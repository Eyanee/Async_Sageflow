
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.550929844379425
distance x is tensor(110.0292, device='cuda:0')
benign distance is  tensor(110.0292, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6929610371589661
distance x is tensor(120.5929, device='cuda:0')
benign distance is  tensor(120.5929, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3631269335746765
distance x is tensor(121.2642, device='cuda:0')
benign distance is  tensor(121.2642, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5663558840751648
distance x is tensor(114.4527, device='cuda:0')
benign distance is  tensor(114.4527, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9087814092636108
distance x is tensor(101.3956, device='cuda:0')
benign distance is  tensor(101.3956, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5198866724967957
distance x is tensor(116.3081, device='cuda:0')
benign distance is  tensor(116.3081, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8514558672904968
distance x is tensor(104.4763, device='cuda:0')
benign distance is  tensor(104.4763, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22767655551433563
distance x is tensor(128.7047, device='cuda:0')
benign distance is  tensor(128.7047, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16495667397975922
distance x is tensor(136.8447, device='cuda:0')
benign distance is  tensor(136.8447, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.47692686319351196
distance x is tensor(132.3745, device='cuda:0')
benign distance is  tensor(132.3745, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.39200201630592346
distance x is tensor(128.7751, device='cuda:0')
benign distance is  tensor(128.7751, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.38265863060951233
distance x is tensor(127.3330, device='cuda:0')
benign distance is  tensor(127.3330, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4038648009300232
distance x is tensor(123.9620, device='cuda:0')
benign distance is  tensor(123.9620, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19887888431549072
distance x is tensor(145.0831, device='cuda:0')
benign distance is  tensor(145.0831, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7790789604187012
distance x is tensor(137.9490, device='cuda:0')
benign distance is  tensor(137.9490, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.37923115491867065
distance x is tensor(132.5671, device='cuda:0')
benign distance is  tensor(132.5671, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.44636330008506775
distance x is tensor(127.4314, device='cuda:0')
benign distance is  tensor(127.4314, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5710074305534363
distance x is tensor(147.4407, device='cuda:0')
benign distance is  tensor(147.4407, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6626875400543213
distance x is tensor(126.1996, device='cuda:0')
benign distance is  tensor(126.1996, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.43015724420547485
distance x is tensor(129.2631, device='cuda:0')
benign distance is  tensor(129.2631, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.13753005862236023
distance x is tensor(126.8788, device='cuda:0')
benign distance is  tensor(126.8788, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.43367162346839905
distance x is tensor(122.5990, device='cuda:0')
benign distance is  tensor(122.5990, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3841951787471771
distance x is tensor(137.1487, device='cuda:0')
benign distance is  tensor(137.1487, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9220300912857056
distance x is tensor(132.3859, device='cuda:0')
benign distance is  tensor(132.3859, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.49257105588912964
distance x is tensor(147.7811, device='cuda:0')
benign distance is  tensor(147.7811, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6954511404037476
distance x is tensor(122.7765, device='cuda:0')
benign distance is  tensor(122.7765, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9002568125724792
distance x is tensor(147.9253, device='cuda:0')
benign distance is  tensor(147.9253, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.33911171555519104
distance x is tensor(134.7274, device='cuda:0')
benign distance is  tensor(134.7274, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6994234323501587
distance x is tensor(125.3964, device='cuda:0')
benign distance is  tensor(125.3964, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5575593113899231
distance x is tensor(140.2197, device='cuda:0')
benign distance is  tensor(140.2197, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2543821930885315
distance x is tensor(126.4542, device='cuda:0')
benign distance is  tensor(126.4542, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6759724617004395
distance x is tensor(131.8750, device='cuda:0')
benign distance is  tensor(131.8750, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4765196442604065
distance x is tensor(138.2788, device='cuda:0')
benign distance is  tensor(138.2788, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.169794961810112
distance x is tensor(127.1025, device='cuda:0')
benign distance is  tensor(127.1025, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.21256911754608154
distance x is tensor(135.6780, device='cuda:0')
benign distance is  tensor(135.6780, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11256898939609528
distance x is tensor(124.7793, device='cuda:0')
benign distance is  tensor(124.7793, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4997996687889099
distance x is tensor(133.9729, device='cuda:0')
benign distance is  tensor(133.9729, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.29287582635879517
distance x is tensor(123.5950, device='cuda:0')
benign distance is  tensor(123.5950, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.21551856398582458
distance x is tensor(126.9440, device='cuda:0')
benign distance is  tensor(126.9440, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.19870856404304504
distance x is tensor(129.5464, device='cuda:0')
benign distance is  tensor(129.5464, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.14020666480064392
distance x is tensor(125.5255, device='cuda:0')
benign distance is  tensor(125.5255, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2644679844379425
distance x is tensor(123.3096, device='cuda:0')
benign distance is  tensor(123.3096, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08808465301990509
distance x is tensor(128.6121, device='cuda:0')
benign distance is  tensor(128.6121, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.28279179334640503
distance x is tensor(140.0348, device='cuda:0')
benign distance is  tensor(140.0348, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.479346364736557
distance x is tensor(136.8011, device='cuda:0')
benign distance is  tensor(136.8011, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7566960453987122
distance x is tensor(127.9432, device='cuda:0')
benign distance is  tensor(127.9432, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5032818913459778
distance x is tensor(136.9179, device='cuda:0')
benign distance is  tensor(136.9179, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2831193208694458
distance x is tensor(132.4239, device='cuda:0')
benign distance is  tensor(132.4239, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([487.4418, 565.8463, 542.7822, 520.1360, 468.1912, 538.0970, 465.9091,
        598.6449, 328.5861, 263.7045, 242.1203, 232.1810, 226.6172, 222.9926,
        220.7211, 219.1464, 217.9622, 216.9204, 216.1331, 215.5823],
       device='cuda:0')
sorted_norm is   tensor([215.5823, 216.1331, 216.9204, 217.9622, 219.1464, 220.7211, 222.9926,
        226.6172, 232.1810, 242.1203, 263.7045, 328.5861, 465.9091, 468.1912,
        487.4418, 520.1360, 538.0970, 542.7822, 565.8463, 598.6449],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  4,  0,  3],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 88.31% 

Test Accuracy: 87.73% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5009535551071167
distance x is tensor(103.6014, device='cuda:0')
benign distance is  tensor(103.6014, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6793941259384155
distance x is tensor(111.2482, device='cuda:0')
benign distance is  tensor(111.2482, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06315469741821289
distance x is tensor(120.7776, device='cuda:0')
benign distance is  tensor(120.7776, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4820326864719391
distance x is tensor(102.5817, device='cuda:0')
benign distance is  tensor(102.5817, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5367287993431091
distance x is tensor(103.8308, device='cuda:0')
benign distance is  tensor(103.8308, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9275985956192017
distance x is tensor(113.1934, device='cuda:0')
benign distance is  tensor(113.1934, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25722411274909973
distance x is tensor(107.1340, device='cuda:0')
benign distance is  tensor(107.1340, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5869207978248596
distance x is tensor(123.7968, device='cuda:0')
benign distance is  tensor(123.7968, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([486.8569, 517.8782, 555.6529, 461.4491, 463.7513, 527.4653, 488.8990,
        560.2787, 344.5408, 280.7040, 260.4342, 251.1566, 246.0694, 242.9380,
        240.7939, 239.2174, 237.9620, 237.1889, 236.5917, 236.0239, 641.7159,
        623.7405, 612.5555, 598.2225, 591.8601, 691.0893, 657.1309, 622.5950],
       device='cuda:0')
sorted_norm is   tensor([236.0239, 236.5917, 237.1889, 237.9620, 239.2174, 240.7939, 242.9380,
        246.0694, 251.1566, 260.4342, 280.7040, 344.5408, 461.4491, 463.7513,
        486.8569, 488.8990, 517.8782, 527.4653, 555.6529, 560.2787, 591.8601,
        598.2225, 612.5555, 622.5950, 623.7405, 641.7159, 657.1309, 691.0893],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  4,  0,  6,  1,  5,
         2,  7, 24, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 87.80% 

Test Accuracy: 87.25% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4033445417881012
distance x is tensor(103.4241, device='cuda:0')
benign distance is  tensor(103.4241, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7686173319816589
distance x is tensor(106.3285, device='cuda:0')
benign distance is  tensor(106.3285, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2616167962551117
distance x is tensor(114.4402, device='cuda:0')
benign distance is  tensor(114.4402, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.201759934425354
distance x is tensor(108.4450, device='cuda:0')
benign distance is  tensor(108.4450, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9229282140731812
distance x is tensor(87.4230, device='cuda:0')
benign distance is  tensor(87.4230, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.14964933693408966
distance x is tensor(110.5436, device='cuda:0')
benign distance is  tensor(110.5436, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5058099031448364
distance x is tensor(99.1581, device='cuda:0')
benign distance is  tensor(99.1581, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9546960592269897
distance x is tensor(113.0429, device='cuda:0')
benign distance is  tensor(113.0429, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25825631618499756
distance x is tensor(126.1154, device='cuda:0')
benign distance is  tensor(126.1154, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3648584485054016
distance x is tensor(130.9663, device='cuda:0')
benign distance is  tensor(130.9663, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1227209568023682
distance x is tensor(122.4368, device='cuda:0')
benign distance is  tensor(122.4368, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8738313913345337
distance x is tensor(124.2663, device='cuda:0')
benign distance is  tensor(124.2663, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.25920990109443665
distance x is tensor(114.5150, device='cuda:0')
benign distance is  tensor(114.5150, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.21401886641979218
distance x is tensor(124.5555, device='cuda:0')
benign distance is  tensor(124.5555, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.40204763412475586
distance x is tensor(123.3721, device='cuda:0')
benign distance is  tensor(123.3721, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6187118291854858
distance x is tensor(126.5139, device='cuda:0')
benign distance is  tensor(126.5139, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([477.5494, 490.2657, 523.5754, 490.4392, 402.4455, 515.0131, 449.4167,
        523.9105, 350.9090, 288.8081, 269.2217, 260.4937, 255.7503, 252.5747,
        250.6000, 249.2447, 248.2235, 247.5598, 246.8695, 246.3014, 623.3340,
        715.8398, 621.1756, 650.1326, 617.5167, 612.4651, 671.0150, 636.0590],
       device='cuda:0')
sorted_norm is   tensor([246.3014, 246.8695, 247.5598, 248.2235, 249.2447, 250.6000, 252.5747,
        255.7503, 260.4937, 269.2217, 288.8081, 350.9090, 402.4455, 449.4167,
        477.5494, 490.2657, 490.4392, 515.0131, 523.5754, 523.9105, 612.4651,
        617.5167, 621.1756, 623.3340, 636.0590, 650.1326, 671.0150, 715.8398],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  6,  0,  1,  3,  5,
         2,  7, 25, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.18% 

Test Accuracy: 86.80% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6433548927307129
distance x is tensor(104.5706, device='cuda:0')
benign distance is  tensor(104.5706, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6365673542022705
distance x is tensor(116.0945, device='cuda:0')
benign distance is  tensor(116.0945, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.210758775472641
distance x is tensor(111.3410, device='cuda:0')
benign distance is  tensor(111.3410, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.401772141456604
distance x is tensor(100.2374, device='cuda:0')
benign distance is  tensor(100.2374, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4218120574951172
distance x is tensor(106.2005, device='cuda:0')
benign distance is  tensor(106.2005, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5609806180000305
distance x is tensor(111.5443, device='cuda:0')
benign distance is  tensor(111.5443, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7397084832191467
distance x is tensor(96.3887, device='cuda:0')
benign distance is  tensor(96.3887, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3868742883205414
distance x is tensor(106.9962, device='cuda:0')
benign distance is  tensor(106.9962, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.09251037240028381
distance x is tensor(124.9964, device='cuda:0')
benign distance is  tensor(124.9964, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.645810604095459
distance x is tensor(132.8302, device='cuda:0')
benign distance is  tensor(132.8302, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.15161557495594025
distance x is tensor(122.6430, device='cuda:0')
benign distance is  tensor(122.6430, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2679820656776428
distance x is tensor(121.2196, device='cuda:0')
benign distance is  tensor(121.2196, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.28341156244277954
distance x is tensor(131.8450, device='cuda:0')
benign distance is  tensor(131.8450, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8366020917892456
distance x is tensor(116.7760, device='cuda:0')
benign distance is  tensor(116.7760, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.24692054092884064
distance x is tensor(128.9652, device='cuda:0')
benign distance is  tensor(128.9652, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8203150033950806
distance x is tensor(121.0312, device='cuda:0')
benign distance is  tensor(121.0312, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([491.6770, 554.1750, 509.4324, 455.1620, 480.9041, 525.8212, 441.5862,
        504.4199, 351.2369, 291.2517, 272.7210, 264.4198, 259.7417, 256.9465,
        255.2064, 253.9199, 252.8923, 252.1870, 251.6674, 251.2399, 742.5776,
        624.6567, 734.3969, 672.7507, 645.6791, 711.1290, 654.9796, 688.5745,
        600.1981, 611.7035, 582.6724, 589.7867, 553.2709, 595.5370, 588.5969,
        604.2159], device='cuda:0')
sorted_norm is   tensor([251.2399, 251.6674, 252.1870, 252.8923, 253.9199, 255.2064, 256.9465,
        259.7417, 264.4198, 272.7210, 291.2517, 351.2369, 441.5862, 455.1620,
        480.9041, 491.6770, 504.4199, 509.4324, 525.8212, 553.2709, 554.1750,
        582.6724, 588.5969, 589.7867, 595.5370, 600.1981, 604.2159, 611.7035,
        624.6567, 645.6791, 654.9796, 672.7507, 688.5745, 711.1290, 734.3969,
        742.5776], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  3,  4,  0,  7,  2,
         5, 32,  1, 30, 34, 31, 33, 28, 35, 29], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.50% 

Test Accuracy: 86.95% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5724696516990662
distance x is tensor(100.7891, device='cuda:0')
benign distance is  tensor(100.7891, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.42444539070129395
distance x is tensor(110.5035, device='cuda:0')
benign distance is  tensor(110.5035, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22310753166675568
distance x is tensor(118.2971, device='cuda:0')
benign distance is  tensor(118.2971, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42944398522377014
distance x is tensor(97.0800, device='cuda:0')
benign distance is  tensor(97.0800, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3742327094078064
distance x is tensor(84.2924, device='cuda:0')
benign distance is  tensor(84.2924, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.21332082152366638
distance x is tensor(108.0247, device='cuda:0')
benign distance is  tensor(108.0247, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1985718011856079
distance x is tensor(107.3833, device='cuda:0')
benign distance is  tensor(107.3833, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3478175699710846
distance x is tensor(102.7790, device='cuda:0')
benign distance is  tensor(102.7790, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5221936702728271
distance x is tensor(125.6572, device='cuda:0')
benign distance is  tensor(125.6572, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.46881818771362305
distance x is tensor(123.3405, device='cuda:0')
benign distance is  tensor(123.3405, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3974153399467468
distance x is tensor(119.7245, device='cuda:0')
benign distance is  tensor(119.7245, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4706161618232727
distance x is tensor(126.9677, device='cuda:0')
benign distance is  tensor(126.9677, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8158753514289856
distance x is tensor(112.5843, device='cuda:0')
benign distance is  tensor(112.5843, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1573721468448639
distance x is tensor(130.9788, device='cuda:0')
benign distance is  tensor(130.9788, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5824640989303589
distance x is tensor(124.2950, device='cuda:0')
benign distance is  tensor(124.2950, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.112845778465271
distance x is tensor(128.9225, device='cuda:0')
benign distance is  tensor(128.9225, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.757735013961792
distance x is tensor(132.7751, device='cuda:0')
benign distance is  tensor(132.7751, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6118844747543335
distance x is tensor(130.0734, device='cuda:0')
benign distance is  tensor(130.0734, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7094566226005554
distance x is tensor(125.8522, device='cuda:0')
benign distance is  tensor(125.8522, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2865022122859955
distance x is tensor(125.6433, device='cuda:0')
benign distance is  tensor(125.6433, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5132333636283875
distance x is tensor(121.9192, device='cuda:0')
benign distance is  tensor(121.9192, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.25999388098716736
distance x is tensor(125.5933, device='cuda:0')
benign distance is  tensor(125.5933, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5256286859512329
distance x is tensor(120.8424, device='cuda:0')
benign distance is  tensor(120.8424, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7577813863754272
distance x is tensor(128.7201, device='cuda:0')
benign distance is  tensor(128.7201, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([474.0146, 523.5365, 539.0678, 461.2548, 390.9474, 506.4365, 495.1978,
        486.4493, 348.6043, 288.5418, 270.2220, 261.9215, 257.4045, 254.6922,
        252.9510, 251.6432, 250.8559, 250.1160, 249.5206, 249.0357, 718.4882,
        677.7806, 711.0345, 670.3537, 701.9209, 651.6268, 679.9618, 675.0922],
       device='cuda:0')
sorted_norm is   tensor([249.0357, 249.5206, 250.1160, 250.8559, 251.6432, 252.9510, 254.6922,
        257.4045, 261.9215, 270.2220, 288.5418, 348.6043, 390.9474, 461.2548,
        474.0146, 486.4493, 495.1978, 506.4365, 523.5365, 539.0678, 651.6268,
        670.3537, 675.0922, 677.7806, 679.9618, 701.9209, 711.0345, 718.4882],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  0,  7,  6,  5,
         1,  2, 25, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 86.63% 

Test Accuracy: 86.29% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.08326682448387146
distance x is tensor(100.9867, device='cuda:0')
benign distance is  tensor(100.9867, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2623562514781952
distance x is tensor(104.8137, device='cuda:0')
benign distance is  tensor(104.8137, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14289356768131256
distance x is tensor(112.0638, device='cuda:0')
benign distance is  tensor(112.0638, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4913772940635681
distance x is tensor(102.3443, device='cuda:0')
benign distance is  tensor(102.3443, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6716161966323853
distance x is tensor(95.8059, device='cuda:0')
benign distance is  tensor(95.8059, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1362661123275757
distance x is tensor(109.3584, device='cuda:0')
benign distance is  tensor(109.3584, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1621381789445877
distance x is tensor(110.8322, device='cuda:0')
benign distance is  tensor(110.8322, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3872440457344055
distance x is tensor(117.6493, device='cuda:0')
benign distance is  tensor(117.6493, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.328269898891449
distance x is tensor(131.6542, device='cuda:0')
benign distance is  tensor(131.6542, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.43248122930526733
distance x is tensor(118.5103, device='cuda:0')
benign distance is  tensor(118.5103, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4233357310295105
distance x is tensor(130.3996, device='cuda:0')
benign distance is  tensor(130.3996, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.18013203144073486
distance x is tensor(122.9638, device='cuda:0')
benign distance is  tensor(122.9638, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.750929057598114
distance x is tensor(118.4079, device='cuda:0')
benign distance is  tensor(118.4079, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.23195485770702362
distance x is tensor(113.6210, device='cuda:0')
benign distance is  tensor(113.6210, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7306221723556519
distance x is tensor(119.3506, device='cuda:0')
benign distance is  tensor(119.3506, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4834429621696472
distance x is tensor(120.5380, device='cuda:0')
benign distance is  tensor(120.5380, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([473.0555, 495.4983, 530.3005, 471.7097, 440.6201, 515.8159, 501.3582,
        546.1344, 347.3098, 288.6608, 270.8819, 263.1462, 258.8386, 256.1540,
        254.4438, 253.2818, 252.3686, 251.7041, 251.1816, 250.7470, 709.2482,
        692.5540, 708.2000, 741.6514, 740.2279, 707.4800, 741.7291, 726.1053,
        597.7825, 641.1540, 597.6791, 606.0549, 638.5569, 577.6475, 640.5557,
        588.9547, 607.1524, 594.4756, 561.6325, 603.5897, 541.8731, 611.3922,
        610.0413, 603.5895], device='cuda:0')
sorted_norm is   tensor([250.7470, 251.1816, 251.7041, 252.3686, 253.2818, 254.4438, 256.1540,
        258.8386, 263.1462, 270.8819, 288.6608, 347.3098, 440.6201, 471.7097,
        473.0555, 495.4983, 501.3582, 515.8159, 530.3005, 541.8731, 546.1344,
        561.6325, 577.6475, 588.9547, 594.4756, 597.6791, 597.7825, 603.5895,
        603.5897, 606.0549, 607.1524, 610.0413, 611.3922, 638.5569, 640.5557,
        641.1540, 692.5540, 707.4800, 708.2000, 709.2482, 726.1053, 740.2279,
        741.6514, 741.7291], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  0,  1,  6,  5,
         2, 40,  7, 38, 33, 35, 37, 30, 28, 43, 39, 31, 36, 42, 41, 32, 34],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 88.12% 

Test Accuracy: 87.69% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.26407137513160706
distance x is tensor(90.9306, device='cuda:0')
benign distance is  tensor(90.9306, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6727063655853271
distance x is tensor(109.0476, device='cuda:0')
benign distance is  tensor(109.0476, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.34046831727027893
distance x is tensor(117.1631, device='cuda:0')
benign distance is  tensor(117.1631, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5410330891609192
distance x is tensor(98.5662, device='cuda:0')
benign distance is  tensor(98.5662, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7055395841598511
distance x is tensor(90.2557, device='cuda:0')
benign distance is  tensor(90.2557, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8362442255020142
distance x is tensor(109.2631, device='cuda:0')
benign distance is  tensor(109.2631, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28626778721809387
distance x is tensor(105.7343, device='cuda:0')
benign distance is  tensor(105.7343, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5653430223464966
distance x is tensor(110.4404, device='cuda:0')
benign distance is  tensor(110.4404, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4198485016822815
distance x is tensor(121.4105, device='cuda:0')
benign distance is  tensor(121.4105, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.24601730704307556
distance x is tensor(124.5425, device='cuda:0')
benign distance is  tensor(124.5425, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.31079986691474915
distance x is tensor(118.5714, device='cuda:0')
benign distance is  tensor(118.5714, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4269445538520813
distance x is tensor(117.8120, device='cuda:0')
benign distance is  tensor(117.8120, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.23144373297691345
distance x is tensor(119.0847, device='cuda:0')
benign distance is  tensor(119.0847, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.08175349980592728
distance x is tensor(127.4761, device='cuda:0')
benign distance is  tensor(127.4761, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.44962865114212036
distance x is tensor(119.2246, device='cuda:0')
benign distance is  tensor(119.2246, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.590343713760376
distance x is tensor(127.7148, device='cuda:0')
benign distance is  tensor(127.7148, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.23242402076721191
distance x is tensor(118.1378, device='cuda:0')
benign distance is  tensor(118.1378, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9115659594535828
distance x is tensor(139.4561, device='cuda:0')
benign distance is  tensor(139.4561, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5445326566696167
distance x is tensor(122.2454, device='cuda:0')
benign distance is  tensor(122.2454, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.49716252088546753
distance x is tensor(123.0378, device='cuda:0')
benign distance is  tensor(123.0378, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5492734909057617
distance x is tensor(121.6874, device='cuda:0')
benign distance is  tensor(121.6874, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1076475381851196
distance x is tensor(109.4846, device='cuda:0')
benign distance is  tensor(109.4846, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2390066683292389
distance x is tensor(122.1273, device='cuda:0')
benign distance is  tensor(122.1273, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.29446840286254883
distance x is tensor(124.8393, device='cuda:0')
benign distance is  tensor(124.8393, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.09149465709924698
distance x is tensor(119.6313, device='cuda:0')
benign distance is  tensor(119.6313, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.264179527759552
distance x is tensor(120.8044, device='cuda:0')
benign distance is  tensor(120.8044, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.19547919929027557
distance x is tensor(117.2553, device='cuda:0')
benign distance is  tensor(117.2553, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.36829671263694763
distance x is tensor(122.4291, device='cuda:0')
benign distance is  tensor(122.4291, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3655255436897278
distance x is tensor(112.7123, device='cuda:0')
benign distance is  tensor(112.7123, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.48332491517066956
distance x is tensor(116.9186, device='cuda:0')
benign distance is  tensor(116.9186, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.2740105986595154
distance x is tensor(126.0393, device='cuda:0')
benign distance is  tensor(126.0393, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2899699807167053
distance x is tensor(123.5231, device='cuda:0')
benign distance is  tensor(123.5231, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([421.8410, 522.3578, 540.4729, 455.1517, 420.0233, 518.4945, 490.3795,
        533.7343, 340.5846, 282.2593, 264.0224, 255.7218, 251.2802, 248.5992,
        246.6742, 245.3081, 244.4912, 243.8815, 243.3519, 242.8321],
       device='cuda:0')
sorted_norm is   tensor([242.8321, 243.3519, 243.8815, 244.4912, 245.3081, 246.6742, 248.5992,
        251.2802, 255.7218, 264.0224, 282.2593, 340.5846, 420.0233, 421.8410,
        455.1517, 490.3795, 518.4945, 522.3578, 533.7343, 540.4729],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  0,  3,  6],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 85.02% 

Test Accuracy: 84.07% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.43140363693237305
distance x is tensor(106.7458, device='cuda:0')
benign distance is  tensor(106.7458, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7219552993774414
distance x is tensor(117.1028, device='cuda:0')
benign distance is  tensor(117.1028, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25966453552246094
distance x is tensor(122.2572, device='cuda:0')
benign distance is  tensor(122.2572, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7488226890563965
distance x is tensor(99.4369, device='cuda:0')
benign distance is  tensor(99.4369, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8452184796333313
distance x is tensor(98.7973, device='cuda:0')
benign distance is  tensor(98.7973, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.38482990860939026
distance x is tensor(109.7829, device='cuda:0')
benign distance is  tensor(109.7829, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.209660142660141
distance x is tensor(108.1892, device='cuda:0')
benign distance is  tensor(108.1892, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4889290928840637
distance x is tensor(115.8120, device='cuda:0')
benign distance is  tensor(115.8120, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([501.5263, 550.0032, 564.7527, 457.3149, 456.8547, 517.6656, 497.9142,
        553.5301, 343.1775, 287.2223, 270.3684, 262.9421, 258.8287, 256.4710,
        254.6908, 253.5428, 252.7032, 252.1461, 251.6547, 251.1957, 669.2725,
        645.7778, 645.7080, 650.4539, 616.6451, 640.3928, 625.6154, 669.8354,
        627.5776, 617.5063, 587.9979, 575.8857, 601.0507, 634.7765, 599.6585,
        630.9659], device='cuda:0')
sorted_norm is   tensor([251.1957, 251.6547, 252.1461, 252.7032, 253.5428, 254.6908, 256.4710,
        258.8287, 262.9421, 270.3684, 287.2223, 343.1775, 456.8547, 457.3149,
        497.9142, 501.5263, 517.6656, 550.0032, 553.5301, 564.7527, 575.8857,
        587.9979, 599.6585, 601.0507, 616.6451, 617.5063, 625.6154, 627.5776,
        630.9659, 634.7765, 640.3928, 645.7080, 645.7778, 650.4539, 669.2725,
        669.8354], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  6,  0,  5,  1,
         7,  2, 31, 30, 34, 32, 24, 29, 26, 28], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 86.46% 

Test Accuracy: 85.80% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9267094731330872
distance x is tensor(101.6737, device='cuda:0')
benign distance is  tensor(101.6737, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7908721566200256
distance x is tensor(113.5677, device='cuda:0')
benign distance is  tensor(113.5677, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22492428123950958
distance x is tensor(116.3879, device='cuda:0')
benign distance is  tensor(116.3879, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.31724196672439575
distance x is tensor(106.7897, device='cuda:0')
benign distance is  tensor(106.7897, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7222580909729004
distance x is tensor(93.8072, device='cuda:0')
benign distance is  tensor(93.8072, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7854856252670288
distance x is tensor(112.6504, device='cuda:0')
benign distance is  tensor(112.6504, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35357287526130676
distance x is tensor(111.5140, device='cuda:0')
benign distance is  tensor(111.5140, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3220401406288147
distance x is tensor(117.1764, device='cuda:0')
benign distance is  tensor(117.1764, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21216988563537598
distance x is tensor(128.6498, device='cuda:0')
benign distance is  tensor(128.6498, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.17381298542022705
distance x is tensor(131.9847, device='cuda:0')
benign distance is  tensor(131.9847, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.1598690003156662
distance x is tensor(115.3995, device='cuda:0')
benign distance is  tensor(115.3995, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7940220236778259
distance x is tensor(123.3580, device='cuda:0')
benign distance is  tensor(123.3580, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5534164309501648
distance x is tensor(122.3476, device='cuda:0')
benign distance is  tensor(122.3476, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4252909719944
distance x is tensor(128.6985, device='cuda:0')
benign distance is  tensor(128.6985, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5222254991531372
distance x is tensor(123.0262, device='cuda:0')
benign distance is  tensor(123.0262, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7000088691711426
distance x is tensor(128.6996, device='cuda:0')
benign distance is  tensor(128.6996, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4614502489566803
distance x is tensor(125.5579, device='cuda:0')
benign distance is  tensor(125.5579, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3123220205307007
distance x is tensor(119.5241, device='cuda:0')
benign distance is  tensor(119.5241, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.27570468187332153
distance x is tensor(130.4408, device='cuda:0')
benign distance is  tensor(130.4408, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.49623265862464905
distance x is tensor(136.4385, device='cuda:0')
benign distance is  tensor(136.4385, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5683987140655518
distance x is tensor(124.9381, device='cuda:0')
benign distance is  tensor(124.9381, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7046235799789429
distance x is tensor(130.2999, device='cuda:0')
benign distance is  tensor(130.2999, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2083481252193451
distance x is tensor(114.5794, device='cuda:0')
benign distance is  tensor(114.5794, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.21054399013519287
distance x is tensor(124.9105, device='cuda:0')
benign distance is  tensor(124.9105, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([478.1164, 532.9216, 537.4335, 485.6888, 440.0191, 537.6584, 518.1633,
        551.7122, 338.1519, 282.1617, 264.9225, 257.2469, 253.0261, 250.5896,
        248.7387, 247.5085, 246.5894, 245.8251, 245.3062, 244.8829, 594.5588,
        697.5900, 607.8344, 624.5895, 609.6596, 557.7319, 625.8240, 620.4286],
       device='cuda:0')
sorted_norm is   tensor([244.8829, 245.3062, 245.8251, 246.5894, 247.5085, 248.7387, 250.5896,
        253.0261, 257.2469, 264.9225, 282.1617, 338.1519, 440.0191, 478.1164,
        485.6888, 518.1633, 532.9216, 537.4335, 537.6584, 551.7122, 557.7319,
        594.5588, 607.8344, 609.6596, 620.4286, 624.5895, 625.8240, 697.5900],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  0,  3,  6,  1,  2,
         5,  7, 25, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 85.78% 

Test Accuracy: 85.03% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41746339201927185
distance x is tensor(114.2764, device='cuda:0')
benign distance is  tensor(114.2764, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4437963962554932
distance x is tensor(114.7731, device='cuda:0')
benign distance is  tensor(114.7731, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6474677920341492
distance x is tensor(110.4573, device='cuda:0')
benign distance is  tensor(110.4573, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5583246946334839
distance x is tensor(102.8976, device='cuda:0')
benign distance is  tensor(102.8976, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6178373098373413
distance x is tensor(100.7294, device='cuda:0')
benign distance is  tensor(100.7294, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7108922004699707
distance x is tensor(108.5508, device='cuda:0')
benign distance is  tensor(108.5508, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26956409215927124
distance x is tensor(105.3780, device='cuda:0')
benign distance is  tensor(105.3780, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2314939796924591
distance x is tensor(116.1206, device='cuda:0')
benign distance is  tensor(116.1206, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.40670084953308105
distance x is tensor(135.9851, device='cuda:0')
benign distance is  tensor(135.9851, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7622256278991699
distance x is tensor(134.3025, device='cuda:0')
benign distance is  tensor(134.3025, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.24372133612632751
distance x is tensor(114.0118, device='cuda:0')
benign distance is  tensor(114.0118, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.15859811007976532
distance x is tensor(129.0395, device='cuda:0')
benign distance is  tensor(129.0395, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.47337356209754944
distance x is tensor(130.9311, device='cuda:0')
benign distance is  tensor(130.9311, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4177851676940918
distance x is tensor(127.6123, device='cuda:0')
benign distance is  tensor(127.6123, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.15691903233528137
distance x is tensor(141.8602, device='cuda:0')
benign distance is  tensor(141.8602, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8517904281616211
distance x is tensor(126.6814, device='cuda:0')
benign distance is  tensor(126.6814, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([535.9785, 553.8380, 522.3290, 486.5125, 473.9098, 513.3199, 486.8716,
        542.4918, 335.2233, 279.4385, 262.4917, 254.9422, 250.9672, 248.4918,
        246.7266, 245.6771, 244.7634, 244.1291, 243.6696, 243.2357, 675.4429,
        641.5026, 685.1472, 649.8311, 645.2947, 617.8471, 641.4432, 637.9409,
        634.5587, 643.9935, 563.1170, 597.9160, 596.2494, 627.5602, 595.9426,
        624.0172], device='cuda:0')
sorted_norm is   tensor([243.2357, 243.6696, 244.1291, 244.7634, 245.6771, 246.7266, 248.4918,
        250.9672, 254.9422, 262.4917, 279.4385, 335.2233, 473.9098, 486.5125,
        486.8716, 513.3199, 522.3290, 535.9785, 542.4918, 553.8380, 563.1170,
        595.9426, 596.2494, 597.9160, 617.8471, 624.0172, 627.5602, 634.5587,
        637.9409, 641.4432, 641.5026, 643.9935, 645.2947, 649.8311, 675.4429,
        685.1472], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  6,  5,  2,  0,
         7,  1, 30, 34, 32, 31, 25, 35, 33, 28], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 87.04% 

Test Accuracy: 86.22% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4705749452114105
distance x is tensor(109.9364, device='cuda:0')
benign distance is  tensor(109.9364, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7178636789321899
distance x is tensor(114.7802, device='cuda:0')
benign distance is  tensor(114.7802, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03675723075866699
distance x is tensor(113.9087, device='cuda:0')
benign distance is  tensor(113.9087, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5335319638252258
distance x is tensor(107.3306, device='cuda:0')
benign distance is  tensor(107.3306, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.18450799584388733
distance x is tensor(103.2598, device='cuda:0')
benign distance is  tensor(103.2598, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.376051127910614
distance x is tensor(106.8482, device='cuda:0')
benign distance is  tensor(106.8482, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22219130396842957
distance x is tensor(103.0000, device='cuda:0')
benign distance is  tensor(103.0000, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3228948712348938
distance x is tensor(114.4617, device='cuda:0')
benign distance is  tensor(114.4617, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5123978853225708
distance x is tensor(133.1223, device='cuda:0')
benign distance is  tensor(133.1223, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.1354638636112213
distance x is tensor(129.9226, device='cuda:0')
benign distance is  tensor(129.9226, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5334782600402832
distance x is tensor(120.5910, device='cuda:0')
benign distance is  tensor(120.5910, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3070403337478638
distance x is tensor(134.2036, device='cuda:0')
benign distance is  tensor(134.2036, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.899091899394989
distance x is tensor(125.0907, device='cuda:0')
benign distance is  tensor(125.0907, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8114155530929565
distance x is tensor(132.3863, device='cuda:0')
benign distance is  tensor(132.3863, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.33000701665878296
distance x is tensor(126.2048, device='cuda:0')
benign distance is  tensor(126.2048, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5508337020874023
distance x is tensor(134.5082, device='cuda:0')
benign distance is  tensor(134.5082, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.46057432889938354
distance x is tensor(130.4798, device='cuda:0')
benign distance is  tensor(130.4798, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.14571473002433777
distance x is tensor(125.6885, device='cuda:0')
benign distance is  tensor(125.6885, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.15447893738746643
distance x is tensor(126.6568, device='cuda:0')
benign distance is  tensor(126.6568, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6484692096710205
distance x is tensor(120.8888, device='cuda:0')
benign distance is  tensor(120.8888, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6398353576660156
distance x is tensor(125.2232, device='cuda:0')
benign distance is  tensor(125.2232, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2903580069541931
distance x is tensor(121.7398, device='cuda:0')
benign distance is  tensor(121.7398, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7038780450820923
distance x is tensor(126.8542, device='cuda:0')
benign distance is  tensor(126.8542, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2732924818992615
distance x is tensor(145.5471, device='cuda:0')
benign distance is  tensor(145.5471, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([521.8015, 546.6312, 534.4698, 481.8623, 474.4269, 515.4908, 476.3913,
        547.1243, 331.8267, 275.6479, 258.4656, 251.1495, 247.0533, 244.4741,
        242.7185, 241.4558, 240.6477, 240.0043, 239.4326, 239.0420],
       device='cuda:0')
sorted_norm is   tensor([239.0420, 239.4326, 240.0043, 240.6477, 241.4558, 242.7185, 244.4741,
        247.0533, 251.1495, 258.4656, 275.6479, 331.8267, 474.4269, 476.3913,
        481.8623, 515.4908, 521.8015, 534.4698, 546.6312, 547.1243],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  6,  3,  5],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 83.88% 

Test Accuracy: 82.84% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3471800982952118
distance x is tensor(130.0020, device='cuda:0')
benign distance is  tensor(130.0020, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5567179918289185
distance x is tensor(131.3678, device='cuda:0')
benign distance is  tensor(131.3678, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.037806253880262375
distance x is tensor(130.6929, device='cuda:0')
benign distance is  tensor(130.6929, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2551175355911255
distance x is tensor(106.1836, device='cuda:0')
benign distance is  tensor(106.1836, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8262974619865417
distance x is tensor(103.1210, device='cuda:0')
benign distance is  tensor(103.1210, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.058383822441101
distance x is tensor(115.9708, device='cuda:0')
benign distance is  tensor(115.9708, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5507890582084656
distance x is tensor(119.2705, device='cuda:0')
benign distance is  tensor(119.2705, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.27672991156578064
distance x is tensor(116.7013, device='cuda:0')
benign distance is  tensor(116.7013, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([625.1133, 630.3925, 625.2967, 497.3410, 492.9127, 556.1494, 551.4219,
        557.5159, 330.4286, 276.5947, 260.3463, 253.2967, 249.4176, 246.9453,
        245.5532, 244.4498, 243.6629, 243.1208, 242.6565, 242.3295, 725.7543,
        730.7561, 714.4655, 722.6041, 706.0022, 713.4622, 735.2170, 739.8476,
        664.5131, 628.2445, 693.8171, 713.9989, 658.9245, 682.7138, 631.6536,
        669.0900, 679.6826, 685.9418, 591.8509, 652.7358, 658.1422, 658.4437,
        706.1564, 629.9748, 662.0811, 653.2723, 607.2469, 674.6975, 623.5476,
        652.8394, 643.9965, 675.4766], device='cuda:0')
sorted_norm is   tensor([242.3295, 242.6565, 243.1208, 243.6629, 244.4498, 245.5532, 246.9453,
        249.4176, 253.2967, 260.3463, 276.5947, 330.4286, 492.9127, 497.3410,
        551.4219, 556.1494, 557.5159, 591.8509, 607.2469, 623.5476, 625.1133,
        625.2967, 628.2445, 629.9748, 630.3925, 631.6536, 643.9965, 652.7358,
        652.8394, 653.2723, 658.1422, 658.4437, 658.9245, 662.0811, 664.5131,
        669.0900, 674.6975, 675.4766, 679.6826, 682.7138, 685.9418, 693.8171,
        706.0022, 706.1564, 713.4622, 713.9989, 714.4655, 722.6041, 725.7543,
        730.7561, 735.2170, 739.8476], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  6,  5,  7, 38,
        46, 48,  0,  2, 29, 43,  1, 34, 50, 39, 49, 45, 40, 41, 32, 44, 28, 35,
        47, 51, 36, 33, 37], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 88.03% 

Test Accuracy: 87.10% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8377158045768738
distance x is tensor(94.9639, device='cuda:0')
benign distance is  tensor(94.9639, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6218405961990356
distance x is tensor(122.3588, device='cuda:0')
benign distance is  tensor(122.3588, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09584077447652817
distance x is tensor(120.2623, device='cuda:0')
benign distance is  tensor(120.2623, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.03679358959198
distance x is tensor(116.6126, device='cuda:0')
benign distance is  tensor(116.6126, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6471227407455444
distance x is tensor(104.1731, device='cuda:0')
benign distance is  tensor(104.1731, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.32503610849380493
distance x is tensor(112.0500, device='cuda:0')
benign distance is  tensor(112.0500, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.08796726167201996
distance x is tensor(104.7667, device='cuda:0')
benign distance is  tensor(104.7667, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7094920873641968
distance x is tensor(111.9651, device='cuda:0')
benign distance is  tensor(111.9651, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4669252038002014
distance x is tensor(132.3373, device='cuda:0')
benign distance is  tensor(132.3373, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.416959673166275
distance x is tensor(131.0147, device='cuda:0')
benign distance is  tensor(131.0147, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2985479235649109
distance x is tensor(114.1826, device='cuda:0')
benign distance is  tensor(114.1826, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9607146382331848
distance x is tensor(131.6356, device='cuda:0')
benign distance is  tensor(131.6356, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4258947968482971
distance x is tensor(112.0634, device='cuda:0')
benign distance is  tensor(112.0634, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15889130532741547
distance x is tensor(124.7785, device='cuda:0')
benign distance is  tensor(124.7785, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7224279046058655
distance x is tensor(121.3584, device='cuda:0')
benign distance is  tensor(121.3584, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.49238449335098267
distance x is tensor(130.5305, device='cuda:0')
benign distance is  tensor(130.5305, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3290650248527527
distance x is tensor(129.1169, device='cuda:0')
benign distance is  tensor(129.1169, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.43970680236816406
distance x is tensor(128.8501, device='cuda:0')
benign distance is  tensor(128.8501, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6828922033309937
distance x is tensor(128.0721, device='cuda:0')
benign distance is  tensor(128.0721, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.34521904587745667
distance x is tensor(123.2327, device='cuda:0')
benign distance is  tensor(123.2327, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.44365978240966797
distance x is tensor(120.1652, device='cuda:0')
benign distance is  tensor(120.1652, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8891072273254395
distance x is tensor(121.0854, device='cuda:0')
benign distance is  tensor(121.0854, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2151803970336914
distance x is tensor(124.9047, device='cuda:0')
benign distance is  tensor(124.9047, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.626926064491272
distance x is tensor(122.3691, device='cuda:0')
benign distance is  tensor(122.3691, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.38010117411613464
distance x is tensor(131.1276, device='cuda:0')
benign distance is  tensor(131.1276, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3648701310157776
distance x is tensor(110.4496, device='cuda:0')
benign distance is  tensor(110.4496, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3269450068473816
distance x is tensor(130.6598, device='cuda:0')
benign distance is  tensor(130.6598, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4239150583744049
distance x is tensor(134.3308, device='cuda:0')
benign distance is  tensor(134.3308, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.36351799964904785
distance x is tensor(138.7046, device='cuda:0')
benign distance is  tensor(138.7046, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8085604906082153
distance x is tensor(127.9993, device='cuda:0')
benign distance is  tensor(127.9993, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4407007694244385
distance x is tensor(126.6654, device='cuda:0')
benign distance is  tensor(126.6654, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3446354269981384
distance x is tensor(124.4508, device='cuda:0')
benign distance is  tensor(124.4508, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2790519595146179
distance x is tensor(123.0013, device='cuda:0')
benign distance is  tensor(123.0013, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.950611412525177
distance x is tensor(121.7109, device='cuda:0')
benign distance is  tensor(121.7109, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.17593301832675934
distance x is tensor(117.5245, device='cuda:0')
benign distance is  tensor(117.5245, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8034698367118835
distance x is tensor(143.2129, device='cuda:0')
benign distance is  tensor(143.2129, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5714188814163208
distance x is tensor(121.7545, device='cuda:0')
benign distance is  tensor(121.7545, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6117137670516968
distance x is tensor(128.8343, device='cuda:0')
benign distance is  tensor(128.8343, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.3261539936065674
distance x is tensor(134.2570, device='cuda:0')
benign distance is  tensor(134.2570, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.313125342130661
distance x is tensor(131.8691, device='cuda:0')
benign distance is  tensor(131.8691, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([454.7867, 574.4067, 574.6219, 542.2158, 479.5909, 541.7099, 486.2366,
        534.4195, 323.8677, 268.0772, 251.0861, 243.5411, 239.5686, 237.0472,
        235.2332, 234.0091, 233.2819, 232.6192, 232.1897, 231.7567],
       device='cuda:0')
sorted_norm is   tensor([231.7567, 232.1897, 232.6192, 233.2819, 234.0091, 235.2332, 237.0472,
        239.5686, 243.5411, 251.0861, 268.0772, 323.8677, 454.7867, 479.5909,
        486.2366, 534.4195, 541.7099, 542.2158, 574.4067, 574.6219],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  0,  4,  6,  7],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 85.98% 

Test Accuracy: 85.13% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0146890878677368
distance x is tensor(112.8845, device='cuda:0')
benign distance is  tensor(112.8845, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2202361524105072
distance x is tensor(113.1659, device='cuda:0')
benign distance is  tensor(113.1659, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20430417358875275
distance x is tensor(121.2769, device='cuda:0')
benign distance is  tensor(121.2769, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6842040419578552
distance x is tensor(107.7904, device='cuda:0')
benign distance is  tensor(107.7904, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6717566251754761
distance x is tensor(104.5315, device='cuda:0')
benign distance is  tensor(104.5315, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3870924413204193
distance x is tensor(120.3559, device='cuda:0')
benign distance is  tensor(120.3559, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4070603847503662
distance x is tensor(109.8173, device='cuda:0')
benign distance is  tensor(109.8173, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7222179174423218
distance x is tensor(123.9970, device='cuda:0')
benign distance is  tensor(123.9970, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([544.8859, 553.3508, 580.7203, 501.8255, 490.6270, 579.2003, 506.9576,
        594.2509, 324.2111, 269.9777, 253.4762, 246.3345, 242.4397, 240.2565,
        238.5508, 237.2626, 236.3633, 235.8270, 235.4459, 235.0828, 648.9680,
        642.4222, 589.1143, 643.8152, 561.6250, 625.6891, 624.0591, 655.5600],
       device='cuda:0')
sorted_norm is   tensor([235.0828, 235.4459, 235.8270, 236.3633, 237.2626, 238.5508, 240.2565,
        242.4397, 246.3345, 253.4762, 269.9777, 324.2111, 490.6270, 501.8255,
        506.9576, 544.8859, 553.3508, 561.6250, 579.2003, 580.7203, 589.1143,
        594.2509, 624.0591, 625.6891, 642.4222, 643.8152, 648.9680, 655.5600],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  6,  0,  1, 24,
         5,  2, 22,  7], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 86.32% 

Test Accuracy: 85.60% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4725784659385681
distance x is tensor(107.3816, device='cuda:0')
benign distance is  tensor(107.3816, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5692898631095886
distance x is tensor(124.2356, device='cuda:0')
benign distance is  tensor(124.2356, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2000611126422882
distance x is tensor(122.1339, device='cuda:0')
benign distance is  tensor(122.1339, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6513472199440002
distance x is tensor(118.9972, device='cuda:0')
benign distance is  tensor(118.9972, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6473525762557983
distance x is tensor(108.9186, device='cuda:0')
benign distance is  tensor(108.9186, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9546005129814148
distance x is tensor(122.9292, device='cuda:0')
benign distance is  tensor(122.9292, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.49558645486831665
distance x is tensor(108.8936, device='cuda:0')
benign distance is  tensor(108.8936, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.380820095539093
distance x is tensor(116.7913, device='cuda:0')
benign distance is  tensor(116.7913, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3952008783817291
distance x is tensor(137.2423, device='cuda:0')
benign distance is  tensor(137.2423, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.39012864232063293
distance x is tensor(134.1189, device='cuda:0')
benign distance is  tensor(134.1189, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7146962285041809
distance x is tensor(122.6568, device='cuda:0')
benign distance is  tensor(122.6568, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.523219883441925
distance x is tensor(129.0952, device='cuda:0')
benign distance is  tensor(129.0952, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.634517252445221
distance x is tensor(125.4160, device='cuda:0')
benign distance is  tensor(125.4160, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6028286814689636
distance x is tensor(130.7368, device='cuda:0')
benign distance is  tensor(130.7368, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.45202597975730896
distance x is tensor(132.2304, device='cuda:0')
benign distance is  tensor(132.2304, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4924547076225281
distance x is tensor(125.2438, device='cuda:0')
benign distance is  tensor(125.2438, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([503.9762, 599.6342, 581.7633, 554.8910, 513.5703, 594.9052, 516.1161,
        560.0790, 321.7940, 267.7193, 251.6430, 244.6000, 240.7235, 238.5654,
        237.0351, 235.6380, 234.8801, 234.1495, 233.6865, 233.4477, 696.4544,
        693.2231, 687.3408, 657.9522, 676.4286, 671.8135, 684.1251, 731.8881,
        659.4719, 673.3886, 657.6826, 645.7247, 621.6550, 643.9694, 651.4659,
        626.0273], device='cuda:0')
sorted_norm is   tensor([233.4477, 233.6865, 234.1495, 234.8801, 235.6380, 237.0351, 238.5654,
        240.7235, 244.6000, 251.6430, 267.7193, 321.7940, 503.9762, 513.5703,
        516.1161, 554.8910, 560.0790, 581.7633, 594.9052, 599.6342, 621.6550,
        626.0273, 643.9694, 645.7247, 651.4659, 657.6826, 657.9522, 659.4719,
        671.8135, 673.3886, 676.4286, 684.1251, 687.3408, 693.2231, 696.4544,
        731.8881], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  0,  4,  6,  3,  7,  2,
         5,  1, 32, 35, 33, 31, 34, 30, 23, 28], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 87.46% 

Test Accuracy: 86.63% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1375153362751007
distance x is tensor(101.8083, device='cuda:0')
benign distance is  tensor(101.8083, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5901004076004028
distance x is tensor(120.1316, device='cuda:0')
benign distance is  tensor(120.1316, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5905896425247192
distance x is tensor(119.8636, device='cuda:0')
benign distance is  tensor(119.8636, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.30155646800994873
distance x is tensor(97.1709, device='cuda:0')
benign distance is  tensor(97.1709, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8471075892448425
distance x is tensor(104.1609, device='cuda:0')
benign distance is  tensor(104.1609, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5214084386825562
distance x is tensor(117.3665, device='cuda:0')
benign distance is  tensor(117.3665, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.43448764085769653
distance x is tensor(102.7874, device='cuda:0')
benign distance is  tensor(102.7874, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.28437480330467224
distance x is tensor(112.0301, device='cuda:0')
benign distance is  tensor(112.0301, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3504788875579834
distance x is tensor(132.5678, device='cuda:0')
benign distance is  tensor(132.5678, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4541843831539154
distance x is tensor(138.9477, device='cuda:0')
benign distance is  tensor(138.9477, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9089471101760864
distance x is tensor(120.0709, device='cuda:0')
benign distance is  tensor(120.0709, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7953047156333923
distance x is tensor(128.9702, device='cuda:0')
benign distance is  tensor(128.9702, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.30027610063552856
distance x is tensor(136.3222, device='cuda:0')
benign distance is  tensor(136.3222, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6517492532730103
distance x is tensor(123.0371, device='cuda:0')
benign distance is  tensor(123.0371, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.16203179955482483
distance x is tensor(134.7064, device='cuda:0')
benign distance is  tensor(134.7064, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.27614063024520874
distance x is tensor(131.7576, device='cuda:0')
benign distance is  tensor(131.7576, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6219832301139832
distance x is tensor(134.2121, device='cuda:0')
benign distance is  tensor(134.2121, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.29808297753334045
distance x is tensor(124.4772, device='cuda:0')
benign distance is  tensor(124.4772, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5931310653686523
distance x is tensor(138.5094, device='cuda:0')
benign distance is  tensor(138.5094, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.30469223856925964
distance x is tensor(136.3634, device='cuda:0')
benign distance is  tensor(136.3634, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.385384202003479
distance x is tensor(130.5143, device='cuda:0')
benign distance is  tensor(130.5143, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.26488691568374634
distance x is tensor(122.5740, device='cuda:0')
benign distance is  tensor(122.5740, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.29771676659584045
distance x is tensor(130.7541, device='cuda:0')
benign distance is  tensor(130.7541, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.33194735646247864
distance x is tensor(122.3087, device='cuda:0')
benign distance is  tensor(122.3087, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([489.8387, 580.6288, 570.4866, 458.4357, 501.4947, 561.0912, 484.1070,
        534.0539, 317.2646, 263.2977, 247.0764, 239.8344, 235.9292, 233.6013,
        231.9536, 230.7366, 229.9941, 229.3287, 228.8203, 228.4919, 674.9683,
        576.3222, 669.0869, 664.1326, 677.2672, 649.6055, 644.5318, 638.9935,
        649.1222, 642.6445, 583.5776, 607.0081, 607.4220, 629.0315, 632.6402,
        604.9785], device='cuda:0')
sorted_norm is   tensor([228.4919, 228.8203, 229.3287, 229.9941, 230.7366, 231.9536, 233.6013,
        235.9292, 239.8344, 247.0764, 263.2977, 317.2646, 458.4357, 484.1070,
        489.8387, 501.4947, 534.0539, 561.0912, 570.4866, 576.3222, 580.6288,
        583.5776, 604.9785, 607.0081, 607.4220, 629.0315, 632.6402, 638.9935,
        642.6445, 644.5318, 649.1222, 649.6055, 664.1326, 669.0869, 674.9683,
        677.2672], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  6,  0,  4,  7,  5,
         2, 21,  1, 30, 35, 31, 32, 33, 34, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 88.03% 

Test Accuracy: 87.11% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3004132807254791
distance x is tensor(122.1010, device='cuda:0')
benign distance is  tensor(122.1010, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6085777282714844
distance x is tensor(117.7053, device='cuda:0')
benign distance is  tensor(117.7053, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14303883910179138
distance x is tensor(122.0829, device='cuda:0')
benign distance is  tensor(122.0829, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0341466665267944
distance x is tensor(109.0353, device='cuda:0')
benign distance is  tensor(109.0353, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5199803113937378
distance x is tensor(106.4015, device='cuda:0')
benign distance is  tensor(106.4015, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8505663871765137
distance x is tensor(123.6381, device='cuda:0')
benign distance is  tensor(123.6381, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4887298047542572
distance x is tensor(115.6694, device='cuda:0')
benign distance is  tensor(115.6694, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20898568630218506
distance x is tensor(132.5713, device='cuda:0')
benign distance is  tensor(132.5713, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16101129353046417
distance x is tensor(137.0089, device='cuda:0')
benign distance is  tensor(137.0089, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.15945658087730408
distance x is tensor(132.8853, device='cuda:0')
benign distance is  tensor(132.8853, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.715297281742096
distance x is tensor(117.1958, device='cuda:0')
benign distance is  tensor(117.1958, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5722135901451111
distance x is tensor(118.8271, device='cuda:0')
benign distance is  tensor(118.8271, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.1917276382446289
distance x is tensor(119.5765, device='cuda:0')
benign distance is  tensor(119.5765, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.09978704154491425
distance x is tensor(130.3439, device='cuda:0')
benign distance is  tensor(130.3439, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2663981914520264
distance x is tensor(127.9572, device='cuda:0')
benign distance is  tensor(127.9572, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9477012753486633
distance x is tensor(135.4577, device='cuda:0')
benign distance is  tensor(135.4577, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4015201926231384
distance x is tensor(141.2988, device='cuda:0')
benign distance is  tensor(141.2988, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6452617645263672
distance x is tensor(125.1663, device='cuda:0')
benign distance is  tensor(125.1663, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6027752757072449
distance x is tensor(136.9634, device='cuda:0')
benign distance is  tensor(136.9634, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3071725368499756
distance x is tensor(139.0106, device='cuda:0')
benign distance is  tensor(139.0106, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6235580444335938
distance x is tensor(129.2580, device='cuda:0')
benign distance is  tensor(129.2580, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5048484802246094
distance x is tensor(134.7099, device='cuda:0')
benign distance is  tensor(134.7099, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9218419194221497
distance x is tensor(128.5048, device='cuda:0')
benign distance is  tensor(128.5048, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.36600160598754883
distance x is tensor(134.7612, device='cuda:0')
benign distance is  tensor(134.7612, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([588.6954, 554.4128, 585.4301, 513.3560, 511.9972, 596.3737, 534.1219,
        638.9562, 314.9393, 260.5740, 244.2564, 236.9270, 232.9728, 230.5852,
        228.8848, 227.8000, 227.1051, 226.4429, 225.9376, 225.5712],
       device='cuda:0')
sorted_norm is   tensor([225.5712, 225.9376, 226.4429, 227.1051, 227.8000, 228.8848, 230.5852,
        232.9728, 236.9270, 244.2564, 260.5740, 314.9393, 511.9972, 513.3560,
        534.1219, 554.4128, 585.4301, 588.6954, 596.3737, 638.9562],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  6,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 86.25% 

Test Accuracy: 85.36% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46174097061157227
distance x is tensor(122.8172, device='cuda:0')
benign distance is  tensor(122.8172, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7600420117378235
distance x is tensor(118.9897, device='cuda:0')
benign distance is  tensor(118.9897, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1337379664182663
distance x is tensor(128.7646, device='cuda:0')
benign distance is  tensor(128.7646, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6010996699333191
distance x is tensor(112.6186, device='cuda:0')
benign distance is  tensor(112.6186, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1499128341674805
distance x is tensor(112.6432, device='cuda:0')
benign distance is  tensor(112.6432, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5926588177680969
distance x is tensor(125.2564, device='cuda:0')
benign distance is  tensor(125.2564, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3312932550907135
distance x is tensor(108.5682, device='cuda:0')
benign distance is  tensor(108.5682, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39924556016921997
distance x is tensor(125.6672, device='cuda:0')
benign distance is  tensor(125.6672, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([586.7342, 577.6436, 608.0632, 538.1714, 522.2203, 597.9473, 504.8397,
        605.9470, 310.4648, 258.0463, 242.1759, 235.0394, 231.2780, 228.9607,
        227.2906, 226.2943, 225.5439, 224.9928, 224.4994, 224.1287, 712.0356,
        717.2685, 700.0076, 799.6292, 720.6404, 729.5963, 748.8246, 751.6921,
        672.9711, 707.8432, 628.3660, 662.3870, 685.2817, 632.8931, 684.1425,
        675.6351, 692.0632, 667.9221, 589.5574, 585.9677, 604.3508, 650.4437,
        635.0549, 667.4061], device='cuda:0')
sorted_norm is   tensor([224.1287, 224.4994, 224.9928, 225.5439, 226.2943, 227.2906, 228.9607,
        231.2780, 235.0394, 242.1759, 258.0463, 310.4648, 504.8397, 522.2203,
        538.1714, 577.6436, 585.9677, 586.7342, 589.5574, 597.9473, 604.3508,
        605.9470, 608.0632, 628.3660, 632.8931, 635.0549, 650.4437, 662.3870,
        667.4061, 667.9221, 672.9711, 675.6351, 684.1425, 685.2817, 692.0632,
        700.0076, 707.8432, 712.0356, 717.2685, 720.6404, 729.5963, 748.8246,
        751.6921, 799.6292], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  4,  3,  1, 39,  0,
        38,  5, 40,  7,  2, 30, 33, 42, 41, 31, 43, 37, 28, 35, 34, 32, 36],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.27% 

Test Accuracy: 87.17% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2397843301296234
distance x is tensor(109.1987, device='cuda:0')
benign distance is  tensor(109.1987, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8893375396728516
distance x is tensor(114.8410, device='cuda:0')
benign distance is  tensor(114.8410, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12867885828018188
distance x is tensor(119.9582, device='cuda:0')
benign distance is  tensor(119.9582, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9872238039970398
distance x is tensor(112.7431, device='cuda:0')
benign distance is  tensor(112.7431, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6584246754646301
distance x is tensor(97.1352, device='cuda:0')
benign distance is  tensor(97.1352, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1259567737579346
distance x is tensor(119.6148, device='cuda:0')
benign distance is  tensor(119.6148, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2019929438829422
distance x is tensor(111.0745, device='cuda:0')
benign distance is  tensor(111.0745, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.32397013902664185
distance x is tensor(108.3676, device='cuda:0')
benign distance is  tensor(108.3676, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.09514717757701874
distance x is tensor(132.6443, device='cuda:0')
benign distance is  tensor(132.6443, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.18632274866104126
distance x is tensor(136.7892, device='cuda:0')
benign distance is  tensor(136.7892, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.593973696231842
distance x is tensor(120.9842, device='cuda:0')
benign distance is  tensor(120.9842, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6837233901023865
distance x is tensor(127.2964, device='cuda:0')
benign distance is  tensor(127.2964, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29771438241004944
distance x is tensor(120.6117, device='cuda:0')
benign distance is  tensor(120.6117, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1504642516374588
distance x is tensor(130.8744, device='cuda:0')
benign distance is  tensor(130.8744, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3236076235771179
distance x is tensor(128.0410, device='cuda:0')
benign distance is  tensor(128.0410, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8062246441841125
distance x is tensor(119.8723, device='cuda:0')
benign distance is  tensor(119.8723, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.40050941705703735
distance x is tensor(121.6213, device='cuda:0')
benign distance is  tensor(121.6213, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7646313905715942
distance x is tensor(143.1953, device='cuda:0')
benign distance is  tensor(143.1953, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.332125186920166
distance x is tensor(123.7105, device='cuda:0')
benign distance is  tensor(123.7105, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4627917408943176
distance x is tensor(125.9974, device='cuda:0')
benign distance is  tensor(125.9974, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.31676751375198364
distance x is tensor(132.9453, device='cuda:0')
benign distance is  tensor(132.9453, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9258708953857422
distance x is tensor(127.0885, device='cuda:0')
benign distance is  tensor(127.0885, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5005066990852356
distance x is tensor(133.3737, device='cuda:0')
benign distance is  tensor(133.3737, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6200920939445496
distance x is tensor(130.1296, device='cuda:0')
benign distance is  tensor(130.1296, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.0882992222905159
distance x is tensor(129.2063, device='cuda:0')
benign distance is  tensor(129.2063, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.37690913677215576
distance x is tensor(138.2693, device='cuda:0')
benign distance is  tensor(138.2693, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.585319995880127
distance x is tensor(127.3867, device='cuda:0')
benign distance is  tensor(127.3867, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.49544134736061096
distance x is tensor(131.5354, device='cuda:0')
benign distance is  tensor(131.5354, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5614111423492432
distance x is tensor(136.8669, device='cuda:0')
benign distance is  tensor(136.8669, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.598781406879425
distance x is tensor(131.5368, device='cuda:0')
benign distance is  tensor(131.5368, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9781051874160767
distance x is tensor(144.7799, device='cuda:0')
benign distance is  tensor(144.7799, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.24270515143871307
distance x is tensor(136.2614, device='cuda:0')
benign distance is  tensor(136.2614, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([514.2539, 562.6177, 566.3131, 526.5101, 456.3692, 572.2291, 514.4462,
        527.7124, 310.7439, 256.8425, 240.2318, 233.1100, 229.1895, 226.7974,
        225.0992, 224.0069, 223.2374, 222.7217, 222.2672, 221.8472],
       device='cuda:0')
sorted_norm is   tensor([221.8472, 222.2672, 222.7217, 223.2374, 224.0069, 225.0992, 226.7974,
        229.1895, 233.1100, 240.2318, 256.8425, 310.7439, 456.3692, 514.2539,
        514.4462, 526.5101, 527.7124, 562.6177, 566.3131, 572.2291],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  0,  6,  3],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 87.02% 

Test Accuracy: 85.81% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.21089744567871094
distance x is tensor(104.1493, device='cuda:0')
benign distance is  tensor(104.1493, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0070781707763672
distance x is tensor(122.9187, device='cuda:0')
benign distance is  tensor(122.9187, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.598601758480072
distance x is tensor(123.8863, device='cuda:0')
benign distance is  tensor(123.8863, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5230189561843872
distance x is tensor(110.1746, device='cuda:0')
benign distance is  tensor(110.1746, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3293341100215912
distance x is tensor(112.9110, device='cuda:0')
benign distance is  tensor(112.9110, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1421504020690918
distance x is tensor(123.1760, device='cuda:0')
benign distance is  tensor(123.1760, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1386239528656006
distance x is tensor(116.6160, device='cuda:0')
benign distance is  tensor(116.6160, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.25113826990127563
distance x is tensor(130.3993, device='cuda:0')
benign distance is  tensor(130.3993, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([484.9259, 595.4875, 573.7764, 517.2267, 538.5370, 587.4203, 548.9976,
        629.6417, 308.4984, 255.9618, 240.0481, 233.1382, 229.2827, 226.9974,
        225.3290, 224.3027, 223.4628, 222.8606, 222.3275, 221.8570, 715.1284,
        688.8023, 738.4356, 733.2886, 698.7122, 656.0065, 693.2057, 663.1018,
        716.1453, 645.3135, 718.0387, 709.2971, 683.9583, 695.3091, 676.6905,
        706.3959, 664.9568, 678.8915, 607.5592, 629.9901, 602.7865, 648.5758,
        627.8084, 603.6500], device='cuda:0')
sorted_norm is   tensor([221.8570, 222.3275, 222.8606, 223.4628, 224.3027, 225.3290, 226.9974,
        229.2827, 233.1382, 240.0481, 255.9618, 308.4984, 484.9259, 517.2267,
        538.5370, 548.9976, 573.7764, 587.4203, 595.4875, 602.7865, 603.6500,
        607.5592, 627.8084, 629.6417, 629.9901, 645.3135, 648.5758, 656.0065,
        663.1018, 664.9568, 676.6905, 678.8915, 683.9583, 688.8023, 693.2057,
        695.3091, 698.7122, 706.3959, 709.2971, 715.1284, 716.1453, 718.0387,
        733.2886, 738.4356], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  0,  3,  4,  6,  2,  5,
         1, 40, 43, 38, 42,  7, 39, 29, 41, 25, 27, 36, 34, 37, 32, 21, 26],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.35% 

Test Accuracy: 87.32% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2314259111881256
distance x is tensor(106.4697, device='cuda:0')
benign distance is  tensor(106.4697, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38285645842552185
distance x is tensor(110.0918, device='cuda:0')
benign distance is  tensor(110.0918, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1910887062549591
distance x is tensor(136.9714, device='cuda:0')
benign distance is  tensor(136.9714, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.617908239364624
distance x is tensor(113.1080, device='cuda:0')
benign distance is  tensor(113.1080, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.26935169100761414
distance x is tensor(108.2052, device='cuda:0')
benign distance is  tensor(108.2052, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5865257978439331
distance x is tensor(123.4515, device='cuda:0')
benign distance is  tensor(123.4515, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3150150775909424
distance x is tensor(107.1708, device='cuda:0')
benign distance is  tensor(107.1708, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23430588841438293
distance x is tensor(120.5080, device='cuda:0')
benign distance is  tensor(120.5080, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20654554665088654
distance x is tensor(140.6864, device='cuda:0')
benign distance is  tensor(140.6864, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5780166983604431
distance x is tensor(129.9863, device='cuda:0')
benign distance is  tensor(129.9863, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4854336380958557
distance x is tensor(132.5054, device='cuda:0')
benign distance is  tensor(132.5054, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.0216376781463623
distance x is tensor(124.0769, device='cuda:0')
benign distance is  tensor(124.0769, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6157140731811523
distance x is tensor(121.5487, device='cuda:0')
benign distance is  tensor(121.5487, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.08738058805465698
distance x is tensor(130.6262, device='cuda:0')
benign distance is  tensor(130.6262, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.07162545621395111
distance x is tensor(140.5647, device='cuda:0')
benign distance is  tensor(140.5647, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4846037030220032
distance x is tensor(133.6539, device='cuda:0')
benign distance is  tensor(133.6539, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2502778172492981
distance x is tensor(152.7731, device='cuda:0')
benign distance is  tensor(152.7731, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.341395616531372
distance x is tensor(125.7731, device='cuda:0')
benign distance is  tensor(125.7731, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.1693633794784546
distance x is tensor(148.0169, device='cuda:0')
benign distance is  tensor(148.0169, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0589898824691772
distance x is tensor(137.0430, device='cuda:0')
benign distance is  tensor(137.0430, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6178826689720154
distance x is tensor(129.5566, device='cuda:0')
benign distance is  tensor(129.5566, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.44341787695884705
distance x is tensor(135.3545, device='cuda:0')
benign distance is  tensor(135.3545, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8702855110168457
distance x is tensor(129.3734, device='cuda:0')
benign distance is  tensor(129.3734, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.516753613948822
distance x is tensor(131.0263, device='cuda:0')
benign distance is  tensor(131.0263, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.44937771558761597
distance x is tensor(136.8840, device='cuda:0')
benign distance is  tensor(136.8840, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10877706855535507
distance x is tensor(124.3465, device='cuda:0')
benign distance is  tensor(124.3465, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9777166247367859
distance x is tensor(134.3373, device='cuda:0')
benign distance is  tensor(134.3373, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3183906376361847
distance x is tensor(129.2404, device='cuda:0')
benign distance is  tensor(129.2404, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.33915868401527405
distance x is tensor(132.1742, device='cuda:0')
benign distance is  tensor(132.1742, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7453456521034241
distance x is tensor(130.7843, device='cuda:0')
benign distance is  tensor(130.7843, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.24207039177417755
distance x is tensor(124.2804, device='cuda:0')
benign distance is  tensor(124.2804, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3149970769882202
distance x is tensor(134.8736, device='cuda:0')
benign distance is  tensor(134.8736, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([509.2291, 527.8231, 641.6242, 525.6360, 480.7796, 589.8314, 512.3294,
        570.1242, 305.4431, 252.0232, 235.8495, 228.5771, 224.5546, 222.1006,
        220.5944, 219.4695, 218.6945, 218.0581, 217.6183, 217.1950, 597.0757,
        695.4274, 604.8748, 626.8390, 649.1099, 611.0300, 660.1220, 612.1286],
       device='cuda:0')
sorted_norm is   tensor([217.1950, 217.6183, 218.0581, 218.6945, 219.4695, 220.5944, 222.1006,
        224.5546, 228.5771, 235.8495, 252.0232, 305.4431, 480.7796, 509.2291,
        512.3294, 525.6360, 527.8231, 570.1242, 589.8314, 597.0757, 604.8748,
        611.0300, 612.1286, 626.8390, 641.6242, 649.1099, 660.1220, 695.4274],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  0,  6,  3,  1,  7,
         5, 20, 22, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.00% 

Test Accuracy: 87.01% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5015488862991333
distance x is tensor(110.1937, device='cuda:0')
benign distance is  tensor(110.1937, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36732882261276245
distance x is tensor(124.8107, device='cuda:0')
benign distance is  tensor(124.8107, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33767011761665344
distance x is tensor(124.9449, device='cuda:0')
benign distance is  tensor(124.9449, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8879830241203308
distance x is tensor(104.8145, device='cuda:0')
benign distance is  tensor(104.8145, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5281122922897339
distance x is tensor(112.3597, device='cuda:0')
benign distance is  tensor(112.3597, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.48212963342666626
distance x is tensor(128.8143, device='cuda:0')
benign distance is  tensor(128.8143, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.14879003167152405
distance x is tensor(106.4552, device='cuda:0')
benign distance is  tensor(106.4552, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.18147236108779907
distance x is tensor(118.0890, device='cuda:0')
benign distance is  tensor(118.0890, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3299546241760254
distance x is tensor(131.4939, device='cuda:0')
benign distance is  tensor(131.4939, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0247433185577393
distance x is tensor(145.8889, device='cuda:0')
benign distance is  tensor(145.8889, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4626252055168152
distance x is tensor(128.0806, device='cuda:0')
benign distance is  tensor(128.0806, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3445826470851898
distance x is tensor(130.8489, device='cuda:0')
benign distance is  tensor(130.8489, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5715643763542175
distance x is tensor(143.0454, device='cuda:0')
benign distance is  tensor(143.0454, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3058946132659912
distance x is tensor(126.6415, device='cuda:0')
benign distance is  tensor(126.6415, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3422118127346039
distance x is tensor(129.3794, device='cuda:0')
benign distance is  tensor(129.3794, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5765551328659058
distance x is tensor(136.9277, device='cuda:0')
benign distance is  tensor(136.9277, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([528.7570, 586.7402, 589.2955, 493.4409, 517.9096, 616.3350, 499.3737,
        561.4374, 304.2980, 251.4032, 235.3613, 228.0355, 224.2103, 221.6929,
        220.0889, 218.8936, 217.9456, 217.4341, 217.0171, 216.6374, 693.2867,
        641.1824, 642.3902, 588.6426, 594.5016, 616.4239, 684.8846, 638.4171],
       device='cuda:0')
sorted_norm is   tensor([216.6374, 217.0171, 217.4341, 217.9456, 218.8936, 220.0889, 221.6929,
        224.2103, 228.0355, 235.3613, 251.4032, 304.2980, 493.4409, 499.3737,
        517.9096, 528.7570, 561.4374, 586.7402, 588.6426, 589.2955, 594.5016,
        616.3350, 616.4239, 638.4171, 641.1824, 642.3902, 684.8846, 693.2867],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  6,  4,  0,  7,  1,
        23,  2, 24,  5], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 87.83% 

Test Accuracy: 86.84% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5520423650741577
distance x is tensor(106.6644, device='cuda:0')
benign distance is  tensor(106.6644, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6920461058616638
distance x is tensor(112.8769, device='cuda:0')
benign distance is  tensor(112.8769, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3298322558403015
distance x is tensor(123.8317, device='cuda:0')
benign distance is  tensor(123.8317, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8112419843673706
distance x is tensor(123.3697, device='cuda:0')
benign distance is  tensor(123.3697, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46495455503463745
distance x is tensor(107.0831, device='cuda:0')
benign distance is  tensor(107.0831, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.14482876658439636
distance x is tensor(121.5872, device='cuda:0')
benign distance is  tensor(121.5872, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2993696331977844
distance x is tensor(114.1245, device='cuda:0')
benign distance is  tensor(114.1245, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0016335248947144
distance x is tensor(127.2744, device='cuda:0')
benign distance is  tensor(127.2744, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9002653956413269
distance x is tensor(134.5185, device='cuda:0')
benign distance is  tensor(134.5185, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.44478529691696167
distance x is tensor(140.5840, device='cuda:0')
benign distance is  tensor(140.5840, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5104798078536987
distance x is tensor(132.1911, device='cuda:0')
benign distance is  tensor(132.1911, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7135278582572937
distance x is tensor(141.7461, device='cuda:0')
benign distance is  tensor(141.7461, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6312795281410217
distance x is tensor(133.6060, device='cuda:0')
benign distance is  tensor(133.6060, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23808252811431885
distance x is tensor(135.6173, device='cuda:0')
benign distance is  tensor(135.6173, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.940913200378418
distance x is tensor(130.2473, device='cuda:0')
benign distance is  tensor(130.2473, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7556992769241333
distance x is tensor(149.0866, device='cuda:0')
benign distance is  tensor(149.0866, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([513.0317, 541.6270, 585.3843, 577.1429, 518.6241, 578.3408, 530.5038,
        608.3164, 302.0896, 249.3723, 233.5087, 226.3306, 222.5811, 220.3160,
        218.8444, 217.9398, 217.1588, 216.4373, 215.9826, 215.5111],
       device='cuda:0')
sorted_norm is   tensor([215.5111, 215.9826, 216.4373, 217.1588, 217.9398, 218.8444, 220.3160,
        222.5811, 226.3306, 233.5087, 249.3723, 302.0896, 513.0317, 518.6241,
        530.5038, 541.6270, 577.1429, 578.3408, 585.3843, 608.3164],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  0,  4,  6,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 86.69% 

Test Accuracy: 85.57% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7395368814468384
distance x is tensor(137.1698, device='cuda:0')
benign distance is  tensor(137.1698, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1825970560312271
distance x is tensor(126.8487, device='cuda:0')
benign distance is  tensor(126.8487, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6102030277252197
distance x is tensor(143.3999, device='cuda:0')
benign distance is  tensor(143.3999, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8904086947441101
distance x is tensor(136.3061, device='cuda:0')
benign distance is  tensor(136.3061, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.45011863112449646
distance x is tensor(124.7764, device='cuda:0')
benign distance is  tensor(124.7764, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7795072197914124
distance x is tensor(133.4596, device='cuda:0')
benign distance is  tensor(133.4596, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1977040022611618
distance x is tensor(131.8074, device='cuda:0')
benign distance is  tensor(131.8074, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6484733819961548
distance x is tensor(126.8422, device='cuda:0')
benign distance is  tensor(126.8422, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([674.5440, 595.2169, 675.8723, 655.3378, 590.1423, 650.6351, 622.0309,
        605.9885, 299.7661, 248.3663, 233.0257, 225.8378, 222.1028, 219.8557,
        218.3306, 217.2031, 216.5939, 216.0021, 215.4913, 215.2130, 736.6155,
        764.4963, 718.4158, 733.1371, 753.4315, 738.1584, 793.6859, 771.2701,
        800.0227, 672.4113, 774.0984, 725.8030, 689.3882, 708.3651, 696.2361,
        704.3364, 678.9775, 728.5887, 659.3282, 682.4640, 727.8436, 671.4426,
        685.2523, 683.3958, 664.2505, 682.6960, 663.3412, 704.2061, 663.9156,
        668.2936, 655.5085, 721.1817], device='cuda:0')
sorted_norm is   tensor([215.2130, 215.4913, 216.0021, 216.5939, 217.2031, 218.3306, 219.8557,
        222.1028, 225.8378, 233.0257, 248.3663, 299.7661, 590.1423, 595.2169,
        605.9885, 622.0309, 650.6351, 655.3378, 655.5085, 659.3282, 663.3412,
        663.9156, 664.2505, 668.2936, 671.4426, 672.4113, 674.5440, 675.8723,
        678.9775, 682.4640, 682.6960, 683.3958, 685.2523, 689.3882, 696.2361,
        704.2061, 704.3364, 708.3651, 718.4158, 721.1817, 725.8030, 727.8436,
        728.5887, 733.1371, 736.6155, 738.1584, 753.4315, 764.4963, 771.2701,
        774.0984, 793.6859, 800.0227], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  1,  7,  6,  5,  3,
        50, 38, 46, 48, 44, 49, 41, 29,  0,  2, 36, 39, 45, 43, 42, 32, 34, 47,
        35, 33, 22, 51, 31], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.40% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.757290244102478
distance x is tensor(126.5938, device='cuda:0')
benign distance is  tensor(126.5938, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2784770131111145
distance x is tensor(122.6221, device='cuda:0')
benign distance is  tensor(122.6221, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23574864864349365
distance x is tensor(120.4961, device='cuda:0')
benign distance is  tensor(120.4961, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4288412630558014
distance x is tensor(107.5833, device='cuda:0')
benign distance is  tensor(107.5833, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6158755421638489
distance x is tensor(119.4911, device='cuda:0')
benign distance is  tensor(119.4911, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.217478632926941
distance x is tensor(117.1246, device='cuda:0')
benign distance is  tensor(117.1246, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.43950915336608887
distance x is tensor(121.8308, device='cuda:0')
benign distance is  tensor(121.8308, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9322254061698914
distance x is tensor(120.7386, device='cuda:0')
benign distance is  tensor(120.7386, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2990490198135376
distance x is tensor(140.8022, device='cuda:0')
benign distance is  tensor(140.8022, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.25857824087142944
distance x is tensor(136.3218, device='cuda:0')
benign distance is  tensor(136.3218, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4718945622444153
distance x is tensor(129.2561, device='cuda:0')
benign distance is  tensor(129.2561, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.998199462890625
distance x is tensor(131.3900, device='cuda:0')
benign distance is  tensor(131.3900, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3525795042514801
distance x is tensor(124.2134, device='cuda:0')
benign distance is  tensor(124.2134, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1593797206878662
distance x is tensor(140.1012, device='cuda:0')
benign distance is  tensor(140.1012, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3627147078514099
distance x is tensor(128.7291, device='cuda:0')
benign distance is  tensor(128.7291, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.034738540649414
distance x is tensor(134.0276, device='cuda:0')
benign distance is  tensor(134.0276, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2124396562576294
distance x is tensor(131.4871, device='cuda:0')
benign distance is  tensor(131.4871, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.504198431968689
distance x is tensor(152.2742, device='cuda:0')
benign distance is  tensor(152.2742, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7510422468185425
distance x is tensor(135.4878, device='cuda:0')
benign distance is  tensor(135.4878, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3859096169471741
distance x is tensor(124.3283, device='cuda:0')
benign distance is  tensor(124.3283, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12316384166479111
distance x is tensor(131.7471, device='cuda:0')
benign distance is  tensor(131.7471, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1735543012619019
distance x is tensor(124.2436, device='cuda:0')
benign distance is  tensor(124.2436, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.02966780588030815
distance x is tensor(142.7231, device='cuda:0')
benign distance is  tensor(142.7231, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8460147976875305
distance x is tensor(129.4688, device='cuda:0')
benign distance is  tensor(129.4688, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.35501664876937866
distance x is tensor(139.8793, device='cuda:0')
benign distance is  tensor(139.8793, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5191606283187866
distance x is tensor(130.5354, device='cuda:0')
benign distance is  tensor(130.5354, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5772420763969421
distance x is tensor(146.3334, device='cuda:0')
benign distance is  tensor(146.3334, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5358611941337585
distance x is tensor(140.2029, device='cuda:0')
benign distance is  tensor(140.2029, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.43927639722824097
distance x is tensor(135.6427, device='cuda:0')
benign distance is  tensor(135.6427, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.21672792732715607
distance x is tensor(134.7298, device='cuda:0')
benign distance is  tensor(134.7298, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.31782907247543335
distance x is tensor(126.0478, device='cuda:0')
benign distance is  tensor(126.0478, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4160032272338867
distance x is tensor(131.8831, device='cuda:0')
benign distance is  tensor(131.8831, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.48671627044677734
distance x is tensor(132.9676, device='cuda:0')
benign distance is  tensor(132.9676, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.20093639194965363
distance x is tensor(128.3106, device='cuda:0')
benign distance is  tensor(128.3106, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1331186443567276
distance x is tensor(129.0718, device='cuda:0')
benign distance is  tensor(129.0718, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.12990155816078186
distance x is tensor(136.4295, device='cuda:0')
benign distance is  tensor(136.4295, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.025264790281653404
distance x is tensor(129.8925, device='cuda:0')
benign distance is  tensor(129.8925, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.206665277481079
distance x is tensor(134.2711, device='cuda:0')
benign distance is  tensor(134.2711, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5682783722877502
distance x is tensor(144.9002, device='cuda:0')
benign distance is  tensor(144.9002, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.03898750990629196
distance x is tensor(138.9761, device='cuda:0')
benign distance is  tensor(138.9761, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([603.0932, 594.6484, 564.5001, 495.9803, 553.7811, 566.8583, 548.8849,
        572.0351, 298.0541, 245.9254, 229.9103, 222.9901, 218.8643, 216.4438,
        214.8890, 214.0241, 213.2242, 212.4897, 212.1070, 211.8568, 698.9484,
        639.7576, 681.8375, 655.0508, 664.2897, 643.9413, 633.4003, 674.7664],
       device='cuda:0')
sorted_norm is   tensor([211.8568, 212.1070, 212.4897, 213.2242, 214.0241, 214.8890, 216.4438,
        218.8643, 222.9901, 229.9103, 245.9254, 298.0541, 495.9803, 548.8849,
        553.7811, 564.5001, 566.8583, 572.0351, 594.6484, 603.0932, 633.4003,
        639.7576, 643.9413, 655.0508, 664.2897, 674.7664, 681.8375, 698.9484],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  6,  4,  2,  5,  7,
         1,  0, 26, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.20% 

Test Accuracy: 87.23% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46835198998451233
distance x is tensor(114.7419, device='cuda:0')
benign distance is  tensor(114.7419, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7964062094688416
distance x is tensor(112.2780, device='cuda:0')
benign distance is  tensor(112.2780, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17811065912246704
distance x is tensor(125.8727, device='cuda:0')
benign distance is  tensor(125.8727, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6216190457344055
distance x is tensor(115.5595, device='cuda:0')
benign distance is  tensor(115.5595, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9983066320419312
distance x is tensor(117.7013, device='cuda:0')
benign distance is  tensor(117.7013, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5662669539451599
distance x is tensor(131.9684, device='cuda:0')
benign distance is  tensor(131.9684, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.195733666419983
distance x is tensor(105.5844, device='cuda:0')
benign distance is  tensor(105.5844, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.952593982219696
distance x is tensor(139.6259, device='cuda:0')
benign distance is  tensor(139.6259, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.39257121086120605
distance x is tensor(149.5892, device='cuda:0')
benign distance is  tensor(149.5892, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.32925596833229065
distance x is tensor(135.3918, device='cuda:0')
benign distance is  tensor(135.3918, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4096764624118805
distance x is tensor(150.3926, device='cuda:0')
benign distance is  tensor(150.3926, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.7216269373893738
distance x is tensor(141.6819, device='cuda:0')
benign distance is  tensor(141.6819, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4327576160430908
distance x is tensor(139.6778, device='cuda:0')
benign distance is  tensor(139.6778, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6489216685295105
distance x is tensor(137.8827, device='cuda:0')
benign distance is  tensor(137.8827, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.2248923778533936
distance x is tensor(133.8723, device='cuda:0')
benign distance is  tensor(133.8723, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4057093560695648
distance x is tensor(135.8958, device='cuda:0')
benign distance is  tensor(135.8958, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([558.3565, 537.5062, 601.0818, 540.0286, 544.8694, 628.0582, 493.3540,
        657.8510, 298.0514, 246.1453, 230.0244, 222.9567, 219.1669, 216.8085,
        215.3602, 214.2467, 213.4246, 212.8490, 212.3698, 212.0329, 675.4799,
        665.7001, 621.1152, 631.4795, 596.0102, 671.9050, 623.7188, 642.2472],
       device='cuda:0')
sorted_norm is   tensor([212.0329, 212.3698, 212.8490, 213.4246, 214.2467, 215.3602, 216.8085,
        219.1669, 222.9567, 230.0244, 246.1453, 298.0514, 493.3540, 537.5062,
        540.0286, 544.8694, 558.3565, 596.0102, 601.0818, 621.1152, 623.7188,
        628.0582, 631.4795, 642.2472, 657.8510, 665.7001, 671.9050, 675.4799],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  1,  3,  4,  0, 24,
         2, 22, 26,  5], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.09% 

Test Accuracy: 86.89% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4277454912662506
distance x is tensor(120.1726, device='cuda:0')
benign distance is  tensor(120.1726, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8885059356689453
distance x is tensor(125.9004, device='cuda:0')
benign distance is  tensor(125.9004, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6970795392990112
distance x is tensor(126.9228, device='cuda:0')
benign distance is  tensor(126.9228, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1322314739227295
distance x is tensor(115.2189, device='cuda:0')
benign distance is  tensor(115.2189, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9809786081314087
distance x is tensor(120.8822, device='cuda:0')
benign distance is  tensor(120.8822, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3446218967437744
distance x is tensor(123.4998, device='cuda:0')
benign distance is  tensor(123.4998, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2180631160736084
distance x is tensor(124.6652, device='cuda:0')
benign distance is  tensor(124.6652, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.123658299446106
distance x is tensor(142.6965, device='cuda:0')
benign distance is  tensor(142.6965, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5975347757339478
distance x is tensor(131.1736, device='cuda:0')
benign distance is  tensor(131.1736, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3075626492500305
distance x is tensor(145.9601, device='cuda:0')
benign distance is  tensor(145.9601, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7768598794937134
distance x is tensor(134.2911, device='cuda:0')
benign distance is  tensor(134.2911, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5620927810668945
distance x is tensor(132.4545, device='cuda:0')
benign distance is  tensor(132.4545, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7554787993431091
distance x is tensor(126.4350, device='cuda:0')
benign distance is  tensor(126.4350, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.21285474300384521
distance x is tensor(137.7132, device='cuda:0')
benign distance is  tensor(137.7132, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5482697486877441
distance x is tensor(135.6183, device='cuda:0')
benign distance is  tensor(135.6183, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.38248926401138306
distance x is tensor(144.8983, device='cuda:0')
benign distance is  tensor(144.8983, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([568.7388, 590.6489, 599.4109, 543.0222, 558.1736, 575.4345, 579.2121,
        672.9276, 296.9489, 245.0101, 229.0692, 222.1357, 218.3072, 216.0880,
        214.7231, 213.6324, 213.0565, 212.4524, 211.9588, 211.5981, 652.7328,
        742.5818, 666.1052, 608.3485, 640.9519, 622.6268, 697.2235, 637.2327],
       device='cuda:0')
sorted_norm is   tensor([211.5981, 211.9588, 212.4524, 213.0565, 213.6324, 214.7231, 216.0880,
        218.3072, 222.1357, 229.0692, 245.0101, 296.9489, 543.0222, 558.1736,
        568.7388, 575.4345, 579.2121, 590.6489, 599.4109, 608.3485, 622.6268,
        637.2327, 640.9519, 652.7328, 666.1052, 672.9276, 697.2235, 742.5818],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  4,  0,  5,  6,  1,
         2, 23, 25, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 87.98% 

Test Accuracy: 86.86% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4415762424468994
distance x is tensor(114.1270, device='cuda:0')
benign distance is  tensor(114.1270, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6119004487991333
distance x is tensor(123.3425, device='cuda:0')
benign distance is  tensor(123.3425, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07894051820039749
distance x is tensor(124.9372, device='cuda:0')
benign distance is  tensor(124.9372, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4708816111087799
distance x is tensor(111.1970, device='cuda:0')
benign distance is  tensor(111.1970, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.926478385925293
distance x is tensor(103.9767, device='cuda:0')
benign distance is  tensor(103.9767, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4666689932346344
distance x is tensor(128.8412, device='cuda:0')
benign distance is  tensor(128.8412, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35519281029701233
distance x is tensor(129.5504, device='cuda:0')
benign distance is  tensor(129.5504, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4444958567619324
distance x is tensor(118.8949, device='cuda:0')
benign distance is  tensor(118.8949, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4527124762535095
distance x is tensor(133.7250, device='cuda:0')
benign distance is  tensor(133.7250, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4742220938205719
distance x is tensor(148.9326, device='cuda:0')
benign distance is  tensor(148.9326, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1412571519613266
distance x is tensor(139.0791, device='cuda:0')
benign distance is  tensor(139.0791, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4580804705619812
distance x is tensor(130.3620, device='cuda:0')
benign distance is  tensor(130.3620, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.45590323209762573
distance x is tensor(144.5352, device='cuda:0')
benign distance is  tensor(144.5352, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9881402254104614
distance x is tensor(145.0230, device='cuda:0')
benign distance is  tensor(145.0230, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.327020525932312
distance x is tensor(136.4133, device='cuda:0')
benign distance is  tensor(136.4133, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7610180974006653
distance x is tensor(134.3106, device='cuda:0')
benign distance is  tensor(134.3106, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([547.3975, 590.6312, 586.9213, 522.9622, 479.0468, 622.2529, 599.4261,
        571.5709, 294.2514, 242.6814, 226.8428, 220.0264, 216.3889, 214.1059,
        212.5782, 211.3379, 210.5626, 210.0394, 209.6494, 209.2878, 708.2563,
        668.0651, 737.0092, 711.3011, 675.5601, 669.6761, 656.2197, 679.9203,
        636.6630, 695.3357, 632.7937, 639.9260, 601.2907, 664.7495, 648.2398,
        686.3290], device='cuda:0')
sorted_norm is   tensor([209.2878, 209.6494, 210.0394, 210.5626, 211.3379, 212.5782, 214.1059,
        216.3889, 220.0264, 226.8428, 242.6814, 294.2514, 479.0468, 522.9622,
        547.3975, 571.5709, 586.9213, 590.6312, 599.4261, 601.2907, 622.2529,
        632.7937, 636.6630, 639.9260, 648.2398, 656.2197, 664.7495, 668.0651,
        669.6761, 675.5601, 679.9203, 686.3290, 695.3357, 708.2563, 711.3011,
        737.0092], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  0,  7,  2,  1,
         6, 32,  5, 30, 28, 31, 34, 26, 33, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 88.14% 

Test Accuracy: 86.88% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5678738951683044
distance x is tensor(124.0721, device='cuda:0')
benign distance is  tensor(124.0721, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.27002424001693726
distance x is tensor(123.3677, device='cuda:0')
benign distance is  tensor(123.3677, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5644469261169434
distance x is tensor(126.9436, device='cuda:0')
benign distance is  tensor(126.9436, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8520981073379517
distance x is tensor(120.9614, device='cuda:0')
benign distance is  tensor(120.9614, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1113579273223877
distance x is tensor(108.4951, device='cuda:0')
benign distance is  tensor(108.4951, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7287341356277466
distance x is tensor(125.8277, device='cuda:0')
benign distance is  tensor(125.8277, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.05804111808538437
distance x is tensor(115.7733, device='cuda:0')
benign distance is  tensor(115.7733, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3140496611595154
distance x is tensor(132.2076, device='cuda:0')
benign distance is  tensor(132.2076, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5083035230636597
distance x is tensor(146.4812, device='cuda:0')
benign distance is  tensor(146.4812, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.22941653430461884
distance x is tensor(131.2179, device='cuda:0')
benign distance is  tensor(131.2179, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8260637521743774
distance x is tensor(136.3287, device='cuda:0')
benign distance is  tensor(136.3287, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5670052170753479
distance x is tensor(144.6423, device='cuda:0')
benign distance is  tensor(144.6423, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2597604990005493
distance x is tensor(138.3501, device='cuda:0')
benign distance is  tensor(138.3501, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19460150599479675
distance x is tensor(142.8136, device='cuda:0')
benign distance is  tensor(142.8136, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6063815951347351
distance x is tensor(134.8938, device='cuda:0')
benign distance is  tensor(134.8938, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6050280928611755
distance x is tensor(147.6226, device='cuda:0')
benign distance is  tensor(147.6226, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.13877417147159576
distance x is tensor(148.8139, device='cuda:0')
benign distance is  tensor(148.8139, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.821851372718811
distance x is tensor(130.0084, device='cuda:0')
benign distance is  tensor(130.0084, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8214632868766785
distance x is tensor(138.8453, device='cuda:0')
benign distance is  tensor(138.8453, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5443072319030762
distance x is tensor(144.3950, device='cuda:0')
benign distance is  tensor(144.3950, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8592126965522766
distance x is tensor(136.7311, device='cuda:0')
benign distance is  tensor(136.7311, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6843590140342712
distance x is tensor(143.7725, device='cuda:0')
benign distance is  tensor(143.7725, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4049663543701172
distance x is tensor(135.5455, device='cuda:0')
benign distance is  tensor(135.5455, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.29201871156692505
distance x is tensor(148.8718, device='cuda:0')
benign distance is  tensor(148.8718, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([573.5874, 596.3406, 587.1465, 552.0529, 524.1159, 596.8937, 528.4750,
        644.6923, 294.8544, 242.8967, 227.1285, 219.9707, 216.1240, 213.6084,
        212.1876, 211.1588, 210.3204, 209.7641, 209.3565, 208.9589],
       device='cuda:0')
sorted_norm is   tensor([208.9589, 209.3565, 209.7641, 210.3204, 211.1588, 212.1876, 213.6084,
        216.1240, 219.9707, 227.1285, 242.8967, 294.8544, 524.1159, 528.4750,
        552.0529, 573.5874, 587.1465, 596.3406, 596.8937, 644.6923],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  6,  3,  0],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 87.34% 

Test Accuracy: 86.17% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.14694368839263916
distance x is tensor(136.0936, device='cuda:0')
benign distance is  tensor(136.0936, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6550562977790833
distance x is tensor(120.5603, device='cuda:0')
benign distance is  tensor(120.5603, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08514100313186646
distance x is tensor(138.4003, device='cuda:0')
benign distance is  tensor(138.4003, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9692831039428711
distance x is tensor(123.6009, device='cuda:0')
benign distance is  tensor(123.6009, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0920913219451904
distance x is tensor(111.2895, device='cuda:0')
benign distance is  tensor(111.2895, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5926440954208374
distance x is tensor(128.8912, device='cuda:0')
benign distance is  tensor(128.8912, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9670531153678894
distance x is tensor(130.2659, device='cuda:0')
benign distance is  tensor(130.2659, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9917352795600891
distance x is tensor(134.8363, device='cuda:0')
benign distance is  tensor(134.8363, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([638.7866, 572.1103, 644.3121, 566.8962, 531.3580, 596.1653, 605.5792,
        640.4550, 291.9434, 240.9202, 225.6603, 219.0910, 215.3521, 213.1233,
        211.5993, 210.7301, 209.9863, 209.4133, 209.0040, 208.6556, 743.7017,
        715.4048, 725.8568, 770.9474, 734.9485, 734.9316, 781.1312, 773.7900,
        779.1754, 726.6531, 790.7975, 761.7029, 740.8814, 726.8515, 709.0802,
        713.9736, 662.5391, 746.1124, 687.1086, 674.5217, 716.4092, 718.2316,
        675.6943, 664.7098, 719.2015, 648.5770, 667.8994, 703.8993, 672.4376,
        692.5640, 661.1837, 711.9773], device='cuda:0')
sorted_norm is   tensor([208.6556, 209.0040, 209.4133, 209.9863, 210.7301, 211.5993, 213.1233,
        215.3521, 219.0910, 225.6603, 240.9202, 291.9434, 531.3580, 566.8962,
        572.1103, 596.1653, 605.5792, 638.7866, 640.4550, 644.3121, 648.5770,
        661.1837, 662.5391, 664.7098, 667.8994, 672.4376, 674.5217, 675.6943,
        687.1086, 692.5640, 703.8993, 709.0802, 711.9773, 713.9736, 715.4048,
        716.4092, 718.2316, 719.2015, 725.8568, 726.6531, 726.8515, 734.9316,
        734.9485, 740.8814, 743.7017, 746.1124, 761.7029, 770.9474, 773.7900,
        779.1754, 781.1312, 790.7975], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  1,  5,  6,  0,
         7,  2, 45, 50, 36, 43, 46, 48, 39, 42, 38, 49, 47, 34, 51, 35, 21, 40,
        41, 44, 22, 29, 33], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 88.18% 

Test Accuracy: 87.10% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.15441904962062836
distance x is tensor(128.9813, device='cuda:0')
benign distance is  tensor(128.9813, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6201891899108887
distance x is tensor(124.5085, device='cuda:0')
benign distance is  tensor(124.5085, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.436021089553833
distance x is tensor(125.4208, device='cuda:0')
benign distance is  tensor(125.4208, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8595714569091797
distance x is tensor(117.4046, device='cuda:0')
benign distance is  tensor(117.4046, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3282632827758789
distance x is tensor(100.0876, device='cuda:0')
benign distance is  tensor(100.0876, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8876371383666992
distance x is tensor(131.7821, device='cuda:0')
benign distance is  tensor(131.7821, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1024550199508667
distance x is tensor(98.2029, device='cuda:0')
benign distance is  tensor(98.2029, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7755017876625061
distance x is tensor(127.3431, device='cuda:0')
benign distance is  tensor(127.3431, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5886381268501282
distance x is tensor(144.8376, device='cuda:0')
benign distance is  tensor(144.8376, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7107443809509277
distance x is tensor(151.0654, device='cuda:0')
benign distance is  tensor(151.0654, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0759590864181519
distance x is tensor(139.6852, device='cuda:0')
benign distance is  tensor(139.6852, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0037132501602173
distance x is tensor(145.8630, device='cuda:0')
benign distance is  tensor(145.8630, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4416268467903137
distance x is tensor(138.2277, device='cuda:0')
benign distance is  tensor(138.2277, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.32935285568237305
distance x is tensor(120.1524, device='cuda:0')
benign distance is  tensor(120.1524, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.30631938576698303
distance x is tensor(132.7126, device='cuda:0')
benign distance is  tensor(132.7126, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3957185745239258
distance x is tensor(146.1928, device='cuda:0')
benign distance is  tensor(146.1928, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.22958466410636902
distance x is tensor(125.3670, device='cuda:0')
benign distance is  tensor(125.3670, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.51557856798172
distance x is tensor(147.5524, device='cuda:0')
benign distance is  tensor(147.5524, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.34117454290390015
distance x is tensor(142.2563, device='cuda:0')
benign distance is  tensor(142.2563, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.261008083820343
distance x is tensor(129.0201, device='cuda:0')
benign distance is  tensor(129.0201, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.38259828090667725
distance x is tensor(146.6427, device='cuda:0')
benign distance is  tensor(146.6427, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.091618776321411
distance x is tensor(133.3873, device='cuda:0')
benign distance is  tensor(133.3873, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.11027860641479492
distance x is tensor(135.7688, device='cuda:0')
benign distance is  tensor(135.7688, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.690434455871582
distance x is tensor(130.0618, device='cuda:0')
benign distance is  tensor(130.0618, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.15482915937900543
distance x is tensor(146.8205, device='cuda:0')
benign distance is  tensor(146.8205, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09016420692205429
distance x is tensor(124.9932, device='cuda:0')
benign distance is  tensor(124.9932, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8447648882865906
distance x is tensor(142.1308, device='cuda:0')
benign distance is  tensor(142.1308, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.46406883001327515
distance x is tensor(132.9553, device='cuda:0')
benign distance is  tensor(132.9553, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2454279363155365
distance x is tensor(128.3262, device='cuda:0')
benign distance is  tensor(128.3262, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4390769898891449
distance x is tensor(134.3644, device='cuda:0')
benign distance is  tensor(134.3644, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3685327172279358
distance x is tensor(139.1698, device='cuda:0')
benign distance is  tensor(139.1698, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2873784899711609
distance x is tensor(127.1113, device='cuda:0')
benign distance is  tensor(127.1113, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1605919599533081
distance x is tensor(138.6553, device='cuda:0')
benign distance is  tensor(138.6553, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5343087315559387
distance x is tensor(138.9709, device='cuda:0')
benign distance is  tensor(138.9709, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08312426507472992
distance x is tensor(145.4838, device='cuda:0')
benign distance is  tensor(145.4838, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3325304687023163
distance x is tensor(142.2886, device='cuda:0')
benign distance is  tensor(142.2886, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3642491400241852
distance x is tensor(137.2939, device='cuda:0')
benign distance is  tensor(137.2939, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6447779536247253
distance x is tensor(130.1774, device='cuda:0')
benign distance is  tensor(130.1774, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.60980224609375
distance x is tensor(141.2498, device='cuda:0')
benign distance is  tensor(141.2498, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4158424437046051
distance x is tensor(137.0152, device='cuda:0')
benign distance is  tensor(137.0152, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([597.7828, 588.9482, 583.0541, 545.0243, 463.1890, 626.1274, 451.7610,
        597.9290, 291.7653, 240.3212, 224.5309, 217.3464, 213.5033, 211.2312,
        209.7951, 208.5800, 207.7451, 207.3121, 206.9131, 206.4595],
       device='cuda:0')
sorted_norm is   tensor([206.4595, 206.9131, 207.3121, 207.7451, 208.5800, 209.7951, 211.2312,
        213.5033, 217.3464, 224.5309, 240.3212, 291.7653, 451.7610, 463.1890,
        545.0243, 583.0541, 588.9482, 597.7828, 597.9290, 626.1274],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  4,  3,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 87.60% 

Test Accuracy: 86.34% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8405773043632507
distance x is tensor(128.8002, device='cuda:0')
benign distance is  tensor(128.8002, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.815015435218811
distance x is tensor(119.7872, device='cuda:0')
benign distance is  tensor(119.7872, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5358020067214966
distance x is tensor(134.7191, device='cuda:0')
benign distance is  tensor(134.7191, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8457050323486328
distance x is tensor(112.8132, device='cuda:0')
benign distance is  tensor(112.8132, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7525143623352051
distance x is tensor(110.6273, device='cuda:0')
benign distance is  tensor(110.6273, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6691383123397827
distance x is tensor(134.4019, device='cuda:0')
benign distance is  tensor(134.4019, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2071855068206787
distance x is tensor(129.7780, device='cuda:0')
benign distance is  tensor(129.7780, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7312239408493042
distance x is tensor(135.3683, device='cuda:0')
benign distance is  tensor(135.3683, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([600.2449, 565.7233, 627.0366, 528.9507, 525.5022, 652.7645, 601.1981,
        649.9814, 290.6182, 239.7005, 224.0803, 217.3677, 213.5838, 211.2676,
        209.8050, 208.6788, 208.0571, 207.5361, 207.0524, 206.7498, 727.6817,
        657.0215, 684.5776, 716.3179, 683.1585, 710.4971, 684.4002, 739.6174,
        706.2507, 739.6541, 682.8569, 702.4277, 671.3584, 587.9885, 649.2708,
        705.5805], device='cuda:0')
sorted_norm is   tensor([206.7498, 207.0524, 207.5361, 208.0571, 208.6788, 209.8050, 211.2676,
        213.5838, 217.3677, 224.0803, 239.7005, 290.6182, 525.5022, 528.9507,
        565.7233, 587.9885, 600.2449, 601.1981, 627.0366, 649.2708, 649.9814,
        652.7645, 657.0215, 671.3584, 682.8569, 683.1585, 684.4002, 684.5776,
        702.4277, 705.5805, 706.2507, 710.4971, 716.3179, 727.6817, 739.6174,
        739.6541], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  1, 33,  0,  6,
         2, 34,  7,  5, 21, 32, 30, 24, 26, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 87.99% 

Test Accuracy: 86.89% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5790144801139832
distance x is tensor(119.0962, device='cuda:0')
benign distance is  tensor(119.0962, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.15659314393997192
distance x is tensor(111.6773, device='cuda:0')
benign distance is  tensor(111.6773, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19844885170459747
distance x is tensor(126.3277, device='cuda:0')
benign distance is  tensor(126.3277, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5844258069992065
distance x is tensor(121.4509, device='cuda:0')
benign distance is  tensor(121.4509, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7779370546340942
distance x is tensor(112.2134, device='cuda:0')
benign distance is  tensor(112.2134, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5916509628295898
distance x is tensor(123.2193, device='cuda:0')
benign distance is  tensor(123.2193, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29785627126693726
distance x is tensor(121.5524, device='cuda:0')
benign distance is  tensor(121.5524, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6438910961151123
distance x is tensor(138.5371, device='cuda:0')
benign distance is  tensor(138.5371, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7977253198623657
distance x is tensor(156.0306, device='cuda:0')
benign distance is  tensor(156.0306, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2654575705528259
distance x is tensor(146.1594, device='cuda:0')
benign distance is  tensor(146.1594, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9361078143119812
distance x is tensor(125.1772, device='cuda:0')
benign distance is  tensor(125.1772, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5448853969573975
distance x is tensor(131.7472, device='cuda:0')
benign distance is  tensor(131.7472, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5895127058029175
distance x is tensor(131.4827, device='cuda:0')
benign distance is  tensor(131.4827, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.10533107817173004
distance x is tensor(132.5784, device='cuda:0')
benign distance is  tensor(132.5784, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.43090224266052246
distance x is tensor(134.2861, device='cuda:0')
benign distance is  tensor(134.2861, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.544640839099884
distance x is tensor(146.7152, device='cuda:0')
benign distance is  tensor(146.7152, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3279072642326355
distance x is tensor(146.0142, device='cuda:0')
benign distance is  tensor(146.0142, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6349743604660034
distance x is tensor(124.5167, device='cuda:0')
benign distance is  tensor(124.5167, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.0316319614648819
distance x is tensor(141.0688, device='cuda:0')
benign distance is  tensor(141.0688, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.067588210105896
distance x is tensor(137.4221, device='cuda:0')
benign distance is  tensor(137.4221, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5437167882919312
distance x is tensor(138.7745, device='cuda:0')
benign distance is  tensor(138.7745, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.36678197979927063
distance x is tensor(133.0697, device='cuda:0')
benign distance is  tensor(133.0697, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.46838560700416565
distance x is tensor(130.7069, device='cuda:0')
benign distance is  tensor(130.7069, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2877424955368042
distance x is tensor(131.4332, device='cuda:0')
benign distance is  tensor(131.4332, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([556.6746, 540.8658, 599.6171, 576.5929, 506.0646, 593.7701, 565.7581,
        662.1080, 289.9671, 238.8299, 223.5080, 216.5040, 212.8009, 210.6572,
        209.0978, 207.9179, 207.2066, 206.5871, 206.1298, 205.8655, 614.4018,
        733.0912, 691.4009, 644.7170, 702.7402, 646.7538, 682.3401, 630.7479],
       device='cuda:0')
sorted_norm is   tensor([205.8655, 206.1298, 206.5871, 207.2066, 207.9179, 209.0978, 210.6572,
        212.8009, 216.5040, 223.5080, 238.8299, 289.9671, 506.0646, 540.8658,
        556.6746, 565.7581, 576.5929, 593.7701, 599.6171, 614.4018, 630.7479,
        644.7170, 646.7538, 662.1080, 682.3401, 691.4009, 702.7402, 733.0912],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  1,  0,  6,  3,  5,
         2, 20, 27, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 87.97% 

Test Accuracy: 86.88% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7793616056442261
distance x is tensor(125.0373, device='cuda:0')
benign distance is  tensor(125.0373, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4054528772830963
distance x is tensor(141.9075, device='cuda:0')
benign distance is  tensor(141.9075, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03955609351396561
distance x is tensor(125.9352, device='cuda:0')
benign distance is  tensor(125.9352, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7211725115776062
distance x is tensor(112.8278, device='cuda:0')
benign distance is  tensor(112.8278, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.13091948628425598
distance x is tensor(102.7856, device='cuda:0')
benign distance is  tensor(102.7856, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8188819885253906
distance x is tensor(144.1525, device='cuda:0')
benign distance is  tensor(144.1525, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2051924169063568
distance x is tensor(127.1484, device='cuda:0')
benign distance is  tensor(127.1484, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.36203959584236145
distance x is tensor(128.8668, device='cuda:0')
benign distance is  tensor(128.8668, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2228008210659027
distance x is tensor(138.9000, device='cuda:0')
benign distance is  tensor(138.9000, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.27797120809555054
distance x is tensor(148.2533, device='cuda:0')
benign distance is  tensor(148.2533, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5251995921134949
distance x is tensor(139.8955, device='cuda:0')
benign distance is  tensor(139.8955, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.13699130713939667
distance x is tensor(147.2123, device='cuda:0')
benign distance is  tensor(147.2123, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.254802405834198
distance x is tensor(150.7731, device='cuda:0')
benign distance is  tensor(150.7731, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4204072952270508
distance x is tensor(134.6912, device='cuda:0')
benign distance is  tensor(134.6912, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.12017916142940521
distance x is tensor(151.6599, device='cuda:0')
benign distance is  tensor(151.6599, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.836072564125061
distance x is tensor(135.7489, device='cuda:0')
benign distance is  tensor(135.7489, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([595.3839, 675.9178, 589.1670, 516.2698, 484.9046, 670.6142, 584.9168,
        613.8689, 287.0077, 236.8065, 221.2478, 214.6712, 211.0407, 208.7748,
        207.3207, 206.1953, 205.4579, 204.9193, 204.3842, 204.1627, 724.7056,
        690.7089, 595.9847, 626.1370, 621.4574, 648.7952, 642.0191, 692.4865],
       device='cuda:0')
sorted_norm is   tensor([204.1627, 204.3842, 204.9193, 205.4579, 206.1953, 207.3207, 208.7748,
        211.0407, 214.6712, 221.2478, 236.8065, 287.0077, 484.9046, 516.2698,
        584.9168, 589.1670, 595.3839, 595.9847, 613.8689, 621.4574, 626.1370,
        642.0191, 648.7952, 670.6142, 675.9178, 690.7089, 692.4865, 724.7056],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  6,  2,  0, 22,
         7, 24, 23, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 87.92% 

Test Accuracy: 86.92% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3276987075805664
distance x is tensor(137.9016, device='cuda:0')
benign distance is  tensor(137.9016, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9856584668159485
distance x is tensor(124.1591, device='cuda:0')
benign distance is  tensor(124.1591, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20770752429962158
distance x is tensor(130.5644, device='cuda:0')
benign distance is  tensor(130.5644, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9514089822769165
distance x is tensor(123.0683, device='cuda:0')
benign distance is  tensor(123.0683, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0211520195007324
distance x is tensor(127.3929, device='cuda:0')
benign distance is  tensor(127.3929, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0280975103378296
distance x is tensor(123.6303, device='cuda:0')
benign distance is  tensor(123.6303, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3211222290992737
distance x is tensor(113.1065, device='cuda:0')
benign distance is  tensor(113.1065, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.427957534790039
distance x is tensor(127.3778, device='cuda:0')
benign distance is  tensor(127.3778, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4131365716457367
distance x is tensor(152.6300, device='cuda:0')
benign distance is  tensor(152.6300, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.23765011131763458
distance x is tensor(155.4031, device='cuda:0')
benign distance is  tensor(155.4031, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3261367082595825
distance x is tensor(132.3880, device='cuda:0')
benign distance is  tensor(132.3880, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7328013181686401
distance x is tensor(138.5483, device='cuda:0')
benign distance is  tensor(138.5483, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9932497143745422
distance x is tensor(129.3112, device='cuda:0')
benign distance is  tensor(129.3112, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6046563982963562
distance x is tensor(147.4533, device='cuda:0')
benign distance is  tensor(147.4533, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.23351606726646423
distance x is tensor(133.6185, device='cuda:0')
benign distance is  tensor(133.6185, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0522562265396118
distance x is tensor(150.0041, device='cuda:0')
benign distance is  tensor(150.0041, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([652.3760, 577.0464, 608.7092, 593.7819, 601.1040, 587.5283, 529.0778,
        602.6041, 287.1479, 236.6265, 221.3397, 214.7531, 211.0002, 208.8260,
        207.3253, 206.4017, 205.6912, 205.0582, 204.5580, 204.3506, 754.4261,
        683.4873, 744.5400, 695.8157, 695.0549, 694.5781, 735.1322, 668.3123],
       device='cuda:0')
sorted_norm is   tensor([204.3506, 204.5580, 205.0582, 205.6912, 206.4017, 207.3253, 208.8260,
        211.0002, 214.7531, 221.3397, 236.6265, 287.1479, 529.0778, 577.0464,
        587.5283, 593.7819, 601.1040, 602.6041, 608.7092, 652.3760, 668.3123,
        683.4873, 694.5781, 695.0549, 695.8157, 735.1322, 744.5400, 754.4261],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  1,  5,  3,  4,  7,
         2,  0, 27, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 87.66% 

Test Accuracy: 86.72% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.26444438099861145
distance x is tensor(131.8779, device='cuda:0')
benign distance is  tensor(131.8779, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1788991391658783
distance x is tensor(127.0303, device='cuda:0')
benign distance is  tensor(127.0303, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2869933843612671
distance x is tensor(133.9128, device='cuda:0')
benign distance is  tensor(133.9128, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1967189311981201
distance x is tensor(115.9093, device='cuda:0')
benign distance is  tensor(115.9093, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4588238596916199
distance x is tensor(93.0914, device='cuda:0')
benign distance is  tensor(93.0914, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.45265713334083557
distance x is tensor(128.7270, device='cuda:0')
benign distance is  tensor(128.7270, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7839599847793579
distance x is tensor(116.7413, device='cuda:0')
benign distance is  tensor(116.7413, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6463837623596191
distance x is tensor(141.7507, device='cuda:0')
benign distance is  tensor(141.7507, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4877510070800781
distance x is tensor(150.2254, device='cuda:0')
benign distance is  tensor(150.2254, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.26480358839035034
distance x is tensor(142.6051, device='cuda:0')
benign distance is  tensor(142.6051, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5614500045776367
distance x is tensor(148.1284, device='cuda:0')
benign distance is  tensor(148.1284, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.24579103291034698
distance x is tensor(140.1917, device='cuda:0')
benign distance is  tensor(140.1917, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.38576942682266235
distance x is tensor(135.0883, device='cuda:0')
benign distance is  tensor(135.0883, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.44862881302833557
distance x is tensor(131.8481, device='cuda:0')
benign distance is  tensor(131.8481, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.43025675415992737
distance x is tensor(134.0866, device='cuda:0')
benign distance is  tensor(134.0866, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3077569305896759
distance x is tensor(147.9864, device='cuda:0')
benign distance is  tensor(147.9864, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([612.6166, 603.0477, 624.4961, 542.7384, 422.7192, 613.0551, 544.4669,
        668.3331, 286.9038, 236.2812, 220.6743, 213.9394, 210.3192, 208.2188,
        206.7366, 205.7615, 204.9610, 204.3377, 203.9428, 203.5119, 744.6093,
        731.6983, 764.1157, 769.3614, 734.5089, 694.0329, 764.0253, 727.3631,
        735.5142, 654.7135, 712.7369, 691.7259, 702.1231, 668.1266, 664.6430,
        661.5199, 682.6989, 726.9666, 681.4733, 707.1904, 731.2507, 664.9021,
        741.6750, 646.3293, 722.3412, 733.3532, 627.0106, 672.9530, 625.0983,
        693.3987, 632.8372, 705.4146], device='cuda:0')
sorted_norm is   tensor([203.5119, 203.9428, 204.3377, 204.9610, 205.7615, 206.7366, 208.2188,
        210.3192, 213.9394, 220.6743, 236.2812, 286.9038, 422.7192, 542.7384,
        544.4669, 603.0477, 612.6166, 613.0551, 624.4961, 625.0983, 627.0106,
        632.8372, 646.3293, 654.7135, 661.5199, 664.6430, 664.9021, 668.1266,
        668.3331, 672.9530, 681.4733, 682.6989, 691.7259, 693.3987, 694.0329,
        702.1231, 705.4146, 707.1904, 712.7369, 722.3412, 726.9666, 727.3631,
        731.2507, 731.6983, 733.3532, 734.5089, 735.5142, 741.6750, 744.6093,
        764.0253, 764.1157, 769.3614], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  6,  1,  0,  5,
         2, 48, 46, 50, 43, 29, 35, 34, 41, 33,  7, 47, 38, 36, 31, 49, 25, 32,
        51, 39, 30, 44, 37], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 88.21% 

Test Accuracy: 87.45% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8748582601547241
distance x is tensor(114.0030, device='cuda:0')
benign distance is  tensor(114.0030, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46102848649024963
distance x is tensor(109.3523, device='cuda:0')
benign distance is  tensor(109.3523, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07355807721614838
distance x is tensor(131.0199, device='cuda:0')
benign distance is  tensor(131.0199, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6685090065002441
distance x is tensor(109.0296, device='cuda:0')
benign distance is  tensor(109.0296, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4350593090057373
distance x is tensor(96.7045, device='cuda:0')
benign distance is  tensor(96.7045, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.37551149725914
distance x is tensor(121.3003, device='cuda:0')
benign distance is  tensor(121.3003, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37783437967300415
distance x is tensor(122.4765, device='cuda:0')
benign distance is  tensor(122.4765, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4935525059700012
distance x is tensor(149.9374, device='cuda:0')
benign distance is  tensor(149.9374, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6646023988723755
distance x is tensor(156.9392, device='cuda:0')
benign distance is  tensor(156.9392, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8119053840637207
distance x is tensor(138.7335, device='cuda:0')
benign distance is  tensor(138.7335, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3005088567733765
distance x is tensor(135.7409, device='cuda:0')
benign distance is  tensor(135.7409, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2523397207260132
distance x is tensor(131.3452, device='cuda:0')
benign distance is  tensor(131.3452, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.849413275718689
distance x is tensor(122.3113, device='cuda:0')
benign distance is  tensor(122.3113, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3908018469810486
distance x is tensor(138.3693, device='cuda:0')
benign distance is  tensor(138.3693, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6498546004295349
distance x is tensor(137.5161, device='cuda:0')
benign distance is  tensor(137.5161, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7022470235824585
distance x is tensor(134.2975, device='cuda:0')
benign distance is  tensor(134.2975, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4342971742153168
distance x is tensor(128.9318, device='cuda:0')
benign distance is  tensor(128.9318, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5227234363555908
distance x is tensor(153.2428, device='cuda:0')
benign distance is  tensor(153.2428, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.14351429045200348
distance x is tensor(144.0808, device='cuda:0')
benign distance is  tensor(144.0808, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.48331689834594727
distance x is tensor(136.1488, device='cuda:0')
benign distance is  tensor(136.1488, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.17362435162067413
distance x is tensor(135.6678, device='cuda:0')
benign distance is  tensor(135.6678, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7860897183418274
distance x is tensor(128.8248, device='cuda:0')
benign distance is  tensor(128.8248, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.18437668681144714
distance x is tensor(139.2047, device='cuda:0')
benign distance is  tensor(139.2047, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5905805826187134
distance x is tensor(139.5910, device='cuda:0')
benign distance is  tensor(139.5910, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.561629056930542
distance x is tensor(143.5519, device='cuda:0')
benign distance is  tensor(143.5519, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2775611877441406
distance x is tensor(128.9510, device='cuda:0')
benign distance is  tensor(128.9510, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3196444809436798
distance x is tensor(158.5046, device='cuda:0')
benign distance is  tensor(158.5046, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.09746121615171432
distance x is tensor(156.7416, device='cuda:0')
benign distance is  tensor(156.7416, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9629800915718079
distance x is tensor(132.8201, device='cuda:0')
benign distance is  tensor(132.8201, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6770230531692505
distance x is tensor(142.5649, device='cuda:0')
benign distance is  tensor(142.5649, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.20584192872047424
distance x is tensor(131.6514, device='cuda:0')
benign distance is  tensor(131.6514, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.14806723594665527
distance x is tensor(142.5831, device='cuda:0')
benign distance is  tensor(142.5831, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4557828903198242
distance x is tensor(144.7444, device='cuda:0')
benign distance is  tensor(144.7444, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.44844356179237366
distance x is tensor(134.8683, device='cuda:0')
benign distance is  tensor(134.8683, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2227364480495453
distance x is tensor(144.8157, device='cuda:0')
benign distance is  tensor(144.8157, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5626891851425171
distance x is tensor(140.2084, device='cuda:0')
benign distance is  tensor(140.2084, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5524227023124695
distance x is tensor(136.4158, device='cuda:0')
benign distance is  tensor(136.4158, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4501057267189026
distance x is tensor(139.9262, device='cuda:0')
benign distance is  tensor(139.9262, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.380026251077652
distance x is tensor(145.9343, device='cuda:0')
benign distance is  tensor(145.9343, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.25588974356651306
distance x is tensor(136.3605, device='cuda:0')
benign distance is  tensor(136.3605, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([537.9564, 513.2320, 616.7875, 504.7251, 449.5810, 561.5250, 574.2699,
        684.6556, 285.0564, 234.2288, 218.9629, 212.1106, 208.3535, 206.0345,
        204.3995, 203.3082, 202.6316, 202.0131, 201.6160, 201.2342],
       device='cuda:0')
sorted_norm is   tensor([201.2342, 201.6160, 202.0131, 202.6316, 203.3082, 204.3995, 206.0345,
        208.3535, 212.1106, 218.9629, 234.2288, 285.0564, 449.5810, 504.7251,
        513.2320, 537.9564, 561.5250, 574.2699, 616.7875, 684.6556],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  1,  0],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 87.75% 

Test Accuracy: 86.74% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6438435912132263
distance x is tensor(115.9713, device='cuda:0')
benign distance is  tensor(115.9713, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.19056856632232666
distance x is tensor(130.4258, device='cuda:0')
benign distance is  tensor(130.4258, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2561594843864441
distance x is tensor(146.8549, device='cuda:0')
benign distance is  tensor(146.8549, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9282838106155396
distance x is tensor(107.7265, device='cuda:0')
benign distance is  tensor(107.7265, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0852361917495728
distance x is tensor(124.8073, device='cuda:0')
benign distance is  tensor(124.8073, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42503443360328674
distance x is tensor(138.6543, device='cuda:0')
benign distance is  tensor(138.6543, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.667009711265564
distance x is tensor(117.4082, device='cuda:0')
benign distance is  tensor(117.4082, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39448851346969604
distance x is tensor(133.1633, device='cuda:0')
benign distance is  tensor(133.1633, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([541.1775, 625.7849, 687.4827, 500.0278, 586.6025, 647.8073, 542.7455,
        624.3351, 283.0843, 232.9041, 217.5285, 210.9746, 207.3952, 205.2509,
        203.6775, 202.6234, 201.8490, 201.2732, 200.8042, 200.6087, 744.6171,
        663.2834, 648.1074, 629.9377, 600.8550, 669.0130, 661.4558, 654.0237],
       device='cuda:0')
sorted_norm is   tensor([200.6087, 200.8042, 201.2732, 201.8490, 202.6234, 203.6775, 205.2509,
        207.3952, 210.9746, 217.5285, 232.9041, 283.0843, 500.0278, 541.1775,
        542.7455, 586.6025, 600.8550, 624.3351, 625.7849, 629.9377, 647.8073,
        648.1074, 654.0237, 661.4558, 663.2834, 669.0130, 687.4827, 744.6171],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  0,  6,  4, 24,  7,
         1, 23,  5, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 87.62% 

Test Accuracy: 86.70% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4566882252693176
distance x is tensor(147.4592, device='cuda:0')
benign distance is  tensor(147.4592, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7985423803329468
distance x is tensor(137.8951, device='cuda:0')
benign distance is  tensor(137.8951, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10887160152196884
distance x is tensor(142.8955, device='cuda:0')
benign distance is  tensor(142.8955, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5322784185409546
distance x is tensor(109.7625, device='cuda:0')
benign distance is  tensor(109.7625, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.22071954607963562
distance x is tensor(113.8008, device='cuda:0')
benign distance is  tensor(113.8008, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5890823602676392
distance x is tensor(118.7049, device='cuda:0')
benign distance is  tensor(118.7049, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2766123116016388
distance x is tensor(123.9991, device='cuda:0')
benign distance is  tensor(123.9991, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6918386220932007
distance x is tensor(123.1105, device='cuda:0')
benign distance is  tensor(123.1105, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.39199304580688477
distance x is tensor(143.9885, device='cuda:0')
benign distance is  tensor(143.9885, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7713255882263184
distance x is tensor(150.8654, device='cuda:0')
benign distance is  tensor(150.8654, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8991534113883972
distance x is tensor(135.2635, device='cuda:0')
benign distance is  tensor(135.2635, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.26212888956069946
distance x is tensor(138.0410, device='cuda:0')
benign distance is  tensor(138.0410, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4967789053916931
distance x is tensor(130.7648, device='cuda:0')
benign distance is  tensor(130.7648, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2478552609682083
distance x is tensor(145.4740, device='cuda:0')
benign distance is  tensor(145.4740, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5131579637527466
distance x is tensor(137.9499, device='cuda:0')
benign distance is  tensor(137.9499, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.27708977460861206
distance x is tensor(151.2222, device='cuda:0')
benign distance is  tensor(151.2222, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([685.5341, 649.9545, 658.2764, 515.7377, 529.1372, 565.1669, 569.9800,
        570.7419, 283.3532, 233.4460, 218.2793, 211.5827, 207.9927, 205.7455,
        204.2901, 203.2966, 202.5502, 202.1208, 201.5890, 201.2460, 636.0096,
        758.6325, 698.9424, 679.1570, 683.0693, 646.2757, 695.7576, 676.9492],
       device='cuda:0')
sorted_norm is   tensor([201.2460, 201.5890, 202.1208, 202.5502, 203.2966, 204.2901, 205.7455,
        207.9927, 211.5827, 218.2793, 233.4460, 283.3532, 515.7377, 529.1372,
        565.1669, 569.9800, 570.7419, 636.0096, 646.2757, 649.9545, 658.2764,
        676.9492, 679.1570, 683.0693, 685.5341, 695.7576, 698.9424, 758.6325],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  4,  5,  6,  7, 20,
        25,  1,  2, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 87.70% 

Test Accuracy: 86.65% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5454263687133789
distance x is tensor(100.6717, device='cuda:0')
benign distance is  tensor(100.6717, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6123033165931702
distance x is tensor(117.9376, device='cuda:0')
benign distance is  tensor(117.9376, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17383575439453125
distance x is tensor(132.6041, device='cuda:0')
benign distance is  tensor(132.6041, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8941287994384766
distance x is tensor(115.0330, device='cuda:0')
benign distance is  tensor(115.0330, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6720287203788757
distance x is tensor(117.6160, device='cuda:0')
benign distance is  tensor(117.6160, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8282507658004761
distance x is tensor(145.3396, device='cuda:0')
benign distance is  tensor(145.3396, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4000040590763092
distance x is tensor(121.7140, device='cuda:0')
benign distance is  tensor(121.7140, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.32236671447753906
distance x is tensor(129.5597, device='cuda:0')
benign distance is  tensor(129.5597, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.38910216093063354
distance x is tensor(143.7435, device='cuda:0')
benign distance is  tensor(143.7435, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4075544774532318
distance x is tensor(154.4678, device='cuda:0')
benign distance is  tensor(154.4678, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1217595562338829
distance x is tensor(147.9708, device='cuda:0')
benign distance is  tensor(147.9708, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.30801063776016235
distance x is tensor(146.6843, device='cuda:0')
benign distance is  tensor(146.6843, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3028985857963562
distance x is tensor(145.2896, device='cuda:0')
benign distance is  tensor(145.2896, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3271893262863159
distance x is tensor(148.1928, device='cuda:0')
benign distance is  tensor(148.1928, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7316409349441528
distance x is tensor(155.9560, device='cuda:0')
benign distance is  tensor(155.9560, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.128595232963562
distance x is tensor(142.7789, device='cuda:0')
benign distance is  tensor(142.7789, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([485.2474, 557.3945, 615.9489, 528.0586, 548.7286, 659.1586, 559.9265,
        611.6594, 283.7133, 233.9102, 218.4297, 211.7419, 208.0572, 205.8250,
        204.3950, 203.4197, 202.7250, 202.2364, 201.5977, 201.2400, 757.6558,
        729.9449, 745.2358, 691.0583, 695.1071, 667.5570, 670.2340, 734.0009,
        729.3950, 657.5333, 784.7626, 767.7903, 677.3462, 719.1619, 664.8595,
        720.0570, 687.9269, 705.9011, 655.6715, 657.3950, 629.8429, 699.4044,
        668.5281, 712.9151], device='cuda:0')
sorted_norm is   tensor([201.2400, 201.5977, 202.2364, 202.7250, 203.4197, 204.3950, 205.8250,
        208.0572, 211.7419, 218.4297, 233.9102, 283.7133, 485.2474, 528.0586,
        548.7286, 557.3945, 559.9265, 611.6594, 615.9489, 629.8429, 655.6715,
        657.3950, 657.5333, 659.1586, 664.8595, 667.5570, 668.5281, 670.2340,
        677.3462, 687.9269, 691.0583, 695.1071, 699.4044, 705.9011, 712.9151,
        719.1619, 720.0570, 729.3950, 729.9449, 734.0009, 745.2358, 757.6558,
        767.7903, 784.7626], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  0,  3,  4,  1,  6,  7,
         2, 40, 38, 39, 29,  5, 34, 25, 42, 26, 32, 36, 23, 24, 41, 37, 43],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 87.98% 

Test Accuracy: 87.24% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5101861953735352
distance x is tensor(135.6487, device='cuda:0')
benign distance is  tensor(135.6487, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1752179861068726
distance x is tensor(125.9970, device='cuda:0')
benign distance is  tensor(125.9970, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.227742001414299
distance x is tensor(139.2116, device='cuda:0')
benign distance is  tensor(139.2116, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0129724740982056
distance x is tensor(113.3589, device='cuda:0')
benign distance is  tensor(113.3589, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3357425332069397
distance x is tensor(129.2646, device='cuda:0')
benign distance is  tensor(129.2646, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1843793392181396
distance x is tensor(113.8299, device='cuda:0')
benign distance is  tensor(113.8299, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6527222990989685
distance x is tensor(108.8342, device='cuda:0')
benign distance is  tensor(108.8342, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30538415908813477
distance x is tensor(140.4265, device='cuda:0')
benign distance is  tensor(140.4265, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3762689232826233
distance x is tensor(141.4871, device='cuda:0')
benign distance is  tensor(141.4871, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.40069007873535156
distance x is tensor(148.7880, device='cuda:0')
benign distance is  tensor(148.7880, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5392351746559143
distance x is tensor(132.7021, device='cuda:0')
benign distance is  tensor(132.7021, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7237640023231506
distance x is tensor(130.6707, device='cuda:0')
benign distance is  tensor(130.6707, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5993265509605408
distance x is tensor(124.5462, device='cuda:0')
benign distance is  tensor(124.5462, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.28049710392951965
distance x is tensor(139.3653, device='cuda:0')
benign distance is  tensor(139.3653, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4239865243434906
distance x is tensor(127.4190, device='cuda:0')
benign distance is  tensor(127.4190, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8657941818237305
distance x is tensor(161.0472, device='cuda:0')
benign distance is  tensor(161.0472, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.18910832703113556
distance x is tensor(150.1624, device='cuda:0')
benign distance is  tensor(150.1624, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3945847749710083
distance x is tensor(138.9035, device='cuda:0')
benign distance is  tensor(138.9035, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.28955942392349243
distance x is tensor(153.9724, device='cuda:0')
benign distance is  tensor(153.9724, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.13664892315864563
distance x is tensor(145.4106, device='cuda:0')
benign distance is  tensor(145.4106, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.933810830116272
distance x is tensor(137.9624, device='cuda:0')
benign distance is  tensor(137.9624, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.306143194437027
distance x is tensor(140.0319, device='cuda:0')
benign distance is  tensor(140.0319, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.33209228515625
distance x is tensor(137.1793, device='cuda:0')
benign distance is  tensor(137.1793, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2189733237028122
distance x is tensor(144.4638, device='cuda:0')
benign distance is  tensor(144.4638, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.046613652259111404
distance x is tensor(157.8053, device='cuda:0')
benign distance is  tensor(157.8053, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09647952020168304
distance x is tensor(135.4523, device='cuda:0')
benign distance is  tensor(135.4523, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3068874478340149
distance x is tensor(143.7689, device='cuda:0')
benign distance is  tensor(143.7689, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.4076937139034271
distance x is tensor(141.8992, device='cuda:0')
benign distance is  tensor(141.8992, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4119265079498291
distance x is tensor(131.1853, device='cuda:0')
benign distance is  tensor(131.1853, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4515395164489746
distance x is tensor(138.2222, device='cuda:0')
benign distance is  tensor(138.2222, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5341825485229492
distance x is tensor(131.2200, device='cuda:0')
benign distance is  tensor(131.2200, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.24732065200805664
distance x is tensor(142.8792, device='cuda:0')
benign distance is  tensor(142.8792, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([638.7731, 589.3514, 631.3326, 509.2782, 605.1738, 530.8138, 500.5025,
        653.7481, 279.3925, 229.2504, 214.2695, 207.6154, 204.1221, 201.9252,
        200.4032, 199.2910, 198.7182, 198.2070, 197.7853, 197.5553],
       device='cuda:0')
sorted_norm is   tensor([197.5553, 197.7853, 198.2070, 198.7182, 199.2910, 200.4032, 201.9252,
        204.1221, 207.6154, 214.2695, 229.2504, 279.3925, 500.5025, 509.2782,
        530.8138, 589.3514, 605.1738, 631.3326, 638.7731, 653.7481],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  3,  5,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 87.62% 

Test Accuracy: 86.46% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0977592468261719
distance x is tensor(143.4429, device='cuda:0')
benign distance is  tensor(143.4429, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6801029443740845
distance x is tensor(136.0793, device='cuda:0')
benign distance is  tensor(136.0793, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4038134217262268
distance x is tensor(148.1336, device='cuda:0')
benign distance is  tensor(148.1336, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7345533967018127
distance x is tensor(115.9582, device='cuda:0')
benign distance is  tensor(115.9582, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7676981687545776
distance x is tensor(132.5862, device='cuda:0')
benign distance is  tensor(132.5862, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2625757157802582
distance x is tensor(125.5286, device='cuda:0')
benign distance is  tensor(125.5286, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27110806107521057
distance x is tensor(126.1909, device='cuda:0')
benign distance is  tensor(126.1909, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20356333255767822
distance x is tensor(149.6998, device='cuda:0')
benign distance is  tensor(149.6998, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([667.4669, 637.4034, 678.1165, 540.5659, 610.5966, 586.7443, 582.9677,
        698.7675, 280.1839, 230.4059, 215.4322, 208.7326, 205.2068, 203.0265,
        201.7549, 200.9253, 200.1175, 199.6325, 199.2844, 198.9135, 766.1306,
        715.2090, 759.6796, 747.0340, 737.3986, 747.9587, 786.9787, 726.6735,
        684.8549, 728.1951, 706.6218, 696.8536, 700.9370, 701.2487, 758.2988,
        696.3904, 685.7678, 704.4706, 634.0770, 627.6334, 603.4553, 671.0224,
        631.7056, 752.7557], device='cuda:0')
sorted_norm is   tensor([198.9135, 199.2844, 199.6325, 200.1175, 200.9253, 201.7549, 203.0265,
        205.2068, 208.7326, 215.4322, 230.4059, 280.1839, 540.5659, 582.9677,
        586.7443, 603.4553, 610.5966, 627.6334, 631.7056, 634.0770, 637.4034,
        667.4669, 671.0224, 678.1165, 684.8549, 685.7678, 696.3904, 696.8536,
        698.7675, 700.9370, 701.2487, 704.4706, 706.6218, 715.2090, 726.6735,
        728.1951, 737.3986, 747.0340, 747.9587, 752.7557, 758.2988, 759.6796,
        766.1306, 786.9787], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  6,  5, 40,  4, 39,
        42, 38,  1,  0, 41,  2, 28, 36, 35, 31,  7, 32, 33, 37, 30, 21, 27],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 88.06% 

Test Accuracy: 87.07% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6266438961029053
distance x is tensor(110.9808, device='cuda:0')
benign distance is  tensor(110.9808, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36399930715560913
distance x is tensor(119.5251, device='cuda:0')
benign distance is  tensor(119.5251, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1872265636920929
distance x is tensor(131.8573, device='cuda:0')
benign distance is  tensor(131.8573, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.24112358689308167
distance x is tensor(109.6032, device='cuda:0')
benign distance is  tensor(109.6032, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.755669891834259
distance x is tensor(116.4596, device='cuda:0')
benign distance is  tensor(116.4596, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.38447505235671997
distance x is tensor(123.7712, device='cuda:0')
benign distance is  tensor(123.7712, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9345079660415649
distance x is tensor(118.9930, device='cuda:0')
benign distance is  tensor(118.9930, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9898541569709778
distance x is tensor(125.9212, device='cuda:0')
benign distance is  tensor(125.9212, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25646311044692993
distance x is tensor(145.2803, device='cuda:0')
benign distance is  tensor(145.2803, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7728127241134644
distance x is tensor(153.6609, device='cuda:0')
benign distance is  tensor(153.6609, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8497408032417297
distance x is tensor(134.1690, device='cuda:0')
benign distance is  tensor(134.1690, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.715414047241211
distance x is tensor(149.8164, device='cuda:0')
benign distance is  tensor(149.8164, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.031638264656067
distance x is tensor(119.4957, device='cuda:0')
benign distance is  tensor(119.4957, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.11638472229242325
distance x is tensor(135.4850, device='cuda:0')
benign distance is  tensor(135.4850, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7716501951217651
distance x is tensor(123.3765, device='cuda:0')
benign distance is  tensor(123.3765, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5418258905410767
distance x is tensor(145.7979, device='cuda:0')
benign distance is  tensor(145.7979, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.43110013008117676
distance x is tensor(130.7039, device='cuda:0')
benign distance is  tensor(130.7039, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6455441117286682
distance x is tensor(158.7548, device='cuda:0')
benign distance is  tensor(158.7548, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.26759421825408936
distance x is tensor(148.6609, device='cuda:0')
benign distance is  tensor(148.6609, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2834199368953705
distance x is tensor(139.0683, device='cuda:0')
benign distance is  tensor(139.0683, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.24340572953224182
distance x is tensor(151.8074, device='cuda:0')
benign distance is  tensor(151.8074, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.0596814155578613
distance x is tensor(139.0164, device='cuda:0')
benign distance is  tensor(139.0164, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.47371602058410645
distance x is tensor(163.7372, device='cuda:0')
benign distance is  tensor(163.7372, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8724158406257629
distance x is tensor(143.7755, device='cuda:0')
benign distance is  tensor(143.7755, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.6679145693778992
distance x is tensor(146.8071, device='cuda:0')
benign distance is  tensor(146.8071, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.20806661248207092
distance x is tensor(147.8976, device='cuda:0')
benign distance is  tensor(147.8976, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.39163145422935486
distance x is tensor(155.4717, device='cuda:0')
benign distance is  tensor(155.4717, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3606952428817749
distance x is tensor(149.2096, device='cuda:0')
benign distance is  tensor(149.2096, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.29881751537323
distance x is tensor(148.1062, device='cuda:0')
benign distance is  tensor(148.1062, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8248451352119446
distance x is tensor(138.9664, device='cuda:0')
benign distance is  tensor(138.9664, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0239249467849731
distance x is tensor(143.3855, device='cuda:0')
benign distance is  tensor(143.3855, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.17988087236881256
distance x is tensor(157.2683, device='cuda:0')
benign distance is  tensor(157.2683, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([522.9811, 557.5462, 614.6317, 493.7088, 538.9479, 596.3010, 544.4048,
        592.6511, 278.9381, 229.3566, 214.0399, 207.3377, 203.5290, 201.4032,
        199.9546, 198.9902, 198.1436, 197.6187, 197.1674, 196.8298],
       device='cuda:0')
sorted_norm is   tensor([196.8298, 197.1674, 197.6187, 198.1436, 198.9902, 199.9546, 201.4032,
        203.5290, 207.3377, 214.0399, 229.3566, 278.9381, 493.7088, 522.9811,
        538.9479, 544.4048, 557.5462, 592.6511, 596.3010, 614.6317],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  0,  4,  6],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 87.75% 

Test Accuracy: 86.48% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.043692316859960556
distance x is tensor(113.5383, device='cuda:0')
benign distance is  tensor(113.5383, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9743169546127319
distance x is tensor(125.7326, device='cuda:0')
benign distance is  tensor(125.7326, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22788719832897186
distance x is tensor(138.9410, device='cuda:0')
benign distance is  tensor(138.9410, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.427034467458725
distance x is tensor(113.1176, device='cuda:0')
benign distance is  tensor(113.1176, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8223191499710083
distance x is tensor(114.5419, device='cuda:0')
benign distance is  tensor(114.5419, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1119961738586426
distance x is tensor(135.2136, device='cuda:0')
benign distance is  tensor(135.2136, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36158135533332825
distance x is tensor(129.0852, device='cuda:0')
benign distance is  tensor(129.0852, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7051993012428284
distance x is tensor(129.3959, device='cuda:0')
benign distance is  tensor(129.3959, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([525.2291, 583.0971, 642.3511, 527.4785, 534.7043, 632.4617, 579.1863,
        607.2119, 278.7933, 229.2315, 214.3861, 207.8374, 204.3156, 202.1089,
        200.6202, 199.6449, 198.8943, 198.3401, 197.8573, 197.4995, 748.1588,
        703.8204, 756.2142, 720.9592, 694.4290, 694.5259, 688.2654, 720.4023,
        712.5092, 723.4023, 626.5750, 724.2189, 575.3112, 649.1060, 612.7366,
        695.4884], device='cuda:0')
sorted_norm is   tensor([197.4995, 197.8573, 198.3401, 198.8943, 199.6449, 200.6202, 202.1089,
        204.3156, 207.8374, 214.3861, 229.2315, 278.7933, 525.2291, 527.4785,
        534.7043, 575.3112, 579.1863, 583.0971, 607.2119, 612.7366, 626.5750,
        632.4617, 642.3511, 649.1060, 688.2654, 694.4290, 694.5259, 695.4884,
        703.8204, 712.5092, 720.4023, 720.9592, 723.4023, 724.2189, 748.1588,
        756.2142], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  0,  3,  4, 32,  6,  1,
         7, 34, 30,  5,  2, 33, 26, 24, 25, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 88.08% 

Test Accuracy: 86.82% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.08271301537752151
distance x is tensor(130.6971, device='cuda:0')
benign distance is  tensor(130.6971, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.126542568206787
distance x is tensor(137.6437, device='cuda:0')
benign distance is  tensor(137.6437, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14236293733119965
distance x is tensor(121.4977, device='cuda:0')
benign distance is  tensor(121.4977, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5432717204093933
distance x is tensor(111.9292, device='cuda:0')
benign distance is  tensor(111.9292, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6150859594345093
distance x is tensor(120.0792, device='cuda:0')
benign distance is  tensor(120.0792, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7888166308403015
distance x is tensor(119.0547, device='cuda:0')
benign distance is  tensor(119.0547, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5562113523483276
distance x is tensor(139.2314, device='cuda:0')
benign distance is  tensor(139.2314, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0049238204956055
distance x is tensor(139.1871, device='cuda:0')
benign distance is  tensor(139.1871, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.07047738879919052
distance x is tensor(143.1673, device='cuda:0')
benign distance is  tensor(143.1673, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0303882360458374
distance x is tensor(156.5806, device='cuda:0')
benign distance is  tensor(156.5806, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4034844934940338
distance x is tensor(133.6480, device='cuda:0')
benign distance is  tensor(133.6480, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7553777694702148
distance x is tensor(152.0828, device='cuda:0')
benign distance is  tensor(152.0828, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6223312616348267
distance x is tensor(126.4763, device='cuda:0')
benign distance is  tensor(126.4763, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5292066931724548
distance x is tensor(133.9508, device='cuda:0')
benign distance is  tensor(133.9508, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6098038554191589
distance x is tensor(128.6928, device='cuda:0')
benign distance is  tensor(128.6928, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6682170033454895
distance x is tensor(149.3239, device='cuda:0')
benign distance is  tensor(149.3239, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.35049039125442505
distance x is tensor(157.3159, device='cuda:0')
benign distance is  tensor(157.3159, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7147411108016968
distance x is tensor(138.4039, device='cuda:0')
benign distance is  tensor(138.4039, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.39489397406578064
distance x is tensor(157.4933, device='cuda:0')
benign distance is  tensor(157.4933, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7408318519592285
distance x is tensor(151.3899, device='cuda:0')
benign distance is  tensor(151.3899, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.45792636275291443
distance x is tensor(135.3733, device='cuda:0')
benign distance is  tensor(135.3733, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.22578532993793488
distance x is tensor(149.0302, device='cuda:0')
benign distance is  tensor(149.0302, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.21003878116607666
distance x is tensor(133.5198, device='cuda:0')
benign distance is  tensor(133.5198, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.41794300079345703
distance x is tensor(150.1371, device='cuda:0')
benign distance is  tensor(150.1371, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([615.1146, 633.3030, 572.0230, 517.8152, 548.2597, 568.5666, 634.7779,
        648.3633, 278.3695, 228.7598, 213.6320, 207.1555, 203.7114, 201.4882,
        200.0469, 198.7967, 198.0176, 197.4181, 197.1077, 196.7041, 781.8235,
        676.9633, 721.7067, 709.5551, 675.9896, 696.7907, 675.7522, 693.1353,
        634.4615, 756.0294, 707.4579, 676.1709, 725.5448, 661.0322, 775.4918,
        684.5258], device='cuda:0')
sorted_norm is   tensor([196.7041, 197.1077, 197.4181, 198.0176, 198.7967, 200.0469, 201.4882,
        203.7114, 207.1555, 213.6320, 228.7598, 278.3695, 517.8152, 548.2597,
        568.5666, 572.0230, 615.1146, 633.3030, 634.4615, 634.7779, 648.3633,
        661.0322, 675.7522, 675.9896, 676.1709, 676.9633, 684.5258, 693.1353,
        696.7907, 707.4579, 709.5551, 721.7067, 725.5448, 756.0294, 775.4918,
        781.8235], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  4,  5,  2,  0,  1,
        28,  6,  7, 33, 26, 24, 31, 21, 35, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 88.04% 

Test Accuracy: 87.16% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4376611113548279
distance x is tensor(121.6609, device='cuda:0')
benign distance is  tensor(121.6609, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9161235690116882
distance x is tensor(130.7197, device='cuda:0')
benign distance is  tensor(130.7197, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7304162979125977
distance x is tensor(124.1617, device='cuda:0')
benign distance is  tensor(124.1617, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6400744318962097
distance x is tensor(117.9738, device='cuda:0')
benign distance is  tensor(117.9738, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5057746171951294
distance x is tensor(101.4784, device='cuda:0')
benign distance is  tensor(101.4784, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8899459838867188
distance x is tensor(121.8568, device='cuda:0')
benign distance is  tensor(121.8568, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4437393546104431
distance x is tensor(106.7208, device='cuda:0')
benign distance is  tensor(106.7208, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2608986496925354
distance x is tensor(141.5491, device='cuda:0')
benign distance is  tensor(141.5491, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5756211876869202
distance x is tensor(132.7039, device='cuda:0')
benign distance is  tensor(132.7039, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.489856481552124
distance x is tensor(148.8635, device='cuda:0')
benign distance is  tensor(148.8635, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16025173664093018
distance x is tensor(139.8640, device='cuda:0')
benign distance is  tensor(139.8640, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.19942320883274078
distance x is tensor(132.1089, device='cuda:0')
benign distance is  tensor(132.1089, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.308427631855011
distance x is tensor(142.8945, device='cuda:0')
benign distance is  tensor(142.8945, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5123332142829895
distance x is tensor(129.1412, device='cuda:0')
benign distance is  tensor(129.1412, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4847801625728607
distance x is tensor(145.6707, device='cuda:0')
benign distance is  tensor(145.6707, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7347408533096313
distance x is tensor(140.6153, device='cuda:0')
benign distance is  tensor(140.6153, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.49795809388160706
distance x is tensor(151.8125, device='cuda:0')
benign distance is  tensor(151.8125, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.4663720726966858
distance x is tensor(134.3221, device='cuda:0')
benign distance is  tensor(134.3221, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.35081928968429565
distance x is tensor(154.8817, device='cuda:0')
benign distance is  tensor(154.8817, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.15889957547187805
distance x is tensor(143.8867, device='cuda:0')
benign distance is  tensor(143.8867, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0298521518707275
distance x is tensor(138.2396, device='cuda:0')
benign distance is  tensor(138.2396, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.35831907391548157
distance x is tensor(128.9033, device='cuda:0')
benign distance is  tensor(128.9033, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2532837986946106
distance x is tensor(126.9961, device='cuda:0')
benign distance is  tensor(126.9961, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1767795979976654
distance x is tensor(133.3507, device='cuda:0')
benign distance is  tensor(133.3507, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([559.2633, 613.3680, 582.2679, 533.4020, 472.1055, 569.3862, 493.6805,
        673.3848, 276.7672, 226.7096, 211.8536, 205.3517, 201.6568, 199.5244,
        197.9687, 197.0288, 196.3320, 195.7517, 195.3493, 194.9791, 681.6519,
        731.8959, 629.5842, 706.4741, 601.3967, 624.2795, 607.0304, 692.8087],
       device='cuda:0')
sorted_norm is   tensor([194.9791, 195.3493, 195.7517, 196.3320, 197.0288, 197.9687, 199.5244,
        201.6568, 205.3517, 211.8536, 226.7096, 276.7672, 472.1055, 493.6805,
        533.4020, 559.2633, 569.3862, 582.2679, 601.3967, 607.0304, 613.3680,
        624.2795, 629.5842, 673.3848, 681.6519, 692.8087, 706.4741, 731.8959],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  6,  3,  0,  5,  2,
        24, 26,  1, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 87.95% 

Test Accuracy: 86.79% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2779408693313599
distance x is tensor(147.7168, device='cuda:0')
benign distance is  tensor(147.7168, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0570083856582642
distance x is tensor(119.8668, device='cuda:0')
benign distance is  tensor(119.8668, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13674190640449524
distance x is tensor(139.7538, device='cuda:0')
benign distance is  tensor(139.7538, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.502410650253296
distance x is tensor(109.5632, device='cuda:0')
benign distance is  tensor(109.5632, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2138826549053192
distance x is tensor(112.1176, device='cuda:0')
benign distance is  tensor(112.1176, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6753901243209839
distance x is tensor(140.6952, device='cuda:0')
benign distance is  tensor(140.6952, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5888612866401672
distance x is tensor(119.9642, device='cuda:0')
benign distance is  tensor(119.9642, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.933296799659729
distance x is tensor(123.9564, device='cuda:0')
benign distance is  tensor(123.9564, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19702696800231934
distance x is tensor(143.6557, device='cuda:0')
benign distance is  tensor(143.6557, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5357391238212585
distance x is tensor(166.2820, device='cuda:0')
benign distance is  tensor(166.2820, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.034587025642395
distance x is tensor(130.9785, device='cuda:0')
benign distance is  tensor(130.9785, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4662877023220062
distance x is tensor(146.1516, device='cuda:0')
benign distance is  tensor(146.1516, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.19744518399238586
distance x is tensor(140.2095, device='cuda:0')
benign distance is  tensor(140.2095, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.09299644082784653
distance x is tensor(144.5271, device='cuda:0')
benign distance is  tensor(144.5271, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.13177074491977692
distance x is tensor(144.6719, device='cuda:0')
benign distance is  tensor(144.6719, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.130035400390625
distance x is tensor(150.2722, device='cuda:0')
benign distance is  tensor(150.2722, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([681.3351, 566.0233, 644.0220, 506.6669, 510.7650, 659.1691, 532.2080,
        599.0507, 277.5014, 228.2768, 213.1086, 206.5336, 202.8611, 200.6581,
        199.2735, 198.2877, 197.5774, 197.0513, 196.6784, 196.2328],
       device='cuda:0')
sorted_norm is   tensor([196.2328, 196.6784, 197.0513, 197.5774, 198.2877, 199.2735, 200.6581,
        202.8611, 206.5336, 213.1086, 228.2768, 277.5014, 506.6669, 510.7650,
        532.2080, 566.0233, 599.0507, 644.0220, 659.1691, 681.3351],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  3,  4,  6,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 87.46% 

Test Accuracy: 86.48% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.28489622473716736
distance x is tensor(131.2102, device='cuda:0')
benign distance is  tensor(131.2102, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.34662631154060364
distance x is tensor(121.0105, device='cuda:0')
benign distance is  tensor(121.0105, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2457520216703415
distance x is tensor(132.5107, device='cuda:0')
benign distance is  tensor(132.5107, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.300349235534668
distance x is tensor(127.7667, device='cuda:0')
benign distance is  tensor(127.7667, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.07876401394605637
distance x is tensor(125.1291, device='cuda:0')
benign distance is  tensor(125.1291, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2418893575668335
distance x is tensor(132.0007, device='cuda:0')
benign distance is  tensor(132.0007, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9047638177871704
distance x is tensor(106.3677, device='cuda:0')
benign distance is  tensor(106.3677, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.382908582687378
distance x is tensor(152.7286, device='cuda:0')
benign distance is  tensor(152.7286, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([631.7545, 580.4390, 618.0031, 600.9714, 571.5715, 622.8047, 490.1365,
        717.1948, 276.6088, 227.5194, 212.8990, 206.5536, 202.7825, 200.7360,
        199.4619, 198.5007, 197.6811, 197.1889, 196.7626, 196.4493, 772.8077,
        769.7654, 802.2795, 775.8350, 780.4217, 736.8172, 763.8021, 826.1286,
        782.9701, 682.5214, 759.8396, 745.6466, 688.8235, 731.4091, 675.0175,
        752.7205, 662.4346, 738.6574, 703.1112, 670.3546, 703.4017, 649.6442,
        732.1438, 679.5760, 680.3197, 781.4420, 633.4077, 699.9887, 682.6732,
        678.7799, 692.5716, 731.8040], device='cuda:0')
sorted_norm is   tensor([196.4493, 196.7626, 197.1889, 197.6811, 198.5007, 199.4619, 200.7360,
        202.7825, 206.5536, 212.8990, 227.5194, 276.6088, 490.1365, 571.5715,
        580.4390, 600.9714, 618.0031, 622.8047, 631.7545, 633.4077, 649.6442,
        662.4346, 670.3546, 675.0175, 678.7799, 679.5760, 680.3197, 682.5214,
        682.6732, 688.8235, 692.5716, 699.9887, 703.1112, 703.4017, 717.1948,
        731.4091, 731.8040, 732.1438, 736.8172, 738.6574, 745.6466, 752.7205,
        759.8396, 763.8021, 769.7654, 772.8077, 775.8350, 780.4217, 781.4420,
        782.9701, 802.2795, 826.1286], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  4,  1,  3,  2,  5,
         0, 46, 41, 36, 39, 34, 49, 43, 44, 29, 48, 32, 50, 47, 38, 40,  7, 33,
        51, 42, 25, 37, 31], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 88.21% 

Test Accuracy: 87.40% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3558556139469147
distance x is tensor(126.0887, device='cuda:0')
benign distance is  tensor(126.0887, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9819141626358032
distance x is tensor(119.3615, device='cuda:0')
benign distance is  tensor(119.3615, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15272606909275055
distance x is tensor(136.7043, device='cuda:0')
benign distance is  tensor(136.7043, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8755549192428589
distance x is tensor(105.7066, device='cuda:0')
benign distance is  tensor(105.7066, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.995518684387207
distance x is tensor(95.9567, device='cuda:0')
benign distance is  tensor(95.9567, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6934653520584106
distance x is tensor(128.9379, device='cuda:0')
benign distance is  tensor(128.9379, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36899691820144653
distance x is tensor(135.5560, device='cuda:0')
benign distance is  tensor(135.5560, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16713359951972961
distance x is tensor(133.9292, device='cuda:0')
benign distance is  tensor(133.9292, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2807249128818512
distance x is tensor(155.3231, device='cuda:0')
benign distance is  tensor(155.3231, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4840618669986725
distance x is tensor(154.3444, device='cuda:0')
benign distance is  tensor(154.3444, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7355340719223022
distance x is tensor(144.7305, device='cuda:0')
benign distance is  tensor(144.7305, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9421745538711548
distance x is tensor(130.4056, device='cuda:0')
benign distance is  tensor(130.4056, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4799225330352783
distance x is tensor(133.9874, device='cuda:0')
benign distance is  tensor(133.9874, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.30543407797813416
distance x is tensor(135.1214, device='cuda:0')
benign distance is  tensor(135.1214, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2474920004606247
distance x is tensor(132.2310, device='cuda:0')
benign distance is  tensor(132.2310, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6454023718833923
distance x is tensor(146.1928, device='cuda:0')
benign distance is  tensor(146.1928, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5372732877731323
distance x is tensor(132.0918, device='cuda:0')
benign distance is  tensor(132.0918, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5969624519348145
distance x is tensor(150.7622, device='cuda:0')
benign distance is  tensor(150.7622, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5519059896469116
distance x is tensor(143.4296, device='cuda:0')
benign distance is  tensor(143.4296, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.31136542558670044
distance x is tensor(138.5585, device='cuda:0')
benign distance is  tensor(138.5585, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.520086407661438
distance x is tensor(136.2589, device='cuda:0')
benign distance is  tensor(136.2589, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1914595365524292
distance x is tensor(139.9653, device='cuda:0')
benign distance is  tensor(139.9653, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3159913122653961
distance x is tensor(148.1746, device='cuda:0')
benign distance is  tensor(148.1746, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0769237279891968
distance x is tensor(138.3517, device='cuda:0')
benign distance is  tensor(138.3517, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5010858178138733
distance x is tensor(147.5381, device='cuda:0')
benign distance is  tensor(147.5381, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0836223363876343
distance x is tensor(129.6656, device='cuda:0')
benign distance is  tensor(129.6656, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.18685314059257507
distance x is tensor(155.5054, device='cuda:0')
benign distance is  tensor(155.5054, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3342692255973816
distance x is tensor(144.3972, device='cuda:0')
benign distance is  tensor(144.3972, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8820789456367493
distance x is tensor(139.7959, device='cuda:0')
benign distance is  tensor(139.7959, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1309778243303299
distance x is tensor(138.9112, device='cuda:0')
benign distance is  tensor(138.9112, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.49305248260498047
distance x is tensor(138.0363, device='cuda:0')
benign distance is  tensor(138.0363, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.26175689697265625
distance x is tensor(147.1657, device='cuda:0')
benign distance is  tensor(147.1657, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.36196810007095337
distance x is tensor(154.5669, device='cuda:0')
benign distance is  tensor(154.5669, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.43410739302635193
distance x is tensor(143.9495, device='cuda:0')
benign distance is  tensor(143.9495, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3117084205150604
distance x is tensor(138.3365, device='cuda:0')
benign distance is  tensor(138.3365, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2132151871919632
distance x is tensor(136.9633, device='cuda:0')
benign distance is  tensor(136.9633, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.37223735451698303
distance x is tensor(142.5921, device='cuda:0')
benign distance is  tensor(142.5921, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.688040018081665
distance x is tensor(144.4578, device='cuda:0')
benign distance is  tensor(144.4578, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2285487651824951
distance x is tensor(163.8527, device='cuda:0')
benign distance is  tensor(163.8527, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  1.0457431077957153
distance x is tensor(142.4786, device='cuda:0')
benign distance is  tensor(142.4786, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([590.0543, 551.5443, 630.4901, 474.5351, 452.0294, 604.3868, 617.4769,
        624.4198, 274.6369, 225.7949, 210.8102, 204.3916, 200.7224, 198.3720,
        197.0221, 196.1325, 195.3928, 194.9204, 194.3960, 194.1043],
       device='cuda:0')
sorted_norm is   tensor([194.1043, 194.3960, 194.9204, 195.3928, 196.1325, 197.0221, 198.3720,
        200.7224, 204.3916, 210.8102, 225.7949, 274.6369, 452.0294, 474.5351,
        551.5443, 590.0543, 604.3868, 617.4769, 624.4198, 630.4901],
       device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  3,  1,  0],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 87.70% 

Test Accuracy: 86.85% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6536217927932739
distance x is tensor(120.8596, device='cuda:0')
benign distance is  tensor(120.8596, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.052880048751831
distance x is tensor(114.3123, device='cuda:0')
benign distance is  tensor(114.3123, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14892806112766266
distance x is tensor(145.9406, device='cuda:0')
benign distance is  tensor(145.9406, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5797403454780579
distance x is tensor(122.6496, device='cuda:0')
benign distance is  tensor(122.6496, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.22688665986061096
distance x is tensor(106.8589, device='cuda:0')
benign distance is  tensor(106.8589, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7721456289291382
distance x is tensor(135.4850, device='cuda:0')
benign distance is  tensor(135.4850, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25666454434394836
distance x is tensor(121.4700, device='cuda:0')
benign distance is  tensor(121.4700, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.288230299949646
distance x is tensor(141.1914, device='cuda:0')
benign distance is  tensor(141.1914, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([563.0637, 533.2233, 670.9406, 575.1000, 501.0215, 634.2180, 545.5716,
        660.8460, 274.9446, 226.4655, 211.5343, 205.0858, 201.5582, 199.3802,
        197.9935, 197.0107, 196.2807, 195.7610, 195.3033, 195.0258, 761.1201,
        709.1456, 775.9037, 706.5626, 706.2844, 658.0060, 657.3002, 682.1238,
        734.9023, 710.0378, 692.7800, 640.9338, 638.5226, 639.6307, 644.0295,
        690.7112], device='cuda:0')
sorted_norm is   tensor([195.0258, 195.3033, 195.7610, 196.2807, 197.0107, 197.9935, 199.3802,
        201.5582, 205.0858, 211.5343, 226.4655, 274.9446, 501.0215, 533.2233,
        545.5716, 563.0637, 575.1000, 634.2180, 638.5226, 639.6307, 640.9338,
        644.0295, 657.3002, 658.0060, 660.8460, 670.9406, 682.1238, 690.7112,
        692.7800, 706.2844, 706.5626, 709.1456, 710.0378, 734.9023, 761.1201,
        775.9037], device='cuda:0')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  1,  6,  0,  3,  5,
        32, 33, 31, 34, 26, 25,  7,  2, 27, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 88.20% 

Test Accuracy: 86.92% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 88.20%
|----0th round Training Accuracy : 88.31%
|----1th round Training Accuracy : 87.80%
|----2th round Training Accuracy : 87.18%
|----3th round Training Accuracy : 87.50%
|----4th round Training Accuracy : 86.63%
|----5th round Training Accuracy : 88.12%
|----6th round Training Accuracy : 85.02%
|----7th round Training Accuracy : 86.46%
|----8th round Training Accuracy : 85.78%
|----9th round Training Accuracy : 87.04%
|----10th round Training Accuracy : 83.88%
|----11th round Training Accuracy : 88.03%
|----12th round Training Accuracy : 85.98%
|----13th round Training Accuracy : 86.32%
|----14th round Training Accuracy : 87.46%
|----15th round Training Accuracy : 88.03%
|----16th round Training Accuracy : 86.25%
|----17th round Training Accuracy : 88.27%
|----18th round Training Accuracy : 87.02%
|----19th round Training Accuracy : 88.35%
|----20th round Training Accuracy : 88.00%
|----21th round Training Accuracy : 87.83%
|----22th round Training Accuracy : 86.69%
|----23th round Training Accuracy : 88.43%
|----24th round Training Accuracy : 88.20%
|----25th round Training Accuracy : 88.09%
|----26th round Training Accuracy : 87.98%
|----27th round Training Accuracy : 88.14%
|----28th round Training Accuracy : 87.34%
|----29th round Training Accuracy : 88.18%
|----30th round Training Accuracy : 87.60%
|----31th round Training Accuracy : 87.99%
|----32th round Training Accuracy : 87.97%
|----33th round Training Accuracy : 87.92%
|----34th round Training Accuracy : 87.66%
|----35th round Training Accuracy : 88.21%
|----36th round Training Accuracy : 87.75%
|----37th round Training Accuracy : 87.62%
|----38th round Training Accuracy : 87.70%
|----39th round Training Accuracy : 87.98%
|----40th round Training Accuracy : 87.62%
|----41th round Training Accuracy : 88.06%
|----42th round Training Accuracy : 87.75%
|----43th round Training Accuracy : 88.08%
|----44th round Training Accuracy : 88.04%
|----45th round Training Accuracy : 87.95%
|----46th round Training Accuracy : 87.46%
|----47th round Training Accuracy : 88.21%
|----48th round Training Accuracy : 87.70%
|----49th round Training Accuracy : 88.20%
|----Final Test Accuracy: 86.92%
|----0th round Final Test Accuracy : 87.73%
|----1th round Final Test Accuracy : 87.25%
|----2th round Final Test Accuracy : 86.80%
|----3th round Final Test Accuracy : 86.95%
|----4th round Final Test Accuracy : 86.29%
|----5th round Final Test Accuracy : 87.69%
|----6th round Final Test Accuracy : 84.07%
|----7th round Final Test Accuracy : 85.80%
|----8th round Final Test Accuracy : 85.03%
|----9th round Final Test Accuracy : 86.22%
|----10th round Final Test Accuracy : 82.84%
|----11th round Final Test Accuracy : 87.10%
|----12th round Final Test Accuracy : 85.13%
|----13th round Final Test Accuracy : 85.60%
|----14th round Final Test Accuracy : 86.63%
|----15th round Final Test Accuracy : 87.11%
|----16th round Final Test Accuracy : 85.36%
|----17th round Final Test Accuracy : 87.17%
|----18th round Final Test Accuracy : 85.81%
|----19th round Final Test Accuracy : 87.32%
|----20th round Final Test Accuracy : 87.01%
|----21th round Final Test Accuracy : 86.84%
|----22th round Final Test Accuracy : 85.57%
|----23th round Final Test Accuracy : 87.40%
|----24th round Final Test Accuracy : 87.23%
|----25th round Final Test Accuracy : 86.89%
|----26th round Final Test Accuracy : 86.86%
|----27th round Final Test Accuracy : 86.88%
|----28th round Final Test Accuracy : 86.17%
|----29th round Final Test Accuracy : 87.10%
|----30th round Final Test Accuracy : 86.34%
|----31th round Final Test Accuracy : 86.89%
|----32th round Final Test Accuracy : 86.88%
|----33th round Final Test Accuracy : 86.92%
|----34th round Final Test Accuracy : 86.72%
|----35th round Final Test Accuracy : 87.45%
|----36th round Final Test Accuracy : 86.74%
|----37th round Final Test Accuracy : 86.70%
|----38th round Final Test Accuracy : 86.65%
|----39th round Final Test Accuracy : 87.24%
|----40th round Final Test Accuracy : 86.46%
|----41th round Final Test Accuracy : 87.07%
|----42th round Final Test Accuracy : 86.48%
|----43th round Final Test Accuracy : 86.82%
|----44th round Final Test Accuracy : 87.16%
|----45th round Final Test Accuracy : 86.79%
|----46th round Final Test Accuracy : 86.48%
|----47th round Final Test Accuracy : 87.40%
|----48th round Final Test Accuracy : 86.85%
|----49th round Final Test Accuracy : 86.92%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3316.4808
