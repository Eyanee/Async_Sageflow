
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7449220046401024
distance x is tensor(128.9572, device='cuda:3')
benign distance is  tensor(128.9572, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9363397341221571
distance x is tensor(108.4503, device='cuda:3')
benign distance is  tensor(108.4503, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6060576029121876
distance x is tensor(112.9831, device='cuda:3')
benign distance is  tensor(112.9831, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9584106206893921
distance x is tensor(154.7187, device='cuda:3')
benign distance is  tensor(154.7187, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8543065348640084
distance x is tensor(100.3535, device='cuda:3')
benign distance is  tensor(100.3535, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7024487350136042
distance x is tensor(97.8045, device='cuda:3')
benign distance is  tensor(97.8045, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0746488347649574
distance x is tensor(109.4541, device='cuda:3')
benign distance is  tensor(109.4541, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6922708805650473
distance x is tensor(84.3088, device='cuda:3')
benign distance is  tensor(84.3088, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8044648002833128
distance x is tensor(113.7762, device='cuda:3')
benign distance is  tensor(113.7762, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7463540025055408
distance x is tensor(129.2924, device='cuda:3')
benign distance is  tensor(129.2924, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1473796870559454
distance x is tensor(91.0399, device='cuda:3')
benign distance is  tensor(91.0399, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2076236978173256
distance x is tensor(123.8824, device='cuda:3')
benign distance is  tensor(123.8824, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2287856116890907
distance x is tensor(158.5661, device='cuda:3')
benign distance is  tensor(158.5661, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6156134214252234
distance x is tensor(67.0181, device='cuda:3')
benign distance is  tensor(67.0181, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8736978285014629
distance x is tensor(141.5637, device='cuda:3')
benign distance is  tensor(141.5637, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2394236326217651
distance x is tensor(130.0395, device='cuda:3')
benign distance is  tensor(130.0395, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.384143065661192
distance x is tensor(112.8211, device='cuda:3')
benign distance is  tensor(112.8211, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6312349373474717
distance x is tensor(113.7393, device='cuda:3')
benign distance is  tensor(113.7393, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9720022529363632
distance x is tensor(120.9883, device='cuda:3')
benign distance is  tensor(120.9883, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6945515926927328
distance x is tensor(121.9336, device='cuda:3')
benign distance is  tensor(121.9336, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9872509818524122
distance x is tensor(86.2356, device='cuda:3')
benign distance is  tensor(86.2356, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.776559860445559
distance x is tensor(209.6667, device='cuda:3')
benign distance is  tensor(209.6667, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9688758365809917
distance x is tensor(147.8250, device='cuda:3')
benign distance is  tensor(147.8250, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6476496998220682
distance x is tensor(117.5830, device='cuda:3')
benign distance is  tensor(117.5830, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9584757816046476
distance x is tensor(135.1164, device='cuda:3')
benign distance is  tensor(135.1164, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5625004805624485
distance x is tensor(77.7095, device='cuda:3')
benign distance is  tensor(77.7095, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8958509583026171
distance x is tensor(145.8803, device='cuda:3')
benign distance is  tensor(145.8803, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2906045019626617
distance x is tensor(114.9169, device='cuda:3')
benign distance is  tensor(114.9169, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6831617224961519
distance x is tensor(121.6185, device='cuda:3')
benign distance is  tensor(121.6185, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7227482534945011
distance x is tensor(121.3088, device='cuda:3')
benign distance is  tensor(121.3088, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4486921951174736
distance x is tensor(106.5218, device='cuda:3')
benign distance is  tensor(106.5218, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7768154572695494
distance x is tensor(175.1110, device='cuda:3')
benign distance is  tensor(175.1110, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7572748586535454
distance x is tensor(116.0443, device='cuda:3')
benign distance is  tensor(116.0443, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7621427644044161
distance x is tensor(104.9949, device='cuda:3')
benign distance is  tensor(104.9949, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5944520067423582
distance x is tensor(148.1016, device='cuda:3')
benign distance is  tensor(148.1016, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3926532976329327
distance x is tensor(123.6155, device='cuda:3')
benign distance is  tensor(123.6155, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9360237568616867
distance x is tensor(112.4121, device='cuda:3')
benign distance is  tensor(112.4121, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8231689296662807
distance x is tensor(81.2972, device='cuda:3')
benign distance is  tensor(81.2972, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7796871811151505
distance x is tensor(101.6138, device='cuda:3')
benign distance is  tensor(101.6138, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9572715107351542
distance x is tensor(122.1603, device='cuda:3')
benign distance is  tensor(122.1603, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.253391146659851
distance x is tensor(111.5469, device='cuda:3')
benign distance is  tensor(111.5469, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2328448705375195
distance x is tensor(141.9119, device='cuda:3')
benign distance is  tensor(141.9119, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0369190722703934
distance x is tensor(137.6794, device='cuda:3')
benign distance is  tensor(137.6794, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1926997750997543
distance x is tensor(101.1725, device='cuda:3')
benign distance is  tensor(101.1725, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5406518112868071
distance x is tensor(153.6153, device='cuda:3')
benign distance is  tensor(153.6153, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6135718692094088
distance x is tensor(138.6760, device='cuda:3')
benign distance is  tensor(138.6760, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7367875492200255
distance x is tensor(106.4752, device='cuda:3')
benign distance is  tensor(106.4752, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5379432085901499
distance x is tensor(137.7630, device='cuda:3')
benign distance is  tensor(137.7630, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([590.0186, 498.7161, 523.6273, 719.3940, 462.3030, 438.2553, 506.7158,
        384.6375, 320.0502, 256.6169, 236.2825, 226.6094, 221.4633, 218.2727,
        215.9911, 214.4320, 213.2968, 212.4111, 211.7698, 211.1662],
       device='cuda:3')
sorted_norm is   tensor([211.1662, 211.7698, 212.4111, 213.2968, 214.4320, 215.9911, 218.2727,
        221.4633, 226.6094, 236.2825, 256.6169, 320.0502, 384.6375, 438.2553,
        462.3030, 498.7161, 506.7158, 523.6273, 590.0186, 719.3940],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  5,  4,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 96.14% 

Test Accuracy: 87.80% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6454553138464689
distance x is tensor(106.4470, device='cuda:3')
benign distance is  tensor(106.4470, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7057409454137087
distance x is tensor(104.2945, device='cuda:3')
benign distance is  tensor(104.2945, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5526496563106775
distance x is tensor(105.4476, device='cuda:3')
benign distance is  tensor(105.4476, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9188524968922138
distance x is tensor(154.8871, device='cuda:3')
benign distance is  tensor(154.8871, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9198066154494882
distance x is tensor(87.1792, device='cuda:3')
benign distance is  tensor(87.1792, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5811307015828788
distance x is tensor(108.8150, device='cuda:3')
benign distance is  tensor(108.8150, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2445722613483667
distance x is tensor(99.1380, device='cuda:3')
benign distance is  tensor(99.1380, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6156454272568226
distance x is tensor(85.0856, device='cuda:3')
benign distance is  tensor(85.0856, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([502.4405, 503.0095, 496.0740, 715.3002, 402.4799, 490.9930, 459.4051,
        387.0452, 329.0043, 267.9575, 248.4604, 239.4121, 234.5882, 231.6071,
        229.7292, 228.2057, 227.2777, 226.5285, 226.0135, 225.4418, 534.2411,
        610.8823, 437.4693, 581.6495, 746.5956, 340.6863, 650.5453, 614.6650],
       device='cuda:3')
sorted_norm is   tensor([225.4418, 226.0135, 226.5285, 227.2777, 228.2057, 229.7292, 231.6071,
        234.5882, 239.4121, 248.4604, 267.9575, 329.0043, 340.6863, 387.0452,
        402.4799, 437.4693, 459.4051, 490.9930, 496.0740, 502.4405, 503.0095,
        534.2411, 581.6495, 610.8823, 614.6650, 650.5453, 715.3002, 746.5956],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 25,  7,  4, 22,  6,  5,
         2,  0,  1, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 95.39% 

Test Accuracy: 86.87% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6949276756495237
distance x is tensor(133.1750, device='cuda:3')
benign distance is  tensor(133.1750, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7294664923101664
distance x is tensor(100.9938, device='cuda:3')
benign distance is  tensor(100.9938, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6529770046472549
distance x is tensor(112.0170, device='cuda:3')
benign distance is  tensor(112.0170, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8401538319885731
distance x is tensor(147.0086, device='cuda:3')
benign distance is  tensor(147.0086, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8428064305335283
distance x is tensor(96.9280, device='cuda:3')
benign distance is  tensor(96.9280, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5592007143422961
distance x is tensor(95.2120, device='cuda:3')
benign distance is  tensor(95.2120, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1813004426658154
distance x is tensor(90.8448, device='cuda:3')
benign distance is  tensor(90.8448, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5856879521161318
distance x is tensor(81.6242, device='cuda:3')
benign distance is  tensor(81.6242, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8527707122266293
distance x is tensor(95.9081, device='cuda:3')
benign distance is  tensor(95.9081, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6444340664893389
distance x is tensor(118.3908, device='cuda:3')
benign distance is  tensor(118.3908, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0070925205945969
distance x is tensor(74.7035, device='cuda:3')
benign distance is  tensor(74.7035, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.246193379163742
distance x is tensor(117.2889, device='cuda:3')
benign distance is  tensor(117.2889, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0740000940859318
distance x is tensor(164.7317, device='cuda:3')
benign distance is  tensor(164.7317, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6575300507247448
distance x is tensor(56.2202, device='cuda:3')
benign distance is  tensor(56.2202, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7512254733592272
distance x is tensor(133.0473, device='cuda:3')
benign distance is  tensor(133.0473, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.252939261496067
distance x is tensor(114.6680, device='cuda:3')
benign distance is  tensor(114.6680, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([627.3418, 483.9457, 528.9079, 685.7870, 443.6188, 441.6738, 437.1278,
        378.4045, 335.2073, 275.4785, 256.8698, 248.6364, 244.0115, 241.0444,
        239.0939, 237.6466, 236.7592, 236.0147, 235.4642, 235.1539, 565.5110,
        556.6667, 584.2521, 594.7231, 441.8861, 954.3812, 701.2502, 575.8917],
       device='cuda:3')
sorted_norm is   tensor([235.1539, 235.4642, 236.0147, 236.7592, 237.6466, 239.0939, 241.0444,
        244.0115, 248.6364, 256.8698, 275.4785, 335.2073, 378.4045, 437.1278,
        441.6738, 441.8861, 443.6188, 483.9457, 528.9079, 556.6667, 565.5110,
        575.8917, 584.2521, 594.7231, 627.3418, 685.7870, 701.2502, 954.3812],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  5, 24,  4,  1,
         2, 21, 20, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 94.30% 

Test Accuracy: 86.34% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7705177329480648
distance x is tensor(117.2641, device='cuda:3')
benign distance is  tensor(117.2641, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8719100207090378
distance x is tensor(95.8160, device='cuda:3')
benign distance is  tensor(95.8160, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7374346945434809
distance x is tensor(101.1554, device='cuda:3')
benign distance is  tensor(101.1554, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8589054271578789
distance x is tensor(144.2853, device='cuda:3')
benign distance is  tensor(144.2853, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7261995393782854
distance x is tensor(83.0192, device='cuda:3')
benign distance is  tensor(83.0192, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6232361695729196
distance x is tensor(95.1668, device='cuda:3')
benign distance is  tensor(95.1668, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8377329725772142
distance x is tensor(91.1745, device='cuda:3')
benign distance is  tensor(91.1745, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5542389135807753
distance x is tensor(80.8069, device='cuda:3')
benign distance is  tensor(80.8069, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.8957601748406887
distance x is tensor(106.2405, device='cuda:3')
benign distance is  tensor(106.2405, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5902309529483318
distance x is tensor(103.3559, device='cuda:3')
benign distance is  tensor(103.3559, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.932702224701643
distance x is tensor(114.2073, device='cuda:3')
benign distance is  tensor(114.2073, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7225318588316441
distance x is tensor(112.1704, device='cuda:3')
benign distance is  tensor(112.1704, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8758500870317221
distance x is tensor(73.8488, device='cuda:3')
benign distance is  tensor(73.8488, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6694917771965265
distance x is tensor(206.2162, device='cuda:3')
benign distance is  tensor(206.2162, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1712308079004288
distance x is tensor(146.4980, device='cuda:3')
benign distance is  tensor(146.4980, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6444073244929314
distance x is tensor(101.8612, device='cuda:3')
benign distance is  tensor(101.8612, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([558.5245, 472.8231, 482.9972, 686.0938, 385.4168, 436.5487, 429.2408,
        371.1689, 338.6091, 279.5323, 261.6354, 253.4649, 249.0321, 246.3886,
        244.4754, 243.2565, 242.2816, 241.6129, 241.1782, 240.6432, 685.8593,
        452.4249, 715.8266, 603.0756, 619.8242, 613.9233, 549.6033, 846.8721,
        470.3070, 554.6581, 367.4433, 557.7270, 775.8777, 289.9506, 616.4294,
        559.0415], device='cuda:3')
sorted_norm is   tensor([240.6432, 241.1782, 241.6129, 242.2816, 243.2565, 244.4754, 246.3886,
        249.0321, 253.4649, 261.6354, 279.5323, 289.9506, 338.6091, 367.4433,
        371.1689, 385.4168, 429.2408, 436.5487, 452.4249, 470.3070, 472.8231,
        482.9972, 549.6033, 554.6581, 557.7270, 558.5245, 559.0415, 603.0756,
        613.9233, 616.4294, 619.8242, 685.8593, 686.0938, 715.8266, 775.8777,
        846.8721], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9, 33,  8, 30,  7,  4,  6,  5,
        21, 28,  1,  2, 26, 29, 31,  0, 35, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 93.09% 

Test Accuracy: 86.87% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6602839417755604
distance x is tensor(109.1532, device='cuda:3')
benign distance is  tensor(109.1532, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7648086901754141
distance x is tensor(93.5654, device='cuda:3')
benign distance is  tensor(93.5654, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6982950549572706
distance x is tensor(97.8822, device='cuda:3')
benign distance is  tensor(97.8822, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8379893992096186
distance x is tensor(141.1690, device='cuda:3')
benign distance is  tensor(141.1690, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6641360186040401
distance x is tensor(74.0680, device='cuda:3')
benign distance is  tensor(74.0680, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5721152471378446
distance x is tensor(92.2774, device='cuda:3')
benign distance is  tensor(92.2774, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.200109088793397
distance x is tensor(88.7109, device='cuda:3')
benign distance is  tensor(88.7109, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6585385967046022
distance x is tensor(81.8533, device='cuda:3')
benign distance is  tensor(81.8533, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8566435910761356
distance x is tensor(93.9400, device='cuda:3')
benign distance is  tensor(93.9400, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6067463364452124
distance x is tensor(112.2400, device='cuda:3')
benign distance is  tensor(112.2400, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9020187985152006
distance x is tensor(66.5270, device='cuda:3')
benign distance is  tensor(66.5270, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2461580373346806
distance x is tensor(109.5806, device='cuda:3')
benign distance is  tensor(109.5806, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0234670713543892
distance x is tensor(154.9198, device='cuda:3')
benign distance is  tensor(154.9198, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6597794871777296
distance x is tensor(64.1949, device='cuda:3')
benign distance is  tensor(64.1949, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9506882131099701
distance x is tensor(134.0878, device='cuda:3')
benign distance is  tensor(134.0878, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2880313619971275
distance x is tensor(125.2187, device='cuda:3')
benign distance is  tensor(125.2187, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0372594483196735
distance x is tensor(108.8907, device='cuda:3')
benign distance is  tensor(108.8907, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6268366202712059
distance x is tensor(81.8705, device='cuda:3')
benign distance is  tensor(81.8705, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7300546653568745
distance x is tensor(116.1353, device='cuda:3')
benign distance is  tensor(116.1353, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0775596778839827
distance x is tensor(110.3686, device='cuda:3')
benign distance is  tensor(110.3686, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6488322671502829
distance x is tensor(108.1076, device='cuda:3')
benign distance is  tensor(108.1076, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9198518227785826
distance x is tensor(99.8317, device='cuda:3')
benign distance is  tensor(99.8317, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5342574622482061
distance x is tensor(99.0299, device='cuda:3')
benign distance is  tensor(99.0299, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6666210927069187
distance x is tensor(153.6791, device='cuda:3')
benign distance is  tensor(153.6791, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([510.0594, 459.9408, 474.5169, 678.1296, 345.0526, 425.6001, 426.8182,
        378.1339, 337.2596, 278.6805, 260.7564, 252.8446, 248.4068, 245.7709,
        243.9057, 242.5536, 241.6216, 240.8337, 240.2539, 239.8779, 627.6307,
        566.9866, 737.3143, 638.3383, 576.7031, 486.0465, 546.7230, 637.7509],
       device='cuda:3')
sorted_norm is   tensor([239.8779, 240.2539, 240.8337, 241.6216, 242.5536, 243.9057, 245.7709,
        248.4068, 252.8446, 260.7564, 278.6805, 337.2596, 345.0526, 378.1339,
        425.6001, 426.8182, 459.9408, 474.5169, 486.0465, 510.0594, 546.7230,
        566.9866, 576.7031, 627.6307, 637.7509, 638.3383, 678.1296, 737.3143],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  7,  5,  6,  1,  2,
        25,  0, 26, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 92.02% 

Test Accuracy: 85.99% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7353704888373613
distance x is tensor(101.7469, device='cuda:3')
benign distance is  tensor(101.7469, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6158950570970774
distance x is tensor(111.2455, device='cuda:3')
benign distance is  tensor(111.2455, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7073470298200846
distance x is tensor(104.1844, device='cuda:3')
benign distance is  tensor(104.1844, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8701084274798632
distance x is tensor(145.8867, device='cuda:3')
benign distance is  tensor(145.8867, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.887361153960228
distance x is tensor(92.8051, device='cuda:3')
benign distance is  tensor(92.8051, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6178967794403434
distance x is tensor(97.5043, device='cuda:3')
benign distance is  tensor(97.5043, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1102550886571407
distance x is tensor(98.4714, device='cuda:3')
benign distance is  tensor(98.4714, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6121596843004227
distance x is tensor(89.5318, device='cuda:3')
benign distance is  tensor(89.5318, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8326830882579088
distance x is tensor(113.4334, device='cuda:3')
benign distance is  tensor(113.4334, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9408166967332363
distance x is tensor(93.3351, device='cuda:3')
benign distance is  tensor(93.3351, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7853882610797882
distance x is tensor(139.6469, device='cuda:3')
benign distance is  tensor(139.6469, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.4192633517086506
distance x is tensor(117.0322, device='cuda:3')
benign distance is  tensor(117.0322, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8231071457266808
distance x is tensor(103.7089, device='cuda:3')
benign distance is  tensor(103.7089, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0184334721416235
distance x is tensor(92.1677, device='cuda:3')
benign distance is  tensor(92.1677, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7950084824115038
distance x is tensor(86.9577, device='cuda:3')
benign distance is  tensor(86.9577, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8194203693419695
distance x is tensor(105.2876, device='cuda:3')
benign distance is  tensor(105.2876, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([493.8266, 528.2715, 497.4196, 673.2766, 437.8878, 452.3012, 474.7715,
        420.8047, 335.2135, 277.2964, 259.9528, 251.9963, 247.8077, 245.2386,
        243.5757, 242.4667, 241.4861, 240.8214, 240.3847, 240.0288, 629.2130,
        743.1397, 715.7798, 569.2548, 795.7614, 713.8688, 596.9832, 692.1696,
        530.2613, 524.4102, 540.3705, 557.3856, 374.2489, 954.9459, 695.4966,
        512.2714, 463.9355, 544.5372, 346.0448, 532.4634, 736.5165, 304.4758,
        619.1702, 609.4939], device='cuda:3')
sorted_norm is   tensor([240.0288, 240.3847, 240.8214, 241.4861, 242.4667, 243.5757, 245.2386,
        247.8077, 251.9963, 259.9528, 277.2964, 304.4758, 335.2135, 346.0448,
        374.2489, 420.8047, 437.8878, 452.3012, 463.9355, 474.7715, 493.8266,
        497.4196, 512.2714, 524.4102, 528.2715, 530.2613, 532.4634, 540.3705,
        544.5372, 557.3856, 569.2548, 596.9832, 609.4939, 619.1702, 629.2130,
        673.2766, 692.1696, 695.4966, 713.8688, 715.7798, 736.5165, 743.1397,
        795.7614, 954.9459], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9, 41,  8, 38, 32,  7,  4,  5,
        36,  6,  0,  2, 35, 29,  1, 28, 39, 30, 37, 31, 23, 26, 43, 42, 20],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 90.57% 

Test Accuracy: 86.74% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6359115745872259
distance x is tensor(99.2247, device='cuda:3')
benign distance is  tensor(99.2247, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8264166191220284
distance x is tensor(106.7975, device='cuda:3')
benign distance is  tensor(106.7975, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6456875838339329
distance x is tensor(101.5180, device='cuda:3')
benign distance is  tensor(101.5180, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.035470999777317
distance x is tensor(147.0669, device='cuda:3')
benign distance is  tensor(147.0669, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1967050954699516
distance x is tensor(82.2950, device='cuda:3')
benign distance is  tensor(82.2950, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6338400105014443
distance x is tensor(99.8975, device='cuda:3')
benign distance is  tensor(99.8975, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.31260253675282
distance x is tensor(84.7871, device='cuda:3')
benign distance is  tensor(84.7871, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6261322516947985
distance x is tensor(76.8886, device='cuda:3')
benign distance is  tensor(76.8886, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1937847211956978
distance x is tensor(90.8544, device='cuda:3')
benign distance is  tensor(90.8544, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.582507929764688
distance x is tensor(110.5696, device='cuda:3')
benign distance is  tensor(110.5696, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9242229461669922
distance x is tensor(66.7677, device='cuda:3')
benign distance is  tensor(66.7677, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2922472767531872
distance x is tensor(107.1118, device='cuda:3')
benign distance is  tensor(107.1118, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0782241970300674
distance x is tensor(153.3011, device='cuda:3')
benign distance is  tensor(153.3011, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6240252247080207
distance x is tensor(54.8857, device='cuda:3')
benign distance is  tensor(54.8857, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0044387206435204
distance x is tensor(127.7738, device='cuda:3')
benign distance is  tensor(127.7738, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2736654505133629
distance x is tensor(116.9663, device='cuda:3')
benign distance is  tensor(116.9663, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1326724141836166
distance x is tensor(91.4885, device='cuda:3')
benign distance is  tensor(91.4885, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7640031408518553
distance x is tensor(103.8128, device='cuda:3')
benign distance is  tensor(103.8128, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.982199814170599
distance x is tensor(111.7214, device='cuda:3')
benign distance is  tensor(111.7214, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8396452348679304
distance x is tensor(112.5646, device='cuda:3')
benign distance is  tensor(112.5646, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9278363734483719
distance x is tensor(75.9901, device='cuda:3')
benign distance is  tensor(75.9901, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7027789615094662
distance x is tensor(199.6552, device='cuda:3')
benign distance is  tensor(199.6552, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0778713077306747
distance x is tensor(144.0049, device='cuda:3')
benign distance is  tensor(144.0049, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7933794669806957
distance x is tensor(108.2045, device='cuda:3')
benign distance is  tensor(108.2045, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.9688679743558168
distance x is tensor(103.7236, device='cuda:3')
benign distance is  tensor(103.7236, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2913728691637516
distance x is tensor(127.1572, device='cuda:3')
benign distance is  tensor(127.1572, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2216838635504246
distance x is tensor(142.6408, device='cuda:3')
benign distance is  tensor(142.6408, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9280751012265682
distance x is tensor(88.6477, device='cuda:3')
benign distance is  tensor(88.6477, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6368797216564417
distance x is tensor(144.5629, device='cuda:3')
benign distance is  tensor(144.5629, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7585260849446058
distance x is tensor(131.3211, device='cuda:3')
benign distance is  tensor(131.3211, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7920739538967609
distance x is tensor(96.8529, device='cuda:3')
benign distance is  tensor(96.8529, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6643597297370434
distance x is tensor(110.6257, device='cuda:3')
benign distance is  tensor(110.6257, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([479.9219, 534.5311, 497.7155, 707.7183, 385.4422, 467.8480, 397.1895,
        367.4537, 333.0710, 274.5301, 256.6459, 248.7289, 244.2867, 241.5115,
        239.7179, 238.4639, 237.6592, 236.9431, 236.3792, 235.9597],
       device='cuda:3')
sorted_norm is   tensor([235.9597, 236.3792, 236.9431, 237.6592, 238.4639, 239.7179, 241.5115,
        244.2867, 248.7289, 256.6459, 274.5301, 333.0710, 367.4537, 385.4422,
        397.1895, 467.8480, 479.9219, 497.7155, 534.5311, 707.7183],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  4,  6,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 86.86% 

Test Accuracy: 83.37% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6415992937982082
distance x is tensor(111.4238, device='cuda:3')
benign distance is  tensor(111.4238, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7813880983740091
distance x is tensor(95.6318, device='cuda:3')
benign distance is  tensor(95.6318, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7115665376186371
distance x is tensor(98.7218, device='cuda:3')
benign distance is  tensor(98.7218, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8567432351410389
distance x is tensor(153.9542, device='cuda:3')
benign distance is  tensor(153.9542, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8199919387698174
distance x is tensor(92.0525, device='cuda:3')
benign distance is  tensor(92.0525, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6947833383455873
distance x is tensor(96.5332, device='cuda:3')
benign distance is  tensor(96.5332, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1798331774771214
distance x is tensor(89.7554, device='cuda:3')
benign distance is  tensor(89.7554, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6829009894281626
distance x is tensor(86.5775, device='cuda:3')
benign distance is  tensor(86.5775, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([528.6335, 473.5108, 480.9606, 728.1031, 429.2361, 446.8340, 426.9364,
        409.3305, 333.4696, 277.6260, 260.9753, 253.5555, 249.7253, 247.4407,
        245.8844, 244.8328, 243.9660, 243.3563, 242.7688, 242.3908, 568.9767,
        468.0920, 605.0388, 589.4834, 559.1323, 537.9098, 525.5518, 768.1826,
        469.0896, 553.2887, 373.3153, 545.0831, 756.7474, 316.5331, 632.8801,
        590.7578], device='cuda:3')
sorted_norm is   tensor([242.3908, 242.7688, 243.3563, 243.9660, 244.8328, 245.8844, 247.4407,
        249.7253, 253.5555, 260.9753, 277.6260, 316.5331, 333.4696, 373.3153,
        409.3305, 426.9364, 429.2361, 446.8340, 468.0920, 469.0896, 473.5108,
        480.9606, 525.5518, 528.6335, 537.9098, 545.0831, 553.2887, 559.1323,
        568.9767, 589.4834, 590.7578, 605.0388, 632.8801, 728.1031, 756.7474,
        768.1826], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9, 33,  8, 30,  7,  6,  4,  5,
        21, 28,  1,  2, 26,  0, 25, 31, 29, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 86.05% 

Test Accuracy: 84.58% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8117400165647268
distance x is tensor(120.8721, device='cuda:3')
benign distance is  tensor(120.8721, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8866207040846348
distance x is tensor(96.0146, device='cuda:3')
benign distance is  tensor(96.0146, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6577522624284029
distance x is tensor(99.1643, device='cuda:3')
benign distance is  tensor(99.1643, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.02010989934206
distance x is tensor(144.7733, device='cuda:3')
benign distance is  tensor(144.7733, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9162169117480516
distance x is tensor(86.3545, device='cuda:3')
benign distance is  tensor(86.3545, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8216984383761883
distance x is tensor(103.4081, device='cuda:3')
benign distance is  tensor(103.4081, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0312592145055532
distance x is tensor(79.1904, device='cuda:3')
benign distance is  tensor(79.1904, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8346014209091663
distance x is tensor(86.1875, device='cuda:3')
benign distance is  tensor(86.1875, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9172493070363998
distance x is tensor(89.0944, device='cuda:3')
benign distance is  tensor(89.0944, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5627013286575675
distance x is tensor(112.6530, device='cuda:3')
benign distance is  tensor(112.6530, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0907477922737598
distance x is tensor(69.4797, device='cuda:3')
benign distance is  tensor(69.4797, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.315615776926279
distance x is tensor(107.4828, device='cuda:3')
benign distance is  tensor(107.4828, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8657995034009218
distance x is tensor(151.2525, device='cuda:3')
benign distance is  tensor(151.2525, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6906136367470026
distance x is tensor(63.1457, device='cuda:3')
benign distance is  tensor(63.1457, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8668671250343323
distance x is tensor(129.7079, device='cuda:3')
benign distance is  tensor(129.7079, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3784157298505306
distance x is tensor(115.4115, device='cuda:3')
benign distance is  tensor(115.4115, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2105561718344688
distance x is tensor(105.7190, device='cuda:3')
benign distance is  tensor(105.7190, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6852669417858124
distance x is tensor(88.4808, device='cuda:3')
benign distance is  tensor(88.4808, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9777684044092894
distance x is tensor(119.1878, device='cuda:3')
benign distance is  tensor(119.1878, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.4337031729519367
distance x is tensor(101.1651, device='cuda:3')
benign distance is  tensor(101.1651, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8249075151979923
distance x is tensor(111.4551, device='cuda:3')
benign distance is  tensor(111.4551, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.191402543336153
distance x is tensor(127.8961, device='cuda:3')
benign distance is  tensor(127.8961, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5712512452155352
distance x is tensor(100.0114, device='cuda:3')
benign distance is  tensor(100.0114, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8134800679981709
distance x is tensor(163.4195, device='cuda:3')
benign distance is  tensor(163.4195, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([571.6328, 473.3209, 467.6607, 689.1992, 413.2843, 463.8398, 380.7238,
        403.0538, 327.1809, 271.4696, 254.6083, 247.2042, 243.1219, 240.5973,
        238.8899, 237.8387, 237.1121, 236.6010, 236.0547, 235.7143, 478.1115,
        524.8115, 548.1533, 573.2831, 394.8422, 927.6721, 698.6498, 551.4863],
       device='cuda:3')
sorted_norm is   tensor([235.7143, 236.0547, 236.6010, 237.1121, 237.8387, 238.8899, 240.5973,
        243.1219, 247.2042, 254.6083, 271.4696, 327.1809, 380.7238, 394.8422,
        403.0538, 413.2843, 463.8398, 467.6607, 473.3209, 478.1115, 524.8115,
        548.1533, 551.4863, 571.6328, 573.2831, 689.1992, 698.6498, 927.6721],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6, 24,  7,  4,  5,  2,
         1, 20, 21, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 82.70% 

Test Accuracy: 83.48% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6163119226694107
distance x is tensor(116.2690, device='cuda:3')
benign distance is  tensor(116.2690, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9860225506126881
distance x is tensor(105.0238, device='cuda:3')
benign distance is  tensor(105.0238, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6362105384469032
distance x is tensor(102.7949, device='cuda:3')
benign distance is  tensor(102.7949, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0732376947999
distance x is tensor(148.9976, device='cuda:3')
benign distance is  tensor(148.9976, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.944751787930727
distance x is tensor(82.0300, device='cuda:3')
benign distance is  tensor(82.0300, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7145532323047519
distance x is tensor(96.8319, device='cuda:3')
benign distance is  tensor(96.8319, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.257970992475748
distance x is tensor(87.2777, device='cuda:3')
benign distance is  tensor(87.2777, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7325429618358612
distance x is tensor(85.5431, device='cuda:3')
benign distance is  tensor(85.5431, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1199111379683018
distance x is tensor(92.8686, device='cuda:3')
benign distance is  tensor(92.8686, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7083051390945911
distance x is tensor(99.8303, device='cuda:3')
benign distance is  tensor(99.8303, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0879350453615189
distance x is tensor(111.3182, device='cuda:3')
benign distance is  tensor(111.3182, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9898045621812344
distance x is tensor(120.2138, device='cuda:3')
benign distance is  tensor(120.2138, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.163952762261033
distance x is tensor(77.3718, device='cuda:3')
benign distance is  tensor(77.3718, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8371076826006174
distance x is tensor(197.2986, device='cuda:3')
benign distance is  tensor(197.2986, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.097010973840952
distance x is tensor(142.6243, device='cuda:3')
benign distance is  tensor(142.6243, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8903408572077751
distance x is tensor(114.9169, device='cuda:3')
benign distance is  tensor(114.9169, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([549.1215, 516.0297, 489.5965, 715.8776, 387.8047, 459.0434, 416.2414,
        411.6412, 327.5523, 272.0401, 255.5583, 248.2025, 244.1819, 241.7233,
        240.0510, 238.8414, 238.1051, 237.5872, 237.0056, 236.7522, 613.4692,
        531.3463, 698.6163, 622.6404, 541.2728, 511.8255, 488.6375, 577.4972,
        440.2250, 545.6405, 350.3191, 530.9713, 729.0060, 313.0002, 619.1970,
        581.2159], device='cuda:3')
sorted_norm is   tensor([236.7522, 237.0056, 237.5872, 238.1051, 238.8414, 240.0510, 241.7233,
        244.1819, 248.2025, 255.5583, 272.0401, 313.0002, 327.5523, 350.3191,
        387.8047, 411.6412, 416.2414, 440.2250, 459.0434, 488.6375, 489.5965,
        511.8255, 516.0297, 530.9713, 531.3463, 541.2728, 545.6405, 549.1215,
        577.4972, 581.2159, 613.4692, 619.1970, 622.6404, 698.6163, 715.8776,
        729.0060], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9, 33,  8, 30,  4,  7,  6, 28,
         5, 26,  2, 25,  1, 31, 21, 24, 29,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 82.24% 

Test Accuracy: 84.32% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5924128275364637
distance x is tensor(111.2064, device='cuda:3')
benign distance is  tensor(111.2064, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.91958362236619
distance x is tensor(100.2541, device='cuda:3')
benign distance is  tensor(100.2541, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7707136329263449
distance x is tensor(102.0851, device='cuda:3')
benign distance is  tensor(102.0851, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9900380857288837
distance x is tensor(150.0741, device='cuda:3')
benign distance is  tensor(150.0741, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8985841982066631
distance x is tensor(84.2212, device='cuda:3')
benign distance is  tensor(84.2212, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7168093780055642
distance x is tensor(86.8755, device='cuda:3')
benign distance is  tensor(86.8755, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2881887443363667
distance x is tensor(80.5640, device='cuda:3')
benign distance is  tensor(80.5640, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7575011998414993
distance x is tensor(79.2300, device='cuda:3')
benign distance is  tensor(79.2300, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0325037762522697
distance x is tensor(87.6204, device='cuda:3')
benign distance is  tensor(87.6204, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6822346393018961
distance x is tensor(114.0164, device='cuda:3')
benign distance is  tensor(114.0164, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3689510747790337
distance x is tensor(75.9487, device='cuda:3')
benign distance is  tensor(75.9487, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5905186273157597
distance x is tensor(111.6685, device='cuda:3')
benign distance is  tensor(111.6685, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5803537927567959
distance x is tensor(156.3255, device='cuda:3')
benign distance is  tensor(156.3255, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7985918466001749
distance x is tensor(58.9996, device='cuda:3')
benign distance is  tensor(58.9996, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9374743849039078
distance x is tensor(140.4889, device='cuda:3')
benign distance is  tensor(140.4889, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7062568366527557
distance x is tensor(118.0568, device='cuda:3')
benign distance is  tensor(118.0568, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7634810488671064
distance x is tensor(116.5352, device='cuda:3')
benign distance is  tensor(116.5352, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9071604572236538
distance x is tensor(106.6288, device='cuda:3')
benign distance is  tensor(106.6288, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7058815825730562
distance x is tensor(137.5382, device='cuda:3')
benign distance is  tensor(137.5382, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.8137068301439285
distance x is tensor(114.8073, device='cuda:3')
benign distance is  tensor(114.8073, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8783841617405415
distance x is tensor(114.0294, device='cuda:3')
benign distance is  tensor(114.0294, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8326675156131387
distance x is tensor(86.5700, device='cuda:3')
benign distance is  tensor(86.5700, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9058825559914112
distance x is tensor(88.7596, device='cuda:3')
benign distance is  tensor(88.7596, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7440792210400105
distance x is tensor(118.7472, device='cuda:3')
benign distance is  tensor(118.7472, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([539.1627, 484.6759, 483.0007, 703.1757, 395.8646, 406.9667, 384.7358,
        377.8399, 323.1336, 267.3677, 250.5114, 243.2883, 239.5214, 237.0656,
        235.4372, 234.3967, 233.4853, 232.9107, 232.4620, 232.0982],
       device='cuda:3')
sorted_norm is   tensor([232.0982, 232.4620, 232.9107, 233.4853, 234.3967, 235.4372, 237.0656,
        239.5214, 243.2883, 250.5114, 267.3677, 323.1336, 377.8399, 384.7358,
        395.8646, 406.9667, 483.0007, 484.6759, 539.1627, 703.1757],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  4,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 76.14% 

Test Accuracy: 79.77% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8651583530008793
distance x is tensor(123.3411, device='cuda:3')
benign distance is  tensor(123.3411, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9902513138949871
distance x is tensor(97.0288, device='cuda:3')
benign distance is  tensor(97.0288, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9063497669994831
distance x is tensor(101.7390, device='cuda:3')
benign distance is  tensor(101.7390, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.097131583839655
distance x is tensor(150.5389, device='cuda:3')
benign distance is  tensor(150.5389, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3093570247292519
distance x is tensor(96.1482, device='cuda:3')
benign distance is  tensor(96.1482, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.032817117869854
distance x is tensor(102.0109, device='cuda:3')
benign distance is  tensor(102.0109, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5468134433031082
distance x is tensor(96.1354, device='cuda:3')
benign distance is  tensor(96.1354, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9486600048840046
distance x is tensor(86.1735, device='cuda:3')
benign distance is  tensor(86.1735, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([597.7980, 478.2878, 487.9755, 720.4480, 443.9352, 475.9124, 481.9498,
        409.8383, 321.4442, 267.7245, 251.5676, 244.6593, 240.9513, 238.7890,
        237.2527, 236.1204, 235.3337, 234.7222, 234.3068, 233.8373, 636.9590,
        738.0100, 778.0198, 572.8847, 802.9673, 735.3718, 621.9955, 654.1608,
        571.2902, 528.3610, 642.5448, 573.1450, 598.0935, 666.0872, 558.1948,
        816.7809, 498.4161, 525.0517, 574.7252, 618.8279, 427.1308, 944.3424,
        713.6899, 594.4464, 459.8621, 578.3947, 407.9647, 568.6302, 767.5776,
        331.3622, 678.9634, 617.8911], device='cuda:3')
sorted_norm is   tensor([233.8373, 234.3068, 234.7222, 235.3337, 236.1204, 237.2527, 238.7890,
        240.9513, 244.6593, 251.5676, 267.7245, 321.4442, 331.3622, 407.9647,
        409.8383, 427.1308, 443.9352, 459.8621, 475.9124, 478.2878, 481.9498,
        487.9755, 498.4161, 525.0517, 528.3610, 558.1948, 568.6302, 571.2902,
        572.8847, 573.1450, 574.7252, 578.3947, 594.4464, 597.7980, 598.0935,
        617.8911, 618.8279, 621.9955, 636.9590, 642.5448, 654.1608, 666.0872,
        678.9634, 713.6899, 720.4480, 735.3718, 738.0100, 767.5776, 778.0198,
        802.9673, 816.7809, 944.3424], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 49, 46,  7, 40,  4, 44,
         5,  1,  6,  2, 36, 37, 29, 34, 47, 28, 23, 31, 38, 45, 43,  0, 32, 51,
        39, 26, 20, 30, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 79.98% 

Test Accuracy: 84.47% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9567709024995565
distance x is tensor(112.6351, device='cuda:3')
benign distance is  tensor(112.6351, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8920713737607002
distance x is tensor(103.2847, device='cuda:3')
benign distance is  tensor(103.2847, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7064549755305052
distance x is tensor(95.5282, device='cuda:3')
benign distance is  tensor(95.5282, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9862246438860893
distance x is tensor(152.1391, device='cuda:3')
benign distance is  tensor(152.1391, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.131623836234212
distance x is tensor(87.4285, device='cuda:3')
benign distance is  tensor(87.4285, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8497196771204472
distance x is tensor(90.1143, device='cuda:3')
benign distance is  tensor(90.1143, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2241586744785309
distance x is tensor(82.3333, device='cuda:3')
benign distance is  tensor(82.3333, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9117267988622189
distance x is tensor(85.3503, device='cuda:3')
benign distance is  tensor(85.3503, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3075993321835995
distance x is tensor(94.2324, device='cuda:3')
benign distance is  tensor(94.2324, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6573216915130615
distance x is tensor(126.9822, device='cuda:3')
benign distance is  tensor(126.9822, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3396179042756557
distance x is tensor(69.8747, device='cuda:3')
benign distance is  tensor(69.8747, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.447565209120512
distance x is tensor(108.9320, device='cuda:3')
benign distance is  tensor(108.9320, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0592787936329842
distance x is tensor(158.1439, device='cuda:3')
benign distance is  tensor(158.1439, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8233327716588974
distance x is tensor(57.3976, device='cuda:3')
benign distance is  tensor(57.3976, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0378479100763798
distance x is tensor(138.5769, device='cuda:3')
benign distance is  tensor(138.5769, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4626915380358696
distance x is tensor(116.7581, device='cuda:3')
benign distance is  tensor(116.7581, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.081579688936472
distance x is tensor(79.8579, device='cuda:3')
benign distance is  tensor(79.8579, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8662136532366276
distance x is tensor(102.1020, device='cuda:3')
benign distance is  tensor(102.1020, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9587340019643307
distance x is tensor(113.2355, device='cuda:3')
benign distance is  tensor(113.2355, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1432503201067448
distance x is tensor(113.5619, device='cuda:3')
benign distance is  tensor(113.5619, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1535833217203617
distance x is tensor(76.9919, device='cuda:3')
benign distance is  tensor(76.9919, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7442042045295238
distance x is tensor(188.4525, device='cuda:3')
benign distance is  tensor(188.4525, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1619337871670723
distance x is tensor(151.1350, device='cuda:3')
benign distance is  tensor(151.1350, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9197890367358923
distance x is tensor(100.4944, device='cuda:3')
benign distance is  tensor(100.4944, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5129886902868748
distance x is tensor(113.6335, device='cuda:3')
benign distance is  tensor(113.6335, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7716880571097136
distance x is tensor(85.0083, device='cuda:3')
benign distance is  tensor(85.0083, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0417211763560772
distance x is tensor(121.4781, device='cuda:3')
benign distance is  tensor(121.4781, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.598226722329855
distance x is tensor(103.9607, device='cuda:3')
benign distance is  tensor(103.9607, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9303881358355284
distance x is tensor(108.4477, device='cuda:3')
benign distance is  tensor(108.4477, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9152532927691936
distance x is tensor(97.2615, device='cuda:3')
benign distance is  tensor(97.2615, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.569727236405015
distance x is tensor(108.5880, device='cuda:3')
benign distance is  tensor(108.5880, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8554859906435013
distance x is tensor(155.9416, device='cuda:3')
benign distance is  tensor(155.9416, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.6306818388402462
distance x is tensor(99.3603, device='cuda:3')
benign distance is  tensor(99.3603, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.4910792633891106
distance x is tensor(129.9133, device='cuda:3')
benign distance is  tensor(129.9133, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0038920268416405
distance x is tensor(141.1887, device='cuda:3')
benign distance is  tensor(141.1887, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.025629960000515
distance x is tensor(80.6138, device='cuda:3')
benign distance is  tensor(80.6138, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.767698559910059
distance x is tensor(149.7632, device='cuda:3')
benign distance is  tensor(149.7632, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8683114536106586
distance x is tensor(127.8304, device='cuda:3')
benign distance is  tensor(127.8304, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8856300003826618
distance x is tensor(91.6001, device='cuda:3')
benign distance is  tensor(91.6001, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6302683763206005
distance x is tensor(121.8764, device='cuda:3')
benign distance is  tensor(121.8764, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([553.3222, 513.4022, 466.5343, 723.7337, 409.4572, 425.4768, 412.7412,
        405.0338, 316.1848, 261.3985, 244.4105, 237.4069, 233.4973, 231.1997,
        229.6895, 228.5957, 227.7210, 227.0923, 226.5463, 226.1212],
       device='cuda:3')
sorted_norm is   tensor([226.1212, 226.5463, 227.0923, 227.7210, 228.5957, 229.6895, 231.1997,
        233.4973, 237.4069, 244.4105, 261.3985, 316.1848, 405.0338, 409.4572,
        412.7412, 425.4768, 466.5343, 513.4022, 553.3222, 723.7337],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  4,  6,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 74.95% 

Test Accuracy: 81.53% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.899351691827178
distance x is tensor(115.8549, device='cuda:3')
benign distance is  tensor(115.8549, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2493580132722855
distance x is tensor(106.7771, device='cuda:3')
benign distance is  tensor(106.7771, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8410292137414217
distance x is tensor(102.4120, device='cuda:3')
benign distance is  tensor(102.4120, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.080024104565382
distance x is tensor(147.4416, device='cuda:3')
benign distance is  tensor(147.4416, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1572897359728813
distance x is tensor(91.8830, device='cuda:3')
benign distance is  tensor(91.8830, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8471785821020603
distance x is tensor(98.2278, device='cuda:3')
benign distance is  tensor(98.2278, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4917357489466667
distance x is tensor(81.5953, device='cuda:3')
benign distance is  tensor(81.5953, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9337334260344505
distance x is tensor(88.7575, device='cuda:3')
benign distance is  tensor(88.7575, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([567.3199, 516.8185, 491.5567, 709.8582, 441.7614, 454.6455, 398.4827,
        414.8756, 316.4190, 262.7548, 246.9385, 239.9117, 236.0354, 233.8571,
        232.3918, 231.3562, 230.6150, 230.0027, 229.4871, 229.2912, 492.7684,
        635.3433, 383.6801, 563.7868, 780.0215, 329.1148, 669.3923, 600.9787],
       device='cuda:3')
sorted_norm is   tensor([229.2912, 229.4871, 230.0027, 230.6150, 231.3562, 232.3918, 233.8571,
        236.0354, 239.9117, 246.9385, 262.7548, 316.4190, 329.1148, 383.6801,
        398.4827, 414.8756, 441.7614, 454.6455, 491.5567, 492.7684, 516.8185,
        563.7868, 567.3199, 600.9787, 635.3433, 669.3923, 709.8582, 780.0215],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 25, 22,  6,  7,  4,  5,
         2, 20,  1, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 69.26% 

Test Accuracy: 80.60% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8736182451248169
distance x is tensor(114.1949, device='cuda:3')
benign distance is  tensor(114.1949, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0964947752654552
distance x is tensor(93.2552, device='cuda:3')
benign distance is  tensor(93.2552, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9539034925401211
distance x is tensor(100.9263, device='cuda:3')
benign distance is  tensor(100.9263, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9757147617638111
distance x is tensor(145.3803, device='cuda:3')
benign distance is  tensor(145.3803, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0899602733552456
distance x is tensor(90.9588, device='cuda:3')
benign distance is  tensor(90.9588, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8977433331310749
distance x is tensor(103.8598, device='cuda:3')
benign distance is  tensor(103.8598, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.629624329507351
distance x is tensor(84.8306, device='cuda:3')
benign distance is  tensor(84.8306, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9731570668518543
distance x is tensor(89.3981, device='cuda:3')
benign distance is  tensor(89.3981, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0245388001203537
distance x is tensor(101.3713, device='cuda:3')
benign distance is  tensor(101.3713, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9547414928674698
distance x is tensor(113.2402, device='cuda:3')
benign distance is  tensor(113.2402, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1772920824587345
distance x is tensor(78.6301, device='cuda:3')
benign distance is  tensor(78.6301, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7562678083777428
distance x is tensor(110.6174, device='cuda:3')
benign distance is  tensor(110.6174, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.430418685078621
distance x is tensor(148.1796, device='cuda:3')
benign distance is  tensor(148.1796, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.286928504705429
distance x is tensor(69.5288, device='cuda:3')
benign distance is  tensor(69.5288, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2735105566680431
distance x is tensor(137.1207, device='cuda:3')
benign distance is  tensor(137.1207, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.1258064210414886
distance x is tensor(117.9697, device='cuda:3')
benign distance is  tensor(117.9697, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([564.9979, 461.0885, 492.2438, 695.0449, 421.8062, 489.4833, 425.4535,
        426.3663, 311.1463, 257.3675, 241.5060, 234.4501, 230.5549, 228.2074,
        226.8000, 225.7892, 225.0087, 224.4646, 224.0737, 223.7733, 650.1608,
        576.6167, 721.5639, 620.2606, 610.3431, 497.4446, 515.4512, 634.8486,
        470.4912, 541.9343, 586.0726, 598.4622, 429.1283, 912.4312, 761.9413,
        542.4630], device='cuda:3')
sorted_norm is   tensor([223.7733, 224.0737, 224.4646, 225.0087, 225.7892, 226.8000, 228.2074,
        230.5549, 234.4501, 241.5060, 257.3675, 311.1463, 421.8062, 425.4535,
        426.3663, 429.1283, 461.0885, 470.4912, 489.4833, 492.2438, 497.4446,
        515.4512, 541.9343, 542.4630, 564.9979, 576.6167, 586.0726, 598.4622,
        610.3431, 620.2606, 634.8486, 650.1608, 695.0449, 721.5639, 761.9413,
        912.4312], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  6,  7, 32,  1, 28,
         5,  2, 25, 26, 29, 35,  0, 21, 30, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 70.46% 

Test Accuracy: 81.87% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8225867990404367
distance x is tensor(117.6716, device='cuda:3')
benign distance is  tensor(117.6716, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.074800830334425
distance x is tensor(100.0008, device='cuda:3')
benign distance is  tensor(100.0008, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8411631565541029
distance x is tensor(96.9606, device='cuda:3')
benign distance is  tensor(96.9606, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2191979810595512
distance x is tensor(148.5077, device='cuda:3')
benign distance is  tensor(148.5077, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0674082562327385
distance x is tensor(91.5006, device='cuda:3')
benign distance is  tensor(91.5006, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.914248414337635
distance x is tensor(101.9527, device='cuda:3')
benign distance is  tensor(101.9527, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.377155914902687
distance x is tensor(89.4910, device='cuda:3')
benign distance is  tensor(89.4910, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8059457167983055
distance x is tensor(85.7804, device='cuda:3')
benign distance is  tensor(85.7804, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4891837164759636
distance x is tensor(90.8832, device='cuda:3')
benign distance is  tensor(90.8832, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0020736753940582
distance x is tensor(111.9162, device='cuda:3')
benign distance is  tensor(111.9162, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2821296490728855
distance x is tensor(125.6591, device='cuda:3')
benign distance is  tensor(125.6591, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0554502233862877
distance x is tensor(124.9336, device='cuda:3')
benign distance is  tensor(124.9336, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.302977230399847
distance x is tensor(76.3418, device='cuda:3')
benign distance is  tensor(76.3418, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9367793127894402
distance x is tensor(198.2519, device='cuda:3')
benign distance is  tensor(198.2519, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2438649125397205
distance x is tensor(148.3921, device='cuda:3')
benign distance is  tensor(148.3921, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8492271546274424
distance x is tensor(113.0151, device='cuda:3')
benign distance is  tensor(113.0151, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.004111435264349
distance x is tensor(121.0143, device='cuda:3')
benign distance is  tensor(121.0143, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1572992652654648
distance x is tensor(104.8065, device='cuda:3')
benign distance is  tensor(104.8065, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8409121073782444
distance x is tensor(138.7487, device='cuda:3')
benign distance is  tensor(138.7487, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.8081446439027786
distance x is tensor(125.4347, device='cuda:3')
benign distance is  tensor(125.4347, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.823291739448905
distance x is tensor(120.2577, device='cuda:3')
benign distance is  tensor(120.2577, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9237517099827528
distance x is tensor(87.0306, device='cuda:3')
benign distance is  tensor(87.0306, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9589144475758076
distance x is tensor(92.2578, device='cuda:3')
benign distance is  tensor(92.2578, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6433590650558472
distance x is tensor(121.9442, device='cuda:3')
benign distance is  tensor(121.9442, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([567.5748, 508.7584, 485.3411, 714.7747, 423.2323, 477.8698, 443.4533,
        421.3178, 310.5272, 256.2688, 240.2245, 233.3422, 229.4068, 227.0266,
        225.4377, 224.4036, 223.5839, 222.9774, 222.6112, 222.1139, 583.6273,
        454.6096, 625.9200, 566.8473, 571.1921, 523.9254, 559.0018, 774.5616,
        495.7950, 533.7783, 388.6615, 562.9097, 708.5194, 333.4541, 649.3837,
        592.7396], device='cuda:3')
sorted_norm is   tensor([222.1139, 222.6112, 222.9774, 223.5839, 224.4036, 225.4377, 227.0266,
        229.4068, 233.3422, 240.2245, 256.2688, 310.5272, 333.4541, 388.6615,
        421.3178, 423.2323, 443.4533, 454.6096, 477.8698, 485.3411, 495.7950,
        508.7584, 523.9254, 533.7783, 559.0018, 562.9097, 566.8473, 567.5748,
        571.1921, 583.6273, 592.7396, 625.9200, 649.3837, 708.5194, 714.7747,
        774.5616], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 33, 30,  7,  4,  6, 21,
         5,  2, 28,  1, 25, 29, 26, 31, 23,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 72.48% 

Test Accuracy: 82.44% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.804274907335639
distance x is tensor(116.5991, device='cuda:3')
benign distance is  tensor(116.5991, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0583450496196747
distance x is tensor(102.9235, device='cuda:3')
benign distance is  tensor(102.9235, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8351307958364487
distance x is tensor(108.0175, device='cuda:3')
benign distance is  tensor(108.0175, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3957409486174583
distance x is tensor(152.1310, device='cuda:3')
benign distance is  tensor(152.1310, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.011961579322815
distance x is tensor(95.2893, device='cuda:3')
benign distance is  tensor(95.2893, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9825440049171448
distance x is tensor(98.5726, device='cuda:3')
benign distance is  tensor(98.5726, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.417269915342331
distance x is tensor(85.3909, device='cuda:3')
benign distance is  tensor(85.3909, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9493213314563036
distance x is tensor(82.5201, device='cuda:3')
benign distance is  tensor(82.5201, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4474967271089554
distance x is tensor(100.3606, device='cuda:3')
benign distance is  tensor(100.3606, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8514529764652252
distance x is tensor(119.5648, device='cuda:3')
benign distance is  tensor(119.5648, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2621786929666996
distance x is tensor(79.5900, device='cuda:3')
benign distance is  tensor(79.5900, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.1383924409747124
distance x is tensor(118.2515, device='cuda:3')
benign distance is  tensor(118.2515, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3077256195247173
distance x is tensor(161.8611, device='cuda:3')
benign distance is  tensor(161.8611, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8919571861624718
distance x is tensor(59.6871, device='cuda:3')
benign distance is  tensor(59.6871, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0120234917849302
distance x is tensor(143.7542, device='cuda:3')
benign distance is  tensor(143.7542, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.0542098060250282
distance x is tensor(118.1550, device='cuda:3')
benign distance is  tensor(118.1550, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2259595282375813
distance x is tensor(115.6554, device='cuda:3')
benign distance is  tensor(115.6554, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8941237777471542
distance x is tensor(101.0716, device='cuda:3')
benign distance is  tensor(101.0716, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3573006018996239
distance x is tensor(129.0887, device='cuda:3')
benign distance is  tensor(129.0887, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.6660081595182419
distance x is tensor(113.1886, device='cuda:3')
benign distance is  tensor(113.1886, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.154225006699562
distance x is tensor(115.2720, device='cuda:3')
benign distance is  tensor(115.2720, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.967721302062273
distance x is tensor(96.5380, device='cuda:3')
benign distance is  tensor(96.5380, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.664572374895215
distance x is tensor(118.3401, device='cuda:3')
benign distance is  tensor(118.3401, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.004938367754221
distance x is tensor(159.5567, device='cuda:3')
benign distance is  tensor(159.5567, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([586.1570, 503.7314, 515.0062, 723.7256, 442.8431, 457.7173, 422.6804,
        392.9838, 305.2409, 251.6257, 235.6156, 228.5707, 224.8989, 222.5807,
        221.1102, 219.9877, 219.1812, 218.5498, 218.1678, 217.7911],
       device='cuda:3')
sorted_norm is   tensor([217.7911, 218.1678, 218.5498, 219.1812, 219.9877, 221.1102, 222.5807,
        224.8989, 228.5707, 235.6156, 251.6257, 305.2409, 392.9838, 422.6804,
        442.8431, 457.7173, 503.7314, 515.0062, 586.1570, 723.7256],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  4,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 66.84% 

Test Accuracy: 79.81% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9842986520379782
distance x is tensor(124.5777, device='cuda:3')
benign distance is  tensor(124.5777, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2756714671850204
distance x is tensor(102.5020, device='cuda:3')
benign distance is  tensor(102.5020, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0314453803002834
distance x is tensor(98.2206, device='cuda:3')
benign distance is  tensor(98.2206, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2537225745618343
distance x is tensor(155.9064, device='cuda:3')
benign distance is  tensor(155.9064, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9526240676641464
distance x is tensor(93.3046, device='cuda:3')
benign distance is  tensor(93.3046, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.949905863031745
distance x is tensor(93.2380, device='cuda:3')
benign distance is  tensor(93.2380, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4072035141289234
distance x is tensor(85.5875, device='cuda:3')
benign distance is  tensor(85.5875, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0873294547200203
distance x is tensor(85.6934, device='cuda:3')
benign distance is  tensor(85.6934, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([607.3165, 509.9256, 490.5700, 751.8608, 440.8580, 437.0182, 429.1917,
        407.0972, 303.2109, 250.9714, 235.4204, 228.6688, 225.0107, 222.7400,
        221.2035, 220.2839, 219.5674, 218.9226, 218.4610, 218.0829, 619.1678,
        742.6923, 779.6036, 538.8552, 811.7188, 719.4120, 586.3546, 697.4954,
        505.6116, 573.8725, 629.5363, 624.7928, 426.2206, 968.2657, 744.7545,
        581.8430, 512.5212, 597.5544, 421.4614, 596.1052, 786.8060, 335.4377,
        700.4641, 605.8105], device='cuda:3')
sorted_norm is   tensor([218.0829, 218.4610, 218.9226, 219.5674, 220.2839, 221.2035, 222.7400,
        225.0107, 228.6688, 235.4204, 250.9714, 303.2109, 335.4377, 407.0972,
        421.4614, 426.2206, 429.1917, 437.0182, 440.8580, 490.5700, 505.6116,
        509.9256, 512.5212, 538.8552, 573.8725, 581.8430, 586.3546, 596.1052,
        597.5544, 605.8105, 607.3165, 619.1678, 624.7928, 629.5363, 697.4954,
        700.4641, 719.4120, 742.6923, 744.7545, 751.8608, 779.6036, 786.8060,
        811.7188, 968.2657], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 41,  7, 38, 32,  6,  5,
         4,  2, 28,  1, 36, 23, 29, 35, 26, 39, 37, 43,  0, 20, 31, 30, 27],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 69.34% 

Test Accuracy: 81.92% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7179283984005451
distance x is tensor(111.0050, device='cuda:3')
benign distance is  tensor(111.0050, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0354042686522007
distance x is tensor(108.9240, device='cuda:3')
benign distance is  tensor(108.9240, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0768534988164902
distance x is tensor(112.9192, device='cuda:3')
benign distance is  tensor(112.9192, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.121795643121004
distance x is tensor(157.7430, device='cuda:3')
benign distance is  tensor(157.7430, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0066708903759718
distance x is tensor(81.9236, device='cuda:3')
benign distance is  tensor(81.9236, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.927971076220274
distance x is tensor(93.5120, device='cuda:3')
benign distance is  tensor(93.5120, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7080005705356598
distance x is tensor(94.3635, device='cuda:3')
benign distance is  tensor(94.3635, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.213901873677969
distance x is tensor(89.4668, device='cuda:3')
benign distance is  tensor(89.4668, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3368106856942177
distance x is tensor(91.8468, device='cuda:3')
benign distance is  tensor(91.8468, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.807926569133997
distance x is tensor(112.0826, device='cuda:3')
benign distance is  tensor(112.0826, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4073858745396137
distance x is tensor(70.5791, device='cuda:3')
benign distance is  tensor(70.5791, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.9120515882968903
distance x is tensor(105.5039, device='cuda:3')
benign distance is  tensor(105.5039, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2734034359455109
distance x is tensor(172.5936, device='cuda:3')
benign distance is  tensor(172.5936, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0388770587742329
distance x is tensor(65.6114, device='cuda:3')
benign distance is  tensor(65.6114, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0424608942121267
distance x is tensor(138.7889, device='cuda:3')
benign distance is  tensor(138.7889, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.400662489235401
distance x is tensor(114.3155, device='cuda:3')
benign distance is  tensor(114.3155, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7172282114624977
distance x is tensor(97.2131, device='cuda:3')
benign distance is  tensor(97.2131, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0141005646437407
distance x is tensor(116.7150, device='cuda:3')
benign distance is  tensor(116.7150, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3190440647304058
distance x is tensor(108.0869, device='cuda:3')
benign distance is  tensor(108.0869, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3267344906926155
distance x is tensor(118.4419, device='cuda:3')
benign distance is  tensor(118.4419, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6128529720008373
distance x is tensor(80.3119, device='cuda:3')
benign distance is  tensor(80.3119, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9168893843889236
distance x is tensor(194.9507, device='cuda:3')
benign distance is  tensor(194.9507, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4166124947369099
distance x is tensor(150.1693, device='cuda:3')
benign distance is  tensor(150.1693, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9601118303835392
distance x is tensor(108.5480, device='cuda:3')
benign distance is  tensor(108.5480, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.5928419828414917
distance x is tensor(94.4549, device='cuda:3')
benign distance is  tensor(94.4549, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.8989960104227066
distance x is tensor(130.7459, device='cuda:3')
benign distance is  tensor(130.7459, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.171703301370144
distance x is tensor(139.6102, device='cuda:3')
benign distance is  tensor(139.6102, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.208636675029993
distance x is tensor(88.2717, device='cuda:3')
benign distance is  tensor(88.2717, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7584710381925106
distance x is tensor(155.0605, device='cuda:3')
benign distance is  tensor(155.0605, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0180101804435253
distance x is tensor(130.5029, device='cuda:3')
benign distance is  tensor(130.5029, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1546368934214115
distance x is tensor(104.7610, device='cuda:3')
benign distance is  tensor(104.7610, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6016567158512771
distance x is tensor(133.2930, device='cuda:3')
benign distance is  tensor(133.2930, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([549.4242, 537.1749, 543.8607, 766.2870, 397.8606, 447.8454, 455.2679,
        421.3214, 301.2875, 248.3171, 232.3004, 225.0733, 221.3406, 218.9667,
        217.4609, 216.4923, 215.7783, 215.2241, 214.8239, 214.3598],
       device='cuda:3')
sorted_norm is   tensor([214.3598, 214.8239, 215.2241, 215.7783, 216.4923, 217.4609, 218.9667,
        221.3406, 225.0733, 232.3004, 248.3171, 301.2875, 397.8606, 421.3214,
        447.8454, 455.2679, 537.1749, 543.8607, 549.4242, 766.2870],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  7,  5,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 63.18% 

Test Accuracy: 79.01% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8673365600407124
distance x is tensor(130.6462, device='cuda:3')
benign distance is  tensor(130.6462, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0606293454766273
distance x is tensor(108.8011, device='cuda:3')
benign distance is  tensor(108.8011, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9921047352254391
distance x is tensor(105.9228, device='cuda:3')
benign distance is  tensor(105.9228, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1875657886266708
distance x is tensor(154.4685, device='cuda:3')
benign distance is  tensor(154.4685, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2499286383390427
distance x is tensor(95.4262, device='cuda:3')
benign distance is  tensor(95.4262, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8913589846342802
distance x is tensor(93.2995, device='cuda:3')
benign distance is  tensor(93.2995, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3878566585481167
distance x is tensor(90.5593, device='cuda:3')
benign distance is  tensor(90.5593, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0865961387753487
distance x is tensor(98.9643, device='cuda:3')
benign distance is  tensor(98.9643, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([642.1791, 539.8115, 517.8229, 757.2565, 458.0802, 454.7605, 448.1347,
        480.1974, 297.1282, 245.4037, 230.0635, 223.1204, 219.5802, 217.3774,
        215.8668, 214.8209, 214.0399, 213.4799, 213.0106, 212.5924, 671.1484,
        585.0520, 736.6184, 660.5229, 650.2729, 506.6034, 522.2444, 666.4094,
        602.3761, 574.0405, 662.2610, 619.8361, 614.1640, 545.2235, 614.4370,
        820.3913, 481.6223, 573.8245, 395.0143, 553.7112, 831.9408, 353.5755,
        686.9232, 605.3267], device='cuda:3')
sorted_norm is   tensor([212.5924, 213.0106, 213.4799, 214.0399, 214.8209, 215.8668, 217.3774,
        219.5802, 223.1204, 230.0635, 245.4037, 297.1282, 353.5755, 395.0143,
        448.1347, 454.7605, 458.0802, 480.1974, 481.6223, 506.6034, 517.8229,
        522.2444, 539.8115, 545.2235, 553.7112, 573.8245, 574.0405, 585.0520,
        602.3761, 605.3267, 614.1640, 614.4370, 619.8361, 642.1791, 650.2729,
        660.5229, 662.2610, 666.4094, 671.1484, 686.9232, 736.6184, 757.2565,
        820.3913, 831.9408], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 41, 38,  6,  5,  4,  7,
        36, 25,  2, 26,  1, 33, 39, 37, 29, 21, 28, 43, 32, 34, 31,  0, 24],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 69.16% 

Test Accuracy: 81.81% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8934490084648132
distance x is tensor(128.9462, device='cuda:3')
benign distance is  tensor(128.9462, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9705430343747139
distance x is tensor(102.2146, device='cuda:3')
benign distance is  tensor(102.2146, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8805768731981516
distance x is tensor(101.5041, device='cuda:3')
benign distance is  tensor(101.5041, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.267884410917759
distance x is tensor(153.9741, device='cuda:3')
benign distance is  tensor(153.9741, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.202369499951601
distance x is tensor(97.4725, device='cuda:3')
benign distance is  tensor(97.4725, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0135653335601091
distance x is tensor(90.0546, device='cuda:3')
benign distance is  tensor(90.0546, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.821432188153267
distance x is tensor(94.3323, device='cuda:3')
benign distance is  tensor(94.3323, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8451578188687563
distance x is tensor(78.8895, device='cuda:3')
benign distance is  tensor(78.8895, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.173935778439045
distance x is tensor(111.0817, device='cuda:3')
benign distance is  tensor(111.0817, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8534412980079651
distance x is tensor(122.9958, device='cuda:3')
benign distance is  tensor(122.9958, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4215924702584743
distance x is tensor(74.4208, device='cuda:3')
benign distance is  tensor(74.4208, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.933472417294979
distance x is tensor(121.1881, device='cuda:3')
benign distance is  tensor(121.1881, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.406602717936039
distance x is tensor(153.2554, device='cuda:3')
benign distance is  tensor(153.2554, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0877956449985504
distance x is tensor(63.6948, device='cuda:3')
benign distance is  tensor(63.6948, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.151905745267868
distance x is tensor(133.7742, device='cuda:3')
benign distance is  tensor(133.7742, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9872276820242405
distance x is tensor(120.9066, device='cuda:3')
benign distance is  tensor(120.9066, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.56834015250206
distance x is tensor(114.0785, device='cuda:3')
benign distance is  tensor(114.0785, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0006621219217777
distance x is tensor(111.5431, device='cuda:3')
benign distance is  tensor(111.5431, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3015425987541676
distance x is tensor(137.7872, device='cuda:3')
benign distance is  tensor(137.7872, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.8064789362251759
distance x is tensor(120.3917, device='cuda:3')
benign distance is  tensor(120.3917, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.060668170452118
distance x is tensor(117.3535, device='cuda:3')
benign distance is  tensor(117.3535, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.24467121809721
distance x is tensor(108.1057, device='cuda:3')
benign distance is  tensor(108.1057, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6148272641003132
distance x is tensor(119.2185, device='cuda:3')
benign distance is  tensor(119.2185, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0693120583891869
distance x is tensor(165.9398, device='cuda:3')
benign distance is  tensor(165.9398, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0270309671759605
distance x is tensor(120.3955, device='cuda:3')
benign distance is  tensor(120.3955, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1693348735570908
distance x is tensor(111.6737, device='cuda:3')
benign distance is  tensor(111.6737, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9406923390924931
distance x is tensor(146.5816, device='cuda:3')
benign distance is  tensor(146.5816, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.735449440777302
distance x is tensor(126.5996, device='cuda:3')
benign distance is  tensor(126.5996, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9649832844734192
distance x is tensor(128.9832, device='cuda:3')
benign distance is  tensor(128.9832, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.1180707775056362
distance x is tensor(100.8749, device='cuda:3')
benign distance is  tensor(100.8749, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.1621208749711514
distance x is tensor(88.7407, device='cuda:3')
benign distance is  tensor(88.7407, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.915053790435195
distance x is tensor(124.2005, device='cuda:3')
benign distance is  tensor(124.2005, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([616.6122, 508.6907, 495.2780, 740.9913, 452.4719, 420.6874, 460.3144,
        380.7922, 295.8378, 243.8276, 228.1400, 221.2419, 217.6289, 215.3577,
        213.9321, 212.9776, 212.3815, 211.6801, 211.2362, 210.8542, 511.9014,
        564.1105, 542.3434, 599.4391, 404.7514, 926.2122, 740.2349, 540.9139],
       device='cuda:3')
sorted_norm is   tensor([210.8542, 211.2362, 211.6801, 212.3815, 212.9776, 213.9321, 215.3577,
        217.6289, 221.2419, 228.1400, 243.8276, 295.8378, 380.7922, 404.7514,
        420.6874, 452.4719, 460.3144, 495.2780, 508.6907, 511.9014, 540.9139,
        542.3434, 564.1105, 599.4391, 616.6122, 740.2349, 740.9913, 926.2122],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7, 24,  5,  4,  6,  2,
         1, 20, 27, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 65.01% 

Test Accuracy: 80.51% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.762745913118124
distance x is tensor(131.8476, device='cuda:3')
benign distance is  tensor(131.8476, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9756942018866539
distance x is tensor(96.9489, device='cuda:3')
benign distance is  tensor(96.9489, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0433199405670166
distance x is tensor(105.5294, device='cuda:3')
benign distance is  tensor(105.5294, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2854568473994732
distance x is tensor(155.1694, device='cuda:3')
benign distance is  tensor(155.1694, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1730549521744251
distance x is tensor(91.7430, device='cuda:3')
benign distance is  tensor(91.7430, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9955985303968191
distance x is tensor(89.4731, device='cuda:3')
benign distance is  tensor(89.4731, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1947965919971466
distance x is tensor(107.0302, device='cuda:3')
benign distance is  tensor(107.0302, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1251255385577679
distance x is tensor(83.3694, device='cuda:3')
benign distance is  tensor(83.3694, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4809397235512733
distance x is tensor(89.6483, device='cuda:3')
benign distance is  tensor(89.6483, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1017203852534294
distance x is tensor(108.9292, device='cuda:3')
benign distance is  tensor(108.9292, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.6155029945075512
distance x is tensor(119.9997, device='cuda:3')
benign distance is  tensor(119.9997, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3337413296103477
distance x is tensor(122.8757, device='cuda:3')
benign distance is  tensor(122.8757, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.505273625254631
distance x is tensor(81.3401, device='cuda:3')
benign distance is  tensor(81.3401, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8702153749763966
distance x is tensor(199.6952, device='cuda:3')
benign distance is  tensor(199.6952, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.364019986242056
distance x is tensor(163.6168, device='cuda:3')
benign distance is  tensor(163.6168, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9285591244697571
distance x is tensor(119.5971, device='cuda:3')
benign distance is  tensor(119.5971, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([647.9700, 484.9602, 505.1428, 744.5718, 441.8639, 424.2235, 501.8224,
        403.6853, 294.5834, 242.4150, 226.8551, 220.1172, 216.5716, 214.1760,
        212.6205, 211.5449, 210.9339, 210.3318, 209.8344, 209.5602, 567.3745,
        606.1686, 379.8143, 590.8552, 758.4500, 325.6430, 652.2122, 617.7583],
       device='cuda:3')
sorted_norm is   tensor([209.5602, 209.8344, 210.3318, 210.9339, 211.5449, 212.6205, 214.1760,
        216.5716, 220.1172, 226.8551, 242.4150, 294.5834, 325.6430, 379.8143,
        403.6853, 424.2235, 441.8639, 484.9602, 501.8224, 505.1428, 567.3745,
        590.8552, 606.1686, 617.7583, 647.9700, 652.2122, 744.5718, 758.4500],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 25, 22,  7,  5,  4,  1,
         6,  2, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 62.79% 

Test Accuracy: 79.80% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9127177037298679
distance x is tensor(132.4964, device='cuda:3')
benign distance is  tensor(132.4964, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1557311564683914
distance x is tensor(105.6969, device='cuda:3')
benign distance is  tensor(105.6969, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9059180207550526
distance x is tensor(106.0616, device='cuda:3')
benign distance is  tensor(106.0616, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.253282081335783
distance x is tensor(163.8369, device='cuda:3')
benign distance is  tensor(163.8369, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3020648956298828
distance x is tensor(90.0275, device='cuda:3')
benign distance is  tensor(90.0275, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9958128202706575
distance x is tensor(104.7572, device='cuda:3')
benign distance is  tensor(104.7572, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2671863473951817
distance x is tensor(79.0107, device='cuda:3')
benign distance is  tensor(79.0107, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.056836873292923
distance x is tensor(91.7685, device='cuda:3')
benign distance is  tensor(91.7685, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9191476702690125
distance x is tensor(98.5987, device='cuda:3')
benign distance is  tensor(98.5987, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.116647407412529
distance x is tensor(124.8483, device='cuda:3')
benign distance is  tensor(124.8483, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4873119927942753
distance x is tensor(82.2677, device='cuda:3')
benign distance is  tensor(82.2677, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.8014265596866608
distance x is tensor(106.6946, device='cuda:3')
benign distance is  tensor(106.6946, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3023605905473232
distance x is tensor(170.2468, device='cuda:3')
benign distance is  tensor(170.2468, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3056223765015602
distance x is tensor(71.5334, device='cuda:3')
benign distance is  tensor(71.5334, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.962111234664917
distance x is tensor(141.5975, device='cuda:3')
benign distance is  tensor(141.5975, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.6378028988838196
distance x is tensor(121.5439, device='cuda:3')
benign distance is  tensor(121.5439, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([658.3943, 533.7127, 518.3914, 785.9481, 439.9217, 476.2985, 391.3467,
        448.0386, 290.3229, 239.0119, 223.4296, 216.5241, 212.8762, 210.7041,
        209.2339, 208.2367, 207.4205, 206.8916, 206.3960, 205.9612],
       device='cuda:3')
sorted_norm is   tensor([205.9612, 206.3960, 206.8916, 207.4205, 208.2367, 209.2339, 210.7041,
        212.8762, 216.5241, 223.4296, 239.0119, 290.3229, 391.3467, 439.9217,
        448.0386, 476.2985, 518.3914, 533.7127, 658.3943, 785.9481],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  4,  7,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 60.43% 

Test Accuracy: 78.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8046213965862989
distance x is tensor(137.1198, device='cuda:3')
benign distance is  tensor(137.1198, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6393164545297623
distance x is tensor(117.2437, device='cuda:3')
benign distance is  tensor(117.2437, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5575109124183655
distance x is tensor(126.6589, device='cuda:3')
benign distance is  tensor(126.6589, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1944114305078983
distance x is tensor(159.3226, device='cuda:3')
benign distance is  tensor(159.3226, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.324332308024168
distance x is tensor(96.4262, device='cuda:3')
benign distance is  tensor(96.4262, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0692604053765535
distance x is tensor(110.8586, device='cuda:3')
benign distance is  tensor(110.8586, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9061374738812447
distance x is tensor(97.7455, device='cuda:3')
benign distance is  tensor(97.7455, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.225107315927744
distance x is tensor(97.1548, device='cuda:3')
benign distance is  tensor(97.1548, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([664.4094, 590.3212, 595.9968, 760.1525, 480.1922, 517.4174, 482.1281,
        477.9627, 290.8580, 239.9502, 224.5895, 218.0927, 214.6343, 212.4605,
        211.1635, 210.2425, 209.4394, 208.9310, 208.3783, 208.1086, 598.1635,
        731.9863, 770.2502, 562.7125, 831.8572, 719.6064, 620.6799, 742.5286,
        629.2767, 625.2229, 735.8522, 683.4280, 644.9970, 610.3210, 639.8350,
        846.4102, 511.2440, 591.9399, 613.1877, 650.5145, 457.4827, 963.3610,
        825.1489, 639.4641, 497.8747, 627.5267, 447.1477, 549.1022, 821.6883,
        365.7058, 691.4489, 633.5066], device='cuda:3')
sorted_norm is   tensor([208.1086, 208.3783, 208.9310, 209.4394, 210.2425, 211.1635, 212.4605,
        214.6343, 218.0927, 224.5895, 239.9502, 290.8580, 365.7058, 447.1477,
        457.4827, 477.9627, 480.1922, 482.1281, 497.8747, 511.2440, 517.4174,
        549.1022, 562.7125, 590.3212, 591.9399, 595.9968, 598.1635, 610.3210,
        613.1877, 620.6799, 625.2229, 627.5267, 629.2767, 633.5066, 639.4641,
        639.8350, 644.9970, 650.5145, 664.4094, 683.4280, 691.4489, 719.6064,
        731.9863, 735.8522, 742.5286, 760.1525, 770.2502, 821.6883, 825.1489,
        831.8572, 846.4102, 963.3610], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 49, 46, 40,  7,  4,  6,
        44, 36,  5, 47, 23,  1, 37,  2, 20, 33, 38, 26, 29, 45, 28, 51, 43, 34,
        32, 39,  0, 31, 50], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 62.97% 

Test Accuracy: 80.50% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8199439905583858
distance x is tensor(123.2348, device='cuda:3')
benign distance is  tensor(123.2348, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1870249919593334
distance x is tensor(96.9316, device='cuda:3')
benign distance is  tensor(96.9316, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0622509680688381
distance x is tensor(99.8414, device='cuda:3')
benign distance is  tensor(99.8414, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1977242678403854
distance x is tensor(153.9940, device='cuda:3')
benign distance is  tensor(153.9940, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4657308217138052
distance x is tensor(86.3425, device='cuda:3')
benign distance is  tensor(86.3425, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.246747013181448
distance x is tensor(112.8202, device='cuda:3')
benign distance is  tensor(112.8202, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9462742283940315
distance x is tensor(91.7597, device='cuda:3')
benign distance is  tensor(91.7597, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0773224718868732
distance x is tensor(87.4473, device='cuda:3')
benign distance is  tensor(87.4473, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.267765611410141
distance x is tensor(98.0742, device='cuda:3')
benign distance is  tensor(98.0742, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0438337586820126
distance x is tensor(117.5988, device='cuda:3')
benign distance is  tensor(117.5988, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3902137652039528
distance x is tensor(71.4738, device='cuda:3')
benign distance is  tensor(71.4738, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3286427408456802
distance x is tensor(111.7869, device='cuda:3')
benign distance is  tensor(111.7869, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4349762760102749
distance x is tensor(157.5095, device='cuda:3')
benign distance is  tensor(157.5095, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9277823399752378
distance x is tensor(64.8097, device='cuda:3')
benign distance is  tensor(64.8097, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1131042689085007
distance x is tensor(131.6549, device='cuda:3')
benign distance is  tensor(131.6549, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.707976281642914
distance x is tensor(121.0911, device='cuda:3')
benign distance is  tensor(121.0911, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8191101998090744
distance x is tensor(99.9333, device='cuda:3')
benign distance is  tensor(99.9333, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0113271661102772
distance x is tensor(114.8502, device='cuda:3')
benign distance is  tensor(114.8502, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3707708418369293
distance x is tensor(115.5317, device='cuda:3')
benign distance is  tensor(115.5317, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.395816132426262
distance x is tensor(127.0017, device='cuda:3')
benign distance is  tensor(127.0017, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.618333876132965
distance x is tensor(89.1316, device='cuda:3')
benign distance is  tensor(89.1316, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9755943939089775
distance x is tensor(198.9335, device='cuda:3')
benign distance is  tensor(198.9335, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3442735485732555
distance x is tensor(156.3781, device='cuda:3')
benign distance is  tensor(156.3781, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0835452228784561
distance x is tensor(112.6122, device='cuda:3')
benign distance is  tensor(112.6122, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5198490917682648
distance x is tensor(108.1300, device='cuda:3')
benign distance is  tensor(108.1300, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9752634316682816
distance x is tensor(86.2102, device='cuda:3')
benign distance is  tensor(86.2102, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.386711411178112
distance x is tensor(128.1134, device='cuda:3')
benign distance is  tensor(128.1134, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.1673331409692764
distance x is tensor(124.4562, device='cuda:3')
benign distance is  tensor(124.4562, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2430436089634895
distance x is tensor(116.2218, device='cuda:3')
benign distance is  tensor(116.2218, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.055864967405796
distance x is tensor(113.9550, device='cuda:3')
benign distance is  tensor(113.9550, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7270912863314152
distance x is tensor(116.2031, device='cuda:3')
benign distance is  tensor(116.2031, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1583825126290321
distance x is tensor(160.2601, device='cuda:3')
benign distance is  tensor(160.2601, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.6801354810595512
distance x is tensor(102.4376, device='cuda:3')
benign distance is  tensor(102.4376, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.676104597747326
distance x is tensor(134.4061, device='cuda:3')
benign distance is  tensor(134.4061, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.9441167265176773
distance x is tensor(153.3177, device='cuda:3')
benign distance is  tensor(153.3177, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3542800582945347
distance x is tensor(93.7289, device='cuda:3')
benign distance is  tensor(93.7289, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8592271246016026
distance x is tensor(152.7863, device='cuda:3')
benign distance is  tensor(152.7863, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0655451491475105
distance x is tensor(128.1656, device='cuda:3')
benign distance is  tensor(128.1656, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.3050201646983624
distance x is tensor(105.8802, device='cuda:3')
benign distance is  tensor(105.8802, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8183865193277597
distance x is tensor(143.7272, device='cuda:3')
benign distance is  tensor(143.7272, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([595.7048, 493.3208, 491.1615, 750.5330, 417.1232, 522.5270, 446.3516,
        424.2186, 288.9557, 236.9985, 221.7605, 215.2100, 211.4247, 209.1019,
        207.6614, 206.6067, 205.7403, 205.2805, 204.9374, 204.5064, 640.8994,
        564.4218, 729.5530, 646.6827, 647.0864, 522.0999, 481.2744, 642.3398],
       device='cuda:3')
sorted_norm is   tensor([204.5064, 204.9374, 205.2805, 205.7403, 206.6067, 207.6614, 209.1019,
        211.4247, 215.2100, 221.7605, 236.9985, 288.9557, 417.1232, 424.2186,
        446.3516, 481.2744, 491.1615, 493.3208, 522.0999, 522.5270, 564.4218,
        595.7048, 640.8994, 642.3398, 646.6827, 647.0864, 729.5530, 750.5330],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  4,  7,  6, 26,  2,  1,
        25,  5, 21,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 63.21% 

Test Accuracy: 80.11% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7271670233458281
distance x is tensor(120.6369, device='cuda:3')
benign distance is  tensor(120.6369, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1072701960802078
distance x is tensor(100.3680, device='cuda:3')
benign distance is  tensor(100.3680, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.078302524983883
distance x is tensor(96.7320, device='cuda:3')
benign distance is  tensor(96.7320, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1030778475105762
distance x is tensor(160.5347, device='cuda:3')
benign distance is  tensor(160.5347, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4472213834524155
distance x is tensor(105.9141, device='cuda:3')
benign distance is  tensor(105.9141, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9459004886448383
distance x is tensor(101.5389, device='cuda:3')
benign distance is  tensor(101.5389, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3918409459292889
distance x is tensor(93.1550, device='cuda:3')
benign distance is  tensor(93.1550, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8796143047511578
distance x is tensor(87.9611, device='cuda:3')
benign distance is  tensor(87.9611, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9678741842508316
distance x is tensor(122.6771, device='cuda:3')
benign distance is  tensor(122.6771, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.3450538627803326
distance x is tensor(103.6184, device='cuda:3')
benign distance is  tensor(103.6184, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9890682734549046
distance x is tensor(144.2962, device='cuda:3')
benign distance is  tensor(144.2962, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.2277840450406075
distance x is tensor(121.3711, device='cuda:3')
benign distance is  tensor(121.3711, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9365683123469353
distance x is tensor(110.3249, device='cuda:3')
benign distance is  tensor(110.3249, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9981370903551579
distance x is tensor(94.5375, device='cuda:3')
benign distance is  tensor(94.5375, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0471452586352825
distance x is tensor(88.2469, device='cuda:3')
benign distance is  tensor(88.2469, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8708993382751942
distance x is tensor(124.6487, device='cuda:3')
benign distance is  tensor(124.6487, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([597.9683, 500.4026, 462.1670, 751.4573, 525.3454, 480.0787, 456.8260,
        420.0942, 288.3783, 237.3533, 221.8566, 215.1888, 211.7073, 209.4364,
        208.0715, 206.9843, 206.4150, 205.8609, 205.4171, 205.1788, 491.6233,
        567.9609, 371.8374, 572.6700, 754.5805, 321.9712, 648.8105, 601.4898],
       device='cuda:3')
sorted_norm is   tensor([205.1788, 205.4171, 205.8609, 206.4150, 206.9843, 208.0715, 209.4364,
        211.7073, 215.1888, 221.8566, 237.3533, 288.3783, 321.9712, 371.8374,
        420.0942, 456.8260, 462.1670, 480.0787, 491.6233, 500.4026, 525.3454,
        567.9609, 572.6700, 597.9683, 601.4898, 648.8105, 751.4573, 754.5805],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 25, 22,  7,  6,  2,  5,
        20,  1,  4, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 61.74% 

Test Accuracy: 79.34% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8618225604295731
distance x is tensor(126.7446, device='cuda:3')
benign distance is  tensor(126.7446, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1452874355018139
distance x is tensor(94.5176, device='cuda:3')
benign distance is  tensor(94.5176, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9363482147455215
distance x is tensor(101.9524, device='cuda:3')
benign distance is  tensor(101.9524, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5115311071276665
distance x is tensor(161.9868, device='cuda:3')
benign distance is  tensor(161.9868, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.28718725964427
distance x is tensor(93.3403, device='cuda:3')
benign distance is  tensor(93.3403, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1600863989442587
distance x is tensor(98.3590, device='cuda:3')
benign distance is  tensor(98.3590, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8859256133437157
distance x is tensor(92.8984, device='cuda:3')
benign distance is  tensor(92.8984, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1063679568469524
distance x is tensor(91.7414, device='cuda:3')
benign distance is  tensor(91.7414, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6561573259532452
distance x is tensor(108.2798, device='cuda:3')
benign distance is  tensor(108.2798, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.268803384155035
distance x is tensor(135.7055, device='cuda:3')
benign distance is  tensor(135.7055, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7164899222552776
distance x is tensor(84.8498, device='cuda:3')
benign distance is  tensor(84.8498, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.0773024931550026
distance x is tensor(122.6960, device='cuda:3')
benign distance is  tensor(122.6960, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.45421576872468
distance x is tensor(177.0742, device='cuda:3')
benign distance is  tensor(177.0742, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1505606025457382
distance x is tensor(73.7617, device='cuda:3')
benign distance is  tensor(73.7617, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3199943788349628
distance x is tensor(143.1231, device='cuda:3')
benign distance is  tensor(143.1231, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5619249567389488
distance x is tensor(130.5253, device='cuda:3')
benign distance is  tensor(130.5253, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([641.5601, 476.1502, 497.7602, 772.6472, 448.8496, 458.1496, 469.5760,
        440.0179, 284.3348, 233.7163, 218.3154, 211.8406, 208.2517, 206.3717,
        205.0527, 203.8789, 203.0425, 202.5053, 202.0299, 201.6062, 521.0140,
        599.0621, 581.5126, 659.8448, 454.6672, 966.3522, 770.5746, 574.7953],
       device='cuda:3')
sorted_norm is   tensor([201.6062, 202.0299, 202.5053, 203.0425, 203.8789, 205.0527, 206.3717,
        208.2517, 211.8406, 218.3154, 233.7163, 284.3348, 440.0179, 448.8496,
        454.6672, 458.1496, 469.5760, 476.1502, 497.7602, 521.0140, 574.7953,
        581.5126, 599.0621, 641.5601, 659.8448, 770.5746, 772.6472, 966.3522],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  4, 24,  5,  6,  1,
         2, 20, 27, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 59.26% 

Test Accuracy: 79.02% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1546539887785912
distance x is tensor(137.5220, device='cuda:3')
benign distance is  tensor(137.5220, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2968513388186693
distance x is tensor(102.7901, device='cuda:3')
benign distance is  tensor(102.7901, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.069055300205946
distance x is tensor(102.5426, device='cuda:3')
benign distance is  tensor(102.5426, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4199757240712643
distance x is tensor(159.9805, device='cuda:3')
benign distance is  tensor(159.9805, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3619794696569443
distance x is tensor(90.2982, device='cuda:3')
benign distance is  tensor(90.2982, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9288906864821911
distance x is tensor(91.4338, device='cuda:3')
benign distance is  tensor(91.4338, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6173796243965626
distance x is tensor(101.0015, device='cuda:3')
benign distance is  tensor(101.0015, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2836588211357594
distance x is tensor(87.0494, device='cuda:3')
benign distance is  tensor(87.0494, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6638890877366066
distance x is tensor(96.0081, device='cuda:3')
benign distance is  tensor(96.0081, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2330613993108273
distance x is tensor(107.0543, device='cuda:3')
benign distance is  tensor(107.0543, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.5036440938711166
distance x is tensor(131.6667, device='cuda:3')
benign distance is  tensor(131.6667, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2178677283227444
distance x is tensor(119.6517, device='cuda:3')
benign distance is  tensor(119.6517, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6166235618293285
distance x is tensor(92.6463, device='cuda:3')
benign distance is  tensor(92.6463, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9685671702027321
distance x is tensor(196.8887, device='cuda:3')
benign distance is  tensor(196.8887, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4404132328927517
distance x is tensor(172.2793, device='cuda:3')
benign distance is  tensor(172.2793, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0980708114802837
distance x is tensor(113.6592, device='cuda:3')
benign distance is  tensor(113.6592, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([659.0541, 509.7890, 502.9588, 769.0787, 441.6926, 423.0043, 496.3698,
        429.9489, 284.2624, 233.4032, 218.2855, 211.7044, 208.1547, 206.0260,
        204.4879, 203.5121, 202.9080, 202.3937, 202.0596, 201.6926, 566.1883,
        473.4820, 665.8585, 660.2541, 610.7535, 596.5051, 599.2255, 793.5707,
        545.5004, 654.7838, 423.9102, 600.0187, 843.9961, 349.6164, 685.4974,
        659.4207], device='cuda:3')
sorted_norm is   tensor([201.6926, 202.0596, 202.3937, 202.9080, 203.5121, 204.4879, 206.0260,
        208.1547, 211.7044, 218.2855, 233.4032, 284.2624, 349.6164, 423.0043,
        423.9102, 429.9489, 441.6926, 473.4820, 496.3698, 502.9588, 509.7890,
        545.5004, 566.1883, 596.5051, 599.2255, 600.0187, 610.7535, 654.7838,
        659.0541, 659.4207, 660.2541, 665.8585, 685.4974, 769.0787, 793.5707,
        843.9961], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 33,  5, 30,  7,  4, 21,
         6,  2,  1, 28, 20, 25, 26, 31, 24, 29], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 59.74% 

Test Accuracy: 79.49% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8170226085931063
distance x is tensor(122.8528, device='cuda:3')
benign distance is  tensor(122.8528, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.09725933521986
distance x is tensor(99.9346, device='cuda:3')
benign distance is  tensor(99.9346, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9920241720974445
distance x is tensor(103.2380, device='cuda:3')
benign distance is  tensor(103.2380, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2928492650389671
distance x is tensor(155.7576, device='cuda:3')
benign distance is  tensor(155.7576, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2120077274739742
distance x is tensor(96.4300, device='cuda:3')
benign distance is  tensor(96.4300, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0955188889056444
distance x is tensor(93.7602, device='cuda:3')
benign distance is  tensor(93.7602, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4292839244008064
distance x is tensor(87.7030, device='cuda:3')
benign distance is  tensor(87.7030, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1304388381540775
distance x is tensor(90.1514, device='cuda:3')
benign distance is  tensor(90.1514, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6053404361009598
distance x is tensor(97.0076, device='cuda:3')
benign distance is  tensor(97.0076, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1704409718513489
distance x is tensor(132.2259, device='cuda:3')
benign distance is  tensor(132.2259, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4381098300218582
distance x is tensor(72.1941, device='cuda:3')
benign distance is  tensor(72.1941, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.5556154251098633
distance x is tensor(119.4343, device='cuda:3')
benign distance is  tensor(119.4343, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6962684281170368
distance x is tensor(169.3462, device='cuda:3')
benign distance is  tensor(169.3462, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9022467210888863
distance x is tensor(70.2155, device='cuda:3')
benign distance is  tensor(70.2155, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2372718378901482
distance x is tensor(137.8916, device='cuda:3')
benign distance is  tensor(137.8916, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.1670986488461494
distance x is tensor(123.2546, device='cuda:3')
benign distance is  tensor(123.2546, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.3785025887191296
distance x is tensor(120.8639, device='cuda:3')
benign distance is  tensor(120.8639, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0737600587308407
distance x is tensor(83.9129, device='cuda:3')
benign distance is  tensor(83.9129, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.5622228160500526
distance x is tensor(130.5592, device='cuda:3')
benign distance is  tensor(130.5592, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.2726049423217773
distance x is tensor(115.1979, device='cuda:3')
benign distance is  tensor(115.1979, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9156819954514503
distance x is tensor(124.3105, device='cuda:3')
benign distance is  tensor(124.3105, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.4850574061274529
distance x is tensor(121.3410, device='cuda:3')
benign distance is  tensor(121.3410, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6355433817952871
distance x is tensor(119.5553, device='cuda:3')
benign distance is  tensor(119.5553, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1240946762263775
distance x is tensor(171.5830, device='cuda:3')
benign distance is  tensor(171.5830, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([609.6855, 500.2585, 498.8189, 749.6788, 479.9479, 449.8456, 423.1854,
        418.1714, 282.3591, 231.9136, 216.5525, 209.9330, 206.3218, 204.1131,
        202.8379, 202.0297, 201.4694, 200.8180, 200.5060, 200.2947],
       device='cuda:3')
sorted_norm is   tensor([200.2947, 200.5060, 200.8180, 201.4694, 202.0297, 202.8379, 204.1131,
        206.3218, 209.9330, 216.5525, 231.9136, 282.3591, 418.1714, 423.1854,
        449.8456, 479.9479, 498.8189, 500.2585, 609.6855, 749.6788],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  5,  4],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 59.25% 

Test Accuracy: 78.10% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9474813975393772
distance x is tensor(127.7273, device='cuda:3')
benign distance is  tensor(127.7273, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1801429465413094
distance x is tensor(108.0518, device='cuda:3')
benign distance is  tensor(108.0518, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1629664301872253
distance x is tensor(105.2921, device='cuda:3')
benign distance is  tensor(105.2921, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.232079342007637
distance x is tensor(164.5947, device='cuda:3')
benign distance is  tensor(164.5947, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3185457475483418
distance x is tensor(86.0039, device='cuda:3')
benign distance is  tensor(86.0039, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3077890761196613
distance x is tensor(98.8549, device='cuda:3')
benign distance is  tensor(98.8549, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.008753776550293
distance x is tensor(92.3799, device='cuda:3')
benign distance is  tensor(92.3799, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3772819191217422
distance x is tensor(90.7273, device='cuda:3')
benign distance is  tensor(90.7273, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([632.2991, 543.7158, 515.9083, 780.4169, 407.0458, 460.7924, 450.7725,
        439.7658, 279.0959, 229.6082, 214.7816, 208.3224, 204.9451, 202.7014,
        201.4037, 200.4522, 199.6536, 199.0471, 198.7124, 198.3554, 608.6814,
        743.5450, 813.5305, 554.2883, 808.2930, 711.2702, 614.1302, 759.6252,
        662.7490, 595.3820, 759.0575, 664.5056, 609.7971, 539.2955, 517.4687,
        678.4920, 508.4960, 553.0851, 641.3967, 621.3644, 485.2514, 941.8817,
        845.2162, 594.8668, 514.1850, 656.9119, 402.9604, 613.1501, 844.5285,
        378.9313, 684.7339, 636.6788], device='cuda:3')
sorted_norm is   tensor([198.3554, 198.7124, 199.0471, 199.6536, 200.4522, 201.4037, 202.7014,
        204.9451, 208.3224, 214.7816, 229.6082, 279.0959, 378.9313, 402.9604,
        407.0458, 439.7658, 450.7725, 460.7924, 485.2514, 508.4960, 514.1850,
        515.9083, 517.4687, 539.2955, 543.7158, 553.0851, 554.2883, 594.8668,
        595.3820, 608.6814, 609.7971, 613.1501, 614.1302, 621.3644, 632.2991,
        636.6788, 641.3967, 656.9119, 662.7490, 664.5056, 678.4920, 684.7339,
        711.2702, 743.5450, 759.0575, 759.6252, 780.4169, 808.2930, 813.5305,
        844.5285, 845.2162, 941.8817], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 49, 46,  4,  7,  6,  5,
        40, 36, 44,  2, 34, 33,  1, 37, 23, 43, 29, 20, 32, 47, 26, 39,  0, 51,
        38, 45, 28, 31, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 63.75% 

Test Accuracy: 80.58% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8279055878520012
distance x is tensor(116.7930, device='cuda:3')
benign distance is  tensor(116.7930, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.317034799605608
distance x is tensor(97.4801, device='cuda:3')
benign distance is  tensor(97.4801, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0749839879572392
distance x is tensor(101.4855, device='cuda:3')
benign distance is  tensor(101.4855, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8187197744846344
distance x is tensor(153.9739, device='cuda:3')
benign distance is  tensor(153.9739, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2338983938097954
distance x is tensor(91.5604, device='cuda:3')
benign distance is  tensor(91.5604, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1003831792622805
distance x is tensor(100.8734, device='cuda:3')
benign distance is  tensor(100.8734, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.653915163129568
distance x is tensor(87.7369, device='cuda:3')
benign distance is  tensor(87.7369, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9835729449987411
distance x is tensor(79.2831, device='cuda:3')
benign distance is  tensor(79.2831, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.673882145434618
distance x is tensor(112.8000, device='cuda:3')
benign distance is  tensor(112.8000, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2960768155753613
distance x is tensor(124.8330, device='cuda:3')
benign distance is  tensor(124.8330, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4379203617572784
distance x is tensor(73.1476, device='cuda:3')
benign distance is  tensor(73.1476, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.9830088391900063
distance x is tensor(114.7121, device='cuda:3')
benign distance is  tensor(114.7121, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.075313899666071
distance x is tensor(168.6399, device='cuda:3')
benign distance is  tensor(168.6399, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0718203987926245
distance x is tensor(65.5936, device='cuda:3')
benign distance is  tensor(65.5936, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3158899284899235
distance x is tensor(140.4595, device='cuda:3')
benign distance is  tensor(140.4595, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.2546816393733025
distance x is tensor(130.9918, device='cuda:3')
benign distance is  tensor(130.9918, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.2001303359866142
distance x is tensor(103.8886, device='cuda:3')
benign distance is  tensor(103.8886, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2548144906759262
distance x is tensor(112.9434, device='cuda:3')
benign distance is  tensor(112.9434, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3014542497694492
distance x is tensor(125.0767, device='cuda:3')
benign distance is  tensor(125.0767, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5184090360999107
distance x is tensor(123.4866, device='cuda:3')
benign distance is  tensor(123.4866, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3389081209897995
distance x is tensor(79.8671, device='cuda:3')
benign distance is  tensor(79.8671, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8817542977631092
distance x is tensor(203.5872, device='cuda:3')
benign distance is  tensor(203.5872, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5964927673339844
distance x is tensor(157.6499, device='cuda:3')
benign distance is  tensor(157.6499, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3736531399190426
distance x is tensor(109.4958, device='cuda:3')
benign distance is  tensor(109.4958, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9463089220225811
distance x is tensor(126.9552, device='cuda:3')
benign distance is  tensor(126.9552, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.5316935367882252
distance x is tensor(102.1071, device='cuda:3')
benign distance is  tensor(102.1071, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1416976489126682
distance x is tensor(143.2318, device='cuda:3')
benign distance is  tensor(143.2318, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.102960981428623
distance x is tensor(128.4889, device='cuda:3')
benign distance is  tensor(128.4889, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0287996716797352
distance x is tensor(115.4511, device='cuda:3')
benign distance is  tensor(115.4511, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.1945709437131882
distance x is tensor(104.1395, device='cuda:3')
benign distance is  tensor(104.1395, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0414081923663616
distance x is tensor(90.1120, device='cuda:3')
benign distance is  tensor(90.1120, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8415811881422997
distance x is tensor(133.4868, device='cuda:3')
benign distance is  tensor(133.4868, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.4606835395097733
distance x is tensor(108.0453, device='cuda:3')
benign distance is  tensor(108.0453, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.7754540592432022
distance x is tensor(142.3906, device='cuda:3')
benign distance is  tensor(142.3906, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.6643988341093063
distance x is tensor(151.3432, device='cuda:3')
benign distance is  tensor(151.3432, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.30952924862504
distance x is tensor(92.7908, device='cuda:3')
benign distance is  tensor(92.7908, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8153119534254074
distance x is tensor(154.0491, device='cuda:3')
benign distance is  tensor(154.0491, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.056548111140728
distance x is tensor(131.5645, device='cuda:3')
benign distance is  tensor(131.5645, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.204183116555214
distance x is tensor(109.5660, device='cuda:3')
benign distance is  tensor(109.5660, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6105804843828082
distance x is tensor(139.7860, device='cuda:3')
benign distance is  tensor(139.7860, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([582.8408, 493.8804, 495.3324, 741.2118, 439.5765, 488.1710, 422.7208,
        376.9471, 277.2934, 227.5906, 212.6092, 205.9031, 202.3359, 200.1464,
        198.6912, 197.7011, 197.1522, 196.5472, 196.0725, 195.7084],
       device='cuda:3')
sorted_norm is   tensor([195.7084, 196.0725, 196.5472, 197.1522, 197.7011, 198.6912, 200.1464,
        202.3359, 205.9031, 212.6092, 227.5906, 277.2934, 376.9471, 422.7208,
        439.5765, 488.1710, 493.8804, 495.3324, 582.8408, 741.2118],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  4,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 61.77% 

Test Accuracy: 79.58% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0525524206459522
distance x is tensor(132.5441, device='cuda:3')
benign distance is  tensor(132.5441, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.343601755797863
distance x is tensor(105.3498, device='cuda:3')
benign distance is  tensor(105.3498, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.251400601118803
distance x is tensor(111.5380, device='cuda:3')
benign distance is  tensor(111.5380, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2243395932018757
distance x is tensor(168.9699, device='cuda:3')
benign distance is  tensor(168.9699, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3237310945987701
distance x is tensor(112.8169, device='cuda:3')
benign distance is  tensor(112.8169, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0536663830280304
distance x is tensor(101.4221, device='cuda:3')
benign distance is  tensor(101.4221, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8105838671326637
distance x is tensor(87.6102, device='cuda:3')
benign distance is  tensor(87.6102, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3600432313978672
distance x is tensor(93.6187, device='cuda:3')
benign distance is  tensor(93.6187, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([665.8344, 509.3564, 532.1996, 824.2072, 531.7292, 476.0918, 435.1091,
        457.5822, 278.2220, 228.3986, 213.3845, 206.9567, 203.5336, 201.5446,
        200.1968, 199.2073, 198.4400, 197.9621, 197.6548, 197.2232, 615.2111,
        441.9149, 673.9453, 600.8301, 626.5120, 637.8926, 611.9805, 833.3037,
        551.5449, 613.7383, 396.2400, 584.3824, 830.5547, 350.0923, 689.5986,
        661.2647], device='cuda:3')
sorted_norm is   tensor([197.2232, 197.6548, 197.9621, 198.4400, 199.2073, 200.1968, 201.5446,
        203.5336, 206.9567, 213.3845, 228.3986, 278.2220, 350.0923, 396.2400,
        435.1091, 441.9149, 457.5822, 476.0918, 509.3564, 531.7292, 532.1996,
        551.5449, 584.3824, 600.8301, 611.9805, 613.7383, 615.2111, 626.5120,
        637.8926, 661.2647, 665.8344, 673.9453, 689.5986, 824.2072, 830.5547,
        833.3037], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 33, 30,  6, 21,  7,  5,
         1,  4,  2, 28, 31, 23, 26, 29, 20, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 62.39% 

Test Accuracy: 79.89% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7853873427957296
distance x is tensor(123.5517, device='cuda:3')
benign distance is  tensor(123.5517, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0695515684783459
distance x is tensor(106.0718, device='cuda:3')
benign distance is  tensor(106.0718, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0898664444684982
distance x is tensor(105.8498, device='cuda:3')
benign distance is  tensor(105.8498, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4684602916240692
distance x is tensor(155.4010, device='cuda:3')
benign distance is  tensor(155.4010, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5933617800474167
distance x is tensor(87.6623, device='cuda:3')
benign distance is  tensor(87.6623, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0136275831609964
distance x is tensor(100.6794, device='cuda:3')
benign distance is  tensor(100.6794, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7323746271431446
distance x is tensor(96.7148, device='cuda:3')
benign distance is  tensor(96.7148, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0753407552838326
distance x is tensor(80.0419, device='cuda:3')
benign distance is  tensor(80.0419, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9568256065249443
distance x is tensor(104.4905, device='cuda:3')
benign distance is  tensor(104.4905, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4232675954699516
distance x is tensor(134.1887, device='cuda:3')
benign distance is  tensor(134.1887, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.510656114667654
distance x is tensor(68.7386, device='cuda:3')
benign distance is  tensor(68.7386, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.020052805542946
distance x is tensor(113.9589, device='cuda:3')
benign distance is  tensor(113.9589, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3333636671304703
distance x is tensor(168.7925, device='cuda:3')
benign distance is  tensor(168.7925, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.301606334745884
distance x is tensor(78.3261, device='cuda:3')
benign distance is  tensor(78.3261, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.125575065612793
distance x is tensor(143.3436, device='cuda:3')
benign distance is  tensor(143.3436, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.220479816198349
distance x is tensor(122.8695, device='cuda:3')
benign distance is  tensor(122.8695, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6185638569295406
distance x is tensor(125.7391, device='cuda:3')
benign distance is  tensor(125.7391, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1472029015421867
distance x is tensor(82.2123, device='cuda:3')
benign distance is  tensor(82.2123, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.4441948384046555
distance x is tensor(134.2242, device='cuda:3')
benign distance is  tensor(134.2242, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.8680889457464218
distance x is tensor(117.1035, device='cuda:3')
benign distance is  tensor(117.1035, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.439437460154295
distance x is tensor(120.6952, device='cuda:3')
benign distance is  tensor(120.6952, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.4501159116625786
distance x is tensor(117.9028, device='cuda:3')
benign distance is  tensor(117.9028, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7712941505014896
distance x is tensor(131.3412, device='cuda:3')
benign distance is  tensor(131.3412, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3456082828342915
distance x is tensor(167.9828, device='cuda:3')
benign distance is  tensor(167.9828, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([613.8181, 520.9819, 503.5031, 752.1321, 413.8417, 468.7741, 474.8055,
        377.6884, 275.3160, 225.9315, 211.0342, 204.4144, 201.2114, 199.1784,
        197.7120, 196.7384, 196.1250, 195.6323, 195.1192, 194.7020, 545.9070,
        566.6492, 601.8088, 600.4362, 413.0460, 963.8207, 778.8236, 562.1483],
       device='cuda:3')
sorted_norm is   tensor([194.7020, 195.1192, 195.6323, 196.1250, 196.7384, 197.7120, 199.1784,
        201.2114, 204.4144, 211.0342, 225.9315, 275.3160, 377.6884, 413.0460,
        413.8417, 468.7741, 474.8055, 503.5031, 520.9819, 545.9070, 562.1483,
        566.6492, 600.4362, 601.8088, 613.8181, 752.1321, 778.8236, 963.8207],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7, 24,  4,  5,  6,  2,
         1, 20, 27, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 60.12% 

Test Accuracy: 79.38% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0926228910684586
distance x is tensor(145.5739, device='cuda:3')
benign distance is  tensor(145.5739, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3097461462020874
distance x is tensor(111.4426, device='cuda:3')
benign distance is  tensor(111.4426, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1378886885941029
distance x is tensor(103.1533, device='cuda:3')
benign distance is  tensor(103.1533, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5305778160691261
distance x is tensor(170.5141, device='cuda:3')
benign distance is  tensor(170.5141, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3591945879161358
distance x is tensor(85.1691, device='cuda:3')
benign distance is  tensor(85.1691, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3345558792352676
distance x is tensor(102.6263, device='cuda:3')
benign distance is  tensor(102.6263, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8322188705205917
distance x is tensor(87.7202, device='cuda:3')
benign distance is  tensor(87.7202, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1596023887395859
distance x is tensor(90.8880, device='cuda:3')
benign distance is  tensor(90.8880, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8411374688148499
distance x is tensor(112.7051, device='cuda:3')
benign distance is  tensor(112.7051, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2084357365965843
distance x is tensor(116.2946, device='cuda:3')
benign distance is  tensor(116.2946, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.587502259761095
distance x is tensor(124.8872, device='cuda:3')
benign distance is  tensor(124.8872, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3171451464295387
distance x is tensor(141.6244, device='cuda:3')
benign distance is  tensor(141.6244, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9637294337153435
distance x is tensor(89.0633, device='cuda:3')
benign distance is  tensor(89.0633, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9933052211999893
distance x is tensor(197.3174, device='cuda:3')
benign distance is  tensor(197.3174, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7839048728346825
distance x is tensor(163.6346, device='cuda:3')
benign distance is  tensor(163.6346, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6419032141566277
distance x is tensor(122.0624, device='cuda:3')
benign distance is  tensor(122.0624, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([709.9112, 552.8657, 505.4610, 806.4107, 411.2636, 489.0115, 422.2771,
        435.5955, 275.1067, 225.3155, 210.3757, 204.0294, 200.4205, 198.3743,
        197.0294, 196.0428, 195.3567, 194.8470, 194.4895, 194.0163, 515.3533,
        648.2803, 348.1768, 566.4474, 795.3421, 371.1136, 699.1840, 625.6130],
       device='cuda:3')
sorted_norm is   tensor([194.0163, 194.4895, 194.8470, 195.3567, 196.0428, 197.0294, 198.3743,
        200.4205, 204.0294, 210.3757, 225.3155, 275.1067, 348.1768, 371.1136,
        411.2636, 422.2771, 435.5955, 489.0115, 505.4610, 515.3533, 552.8657,
        566.4474, 625.6130, 648.2803, 699.1840, 709.9112, 795.3421, 806.4107],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 22, 25,  4,  6,  7,  5,
         2, 20,  1, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 59.43% 

Test Accuracy: 79.17% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0832719318568707
distance x is tensor(128.4886, device='cuda:3')
benign distance is  tensor(128.4886, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3609565943479538
distance x is tensor(112.8272, device='cuda:3')
benign distance is  tensor(112.8272, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9561090804636478
distance x is tensor(101.7580, device='cuda:3')
benign distance is  tensor(101.7580, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5758711025118828
distance x is tensor(173.0225, device='cuda:3')
benign distance is  tensor(173.0225, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.54966576769948
distance x is tensor(98.4711, device='cuda:3')
benign distance is  tensor(98.4711, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3228243216872215
distance x is tensor(119.6486, device='cuda:3')
benign distance is  tensor(119.6486, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6936919465661049
distance x is tensor(93.0336, device='cuda:3')
benign distance is  tensor(93.0336, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2442045360803604
distance x is tensor(109.7331, device='cuda:3')
benign distance is  tensor(109.7331, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5538822785019875
distance x is tensor(113.7956, device='cuda:3')
benign distance is  tensor(113.7956, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4863395877182484
distance x is tensor(131.7422, device='cuda:3')
benign distance is  tensor(131.7422, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.377556949853897
distance x is tensor(82.4957, device='cuda:3')
benign distance is  tensor(82.4957, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.158049136400223
distance x is tensor(112.9083, device='cuda:3')
benign distance is  tensor(112.9083, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.8387612998485565
distance x is tensor(159.8886, device='cuda:3')
benign distance is  tensor(159.8886, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.4870377443730831
distance x is tensor(77.4415, device='cuda:3')
benign distance is  tensor(77.4415, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0672339107841253
distance x is tensor(146.4079, device='cuda:3')
benign distance is  tensor(146.4079, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.5215912088751793
distance x is tensor(130.0535, device='cuda:3')
benign distance is  tensor(130.0535, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([637.1920, 564.1776, 506.5272, 829.8116, 474.1066, 556.9508, 442.5715,
        535.8630, 273.9030, 224.7247, 210.1588, 203.8075, 200.3073, 198.1792,
        196.8369, 195.8434, 195.1445, 194.6900, 194.2372, 193.9944, 689.6470,
        560.7592, 743.7543, 679.6600, 606.7216, 579.6386, 510.8836, 690.7154],
       device='cuda:3')
sorted_norm is   tensor([193.9944, 194.2372, 194.6900, 195.1445, 195.8434, 196.8369, 198.1792,
        200.3073, 203.8075, 210.1588, 224.7247, 273.9030, 442.5715, 474.1066,
        506.5272, 510.8836, 535.8630, 556.9508, 560.7592, 564.1776, 579.6386,
        606.7216, 637.1920, 679.6600, 689.6470, 690.7154, 743.7543, 829.8116],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  4,  2, 26,  7,  5,
        21,  1, 25, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 60.95% 

Test Accuracy: 79.03% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.266313474625349
distance x is tensor(149.2857, device='cuda:3')
benign distance is  tensor(149.2857, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.146105371415615
distance x is tensor(115.5262, device='cuda:3')
benign distance is  tensor(115.5262, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1958713382482529
distance x is tensor(101.5708, device='cuda:3')
benign distance is  tensor(101.5708, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.036808207631111
distance x is tensor(153.1285, device='cuda:3')
benign distance is  tensor(153.1285, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6816539838910103
distance x is tensor(123.9465, device='cuda:3')
benign distance is  tensor(123.9465, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1096297204494476
distance x is tensor(95.8669, device='cuda:3')
benign distance is  tensor(95.8669, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7921741157770157
distance x is tensor(96.0328, device='cuda:3')
benign distance is  tensor(96.0328, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1329195834696293
distance x is tensor(82.4694, device='cuda:3')
benign distance is  tensor(82.4694, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0658851340413094
distance x is tensor(130.3854, device='cuda:3')
benign distance is  tensor(130.3854, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.5110122747719288
distance x is tensor(111.9493, device='cuda:3')
benign distance is  tensor(111.9493, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1372959725558758
distance x is tensor(146.2046, device='cuda:3')
benign distance is  tensor(146.2046, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.5428905934095383
distance x is tensor(140.4883, device='cuda:3')
benign distance is  tensor(140.4883, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9922402054071426
distance x is tensor(115.8244, device='cuda:3')
benign distance is  tensor(115.8244, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.2725418470799923
distance x is tensor(97.7396, device='cuda:3')
benign distance is  tensor(97.7396, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9229352287948132
distance x is tensor(95.9785, device='cuda:3')
benign distance is  tensor(95.9785, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8257646020501852
distance x is tensor(143.6200, device='cuda:3')
benign distance is  tensor(143.6200, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([742.2997, 550.8838, 493.2039, 739.7425, 582.5665, 454.8250, 468.1645,
        399.5687, 274.5607, 225.3321, 210.9282, 204.4351, 200.9272, 198.7687,
        197.3130, 196.5953, 195.7958, 195.3222, 194.7993, 194.4696, 621.1302,
        734.9820, 778.3331, 543.7513, 798.8914, 688.7599, 602.8259, 721.7956,
        630.0068, 441.7438, 681.3353, 621.3350, 614.7038, 611.8696, 660.6653,
        820.1486, 568.4042, 587.7044, 598.8257, 688.9191, 447.3308, 923.6910,
        777.6206, 624.8017, 561.8241, 630.5508, 412.8546, 572.9528, 784.4062,
        380.6410, 696.4258, 657.7856], device='cuda:3')
sorted_norm is   tensor([194.4696, 194.7993, 195.3222, 195.7958, 196.5953, 197.3130, 198.7687,
        200.9272, 204.4351, 210.9282, 225.3321, 274.5607, 380.6410, 399.5687,
        412.8546, 441.7438, 447.3308, 454.8250, 468.1645, 493.2039, 543.7513,
        550.8838, 561.8241, 568.4042, 572.9528, 582.5665, 587.7044, 598.8257,
        602.8259, 611.8696, 614.7038, 621.1302, 621.3350, 624.8017, 630.0068,
        630.5508, 657.7856, 660.6653, 681.3353, 688.7599, 688.9191, 696.4258,
        721.7956, 734.9820, 739.7425, 742.2997, 777.6206, 778.3331, 784.4062,
        798.8914, 820.1486, 923.6910], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 49,  7, 46, 29, 40,  5,
         6,  2, 23,  1, 44, 36, 47,  4, 37, 38, 26, 33, 32, 20, 31, 43, 28, 45,
        51, 34, 30, 25, 39], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 58.75% 

Test Accuracy: 79.68% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0777011662721634
distance x is tensor(124.3567, device='cuda:3')
benign distance is  tensor(124.3567, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0448162518441677
distance x is tensor(109.4737, device='cuda:3')
benign distance is  tensor(109.4737, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1879546530544758
distance x is tensor(114.0457, device='cuda:3')
benign distance is  tensor(114.0457, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4814036712050438
distance x is tensor(155.6467, device='cuda:3')
benign distance is  tensor(155.6467, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6436187736690044
distance x is tensor(86.6123, device='cuda:3')
benign distance is  tensor(86.6123, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1777509823441505
distance x is tensor(100.7380, device='cuda:3')
benign distance is  tensor(100.7380, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1636050045490265
distance x is tensor(92.5750, device='cuda:3')
benign distance is  tensor(92.5750, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9900098219513893
distance x is tensor(86.1566, device='cuda:3')
benign distance is  tensor(86.1566, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.794644869863987
distance x is tensor(99.8011, device='cuda:3')
benign distance is  tensor(99.8011, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2856876216828823
distance x is tensor(144.3050, device='cuda:3')
benign distance is  tensor(144.3050, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6844385489821434
distance x is tensor(66.7596, device='cuda:3')
benign distance is  tensor(66.7596, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.9543873965740204
distance x is tensor(122.2567, device='cuda:3')
benign distance is  tensor(122.2567, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.684229202568531
distance x is tensor(173.0429, device='cuda:3')
benign distance is  tensor(173.0429, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.079975415021181
distance x is tensor(67.9986, device='cuda:3')
benign distance is  tensor(67.9986, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.021454133093357
distance x is tensor(141.0343, device='cuda:3')
benign distance is  tensor(141.0343, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9134951308369637
distance x is tensor(125.3848, device='cuda:3')
benign distance is  tensor(125.3848, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7480678260326385
distance x is tensor(101.5840, device='cuda:3')
benign distance is  tensor(101.5840, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.218110341578722
distance x is tensor(107.6457, device='cuda:3')
benign distance is  tensor(107.6457, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.6056330762803555
distance x is tensor(114.1382, device='cuda:3')
benign distance is  tensor(114.1382, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.478248242288828
distance x is tensor(134.4818, device='cuda:3')
benign distance is  tensor(134.4818, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7780245020985603
distance x is tensor(91.6949, device='cuda:3')
benign distance is  tensor(91.6949, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.025887668132782
distance x is tensor(195.0003, device='cuda:3')
benign distance is  tensor(195.0003, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4357424899935722
distance x is tensor(166.7412, device='cuda:3')
benign distance is  tensor(166.7412, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1855509728193283
distance x is tensor(116.0455, device='cuda:3')
benign distance is  tensor(116.0455, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.8561543598771095
distance x is tensor(118.4277, device='cuda:3')
benign distance is  tensor(118.4277, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3123472146689892
distance x is tensor(122.7143, device='cuda:3')
benign distance is  tensor(122.7143, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.6755508705973625
distance x is tensor(136.7136, device='cuda:3')
benign distance is  tensor(136.7136, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.942472130060196
distance x is tensor(120.9627, device='cuda:3')
benign distance is  tensor(120.9627, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5488514304161072
distance x is tensor(133.2081, device='cuda:3')
benign distance is  tensor(133.2081, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.3548722751438618
distance x is tensor(123.5038, device='cuda:3')
benign distance is  tensor(123.5038, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6237922254949808
distance x is tensor(125.4153, device='cuda:3')
benign distance is  tensor(125.4153, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.2258287444710732
distance x is tensor(162.6313, device='cuda:3')
benign distance is  tensor(162.6313, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.5780600681900978
distance x is tensor(118.3790, device='cuda:3')
benign distance is  tensor(118.3790, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.8784756883978844
distance x is tensor(129.5099, device='cuda:3')
benign distance is  tensor(129.5099, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.722954548895359
distance x is tensor(149.8579, device='cuda:3')
benign distance is  tensor(149.8579, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.451095163822174
distance x is tensor(95.2816, device='cuda:3')
benign distance is  tensor(95.2816, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.9280428513884544
distance x is tensor(156.0279, device='cuda:3')
benign distance is  tensor(156.0279, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1065586805343628
distance x is tensor(138.6420, device='cuda:3')
benign distance is  tensor(138.6420, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2062025219202042
distance x is tensor(110.8725, device='cuda:3')
benign distance is  tensor(110.8725, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6752541568130255
distance x is tensor(136.5108, device='cuda:3')
benign distance is  tensor(136.5108, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([618.2679, 537.2061, 539.1658, 728.6604, 414.5460, 464.4839, 455.2402,
        402.6190, 272.8250, 223.0902, 208.7194, 202.4290, 199.0779, 197.0972,
        195.7611, 194.8249, 194.0573, 193.5244, 193.1783, 192.8576],
       device='cuda:3')
sorted_norm is   tensor([192.8576, 193.1783, 193.5244, 194.0573, 194.8249, 195.7611, 197.0972,
        199.0779, 202.4290, 208.7194, 223.0902, 272.8250, 402.6190, 414.5460,
        455.2402, 464.4839, 537.2061, 539.1658, 618.2679, 728.6604],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  4,  6,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 57.51% 

Test Accuracy: 78.74% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8467647526413202
distance x is tensor(143.1222, device='cuda:3')
benign distance is  tensor(143.1222, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3610312826931477
distance x is tensor(107.4097, device='cuda:3')
benign distance is  tensor(107.4097, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1499613672494888
distance x is tensor(109.2393, device='cuda:3')
benign distance is  tensor(109.2393, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7330918312072754
distance x is tensor(162.3354, device='cuda:3')
benign distance is  tensor(162.3354, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6765152290463448
distance x is tensor(88.6668, device='cuda:3')
benign distance is  tensor(88.6668, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0729546379297972
distance x is tensor(103.8683, device='cuda:3')
benign distance is  tensor(103.8683, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6829539611935616
distance x is tensor(98.5445, device='cuda:3')
benign distance is  tensor(98.5445, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2900745458900928
distance x is tensor(93.2387, device='cuda:3')
benign distance is  tensor(93.2387, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([695.6223, 521.4882, 516.7859, 760.9691, 426.4715, 477.8088, 462.0415,
        449.6299, 271.2405, 222.5341, 207.8524, 201.4957, 198.1950, 196.0607,
        194.8335, 193.9618, 193.2397, 192.7153, 192.3513, 192.0486, 522.9683,
        709.5566, 366.1997, 621.5844, 839.2856, 356.0660, 679.9196, 646.9115],
       device='cuda:3')
sorted_norm is   tensor([192.0486, 192.3513, 192.7153, 193.2397, 193.9618, 194.8335, 196.0607,
        198.1950, 201.4957, 207.8524, 222.5341, 271.2405, 356.0660, 366.1997,
        426.4715, 449.6299, 462.0415, 477.8088, 516.7859, 521.4882, 522.9683,
        621.5844, 646.9115, 679.9196, 695.6223, 709.5566, 760.9691, 839.2856],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 25, 22,  4,  7,  6,  5,
         2,  1, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 56.64% 

Test Accuracy: 78.73% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1071015112102032
distance x is tensor(147.6672, device='cuda:3')
benign distance is  tensor(147.6672, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4747708924114704
distance x is tensor(102.3355, device='cuda:3')
benign distance is  tensor(102.3355, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.302518256008625
distance x is tensor(117.7136, device='cuda:3')
benign distance is  tensor(117.7136, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3420940712094307
distance x is tensor(160.2395, device='cuda:3')
benign distance is  tensor(160.2395, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4403748251497746
distance x is tensor(93.1747, device='cuda:3')
benign distance is  tensor(93.1747, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0925485230982304
distance x is tensor(97.1428, device='cuda:3')
benign distance is  tensor(97.1428, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6971033662557602
distance x is tensor(91.1898, device='cuda:3')
benign distance is  tensor(91.1898, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2095824554562569
distance x is tensor(87.3108, device='cuda:3')
benign distance is  tensor(87.3108, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4392690882086754
distance x is tensor(101.3828, device='cuda:3')
benign distance is  tensor(101.3828, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3308771029114723
distance x is tensor(130.3176, device='cuda:3')
benign distance is  tensor(130.3176, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5428786762058735
distance x is tensor(86.1289, device='cuda:3')
benign distance is  tensor(86.1289, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.1549081206321716
distance x is tensor(120.8621, device='cuda:3')
benign distance is  tensor(120.8621, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3972072899341583
distance x is tensor(161.4186, device='cuda:3')
benign distance is  tensor(161.4186, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3235536962747574
distance x is tensor(70.7484, device='cuda:3')
benign distance is  tensor(70.7484, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.190644845366478
distance x is tensor(157.4599, device='cuda:3')
benign distance is  tensor(157.4599, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.5762669891119003
distance x is tensor(127.5305, device='cuda:3')
benign distance is  tensor(127.5305, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([712.7333, 517.4395, 547.9379, 753.5422, 449.8971, 458.9394, 440.8094,
        420.5527, 271.3102, 223.0883, 208.4542, 202.1592, 198.6855, 196.5017,
        195.1284, 194.1385, 193.6056, 192.9211, 192.4598, 192.0853, 543.0574,
        561.1539, 573.7996, 663.4312, 480.2781, 923.6069, 832.4285, 592.8415],
       device='cuda:3')
sorted_norm is   tensor([192.0853, 192.4598, 192.9211, 193.6056, 194.1385, 195.1284, 196.5017,
        198.6855, 202.1592, 208.4542, 223.0883, 271.3102, 420.5527, 440.8094,
        449.8971, 458.9394, 480.2781, 517.4395, 543.0574, 547.9379, 561.1539,
        573.7996, 592.8415, 663.4312, 712.7333, 753.5422, 832.4285, 923.6069],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  4,  5, 24,  1,
        20,  2, 21, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 55.28% 

Test Accuracy: 78.24% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9623160921037197
distance x is tensor(137.3598, device='cuda:3')
benign distance is  tensor(137.3598, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3338252641260624
distance x is tensor(115.5255, device='cuda:3')
benign distance is  tensor(115.5255, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1135873049497604
distance x is tensor(111.0748, device='cuda:3')
benign distance is  tensor(111.0748, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.679922766983509
distance x is tensor(164.2578, device='cuda:3')
benign distance is  tensor(164.2578, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.647578552365303
distance x is tensor(113.0367, device='cuda:3')
benign distance is  tensor(113.0367, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.200184028595686
distance x is tensor(97.6200, device='cuda:3')
benign distance is  tensor(97.6200, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.632228147238493
distance x is tensor(94.5869, device='cuda:3')
benign distance is  tensor(94.5869, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.177617210894823
distance x is tensor(106.6450, device='cuda:3')
benign distance is  tensor(106.6450, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6220240369439125
distance x is tensor(100.2960, device='cuda:3')
benign distance is  tensor(100.2960, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1765597984194756
distance x is tensor(119.1966, device='cuda:3')
benign distance is  tensor(119.1966, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7458550706505775
distance x is tensor(125.4867, device='cuda:3')
benign distance is  tensor(125.4867, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5430157631635666
distance x is tensor(126.6733, device='cuda:3')
benign distance is  tensor(126.6733, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.811354711651802
distance x is tensor(107.0826, device='cuda:3')
benign distance is  tensor(107.0826, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0931826680898666
distance x is tensor(205.6350, device='cuda:3')
benign distance is  tensor(205.6350, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5615410953760147
distance x is tensor(160.5404, device='cuda:3')
benign distance is  tensor(160.5404, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3490723669528961
distance x is tensor(122.7209, device='cuda:3')
benign distance is  tensor(122.7209, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([682.9072, 560.4761, 531.4486, 786.7059, 534.1461, 450.1513, 456.1747,
        512.3695, 270.3479, 221.7324, 207.1442, 200.9296, 197.6761, 195.5476,
        194.1569, 193.2852, 192.5714, 192.1659, 191.8560, 191.6283, 675.1608,
        578.8426, 745.4820, 689.9636, 620.0304, 526.7241, 510.2932, 738.3337,
        609.2598, 693.6980, 709.4570, 634.6649, 688.1218, 661.2448, 656.5632,
        811.4711, 501.4994, 621.4026, 417.1065, 596.2142, 762.0408, 347.6245,
        737.1727, 627.3928], device='cuda:3')
sorted_norm is   tensor([191.6283, 191.8560, 192.1659, 192.5714, 193.2852, 194.1569, 195.5476,
        197.6761, 200.9296, 207.1442, 221.7324, 270.3479, 347.6245, 417.1065,
        450.1513, 456.1747, 501.4994, 510.2932, 512.3695, 526.7241, 531.4486,
        534.1461, 560.4761, 578.8426, 596.2142, 609.2598, 620.0304, 621.4026,
        627.3928, 634.6649, 656.5632, 661.2448, 675.1608, 682.9072, 688.1218,
        689.9636, 693.6980, 709.4570, 737.1727, 738.3337, 745.4820, 762.0408,
        786.7059, 811.4711], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 41, 38,  5,  6, 36, 26,
         7, 25,  2,  4,  1, 21, 39, 28, 24, 37, 43, 31, 34, 33, 20,  0, 32],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 62.49% 

Test Accuracy: 80.28% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0784084796905518
distance x is tensor(128.8910, device='cuda:3')
benign distance is  tensor(128.8910, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0415013507008553
distance x is tensor(102.2246, device='cuda:3')
benign distance is  tensor(102.2246, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9858256503939629
distance x is tensor(104.6564, device='cuda:3')
benign distance is  tensor(104.6564, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3955848291516304
distance x is tensor(155.4237, device='cuda:3')
benign distance is  tensor(155.4237, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4922086708247662
distance x is tensor(92.3760, device='cuda:3')
benign distance is  tensor(92.3760, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.160955999046564
distance x is tensor(101.6163, device='cuda:3')
benign distance is  tensor(101.6163, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7286449894309044
distance x is tensor(99.4389, device='cuda:3')
benign distance is  tensor(99.4389, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3978926055133343
distance x is tensor(80.4908, device='cuda:3')
benign distance is  tensor(80.4908, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2708438336849213
distance x is tensor(124.6832, device='cuda:3')
benign distance is  tensor(124.6832, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3517255522310734
distance x is tensor(126.5115, device='cuda:3')
benign distance is  tensor(126.5115, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5742164142429829
distance x is tensor(69.9436, device='cuda:3')
benign distance is  tensor(69.9436, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.288601830601692
distance x is tensor(112.0581, device='cuda:3')
benign distance is  tensor(112.0581, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6201617270708084
distance x is tensor(157.9141, device='cuda:3')
benign distance is  tensor(157.9141, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1126223970204592
distance x is tensor(70.6592, device='cuda:3')
benign distance is  tensor(70.6592, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3122544400393963
distance x is tensor(149.0751, device='cuda:3')
benign distance is  tensor(149.0751, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.779070071876049
distance x is tensor(120.3845, device='cuda:3')
benign distance is  tensor(120.3845, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6928390562534332
distance x is tensor(117.6778, device='cuda:3')
benign distance is  tensor(117.6778, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0870290994644165
distance x is tensor(88.7917, device='cuda:3')
benign distance is  tensor(88.7917, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.5276861414313316
distance x is tensor(138.8323, device='cuda:3')
benign distance is  tensor(138.8323, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.5262744426727295
distance x is tensor(114.9034, device='cuda:3')
benign distance is  tensor(114.9034, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1895479932427406
distance x is tensor(126.4808, device='cuda:3')
benign distance is  tensor(126.4808, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.4516360014677048
distance x is tensor(116.4061, device='cuda:3')
benign distance is  tensor(116.4061, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7016646880656481
distance x is tensor(119.0825, device='cuda:3')
benign distance is  tensor(119.0825, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3261152729392052
distance x is tensor(162.2659, device='cuda:3')
benign distance is  tensor(162.2659, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8916371911764145
distance x is tensor(129.4364, device='cuda:3')
benign distance is  tensor(129.4364, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.5041680708527565
distance x is tensor(98.6333, device='cuda:3')
benign distance is  tensor(98.6333, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1109096705913544
distance x is tensor(146.8063, device='cuda:3')
benign distance is  tensor(146.8063, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.9231856614351273
distance x is tensor(138.5202, device='cuda:3')
benign distance is  tensor(138.5202, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9553787149488926
distance x is tensor(122.5171, device='cuda:3')
benign distance is  tensor(122.5171, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.162086397409439
distance x is tensor(111.6655, device='cuda:3')
benign distance is  tensor(111.6655, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0830975323915482
distance x is tensor(94.7551, device='cuda:3')
benign distance is  tensor(94.7551, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.1016892977058887
distance x is tensor(135.8016, device='cuda:3')
benign distance is  tensor(135.8016, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([626.9742, 505.4266, 491.5753, 744.4843, 450.8897, 467.7804, 480.3633,
        387.2937, 267.9961, 219.4906, 204.6526, 198.1675, 194.9419, 192.8139,
        191.4517, 190.5044, 189.7919, 189.3911, 188.9237, 188.5449],
       device='cuda:3')
sorted_norm is   tensor([188.5449, 188.9237, 189.3911, 189.7919, 190.5044, 191.4517, 192.8139,
        194.9419, 198.1675, 204.6526, 219.4906, 267.9961, 387.2937, 450.8897,
        467.7804, 480.3633, 491.5753, 505.4266, 626.9742, 744.4843],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  4,  5,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 61.11% 

Test Accuracy: 79.53% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0671555772423744
distance x is tensor(145.5057, device='cuda:3')
benign distance is  tensor(145.5057, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2149318419396877
distance x is tensor(109.9341, device='cuda:3')
benign distance is  tensor(109.9341, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0245575234293938
distance x is tensor(106.9922, device='cuda:3')
benign distance is  tensor(106.9922, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.395748671144247
distance x is tensor(168.5189, device='cuda:3')
benign distance is  tensor(168.5189, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3916330374777317
distance x is tensor(93.2427, device='cuda:3')
benign distance is  tensor(93.2427, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3089410364627838
distance x is tensor(103.4155, device='cuda:3')
benign distance is  tensor(103.4155, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6597017422318459
distance x is tensor(89.2495, device='cuda:3')
benign distance is  tensor(89.2495, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3961887136101723
distance x is tensor(80.6886, device='cuda:3')
benign distance is  tensor(80.6886, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([704.3416, 527.7512, 517.0042, 777.3405, 442.9002, 477.4074, 422.9357,
        383.1742, 267.7786, 219.5172, 205.1043, 198.5910, 195.3062, 193.2654,
        191.9588, 191.0391, 190.2268, 189.7219, 189.3694, 189.0121, 667.0048,
        698.4268, 779.9280, 560.7799, 819.0055, 730.2910, 616.5170, 707.2419,
        523.8610, 600.8181, 614.2343, 615.0573, 532.3264, 945.2665, 781.1075,
        610.9569, 616.2022, 616.6479, 371.8267, 566.7122, 771.7234, 358.3215,
        728.9021, 625.1085], device='cuda:3')
sorted_norm is   tensor([189.0121, 189.3694, 189.7219, 190.2268, 191.0391, 191.9588, 193.2654,
        195.3062, 198.5910, 205.1043, 219.5172, 267.7786, 358.3215, 371.8267,
        383.1742, 422.9357, 442.9002, 477.4074, 517.0042, 523.8610, 527.7512,
        532.3264, 560.7799, 566.7122, 600.8181, 610.9569, 614.2343, 615.0573,
        616.2022, 616.5170, 616.6479, 625.1085, 667.0048, 698.4268, 704.3416,
        707.2419, 728.9021, 730.2910, 771.7234, 777.3405, 779.9280, 781.1075,
        819.0055, 945.2665], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 41, 38,  7,  6,  4,  5,
         2, 28,  1, 32, 23, 39, 29, 35, 30, 31, 36, 26, 37, 43, 20, 21,  0],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 59.17% 

Test Accuracy: 79.69% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9932070821523666
distance x is tensor(129.5590, device='cuda:3')
benign distance is  tensor(129.5590, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3049622476100922
distance x is tensor(99.2459, device='cuda:3')
benign distance is  tensor(99.2459, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3097000941634178
distance x is tensor(117.9848, device='cuda:3')
benign distance is  tensor(117.9848, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3099080547690392
distance x is tensor(163.4845, device='cuda:3')
benign distance is  tensor(163.4845, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7253058403730392
distance x is tensor(97.1580, device='cuda:3')
benign distance is  tensor(97.1580, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.557041622698307
distance x is tensor(108.9336, device='cuda:3')
benign distance is  tensor(108.9336, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6261808574199677
distance x is tensor(99.3273, device='cuda:3')
benign distance is  tensor(99.3273, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2661888375878334
distance x is tensor(92.0464, device='cuda:3')
benign distance is  tensor(92.0464, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8558622002601624
distance x is tensor(104.2511, device='cuda:3')
benign distance is  tensor(104.2511, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3343947678804398
distance x is tensor(132.0986, device='cuda:3')
benign distance is  tensor(132.0986, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8417234793305397
distance x is tensor(85.8916, device='cuda:3')
benign distance is  tensor(85.8916, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.240155950188637
distance x is tensor(110.7290, device='cuda:3')
benign distance is  tensor(110.7290, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4454714208841324
distance x is tensor(162.0945, device='cuda:3')
benign distance is  tensor(162.0945, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1329280696809292
distance x is tensor(71.5916, device='cuda:3')
benign distance is  tensor(71.5916, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3944695964455605
distance x is tensor(142.6305, device='cuda:3')
benign distance is  tensor(142.6305, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.331397622823715
distance x is tensor(128.0143, device='cuda:3')
benign distance is  tensor(128.0143, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.819405920803547
distance x is tensor(99.7986, device='cuda:3')
benign distance is  tensor(99.7986, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3652280308306217
distance x is tensor(112.0450, device='cuda:3')
benign distance is  tensor(112.0450, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4772963412106037
distance x is tensor(123.3840, device='cuda:3')
benign distance is  tensor(123.3840, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4224600158631802
distance x is tensor(125.2116, device='cuda:3')
benign distance is  tensor(125.2116, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6168805733323097
distance x is tensor(91.7206, device='cuda:3')
benign distance is  tensor(91.7206, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9484276473522186
distance x is tensor(197.2968, device='cuda:3')
benign distance is  tensor(197.2968, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.8245660364627838
distance x is tensor(174.6160, device='cuda:3')
benign distance is  tensor(174.6160, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1080662310123444
distance x is tensor(115.3297, device='cuda:3')
benign distance is  tensor(115.3297, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.8114662244915962
distance x is tensor(104.5638, device='cuda:3')
benign distance is  tensor(104.5638, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.8500667363405228
distance x is tensor(137.9871, device='cuda:3')
benign distance is  tensor(137.9871, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.642209004610777
distance x is tensor(150.4099, device='cuda:3')
benign distance is  tensor(150.4099, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.4850876778364182
distance x is tensor(98.9322, device='cuda:3')
benign distance is  tensor(98.9322, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.9661845192313194
distance x is tensor(156.0103, device='cuda:3')
benign distance is  tensor(156.0103, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.392384685575962
distance x is tensor(140.3227, device='cuda:3')
benign distance is  tensor(140.3227, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2826279550790787
distance x is tensor(113.3503, device='cuda:3')
benign distance is  tensor(113.3503, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7237880462780595
distance x is tensor(138.3898, device='cuda:3')
benign distance is  tensor(138.3898, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([632.1602, 485.2137, 573.8718, 783.7584, 476.1261, 496.3891, 469.3981,
        438.3103, 264.5941, 216.5515, 202.0479, 195.5963, 192.4220, 190.4538,
        189.1953, 188.3971, 187.7484, 187.3257, 186.9128, 186.4954],
       device='cuda:3')
sorted_norm is   tensor([186.4954, 186.9128, 187.3257, 187.7484, 188.3971, 189.1953, 190.4538,
        192.4220, 195.5963, 202.0479, 216.5515, 264.5941, 438.3103, 469.3981,
        476.1261, 485.2137, 496.3891, 573.8718, 632.1602, 783.7584],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  4,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 58.10% 

Test Accuracy: 78.69% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9649429507553577
distance x is tensor(135.1824, device='cuda:3')
benign distance is  tensor(135.1824, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3631468527019024
distance x is tensor(111.1891, device='cuda:3')
benign distance is  tensor(111.1891, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1996086426079273
distance x is tensor(109.0605, device='cuda:3')
benign distance is  tensor(109.0605, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5319115333259106
distance x is tensor(161.5502, device='cuda:3')
benign distance is  tensor(161.5502, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3455616645514965
distance x is tensor(86.7141, device='cuda:3')
benign distance is  tensor(86.7141, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2378447689116001
distance x is tensor(109.9431, device='cuda:3')
benign distance is  tensor(109.9431, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7496812231838703
distance x is tensor(78.5757, device='cuda:3')
benign distance is  tensor(78.5757, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0411752685904503
distance x is tensor(85.0068, device='cuda:3')
benign distance is  tensor(85.0068, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([680.1255, 551.0536, 533.6567, 758.8781, 411.3094, 504.2849, 382.8109,
        411.0998, 262.8903, 215.7048, 201.4404, 195.1255, 191.8606, 189.6751,
        188.3766, 187.3662, 186.7061, 186.2026, 185.8593, 185.5140, 605.5401,
        474.3636, 705.8402, 612.7768, 651.1406, 614.7972, 631.1994, 791.9545,
        518.0851, 643.7141, 435.7734, 564.9320, 788.9356, 360.3646, 693.1456,
        649.3829], device='cuda:3')
sorted_norm is   tensor([185.5140, 185.8593, 186.2026, 186.7061, 187.3662, 188.3766, 189.6751,
        191.8606, 195.1255, 201.4404, 215.7048, 262.8903, 360.3646, 382.8109,
        411.0998, 411.3094, 435.7734, 474.3636, 504.2849, 518.0851, 533.6567,
        551.0536, 564.9320, 605.5401, 612.7768, 614.7972, 631.1994, 643.7141,
        649.3829, 651.1406, 680.1255, 693.1456, 705.8402, 758.8781, 788.9356,
        791.9545], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 33,  6,  7,  4, 30, 21,
         5, 28,  2,  1, 31, 20, 23, 25, 26, 29], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 59.36% 

Test Accuracy: 79.44% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.784581245854497
distance x is tensor(136.8841, device='cuda:3')
benign distance is  tensor(136.8841, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8325817622244358
distance x is tensor(100.0720, device='cuda:3')
benign distance is  tensor(100.0720, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1451200433075428
distance x is tensor(113.8805, device='cuda:3')
benign distance is  tensor(113.8805, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5950152277946472
distance x is tensor(168.7973, device='cuda:3')
benign distance is  tensor(168.7973, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4255461394786835
distance x is tensor(86.8207, device='cuda:3')
benign distance is  tensor(86.8207, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2336560897529125
distance x is tensor(97.9899, device='cuda:3')
benign distance is  tensor(97.9899, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6239404752850533
distance x is tensor(83.5471, device='cuda:3')
benign distance is  tensor(83.5471, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3126256689429283
distance x is tensor(92.8074, device='cuda:3')
benign distance is  tensor(92.8074, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.381658174097538
distance x is tensor(109.2713, device='cuda:3')
benign distance is  tensor(109.2713, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.5330789983272552
distance x is tensor(130.6350, device='cuda:3')
benign distance is  tensor(130.6350, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8905554562807083
distance x is tensor(78.8756, device='cuda:3')
benign distance is  tensor(78.8756, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.1960667446255684
distance x is tensor(118.3646, device='cuda:3')
benign distance is  tensor(118.3646, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3680699281394482
distance x is tensor(164.4874, device='cuda:3')
benign distance is  tensor(164.4874, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1912091486155987
distance x is tensor(71.2749, device='cuda:3')
benign distance is  tensor(71.2749, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2615317590534687
distance x is tensor(152.1918, device='cuda:3')
benign distance is  tensor(152.1918, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.0264107063412666
distance x is tensor(131.3897, device='cuda:3')
benign distance is  tensor(131.3897, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6654766947031021
distance x is tensor(119.4389, device='cuda:3')
benign distance is  tensor(119.4389, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1698689498007298
distance x is tensor(88.3475, device='cuda:3')
benign distance is  tensor(88.3475, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.5633798763155937
distance x is tensor(146.9620, device='cuda:3')
benign distance is  tensor(146.9620, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.05944000184536
distance x is tensor(124.7259, device='cuda:3')
benign distance is  tensor(124.7259, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1758211739361286
distance x is tensor(129.3415, device='cuda:3')
benign distance is  tensor(129.3415, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.191435318440199
distance x is tensor(115.3407, device='cuda:3')
benign distance is  tensor(115.3407, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7139534987509251
distance x is tensor(123.9360, device='cuda:3')
benign distance is  tensor(123.9360, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3788045421242714
distance x is tensor(171.5736, device='cuda:3')
benign distance is  tensor(171.5736, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([669.0250, 501.5870, 537.6688, 791.9990, 419.6422, 456.6374, 398.3491,
        438.8524, 262.2463, 214.7247, 200.4839, 194.5337, 191.2965, 189.5304,
        188.1561, 187.2947, 186.7150, 186.1205, 185.8502, 185.4999, 673.5684,
        525.6299, 742.1512, 691.9232, 626.1979, 564.4442, 489.3440, 680.6121,
        545.2164, 547.7386, 604.1484, 617.7266, 463.3246, 924.8159, 834.7358,
        571.3413], device='cuda:3')
sorted_norm is   tensor([185.4999, 185.8502, 186.1205, 186.7150, 187.2947, 188.1561, 189.5304,
        191.2965, 194.5337, 200.4839, 214.7247, 262.2463, 398.3491, 419.6422,
        438.8524, 456.6374, 463.3246, 489.3440, 501.5870, 525.6299, 537.6688,
        545.2164, 547.7386, 564.4442, 571.3413, 604.1484, 617.7266, 626.1979,
        669.0250, 673.5684, 680.6121, 691.9232, 742.1512, 791.9990, 834.7358,
        924.8159], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  6,  4,  7,  5, 32, 26,
         1, 21,  2, 28, 29, 25, 35, 30, 31, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 59.09% 

Test Accuracy: 79.43% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9211535155773163
distance x is tensor(137.2876, device='cuda:3')
benign distance is  tensor(137.2876, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.222327683120966
distance x is tensor(110.0158, device='cuda:3')
benign distance is  tensor(110.0158, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1385799311101437
distance x is tensor(117.3360, device='cuda:3')
benign distance is  tensor(117.3360, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7568379864096642
distance x is tensor(172.2446, device='cuda:3')
benign distance is  tensor(172.2446, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6674387380480766
distance x is tensor(90.7566, device='cuda:3')
benign distance is  tensor(90.7566, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1569050550460815
distance x is tensor(98.6589, device='cuda:3')
benign distance is  tensor(98.6589, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.243075579404831
distance x is tensor(96.9456, device='cuda:3')
benign distance is  tensor(96.9456, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4308560825884342
distance x is tensor(87.7456, device='cuda:3')
benign distance is  tensor(87.7456, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4808121174573898
distance x is tensor(92.1413, device='cuda:3')
benign distance is  tensor(92.1413, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.289158247411251
distance x is tensor(108.6751, device='cuda:3')
benign distance is  tensor(108.6751, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4879069589078426
distance x is tensor(111.6743, device='cuda:3')
benign distance is  tensor(111.6743, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7033820897340775
distance x is tensor(131.4276, device='cuda:3')
benign distance is  tensor(131.4276, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6919932812452316
distance x is tensor(94.4984, device='cuda:3')
benign distance is  tensor(94.4984, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9032420236617327
distance x is tensor(202.2093, device='cuda:3')
benign distance is  tensor(202.2093, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2955642715096474
distance x is tensor(174.7031, device='cuda:3')
benign distance is  tensor(174.7031, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3257852904498577
distance x is tensor(124.2718, device='cuda:3')
benign distance is  tensor(124.2718, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1033531054854393
distance x is tensor(134.6426, device='cuda:3')
benign distance is  tensor(134.6426, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.7389320209622383
distance x is tensor(104.5839, device='cuda:3')
benign distance is  tensor(104.5839, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.4490604661405087
distance x is tensor(153.8248, device='cuda:3')
benign distance is  tensor(153.8248, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.6365617364645004
distance x is tensor(144.5679, device='cuda:3')
benign distance is  tensor(144.5679, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0160297937691212
distance x is tensor(131.8880, device='cuda:3')
benign distance is  tensor(131.8880, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.3516581691801548
distance x is tensor(96.4500, device='cuda:3')
benign distance is  tensor(96.4500, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9612549021840096
distance x is tensor(97.7190, device='cuda:3')
benign distance is  tensor(97.7190, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8145652823150158
distance x is tensor(130.1447, device='cuda:3')
benign distance is  tensor(130.1447, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([675.1147, 538.1205, 532.9493, 790.5524, 430.5151, 452.4553, 465.5918,
        409.3134, 262.7211, 214.9046, 200.7806, 194.7370, 191.5354, 189.5060,
        188.1686, 187.2235, 186.5192, 185.9026, 185.4793, 185.2308, 537.3850,
        610.4019, 384.8159, 572.6882, 783.5907, 344.5551, 694.2782, 666.4030],
       device='cuda:3')
sorted_norm is   tensor([185.2308, 185.4793, 185.9026, 186.5192, 187.2235, 188.1686, 189.5060,
        191.5354, 194.7370, 200.7806, 214.9046, 262.7211, 344.5551, 384.8159,
        409.3134, 430.5151, 452.4553, 465.5918, 532.9493, 537.3850, 538.1205,
        572.6882, 610.4019, 666.4030, 675.1147, 694.2782, 783.5907, 790.5524],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 25, 22,  7,  4,  5,  6,
         2, 20,  1, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 57.31% 

Test Accuracy: 79.22% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8923952132463455
distance x is tensor(143.2446, device='cuda:3')
benign distance is  tensor(143.2446, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0506552122533321
distance x is tensor(118.3616, device='cuda:3')
benign distance is  tensor(118.3616, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2449400760233402
distance x is tensor(105.0082, device='cuda:3')
benign distance is  tensor(105.0082, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3282512351870537
distance x is tensor(172.3126, device='cuda:3')
benign distance is  tensor(172.3126, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6943908967077732
distance x is tensor(115.1080, device='cuda:3')
benign distance is  tensor(115.1080, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3931879438459873
distance x is tensor(111.6379, device='cuda:3')
benign distance is  tensor(111.6379, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0385535806417465
distance x is tensor(100.5807, device='cuda:3')
benign distance is  tensor(100.5807, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2264932207763195
distance x is tensor(93.4301, device='cuda:3')
benign distance is  tensor(93.4301, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5727169923484325
distance x is tensor(129.8294, device='cuda:3')
benign distance is  tensor(129.8294, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3150672651827335
distance x is tensor(122.9766, device='cuda:3')
benign distance is  tensor(122.9766, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.0629785507917404
distance x is tensor(83.0615, device='cuda:3')
benign distance is  tensor(83.0615, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.483541361987591
distance x is tensor(110.8857, device='cuda:3')
benign distance is  tensor(110.8857, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.0712475776672363
distance x is tensor(161.5051, device='cuda:3')
benign distance is  tensor(161.5051, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.312169723212719
distance x is tensor(64.8122, device='cuda:3')
benign distance is  tensor(64.8122, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3708651587367058
distance x is tensor(161.1764, device='cuda:3')
benign distance is  tensor(161.1764, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.255297303199768
distance x is tensor(129.0938, device='cuda:3')
benign distance is  tensor(129.0938, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([699.1590, 588.1423, 511.2376, 808.0763, 560.8865, 514.1864, 468.8210,
        446.9203, 261.5067, 214.2956, 200.0855, 193.9394, 190.6974, 188.8442,
        187.5445, 186.5573, 185.9960, 185.4783, 185.1473, 184.7502],
       device='cuda:3')
sorted_norm is   tensor([184.7502, 185.1473, 185.4783, 185.9960, 186.5573, 187.5445, 188.8442,
        190.6974, 193.9394, 200.0855, 214.2956, 261.5067, 446.9203, 468.8210,
        511.2376, 514.1864, 560.8865, 588.1423, 699.1590, 808.0763],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  6,  2,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 57.37% 

Test Accuracy: 78.73% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0640074145048857
distance x is tensor(149.0428, device='cuda:3')
benign distance is  tensor(149.0428, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2656997963786125
distance x is tensor(106.7330, device='cuda:3')
benign distance is  tensor(106.7330, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1793078035116196
distance x is tensor(109.8947, device='cuda:3')
benign distance is  tensor(109.8947, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8578471913933754
distance x is tensor(177.2904, device='cuda:3')
benign distance is  tensor(177.2904, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7013909965753555
distance x is tensor(114.5813, device='cuda:3')
benign distance is  tensor(114.5813, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.320903543382883
distance x is tensor(116.1675, device='cuda:3')
benign distance is  tensor(116.1675, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5311950221657753
distance x is tensor(109.0203, device='cuda:3')
benign distance is  tensor(109.0203, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2820196188986301
distance x is tensor(79.2862, device='cuda:3')
benign distance is  tensor(79.2862, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([727.0092, 529.3832, 533.0152, 821.9608, 540.9411, 511.5230, 521.5652,
        391.0553, 260.2854, 213.2273, 199.3673, 193.3477, 190.1078, 188.1898,
        186.8697, 185.9644, 185.2486, 184.6700, 184.2449, 183.9726, 620.8220,
        734.4214, 780.9222, 569.0808, 811.4121, 739.1528, 630.4910, 728.4172,
        615.2562, 481.7962, 741.1100, 661.5792, 671.5247, 616.4827, 653.4287,
        832.4022, 514.8345, 571.0489, 573.8171, 674.2308, 490.5734, 969.8300,
        845.4733, 651.3030, 629.7292, 606.5368, 426.7434, 565.3729, 783.0427,
        354.4447, 791.9406, 678.9841], device='cuda:3')
sorted_norm is   tensor([183.9726, 184.2449, 184.6700, 185.2486, 185.9644, 186.8697, 188.1898,
        190.1078, 193.3477, 199.3673, 213.2273, 260.2854, 354.4447, 391.0553,
        426.7434, 481.7962, 490.5734, 511.5230, 514.8345, 521.5652, 529.3832,
        533.0152, 540.9411, 565.3729, 569.0808, 571.0489, 573.8171, 606.5368,
        615.2562, 616.4827, 620.8220, 629.7292, 630.4910, 651.3030, 653.4287,
        661.5792, 671.5247, 674.2308, 678.9841, 727.0092, 728.4172, 734.4214,
        739.1528, 741.1100, 780.9222, 783.0427, 791.9406, 811.4121, 821.9608,
        832.4022, 845.4733, 969.8300], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 49,  7, 46, 29, 40,  5,
        36,  6,  1,  2,  4, 47, 23, 37, 38, 45, 28, 33, 20, 44, 26, 43, 34, 31,
        32, 39, 51,  0, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 61.29% 

Test Accuracy: 80.06% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9587252587080002
distance x is tensor(128.2040, device='cuda:3')
benign distance is  tensor(128.2040, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3954459019005299
distance x is tensor(127.0501, device='cuda:3')
benign distance is  tensor(127.0501, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.083922803401947
distance x is tensor(103.9732, device='cuda:3')
benign distance is  tensor(103.9732, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4056576751172543
distance x is tensor(164.4685, device='cuda:3')
benign distance is  tensor(164.4685, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6757687740027905
distance x is tensor(88.9332, device='cuda:3')
benign distance is  tensor(88.9332, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.16873200237751
distance x is tensor(99.3600, device='cuda:3')
benign distance is  tensor(99.3600, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4425047524273396
distance x is tensor(90.0057, device='cuda:3')
benign distance is  tensor(90.0057, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.276349052786827
distance x is tensor(86.5473, device='cuda:3')
benign distance is  tensor(86.5473, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5662976801395416
distance x is tensor(107.3900, device='cuda:3')
benign distance is  tensor(107.3900, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2680321373045444
distance x is tensor(141.2196, device='cuda:3')
benign distance is  tensor(141.2196, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4678936563432217
distance x is tensor(86.1141, device='cuda:3')
benign distance is  tensor(86.1141, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.099962554872036
distance x is tensor(110.2524, device='cuda:3')
benign distance is  tensor(110.2524, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4892465695738792
distance x is tensor(168.5550, device='cuda:3')
benign distance is  tensor(168.5550, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2751543931663036
distance x is tensor(63.1183, device='cuda:3')
benign distance is  tensor(63.1183, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4379853047430515
distance x is tensor(154.6006, device='cuda:3')
benign distance is  tensor(154.6006, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6927902549505234
distance x is tensor(128.7725, device='cuda:3')
benign distance is  tensor(128.7725, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6947278156876564
distance x is tensor(91.3450, device='cuda:3')
benign distance is  tensor(91.3450, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3037815429270267
distance x is tensor(121.9551, device='cuda:3')
benign distance is  tensor(121.9551, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7807312086224556
distance x is tensor(116.4510, device='cuda:3')
benign distance is  tensor(116.4510, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.469320435076952
distance x is tensor(124.3672, device='cuda:3')
benign distance is  tensor(124.3672, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6045006662607193
distance x is tensor(95.2241, device='cuda:3')
benign distance is  tensor(95.2241, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.033863365650177
distance x is tensor(212.5971, device='cuda:3')
benign distance is  tensor(212.5971, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5875136703252792
distance x is tensor(166.8039, device='cuda:3')
benign distance is  tensor(166.8039, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.149721022695303
distance x is tensor(112.1884, device='cuda:3')
benign distance is  tensor(112.1884, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.3552722111344337
distance x is tensor(117.9831, device='cuda:3')
benign distance is  tensor(117.9831, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2863488867878914
distance x is tensor(135.3181, device='cuda:3')
benign distance is  tensor(135.3181, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3739163801074028
distance x is tensor(143.5017, device='cuda:3')
benign distance is  tensor(143.5017, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.695431672036648
distance x is tensor(119.3218, device='cuda:3')
benign distance is  tensor(119.3218, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3539682775735855
distance x is tensor(128.4176, device='cuda:3')
benign distance is  tensor(128.4176, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5749760568141937
distance x is tensor(133.0978, device='cuda:3')
benign distance is  tensor(133.0978, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8762167412787676
distance x is tensor(126.1256, device='cuda:3')
benign distance is  tensor(126.1256, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3083338402211666
distance x is tensor(169.6045, device='cuda:3')
benign distance is  tensor(169.6045, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.5552022010087967
distance x is tensor(126.2496, device='cuda:3')
benign distance is  tensor(126.2496, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.1508001014590263
distance x is tensor(131.5101, device='cuda:3')
benign distance is  tensor(131.5101, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.5286774933338165
distance x is tensor(146.5551, device='cuda:3')
benign distance is  tensor(146.5551, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.5351677909493446
distance x is tensor(95.8409, device='cuda:3')
benign distance is  tensor(95.8409, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.0020154640078545
distance x is tensor(156.7348, device='cuda:3')
benign distance is  tensor(156.7348, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1095842830836773
distance x is tensor(136.0560, device='cuda:3')
benign distance is  tensor(136.0560, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0639787279069424
distance x is tensor(115.4901, device='cuda:3')
benign distance is  tensor(115.4901, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8527621328830719
distance x is tensor(160.9790, device='cuda:3')
benign distance is  tensor(160.9790, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([637.2223, 601.0923, 496.7029, 766.2734, 427.8929, 468.5455, 438.5510,
        401.0182, 261.7474, 214.0229, 199.9869, 193.7041, 190.4707, 188.4472,
        187.0097, 186.0228, 185.4550, 184.9643, 184.5806, 184.2278],
       device='cuda:3')
sorted_norm is   tensor([184.2278, 184.5806, 184.9643, 185.4550, 186.0228, 187.0097, 188.4472,
        190.4707, 193.7041, 199.9869, 214.0229, 261.7474, 401.0182, 427.8929,
        438.5510, 468.5455, 496.7029, 601.0923, 637.2223, 766.2734],
       device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8,  7,  4,  6,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 59.72% 

Test Accuracy: 79.28% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9009526260197163
distance x is tensor(142.0283, device='cuda:3')
benign distance is  tensor(142.0283, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.377506796270609
distance x is tensor(128.5637, device='cuda:3')
benign distance is  tensor(128.5637, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3546029441058636
distance x is tensor(127.4310, device='cuda:3')
benign distance is  tensor(127.4310, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5653833821415901
distance x is tensor(166.0498, device='cuda:3')
benign distance is  tensor(166.0498, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2175540924072266
distance x is tensor(104.2052, device='cuda:3')
benign distance is  tensor(104.2052, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.266620870679617
distance x is tensor(84.8483, device='cuda:3')
benign distance is  tensor(84.8483, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.790805771946907
distance x is tensor(109.7858, device='cuda:3')
benign distance is  tensor(109.7858, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2541640102863312
distance x is tensor(86.0284, device='cuda:3')
benign distance is  tensor(86.0284, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([695.7972, 625.0891, 602.9170, 785.7793, 480.7412, 402.5945, 519.6327,
        399.0199, 258.1910, 211.5793, 197.3556, 191.0950, 187.9152, 185.9446,
        184.5839, 183.8407, 183.1422, 182.6777, 182.2684, 182.0638, 698.1672,
        553.9835, 764.4682, 717.5005, 670.3240, 523.2204, 516.0761, 670.6382,
        533.3272, 701.7915, 448.3868, 551.3278, 810.2584, 333.6250, 758.0708,
        634.7944], device='cuda:3')
sorted_norm is   tensor([182.0638, 182.2684, 182.6777, 183.1422, 183.8407, 184.5839, 185.9446,
        187.9152, 191.0950, 197.3556, 211.5793, 258.1910, 333.6250, 399.0199,
        402.5945, 448.3868, 480.7412, 516.0761, 519.6327, 523.2204, 533.3272,
        551.3278, 553.9835, 602.9170, 625.0891, 634.7944, 670.3240, 670.6382,
        695.7972, 698.1672, 701.7915, 717.5005, 758.0708, 764.4682, 785.7793,
        810.2584], device='cuda:3')
used idx is  tensor([19, 18, 17, 16, 15, 14, 13, 12, 11, 10,  9,  8, 33,  7,  5, 30,  4, 26,
         6, 25, 28, 31, 21,  2,  1, 35, 24, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 63.70% 

Test Accuracy: 80.60% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 63.70%
|----0th round Training Accuracy : 96.14%
|----1th round Training Accuracy : 95.39%
|----2th round Training Accuracy : 94.30%
|----3th round Training Accuracy : 93.09%
|----4th round Training Accuracy : 92.02%
|----5th round Training Accuracy : 90.57%
|----6th round Training Accuracy : 86.86%
|----7th round Training Accuracy : 86.05%
|----8th round Training Accuracy : 82.70%
|----9th round Training Accuracy : 82.24%
|----10th round Training Accuracy : 76.14%
|----11th round Training Accuracy : 79.98%
|----12th round Training Accuracy : 74.95%
|----13th round Training Accuracy : 69.26%
|----14th round Training Accuracy : 70.46%
|----15th round Training Accuracy : 72.48%
|----16th round Training Accuracy : 66.84%
|----17th round Training Accuracy : 69.34%
|----18th round Training Accuracy : 63.18%
|----19th round Training Accuracy : 69.16%
|----20th round Training Accuracy : 65.01%
|----21th round Training Accuracy : 62.79%
|----22th round Training Accuracy : 60.43%
|----23th round Training Accuracy : 62.97%
|----24th round Training Accuracy : 63.21%
|----25th round Training Accuracy : 61.74%
|----26th round Training Accuracy : 59.26%
|----27th round Training Accuracy : 59.74%
|----28th round Training Accuracy : 59.25%
|----29th round Training Accuracy : 63.75%
|----30th round Training Accuracy : 61.77%
|----31th round Training Accuracy : 62.39%
|----32th round Training Accuracy : 60.12%
|----33th round Training Accuracy : 59.43%
|----34th round Training Accuracy : 60.95%
|----35th round Training Accuracy : 58.75%
|----36th round Training Accuracy : 57.51%
|----37th round Training Accuracy : 56.64%
|----38th round Training Accuracy : 55.28%
|----39th round Training Accuracy : 62.49%
|----40th round Training Accuracy : 61.11%
|----41th round Training Accuracy : 59.17%
|----42th round Training Accuracy : 58.10%
|----43th round Training Accuracy : 59.36%
|----44th round Training Accuracy : 59.09%
|----45th round Training Accuracy : 57.31%
|----46th round Training Accuracy : 57.37%
|----47th round Training Accuracy : 61.29%
|----48th round Training Accuracy : 59.72%
|----49th round Training Accuracy : 63.70%
|----Final Test Accuracy: 80.60%
|----0th round Final Test Accuracy : 87.80%
|----1th round Final Test Accuracy : 86.87%
|----2th round Final Test Accuracy : 86.34%
|----3th round Final Test Accuracy : 86.87%
|----4th round Final Test Accuracy : 85.99%
|----5th round Final Test Accuracy : 86.74%
|----6th round Final Test Accuracy : 83.37%
|----7th round Final Test Accuracy : 84.58%
|----8th round Final Test Accuracy : 83.48%
|----9th round Final Test Accuracy : 84.32%
|----10th round Final Test Accuracy : 79.77%
|----11th round Final Test Accuracy : 84.47%
|----12th round Final Test Accuracy : 81.53%
|----13th round Final Test Accuracy : 80.60%
|----14th round Final Test Accuracy : 81.87%
|----15th round Final Test Accuracy : 82.44%
|----16th round Final Test Accuracy : 79.81%
|----17th round Final Test Accuracy : 81.92%
|----18th round Final Test Accuracy : 79.01%
|----19th round Final Test Accuracy : 81.81%
|----20th round Final Test Accuracy : 80.51%
|----21th round Final Test Accuracy : 79.80%
|----22th round Final Test Accuracy : 78.00%
|----23th round Final Test Accuracy : 80.50%
|----24th round Final Test Accuracy : 80.11%
|----25th round Final Test Accuracy : 79.34%
|----26th round Final Test Accuracy : 79.02%
|----27th round Final Test Accuracy : 79.49%
|----28th round Final Test Accuracy : 78.10%
|----29th round Final Test Accuracy : 80.58%
|----30th round Final Test Accuracy : 79.58%
|----31th round Final Test Accuracy : 79.89%
|----32th round Final Test Accuracy : 79.38%
|----33th round Final Test Accuracy : 79.17%
|----34th round Final Test Accuracy : 79.03%
|----35th round Final Test Accuracy : 79.68%
|----36th round Final Test Accuracy : 78.74%
|----37th round Final Test Accuracy : 78.73%
|----38th round Final Test Accuracy : 78.24%
|----39th round Final Test Accuracy : 80.28%
|----40th round Final Test Accuracy : 79.53%
|----41th round Final Test Accuracy : 79.69%
|----42th round Final Test Accuracy : 78.69%
|----43th round Final Test Accuracy : 79.44%
|----44th round Final Test Accuracy : 79.43%
|----45th round Final Test Accuracy : 79.22%
|----46th round Final Test Accuracy : 78.73%
|----47th round Final Test Accuracy : 80.06%
|----48th round Final Test Accuracy : 79.28%
|----49th round Final Test Accuracy : 80.60%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3905.6184
