
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7494948208332062
distance x is tensor(120.4668, device='cuda:0')
benign distance is  tensor(120.4668, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8473281674087048
distance x is tensor(103.5205, device='cuda:0')
benign distance is  tensor(103.5205, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.583319365978241
distance x is tensor(105.7074, device='cuda:0')
benign distance is  tensor(105.7074, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.960372069850564
distance x is tensor(147.0984, device='cuda:0')
benign distance is  tensor(147.0984, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8362589199095964
distance x is tensor(98.0104, device='cuda:0')
benign distance is  tensor(98.0104, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6452684197574854
distance x is tensor(96.6803, device='cuda:0')
benign distance is  tensor(96.6803, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1272805538028479
distance x is tensor(108.6898, device='cuda:0')
benign distance is  tensor(108.6898, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6816398240625858
distance x is tensor(82.8665, device='cuda:0')
benign distance is  tensor(82.8665, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9004538431763649
distance x is tensor(115.4098, device='cuda:0')
benign distance is  tensor(115.4098, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7732947086915374
distance x is tensor(124.0353, device='cuda:0')
benign distance is  tensor(124.0353, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0379790216684341
distance x is tensor(96.1593, device='cuda:0')
benign distance is  tensor(96.1593, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1767372228205204
distance x is tensor(122.1372, device='cuda:0')
benign distance is  tensor(122.1372, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8890836723148823
distance x is tensor(173.7082, device='cuda:0')
benign distance is  tensor(173.7082, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6193679319694638
distance x is tensor(66.8635, device='cuda:0')
benign distance is  tensor(66.8635, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9238196443766356
distance x is tensor(141.2217, device='cuda:0')
benign distance is  tensor(141.2217, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1845110952854156
distance x is tensor(129.1026, device='cuda:0')
benign distance is  tensor(129.1026, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.5282863043248653
distance x is tensor(111.5081, device='cuda:0')
benign distance is  tensor(111.5081, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6589062083512545
distance x is tensor(119.0455, device='cuda:0')
benign distance is  tensor(119.0455, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.96057721786201
distance x is tensor(121.2090, device='cuda:0')
benign distance is  tensor(121.2090, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7156502045691013
distance x is tensor(122.0808, device='cuda:0')
benign distance is  tensor(122.0808, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9997048443183303
distance x is tensor(85.9775, device='cuda:0')
benign distance is  tensor(85.9775, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8079690635204315
distance x is tensor(206.6366, device='cuda:0')
benign distance is  tensor(206.6366, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9058096650987864
distance x is tensor(157.2988, device='cuda:0')
benign distance is  tensor(157.2988, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6026151617988944
distance x is tensor(114.0887, device='cuda:0')
benign distance is  tensor(114.0887, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0541680827736855
distance x is tensor(124.9343, device='cuda:0')
benign distance is  tensor(124.9343, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5514736156910658
distance x is tensor(78.2705, device='cuda:0')
benign distance is  tensor(78.2705, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8444629572331905
distance x is tensor(142.3960, device='cuda:0')
benign distance is  tensor(142.3960, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.297559816390276
distance x is tensor(119.5297, device='cuda:0')
benign distance is  tensor(119.5297, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6069109831005335
distance x is tensor(125.0264, device='cuda:0')
benign distance is  tensor(125.0264, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.822962611913681
distance x is tensor(122.4037, device='cuda:0')
benign distance is  tensor(122.4037, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5086725503206253
distance x is tensor(106.3581, device='cuda:0')
benign distance is  tensor(106.3581, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8077538050711155
distance x is tensor(168.4447, device='cuda:0')
benign distance is  tensor(168.4447, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7925241850316525
distance x is tensor(115.1773, device='cuda:0')
benign distance is  tensor(115.1773, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7797621358186007
distance x is tensor(105.7537, device='cuda:0')
benign distance is  tensor(105.7537, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5626409742981195
distance x is tensor(146.3272, device='cuda:0')
benign distance is  tensor(146.3272, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2157221138477325
distance x is tensor(124.1395, device='cuda:0')
benign distance is  tensor(124.1395, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8516955208033323
distance x is tensor(109.6948, device='cuda:0')
benign distance is  tensor(109.6948, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8526102090254426
distance x is tensor(82.9165, device='cuda:0')
benign distance is  tensor(82.9165, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7257715035229921
distance x is tensor(100.1261, device='cuda:0')
benign distance is  tensor(100.1261, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9180757217109203
distance x is tensor(115.1246, device='cuda:0')
benign distance is  tensor(115.1246, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1972392238676548
distance x is tensor(112.0188, device='cuda:0')
benign distance is  tensor(112.0188, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1687795594334602
distance x is tensor(140.3254, device='cuda:0')
benign distance is  tensor(140.3254, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2180755510926247
distance x is tensor(156.0837, device='cuda:0')
benign distance is  tensor(156.0837, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1783966310322285
distance x is tensor(99.2407, device='cuda:0')
benign distance is  tensor(99.2407, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5158953722566366
distance x is tensor(156.5374, device='cuda:0')
benign distance is  tensor(156.5374, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6520205140113831
distance x is tensor(137.2323, device='cuda:0')
benign distance is  tensor(137.2323, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6894774883985519
distance x is tensor(105.3888, device='cuda:0')
benign distance is  tensor(105.3888, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6070045754313469
distance x is tensor(132.5919, device='cuda:0')
benign distance is  tensor(132.5919, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85200000016
mal_loss is 0.5405984446406364
mal_entropy is 0.2615783382207155
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([565.5064, 482.7582, 493.8742, 688.5448, 445.0899, 439.1206, 497.4292,
        381.2782, 460.6336, 460.6336, 460.6336, 460.6336, 460.6336, 460.6336,
        460.6336, 460.6336, 460.6336, 460.6336, 460.6336, 460.6336],
       device='cuda:0')
sorted_norm is   tensor([381.2782, 439.1206, 445.0899, 460.6336, 460.6336, 460.6336, 460.6336,
        460.6336, 460.6336, 460.6336, 460.6336, 460.6336, 460.6336, 460.6336,
        460.6336, 482.7582, 493.8742, 497.4292, 565.5064, 688.5448],
       device='cuda:0')
used idx is  tensor([ 7,  5,  4, 19, 15, 18, 16, 17, 13, 12, 14,  9,  8, 11, 10,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 96.20% 

Test Accuracy: 87.13% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7921912334859371
distance x is tensor(126.8155, device='cuda:0')
benign distance is  tensor(126.8155, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7300382293760777
distance x is tensor(119.1882, device='cuda:0')
benign distance is  tensor(119.1882, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.638288140296936
distance x is tensor(121.8158, device='cuda:0')
benign distance is  tensor(121.8158, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9957933947443962
distance x is tensor(156.4411, device='cuda:0')
benign distance is  tensor(156.4411, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9016750361770391
distance x is tensor(87.0437, device='cuda:0')
benign distance is  tensor(87.0437, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7379812858998775
distance x is tensor(102.1589, device='cuda:0')
benign distance is  tensor(102.1589, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2848039343953133
distance x is tensor(123.3052, device='cuda:0')
benign distance is  tensor(123.3052, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7600975334644318
distance x is tensor(92.2098, device='cuda:0')
benign distance is  tensor(92.2098, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.6730000001600001
mal_loss is 1.9667976573109627
mal_entropy is 0.2653280645608902
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([600.8021, 566.2017, 572.8945, 722.5612, 391.1648, 459.5154, 563.8339,
        426.1050, 458.5554, 458.5554, 458.5554, 458.5554, 458.5554, 458.5554,
        458.5554, 458.5554, 458.5554, 458.5554, 458.5554, 458.5554, 630.8543,
        672.7269, 553.1710, 664.6765, 855.8733, 457.2518, 728.9899, 694.9261],
       device='cuda:0')
sorted_norm is   tensor([391.1648, 426.1050, 457.2518, 458.5554, 458.5554, 458.5554, 458.5554,
        458.5554, 458.5554, 458.5554, 458.5554, 458.5554, 458.5554, 458.5554,
        458.5554, 459.5154, 553.1710, 563.8339, 566.2017, 572.8945, 600.8021,
        630.8543, 664.6765, 672.7269, 694.9261, 722.5612, 728.9899, 855.8733],
       device='cuda:0')
used idx is  tensor([ 4,  7, 25, 18, 19, 15, 16, 17, 13, 12,  8,  9, 14, 10, 11,  5, 22,  6,
         1,  2,  0, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 95.90% 

Test Accuracy: 85.36% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8610213957726955
distance x is tensor(153.8904, device='cuda:0')
benign distance is  tensor(153.8904, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8279400896281004
distance x is tensor(114.5738, device='cuda:0')
benign distance is  tensor(114.5738, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7424659989774227
distance x is tensor(129.4248, device='cuda:0')
benign distance is  tensor(129.4248, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1146612502634525
distance x is tensor(164.5214, device='cuda:0')
benign distance is  tensor(164.5214, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8421719931066036
distance x is tensor(114.9833, device='cuda:0')
benign distance is  tensor(114.9833, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7337947012856603
distance x is tensor(123.5287, device='cuda:0')
benign distance is  tensor(123.5287, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2114156857132912
distance x is tensor(130.5730, device='cuda:0')
benign distance is  tensor(130.5730, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8286474328488111
distance x is tensor(107.3681, device='cuda:0')
benign distance is  tensor(107.3681, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8401117715984583
distance x is tensor(116.0499, device='cuda:0')
benign distance is  tensor(116.0499, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6947940951213241
distance x is tensor(137.0956, device='cuda:0')
benign distance is  tensor(137.0956, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1052792854607105
distance x is tensor(100.5221, device='cuda:0')
benign distance is  tensor(100.5221, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6204547509551048
distance x is tensor(133.0738, device='cuda:0')
benign distance is  tensor(133.0738, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9039676878601313
distance x is tensor(183.8872, device='cuda:0')
benign distance is  tensor(183.8872, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.823768638074398
distance x is tensor(89.6113, device='cuda:0')
benign distance is  tensor(89.6113, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.011506425216794
distance x is tensor(158.9992, device='cuda:0')
benign distance is  tensor(158.9992, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6542881354689598
distance x is tensor(147.6314, device='cuda:0')
benign distance is  tensor(147.6314, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.47200000016000004
mal_loss is 6.497698873281479
mal_entropy is 0.20943681616336107
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 701.8333,  539.2950,  575.2613,  753.0287,  519.8194,  545.7613,
         592.2162,  487.9534,  459.6432,  459.6432,  459.6432,  459.6432,
         459.6432,  459.6432,  459.6432,  459.6432,  459.6432,  459.6432,
         459.6432,  459.6432,  666.6514,  691.4390,  690.2352,  704.8286,
         570.3317, 1028.5281,  825.6385,  675.1194], device='cuda:0')
sorted_norm is   tensor([ 459.6432,  459.6432,  459.6432,  459.6432,  459.6432,  459.6432,
         459.6432,  459.6432,  459.6432,  459.6432,  459.6432,  459.6432,
         487.9534,  519.8194,  539.2950,  545.7613,  570.3317,  575.2613,
         592.2162,  666.6514,  675.1194,  690.2352,  691.4390,  701.8333,
         704.8286,  753.0287,  825.6385, 1028.5281], device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  4,  1,  5, 24,  2,
         6, 20, 27, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 94.94% 

Test Accuracy: 82.08% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9059634245932102
distance x is tensor(141.2965, device='cuda:0')
benign distance is  tensor(141.2965, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9237839542329311
distance x is tensor(139.5302, device='cuda:0')
benign distance is  tensor(139.5302, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8146443627774715
distance x is tensor(134.5281, device='cuda:0')
benign distance is  tensor(134.5281, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0180203765630722
distance x is tensor(167.6453, device='cuda:0')
benign distance is  tensor(167.6453, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.242206022143364
distance x is tensor(126.7471, device='cuda:0')
benign distance is  tensor(126.7471, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7272475501522422
distance x is tensor(129.5585, device='cuda:0')
benign distance is  tensor(129.5585, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9691201224923134
distance x is tensor(123.8945, device='cuda:0')
benign distance is  tensor(123.8945, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6800172105431557
distance x is tensor(123.1162, device='cuda:0')
benign distance is  tensor(123.1162, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6594709306955338
distance x is tensor(133.6437, device='cuda:0')
benign distance is  tensor(133.6437, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7429015170782804
distance x is tensor(137.6761, device='cuda:0')
benign distance is  tensor(137.6761, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.315269861370325
distance x is tensor(144.4303, device='cuda:0')
benign distance is  tensor(144.4303, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3320339173078537
distance x is tensor(147.1369, device='cuda:0')
benign distance is  tensor(147.1369, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9739544931799173
distance x is tensor(118.1834, device='cuda:0')
benign distance is  tensor(118.1834, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7041687360033393
distance x is tensor(211.3978, device='cuda:0')
benign distance is  tensor(211.3978, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3495450988411903
distance x is tensor(179.4546, device='cuda:0')
benign distance is  tensor(179.4546, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.697720605880022
distance x is tensor(135.1202, device='cuda:0')
benign distance is  tensor(135.1202, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.31300000016000007
mal_loss is 20.497698068618774
mal_entropy is 0.10392520972527564
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([643.0626, 631.7031, 616.4335, 764.4423, 562.2170, 593.1173, 554.2034,
        565.8414, 460.4890, 460.4890, 460.4890, 460.4890, 460.4890, 460.4890,
        460.4890, 460.4890, 460.4890, 460.4890, 460.4890, 460.4890, 739.6069,
        603.8054, 817.4417, 749.0540, 750.0052, 728.8305, 675.1541, 922.3914,
        611.3736, 679.8049, 507.1754, 658.1357, 868.1881, 466.1479, 760.4136,
        710.3149], device='cuda:0')
sorted_norm is   tensor([460.4890, 460.4890, 460.4890, 460.4890, 460.4890, 460.4890, 460.4890,
        460.4890, 460.4890, 460.4890, 460.4890, 460.4890, 466.1479, 507.1754,
        554.2034, 562.2170, 565.8414, 593.1173, 603.8054, 611.3736, 616.4335,
        631.7031, 643.0626, 658.1357, 675.1541, 679.8049, 710.3149, 728.8305,
        739.6069, 749.0540, 750.0052, 760.4136, 764.4423, 817.4417, 868.1881,
        922.3914], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 30,  6,  4,  7,  5,
        21, 28,  2,  1,  0, 31, 26, 29, 35, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 94.67% 

Test Accuracy: 82.95% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8837042190134525
distance x is tensor(134.9604, device='cuda:0')
benign distance is  tensor(134.9604, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0907866805791855
distance x is tensor(124.9053, device='cuda:0')
benign distance is  tensor(124.9053, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.706783028319478
distance x is tensor(133.8042, device='cuda:0')
benign distance is  tensor(133.8042, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9623220451176167
distance x is tensor(172.2576, device='cuda:0')
benign distance is  tensor(172.2576, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1211618278175592
distance x is tensor(119.1107, device='cuda:0')
benign distance is  tensor(119.1107, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8481226330623031
distance x is tensor(124.4759, device='cuda:0')
benign distance is  tensor(124.4759, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5717454552650452
distance x is tensor(154.3051, device='cuda:0')
benign distance is  tensor(154.3051, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7879289276897907
distance x is tensor(124.1362, device='cuda:0')
benign distance is  tensor(124.1362, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.290543656796217
distance x is tensor(129.7623, device='cuda:0')
benign distance is  tensor(129.7623, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7450402583926916
distance x is tensor(140.1312, device='cuda:0')
benign distance is  tensor(140.1312, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2603570073843002
distance x is tensor(119.0818, device='cuda:0')
benign distance is  tensor(119.0818, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6876172311604023
distance x is tensor(143.6498, device='cuda:0')
benign distance is  tensor(143.6498, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1343432180583477
distance x is tensor(209.6934, device='cuda:0')
benign distance is  tensor(209.6934, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8206376079469919
distance x is tensor(89.1256, device='cuda:0')
benign distance is  tensor(89.1256, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8136054128408432
distance x is tensor(164.0748, device='cuda:0')
benign distance is  tensor(164.0748, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6518247872591019
distance x is tensor(141.1266, device='cuda:0')
benign distance is  tensor(141.1266, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0773154757916927
distance x is tensor(134.4265, device='cuda:0')
benign distance is  tensor(134.4265, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6954508610069752
distance x is tensor(105.3195, device='cuda:0')
benign distance is  tensor(105.3195, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0260443277657032
distance x is tensor(152.9276, device='cuda:0')
benign distance is  tensor(152.9276, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3690542057156563
distance x is tensor(138.5072, device='cuda:0')
benign distance is  tensor(138.5072, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.758513318374753
distance x is tensor(142.2456, device='cuda:0')
benign distance is  tensor(142.2456, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0562029052525759
distance x is tensor(144.1783, device='cuda:0')
benign distance is  tensor(144.1783, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.612418838776648
distance x is tensor(132.8029, device='cuda:0')
benign distance is  tensor(132.8029, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7813887260854244
distance x is tensor(185.3472, device='cuda:0')
benign distance is  tensor(185.3472, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.34600000016000004
mal_loss is 19.64132660627365
mal_entropy is 0.15482545737177134
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([615.6786, 566.3535, 608.7543, 776.6136, 531.3642, 558.7838, 689.9897,
        563.0239, 460.9377, 460.9377, 460.9377, 460.9377, 460.9377, 460.9377,
        460.9377, 460.9377, 460.9377, 460.9377, 460.9377, 460.9377, 734.5671,
        701.3922, 829.7782, 763.5984, 684.5342, 620.5065, 671.9087, 719.8804],
       device='cuda:0')
sorted_norm is   tensor([460.9377, 460.9377, 460.9377, 460.9377, 460.9377, 460.9377, 460.9377,
        460.9377, 460.9377, 460.9377, 460.9377, 460.9377, 531.3642, 558.7838,
        563.0239, 566.3535, 608.7543, 615.6786, 620.5065, 671.9087, 684.5342,
        689.9897, 701.3922, 719.8804, 734.5671, 763.5984, 776.6136, 829.7782],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  5,  7,  1,  2,  0,
        25, 26, 24,  6], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 93.56% 

Test Accuracy: 76.04% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8341742679476738
distance x is tensor(159.5507, device='cuda:0')
benign distance is  tensor(159.5507, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9428939763456583
distance x is tensor(163.4704, device='cuda:0')
benign distance is  tensor(163.4704, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7443782556802034
distance x is tensor(160.7250, device='cuda:0')
benign distance is  tensor(160.7250, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.021075513213873
distance x is tensor(177.1983, device='cuda:0')
benign distance is  tensor(177.1983, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0614810101687908
distance x is tensor(151.4842, device='cuda:0')
benign distance is  tensor(151.4842, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7100497325882316
distance x is tensor(145.9599, device='cuda:0')
benign distance is  tensor(145.9599, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9927105326205492
distance x is tensor(126.1453, device='cuda:0')
benign distance is  tensor(126.1453, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.733109513297677
distance x is tensor(131.0611, device='cuda:0')
benign distance is  tensor(131.0611, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.774034321308136
distance x is tensor(172.4624, device='cuda:0')
benign distance is  tensor(172.4624, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.0010031685233116
distance x is tensor(138.4178, device='cuda:0')
benign distance is  tensor(138.4178, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8031389843672514
distance x is tensor(175.0145, device='cuda:0')
benign distance is  tensor(175.0145, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.9203491657972336
distance x is tensor(169.5283, device='cuda:0')
benign distance is  tensor(169.5283, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8905466422438622
distance x is tensor(143.6784, device='cuda:0')
benign distance is  tensor(143.6784, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9248674772679806
distance x is tensor(123.9413, device='cuda:0')
benign distance is  tensor(123.9413, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.052510891109705
distance x is tensor(135.1920, device='cuda:0')
benign distance is  tensor(135.1920, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8541946914047003
distance x is tensor(157.3184, device='cuda:0')
benign distance is  tensor(157.3184, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3310000001600001
mal_loss is 35.2688490152359
mal_entropy is 0.09765600366517901
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([710.9410, 731.7723, 704.0385, 785.1580, 651.1299, 632.8333, 562.4080,
        553.5512, 461.0233, 461.0233, 461.0233, 461.0233, 461.0233, 461.0233,
        461.0233, 461.0233, 461.0233, 461.0233, 461.0233, 461.0233, 774.5787,
        861.3604, 894.6642, 708.9537, 928.0594, 837.8621, 738.5770, 803.4152,
        677.4417, 697.2032, 708.1419, 717.3083, 614.8329, 987.1184, 866.5563,
        696.4021, 635.7375, 682.6859, 600.4139, 698.0044, 958.0439, 467.3114,
        772.1655, 690.6040], device='cuda:0')
sorted_norm is   tensor([461.0233, 461.0233, 461.0233, 461.0233, 461.0233, 461.0233, 461.0233,
        461.0233, 461.0233, 461.0233, 461.0233, 461.0233, 467.3114, 553.5512,
        562.4080, 600.4139, 614.8329, 632.8333, 635.7375, 651.1299, 677.4417,
        682.6859, 690.6040, 696.4021, 697.2032, 698.0044, 704.0385, 708.1419,
        708.9537, 710.9410, 717.3083, 731.7723, 738.5770, 772.1655, 774.5787,
        785.1580, 803.4152, 837.8621, 861.3604, 866.5563, 894.6642, 928.0594,
        958.0439, 987.1184], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 41,  7,  6, 38, 32,  5,
        36,  4, 28, 37, 43, 35, 29, 39,  2, 30, 23,  0, 31,  1, 26, 42, 20],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 94.58% 

Test Accuracy: 84.88% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8136617988348007
distance x is tensor(145.9821, device='cuda:0')
benign distance is  tensor(145.9821, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7432511057704687
distance x is tensor(136.5526, device='cuda:0')
benign distance is  tensor(136.5526, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.804823799058795
distance x is tensor(127.3154, device='cuda:0')
benign distance is  tensor(127.3154, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8270823564380407
distance x is tensor(172.3745, device='cuda:0')
benign distance is  tensor(172.3745, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0380848459899426
distance x is tensor(128.1809, device='cuda:0')
benign distance is  tensor(128.1809, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6552354511804879
distance x is tensor(119.4052, device='cuda:0')
benign distance is  tensor(119.4052, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.302599161863327
distance x is tensor(116.5603, device='cuda:0')
benign distance is  tensor(116.5603, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7921875193715096
distance x is tensor(111.2579, device='cuda:0')
benign distance is  tensor(111.2579, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8504404705017805
distance x is tensor(111.5091, device='cuda:0')
benign distance is  tensor(111.5091, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6647194665856659
distance x is tensor(126.4845, device='cuda:0')
benign distance is  tensor(126.4845, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0699139460921288
distance x is tensor(104.6807, device='cuda:0')
benign distance is  tensor(104.6807, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3132463209331036
distance x is tensor(134.8132, device='cuda:0')
benign distance is  tensor(134.8132, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0866754576563835
distance x is tensor(172.2843, device='cuda:0')
benign distance is  tensor(172.2843, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6604493102058768
distance x is tensor(84.9666, device='cuda:0')
benign distance is  tensor(84.9666, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8877286911010742
distance x is tensor(144.1596, device='cuda:0')
benign distance is  tensor(144.1596, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.682656817138195
distance x is tensor(145.2982, device='cuda:0')
benign distance is  tensor(145.2982, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.249535821378231
distance x is tensor(128.5737, device='cuda:0')
benign distance is  tensor(128.5737, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7611607350409031
distance x is tensor(129.5906, device='cuda:0')
benign distance is  tensor(129.5906, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2325462438166142
distance x is tensor(143.9850, device='cuda:0')
benign distance is  tensor(143.9850, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.957609761506319
distance x is tensor(133.5607, device='cuda:0')
benign distance is  tensor(133.5607, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9691647654399276
distance x is tensor(98.0441, device='cuda:0')
benign distance is  tensor(98.0441, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7227870225906372
distance x is tensor(223.5661, device='cuda:0')
benign distance is  tensor(223.5661, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3371131159365177
distance x is tensor(172.0324, device='cuda:0')
benign distance is  tensor(172.0324, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7746674455702305
distance x is tensor(129.8545, device='cuda:0')
benign distance is  tensor(129.8545, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.5720743983983994
distance x is tensor(129.6920, device='cuda:0')
benign distance is  tensor(129.6920, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.6825282238423824
distance x is tensor(160.3598, device='cuda:0')
benign distance is  tensor(160.3598, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.5053728967905045
distance x is tensor(158.3593, device='cuda:0')
benign distance is  tensor(158.3593, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.126298226416111
distance x is tensor(106.4752, device='cuda:0')
benign distance is  tensor(106.4752, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6155544947832823
distance x is tensor(173.4733, device='cuda:0')
benign distance is  tensor(173.4733, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9597386438399553
distance x is tensor(152.1600, device='cuda:0')
benign distance is  tensor(152.1600, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9232654515653849
distance x is tensor(122.1276, device='cuda:0')
benign distance is  tensor(122.1276, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5647361651062965
distance x is tensor(145.5736, device='cuda:0')
benign distance is  tensor(145.5736, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3970000001600001
mal_loss is 12.5892972946167
mal_entropy is 0.1439188034273684
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([659.7023, 626.6571, 582.3351, 782.5663, 573.2997, 532.4526, 536.7244,
        508.4084, 458.5991, 458.5991, 458.5991, 458.5991, 458.5991, 458.5991,
        458.5991, 458.5991, 458.5991, 458.5991, 458.5991, 458.5991],
       device='cuda:0')
sorted_norm is   tensor([458.5991, 458.5991, 458.5991, 458.5991, 458.5991, 458.5991, 458.5991,
        458.5991, 458.5991, 458.5991, 458.5991, 458.5991, 508.4084, 532.4526,
        536.7244, 573.2997, 582.3351, 626.6571, 659.7023, 782.5663],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  5,  6,  4],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 91.33% 

Test Accuracy: 56.81% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9375128857791424
distance x is tensor(181.4999, device='cuda:0')
benign distance is  tensor(181.4999, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.936671145260334
distance x is tensor(177.5876, device='cuda:0')
benign distance is  tensor(177.5876, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8307507019490004
distance x is tensor(203.9629, device='cuda:0')
benign distance is  tensor(203.9629, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1187645085155964
distance x is tensor(221.1263, device='cuda:0')
benign distance is  tensor(221.1263, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4594262912869453
distance x is tensor(234.4327, device='cuda:0')
benign distance is  tensor(234.4327, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.970696727745235
distance x is tensor(180.7946, device='cuda:0')
benign distance is  tensor(180.7946, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9929583817720413
distance x is tensor(182.1147, device='cuda:0')
benign distance is  tensor(182.1147, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.967679450288415
distance x is tensor(173.4209, device='cuda:0')
benign distance is  tensor(173.4209, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.28400000016000004
mal_loss is 66.21406149864197
mal_entropy is 0.05339336092583835
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([753.2328, 735.1518, 820.6212, 907.7334, 960.5290, 741.4586, 745.2401,
        712.3624, 461.7201, 461.7201, 461.7201, 461.7201, 461.7201, 461.7201,
        461.7201, 461.7201, 461.7201, 461.7201, 461.7201, 461.7201, 737.2318,
        651.3795, 816.3895, 767.8996, 775.7196, 799.4016, 747.7651, 951.5944,
        616.7768, 686.2991, 593.2040, 716.3770, 870.4296, 515.7953, 749.0413,
        769.0146], device='cuda:0')
sorted_norm is   tensor([461.7201, 461.7201, 461.7201, 461.7201, 461.7201, 461.7201, 461.7201,
        461.7201, 461.7201, 461.7201, 461.7201, 461.7201, 515.7953, 593.2040,
        616.7768, 651.3795, 686.2991, 712.3624, 716.3770, 735.1518, 737.2318,
        741.4586, 745.2401, 747.7651, 749.0413, 753.2328, 767.8996, 769.0146,
        775.7196, 799.4016, 816.3895, 820.6212, 870.4296, 907.7334, 951.5944,
        960.5290], device='cuda:0')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 33, 30, 28, 21, 29,  7,
        31,  1, 20,  5,  6, 26, 34,  0, 23, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 93.01% 

Test Accuracy: 77.64% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.923044690862298
distance x is tensor(165.0310, device='cuda:0')
benign distance is  tensor(165.0310, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2215325869619846
distance x is tensor(148.9438, device='cuda:0')
benign distance is  tensor(148.9438, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.80047214217484
distance x is tensor(147.5024, device='cuda:0')
benign distance is  tensor(147.5024, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0679587684571743
distance x is tensor(177.7869, device='cuda:0')
benign distance is  tensor(177.7869, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0222253957763314
distance x is tensor(120.6413, device='cuda:0')
benign distance is  tensor(120.6413, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7087429463863373
distance x is tensor(120.3096, device='cuda:0')
benign distance is  tensor(120.3096, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4228597544133663
distance x is tensor(141.8920, device='cuda:0')
benign distance is  tensor(141.8920, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2393321245908737
distance x is tensor(117.6126, device='cuda:0')
benign distance is  tensor(117.6126, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1208353377878666
distance x is tensor(141.3850, device='cuda:0')
benign distance is  tensor(141.3850, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7476252382621169
distance x is tensor(154.2758, device='cuda:0')
benign distance is  tensor(154.2758, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3884547539055347
distance x is tensor(123.2372, device='cuda:0')
benign distance is  tensor(123.2372, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.143525093793869
distance x is tensor(148.5573, device='cuda:0')
benign distance is  tensor(148.5573, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4100505821406841
distance x is tensor(187.0277, device='cuda:0')
benign distance is  tensor(187.0277, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8701782748103142
distance x is tensor(107.6358, device='cuda:0')
benign distance is  tensor(107.6358, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2007098533213139
distance x is tensor(169.5875, device='cuda:0')
benign distance is  tensor(169.5875, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.025778390467167
distance x is tensor(149.0313, device='cuda:0')
benign distance is  tensor(149.0313, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4120157584547997
distance x is tensor(155.3759, device='cuda:0')
benign distance is  tensor(155.3759, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8065461292862892
distance x is tensor(130.5240, device='cuda:0')
benign distance is  tensor(130.5240, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.155065182596445
distance x is tensor(164.2421, device='cuda:0')
benign distance is  tensor(164.2421, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.9038300588726997
distance x is tensor(135.6412, device='cuda:0')
benign distance is  tensor(135.6412, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.109817262738943
distance x is tensor(161.1740, device='cuda:0')
benign distance is  tensor(161.1740, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9276307392865419
distance x is tensor(151.5444, device='cuda:0')
benign distance is  tensor(151.5444, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7528221029788256
distance x is tensor(150.4570, device='cuda:0')
benign distance is  tensor(150.4570, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7453289590775967
distance x is tensor(191.2225, device='cuda:0')
benign distance is  tensor(191.2225, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.36800000016000006
mal_loss is 21.14136528968811
mal_entropy is 0.09070990281179547
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 744.0723,  669.2862,  658.5643,  788.8279,  540.3580,  536.2936,
         629.2857,  528.6152,  455.2582,  455.2582,  455.2582,  455.2582,
         455.2582,  455.2582,  455.2582,  455.2582,  455.2582,  455.2582,
         455.2582,  455.2582,  670.8903,  664.6113,  706.2825,  691.5536,
         536.3995, 1035.4310,  841.2239,  672.4611], device='cuda:0')
sorted_norm is   tensor([ 455.2582,  455.2582,  455.2582,  455.2582,  455.2582,  455.2582,
         455.2582,  455.2582,  455.2582,  455.2582,  455.2582,  455.2582,
         528.6152,  536.2936,  536.3995,  540.3580,  629.2857,  658.5643,
         664.6113,  669.2862,  670.8903,  672.4611,  691.5536,  706.2825,
         744.0723,  788.8279,  841.2239, 1035.4310], device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  5, 24,  4,  6,  2,
        21,  1, 20, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 92.21% 

Test Accuracy: 71.44% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.756866104900837
distance x is tensor(167.3108, device='cuda:0')
benign distance is  tensor(167.3108, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.974485382437706
distance x is tensor(168.5972, device='cuda:0')
benign distance is  tensor(168.5972, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8422792199999094
distance x is tensor(163.4377, device='cuda:0')
benign distance is  tensor(163.4377, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2606920525431633
distance x is tensor(188.3095, device='cuda:0')
benign distance is  tensor(188.3095, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.327975519001484
distance x is tensor(145.5530, device='cuda:0')
benign distance is  tensor(145.5530, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9285732787102461
distance x is tensor(146.4778, device='cuda:0')
benign distance is  tensor(146.4778, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.942949254065752
distance x is tensor(153.9708, device='cuda:0')
benign distance is  tensor(153.9708, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.883076261729002
distance x is tensor(152.5208, device='cuda:0')
benign distance is  tensor(152.5208, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6066999286413193
distance x is tensor(173.1084, device='cuda:0')
benign distance is  tensor(173.1084, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7882768400013447
distance x is tensor(162.0238, device='cuda:0')
benign distance is  tensor(162.0238, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7721251510083675
distance x is tensor(168.7494, device='cuda:0')
benign distance is  tensor(168.7494, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7718014493584633
distance x is tensor(183.8779, device='cuda:0')
benign distance is  tensor(183.8779, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.4743049331009388
distance x is tensor(140.0908, device='cuda:0')
benign distance is  tensor(140.0908, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8946203328669071
distance x is tensor(237.2761, device='cuda:0')
benign distance is  tensor(237.2761, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.338273786008358
distance x is tensor(193.7770, device='cuda:0')
benign distance is  tensor(193.7770, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8354424256831408
distance x is tensor(160.1238, device='cuda:0')
benign distance is  tensor(160.1238, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3240000001600001
mal_loss is 39.55582284927368
mal_entropy is 0.05682115908712149
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([744.7890, 751.5015, 692.7510, 824.1209, 648.6962, 630.8552, 687.8862,
        669.3836, 457.2639, 457.2639, 457.2639, 457.2639, 457.2639, 457.2639,
        457.2639, 457.2639, 457.2639, 457.2639, 457.2639, 457.2639, 885.4543,
        729.6008, 881.9161, 861.9821, 748.3178, 692.5771, 714.3652, 824.6643,
        666.0644, 733.5691, 597.8080, 711.5101, 855.1630, 531.3414, 795.8832,
        710.1513], device='cuda:0')
sorted_norm is   tensor([457.2639, 457.2639, 457.2639, 457.2639, 457.2639, 457.2639, 457.2639,
        457.2639, 457.2639, 457.2639, 457.2639, 457.2639, 531.3414, 597.8080,
        630.8552, 648.6962, 666.0644, 669.3836, 687.8862, 692.5771, 692.7510,
        710.1513, 711.5101, 714.3652, 729.6008, 733.5691, 744.7890, 748.3178,
        751.5015, 795.8832, 824.1209, 824.6643, 855.1630, 861.9821, 881.9161,
        885.4543], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 30,  5,  4, 28,  7,
         6, 25,  2, 35, 31, 26, 21, 29,  0, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 93.05% 

Test Accuracy: 80.40% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8992652557790279
distance x is tensor(160.9558, device='cuda:0')
benign distance is  tensor(160.9558, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8172336257994175
distance x is tensor(132.1414, device='cuda:0')
benign distance is  tensor(132.1414, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0490339249372482
distance x is tensor(140.4962, device='cuda:0')
benign distance is  tensor(140.4962, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2538663893938065
distance x is tensor(171.0531, device='cuda:0')
benign distance is  tensor(171.0531, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3944518715143204
distance x is tensor(121.1469, device='cuda:0')
benign distance is  tensor(121.1469, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9010075284168124
distance x is tensor(122.0146, device='cuda:0')
benign distance is  tensor(122.0146, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2868738416582346
distance x is tensor(131.0727, device='cuda:0')
benign distance is  tensor(131.0727, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8765325788408518
distance x is tensor(119.8185, device='cuda:0')
benign distance is  tensor(119.8185, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.334622085094452
distance x is tensor(133.6797, device='cuda:0')
benign distance is  tensor(133.6797, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8165457658469677
distance x is tensor(180.5350, device='cuda:0')
benign distance is  tensor(180.5350, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3360779769718647
distance x is tensor(114.0264, device='cuda:0')
benign distance is  tensor(114.0264, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.826286643743515
distance x is tensor(148.0160, device='cuda:0')
benign distance is  tensor(148.0160, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.374429378658533
distance x is tensor(200.2403, device='cuda:0')
benign distance is  tensor(200.2403, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.4514000043272972
distance x is tensor(119.5834, device='cuda:0')
benign distance is  tensor(119.5834, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1641238331794739
distance x is tensor(166.3640, device='cuda:0')
benign distance is  tensor(166.3640, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7601423934102058
distance x is tensor(161.0665, device='cuda:0')
benign distance is  tensor(161.0665, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0002780426293612
distance x is tensor(162.9842, device='cuda:0')
benign distance is  tensor(162.9842, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.7028229087591171
distance x is tensor(143.5072, device='cuda:0')
benign distance is  tensor(143.5072, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7522764541208744
distance x is tensor(175.7510, device='cuda:0')
benign distance is  tensor(175.7510, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.9231535866856575
distance x is tensor(173.5917, device='cuda:0')
benign distance is  tensor(173.5917, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.01122822239995
distance x is tensor(149.6090, device='cuda:0')
benign distance is  tensor(149.6090, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0072593912482262
distance x is tensor(116.7807, device='cuda:0')
benign distance is  tensor(116.7807, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0273792538791895
distance x is tensor(129.2471, device='cuda:0')
benign distance is  tensor(129.2471, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8952679540961981
distance x is tensor(157.9381, device='cuda:0')
benign distance is  tensor(157.9381, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.35200000016000005
mal_loss is 22.326149463653564
mal_entropy is 0.0696756043471396
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([719.2399, 588.9333, 615.9401, 768.3243, 535.5724, 539.9020, 603.9303,
        550.4930, 458.8667, 458.8667, 458.8667, 458.8667, 458.8667, 458.8667,
        458.8667, 458.8667, 458.8667, 458.8667, 458.8667, 458.8667],
       device='cuda:0')
sorted_norm is   tensor([458.8667, 458.8667, 458.8667, 458.8667, 458.8667, 458.8667, 458.8667,
        458.8667, 458.8667, 458.8667, 458.8667, 458.8667, 535.5724, 539.9020,
        550.4930, 588.9333, 603.9303, 615.9401, 719.2399, 768.3243],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  5,  7,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 89.87% 

Test Accuracy: 47.86% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.084717981517315
distance x is tensor(240.4149, device='cuda:0')
benign distance is  tensor(240.4149, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.831895686686039
distance x is tensor(234.4512, device='cuda:0')
benign distance is  tensor(234.4512, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8325220942497253
distance x is tensor(244.7064, device='cuda:0')
benign distance is  tensor(244.7064, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.951172910630703
distance x is tensor(245.2526, device='cuda:0')
benign distance is  tensor(245.2526, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2442309632897377
distance x is tensor(258.8215, device='cuda:0')
benign distance is  tensor(258.8215, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0013957899063826
distance x is tensor(212.1338, device='cuda:0')
benign distance is  tensor(212.1338, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.046876735985279
distance x is tensor(221.3391, device='cuda:0')
benign distance is  tensor(221.3391, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0431575365364552
distance x is tensor(205.1435, device='cuda:0')
benign distance is  tensor(205.1435, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.14500000016000006
mal_loss is 103.24526262283325
mal_entropy is 0.014920476525730919
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 962.0582,  905.9882,  924.2297,  980.5573, 1027.7361,  851.6438,
         893.3108,  815.6735,  460.5678,  460.5678,  460.5678,  460.5678,
         460.5678,  460.5678,  460.5678,  460.5678,  460.5678,  460.5678,
         460.5678,  460.5678,  872.0352,  963.1214,  940.9031,  778.8270,
        1026.8086,  931.3025,  841.9897,  912.2627,  843.0887,  747.9067,
         904.7706,  786.6418,  878.4955,  829.8592,  848.3143,  980.6463,
         880.8130,  823.0240,  844.1407,  905.0852,  744.6584, 1109.1924,
         945.8707,  827.2189,  707.4264,  882.5241,  628.4459,  756.9923,
         968.1408,  644.6603,  816.8827,  804.5467], device='cuda:0')
sorted_norm is   tensor([ 460.5678,  460.5678,  460.5678,  460.5678,  460.5678,  460.5678,
         460.5678,  460.5678,  460.5678,  460.5678,  460.5678,  460.5678,
         628.4459,  644.6603,  707.4264,  744.6584,  747.9067,  756.9923,
         778.8270,  786.6418,  804.5467,  815.6735,  816.8827,  823.0240,
         827.2189,  829.8592,  841.9897,  843.0887,  844.1407,  848.3143,
         851.6438,  872.0352,  878.4955,  880.8130,  882.5241,  893.3108,
         904.7706,  905.0852,  905.9882,  912.2627,  924.2297,  931.3025,
         940.9031,  945.8707,  962.0582,  963.1214,  968.1408,  980.5573,
         980.6463, 1026.8086, 1027.7361, 1109.1924], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 46, 49, 44, 40, 29, 47,
        23, 31, 51,  7, 50, 37, 43, 33, 26, 28, 38, 34,  5, 20, 32, 36, 45,  6,
        30, 39,  1, 27,  2], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 92.87% 

Test Accuracy: 84.07% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9379338528960943
distance x is tensor(150.8576, device='cuda:0')
benign distance is  tensor(150.8576, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8462763726711273
distance x is tensor(125.2996, device='cuda:0')
benign distance is  tensor(125.2996, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9447320103645325
distance x is tensor(130.9876, device='cuda:0')
benign distance is  tensor(130.9876, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1329126600176096
distance x is tensor(179.4653, device='cuda:0')
benign distance is  tensor(179.4653, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5332225691527128
distance x is tensor(113.5174, device='cuda:0')
benign distance is  tensor(113.5174, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8934430005028844
distance x is tensor(123.0237, device='cuda:0')
benign distance is  tensor(123.0237, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1679882779717445
distance x is tensor(125.1584, device='cuda:0')
benign distance is  tensor(125.1584, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8494632709771395
distance x is tensor(101.0410, device='cuda:0')
benign distance is  tensor(101.0410, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1679521538317204
distance x is tensor(127.6109, device='cuda:0')
benign distance is  tensor(127.6109, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7101594274863601
distance x is tensor(137.7677, device='cuda:0')
benign distance is  tensor(137.7677, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4195633120834827
distance x is tensor(102.0560, device='cuda:0')
benign distance is  tensor(102.0560, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5781787969172
distance x is tensor(134.5877, device='cuda:0')
benign distance is  tensor(134.5877, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3210543766617775
distance x is tensor(174.8670, device='cuda:0')
benign distance is  tensor(174.8670, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7752012796700001
distance x is tensor(76.2557, device='cuda:0')
benign distance is  tensor(76.2557, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2977720014750957
distance x is tensor(164.5143, device='cuda:0')
benign distance is  tensor(164.5143, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.6147661358118057
distance x is tensor(136.2817, device='cuda:0')
benign distance is  tensor(136.2817, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.040623188018799
distance x is tensor(128.2338, device='cuda:0')
benign distance is  tensor(128.2338, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8387008998543024
distance x is tensor(127.2674, device='cuda:0')
benign distance is  tensor(127.2674, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3630003817379475
distance x is tensor(137.6454, device='cuda:0')
benign distance is  tensor(137.6454, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0688170157372952
distance x is tensor(135.2203, device='cuda:0')
benign distance is  tensor(135.2203, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6630641780793667
distance x is tensor(102.8107, device='cuda:0')
benign distance is  tensor(102.8107, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7998242024332285
distance x is tensor(214.7485, device='cuda:0')
benign distance is  tensor(214.7485, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2099131643772125
distance x is tensor(170.6590, device='cuda:0')
benign distance is  tensor(170.6590, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8322534132748842
distance x is tensor(126.4974, device='cuda:0')
benign distance is  tensor(126.4974, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4606459811329842
distance x is tensor(139.1725, device='cuda:0')
benign distance is  tensor(139.1725, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8479009494185448
distance x is tensor(96.8644, device='cuda:0')
benign distance is  tensor(96.8644, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.194263018667698
distance x is tensor(147.1189, device='cuda:0')
benign distance is  tensor(147.1189, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.5661516562104225
distance x is tensor(137.4287, device='cuda:0')
benign distance is  tensor(137.4287, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.008174180984497
distance x is tensor(125.1874, device='cuda:0')
benign distance is  tensor(125.1874, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.1106154974550009
distance x is tensor(140.6376, device='cuda:0')
benign distance is  tensor(140.6376, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5998689252883196
distance x is tensor(122.7993, device='cuda:0')
benign distance is  tensor(122.7993, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0937365926802158
distance x is tensor(180.5743, device='cuda:0')
benign distance is  tensor(180.5743, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.903485968708992
distance x is tensor(141.9423, device='cuda:0')
benign distance is  tensor(141.9423, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.8941880017518997
distance x is tensor(155.6633, device='cuda:0')
benign distance is  tensor(155.6633, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1872180476784706
distance x is tensor(153.2890, device='cuda:0')
benign distance is  tensor(153.2890, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.4793944172561169
distance x is tensor(108.2724, device='cuda:0')
benign distance is  tensor(108.2724, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8028193898499012
distance x is tensor(169.6260, device='cuda:0')
benign distance is  tensor(169.6260, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.210512451827526
distance x is tensor(152.0511, device='cuda:0')
benign distance is  tensor(152.0511, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0217601396143436
distance x is tensor(125.5856, device='cuda:0')
benign distance is  tensor(125.5856, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6468331525102258
distance x is tensor(147.1796, device='cuda:0')
benign distance is  tensor(147.1796, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.51800000016
mal_loss is 5.086842358112335
mal_entropy is 0.21508604660630226
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([694.4388, 589.4501, 592.1650, 810.2827, 515.6863, 550.1339, 577.4042,
        458.8149, 448.5026, 448.5026, 448.5026, 448.5026, 448.5026, 448.5026,
        448.5026, 448.5026, 448.5026, 448.5026, 448.5026, 448.5026],
       device='cuda:0')
sorted_norm is   tensor([448.5026, 448.5026, 448.5026, 448.5026, 448.5026, 448.5026, 448.5026,
        448.5026, 448.5026, 448.5026, 448.5026, 448.5026, 458.8149, 515.6863,
        550.1339, 577.4042, 589.4501, 592.1650, 694.4388, 810.2827],
       device='cuda:0')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  7,  4,  5,  6],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 91.16% 

Test Accuracy: 70.91% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8776864148676395
distance x is tensor(185.4781, device='cuda:0')
benign distance is  tensor(185.4781, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1810828000307083
distance x is tensor(167.4274, device='cuda:0')
benign distance is  tensor(167.4274, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4804362803697586
distance x is tensor(178.3021, device='cuda:0')
benign distance is  tensor(178.3021, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0781788975000381
distance x is tensor(209.1902, device='cuda:0')
benign distance is  tensor(209.1902, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3925366923213005
distance x is tensor(168.1436, device='cuda:0')
benign distance is  tensor(168.1436, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1483987672254443
distance x is tensor(156.6004, device='cuda:0')
benign distance is  tensor(156.6004, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.240845002233982
distance x is tensor(154.6452, device='cuda:0')
benign distance is  tensor(154.6452, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1508450955152512
distance x is tensor(138.0719, device='cuda:0')
benign distance is  tensor(138.0719, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3230000001600001
mal_loss is 32.52778208255768
mal_entropy is 0.0525885249953717
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([838.2978, 712.1349, 769.8645, 893.2299, 742.8316, 688.4819, 689.3398,
        612.1815, 459.5294, 459.5294, 459.5294, 459.5294, 459.5294, 459.5294,
        459.5294, 459.5294, 459.5294, 459.5294, 459.5294, 459.5294, 689.1752,
        716.6263, 586.7595, 709.0958, 876.4491, 489.3068, 814.2076, 719.9494],
       device='cuda:0')
sorted_norm is   tensor([459.5294, 459.5294, 459.5294, 459.5294, 459.5294, 459.5294, 459.5294,
        459.5294, 459.5294, 459.5294, 459.5294, 459.5294, 489.3068, 586.7595,
        612.1815, 688.4819, 689.1752, 689.3398, 709.0958, 712.1349, 716.6263,
        719.9494, 742.8316, 769.8645, 814.2076, 838.2978, 876.4491, 893.2299],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25, 22,  7,  5, 20,  6,
        23,  1, 21, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 90.01% 

Test Accuracy: 66.58% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8681382425129414
distance x is tensor(182.6892, device='cuda:0')
benign distance is  tensor(182.6892, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4483937546610832
distance x is tensor(174.1705, device='cuda:0')
benign distance is  tensor(174.1705, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.347028002142906
distance x is tensor(184.9787, device='cuda:0')
benign distance is  tensor(184.9787, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3470875918865204
distance x is tensor(205.9504, device='cuda:0')
benign distance is  tensor(205.9504, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6945965774357319
distance x is tensor(188.8394, device='cuda:0')
benign distance is  tensor(188.8394, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0443611182272434
distance x is tensor(172.1399, device='cuda:0')
benign distance is  tensor(172.1399, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6331239342689514
distance x is tensor(168.8978, device='cuda:0')
benign distance is  tensor(168.8978, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0454006996005774
distance x is tensor(149.2045, device='cuda:0')
benign distance is  tensor(149.2045, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5489093884825706
distance x is tensor(175.7650, device='cuda:0')
benign distance is  tensor(175.7650, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.232350680977106
distance x is tensor(182.6345, device='cuda:0')
benign distance is  tensor(182.6345, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.997593030333519
distance x is tensor(164.1390, device='cuda:0')
benign distance is  tensor(164.1390, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.9277133345603943
distance x is tensor(178.4747, device='cuda:0')
benign distance is  tensor(178.4747, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6259028166532516
distance x is tensor(221.9755, device='cuda:0')
benign distance is  tensor(221.9755, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8983661010861397
distance x is tensor(139.5381, device='cuda:0')
benign distance is  tensor(139.5381, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1085686832666397
distance x is tensor(183.2371, device='cuda:0')
benign distance is  tensor(183.2371, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.1958291083574295
distance x is tensor(193.5950, device='cuda:0')
benign distance is  tensor(193.5950, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2580000001600001
mal_loss is 47.753968477249146
mal_entropy is 0.04687059001298621
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 815.1982,  720.2690,  753.8162,  860.2757,  770.7066,  726.6867,
         724.9545,  642.7748,  458.6445,  458.6445,  458.6445,  458.6445,
         458.6445,  458.6445,  458.6445,  458.6445,  458.6445,  458.6445,
         458.6445,  458.6445,  861.2795,  780.7106,  914.7507,  913.1213,
         794.5363,  704.5356,  735.4982,  839.3409,  714.5959,  700.9285,
         729.9492,  749.1950,  611.6130, 1034.8942,  872.6719,  708.8586],
       device='cuda:0')
sorted_norm is   tensor([ 458.6445,  458.6445,  458.6445,  458.6445,  458.6445,  458.6445,
         458.6445,  458.6445,  458.6445,  458.6445,  458.6445,  458.6445,
         611.6130,  642.7748,  700.9285,  704.5356,  708.8586,  714.5959,
         720.2690,  724.9545,  726.6867,  729.9492,  735.4982,  749.1950,
         753.8162,  770.7066,  780.7106,  794.5363,  815.1982,  839.3409,
         860.2757,  861.2795,  872.6719,  913.1213,  914.7507, 1034.8942],
       device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 32,  7, 29, 25, 35, 28,
         1,  6,  5, 30, 26, 31,  2,  4, 21, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 91.08% 

Test Accuracy: 79.14% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8511515446007252
distance x is tensor(154.1771, device='cuda:0')
benign distance is  tensor(154.1771, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2086158469319344
distance x is tensor(142.8350, device='cuda:0')
benign distance is  tensor(142.8350, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0086562037467957
distance x is tensor(153.4090, device='cuda:0')
benign distance is  tensor(153.4090, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.146777294576168
distance x is tensor(189.5358, device='cuda:0')
benign distance is  tensor(189.5358, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1975133400410414
distance x is tensor(141.0255, device='cuda:0')
benign distance is  tensor(141.0255, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0611219862475991
distance x is tensor(138.5491, device='cuda:0')
benign distance is  tensor(138.5491, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.229254860430956
distance x is tensor(145.7406, device='cuda:0')
benign distance is  tensor(145.7406, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8561030961573124
distance x is tensor(123.6113, device='cuda:0')
benign distance is  tensor(123.6113, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4612050093710423
distance x is tensor(154.1761, device='cuda:0')
benign distance is  tensor(154.1761, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9696610830724239
distance x is tensor(136.4296, device='cuda:0')
benign distance is  tensor(136.4296, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8953294456005096
distance x is tensor(155.3982, device='cuda:0')
benign distance is  tensor(155.3982, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.317235179245472
distance x is tensor(160.0369, device='cuda:0')
benign distance is  tensor(160.0369, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6478342562913895
distance x is tensor(136.1600, device='cuda:0')
benign distance is  tensor(136.1600, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8550302870571613
distance x is tensor(231.7480, device='cuda:0')
benign distance is  tensor(231.7480, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5040534660220146
distance x is tensor(196.1198, device='cuda:0')
benign distance is  tensor(196.1198, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.010062601417303
distance x is tensor(159.7957, device='cuda:0')
benign distance is  tensor(159.7957, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0326020903885365
distance x is tensor(159.0480, device='cuda:0')
benign distance is  tensor(159.0480, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.6553879901766777
distance x is tensor(166.4144, device='cuda:0')
benign distance is  tensor(166.4144, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.0666405633091927
distance x is tensor(167.5478, device='cuda:0')
benign distance is  tensor(167.5478, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.6228488236665726
distance x is tensor(164.4088, device='cuda:0')
benign distance is  tensor(164.4088, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9346489794552326
distance x is tensor(142.3790, device='cuda:0')
benign distance is  tensor(142.3790, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.3912223055958748
distance x is tensor(138.5520, device='cuda:0')
benign distance is  tensor(138.5520, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.3250290304422379
distance x is tensor(136.2805, device='cuda:0')
benign distance is  tensor(136.2805, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9492782205343246
distance x is tensor(157.2426, device='cuda:0')
benign distance is  tensor(157.2426, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3330000001600001
mal_loss is 21.596564888954163
mal_entropy is 0.07643298362381756
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([685.2895, 640.7632, 674.5861, 824.6608, 628.9291, 610.4214, 659.9599,
        555.3972, 458.3920, 458.3920, 458.3920, 458.3920, 458.3920, 458.3920,
        458.3920, 458.3920, 458.3920, 458.3920, 458.3920, 458.3920, 717.1907,
        561.8146, 759.1086, 718.4299, 663.0025, 732.0080, 650.0749, 891.1047,
        752.7529, 771.5532, 692.1134, 754.4597, 924.2322, 612.8881, 790.9523,
        814.1300], device='cuda:0')
sorted_norm is   tensor([458.3920, 458.3920, 458.3920, 458.3920, 458.3920, 458.3920, 458.3920,
        458.3920, 458.3920, 458.3920, 458.3920, 458.3920, 555.3972, 561.8146,
        610.4214, 612.8881, 628.9291, 640.7632, 650.0749, 659.9599, 663.0025,
        674.5861, 685.2895, 692.1134, 717.1907, 718.4299, 732.0080, 752.7529,
        754.4597, 759.1086, 771.5532, 790.9523, 814.1300, 824.6608, 891.1047,
        924.2322], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  7, 21,  5, 33,  4,  1,
        26,  6, 24,  2,  0, 30, 20, 23, 25, 28], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 91.51% 

Test Accuracy: 80.89% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8799252454191446
distance x is tensor(150.0182, device='cuda:0')
benign distance is  tensor(150.0182, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.780541554093361
distance x is tensor(151.3389, device='cuda:0')
benign distance is  tensor(151.3389, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0182514265179634
distance x is tensor(136.4668, device='cuda:0')
benign distance is  tensor(136.4668, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1552078258246183
distance x is tensor(190.5307, device='cuda:0')
benign distance is  tensor(190.5307, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.08487568795681
distance x is tensor(136.5187, device='cuda:0')
benign distance is  tensor(136.5187, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9180418588221073
distance x is tensor(131.0053, device='cuda:0')
benign distance is  tensor(131.0053, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3281166069209576
distance x is tensor(144.8311, device='cuda:0')
benign distance is  tensor(144.8311, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0039960257709026
distance x is tensor(134.6875, device='cuda:0')
benign distance is  tensor(134.6875, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4487250857055187
distance x is tensor(133.3536, device='cuda:0')
benign distance is  tensor(133.3536, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0348367299884558
distance x is tensor(181.4882, device='cuda:0')
benign distance is  tensor(181.4882, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4825524128973484
distance x is tensor(129.1989, device='cuda:0')
benign distance is  tensor(129.1989, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.694756619632244
distance x is tensor(155.6576, device='cuda:0')
benign distance is  tensor(155.6576, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.925303004682064
distance x is tensor(181.7038, device='cuda:0')
benign distance is  tensor(181.7038, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1230851151049137
distance x is tensor(94.6809, device='cuda:0')
benign distance is  tensor(94.6809, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.256305668503046
distance x is tensor(176.0597, device='cuda:0')
benign distance is  tensor(176.0597, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.0596484169363976
distance x is tensor(150.8749, device='cuda:0')
benign distance is  tensor(150.8749, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7669996097683907
distance x is tensor(148.0034, device='cuda:0')
benign distance is  tensor(148.0034, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9394888766109943
distance x is tensor(113.1145, device='cuda:0')
benign distance is  tensor(113.1145, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3636978343129158
distance x is tensor(162.9572, device='cuda:0')
benign distance is  tensor(162.9572, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.116255883127451
distance x is tensor(141.8488, device='cuda:0')
benign distance is  tensor(141.8488, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2932499572634697
distance x is tensor(159.4262, device='cuda:0')
benign distance is  tensor(159.4262, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.436056450009346
distance x is tensor(148.4942, device='cuda:0')
benign distance is  tensor(148.4942, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.712128235027194
distance x is tensor(147.7389, device='cuda:0')
benign distance is  tensor(147.7389, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0546136684715748
distance x is tensor(190.1417, device='cuda:0')
benign distance is  tensor(190.1417, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3190000001600001
mal_loss is 20.654781818389893
mal_entropy is 0.06641328823752701
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([669.0171, 663.7220, 584.6092, 827.9069, 595.8981, 564.9702, 627.4266,
        595.9406, 459.5139, 459.5138, 459.5139, 459.5138, 459.5139, 459.5138,
        459.5139, 459.5138, 459.5139, 459.5138, 459.5139, 459.5138],
       device='cuda:0')
sorted_norm is   tensor([459.5138, 459.5138, 459.5138, 459.5138, 459.5138, 459.5138, 459.5139,
        459.5139, 459.5139, 459.5139, 459.5139, 459.5139, 564.9702, 584.6092,
        595.8981, 595.9406, 627.4266, 663.7220, 669.0171, 827.9069],
       device='cuda:0')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10,  5,  2,  4,  7],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 86.80% 

Test Accuracy: 53.19% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1165748611092567
distance x is tensor(214.2538, device='cuda:0')
benign distance is  tensor(214.2538, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6851603537797928
distance x is tensor(237.3949, device='cuda:0')
benign distance is  tensor(237.3949, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5313335061073303
distance x is tensor(205.1814, device='cuda:0')
benign distance is  tensor(205.1814, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.066503331065178
distance x is tensor(253.1413, device='cuda:0')
benign distance is  tensor(253.1413, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1384500116109848
distance x is tensor(274.3141, device='cuda:0')
benign distance is  tensor(274.3141, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0906945765018463
distance x is tensor(204.6134, device='cuda:0')
benign distance is  tensor(204.6134, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.31036027520895
distance x is tensor(211.3773, device='cuda:0')
benign distance is  tensor(211.3773, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5125595927238464
distance x is tensor(234.1090, device='cuda:0')
benign distance is  tensor(234.1090, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.12000000016000001
mal_loss is 90.15896272659302
mal_entropy is 0.013055026151050697
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 862.4554,  913.9945,  782.5847,  979.2631, 1070.1604,  805.2997,
         850.3888,  894.7907,  461.3175,  461.3175,  461.3175,  461.3175,
         461.3175,  461.3175,  461.3175,  461.3175,  461.3175,  461.3175,
         461.3175,  461.3175,  877.7117,  937.8298,  909.1378,  758.4595,
         984.3522,  903.8061,  807.2341,  886.2142,  828.9666,  739.7811,
         788.3541,  828.0271,  756.0431, 1095.7032,  952.9929,  827.5497,
         693.3041,  882.2883,  679.0837,  776.5569,  880.4490,  539.0370,
         864.9451,  773.4318], device='cuda:0')
sorted_norm is   tensor([ 461.3175,  461.3175,  461.3175,  461.3175,  461.3175,  461.3175,
         461.3175,  461.3175,  461.3175,  461.3175,  461.3175,  461.3175,
         539.0370,  679.0837,  693.3041,  739.7811,  756.0431,  758.4595,
         773.4318,  776.5569,  782.5847,  788.3541,  805.2997,  807.2341,
         827.5497,  828.0271,  828.9666,  850.3888,  862.4554,  864.9451,
         877.7117,  880.4490,  882.2883,  886.2142,  894.7907,  903.8061,
         909.1378,  913.9945,  937.8298,  952.9929,  979.2631,  984.3522,
        1070.1604, 1095.7032], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 41, 38, 36, 29, 32, 23,
        43, 39,  2, 30,  5, 26, 35, 31, 28,  6,  0, 42, 20, 40, 37, 27,  7],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 91.45% 

Test Accuracy: 82.74% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8464902751147747
distance x is tensor(158.0123, device='cuda:0')
benign distance is  tensor(158.0123, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6099971793591976
distance x is tensor(125.1407, device='cuda:0')
benign distance is  tensor(125.1407, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.002879872918129
distance x is tensor(128.9642, device='cuda:0')
benign distance is  tensor(128.9642, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3195300064980984
distance x is tensor(176.2678, device='cuda:0')
benign distance is  tensor(176.2678, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9986386448144913
distance x is tensor(123.9768, device='cuda:0')
benign distance is  tensor(123.9768, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9869040753692389
distance x is tensor(135.2287, device='cuda:0')
benign distance is  tensor(135.2287, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1282784938812256
distance x is tensor(137.0624, device='cuda:0')
benign distance is  tensor(137.0624, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1918953508138657
distance x is tensor(117.8396, device='cuda:0')
benign distance is  tensor(117.8396, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6231626495718956
distance x is tensor(132.1864, device='cuda:0')
benign distance is  tensor(132.1864, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8735130317509174
distance x is tensor(163.5842, device='cuda:0')
benign distance is  tensor(163.5842, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5357622429728508
distance x is tensor(105.6518, device='cuda:0')
benign distance is  tensor(105.6518, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.2181515097618103
distance x is tensor(149.5376, device='cuda:0')
benign distance is  tensor(149.5376, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0821424759924412
distance x is tensor(181.8502, device='cuda:0')
benign distance is  tensor(181.8502, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2564123626798391
distance x is tensor(80.8915, device='cuda:0')
benign distance is  tensor(80.8915, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4901682808995247
distance x is tensor(167.2171, device='cuda:0')
benign distance is  tensor(167.2171, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.9987395480275154
distance x is tensor(151.8394, device='cuda:0')
benign distance is  tensor(151.8394, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8917236253619194
distance x is tensor(142.4698, device='cuda:0')
benign distance is  tensor(142.4698, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2743627205491066
distance x is tensor(139.5865, device='cuda:0')
benign distance is  tensor(139.5865, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.5552108436822891
distance x is tensor(143.0155, device='cuda:0')
benign distance is  tensor(143.0155, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5430358350276947
distance x is tensor(152.8179, device='cuda:0')
benign distance is  tensor(152.8179, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9715567007660866
distance x is tensor(109.7616, device='cuda:0')
benign distance is  tensor(109.7616, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8178903423249722
distance x is tensor(217.5110, device='cuda:0')
benign distance is  tensor(217.5110, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5181523710489273
distance x is tensor(185.5453, device='cuda:0')
benign distance is  tensor(185.5453, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9499376229941845
distance x is tensor(150.1026, device='cuda:0')
benign distance is  tensor(150.1026, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.262528710067272
distance x is tensor(147.0768, device='cuda:0')
benign distance is  tensor(147.0768, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.9054152742028236
distance x is tensor(151.4055, device='cuda:0')
benign distance is  tensor(151.4055, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.7792837247252464
distance x is tensor(162.9534, device='cuda:0')
benign distance is  tensor(162.9534, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.2678841799497604
distance x is tensor(119.1357, device='cuda:0')
benign distance is  tensor(119.1357, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6590964999049902
distance x is tensor(180.2826, device='cuda:0')
benign distance is  tensor(180.2826, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1127705052495003
distance x is tensor(161.1773, device='cuda:0')
benign distance is  tensor(161.1773, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.4093214236199856
distance x is tensor(137.5151, device='cuda:0')
benign distance is  tensor(137.5151, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7141120713204145
distance x is tensor(148.3239, device='cuda:0')
benign distance is  tensor(148.3239, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.4440000001600001
mal_loss is 7.856591641902924
mal_entropy is 0.20050465315580368
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([721.7891, 559.4156, 581.1542, 767.6268, 548.5612, 582.8102, 596.6182,
        524.0138, 450.9191, 450.9192, 450.9191, 450.9192, 450.9191, 450.9192,
        450.9191, 450.9192, 450.9191, 450.9192, 450.9191, 450.9192],
       device='cuda:0')
sorted_norm is   tensor([450.9191, 450.9191, 450.9191, 450.9191, 450.9191, 450.9191, 450.9192,
        450.9192, 450.9192, 450.9192, 450.9192, 450.9192, 524.0138, 548.5612,
        559.4156, 581.1542, 582.8102, 596.6182, 721.7891, 767.6268],
       device='cuda:0')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  7,  4,  1,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 89.44% 

Test Accuracy: 67.57% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.010287830606103
distance x is tensor(200.0792, device='cuda:0')
benign distance is  tensor(200.0792, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4861243888735771
distance x is tensor(178.7350, device='cuda:0')
benign distance is  tensor(178.7350, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5116747841238976
distance x is tensor(166.3637, device='cuda:0')
benign distance is  tensor(166.3637, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3582038283348083
distance x is tensor(221.9213, device='cuda:0')
benign distance is  tensor(221.9213, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8156826309859753
distance x is tensor(178.9835, device='cuda:0')
benign distance is  tensor(178.9835, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0989738088101149
distance x is tensor(170.0771, device='cuda:0')
benign distance is  tensor(170.0771, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4429138228297234
distance x is tensor(187.7160, device='cuda:0')
benign distance is  tensor(187.7160, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3970630280673504
distance x is tensor(167.2326, device='cuda:0')
benign distance is  tensor(167.2326, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2310000001600001
mal_loss is 43.01802062988281
mal_entropy is 0.05546972143929452
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([849.4466, 748.4907, 685.8337, 919.7396, 756.5033, 717.4214, 789.5363,
        718.7103, 455.7373, 455.7372, 455.7373, 455.7372, 455.7373, 455.7372,
        455.7373, 455.7372, 455.7373, 455.7372, 455.7373, 455.7372, 859.5460,
        885.8922, 879.8179, 874.4135, 786.7098, 786.4970, 779.8777, 848.0178,
        772.5248, 671.8448, 859.0004, 785.4504, 815.7708, 801.3032, 787.4884,
        964.6535, 685.9680, 805.7080, 594.9234, 771.6882, 877.6523, 501.4446,
        819.3775, 777.7617], device='cuda:0')
sorted_norm is   tensor([455.7372, 455.7372, 455.7372, 455.7372, 455.7372, 455.7372, 455.7373,
        455.7373, 455.7373, 455.7373, 455.7373, 455.7373, 501.4446, 594.9234,
        671.8448, 685.8337, 685.9680, 717.4214, 718.7103, 748.4907, 756.5033,
        771.6882, 772.5248, 777.7617, 779.8777, 785.4504, 786.4970, 786.7098,
        787.4884, 789.5363, 801.3032, 805.7080, 815.7708, 819.3775, 848.0178,
        849.4466, 859.0004, 859.5460, 874.4135, 877.6523, 879.8179, 885.8922,
        919.7396, 964.6535], device='cuda:0')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 41, 38, 29,  2, 36,  5,
         7,  1,  4, 39, 28, 43, 26, 31, 25, 24, 34,  6, 33, 37, 32, 42, 27],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 91.30% 

Test Accuracy: 82.33% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8369594253599644
distance x is tensor(166.7093, device='cuda:0')
benign distance is  tensor(166.7093, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9803907871246338
distance x is tensor(140.2682, device='cuda:0')
benign distance is  tensor(140.2682, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0038019604980946
distance x is tensor(135.7879, device='cuda:0')
benign distance is  tensor(135.7879, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6362055018544197
distance x is tensor(183.1534, device='cuda:0')
benign distance is  tensor(183.1534, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0527476239949465
distance x is tensor(133.9568, device='cuda:0')
benign distance is  tensor(133.9568, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.994292002171278
distance x is tensor(142.6960, device='cuda:0')
benign distance is  tensor(142.6960, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8197586759924889
distance x is tensor(133.0032, device='cuda:0')
benign distance is  tensor(133.0032, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2589822746813297
distance x is tensor(116.5386, device='cuda:0')
benign distance is  tensor(116.5386, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4275262132287025
distance x is tensor(129.7961, device='cuda:0')
benign distance is  tensor(129.7961, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9571605082601309
distance x is tensor(158.5608, device='cuda:0')
benign distance is  tensor(158.5608, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6165439039468765
distance x is tensor(126.8129, device='cuda:0')
benign distance is  tensor(126.8129, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.072665758430958
distance x is tensor(139.9109, device='cuda:0')
benign distance is  tensor(139.9109, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6297698430716991
distance x is tensor(211.4130, device='cuda:0')
benign distance is  tensor(211.4130, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0373588278889656
distance x is tensor(100.5530, device='cuda:0')
benign distance is  tensor(100.5530, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2164795082062483
distance x is tensor(170.4485, device='cuda:0')
benign distance is  tensor(170.4485, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.4465986490249634
distance x is tensor(148.0363, device='cuda:0')
benign distance is  tensor(148.0363, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.8439881578087807
distance x is tensor(146.6565, device='cuda:0')
benign distance is  tensor(146.6565, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0374312996864319
distance x is tensor(109.9576, device='cuda:0')
benign distance is  tensor(109.9576, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.5819603875279427
distance x is tensor(152.2385, device='cuda:0')
benign distance is  tensor(152.2385, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.8592571020126343
distance x is tensor(138.7620, device='cuda:0')
benign distance is  tensor(138.7620, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.219422698020935
distance x is tensor(141.2052, device='cuda:0')
benign distance is  tensor(141.2052, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0578949376940727
distance x is tensor(146.2941, device='cuda:0')
benign distance is  tensor(146.2941, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9402042385190725
distance x is tensor(144.6965, device='cuda:0')
benign distance is  tensor(144.6965, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.168639626353979
distance x is tensor(182.8735, device='cuda:0')
benign distance is  tensor(182.8735, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1088194586336613
distance x is tensor(152.0005, device='cuda:0')
benign distance is  tensor(152.0005, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.6897480003535748
distance x is tensor(131.7795, device='cuda:0')
benign distance is  tensor(131.7795, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.0043400637805462
distance x is tensor(174.0029, device='cuda:0')
benign distance is  tensor(174.0029, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.774648904800415
distance x is tensor(151.5083, device='cuda:0')
benign distance is  tensor(151.5083, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8774046618491411
distance x is tensor(148.4794, device='cuda:0')
benign distance is  tensor(148.4794, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.2910605669021606
distance x is tensor(124.0248, device='cuda:0')
benign distance is  tensor(124.0248, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.4049540497362614
distance x is tensor(129.7983, device='cuda:0')
benign distance is  tensor(129.7983, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9364674091339111
distance x is tensor(156.0030, device='cuda:0')
benign distance is  tensor(156.0030, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3240000001600001
mal_loss is 15.116597175598145
mal_entropy is 0.10200986638665199
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([741.9966, 616.7408, 597.1818, 789.5536, 590.4717, 594.2122, 591.6987,
        516.6465, 455.5854, 455.5854, 455.5854, 455.5854, 455.5854, 455.5854,
        455.5854, 455.5854, 455.5854, 455.5854, 455.5854, 455.5854, 688.0961,
        662.0760, 649.7956, 717.6376, 537.6502, 970.3275, 834.8981, 697.4871],
       device='cuda:0')
sorted_norm is   tensor([455.5854, 455.5854, 455.5854, 455.5854, 455.5854, 455.5854, 455.5854,
        455.5854, 455.5854, 455.5854, 455.5854, 455.5854, 516.6465, 537.6502,
        590.4717, 591.6987, 594.2122, 597.1818, 616.7408, 649.7956, 662.0760,
        688.0961, 697.4871, 717.6376, 741.9966, 789.5536, 834.8981, 970.3275],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7, 24,  4,  6,  5,  2,
         1, 22, 21, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.75% 

Test Accuracy: 77.71% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8403636664152145
distance x is tensor(178.8112, device='cuda:0')
benign distance is  tensor(178.8112, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3998516015708447
distance x is tensor(147.8209, device='cuda:0')
benign distance is  tensor(147.8209, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2208586484193802
distance x is tensor(153.2190, device='cuda:0')
benign distance is  tensor(153.2190, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.535526618361473
distance x is tensor(186.9457, device='cuda:0')
benign distance is  tensor(186.9457, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4691776596009731
distance x is tensor(174.9904, device='cuda:0')
benign distance is  tensor(174.9904, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2241986617445946
distance x is tensor(160.4987, device='cuda:0')
benign distance is  tensor(160.4987, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.6113017350435257
distance x is tensor(162.9908, device='cuda:0')
benign distance is  tensor(162.9908, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2985228337347507
distance x is tensor(130.3871, device='cuda:0')
benign distance is  tensor(130.3871, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.384749375283718
distance x is tensor(143.8033, device='cuda:0')
benign distance is  tensor(143.8033, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2656510546803474
distance x is tensor(147.8579, device='cuda:0')
benign distance is  tensor(147.8579, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.595136296004057
distance x is tensor(143.5888, device='cuda:0')
benign distance is  tensor(143.5888, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.8501864820718765
distance x is tensor(214.1490, device='cuda:0')
benign distance is  tensor(214.1490, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7114548720419407
distance x is tensor(135.5313, device='cuda:0')
benign distance is  tensor(135.5313, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9730230551213026
distance x is tensor(230.1213, device='cuda:0')
benign distance is  tensor(230.1213, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5240478962659836
distance x is tensor(202.5630, device='cuda:0')
benign distance is  tensor(202.5630, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.984062634408474
distance x is tensor(164.7013, device='cuda:0')
benign distance is  tensor(164.7013, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.21500000016000007
mal_loss is 35.730647563934326
mal_entropy is 0.05798847263213247
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([768.7323, 626.0047, 641.6885, 802.4770, 723.4032, 657.9438, 690.1005,
        563.2211, 458.6358, 458.6358, 458.6358, 458.6358, 458.6358, 458.6358,
        458.6358, 458.6358, 458.6358, 458.6358, 458.6358, 458.6358, 630.1395,
        726.3698, 607.4442, 663.3691, 959.7349, 502.5115, 793.8165, 710.0820],
       device='cuda:0')
sorted_norm is   tensor([458.6358, 458.6358, 458.6358, 458.6358, 458.6358, 458.6358, 458.6358,
        458.6358, 458.6358, 458.6358, 458.6358, 458.6358, 502.5115, 563.2211,
        607.4442, 626.0047, 630.1395, 641.6885, 657.9438, 663.3691, 690.1005,
        710.0820, 723.4032, 726.3698, 768.7323, 793.8165, 802.4770, 959.7349],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25,  7, 22,  1, 20,  2,
         5, 23,  6, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.02% 

Test Accuracy: 74.99% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9652015753090382
distance x is tensor(178.6267, device='cuda:0')
benign distance is  tensor(178.6267, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5402979254722595
distance x is tensor(170.1778, device='cuda:0')
benign distance is  tensor(170.1778, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4637908898293972
distance x is tensor(149.6482, device='cuda:0')
benign distance is  tensor(149.6482, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.455169066786766
distance x is tensor(203.9375, device='cuda:0')
benign distance is  tensor(203.9375, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2260964661836624
distance x is tensor(160.6037, device='cuda:0')
benign distance is  tensor(160.6037, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3966784477233887
distance x is tensor(146.7402, device='cuda:0')
benign distance is  tensor(146.7402, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9970010817050934
distance x is tensor(147.8324, device='cuda:0')
benign distance is  tensor(147.8324, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4273028634488583
distance x is tensor(147.4295, device='cuda:0')
benign distance is  tensor(147.4295, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.768896158784628
distance x is tensor(156.2111, device='cuda:0')
benign distance is  tensor(156.2111, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.972352834418416
distance x is tensor(181.1366, device='cuda:0')
benign distance is  tensor(181.1366, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2305397391319275
distance x is tensor(118.3680, device='cuda:0')
benign distance is  tensor(118.3680, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.1563044488430023
distance x is tensor(171.9733, device='cuda:0')
benign distance is  tensor(171.9733, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6545091420412064
distance x is tensor(213.9045, device='cuda:0')
benign distance is  tensor(213.9045, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.025012418627739
distance x is tensor(126.0875, device='cuda:0')
benign distance is  tensor(126.0875, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6437577083706856
distance x is tensor(181.6220, device='cuda:0')
benign distance is  tensor(181.6220, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.1922430098056793
distance x is tensor(169.7730, device='cuda:0')
benign distance is  tensor(169.7730, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.16300000016000007
mal_loss is 46.94682478904724
mal_entropy is 0.04737702733837068
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([751.7485, 689.6541, 630.2087, 847.0515, 651.9423, 624.9329, 624.1025,
        617.6354, 459.9355, 459.9355, 459.9355, 459.9355, 459.9355, 459.9355,
        459.9355, 459.9355, 459.9355, 459.9355, 459.9355, 459.9355],
       device='cuda:0')
sorted_norm is   tensor([459.9355, 459.9355, 459.9355, 459.9355, 459.9355, 459.9355, 459.9355,
        459.9355, 459.9355, 459.9355, 459.9355, 459.9355, 617.6354, 624.1025,
        624.9329, 630.2087, 651.9423, 689.6541, 751.7485, 847.0515],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  6,  5,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 78.82% 

Test Accuracy: 44.68% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1733861900866032
distance x is tensor(283.0087, device='cuda:0')
benign distance is  tensor(283.0087, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.043376810848713
distance x is tensor(339.0359, device='cuda:0')
benign distance is  tensor(339.0359, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9395232945680618
distance x is tensor(234.5177, device='cuda:0')
benign distance is  tensor(234.5177, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2914588674902916
distance x is tensor(341.7849, device='cuda:0')
benign distance is  tensor(341.7849, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8573544099926949
distance x is tensor(296.2693, device='cuda:0')
benign distance is  tensor(296.2693, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.321456104516983
distance x is tensor(246.6983, device='cuda:0')
benign distance is  tensor(246.6983, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.136713720858097
distance x is tensor(250.9498, device='cuda:0')
benign distance is  tensor(250.9498, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4033161997795105
distance x is tensor(259.7983, device='cuda:0')
benign distance is  tensor(259.7983, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.08500000015999996
mal_loss is 133.63696956634521
mal_entropy is 0.010330677137062594
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1076.7003, 1291.9843,  862.0089, 1276.1885, 1134.7412,  925.0870,
         962.5081,  976.7890,  460.4139,  460.4139,  460.4139,  460.4139,
         460.4139,  460.4139,  460.4139,  460.4139,  460.4139,  460.4139,
         460.4139,  460.4139,  924.5280,  948.5854,  974.1298,  830.9398,
        1049.9403,  966.1301,  889.0891,  933.6556,  847.2126,  747.2318,
         889.9731,  845.8737,  845.2071,  851.9341,  836.7449,  974.6105,
         787.8211,  800.5598,  782.7247, 1030.7690,  743.0447, 1087.7869,
         985.1445,  850.9678,  743.1130,  846.6390,  623.6519,  799.4468,
         984.0435,  637.8312,  870.1765,  819.9901], device='cuda:0')
sorted_norm is   tensor([ 460.4139,  460.4139,  460.4139,  460.4139,  460.4139,  460.4139,
         460.4139,  460.4139,  460.4139,  460.4139,  460.4139,  460.4139,
         623.6519,  637.8312,  743.0447,  743.1130,  747.2318,  782.7247,
         787.8211,  799.4468,  800.5598,  819.9901,  830.9398,  836.7449,
         845.2071,  845.8737,  846.6390,  847.2126,  850.9678,  851.9341,
         862.0089,  870.1765,  889.0891,  889.9731,  924.5280,  925.0870,
         933.6556,  948.5854,  962.5081,  966.1301,  974.1298,  974.6105,
         976.7890,  984.0435,  985.1445, 1030.7690, 1049.9403, 1076.7003,
        1087.7869, 1134.7412, 1276.1885, 1291.9843], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 46, 49, 40, 44, 29, 38,
        36, 47, 37, 51, 23, 34, 32, 31, 45, 28, 43, 33,  2, 50, 26, 30, 20,  5,
        27, 21,  6, 25, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.36% 

Test Accuracy: 82.92% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9174297451972961
distance x is tensor(156.5629, device='cuda:0')
benign distance is  tensor(156.5629, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3011160418391228
distance x is tensor(125.4107, device='cuda:0')
benign distance is  tensor(125.4107, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1654233485460281
distance x is tensor(118.3132, device='cuda:0')
benign distance is  tensor(118.3132, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1924055628478527
distance x is tensor(170.1958, device='cuda:0')
benign distance is  tensor(170.1958, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4772520251572132
distance x is tensor(125.7384, device='cuda:0')
benign distance is  tensor(125.7384, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0961382873356342
distance x is tensor(131.2901, device='cuda:0')
benign distance is  tensor(131.2901, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4746616184711456
distance x is tensor(130.3884, device='cuda:0')
benign distance is  tensor(130.3884, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1407728493213654
distance x is tensor(130.1974, device='cuda:0')
benign distance is  tensor(130.1974, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3276851326227188
distance x is tensor(129.0013, device='cuda:0')
benign distance is  tensor(129.0013, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0864656865596771
distance x is tensor(157.6658, device='cuda:0')
benign distance is  tensor(157.6658, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3000688031315804
distance x is tensor(105.8115, device='cuda:0')
benign distance is  tensor(105.8115, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.0880148112773895
distance x is tensor(142.8326, device='cuda:0')
benign distance is  tensor(142.8326, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.1227386221289635
distance x is tensor(181.1390, device='cuda:0')
benign distance is  tensor(181.1390, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2923125810921192
distance x is tensor(90.6689, device='cuda:0')
benign distance is  tensor(90.6689, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1640824377536774
distance x is tensor(158.2681, device='cuda:0')
benign distance is  tensor(158.2681, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.0630851686000824
distance x is tensor(143.3624, device='cuda:0')
benign distance is  tensor(143.3624, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.050074689090252
distance x is tensor(132.3156, device='cuda:0')
benign distance is  tensor(132.3156, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.191769763827324
distance x is tensor(129.5409, device='cuda:0')
benign distance is  tensor(129.5409, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7927570417523384
distance x is tensor(138.3017, device='cuda:0')
benign distance is  tensor(138.3017, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4546651802957058
distance x is tensor(152.8296, device='cuda:0')
benign distance is  tensor(152.8296, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.5656897313892841
distance x is tensor(115.2174, device='cuda:0')
benign distance is  tensor(115.2174, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9115956127643585
distance x is tensor(221.6526, device='cuda:0')
benign distance is  tensor(221.6526, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4709024131298065
distance x is tensor(175.0190, device='cuda:0')
benign distance is  tensor(175.0190, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.087326081469655
distance x is tensor(142.4981, device='cuda:0')
benign distance is  tensor(142.4981, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6210462898015976
distance x is tensor(144.6857, device='cuda:0')
benign distance is  tensor(144.6857, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9666059762239456
distance x is tensor(106.1059, device='cuda:0')
benign distance is  tensor(106.1059, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.4718736857175827
distance x is tensor(148.2531, device='cuda:0')
benign distance is  tensor(148.2531, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.4879591539502144
distance x is tensor(157.7386, device='cuda:0')
benign distance is  tensor(157.7386, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5392955280840397
distance x is tensor(138.3902, device='cuda:0')
benign distance is  tensor(138.3902, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.129051148891449
distance x is tensor(136.3581, device='cuda:0')
benign distance is  tensor(136.3581, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7853192165493965
distance x is tensor(135.6324, device='cuda:0')
benign distance is  tensor(135.6324, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.902200236916542
distance x is tensor(181.3359, device='cuda:0')
benign distance is  tensor(181.3359, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.582788474857807
distance x is tensor(124.9466, device='cuda:0')
benign distance is  tensor(124.9466, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.225629046559334
distance x is tensor(150.0372, device='cuda:0')
benign distance is  tensor(150.0372, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.8524422235786915
distance x is tensor(174.0980, device='cuda:0')
benign distance is  tensor(174.0980, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.7382247671484947
distance x is tensor(116.3208, device='cuda:0')
benign distance is  tensor(116.3208, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.838004045188427
distance x is tensor(179.3958, device='cuda:0')
benign distance is  tensor(179.3958, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.2538964040577412
distance x is tensor(152.8523, device='cuda:0')
benign distance is  tensor(152.8523, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.3855242729187012
distance x is tensor(127.5576, device='cuda:0')
benign distance is  tensor(127.5576, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7418687902390957
distance x is tensor(160.7698, device='cuda:0')
benign distance is  tensor(160.7698, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.51600000016
mal_loss is 5.632782071828842
mal_entropy is 0.23506521061062813
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([687.7108, 551.6392, 514.0461, 746.9266, 552.1724, 563.7642, 580.4255,
        536.7248, 441.7058, 441.7058, 441.7058, 441.7058, 441.7058, 441.7058,
        441.7058, 441.7058, 441.7058, 441.7058, 441.7058, 441.7058, 735.4811,
        648.3520, 814.2459, 718.5746, 686.1489, 624.2436, 638.6327, 735.8773],
       device='cuda:0')
sorted_norm is   tensor([441.7058, 441.7058, 441.7058, 441.7058, 441.7058, 441.7058, 441.7058,
        441.7058, 441.7058, 441.7058, 441.7058, 441.7058, 514.0461, 536.7248,
        551.6392, 552.1724, 563.7642, 580.4255, 624.2436, 638.6327, 648.3520,
        686.1489, 687.7108, 718.5746, 735.4811, 735.8773, 746.9266, 814.2459],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  7,  1,  4,  5,  6,
        25, 26, 21, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.89% 

Test Accuracy: 80.73% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0830057673156261
distance x is tensor(167.5893, device='cuda:0')
benign distance is  tensor(167.5893, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3260492868721485
distance x is tensor(147.2333, device='cuda:0')
benign distance is  tensor(147.2333, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2500209286808968
distance x is tensor(147.7331, device='cuda:0')
benign distance is  tensor(147.7331, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7731713354587555
distance x is tensor(185.2286, device='cuda:0')
benign distance is  tensor(185.2286, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.562697060406208
distance x is tensor(141.3543, device='cuda:0')
benign distance is  tensor(141.3543, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1362212505191565
distance x is tensor(125.3396, device='cuda:0')
benign distance is  tensor(125.3396, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9936012923717499
distance x is tensor(131.7628, device='cuda:0')
benign distance is  tensor(131.7628, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.106494415551424
distance x is tensor(129.5989, device='cuda:0')
benign distance is  tensor(129.5989, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9751669801771641
distance x is tensor(162.6349, device='cuda:0')
benign distance is  tensor(162.6349, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0551987886428833
distance x is tensor(140.8913, device='cuda:0')
benign distance is  tensor(140.8913, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.0862730965018272
distance x is tensor(168.7854, device='cuda:0')
benign distance is  tensor(168.7854, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.9436119198799133
distance x is tensor(166.4739, device='cuda:0')
benign distance is  tensor(166.4739, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9959521070122719
distance x is tensor(149.7051, device='cuda:0')
benign distance is  tensor(149.7051, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.6305225491523743
distance x is tensor(121.7597, device='cuda:0')
benign distance is  tensor(121.7597, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.4451132863759995
distance x is tensor(122.4094, device='cuda:0')
benign distance is  tensor(122.4094, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0132483653724194
distance x is tensor(155.0071, device='cuda:0')
benign distance is  tensor(155.0071, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.37300000016000007
mal_loss is 12.225054383277893
mal_entropy is 0.16427061706781387
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([741.4888, 648.7437, 625.0302, 799.8433, 616.5546, 533.4836, 580.7388,
        581.3782, 443.8068, 443.8068, 443.8068, 443.8068, 443.8068, 443.8068,
        443.8068, 443.8068, 443.8068, 443.8068, 443.8068, 443.8068, 610.4526,
        729.1217, 525.2937, 692.1595, 819.3876, 470.4442, 730.6667, 682.7613],
       device='cuda:0')
sorted_norm is   tensor([443.8068, 443.8068, 443.8068, 443.8068, 443.8068, 443.8068, 443.8068,
        443.8068, 443.8068, 443.8068, 443.8068, 443.8068, 470.4442, 525.2937,
        533.4836, 580.7388, 581.3782, 610.4526, 616.5546, 625.0302, 648.7437,
        682.7613, 692.1595, 729.1217, 730.6667, 741.4888, 799.8433, 819.3876],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25, 22,  5,  6,  7, 20,
         4,  2,  1, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 87.77% 

Test Accuracy: 78.05% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0207090638577938
distance x is tensor(168.4129, device='cuda:0')
benign distance is  tensor(168.4129, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6271035261452198
distance x is tensor(154.9593, device='cuda:0')
benign distance is  tensor(154.9593, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5982249155640602
distance x is tensor(153.9755, device='cuda:0')
benign distance is  tensor(153.9755, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3402877748012543
distance x is tensor(186.3672, device='cuda:0')
benign distance is  tensor(186.3672, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6298482865095139
distance x is tensor(150.3401, device='cuda:0')
benign distance is  tensor(150.3401, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3040318749845028
distance x is tensor(148.5984, device='cuda:0')
benign distance is  tensor(148.5984, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9543356969952583
distance x is tensor(155.8241, device='cuda:0')
benign distance is  tensor(155.8241, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5007408671081066
distance x is tensor(141.5966, device='cuda:0')
benign distance is  tensor(141.5966, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7201729975640774
distance x is tensor(149.2974, device='cuda:0')
benign distance is  tensor(149.2974, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9636206105351448
distance x is tensor(187.6815, device='cuda:0')
benign distance is  tensor(187.6815, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1510752961039543
distance x is tensor(153.1650, device='cuda:0')
benign distance is  tensor(153.1650, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.6242466121912003
distance x is tensor(170.0282, device='cuda:0')
benign distance is  tensor(170.0282, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7060533463954926
distance x is tensor(191.5955, device='cuda:0')
benign distance is  tensor(191.5955, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1178414076566696
distance x is tensor(118.3750, device='cuda:0')
benign distance is  tensor(118.3750, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3173335585743189
distance x is tensor(192.3100, device='cuda:0')
benign distance is  tensor(192.3100, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.137142702937126
distance x is tensor(179.1478, device='cuda:0')
benign distance is  tensor(179.1478, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.28700000016000005
mal_loss is 24.17181122303009
mal_entropy is 0.10970700811594725
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 746.4366,  676.1918,  639.1840,  795.2156,  633.6215,  645.4679,
         663.2762,  609.0320,  452.9483,  452.9482,  452.9483,  452.9482,
         452.9483,  452.9482,  452.9483,  452.9482,  452.9483,  452.9482,
         452.9483,  452.9482,  695.0927,  675.8887,  679.4374,  757.2628,
         608.9082, 1019.4725,  836.2742,  728.1551], device='cuda:0')
sorted_norm is   tensor([ 452.9482,  452.9482,  452.9482,  452.9482,  452.9482,  452.9482,
         452.9483,  452.9483,  452.9483,  452.9483,  452.9483,  452.9483,
         608.9082,  609.0320,  633.6215,  639.1840,  645.4679,  663.2762,
         675.8887,  676.1918,  679.4374,  695.0927,  728.1551,  746.4366,
         757.2628,  795.2156,  836.2742, 1019.4725], device='cuda:0')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10, 24,  7,  4,  2,  5,  6,
        21,  1, 22, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 86.20% 

Test Accuracy: 75.32% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1559004839509726
distance x is tensor(184.2369, device='cuda:0')
benign distance is  tensor(184.2369, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5683357119560242
distance x is tensor(154.2341, device='cuda:0')
benign distance is  tensor(154.2341, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.206474795937538
distance x is tensor(196.2725, device='cuda:0')
benign distance is  tensor(196.2725, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9185494631528854
distance x is tensor(202.7943, device='cuda:0')
benign distance is  tensor(202.7943, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.663030032068491
distance x is tensor(143.2488, device='cuda:0')
benign distance is  tensor(143.2488, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1748440563678741
distance x is tensor(158.8926, device='cuda:0')
benign distance is  tensor(158.8926, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1628823652863503
distance x is tensor(155.9145, device='cuda:0')
benign distance is  tensor(155.9145, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.243819236755371
distance x is tensor(143.8849, device='cuda:0')
benign distance is  tensor(143.8849, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8851779699325562
distance x is tensor(133.8503, device='cuda:0')
benign distance is  tensor(133.8503, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.5651402436196804
distance x is tensor(160.0058, device='cuda:0')
benign distance is  tensor(160.0058, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.833454169332981
distance x is tensor(170.3354, device='cuda:0')
benign distance is  tensor(170.3354, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.6172030717134476
distance x is tensor(183.0844, device='cuda:0')
benign distance is  tensor(183.0844, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7155342102050781
distance x is tensor(142.1344, device='cuda:0')
benign distance is  tensor(142.1344, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0707545280456543
distance x is tensor(232.9327, device='cuda:0')
benign distance is  tensor(232.9327, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.534380342811346
distance x is tensor(205.6129, device='cuda:0')
benign distance is  tensor(205.6129, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2639550641179085
distance x is tensor(174.4247, device='cuda:0')
benign distance is  tensor(174.4247, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2120000001600001
mal_loss is 37.01160454750061
mal_entropy is 0.07149759540334344
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([775.3223, 659.3566, 784.9785, 828.1709, 595.0961, 668.7831, 646.1497,
        607.3774, 453.9675, 453.9676, 453.9675, 453.9676, 453.9675, 453.9676,
        453.9675, 453.9676, 453.9675, 453.9676, 453.9675, 453.9676, 743.0549,
        617.7083, 780.8947, 827.8784, 740.2552, 730.0682, 718.6583, 899.4117,
        689.4519, 823.7343, 710.6973, 778.8714, 840.6105, 549.8907, 843.4697,
        802.8322], device='cuda:0')
sorted_norm is   tensor([453.9675, 453.9675, 453.9675, 453.9675, 453.9675, 453.9675, 453.9676,
        453.9676, 453.9676, 453.9676, 453.9676, 453.9676, 549.8907, 595.0961,
        607.3774, 617.7083, 646.1497, 659.3566, 668.7831, 689.4519, 710.6973,
        718.6583, 730.0682, 740.2552, 743.0549, 775.3223, 778.8714, 780.8947,
        784.9785, 802.8322, 823.7343, 827.8784, 828.1709, 840.6105, 843.4697,
        899.4117], device='cuda:0')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19, 15, 13,  9, 11, 33,  4,  7, 21,  6,  1,
         5, 28, 30, 26, 25, 24, 20,  0, 31, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 86.98% 

Test Accuracy: 80.00% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2269178479909897
distance x is tensor(166.9548, device='cuda:0')
benign distance is  tensor(166.9548, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1223569884896278
distance x is tensor(140.8047, device='cuda:0')
benign distance is  tensor(140.8047, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2814574390649796
distance x is tensor(141.8308, device='cuda:0')
benign distance is  tensor(141.8308, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5366733185946941
distance x is tensor(183.5469, device='cuda:0')
benign distance is  tensor(183.5469, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.447268784046173
distance x is tensor(143.0947, device='cuda:0')
benign distance is  tensor(143.0947, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1472044829279184
distance x is tensor(143.4163, device='cuda:0')
benign distance is  tensor(143.4163, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.763911910355091
distance x is tensor(136.3543, device='cuda:0')
benign distance is  tensor(136.3543, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0736342538148165
distance x is tensor(129.2276, device='cuda:0')
benign distance is  tensor(129.2276, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7053696662187576
distance x is tensor(135.9273, device='cuda:0')
benign distance is  tensor(135.9273, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0054857693612576
distance x is tensor(176.0216, device='cuda:0')
benign distance is  tensor(176.0216, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7158303707838058
distance x is tensor(106.6521, device='cuda:0')
benign distance is  tensor(106.6521, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.6789697259664536
distance x is tensor(144.3502, device='cuda:0')
benign distance is  tensor(144.3502, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.694978304207325
distance x is tensor(205.8557, device='cuda:0')
benign distance is  tensor(205.8557, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.345213696360588
distance x is tensor(108.3373, device='cuda:0')
benign distance is  tensor(108.3373, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2862722165882587
distance x is tensor(165.5623, device='cuda:0')
benign distance is  tensor(165.5623, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.687208727002144
distance x is tensor(161.2975, device='cuda:0')
benign distance is  tensor(161.2975, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9062213450670242
distance x is tensor(152.5341, device='cuda:0')
benign distance is  tensor(152.5341, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2917226664721966
distance x is tensor(125.9435, device='cuda:0')
benign distance is  tensor(125.9435, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.6680722795426846
distance x is tensor(157.6915, device='cuda:0')
benign distance is  tensor(157.6915, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.324314847588539
distance x is tensor(140.0098, device='cuda:0')
benign distance is  tensor(140.0098, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.4314305186271667
distance x is tensor(150.3445, device='cuda:0')
benign distance is  tensor(150.3445, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.4242315702140331
distance x is tensor(152.7882, device='cuda:0')
benign distance is  tensor(152.7882, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8761012386530638
distance x is tensor(167.6288, device='cuda:0')
benign distance is  tensor(167.6288, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.8384407311677933
distance x is tensor(198.2818, device='cuda:0')
benign distance is  tensor(198.2818, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2590000001600001
mal_loss is 25.20001244544983
mal_entropy is 0.07199779618531466
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([702.5176, 611.7531, 600.3566, 778.1973, 605.0753, 603.2653, 585.3177,
        545.3589, 457.6125, 457.6125, 457.6125, 457.6125, 457.6125, 457.6125,
        457.6125, 457.6125, 457.6125, 457.6125, 457.6125, 457.6125],
       device='cuda:0')
sorted_norm is   tensor([457.6125, 457.6125, 457.6125, 457.6125, 457.6125, 457.6125, 457.6125,
        457.6125, 457.6125, 457.6125, 457.6125, 457.6125, 545.3589, 585.3177,
        600.3566, 603.2653, 605.0753, 611.7531, 702.5176, 778.1973],
       device='cuda:0')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  7,  6,  2,  5],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 77.01% 

Test Accuracy: 51.42% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3616014942526817
distance x is tensor(296.6242, device='cuda:0')
benign distance is  tensor(296.6242, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2459836602211
distance x is tensor(250.0674, device='cuda:0')
benign distance is  tensor(250.0674, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8289631083607674
distance x is tensor(230.2552, device='cuda:0')
benign distance is  tensor(230.2552, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.054490752518177
distance x is tensor(233.8696, device='cuda:0')
benign distance is  tensor(233.8696, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6603676527738571
distance x is tensor(254.4717, device='cuda:0')
benign distance is  tensor(254.4717, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.220096755772829
distance x is tensor(277.1947, device='cuda:0')
benign distance is  tensor(277.1947, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.484151691198349
distance x is tensor(221.4178, device='cuda:0')
benign distance is  tensor(221.4178, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.502171352505684
distance x is tensor(269.8998, device='cuda:0')
benign distance is  tensor(269.8998, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.09400000015999997
mal_loss is 108.5816650390625
mal_entropy is 0.0038278859564547796
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1148.9240,  933.1281,  861.4359,  906.7846,  968.8279, 1035.9346,
         840.0115, 1033.9883,  460.6388,  460.6388,  460.6388,  460.6388,
         460.6388,  460.6388,  460.6388,  460.6388,  460.6388,  460.6388,
         460.6388,  460.6388,  818.9843,  896.4656,  953.4882,  778.0109,
        1012.4438,  901.8632,  822.7639,  934.3618,  890.0131,  821.9686,
         911.3405,  908.0796,  851.4135,  761.1070,  763.6367,  871.1290,
         705.1037,  794.9111,  818.1850,  865.9022,  732.0224, 1064.3842,
         955.4655,  850.9702,  695.1602,  842.9619,  601.2427,  741.8770,
         961.9333,  587.5409,  805.7903,  787.5542], device='cuda:0')
sorted_norm is   tensor([ 460.6388,  460.6388,  460.6388,  460.6388,  460.6388,  460.6388,
         460.6388,  460.6388,  460.6388,  460.6388,  460.6388,  460.6388,
         587.5409,  601.2427,  695.1602,  705.1037,  732.0224,  741.8770,
         761.1070,  763.6367,  778.0109,  787.5542,  794.9111,  805.7903,
         818.1850,  818.9843,  821.9686,  822.7639,  840.0115,  842.9619,
         850.9702,  851.4135,  861.4359,  865.9022,  871.1290,  890.0131,
         896.4656,  901.8632,  906.7846,  908.0796,  911.3405,  933.1281,
         934.3618,  953.4882,  955.4655,  961.9333,  968.8279, 1012.4438,
        1033.9883, 1035.9346, 1064.3842, 1148.9240], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 49, 46, 44, 36, 40, 47,
        33, 34, 23, 51, 37, 50, 38, 20, 29, 26,  6, 45, 43, 32,  2, 39, 35, 28,
        21, 25,  3, 31, 30], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 87.72% 

Test Accuracy: 83.59% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9312631133943796
distance x is tensor(159.0995, device='cuda:0')
benign distance is  tensor(159.0995, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8540637344121933
distance x is tensor(134.1775, device='cuda:0')
benign distance is  tensor(134.1775, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.380920059978962
distance x is tensor(125.3971, device='cuda:0')
benign distance is  tensor(125.3971, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4490860812366009
distance x is tensor(170.4560, device='cuda:0')
benign distance is  tensor(170.4560, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.881542645394802
distance x is tensor(123.5685, device='cuda:0')
benign distance is  tensor(123.5685, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1166767189279199
distance x is tensor(120.8522, device='cuda:0')
benign distance is  tensor(120.8522, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6628873720765114
distance x is tensor(110.9801, device='cuda:0')
benign distance is  tensor(110.9801, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1147400736808777
distance x is tensor(108.2267, device='cuda:0')
benign distance is  tensor(108.2267, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4341317228972912
distance x is tensor(134.6155, device='cuda:0')
benign distance is  tensor(134.6155, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1857880055904388
distance x is tensor(162.9290, device='cuda:0')
benign distance is  tensor(162.9290, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.087152771651745
distance x is tensor(97.2138, device='cuda:0')
benign distance is  tensor(97.2138, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.2314750850200653
distance x is tensor(138.1341, device='cuda:0')
benign distance is  tensor(138.1341, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2103698551654816
distance x is tensor(192.4249, device='cuda:0')
benign distance is  tensor(192.4249, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0736508592963219
distance x is tensor(83.9118, device='cuda:0')
benign distance is  tensor(83.9118, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3680849149823189
distance x is tensor(164.5303, device='cuda:0')
benign distance is  tensor(164.5303, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.7207185998559
distance x is tensor(149.1567, device='cuda:0')
benign distance is  tensor(149.1567, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8325349800288677
distance x is tensor(117.3279, device='cuda:0')
benign distance is  tensor(117.3279, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0898141227662563
distance x is tensor(135.7188, device='cuda:0')
benign distance is  tensor(135.7188, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7174280099570751
distance x is tensor(131.3260, device='cuda:0')
benign distance is  tensor(131.3260, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4736814349889755
distance x is tensor(148.4651, device='cuda:0')
benign distance is  tensor(148.4651, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7889085337519646
distance x is tensor(108.6372, device='cuda:0')
benign distance is  tensor(108.6372, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0960866548120975
distance x is tensor(209.5646, device='cuda:0')
benign distance is  tensor(209.5646, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.134175382554531
distance x is tensor(175.9878, device='cuda:0')
benign distance is  tensor(175.9878, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3978489600121975
distance x is tensor(133.1406, device='cuda:0')
benign distance is  tensor(133.1406, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1954648420214653
distance x is tensor(149.4578, device='cuda:0')
benign distance is  tensor(149.4578, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.5790112279355526
distance x is tensor(120.9275, device='cuda:0')
benign distance is  tensor(120.9275, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8915570098906755
distance x is tensor(148.2973, device='cuda:0')
benign distance is  tensor(148.2973, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.074994094669819
distance x is tensor(142.6998, device='cuda:0')
benign distance is  tensor(142.6998, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.155147559940815
distance x is tensor(139.5349, device='cuda:0')
benign distance is  tensor(139.5349, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.6435914859175682
distance x is tensor(123.0480, device='cuda:0')
benign distance is  tensor(123.0480, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.556759912520647
distance x is tensor(113.6677, device='cuda:0')
benign distance is  tensor(113.6677, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.1449050214141607
distance x is tensor(143.4545, device='cuda:0')
benign distance is  tensor(143.4545, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.594365507364273
distance x is tensor(130.3806, device='cuda:0')
benign distance is  tensor(130.3806, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.5390326902270317
distance x is tensor(151.9894, device='cuda:0')
benign distance is  tensor(151.9894, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.4822984151542187
distance x is tensor(160.9639, device='cuda:0')
benign distance is  tensor(160.9639, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.485594104975462
distance x is tensor(103.7874, device='cuda:0')
benign distance is  tensor(103.7874, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8229161072522402
distance x is tensor(172.2948, device='cuda:0')
benign distance is  tensor(172.2948, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0658888220787048
distance x is tensor(151.1099, device='cuda:0')
benign distance is  tensor(151.1099, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.3388303183019161
distance x is tensor(126.7893, device='cuda:0')
benign distance is  tensor(126.7893, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6303634578362107
distance x is tensor(156.9885, device='cuda:0')
benign distance is  tensor(156.9885, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.59500000016
mal_loss is 3.4895282238721848
mal_entropy is 0.25653052516281605
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([701.5159, 585.8810, 542.0192, 751.4365, 545.5993, 517.8496, 498.4732,
        472.5404, 444.0455, 444.0455, 444.0455, 444.0455, 444.0455, 444.0455,
        444.0455, 444.0455, 444.0455, 444.0455, 444.0455, 444.0455],
       device='cuda:0')
sorted_norm is   tensor([444.0455, 444.0455, 444.0455, 444.0455, 444.0455, 444.0455, 444.0455,
        444.0455, 444.0455, 444.0455, 444.0455, 444.0455, 472.5404, 498.4732,
        517.8496, 542.0192, 545.5993, 585.8810, 701.5159, 751.4365],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  6,  5,  2],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.99% 

Test Accuracy: 76.92% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2530512362718582
distance x is tensor(173.2002, device='cuda:0')
benign distance is  tensor(173.2002, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2569151036441326
distance x is tensor(160.4925, device='cuda:0')
benign distance is  tensor(160.4925, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6111832410097122
distance x is tensor(144.6211, device='cuda:0')
benign distance is  tensor(144.6211, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.504562072455883
distance x is tensor(193.3787, device='cuda:0')
benign distance is  tensor(193.3787, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6522456407546997
distance x is tensor(158.8971, device='cuda:0')
benign distance is  tensor(158.8971, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2243058308959007
distance x is tensor(153.9034, device='cuda:0')
benign distance is  tensor(153.9034, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.338429741561413
distance x is tensor(154.2888, device='cuda:0')
benign distance is  tensor(154.2888, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9164250791072845
distance x is tensor(154.0591, device='cuda:0')
benign distance is  tensor(154.0591, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2490000001600001
mal_loss is 29.847742319107056
mal_entropy is 0.08584827953018248
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([739.4300, 668.8500, 618.2542, 808.8219, 658.6066, 654.6136, 658.0282,
        652.1763, 456.8991, 456.8991, 456.8991, 456.8991, 456.8991, 456.8991,
        456.8991, 456.8991, 456.8991, 456.8991, 456.8991, 456.8991, 754.4011,
        671.2594, 791.6587, 736.9453, 752.8449, 775.2267, 832.4102, 907.9998,
        697.1772, 778.2540, 552.6580, 727.0880, 916.3074, 504.0867, 803.4259,
        754.5659], device='cuda:0')
sorted_norm is   tensor([456.8991, 456.8991, 456.8991, 456.8991, 456.8991, 456.8991, 456.8991,
        456.8991, 456.8991, 456.8991, 456.8991, 456.8991, 504.0867, 552.6580,
        618.2542, 652.1763, 654.6136, 658.0282, 658.6066, 668.8500, 671.2594,
        697.1772, 727.0880, 736.9453, 739.4300, 752.8449, 754.4011, 754.5659,
        775.2267, 778.2540, 791.6587, 803.4259, 808.8219, 832.4102, 907.9998,
        916.3074], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 30,  2,  7,  5,  6,
         4,  1, 21, 28, 31, 23,  0, 24, 20, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.22% 

Test Accuracy: 81.25% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0043420381844044
distance x is tensor(180.7370, device='cuda:0')
benign distance is  tensor(180.7370, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6046268604695797
distance x is tensor(145.7375, device='cuda:0')
benign distance is  tensor(145.7375, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2104062214493752
distance x is tensor(128.9089, device='cuda:0')
benign distance is  tensor(128.9089, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4721598513424397
distance x is tensor(181.0967, device='cuda:0')
benign distance is  tensor(181.0967, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8686590902507305
distance x is tensor(142.6265, device='cuda:0')
benign distance is  tensor(142.6265, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1400750819593668
distance x is tensor(138.6328, device='cuda:0')
benign distance is  tensor(138.6328, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8546521812677383
distance x is tensor(152.9742, device='cuda:0')
benign distance is  tensor(152.9742, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.464364405721426
distance x is tensor(138.8109, device='cuda:0')
benign distance is  tensor(138.8109, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6901812590658665
distance x is tensor(137.2697, device='cuda:0')
benign distance is  tensor(137.2697, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1722745522856712
distance x is tensor(183.4429, device='cuda:0')
benign distance is  tensor(183.4429, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.188539005815983
distance x is tensor(126.1681, device='cuda:0')
benign distance is  tensor(126.1681, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.2899940460920334
distance x is tensor(149.7998, device='cuda:0')
benign distance is  tensor(149.7998, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7575555592775345
distance x is tensor(189.4913, device='cuda:0')
benign distance is  tensor(189.4913, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.7655776031315327
distance x is tensor(100.3401, device='cuda:0')
benign distance is  tensor(100.3401, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8376603350043297
distance x is tensor(183.7099, device='cuda:0')
benign distance is  tensor(183.7099, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.3444109112024307
distance x is tensor(163.4482, device='cuda:0')
benign distance is  tensor(163.4482, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.081534244120121
distance x is tensor(151.0574, device='cuda:0')
benign distance is  tensor(151.0574, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.4744415879249573
distance x is tensor(172.3920, device='cuda:0')
benign distance is  tensor(172.3920, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2895433455705643
distance x is tensor(161.9105, device='cuda:0')
benign distance is  tensor(161.9105, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.2201436534523964
distance x is tensor(143.7576, device='cuda:0')
benign distance is  tensor(143.7576, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.480601903051138
distance x is tensor(152.6753, device='cuda:0')
benign distance is  tensor(152.6753, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.3478796184062958
distance x is tensor(158.7585, device='cuda:0')
benign distance is  tensor(158.7585, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6520533449947834
distance x is tensor(152.9303, device='cuda:0')
benign distance is  tensor(152.9303, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3637130707502365
distance x is tensor(188.2770, device='cuda:0')
benign distance is  tensor(188.2770, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.29300000016000005
mal_loss is 21.759725332260132
mal_entropy is 0.10208445601165295
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([779.1669, 626.4035, 539.1926, 770.8552, 597.1897, 578.0965, 666.2778,
        588.2795, 457.9158, 457.9158, 457.9158, 457.9158, 457.9158, 457.9158,
        457.9158, 457.9158, 457.9158, 457.9158, 457.9158, 457.9158, 618.2031,
        686.1968, 655.9241, 734.5570, 584.0628, 969.7643, 823.7814, 668.6541],
       device='cuda:0')
sorted_norm is   tensor([457.9158, 457.9158, 457.9158, 457.9158, 457.9158, 457.9158, 457.9158,
        457.9158, 457.9158, 457.9158, 457.9158, 457.9158, 539.1926, 578.0965,
        584.0628, 588.2795, 597.1897, 618.2031, 626.4035, 655.9241, 666.2778,
        668.6541, 686.1968, 734.5570, 770.8552, 779.1669, 823.7814, 969.7643],
       device='cuda:0')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  2,  5, 24,  7,  4, 20,
         1, 22,  6, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 87.24% 

Test Accuracy: 77.60% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0442230589687824
distance x is tensor(176.6984, device='cuda:0')
benign distance is  tensor(176.6984, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.839244805276394
distance x is tensor(157.2414, device='cuda:0')
benign distance is  tensor(157.2414, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5569636225700378
distance x is tensor(133.3107, device='cuda:0')
benign distance is  tensor(133.3107, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.557350568473339
distance x is tensor(190.3450, device='cuda:0')
benign distance is  tensor(190.3450, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5477070454508066
distance x is tensor(166.1685, device='cuda:0')
benign distance is  tensor(166.1685, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.32545954734087
distance x is tensor(147.0356, device='cuda:0')
benign distance is  tensor(147.0356, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1660789027810097
distance x is tensor(177.0024, device='cuda:0')
benign distance is  tensor(177.0024, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1942241564393044
distance x is tensor(136.2192, device='cuda:0')
benign distance is  tensor(136.2192, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.38997570425272
distance x is tensor(179.6786, device='cuda:0')
benign distance is  tensor(179.6786, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3629643190652132
distance x is tensor(159.7735, device='cuda:0')
benign distance is  tensor(159.7735, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.6487234085798264
distance x is tensor(168.6059, device='cuda:0')
benign distance is  tensor(168.6059, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.9839780926704407
distance x is tensor(175.4111, device='cuda:0')
benign distance is  tensor(175.4111, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.8718908429145813
distance x is tensor(139.0893, device='cuda:0')
benign distance is  tensor(139.0893, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9961423724889755
distance x is tensor(234.2642, device='cuda:0')
benign distance is  tensor(234.2642, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9785834327340126
distance x is tensor(202.8109, device='cuda:0')
benign distance is  tensor(202.8109, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.391525063663721
distance x is tensor(177.9595, device='cuda:0')
benign distance is  tensor(177.9595, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.17600000016000006
mal_loss is 40.312636613845825
mal_entropy is 0.060251333517953753
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([733.6564, 639.4685, 550.2932, 799.8403, 683.0146, 600.4960, 701.1701,
        559.7752, 459.1566, 459.1566, 459.1566, 459.1566, 459.1566, 459.1566,
        459.1566, 459.1566, 459.1566, 459.1566, 459.1566, 459.1566, 624.1879,
        797.4107, 595.7676, 706.9023, 823.9904, 484.7818, 806.4479, 759.1110],
       device='cuda:0')
sorted_norm is   tensor([459.1566, 459.1566, 459.1566, 459.1566, 459.1566, 459.1566, 459.1566,
        459.1566, 459.1566, 459.1566, 459.1566, 459.1566, 484.7818, 550.2932,
        559.7752, 595.7676, 600.4960, 624.1879, 639.4685, 683.0146, 701.1701,
        706.9023, 733.6564, 759.1110, 797.4107, 799.8403, 806.4479, 823.9904],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25,  2,  7, 22,  5, 20,
         1,  4,  6, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 85.77% 

Test Accuracy: 77.19% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.029285740107298
distance x is tensor(185.2178, device='cuda:0')
benign distance is  tensor(185.2178, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6625679060816765
distance x is tensor(151.3326, device='cuda:0')
benign distance is  tensor(151.3326, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.1604234501719475
distance x is tensor(138.9951, device='cuda:0')
benign distance is  tensor(138.9951, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.007328737527132
distance x is tensor(188.3220, device='cuda:0')
benign distance is  tensor(188.3220, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2618366479873657
distance x is tensor(167.6694, device='cuda:0')
benign distance is  tensor(167.6694, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.364920610561967
distance x is tensor(150.2988, device='cuda:0')
benign distance is  tensor(150.2988, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8143933713436127
distance x is tensor(151.1014, device='cuda:0')
benign distance is  tensor(151.1014, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8072280548512936
distance x is tensor(147.3663, device='cuda:0')
benign distance is  tensor(147.3663, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.529612421989441
distance x is tensor(145.6685, device='cuda:0')
benign distance is  tensor(145.6685, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.6237165145576
distance x is tensor(180.9156, device='cuda:0')
benign distance is  tensor(180.9156, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1601497381925583
distance x is tensor(124.1469, device='cuda:0')
benign distance is  tensor(124.1469, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.7664986103773117
distance x is tensor(168.9726, device='cuda:0')
benign distance is  tensor(168.9726, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7956627011299133
distance x is tensor(187.8183, device='cuda:0')
benign distance is  tensor(187.8183, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.755359262228012
distance x is tensor(123.8757, device='cuda:0')
benign distance is  tensor(123.8757, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6266480199992657
distance x is tensor(180.7717, device='cuda:0')
benign distance is  tensor(180.7717, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.2163956612348557
distance x is tensor(185.9572, device='cuda:0')
benign distance is  tensor(185.9572, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.15700000016000004
mal_loss is 40.73203682899475
mal_entropy is 0.07493847259320319
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([772.8532, 642.1450, 587.2531, 790.9199, 663.9857, 616.9681, 644.3765,
        613.3088, 455.6162, 455.6162, 455.6162, 455.6162, 455.6162, 455.6162,
        455.6162, 455.6162, 455.6162, 455.6162, 455.6162, 455.6162, 830.4929,
        746.0071, 834.9147, 803.1312, 781.6770, 740.7909, 707.0909, 806.9605],
       device='cuda:0')
sorted_norm is   tensor([455.6162, 455.6162, 455.6162, 455.6162, 455.6162, 455.6162, 455.6162,
        455.6162, 455.6162, 455.6162, 455.6162, 455.6162, 587.2531, 613.3088,
        616.9681, 642.1450, 644.3765, 663.9857, 707.0909, 740.7909, 746.0071,
        772.8532, 781.6770, 790.9199, 803.1312, 806.9605, 830.4929, 834.9147],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  7,  5,  1,  6,  4,
        26, 25, 21,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 85.17% 

Test Accuracy: 73.13% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0931455995887518
distance x is tensor(182.5024, device='cuda:0')
benign distance is  tensor(182.5024, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7132372856140137
distance x is tensor(137.1145, device='cuda:0')
benign distance is  tensor(137.1145, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9958268776535988
distance x is tensor(156.6831, device='cuda:0')
benign distance is  tensor(156.6831, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.065267913043499
distance x is tensor(206.2756, device='cuda:0')
benign distance is  tensor(206.2756, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6148810610175133
distance x is tensor(182.8862, device='cuda:0')
benign distance is  tensor(182.8862, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3075193837285042
distance x is tensor(153.6609, device='cuda:0')
benign distance is  tensor(153.6609, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.471655286848545
distance x is tensor(178.4857, device='cuda:0')
benign distance is  tensor(178.4857, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2265791222453117
distance x is tensor(140.4826, device='cuda:0')
benign distance is  tensor(140.4826, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.2862590998411179
distance x is tensor(183.3190, device='cuda:0')
benign distance is  tensor(183.3190, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0231292992830276
distance x is tensor(171.6714, device='cuda:0')
benign distance is  tensor(171.6714, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.4672534465789795
distance x is tensor(196.3162, device='cuda:0')
benign distance is  tensor(196.3162, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.790004387497902
distance x is tensor(217.5442, device='cuda:0')
benign distance is  tensor(217.5442, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.3606891855597496
distance x is tensor(168.9744, device='cuda:0')
benign distance is  tensor(168.9744, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.3171061351895332
distance x is tensor(174.9648, device='cuda:0')
benign distance is  tensor(174.9648, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.4251004457473755
distance x is tensor(144.8904, device='cuda:0')
benign distance is  tensor(144.8904, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.1340331137180328
distance x is tensor(204.6760, device='cuda:0')
benign distance is  tensor(204.6760, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.11800000016
mal_loss is 56.30374479293823
mal_entropy is 0.05086710280738771
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 782.0432,  582.3647,  637.8259,  817.7479,  719.8188,  608.0299,
         744.0002,  570.8250,  455.2773,  455.2773,  455.2773,  455.2773,
         455.2773,  455.2773,  455.2773,  455.2773,  455.2773,  455.2773,
         455.2773,  455.2773,  803.7847,  873.8350,  895.0776,  708.6817,
         936.9736,  875.0070,  783.4022,  885.6391,  742.7573,  859.1208,
         814.2076,  754.4799,  755.9874,  790.7645,  766.4872,  892.7120,
         817.4885,  764.8553,  752.4454,  795.7344,  658.7260, 1017.5446,
         905.2675,  814.4244,  651.2006,  788.1346,  590.0555,  751.8524,
         808.7084,  556.7157,  793.3802,  810.1068], device='cuda:0')
sorted_norm is   tensor([ 455.2773,  455.2773,  455.2773,  455.2773,  455.2773,  455.2773,
         455.2773,  455.2773,  455.2773,  455.2773,  455.2773,  455.2773,
         556.7157,  570.8250,  582.3647,  590.0555,  608.0299,  637.8259,
         651.2006,  658.7260,  708.6817,  719.8188,  742.7573,  744.0002,
         751.8524,  752.4454,  754.4799,  755.9874,  764.8553,  766.4872,
         782.0432,  783.4022,  788.1346,  790.7645,  793.3802,  795.7344,
         803.7847,  808.7084,  810.1068,  814.2076,  814.4244,  817.4885,
         817.7479,  859.1208,  873.8350,  875.0070,  885.6391,  892.7120,
         895.0776,  905.2675,  936.9736, 1017.5446], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 49,  7,  1, 46,  5,  2,
        44, 40, 23,  4, 28,  6, 47, 38, 31, 32, 37, 34,  0, 26, 45, 33, 50, 39,
        20, 48, 51, 30, 43], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 81.90% 

Test Accuracy: 82.28% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0326798856258392
distance x is tensor(155.2052, device='cuda:0')
benign distance is  tensor(155.2052, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8805300071835518
distance x is tensor(122.2662, device='cuda:0')
benign distance is  tensor(122.2662, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5165203884243965
distance x is tensor(132.2135, device='cuda:0')
benign distance is  tensor(132.2135, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5882978178560734
distance x is tensor(159.4698, device='cuda:0')
benign distance is  tensor(159.4698, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.021325744688511
distance x is tensor(126.3682, device='cuda:0')
benign distance is  tensor(126.3682, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0369135402143002
distance x is tensor(130.8250, device='cuda:0')
benign distance is  tensor(130.8250, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8674264922738075
distance x is tensor(135.8052, device='cuda:0')
benign distance is  tensor(135.8052, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4008229970932007
distance x is tensor(116.8700, device='cuda:0')
benign distance is  tensor(116.8700, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6968944482505322
distance x is tensor(120.4291, device='cuda:0')
benign distance is  tensor(120.4291, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4473442863672972
distance x is tensor(164.3059, device='cuda:0')
benign distance is  tensor(164.3059, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.187125116586685
distance x is tensor(92.1647, device='cuda:0')
benign distance is  tensor(92.1647, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.959944687783718
distance x is tensor(129.2402, device='cuda:0')
benign distance is  tensor(129.2402, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5824114829301834
distance x is tensor(176.2462, device='cuda:0')
benign distance is  tensor(176.2462, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.020118959248066
distance x is tensor(77.0281, device='cuda:0')
benign distance is  tensor(77.0281, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4119047671556473
distance x is tensor(160.5965, device='cuda:0')
benign distance is  tensor(160.5965, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2149957790970802
distance x is tensor(134.4713, device='cuda:0')
benign distance is  tensor(134.4713, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7897940501570702
distance x is tensor(113.4421, device='cuda:0')
benign distance is  tensor(113.4421, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2062442563474178
distance x is tensor(136.4389, device='cuda:0')
benign distance is  tensor(136.4389, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.18108819052577
distance x is tensor(146.0513, device='cuda:0')
benign distance is  tensor(146.0513, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.1065446883440018
distance x is tensor(147.9941, device='cuda:0')
benign distance is  tensor(147.9941, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6387524902820587
distance x is tensor(118.0336, device='cuda:0')
benign distance is  tensor(118.0336, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1262698769569397
distance x is tensor(203.5253, device='cuda:0')
benign distance is  tensor(203.5253, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.279029730707407
distance x is tensor(167.0111, device='cuda:0')
benign distance is  tensor(167.0111, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.291104905307293
distance x is tensor(145.1550, device='cuda:0')
benign distance is  tensor(145.1550, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.057873986661434
distance x is tensor(130.0410, device='cuda:0')
benign distance is  tensor(130.0410, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1752143241465092
distance x is tensor(98.8793, device='cuda:0')
benign distance is  tensor(98.8793, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3839334845542908
distance x is tensor(145.6677, device='cuda:0')
benign distance is  tensor(145.6677, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.9989146068692207
distance x is tensor(128.3177, device='cuda:0')
benign distance is  tensor(128.3177, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1671232432127
distance x is tensor(146.8520, device='cuda:0')
benign distance is  tensor(146.8520, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5322050005197525
distance x is tensor(135.5909, device='cuda:0')
benign distance is  tensor(135.5909, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8481416869908571
distance x is tensor(132.0569, device='cuda:0')
benign distance is  tensor(132.0569, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.2879897691309452
distance x is tensor(166.9248, device='cuda:0')
benign distance is  tensor(166.9248, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.620954990386963
distance x is tensor(131.0087, device='cuda:0')
benign distance is  tensor(131.0087, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.306424878537655
distance x is tensor(150.7491, device='cuda:0')
benign distance is  tensor(150.7491, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.4926967024803162
distance x is tensor(175.3338, device='cuda:0')
benign distance is  tensor(175.3338, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.8874423801898956
distance x is tensor(113.0825, device='cuda:0')
benign distance is  tensor(113.0825, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.914765402674675
distance x is tensor(166.9306, device='cuda:0')
benign distance is  tensor(166.9306, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.6887925304472446
distance x is tensor(144.6720, device='cuda:0')
benign distance is  tensor(144.6720, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.6573357805609703
distance x is tensor(135.9189, device='cuda:0')
benign distance is  tensor(135.9189, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6952582448720932
distance x is tensor(154.6452, device='cuda:0')
benign distance is  tensor(154.6452, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.63000000016
mal_loss is 2.8583681881427765
mal_entropy is 0.2666367255151272
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([677.4111, 554.8648, 566.1743, 701.7097, 544.8762, 546.5720, 583.9859,
        505.8498, 440.3346, 440.3346, 440.3346, 440.3346, 440.3346, 440.3346,
        440.3346, 440.3346, 440.3346, 440.3346, 440.3346, 440.3346],
       device='cuda:0')
sorted_norm is   tensor([440.3346, 440.3346, 440.3346, 440.3346, 440.3346, 440.3346, 440.3346,
        440.3346, 440.3346, 440.3346, 440.3346, 440.3346, 505.8498, 544.8762,
        546.5720, 554.8648, 566.1743, 583.9859, 677.4111, 701.7097],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  4,  5,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 86.73% 

Test Accuracy: 78.32% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0119849368929863
distance x is tensor(178.2508, device='cuda:0')
benign distance is  tensor(178.2508, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5892456397414207
distance x is tensor(148.4474, device='cuda:0')
benign distance is  tensor(148.4474, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8638230487704277
distance x is tensor(154.8729, device='cuda:0')
benign distance is  tensor(154.8729, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8873686119914055
distance x is tensor(185.5333, device='cuda:0')
benign distance is  tensor(185.5333, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8479656763374805
distance x is tensor(160.2314, device='cuda:0')
benign distance is  tensor(160.2314, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8679346218705177
distance x is tensor(140.2708, device='cuda:0')
benign distance is  tensor(140.2708, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1075989454984665
distance x is tensor(163.6053, device='cuda:0')
benign distance is  tensor(163.6053, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8582050204277039
distance x is tensor(124.2397, device='cuda:0')
benign distance is  tensor(124.2397, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.22100000016000007
mal_loss is 28.15217399597168
mal_entropy is 0.0896926389541477
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([743.6417, 628.7472, 638.8480, 789.2247, 670.3547, 583.6807, 690.3234,
        529.2459, 450.7047, 450.7048, 450.7047, 450.7048, 450.7047, 450.7048,
        450.7047, 450.7048, 450.7047, 450.7048, 450.7047, 450.7048, 632.5726,
        781.6065, 535.0711, 691.6766, 857.0615, 476.4171, 778.6335, 694.5434],
       device='cuda:0')
sorted_norm is   tensor([450.7047, 450.7047, 450.7047, 450.7047, 450.7047, 450.7047, 450.7048,
        450.7048, 450.7048, 450.7048, 450.7048, 450.7048, 476.4171, 529.2459,
        535.0711, 583.6807, 628.7472, 632.5726, 638.8480, 670.3547, 690.3234,
        691.6766, 694.5434, 743.6417, 778.6335, 781.6065, 789.2247, 857.0615],
       device='cuda:0')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11, 25,  7, 22,  5,  1, 20,
         2,  4,  6, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 84.47% 

Test Accuracy: 76.14% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.172279454767704
distance x is tensor(196.6644, device='cuda:0')
benign distance is  tensor(196.6644, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.9406439363956451
distance x is tensor(157.2876, device='cuda:0')
benign distance is  tensor(157.2876, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4304818473756313
distance x is tensor(143.8009, device='cuda:0')
benign distance is  tensor(143.8009, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.606654155999422
distance x is tensor(192.9586, device='cuda:0')
benign distance is  tensor(192.9586, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3498906940221786
distance x is tensor(148.1360, device='cuda:0')
benign distance is  tensor(148.1360, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5020795427262783
distance x is tensor(154.7401, device='cuda:0')
benign distance is  tensor(154.7401, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8034564852714539
distance x is tensor(154.5621, device='cuda:0')
benign distance is  tensor(154.5621, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6825602650642395
distance x is tensor(131.3465, device='cuda:0')
benign distance is  tensor(131.3465, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8703186362981796
distance x is tensor(164.9061, device='cuda:0')
benign distance is  tensor(164.9061, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2003892958164215
distance x is tensor(173.9436, device='cuda:0')
benign distance is  tensor(173.9436, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.813190147280693
distance x is tensor(162.2274, device='cuda:0')
benign distance is  tensor(162.2274, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.0071253404021263
distance x is tensor(163.2202, device='cuda:0')
benign distance is  tensor(163.2202, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7761825770139694
distance x is tensor(204.6728, device='cuda:0')
benign distance is  tensor(204.6728, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3006459437310696
distance x is tensor(118.8059, device='cuda:0')
benign distance is  tensor(118.8059, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4621433168649673
distance x is tensor(203.1655, device='cuda:0')
benign distance is  tensor(203.1655, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.295452654361725
distance x is tensor(203.1373, device='cuda:0')
benign distance is  tensor(203.1373, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.14800000016000006
mal_loss is 45.29279017448425
mal_entropy is 0.04833638924174011
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([824.3630, 626.4047, 601.2744, 810.1440, 608.4467, 612.1113, 645.9521,
        567.4431, 457.0017, 457.0017, 457.0017, 457.0017, 457.0017, 457.0017,
        457.0017, 457.0017, 457.0017, 457.0017, 457.0017, 457.0017, 664.9477,
        727.1458, 741.9069, 767.2825, 657.0842, 982.8538, 846.0752, 760.2158],
       device='cuda:0')
sorted_norm is   tensor([457.0017, 457.0017, 457.0017, 457.0017, 457.0017, 457.0017, 457.0017,
        457.0017, 457.0017, 457.0017, 457.0017, 457.0017, 567.4431, 601.2744,
        608.4467, 612.1113, 626.4047, 645.9521, 657.0842, 664.9477, 727.1458,
        741.9069, 760.2158, 767.2825, 810.1440, 824.3630, 846.0752, 982.8538],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  4,  5,  1,  6,
        24, 20, 21, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 81.51% 

Test Accuracy: 75.47% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9804581701755524
distance x is tensor(191.2536, device='cuda:0')
benign distance is  tensor(191.2536, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5540622621774673
distance x is tensor(159.9180, device='cuda:0')
benign distance is  tensor(159.9180, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.467903971672058
distance x is tensor(168.9985, device='cuda:0')
benign distance is  tensor(168.9985, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7301743477582932
distance x is tensor(186.1797, device='cuda:0')
benign distance is  tensor(186.1797, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0386137776076794
distance x is tensor(183.0882, device='cuda:0')
benign distance is  tensor(183.0882, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4368170164525509
distance x is tensor(147.1174, device='cuda:0')
benign distance is  tensor(147.1174, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.340561605989933
distance x is tensor(163.8007, device='cuda:0')
benign distance is  tensor(163.8007, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.4481535479426384
distance x is tensor(178.3119, device='cuda:0')
benign distance is  tensor(178.3119, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.450282044708729
distance x is tensor(143.5306, device='cuda:0')
benign distance is  tensor(143.5306, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.8122522123157978
distance x is tensor(184.5537, device='cuda:0')
benign distance is  tensor(184.5537, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.0715267211198807
distance x is tensor(158.4392, device='cuda:0')
benign distance is  tensor(158.4392, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.6139882020652294
distance x is tensor(179.1367, device='cuda:0')
benign distance is  tensor(179.1367, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9504488930106163
distance x is tensor(152.1026, device='cuda:0')
benign distance is  tensor(152.1026, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5697255730628967
distance x is tensor(224.8904, device='cuda:0')
benign distance is  tensor(224.8904, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9191355369985104
distance x is tensor(220.8368, device='cuda:0')
benign distance is  tensor(220.8368, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3215074129402637
distance x is tensor(168.2261, device='cuda:0')
benign distance is  tensor(168.2261, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.14500000016000006
mal_loss is 41.04357671737671
mal_entropy is 0.05002483224961907
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([787.8926, 653.2814, 670.7572, 766.0863, 707.2328, 609.9806, 673.7913,
        703.2421, 453.2613, 453.2613, 453.2613, 453.2613, 453.2613, 453.2613,
        453.2613, 453.2613, 453.2613, 453.2613, 453.2613, 453.2613, 853.9164,
        839.3391, 893.8426, 923.4504, 817.5052, 811.4294, 708.8323, 887.1428,
        714.1900, 624.4890, 798.4300, 731.8588, 792.1224, 763.0660, 724.8284,
        864.7360, 712.3599, 730.1749, 671.9911, 719.4315, 887.5686, 537.7487,
        837.1127, 860.5615], device='cuda:0')
sorted_norm is   tensor([453.2613, 453.2613, 453.2613, 453.2613, 453.2613, 453.2613, 453.2613,
        453.2613, 453.2613, 453.2613, 453.2613, 453.2613, 537.7487, 609.9806,
        624.4890, 653.2814, 670.7572, 671.9911, 673.7913, 703.2421, 707.2328,
        708.8323, 712.3599, 714.1900, 719.4315, 724.8284, 730.1749, 731.8588,
        763.0660, 766.0863, 787.8926, 792.1224, 798.4300, 811.4294, 817.5052,
        837.1127, 839.3391, 853.9164, 860.5615, 864.7360, 887.1428, 887.5686,
        893.8426, 923.4504], device='cuda:0')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 41,  5, 29,  1,  2, 38,
         6,  7,  4, 26, 36, 28, 39, 34, 37, 31, 33,  3,  0, 32, 30, 25, 24],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 81.60% 

Test Accuracy: 81.77% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1220255680382252
distance x is tensor(162.2029, device='cuda:0')
benign distance is  tensor(162.2029, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8471837863326073
distance x is tensor(128.8155, device='cuda:0')
benign distance is  tensor(128.8155, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5093617588281631
distance x is tensor(132.7428, device='cuda:0')
benign distance is  tensor(132.7428, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6495233252644539
distance x is tensor(170.4781, device='cuda:0')
benign distance is  tensor(170.4781, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.031787395477295
distance x is tensor(162.4678, device='cuda:0')
benign distance is  tensor(162.4678, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.784978199750185
distance x is tensor(153.0854, device='cuda:0')
benign distance is  tensor(153.0854, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.821274496614933
distance x is tensor(131.7980, device='cuda:0')
benign distance is  tensor(131.7980, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4980075545608997
distance x is tensor(122.5820, device='cuda:0')
benign distance is  tensor(122.5820, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5649090707302094
distance x is tensor(140.1242, device='cuda:0')
benign distance is  tensor(140.1242, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.573036527261138
distance x is tensor(157.3227, device='cuda:0')
benign distance is  tensor(157.3227, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.219771109521389
distance x is tensor(113.0268, device='cuda:0')
benign distance is  tensor(113.0268, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.3126814365386963
distance x is tensor(132.4622, device='cuda:0')
benign distance is  tensor(132.4622, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5642590671777725
distance x is tensor(174.5833, device='cuda:0')
benign distance is  tensor(174.5833, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1912213861942291
distance x is tensor(94.8573, device='cuda:0')
benign distance is  tensor(94.8573, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6193057037889957
distance x is tensor(166.1617, device='cuda:0')
benign distance is  tensor(166.1617, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.802276521921158
distance x is tensor(145.0773, device='cuda:0')
benign distance is  tensor(145.0773, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6772644147276878
distance x is tensor(131.3444, device='cuda:0')
benign distance is  tensor(131.3444, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3084698915481567
distance x is tensor(99.7043, device='cuda:0')
benign distance is  tensor(99.7043, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.9977712258696556
distance x is tensor(141.6898, device='cuda:0')
benign distance is  tensor(141.6898, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.1789584159851074
distance x is tensor(119.1877, device='cuda:0')
benign distance is  tensor(119.1877, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3116958923637867
distance x is tensor(152.1659, device='cuda:0')
benign distance is  tensor(152.1659, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.426705401390791
distance x is tensor(134.5691, device='cuda:0')
benign distance is  tensor(134.5691, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9183195941150188
distance x is tensor(132.0686, device='cuda:0')
benign distance is  tensor(132.0686, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.4946035258471966
distance x is tensor(170.5228, device='cuda:0')
benign distance is  tensor(170.5228, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.300244603306055
distance x is tensor(149.8319, device='cuda:0')
benign distance is  tensor(149.8319, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.019067235291004
distance x is tensor(122.8255, device='cuda:0')
benign distance is  tensor(122.8255, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.341755449771881
distance x is tensor(157.8982, device='cuda:0')
benign distance is  tensor(157.8982, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.167786210775375
distance x is tensor(150.7866, device='cuda:0')
benign distance is  tensor(150.7866, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0987168923020363
distance x is tensor(144.8336, device='cuda:0')
benign distance is  tensor(144.8336, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.2444552518427372
distance x is tensor(112.8755, device='cuda:0')
benign distance is  tensor(112.8755, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.6491102017462254
distance x is tensor(109.6531, device='cuda:0')
benign distance is  tensor(109.6531, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0263198353350163
distance x is tensor(140.7887, device='cuda:0')
benign distance is  tensor(140.7887, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.63700000016
mal_loss is 2.815607398748398
mal_entropy is 0.2632871950045228
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([712.9393, 573.3794, 572.7120, 745.6188, 708.9861, 617.4075, 576.0851,
        532.4376, 426.9663, 426.9663, 426.9663, 426.9663, 426.9663, 426.9663,
        426.9663, 426.9663, 426.9663, 426.9663, 426.9663, 426.9663],
       device='cuda:0')
sorted_norm is   tensor([426.9663, 426.9663, 426.9663, 426.9663, 426.9663, 426.9663, 426.9663,
        426.9663, 426.9663, 426.9663, 426.9663, 426.9663, 532.4376, 572.7120,
        573.3794, 576.0851, 617.4075, 708.9861, 712.9393, 745.6188],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  1,  6],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 85.11% 

Test Accuracy: 77.52% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.409944448620081
distance x is tensor(177.4397, device='cuda:0')
benign distance is  tensor(177.4397, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.400197498500347
distance x is tensor(152.7776, device='cuda:0')
benign distance is  tensor(152.7776, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5853113271296024
distance x is tensor(141.6901, device='cuda:0')
benign distance is  tensor(141.6901, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8589083552360535
distance x is tensor(185.8720, device='cuda:0')
benign distance is  tensor(185.8720, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.901781503111124
distance x is tensor(155.1917, device='cuda:0')
benign distance is  tensor(155.1917, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5344928205013275
distance x is tensor(147.2499, device='cuda:0')
benign distance is  tensor(147.2499, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1024754494428635
distance x is tensor(142.3082, device='cuda:0')
benign distance is  tensor(142.3082, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4914755895733833
distance x is tensor(123.7889, device='cuda:0')
benign distance is  tensor(123.7889, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3310000001600001
mal_loss is 17.041694164276123
mal_entropy is 0.15933464653789997
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([759.1395, 651.5181, 606.6559, 783.7251, 648.1669, 613.0438, 606.4678,
        545.8055, 435.0977, 435.0977, 435.0977, 435.0977, 435.0977, 435.0977,
        435.0977, 435.0977, 435.0977, 435.0977, 435.0977, 435.0977, 809.1817,
        861.2688, 947.9855, 732.3568, 925.7905, 839.8390, 805.1500, 860.3513,
        692.7048, 791.1996, 731.6788, 839.9446, 712.0327, 976.3336, 943.5666,
        784.3685, 696.0813, 780.8987, 604.5214, 688.8293, 843.4511, 533.1160,
        819.6126, 739.9470], device='cuda:0')
sorted_norm is   tensor([435.0977, 435.0977, 435.0977, 435.0977, 435.0977, 435.0977, 435.0977,
        435.0977, 435.0977, 435.0977, 435.0977, 435.0977, 533.1160, 545.8055,
        604.5214, 606.4678, 606.6559, 613.0438, 648.1669, 651.5181, 688.8293,
        692.7048, 696.0813, 712.0327, 731.6788, 732.3568, 739.9470, 759.1395,
        780.8987, 783.7251, 784.3685, 791.1996, 805.1500, 809.1817, 819.6126,
        839.8390, 839.9446, 843.4511, 860.3513, 861.2688, 925.7905, 943.5666,
        947.9855, 976.3336], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 41,  7, 38,  6,  2,  5,
         4,  1, 39, 28, 36, 32, 30, 23, 43,  0, 37,  3, 35, 29, 26, 20, 42],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 78.57% 

Test Accuracy: 81.57% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9202946983277798
distance x is tensor(170.3414, device='cuda:0')
benign distance is  tensor(170.3414, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6706434972584248
distance x is tensor(120.5504, device='cuda:0')
benign distance is  tensor(120.5504, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4374264143407345
distance x is tensor(116.7334, device='cuda:0')
benign distance is  tensor(116.7334, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.599990837275982
distance x is tensor(160.2959, device='cuda:0')
benign distance is  tensor(160.2959, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9617807902395725
distance x is tensor(134.3214, device='cuda:0')
benign distance is  tensor(134.3214, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2799568735063076
distance x is tensor(142.1445, device='cuda:0')
benign distance is  tensor(142.1445, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1205984801054
distance x is tensor(135.7236, device='cuda:0')
benign distance is  tensor(135.7236, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8229261189699173
distance x is tensor(108.7203, device='cuda:0')
benign distance is  tensor(108.7203, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.530553873628378
distance x is tensor(143.6820, device='cuda:0')
benign distance is  tensor(143.6820, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0987897217273712
distance x is tensor(151.8527, device='cuda:0')
benign distance is  tensor(151.8527, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.090381480753422
distance x is tensor(109.7221, device='cuda:0')
benign distance is  tensor(109.7221, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5070518404245377
distance x is tensor(139.8483, device='cuda:0')
benign distance is  tensor(139.8483, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.1433734223246574
distance x is tensor(189.5802, device='cuda:0')
benign distance is  tensor(189.5802, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.305015793070197
distance x is tensor(93.7031, device='cuda:0')
benign distance is  tensor(93.7031, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.389592282474041
distance x is tensor(168.2616, device='cuda:0')
benign distance is  tensor(168.2616, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.410645551979542
distance x is tensor(141.8657, device='cuda:0')
benign distance is  tensor(141.8657, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.0754857659339905
distance x is tensor(121.0927, device='cuda:0')
benign distance is  tensor(121.0927, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.6348964348435402
distance x is tensor(153.7957, device='cuda:0')
benign distance is  tensor(153.7957, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8865158408880234
distance x is tensor(135.7321, device='cuda:0')
benign distance is  tensor(135.7321, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.9348445236682892
distance x is tensor(153.5596, device='cuda:0')
benign distance is  tensor(153.5596, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9242392182350159
distance x is tensor(106.7501, device='cuda:0')
benign distance is  tensor(106.7501, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1399682946503162
distance x is tensor(204.9941, device='cuda:0')
benign distance is  tensor(204.9941, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.4607745483517647
distance x is tensor(181.2758, device='cuda:0')
benign distance is  tensor(181.2758, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2846517991274595
distance x is tensor(136.8568, device='cuda:0')
benign distance is  tensor(136.8568, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.951192319393158
distance x is tensor(126.5618, device='cuda:0')
benign distance is  tensor(126.5618, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.822290688753128
distance x is tensor(156.3496, device='cuda:0')
benign distance is  tensor(156.3496, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.8727226331830025
distance x is tensor(168.6788, device='cuda:0')
benign distance is  tensor(168.6788, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.6003786996006966
distance x is tensor(112.5639, device='cuda:0')
benign distance is  tensor(112.5639, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.0772155709564686
distance x is tensor(166.7230, device='cuda:0')
benign distance is  tensor(166.7230, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.737659327685833
distance x is tensor(145.3713, device='cuda:0')
benign distance is  tensor(145.3713, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.6951710060238838
distance x is tensor(143.1119, device='cuda:0')
benign distance is  tensor(143.1119, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6927381698042154
distance x is tensor(166.3131, device='cuda:0')
benign distance is  tensor(166.3131, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.57500000016
mal_loss is 4.153037577867508
mal_entropy is 0.24854470416903496
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([754.6118, 542.0727, 497.9479, 687.7251, 566.2703, 608.5027, 601.5498,
        485.1641, 433.1055, 433.1055, 433.1055, 433.1055, 433.1055, 433.1055,
        433.1055, 433.1055, 433.1055, 433.1055, 433.1055, 433.1055],
       device='cuda:0')
sorted_norm is   tensor([433.1055, 433.1055, 433.1055, 433.1055, 433.1055, 433.1055, 433.1055,
        433.1055, 433.1055, 433.1055, 433.1055, 433.1055, 485.1641, 497.9479,
        542.0727, 566.2703, 601.5498, 608.5027, 687.7251, 754.6118],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  1,  4],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 82.68% 

Test Accuracy: 76.44% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0043646171689034
distance x is tensor(190.4666, device='cuda:0')
benign distance is  tensor(190.4666, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8207779377698898
distance x is tensor(150.8016, device='cuda:0')
benign distance is  tensor(150.8016, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6206250563263893
distance x is tensor(147.8819, device='cuda:0')
benign distance is  tensor(147.8819, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.983025573194027
distance x is tensor(196.0446, device='cuda:0')
benign distance is  tensor(196.0446, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.052511230111122
distance x is tensor(153.7848, device='cuda:0')
benign distance is  tensor(153.7848, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4537871032953262
distance x is tensor(164.9880, device='cuda:0')
benign distance is  tensor(164.9880, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.62601238489151
distance x is tensor(168.8921, device='cuda:0')
benign distance is  tensor(168.8921, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7623957395553589
distance x is tensor(143.7540, device='cuda:0')
benign distance is  tensor(143.7540, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2440000001600001
mal_loss is 28.483646988868713
mal_entropy is 0.10109528643079102
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([820.1909, 631.8380, 607.4817, 801.1697, 647.6924, 671.4136, 710.5742,
        609.3497, 441.8903, 441.8903, 441.8903, 441.8903, 441.8903, 441.8903,
        441.8903, 441.8903, 441.8903, 441.8903, 441.8903, 441.8903, 732.0407,
        628.7749, 783.2903, 703.2084, 798.6255, 753.1265, 729.8333, 870.5005,
        708.1888, 746.1545, 599.0592, 714.2596, 912.3831, 539.2137, 803.2264,
        738.9720], device='cuda:0')
sorted_norm is   tensor([441.8903, 441.8903, 441.8903, 441.8903, 441.8903, 441.8903, 441.8903,
        441.8903, 441.8903, 441.8903, 441.8903, 441.8903, 539.2137, 599.0592,
        607.4817, 609.3497, 628.7749, 631.8380, 647.6924, 671.4136, 703.2084,
        708.1888, 710.5742, 714.2596, 729.8333, 732.0407, 738.9720, 746.1545,
        753.1265, 783.2903, 798.6255, 801.1697, 803.2264, 820.1909, 870.5005,
        912.3831], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 30,  2,  7, 21,  1,
         4,  5, 23, 28,  6, 31, 26, 20, 35, 29], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 82.18% 

Test Accuracy: 81.03% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0877819955348969
distance x is tensor(171.8785, device='cuda:0')
benign distance is  tensor(171.8785, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.9912091605365276
distance x is tensor(139.7563, device='cuda:0')
benign distance is  tensor(139.7563, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.1869900301098824
distance x is tensor(130.4078, device='cuda:0')
benign distance is  tensor(130.4078, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6548279449343681
distance x is tensor(174.3665, device='cuda:0')
benign distance is  tensor(174.3665, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2422230541706085
distance x is tensor(153.8423, device='cuda:0')
benign distance is  tensor(153.8423, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3398784175515175
distance x is tensor(140.9965, device='cuda:0')
benign distance is  tensor(140.9965, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8226706832647324
distance x is tensor(142.8008, device='cuda:0')
benign distance is  tensor(142.8008, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.648380920290947
distance x is tensor(116.7370, device='cuda:0')
benign distance is  tensor(116.7370, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3819149620831013
distance x is tensor(132.3954, device='cuda:0')
benign distance is  tensor(132.3954, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3287331331521273
distance x is tensor(174.4024, device='cuda:0')
benign distance is  tensor(174.4024, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.0150256603956223
distance x is tensor(127.9874, device='cuda:0')
benign distance is  tensor(127.9874, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.9045607894659042
distance x is tensor(151.4762, device='cuda:0')
benign distance is  tensor(151.4762, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.0768879875540733
distance x is tensor(188.8349, device='cuda:0')
benign distance is  tensor(188.8349, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3348933160305023
distance x is tensor(87.9808, device='cuda:0')
benign distance is  tensor(87.9808, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.66927220672369
distance x is tensor(156.1311, device='cuda:0')
benign distance is  tensor(156.1311, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.575325608253479
distance x is tensor(170.0548, device='cuda:0')
benign distance is  tensor(170.0548, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9093587175011635
distance x is tensor(156.7888, device='cuda:0')
benign distance is  tensor(156.7888, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2823797948658466
distance x is tensor(105.8888, device='cuda:0')
benign distance is  tensor(105.8888, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.205117367208004
distance x is tensor(160.9192, device='cuda:0')
benign distance is  tensor(160.9192, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.306096002459526
distance x is tensor(144.7660, device='cuda:0')
benign distance is  tensor(144.7660, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5262423604726791
distance x is tensor(146.4234, device='cuda:0')
benign distance is  tensor(146.4234, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.7500504180788994
distance x is tensor(153.1377, device='cuda:0')
benign distance is  tensor(153.1377, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7973208781331778
distance x is tensor(162.5405, device='cuda:0')
benign distance is  tensor(162.5405, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.2578954473137856
distance x is tensor(171.5842, device='cuda:0')
benign distance is  tensor(171.5842, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.4690000001600001
mal_loss is 8.818779587745667
mal_entropy is 0.19517822237685323
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([753.1060, 618.4106, 552.7950, 744.8142, 644.6497, 578.4277, 611.2592,
        511.8220, 438.7113, 438.7113, 438.7113, 438.7113, 438.7113, 438.7113,
        438.7113, 438.7113, 438.7113, 438.7113, 438.7113, 438.7113, 777.5500,
        682.1323, 805.0408, 769.2407, 757.2969, 637.2843, 627.5711, 744.3425,
        611.5934, 720.9816, 665.9009, 730.2717, 545.7943, 931.2129, 839.7596,
        663.9721], device='cuda:0')
sorted_norm is   tensor([438.7113, 438.7113, 438.7113, 438.7113, 438.7113, 438.7113, 438.7113,
        438.7113, 438.7113, 438.7113, 438.7113, 438.7113, 511.8220, 545.7943,
        552.7950, 578.4277, 611.2592, 611.5934, 618.4106, 627.5711, 637.2843,
        644.6497, 663.9721, 665.9009, 682.1323, 720.9816, 730.2717, 744.3425,
        744.8142, 753.1060, 757.2969, 769.2407, 777.5500, 805.0408, 839.7596,
        931.2129], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  7, 32,  2,  5,  6, 28,
         1, 26, 25,  4, 35, 30, 21, 29, 31, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 79.46% 

Test Accuracy: 81.15% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0103647410869598
distance x is tensor(169.3995, device='cuda:0')
benign distance is  tensor(169.3995, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1156794130802155
distance x is tensor(130.4550, device='cuda:0')
benign distance is  tensor(130.4550, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4228747338056564
distance x is tensor(127.6536, device='cuda:0')
benign distance is  tensor(127.6536, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9598717838525772
distance x is tensor(179.6461, device='cuda:0')
benign distance is  tensor(179.6461, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9801391176879406
distance x is tensor(158.4378, device='cuda:0')
benign distance is  tensor(158.4378, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3404338229447603
distance x is tensor(134.7550, device='cuda:0')
benign distance is  tensor(134.7550, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.214760571718216
distance x is tensor(148.6287, device='cuda:0')
benign distance is  tensor(148.6287, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.403585895895958
distance x is tensor(140.1289, device='cuda:0')
benign distance is  tensor(140.1289, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.5519420355558395
distance x is tensor(129.7678, device='cuda:0')
benign distance is  tensor(129.7678, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.5376139134168625
distance x is tensor(143.6279, device='cuda:0')
benign distance is  tensor(143.6279, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8811047673225403
distance x is tensor(154.3596, device='cuda:0')
benign distance is  tensor(154.3596, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7913246005773544
distance x is tensor(172.8043, device='cuda:0')
benign distance is  tensor(172.8043, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6647738218307495
distance x is tensor(133.2047, device='cuda:0')
benign distance is  tensor(133.2047, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2267391681671143
distance x is tensor(211.3465, device='cuda:0')
benign distance is  tensor(211.3465, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.8778944686055183
distance x is tensor(171.0145, device='cuda:0')
benign distance is  tensor(171.0145, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3860806077718735
distance x is tensor(146.2672, device='cuda:0')
benign distance is  tensor(146.2672, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.160973146557808
distance x is tensor(152.9726, device='cuda:0')
benign distance is  tensor(152.9726, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.4422793462872505
distance x is tensor(141.4653, device='cuda:0')
benign distance is  tensor(141.4653, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.3492928184568882
distance x is tensor(154.3591, device='cuda:0')
benign distance is  tensor(154.3591, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  5.262418240308762
distance x is tensor(149.4276, device='cuda:0')
benign distance is  tensor(149.4276, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.1874935552477837
distance x is tensor(153.2950, device='cuda:0')
benign distance is  tensor(153.2950, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.416210100054741
distance x is tensor(117.9076, device='cuda:0')
benign distance is  tensor(117.9076, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.4089915417134762
distance x is tensor(111.6391, device='cuda:0')
benign distance is  tensor(111.6391, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0076143331825733
distance x is tensor(156.5606, device='cuda:0')
benign distance is  tensor(156.5606, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.43900000016000007
mal_loss is 8.658052802085876
mal_entropy is 0.19385284604504704
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([735.2930, 566.9174, 545.0345, 773.3019, 667.4947, 551.1493, 623.4837,
        570.9377, 443.2103, 443.2104, 443.2103, 443.2104, 443.2103, 443.2104,
        443.2103, 443.2104, 443.2103, 443.2104, 443.2103, 443.2104, 589.5200,
        748.7751, 573.7832, 680.7098, 832.1842, 423.4523, 684.1288, 759.8433],
       device='cuda:0')
sorted_norm is   tensor([423.4523, 443.2103, 443.2103, 443.2103, 443.2103, 443.2103, 443.2103,
        443.2104, 443.2104, 443.2104, 443.2104, 443.2104, 443.2104, 545.0345,
        551.1493, 566.9174, 570.9377, 573.7832, 589.5200, 623.4837, 667.4947,
        680.7098, 684.1288, 735.2930, 748.7751, 759.8433, 773.3019, 832.1842],
       device='cuda:0')
used idx is  tensor([25, 16, 18, 14, 10,  8, 12, 19, 15, 13,  9, 11, 17,  2,  5,  1,  7, 22,
        20,  6,  4, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 82.25% 

Test Accuracy: 80.53% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9930850677192211
distance x is tensor(173.7891, device='cuda:0')
benign distance is  tensor(173.7891, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3114491552114487
distance x is tensor(138.7254, device='cuda:0')
benign distance is  tensor(138.7254, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.52019627019763
distance x is tensor(137.3692, device='cuda:0')
benign distance is  tensor(137.3692, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6068483926355839
distance x is tensor(179.7144, device='cuda:0')
benign distance is  tensor(179.7144, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2269274964928627
distance x is tensor(156.5701, device='cuda:0')
benign distance is  tensor(156.5701, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5584315657615662
distance x is tensor(130.0471, device='cuda:0')
benign distance is  tensor(130.0471, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.961061529815197
distance x is tensor(151.9167, device='cuda:0')
benign distance is  tensor(151.9167, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6634839475154877
distance x is tensor(116.8401, device='cuda:0')
benign distance is  tensor(116.8401, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.5050219669938087
distance x is tensor(134.2765, device='cuda:0')
benign distance is  tensor(134.2765, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.5858630314469337
distance x is tensor(173.2996, device='cuda:0')
benign distance is  tensor(173.2996, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.0282078087329865
distance x is tensor(135.4550, device='cuda:0')
benign distance is  tensor(135.4550, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.4841550439596176
distance x is tensor(142.9256, device='cuda:0')
benign distance is  tensor(142.9256, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2970133274793625
distance x is tensor(205.7995, device='cuda:0')
benign distance is  tensor(205.7995, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.350012332201004
distance x is tensor(100.4548, device='cuda:0')
benign distance is  tensor(100.4548, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.1053979247808456
distance x is tensor(176.2023, device='cuda:0')
benign distance is  tensor(176.2023, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.6706485599279404
distance x is tensor(164.6552, device='cuda:0')
benign distance is  tensor(164.6552, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.31000000016000007
mal_loss is 16.881857454776764
mal_entropy is 0.1512897713109851
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([742.2828, 589.9356, 565.1931, 756.5198, 652.6448, 538.8266, 644.3800,
        512.5617, 446.5208, 446.5209, 446.5208, 446.5209, 446.5208, 446.5209,
        446.5208, 446.5209, 446.5208, 446.5209, 446.5208, 446.5209],
       device='cuda:0')
sorted_norm is   tensor([446.5208, 446.5208, 446.5208, 446.5208, 446.5208, 446.5208, 446.5209,
        446.5209, 446.5209, 446.5209, 446.5209, 446.5209, 512.5617, 538.8266,
        565.1931, 589.9356, 644.3800, 652.6448, 742.2828, 756.5198],
       device='cuda:0')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  7,  5,  2,  1],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 79.81% 

Test Accuracy: 64.24% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2697144374251366
distance x is tensor(196.5424, device='cuda:0')
benign distance is  tensor(196.5424, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7744982913136482
distance x is tensor(210.6352, device='cuda:0')
benign distance is  tensor(210.6352, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.291600503027439
distance x is tensor(188.9900, device='cuda:0')
benign distance is  tensor(188.9900, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0390363559126854
distance x is tensor(262.7997, device='cuda:0')
benign distance is  tensor(262.7997, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.7748436331748962
distance x is tensor(221.8020, device='cuda:0')
benign distance is  tensor(221.8020, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.617231983691454
distance x is tensor(212.9045, device='cuda:0')
benign distance is  tensor(212.9045, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7111323699355125
distance x is tensor(190.8421, device='cuda:0')
benign distance is  tensor(190.8421, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.923960767686367
distance x is tensor(163.5792, device='cuda:0')
benign distance is  tensor(163.5792, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.12100000016
mal_loss is 72.36821699142456
mal_entropy is 0.04973522818181664
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 808.8789,  806.6739,  711.4914, 1020.5327,  840.8066,  838.4723,
         739.3574,  647.1328,  454.0781,  454.0781,  454.0781,  454.0781,
         454.0781,  454.0781,  454.0781,  454.0781,  454.0781,  454.0781,
         454.0781,  454.0781,  820.2600,  903.6130,  940.6390,  758.8884,
         949.7420,  859.0565,  871.5656,  949.1104,  811.7733,  658.9115,
         837.2213,  813.5016,  796.3756,  818.6800,  852.1865,  902.2930,
         735.2760,  793.7312,  817.5847,  882.1873,  743.3001, 1018.1087,
         874.8049,  788.1005,  664.4915,  820.3601,  674.3460,  734.9686,
         948.1660,  555.4126,  828.9873,  803.3920], device='cuda:0')
sorted_norm is   tensor([ 454.0781,  454.0781,  454.0781,  454.0781,  454.0781,  454.0781,
         454.0781,  454.0781,  454.0781,  454.0781,  454.0781,  454.0781,
         555.4126,  647.1328,  658.9115,  664.4915,  674.3460,  711.4914,
         734.9686,  735.2760,  739.3574,  743.3001,  758.8884,  788.1005,
         793.7312,  796.3756,  803.3920,  806.6739,  808.8789,  811.7733,
         813.5016,  817.5847,  818.6800,  820.2600,  820.3601,  828.9873,
         837.2213,  838.4723,  840.8066,  852.1865,  859.0565,  871.5656,
         874.8049,  882.1873,  902.2930,  903.6130,  940.6390,  948.1660,
         949.1104,  949.7420, 1018.1087, 1020.5327], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 49,  7, 29, 44, 46,  2,
        47, 36,  6, 40, 23, 43, 37, 32, 51,  1,  0, 28, 31, 38, 33, 20, 45, 50,
        30,  5,  4, 34, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 75.37% 

Test Accuracy: 80.64% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9614428542554379
distance x is tensor(155.1211, device='cuda:0')
benign distance is  tensor(155.1211, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6117007732391357
distance x is tensor(136.4323, device='cuda:0')
benign distance is  tensor(136.4323, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.843083068728447
distance x is tensor(122.3943, device='cuda:0')
benign distance is  tensor(122.3943, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6617879644036293
distance x is tensor(165.6684, device='cuda:0')
benign distance is  tensor(165.6684, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8053617477416992
distance x is tensor(133.2957, device='cuda:0')
benign distance is  tensor(133.2957, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5835657380521297
distance x is tensor(139.0105, device='cuda:0')
benign distance is  tensor(139.0105, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3997707590460777
distance x is tensor(124.3833, device='cuda:0')
benign distance is  tensor(124.3833, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0821404457092285
distance x is tensor(111.3447, device='cuda:0')
benign distance is  tensor(111.3447, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7456114143133163
distance x is tensor(116.1723, device='cuda:0')
benign distance is  tensor(116.1723, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3230829425156116
distance x is tensor(170.4900, device='cuda:0')
benign distance is  tensor(170.4900, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.555075876414776
distance x is tensor(92.2717, device='cuda:0')
benign distance is  tensor(92.2717, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.84038907289505
distance x is tensor(130.8797, device='cuda:0')
benign distance is  tensor(130.8797, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6810956448316574
distance x is tensor(164.6073, device='cuda:0')
benign distance is  tensor(164.6073, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.001926761120558
distance x is tensor(76.7645, device='cuda:0')
benign distance is  tensor(76.7645, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5358150973916054
distance x is tensor(159.9380, device='cuda:0')
benign distance is  tensor(159.9380, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.8958470821380615
distance x is tensor(136.7671, device='cuda:0')
benign distance is  tensor(136.7671, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.244588725268841
distance x is tensor(139.7443, device='cuda:0')
benign distance is  tensor(139.7443, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3968383744359016
distance x is tensor(128.0366, device='cuda:0')
benign distance is  tensor(128.0366, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.803711399435997
distance x is tensor(140.6047, device='cuda:0')
benign distance is  tensor(140.6047, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.001484602689743
distance x is tensor(134.1191, device='cuda:0')
benign distance is  tensor(134.1191, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.4398823417723179
distance x is tensor(129.3127, device='cuda:0')
benign distance is  tensor(129.3127, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0932519920170307
distance x is tensor(202.1889, device='cuda:0')
benign distance is  tensor(202.1889, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.6348637752234936
distance x is tensor(172.1382, device='cuda:0')
benign distance is  tensor(172.1382, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.5267227329313755
distance x is tensor(140.8047, device='cuda:0')
benign distance is  tensor(140.8047, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5279330164194107
distance x is tensor(142.5456, device='cuda:0')
benign distance is  tensor(142.5456, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.7798670381307602
distance x is tensor(210.5357, device='cuda:0')
benign distance is  tensor(210.5357, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.9135454520583153
distance x is tensor(146.5990, device='cuda:0')
benign distance is  tensor(146.5990, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.948895290493965
distance x is tensor(123.8987, device='cuda:0')
benign distance is  tensor(123.8987, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.64091307669878
distance x is tensor(150.2852, device='cuda:0')
benign distance is  tensor(150.2852, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8404195122420788
distance x is tensor(158.3646, device='cuda:0')
benign distance is  tensor(158.3646, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8656565397977829
distance x is tensor(132.1475, device='cuda:0')
benign distance is  tensor(132.1475, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.1069010347127914
distance x is tensor(168.6344, device='cuda:0')
benign distance is  tensor(168.6344, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.064679995179176
distance x is tensor(126.3327, device='cuda:0')
benign distance is  tensor(126.3327, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.7375167161226273
distance x is tensor(143.1494, device='cuda:0')
benign distance is  tensor(143.1494, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.812033012509346
distance x is tensor(169.9936, device='cuda:0')
benign distance is  tensor(169.9936, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.5408146530389786
distance x is tensor(103.7867, device='cuda:0')
benign distance is  tensor(103.7867, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.2748856209218502
distance x is tensor(158.6030, device='cuda:0')
benign distance is  tensor(158.6030, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.5538685470819473
distance x is tensor(135.5121, device='cuda:0')
benign distance is  tensor(135.5121, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.8063905835151672
distance x is tensor(130.9086, device='cuda:0')
benign distance is  tensor(130.9086, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8646887913346291
distance x is tensor(165.4890, device='cuda:0')
benign distance is  tensor(165.4890, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.72100000016
mal_loss is 1.6742806360125542
mal_entropy is 0.24932675808668137
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([690.2868, 611.2128, 535.4921, 730.8343, 571.5903, 576.8727, 537.6205,
        492.0150, 421.1699, 421.1699, 421.1699, 421.1699, 421.1699, 421.1699,
        421.1699, 421.1699, 421.1699, 421.1699, 421.1699, 421.1699],
       device='cuda:0')
sorted_norm is   tensor([421.1699, 421.1699, 421.1699, 421.1699, 421.1699, 421.1699, 421.1699,
        421.1699, 421.1699, 421.1699, 421.1699, 421.1699, 492.0150, 535.4921,
        537.6205, 571.5903, 576.8727, 611.2128, 690.2868, 730.8343],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  6,  4],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 81.90% 

Test Accuracy: 78.94% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.5359425470232964
distance x is tensor(167.4683, device='cuda:0')
benign distance is  tensor(167.4683, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0553630590438843
distance x is tensor(144.6550, device='cuda:0')
benign distance is  tensor(144.6550, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2983529046177864
distance x is tensor(133.5428, device='cuda:0')
benign distance is  tensor(133.5428, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0737118422985077
distance x is tensor(190.5015, device='cuda:0')
benign distance is  tensor(190.5015, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7184470780193806
distance x is tensor(206.3811, device='cuda:0')
benign distance is  tensor(206.3811, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.433313075453043
distance x is tensor(147.6794, device='cuda:0')
benign distance is  tensor(147.6794, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9828870370984077
distance x is tensor(157.5167, device='cuda:0')
benign distance is  tensor(157.5167, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6191843003034592
distance x is tensor(126.8129, device='cuda:0')
benign distance is  tensor(126.8129, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.48900000016000006
mal_loss is 8.458350449800491
mal_entropy is 0.2016775943338871
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([738.1754, 632.7270, 570.9512, 823.3761, 892.9993, 614.3982, 659.5807,
        558.6672, 445.6359, 445.6359, 445.6359, 445.6359, 445.6359, 445.6359,
        445.6359, 445.6359, 445.6359, 445.6359, 445.6359, 445.6359, 810.6818,
        761.3582, 817.5818, 805.2203, 809.6521, 682.9026, 674.3607, 811.6435,
        605.0395, 824.9931, 530.9025, 677.3901, 798.7877, 471.2565, 786.6003,
        717.0526], device='cuda:0')
sorted_norm is   tensor([445.6359, 445.6359, 445.6359, 445.6359, 445.6359, 445.6359, 445.6359,
        445.6359, 445.6359, 445.6359, 445.6359, 445.6359, 471.2565, 530.9025,
        558.6672, 570.9512, 605.0395, 614.3982, 632.7270, 659.5807, 674.3607,
        677.3901, 682.9026, 717.0526, 738.1754, 761.3582, 786.6003, 798.7877,
        805.2203, 809.6521, 810.6818, 811.6435, 817.5818, 823.3761, 824.9931,
        892.9993], device='cuda:0')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 30,  7,  2, 28,  5,
         1,  6, 26, 31, 25, 35,  0, 21, 34, 32], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 77.41% 

Test Accuracy: 80.00% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 77.41%
|----0th round Training Accuracy : 96.20%
|----1th round Training Accuracy : 95.90%
|----2th round Training Accuracy : 94.94%
|----3th round Training Accuracy : 94.67%
|----4th round Training Accuracy : 93.56%
|----5th round Training Accuracy : 94.58%
|----6th round Training Accuracy : 91.33%
|----7th round Training Accuracy : 93.01%
|----8th round Training Accuracy : 92.21%
|----9th round Training Accuracy : 93.05%
|----10th round Training Accuracy : 89.87%
|----11th round Training Accuracy : 92.87%
|----12th round Training Accuracy : 91.16%
|----13th round Training Accuracy : 90.01%
|----14th round Training Accuracy : 91.08%
|----15th round Training Accuracy : 91.51%
|----16th round Training Accuracy : 86.80%
|----17th round Training Accuracy : 91.45%
|----18th round Training Accuracy : 89.44%
|----19th round Training Accuracy : 91.30%
|----20th round Training Accuracy : 89.75%
|----21th round Training Accuracy : 88.02%
|----22th round Training Accuracy : 78.82%
|----23th round Training Accuracy : 89.36%
|----24th round Training Accuracy : 88.89%
|----25th round Training Accuracy : 87.77%
|----26th round Training Accuracy : 86.20%
|----27th round Training Accuracy : 86.98%
|----28th round Training Accuracy : 77.01%
|----29th round Training Accuracy : 87.72%
|----30th round Training Accuracy : 89.99%
|----31th round Training Accuracy : 89.22%
|----32th round Training Accuracy : 87.24%
|----33th round Training Accuracy : 85.77%
|----34th round Training Accuracy : 85.17%
|----35th round Training Accuracy : 81.90%
|----36th round Training Accuracy : 86.73%
|----37th round Training Accuracy : 84.47%
|----38th round Training Accuracy : 81.51%
|----39th round Training Accuracy : 81.60%
|----40th round Training Accuracy : 85.11%
|----41th round Training Accuracy : 78.57%
|----42th round Training Accuracy : 82.68%
|----43th round Training Accuracy : 82.18%
|----44th round Training Accuracy : 79.46%
|----45th round Training Accuracy : 82.25%
|----46th round Training Accuracy : 79.81%
|----47th round Training Accuracy : 75.37%
|----48th round Training Accuracy : 81.90%
|----49th round Training Accuracy : 77.41%
|----Final Test Accuracy: 80.00%
|----0th round Final Test Accuracy : 87.13%
|----1th round Final Test Accuracy : 85.36%
|----2th round Final Test Accuracy : 82.08%
|----3th round Final Test Accuracy : 82.95%
|----4th round Final Test Accuracy : 76.04%
|----5th round Final Test Accuracy : 84.88%
|----6th round Final Test Accuracy : 56.81%
|----7th round Final Test Accuracy : 77.64%
|----8th round Final Test Accuracy : 71.44%
|----9th round Final Test Accuracy : 80.40%
|----10th round Final Test Accuracy : 47.86%
|----11th round Final Test Accuracy : 84.07%
|----12th round Final Test Accuracy : 70.91%
|----13th round Final Test Accuracy : 66.58%
|----14th round Final Test Accuracy : 79.14%
|----15th round Final Test Accuracy : 80.89%
|----16th round Final Test Accuracy : 53.19%
|----17th round Final Test Accuracy : 82.74%
|----18th round Final Test Accuracy : 67.57%
|----19th round Final Test Accuracy : 82.33%
|----20th round Final Test Accuracy : 77.71%
|----21th round Final Test Accuracy : 74.99%
|----22th round Final Test Accuracy : 44.68%
|----23th round Final Test Accuracy : 82.92%
|----24th round Final Test Accuracy : 80.73%
|----25th round Final Test Accuracy : 78.05%
|----26th round Final Test Accuracy : 75.32%
|----27th round Final Test Accuracy : 80.00%
|----28th round Final Test Accuracy : 51.42%
|----29th round Final Test Accuracy : 83.59%
|----30th round Final Test Accuracy : 76.92%
|----31th round Final Test Accuracy : 81.25%
|----32th round Final Test Accuracy : 77.60%
|----33th round Final Test Accuracy : 77.19%
|----34th round Final Test Accuracy : 73.13%
|----35th round Final Test Accuracy : 82.28%
|----36th round Final Test Accuracy : 78.32%
|----37th round Final Test Accuracy : 76.14%
|----38th round Final Test Accuracy : 75.47%
|----39th round Final Test Accuracy : 81.77%
|----40th round Final Test Accuracy : 77.52%
|----41th round Final Test Accuracy : 81.57%
|----42th round Final Test Accuracy : 76.44%
|----43th round Final Test Accuracy : 81.03%
|----44th round Final Test Accuracy : 81.15%
|----45th round Final Test Accuracy : 80.53%
|----46th round Final Test Accuracy : 64.24%
|----47th round Final Test Accuracy : 80.64%
|----48th round Final Test Accuracy : 78.94%
|----49th round Final Test Accuracy : 80.00%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3157.1327
