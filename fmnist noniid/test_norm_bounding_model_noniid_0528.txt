
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7852751277387142
distance x is tensor(122.4030, device='cuda:2')
benign distance is  tensor(122.4030, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9148345589637756
distance x is tensor(109.2430, device='cuda:2')
benign distance is  tensor(109.2430, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6249096058309078
distance x is tensor(110.8727, device='cuda:2')
benign distance is  tensor(110.8727, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8466833904385567
distance x is tensor(146.1271, device='cuda:2')
benign distance is  tensor(146.1271, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8007960738614202
distance x is tensor(104.6783, device='cuda:2')
benign distance is  tensor(104.6783, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6133790398016572
distance x is tensor(96.1506, device='cuda:2')
benign distance is  tensor(96.1506, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0104774944484234
distance x is tensor(109.0376, device='cuda:2')
benign distance is  tensor(109.0376, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6967986188828945
distance x is tensor(85.8537, device='cuda:2')
benign distance is  tensor(85.8537, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8145185522735119
distance x is tensor(115.3699, device='cuda:2')
benign distance is  tensor(115.3699, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6865807641297579
distance x is tensor(135.6246, device='cuda:2')
benign distance is  tensor(135.6246, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.102035291492939
distance x is tensor(90.1652, device='cuda:2')
benign distance is  tensor(90.1652, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2901674844324589
distance x is tensor(124.2127, device='cuda:2')
benign distance is  tensor(124.2127, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.009726133197546
distance x is tensor(168.6491, device='cuda:2')
benign distance is  tensor(168.6491, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6150144478306174
distance x is tensor(67.0834, device='cuda:2')
benign distance is  tensor(67.0834, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9580987077206373
distance x is tensor(146.4255, device='cuda:2')
benign distance is  tensor(146.4255, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1719459183514118
distance x is tensor(130.8069, device='cuda:2')
benign distance is  tensor(130.8069, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3725059553980827
distance x is tensor(124.3916, device='cuda:2')
benign distance is  tensor(124.3916, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6038178782910109
distance x is tensor(114.4815, device='cuda:2')
benign distance is  tensor(114.4815, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9447531308978796
distance x is tensor(116.3585, device='cuda:2')
benign distance is  tensor(116.3585, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7527615232393146
distance x is tensor(121.3232, device='cuda:2')
benign distance is  tensor(121.3232, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0163264330476522
distance x is tensor(87.8809, device='cuda:2')
benign distance is  tensor(87.8809, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7392153441905975
distance x is tensor(207.3965, device='cuda:2')
benign distance is  tensor(207.3965, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9991511069238186
distance x is tensor(155.3858, device='cuda:2')
benign distance is  tensor(155.3858, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7655076161026955
distance x is tensor(112.8652, device='cuda:2')
benign distance is  tensor(112.8652, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8648360297083855
distance x is tensor(117.5777, device='cuda:2')
benign distance is  tensor(117.5777, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5759155349805951
distance x is tensor(78.1004, device='cuda:2')
benign distance is  tensor(78.1004, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0301413089036942
distance x is tensor(143.8107, device='cuda:2')
benign distance is  tensor(143.8107, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.297053448855877
distance x is tensor(116.7119, device='cuda:2')
benign distance is  tensor(116.7119, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6366996318101883
distance x is tensor(122.5088, device='cuda:2')
benign distance is  tensor(122.5088, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7219376713037491
distance x is tensor(121.8786, device='cuda:2')
benign distance is  tensor(121.8786, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5467136986553669
distance x is tensor(106.0953, device='cuda:2')
benign distance is  tensor(106.0953, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6638948637992144
distance x is tensor(171.0450, device='cuda:2')
benign distance is  tensor(171.0450, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7745489906519651
distance x is tensor(112.8614, device='cuda:2')
benign distance is  tensor(112.8614, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7027708990499377
distance x is tensor(102.2622, device='cuda:2')
benign distance is  tensor(102.2622, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5676176594570279
distance x is tensor(147.4700, device='cuda:2')
benign distance is  tensor(147.4700, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.451329842209816
distance x is tensor(134.4855, device='cuda:2')
benign distance is  tensor(134.4855, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8887768778949976
distance x is tensor(110.2178, device='cuda:2')
benign distance is  tensor(110.2178, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0084655499085784
distance x is tensor(83.3559, device='cuda:2')
benign distance is  tensor(83.3559, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7520076930522919
distance x is tensor(99.5508, device='cuda:2')
benign distance is  tensor(99.5508, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9335359334945679
distance x is tensor(120.6001, device='cuda:2')
benign distance is  tensor(120.6001, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.109132206067443
distance x is tensor(110.3316, device='cuda:2')
benign distance is  tensor(110.3316, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1843256019055843
distance x is tensor(141.0258, device='cuda:2')
benign distance is  tensor(141.0258, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1036209035664797
distance x is tensor(144.4235, device='cuda:2')
benign distance is  tensor(144.4235, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.069772507995367
distance x is tensor(104.6312, device='cuda:2')
benign distance is  tensor(104.6312, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5237647779285908
distance x is tensor(150.0887, device='cuda:2')
benign distance is  tensor(150.0887, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6791614349931479
distance x is tensor(136.0398, device='cuda:2')
benign distance is  tensor(136.0398, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7029314339160919
distance x is tensor(102.5824, device='cuda:2')
benign distance is  tensor(102.5824, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5661578364670277
distance x is tensor(128.4019, device='cuda:2')
benign distance is  tensor(128.4019, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 559.6788,  501.3505,  511.5671,  686.5284,  480.4999,  430.0528,
         504.9452,  391.2136, 3938.2151, 3997.1646, 3958.3940, 3959.3577,
        3950.8545, 3963.7498, 3976.9009, 3954.8796, 3980.3611, 3957.3032,
        3960.6560, 4008.9255], device='cuda:2')
sorted_norm is   tensor([ 391.2136,  430.0528,  480.4999,  501.3505,  504.9452,  511.5671,
         559.6788,  686.5284, 3938.2151, 3950.8545, 3954.8796, 3957.3032,
        3958.3940, 3959.3577, 3960.6560, 3963.7498, 3976.9009, 3980.3611,
        3997.1646, 4008.9255], device='cuda:2')
used idx is  tensor([ 7,  5,  4,  1,  6,  2,  0,  3,  8, 12, 15, 17, 10, 11, 18, 13],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2317504659295082
distance x is tensor(127.5859, device='cuda:2')
benign distance is  tensor(127.5859, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.617061048746109
distance x is tensor(82.5464, device='cuda:2')
benign distance is  tensor(82.5464, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.717646062374115
distance x is tensor(54.4062, device='cuda:2')
benign distance is  tensor(54.4062, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.583120994269848
distance x is tensor(125.3316, device='cuda:2')
benign distance is  tensor(125.3316, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.6355036795139313
distance x is tensor(83.4692, device='cuda:2')
benign distance is  tensor(83.4692, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9860366731882095
distance x is tensor(61.3709, device='cuda:2')
benign distance is  tensor(61.3709, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.9270856976509094
distance x is tensor(99.7391, device='cuda:2')
benign distance is  tensor(99.7391, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.594176858663559
distance x is tensor(73.1165, device='cuda:2')
benign distance is  tensor(73.1165, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 740.1874,  519.9476,  392.1328,  719.3226,  602.5273,  414.8812,
         611.2043,  487.0280,  476.1942,  644.7559,  638.1298,  646.2999,
         574.8459,  513.5329,  628.7943,  578.0745,  579.0310,  632.9846,
         597.9851,  697.0596, 2031.0598, 2076.6848, 2004.0695, 2036.9552,
        2122.0583, 1985.8645, 2078.1294, 2050.1301], device='cuda:2')
sorted_norm is   tensor([ 392.1328,  414.8812,  476.1942,  487.0280,  513.5329,  519.9476,
         574.8459,  578.0745,  579.0310,  597.9851,  602.5273,  611.2043,
         628.7943,  632.9846,  638.1298,  644.7559,  646.2999,  697.0596,
         719.3226,  740.1874, 1985.8645, 2004.0695, 2031.0598, 2036.9552,
        2050.1301, 2076.6848, 2078.1294, 2122.0583], device='cuda:2')
used idx is  tensor([ 2,  5,  8,  7, 13,  1, 12, 15, 16, 18,  4,  6, 14, 17, 10,  9, 11, 19,
         3,  0, 25, 22], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8943199962377548
distance x is tensor(142.7960, device='cuda:2')
benign distance is  tensor(142.7960, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3243867233395576
distance x is tensor(90.3464, device='cuda:2')
benign distance is  tensor(90.3464, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6991617381572723
distance x is tensor(67.5234, device='cuda:2')
benign distance is  tensor(67.5234, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2807850539684296
distance x is tensor(144.1258, device='cuda:2')
benign distance is  tensor(144.1258, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.328438200056553
distance x is tensor(111.7110, device='cuda:2')
benign distance is  tensor(111.7110, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.94296033680439
distance x is tensor(78.9531, device='cuda:2')
benign distance is  tensor(78.9531, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3302745148539543
distance x is tensor(115.5607, device='cuda:2')
benign distance is  tensor(115.5607, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.172527439892292
distance x is tensor(86.4328, device='cuda:2')
benign distance is  tensor(86.4328, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.6183535009622574
distance x is tensor(100.4948, device='cuda:2')
benign distance is  tensor(100.4948, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.6420526131987572
distance x is tensor(124.0689, device='cuda:2')
benign distance is  tensor(124.0689, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.309949181973934
distance x is tensor(102.3280, device='cuda:2')
benign distance is  tensor(102.3280, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.914890617132187
distance x is tensor(120.7807, device='cuda:2')
benign distance is  tensor(120.7807, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.520827829837799
distance x is tensor(133.4634, device='cuda:2')
benign distance is  tensor(133.4634, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6984204202890396
distance x is tensor(66.5135, device='cuda:2')
benign distance is  tensor(66.5135, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9485576376318932
distance x is tensor(129.7454, device='cuda:2')
benign distance is  tensor(129.7454, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.069374859333038
distance x is tensor(124.9698, device='cuda:2')
benign distance is  tensor(124.9698, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 657.9457,  486.6743,  416.1403,  686.7870,  550.3224,  455.4371,
         585.5931,  471.9220,  668.8434,  786.0900,  689.1751,  746.3149,
         698.7156,  661.1442,  803.2952,  676.0735,  726.5460,  725.6028,
         732.3176,  841.5738, 1878.6658, 1859.1865, 1866.0450, 1880.6027,
        1827.4641, 2044.9807, 1932.1368, 1868.1726], device='cuda:2')
sorted_norm is   tensor([ 416.1403,  455.4371,  471.9220,  486.6743,  550.3224,  585.5931,
         657.9457,  661.1442,  668.8434,  676.0735,  686.7870,  689.1751,
         698.7156,  725.6028,  726.5460,  732.3176,  746.3149,  786.0900,
         803.2952,  841.5738, 1827.4641, 1859.1865, 1866.0450, 1868.1726,
        1878.6658, 1880.6027, 1932.1368, 2044.9807], device='cuda:2')
used idx is  tensor([ 2,  5,  7,  1,  4,  6,  0, 13,  8, 15,  3, 10, 12, 17, 16, 18, 11,  9,
        14, 19, 24, 21], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2355804145336151
distance x is tensor(115.5521, device='cuda:2')
benign distance is  tensor(115.5521, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.876999869942665
distance x is tensor(65.5193, device='cuda:2')
benign distance is  tensor(65.5193, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3409371078014374
distance x is tensor(48.0170, device='cuda:2')
benign distance is  tensor(48.0170, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.400186076760292
distance x is tensor(107.1710, device='cuda:2')
benign distance is  tensor(107.1710, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.047085717320442
distance x is tensor(75.0560, device='cuda:2')
benign distance is  tensor(75.0560, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8860339224338531
distance x is tensor(61.5631, device='cuda:2')
benign distance is  tensor(61.5631, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.561753772199154
distance x is tensor(91.9836, device='cuda:2')
benign distance is  tensor(91.9836, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.000577449798584
distance x is tensor(61.3338, device='cuda:2')
benign distance is  tensor(61.3338, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.212264120578766
distance x is tensor(76.7105, device='cuda:2')
benign distance is  tensor(76.7105, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.195204272866249
distance x is tensor(79.0291, device='cuda:2')
benign distance is  tensor(79.0291, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.827794313430786
distance x is tensor(79.6150, device='cuda:2')
benign distance is  tensor(79.6150, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.4576315209269524
distance x is tensor(92.2121, device='cuda:2')
benign distance is  tensor(92.2121, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.2155822589993477
distance x is tensor(80.5553, device='cuda:2')
benign distance is  tensor(80.5553, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.6383419409394264
distance x is tensor(142.7475, device='cuda:2')
benign distance is  tensor(142.7475, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9909362271428108
distance x is tensor(118.5208, device='cuda:2')
benign distance is  tensor(118.5208, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6018999963998795
distance x is tensor(111.3521, device='cuda:2')
benign distance is  tensor(111.3521, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 720.5710,  495.6748,  396.7790,  692.5052,  547.7614,  456.8512,
         609.5302,  483.6501,  589.8111,  705.1027,  666.8655,  692.0397,
         610.1845,  575.6378,  701.3897,  621.5663,  638.8791,  667.7852,
         649.4556,  731.8504, 1920.7732, 1871.8529, 1951.9218, 1919.0093,
        1925.5687, 1921.0175, 1903.1196, 2012.0258,  596.9139,  672.2164,
         588.1945,  678.1474,  728.9603,  446.3426,  700.6623,  691.0849],
       device='cuda:2')
sorted_norm is   tensor([ 396.7790,  446.3426,  456.8512,  483.6501,  495.6748,  547.7614,
         575.6378,  588.1945,  589.8111,  596.9139,  609.5302,  610.1845,
         621.5663,  638.8791,  649.4556,  666.8655,  667.7852,  672.2164,
         678.1474,  691.0849,  692.0397,  692.5052,  700.6623,  701.3897,
         705.1027,  720.5710,  728.9603,  731.8504, 1871.8529, 1903.1196,
        1919.0093, 1920.7732, 1921.0175, 1925.5687, 1951.9218, 2012.0258],
       device='cuda:2')
used idx is  tensor([ 2, 33,  5,  7,  1,  4, 13, 30,  8, 28,  6, 12, 15, 16, 18, 10, 17, 29,
        31, 35, 11,  3, 34, 14,  9,  0, 32, 19], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 0.56% 

Test Accuracy: 10.35% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0124563314020634
distance x is tensor(150.6777, device='cuda:2')
benign distance is  tensor(150.6777, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.6832550019025803
distance x is tensor(102.4801, device='cuda:2')
benign distance is  tensor(102.4801, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.290743440389633
distance x is tensor(79.8758, device='cuda:2')
benign distance is  tensor(79.8758, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3663174510002136
distance x is tensor(144.0392, device='cuda:2')
benign distance is  tensor(144.0392, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2584430500864983
distance x is tensor(110.8122, device='cuda:2')
benign distance is  tensor(110.8122, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9600310698151588
distance x is tensor(99.0570, device='cuda:2')
benign distance is  tensor(99.0570, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.809169724583626
distance x is tensor(116.6635, device='cuda:2')
benign distance is  tensor(116.6635, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.209383323788643
distance x is tensor(103.7207, device='cuda:2')
benign distance is  tensor(103.7207, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.4798896610736847
distance x is tensor(111.6837, device='cuda:2')
benign distance is  tensor(111.6837, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9715394377708435
distance x is tensor(125.5448, device='cuda:2')
benign distance is  tensor(125.5448, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3919843211770058
distance x is tensor(112.1990, device='cuda:2')
benign distance is  tensor(112.1990, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  5.373597115278244
distance x is tensor(123.3286, device='cuda:2')
benign distance is  tensor(123.3286, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.622600182890892
distance x is tensor(138.5449, device='cuda:2')
benign distance is  tensor(138.5449, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.1520596966147423
distance x is tensor(95.2332, device='cuda:2')
benign distance is  tensor(95.2332, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6974310874938965
distance x is tensor(139.7677, device='cuda:2')
benign distance is  tensor(139.7677, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.353569895029068
distance x is tensor(126.5800, device='cuda:2')
benign distance is  tensor(126.5800, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.1871279031038284
distance x is tensor(137.4430, device='cuda:2')
benign distance is  tensor(137.4430, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.825972817838192
distance x is tensor(88.3693, device='cuda:2')
benign distance is  tensor(88.3693, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.9454162567853928
distance x is tensor(139.1814, device='cuda:2')
benign distance is  tensor(139.1814, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.343687728047371
distance x is tensor(117.1285, device='cuda:2')
benign distance is  tensor(117.1285, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.918911837041378
distance x is tensor(117.2596, device='cuda:2')
benign distance is  tensor(117.2596, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.3872179612517357
distance x is tensor(126.4261, device='cuda:2')
benign distance is  tensor(126.4261, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7632450889796019
distance x is tensor(116.4380, device='cuda:2')
benign distance is  tensor(116.4380, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.1472537219524384
distance x is tensor(149.9776, device='cuda:2')
benign distance is  tensor(149.9776, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 692.9950,  497.7437,  419.3002,  665.6247,  525.7866,  487.1261,
         552.0476,  498.4613,  674.2026,  797.0855,  685.1621,  747.9069,
         655.4875,  679.6129,  768.8020,  653.9639,  734.2230,  697.1041,
         710.5443,  840.8787, 1975.9420, 1965.7860, 2029.2283, 2004.6702,
        1970.0206, 1943.5754, 1959.7336, 1985.2174], device='cuda:2')
sorted_norm is   tensor([ 419.3002,  487.1261,  497.7437,  498.4613,  525.7866,  552.0476,
         653.9639,  655.4875,  665.6247,  674.2026,  679.6129,  685.1621,
         692.9950,  697.1041,  710.5443,  734.2230,  747.9069,  768.8020,
         797.0855,  840.8787, 1943.5754, 1959.7336, 1965.7860, 1970.0206,
        1975.9420, 1985.2174, 2004.6702, 2029.2283], device='cuda:2')
used idx is  tensor([ 2,  5,  1,  7,  4,  6, 15, 12,  3,  8, 13, 10,  0, 17, 18, 16, 11, 14,
         9, 19, 25, 26], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.174818031489849
distance x is tensor(120.8293, device='cuda:2')
benign distance is  tensor(120.8293, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.582209974527359
distance x is tensor(75.4152, device='cuda:2')
benign distance is  tensor(75.4152, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.5785892009735107
distance x is tensor(48.7230, device='cuda:2')
benign distance is  tensor(48.7230, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.299160026013851
distance x is tensor(109.2901, device='cuda:2')
benign distance is  tensor(109.2901, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8546021282672882
distance x is tensor(85.9593, device='cuda:2')
benign distance is  tensor(85.9593, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.133730761706829
distance x is tensor(68.1021, device='cuda:2')
benign distance is  tensor(68.1021, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4390067607164383
distance x is tensor(86.4270, device='cuda:2')
benign distance is  tensor(86.4270, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3765553683042526
distance x is tensor(76.1558, device='cuda:2')
benign distance is  tensor(76.1558, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.4155690371990204
distance x is tensor(93.5021, device='cuda:2')
benign distance is  tensor(93.5021, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.031330354511738
distance x is tensor(75.4703, device='cuda:2')
benign distance is  tensor(75.4703, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.6435161158442497
distance x is tensor(86.7860, device='cuda:2')
benign distance is  tensor(86.7860, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.9373154789209366
distance x is tensor(78.7109, device='cuda:2')
benign distance is  tensor(78.7109, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0999842919409275
distance x is tensor(100.2323, device='cuda:2')
benign distance is  tensor(100.2323, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.7784614711999893
distance x is tensor(86.9140, device='cuda:2')
benign distance is  tensor(86.9140, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.2773057892918587
distance x is tensor(55.0480, device='cuda:2')
benign distance is  tensor(55.0480, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.3163523711264133
distance x is tensor(86.5164, device='cuda:2')
benign distance is  tensor(86.5164, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 746.2824,  519.6137,  392.0774,  689.3109,  573.9952,  457.9702,
         557.1329,  508.3687,  605.1236,  714.6544,  684.3629,  710.7643,
         687.5118,  636.9161,  737.5990,  641.2623,  700.9958,  679.3297,
         681.2654,  793.4124, 1885.2783, 1924.4927, 1934.5052, 1868.5151,
        1959.1238, 1929.7554, 1880.5701, 1909.1921,  553.8344,  578.1451,
         571.6841,  643.7668,  566.8619,  850.9498,  746.9479,  719.6160,
         660.3164,  723.3237,  645.1249,  699.6055,  776.7240,  599.4057,
         769.1801,  719.0360], device='cuda:2')
sorted_norm is   tensor([ 392.0774,  457.9702,  508.3687,  519.6137,  553.8344,  557.1329,
         566.8619,  571.6841,  573.9952,  578.1451,  599.4057,  605.1236,
         636.9161,  641.2623,  643.7668,  645.1249,  660.3164,  679.3297,
         681.2654,  684.3629,  687.5118,  689.3109,  699.6055,  700.9958,
         710.7643,  714.6544,  719.0360,  719.6160,  723.3237,  737.5990,
         746.2824,  746.9479,  769.1801,  776.7240,  793.4124,  850.9498,
        1868.5151, 1880.5701, 1885.2783, 1909.1921, 1924.4927, 1929.7554,
        1934.5052, 1959.1238], device='cuda:2')
used idx is  tensor([ 2,  5,  7,  1, 28,  6, 32, 30,  4, 29, 41,  8, 13, 15, 31, 38, 36, 17,
        18, 10, 12,  3, 39, 16, 11,  9, 43, 35, 37, 14,  0, 34, 42, 40, 19],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 0.36% 

Test Accuracy: 15.41% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8655720688402653
distance x is tensor(137.7385, device='cuda:2')
benign distance is  tensor(137.7385, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.8139880150556564
distance x is tensor(96.8965, device='cuda:2')
benign distance is  tensor(96.8965, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.667025566101074
distance x is tensor(77.1361, device='cuda:2')
benign distance is  tensor(77.1361, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.6248303800821304
distance x is tensor(134.6233, device='cuda:2')
benign distance is  tensor(134.6233, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.6637761667370796
distance x is tensor(104.8665, device='cuda:2')
benign distance is  tensor(104.8665, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9659945517778397
distance x is tensor(93.7696, device='cuda:2')
benign distance is  tensor(93.7696, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.760910913348198
distance x is tensor(112.3167, device='cuda:2')
benign distance is  tensor(112.3167, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9825250208377838
distance x is tensor(98.2253, device='cuda:2')
benign distance is  tensor(98.2253, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.1434867829084396
distance x is tensor(96.7371, device='cuda:2')
benign distance is  tensor(96.7371, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.0129305496811867
distance x is tensor(121.6124, device='cuda:2')
benign distance is  tensor(121.6124, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.076002888381481
distance x is tensor(92.6568, device='cuda:2')
benign distance is  tensor(92.6568, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.8623271584510803
distance x is tensor(110.9186, device='cuda:2')
benign distance is  tensor(110.9186, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.771770477294922
distance x is tensor(145.1718, device='cuda:2')
benign distance is  tensor(145.1718, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8538358062505722
distance x is tensor(84.0952, device='cuda:2')
benign distance is  tensor(84.0952, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9263898879289627
distance x is tensor(127.7863, device='cuda:2')
benign distance is  tensor(127.7863, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  6.42486310005188
distance x is tensor(115.5715, device='cuda:2')
benign distance is  tensor(115.5715, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.3046418875455856
distance x is tensor(104.9861, device='cuda:2')
benign distance is  tensor(104.9861, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.9226126670837402
distance x is tensor(102.2756, device='cuda:2')
benign distance is  tensor(102.2756, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.699635736644268
distance x is tensor(110.9266, device='cuda:2')
benign distance is  tensor(110.9266, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.4890869334340096
distance x is tensor(128.2218, device='cuda:2')
benign distance is  tensor(128.2218, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.0096698477864265
distance x is tensor(106.3225, device='cuda:2')
benign distance is  tensor(106.3225, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2968346923589706
distance x is tensor(189.9267, device='cuda:2')
benign distance is  tensor(189.9267, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.992368645966053
distance x is tensor(147.6536, device='cuda:2')
benign distance is  tensor(147.6536, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3098463863134384
distance x is tensor(118.6205, device='cuda:2')
benign distance is  tensor(118.6205, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.290627121925354
distance x is tensor(92.2442, device='cuda:2')
benign distance is  tensor(92.2442, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.1255389004945755
distance x is tensor(119.9222, device='cuda:2')
benign distance is  tensor(119.9222, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.0615796595811844
distance x is tensor(148.3299, device='cuda:2')
benign distance is  tensor(148.3299, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.125526800751686
distance x is tensor(70.1553, device='cuda:2')
benign distance is  tensor(70.1553, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.5418331176042557
distance x is tensor(137.8920, device='cuda:2')
benign distance is  tensor(137.8920, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.297979138791561
distance x is tensor(110.9890, device='cuda:2')
benign distance is  tensor(110.9890, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.4695686995983124
distance x is tensor(95.3704, device='cuda:2')
benign distance is  tensor(95.3704, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6787456776946783
distance x is tensor(127.0853, device='cuda:2')
benign distance is  tensor(127.0853, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([657.5340, 485.3170, 422.0580, 646.9750, 516.2923, 488.6720, 550.4297,
        487.1403, 665.2355, 765.7329, 674.5842, 708.0303, 653.1686, 662.1540,
        746.1818, 639.1068, 728.7192, 682.1385, 693.6880, 827.1408],
       device='cuda:2')
sorted_norm is   tensor([422.0580, 485.3170, 487.1403, 488.6720, 516.2923, 550.4297, 639.1068,
        646.9750, 653.1686, 657.5340, 662.1540, 665.2355, 674.5842, 682.1385,
        693.6880, 708.0303, 728.7192, 746.1818, 765.7329, 827.1408],
       device='cuda:2')
used idx is  tensor([ 2,  1,  7,  5,  4,  6, 15,  3, 12,  0, 13,  8, 10, 17, 18, 11],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.584761954843998
distance x is tensor(99.5247, device='cuda:2')
benign distance is  tensor(99.5247, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.986817106604576
distance x is tensor(67.2497, device='cuda:2')
benign distance is  tensor(67.2497, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6574341356754303
distance x is tensor(42.6619, device='cuda:2')
benign distance is  tensor(42.6619, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.8208418786525726
distance x is tensor(117.1702, device='cuda:2')
benign distance is  tensor(117.1702, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1772729232907295
distance x is tensor(77.3015, device='cuda:2')
benign distance is  tensor(77.3015, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9894523695111275
distance x is tensor(55.7603, device='cuda:2')
benign distance is  tensor(55.7603, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4854861423373222
distance x is tensor(84.4500, device='cuda:2')
benign distance is  tensor(84.4500, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.5715775340795517
distance x is tensor(44.0694, device='cuda:2')
benign distance is  tensor(44.0694, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([689.8989, 521.3774, 376.5669, 720.2313, 524.1964, 403.7208, 568.5906,
        393.6948, 326.4008, 595.2428, 531.4525, 601.6889, 557.7708, 477.7565,
        608.6338, 542.6243, 543.4371, 576.0375, 563.7879, 687.1146, 716.3212,
        539.8207, 722.1381, 644.6570, 649.7574, 685.0522, 657.3253, 753.6089,
        571.5255, 683.1519, 545.6499, 618.0446, 756.2648, 506.2657, 711.1275,
        653.8347], device='cuda:2')
sorted_norm is   tensor([326.4008, 376.5669, 393.6948, 403.7208, 477.7565, 506.2657, 521.3774,
        524.1964, 531.4525, 539.8207, 542.6243, 543.4371, 545.6499, 557.7708,
        563.7879, 568.5906, 571.5255, 576.0375, 595.2428, 601.6889, 608.6338,
        618.0446, 644.6570, 649.7574, 653.8347, 657.3253, 683.1519, 685.0522,
        687.1146, 689.8989, 711.1275, 716.3212, 720.2313, 722.1381, 753.6089,
        756.2648], device='cuda:2')
used idx is  tensor([ 8,  2,  7,  5, 13, 33,  1,  4, 10, 21, 15, 16, 30, 12, 18,  6, 28, 17,
         9, 11, 14, 31, 23, 24, 35, 26, 29, 25], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 13.46% 

Test Accuracy: 21.69% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1669420823454857
distance x is tensor(145.1572, device='cuda:2')
benign distance is  tensor(145.1572, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1430745273828506
distance x is tensor(100.4151, device='cuda:2')
benign distance is  tensor(100.4151, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3960690423846245
distance x is tensor(79.6794, device='cuda:2')
benign distance is  tensor(79.6794, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.913023255765438
distance x is tensor(133.5285, device='cuda:2')
benign distance is  tensor(133.5285, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.256208024919033
distance x is tensor(112.0118, device='cuda:2')
benign distance is  tensor(112.0118, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8407787531614304
distance x is tensor(99.4683, device='cuda:2')
benign distance is  tensor(99.4683, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2190955132246017
distance x is tensor(114.5579, device='cuda:2')
benign distance is  tensor(114.5579, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.160853423178196
distance x is tensor(95.2725, device='cuda:2')
benign distance is  tensor(95.2725, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.0202035382390022
distance x is tensor(107.4956, device='cuda:2')
benign distance is  tensor(107.4956, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.913719080388546
distance x is tensor(115.9874, device='cuda:2')
benign distance is  tensor(115.9874, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2770561054348946
distance x is tensor(97.5714, device='cuda:2')
benign distance is  tensor(97.5714, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.837188884615898
distance x is tensor(111.6903, device='cuda:2')
benign distance is  tensor(111.6903, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.1909223198890686
distance x is tensor(147.9125, device='cuda:2')
benign distance is  tensor(147.9125, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.3902643620967865
distance x is tensor(88.2011, device='cuda:2')
benign distance is  tensor(88.2011, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7714368104934692
distance x is tensor(137.6749, device='cuda:2')
benign distance is  tensor(137.6749, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.4985461831092834
distance x is tensor(126.9812, device='cuda:2')
benign distance is  tensor(126.9812, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.467531956732273
distance x is tensor(123.4462, device='cuda:2')
benign distance is  tensor(123.4462, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.7308300957083702
distance x is tensor(78.1700, device='cuda:2')
benign distance is  tensor(78.1700, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.461876332759857
distance x is tensor(126.9054, device='cuda:2')
benign distance is  tensor(126.9054, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.893183410167694
distance x is tensor(110.8806, device='cuda:2')
benign distance is  tensor(110.8806, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.7810713574290276
distance x is tensor(113.0971, device='cuda:2')
benign distance is  tensor(113.0971, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.05257585644722
distance x is tensor(117.5748, device='cuda:2')
benign distance is  tensor(117.5748, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9118733890354633
distance x is tensor(117.2238, device='cuda:2')
benign distance is  tensor(117.2238, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.3941622525453568
distance x is tensor(143.2594, device='cuda:2')
benign distance is  tensor(143.2594, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([659.8337, 472.9458, 406.7076, 627.0278, 521.7644, 494.7225, 526.6429,
        457.7860, 710.7116, 831.1888, 725.0894, 761.8560, 688.7300, 728.9312,
        797.3284, 679.8860, 790.8516, 726.6345, 742.3424, 865.6037, 502.3417,
        500.8909, 533.9256, 604.6299, 507.2077, 858.0718, 679.6065, 573.0139],
       device='cuda:2')
sorted_norm is   tensor([406.7076, 457.7860, 472.9458, 494.7225, 500.8909, 502.3417, 507.2077,
        521.7644, 526.6429, 533.9256, 573.0139, 604.6299, 627.0278, 659.8337,
        679.6065, 679.8860, 688.7300, 710.7116, 725.0894, 726.6345, 728.9312,
        742.3424, 761.8560, 790.8516, 797.3284, 831.1888, 858.0718, 865.6037],
       device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5, 21, 20, 24,  4,  6, 22, 27, 23,  3,  0, 26, 15, 12,  8,
        10, 17, 13, 18], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 12.66% 

Test Accuracy: 42.94% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8630458824336529
distance x is tensor(141.3268, device='cuda:2')
benign distance is  tensor(141.3268, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1403282582759857
distance x is tensor(95.6771, device='cuda:2')
benign distance is  tensor(95.6771, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.382308416068554
distance x is tensor(77.5797, device='cuda:2')
benign distance is  tensor(77.5797, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0812558382749557
distance x is tensor(129.1445, device='cuda:2')
benign distance is  tensor(129.1445, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.6045482084155083
distance x is tensor(103.5087, device='cuda:2')
benign distance is  tensor(103.5087, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.755499042570591
distance x is tensor(96.1209, device='cuda:2')
benign distance is  tensor(96.1209, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3656102046370506
distance x is tensor(106.2070, device='cuda:2')
benign distance is  tensor(106.2070, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9416124001145363
distance x is tensor(96.0332, device='cuda:2')
benign distance is  tensor(96.0332, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.129321441054344
distance x is tensor(91.3172, device='cuda:2')
benign distance is  tensor(91.3172, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.935621902346611
distance x is tensor(96.5882, device='cuda:2')
benign distance is  tensor(96.5882, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.9144390672445297
distance x is tensor(104.0313, device='cuda:2')
benign distance is  tensor(104.0313, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.8738584369421005
distance x is tensor(116.0973, device='cuda:2')
benign distance is  tensor(116.0973, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.19581887871027
distance x is tensor(97.0197, device='cuda:2')
benign distance is  tensor(97.0197, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5226265490055084
distance x is tensor(186.3349, device='cuda:2')
benign distance is  tensor(186.3349, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.081338718533516
distance x is tensor(139.7787, device='cuda:2')
benign distance is  tensor(139.7787, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4671036079525948
distance x is tensor(111.0289, device='cuda:2')
benign distance is  tensor(111.0289, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([653.0722, 460.8317, 406.7102, 594.9901, 500.7673, 477.6959, 502.2845,
        469.9185, 738.8890, 848.3127, 746.8099, 823.9865, 703.7537, 764.8412,
        827.6462, 731.8824, 818.6309, 755.7623, 786.1863, 911.6333, 707.3354,
        622.4492, 661.7953, 671.3588, 733.9490, 629.5655, 522.3008, 664.0905,
        511.6269, 566.0412, 442.9395, 520.4200, 681.0176, 417.3926, 642.3264,
        595.4449], device='cuda:2')
sorted_norm is   tensor([406.7102, 417.3926, 442.9395, 460.8317, 469.9185, 477.6959, 500.7673,
        502.2845, 511.6269, 520.4200, 522.3008, 566.0412, 594.9901, 595.4449,
        622.4492, 629.5655, 642.3264, 653.0722, 661.7953, 664.0905, 671.3588,
        681.0176, 703.7537, 707.3354, 731.8824, 733.9490, 738.8890, 746.8099,
        755.7623, 764.8412, 786.1863, 818.6309, 823.9865, 827.6462, 848.3127,
        911.6333], device='cuda:2')
used idx is  tensor([ 2, 33, 30,  1,  7,  5,  4,  6, 28, 31, 26, 29,  3, 35, 21, 25, 34,  0,
        22, 27, 23, 32, 12, 20, 15, 24,  8, 10], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 6.85% 

Test Accuracy: 36.28% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9936094507575035
distance x is tensor(142.9760, device='cuda:2')
benign distance is  tensor(142.9760, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8801807314157486
distance x is tensor(98.6588, device='cuda:2')
benign distance is  tensor(98.6588, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.9201061576604843
distance x is tensor(85.1275, device='cuda:2')
benign distance is  tensor(85.1275, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3361461088061333
distance x is tensor(134.9402, device='cuda:2')
benign distance is  tensor(134.9402, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2604158371686935
distance x is tensor(108.1841, device='cuda:2')
benign distance is  tensor(108.1841, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6064333096146584
distance x is tensor(98.3579, device='cuda:2')
benign distance is  tensor(98.3579, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.41947890073061
distance x is tensor(103.6399, device='cuda:2')
benign distance is  tensor(103.6399, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9017166271805763
distance x is tensor(91.6363, device='cuda:2')
benign distance is  tensor(91.6363, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.241008162498474
distance x is tensor(100.5031, device='cuda:2')
benign distance is  tensor(100.5031, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7095243781805038
distance x is tensor(116.1841, device='cuda:2')
benign distance is  tensor(116.1841, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.547833628952503
distance x is tensor(90.9860, device='cuda:2')
benign distance is  tensor(90.9860, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.574640437960625
distance x is tensor(109.7519, device='cuda:2')
benign distance is  tensor(109.7519, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.1159197092056274
distance x is tensor(140.0332, device='cuda:2')
benign distance is  tensor(140.0332, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8759091272950172
distance x is tensor(80.9354, device='cuda:2')
benign distance is  tensor(80.9354, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.744771733880043
distance x is tensor(130.0100, device='cuda:2')
benign distance is  tensor(130.0100, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.686985820531845
distance x is tensor(113.6776, device='cuda:2')
benign distance is  tensor(113.6776, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.2786099947988987
distance x is tensor(118.4460, device='cuda:2')
benign distance is  tensor(118.4460, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.3279645144939423
distance x is tensor(99.4568, device='cuda:2')
benign distance is  tensor(99.4568, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.1540406942367554
distance x is tensor(111.6774, device='cuda:2')
benign distance is  tensor(111.6774, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  5.257194504141808
distance x is tensor(112.4888, device='cuda:2')
benign distance is  tensor(112.4888, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9469207413494587
distance x is tensor(120.8964, device='cuda:2')
benign distance is  tensor(120.8964, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.5486285910010338
distance x is tensor(93.5875, device='cuda:2')
benign distance is  tensor(93.5875, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.882409356534481
distance x is tensor(95.2722, device='cuda:2')
benign distance is  tensor(95.2722, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.043666161596775
distance x is tensor(113.9563, device='cuda:2')
benign distance is  tensor(113.9563, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([636.2910, 448.7300, 412.7072, 607.6492, 507.7856, 464.6370, 470.4922,
        433.1516, 809.1060, 906.4435, 810.7365, 838.4523, 778.4383, 834.2841,
        881.1649, 773.1534, 860.7392, 805.3831, 854.4312, 961.0205],
       device='cuda:2')
sorted_norm is   tensor([412.7072, 433.1516, 448.7300, 464.6370, 470.4922, 507.7856, 607.6492,
        636.2910, 773.1534, 778.4383, 805.3831, 809.1060, 810.7365, 834.2841,
        838.4523, 854.4312, 860.7392, 881.1649, 906.4435, 961.0205],
       device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5,  6,  4,  3,  0, 15, 12, 17,  8, 10, 13, 11, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.55685593187809
distance x is tensor(98.0266, device='cuda:2')
benign distance is  tensor(98.0266, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.610403925180435
distance x is tensor(66.7525, device='cuda:2')
benign distance is  tensor(66.7525, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.833252727985382
distance x is tensor(41.5964, device='cuda:2')
benign distance is  tensor(41.5964, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.8745352178812027
distance x is tensor(112.6916, device='cuda:2')
benign distance is  tensor(112.6916, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.2554570883512497
distance x is tensor(51.5500, device='cuda:2')
benign distance is  tensor(51.5500, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.372768983244896
distance x is tensor(44.1276, device='cuda:2')
benign distance is  tensor(44.1276, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.683577239513397
distance x is tensor(75.6462, device='cuda:2')
benign distance is  tensor(75.6462, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6050070077180862
distance x is tensor(23.1908, device='cuda:2')
benign distance is  tensor(23.1908, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([653.1684, 513.3301, 381.2282, 706.2885, 429.3151, 367.2837, 534.3962,
        287.6197, 304.6085, 610.6232, 368.0271, 626.0725, 565.3110, 476.5369,
        574.8911, 470.8664, 471.5747, 524.6015, 517.1839, 647.1462, 543.7448,
        674.2847, 780.4441, 476.4868, 735.3121, 619.8860, 569.7381, 704.0489,
        693.2308, 514.2975, 694.8314, 642.3071, 645.5708, 661.0919, 668.9286,
        765.6791, 570.5816, 610.6240, 621.9646, 691.7713, 603.6697, 945.6173,
        763.7805, 667.2996, 632.8124, 698.4901, 577.9193, 657.6388, 775.0450,
        543.0466, 750.0794, 681.5751], device='cuda:2')
sorted_norm is   tensor([287.6197, 304.6085, 367.2837, 368.0271, 381.2282, 429.3151, 470.8664,
        471.5747, 476.4868, 476.5369, 513.3301, 514.2975, 517.1839, 524.6015,
        534.3962, 543.0466, 543.7448, 565.3110, 569.7381, 570.5816, 574.8911,
        577.9193, 603.6697, 610.6232, 610.6240, 619.8860, 621.9646, 626.0725,
        632.8124, 642.3071, 645.5708, 647.1462, 653.1684, 657.6388, 661.0919,
        667.2996, 668.9286, 674.2847, 681.5751, 691.7713, 693.2308, 694.8314,
        698.4901, 704.0489, 706.2885, 735.3121, 750.0794, 763.7805, 765.6791,
        775.0450, 780.4441, 945.6173], device='cuda:2')
used idx is  tensor([ 7,  8,  5, 10,  2,  4, 15, 16, 23, 13,  1, 29, 18, 17,  6, 49, 20, 12,
        26, 36, 14, 46, 40,  9, 37, 25, 38, 11, 44, 31, 32, 19,  0, 47, 33, 43,
        34, 21, 51, 39, 28], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 21.27% 

Test Accuracy: 52.17% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8283466584980488
distance x is tensor(134.8009, device='cuda:2')
benign distance is  tensor(134.8009, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1400974467396736
distance x is tensor(94.0721, device='cuda:2')
benign distance is  tensor(94.0721, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2375835850834846
distance x is tensor(78.1006, device='cuda:2')
benign distance is  tensor(78.1006, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0019706785678864
distance x is tensor(129.7778, device='cuda:2')
benign distance is  tensor(129.7778, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.8555380776524544
distance x is tensor(101.3778, device='cuda:2')
benign distance is  tensor(101.3778, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5275084376335144
distance x is tensor(94.6632, device='cuda:2')
benign distance is  tensor(94.6632, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7556474059820175
distance x is tensor(100.1200, device='cuda:2')
benign distance is  tensor(100.1200, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2541042417287827
distance x is tensor(89.7314, device='cuda:2')
benign distance is  tensor(89.7314, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3687929287552834
distance x is tensor(94.0529, device='cuda:2')
benign distance is  tensor(94.0529, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.1283994242548943
distance x is tensor(118.7545, device='cuda:2')
benign distance is  tensor(118.7545, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.348470114171505
distance x is tensor(88.1243, device='cuda:2')
benign distance is  tensor(88.1243, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.9322112798690796
distance x is tensor(105.6793, device='cuda:2')
benign distance is  tensor(105.6793, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.0407916232943535
distance x is tensor(134.7995, device='cuda:2')
benign distance is  tensor(134.7995, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9828147143125534
distance x is tensor(77.8977, device='cuda:2')
benign distance is  tensor(77.8977, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6888591647148132
distance x is tensor(137.6950, device='cuda:2')
benign distance is  tensor(137.6950, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.7102283388376236
distance x is tensor(108.2819, device='cuda:2')
benign distance is  tensor(108.2819, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.208639368414879
distance x is tensor(88.3434, device='cuda:2')
benign distance is  tensor(88.3434, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.7413269057869911
distance x is tensor(97.7374, device='cuda:2')
benign distance is  tensor(97.7374, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.9990622475743294
distance x is tensor(105.4995, device='cuda:2')
benign distance is  tensor(105.4995, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.381031669676304
distance x is tensor(116.4706, device='cuda:2')
benign distance is  tensor(116.4706, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.599126122891903
distance x is tensor(99.1698, device='cuda:2')
benign distance is  tensor(99.1698, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4836228787899017
distance x is tensor(187.4480, device='cuda:2')
benign distance is  tensor(187.4480, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.959789752960205
distance x is tensor(139.3229, device='cuda:2')
benign distance is  tensor(139.3229, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.1974601671099663
distance x is tensor(109.4226, device='cuda:2')
benign distance is  tensor(109.4226, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.0302016362547874
distance x is tensor(120.2146, device='cuda:2')
benign distance is  tensor(120.2146, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.8487517312169075
distance x is tensor(79.6247, device='cuda:2')
benign distance is  tensor(79.6247, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.719273552298546
distance x is tensor(119.1510, device='cuda:2')
benign distance is  tensor(119.1510, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.18349027633667
distance x is tensor(104.6544, device='cuda:2')
benign distance is  tensor(104.6544, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.9112738445401192
distance x is tensor(108.1394, device='cuda:2')
benign distance is  tensor(108.1394, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.0377501398324966
distance x is tensor(113.2433, device='cuda:2')
benign distance is  tensor(113.2433, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8820408880710602
distance x is tensor(105.4370, device='cuda:2')
benign distance is  tensor(105.4370, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  4.064108490943909
distance x is tensor(142.6061, device='cuda:2')
benign distance is  tensor(142.6061, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.6789309233427048
distance x is tensor(83.5105, device='cuda:2')
benign distance is  tensor(83.5105, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.8720581233501434
distance x is tensor(119.7772, device='cuda:2')
benign distance is  tensor(119.7772, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.4034168794751167
distance x is tensor(145.1911, device='cuda:2')
benign distance is  tensor(145.1911, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.2868463546037674
distance x is tensor(76.3632, device='cuda:2')
benign distance is  tensor(76.3632, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.4651164710521698
distance x is tensor(131.4378, device='cuda:2')
benign distance is  tensor(131.4378, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.809920571744442
distance x is tensor(116.2282, device='cuda:2')
benign distance is  tensor(116.2282, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.6494952887296677
distance x is tensor(90.6171, device='cuda:2')
benign distance is  tensor(90.6171, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7506596725434065
distance x is tensor(131.1533, device='cuda:2')
benign distance is  tensor(131.1533, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([617.5026, 443.6389, 398.0648, 596.2388, 483.1235, 467.9486, 466.6853,
        427.1534, 813.5117, 895.1089, 806.8688, 850.2088, 774.9334, 816.1860,
        883.0932, 767.8218, 869.4031, 813.0561, 845.1406, 954.9078],
       device='cuda:2')
sorted_norm is   tensor([398.0648, 427.1534, 443.6389, 466.6853, 467.9486, 483.1235, 596.2388,
        617.5026, 767.8218, 774.9334, 806.8688, 813.0561, 813.5117, 816.1860,
        845.1406, 850.2088, 869.4031, 883.0932, 895.1089, 954.9078],
       device='cuda:2')
used idx is  tensor([ 2,  7,  1,  6,  5,  4,  3,  0, 15, 12, 10, 17,  8, 13, 18, 11],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.4522770270705223
distance x is tensor(106.8588, device='cuda:2')
benign distance is  tensor(106.8588, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.508682072162628
distance x is tensor(58.4299, device='cuda:2')
benign distance is  tensor(58.4299, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8958064168691635
distance x is tensor(49.3514, device='cuda:2')
benign distance is  tensor(49.3514, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.333744026720524
distance x is tensor(119.3027, device='cuda:2')
benign distance is  tensor(119.3027, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4164351522922516
distance x is tensor(75.3831, device='cuda:2')
benign distance is  tensor(75.3831, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.5646692663431168
distance x is tensor(52.9286, device='cuda:2')
benign distance is  tensor(52.9286, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.3694358319044113
distance x is tensor(81.4865, device='cuda:2')
benign distance is  tensor(81.4865, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.8865205496549606
distance x is tensor(33.8609, device='cuda:2')
benign distance is  tensor(33.8609, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([647.2895, 493.9812, 393.9697, 699.2384, 535.8214, 394.9764, 560.2932,
        336.0789, 335.1089, 582.1218, 386.3700, 581.5182, 564.1815, 482.4329,
        589.9631, 563.6566, 494.4833, 584.5677, 563.5923, 667.1442, 619.0190,
        719.8669, 576.8446, 653.6847, 771.9139, 548.5146, 792.8725, 673.6185],
       device='cuda:2')
sorted_norm is   tensor([335.1089, 336.0789, 386.3700, 393.9697, 394.9764, 482.4329, 493.9812,
        494.4833, 535.8214, 548.5146, 560.2932, 563.5923, 563.6566, 564.1815,
        576.8446, 581.5182, 582.1218, 584.5677, 589.9631, 619.0190, 647.2895,
        653.6847, 667.1442, 673.6185, 699.2384, 719.8669, 771.9139, 792.8725],
       device='cuda:2')
used idx is  tensor([ 8,  7, 10,  2,  5, 13,  1, 16,  4, 25,  6, 18, 15, 12, 22, 11,  9, 17,
        14, 20,  0, 23], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 13.55% 

Test Accuracy: 10.00% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9613500274717808
distance x is tensor(146.9592, device='cuda:2')
benign distance is  tensor(146.9592, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.413474902510643
distance x is tensor(103.0322, device='cuda:2')
benign distance is  tensor(103.0322, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8208659440279007
distance x is tensor(76.9965, device='cuda:2')
benign distance is  tensor(76.9965, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3423770740628242
distance x is tensor(132.4468, device='cuda:2')
benign distance is  tensor(132.4468, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2893520146608353
distance x is tensor(106.8694, device='cuda:2')
benign distance is  tensor(106.8694, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7310214936733246
distance x is tensor(99.4388, device='cuda:2')
benign distance is  tensor(99.4388, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4799559488892555
distance x is tensor(111.1919, device='cuda:2')
benign distance is  tensor(111.1919, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.098489783704281
distance x is tensor(97.5367, device='cuda:2')
benign distance is  tensor(97.5367, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.107125647366047
distance x is tensor(102.7938, device='cuda:2')
benign distance is  tensor(102.7938, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.676362194120884
distance x is tensor(114.6111, device='cuda:2')
benign distance is  tensor(114.6111, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.9929480329155922
distance x is tensor(97.4698, device='cuda:2')
benign distance is  tensor(97.4698, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.100593417882919
distance x is tensor(120.6129, device='cuda:2')
benign distance is  tensor(120.6129, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.8797193318605423
distance x is tensor(136.7633, device='cuda:2')
benign distance is  tensor(136.7633, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.684537649154663
distance x is tensor(94.3538, device='cuda:2')
benign distance is  tensor(94.3538, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9153426960110664
distance x is tensor(127.5820, device='cuda:2')
benign distance is  tensor(127.5820, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.251546859741211
distance x is tensor(122.6869, device='cuda:2')
benign distance is  tensor(122.6869, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([687.9765, 505.6454, 433.7980, 653.3848, 537.8815, 506.3535, 553.5632,
        493.6136, 615.7654, 710.6071, 641.8171, 666.6926, 597.8333, 608.0009,
        705.4539, 602.5396, 678.2510, 646.1448, 642.8389, 786.7771, 667.7740,
        582.2005, 646.8320, 626.9023, 675.9268, 571.2261, 560.2765, 661.2567,
        535.2950, 581.4930, 604.8901, 651.2863, 577.6973, 935.5057, 735.3940,
        637.5443], device='cuda:2')
sorted_norm is   tensor([433.7980, 493.6136, 505.6454, 506.3535, 535.2950, 537.8815, 553.5632,
        560.2765, 571.2261, 577.6973, 581.4930, 582.2005, 597.8333, 602.5396,
        604.8901, 608.0009, 615.7654, 626.9023, 637.5443, 641.8171, 642.8389,
        646.1448, 646.8320, 651.2863, 653.3848, 661.2567, 666.6926, 667.7740,
        675.9268, 678.2510, 687.9765, 705.4539, 710.6071, 735.3940, 786.7771,
        935.5057], device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5, 28,  4,  6, 26, 25, 32, 29, 21, 12, 15, 30, 13,  8, 23,
        35, 10, 18, 17, 22, 31,  3, 27, 11, 20], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 12.19% 

Test Accuracy: 43.55% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9401116147637367
distance x is tensor(140.4548, device='cuda:2')
benign distance is  tensor(140.4548, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4442578107118607
distance x is tensor(99.8693, device='cuda:2')
benign distance is  tensor(99.8693, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8808519393205643
distance x is tensor(86.3613, device='cuda:2')
benign distance is  tensor(86.3613, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2839066684246063
distance x is tensor(134.4940, device='cuda:2')
benign distance is  tensor(134.4940, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6729886829853058
distance x is tensor(104.9871, device='cuda:2')
benign distance is  tensor(104.9871, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4741305485367775
distance x is tensor(96.2840, device='cuda:2')
benign distance is  tensor(96.2840, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2714337557554245
distance x is tensor(103.4969, device='cuda:2')
benign distance is  tensor(103.4969, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.91899473965168
distance x is tensor(98.4880, device='cuda:2')
benign distance is  tensor(98.4880, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.7082121074199677
distance x is tensor(95.2278, device='cuda:2')
benign distance is  tensor(95.2278, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1385918334126472
distance x is tensor(99.7871, device='cuda:2')
benign distance is  tensor(99.7871, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.7391477078199387
distance x is tensor(110.0062, device='cuda:2')
benign distance is  tensor(110.0062, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.9523152709007263
distance x is tensor(113.7060, device='cuda:2')
benign distance is  tensor(113.7060, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.3934040516614914
distance x is tensor(101.1804, device='cuda:2')
benign distance is  tensor(101.1804, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4172069430351257
distance x is tensor(192.1972, device='cuda:2')
benign distance is  tensor(192.1972, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.393234111368656
distance x is tensor(142.0829, device='cuda:2')
benign distance is  tensor(142.0829, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.9116721004247665
distance x is tensor(112.5396, device='cuda:2')
benign distance is  tensor(112.5396, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1169643327593803
distance x is tensor(117.4115, device='cuda:2')
benign distance is  tensor(117.4115, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0932989045977592
distance x is tensor(95.2845, device='cuda:2')
benign distance is  tensor(95.2845, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.5455425158143044
distance x is tensor(115.9638, device='cuda:2')
benign distance is  tensor(115.9638, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.487218752503395
distance x is tensor(111.7379, device='cuda:2')
benign distance is  tensor(111.7379, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0489225052297115
distance x is tensor(114.5718, device='cuda:2')
benign distance is  tensor(114.5718, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9346328154206276
distance x is tensor(91.2757, device='cuda:2')
benign distance is  tensor(91.2757, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.8979286327958107
distance x is tensor(91.8585, device='cuda:2')
benign distance is  tensor(91.8585, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8829141929745674
distance x is tensor(112.8899, device='cuda:2')
benign distance is  tensor(112.8899, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([621.0688, 455.5709, 422.6793, 595.5133, 476.1982, 464.7494, 465.8743,
        448.7058, 790.0306, 909.2722, 807.1043, 845.9171, 769.8661, 816.9927,
        886.2916, 772.7128, 864.7573, 840.7800, 845.2108, 982.9742, 556.6703,
        442.6316, 559.2762, 499.6963, 529.2166, 543.7740, 537.5250, 661.0191,
        473.9067, 540.7512, 433.9690, 536.4928, 614.3292, 430.8837, 579.3128,
        549.3001], device='cuda:2')
sorted_norm is   tensor([422.6793, 430.8837, 433.9690, 442.6316, 448.7058, 455.5709, 464.7494,
        465.8743, 473.9067, 476.1982, 499.6963, 529.2166, 536.4928, 537.5250,
        540.7512, 543.7740, 549.3001, 556.6703, 559.2762, 579.3128, 595.5133,
        614.3292, 621.0688, 661.0191, 769.8661, 772.7128, 790.0306, 807.1043,
        816.9927, 840.7800, 845.2108, 845.9171, 864.7573, 886.2916, 909.2722,
        982.9742], device='cuda:2')
used idx is  tensor([ 2, 33, 30, 21,  7,  1,  5,  6, 28,  4, 23, 24, 31, 26, 29, 25, 35, 20,
        22, 34,  3, 32,  0, 27, 12, 15,  8, 10], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 34.90% 

Test Accuracy: 63.55% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.015823144465685
distance x is tensor(120.3002, device='cuda:2')
benign distance is  tensor(120.3002, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.35170017182827
distance x is tensor(89.5386, device='cuda:2')
benign distance is  tensor(89.5386, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.005081221461296
distance x is tensor(76.4911, device='cuda:2')
benign distance is  tensor(76.4911, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3205157220363617
distance x is tensor(121.6972, device='cuda:2')
benign distance is  tensor(121.6972, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2846710681915283
distance x is tensor(88.0660, device='cuda:2')
benign distance is  tensor(88.0660, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7739519029855728
distance x is tensor(91.2513, device='cuda:2')
benign distance is  tensor(91.2513, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3762226924300194
distance x is tensor(92.1648, device='cuda:2')
benign distance is  tensor(92.1648, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.035801336169243
distance x is tensor(79.9453, device='cuda:2')
benign distance is  tensor(79.9453, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.8020620197057724
distance x is tensor(89.5749, device='cuda:2')
benign distance is  tensor(89.5749, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.973570577800274
distance x is tensor(110.6266, device='cuda:2')
benign distance is  tensor(110.6266, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.80210742354393
distance x is tensor(78.2787, device='cuda:2')
benign distance is  tensor(78.2787, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.9536114782094955
distance x is tensor(94.1636, device='cuda:2')
benign distance is  tensor(94.1636, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.593896947801113
distance x is tensor(121.8168, device='cuda:2')
benign distance is  tensor(121.8168, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6750669851899147
distance x is tensor(65.6153, device='cuda:2')
benign distance is  tensor(65.6153, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2240013480186462
distance x is tensor(115.6752, device='cuda:2')
benign distance is  tensor(115.6752, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.5394087433815
distance x is tensor(102.8862, device='cuda:2')
benign distance is  tensor(102.8862, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.011223204433918
distance x is tensor(107.9510, device='cuda:2')
benign distance is  tensor(107.9510, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.7328521087765694
distance x is tensor(87.1834, device='cuda:2')
benign distance is  tensor(87.1834, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.8695515990257263
distance x is tensor(109.6366, device='cuda:2')
benign distance is  tensor(109.6366, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.622166499495506
distance x is tensor(93.4914, device='cuda:2')
benign distance is  tensor(93.4914, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6981206759810448
distance x is tensor(99.8085, device='cuda:2')
benign distance is  tensor(99.8085, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8727443367242813
distance x is tensor(106.1816, device='cuda:2')
benign distance is  tensor(106.1816, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7722708154469728
distance x is tensor(98.8312, device='cuda:2')
benign distance is  tensor(98.8312, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.8957980573177338
distance x is tensor(131.1146, device='cuda:2')
benign distance is  tensor(131.1146, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 550.4403,  421.4907,  387.1787,  552.5171,  422.7869,  432.4930,
         422.2418,  379.0391,  958.1360, 1056.8073,  955.0621,  974.0825,
         951.0004,  981.0305, 1027.4736,  925.4399, 1021.6785,  960.7025,
         989.8882, 1091.8186], device='cuda:2')
sorted_norm is   tensor([ 379.0391,  387.1787,  421.4907,  422.2418,  422.7869,  432.4930,
         550.4403,  552.5171,  925.4399,  951.0004,  955.0621,  958.1360,
         960.7025,  974.0825,  981.0305,  989.8882, 1021.6785, 1027.4736,
        1056.8073, 1091.8186], device='cuda:2')
used idx is  tensor([ 7,  2,  1,  6,  4,  5,  0,  3, 15, 12, 10,  8, 17, 11, 13, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.5074537247419357
distance x is tensor(94.8146, device='cuda:2')
benign distance is  tensor(94.8146, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.029910519719124
distance x is tensor(72.0309, device='cuda:2')
benign distance is  tensor(72.0309, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.791368916630745
distance x is tensor(38.8689, device='cuda:2')
benign distance is  tensor(38.8689, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.9045484513044357
distance x is tensor(102.8112, device='cuda:2')
benign distance is  tensor(102.8112, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9012415409088135
distance x is tensor(66.9646, device='cuda:2')
benign distance is  tensor(66.9646, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.314321182668209
distance x is tensor(40.6847, device='cuda:2')
benign distance is  tensor(40.6847, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  4.1681937873363495
distance x is tensor(80.2389, device='cuda:2')
benign distance is  tensor(80.2389, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.617379352450371
distance x is tensor(44.4586, device='cuda:2')
benign distance is  tensor(44.4586, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([630.8491, 528.7968, 352.4714, 689.3358, 522.6241, 340.0612, 596.2435,
        408.6372, 307.7993, 605.8087, 456.9707, 568.1229, 535.7815, 504.9648,
        598.3786, 576.4202, 486.1669, 582.5817, 543.6839, 657.4411, 565.4670,
        727.1796, 811.7045, 547.4279, 768.2711, 698.1766, 602.3596, 768.4897,
        604.6562, 623.9333, 661.3183, 683.0067, 623.9879, 990.4998, 785.4532,
        697.6103, 668.1787, 749.3090, 608.6818, 668.4871, 785.1371, 569.4986,
        774.6231, 700.3787], device='cuda:2')
sorted_norm is   tensor([307.7993, 340.0612, 352.4714, 408.6372, 456.9707, 486.1669, 504.9648,
        522.6241, 528.7968, 535.7815, 543.6839, 547.4279, 565.4670, 568.1229,
        569.4986, 576.4202, 582.5817, 596.2435, 598.3786, 602.3596, 604.6562,
        605.8087, 608.6818, 623.9333, 623.9879, 630.8491, 657.4411, 661.3183,
        668.1787, 668.4871, 683.0067, 689.3358, 697.6103, 698.1766, 700.3787,
        727.1796, 749.3090, 768.2711, 768.4897, 774.6231, 785.1371, 785.4532,
        811.7045, 990.4998], device='cuda:2')
used idx is  tensor([ 8,  5,  2,  7, 10, 16, 13,  4,  1, 12, 18, 23, 20, 11, 41, 15, 17,  6,
        14, 26, 28,  9, 38, 29, 32,  0, 19, 30, 36, 39, 31,  3, 35, 25, 43],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 14.24% 

Test Accuracy: 43.69% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9687509424984455
distance x is tensor(141.5331, device='cuda:2')
benign distance is  tensor(141.5331, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.621995523571968
distance x is tensor(106.1784, device='cuda:2')
benign distance is  tensor(106.1784, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.0923616737127304
distance x is tensor(82.8248, device='cuda:2')
benign distance is  tensor(82.8248, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.643742084503174
distance x is tensor(136.4638, device='cuda:2')
benign distance is  tensor(136.4638, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.297151543200016
distance x is tensor(105.9790, device='cuda:2')
benign distance is  tensor(105.9790, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.573506273329258
distance x is tensor(99.6841, device='cuda:2')
benign distance is  tensor(99.6841, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9333393424749374
distance x is tensor(108.2703, device='cuda:2')
benign distance is  tensor(108.2703, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2429942935705185
distance x is tensor(94.9742, device='cuda:2')
benign distance is  tensor(94.9742, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.965797245502472
distance x is tensor(103.7047, device='cuda:2')
benign distance is  tensor(103.7047, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9159725829958916
distance x is tensor(116.8306, device='cuda:2')
benign distance is  tensor(116.8306, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7016416564583778
distance x is tensor(90.8324, device='cuda:2')
benign distance is  tensor(90.8324, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.752705410122871
distance x is tensor(114.1966, device='cuda:2')
benign distance is  tensor(114.1966, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.401956908404827
distance x is tensor(131.7462, device='cuda:2')
benign distance is  tensor(131.7462, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.600162960588932
distance x is tensor(83.3177, device='cuda:2')
benign distance is  tensor(83.3177, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.163404606282711
distance x is tensor(127.6203, device='cuda:2')
benign distance is  tensor(127.6203, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.081641346216202
distance x is tensor(116.1796, device='cuda:2')
benign distance is  tensor(116.1796, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.021665930747986
distance x is tensor(94.0602, device='cuda:2')
benign distance is  tensor(94.0602, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.26176917552948
distance x is tensor(100.7029, device='cuda:2')
benign distance is  tensor(100.7029, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.0963336378335953
distance x is tensor(106.5547, device='cuda:2')
benign distance is  tensor(106.5547, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.9081264585256577
distance x is tensor(126.2489, device='cuda:2')
benign distance is  tensor(126.2489, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.614891305565834
distance x is tensor(101.8751, device='cuda:2')
benign distance is  tensor(101.8751, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3275820314884186
distance x is tensor(194.4258, device='cuda:2')
benign distance is  tensor(194.4258, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.6275107190012932
distance x is tensor(143.4872, device='cuda:2')
benign distance is  tensor(143.4872, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.9739534631371498
distance x is tensor(116.0071, device='cuda:2')
benign distance is  tensor(116.0071, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.9241524636745453
distance x is tensor(89.9684, device='cuda:2')
benign distance is  tensor(89.9684, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.6120425015687943
distance x is tensor(128.3190, device='cuda:2')
benign distance is  tensor(128.3190, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.4753610640764236
distance x is tensor(147.9753, device='cuda:2')
benign distance is  tensor(147.9753, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.1350194439291954
distance x is tensor(80.3698, device='cuda:2')
benign distance is  tensor(80.3698, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.4969188868999481
distance x is tensor(139.6796, device='cuda:2')
benign distance is  tensor(139.6796, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.2230664640665054
distance x is tensor(117.7443, device='cuda:2')
benign distance is  tensor(117.7443, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.3452622145414352
distance x is tensor(103.9245, device='cuda:2')
benign distance is  tensor(103.9245, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6691191177815199
distance x is tensor(137.1640, device='cuda:2')
benign distance is  tensor(137.1640, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([632.3301, 483.5987, 406.9239, 613.0354, 487.9197, 468.8168, 481.9921,
        442.9401, 776.2823, 893.8055, 804.5643, 825.8518, 760.3109, 806.7085,
        872.8032, 753.8691, 866.9463, 793.6671, 825.0763, 952.4738],
       device='cuda:2')
sorted_norm is   tensor([406.9239, 442.9401, 468.8168, 481.9921, 483.5987, 487.9197, 613.0354,
        632.3301, 753.8691, 760.3109, 776.2823, 793.6671, 804.5643, 806.7085,
        825.0763, 825.8518, 866.9463, 872.8032, 893.8055, 952.4738],
       device='cuda:2')
used idx is  tensor([ 2,  7,  5,  6,  1,  4,  3,  0, 15, 12,  8, 17, 10, 13, 18, 11],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.524081900715828
distance x is tensor(100.9879, device='cuda:2')
benign distance is  tensor(100.9879, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.6209916174411774
distance x is tensor(60.4760, device='cuda:2')
benign distance is  tensor(60.4760, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.9397910982370377
distance x is tensor(37.9802, device='cuda:2')
benign distance is  tensor(37.9802, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3915172144770622
distance x is tensor(93.3244, device='cuda:2')
benign distance is  tensor(93.3244, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.722540408372879
distance x is tensor(69.2941, device='cuda:2')
benign distance is  tensor(69.2941, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.0720290765166283
distance x is tensor(30.0010, device='cuda:2')
benign distance is  tensor(30.0010, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.9611665457487106
distance x is tensor(67.9260, device='cuda:2')
benign distance is  tensor(67.9260, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6639519929885864
distance x is tensor(28.3683, device='cuda:2')
benign distance is  tensor(28.3683, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([669.9654, 510.4315, 365.8735, 656.7392, 489.4520, 284.6458, 545.9417,
        315.2695, 309.3509, 599.8633, 376.3822, 567.5280, 561.4223, 471.9592,
        593.4148, 537.1390, 464.0649, 588.1742, 540.5528, 665.6011, 698.5329,
        603.2393, 698.9067, 667.4102, 685.8068, 598.9928, 584.4694, 682.5430,
        716.3177, 668.9354, 724.2882, 672.4899, 691.6631, 725.4856, 705.3325,
        811.6669, 632.0573, 701.6181, 566.3337, 663.6460, 751.4028, 546.3298,
        740.3726, 670.5889], device='cuda:2')
sorted_norm is   tensor([284.6458, 309.3509, 315.2695, 365.8735, 376.3822, 464.0649, 471.9592,
        489.4520, 510.4315, 537.1390, 540.5528, 545.9417, 546.3298, 561.4223,
        566.3337, 567.5280, 584.4694, 588.1742, 593.4148, 598.9928, 599.8633,
        603.2393, 632.0573, 656.7392, 663.6460, 665.6011, 667.4102, 668.9354,
        669.9654, 670.5889, 672.4899, 682.5430, 685.8068, 691.6631, 698.5329,
        698.9067, 701.6181, 705.3325, 716.3177, 724.2882, 725.4856, 740.3726,
        751.4028, 811.6669], device='cuda:2')
used idx is  tensor([ 5,  8,  7,  2, 10, 16, 13,  4,  1, 15, 18,  6, 41, 12, 38, 11, 26, 17,
        14, 25,  9, 21, 36,  3, 39, 19, 23, 29,  0, 43, 31, 27, 24, 32, 20],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 27.30% 

Test Accuracy: 36.66% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0795970782637596
distance x is tensor(134.5928, device='cuda:2')
benign distance is  tensor(134.5928, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0993996933102608
distance x is tensor(100.5880, device='cuda:2')
benign distance is  tensor(100.5880, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6065811067819595
distance x is tensor(83.4922, device='cuda:2')
benign distance is  tensor(83.4922, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.913129687309265
distance x is tensor(133.8764, device='cuda:2')
benign distance is  tensor(133.8764, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.178187407553196
distance x is tensor(101.2400, device='cuda:2')
benign distance is  tensor(101.2400, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4926216900348663
distance x is tensor(101.6417, device='cuda:2')
benign distance is  tensor(101.6417, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9704813957214355
distance x is tensor(106.2348, device='cuda:2')
benign distance is  tensor(106.2348, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8384439796209335
distance x is tensor(93.8543, device='cuda:2')
benign distance is  tensor(93.8543, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.5877166017889977
distance x is tensor(102.8769, device='cuda:2')
benign distance is  tensor(102.8769, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8342647403478622
distance x is tensor(122.1083, device='cuda:2')
benign distance is  tensor(122.1083, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.9437884911894798
distance x is tensor(94.1145, device='cuda:2')
benign distance is  tensor(94.1145, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.8476319760084152
distance x is tensor(112.5271, device='cuda:2')
benign distance is  tensor(112.5271, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.888710990548134
distance x is tensor(136.0349, device='cuda:2')
benign distance is  tensor(136.0349, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8464435264468193
distance x is tensor(86.6278, device='cuda:2')
benign distance is  tensor(86.6278, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8955663442611694
distance x is tensor(133.4145, device='cuda:2')
benign distance is  tensor(133.4145, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.134684175252914
distance x is tensor(114.9202, device='cuda:2')
benign distance is  tensor(114.9202, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.8986982181668282
distance x is tensor(123.5098, device='cuda:2')
benign distance is  tensor(123.5098, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.69986392557621
distance x is tensor(84.5443, device='cuda:2')
benign distance is  tensor(84.5443, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.3837524577975273
distance x is tensor(127.9476, device='cuda:2')
benign distance is  tensor(127.9476, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.060141757130623
distance x is tensor(109.9690, device='cuda:2')
benign distance is  tensor(109.9690, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.8072892278432846
distance x is tensor(113.3480, device='cuda:2')
benign distance is  tensor(113.3480, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.1212070882320404
distance x is tensor(120.6267, device='cuda:2')
benign distance is  tensor(120.6267, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.72310371696949
distance x is tensor(111.3012, device='cuda:2')
benign distance is  tensor(111.3012, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.964486241340637
distance x is tensor(143.1258, device='cuda:2')
benign distance is  tensor(143.1258, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1346440613269806
distance x is tensor(121.0971, device='cuda:2')
benign distance is  tensor(121.0971, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2247672602534294
distance x is tensor(99.1962, device='cuda:2')
benign distance is  tensor(99.1962, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.80361507833004
distance x is tensor(112.8214, device='cuda:2')
benign distance is  tensor(112.8214, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.802068144083023
distance x is tensor(116.4962, device='cuda:2')
benign distance is  tensor(116.4962, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.2005851902067661
distance x is tensor(118.1437, device='cuda:2')
benign distance is  tensor(118.1437, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9431931674480438
distance x is tensor(99.6529, device='cuda:2')
benign distance is  tensor(99.6529, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.7810804024338722
distance x is tensor(93.8301, device='cuda:2')
benign distance is  tensor(93.8301, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9522468894720078
distance x is tensor(116.5234, device='cuda:2')
benign distance is  tensor(116.5234, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([604.7464, 466.1671, 413.5228, 603.8927, 478.7535, 479.8636, 486.4509,
        437.8416, 780.2234, 893.5064, 789.3480, 827.8967, 765.5369, 797.4690,
        855.9080, 745.1559, 830.9512, 781.4619, 812.7900, 955.9395, 441.2682,
        487.2752, 505.6986, 578.6300, 474.7358, 874.6162, 641.8325, 555.1837],
       device='cuda:2')
sorted_norm is   tensor([413.5228, 437.8416, 441.2682, 466.1671, 474.7358, 478.7535, 479.8636,
        486.4509, 487.2752, 505.6986, 555.1837, 578.6300, 603.8927, 604.7464,
        641.8325, 745.1559, 765.5369, 780.2234, 781.4619, 789.3480, 797.4690,
        812.7900, 827.8967, 830.9512, 855.9080, 874.6162, 893.5064, 955.9395],
       device='cuda:2')
used idx is  tensor([ 2,  7, 20,  1, 24,  4,  5,  6, 21, 22, 27, 23,  3,  0, 26, 15, 12,  8,
        17, 10, 13, 18], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 13.02% 

Test Accuracy: 31.67% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8734070174396038
distance x is tensor(139.9922, device='cuda:2')
benign distance is  tensor(139.9922, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1581838876008987
distance x is tensor(103.4329, device='cuda:2')
benign distance is  tensor(103.4329, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.619484931230545
distance x is tensor(89.0442, device='cuda:2')
benign distance is  tensor(89.0442, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.7321397960186005
distance x is tensor(141.0844, device='cuda:2')
benign distance is  tensor(141.0844, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0402602031826973
distance x is tensor(108.4592, device='cuda:2')
benign distance is  tensor(108.4592, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.500320166349411
distance x is tensor(104.4774, device='cuda:2')
benign distance is  tensor(104.4774, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9468855112791061
distance x is tensor(104.8791, device='cuda:2')
benign distance is  tensor(104.8791, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0374265983700752
distance x is tensor(94.4476, device='cuda:2')
benign distance is  tensor(94.4476, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.4681732803583145
distance x is tensor(99.1162, device='cuda:2')
benign distance is  tensor(99.1162, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1624506786465645
distance x is tensor(107.8039, device='cuda:2')
benign distance is  tensor(107.8039, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.375199370086193
distance x is tensor(114.1144, device='cuda:2')
benign distance is  tensor(114.1144, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3990863785147667
distance x is tensor(136.6582, device='cuda:2')
benign distance is  tensor(136.6582, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.119548238813877
distance x is tensor(102.9711, device='cuda:2')
benign distance is  tensor(102.9711, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3676961436867714
distance x is tensor(191.1377, device='cuda:2')
benign distance is  tensor(191.1377, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7969066202640533
distance x is tensor(145.3495, device='cuda:2')
benign distance is  tensor(145.3495, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.9735382050275803
distance x is tensor(113.0866, device='cuda:2')
benign distance is  tensor(113.0866, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([623.9090, 466.8615, 432.9201, 623.2229, 499.9864, 472.4755, 470.3624,
        434.3360, 790.0630, 893.2282, 777.7114, 837.0727, 750.8073, 822.4864,
        855.6192, 735.3444, 829.6212, 815.0610, 828.8343, 939.2900, 501.1325,
        592.2330, 434.6405, 518.1616, 632.3966, 420.7426, 620.9715, 539.9037],
       device='cuda:2')
sorted_norm is   tensor([420.7426, 432.9201, 434.3360, 434.6405, 466.8615, 470.3624, 472.4755,
        499.9864, 501.1325, 518.1616, 539.9037, 592.2330, 620.9715, 623.2229,
        623.9090, 632.3966, 735.3444, 750.8073, 777.7114, 790.0630, 815.0610,
        822.4864, 828.8343, 829.6212, 837.0727, 855.6192, 893.2282, 939.2900],
       device='cuda:2')
used idx is  tensor([25,  2,  7, 22,  1,  6,  5,  4, 20, 23, 27, 21, 26,  3,  0, 24, 15, 12,
        10,  8, 17, 13], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 21.21% 

Test Accuracy: 53.36% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8361387029290199
distance x is tensor(141.3102, device='cuda:2')
benign distance is  tensor(141.3102, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1502196863293648
distance x is tensor(103.0010, device='cuda:2')
benign distance is  tensor(103.0010, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.3524509370326996
distance x is tensor(86.9428, device='cuda:2')
benign distance is  tensor(86.9428, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.8174025267362595
distance x is tensor(138.1754, device='cuda:2')
benign distance is  tensor(138.1754, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7678555622696877
distance x is tensor(109.1450, device='cuda:2')
benign distance is  tensor(109.1450, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.582647681236267
distance x is tensor(105.7336, device='cuda:2')
benign distance is  tensor(105.7336, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.1090864092111588
distance x is tensor(108.8263, device='cuda:2')
benign distance is  tensor(108.8263, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0249344557523727
distance x is tensor(92.4331, device='cuda:2')
benign distance is  tensor(92.4331, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.409808039665222
distance x is tensor(102.8430, device='cuda:2')
benign distance is  tensor(102.8430, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.0647547617554665
distance x is tensor(119.0597, device='cuda:2')
benign distance is  tensor(119.0597, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7357355505228043
distance x is tensor(94.0847, device='cuda:2')
benign distance is  tensor(94.0847, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5469407439231873
distance x is tensor(110.6895, device='cuda:2')
benign distance is  tensor(110.6895, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.5510455816984177
distance x is tensor(136.6676, device='cuda:2')
benign distance is  tensor(136.6676, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.4341845661401749
distance x is tensor(78.8497, device='cuda:2')
benign distance is  tensor(78.8497, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4681435450911522
distance x is tensor(132.1635, device='cuda:2')
benign distance is  tensor(132.1635, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.424289852380753
distance x is tensor(113.0493, device='cuda:2')
benign distance is  tensor(113.0493, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 630.8388,  456.3242,  420.4500,  602.8523,  504.2431,  482.6004,
         480.9153,  422.9349,  835.0165,  939.3828,  863.0928,  873.8995,
         798.5126,  866.9064,  927.7379,  803.7047,  907.0526,  841.1882,
         868.8835, 1003.7968], device='cuda:2')
sorted_norm is   tensor([ 420.4500,  422.9349,  456.3242,  480.9153,  482.6004,  504.2431,
         602.8523,  630.8388,  798.5126,  803.7047,  835.0165,  841.1882,
         863.0928,  866.9064,  868.8835,  873.8995,  907.0526,  927.7379,
         939.3828, 1003.7968], device='cuda:2')
used idx is  tensor([ 2,  7,  1,  6,  5,  4,  3,  0, 12, 15,  8, 17, 10, 13, 18, 11],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.5714401677250862
distance x is tensor(100.1477, device='cuda:2')
benign distance is  tensor(100.1477, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.349122017621994
distance x is tensor(74.5109, device='cuda:2')
benign distance is  tensor(74.5109, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8938146233558655
distance x is tensor(45.0291, device='cuda:2')
benign distance is  tensor(45.0291, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2962196618318558
distance x is tensor(100.7869, device='cuda:2')
benign distance is  tensor(100.7869, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.8127858340740204
distance x is tensor(85.9692, device='cuda:2')
benign distance is  tensor(85.9692, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.8187902867794037
distance x is tensor(15.9492, device='cuda:2')
benign distance is  tensor(15.9492, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5460770577192307
distance x is tensor(78.0786, device='cuda:2')
benign distance is  tensor(78.0786, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  4.575267627835274
distance x is tensor(49.4192, device='cuda:2')
benign distance is  tensor(49.4192, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([668.8258, 530.5795, 381.2613, 685.7772, 541.6686, 227.0406, 571.5531,
        402.3204, 364.5905, 602.6915, 413.9332, 574.6588, 557.2390, 478.3893,
        615.3575, 583.4747, 442.5106, 580.8672, 582.9297, 648.5870, 569.0456,
        726.6531, 796.3921, 545.8512, 778.2042, 682.9632, 629.0169, 767.4246,
        700.7642, 574.4940, 732.7301, 648.3143, 663.6649, 688.2548, 688.3353,
        778.5388, 595.7725, 635.1644, 660.4884, 748.1741, 614.3032, 967.2599,
        782.7104, 677.7744, 649.7451, 718.2280, 590.1138, 667.9863, 781.1174,
        545.8569, 771.8267, 683.6342], device='cuda:2')
sorted_norm is   tensor([227.0406, 364.5905, 381.2613, 402.3204, 413.9332, 442.5106, 478.3893,
        530.5795, 541.6686, 545.8512, 545.8569, 557.2390, 569.0456, 571.5531,
        574.4940, 574.6588, 580.8672, 582.9297, 583.4747, 590.1138, 595.7725,
        602.6915, 614.3032, 615.3575, 629.0169, 635.1644, 648.3143, 648.5870,
        649.7451, 660.4884, 663.6649, 667.9863, 668.8258, 677.7744, 682.9632,
        683.6342, 685.7772, 688.2548, 688.3353, 700.7642, 718.2280, 726.6531,
        732.7301, 748.1741, 767.4246, 771.8267, 778.2042, 778.5388, 781.1174,
        782.7104, 796.3921, 967.2599], device='cuda:2')
used idx is  tensor([ 5,  8,  2,  7, 10, 16, 13,  1,  4, 23, 49, 12, 20,  6, 29, 11, 17, 18,
        15, 46, 36,  9, 40, 14, 26, 37, 31, 19, 44, 38, 32, 47,  0, 43, 25, 51,
         3, 33, 34, 28, 45], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 35.29% 

Test Accuracy: 56.30% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9243949390947819
distance x is tensor(129.4036, device='cuda:2')
benign distance is  tensor(129.4036, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.940271683037281
distance x is tensor(98.9457, device='cuda:2')
benign distance is  tensor(98.9457, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.191670924425125
distance x is tensor(82.1239, device='cuda:2')
benign distance is  tensor(82.1239, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3017449751496315
distance x is tensor(135.8962, device='cuda:2')
benign distance is  tensor(135.8962, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9721621498465538
distance x is tensor(105.4328, device='cuda:2')
benign distance is  tensor(105.4328, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8801880478858948
distance x is tensor(100.9623, device='cuda:2')
benign distance is  tensor(100.9623, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.445273570716381
distance x is tensor(110.1469, device='cuda:2')
benign distance is  tensor(110.1469, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.003186374902725
distance x is tensor(89.3416, device='cuda:2')
benign distance is  tensor(89.3416, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.736776977777481
distance x is tensor(106.9833, device='cuda:2')
benign distance is  tensor(106.9833, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7150701880455017
distance x is tensor(117.5898, device='cuda:2')
benign distance is  tensor(117.5898, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2355362102389336
distance x is tensor(98.1956, device='cuda:2')
benign distance is  tensor(98.1956, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.768004208803177
distance x is tensor(109.6089, device='cuda:2')
benign distance is  tensor(109.6089, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.8539333790540695
distance x is tensor(138.1922, device='cuda:2')
benign distance is  tensor(138.1922, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.150110609829426
distance x is tensor(77.1355, device='cuda:2')
benign distance is  tensor(77.1355, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8916682824492455
distance x is tensor(131.3942, device='cuda:2')
benign distance is  tensor(131.3942, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.454293787479401
distance x is tensor(115.8269, device='cuda:2')
benign distance is  tensor(115.8269, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.62934747338295
distance x is tensor(100.4805, device='cuda:2')
benign distance is  tensor(100.4805, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1433221995830536
distance x is tensor(100.5206, device='cuda:2')
benign distance is  tensor(100.5206, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.9324351772665977
distance x is tensor(107.9168, device='cuda:2')
benign distance is  tensor(107.9168, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.741027109324932
distance x is tensor(125.8488, device='cuda:2')
benign distance is  tensor(125.8488, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9650133401155472
distance x is tensor(101.3293, device='cuda:2')
benign distance is  tensor(101.3293, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.44117995724082
distance x is tensor(189.1356, device='cuda:2')
benign distance is  tensor(189.1356, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.6058888658881187
distance x is tensor(149.2978, device='cuda:2')
benign distance is  tensor(149.2978, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.103582337498665
distance x is tensor(115.7491, device='cuda:2')
benign distance is  tensor(115.7491, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.886983647942543
distance x is tensor(118.5649, device='cuda:2')
benign distance is  tensor(118.5649, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.9598489999771118
distance x is tensor(83.1063, device='cuda:2')
benign distance is  tensor(83.1063, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.8825903832912445
distance x is tensor(123.8706, device='cuda:2')
benign distance is  tensor(123.8706, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.482316747307777
distance x is tensor(108.0661, device='cuda:2')
benign distance is  tensor(108.0661, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.9025681540369987
distance x is tensor(108.6504, device='cuda:2')
benign distance is  tensor(108.6504, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.866512767970562
distance x is tensor(113.1457, device='cuda:2')
benign distance is  tensor(113.1457, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7998134978115559
distance x is tensor(108.4663, device='cuda:2')
benign distance is  tensor(108.4663, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.8410307466983795
distance x is tensor(135.5338, device='cuda:2')
benign distance is  tensor(135.5338, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.508018344640732
distance x is tensor(89.9046, device='cuda:2')
benign distance is  tensor(89.9046, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  5.144399806857109
distance x is tensor(129.2718, device='cuda:2')
benign distance is  tensor(129.2718, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.9255573600530624
distance x is tensor(145.0943, device='cuda:2')
benign distance is  tensor(145.0943, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.0133356228470802
distance x is tensor(85.3571, device='cuda:2')
benign distance is  tensor(85.3571, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.7320667877793312
distance x is tensor(138.2248, device='cuda:2')
benign distance is  tensor(138.2248, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.1853409111499786
distance x is tensor(118.3363, device='cuda:2')
benign distance is  tensor(118.3363, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  4.111233502626419
distance x is tensor(97.3581, device='cuda:2')
benign distance is  tensor(97.3581, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.709205687046051
distance x is tensor(138.9748, device='cuda:2')
benign distance is  tensor(138.9748, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 588.3983,  448.1588,  407.1367,  600.1001,  478.1445,  467.3766,
         476.7482,  419.6878,  835.9142,  945.3970,  854.9502,  850.2444,
         831.4428,  902.2554,  929.5325,  805.9856,  904.8223,  858.0937,
         889.1200, 1012.1761,  553.0044,  438.1972,  518.9509,  511.2958,
         539.5386,  452.6549,  408.2395,  537.1667], device='cuda:2')
sorted_norm is   tensor([ 407.1367,  408.2395,  419.6878,  438.1972,  448.1588,  452.6549,
         467.3766,  476.7482,  478.1445,  511.2958,  518.9509,  537.1667,
         539.5386,  553.0044,  588.3983,  600.1001,  805.9856,  831.4428,
         835.9142,  850.2444,  854.9502,  858.0937,  889.1200,  902.2554,
         904.8223,  929.5325,  945.3970, 1012.1761], device='cuda:2')
used idx is  tensor([ 2, 26,  7, 21,  1, 25,  5,  6,  4, 23, 22, 27, 24, 20,  0,  3, 15, 12,
         8, 11, 10, 17], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 20.49% 

Test Accuracy: 47.30% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8660844229161739
distance x is tensor(135.1597, device='cuda:2')
benign distance is  tensor(135.1597, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4637994319200516
distance x is tensor(106.4529, device='cuda:2')
benign distance is  tensor(106.4529, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.389404535293579
distance x is tensor(84.8537, device='cuda:2')
benign distance is  tensor(84.8537, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4018977507948875
distance x is tensor(139.8100, device='cuda:2')
benign distance is  tensor(139.8100, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.232745200395584
distance x is tensor(105.8665, device='cuda:2')
benign distance is  tensor(105.8665, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2408461831510067
distance x is tensor(106.1842, device='cuda:2')
benign distance is  tensor(106.1842, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7487974092364311
distance x is tensor(107.5309, device='cuda:2')
benign distance is  tensor(107.5309, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0180382505059242
distance x is tensor(92.6373, device='cuda:2')
benign distance is  tensor(92.6373, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1164146214723587
distance x is tensor(121.6493, device='cuda:2')
benign distance is  tensor(121.6493, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0385975688695908
distance x is tensor(101.0861, device='cuda:2')
benign distance is  tensor(101.0861, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.5049019008874893
distance x is tensor(117.7545, device='cuda:2')
benign distance is  tensor(117.7545, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.568727552890778
distance x is tensor(116.7757, device='cuda:2')
benign distance is  tensor(116.7757, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.057761199772358
distance x is tensor(116.1966, device='cuda:2')
benign distance is  tensor(116.1966, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.5735570788383484
distance x is tensor(101.5910, device='cuda:2')
benign distance is  tensor(101.5910, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.0720150992274284
distance x is tensor(97.6829, device='cuda:2')
benign distance is  tensor(97.6829, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9068361595273018
distance x is tensor(113.7227, device='cuda:2')
benign distance is  tensor(113.7227, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 599.7822,  468.5378,  413.2353,  622.3038,  469.3491,  478.5553,
         478.6909,  424.8047,  842.5970,  942.2909,  829.0155,  898.1105,
         798.6957,  862.0765,  922.5693,  808.9996,  900.8455,  850.5629,
         865.4297, 1000.5667,  493.8217,  560.6599,  458.0588,  520.2812,
         636.9388,  372.3662,  612.8177,  541.3795], device='cuda:2')
sorted_norm is   tensor([ 372.3662,  413.2353,  424.8047,  458.0588,  468.5378,  469.3491,
         478.5553,  478.6909,  493.8217,  520.2812,  541.3795,  560.6599,
         599.7822,  612.8177,  622.3038,  636.9388,  798.6957,  808.9996,
         829.0155,  842.5970,  850.5629,  862.0765,  865.4297,  898.1105,
         900.8455,  922.5693,  942.2909, 1000.5667], device='cuda:2')
used idx is  tensor([25,  2,  7, 22,  1,  4,  5,  6, 20, 23, 27, 21,  0, 26,  3, 24, 12, 15,
        10,  8, 17, 13], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 26.70% 

Test Accuracy: 55.40% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9601465724408627
distance x is tensor(137.7820, device='cuda:2')
benign distance is  tensor(137.7820, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.48824492841959
distance x is tensor(98.6718, device='cuda:2')
benign distance is  tensor(98.6718, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6637952476739883
distance x is tensor(87.8548, device='cuda:2')
benign distance is  tensor(87.8548, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.487684153020382
distance x is tensor(136.0771, device='cuda:2')
benign distance is  tensor(136.0771, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7215571254491806
distance x is tensor(113.7728, device='cuda:2')
benign distance is  tensor(113.7728, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3602360226213932
distance x is tensor(103.7639, device='cuda:2')
benign distance is  tensor(103.7639, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1587805673480034
distance x is tensor(106.8929, device='cuda:2')
benign distance is  tensor(106.8929, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.798346757888794
distance x is tensor(93.6514, device='cuda:2')
benign distance is  tensor(93.6514, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8515301793813705
distance x is tensor(107.2261, device='cuda:2')
benign distance is  tensor(107.2261, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8426102474331856
distance x is tensor(122.0296, device='cuda:2')
benign distance is  tensor(122.0296, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8036001101136208
distance x is tensor(92.0005, device='cuda:2')
benign distance is  tensor(92.0005, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.032390922307968
distance x is tensor(110.8658, device='cuda:2')
benign distance is  tensor(110.8658, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2844734266400337
distance x is tensor(143.1559, device='cuda:2')
benign distance is  tensor(143.1559, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2668641954660416
distance x is tensor(79.9854, device='cuda:2')
benign distance is  tensor(79.9854, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6285331100225449
distance x is tensor(138.4378, device='cuda:2')
benign distance is  tensor(138.4378, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.7160345166921616
distance x is tensor(115.9435, device='cuda:2')
benign distance is  tensor(115.9435, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 608.1425,  451.5009,  424.7792,  595.3820,  506.8374,  471.5935,
         455.0078,  420.4156,  843.3726,  969.5535,  848.9217,  895.2106,
         824.0379,  891.3295,  930.0950,  819.4803,  919.0526,  871.5920,
         896.8445, 1031.0863,  459.0643,  466.0868,  488.3896,  571.1568,
         453.7665,  839.6553,  650.7678,  529.0111], device='cuda:2')
sorted_norm is   tensor([ 420.4156,  424.7792,  451.5009,  453.7665,  455.0078,  459.0643,
         466.0868,  471.5935,  488.3896,  506.8374,  529.0111,  571.1568,
         595.3820,  608.1425,  650.7678,  819.4803,  824.0379,  839.6553,
         843.3726,  848.9217,  871.5920,  891.3295,  895.2106,  896.8445,
         919.0526,  930.0950,  969.5535, 1031.0863], device='cuda:2')
used idx is  tensor([ 7,  2,  1, 24,  6, 20, 21,  5, 22,  4, 27, 23,  3,  0, 26, 15, 12, 25,
         8, 10, 17, 13], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 20.43% 

Test Accuracy: 53.13% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7998877838253975
distance x is tensor(136.7370, device='cuda:2')
benign distance is  tensor(136.7370, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.132395140826702
distance x is tensor(100.0794, device='cuda:2')
benign distance is  tensor(100.0794, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6632321774959564
distance x is tensor(90.6027, device='cuda:2')
benign distance is  tensor(90.6027, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.1950411573052406
distance x is tensor(137.0021, device='cuda:2')
benign distance is  tensor(137.0021, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9132535457611084
distance x is tensor(106.0346, device='cuda:2')
benign distance is  tensor(106.0346, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7565369755029678
distance x is tensor(104.5662, device='cuda:2')
benign distance is  tensor(104.5662, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.51087586581707
distance x is tensor(111.2205, device='cuda:2')
benign distance is  tensor(111.2205, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8945506140589714
distance x is tensor(95.3055, device='cuda:2')
benign distance is  tensor(95.3055, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.1973030865192413
distance x is tensor(97.6056, device='cuda:2')
benign distance is  tensor(97.6056, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.087626300752163
distance x is tensor(102.5297, device='cuda:2')
benign distance is  tensor(102.5297, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5761959105730057
distance x is tensor(113.9926, device='cuda:2')
benign distance is  tensor(113.9926, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.4738828763365746
distance x is tensor(120.2579, device='cuda:2')
benign distance is  tensor(120.2579, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.645749881863594
distance x is tensor(98.9888, device='cuda:2')
benign distance is  tensor(98.9888, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1615661978721619
distance x is tensor(196.4409, device='cuda:2')
benign distance is  tensor(196.4409, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7173205614089966
distance x is tensor(142.3818, device='cuda:2')
benign distance is  tensor(142.3818, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.5712267979979515
distance x is tensor(116.1769, device='cuda:2')
benign distance is  tensor(116.1769, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 606.3501,  451.1485,  431.5481,  603.5560,  464.3026,  474.5883,
         479.3224,  427.6239,  866.0441,  988.2250,  878.9050,  934.0589,
         842.5691,  894.8174,  957.0926,  842.3316,  934.1105,  889.4681,
         906.8434, 1046.1492,  531.8292,  412.9516,  546.0181,  494.6036,
         502.2968,  517.9137,  516.3179,  631.2859,  495.6968,  571.1448,
         418.6766,  513.2316,  668.0464,  373.6554,  615.1605,  527.2039],
       device='cuda:2')
sorted_norm is   tensor([ 373.6554,  412.9516,  418.6766,  427.6239,  431.5481,  451.1485,
         464.3026,  474.5883,  479.3224,  494.6036,  495.6968,  502.2968,
         513.2316,  516.3179,  517.9137,  527.2039,  531.8292,  546.0181,
         571.1448,  603.5560,  606.3501,  615.1605,  631.2859,  668.0464,
         842.3316,  842.5691,  866.0441,  878.9050,  889.4681,  894.8174,
         906.8434,  934.0589,  934.1105,  957.0926,  988.2250, 1046.1492],
       device='cuda:2')
used idx is  tensor([33, 21, 30,  7,  2,  1,  4,  5,  6, 23, 28, 24, 31, 26, 25, 35, 20, 22,
        29,  3,  0, 34, 27, 32, 15, 12,  8, 10], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 41.95% 

Test Accuracy: 68.61% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0085553340613842
distance x is tensor(123.2762, device='cuda:2')
benign distance is  tensor(123.2762, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.436433859169483
distance x is tensor(92.3407, device='cuda:2')
benign distance is  tensor(92.3407, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.014364004135132
distance x is tensor(79.8922, device='cuda:2')
benign distance is  tensor(79.8922, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0925838500261307
distance x is tensor(124.7831, device='cuda:2')
benign distance is  tensor(124.7831, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9602651670575142
distance x is tensor(92.3711, device='cuda:2')
benign distance is  tensor(92.3711, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6141382828354836
distance x is tensor(94.1490, device='cuda:2')
benign distance is  tensor(94.1490, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.191772125661373
distance x is tensor(94.0776, device='cuda:2')
benign distance is  tensor(94.0776, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8825029358267784
distance x is tensor(82.4823, device='cuda:2')
benign distance is  tensor(82.4823, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3511702120304108
distance x is tensor(89.5314, device='cuda:2')
benign distance is  tensor(89.5314, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.076984040439129
distance x is tensor(114.1535, device='cuda:2')
benign distance is  tensor(114.1535, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.0968116223812103
distance x is tensor(78.0087, device='cuda:2')
benign distance is  tensor(78.0087, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.935734897851944
distance x is tensor(97.7779, device='cuda:2')
benign distance is  tensor(97.7779, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.942944973707199
distance x is tensor(122.6712, device='cuda:2')
benign distance is  tensor(122.6712, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.032038174569607
distance x is tensor(63.4749, device='cuda:2')
benign distance is  tensor(63.4749, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9881234094500542
distance x is tensor(128.2249, device='cuda:2')
benign distance is  tensor(128.2249, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.647831067442894
distance x is tensor(100.9142, device='cuda:2')
benign distance is  tensor(100.9142, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7223992049694061
distance x is tensor(106.5561, device='cuda:2')
benign distance is  tensor(106.5561, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.6475353688001633
distance x is tensor(73.0206, device='cuda:2')
benign distance is  tensor(73.0206, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.176260456442833
distance x is tensor(108.4486, device='cuda:2')
benign distance is  tensor(108.4486, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.167029976844788
distance x is tensor(87.8328, device='cuda:2')
benign distance is  tensor(87.8328, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5923294425010681
distance x is tensor(100.9516, device='cuda:2')
benign distance is  tensor(100.9516, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.050591342151165
distance x is tensor(101.6942, device='cuda:2')
benign distance is  tensor(101.6942, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6468272842466831
distance x is tensor(99.1305, device='cuda:2')
benign distance is  tensor(99.1305, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.53560122102499
distance x is tensor(133.9481, device='cuda:2')
benign distance is  tensor(133.9481, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 558.9036,  423.9006,  396.1003,  546.6141,  420.8389,  431.2284,
         415.9566,  373.4579, 1018.7801, 1145.8472, 1028.2524, 1060.2950,
        1012.4528, 1051.3540, 1096.9922, 1012.7584, 1090.4403, 1039.1973,
        1063.2914, 1167.4369], device='cuda:2')
sorted_norm is   tensor([ 373.4579,  396.1003,  415.9566,  420.8389,  423.9006,  431.2284,
         546.6141,  558.9036, 1012.4528, 1012.7584, 1018.7801, 1028.2524,
        1039.1973, 1051.3540, 1060.2950, 1063.2914, 1090.4403, 1096.9922,
        1145.8472, 1167.4369], device='cuda:2')
used idx is  tensor([ 7,  2,  6,  4,  1,  5,  3,  0, 12, 15,  8, 10, 17, 13, 11, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.591984584927559
distance x is tensor(89.7129, device='cuda:2')
benign distance is  tensor(89.7129, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.321324773132801
distance x is tensor(64.8907, device='cuda:2')
benign distance is  tensor(64.8907, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.795297309756279
distance x is tensor(37.0007, device='cuda:2')
benign distance is  tensor(37.0007, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.728033885359764
distance x is tensor(92.7716, device='cuda:2')
benign distance is  tensor(92.7716, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1421456784009933
distance x is tensor(50.4903, device='cuda:2')
benign distance is  tensor(50.4903, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.0802267715334892
distance x is tensor(35.6633, device='cuda:2')
benign distance is  tensor(35.6633, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.430762767791748
distance x is tensor(76.4648, device='cuda:2')
benign distance is  tensor(76.4648, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.658215805888176
distance x is tensor(26.3033, device='cuda:2')
benign distance is  tensor(26.3033, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 650.9091,  536.0551,  358.5606,  669.5535,  501.2310,  315.1389,
         554.6442,  324.8610,  309.6308,  605.2246,  517.3364,  598.3659,
         537.9186,  459.6421,  548.7746,  544.5345,  466.8204,  567.5001,
         508.3152,  633.3253,  594.4034,  740.7533,  817.8625,  587.2472,
         799.9818,  720.5513,  632.5153,  793.0889,  723.7111,  641.8362,
         715.0421,  695.3153,  707.4650,  646.1660,  619.5360,  702.5143,
         620.9537,  654.4949,  690.5645,  720.3627,  626.0143, 1019.6796,
         800.8055,  722.8810,  690.8645,  785.5919,  627.3373,  705.1274,
         815.5383,  589.9890,  834.9594,  716.4116], device='cuda:2')
sorted_norm is   tensor([ 309.6308,  315.1389,  324.8610,  358.5606,  459.6421,  466.8204,
         501.2310,  508.3152,  517.3364,  536.0551,  537.9186,  544.5345,
         548.7746,  554.6442,  567.5001,  587.2472,  589.9890,  594.4034,
         598.3659,  605.2246,  619.5360,  620.9537,  626.0143,  627.3373,
         632.5153,  633.3253,  641.8362,  646.1660,  650.9091,  654.4949,
         669.5535,  690.5645,  690.8645,  695.3153,  702.5143,  705.1274,
         707.4650,  715.0421,  716.4116,  720.3627,  720.5513,  722.8810,
         723.7111,  740.7533,  785.5919,  793.0889,  799.9818,  800.8055,
         815.5383,  817.8625,  834.9594, 1019.6796], device='cuda:2')
used idx is  tensor([ 8,  5,  7,  2, 13, 16,  4, 18, 10,  1, 12, 15, 14,  6, 17, 23, 49, 20,
        11,  9, 34, 36, 40, 46, 26, 19, 29, 33,  0, 37,  3, 38, 44, 31, 35, 47,
        32, 30, 51, 39, 25], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 28.14% 

Test Accuracy: 57.18% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8047320283949375
distance x is tensor(141.1055, device='cuda:2')
benign distance is  tensor(141.1055, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3969534933567047
distance x is tensor(105.1870, device='cuda:2')
benign distance is  tensor(105.1870, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.077442906796932
distance x is tensor(85.5764, device='cuda:2')
benign distance is  tensor(85.5764, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.410082645714283
distance x is tensor(131.5712, device='cuda:2')
benign distance is  tensor(131.5712, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9188672751188278
distance x is tensor(110.4404, device='cuda:2')
benign distance is  tensor(110.4404, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5534537583589554
distance x is tensor(104.7567, device='cuda:2')
benign distance is  tensor(104.7567, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.9120329171419144
distance x is tensor(116.0478, device='cuda:2')
benign distance is  tensor(116.0478, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.086923308670521
distance x is tensor(94.1538, device='cuda:2')
benign distance is  tensor(94.1538, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.396956220269203
distance x is tensor(105.5341, device='cuda:2')
benign distance is  tensor(105.5341, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7469156607985497
distance x is tensor(120.1342, device='cuda:2')
benign distance is  tensor(120.1342, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.009697340428829
distance x is tensor(87.5760, device='cuda:2')
benign distance is  tensor(87.5760, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.8700917214155197
distance x is tensor(108.5996, device='cuda:2')
benign distance is  tensor(108.5996, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.0709132626652718
distance x is tensor(137.1685, device='cuda:2')
benign distance is  tensor(137.1685, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.5747773349285126
distance x is tensor(80.1509, device='cuda:2')
benign distance is  tensor(80.1509, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8083374872803688
distance x is tensor(133.7568, device='cuda:2')
benign distance is  tensor(133.7568, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.915945932269096
distance x is tensor(120.3761, device='cuda:2')
benign distance is  tensor(120.3761, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.6424883157014847
distance x is tensor(97.9909, device='cuda:2')
benign distance is  tensor(97.9909, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.7756571918725967
distance x is tensor(103.5983, device='cuda:2')
benign distance is  tensor(103.5983, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2251168116927147
distance x is tensor(114.4235, device='cuda:2')
benign distance is  tensor(114.4235, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.5391185581684113
distance x is tensor(130.8159, device='cuda:2')
benign distance is  tensor(130.8159, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9994967132806778
distance x is tensor(99.5245, device='cuda:2')
benign distance is  tensor(99.5245, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.6806188970804214
distance x is tensor(196.9304, device='cuda:2')
benign distance is  tensor(196.9304, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.114477574825287
distance x is tensor(152.3665, device='cuda:2')
benign distance is  tensor(152.3665, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.2912680879235268
distance x is tensor(113.9949, device='cuda:2')
benign distance is  tensor(113.9949, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.2081166692078114
distance x is tensor(117.3253, device='cuda:2')
benign distance is  tensor(117.3253, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.9073650389909744
distance x is tensor(100.6159, device='cuda:2')
benign distance is  tensor(100.6159, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.667012721300125
distance x is tensor(117.6337, device='cuda:2')
benign distance is  tensor(117.6337, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.16101011633873
distance x is tensor(114.8225, device='cuda:2')
benign distance is  tensor(114.8225, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0535687617957592
distance x is tensor(121.6500, device='cuda:2')
benign distance is  tensor(121.6500, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.5336140543222427
distance x is tensor(102.1266, device='cuda:2')
benign distance is  tensor(102.1266, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.9555365666747093
distance x is tensor(93.1605, device='cuda:2')
benign distance is  tensor(93.1605, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9921361953020096
distance x is tensor(116.4422, device='cuda:2')
benign distance is  tensor(116.4422, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.1223374903202057
distance x is tensor(91.6453, device='cuda:2')
benign distance is  tensor(91.6453, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  4.287754535675049
distance x is tensor(125.3967, device='cuda:2')
benign distance is  tensor(125.3967, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.390824906527996
distance x is tensor(148.2956, device='cuda:2')
benign distance is  tensor(148.2956, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.007378078997135
distance x is tensor(87.4336, device='cuda:2')
benign distance is  tensor(87.4336, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.342485811561346
distance x is tensor(134.3185, device='cuda:2')
benign distance is  tensor(134.3185, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.9847440049052238
distance x is tensor(121.5251, device='cuda:2')
benign distance is  tensor(121.5251, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.0429279059171677
distance x is tensor(109.0455, device='cuda:2')
benign distance is  tensor(109.0455, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7507732212543488
distance x is tensor(133.0786, device='cuda:2')
benign distance is  tensor(133.0786, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 618.5789,  467.7650,  415.4850,  580.3004,  485.6331,  474.5027,
         498.4901,  425.3334,  852.7554,  985.2527,  864.5344,  893.6027,
         824.4249,  888.8940,  944.0941,  835.8315,  950.1068,  885.8287,
         902.9983, 1034.0072], device='cuda:2')
sorted_norm is   tensor([ 415.4850,  425.3334,  467.7650,  474.5027,  485.6331,  498.4901,
         580.3004,  618.5789,  824.4249,  835.8315,  852.7554,  864.5344,
         885.8287,  888.8940,  893.6027,  902.9983,  944.0941,  950.1068,
         985.2527, 1034.0072], device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5,  4,  6,  3,  0, 12, 15,  8, 10, 17, 13, 11, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.7668175026774406
distance x is tensor(63.1272, device='cuda:2')
benign distance is  tensor(63.1272, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.594554156064987
distance x is tensor(45.6723, device='cuda:2')
benign distance is  tensor(45.6723, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.879125624895096
distance x is tensor(30.3993, device='cuda:2')
benign distance is  tensor(30.3993, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2488375529646873
distance x is tensor(102.0425, device='cuda:2')
benign distance is  tensor(102.0425, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9987058639526367
distance x is tensor(53.6991, device='cuda:2')
benign distance is  tensor(53.6991, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7898023575544357
distance x is tensor(11.8397, device='cuda:2')
benign distance is  tensor(11.8397, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.9466172605752945
distance x is tensor(60.1707, device='cuda:2')
benign distance is  tensor(60.1707, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.717091888189316
distance x is tensor(5.6155, device='cuda:2')
benign distance is  tensor(5.6155, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([473.9218, 457.9982, 353.3509, 680.5939, 435.9822, 222.3951, 502.7794,
        269.5888, 312.6002, 545.4932, 361.2363, 529.9835, 543.9547, 458.4575,
        456.2992, 479.0071, 408.1986, 580.2361, 418.1466, 656.4314, 729.5551,
        631.2501, 741.0623, 672.1816, 722.8572, 725.9245, 721.3586, 854.2324,
        663.6082, 734.3594, 578.5749, 664.8273, 790.9971, 556.6718, 780.8261,
        711.9467], device='cuda:2')
sorted_norm is   tensor([222.3951, 269.5888, 312.6002, 353.3509, 361.2363, 408.1986, 418.1466,
        435.9822, 456.2992, 457.9982, 458.4575, 473.9218, 479.0071, 502.7794,
        529.9835, 543.9547, 545.4932, 556.6718, 578.5749, 580.2361, 631.2501,
        656.4314, 663.6082, 664.8273, 672.1816, 680.5939, 711.9467, 721.3586,
        722.8572, 725.9245, 729.5551, 734.3594, 741.0623, 780.8261, 790.9971,
        854.2324], device='cuda:2')
used idx is  tensor([ 5,  7,  8,  2, 10, 16, 18,  4, 14,  1, 13,  0, 15,  6, 11, 12,  9, 33,
        30, 17, 21, 19, 28, 31, 23,  3, 35, 26], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 8.53% 

Test Accuracy: 14.39% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9924525655806065
distance x is tensor(143.3045, device='cuda:2')
benign distance is  tensor(143.3045, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0393692553043365
distance x is tensor(107.0535, device='cuda:2')
benign distance is  tensor(107.0535, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6085226237773895
distance x is tensor(89.9903, device='cuda:2')
benign distance is  tensor(89.9903, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.608123928308487
distance x is tensor(141.3988, device='cuda:2')
benign distance is  tensor(141.3988, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1686138212680817
distance x is tensor(115.1073, device='cuda:2')
benign distance is  tensor(115.1073, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8450962081551552
distance x is tensor(112.6272, device='cuda:2')
benign distance is  tensor(112.6272, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4990638121962547
distance x is tensor(118.4924, device='cuda:2')
benign distance is  tensor(118.4924, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8857855424284935
distance x is tensor(104.3248, device='cuda:2')
benign distance is  tensor(104.3248, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.5592287853360176
distance x is tensor(117.3643, device='cuda:2')
benign distance is  tensor(117.3643, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4670844301581383
distance x is tensor(124.5989, device='cuda:2')
benign distance is  tensor(124.5989, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3197645097970963
distance x is tensor(100.6630, device='cuda:2')
benign distance is  tensor(100.6630, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.9523496329784393
distance x is tensor(122.4227, device='cuda:2')
benign distance is  tensor(122.4227, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.811647519469261
distance x is tensor(147.1509, device='cuda:2')
benign distance is  tensor(147.1509, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.73434204980731
distance x is tensor(90.0296, device='cuda:2')
benign distance is  tensor(90.0296, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.598074734210968
distance x is tensor(143.5223, device='cuda:2')
benign distance is  tensor(143.5223, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.678471073508263
distance x is tensor(131.5714, device='cuda:2')
benign distance is  tensor(131.5714, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.932033896446228
distance x is tensor(130.8316, device='cuda:2')
benign distance is  tensor(130.8316, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.7313849925994873
distance x is tensor(96.0042, device='cuda:2')
benign distance is  tensor(96.0042, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.072435036301613
distance x is tensor(137.4751, device='cuda:2')
benign distance is  tensor(137.4751, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.18000365793705
distance x is tensor(115.7585, device='cuda:2')
benign distance is  tensor(115.7585, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.130634568631649
distance x is tensor(125.2119, device='cuda:2')
benign distance is  tensor(125.2119, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8000564873218536
distance x is tensor(150.2437, device='cuda:2')
benign distance is  tensor(150.2437, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6983905006200075
distance x is tensor(126.0250, device='cuda:2')
benign distance is  tensor(126.0250, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.291525185108185
distance x is tensor(148.1869, device='cuda:2')
benign distance is  tensor(148.1869, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([628.4971, 488.5346, 437.8673, 626.7779, 518.0073, 511.7023, 521.3288,
        478.7018, 704.5295, 834.5029, 701.3143, 740.3477, 679.1552, 727.2023,
        786.1562, 679.0175, 784.2329, 722.2546, 758.4210, 865.1165, 531.4752,
        550.8199, 591.6934, 655.0974, 524.4099, 940.7980, 739.6483, 612.4000],
       device='cuda:2')
sorted_norm is   tensor([437.8673, 478.7018, 488.5346, 511.7023, 518.0073, 521.3288, 524.4099,
        531.4752, 550.8199, 591.6934, 612.4000, 626.7779, 628.4971, 655.0974,
        679.0175, 679.1552, 701.3143, 704.5295, 722.2546, 727.2023, 739.6483,
        740.3477, 758.4210, 784.2329, 786.1562, 834.5029, 865.1165, 940.7980],
       device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5,  4,  6, 24, 20, 21, 22, 27,  3,  0, 23, 15, 12, 10,  8,
        17, 13, 26, 11], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 13.58% 

Test Accuracy: 35.13% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8310014493763447
distance x is tensor(144.2413, device='cuda:2')
benign distance is  tensor(144.2413, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3281875252723694
distance x is tensor(105.5480, device='cuda:2')
benign distance is  tensor(105.5480, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6786044538021088
distance x is tensor(89.5003, device='cuda:2')
benign distance is  tensor(89.5003, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5991758927702904
distance x is tensor(140.2341, device='cuda:2')
benign distance is  tensor(140.2341, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9482995346188545
distance x is tensor(105.8828, device='cuda:2')
benign distance is  tensor(105.8828, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7132486030459404
distance x is tensor(108.6649, device='cuda:2')
benign distance is  tensor(108.6649, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8594257831573486
distance x is tensor(119.2226, device='cuda:2')
benign distance is  tensor(119.2226, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.7654112204909325
distance x is tensor(97.5826, device='cuda:2')
benign distance is  tensor(97.5826, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.4038733541965485
distance x is tensor(97.4834, device='cuda:2')
benign distance is  tensor(97.4834, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1951641365885735
distance x is tensor(110.4677, device='cuda:2')
benign distance is  tensor(110.4677, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.906221017241478
distance x is tensor(118.2978, device='cuda:2')
benign distance is  tensor(118.2978, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.9239792823791504
distance x is tensor(122.7735, device='cuda:2')
benign distance is  tensor(122.7735, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.774827316403389
distance x is tensor(111.7450, device='cuda:2')
benign distance is  tensor(111.7450, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.745547503232956
distance x is tensor(196.6061, device='cuda:2')
benign distance is  tensor(196.6061, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9773507192730904
distance x is tensor(149.1905, device='cuda:2')
benign distance is  tensor(149.1905, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6943342760205269
distance x is tensor(122.2773, device='cuda:2')
benign distance is  tensor(122.2773, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([637.0904, 469.6249, 427.9819, 618.6000, 470.7416, 486.0518, 513.9302,
        428.5014, 802.0651, 905.3962, 791.6379, 828.3493, 770.5411, 822.7384,
        897.9734, 778.5934, 867.2201, 826.9294, 843.6663, 973.8087, 497.9330,
        552.5648, 411.1472, 517.1456, 633.0330, 377.1690, 599.9406, 549.0786],
       device='cuda:2')
sorted_norm is   tensor([377.1690, 411.1472, 427.9819, 428.5014, 469.6249, 470.7416, 486.0518,
        497.9330, 513.9302, 517.1456, 549.0786, 552.5648, 599.9406, 618.6000,
        633.0330, 637.0904, 770.5411, 778.5934, 791.6379, 802.0651, 822.7384,
        826.9294, 828.3493, 843.6663, 867.2201, 897.9734, 905.3962, 973.8087],
       device='cuda:2')
used idx is  tensor([25, 22,  2,  7,  1,  4,  5, 20,  6, 23, 27, 21, 26,  3, 24,  0, 12, 15,
        10,  8, 13, 17], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 22.05% 

Test Accuracy: 53.79% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.945747185498476
distance x is tensor(133.1747, device='cuda:2')
benign distance is  tensor(133.1747, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2654552161693573
distance x is tensor(101.4986, device='cuda:2')
benign distance is  tensor(101.4986, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3682417199015617
distance x is tensor(89.4286, device='cuda:2')
benign distance is  tensor(89.4286, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.8726149648427963
distance x is tensor(137.8334, device='cuda:2')
benign distance is  tensor(137.8334, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1149400621652603
distance x is tensor(112.6697, device='cuda:2')
benign distance is  tensor(112.6697, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.968675658106804
distance x is tensor(104.4464, device='cuda:2')
benign distance is  tensor(104.4464, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3204410821199417
distance x is tensor(108.5165, device='cuda:2')
benign distance is  tensor(108.5165, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1369803696870804
distance x is tensor(94.3680, device='cuda:2')
benign distance is  tensor(94.3680, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.467021018266678
distance x is tensor(104.7282, device='cuda:2')
benign distance is  tensor(104.7282, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.972680240869522
distance x is tensor(124.2819, device='cuda:2')
benign distance is  tensor(124.2819, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.4770003259181976
distance x is tensor(92.8821, device='cuda:2')
benign distance is  tensor(92.8821, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.663016080856323
distance x is tensor(111.6189, device='cuda:2')
benign distance is  tensor(111.6189, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.656749464571476
distance x is tensor(138.6770, device='cuda:2')
benign distance is  tensor(138.6770, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.4227843284606934
distance x is tensor(78.9935, device='cuda:2')
benign distance is  tensor(78.9935, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.5719015821814537
distance x is tensor(137.1420, device='cuda:2')
benign distance is  tensor(137.1420, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.473419800400734
distance x is tensor(120.1548, device='cuda:2')
benign distance is  tensor(120.1548, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([600.7601, 453.8956, 429.9533, 604.3120, 494.5201, 471.7580, 473.4062,
        440.3516, 814.9844, 943.8846, 830.4011, 865.2678, 798.6339, 859.7308,
        899.8993, 790.9360, 912.6567, 858.6428, 871.5770, 990.5499, 563.3708,
        477.8333, 570.4521, 545.2482, 576.7536, 483.5152, 443.6766, 563.9906],
       device='cuda:2')
sorted_norm is   tensor([429.9533, 440.3516, 443.6766, 453.8956, 471.7580, 473.4062, 477.8333,
        483.5152, 494.5201, 545.2482, 563.3708, 563.9906, 570.4521, 576.7536,
        600.7601, 604.3120, 790.9360, 798.6339, 814.9844, 830.4011, 858.6428,
        859.7308, 865.2678, 871.5770, 899.8993, 912.6567, 943.8846, 990.5499],
       device='cuda:2')
used idx is  tensor([ 2,  7, 26,  1,  5,  6, 21, 25,  4, 23, 20, 27, 22, 24,  0,  3, 15, 12,
         8, 10, 17, 13], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 26.06% 

Test Accuracy: 56.22% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0570482909679413
distance x is tensor(137.1759, device='cuda:2')
benign distance is  tensor(137.1759, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2368402406573296
distance x is tensor(104.6425, device='cuda:2')
benign distance is  tensor(104.6425, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.1991017684340477
distance x is tensor(84.9436, device='cuda:2')
benign distance is  tensor(84.9436, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2565941587090492
distance x is tensor(134.1839, device='cuda:2')
benign distance is  tensor(134.1839, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4799392744898796
distance x is tensor(103.9478, device='cuda:2')
benign distance is  tensor(103.9478, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3304993845522404
distance x is tensor(107.5973, device='cuda:2')
benign distance is  tensor(107.5973, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8550760373473167
distance x is tensor(110.1779, device='cuda:2')
benign distance is  tensor(110.1779, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.982387252151966
distance x is tensor(101.0912, device='cuda:2')
benign distance is  tensor(101.0912, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0082834549248219
distance x is tensor(121.6843, device='cuda:2')
benign distance is  tensor(121.6843, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.1099361404776573
distance x is tensor(107.3897, device='cuda:2')
benign distance is  tensor(107.3897, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.396991051733494
distance x is tensor(118.5568, device='cuda:2')
benign distance is  tensor(118.5568, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.571579948067665
distance x is tensor(116.3893, device='cuda:2')
benign distance is  tensor(116.3893, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.1005979105830193
distance x is tensor(118.3509, device='cuda:2')
benign distance is  tensor(118.3509, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.843906506896019
distance x is tensor(101.1720, device='cuda:2')
benign distance is  tensor(101.1720, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.9215359836816788
distance x is tensor(97.3608, device='cuda:2')
benign distance is  tensor(97.3608, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9706957712769508
distance x is tensor(118.5487, device='cuda:2')
benign distance is  tensor(118.5487, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 610.7886,  461.3548,  413.4041,  591.2814,  461.0522,  482.2750,
         486.9180,  467.1958,  853.1939,  972.4617,  853.6990,  908.7194,
         839.7960,  892.2053,  939.1323,  840.5474,  940.7192,  873.3895,
         907.1731, 1028.9546,  436.2590,  576.1636,  651.5893,  428.6262,
         617.7294,  560.0911,  502.6190,  598.6679,  531.6908,  479.4614,
         545.3836,  472.5244,  506.9247,  639.1863,  531.3010,  619.4759,
         424.8232,  477.3924,  502.1006,  519.7809,  463.2288,  838.3019,
         630.4152,  534.4239,  478.2274,  566.2281,  417.7800,  504.0926,
         632.6744,  369.4885,  607.8943,  549.7273], device='cuda:2')
sorted_norm is   tensor([ 369.4885,  413.4041,  417.7800,  424.8232,  428.6262,  436.2590,
         461.0522,  461.3548,  463.2288,  467.1958,  472.5244,  477.3924,
         478.2274,  479.4614,  482.2750,  486.9180,  502.1006,  502.6190,
         504.0926,  506.9247,  519.7809,  531.3010,  531.6908,  534.4239,
         545.3836,  549.7273,  560.0911,  566.2281,  576.1636,  591.2814,
         598.6679,  607.8943,  610.7886,  617.7294,  619.4759,  630.4152,
         632.6744,  639.1863,  651.5893,  838.3019,  839.7960,  840.5474,
         853.1939,  853.6990,  873.3895,  892.2053,  907.1731,  908.7194,
         939.1323,  940.7192,  972.4617, 1028.9546], device='cuda:2')
used idx is  tensor([49,  2, 46, 36, 23, 20,  4,  1, 40,  7, 31, 37, 44, 29,  5,  6, 38, 26,
        47, 32, 39, 34, 28, 43, 30, 51, 25, 45, 21,  3, 27, 50,  0, 24, 35, 42,
        48, 33, 22, 41, 12], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 40.83% 

Test Accuracy: 70.34% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8170871995389462
distance x is tensor(115.5649, device='cuda:2')
benign distance is  tensor(115.5649, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.122936263680458
distance x is tensor(87.9306, device='cuda:2')
benign distance is  tensor(87.9306, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3324191197752953
distance x is tensor(71.5741, device='cuda:2')
benign distance is  tensor(71.5741, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2028344571590424
distance x is tensor(116.5603, device='cuda:2')
benign distance is  tensor(116.5603, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1009208858013153
distance x is tensor(83.5476, device='cuda:2')
benign distance is  tensor(83.5476, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4025610871613026
distance x is tensor(81.7673, device='cuda:2')
benign distance is  tensor(81.7673, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.306696631014347
distance x is tensor(81.6098, device='cuda:2')
benign distance is  tensor(81.6098, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.518914185464382
distance x is tensor(76.3625, device='cuda:2')
benign distance is  tensor(76.3625, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.342285819351673
distance x is tensor(85.3479, device='cuda:2')
benign distance is  tensor(85.3479, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.211950108408928
distance x is tensor(105.8536, device='cuda:2')
benign distance is  tensor(105.8536, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.441966563463211
distance x is tensor(70.4875, device='cuda:2')
benign distance is  tensor(70.4875, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.7355330735445023
distance x is tensor(92.4882, device='cuda:2')
benign distance is  tensor(92.4882, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.9120821580290794
distance x is tensor(115.0167, device='cuda:2')
benign distance is  tensor(115.0167, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6822976879775524
distance x is tensor(54.4648, device='cuda:2')
benign distance is  tensor(54.4648, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7667959183454514
distance x is tensor(109.8546, device='cuda:2')
benign distance is  tensor(109.8546, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.015877425670624
distance x is tensor(89.6769, device='cuda:2')
benign distance is  tensor(89.6769, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.560164377093315
distance x is tensor(75.9398, device='cuda:2')
benign distance is  tensor(75.9398, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.942249596118927
distance x is tensor(83.1473, device='cuda:2')
benign distance is  tensor(83.1473, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5532139241695404
distance x is tensor(95.0777, device='cuda:2')
benign distance is  tensor(95.0777, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.0406125485897064
distance x is tensor(99.2503, device='cuda:2')
benign distance is  tensor(99.2503, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9067844972014427
distance x is tensor(87.6828, device='cuda:2')
benign distance is  tensor(87.6828, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.657498560845852
distance x is tensor(167.9361, device='cuda:2')
benign distance is  tensor(167.9361, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.6267145425081253
distance x is tensor(124.4075, device='cuda:2')
benign distance is  tensor(124.4075, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6006447300314903
distance x is tensor(86.7938, device='cuda:2')
benign distance is  tensor(86.7938, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.302448682487011
distance x is tensor(100.2806, device='cuda:2')
benign distance is  tensor(100.2806, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.6074324920773506
distance x is tensor(62.2954, device='cuda:2')
benign distance is  tensor(62.2954, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.5428894832730293
distance x is tensor(101.1217, device='cuda:2')
benign distance is  tensor(101.1217, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.2979566752910614
distance x is tensor(84.4073, device='cuda:2')
benign distance is  tensor(84.4073, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6119669899344444
distance x is tensor(91.9739, device='cuda:2')
benign distance is  tensor(91.9739, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.534526877105236
distance x is tensor(96.5852, device='cuda:2')
benign distance is  tensor(96.5852, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7372615095227957
distance x is tensor(92.0432, device='cuda:2')
benign distance is  tensor(92.0432, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.9271860346198082
distance x is tensor(124.8422, device='cuda:2')
benign distance is  tensor(124.8422, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.9381483048200607
distance x is tensor(82.4604, device='cuda:2')
benign distance is  tensor(82.4604, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.055086761713028
distance x is tensor(101.0001, device='cuda:2')
benign distance is  tensor(101.0001, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.690389908850193
distance x is tensor(124.8673, device='cuda:2')
benign distance is  tensor(124.8673, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.8733114451169968
distance x is tensor(73.7235, device='cuda:2')
benign distance is  tensor(73.7235, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.9372863546013832
distance x is tensor(120.4755, device='cuda:2')
benign distance is  tensor(120.4755, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.0598967373371124
distance x is tensor(107.5101, device='cuda:2')
benign distance is  tensor(107.5101, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.3975183740258217
distance x is tensor(78.4103, device='cuda:2')
benign distance is  tensor(78.4103, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6611554436385632
distance x is tensor(112.5970, device='cuda:2')
benign distance is  tensor(112.5970, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 535.9826,  405.4430,  360.2562,  518.1328,  395.4430,  380.4968,
         362.3403,  349.5358, 1194.8356, 1284.3807, 1198.1105, 1208.6552,
        1183.8888, 1218.4292, 1246.4952, 1173.8862, 1257.9731, 1188.9626,
        1230.4912, 1323.0986], device='cuda:2')
sorted_norm is   tensor([ 349.5358,  360.2562,  362.3403,  380.4968,  395.4430,  405.4430,
         518.1328,  535.9826, 1173.8862, 1183.8888, 1188.9626, 1194.8356,
        1198.1105, 1208.6552, 1218.4292, 1230.4912, 1246.4952, 1257.9731,
        1284.3807, 1323.0986], device='cuda:2')
used idx is  tensor([ 7,  2,  6,  5,  4,  1,  3,  0, 15, 12, 17,  8, 10, 11, 13, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.376934975385666
distance x is tensor(112.9050, device='cuda:2')
benign distance is  tensor(112.9050, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9065287932753563
distance x is tensor(66.5770, device='cuda:2')
benign distance is  tensor(66.5770, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.910015717148781
distance x is tensor(38.6048, device='cuda:2')
benign distance is  tensor(38.6048, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.1048555076122284
distance x is tensor(108.4336, device='cuda:2')
benign distance is  tensor(108.4336, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.7134980261325836
distance x is tensor(60.3550, device='cuda:2')
benign distance is  tensor(60.3550, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.0131776183843613
distance x is tensor(43.4390, device='cuda:2')
benign distance is  tensor(43.4390, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.67084763944149
distance x is tensor(86.7578, device='cuda:2')
benign distance is  tensor(86.7578, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9612228721380234
distance x is tensor(32.3816, device='cuda:2')
benign distance is  tensor(32.3816, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([700.5259, 509.4501, 366.4574, 703.6586, 540.7171, 365.0229, 596.2519,
        328.9720, 303.5246, 605.3875, 532.4882, 588.1676, 546.6821, 465.9238,
        553.6880, 530.8582, 456.9432, 561.4436, 578.3147, 657.7305, 741.1022,
        827.7781, 676.4897, 756.6092, 854.9105, 638.6663, 836.6304, 745.7297],
       device='cuda:2')
sorted_norm is   tensor([303.5246, 328.9720, 365.0229, 366.4574, 456.9432, 465.9238, 509.4501,
        530.8582, 532.4882, 540.7171, 546.6821, 553.6880, 561.4436, 578.3147,
        588.1676, 596.2519, 605.3875, 638.6663, 657.7305, 676.4897, 700.5259,
        703.6586, 741.1022, 745.7297, 756.6092, 827.7781, 836.6304, 854.9105],
       device='cuda:2')
used idx is  tensor([ 8,  7,  5,  2, 16, 13,  1, 15, 10,  4, 12, 14, 17, 18, 11,  6,  9, 25,
        19, 22,  0,  3], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 44.45% 

Test Accuracy: 10.00% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0524332113564014
distance x is tensor(135.6303, device='cuda:2')
benign distance is  tensor(135.6303, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4105712100863457
distance x is tensor(95.8271, device='cuda:2')
benign distance is  tensor(95.8271, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2911902740597725
distance x is tensor(64.9886, device='cuda:2')
benign distance is  tensor(64.9886, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2788751125335693
distance x is tensor(140.4821, device='cuda:2')
benign distance is  tensor(140.4821, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.40029539167881
distance x is tensor(107.1285, device='cuda:2')
benign distance is  tensor(107.1285, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2506057620048523
distance x is tensor(85.1741, device='cuda:2')
benign distance is  tensor(85.1741, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.614531770348549
distance x is tensor(112.2364, device='cuda:2')
benign distance is  tensor(112.2364, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6148637533187866
distance x is tensor(98.7464, device='cuda:2')
benign distance is  tensor(98.7464, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.382427953183651
distance x is tensor(106.1832, device='cuda:2')
benign distance is  tensor(106.1832, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8119648322463036
distance x is tensor(118.9703, device='cuda:2')
benign distance is  tensor(118.9703, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.6722552329301834
distance x is tensor(99.6278, device='cuda:2')
benign distance is  tensor(99.6278, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.174951493740082
distance x is tensor(108.5188, device='cuda:2')
benign distance is  tensor(108.5188, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.939179487526417
distance x is tensor(135.6031, device='cuda:2')
benign distance is  tensor(135.6031, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9827151000499725
distance x is tensor(64.5617, device='cuda:2')
benign distance is  tensor(64.5617, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7064414396882057
distance x is tensor(128.4030, device='cuda:2')
benign distance is  tensor(128.4030, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.8525116443634033
distance x is tensor(116.4592, device='cuda:2')
benign distance is  tensor(116.4592, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 687.0133,  531.3467,  412.9364,  694.7026,  569.1721,  467.3365,
         585.1580,  523.3399,  522.6075,  644.1744,  600.1754,  629.7463,
         566.9939,  530.4386,  651.0574,  545.8625,  619.0760,  604.5240,
         615.6666,  722.5022,  664.3250,  695.8507,  746.7128,  753.0128,
         694.5259, 1035.8678,  842.1617,  726.9507], device='cuda:2')
sorted_norm is   tensor([ 412.9364,  467.3365,  522.6075,  523.3399,  530.4386,  531.3467,
         545.8625,  566.9939,  569.1721,  585.1580,  600.1754,  604.5240,
         615.6666,  619.0760,  629.7463,  644.1744,  651.0574,  664.3250,
         687.0133,  694.5259,  694.7026,  695.8507,  722.5022,  726.9507,
         746.7128,  753.0128,  842.1617, 1035.8678], device='cuda:2')
used idx is  tensor([ 2,  5,  8,  7, 13,  1, 15, 12,  4,  6, 10, 17, 18, 16, 11,  9, 14, 20,
         0, 24,  3, 21], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0539532601833344
distance x is tensor(123.3400, device='cuda:2')
benign distance is  tensor(123.3400, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.365682192146778
distance x is tensor(91.2269, device='cuda:2')
benign distance is  tensor(91.2269, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.0571706295013428
distance x is tensor(63.0729, device='cuda:2')
benign distance is  tensor(63.0729, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4741068184375763
distance x is tensor(138.7790, device='cuda:2')
benign distance is  tensor(138.7790, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4222465455532074
distance x is tensor(99.2234, device='cuda:2')
benign distance is  tensor(99.2234, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7796724513173103
distance x is tensor(83.8275, device='cuda:2')
benign distance is  tensor(83.8275, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.110946625471115
distance x is tensor(105.0404, device='cuda:2')
benign distance is  tensor(105.0404, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8842975720763206
distance x is tensor(83.4224, device='cuda:2')
benign distance is  tensor(83.4224, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.1500033140182495
distance x is tensor(95.7818, device='cuda:2')
benign distance is  tensor(95.7818, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.9186347275972366
distance x is tensor(92.5608, device='cuda:2')
benign distance is  tensor(92.5608, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.9755237251520157
distance x is tensor(98.3510, device='cuda:2')
benign distance is  tensor(98.3510, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.1305161267518997
distance x is tensor(117.4284, device='cuda:2')
benign distance is  tensor(117.4284, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6330843642354012
distance x is tensor(102.0345, device='cuda:2')
benign distance is  tensor(102.0345, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4527603909373283
distance x is tensor(179.8431, device='cuda:2')
benign distance is  tensor(179.8431, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.1041908264160156
distance x is tensor(139.5993, device='cuda:2')
benign distance is  tensor(139.5993, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7135165333747864
distance x is tensor(114.9460, device='cuda:2')
benign distance is  tensor(114.9460, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([667.3965, 528.1216, 421.0596, 703.3857, 542.0288, 463.1672, 570.5731,
        482.0509, 529.2772, 701.9777, 601.1808, 658.7916, 592.4235, 573.3124,
        668.0383, 569.7469, 617.6431, 627.1490, 627.8276, 744.7001, 702.7860,
        626.7909, 696.0184, 665.7089, 684.3113, 614.1067, 590.5869, 703.0634,
        742.8538, 623.1631, 745.3262, 686.5406, 725.7876, 745.8774, 735.7592,
        847.1481, 587.7282, 656.5559, 556.1811, 616.7975, 717.8091, 423.3216,
        694.7057, 659.9160], device='cuda:2')
sorted_norm is   tensor([421.0596, 423.3216, 463.1672, 482.0509, 528.1216, 529.2772, 542.0288,
        556.1811, 569.7469, 570.5731, 573.3124, 587.7282, 590.5869, 592.4235,
        601.1808, 614.1067, 616.7975, 617.6431, 623.1631, 626.7909, 627.1490,
        627.8276, 656.5559, 658.7916, 659.9160, 665.7089, 667.3965, 668.0383,
        684.3113, 686.5406, 694.7057, 696.0184, 701.9777, 702.7860, 703.0634,
        703.3857, 717.8091, 725.7876, 735.7592, 742.8538, 744.7001, 745.3262,
        745.8774, 847.1481], device='cuda:2')
used idx is  tensor([ 2, 41,  5,  7,  1,  8,  4, 38, 15,  6, 13, 36, 26, 12, 10, 25, 39, 16,
        29, 21, 17, 18, 37, 11, 43, 23,  0, 14, 24, 31, 42, 22,  9, 20, 27],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 15.28% 

Test Accuracy: 36.17% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1638412438333035
distance x is tensor(142.2030, device='cuda:2')
benign distance is  tensor(142.2030, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2766293361783028
distance x is tensor(102.4241, device='cuda:2')
benign distance is  tensor(102.4241, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.452583387494087
distance x is tensor(85.7049, device='cuda:2')
benign distance is  tensor(85.7049, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.250957667827606
distance x is tensor(142.1272, device='cuda:2')
benign distance is  tensor(142.1272, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.786917559802532
distance x is tensor(113.8101, device='cuda:2')
benign distance is  tensor(113.8101, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5911644995212555
distance x is tensor(108.0088, device='cuda:2')
benign distance is  tensor(108.0088, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.997678242623806
distance x is tensor(115.3863, device='cuda:2')
benign distance is  tensor(115.3863, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.5915458723902702
distance x is tensor(102.6827, device='cuda:2')
benign distance is  tensor(102.6827, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.2991108894348145
distance x is tensor(105.9168, device='cuda:2')
benign distance is  tensor(105.9168, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7108488902449608
distance x is tensor(127.0400, device='cuda:2')
benign distance is  tensor(127.0400, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8920775204896927
distance x is tensor(95.2801, device='cuda:2')
benign distance is  tensor(95.2801, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.26130473613739
distance x is tensor(109.7788, device='cuda:2')
benign distance is  tensor(109.7788, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.9835429191589355
distance x is tensor(147.0024, device='cuda:2')
benign distance is  tensor(147.0024, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.579644836485386
distance x is tensor(84.2076, device='cuda:2')
benign distance is  tensor(84.2076, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.874993547797203
distance x is tensor(141.5221, device='cuda:2')
benign distance is  tensor(141.5221, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.682795211672783
distance x is tensor(117.0590, device='cuda:2')
benign distance is  tensor(117.0590, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.8712645396590233
distance x is tensor(125.1403, device='cuda:2')
benign distance is  tensor(125.1403, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.84822978079319
distance x is tensor(98.0309, device='cuda:2')
benign distance is  tensor(98.0309, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.416680082678795
distance x is tensor(130.9516, device='cuda:2')
benign distance is  tensor(130.9516, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.198210850358009
distance x is tensor(113.0282, device='cuda:2')
benign distance is  tensor(113.0282, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6790477335453033
distance x is tensor(121.3630, device='cuda:2')
benign distance is  tensor(121.3630, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.389286272227764
distance x is tensor(131.8420, device='cuda:2')
benign distance is  tensor(131.8420, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7530981712043285
distance x is tensor(120.6774, device='cuda:2')
benign distance is  tensor(120.6774, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.0383249521255493
distance x is tensor(143.0272, device='cuda:2')
benign distance is  tensor(143.0272, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0262719988822937
distance x is tensor(123.1236, device='cuda:2')
benign distance is  tensor(123.1236, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0902634859085083
distance x is tensor(104.6953, device='cuda:2')
benign distance is  tensor(104.6953, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.2334798127412796
distance x is tensor(118.4038, device='cuda:2')
benign distance is  tensor(118.4038, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.639729484915733
distance x is tensor(116.8223, device='cuda:2')
benign distance is  tensor(116.8223, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8555165193974972
distance x is tensor(122.5050, device='cuda:2')
benign distance is  tensor(122.5050, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.7855593487620354
distance x is tensor(100.5420, device='cuda:2')
benign distance is  tensor(100.5420, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.7011650651693344
distance x is tensor(102.8629, device='cuda:2')
benign distance is  tensor(102.8629, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.3216999433934689
distance x is tensor(122.9300, device='cuda:2')
benign distance is  tensor(122.9300, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([623.4388, 471.0836, 420.8828, 619.2461, 508.0143, 495.1361, 501.5082,
        462.4646, 770.3941, 868.6985, 759.3600, 789.7019, 738.4442, 792.2278,
        845.9849, 714.1249, 827.5078, 789.0535, 803.7742, 944.6837],
       device='cuda:2')
sorted_norm is   tensor([420.8828, 462.4646, 471.0836, 495.1361, 501.5082, 508.0143, 619.2461,
        623.4388, 714.1249, 738.4442, 759.3600, 770.3941, 789.0535, 789.7019,
        792.2278, 803.7742, 827.5078, 845.9849, 868.6985, 944.6837],
       device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5,  6,  4,  3,  0, 15, 12, 10,  8, 17, 11, 13, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3346938639879227
distance x is tensor(104.4734, device='cuda:2')
benign distance is  tensor(104.4734, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5977973267436028
distance x is tensor(72.5258, device='cuda:2')
benign distance is  tensor(72.5258, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6659420132637024
distance x is tensor(46.1937, device='cuda:2')
benign distance is  tensor(46.1937, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5610513985157013
distance x is tensor(112.2266, device='cuda:2')
benign distance is  tensor(112.2266, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.631564438343048
distance x is tensor(76.7551, device='cuda:2')
benign distance is  tensor(76.7551, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.0664383247494698
distance x is tensor(56.2465, device='cuda:2')
benign distance is  tensor(56.2465, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.536402478814125
distance x is tensor(85.4080, device='cuda:2')
benign distance is  tensor(85.4080, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.926410421729088
distance x is tensor(54.3253, device='cuda:2')
benign distance is  tensor(54.3253, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([718.0294, 534.9010, 384.8616, 726.0657, 575.0096, 432.2340, 601.5166,
        449.6727, 451.4330, 600.6951, 569.9093, 625.3414, 553.4697, 509.6564,
        639.6035, 562.9494, 535.7850, 601.3027, 575.5868, 686.5887, 703.3953,
        780.5284, 869.7836, 682.4005, 874.1434, 810.2849, 700.1380, 827.4723,
        577.0053, 577.1912, 573.7434, 644.7012, 581.4724, 904.7815, 742.2574,
        670.9661, 622.4455, 705.2756, 566.3726, 633.4552, 786.2565, 532.1116,
        765.6293, 662.8945], device='cuda:2')
sorted_norm is   tensor([384.8616, 432.2340, 449.6727, 451.4330, 509.6564, 532.1116, 534.9010,
        535.7850, 553.4697, 562.9494, 566.3726, 569.9093, 573.7434, 575.0096,
        575.5868, 577.0053, 577.1912, 581.4724, 600.6951, 601.3027, 601.5166,
        622.4455, 625.3414, 633.4552, 639.6035, 644.7012, 662.8945, 670.9661,
        682.4005, 686.5887, 700.1380, 703.3953, 705.2756, 718.0294, 726.0657,
        742.2574, 765.6293, 780.5284, 786.2565, 810.2849, 827.4723, 869.7836,
        874.1434, 904.7815], device='cuda:2')
used idx is  tensor([ 2,  5,  7,  8, 13, 41,  1, 16, 12, 15, 38, 10, 30,  4, 18, 28, 29, 32,
         9, 17,  6, 36, 11, 39, 14, 31, 43, 35, 23, 19, 26, 20, 37,  0,  3],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 13.88% 

Test Accuracy: 27.30% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9246129505336285
distance x is tensor(145.0161, device='cuda:2')
benign distance is  tensor(145.0161, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4223367795348167
distance x is tensor(111.1402, device='cuda:2')
benign distance is  tensor(111.1402, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.387787327170372
distance x is tensor(91.1054, device='cuda:2')
benign distance is  tensor(91.1054, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.339701287448406
distance x is tensor(148.0217, device='cuda:2')
benign distance is  tensor(148.0217, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7344075441360474
distance x is tensor(113.1073, device='cuda:2')
benign distance is  tensor(113.1073, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6950167790055275
distance x is tensor(110.6145, device='cuda:2')
benign distance is  tensor(110.6145, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.637818992137909
distance x is tensor(119.1716, device='cuda:2')
benign distance is  tensor(119.1716, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1299416050314903
distance x is tensor(99.9283, device='cuda:2')
benign distance is  tensor(99.9283, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.4479228779673576
distance x is tensor(106.8110, device='cuda:2')
benign distance is  tensor(106.8110, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8337369933724403
distance x is tensor(129.5615, device='cuda:2')
benign distance is  tensor(129.5615, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2909573018550873
distance x is tensor(96.6472, device='cuda:2')
benign distance is  tensor(96.6472, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.273729905486107
distance x is tensor(116.6378, device='cuda:2')
benign distance is  tensor(116.6378, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.555504336953163
distance x is tensor(149.4923, device='cuda:2')
benign distance is  tensor(149.4923, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9198604971170425
distance x is tensor(90.2035, device='cuda:2')
benign distance is  tensor(90.2035, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8851681500673294
distance x is tensor(137.6285, device='cuda:2')
benign distance is  tensor(137.6285, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.271522104740143
distance x is tensor(118.3899, device='cuda:2')
benign distance is  tensor(118.3899, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.6166681051254272
distance x is tensor(105.8152, device='cuda:2')
benign distance is  tensor(105.8152, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.586500473320484
distance x is tensor(103.4048, device='cuda:2')
benign distance is  tensor(103.4048, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5148652344942093
distance x is tensor(115.3941, device='cuda:2')
benign distance is  tensor(115.3941, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.144895277917385
distance x is tensor(132.1184, device='cuda:2')
benign distance is  tensor(132.1184, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.8605727776885033
distance x is tensor(105.2106, device='cuda:2')
benign distance is  tensor(105.2106, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3798353746533394
distance x is tensor(197.1378, device='cuda:2')
benign distance is  tensor(197.1378, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.8881739154458046
distance x is tensor(149.3675, device='cuda:2')
benign distance is  tensor(149.3675, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.5780811980366707
distance x is tensor(122.1134, device='cuda:2')
benign distance is  tensor(122.1134, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.9646147340536118
distance x is tensor(97.0226, device='cuda:2')
benign distance is  tensor(97.0226, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.6912909001111984
distance x is tensor(128.9791, device='cuda:2')
benign distance is  tensor(128.9791, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.937080256640911
distance x is tensor(152.9066, device='cuda:2')
benign distance is  tensor(152.9066, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.890360288321972
distance x is tensor(82.6700, device='cuda:2')
benign distance is  tensor(82.6700, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.9695818796753883
distance x is tensor(149.5511, device='cuda:2')
benign distance is  tensor(149.5511, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.053440548479557
distance x is tensor(124.9618, device='cuda:2')
benign distance is  tensor(124.9618, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.68598809838295
distance x is tensor(102.1533, device='cuda:2')
benign distance is  tensor(102.1533, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7603960558772087
distance x is tensor(139.7829, device='cuda:2')
benign distance is  tensor(139.7829, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([647.7206, 498.9309, 438.6959, 651.4222, 513.3333, 513.0512, 533.4841,
        462.3752, 729.1924, 858.0176, 733.3936, 770.4854, 695.5652, 770.8875,
        824.5898, 694.9936, 808.4992, 754.1345, 774.0453, 913.9200],
       device='cuda:2')
sorted_norm is   tensor([438.6959, 462.3752, 498.9309, 513.0512, 513.3333, 533.4841, 647.7206,
        651.4222, 694.9936, 695.5652, 729.1924, 733.3936, 754.1345, 770.4854,
        770.8875, 774.0453, 808.4992, 824.5898, 858.0176, 913.9200],
       device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5,  4,  6,  0,  3, 15, 12,  8, 10, 17, 11, 13, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.9462225064635277
distance x is tensor(77.5986, device='cuda:2')
benign distance is  tensor(77.5986, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.543611876666546
distance x is tensor(51.0043, device='cuda:2')
benign distance is  tensor(51.0043, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.57465061545372
distance x is tensor(30.1019, device='cuda:2')
benign distance is  tensor(30.1019, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.154333271086216
distance x is tensor(102.5654, device='cuda:2')
benign distance is  tensor(102.5654, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.661052867770195
distance x is tensor(51.7091, device='cuda:2')
benign distance is  tensor(51.7091, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.29093174636364
distance x is tensor(35.2460, device='cuda:2')
benign distance is  tensor(35.2460, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.461793527007103
distance x is tensor(70.3866, device='cuda:2')
benign distance is  tensor(70.3866, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.0119238793849945
distance x is tensor(31.8490, device='cuda:2')
benign distance is  tensor(31.8490, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([562.9974, 469.8425, 338.0135, 668.8367, 426.3117, 293.2864, 547.6548,
        335.8257, 311.7163, 550.0215, 369.6564, 556.4294, 530.8927, 458.4794,
        608.4279, 493.2506, 446.6500, 579.6228, 552.2899, 634.2761, 682.0707,
        592.7778, 704.3423, 650.1827, 674.7282, 713.5137, 683.8503, 768.7945,
        609.3521, 712.4466, 556.8436, 642.4840, 780.4319, 542.7370, 741.7180,
        655.5988], device='cuda:2')
sorted_norm is   tensor([293.2864, 311.7163, 335.8257, 338.0135, 369.6564, 426.3117, 446.6500,
        458.4794, 469.8425, 493.2506, 530.8927, 542.7370, 547.6548, 550.0215,
        552.2899, 556.4294, 556.8436, 562.9974, 579.6228, 592.7778, 608.4279,
        609.3521, 634.2761, 642.4840, 650.1827, 655.5988, 668.8367, 674.7282,
        682.0707, 683.8503, 704.3423, 712.4466, 713.5137, 741.7180, 768.7945,
        780.4319], device='cuda:2')
used idx is  tensor([ 5,  8,  7,  2, 10,  4, 16, 13,  1, 15, 12, 33,  6,  9, 18, 11, 30,  0,
        17, 21, 14, 28, 19, 31, 23, 35,  3, 24], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 6.12% 

Test Accuracy: 14.75% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7558964416384697
distance x is tensor(144.7130, device='cuda:2')
benign distance is  tensor(144.7130, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1466315388679504
distance x is tensor(107.5011, device='cuda:2')
benign distance is  tensor(107.5011, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.1332734674215317
distance x is tensor(87.5549, device='cuda:2')
benign distance is  tensor(87.5549, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.2353145331144333
distance x is tensor(142.2500, device='cuda:2')
benign distance is  tensor(142.2500, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.600535102188587
distance x is tensor(118.3819, device='cuda:2')
benign distance is  tensor(118.3819, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7368568032979965
distance x is tensor(109.1177, device='cuda:2')
benign distance is  tensor(109.1177, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3967070654034615
distance x is tensor(117.8196, device='cuda:2')
benign distance is  tensor(117.8196, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.008034683763981
distance x is tensor(101.0422, device='cuda:2')
benign distance is  tensor(101.0422, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.278943344950676
distance x is tensor(104.8347, device='cuda:2')
benign distance is  tensor(104.8347, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.5752475783228874
distance x is tensor(125.9428, device='cuda:2')
benign distance is  tensor(125.9428, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.384169653058052
distance x is tensor(99.5868, device='cuda:2')
benign distance is  tensor(99.5868, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5889108180999756
distance x is tensor(121.2492, device='cuda:2')
benign distance is  tensor(121.2492, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.7269556671380997
distance x is tensor(137.5191, device='cuda:2')
benign distance is  tensor(137.5191, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6420531272888184
distance x is tensor(90.4951, device='cuda:2')
benign distance is  tensor(90.4951, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.819885402917862
distance x is tensor(136.6560, device='cuda:2')
benign distance is  tensor(136.6560, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.9699413180351257
distance x is tensor(127.0593, device='cuda:2')
benign distance is  tensor(127.0593, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9362933039665222
distance x is tensor(126.6219, device='cuda:2')
benign distance is  tensor(126.6219, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.945232130587101
distance x is tensor(80.8802, device='cuda:2')
benign distance is  tensor(80.8802, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.2638508453965187
distance x is tensor(134.3619, device='cuda:2')
benign distance is  tensor(134.3619, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.042953163385391
distance x is tensor(110.3996, device='cuda:2')
benign distance is  tensor(110.3996, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.734973005950451
distance x is tensor(126.3948, device='cuda:2')
benign distance is  tensor(126.3948, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.3163674399256706
distance x is tensor(125.3651, device='cuda:2')
benign distance is  tensor(125.3651, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7717607468366623
distance x is tensor(116.1722, device='cuda:2')
benign distance is  tensor(116.1722, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.390072137117386
distance x is tensor(144.2153, device='cuda:2')
benign distance is  tensor(144.2153, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([651.9051, 491.2840, 440.9258, 641.2579, 532.9262, 508.6169, 532.7572,
        471.4699, 667.5562, 787.5679, 668.9135, 716.2239, 647.3996, 694.8077,
        776.9452, 657.6976, 748.2966, 700.5032, 722.6860, 846.3368, 624.2546,
        528.4703, 612.2269, 578.8781, 617.4086, 515.6740, 514.8381, 627.3048,
        513.0659, 527.8591, 569.1190, 627.0167, 514.6090, 915.1069, 692.1199,
        613.8658], device='cuda:2')
sorted_norm is   tensor([440.9258, 471.4699, 491.2840, 508.6169, 513.0659, 514.6090, 514.8381,
        515.6740, 527.8591, 528.4703, 532.7572, 532.9262, 569.1190, 578.8781,
        612.2269, 613.8658, 617.4086, 624.2546, 627.0167, 627.3048, 641.2579,
        647.3996, 651.9051, 657.6976, 667.5562, 668.9135, 692.1199, 694.8077,
        700.5032, 716.2239, 722.6860, 748.2966, 776.9452, 787.5679, 846.3368,
        915.1069], device='cuda:2')
used idx is  tensor([ 2,  7,  1,  5, 28, 32, 26, 25, 29, 21,  6,  4, 30, 23, 22, 35, 24, 20,
        31, 27,  3, 12,  0, 15,  8, 10, 34, 13], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 32.29% 

Test Accuracy: 62.26% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0524879693984985
distance x is tensor(126.6832, device='cuda:2')
benign distance is  tensor(126.6832, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4859427139163017
distance x is tensor(98.4337, device='cuda:2')
benign distance is  tensor(98.4337, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9114207550883293
distance x is tensor(78.0684, device='cuda:2')
benign distance is  tensor(78.0684, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5732077956199646
distance x is tensor(129.1893, device='cuda:2')
benign distance is  tensor(129.1893, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.801418974995613
distance x is tensor(97.9676, device='cuda:2')
benign distance is  tensor(97.9676, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5861559361219406
distance x is tensor(92.0769, device='cuda:2')
benign distance is  tensor(92.0769, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.673664376139641
distance x is tensor(94.8580, device='cuda:2')
benign distance is  tensor(94.8580, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1117159724235535
distance x is tensor(86.9764, device='cuda:2')
benign distance is  tensor(86.9764, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.0596663802862167
distance x is tensor(89.2926, device='cuda:2')
benign distance is  tensor(89.2926, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.0726334154605865
distance x is tensor(92.9528, device='cuda:2')
benign distance is  tensor(92.9528, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.089187830686569
distance x is tensor(113.6735, device='cuda:2')
benign distance is  tensor(113.6735, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.532665565609932
distance x is tensor(116.1882, device='cuda:2')
benign distance is  tensor(116.1882, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.016860894858837
distance x is tensor(88.3452, device='cuda:2')
benign distance is  tensor(88.3452, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5876689329743385
distance x is tensor(179.7216, device='cuda:2')
benign distance is  tensor(179.7216, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5988157466053963
distance x is tensor(140.9205, device='cuda:2')
benign distance is  tensor(140.9205, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.0538749396800995
distance x is tensor(102.5695, device='cuda:2')
benign distance is  tensor(102.5695, device='cuda:2')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0639486648142338
distance x is tensor(109.2865, device='cuda:2')
benign distance is  tensor(109.2865, device='cuda:2')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.011174686253071
distance x is tensor(94.2398, device='cuda:2')
benign distance is  tensor(94.2398, device='cuda:2')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.2732780650258064
distance x is tensor(110.1517, device='cuda:2')
benign distance is  tensor(110.1517, device='cuda:2')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.864705502986908
distance x is tensor(105.6777, device='cuda:2')
benign distance is  tensor(105.6777, device='cuda:2')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9818027429282665
distance x is tensor(111.0937, device='cuda:2')
benign distance is  tensor(111.0937, device='cuda:2')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9915760159492493
distance x is tensor(90.4892, device='cuda:2')
benign distance is  tensor(90.4892, device='cuda:2')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.183443807065487
distance x is tensor(92.8960, device='cuda:2')
benign distance is  tensor(92.8960, device='cuda:2')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8759926296770573
distance x is tensor(110.1801, device='cuda:2')
benign distance is  tensor(110.1801, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 566.6847,  442.9645,  393.8636,  571.2305,  448.8419,  429.2188,
         418.7493,  395.8740,  919.7592, 1047.3960,  917.8061, 1028.0818,
         911.7523,  980.2930, 1003.1609,  925.6738,  996.1835,  944.5646,
         972.0300, 1085.1707,  412.7148,  503.9863,  371.2258,  477.5956,
         552.2042,  345.1120,  523.5034,  506.4610], device='cuda:2')
sorted_norm is   tensor([ 345.1120,  371.2258,  393.8636,  395.8740,  412.7148,  418.7493,
         429.2188,  442.9645,  448.8419,  477.5956,  503.9863,  506.4610,
         523.5034,  552.2042,  566.6847,  571.2305,  911.7523,  917.8061,
         919.7592,  925.6738,  944.5646,  972.0300,  980.2930,  996.1835,
        1003.1609, 1028.0818, 1047.3960, 1085.1707], device='cuda:2')
used idx is  tensor([25, 22,  2,  7, 20,  6,  5,  1,  4, 23, 21, 27, 26, 24,  0,  3, 12, 10,
         8, 15, 17, 18], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 21.14% 

Test Accuracy: 55.32% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9056823588907719
distance x is tensor(138.7611, device='cuda:2')
benign distance is  tensor(138.7611, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.309814475476742
distance x is tensor(102.7448, device='cuda:2')
benign distance is  tensor(102.7448, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.727448210120201
distance x is tensor(86.7271, device='cuda:2')
benign distance is  tensor(86.7271, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.4473636746406555
distance x is tensor(139.4716, device='cuda:2')
benign distance is  tensor(139.4716, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7918642461299896
distance x is tensor(108.4786, device='cuda:2')
benign distance is  tensor(108.4786, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6788164228200912
distance x is tensor(106.1147, device='cuda:2')
benign distance is  tensor(106.1147, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4548041820526123
distance x is tensor(114.1622, device='cuda:2')
benign distance is  tensor(114.1622, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.297576569020748
distance x is tensor(92.4890, device='cuda:2')
benign distance is  tensor(92.4890, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.6726469099521637
distance x is tensor(104.9954, device='cuda:2')
benign distance is  tensor(104.9954, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7949047610163689
distance x is tensor(121.2734, device='cuda:2')
benign distance is  tensor(121.2734, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2159950137138367
distance x is tensor(89.9637, device='cuda:2')
benign distance is  tensor(89.9637, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.408073931932449
distance x is tensor(109.5306, device='cuda:2')
benign distance is  tensor(109.5306, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.812562294304371
distance x is tensor(139.8658, device='cuda:2')
benign distance is  tensor(139.8658, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.0032792538404465
distance x is tensor(83.8181, device='cuda:2')
benign distance is  tensor(83.8181, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.1357688419520855
distance x is tensor(133.4786, device='cuda:2')
benign distance is  tensor(133.4786, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.3830538392066956
distance x is tensor(114.4730, device='cuda:2')
benign distance is  tensor(114.4730, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([616.3324, 459.7741, 424.1357, 612.3401, 488.2992, 489.9676, 504.3429,
        427.6510, 801.7217, 932.8379, 818.7753, 866.8146, 786.6281, 864.6653,
        902.7582, 770.5443, 883.4036, 829.4662, 843.6392, 979.5196],
       device='cuda:2')
sorted_norm is   tensor([424.1357, 427.6510, 459.7741, 488.2992, 489.9676, 504.3429, 612.3401,
        616.3324, 770.5443, 786.6281, 801.7217, 818.7753, 829.4662, 843.6392,
        864.6653, 866.8146, 883.4036, 902.7582, 932.8379, 979.5196],
       device='cuda:2')
used idx is  tensor([ 2,  7,  1,  4,  5,  6,  3,  0, 15, 12,  8, 10, 17, 18, 13, 11],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.5682612359523773
distance x is tensor(32.0862, device='cuda:2')
benign distance is  tensor(32.0862, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9610473960638046
distance x is tensor(53.2705, device='cuda:2')
benign distance is  tensor(53.2705, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.354627698659897
distance x is tensor(28.4838, device='cuda:2')
benign distance is  tensor(28.4838, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.9257430732250214
distance x is tensor(105.0925, device='cuda:2')
benign distance is  tensor(105.0925, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9330647587776184
distance x is tensor(78.5398, device='cuda:2')
benign distance is  tensor(78.5398, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7168803066015244
distance x is tensor(11.2336, device='cuda:2')
benign distance is  tensor(11.2336, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8841071873903275
distance x is tensor(78.0597, device='cuda:2')
benign distance is  tensor(78.0597, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.7175519466400146
distance x is tensor(8.6311, device='cuda:2')
benign distance is  tensor(8.6311, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([320.8273, 469.0195, 329.9241, 663.2357, 486.1280, 222.8153, 550.7859,
        273.7406, 323.3203, 573.6012, 364.7677, 560.6341, 525.0420, 440.0771,
        545.5829, 492.4195, 426.2318, 540.5191, 489.9820, 596.3571, 570.2772,
        702.6487, 790.8774, 519.0237, 789.1500, 678.4988, 594.1146, 749.6747,
        674.1350, 484.6587, 692.0172, 608.6439, 656.3763, 664.9691, 647.7603,
        736.2711, 616.1425, 644.7771, 719.5113, 727.4034, 621.4977, 985.3132,
        820.3336, 701.0347, 637.5289, 718.1713, 570.4385, 649.4003, 783.1038,
        558.7665, 758.2725, 677.7673], device='cuda:2')
sorted_norm is   tensor([222.8153, 273.7406, 320.8273, 323.3203, 329.9241, 364.7677, 426.2318,
        440.0771, 469.0195, 484.6587, 486.1280, 489.9820, 492.4195, 519.0237,
        525.0420, 540.5191, 545.5829, 550.7859, 558.7665, 560.6341, 570.2772,
        570.4385, 573.6012, 594.1146, 596.3571, 608.6439, 616.1425, 621.4977,
        637.5289, 644.7771, 647.7603, 649.4003, 656.3763, 663.2357, 664.9691,
        674.1350, 677.7673, 678.4988, 692.0172, 701.0347, 702.6487, 718.1713,
        719.5113, 727.4034, 736.2711, 749.6747, 758.2725, 783.1038, 789.1500,
        790.8774, 820.3336, 985.3132], device='cuda:2')
used idx is  tensor([ 5,  7,  0,  8,  2, 10, 16, 13,  1, 29,  4, 18, 15, 23, 12, 17, 14,  6,
        49, 11, 20, 46,  9, 26, 19, 31, 36, 40, 44, 37, 34, 47, 32,  3, 33, 28,
        51, 25, 30, 43, 21], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 33.07% 

Test Accuracy: 56.53% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7887709774076939
distance x is tensor(133.1928, device='cuda:2')
benign distance is  tensor(133.1928, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.036175638437271
distance x is tensor(103.9085, device='cuda:2')
benign distance is  tensor(103.9085, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.801524430513382
distance x is tensor(80.7964, device='cuda:2')
benign distance is  tensor(80.7964, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4874983355402946
distance x is tensor(134.2131, device='cuda:2')
benign distance is  tensor(134.2131, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6979975253343582
distance x is tensor(115.3931, device='cuda:2')
benign distance is  tensor(115.3931, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.550248071551323
distance x is tensor(99.4256, device='cuda:2')
benign distance is  tensor(99.4256, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4907457530498505
distance x is tensor(105.8657, device='cuda:2')
benign distance is  tensor(105.8657, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.845876306295395
distance x is tensor(93.6656, device='cuda:2')
benign distance is  tensor(93.6656, device='cuda:2')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9801515638828278
distance x is tensor(101.3147, device='cuda:2')
benign distance is  tensor(101.3147, device='cuda:2')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.1097110733389854
distance x is tensor(123.6454, device='cuda:2')
benign distance is  tensor(123.6454, device='cuda:2')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.4835434779524803
distance x is tensor(88.8179, device='cuda:2')
benign distance is  tensor(88.8179, device='cuda:2')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.54034560918808
distance x is tensor(107.8098, device='cuda:2')
benign distance is  tensor(107.8098, device='cuda:2')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.605619765818119
distance x is tensor(132.1857, device='cuda:2')
benign distance is  tensor(132.1857, device='cuda:2')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.1002145558595657
distance x is tensor(79.3324, device='cuda:2')
benign distance is  tensor(79.3324, device='cuda:2')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6212969049811363
distance x is tensor(134.9809, device='cuda:2')
benign distance is  tensor(134.9809, device='cuda:2')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.864419460296631
distance x is tensor(114.0891, device='cuda:2')
benign distance is  tensor(114.0891, device='cuda:2')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.5260203778743744
distance x is tensor(92.4235, device='cuda:2')
benign distance is  tensor(92.4235, device='cuda:2')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.0407895296812057
distance x is tensor(96.2477, device='cuda:2')
benign distance is  tensor(96.2477, device='cuda:2')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.524163782596588
distance x is tensor(112.3115, device='cuda:2')
benign distance is  tensor(112.3115, device='cuda:2')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.2565924301743507
distance x is tensor(127.2691, device='cuda:2')
benign distance is  tensor(127.2691, device='cuda:2')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.011229783296585
distance x is tensor(97.3990, device='cuda:2')
benign distance is  tensor(97.3990, device='cuda:2')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.235326413065195
distance x is tensor(193.4614, device='cuda:2')
benign distance is  tensor(193.4614, device='cuda:2')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7319937646389008
distance x is tensor(146.4846, device='cuda:2')
benign distance is  tensor(146.4846, device='cuda:2')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.659328356385231
distance x is tensor(116.0606, device='cuda:2')
benign distance is  tensor(116.0606, device='cuda:2')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.587188571691513
distance x is tensor(118.9932, device='cuda:2')
benign distance is  tensor(118.9932, device='cuda:2')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.6486331149935722
distance x is tensor(85.0235, device='cuda:2')
benign distance is  tensor(85.0235, device='cuda:2')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.394321396946907
distance x is tensor(123.1394, device='cuda:2')
benign distance is  tensor(123.1394, device='cuda:2')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.405147537589073
distance x is tensor(105.5086, device='cuda:2')
benign distance is  tensor(105.5086, device='cuda:2')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.583369329571724
distance x is tensor(110.1481, device='cuda:2')
benign distance is  tensor(110.1481, device='cuda:2')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.215720519423485
distance x is tensor(124.8089, device='cuda:2')
benign distance is  tensor(124.8089, device='cuda:2')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6995784062892199
distance x is tensor(111.8575, device='cuda:2')
benign distance is  tensor(111.8575, device='cuda:2')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.5692549347877502
distance x is tensor(141.7341, device='cuda:2')
benign distance is  tensor(141.7341, device='cuda:2')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.3812780380249023
distance x is tensor(93.4286, device='cuda:2')
benign distance is  tensor(93.4286, device='cuda:2')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  4.34792797267437
distance x is tensor(123.8228, device='cuda:2')
benign distance is  tensor(123.8228, device='cuda:2')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.6273511350154877
distance x is tensor(143.9379, device='cuda:2')
benign distance is  tensor(143.9379, device='cuda:2')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.7518429905176163
distance x is tensor(81.5505, device='cuda:2')
benign distance is  tensor(81.5505, device='cuda:2')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.8431514725089073
distance x is tensor(139.5120, device='cuda:2')
benign distance is  tensor(139.5120, device='cuda:2')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.385713964700699
distance x is tensor(118.5142, device='cuda:2')
benign distance is  tensor(118.5142, device='cuda:2')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.2115895599126816
distance x is tensor(96.0985, device='cuda:2')
benign distance is  tensor(96.0985, device='cuda:2')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6314141545444727
distance x is tensor(130.6246, device='cuda:2')
benign distance is  tensor(130.6246, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([598.3485, 471.8577, 394.6001, 595.8129, 517.1630, 466.6210, 466.4390,
        428.8671, 824.3979, 956.7883, 829.2928, 859.1163, 796.5696, 853.9562,
        902.0260, 786.2845, 882.9916, 843.3139, 866.3223, 971.3362],
       device='cuda:2')
sorted_norm is   tensor([394.6001, 428.8671, 466.4390, 466.6210, 471.8577, 517.1630, 595.8129,
        598.3485, 786.2845, 796.5696, 824.3979, 829.2928, 843.3139, 853.9562,
        859.1163, 866.3223, 882.9916, 902.0260, 956.7883, 971.3362],
       device='cuda:2')
used idx is  tensor([ 2,  7,  6,  5,  1,  4,  3,  0, 15, 12,  8, 10, 17, 13, 11, 18],
       device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3341112397611141
distance x is tensor(94.6951, device='cuda:2')
benign distance is  tensor(94.6951, device='cuda:2')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4587422013282776
distance x is tensor(65.3273, device='cuda:2')
benign distance is  tensor(65.3273, device='cuda:2')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6790239810943604
distance x is tensor(42.1215, device='cuda:2')
benign distance is  tensor(42.1215, device='cuda:2')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.602634906768799
distance x is tensor(117.7462, device='cuda:2')
benign distance is  tensor(117.7462, device='cuda:2')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.462768591940403
distance x is tensor(74.6439, device='cuda:2')
benign distance is  tensor(74.6439, device='cuda:2')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.1458686366677284
distance x is tensor(47.6576, device='cuda:2')
benign distance is  tensor(47.6576, device='cuda:2')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.774039641022682
distance x is tensor(96.6767, device='cuda:2')
benign distance is  tensor(96.6767, device='cuda:2')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.849509835243225
distance x is tensor(12.7660, device='cuda:2')
benign distance is  tensor(12.7660, device='cuda:2')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([599.5421, 499.3752, 382.3856, 735.4568, 552.0740, 358.2232, 639.1520,
        267.8837, 312.3977, 607.0082, 511.5672, 597.2641, 531.6071, 460.1996,
        600.5057, 511.9429, 480.0460, 565.1378, 538.4089, 657.4097, 724.0159,
        652.4935, 736.9605, 695.2021, 721.0793, 648.3267, 649.3998, 728.0963,
        631.0093, 732.2120, 573.2667, 652.2201, 764.6870, 548.0356, 777.4175,
        678.4805], device='cuda:2')
sorted_norm is   tensor([267.8837, 312.3977, 358.2232, 382.3856, 460.1996, 480.0460, 499.3752,
        511.5672, 511.9429, 531.6071, 538.4089, 548.0356, 552.0740, 565.1378,
        573.2667, 597.2641, 599.5421, 600.5057, 607.0082, 631.0093, 639.1520,
        648.3267, 649.3998, 652.2201, 652.4935, 657.4097, 678.4805, 695.2021,
        721.0793, 724.0159, 728.0963, 732.2120, 735.4568, 736.9605, 764.6870,
        777.4175], device='cuda:2')
used idx is  tensor([ 7,  8,  5,  2, 13, 16,  1, 10, 15, 12, 18, 33,  4, 17, 30, 11,  0, 14,
         9, 28,  6, 25, 26, 31, 21, 19, 35, 23], device='cuda:2')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 30.48% 

Test Accuracy: 24.56% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 30.48%
|----0th round Training Accuracy : 0.00%
|----1th round Training Accuracy : 0.00%
|----2th round Training Accuracy : 0.00%
|----3th round Training Accuracy : 0.56%
|----4th round Training Accuracy : 0.00%
|----5th round Training Accuracy : 0.36%
|----6th round Training Accuracy : 0.00%
|----7th round Training Accuracy : 13.46%
|----8th round Training Accuracy : 12.66%
|----9th round Training Accuracy : 6.85%
|----10th round Training Accuracy : 0.00%
|----11th round Training Accuracy : 21.27%
|----12th round Training Accuracy : 0.00%
|----13th round Training Accuracy : 13.55%
|----14th round Training Accuracy : 12.19%
|----15th round Training Accuracy : 34.90%
|----16th round Training Accuracy : 0.00%
|----17th round Training Accuracy : 14.24%
|----18th round Training Accuracy : 0.00%
|----19th round Training Accuracy : 27.30%
|----20th round Training Accuracy : 13.02%
|----21th round Training Accuracy : 21.21%
|----22th round Training Accuracy : 0.00%
|----23th round Training Accuracy : 35.29%
|----24th round Training Accuracy : 20.49%
|----25th round Training Accuracy : 26.70%
|----26th round Training Accuracy : 20.43%
|----27th round Training Accuracy : 41.95%
|----28th round Training Accuracy : 0.00%
|----29th round Training Accuracy : 28.14%
|----30th round Training Accuracy : 0.00%
|----31th round Training Accuracy : 8.53%
|----32th round Training Accuracy : 13.58%
|----33th round Training Accuracy : 22.05%
|----34th round Training Accuracy : 26.06%
|----35th round Training Accuracy : 40.83%
|----36th round Training Accuracy : 0.00%
|----37th round Training Accuracy : 44.45%
|----38th round Training Accuracy : 0.00%
|----39th round Training Accuracy : 15.28%
|----40th round Training Accuracy : 0.00%
|----41th round Training Accuracy : 13.88%
|----42th round Training Accuracy : 0.00%
|----43th round Training Accuracy : 6.12%
|----44th round Training Accuracy : 32.29%
|----45th round Training Accuracy : 21.14%
|----46th round Training Accuracy : 0.00%
|----47th round Training Accuracy : 33.07%
|----48th round Training Accuracy : 0.00%
|----49th round Training Accuracy : 30.48%
|----Final Test Accuracy: 24.56%
|----0th round Final Test Accuracy : 10.00%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 10.00%
|----3th round Final Test Accuracy : 10.35%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 15.41%
|----6th round Final Test Accuracy : 10.00%
|----7th round Final Test Accuracy : 21.69%
|----8th round Final Test Accuracy : 42.94%
|----9th round Final Test Accuracy : 36.28%
|----10th round Final Test Accuracy : 10.00%
|----11th round Final Test Accuracy : 52.17%
|----12th round Final Test Accuracy : 10.00%
|----13th round Final Test Accuracy : 10.00%
|----14th round Final Test Accuracy : 43.55%
|----15th round Final Test Accuracy : 63.55%
|----16th round Final Test Accuracy : 10.00%
|----17th round Final Test Accuracy : 43.69%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 36.66%
|----20th round Final Test Accuracy : 31.67%
|----21th round Final Test Accuracy : 53.36%
|----22th round Final Test Accuracy : 10.00%
|----23th round Final Test Accuracy : 56.30%
|----24th round Final Test Accuracy : 47.30%
|----25th round Final Test Accuracy : 55.40%
|----26th round Final Test Accuracy : 53.13%
|----27th round Final Test Accuracy : 68.61%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 57.18%
|----30th round Final Test Accuracy : 10.00%
|----31th round Final Test Accuracy : 14.39%
|----32th round Final Test Accuracy : 35.13%
|----33th round Final Test Accuracy : 53.79%
|----34th round Final Test Accuracy : 56.22%
|----35th round Final Test Accuracy : 70.34%
|----36th round Final Test Accuracy : 10.00%
|----37th round Final Test Accuracy : 10.00%
|----38th round Final Test Accuracy : 10.00%
|----39th round Final Test Accuracy : 36.17%
|----40th round Final Test Accuracy : 10.00%
|----41th round Final Test Accuracy : 27.30%
|----42th round Final Test Accuracy : 10.00%
|----43th round Final Test Accuracy : 14.75%
|----44th round Final Test Accuracy : 62.26%
|----45th round Final Test Accuracy : 55.32%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 56.53%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 24.56%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 3048.1083
