
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6680732667446136
distance x is tensor(121.3502, device='cuda:3')
benign distance is  tensor(121.3502, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.754670069552958
distance x is tensor(105.3576, device='cuda:3')
benign distance is  tensor(105.3576, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.584369596093893
distance x is tensor(106.5403, device='cuda:3')
benign distance is  tensor(106.5403, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0173941534012556
distance x is tensor(153.9964, device='cuda:3')
benign distance is  tensor(153.9964, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8406791146844625
distance x is tensor(98.0235, device='cuda:3')
benign distance is  tensor(98.0235, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7238443135283887
distance x is tensor(94.7284, device='cuda:3')
benign distance is  tensor(94.7284, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0828129798173904
distance x is tensor(107.7830, device='cuda:3')
benign distance is  tensor(107.7830, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7126481607556343
distance x is tensor(87.6034, device='cuda:3')
benign distance is  tensor(87.6034, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8951948620378971
distance x is tensor(114.3413, device='cuda:3')
benign distance is  tensor(114.3413, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7774994280189276
distance x is tensor(126.3902, device='cuda:3')
benign distance is  tensor(126.3902, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2156775705516338
distance x is tensor(89.6095, device='cuda:3')
benign distance is  tensor(89.6095, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.166675876826048
distance x is tensor(123.1720, device='cuda:3')
benign distance is  tensor(123.1720, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.154990404844284
distance x is tensor(165.2964, device='cuda:3')
benign distance is  tensor(165.2964, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6132147135213017
distance x is tensor(67.0471, device='cuda:3')
benign distance is  tensor(67.0471, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9991195304319263
distance x is tensor(145.3982, device='cuda:3')
benign distance is  tensor(145.3982, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1872545704245567
distance x is tensor(130.6843, device='cuda:3')
benign distance is  tensor(130.6843, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.344394251704216
distance x is tensor(144.7127, device='cuda:3')
benign distance is  tensor(144.7127, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5858330838382244
distance x is tensor(115.6249, device='cuda:3')
benign distance is  tensor(115.6249, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.025199055671692
distance x is tensor(123.9846, device='cuda:3')
benign distance is  tensor(123.9846, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7599972430616617
distance x is tensor(117.3179, device='cuda:3')
benign distance is  tensor(117.3179, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.015893978998065
distance x is tensor(86.1394, device='cuda:3')
benign distance is  tensor(86.1394, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7467639185488224
distance x is tensor(212.2410, device='cuda:3')
benign distance is  tensor(212.2410, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0003525279462337
distance x is tensor(153.1488, device='cuda:3')
benign distance is  tensor(153.1488, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6557785551995039
distance x is tensor(115.1114, device='cuda:3')
benign distance is  tensor(115.1114, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9304684288799763
distance x is tensor(124.8924, device='cuda:3')
benign distance is  tensor(124.8924, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5564678404480219
distance x is tensor(77.7457, device='cuda:3')
benign distance is  tensor(77.7457, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1057866252958775
distance x is tensor(139.9961, device='cuda:3')
benign distance is  tensor(139.9961, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2219360992312431
distance x is tensor(121.9055, device='cuda:3')
benign distance is  tensor(121.9055, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6852944130077958
distance x is tensor(119.8935, device='cuda:3')
benign distance is  tensor(119.8935, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7772781793028116
distance x is tensor(120.6561, device='cuda:3')
benign distance is  tensor(120.6561, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.473467830568552
distance x is tensor(105.4447, device='cuda:3')
benign distance is  tensor(105.4447, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7772097550332546
distance x is tensor(171.4357, device='cuda:3')
benign distance is  tensor(171.4357, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7656871452927589
distance x is tensor(113.6350, device='cuda:3')
benign distance is  tensor(113.6350, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8162318151444197
distance x is tensor(104.4379, device='cuda:3')
benign distance is  tensor(104.4379, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.594641325995326
distance x is tensor(145.0229, device='cuda:3')
benign distance is  tensor(145.0229, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1561917439103127
distance x is tensor(130.8234, device='cuda:3')
benign distance is  tensor(130.8234, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8911783564835787
distance x is tensor(115.4903, device='cuda:3')
benign distance is  tensor(115.4903, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8597087021917105
distance x is tensor(81.5745, device='cuda:3')
benign distance is  tensor(81.5745, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8370608519762754
distance x is tensor(101.6182, device='cuda:3')
benign distance is  tensor(101.6182, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7880005948245525
distance x is tensor(127.3182, device='cuda:3')
benign distance is  tensor(127.3182, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.576461497694254
distance x is tensor(117.2870, device='cuda:3')
benign distance is  tensor(117.2870, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3032699823379517
distance x is tensor(145.7080, device='cuda:3')
benign distance is  tensor(145.7080, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1748272404074669
distance x is tensor(156.3655, device='cuda:3')
benign distance is  tensor(156.3655, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.037083774805069
distance x is tensor(98.9430, device='cuda:3')
benign distance is  tensor(98.9430, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5512476190924644
distance x is tensor(154.1534, device='cuda:3')
benign distance is  tensor(154.1534, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6943419650197029
distance x is tensor(134.0713, device='cuda:3')
benign distance is  tensor(134.0713, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7015543952584267
distance x is tensor(104.1859, device='cuda:3')
benign distance is  tensor(104.1859, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5301638655364513
distance x is tensor(137.4522, device='cuda:3')
benign distance is  tensor(137.4522, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(84.7708, device='cuda:3')
compute distance is  tensor(84.7708, device='cuda:3')
compute norm is  tensor(44.6525, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4665, device='cuda:3')
compute distance is  tensor(132.4665, device='cuda:3')
compute norm is  tensor(46.0690, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.6767, device='cuda:3')
compute distance is  tensor(111.6767, device='cuda:3')
compute norm is  tensor(45.2753, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.4629, device='cuda:3')
compute distance is  tensor(99.4629, device='cuda:3')
compute norm is  tensor(45.0613, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.2725, device='cuda:3')
compute distance is  tensor(100.2725, device='cuda:3')
compute norm is  tensor(45.0050, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7363, device='cuda:3')
compute distance is  tensor(103.7363, device='cuda:3')
compute norm is  tensor(45.2684, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5805, device='cuda:3')
compute distance is  tensor(121.5805, device='cuda:3')
compute norm is  tensor(45.6152, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.9629, device='cuda:3')
compute distance is  tensor(99.9629, device='cuda:3')
compute norm is  tensor(45.0897, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.3562, device='cuda:3')
compute distance is  tensor(115.3562, device='cuda:3')
compute norm is  tensor(45.5216, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.4878, device='cuda:3')
compute distance is  tensor(99.4878, device='cuda:3')
compute norm is  tensor(45.1114, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.7996, device='cuda:3')
compute distance is  tensor(118.7996, device='cuda:3')
compute norm is  tensor(45.2766, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.7103, device='cuda:3')
compute distance is  tensor(150.7103, device='cuda:3')
compute norm is  tensor(46.8263, device='cuda:3', dtype=torch.float64)
batch acc is 0.10243333348966525
mal_rand_acc is 0.10900000016000001
mal_rand loss is 106489762021376.0
len of model dicts is  12
distance x is tensor(84.7708, device='cuda:3')
compute distance is  tensor(84.7708, device='cuda:3')
compute norm is  tensor(44.6525, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4665, device='cuda:3')
compute distance is  tensor(132.4665, device='cuda:3')
compute norm is  tensor(46.0690, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.6767, device='cuda:3')
compute distance is  tensor(111.6767, device='cuda:3')
compute norm is  tensor(45.2753, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.4629, device='cuda:3')
compute distance is  tensor(99.4629, device='cuda:3')
compute norm is  tensor(45.0613, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.2725, device='cuda:3')
compute distance is  tensor(100.2725, device='cuda:3')
compute norm is  tensor(45.0050, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7363, device='cuda:3')
compute distance is  tensor(103.7363, device='cuda:3')
compute norm is  tensor(45.2684, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5805, device='cuda:3')
compute distance is  tensor(121.5805, device='cuda:3')
compute norm is  tensor(45.6152, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.9629, device='cuda:3')
compute distance is  tensor(99.9629, device='cuda:3')
compute norm is  tensor(45.0897, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.3562, device='cuda:3')
compute distance is  tensor(115.3562, device='cuda:3')
compute norm is  tensor(45.5216, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.4878, device='cuda:3')
compute distance is  tensor(99.4878, device='cuda:3')
compute norm is  tensor(45.1114, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.7996, device='cuda:3')
compute distance is  tensor(118.7996, device='cuda:3')
compute norm is  tensor(45.2766, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.7103, device='cuda:3')
compute distance is  tensor(150.7103, device='cuda:3')
compute norm is  tensor(46.8263, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(150.7103, device='cuda:3')
distance x is tensor(102085.9062, device='cuda:3')
distance x is tensor(102085.9062, device='cuda:3')
________________________________
test distance is  tensor(102085.9062, device='cuda:3')
test distance1 is  tensor(102085.9062, device='cuda:3')
test similarity is  tensor(-0.1082, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107539920277844.61
test entropy is  0.0
________________________________
cal ratio is  0.03765430727560871
distance x is tensor(3843.9792, device='cuda:3')
cal_distance is  tensor(3843.9792, device='cuda:3')
cal ratio is  0.19404704683546412
distance x is tensor(745.9166, device='cuda:3')
cal_distance is  tensor(745.9166, device='cuda:3')
cal ratio is  0.4405066091283064
distance x is tensor(328.5838, device='cuda:3')
cal_distance is  tensor(328.5838, device='cuda:3')
cal ratio is  0.6637040828099184
distance x is tensor(218.0840, device='cuda:3')
cal_distance is  tensor(218.0840, device='cuda:3')
cal ratio is  0.8146773837463415
distance x is tensor(177.6690, device='cuda:3')
cal_distance is  tensor(177.6690, device='cuda:3')
cal ratio is  0.9025926376651312
distance x is tensor(160.3631, device='cuda:3')
cal_distance is  tensor(160.3631, device='cuda:3')
cal ratio is  0.9500474031442285
distance x is tensor(152.3528, device='cuda:3')
cal_distance is  tensor(152.3528, device='cuda:3')
cal ratio is  0.9747029994234919
distance x is tensor(148.4989, device='cuda:3')
cal_distance is  tensor(148.4989, device='cuda:3')
distance x is tensor(148.4989, device='cuda:3')
return_distance is  tensor(148.4989, device='cuda:3')
distance x is tensor(148.4896, device='cuda:3')
distance x is tensor(148.4896, device='cuda:3')
________________________________
test distance is  tensor(148.4896, device='cuda:3')
test distance1 is  tensor(148.4896, device='cuda:3')
test similarity is  tensor(0.9303, device='cuda:3')
test acc is  0.10040000015633196
test loss is 392.48915210715745
test entropy is  0.00018535583220205038
________________________________
0
distance x is tensor(148.4896, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0002050964514840711
avg test loss is  391.81741014167443
avg accuracy is  0.2880500001563393
solo acc is  0.10041666682299864
compute similarity  is  tensor(0.9303, device='cuda:3')
compute_distance is  tensor(148.4896, device='cuda:3')
compute_norm is  tensor(44.5399, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.7609, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9260146882869541
avg test loss is  1.5304873968238262
avg accuracy is  0.8093000001563252
solo acc is  0.3173666668230065
compute similarity  is  tensor(0.9422, device='cuda:3')
compute_distance is  tensor(121.7609, device='cuda:3')
compute_norm is  tensor(43.5444, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.4533, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9026041401347626
avg test loss is  1.5456517153203106
avg accuracy is  0.8106333334896585
solo acc is  0.2735666668230055
compute similarity  is  tensor(0.9415, device='cuda:3')
compute_distance is  tensor(124.4533, device='cuda:3')
compute_norm is  tensor(43.2557, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.7102, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8738553992339543
avg test loss is  1.5202699467571559
avg accuracy is  0.8162500001563249
solo acc is  0.2654000001563387
compute similarity  is  tensor(0.9411, device='cuda:3')
compute_distance is  tensor(126.7102, device='cuda:3')
compute_norm is  tensor(42.9938, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.7677, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8648154028951486
avg test loss is  1.4837548553562367
avg accuracy is  0.8201166668229913
solo acc is  0.2646000001563386
compute similarity  is  tensor(0.9406, device='cuda:3')
compute_distance is  tensor(128.7677, device='cuda:3')
compute_norm is  tensor(42.7492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.6811, device='cuda:3')
distance x is tensor(130.6811, device='cuda:3')
________________________________
test distance is  tensor(130.6811, device='cuda:3')
test distance1 is  tensor(130.6811, device='cuda:3')
test similarity is  tensor(0.9402, device='cuda:3')
test acc is  0.26340000015633863
test loss is 1.4447109204873856
test entropy is  0.8739387422228164
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2750000001600001
mal loss is 1.4328127801418304
mal norm is  tensor(670.9217, device='cuda:3')
distance x is tensor(130.6883, device='cuda:3')
mal distance is  tensor(130.6883, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([557.6093, 489.8043, 498.7738, 709.0340, 449.7805, 426.0069, 500.8149,
        397.2487, 670.9218, 670.9217, 670.9218, 670.9217, 670.9218, 670.9217,
        670.9218, 670.9217, 670.9218, 670.9217, 670.9218, 670.9217],
       device='cuda:3')
sorted_norm is   tensor([397.2487, 426.0069, 449.7805, 489.8043, 498.7738, 500.8149, 557.6093,
        670.9217, 670.9217, 670.9217, 670.9217, 670.9217, 670.9217, 670.9218,
        670.9218, 670.9218, 670.9218, 670.9218, 670.9218, 709.0340],
       device='cuda:3')
used idx is  tensor([ 7,  5,  4,  1,  2,  6,  0, 19, 15, 17, 13,  9, 11, 10, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 91.98% 

Test Accuracy: 83.95% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7576909642666578
distance x is tensor(120.6390, device='cuda:3')
benign distance is  tensor(120.6390, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8729483038187027
distance x is tensor(129.4150, device='cuda:3')
benign distance is  tensor(129.4150, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8393817823380232
distance x is tensor(129.5590, device='cuda:3')
benign distance is  tensor(129.5590, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8413469288498163
distance x is tensor(163.9583, device='cuda:3')
benign distance is  tensor(163.9583, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8052125778049231
distance x is tensor(107.5083, device='cuda:3')
benign distance is  tensor(107.5083, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7941638445481658
distance x is tensor(119.9094, device='cuda:3')
benign distance is  tensor(119.9094, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8964494299143553
distance x is tensor(111.9619, device='cuda:3')
benign distance is  tensor(111.9619, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7028808183968067
distance x is tensor(113.8619, device='cuda:3')
benign distance is  tensor(113.8619, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(89.9577, device='cuda:3')
compute distance is  tensor(89.9577, device='cuda:3')
compute norm is  tensor(43.6630, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6128, device='cuda:3')
compute distance is  tensor(152.6128, device='cuda:3')
compute norm is  tensor(45.1407, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5583, device='cuda:3')
compute distance is  tensor(119.5583, device='cuda:3')
compute norm is  tensor(44.2976, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.9915, device='cuda:3')
compute distance is  tensor(113.9915, device='cuda:3')
compute norm is  tensor(44.1845, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.2360, device='cuda:3')
compute distance is  tensor(101.2360, device='cuda:3')
compute norm is  tensor(43.7987, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4690, device='cuda:3')
compute distance is  tensor(131.4690, device='cuda:3')
compute norm is  tensor(44.5733, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0813, device='cuda:3')
compute distance is  tensor(139.0813, device='cuda:3')
compute norm is  tensor(44.6857, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2019, device='cuda:3')
compute distance is  tensor(103.2019, device='cuda:3')
compute norm is  tensor(43.9357, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5526, device='cuda:3')
compute distance is  tensor(130.5526, device='cuda:3')
compute norm is  tensor(44.4926, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.0284, device='cuda:3')
compute distance is  tensor(107.0284, device='cuda:3')
compute norm is  tensor(44.1134, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8521, device='cuda:3')
compute distance is  tensor(132.8521, device='cuda:3')
compute norm is  tensor(44.5405, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.4573, device='cuda:3')
compute distance is  tensor(154.4573, device='cuda:3')
compute norm is  tensor(45.6410, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.4573, device='cuda:3')
distance x is tensor(102045.6172, device='cuda:3')
distance x is tensor(102045.6172, device='cuda:3')
________________________________
test distance is  tensor(102045.6172, device='cuda:3')
test distance1 is  tensor(102045.6172, device='cuda:3')
test similarity is  tensor(0.0565, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107524781791620.64
test entropy is  0.0
________________________________
cal ratio is  0.03812704277599623
distance x is tensor(3890.7026, device='cuda:3')
cal_distance is  tensor(3890.7026, device='cuda:3')
cal ratio is  0.1952613482822333
distance x is tensor(759.7075, device='cuda:3')
cal_distance is  tensor(759.7075, device='cuda:3')
cal ratio is  0.44188280160078774
distance x is tensor(335.7043, device='cuda:3')
cal_distance is  tensor(335.7043, device='cuda:3')
cal ratio is  0.6647401038312309
distance x is tensor(223.1577, device='cuda:3')
cal_distance is  tensor(223.1577, device='cuda:3')
cal ratio is  0.8153130801583708
distance x is tensor(181.9442, device='cuda:3')
cal_distance is  tensor(181.9442, device='cuda:3')
cal ratio is  0.9029447517829944
distance x is tensor(164.2860, device='cuda:3')
cal_distance is  tensor(164.2860, device='cuda:3')
cal ratio is  0.9502327870834997
distance x is tensor(156.1102, device='cuda:3')
cal_distance is  tensor(156.1102, device='cuda:3')
cal ratio is  0.9747981373699278
distance x is tensor(152.1761, device='cuda:3')
cal_distance is  tensor(152.1761, device='cuda:3')
distance x is tensor(152.1761, device='cuda:3')
return_distance is  tensor(152.1761, device='cuda:3')
distance x is tensor(152.1668, device='cuda:3')
distance x is tensor(152.1668, device='cuda:3')
________________________________
test distance is  tensor(152.1668, device='cuda:3')
test distance1 is  tensor(152.1668, device='cuda:3')
test similarity is  tensor(0.9317, device='cuda:3')
test acc is  0.10000000015633198
test loss is 544.4667250708476
test entropy is  4.479749647726231e-28
________________________________
0
distance x is tensor(152.1668, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.8290221725975435e-31
avg test loss is  545.2351360849734
avg accuracy is  0.1017833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9317, device='cuda:3')
compute_distance is  tensor(152.1668, device='cuda:3')
compute_norm is  tensor(45.2944, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.1170, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2939150102102934
avg test loss is  1.9676355483181187
avg accuracy is  0.6166833334896696
solo acc is  0.18700000015633572
compute similarity  is  tensor(0.9352, device='cuda:3')
compute_distance is  tensor(145.1170, device='cuda:3')
compute_norm is  tensor(45.4515, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(146.5546, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7143531930980398
avg test loss is  2.7303930853983993
avg accuracy is  0.5392500001563424
solo acc is  0.10886666682299861
compute similarity  is  tensor(0.9348, device='cuda:3')
compute_distance is  tensor(146.5546, device='cuda:3')
compute_norm is  tensor(45.4025, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.0029, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0331013114340524
avg test loss is  1.6257236002604845
avg accuracy is  0.6007166668230042
solo acc is  0.2518500001563383
compute similarity  is  tensor(0.9353, device='cuda:3')
compute_distance is  tensor(148.0029, device='cuda:3')
compute_norm is  tensor(45.1063, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(148.8350, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6393381128433162
avg test loss is  2.472156666489298
avg accuracy is  0.5127500001563421
solo acc is  0.11065000015633193
compute similarity  is  tensor(0.9349, device='cuda:3')
compute_distance is  tensor(148.8350, device='cuda:3')
compute_norm is  tensor(44.9813, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.1080, device='cuda:3')
distance x is tensor(150.1080, device='cuda:3')
________________________________
test distance is  tensor(150.1080, device='cuda:3')
test distance1 is  tensor(150.1080, device='cuda:3')
test similarity is  tensor(0.9348, device='cuda:3')
test acc is  0.2652833334896721
test loss is 1.5075203978430742
test entropy is  0.9946605882156633
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2690000001600001
mal loss is 1.5158352926373482
mal norm is  tensor(722.2756, device='cuda:3')
distance x is tensor(150.1153, device='cuda:3')
mal distance is  tensor(150.1153, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([528.4879, 561.5164, 552.9528, 712.3552, 454.4485, 500.1512, 493.3426,
        487.8355, 722.2756, 722.2756, 722.2756, 722.2756, 722.2756, 722.2756,
        722.2756, 722.2756, 722.2756, 722.2756, 722.2756, 722.2756, 638.8363,
        697.0138, 553.8472, 681.6635, 842.0080, 482.6467, 750.6514, 706.7283],
       device='cuda:3')
sorted_norm is   tensor([454.4485, 482.6467, 487.8355, 493.3426, 500.1512, 528.4879, 552.9528,
        553.8472, 561.5164, 638.8363, 681.6635, 697.0138, 706.7283, 712.3552,
        722.2756, 722.2756, 722.2756, 722.2756, 722.2756, 722.2756, 722.2756,
        722.2756, 722.2756, 722.2756, 722.2756, 722.2756, 750.6514, 842.0080],
       device='cuda:3')
used idx is  tensor([ 4, 25,  7,  6,  5,  0,  2, 22,  1, 20, 23, 21, 27,  3, 16, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 91.02% 

Test Accuracy: 85.60% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9296064414083958
distance x is tensor(138.2029, device='cuda:3')
benign distance is  tensor(138.2029, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0010779555886984
distance x is tensor(126.1777, device='cuda:3')
benign distance is  tensor(126.1777, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9680722523480654
distance x is tensor(121.9625, device='cuda:3')
benign distance is  tensor(121.9625, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0064192954450846
distance x is tensor(155.8617, device='cuda:3')
benign distance is  tensor(155.8617, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2502788379788399
distance x is tensor(115.0590, device='cuda:3')
benign distance is  tensor(115.0590, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7954060295596719
distance x is tensor(124.4056, device='cuda:3')
benign distance is  tensor(124.4056, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9946495126932859
distance x is tensor(122.5657, device='cuda:3')
benign distance is  tensor(122.5657, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8340372927486897
distance x is tensor(104.4878, device='cuda:3')
benign distance is  tensor(104.4878, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.235258124768734
distance x is tensor(127.1650, device='cuda:3')
benign distance is  tensor(127.1650, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7930470686405897
distance x is tensor(125.9296, device='cuda:3')
benign distance is  tensor(125.9296, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9581178519874811
distance x is tensor(114.7730, device='cuda:3')
benign distance is  tensor(114.7730, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.618580050766468
distance x is tensor(121.9476, device='cuda:3')
benign distance is  tensor(121.9476, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0765055231750011
distance x is tensor(169.9060, device='cuda:3')
benign distance is  tensor(169.9060, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.757377989590168
distance x is tensor(81.7451, device='cuda:3')
benign distance is  tensor(81.7451, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8124771993607283
distance x is tensor(152.0099, device='cuda:3')
benign distance is  tensor(152.0099, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9226101487874985
distance x is tensor(128.8137, device='cuda:3')
benign distance is  tensor(128.8137, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(92.8447, device='cuda:3')
compute distance is  tensor(92.8447, device='cuda:3')
compute norm is  tensor(43.9913, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.0515, device='cuda:3')
compute distance is  tensor(160.0515, device='cuda:3')
compute norm is  tensor(45.5084, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.2441, device='cuda:3')
compute distance is  tensor(112.2441, device='cuda:3')
compute norm is  tensor(44.2175, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.4442, device='cuda:3')
compute distance is  tensor(110.4442, device='cuda:3')
compute norm is  tensor(44.4096, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.7169, device='cuda:3')
compute distance is  tensor(107.7169, device='cuda:3')
compute norm is  tensor(43.9985, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6141, device='cuda:3')
compute distance is  tensor(125.6141, device='cuda:3')
compute norm is  tensor(44.7443, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9518, device='cuda:3')
compute distance is  tensor(133.9518, device='cuda:3')
compute norm is  tensor(44.7838, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.7497, device='cuda:3')
compute distance is  tensor(101.7497, device='cuda:3')
compute norm is  tensor(44.1089, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1713, device='cuda:3')
compute distance is  tensor(142.1713, device='cuda:3')
compute norm is  tensor(44.9898, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.6801, device='cuda:3')
compute distance is  tensor(99.6801, device='cuda:3')
compute norm is  tensor(44.3618, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1058, device='cuda:3')
compute distance is  tensor(141.1058, device='cuda:3')
compute norm is  tensor(44.7767, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.2052, device='cuda:3')
compute distance is  tensor(162.2052, device='cuda:3')
compute norm is  tensor(46.0249, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.2052, device='cuda:3')
distance x is tensor(102032.2812, device='cuda:3')
distance x is tensor(102032.2812, device='cuda:3')
________________________________
test distance is  tensor(102032.2812, device='cuda:3')
test distance1 is  tensor(102032.2812, device='cuda:3')
test similarity is  tensor(0.1145, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107579466179206.28
test entropy is  0.0
________________________________
cal ratio is  0.039074159190524274
distance x is tensor(3986.8311, device='cuda:3')
cal_distance is  tensor(3986.8311, device='cuda:3')
cal ratio is  0.19767170932685338
distance x is tensor(788.0875, device='cuda:3')
cal_distance is  tensor(788.0875, device='cuda:3')
cal ratio is  0.4446018238998261
distance x is tensor(350.3877, device='cuda:3')
cal_distance is  tensor(350.3877, device='cuda:3')
cal ratio is  0.666782227232936
distance x is tensor(233.6338, device='cuda:3')
cal_distance is  tensor(233.6338, device='cuda:3')
cal ratio is  0.8165646914552347
distance x is tensor(190.7780, device='cuda:3')
cal_distance is  tensor(190.7780, device='cuda:3')
cal ratio is  0.9036376408157042
distance x is tensor(172.3946, device='cuda:3')
cal_distance is  tensor(172.3946, device='cuda:3')
cal ratio is  0.9505973643738301
distance x is tensor(163.8781, device='cuda:3')
cal_distance is  tensor(163.8781, device='cuda:3')
cal ratio is  0.9749851268465305
distance x is tensor(159.7788, device='cuda:3')
cal_distance is  tensor(159.7788, device='cuda:3')
distance x is tensor(159.7788, device='cuda:3')
return_distance is  tensor(159.7788, device='cuda:3')
distance x is tensor(159.7696, device='cuda:3')
distance x is tensor(159.7696, device='cuda:3')
________________________________
test distance is  tensor(159.7696, device='cuda:3')
test distance1 is  tensor(159.7696, device='cuda:3')
test similarity is  tensor(0.9301, device='cuda:3')
test acc is  0.10016666682299866
test loss is 339.6927977604652
test entropy is  9.482845773653888e-05
________________________________
0
distance x is tensor(159.7696, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00010078959755310904
avg test loss is  338.91091899424475
avg accuracy is  0.16021666682300068
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9301, device='cuda:3')
compute_distance is  tensor(159.7696, device='cuda:3')
compute_norm is  tensor(46.2981, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.4665, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1673191585012082
avg test loss is  1.8935960311371127
avg accuracy is  0.6644833334896663
solo acc is  0.19775000015633615
compute similarity  is  tensor(0.9335, device='cuda:3')
compute_distance is  tensor(150.4665, device='cuda:3')
compute_norm is  tensor(46.7152, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.7524, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6924555831626534
avg test loss is  2.692245259467981
avg accuracy is  0.6497500001563339
solo acc is  0.10830000015633195
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(151.7524, device='cuda:3')
compute_norm is  tensor(46.6182, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.8518, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0401085275831
avg test loss is  1.6763745255307603
avg accuracy is  0.667683333489666
solo acc is  0.22745000015633754
compute similarity  is  tensor(0.9337, device='cuda:3')
compute_distance is  tensor(152.8518, device='cuda:3')
compute_norm is  tensor(46.3212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(153.7272, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6444906819858023
avg test loss is  2.49585911599812
avg accuracy is  0.6393166668230011
solo acc is  0.10933333348966529
compute similarity  is  tensor(0.9333, device='cuda:3')
compute_distance is  tensor(153.7272, device='cuda:3')
compute_norm is  tensor(46.1984, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.5567, device='cuda:3')
distance x is tensor(154.5567, device='cuda:3')
________________________________
test distance is  tensor(154.5567, device='cuda:3')
test distance1 is  tensor(154.5567, device='cuda:3')
test similarity is  tensor(0.9335, device='cuda:3')
test acc is  0.2385833334896712
test loss is 1.5671937788473262
test entropy is  1.0169017893164904
________________________________
0
distance x is tensor(154.5567, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0176168996642139
avg test loss is  1.5655189352249033
avg accuracy is  0.6726166668229991
solo acc is  0.23746666682300452
compute similarity  is  tensor(0.9335, device='cuda:3')
compute_distance is  tensor(154.5567, device='cuda:3')
compute_norm is  tensor(45.9121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.3772, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.619322310124379
avg test loss is  2.4115988056796955
avg accuracy is  0.6296833334896687
solo acc is  0.10771666682299862
compute similarity  is  tensor(0.9330, device='cuda:3')
compute_distance is  tensor(155.3772, device='cuda:3')
compute_norm is  tensor(45.7878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.2275, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9835981518856244
avg test loss is  1.5217333766443135
avg accuracy is  0.6792500001563319
solo acc is  0.23806666682300448
compute similarity  is  tensor(0.9330, device='cuda:3')
compute_distance is  tensor(156.2275, device='cuda:3')
compute_norm is  tensor(45.5221, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(156.2275, device='cuda:3')
distance x is tensor(156.2275, device='cuda:3')
________________________________
test distance is  tensor(156.2275, device='cuda:3')
test distance1 is  tensor(156.2275, device='cuda:3')
test similarity is  tensor(0.9330, device='cuda:3')
test acc is  0.23886666682300456
test loss is 1.521416318569102
test entropy is  0.9832079359082017
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2650000001600001
mal loss is 1.5064902156591415
mal norm is  tensor(751.4427, device='cuda:3')
distance x is tensor(156.2359, device='cuda:3')
mal distance is  tensor(156.2359, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 593.4751,  542.0392,  532.0886,  679.9196,  484.4113,  523.8378,
         517.1294,  450.2845,  751.4427,  751.4427,  751.4427,  751.4427,
         751.4427,  751.4427,  751.4427,  751.4427,  751.4427,  751.4427,
         751.4427,  751.4427,  825.3916,  723.4995,  743.6360,  733.2940,
         628.3216, 1084.4529,  852.1394,  730.5156], device='cuda:3')
sorted_norm is   tensor([ 450.2845,  484.4113,  517.1294,  523.8378,  532.0886,  542.0392,
         593.4751,  628.3216,  679.9196,  723.4995,  730.5156,  733.2940,
         743.6360,  751.4427,  751.4427,  751.4427,  751.4427,  751.4427,
         751.4427,  751.4427,  751.4427,  751.4427,  751.4427,  751.4427,
         751.4427,  825.3916,  852.1394, 1084.4529], device='cuda:3')
used idx is  tensor([ 7,  4,  6,  5,  2,  1,  0, 24,  3, 21, 27, 23, 22, 19, 16, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 83.12% 

Test Accuracy: 81.21% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9298481177538633
distance x is tensor(154.2334, device='cuda:3')
benign distance is  tensor(154.2334, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1138781942427158
distance x is tensor(142.2401, device='cuda:3')
benign distance is  tensor(142.2401, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4483637623488903
distance x is tensor(145.8817, device='cuda:3')
benign distance is  tensor(145.8817, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9999319426715374
distance x is tensor(170.9978, device='cuda:3')
benign distance is  tensor(170.9978, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3588342778384686
distance x is tensor(120.8081, device='cuda:3')
benign distance is  tensor(120.8081, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7789669018238783
distance x is tensor(133.7930, device='cuda:3')
benign distance is  tensor(133.7930, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0587262902408838
distance x is tensor(137.1883, device='cuda:3')
benign distance is  tensor(137.1883, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.08602193929255
distance x is tensor(121.3347, device='cuda:3')
benign distance is  tensor(121.3347, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.157191351056099
distance x is tensor(140.6185, device='cuda:3')
benign distance is  tensor(140.6185, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7564935032278299
distance x is tensor(141.5407, device='cuda:3')
benign distance is  tensor(141.5407, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4126394353806973
distance x is tensor(142.3475, device='cuda:3')
benign distance is  tensor(142.3475, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4615981690585613
distance x is tensor(146.8380, device='cuda:3')
benign distance is  tensor(146.8380, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.303782295435667
distance x is tensor(96.5555, device='cuda:3')
benign distance is  tensor(96.5555, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9300914257764816
distance x is tensor(223.0774, device='cuda:3')
benign distance is  tensor(223.0774, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3218009024858475
distance x is tensor(164.1431, device='cuda:3')
benign distance is  tensor(164.1431, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8923891335725784
distance x is tensor(142.4398, device='cuda:3')
benign distance is  tensor(142.4398, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(112.2611, device='cuda:3')
compute distance is  tensor(112.2611, device='cuda:3')
compute norm is  tensor(44.5948, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.6319, device='cuda:3')
compute distance is  tensor(161.6319, device='cuda:3')
compute norm is  tensor(45.8422, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.7215, device='cuda:3')
compute distance is  tensor(134.7215, device='cuda:3')
compute norm is  tensor(45.0513, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9003, device='cuda:3')
compute distance is  tensor(124.9003, device='cuda:3')
compute norm is  tensor(44.9503, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.8267, device='cuda:3')
compute distance is  tensor(115.8267, device='cuda:3')
compute norm is  tensor(44.4892, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1824, device='cuda:3')
compute distance is  tensor(135.1824, device='cuda:3')
compute norm is  tensor(45.0443, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.3012, device='cuda:3')
compute distance is  tensor(150.3012, device='cuda:3')
compute norm is  tensor(45.5365, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2533, device='cuda:3')
compute distance is  tensor(128.2533, device='cuda:3')
compute norm is  tensor(44.7758, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9377, device='cuda:3')
compute distance is  tensor(144.9377, device='cuda:3')
compute norm is  tensor(45.2988, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4169, device='cuda:3')
compute distance is  tensor(124.4169, device='cuda:3')
compute norm is  tensor(44.9866, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4652, device='cuda:3')
compute distance is  tensor(134.4652, device='cuda:3')
compute norm is  tensor(45.0492, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.8337, device='cuda:3')
compute distance is  tensor(171.8337, device='cuda:3')
compute norm is  tensor(46.5481, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(171.8337, device='cuda:3')
distance x is tensor(102005.7812, device='cuda:3')
distance x is tensor(102005.7812, device='cuda:3')
________________________________
test distance is  tensor(102005.7812, device='cuda:3')
test distance1 is  tensor(102005.7812, device='cuda:3')
test similarity is  tensor(0.1897, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107471109438614.66
test entropy is  0.0
________________________________
cal ratio is  0.04022238455498461
distance x is tensor(4102.9214, device='cuda:3')
cal_distance is  tensor(4102.9214, device='cuda:3')
cal ratio is  0.2005550516525041
distance x is tensor(822.8652, device='cuda:3')
cal_distance is  tensor(822.8652, device='cuda:3')
cal ratio is  0.44783273991235023
distance x is tensor(368.5086, device='cuda:3')
cal_distance is  tensor(368.5086, device='cuda:3')
cal ratio is  0.6692007226896174
distance x is tensor(246.6077, device='cuda:3')
cal_distance is  tensor(246.6077, device='cuda:3')
cal ratio is  0.8180443990242043
distance x is tensor(201.7369, device='cuda:3')
cal_distance is  tensor(201.7369, device='cuda:3')
cal ratio is  0.9044562741149239
distance x is tensor(182.4626, device='cuda:3')
cal_distance is  tensor(182.4626, device='cuda:3')
cal ratio is  0.9510278047524248
distance x is tensor(173.5273, device='cuda:3')
cal_distance is  tensor(173.5273, device='cuda:3')
cal ratio is  0.9752058920856559
distance x is tensor(169.2249, device='cuda:3')
cal_distance is  tensor(169.2249, device='cuda:3')
distance x is tensor(169.2249, device='cuda:3')
return_distance is  tensor(169.2249, device='cuda:3')
distance x is tensor(169.2158, device='cuda:3')
distance x is tensor(169.2158, device='cuda:3')
________________________________
test distance is  tensor(169.2158, device='cuda:3')
test distance1 is  tensor(169.2158, device='cuda:3')
test similarity is  tensor(0.9297, device='cuda:3')
test acc is  0.10126666682299863
test loss is 334.2496696748713
test entropy is  0.0008235606673481842
________________________________
0
distance x is tensor(169.2158, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0007246663198300273
avg test loss is  334.1976275088182
avg accuracy is  0.20951666682300343
solo acc is  0.10120000015633197
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(169.2158, device='cuda:3')
compute_norm is  tensor(47.6595, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.7752, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1685585640768
avg test loss is  1.8947565647076443
avg accuracy is  0.6505833334896672
solo acc is  0.18533333348966893
compute similarity  is  tensor(0.9316, device='cuda:3')
compute_distance is  tensor(164.7752, device='cuda:3')
compute_norm is  tensor(48.7266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.5710, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.676050209732198
avg test loss is  2.7047844863395447
avg accuracy is  0.6407166668230012
solo acc is  0.10581666682299862
compute similarity  is  tensor(0.9315, device='cuda:3')
compute_distance is  tensor(165.5710, device='cuda:3')
compute_norm is  tensor(48.6248, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.0444, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0728612898636474
avg test loss is  1.738882137259949
avg accuracy is  0.6716333334896658
solo acc is  0.20280000015633648
compute similarity  is  tensor(0.9319, device='cuda:3')
compute_distance is  tensor(166.0444, device='cuda:3')
compute_norm is  tensor(48.2988, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.6129, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6581374163439533
avg test loss is  2.547920965690857
avg accuracy is  0.6516333334896671
solo acc is  0.10500000015633197
compute similarity  is  tensor(0.9316, device='cuda:3')
compute_distance is  tensor(166.6129, device='cuda:3')
compute_norm is  tensor(48.1757, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.2763, device='cuda:3')
distance x is tensor(167.2763, device='cuda:3')
________________________________
test distance is  tensor(167.2763, device='cuda:3')
test distance1 is  tensor(167.2763, device='cuda:3')
test similarity is  tensor(0.9318, device='cuda:3')
test acc is  0.20651666682300332
test loss is 1.671378897197211
test entropy is  1.0414803917728253
________________________________
0
distance x is tensor(167.2763, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0408496455724305
avg test loss is  1.6675340379479089
avg accuracy is  0.6812833334896652
solo acc is  0.2094833334896701
compute similarity  is  tensor(0.9318, device='cuda:3')
compute_distance is  tensor(167.2763, device='cuda:3')
compute_norm is  tensor(47.8791, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(167.8257, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6241832291012379
avg test loss is  2.5087352525959137
avg accuracy is  0.6585833334896666
solo acc is  0.1040833334896653
compute similarity  is  tensor(0.9315, device='cuda:3')
compute_distance is  tensor(167.8257, device='cuda:3')
compute_norm is  tensor(47.7504, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.6683, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0269799914314295
avg test loss is  1.617028164583991
avg accuracy is  0.6907833334896646
solo acc is  0.20396666682300318
compute similarity  is  tensor(0.9314, device='cuda:3')
compute_distance is  tensor(168.6683, device='cuda:3')
compute_norm is  tensor(47.4653, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.2121, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6263482251655318
avg test loss is  2.4300018318934735
avg accuracy is  0.6644666668229995
solo acc is  0.1037833334896653
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(169.2121, device='cuda:3')
compute_norm is  tensor(47.3358, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0455, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9998175602859017
avg test loss is  1.5317211311254928
avg accuracy is  0.6896166668229979
solo acc is  0.22975000015633756
compute similarity  is  tensor(0.9310, device='cuda:3')
compute_distance is  tensor(170.0455, device='cuda:3')
compute_norm is  tensor(47.0672, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(170.0455, device='cuda:3')
distance x is tensor(170.0455, device='cuda:3')
________________________________
test distance is  tensor(170.0455, device='cuda:3')
test distance1 is  tensor(170.0455, device='cuda:3')
test similarity is  tensor(0.9310, device='cuda:3')
test acc is  0.22425000015633742
test loss is 1.531522293207742
test entropy is  1.0003909389855765
________________________________
0
distance x is tensor(170.0455, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.000029508175372
avg test loss is  1.5276417120941665
avg accuracy is  0.688016666822998
solo acc is  0.2299666668230043
compute similarity  is  tensor(0.9310, device='cuda:3')
compute_distance is  tensor(170.0455, device='cuda:3')
compute_norm is  tensor(47.0672, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.5797, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6052247681089048
avg test loss is  2.3755262256431173
avg accuracy is  0.6630166668229996
solo acc is  0.10381666682299863
compute similarity  is  tensor(0.9307, device='cuda:3')
compute_distance is  tensor(170.5797, device='cuda:3')
compute_norm is  tensor(46.9334, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.2499, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9736937722290503
avg test loss is  1.4883095145479703
avg accuracy is  0.6914166668229977
solo acc is  0.23233333348967103
compute similarity  is  tensor(0.9306, device='cuda:3')
compute_distance is  tensor(171.2499, device='cuda:3')
compute_norm is  tensor(46.6805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(171.2582, device='cuda:3')
________________________________
test distance is  tensor(171.2582, device='cuda:3')
test similarity is  tensor(0.9306, device='cuda:3')
test acc is  0.6871333334896648
test loss is 1.4880412566636416
test entropy is  0.9752962174319001
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2340000001600001
mal loss is 1.487498015165329
mal norm is  tensor(790.8270, device='cuda:3')
distance x is tensor(171.2582, device='cuda:3')
mal distance is  tensor(171.2582, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 659.5335,  601.6700,  604.7269,  711.7469,  492.8142,  552.9160,
         582.5906,  511.8772,  790.8270,  790.8270,  790.8270,  790.8270,
         790.8270,  790.8270,  790.8270,  790.8270,  790.8270,  790.8270,
         790.8270,  790.8270,  884.6699,  761.8662,  919.9631,  882.0145,
         859.9760,  867.5213,  818.7846, 1042.8730,  586.5439,  588.6186,
         525.4898,  573.9660,  778.4133,  398.7917,  678.5425,  593.6236],
       device='cuda:3')
sorted_norm is   tensor([ 398.7917,  492.8142,  511.8772,  525.4898,  552.9160,  573.9660,
         582.5906,  586.5439,  588.6186,  593.6236,  601.6700,  604.7269,
         659.5335,  678.5425,  711.7469,  761.8662,  778.4133,  790.8270,
         790.8270,  790.8270,  790.8270,  790.8270,  790.8270,  790.8270,
         790.8270,  790.8270,  790.8270,  790.8270,  790.8270,  818.7846,
         859.9760,  867.5213,  882.0145,  884.6699,  919.9631, 1042.8730],
       device='cuda:3')
used idx is  tensor([33,  4,  7, 30,  5, 31,  6, 28, 29, 35,  1,  2,  0, 34,  3, 21, 32, 17,
         8, 10, 13, 12, 14, 11, 16, 19, 18,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 71.47% 

Test Accuracy: 77.10% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7528275717049837
distance x is tensor(164.9203, device='cuda:3')
benign distance is  tensor(164.9203, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1310172453522682
distance x is tensor(130.0415, device='cuda:3')
benign distance is  tensor(130.0415, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9927219562232494
distance x is tensor(139.4533, device='cuda:3')
benign distance is  tensor(139.4533, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2141589857637882
distance x is tensor(178.2442, device='cuda:3')
benign distance is  tensor(178.2442, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.344234747812152
distance x is tensor(120.7919, device='cuda:3')
benign distance is  tensor(120.7919, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9280904335901141
distance x is tensor(147.7143, device='cuda:3')
benign distance is  tensor(147.7143, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6253647468984127
distance x is tensor(149.2657, device='cuda:3')
benign distance is  tensor(149.2657, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1154581047594547
distance x is tensor(124.0733, device='cuda:3')
benign distance is  tensor(124.0733, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0805291384458542
distance x is tensor(147.1500, device='cuda:3')
benign distance is  tensor(147.1500, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8942101858556271
distance x is tensor(153.0856, device='cuda:3')
benign distance is  tensor(153.0856, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1695015914738178
distance x is tensor(131.1689, device='cuda:3')
benign distance is  tensor(131.1689, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.388739198446274
distance x is tensor(154.7125, device='cuda:3')
benign distance is  tensor(154.7125, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6519077308475971
distance x is tensor(183.3739, device='cuda:3')
benign distance is  tensor(183.3739, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.749458821490407
distance x is tensor(108.5445, device='cuda:3')
benign distance is  tensor(108.5445, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2560867760330439
distance x is tensor(172.5052, device='cuda:3')
benign distance is  tensor(172.5052, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.950972333550453
distance x is tensor(146.3416, device='cuda:3')
benign distance is  tensor(146.3416, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2671442665159702
distance x is tensor(142.5199, device='cuda:3')
benign distance is  tensor(142.5199, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9348994232714176
distance x is tensor(106.9127, device='cuda:3')
benign distance is  tensor(106.9127, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.4639266058802605
distance x is tensor(167.0384, device='cuda:3')
benign distance is  tensor(167.0384, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.809352457523346
distance x is tensor(138.2796, device='cuda:3')
benign distance is  tensor(138.2796, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9421531893312931
distance x is tensor(141.8392, device='cuda:3')
benign distance is  tensor(141.8392, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.1018626280128956
distance x is tensor(148.4646, device='cuda:3')
benign distance is  tensor(148.4646, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5997046791017056
distance x is tensor(136.5174, device='cuda:3')
benign distance is  tensor(136.5174, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.4265815913677216
distance x is tensor(188.7089, device='cuda:3')
benign distance is  tensor(188.7089, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(103.8136, device='cuda:3')
compute distance is  tensor(103.8136, device='cuda:3')
compute norm is  tensor(45.0891, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.7277, device='cuda:3')
compute distance is  tensor(160.7277, device='cuda:3')
compute norm is  tensor(46.3431, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6169, device='cuda:3')
compute distance is  tensor(124.6169, device='cuda:3')
compute norm is  tensor(45.2997, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0570, device='cuda:3')
compute distance is  tensor(124.0570, device='cuda:3')
compute norm is  tensor(45.3834, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6701, device='cuda:3')
compute distance is  tensor(126.6701, device='cuda:3')
compute norm is  tensor(45.3229, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.4685, device='cuda:3')
compute distance is  tensor(143.4685, device='cuda:3')
compute norm is  tensor(46.0029, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.5366, device='cuda:3')
compute distance is  tensor(147.5366, device='cuda:3')
compute norm is  tensor(46.1142, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.7607, device='cuda:3')
compute distance is  tensor(117.7607, device='cuda:3')
compute norm is  tensor(45.3509, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4566, device='cuda:3')
compute distance is  tensor(145.4566, device='cuda:3')
compute norm is  tensor(45.8726, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0910, device='cuda:3')
compute distance is  tensor(123.0910, device='cuda:3')
compute norm is  tensor(45.5458, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0237, device='cuda:3')
compute distance is  tensor(133.0237, device='cuda:3')
compute norm is  tensor(45.6128, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.5913, device='cuda:3')
compute distance is  tensor(170.5913, device='cuda:3')
compute norm is  tensor(47.1336, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.5913, device='cuda:3')
distance x is tensor(101981.7578, device='cuda:3')
distance x is tensor(101981.7578, device='cuda:3')
________________________________
test distance is  tensor(101981.7578, device='cuda:3')
test distance1 is  tensor(101981.7578, device='cuda:3')
test similarity is  tensor(0.2652, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107645811903455.25
test entropy is  0.0
________________________________
cal ratio is  0.04008143864772513
distance x is tensor(4087.5808, device='cuda:3')
cal_distance is  tensor(4087.5808, device='cuda:3')
cal ratio is  0.20020336190765448
distance x is tensor(818.3511, device='cuda:3')
cal_distance is  tensor(818.3511, device='cuda:3')
cal ratio is  0.4474399046398331
distance x is tensor(366.1655, device='cuda:3')
cal_distance is  tensor(366.1655, device='cuda:3')
cal ratio is  0.6689071660970052
distance x is tensor(244.9322, device='cuda:3')
cal_distance is  tensor(244.9322, device='cuda:3')
cal ratio is  0.8178649582908859
distance x is tensor(200.3223, device='cuda:3')
cal_distance is  tensor(200.3223, device='cuda:3')
cal ratio is  0.9043569328122092
distance x is tensor(181.1633, device='cuda:3')
cal_distance is  tensor(181.1633, device='cuda:3')
cal ratio is  0.9509756469220736
distance x is tensor(172.2821, device='cuda:3')
cal_distance is  tensor(172.2821, device='cuda:3')
cal ratio is  0.9751791833528921
distance x is tensor(168.0061, device='cuda:3')
cal_distance is  tensor(168.0061, device='cuda:3')
distance x is tensor(168.0061, device='cuda:3')
return_distance is  tensor(168.0061, device='cuda:3')
distance x is tensor(167.9970, device='cuda:3')
distance x is tensor(167.9970, device='cuda:3')
________________________________
test distance is  tensor(167.9970, device='cuda:3')
test distance1 is  tensor(167.9970, device='cuda:3')
test similarity is  tensor(0.9377, device='cuda:3')
test acc is  0.15350000015633342
test loss is 129.80003865288774
test entropy is  0.028587709165496956
________________________________
0
distance x is tensor(167.9970, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02867570689729945
avg test loss is  129.96623015251242
avg accuracy is  0.5917500001563384
solo acc is  0.15320000015633345
compute similarity  is  tensor(0.9377, device='cuda:3')
compute_distance is  tensor(167.9970, device='cuda:3')
compute_norm is  tensor(48.7583, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.7081, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0183472973324343
avg test loss is  1.528825805893839
avg accuracy is  0.7089333334896636
solo acc is  0.2537833334896717
compute similarity  is  tensor(0.9420, device='cuda:3')
compute_distance is  tensor(155.7081, device='cuda:3')
compute_norm is  tensor(49.0324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.5921, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6184228705699002
avg test loss is  2.398663492980542
avg accuracy is  0.6808500001563318
solo acc is  0.10933333348966529
compute similarity  is  tensor(0.9417, device='cuda:3')
compute_distance is  tensor(156.5921, device='cuda:3')
compute_norm is  tensor(48.8719, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.2656, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9714761375110033
avg test loss is  1.4704124658092508
avg accuracy is  0.7212166668229961
solo acc is  0.25411666682300504
compute similarity  is  tensor(0.9417, device='cuda:3')
compute_distance is  tensor(157.2656, device='cuda:3')
compute_norm is  tensor(48.6376, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(157.2656, device='cuda:3')
distance x is tensor(157.2656, device='cuda:3')
________________________________
test distance is  tensor(157.2656, device='cuda:3')
test distance1 is  tensor(157.2656, device='cuda:3')
test similarity is  tensor(0.9417, device='cuda:3')
test acc is  0.25738333348967185
test loss is 1.462871605907676
test entropy is  0.9719040817670477
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2470000001600001
mal loss is 1.4632281363010406
mal norm is  tensor(798.5518, device='cuda:3')
distance x is tensor(157.2747, device='cuda:3')
mal distance is  tensor(157.2747, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 680.8672,  545.4144,  562.7968,  729.3747,  494.8537,  586.1628,
         613.4723,  504.0316,  798.5518,  798.5518,  798.5518,  798.5518,
         798.5518,  798.5518,  798.5518,  798.5518,  798.5518,  798.5518,
         798.5518,  798.5518, 1016.7986,  987.7445, 1095.4858, 1057.0979,
        1001.5016,  943.0939,  983.0476, 1038.5524], device='cuda:3')
sorted_norm is   tensor([ 494.8537,  504.0316,  545.4144,  562.7968,  586.1628,  613.4723,
         680.8672,  729.3747,  798.5518,  798.5518,  798.5518,  798.5518,
         798.5518,  798.5518,  798.5518,  798.5518,  798.5518,  798.5518,
         798.5518,  798.5518,  943.0939,  983.0476,  987.7445, 1001.5016,
        1016.7986, 1038.5524, 1057.0979, 1095.4858], device='cuda:3')
used idx is  tensor([ 4,  7,  1,  2,  5,  6,  0,  3, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 25, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 55.08% 

Test Accuracy: 69.33% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9443662576377392
distance x is tensor(204.9338, device='cuda:3')
benign distance is  tensor(204.9338, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.241152536123991
distance x is tensor(160.4988, device='cuda:3')
benign distance is  tensor(160.4988, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.242082379758358
distance x is tensor(144.8434, device='cuda:3')
benign distance is  tensor(144.8434, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5664236769080162
distance x is tensor(184.1878, device='cuda:3')
benign distance is  tensor(184.1878, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3859580717980862
distance x is tensor(169.1777, device='cuda:3')
benign distance is  tensor(169.1777, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1600989643484354
distance x is tensor(196.9981, device='cuda:3')
benign distance is  tensor(196.9981, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.795465409755707
distance x is tensor(151.9632, device='cuda:3')
benign distance is  tensor(151.9632, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2607861794531345
distance x is tensor(143.3155, device='cuda:3')
benign distance is  tensor(143.3155, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9294249825179577
distance x is tensor(156.4764, device='cuda:3')
benign distance is  tensor(156.4764, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.7378804311156273
distance x is tensor(154.8050, device='cuda:3')
benign distance is  tensor(154.8050, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.5857122242450714
distance x is tensor(166.4399, device='cuda:3')
benign distance is  tensor(166.4399, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.060126230120659
distance x is tensor(148.3838, device='cuda:3')
benign distance is  tensor(148.3838, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.303694561123848
distance x is tensor(166.4641, device='cuda:3')
benign distance is  tensor(166.4641, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.156978689134121
distance x is tensor(136.5278, device='cuda:3')
benign distance is  tensor(136.5278, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.16591627150774
distance x is tensor(125.9993, device='cuda:3')
benign distance is  tensor(125.9993, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.941164318472147
distance x is tensor(161.4118, device='cuda:3')
benign distance is  tensor(161.4118, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.0647, device='cuda:3')
compute distance is  tensor(135.0647, device='cuda:3')
compute norm is  tensor(47.5502, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.7479, device='cuda:3')
compute distance is  tensor(169.7479, device='cuda:3')
compute norm is  tensor(48.3198, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.3981, device='cuda:3')
compute distance is  tensor(144.3981, device='cuda:3')
compute norm is  tensor(47.6620, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2660, device='cuda:3')
compute distance is  tensor(151.2660, device='cuda:3')
compute norm is  tensor(47.9635, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.4324, device='cuda:3')
compute distance is  tensor(143.4324, device='cuda:3')
compute norm is  tensor(47.4874, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5008, device='cuda:3')
compute distance is  tensor(144.5008, device='cuda:3')
compute norm is  tensor(47.7787, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.6534, device='cuda:3')
compute distance is  tensor(164.6534, device='cuda:3')
compute norm is  tensor(48.2835, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6703, device='cuda:3')
compute distance is  tensor(132.6703, device='cuda:3')
compute norm is  tensor(47.3627, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.1659, device='cuda:3')
compute distance is  tensor(157.1659, device='cuda:3')
compute norm is  tensor(47.9915, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6430, device='cuda:3')
compute distance is  tensor(152.6430, device='cuda:3')
compute norm is  tensor(48.0114, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1198, device='cuda:3')
compute distance is  tensor(138.1198, device='cuda:3')
compute norm is  tensor(47.5866, device='cuda:3', dtype=torch.float64)
distance x is tensor(192.6166, device='cuda:3')
compute distance is  tensor(192.6166, device='cuda:3')
compute norm is  tensor(49.5041, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(192.6166, device='cuda:3')
distance x is tensor(101932.6719, device='cuda:3')
distance x is tensor(101932.6719, device='cuda:3')
________________________________
test distance is  tensor(101932.6719, device='cuda:3')
test distance1 is  tensor(101932.6719, device='cuda:3')
test similarity is  tensor(0.3994, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107625818899375.22
test entropy is  0.0
________________________________
cal ratio is  0.04260065283985524
distance x is tensor(4342.4028, device='cuda:3')
cal_distance is  tensor(4342.4028, device='cuda:3')
cal ratio is  0.20639914636855883
distance x is tensor(896.2719, device='cuda:3')
cal_distance is  tensor(896.2719, device='cuda:3')
cal ratio is  0.4543108181375861
distance x is tensor(407.1885, device='cuda:3')
cal_distance is  tensor(407.1885, device='cuda:3')
cal ratio is  0.674023761184336
distance x is tensor(274.4562, device='cuda:3')
cal_distance is  tensor(274.4562, device='cuda:3')
cal ratio is  0.8209872371503973
distance x is tensor(225.3259, device='cuda:3')
cal_distance is  tensor(225.3259, device='cuda:3')
cal ratio is  0.9060818452377002
distance x is tensor(204.1641, device='cuda:3')
cal_distance is  tensor(204.1641, device='cuda:3')
cal ratio is  0.9518823884863843
distance x is tensor(194.3404, device='cuda:3')
cal_distance is  tensor(194.3404, device='cuda:3')
cal ratio is  0.9756440456738088
distance x is tensor(189.6072, device='cuda:3')
cal_distance is  tensor(189.6072, device='cuda:3')
distance x is tensor(189.6072, device='cuda:3')
return_distance is  tensor(189.6072, device='cuda:3')
distance x is tensor(189.5981, device='cuda:3')
distance x is tensor(189.5981, device='cuda:3')
________________________________
test distance is  tensor(189.5981, device='cuda:3')
test distance1 is  tensor(189.5981, device='cuda:3')
test similarity is  tensor(0.9428, device='cuda:3')
test acc is  0.10006666682299865
test loss is 452.56632022816996
test entropy is  3.1336584354458274e-05
________________________________
0
distance x is tensor(189.5981, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.873957768295559e-05
avg test loss is  452.1155192816435
avg accuracy is  0.17138333348966805
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.9428, device='cuda:3')
compute_distance is  tensor(189.5981, device='cuda:3')
compute_norm is  tensor(52.6875, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7504.6514, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5462001890007622
avg test loss is  2.879893615810093
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0731, device='cuda:3')
compute_distance is  tensor(7504.6514, device='cuda:3')
compute_norm is  tensor(437.4694, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7469.7642, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8472272865553655
avg test loss is  3.6319891809146285
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0731, device='cuda:3')
compute_distance is  tensor(7469.7642, device='cuda:3')
compute_norm is  tensor(435.5069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7434.9780, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.559859827256152
avg test loss is  2.8593903584266775
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0731, device='cuda:3')
compute_distance is  tensor(7434.9780, device='cuda:3')
compute_norm is  tensor(433.4055, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7400.5234, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8607737050254716
avg test loss is  3.6014639578902643
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0732, device='cuda:3')
compute_distance is  tensor(7400.5234, device='cuda:3')
compute_norm is  tensor(431.5711, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7366.0195, device='cuda:3')
distance x is tensor(7366.0195, device='cuda:3')
________________________________
test distance is  tensor(7366.0195, device='cuda:3')
test distance1 is  tensor(7366.0195, device='cuda:3')
test similarity is  tensor(0.0731, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8605906439742554
test entropy is  1.5588893435402973
________________________________
cal ratio is  0.15847345221008174
distance x is tensor(1167.3175, device='cuda:3')
cal_distance is  tensor(1167.3175, device='cuda:3')
cal ratio is  0.39808741648880924
distance x is tensor(464.6938, device='cuda:3')
cal_distance is  tensor(464.6938, device='cuda:3')
cal ratio is  0.6309421316187518
distance x is tensor(293.1946, device='cuda:3')
cal_distance is  tensor(293.1946, device='cuda:3')
cal ratio is  0.7943190379355822
distance x is tensor(232.8898, device='cuda:3')
cal_distance is  tensor(232.8898, device='cuda:3')
cal ratio is  0.8912462064146011
distance x is tensor(207.5621, device='cuda:3')
cal_distance is  tensor(207.5621, device='cuda:3')
cal ratio is  0.9440585759424496
distance x is tensor(195.9507, device='cuda:3')
cal_distance is  tensor(195.9507, device='cuda:3')
cal ratio is  0.9716268603018635
distance x is tensor(190.3910, device='cuda:3')
cal_distance is  tensor(190.3910, device='cuda:3')
distance x is tensor(190.3910, device='cuda:3')
return_distance is  tensor(190.3910, device='cuda:3')
distance x is tensor(190.3929, device='cuda:3')
distance x is tensor(190.3929, device='cuda:3')
________________________________
test distance is  tensor(190.3929, device='cuda:3')
test distance1 is  tensor(190.3929, device='cuda:3')
test similarity is  tensor(0.9471, device='cuda:3')
test acc is  0.15485000015633352
test loss is 2.135650914106796
test entropy is  1.6340531123472428
________________________________
0
distance x is tensor(190.3929, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6347809314473605
avg test loss is  2.1383182289503786
avg accuracy is  0.3726333334896741
solo acc is  0.15675000015633378
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(190.3929, device='cuda:3')
compute_norm is  tensor(48.3990, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.5571, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7165880805012513
avg test loss is  2.6462257686200172
avg accuracy is  0.3844000001563409
solo acc is  0.1035333334896653
compute similarity  is  tensor(0.9472, device='cuda:3')
compute_distance is  tensor(192.5571, device='cuda:3')
compute_norm is  tensor(48.3469, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(194.2008, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0459051649453543
avg test loss is  1.6496228869281597
avg accuracy is  0.5500666668230086
solo acc is  0.22670000015633748
compute similarity  is  tensor(0.9474, device='cuda:3')
compute_distance is  tensor(194.2008, device='cuda:3')
compute_norm is  tensor(48.1423, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(194.2927, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.648304804555897
avg test loss is  2.4456426460605694
avg accuracy is  0.454383333489675
solo acc is  0.10496666682299861
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(194.2927, device='cuda:3')
compute_norm is  tensor(48.0354, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(195.7429, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0048443084078302
avg test loss is  1.579066321666815
avg accuracy is  0.5893000001563385
solo acc is  0.22371666682300403
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(195.7429, device='cuda:3')
compute_norm is  tensor(47.7715, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(196.0440, device='cuda:3')
distance x is tensor(196.0440, device='cuda:3')
________________________________
test distance is  tensor(196.0440, device='cuda:3')
test distance1 is  tensor(196.0440, device='cuda:3')
test similarity is  tensor(0.9468, device='cuda:3')
test acc is  0.1039333334896653
test loss is 2.3637186694246872
test entropy is  0.6258885310148634
________________________________
cal ratio is  0.971395794003943
distance x is tensor(190.4313, device='cuda:3')
cal_distance is  tensor(190.4313, device='cuda:3')
distance x is tensor(190.4313, device='cuda:3')
return_distance is  tensor(190.4313, device='cuda:3')
distance x is tensor(190.4364, device='cuda:3')
distance x is tensor(190.4364, device='cuda:3')
________________________________
test distance is  tensor(190.4364, device='cuda:3')
test distance1 is  tensor(190.4364, device='cuda:3')
test similarity is  tensor(0.9496, device='cuda:3')
test acc is  0.10470000015633195
test loss is 2.2999489622583775
test entropy is  0.6575939479921418
________________________________
0
distance x is tensor(190.4364, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6584793101114504
avg test loss is  2.304619980010905
avg accuracy is  0.4973666668230087
solo acc is  0.10493333348966528
compute similarity  is  tensor(0.9496, device='cuda:3')
compute_distance is  tensor(190.4364, device='cuda:3')
compute_norm is  tensor(47.5281, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.0284, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9813247882226891
avg test loss is  1.5052585389568354
avg accuracy is  0.615066666823003
solo acc is  0.23843333348967116
compute similarity  is  tensor(0.9495, device='cuda:3')
compute_distance is  tensor(192.0284, device='cuda:3')
compute_norm is  tensor(47.2767, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(192.0232, device='cuda:3')
________________________________
test distance is  tensor(192.0232, device='cuda:3')
test similarity is  tensor(0.9495, device='cuda:3')
test acc is  0.6137833334896697
test loss is 1.5014220404980787
test entropy is  0.9799814086987265
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.23800000016000009
mal loss is 1.5146793499588966
mal norm is  tensor(674.5301, device='cuda:3')
distance x is tensor(192.0232, device='cuda:3')
mal distance is  tensor(192.0232, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 837.2587,  648.5161,  571.6774,  739.2150,  669.0995,  880.7650,
         620.9128,  568.8184,  674.5301,  674.5301,  674.5301,  674.5301,
         674.5301,  674.5301,  674.5301,  674.5301,  674.5301,  674.5301,
         674.5301,  674.5301, 1290.2766, 1354.1001, 1370.8865, 1261.9342,
        1382.5753, 1320.5303, 1262.9686, 1317.7705,  824.9321,  817.1558,
         813.2872,  842.0414,  673.4347, 1124.0154,  896.2893,  830.9660,
         725.5746,  758.2733,  659.6827,  774.9794,  870.3044,  597.3380,
         810.1473,  728.2199], device='cuda:3')
sorted_norm is   tensor([ 568.8184,  571.6774,  597.3380,  620.9128,  648.5161,  659.6827,
         669.0995,  673.4347,  674.5301,  674.5301,  674.5301,  674.5301,
         674.5301,  674.5301,  674.5301,  674.5301,  674.5301,  674.5301,
         674.5301,  674.5301,  725.5746,  728.2199,  739.2150,  758.2733,
         774.9794,  810.1473,  813.2872,  817.1558,  824.9321,  830.9660,
         837.2587,  842.0414,  870.3044,  880.7650,  896.2893, 1124.0154,
        1261.9342, 1262.9686, 1290.2766, 1317.7705, 1320.5303, 1354.1001,
        1370.8865, 1382.5753], device='cuda:3')
used idx is  tensor([ 7,  2, 41,  6,  1, 38,  4, 32, 14, 12, 15, 17, 13, 19, 16, 18, 11, 10,
         8,  9, 36, 43,  3, 37, 39, 42, 30, 29, 28, 35,  0, 31, 40,  5, 34],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 46.70% 

Test Accuracy: 65.97% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8643616121262312
distance x is tensor(135.7943, device='cuda:3')
benign distance is  tensor(135.7943, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3527916260063648
distance x is tensor(128.1291, device='cuda:3')
benign distance is  tensor(128.1291, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1919916104525328
distance x is tensor(123.1653, device='cuda:3')
benign distance is  tensor(123.1653, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1770751848816872
distance x is tensor(149.1197, device='cuda:3')
benign distance is  tensor(149.1197, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4523758366703987
distance x is tensor(109.8567, device='cuda:3')
benign distance is  tensor(109.8567, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.063737940043211
distance x is tensor(125.6225, device='cuda:3')
benign distance is  tensor(125.6225, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9449713826179504
distance x is tensor(116.5465, device='cuda:3')
benign distance is  tensor(116.5465, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.03636927716434
distance x is tensor(108.7645, device='cuda:3')
benign distance is  tensor(108.7645, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0544071458280087
distance x is tensor(108.7173, device='cuda:3')
benign distance is  tensor(108.7173, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.050089268013835
distance x is tensor(129.7535, device='cuda:3')
benign distance is  tensor(129.7535, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4089755155146122
distance x is tensor(99.9009, device='cuda:3')
benign distance is  tensor(99.9009, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3762047588825226
distance x is tensor(120.8035, device='cuda:3')
benign distance is  tensor(120.8035, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4145819060504436
distance x is tensor(159.3970, device='cuda:3')
benign distance is  tensor(159.3970, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8549394644796848
distance x is tensor(100.2249, device='cuda:3')
benign distance is  tensor(100.2249, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9702104721218348
distance x is tensor(143.6742, device='cuda:3')
benign distance is  tensor(143.6742, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.4204428270459175
distance x is tensor(124.2944, device='cuda:3')
benign distance is  tensor(124.2944, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3953120224177837
distance x is tensor(128.5794, device='cuda:3')
benign distance is  tensor(128.5794, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1471766643226147
distance x is tensor(123.8797, device='cuda:3')
benign distance is  tensor(123.8797, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2885205149650574
distance x is tensor(136.6004, device='cuda:3')
benign distance is  tensor(136.6004, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4156715422868729
distance x is tensor(131.0603, device='cuda:3')
benign distance is  tensor(131.0603, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7062606811523438
distance x is tensor(114.3510, device='cuda:3')
benign distance is  tensor(114.3510, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9176384415477514
distance x is tensor(212.1310, device='cuda:3')
benign distance is  tensor(212.1310, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1749174296855927
distance x is tensor(149.0885, device='cuda:3')
benign distance is  tensor(149.0885, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6296424679458141
distance x is tensor(131.1949, device='cuda:3')
benign distance is  tensor(131.1949, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.274981454014778
distance x is tensor(125.8661, device='cuda:3')
benign distance is  tensor(125.8661, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.076721780002117
distance x is tensor(143.4946, device='cuda:3')
benign distance is  tensor(143.4946, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.630981508642435
distance x is tensor(143.2304, device='cuda:3')
benign distance is  tensor(143.2304, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3984588347375393
distance x is tensor(116.0166, device='cuda:3')
benign distance is  tensor(116.0166, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.9095498863607645
distance x is tensor(153.5917, device='cuda:3')
benign distance is  tensor(153.5917, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.3454397432506084
distance x is tensor(142.5649, device='cuda:3')
benign distance is  tensor(142.5649, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2976641058921814
distance x is tensor(125.4747, device='cuda:3')
benign distance is  tensor(125.4747, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7040183693170547
distance x is tensor(144.6107, device='cuda:3')
benign distance is  tensor(144.6107, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(88.6104, device='cuda:3')
compute distance is  tensor(88.6104, device='cuda:3')
compute norm is  tensor(46.0637, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1861, device='cuda:3')
compute distance is  tensor(143.1861, device='cuda:3')
compute norm is  tensor(47.2328, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.4173, device='cuda:3')
compute distance is  tensor(113.4173, device='cuda:3')
compute norm is  tensor(46.4528, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2498, device='cuda:3')
compute distance is  tensor(122.2498, device='cuda:3')
compute norm is  tensor(46.6056, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.1757, device='cuda:3')
compute distance is  tensor(107.1757, device='cuda:3')
compute norm is  tensor(46.3632, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7925, device='cuda:3')
compute distance is  tensor(133.7925, device='cuda:3')
compute norm is  tensor(46.9856, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0047, device='cuda:3')
compute distance is  tensor(132.0047, device='cuda:3')
compute norm is  tensor(46.9661, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.0891, device='cuda:3')
compute distance is  tensor(99.0891, device='cuda:3')
compute norm is  tensor(46.3747, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6664, device='cuda:3')
compute distance is  tensor(132.6664, device='cuda:3')
compute norm is  tensor(46.8984, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.0266, device='cuda:3')
compute distance is  tensor(110.0266, device='cuda:3')
compute norm is  tensor(46.5716, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4339, device='cuda:3')
compute distance is  tensor(121.4339, device='cuda:3')
compute norm is  tensor(46.6111, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.4517, device='cuda:3')
compute distance is  tensor(151.4517, device='cuda:3')
compute norm is  tensor(47.9412, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.4517, device='cuda:3')
distance x is tensor(102015.0234, device='cuda:3')
distance x is tensor(102015.0234, device='cuda:3')
________________________________
test distance is  tensor(102015.0234, device='cuda:3')
test distance1 is  tensor(102015.0234, device='cuda:3')
test similarity is  tensor(0.2613, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107484880689051.56
test entropy is  0.0
________________________________
cal ratio is  0.03775991664684215
distance x is tensor(3852.0835, device='cuda:3')
cal_distance is  tensor(3852.0835, device='cuda:3')
cal ratio is  0.19431899577915385
distance x is tensor(748.5367, device='cuda:3')
cal_distance is  tensor(748.5367, device='cuda:3')
cal ratio is  0.44081518354968785
distance x is tensor(329.9688, device='cuda:3')
cal_distance is  tensor(329.9688, device='cuda:3')
cal ratio is  0.6639366575941552
distance x is tensor(219.0800, device='cuda:3')
cal_distance is  tensor(219.0800, device='cuda:3')
cal ratio is  0.8148201521970396
distance x is tensor(178.5116, device='cuda:3')
cal_distance is  tensor(178.5116, device='cuda:3')
cal ratio is  0.9026717532402908
distance x is tensor(161.1378, device='cuda:3')
cal_distance is  tensor(161.1378, device='cuda:3')
cal ratio is  0.9500890679768698
distance x is tensor(153.0956, device='cuda:3')
cal_distance is  tensor(153.0956, device='cuda:3')
cal ratio is  0.974724347542352
distance x is tensor(149.2261, device='cuda:3')
cal_distance is  tensor(149.2261, device='cuda:3')
distance x is tensor(149.2261, device='cuda:3')
return_distance is  tensor(149.2261, device='cuda:3')
distance x is tensor(149.2170, device='cuda:3')
distance x is tensor(149.2170, device='cuda:3')
________________________________
test distance is  tensor(149.2170, device='cuda:3')
test distance1 is  tensor(149.2170, device='cuda:3')
test similarity is  tensor(0.9511, device='cuda:3')
test acc is  0.11893333348966527
test loss is 49.46051847299279
test entropy is  0.03714649896643786
________________________________
0
distance x is tensor(149.2170, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0367081653740533
avg test loss is  49.56678887470953
avg accuracy is  0.49486666682300867
solo acc is  0.11861666682299861
compute similarity  is  tensor(0.9511, device='cuda:3')
compute_distance is  tensor(149.2170, device='cuda:3')
compute_norm is  tensor(48.9739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.8840, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9420313094851813
avg test loss is  1.4378478717702283
avg accuracy is  0.700133333489664
solo acc is  0.27821666682300566
compute similarity  is  tensor(0.9526, device='cuda:3')
compute_distance is  tensor(142.8840, device='cuda:3')
compute_norm is  tensor(48.8107, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.8840, device='cuda:3')
distance x is tensor(142.8840, device='cuda:3')
________________________________
test distance is  tensor(142.8840, device='cuda:3')
test distance1 is  tensor(142.8840, device='cuda:3')
test similarity is  tensor(0.9526, device='cuda:3')
test acc is  0.27825000015633905
test loss is 1.4340976011524322
test entropy is  0.9438194910219229
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.28600000016000005
mal loss is 1.4500253275036812
mal norm is  tensor(727.1518, device='cuda:3')
distance x is tensor(142.8928, device='cuda:3')
mal distance is  tensor(142.8928, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([579.1057, 563.7608, 524.2059, 629.6829, 454.5825, 529.6577, 492.6383,
        462.9325, 727.1518, 727.1518, 727.1518, 727.1518, 727.1518, 727.1518,
        727.1518, 727.1518, 727.1518, 727.1518, 727.1518, 727.1518],
       device='cuda:3')
sorted_norm is   tensor([454.5825, 462.9325, 492.6383, 524.2059, 529.6577, 563.7608, 579.1057,
        629.6829, 727.1518, 727.1518, 727.1518, 727.1518, 727.1518, 727.1518,
        727.1518, 727.1518, 727.1518, 727.1518, 727.1518, 727.1518],
       device='cuda:3')
used idx is  tensor([ 4,  7,  6,  2,  5,  1,  0,  3, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 78.24% 

Test Accuracy: 80.82% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0461693927645683
distance x is tensor(166.3462, device='cuda:3')
benign distance is  tensor(166.3462, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9366653487086296
distance x is tensor(135.6348, device='cuda:3')
benign distance is  tensor(135.6348, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3101624473929405
distance x is tensor(132.9325, device='cuda:3')
benign distance is  tensor(132.9325, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8466858342289925
distance x is tensor(165.0102, device='cuda:3')
benign distance is  tensor(165.0102, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1037502381950617
distance x is tensor(131.4261, device='cuda:3')
benign distance is  tensor(131.4261, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1564224604517221
distance x is tensor(144.8860, device='cuda:3')
benign distance is  tensor(144.8860, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6616643518209457
distance x is tensor(111.6283, device='cuda:3')
benign distance is  tensor(111.6283, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0510560348629951
distance x is tensor(110.7644, device='cuda:3')
benign distance is  tensor(110.7644, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(109.1776, device='cuda:3')
compute distance is  tensor(109.1776, device='cuda:3')
compute norm is  tensor(48.3078, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.1317, device='cuda:3')
compute distance is  tensor(157.1317, device='cuda:3')
compute norm is  tensor(49.4367, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3044, device='cuda:3')
compute distance is  tensor(124.3044, device='cuda:3')
compute norm is  tensor(48.4831, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6172, device='cuda:3')
compute distance is  tensor(128.6172, device='cuda:3')
compute norm is  tensor(48.4753, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.9548, device='cuda:3')
compute distance is  tensor(111.9548, device='cuda:3')
compute norm is  tensor(48.0475, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.6075, device='cuda:3')
compute distance is  tensor(135.6075, device='cuda:3')
compute norm is  tensor(48.7542, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1142, device='cuda:3')
compute distance is  tensor(142.1142, device='cuda:3')
compute norm is  tensor(48.7469, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.2409, device='cuda:3')
compute distance is  tensor(105.2409, device='cuda:3')
compute norm is  tensor(48.0543, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.8722, device='cuda:3')
compute distance is  tensor(157.8722, device='cuda:3')
compute norm is  tensor(49.1990, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.3743, device='cuda:3')
compute distance is  tensor(121.3743, device='cuda:3')
compute norm is  tensor(48.5280, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2307, device='cuda:3')
compute distance is  tensor(125.2307, device='cuda:3')
compute norm is  tensor(48.4160, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.7557, device='cuda:3')
compute distance is  tensor(164.7557, device='cuda:3')
compute norm is  tensor(50.1313, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.7557, device='cuda:3')
distance x is tensor(101956.8516, device='cuda:3')
distance x is tensor(101956.8516, device='cuda:3')
________________________________
test distance is  tensor(101956.8516, device='cuda:3')
test distance1 is  tensor(101956.8516, device='cuda:3')
test similarity is  tensor(0.3987, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107672019927040.0
test entropy is  0.0
________________________________
cal ratio is  0.039394731544738174
distance x is tensor(4016.5674, device='cuda:3')
cal_distance is  tensor(4016.5674, device='cuda:3')
cal ratio is  0.19848094886913462
distance x is tensor(797.2158, device='cuda:3')
cal_distance is  tensor(797.2158, device='cuda:3')
cal ratio is  0.44551096044195027
distance x is tensor(355.1709, device='cuda:3')
cal_distance is  tensor(355.1709, device='cuda:3')
cal ratio is  0.6674636907024555
distance x is tensor(237.0652, device='cuda:3')
cal_distance is  tensor(237.0652, device='cuda:3')
cal ratio is  0.8169818778485298
distance x is tensor(193.6788, device='cuda:3')
cal_distance is  tensor(193.6788, device='cuda:3')
cal ratio is  0.9038686124570398
distance x is tensor(175.0607, device='cuda:3')
cal_distance is  tensor(175.0607, device='cuda:3')
cal ratio is  0.9507187888223149
distance x is tensor(166.4337, device='cuda:3')
cal_distance is  tensor(166.4337, device='cuda:3')
cal ratio is  0.9750474487032071
distance x is tensor(162.2808, device='cuda:3')
cal_distance is  tensor(162.2808, device='cuda:3')
distance x is tensor(162.2808, device='cuda:3')
return_distance is  tensor(162.2808, device='cuda:3')
distance x is tensor(162.2718, device='cuda:3')
distance x is tensor(162.2718, device='cuda:3')
________________________________
test distance is  tensor(162.2718, device='cuda:3')
test distance1 is  tensor(162.2718, device='cuda:3')
test similarity is  tensor(0.9575, device='cuda:3')
test acc is  0.1003333334896653
test loss is 212.74098548807822
test entropy is  0.0002536938632040533
________________________________
0
distance x is tensor(162.2718, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0001801045485539135
avg test loss is  212.68371279458248
avg accuracy is  0.32495000015634
solo acc is  0.10031666682299864
compute similarity  is  tensor(0.9575, device='cuda:3')
compute_distance is  tensor(162.2718, device='cuda:3')
compute_norm is  tensor(52.3764, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.7396, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1215061666741808
avg test loss is  1.8077213182123995
avg accuracy is  0.677150000156332
solo acc is  0.19235000015633597
compute similarity  is  tensor(0.9582, device='cuda:3')
compute_distance is  tensor(159.7396, device='cuda:3')
compute_norm is  tensor(52.8812, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.3925, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6636054878677132
avg test loss is  2.621125777647185
avg accuracy is  0.662400000156333
solo acc is  0.1046833334896653
compute similarity  is  tensor(0.9581, device='cuda:3')
compute_distance is  tensor(160.3925, device='cuda:3')
compute_norm is  tensor(52.7473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.3870, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0624825340598376
avg test loss is  1.6838084738900159
avg accuracy is  0.6885166668229981
solo acc is  0.20028333348966973
compute similarity  is  tensor(0.9584, device='cuda:3')
compute_distance is  tensor(160.3870, device='cuda:3')
compute_norm is  tensor(52.4168, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.7593, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6310401953486745
avg test loss is  2.5142155456136286
avg accuracy is  0.6644666668229995
solo acc is  0.10396666682299864
compute similarity  is  tensor(0.9583, device='cuda:3')
compute_distance is  tensor(160.7593, device='cuda:3')
compute_norm is  tensor(52.2643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.7891, device='cuda:3')
distance x is tensor(160.7891, device='cuda:3')
________________________________
test distance is  tensor(160.7891, device='cuda:3')
test distance1 is  tensor(160.7891, device='cuda:3')
test similarity is  tensor(0.9584, device='cuda:3')
test acc is  0.2026333334896698
test loss is 1.6163251035249055
test entropy is  1.0413142820792411
________________________________
0
distance x is tensor(160.7891, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0424866602619065
avg test loss is  1.612571498732577
avg accuracy is  0.6905666668229979
solo acc is  0.20498333348966993
compute similarity  is  tensor(0.9584, device='cuda:3')
compute_distance is  tensor(160.7891, device='cuda:3')
compute_norm is  tensor(51.9591, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.0837, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6324726929669695
avg test loss is  2.41391124133108
avg accuracy is  0.6631666668229996
solo acc is  0.1039333334896653
compute similarity  is  tensor(0.9583, device='cuda:3')
compute_distance is  tensor(161.0837, device='cuda:3')
compute_norm is  tensor(51.8037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.3071, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.002203037807428
avg test loss is  1.58199530001134
avg accuracy is  0.6964666668229975
solo acc is  0.2043833334896699
compute similarity  is  tensor(0.9583, device='cuda:3')
compute_distance is  tensor(161.3071, device='cuda:3')
compute_norm is  tensor(51.5137, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.5570, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6274543757886012
avg test loss is  2.3556729772451845
avg accuracy is  0.6634500001563329
solo acc is  0.1029833334896653
compute similarity  is  tensor(0.9581, device='cuda:3')
compute_distance is  tensor(161.5570, device='cuda:3')
compute_norm is  tensor(51.3568, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.9100, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.986987692969186
avg test loss is  1.5556537938524666
avg accuracy is  0.6982000001563308
solo acc is  0.20726666682300338
compute similarity  is  tensor(0.9581, device='cuda:3')
compute_distance is  tensor(161.9100, device='cuda:3')
compute_norm is  tensor(51.0803, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(161.9100, device='cuda:3')
distance x is tensor(161.9100, device='cuda:3')
________________________________
test distance is  tensor(161.9100, device='cuda:3')
test distance1 is  tensor(161.9100, device='cuda:3')
test similarity is  tensor(0.9581, device='cuda:3')
test acc is  0.20675000015633666
test loss is 1.554448995635962
test entropy is  0.9881901372470328
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.21600000016000007
mal loss is 1.5585973486304283
mal norm is  tensor(746.5382, device='cuda:3')
distance x is tensor(161.9186, device='cuda:3')
mal distance is  tensor(161.9186, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([689.8578, 560.5712, 534.4376, 669.2750, 531.4089, 571.5944, 459.3233,
        453.5515, 746.5381, 746.5382, 746.5381, 746.5382, 746.5381, 746.5382,
        746.5381, 746.5382, 746.5381, 746.5382, 746.5381, 746.5382, 745.9068,
        648.6835, 808.8824, 731.3769, 736.5061, 776.7716, 731.2993, 899.3312,
        591.1717, 659.1052, 549.6479, 642.8468, 776.3889, 561.5136, 709.2246,
        654.5909], device='cuda:3')
sorted_norm is   tensor([453.5515, 459.3233, 531.4089, 534.4376, 549.6479, 560.5712, 561.5136,
        571.5944, 591.1717, 642.8468, 648.6835, 654.5909, 659.1052, 669.2750,
        689.8578, 709.2246, 731.2993, 731.3769, 736.5061, 745.9068, 746.5381,
        746.5381, 746.5381, 746.5381, 746.5381, 746.5381, 746.5382, 746.5382,
        746.5382, 746.5382, 746.5382, 746.5382, 776.3889, 776.7716, 808.8824,
        899.3312], device='cuda:3')
used idx is  tensor([ 7,  6,  4,  2, 30,  1, 33,  5, 28, 31, 21, 35, 29,  3,  0, 34, 26, 23,
        24, 20, 10, 18, 16, 14, 12,  8, 15, 13], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 73.42% 

Test Accuracy: 77.35% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7181346900761127
distance x is tensor(144.1653, device='cuda:3')
benign distance is  tensor(144.1653, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4011168517172337
distance x is tensor(131.3065, device='cuda:3')
benign distance is  tensor(131.3065, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.456913311034441
distance x is tensor(125.4855, device='cuda:3')
benign distance is  tensor(125.4855, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8727247267961502
distance x is tensor(163.6182, device='cuda:3')
benign distance is  tensor(163.6182, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1542044933885336
distance x is tensor(112.5709, device='cuda:3')
benign distance is  tensor(112.5709, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2697653248906136
distance x is tensor(116.9248, device='cuda:3')
benign distance is  tensor(116.9248, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6606404781341553
distance x is tensor(117.9325, device='cuda:3')
benign distance is  tensor(117.9325, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9337538201361895
distance x is tensor(111.5832, device='cuda:3')
benign distance is  tensor(111.5832, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1111081894487143
distance x is tensor(111.8414, device='cuda:3')
benign distance is  tensor(111.8414, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0973336268216372
distance x is tensor(144.8200, device='cuda:3')
benign distance is  tensor(144.8200, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.375658918172121
distance x is tensor(100.8050, device='cuda:3')
benign distance is  tensor(100.8050, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.208696112036705
distance x is tensor(122.1244, device='cuda:3')
benign distance is  tensor(122.1244, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.1996026039123535
distance x is tensor(172.5549, device='cuda:3')
benign distance is  tensor(172.5549, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9944767560809851
distance x is tensor(82.1522, device='cuda:3')
benign distance is  tensor(82.1522, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.912002719938755
distance x is tensor(149.6539, device='cuda:3')
benign distance is  tensor(149.6539, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.8536214381456375
distance x is tensor(129.6989, device='cuda:3')
benign distance is  tensor(129.6989, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.553226761519909
distance x is tensor(123.4208, device='cuda:3')
benign distance is  tensor(123.4208, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3724353648722172
distance x is tensor(122.6990, device='cuda:3')
benign distance is  tensor(122.6990, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.9322646632790565
distance x is tensor(130.5897, device='cuda:3')
benign distance is  tensor(130.5897, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.0857060253620148
distance x is tensor(120.6314, device='cuda:3')
benign distance is  tensor(120.6314, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9679281134158373
distance x is tensor(125.1317, device='cuda:3')
benign distance is  tensor(125.1317, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.2324532978236675
distance x is tensor(143.4674, device='cuda:3')
benign distance is  tensor(143.4674, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6196970865130424
distance x is tensor(126.4393, device='cuda:3')
benign distance is  tensor(126.4393, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.320232778787613
distance x is tensor(167.0209, device='cuda:3')
benign distance is  tensor(167.0209, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(85.3645, device='cuda:3')
compute distance is  tensor(85.3645, device='cuda:3')
compute norm is  tensor(47.8658, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.7129, device='cuda:3')
compute distance is  tensor(153.7129, device='cuda:3')
compute norm is  tensor(49.1540, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.2738, device='cuda:3')
compute distance is  tensor(117.2738, device='cuda:3')
compute norm is  tensor(48.2224, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.1450, device='cuda:3')
compute distance is  tensor(101.1450, device='cuda:3')
compute norm is  tensor(48.1282, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.1863, device='cuda:3')
compute distance is  tensor(103.1863, device='cuda:3')
compute norm is  tensor(48.0521, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8454, device='cuda:3')
compute distance is  tensor(121.8454, device='cuda:3')
compute norm is  tensor(48.6035, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9965, device='cuda:3')
compute distance is  tensor(131.9965, device='cuda:3')
compute norm is  tensor(48.6237, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.8046, device='cuda:3')
compute distance is  tensor(100.8046, device='cuda:3')
compute norm is  tensor(48.1156, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7555, device='cuda:3')
compute distance is  tensor(140.7555, device='cuda:3')
compute norm is  tensor(48.9119, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8475, device='cuda:3')
compute distance is  tensor(114.8475, device='cuda:3')
compute norm is  tensor(48.4663, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2245, device='cuda:3')
compute distance is  tensor(125.2245, device='cuda:3')
compute norm is  tensor(48.5607, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.2642, device='cuda:3')
compute distance is  tensor(156.2642, device='cuda:3')
compute norm is  tensor(49.9855, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(156.2642, device='cuda:3')
distance x is tensor(101960.0156, device='cuda:3')
distance x is tensor(101960.0156, device='cuda:3')
________________________________
test distance is  tensor(101960.0156, device='cuda:3')
test distance1 is  tensor(101960.0156, device='cuda:3')
test similarity is  tensor(0.3980, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107606673565027.89
test entropy is  0.0
________________________________
cal ratio is  0.038365497718977855
distance x is tensor(3911.7522, device='cuda:3')
cal_distance is  tensor(3911.7522, device='cuda:3')
cal ratio is  0.1958709913901345
distance x is tensor(766.2023, device='cuda:3')
cal_distance is  tensor(766.2023, device='cuda:3')
cal ratio is  0.4425721144238605
distance x is tensor(339.1023, device='cuda:3')
cal_distance is  tensor(339.1023, device='cuda:3')
cal ratio is  0.6652584665968181
distance x is tensor(225.5922, device='cuda:3')
cal_distance is  tensor(225.5922, device='cuda:3')
cal ratio is  0.8156310057583388
distance x is tensor(184.0008, device='cuda:3')
cal_distance is  tensor(184.0008, device='cuda:3')
cal ratio is  0.9031208841302664
distance x is tensor(166.1754, device='cuda:3')
cal_distance is  tensor(166.1754, device='cuda:3')
cal ratio is  0.9503254654917794
distance x is tensor(157.9210, device='cuda:3')
cal_distance is  tensor(157.9210, device='cuda:3')
cal ratio is  0.9748456147792545
distance x is tensor(153.9487, device='cuda:3')
cal_distance is  tensor(153.9487, device='cuda:3')
distance x is tensor(153.9487, device='cuda:3')
return_distance is  tensor(153.9487, device='cuda:3')
distance x is tensor(153.9397, device='cuda:3')
distance x is tensor(153.9397, device='cuda:3')
________________________________
test distance is  tensor(153.9397, device='cuda:3')
test distance1 is  tensor(153.9397, device='cuda:3')
test similarity is  tensor(0.9609, device='cuda:3')
test acc is  0.3537333334896738
test loss is 19.74090332466402
test entropy is  0.12691100013615098
________________________________
0
distance x is tensor(153.9397, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.12707098314502854
avg test loss is  19.710779167695847
avg accuracy is  0.7197000001563295
solo acc is  0.35381666682300716
compute similarity  is  tensor(0.9609, device='cuda:3')
compute_distance is  tensor(153.9397, device='cuda:3')
compute_norm is  tensor(51.9784, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.6620, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0459043815064786
avg test loss is  1.5736613783246673
avg accuracy is  0.7212666668229961
solo acc is  0.22835000015633755
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(149.6620, device='cuda:3')
compute_norm is  tensor(51.9719, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(150.0128, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6186209832872155
avg test loss is  2.4148355347515422
avg accuracy is  0.6979166668229976
solo acc is  0.10475000015633196
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(150.0128, device='cuda:3')
compute_norm is  tensor(51.7929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.8262, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9596147237937334
avg test loss is  1.4763753110411832
avg accuracy is  0.7475000001563281
solo acc is  0.24756666682300482
compute similarity  is  tensor(0.9622, device='cuda:3')
compute_distance is  tensor(149.8262, device='cuda:3')
compute_norm is  tensor(51.5387, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(149.8262, device='cuda:3')
distance x is tensor(149.8262, device='cuda:3')
________________________________
test distance is  tensor(149.8262, device='cuda:3')
test distance1 is  tensor(149.8262, device='cuda:3')
test similarity is  tensor(0.9622, device='cuda:3')
test acc is  0.250166666823005
test loss is 1.4735684111428413
test entropy is  0.9592806892608529
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2450000001600001
mal loss is 1.4880100265145302
mal norm is  tensor(736.7971, device='cuda:3')
distance x is tensor(149.8350, device='cuda:3')
mal distance is  tensor(149.8350, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([599.3866, 527.0122, 522.9253, 672.0435, 461.4234, 473.3189, 494.6945,
        467.0042, 736.7971, 736.7971, 736.7971, 736.7971, 736.7971, 736.7971,
        736.7971, 736.7971, 736.7971, 736.7971, 736.7971, 736.7971, 667.3819,
        647.9890, 679.2418, 677.3423, 601.3434, 975.6080, 731.8604, 670.3568],
       device='cuda:3')
sorted_norm is   tensor([461.4234, 467.0042, 473.3189, 494.6945, 522.9253, 527.0122, 599.3866,
        601.3434, 647.9890, 667.3819, 670.3568, 672.0435, 677.3423, 679.2418,
        731.8604, 736.7971, 736.7971, 736.7971, 736.7971, 736.7971, 736.7971,
        736.7971, 736.7971, 736.7971, 736.7971, 736.7971, 736.7971, 975.6080],
       device='cuda:3')
used idx is  tensor([ 4,  7,  5,  6,  2,  1,  0, 24, 21, 20, 27,  3, 23, 22, 26, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 72.93% 

Test Accuracy: 80.70% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8730118442326784
distance x is tensor(130.9641, device='cuda:3')
benign distance is  tensor(130.9641, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7151838690042496
distance x is tensor(131.6395, device='cuda:3')
benign distance is  tensor(131.6395, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1451392099261284
distance x is tensor(113.0243, device='cuda:3')
benign distance is  tensor(113.0243, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.686769887804985
distance x is tensor(163.4410, device='cuda:3')
benign distance is  tensor(163.4410, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5472999028861523
distance x is tensor(106.1697, device='cuda:3')
benign distance is  tensor(106.1697, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0143408887088299
distance x is tensor(116.9875, device='cuda:3')
benign distance is  tensor(116.9875, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.480746366083622
distance x is tensor(102.9462, device='cuda:3')
benign distance is  tensor(102.9462, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.100527599453926
distance x is tensor(103.4794, device='cuda:3')
benign distance is  tensor(103.4794, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7744500413537025
distance x is tensor(130.5882, device='cuda:3')
benign distance is  tensor(130.5882, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0830877423286438
distance x is tensor(114.1074, device='cuda:3')
benign distance is  tensor(114.1074, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7337208166718483
distance x is tensor(135.6702, device='cuda:3')
benign distance is  tensor(135.6702, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.522309709340334
distance x is tensor(126.8409, device='cuda:3')
benign distance is  tensor(126.8409, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1952121295034885
distance x is tensor(90.3357, device='cuda:3')
benign distance is  tensor(90.3357, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0661873780190945
distance x is tensor(207.7272, device='cuda:3')
benign distance is  tensor(207.7272, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0932930894196033
distance x is tensor(175.2215, device='cuda:3')
benign distance is  tensor(175.2215, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9151040893048048
distance x is tensor(115.3152, device='cuda:3')
benign distance is  tensor(115.3152, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(94.4983, device='cuda:3')
compute distance is  tensor(94.4983, device='cuda:3')
compute norm is  tensor(48.9358, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3623, device='cuda:3')
compute distance is  tensor(148.3623, device='cuda:3')
compute norm is  tensor(50.0968, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.7312, device='cuda:3')
compute distance is  tensor(101.7312, device='cuda:3')
compute norm is  tensor(48.9128, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9864, device='cuda:3')
compute distance is  tensor(116.9864, device='cuda:3')
compute norm is  tensor(49.0580, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.4585, device='cuda:3')
compute distance is  tensor(102.4585, device='cuda:3')
compute norm is  tensor(48.8001, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2663, device='cuda:3')
compute distance is  tensor(139.2663, device='cuda:3')
compute norm is  tensor(49.6587, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5327, device='cuda:3')
compute distance is  tensor(128.5327, device='cuda:3')
compute norm is  tensor(49.4666, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.0952, device='cuda:3')
compute distance is  tensor(95.0952, device='cuda:3')
compute norm is  tensor(48.9035, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5136, device='cuda:3')
compute distance is  tensor(135.5136, device='cuda:3')
compute norm is  tensor(49.6342, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.2543, device='cuda:3')
compute distance is  tensor(110.2543, device='cuda:3')
compute norm is  tensor(49.2443, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.4610, device='cuda:3')
compute distance is  tensor(114.4610, device='cuda:3')
compute norm is  tensor(49.1438, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4770, device='cuda:3')
compute distance is  tensor(150.4770, device='cuda:3')
compute norm is  tensor(50.5430, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(150.4770, device='cuda:3')
distance x is tensor(101949.5078, device='cuda:3')
distance x is tensor(101949.5078, device='cuda:3')
________________________________
test distance is  tensor(101949.5078, device='cuda:3')
test distance1 is  tensor(101949.5078, device='cuda:3')
test similarity is  tensor(0.4240, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107568708173998.67
test entropy is  0.0
________________________________
cal ratio is  0.03765031192979298
distance x is tensor(3838.4355, device='cuda:3')
cal_distance is  tensor(3838.4355, device='cuda:3')
cal ratio is  0.19403675836186568
distance x is tensor(744.8012, device='cuda:3')
cal_distance is  tensor(744.8012, device='cuda:3')
cal ratio is  0.44049497835488177
distance x is tensor(328.0837, device='cuda:3')
cal_distance is  tensor(328.0837, device='cuda:3')
cal ratio is  0.6636953715295784
distance x is tensor(217.7492, device='cuda:3')
cal_distance is  tensor(217.7492, device='cuda:3')
cal ratio is  0.8146721840294162
distance x is tensor(177.3951, device='cuda:3')
cal_distance is  tensor(177.3951, device='cuda:3')
cal ratio is  0.9025897202448193
distance x is tensor(160.1154, device='cuda:3')
cal_distance is  tensor(160.1154, device='cuda:3')
cal ratio is  0.9500459570434746
distance x is tensor(152.1172, device='cuda:3')
cal_distance is  tensor(152.1172, device='cuda:3')
cal ratio is  0.9747022359332771
distance x is tensor(148.2691, device='cuda:3')
cal_distance is  tensor(148.2691, device='cuda:3')
distance x is tensor(148.2691, device='cuda:3')
return_distance is  tensor(148.2691, device='cuda:3')
distance x is tensor(148.2601, device='cuda:3')
distance x is tensor(148.2601, device='cuda:3')
________________________________
test distance is  tensor(148.2601, device='cuda:3')
test distance1 is  tensor(148.2601, device='cuda:3')
test similarity is  tensor(0.9660, device='cuda:3')
test acc is  0.1038833334896653
test loss is 92.19262545652735
test entropy is  0.0041245377216593
________________________________
0
distance x is tensor(148.2601, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.004537285501558763
avg test loss is  92.29787201057873
avg accuracy is  0.578616666823006
solo acc is  0.10416666682299863
compute similarity  is  tensor(0.9660, device='cuda:3')
compute_distance is  tensor(148.2601, device='cuda:3')
compute_norm is  tensor(52.7804, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.8436, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9825260381835864
avg test loss is  1.5090868526430272
avg accuracy is  0.7482000001563279
solo acc is  0.24613333348967145
compute similarity  is  tensor(0.9675, device='cuda:3')
compute_distance is  tensor(142.8436, device='cuda:3')
compute_norm is  tensor(52.8652, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.8436, device='cuda:3')
distance x is tensor(142.8436, device='cuda:3')
________________________________
test distance is  tensor(142.8436, device='cuda:3')
test distance1 is  tensor(142.8436, device='cuda:3')
test similarity is  tensor(0.9675, device='cuda:3')
test acc is  0.24330000015633801
test loss is 1.5101663003852372
test entropy is  0.9831127941862606
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2580000001600001
mal loss is 1.4880614504218102
mal norm is  tensor(720.4739, device='cuda:3')
distance x is tensor(142.8527, device='cuda:3')
mal distance is  tensor(142.8527, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([552.7332, 532.5858, 461.3593, 660.9855, 430.9804, 466.3807, 423.7578,
        421.3220, 720.4739, 720.4739, 720.4739, 720.4739, 720.4739, 720.4739,
        720.4739, 720.4739, 720.4739, 720.4739, 720.4739, 720.4739, 670.5095,
        644.5662, 689.6366, 631.3829, 699.7449, 602.9453, 573.0417, 688.2373,
        479.8321, 610.4562, 427.6298, 516.9775, 700.9530, 363.4900, 620.3512,
        553.6987], device='cuda:3')
sorted_norm is   tensor([363.4900, 421.3220, 423.7578, 427.6298, 430.9804, 461.3593, 466.3807,
        479.8321, 516.9775, 532.5858, 552.7332, 553.6987, 573.0417, 602.9453,
        610.4562, 620.3512, 631.3829, 644.5662, 660.9855, 670.5095, 688.2373,
        689.6366, 699.7449, 700.9530, 720.4739, 720.4739, 720.4739, 720.4739,
        720.4739, 720.4739, 720.4739, 720.4739, 720.4739, 720.4739, 720.4739,
        720.4739], device='cuda:3')
used idx is  tensor([33,  7,  6, 30,  4,  2,  5, 28, 31,  1,  0, 35, 26, 25, 29, 34, 23, 21,
         3, 20, 27, 22, 24, 32, 11, 10,  8,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 80.10% 

Test Accuracy: 83.86% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7525982297956944
distance x is tensor(127.9725, device='cuda:3')
benign distance is  tensor(127.9725, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.03595881909132
distance x is tensor(114.1740, device='cuda:3')
benign distance is  tensor(114.1740, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3159803040325642
distance x is tensor(113.7835, device='cuda:3')
benign distance is  tensor(113.7835, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.27945776283741
distance x is tensor(141.9497, device='cuda:3')
benign distance is  tensor(141.9497, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.090495638549328
distance x is tensor(101.3180, device='cuda:3')
benign distance is  tensor(101.3180, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9131302870810032
distance x is tensor(106.8878, device='cuda:3')
benign distance is  tensor(106.8878, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.671087495982647
distance x is tensor(100.8780, device='cuda:3')
benign distance is  tensor(100.8780, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1343538202345371
distance x is tensor(92.6657, device='cuda:3')
benign distance is  tensor(92.6657, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5862851031124592
distance x is tensor(101.9102, device='cuda:3')
benign distance is  tensor(101.9102, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7749262731522322
distance x is tensor(128.6158, device='cuda:3')
benign distance is  tensor(128.6158, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5129861682653427
distance x is tensor(86.1964, device='cuda:3')
benign distance is  tensor(86.1964, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.8382379561662674
distance x is tensor(120.6116, device='cuda:3')
benign distance is  tensor(120.6116, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.599739618599415
distance x is tensor(174.4996, device='cuda:3')
benign distance is  tensor(174.4996, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0727799590677023
distance x is tensor(73.5470, device='cuda:3')
benign distance is  tensor(73.5470, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6487894169986248
distance x is tensor(131.5375, device='cuda:3')
benign distance is  tensor(131.5375, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.39958918094635
distance x is tensor(126.9220, device='cuda:3')
benign distance is  tensor(126.9220, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8040746878832579
distance x is tensor(120.3339, device='cuda:3')
benign distance is  tensor(120.3339, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.733190730214119
distance x is tensor(108.9975, device='cuda:3')
benign distance is  tensor(108.9975, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1525633595883846
distance x is tensor(137.3834, device='cuda:3')
benign distance is  tensor(137.3834, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.8007679283618927
distance x is tensor(118.9703, device='cuda:3')
benign distance is  tensor(118.9703, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8856046479195356
distance x is tensor(113.7799, device='cuda:3')
benign distance is  tensor(113.7799, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.035824028775096
distance x is tensor(86.3141, device='cuda:3')
benign distance is  tensor(86.3141, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.3272040709853172
distance x is tensor(91.0153, device='cuda:3')
benign distance is  tensor(91.0153, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9287414252758026
distance x is tensor(131.3066, device='cuda:3')
benign distance is  tensor(131.3066, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(82.1402, device='cuda:3')
compute distance is  tensor(82.1402, device='cuda:3')
compute norm is  tensor(48.9670, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2803, device='cuda:3')
compute distance is  tensor(139.2803, device='cuda:3')
compute norm is  tensor(50.1499, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.7925, device='cuda:3')
compute distance is  tensor(102.7925, device='cuda:3')
compute norm is  tensor(49.0929, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.1645, device='cuda:3')
compute distance is  tensor(100.1645, device='cuda:3')
compute norm is  tensor(49.2996, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.5429, device='cuda:3')
compute distance is  tensor(102.5429, device='cuda:3')
compute norm is  tensor(49.1221, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.7309, device='cuda:3')
compute distance is  tensor(110.7309, device='cuda:3')
compute norm is  tensor(49.4006, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9813, device='cuda:3')
compute distance is  tensor(123.9813, device='cuda:3')
compute norm is  tensor(49.8452, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.3341, device='cuda:3')
compute distance is  tensor(99.3341, device='cuda:3')
compute norm is  tensor(49.1983, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4338, device='cuda:3')
compute distance is  tensor(123.4338, device='cuda:3')
compute norm is  tensor(49.6531, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7560, device='cuda:3')
compute distance is  tensor(103.7560, device='cuda:3')
compute norm is  tensor(49.4431, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5105, device='cuda:3')
compute distance is  tensor(121.5105, device='cuda:3')
compute norm is  tensor(49.6578, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.2932, device='cuda:3')
compute distance is  tensor(148.2932, device='cuda:3')
compute norm is  tensor(50.7524, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(148.2932, device='cuda:3')
distance x is tensor(101950.6172, device='cuda:3')
distance x is tensor(101950.6172, device='cuda:3')
________________________________
test distance is  tensor(101950.6172, device='cuda:3')
test distance1 is  tensor(101950.6172, device='cuda:3')
test similarity is  tensor(0.4157, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107701995759192.42
test entropy is  0.0
________________________________
cal ratio is  0.03737590503067823
distance x is tensor(3810.5012, device='cuda:3')
cal_distance is  tensor(3810.5012, device='cuda:3')
cal ratio is  0.19332837210747095
distance x is tensor(736.6817, device='cuda:3')
cal_distance is  tensor(736.6817, device='cuda:3')
cal ratio is  0.43969011714023554
distance x is tensor(323.9142, device='cuda:3')
cal_distance is  tensor(323.9142, device='cuda:3')
cal ratio is  0.6630887507113528
distance x is tensor(214.7854, device='cuda:3')
cal_distance is  tensor(214.7854, device='cuda:3')
cal ratio is  0.8142997558214865
distance x is tensor(174.9005, device='cuda:3')
cal_distance is  tensor(174.9005, device='cuda:3')
cal ratio is  0.9023834156912693
distance x is tensor(157.8278, device='cuda:3')
cal_distance is  tensor(157.8278, device='cuda:3')
cal ratio is  0.9499373124295173
distance x is tensor(149.9267, device='cuda:3')
cal_distance is  tensor(149.9267, device='cuda:3')
cal ratio is  0.9746464701654802
distance x is tensor(146.1257, device='cuda:3')
cal_distance is  tensor(146.1257, device='cuda:3')
distance x is tensor(146.1257, device='cuda:3')
return_distance is  tensor(146.1257, device='cuda:3')
distance x is tensor(146.1167, device='cuda:3')
distance x is tensor(146.1167, device='cuda:3')
________________________________
test distance is  tensor(146.1167, device='cuda:3')
test distance1 is  tensor(146.1167, device='cuda:3')
test similarity is  tensor(0.9665, device='cuda:3')
test acc is  0.16036666682300071
test loss is 58.3192841137396
test entropy is  0.02854161964746214
________________________________
0
distance x is tensor(146.1167, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02962857977674429
avg test loss is  58.70284800742989
avg accuracy is  0.7294833334896622
solo acc is  0.15990000015633396
compute similarity  is  tensor(0.9665, device='cuda:3')
compute_distance is  tensor(146.1167, device='cuda:3')
compute_norm is  tensor(52.9368, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.0742, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9477332828522745
avg test loss is  1.4416548881703601
avg accuracy is  0.7801833334896597
solo acc is  0.27643333348967225
compute similarity  is  tensor(0.9674, device='cuda:3')
compute_distance is  tensor(142.0742, device='cuda:3')
compute_norm is  tensor(52.7878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.0742, device='cuda:3')
distance x is tensor(142.0742, device='cuda:3')
________________________________
test distance is  tensor(142.0742, device='cuda:3')
test distance1 is  tensor(142.0742, device='cuda:3')
test similarity is  tensor(0.9674, device='cuda:3')
test acc is  0.278500000156339
test loss is 1.445975816707367
test entropy is  0.9478492623071935
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29300000016000005
mal loss is 1.4352236613631248
mal norm is  tensor(712.2350, device='cuda:3')
distance x is tensor(142.0830, device='cuda:3')
mal distance is  tensor(142.0830, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([544.8352, 468.5563, 456.9252, 587.5222, 407.2818, 427.9813, 414.5082,
        381.1017, 712.2350, 712.2350, 712.2350, 712.2350, 712.2350, 712.2350,
        712.2350, 712.2350, 712.2350, 712.2350, 712.2350, 712.2350],
       device='cuda:3')
sorted_norm is   tensor([381.1017, 407.2818, 414.5082, 427.9813, 456.9252, 468.5563, 544.8352,
        587.5222, 712.2350, 712.2350, 712.2350, 712.2350, 712.2350, 712.2350,
        712.2350, 712.2350, 712.2350, 712.2350, 712.2350, 712.2350],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  5,  2,  1,  0,  3, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 80.44% 

Test Accuracy: 81.70% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7691338583827019
distance x is tensor(163.7134, device='cuda:3')
benign distance is  tensor(163.7134, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5258148275315762
distance x is tensor(136.5448, device='cuda:3')
benign distance is  tensor(136.5448, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2805133536458015
distance x is tensor(125.3885, device='cuda:3')
benign distance is  tensor(125.3885, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9732456430792809
distance x is tensor(168.0002, device='cuda:3')
benign distance is  tensor(168.0002, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.470552995800972
distance x is tensor(104.0583, device='cuda:3')
benign distance is  tensor(104.0583, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.03636022657156
distance x is tensor(137.0074, device='cuda:3')
benign distance is  tensor(137.0074, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5013426542282104
distance x is tensor(128.6989, device='cuda:3')
benign distance is  tensor(128.6989, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3398178108036518
distance x is tensor(114.2572, device='cuda:3')
benign distance is  tensor(114.2572, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(106.8490, device='cuda:3')
compute distance is  tensor(106.8490, device='cuda:3')
compute norm is  tensor(51.8017, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.5507, device='cuda:3')
compute distance is  tensor(146.5507, device='cuda:3')
compute norm is  tensor(52.7295, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.0739, device='cuda:3')
compute distance is  tensor(122.0739, device='cuda:3')
compute norm is  tensor(51.9629, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6834, device='cuda:3')
compute distance is  tensor(126.6834, device='cuda:3')
compute norm is  tensor(52.1977, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.3903, device='cuda:3')
compute distance is  tensor(108.3903, device='cuda:3')
compute norm is  tensor(51.6377, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7989, device='cuda:3')
compute distance is  tensor(135.7989, device='cuda:3')
compute norm is  tensor(52.2740, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8882, device='cuda:3')
compute distance is  tensor(146.8882, device='cuda:3')
compute norm is  tensor(52.7378, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.4681, device='cuda:3')
compute distance is  tensor(112.4681, device='cuda:3')
compute norm is  tensor(51.9362, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9360, device='cuda:3')
compute distance is  tensor(139.9360, device='cuda:3')
compute norm is  tensor(52.2411, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4657, device='cuda:3')
compute distance is  tensor(122.4657, device='cuda:3')
compute norm is  tensor(52.1688, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5600, device='cuda:3')
compute distance is  tensor(126.5600, device='cuda:3')
compute norm is  tensor(52.1040, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.1361, device='cuda:3')
compute distance is  tensor(158.1361, device='cuda:3')
compute norm is  tensor(53.3736, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.1361, device='cuda:3')
distance x is tensor(101896.7031, device='cuda:3')
distance x is tensor(101896.7031, device='cuda:3')
________________________________
test distance is  tensor(101896.7031, device='cuda:3')
test distance1 is  tensor(101896.7031, device='cuda:3')
test similarity is  tensor(0.5203, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107657105885266.97
test entropy is  0.0
________________________________
cal ratio is  0.03860660095657255
distance x is tensor(3933.8899, device='cuda:3')
cal_distance is  tensor(3933.8899, device='cuda:3')
cal ratio is  0.196485516675662
distance x is tensor(772.9561, device='cuda:3')
cal_distance is  tensor(772.9561, device='cuda:3')
cal ratio is  0.4432658115894721
distance x is tensor(342.6275, device='cuda:3')
cal_distance is  tensor(342.6275, device='cuda:3')
cal ratio is  0.6657796715585852
distance x is tensor(228.1159, device='cuda:3')
cal_distance is  tensor(228.1159, device='cuda:3')
cal ratio is  0.8159505263201502
distance x is tensor(186.1322, device='cuda:3')
cal_distance is  tensor(186.1322, device='cuda:3')
cal ratio is  0.9032977742912552
distance x is tensor(168.1332, device='cuda:3')
cal_distance is  tensor(168.1332, device='cuda:3')
cal ratio is  0.9504185263618181
distance x is tensor(159.7971, device='cuda:3')
cal_distance is  tensor(159.7971, device='cuda:3')
cal ratio is  0.974893471546874
distance x is tensor(155.7853, device='cuda:3')
cal_distance is  tensor(155.7853, device='cuda:3')
distance x is tensor(155.7853, device='cuda:3')
return_distance is  tensor(155.7853, device='cuda:3')
distance x is tensor(155.7763, device='cuda:3')
distance x is tensor(155.7763, device='cuda:3')
________________________________
test distance is  tensor(155.7763, device='cuda:3')
test distance1 is  tensor(155.7763, device='cuda:3')
test similarity is  tensor(0.9725, device='cuda:3')
test acc is  0.10386666682299862
test loss is 131.01858258603224
test entropy is  0.002451434834918849
________________________________
0
distance x is tensor(155.7763, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0023435511118605466
avg test loss is  131.3604448639762
avg accuracy is  0.4866166668230087
solo acc is  0.1040833334896653
compute similarity  is  tensor(0.9725, device='cuda:3')
compute_distance is  tensor(155.7763, device='cuda:3')
compute_norm is  tensor(56.5849, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.9332, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0566971664235536
avg test loss is  1.6648993312931264
avg accuracy is  0.7063833334896635
solo acc is  0.20773333348967002
compute similarity  is  tensor(0.9735, device='cuda:3')
compute_distance is  tensor(151.9332, device='cuda:3')
compute_norm is  tensor(56.8075, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(152.2135, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6429200482520976
avg test loss is  2.472658010306897
avg accuracy is  0.6632166668229996
solo acc is  0.1053833334896653
compute similarity  is  tensor(0.9734, device='cuda:3')
compute_distance is  tensor(152.2135, device='cuda:3')
compute_norm is  tensor(56.6171, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.7988, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9991751477789523
avg test loss is  1.5367332380463574
avg accuracy is  0.7210666668229962
solo acc is  0.23233333348967106
compute similarity  is  tensor(0.9736, device='cuda:3')
compute_distance is  tensor(151.7988, device='cuda:3')
compute_norm is  tensor(56.3175, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.7988, device='cuda:3')
distance x is tensor(151.7988, device='cuda:3')
________________________________
test distance is  tensor(151.7988, device='cuda:3')
test distance1 is  tensor(151.7988, device='cuda:3')
test similarity is  tensor(0.9736, device='cuda:3')
test acc is  0.23066666682300432
test loss is 1.531063342018168
test entropy is  1.0004571529466715
________________________________
0
distance x is tensor(151.7988, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0004567341255481
avg test loss is  1.5358225855745995
avg accuracy is  0.7213500001563294
solo acc is  0.23070000015633763
compute similarity  is  tensor(0.9736, device='cuda:3')
compute_distance is  tensor(151.7988, device='cuda:3')
compute_norm is  tensor(56.3175, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.8755, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.616024120244136
avg test loss is  2.3679347415722765
avg accuracy is  0.6702166668229991
solo acc is  0.1052333334896653
compute similarity  is  tensor(0.9735, device='cuda:3')
compute_distance is  tensor(151.8755, device='cuda:3')
compute_norm is  tensor(56.1205, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.7208, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9813147063321396
avg test loss is  1.4870418718120437
avg accuracy is  0.7260833334896625
solo acc is  0.22808333348967083
compute similarity  is  tensor(0.9736, device='cuda:3')
compute_distance is  tensor(151.7208, device='cuda:3')
compute_norm is  tensor(55.8271, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.7208, device='cuda:3')
distance x is tensor(151.7208, device='cuda:3')
________________________________
test distance is  tensor(151.7208, device='cuda:3')
test distance1 is  tensor(151.7208, device='cuda:3')
test similarity is  tensor(0.9736, device='cuda:3')
test acc is  0.2269166668230042
test loss is 1.4910931156388223
test entropy is  0.980801660877301
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2580000001600001
mal loss is 1.4861193671822548
mal norm is  tensor(724.5390, device='cuda:3')
distance x is tensor(151.7296, device='cuda:3')
mal distance is  tensor(151.7296, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 661.1484,  534.0002,  501.3736,  661.5091,  424.0294,  527.6403,
         515.2946,  458.0755,  724.5390,  724.5390,  724.5390,  724.5390,
         724.5390,  724.5390,  724.5390,  724.5390,  724.5390,  724.5390,
         724.5390,  724.5390,  955.8295, 1008.0885, 1002.2216,  932.3256,
        1050.1310, 1001.2510,  951.5907, 1001.2944,  673.0157,  680.0444,
         693.5580,  681.5533,  682.3716,  753.6105,  694.2527,  824.6949,
         661.0563,  594.0764,  669.3100,  640.4379,  524.9485,  928.3467,
         797.6305,  600.8825,  569.7623,  651.4493,  509.2225,  627.8780,
         838.9308,  469.1963,  658.6271,  647.1731], device='cuda:3')
sorted_norm is   tensor([ 424.0294,  458.0755,  469.1963,  501.3736,  509.2225,  515.2946,
         524.9485,  527.6403,  534.0002,  569.7623,  594.0764,  600.8825,
         627.8780,  640.4379,  647.1731,  651.4493,  658.6271,  661.0563,
         661.1484,  661.5091,  669.3100,  673.0157,  680.0444,  681.5533,
         682.3716,  693.5580,  694.2527,  724.5390,  724.5390,  724.5390,
         724.5390,  724.5390,  724.5390,  724.5390,  724.5390,  724.5390,
         724.5390,  724.5390,  724.5390,  753.6105,  797.6305,  824.6949,
         838.9308,  928.3467,  932.3256,  951.5907,  955.8295, 1001.2510,
        1001.2944, 1002.2216, 1008.0885, 1050.1310], device='cuda:3')
used idx is  tensor([ 4,  7, 49,  2, 46,  6, 40,  5,  1, 44, 37, 43, 47, 39, 51, 45, 50, 36,
         0,  3, 38, 28, 29, 31, 32, 30, 34, 11, 19, 18, 16, 17, 13, 10,  8,  9,
        14, 12, 15, 33, 42], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 72.99% 

Test Accuracy: 80.16% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.821762204170227
distance x is tensor(129.0181, device='cuda:3')
benign distance is  tensor(129.0181, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7731374949216843
distance x is tensor(118.9970, device='cuda:3')
benign distance is  tensor(118.9970, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6079096570611
distance x is tensor(117.5277, device='cuda:3')
benign distance is  tensor(117.5277, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5332191213965416
distance x is tensor(154.3211, device='cuda:3')
benign distance is  tensor(154.3211, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1851500496268272
distance x is tensor(120.9768, device='cuda:3')
benign distance is  tensor(120.9768, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9787922669202089
distance x is tensor(107.0467, device='cuda:3')
benign distance is  tensor(107.0467, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8562265560030937
distance x is tensor(117.0906, device='cuda:3')
benign distance is  tensor(117.0906, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7582983896136284
distance x is tensor(137.8513, device='cuda:3')
benign distance is  tensor(137.8513, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2903921157121658
distance x is tensor(124.2444, device='cuda:3')
benign distance is  tensor(124.2444, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8772455528378487
distance x is tensor(145.2293, device='cuda:3')
benign distance is  tensor(145.2293, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3945912159979343
distance x is tensor(86.9485, device='cuda:3')
benign distance is  tensor(86.9485, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.025320380926132
distance x is tensor(137.4452, device='cuda:3')
benign distance is  tensor(137.4452, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9969489350914955
distance x is tensor(164.5210, device='cuda:3')
benign distance is  tensor(164.5210, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9930708929896355
distance x is tensor(75.7564, device='cuda:3')
benign distance is  tensor(75.7564, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1951224878430367
distance x is tensor(147.3840, device='cuda:3')
benign distance is  tensor(147.3840, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.77562715113163
distance x is tensor(126.9898, device='cuda:3')
benign distance is  tensor(126.9898, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.712169401347637
distance x is tensor(105.7972, device='cuda:3')
benign distance is  tensor(105.7972, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1021984964609146
distance x is tensor(125.4365, device='cuda:3')
benign distance is  tensor(125.4365, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.5139405727386475
distance x is tensor(137.4485, device='cuda:3')
benign distance is  tensor(137.4485, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4099424928426743
distance x is tensor(120.8678, device='cuda:3')
benign distance is  tensor(120.8678, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.394830860197544
distance x is tensor(93.9732, device='cuda:3')
benign distance is  tensor(93.9732, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2253932058811188
distance x is tensor(198.7233, device='cuda:3')
benign distance is  tensor(198.7233, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4477314986288548
distance x is tensor(162.6572, device='cuda:3')
benign distance is  tensor(162.6572, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9910247921943665
distance x is tensor(122.0376, device='cuda:3')
benign distance is  tensor(122.0376, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.673965286463499
distance x is tensor(125.4384, device='cuda:3')
benign distance is  tensor(125.4384, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2294198609888554
distance x is tensor(87.4201, device='cuda:3')
benign distance is  tensor(87.4201, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.5169484205543995
distance x is tensor(140.7749, device='cuda:3')
benign distance is  tensor(140.7749, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.9316187128424644
distance x is tensor(112.5398, device='cuda:3')
benign distance is  tensor(112.5398, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1579418443143368
distance x is tensor(124.4552, device='cuda:3')
benign distance is  tensor(124.4552, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.275902222841978
distance x is tensor(126.3363, device='cuda:3')
benign distance is  tensor(126.3363, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6021639201790094
distance x is tensor(126.6366, device='cuda:3')
benign distance is  tensor(126.6366, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.5483862161636353
distance x is tensor(167.2739, device='cuda:3')
benign distance is  tensor(167.2739, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.732778623700142
distance x is tensor(120.0814, device='cuda:3')
benign distance is  tensor(120.0814, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.261975571513176
distance x is tensor(135.8980, device='cuda:3')
benign distance is  tensor(135.8980, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.702299639582634
distance x is tensor(159.0519, device='cuda:3')
benign distance is  tensor(159.0519, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3618079163134098
distance x is tensor(96.2528, device='cuda:3')
benign distance is  tensor(96.2528, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.0353565216064453
distance x is tensor(156.5731, device='cuda:3')
benign distance is  tensor(156.5731, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.6706661731004715
distance x is tensor(135.1491, device='cuda:3')
benign distance is  tensor(135.1491, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.5151352733373642
distance x is tensor(118.4033, device='cuda:3')
benign distance is  tensor(118.4033, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5901608522981405
distance x is tensor(144.4901, device='cuda:3')
benign distance is  tensor(144.4901, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(90.1680, device='cuda:3')
compute distance is  tensor(90.1680, device='cuda:3')
compute norm is  tensor(51.5272, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.3410, device='cuda:3')
compute distance is  tensor(153.3410, device='cuda:3')
compute norm is  tensor(53.0144, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.6645, device='cuda:3')
compute distance is  tensor(109.6645, device='cuda:3')
compute norm is  tensor(51.7744, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.0263, device='cuda:3')
compute distance is  tensor(119.0263, device='cuda:3')
compute norm is  tensor(52.0789, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.3581, device='cuda:3')
compute distance is  tensor(102.3581, device='cuda:3')
compute norm is  tensor(51.6526, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3038, device='cuda:3')
compute distance is  tensor(122.3038, device='cuda:3')
compute norm is  tensor(52.2528, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1183, device='cuda:3')
compute distance is  tensor(122.1183, device='cuda:3')
compute norm is  tensor(52.2233, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.2194, device='cuda:3')
compute distance is  tensor(106.2194, device='cuda:3')
compute norm is  tensor(51.7439, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2385, device='cuda:3')
compute distance is  tensor(125.2385, device='cuda:3')
compute norm is  tensor(52.2917, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.0201, device='cuda:3')
compute distance is  tensor(113.0201, device='cuda:3')
compute norm is  tensor(52.1244, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1663, device='cuda:3')
compute distance is  tensor(118.1663, device='cuda:3')
compute norm is  tensor(51.9722, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8043, device='cuda:3')
compute distance is  tensor(140.8043, device='cuda:3')
compute norm is  tensor(53.2521, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.3410, device='cuda:3')
distance x is tensor(101905.7188, device='cuda:3')
distance x is tensor(101905.7188, device='cuda:3')
________________________________
test distance is  tensor(101905.7188, device='cuda:3')
test distance1 is  tensor(101905.7188, device='cuda:3')
test similarity is  tensor(0.5130, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107599166243794.16
test entropy is  0.0
________________________________
cal ratio is  0.03801508791847323
distance x is tensor(3873.9592, device='cuda:3')
cal_distance is  tensor(3873.9592, device='cuda:3')
cal ratio is  0.19497446542917385
distance x is tensor(755.3268, device='cuda:3')
cal_distance is  tensor(755.3268, device='cuda:3')
cal ratio is  0.44155807153407356
distance x is tensor(333.5232, device='cuda:3')
cal_distance is  tensor(333.5232, device='cuda:3')
cal ratio is  0.6644958143924067
distance x is tensor(221.6263, device='cuda:3')
cal_distance is  tensor(221.6263, device='cuda:3')
cal ratio is  0.8151633405239944
distance x is tensor(180.6625, device='cuda:3')
cal_distance is  tensor(180.6625, device='cuda:3')
cal ratio is  0.9028618559479356
distance x is tensor(163.1137, device='cuda:3')
cal_distance is  tensor(163.1137, device='cuda:3')
cal ratio is  0.9501891705870237
distance x is tensor(154.9891, device='cuda:3')
cal_distance is  tensor(154.9891, device='cuda:3')
cal ratio is  0.9747757631694783
distance x is tensor(151.0797, device='cuda:3')
cal_distance is  tensor(151.0797, device='cuda:3')
distance x is tensor(151.0797, device='cuda:3')
return_distance is  tensor(151.0797, device='cuda:3')
distance x is tensor(151.0707, device='cuda:3')
distance x is tensor(151.0707, device='cuda:3')
________________________________
test distance is  tensor(151.0707, device='cuda:3')
test distance1 is  tensor(151.0707, device='cuda:3')
test similarity is  tensor(0.9734, device='cuda:3')
test acc is  0.32245000015633996
test loss is 20.479242814883495
test entropy is  0.1149263886460808
________________________________
0
distance x is tensor(151.0707, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.11531229365243713
avg test loss is  20.474513597834086
avg accuracy is  0.7355166668229953
solo acc is  0.3194000001563399
compute similarity  is  tensor(0.9734, device='cuda:3')
compute_distance is  tensor(151.0707, device='cuda:3')
compute_norm is  tensor(56.3154, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.9824, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9428216832151799
avg test loss is  1.4025784193325652
avg accuracy is  0.77138333348966
solo acc is  0.2869500001563392
compute similarity  is  tensor(0.9742, device='cuda:3')
compute_distance is  tensor(144.9824, device='cuda:3')
compute_norm is  tensor(56.0791, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(144.9824, device='cuda:3')
distance x is tensor(144.9824, device='cuda:3')
________________________________
test distance is  tensor(144.9824, device='cuda:3')
test distance1 is  tensor(144.9824, device='cuda:3')
test similarity is  tensor(0.9742, device='cuda:3')
test acc is  0.28626666682300583
test loss is 1.4036530293127112
test entropy is  0.9432811838731583
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29800000016000006
mal loss is 1.4325047954916954
mal norm is  tensor(735.2432, device='cuda:3')
distance x is tensor(144.9910, device='cuda:3')
mal distance is  tensor(144.9910, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([537.4842, 486.5488, 469.1768, 622.2023, 468.1240, 423.7209, 467.5916,
        526.8364, 735.2433, 735.2432, 735.2433, 735.2432, 735.2433, 735.2432,
        735.2433, 735.2432, 735.2433, 735.2432, 735.2433, 735.2432],
       device='cuda:3')
sorted_norm is   tensor([423.7209, 467.5916, 468.1240, 469.1768, 486.5488, 526.8364, 537.4842,
        622.2023, 735.2432, 735.2432, 735.2432, 735.2432, 735.2432, 735.2432,
        735.2433, 735.2433, 735.2433, 735.2433, 735.2433, 735.2433],
       device='cuda:3')
used idx is  tensor([ 5,  6,  4,  2,  1,  7,  0,  3, 19, 17, 13, 15, 11,  9, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 77.53% 

Test Accuracy: 80.89% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8960448876023293
distance x is tensor(187.9776, device='cuda:3')
benign distance is  tensor(187.9776, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.029450833797455
distance x is tensor(133.1613, device='cuda:3')
benign distance is  tensor(133.1613, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3153393268585205
distance x is tensor(119.0524, device='cuda:3')
benign distance is  tensor(119.0524, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.968400165438652
distance x is tensor(176.9463, device='cuda:3')
benign distance is  tensor(176.9463, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2059702835977077
distance x is tensor(139.7995, device='cuda:3')
benign distance is  tensor(139.7995, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1004616133868694
distance x is tensor(127.5944, device='cuda:3')
benign distance is  tensor(127.5944, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9735229536890984
distance x is tensor(126.1278, device='cuda:3')
benign distance is  tensor(126.1278, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3976073637604713
distance x is tensor(109.2135, device='cuda:3')
benign distance is  tensor(109.2135, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(98.4248, device='cuda:3')
compute distance is  tensor(98.4248, device='cuda:3')
compute norm is  tensor(54.6667, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.6840, device='cuda:3')
compute distance is  tensor(150.6840, device='cuda:3')
compute norm is  tensor(55.8286, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4861, device='cuda:3')
compute distance is  tensor(125.4861, device='cuda:3')
compute norm is  tensor(55.1107, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.9131, device='cuda:3')
compute distance is  tensor(109.9131, device='cuda:3')
compute norm is  tensor(54.9359, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.3605, device='cuda:3')
compute distance is  tensor(116.3605, device='cuda:3')
compute norm is  tensor(54.7357, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7956, device='cuda:3')
compute distance is  tensor(127.7956, device='cuda:3')
compute norm is  tensor(55.2628, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5722, device='cuda:3')
compute distance is  tensor(128.5722, device='cuda:3')
compute norm is  tensor(55.3979, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0852, device='cuda:3')
compute distance is  tensor(109.0852, device='cuda:3')
compute norm is  tensor(54.6675, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9536, device='cuda:3')
compute distance is  tensor(138.9536, device='cuda:3')
compute norm is  tensor(55.3858, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2439, device='cuda:3')
compute distance is  tensor(126.2439, device='cuda:3')
compute norm is  tensor(55.3551, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7097, device='cuda:3')
compute distance is  tensor(133.7097, device='cuda:3')
compute norm is  tensor(55.2876, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.9836, device='cuda:3')
compute distance is  tensor(163.9836, device='cuda:3')
compute norm is  tensor(56.4820, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(163.9836, device='cuda:3')
distance x is tensor(101850.2266, device='cuda:3')
distance x is tensor(101850.2266, device='cuda:3')
________________________________
test distance is  tensor(101850.2266, device='cuda:3')
test distance1 is  tensor(101850.2266, device='cuda:3')
test similarity is  tensor(0.5984, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107602393568445.95
test entropy is  0.0
________________________________
cal ratio is  0.03932287686087529
distance x is tensor(4005.0491, device='cuda:3')
cal_distance is  tensor(4005.0491, device='cuda:3')
cal ratio is  0.19829983358495826
distance x is tensor(794.2042, device='cuda:3')
cal_distance is  tensor(794.2042, device='cuda:3')
cal ratio is  0.44530767288268724
distance x is tensor(353.6677, device='cuda:3')
cal_distance is  tensor(353.6677, device='cuda:3')
cal ratio is  0.6673114852768937
distance x is tensor(236.0080, device='cuda:3')
cal_distance is  tensor(236.0080, device='cuda:3')
cal ratio is  0.8168887521451568
distance x is tensor(192.7932, device='cuda:3')
cal_distance is  tensor(192.7932, device='cuda:3')
cal ratio is  0.9038169316216861
distance x is tensor(174.2501, device='cuda:3')
cal_distance is  tensor(174.2501, device='cuda:3')
cal ratio is  0.9506917233221882
distance x is tensor(165.6584, device='cuda:3')
cal_distance is  tensor(165.6584, device='cuda:3')
cal ratio is  0.9750336225776712
distance x is tensor(161.5226, device='cuda:3')
cal_distance is  tensor(161.5226, device='cuda:3')
distance x is tensor(161.5226, device='cuda:3')
return_distance is  tensor(161.5226, device='cuda:3')
distance x is tensor(161.5137, device='cuda:3')
distance x is tensor(161.5137, device='cuda:3')
________________________________
test distance is  tensor(161.5137, device='cuda:3')
test distance1 is  tensor(161.5137, device='cuda:3')
test similarity is  tensor(0.9784, device='cuda:3')
test acc is  0.1007333334896653
test loss is 157.04679342729452
test entropy is  0.0006396281809706076
________________________________
0
distance x is tensor(161.5137, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.000671243520598578
avg test loss is  157.1173608938514
avg accuracy is  0.4577166668230083
solo acc is  0.10105000015633196
compute similarity  is  tensor(0.9784, device='cuda:3')
compute_distance is  tensor(161.5137, device='cuda:3')
compute_norm is  tensor(60.4608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.7215, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1145149947864923
avg test loss is  1.7527401852709399
avg accuracy is  0.6617166668229997
solo acc is  0.19200000015633592
compute similarity  is  tensor(0.9787, device='cuda:3')
compute_distance is  tensor(160.7215, device='cuda:3')
compute_norm is  tensor(61.0674, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.5285, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6538975833575609
avg test loss is  2.575470871508503
avg accuracy is  0.61228333348967
solo acc is  0.10510000015633197
compute similarity  is  tensor(0.9787, device='cuda:3')
compute_distance is  tensor(160.5285, device='cuda:3')
compute_norm is  tensor(60.8804, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.5664, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0471135670188139
avg test loss is  1.6353376068031864
avg accuracy is  0.676550000156332
solo acc is  0.20133333348966967
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(159.5664, device='cuda:3')
compute_norm is  tensor(60.5333, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.1648, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.626326548328786
avg test loss is  2.462746517744654
avg accuracy is  0.6020500001563374
solo acc is  0.1040833334896653
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(159.1648, device='cuda:3')
compute_norm is  tensor(60.3308, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.3765, device='cuda:3')
distance x is tensor(158.3765, device='cuda:3')
________________________________
test distance is  tensor(158.3765, device='cuda:3')
test distance1 is  tensor(158.3765, device='cuda:3')
test similarity is  tensor(0.9790, device='cuda:3')
test acc is  0.2002333334896697
test loss is 1.59549681248187
test entropy is  1.018473757990896
________________________________
0
distance x is tensor(158.3765, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0183317671452503
avg test loss is  1.5964120125719734
avg accuracy is  0.6754000001563321
solo acc is  0.1993000001563363
compute similarity  is  tensor(0.9790, device='cuda:3')
compute_distance is  tensor(158.3765, device='cuda:3')
compute_norm is  tensor(60.0081, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.9707, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.625343912573003
avg test loss is  2.3855682362371415
avg accuracy is  0.5969333334896713
solo acc is  0.10316666682299863
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(157.9707, device='cuda:3')
compute_norm is  tensor(59.8044, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.3959, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0131481007726462
avg test loss is  1.5543281355900551
avg accuracy is  0.6789166668229984
solo acc is  0.1995833334896696
compute similarity  is  tensor(0.9790, device='cuda:3')
compute_distance is  tensor(157.3959, device='cuda:3')
compute_norm is  tensor(59.4948, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.9972, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6183191125453916
avg test loss is  2.3577283276423717
avg accuracy is  0.5931000001563382
solo acc is  0.10205000015633196
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(156.9972, device='cuda:3')
compute_norm is  tensor(59.2917, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.5717, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0010427079602344
avg test loss is  1.5240473344381937
avg accuracy is  0.6865833334896648
solo acc is  0.20581666682300337
compute similarity  is  tensor(0.9789, device='cuda:3')
compute_distance is  tensor(156.5717, device='cuda:3')
compute_norm is  tensor(58.9883, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.2278, device='cuda:3')
distance x is tensor(156.2278, device='cuda:3')
________________________________
test distance is  tensor(156.2278, device='cuda:3')
test distance1 is  tensor(156.2278, device='cuda:3')
test similarity is  tensor(0.9788, device='cuda:3')
test acc is  0.10216666682299863
test loss is 2.3323785810074065
test entropy is  0.6069992519517952
________________________________
0
distance x is tensor(156.2278, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6081497367384083
avg test loss is  2.326430556235283
avg accuracy is  0.5971666668230045
solo acc is  0.10286666682299864
compute similarity  is  tensor(0.9788, device='cuda:3')
compute_distance is  tensor(156.2278, device='cuda:3')
compute_norm is  tensor(58.7865, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.9697, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9789483928477077
avg test loss is  1.489248584201341
avg accuracy is  0.695450000156331
solo acc is  0.20788333348967006
compute similarity  is  tensor(0.9788, device='cuda:3')
compute_distance is  tensor(155.9697, device='cuda:3')
compute_norm is  tensor(58.4891, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(155.9782, device='cuda:3')
________________________________
test distance is  tensor(155.9782, device='cuda:3')
test similarity is  tensor(0.9788, device='cuda:3')
test acc is  0.6919333334896645
test loss is 1.4877941861335657
test entropy is  0.9796888474335295
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.21200000016000006
mal loss is 1.4811710268259048
mal norm is  tensor(699.9720, device='cuda:3')
distance x is tensor(155.9782, device='cuda:3')
mal distance is  tensor(155.9782, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([727.6981, 526.4323, 486.2153, 671.2247, 560.4228, 495.7051, 502.0616,
        438.9230, 699.9720, 699.9720, 699.9720, 699.9720, 699.9720, 699.9720,
        699.9720, 699.9720, 699.9720, 699.9720, 699.9720, 699.9720, 613.2066,
        694.5740, 513.8417, 671.0990, 771.3691, 478.7773, 718.7230, 645.1903],
       device='cuda:3')
sorted_norm is   tensor([438.9230, 478.7773, 486.2153, 495.7051, 502.0616, 513.8417, 526.4323,
        560.4228, 613.2066, 645.1903, 671.0990, 671.2247, 694.5740, 699.9720,
        699.9720, 699.9720, 699.9720, 699.9720, 699.9720, 699.9720, 699.9720,
        699.9720, 699.9720, 699.9720, 699.9720, 718.7230, 727.6981, 771.3691],
       device='cuda:3')
used idx is  tensor([ 7, 25,  2,  5,  6, 22,  1,  4, 20, 27, 23,  3, 21, 19, 16, 17, 15, 11,
         8, 10, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 42.19% 

Test Accuracy: 65.37% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8940686732530594
distance x is tensor(157.0900, device='cuda:3')
benign distance is  tensor(157.0900, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.650001585483551
distance x is tensor(118.4198, device='cuda:3')
benign distance is  tensor(118.4198, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4769803956151009
distance x is tensor(117.5286, device='cuda:3')
benign distance is  tensor(117.5286, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6168867275118828
distance x is tensor(161.5149, device='cuda:3')
benign distance is  tensor(161.5149, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.406378798186779
distance x is tensor(126.5159, device='cuda:3')
benign distance is  tensor(126.5159, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3464162312448025
distance x is tensor(121.1501, device='cuda:3')
benign distance is  tensor(121.1501, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9398094043135643
distance x is tensor(124.1193, device='cuda:3')
benign distance is  tensor(124.1193, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7909277901053429
distance x is tensor(115.7381, device='cuda:3')
benign distance is  tensor(115.7381, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7880787029862404
distance x is tensor(123.3117, device='cuda:3')
benign distance is  tensor(123.3117, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2961889579892159
distance x is tensor(144.3460, device='cuda:3')
benign distance is  tensor(144.3460, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7595567032694817
distance x is tensor(112.5630, device='cuda:3')
benign distance is  tensor(112.5630, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.4762529730796814
distance x is tensor(122.2513, device='cuda:3')
benign distance is  tensor(122.2513, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9522254168987274
distance x is tensor(162.6826, device='cuda:3')
benign distance is  tensor(162.6826, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.22681675106287
distance x is tensor(111.8496, device='cuda:3')
benign distance is  tensor(111.8496, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3821904920041561
distance x is tensor(154.5650, device='cuda:3')
benign distance is  tensor(154.5650, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.369872957468033
distance x is tensor(139.9017, device='cuda:3')
benign distance is  tensor(139.9017, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.0647, device='cuda:3')
compute distance is  tensor(129.0647, device='cuda:3')
compute norm is  tensor(56.4153, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.6413, device='cuda:3')
compute distance is  tensor(148.6413, device='cuda:3')
compute norm is  tensor(56.9128, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.9924, device='cuda:3')
compute distance is  tensor(113.9924, device='cuda:3')
compute norm is  tensor(56.0686, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.3514, device='cuda:3')
compute distance is  tensor(112.3514, device='cuda:3')
compute norm is  tensor(56.3013, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.0607, device='cuda:3')
compute distance is  tensor(98.0607, device='cuda:3')
compute norm is  tensor(55.8397, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.9338, device='cuda:3')
compute distance is  tensor(114.9338, device='cuda:3')
compute norm is  tensor(56.2390, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8002, device='cuda:3')
compute distance is  tensor(128.8002, device='cuda:3')
compute norm is  tensor(56.5908, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.0993, device='cuda:3')
compute distance is  tensor(101.0993, device='cuda:3')
compute norm is  tensor(55.8762, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5339, device='cuda:3')
compute distance is  tensor(132.5339, device='cuda:3')
compute norm is  tensor(56.6706, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.9229, device='cuda:3')
compute distance is  tensor(113.9229, device='cuda:3')
compute norm is  tensor(56.3837, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7323, device='cuda:3')
compute distance is  tensor(126.7323, device='cuda:3')
compute norm is  tensor(56.4086, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4021, device='cuda:3')
compute distance is  tensor(150.4021, device='cuda:3')
compute norm is  tensor(57.5801, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(150.4021, device='cuda:3')
distance x is tensor(101833.2891, device='cuda:3')
distance x is tensor(101833.2891, device='cuda:3')
________________________________
test distance is  tensor(101833.2891, device='cuda:3')
test distance1 is  tensor(101833.2891, device='cuda:3')
test similarity is  tensor(0.6269, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107596352089387.12
test entropy is  0.0
________________________________
cal ratio is  0.037662418409191545
distance x is tensor(3835.2927, device='cuda:3')
cal_distance is  tensor(3835.2927, device='cuda:3')
cal ratio is  0.194067953988311
distance x is tensor(744.3110, device='cuda:3')
cal_distance is  tensor(744.3110, device='cuda:3')
cal ratio is  0.44053037328741773
distance x is tensor(327.8941, device='cuda:3')
cal_distance is  tensor(327.8941, device='cuda:3')
cal ratio is  0.6637221518833073
distance x is tensor(217.6321, device='cuda:3')
cal_distance is  tensor(217.6321, device='cuda:3')
cal ratio is  0.8146885208661964
distance x is tensor(177.3032, device='cuda:3')
cal_distance is  tensor(177.3032, device='cuda:3')
cal ratio is  0.9025988847182146
distance x is tensor(160.0341, device='cuda:3')
cal_distance is  tensor(160.0341, device='cuda:3')
cal ratio is  0.9500507773707606
distance x is tensor(152.0408, device='cuda:3')
cal_distance is  tensor(152.0408, device='cuda:3')
cal ratio is  0.9747046438619233
distance x is tensor(148.1950, device='cuda:3')
cal_distance is  tensor(148.1950, device='cuda:3')
distance x is tensor(148.1950, device='cuda:3')
return_distance is  tensor(148.1950, device='cuda:3')
distance x is tensor(148.1860, device='cuda:3')
distance x is tensor(148.1860, device='cuda:3')
________________________________
test distance is  tensor(148.1860, device='cuda:3')
test distance1 is  tensor(148.1860, device='cuda:3')
test similarity is  tensor(0.9834, device='cuda:3')
test acc is  0.4391666668230082
test loss is 7.1358857480193505
test entropy is  0.24019307318304392
________________________________
0
distance x is tensor(148.1860, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.2432620983991796
avg test loss is  7.137333470875267
avg accuracy is  0.7071666668229969
solo acc is  0.43790000015634145
compute similarity  is  tensor(0.9834, device='cuda:3')
compute_distance is  tensor(148.1860, device='cuda:3')
compute_norm is  tensor(61.2416, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.1756, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9447191405270908
avg test loss is  1.4184983067675185
avg accuracy is  0.7333500001563288
solo acc is  0.26773333348967215
compute similarity  is  tensor(0.9841, device='cuda:3')
compute_distance is  tensor(143.1756, device='cuda:3')
compute_norm is  tensor(61.0621, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(143.1756, device='cuda:3')
distance x is tensor(143.1756, device='cuda:3')
________________________________
test distance is  tensor(143.1756, device='cuda:3')
test distance1 is  tensor(143.1756, device='cuda:3')
test similarity is  tensor(0.9841, device='cuda:3')
test acc is  0.2658000001563387
test loss is 1.4230457789608155
test entropy is  0.9448191924517089
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2650000001600001
mal loss is 1.412896990776062
mal norm is  tensor(720.3661, device='cuda:3')
distance x is tensor(143.1846, device='cuda:3')
mal distance is  tensor(143.1846, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 639.9954,  480.1089,  480.3359,  637.5043,  493.6973,  475.9028,
         491.5179,  465.3331,  720.3661,  720.3661,  720.3661,  720.3661,
         720.3661,  720.3661,  720.3661,  720.3661,  720.3661,  720.3661,
         720.3661,  720.3661,  999.3632,  964.9100, 1038.1053,  981.3315,
         973.7183,  915.7291,  928.5494, 1026.0370,  678.2384,  733.0682,
         769.3460,  722.7068,  644.5982,  982.3761,  851.8823,  726.6887],
       device='cuda:3')
sorted_norm is   tensor([ 465.3331,  475.9028,  480.1089,  480.3359,  491.5179,  493.6973,
         637.5043,  639.9954,  644.5982,  678.2384,  720.3661,  720.3661,
         720.3661,  720.3661,  720.3661,  720.3661,  720.3661,  720.3661,
         720.3661,  720.3661,  720.3661,  720.3661,  722.7068,  726.6887,
         733.0682,  769.3460,  851.8823,  915.7291,  928.5494,  964.9100,
         973.7183,  981.3315,  982.3761,  999.3632, 1026.0370, 1038.1053],
       device='cuda:3')
used idx is  tensor([ 7,  5,  1,  2,  6,  4,  3,  0, 32, 28, 19, 18, 14, 12, 16, 17, 13, 10,
        11,  9,  8, 15, 31, 35, 29, 30, 34, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 69.25% 

Test Accuracy: 78.79% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6797021273523569
distance x is tensor(168.7231, device='cuda:3')
benign distance is  tensor(168.7231, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5556065328419209
distance x is tensor(131.3633, device='cuda:3')
benign distance is  tensor(131.3633, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4046018719673157
distance x is tensor(125.9792, device='cuda:3')
benign distance is  tensor(125.9792, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4565152004361153
distance x is tensor(162.4912, device='cuda:3')
benign distance is  tensor(162.4912, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.751169703900814
distance x is tensor(121.5924, device='cuda:3')
benign distance is  tensor(121.5924, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5149593874812126
distance x is tensor(113.1879, device='cuda:3')
benign distance is  tensor(113.1879, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5407922491431236
distance x is tensor(148.1814, device='cuda:3')
benign distance is  tensor(148.1814, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3389290496706963
distance x is tensor(106.5199, device='cuda:3')
benign distance is  tensor(106.5199, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.839346669614315
distance x is tensor(114.2055, device='cuda:3')
benign distance is  tensor(114.2055, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.6253588199615479
distance x is tensor(124.6203, device='cuda:3')
benign distance is  tensor(124.6203, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.3955935314297676
distance x is tensor(152.4933, device='cuda:3')
benign distance is  tensor(152.4933, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.9305988401174545
distance x is tensor(124.9664, device='cuda:3')
benign distance is  tensor(124.9664, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9313501119613647
distance x is tensor(108.5107, device='cuda:3')
benign distance is  tensor(108.5107, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1150319315493107
distance x is tensor(206.2367, device='cuda:3')
benign distance is  tensor(206.2367, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3402650356292725
distance x is tensor(184.0002, device='cuda:3')
benign distance is  tensor(184.0002, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.9090902656316757
distance x is tensor(141.3680, device='cuda:3')
benign distance is  tensor(141.3680, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8492999188601971
distance x is tensor(134.2741, device='cuda:3')
benign distance is  tensor(134.2741, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.6696749106049538
distance x is tensor(120.2903, device='cuda:3')
benign distance is  tensor(120.2903, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.7533197775483131
distance x is tensor(142.3675, device='cuda:3')
benign distance is  tensor(142.3675, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.7798143178224564
distance x is tensor(135.3567, device='cuda:3')
benign distance is  tensor(135.3567, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0204524137079716
distance x is tensor(142.4568, device='cuda:3')
benign distance is  tensor(142.4568, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.5162003003060818
distance x is tensor(93.7914, device='cuda:3')
benign distance is  tensor(93.7914, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.607041098177433
distance x is tensor(115.0481, device='cuda:3')
benign distance is  tensor(115.0481, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8543461989611387
distance x is tensor(133.9297, device='cuda:3')
benign distance is  tensor(133.9297, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.3889, device='cuda:3')
compute distance is  tensor(104.3889, device='cuda:3')
compute norm is  tensor(57.5950, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1288, device='cuda:3')
compute distance is  tensor(137.1288, device='cuda:3')
compute norm is  tensor(58.2255, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2597, device='cuda:3')
compute distance is  tensor(123.2597, device='cuda:3')
compute norm is  tensor(57.5834, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8635, device='cuda:3')
compute distance is  tensor(121.8635, device='cuda:3')
compute norm is  tensor(57.7957, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.5704, device='cuda:3')
compute distance is  tensor(107.5704, device='cuda:3')
compute norm is  tensor(57.2866, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.0791, device='cuda:3')
compute distance is  tensor(117.0791, device='cuda:3')
compute norm is  tensor(57.6670, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1712, device='cuda:3')
compute distance is  tensor(128.1712, device='cuda:3')
compute norm is  tensor(57.9291, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.2583, device='cuda:3')
compute distance is  tensor(105.2583, device='cuda:3')
compute norm is  tensor(57.3508, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8978, device='cuda:3')
compute distance is  tensor(120.8978, device='cuda:3')
compute norm is  tensor(57.7639, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.6064, device='cuda:3')
compute distance is  tensor(113.6064, device='cuda:3')
compute norm is  tensor(57.5621, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.2631, device='cuda:3')
compute distance is  tensor(114.2631, device='cuda:3')
compute norm is  tensor(57.4925, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.2194, device='cuda:3')
compute distance is  tensor(149.2194, device='cuda:3')
compute norm is  tensor(58.9029, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.2194, device='cuda:3')
distance x is tensor(101812.1797, device='cuda:3')
distance x is tensor(101812.1797, device='cuda:3')
________________________________
test distance is  tensor(101812.1797, device='cuda:3')
test distance1 is  tensor(101812.1797, device='cuda:3')
test similarity is  tensor(0.6506, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107485934702443.53
test entropy is  0.0
________________________________
cal ratio is  0.03751792733757104
distance x is tensor(3819.7869, device='cuda:3')
cal_distance is  tensor(3819.7869, device='cuda:3')
cal ratio is  0.193695325174217
distance x is tensor(739.8784, device='cuda:3')
cal_distance is  tensor(739.8784, device='cuda:3')
cal ratio is  0.4401072671912714
distance x is tensor(325.6284, device='cuda:3')
cal_distance is  tensor(325.6284, device='cuda:3')
cal ratio is  0.6634032186688427
distance x is tensor(216.0244, device='cuda:3')
cal_distance is  tensor(216.0244, device='cuda:3')
cal ratio is  0.8144928086088048
distance x is tensor(175.9512, device='cuda:3')
cal_distance is  tensor(175.9512, device='cuda:3')
cal ratio is  0.9024904271989173
distance x is tensor(158.7947, device='cuda:3')
cal_distance is  tensor(158.7947, device='cuda:3')
cal ratio is  0.949993594662505
distance x is tensor(150.8542, device='cuda:3')
cal_distance is  tensor(150.8542, device='cuda:3')
cal ratio is  0.9746754253015004
distance x is tensor(147.0340, device='cuda:3')
cal_distance is  tensor(147.0340, device='cuda:3')
distance x is tensor(147.0340, device='cuda:3')
return_distance is  tensor(147.0340, device='cuda:3')
distance x is tensor(147.0250, device='cuda:3')
distance x is tensor(147.0250, device='cuda:3')
________________________________
test distance is  tensor(147.0250, device='cuda:3')
test distance1 is  tensor(147.0250, device='cuda:3')
test similarity is  tensor(0.9855, device='cuda:3')
test acc is  0.12453333348966523
test loss is 51.57938159503408
test entropy is  0.020313255462731827
________________________________
0
distance x is tensor(147.0250, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02031417473339435
avg test loss is  51.73041145633787
avg accuracy is  0.6185333334896694
solo acc is  0.12386666682299857
compute similarity  is  tensor(0.9855, device='cuda:3')
compute_distance is  tensor(147.0250, device='cuda:3')
compute_norm is  tensor(62.8202, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.4850, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9446577244221783
avg test loss is  1.4428925374423518
avg accuracy is  0.7432833334896616
solo acc is  0.25755000015633855
compute similarity  is  tensor(0.9862, device='cuda:3')
compute_distance is  tensor(141.4850, device='cuda:3')
compute_norm is  tensor(62.6575, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(141.4850, device='cuda:3')
distance x is tensor(141.4850, device='cuda:3')
________________________________
test distance is  tensor(141.4850, device='cuda:3')
test distance1 is  tensor(141.4850, device='cuda:3')
test similarity is  tensor(0.9862, device='cuda:3')
test acc is  0.25996666682300523
test loss is 1.4448582388953106
test entropy is  0.9428416113101089
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2510000001600001
mal loss is 1.4512355253100395
mal norm is  tensor(711.9328, device='cuda:3')
distance x is tensor(141.4939, device='cuda:3')
mal distance is  tensor(141.4939, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([686.7855, 521.9023, 484.2173, 632.7186, 479.5087, 444.2509, 578.5845,
        433.6427, 711.9328, 711.9328, 711.9328, 711.9328, 711.9328, 711.9328,
        711.9328, 711.9328, 711.9328, 711.9328, 711.9328, 711.9328, 817.2615,
        740.7435, 862.9818, 800.9946, 825.8389, 833.9501, 835.6548, 947.1926,
        522.7458, 591.5286, 473.2745, 517.6619, 668.4818, 474.3657, 647.8577,
        591.3591], device='cuda:3')
sorted_norm is   tensor([433.6427, 444.2509, 473.2745, 474.3657, 479.5087, 484.2173, 517.6619,
        521.9023, 522.7458, 578.5845, 591.3591, 591.5286, 632.7186, 647.8577,
        668.4818, 686.7855, 711.9328, 711.9328, 711.9328, 711.9328, 711.9328,
        711.9328, 711.9328, 711.9328, 711.9328, 711.9328, 711.9328, 711.9328,
        740.7435, 800.9946, 817.2615, 825.8389, 833.9501, 835.6548, 862.9818,
        947.1926], device='cuda:3')
used idx is  tensor([ 7,  5, 30, 33,  4,  2, 31,  1, 28,  6, 35, 29,  3, 34, 32,  0, 11, 10,
         8,  9, 13, 12, 14, 15, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 66.61% 

Test Accuracy: 77.64% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8624483402818441
distance x is tensor(132.9134, device='cuda:3')
benign distance is  tensor(132.9134, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2622874081134796
distance x is tensor(126.0254, device='cuda:3')
benign distance is  tensor(126.0254, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8069601356983185
distance x is tensor(111.4195, device='cuda:3')
benign distance is  tensor(111.4195, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.55311818420887
distance x is tensor(143.8445, device='cuda:3')
benign distance is  tensor(143.8445, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2500654235482216
distance x is tensor(116.4817, device='cuda:3')
benign distance is  tensor(116.4817, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2903039567172527
distance x is tensor(116.4648, device='cuda:3')
benign distance is  tensor(116.4648, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1471624225378036
distance x is tensor(111.2895, device='cuda:3')
benign distance is  tensor(111.2895, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2510251104831696
distance x is tensor(99.9930, device='cuda:3')
benign distance is  tensor(99.9930, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6211690232157707
distance x is tensor(125.3364, device='cuda:3')
benign distance is  tensor(125.3364, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2978058196604252
distance x is tensor(145.3536, device='cuda:3')
benign distance is  tensor(145.3536, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6193624772131443
distance x is tensor(82.8111, device='cuda:3')
benign distance is  tensor(82.8111, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.601406455039978
distance x is tensor(115.4665, device='cuda:3')
benign distance is  tensor(115.4665, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.430069074034691
distance x is tensor(147.2987, device='cuda:3')
benign distance is  tensor(147.2987, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3405102416872978
distance x is tensor(95.0872, device='cuda:3')
benign distance is  tensor(95.0872, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3787408880889416
distance x is tensor(151.1406, device='cuda:3')
benign distance is  tensor(151.1406, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.7140427827835083
distance x is tensor(122.8958, device='cuda:3')
benign distance is  tensor(122.8958, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4950249567627907
distance x is tensor(128.3758, device='cuda:3')
benign distance is  tensor(128.3758, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.6460670456290245
distance x is tensor(218.2215, device='cuda:3')
benign distance is  tensor(218.2215, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.114446096122265
distance x is tensor(137.2975, device='cuda:3')
benign distance is  tensor(137.2975, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.9798119366168976
distance x is tensor(143.5486, device='cuda:3')
benign distance is  tensor(143.5486, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2415920682251453
distance x is tensor(155.2943, device='cuda:3')
benign distance is  tensor(155.2943, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.4160729721188545
distance x is tensor(148.3059, device='cuda:3')
benign distance is  tensor(148.3059, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7470741402357817
distance x is tensor(124.6421, device='cuda:3')
benign distance is  tensor(124.6421, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.073443464934826
distance x is tensor(148.0674, device='cuda:3')
benign distance is  tensor(148.0674, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(95.7287, device='cuda:3')
compute distance is  tensor(95.7287, device='cuda:3')
compute norm is  tensor(59.8725, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.1543, device='cuda:3')
compute distance is  tensor(147.1543, device='cuda:3')
compute norm is  tensor(61.0253, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.0806, device='cuda:3')
compute distance is  tensor(107.0806, device='cuda:3')
compute norm is  tensor(59.9713, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7285, device='cuda:3')
compute distance is  tensor(137.7285, device='cuda:3')
compute norm is  tensor(61.0095, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.5000, device='cuda:3')
compute distance is  tensor(98.5000, device='cuda:3')
compute norm is  tensor(59.9919, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.6713, device='cuda:3')
compute distance is  tensor(109.6713, device='cuda:3')
compute norm is  tensor(60.2710, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9804, device='cuda:3')
compute distance is  tensor(125.9804, device='cuda:3')
compute norm is  tensor(60.6024, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.6008, device='cuda:3')
compute distance is  tensor(97.6008, device='cuda:3')
compute norm is  tensor(59.9457, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7275, device='cuda:3')
compute distance is  tensor(123.7275, device='cuda:3')
compute norm is  tensor(60.5847, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.4377, device='cuda:3')
compute distance is  tensor(98.4377, device='cuda:3')
compute norm is  tensor(60.2031, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5860, device='cuda:3')
compute distance is  tensor(124.5860, device='cuda:3')
compute norm is  tensor(60.5186, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.2814, device='cuda:3')
compute distance is  tensor(159.2814, device='cuda:3')
compute norm is  tensor(61.8626, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(159.2814, device='cuda:3')
distance x is tensor(101780.5391, device='cuda:3')
distance x is tensor(101780.5391, device='cuda:3')
________________________________
test distance is  tensor(101780.5391, device='cuda:3')
test distance1 is  tensor(101780.5391, device='cuda:3')
test similarity is  tensor(0.6855, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107632362550199.95
test entropy is  0.0
________________________________
cal ratio is  0.03876825110246163
distance x is tensor(3945.8577, device='cuda:3')
cal_distance is  tensor(3945.8577, device='cuda:3')
cal ratio is  0.19689645144367549
distance x is tensor(776.9290, device='cuda:3')
cal_distance is  tensor(776.9290, device='cuda:3')
cal ratio is  0.4437291252102122
distance x is tensor(344.7485, device='cuda:3')
cal_distance is  tensor(344.7485, device='cuda:3')
cal ratio is  0.66612752368411
distance x is tensor(229.6480, device='cuda:3')
cal_distance is  tensor(229.6480, device='cuda:3')
cal ratio is  0.8161637393972795
distance x is tensor(187.4312, device='cuda:3')
cal_distance is  tensor(187.4312, device='cuda:3')
cal ratio is  0.9034157979912534
distance x is tensor(169.3287, device='cuda:3')
cal_distance is  tensor(169.3287, device='cuda:3')
cal ratio is  0.9504806522199216
distance x is tensor(160.9439, device='cuda:3')
cal_distance is  tensor(160.9439, device='cuda:3')
cal ratio is  0.9749252964647233
distance x is tensor(156.9084, device='cuda:3')
cal_distance is  tensor(156.9084, device='cuda:3')
distance x is tensor(156.9084, device='cuda:3')
return_distance is  tensor(156.9084, device='cuda:3')
distance x is tensor(156.8995, device='cuda:3')
distance x is tensor(156.8995, device='cuda:3')
________________________________
test distance is  tensor(156.8995, device='cuda:3')
test distance1 is  tensor(156.8995, device='cuda:3')
test similarity is  tensor(0.9868, device='cuda:3')
test acc is  0.1460500001563328
test loss is 43.505614652816675
test entropy is  0.033211442601578094
________________________________
0
distance x is tensor(156.8995, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.034788054686701445
avg test loss is  43.39055951571922
avg accuracy is  0.6572333334896667
solo acc is  0.14590000015633284
compute similarity  is  tensor(0.9868, device='cuda:3')
compute_distance is  tensor(156.8995, device='cuda:3')
compute_norm is  tensor(66.2423, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.4079, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.943782251336173
avg test loss is  1.4548737315226719
avg accuracy is  0.7358833334896618
solo acc is  0.2579833334896718
compute similarity  is  tensor(0.9875, device='cuda:3')
compute_distance is  tensor(151.4079, device='cuda:3')
compute_norm is  tensor(66.0669, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.4079, device='cuda:3')
distance x is tensor(151.4079, device='cuda:3')
________________________________
test distance is  tensor(151.4079, device='cuda:3')
test distance1 is  tensor(151.4079, device='cuda:3')
test similarity is  tensor(0.9875, device='cuda:3')
test acc is  0.2575166668230051
test loss is 1.4533878857138822
test entropy is  0.9457801087324553
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2520000001600001
mal loss is 1.4834930747747421
mal norm is  tensor(760.5832, device='cuda:3')
distance x is tensor(151.4169, device='cuda:3')
mal distance is  tensor(151.4169, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([540.0146, 507.0706, 460.7882, 571.4814, 460.7246, 446.1966, 451.3108,
        405.1633, 760.5832, 760.5832, 760.5832, 760.5832, 760.5832, 760.5832,
        760.5832, 760.5832, 760.5832, 760.5832, 760.5832, 760.5832],
       device='cuda:3')
sorted_norm is   tensor([405.1633, 446.1966, 451.3108, 460.7246, 460.7882, 507.0706, 540.0146,
        571.4814, 760.5832, 760.5832, 760.5832, 760.5832, 760.5832, 760.5832,
        760.5832, 760.5832, 760.5832, 760.5832, 760.5832, 760.5832],
       device='cuda:3')
used idx is  tensor([ 7,  5,  6,  4,  2,  1,  0,  3, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 66.54% 

Test Accuracy: 76.36% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2379610799252987
distance x is tensor(153.2827, device='cuda:3')
benign distance is  tensor(153.2827, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3889432698488235
distance x is tensor(120.2934, device='cuda:3')
benign distance is  tensor(120.2934, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.318059891462326
distance x is tensor(118.6431, device='cuda:3')
benign distance is  tensor(118.6431, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.078390344977379
distance x is tensor(179.1871, device='cuda:3')
benign distance is  tensor(179.1871, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.7970410138368607
distance x is tensor(128.5925, device='cuda:3')
benign distance is  tensor(128.5925, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.246062532067299
distance x is tensor(129.1735, device='cuda:3')
benign distance is  tensor(129.1735, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.522449016571045
distance x is tensor(150.2560, device='cuda:3')
benign distance is  tensor(150.2560, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5120039507746696
distance x is tensor(113.9178, device='cuda:3')
benign distance is  tensor(113.9178, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(94.7172, device='cuda:3')
compute distance is  tensor(94.7172, device='cuda:3')
compute norm is  tensor(63.7940, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.1402, device='cuda:3')
compute distance is  tensor(158.1402, device='cuda:3')
compute norm is  tensor(65.1334, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.5997, device='cuda:3')
compute distance is  tensor(122.5997, device='cuda:3')
compute norm is  tensor(64.2549, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1709, device='cuda:3')
compute distance is  tensor(130.1709, device='cuda:3')
compute norm is  tensor(64.5815, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.6833, device='cuda:3')
compute distance is  tensor(102.6833, device='cuda:3')
compute norm is  tensor(63.9295, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.2070, device='cuda:3')
compute distance is  tensor(114.2070, device='cuda:3')
compute norm is  tensor(64.2960, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1698, device='cuda:3')
compute distance is  tensor(125.1698, device='cuda:3')
compute norm is  tensor(64.6320, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.0592, device='cuda:3')
compute distance is  tensor(101.0592, device='cuda:3')
compute norm is  tensor(63.8537, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1677, device='cuda:3')
compute distance is  tensor(118.1677, device='cuda:3')
compute norm is  tensor(64.3192, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.6948, device='cuda:3')
compute distance is  tensor(121.6948, device='cuda:3')
compute norm is  tensor(64.7268, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7510, device='cuda:3')
compute distance is  tensor(120.7510, device='cuda:3')
compute norm is  tensor(64.5236, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2677, device='cuda:3')
compute distance is  tensor(147.2677, device='cuda:3')
compute norm is  tensor(65.4243, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.1402, device='cuda:3')
distance x is tensor(101723.6797, device='cuda:3')
distance x is tensor(101723.6797, device='cuda:3')
________________________________
test distance is  tensor(101723.6797, device='cuda:3')
test distance1 is  tensor(101723.6797, device='cuda:3')
test similarity is  tensor(0.7333, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107517245691559.03
test entropy is  0.0
________________________________
cal ratio is  0.03863992259908112
distance x is tensor(3930.6006, device='cuda:3')
cal_distance is  tensor(3930.6006, device='cuda:3')
cal ratio is  0.19657026044357384
distance x is tensor(772.6428, device='cuda:3')
cal_distance is  tensor(772.6428, device='cuda:3')
cal ratio is  0.4433614310397566
distance x is tensor(342.5625, device='cuda:3')
cal_distance is  tensor(342.5625, device='cuda:3')
cal ratio is  0.6658515046820611
distance x is tensor(228.0972, device='cuda:3')
cal_distance is  tensor(228.0972, device='cuda:3')
cal ratio is  0.8159945834648585
distance x is tensor(186.1269, device='cuda:3')
cal_distance is  tensor(186.1269, device='cuda:3')
cal ratio is  0.9033222357718124
distance x is tensor(168.1330, device='cuda:3')
cal_distance is  tensor(168.1330, device='cuda:3')
cal ratio is  0.9504313252832253
distance x is tensor(159.7991, device='cuda:3')
cal_distance is  tensor(159.7991, device='cuda:3')
cal ratio is  0.9748999892806967
distance x is tensor(155.7883, device='cuda:3')
cal_distance is  tensor(155.7883, device='cuda:3')
distance x is tensor(155.7883, device='cuda:3')
return_distance is  tensor(155.7883, device='cuda:3')
distance x is tensor(155.7794, device='cuda:3')
distance x is tensor(155.7794, device='cuda:3')
________________________________
test distance is  tensor(155.7794, device='cuda:3')
test distance1 is  tensor(155.7794, device='cuda:3')
test similarity is  tensor(0.9904, device='cuda:3')
test acc is  0.11065000015633196
test loss is 81.14620968832898
test entropy is  0.013627423027627993
________________________________
0
distance x is tensor(155.7794, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.013793243442089407
avg test loss is  81.44660235569675
avg accuracy is  0.5551166668230082
solo acc is  0.11078333348966529
compute similarity  is  tensor(0.9904, device='cuda:3')
compute_distance is  tensor(155.7794, device='cuda:3')
compute_norm is  tensor(70.5354, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1462.7166, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.546547408805473
avg test loss is  2.8815482387156375
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2180, device='cuda:3')
compute_distance is  tensor(1462.7166, device='cuda:3')
compute_norm is  tensor(250.4693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1456.3302, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8319866565753148
avg test loss is  3.6447759973469065
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2181, device='cuda:3')
compute_distance is  tensor(1456.3302, device='cuda:3')
compute_norm is  tensor(249.5043, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1449.5135, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5522254626634024
avg test loss is  2.872105717404819
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2179, device='cuda:3')
compute_distance is  tensor(1449.5135, device='cuda:3')
compute_norm is  tensor(248.0705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1443.2548, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8382124654265609
avg test loss is  3.6277002154636993
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2180, device='cuda:3')
compute_distance is  tensor(1443.2548, device='cuda:3')
compute_norm is  tensor(247.1437, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1436.5839, device='cuda:3')
distance x is tensor(1436.5839, device='cuda:3')
________________________________
test distance is  tensor(1436.5839, device='cuda:3')
test distance1 is  tensor(1436.5839, device='cuda:3')
test similarity is  tensor(0.2179, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8685564720300216
test entropy is  1.554449764396082
________________________________
cal ratio is  0.32514852829929625
distance x is tensor(467.1022, device='cuda:3')
cal_distance is  tensor(467.1022, device='cuda:3')
cal ratio is  0.5702185070287985
distance x is tensor(266.3501, device='cuda:3')
cal_distance is  tensor(266.3501, device='cuda:3')
cal ratio is  0.7551285104769444
distance x is tensor(201.1284, device='cuda:3')
cal_distance is  tensor(201.1284, device='cuda:3')
cal ratio is  0.8689816082477637
distance x is tensor(174.7768, device='cuda:3')
cal_distance is  tensor(174.7768, device='cuda:3')
cal ratio is  0.9321920383917079
distance x is tensor(162.9255, device='cuda:3')
cal_distance is  tensor(162.9255, device='cuda:3')
cal ratio is  0.9655010607539256
distance x is tensor(157.3047, device='cuda:3')
cal_distance is  tensor(157.3047, device='cuda:3')
distance x is tensor(157.3047, device='cuda:3')
return_distance is  tensor(157.3047, device='cuda:3')
distance x is tensor(157.3060, device='cuda:3')
distance x is tensor(157.3060, device='cuda:3')
________________________________
test distance is  tensor(157.3060, device='cuda:3')
test distance1 is  tensor(157.3060, device='cuda:3')
test similarity is  tensor(0.8963, device='cuda:3')
test acc is  0.11046666682299862
test loss is 1485.6640276878372
test entropy is  0.10650417956070657
________________________________
0
distance x is tensor(157.3060, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.10653636886231002
avg test loss is  1483.088543792269
avg accuracy is  0.10971666682299862
solo acc is  0.11086666682299862
compute similarity  is  tensor(0.8963, device='cuda:3')
compute_distance is  tensor(157.3060, device='cuda:3')
compute_norm is  tensor(73.3028, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5134.8848, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5472403420314098
avg test loss is  2.8780683787392656
avg accuracy is  0.05121666682299894
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0225, device='cuda:3')
compute_distance is  tensor(5134.8848, device='cuda:3')
compute_norm is  tensor(781.6141, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5112.0464, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8306320905049981
avg test loss is  3.640632150269775
avg accuracy is  0.04856666682299895
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0225, device='cuda:3')
compute_distance is  tensor(5112.0464, device='cuda:3')
compute_norm is  tensor(778.1740, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5088.9746, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5516766683379215
avg test loss is  2.8713438772697693
avg accuracy is  0.047700000156332294
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0225, device='cuda:3')
compute_distance is  tensor(5088.9746, device='cuda:3')
compute_norm is  tensor(774.2628, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5066.4478, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.832862096554689
avg test loss is  3.630418604879237
avg accuracy is  0.047033333489665624
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0225, device='cuda:3')
compute_distance is  tensor(5066.4478, device='cuda:3')
compute_norm is  tensor(770.8809, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5043.6880, device='cuda:3')
distance x is tensor(5043.6880, device='cuda:3')
________________________________
test distance is  tensor(5043.6880, device='cuda:3')
test distance1 is  tensor(5043.6880, device='cuda:3')
test similarity is  tensor(0.0225, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8658370664124804
test entropy is  1.5542840395909128
________________________________
cal ratio is  0.17352943968708778
distance x is tensor(875.2263, device='cuda:3')
cal_distance is  tensor(875.2263, device='cuda:3')
cal ratio is  0.41656915197190925
distance x is tensor(364.5912, device='cuda:3')
cal_distance is  tensor(364.5912, device='cuda:3')
cal ratio is  0.645422595185481
distance x is tensor(235.3148, device='cuda:3')
cal_distance is  tensor(235.3148, device='cuda:3')
cal ratio is  0.8033829880705016
distance x is tensor(189.0476, device='cuda:3')
cal_distance is  tensor(189.0476, device='cuda:3')
cal ratio is  0.8963170553737616
distance x is tensor(169.4464, device='cuda:3')
cal_distance is  tensor(169.4464, device='cuda:3')
cal ratio is  0.9467407454815739
distance x is tensor(160.4217, device='cuda:3')
cal_distance is  tensor(160.4217, device='cuda:3')
cal ratio is  0.9730064284571971
distance x is tensor(156.0914, device='cuda:3')
cal_distance is  tensor(156.0914, device='cuda:3')
distance x is tensor(156.0914, device='cuda:3')
return_distance is  tensor(156.0914, device='cuda:3')
distance x is tensor(156.0948, device='cuda:3')
distance x is tensor(156.0948, device='cuda:3')
________________________________
test distance is  tensor(156.0948, device='cuda:3')
test distance1 is  tensor(156.0948, device='cuda:3')
test similarity is  tensor(0.8403, device='cuda:3')
test acc is  0.5142000001563422
test loss is 1.313182009308577
test entropy is  1.4306694406436196
________________________________
0
distance x is tensor(156.0948, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4314123547153432
avg test loss is  1.3113866143389297
avg accuracy is  0.7261000001563291
solo acc is  0.5132833334896755
compute similarity  is  tensor(0.8403, device='cuda:3')
compute_distance is  tensor(156.0948, device='cuda:3')
compute_norm is  tensor(74.2773, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.8519, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.61580006905329
avg test loss is  2.4041267419928936
avg accuracy is  0.6793333334896652
solo acc is  0.11126666682299861
compute similarity  is  tensor(0.8402, device='cuda:3')
compute_distance is  tensor(160.8519, device='cuda:3')
compute_norm is  tensor(74.0234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.0913, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9523069983098045
avg test loss is  1.4487394497338644
avg accuracy is  0.7345000001563287
solo acc is  0.25316666682300504
compute similarity  is  tensor(0.8401, device='cuda:3')
compute_distance is  tensor(162.0913, device='cuda:3')
compute_norm is  tensor(73.6030, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(162.0864, device='cuda:3')
________________________________
test distance is  tensor(162.0864, device='cuda:3')
test similarity is  tensor(0.8401, device='cuda:3')
test acc is  0.734083333489662
test loss is 1.4513026642392692
test entropy is  0.9518575798600976
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2650000001600001
mal loss is 1.4661539942026138
mal norm is  tensor(2038.2064, device='cuda:3')
distance x is tensor(162.0864, device='cuda:3')
mal distance is  tensor(162.0864, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 612.8285,  477.7962,  484.7372,  698.8655,  506.6949,  502.5686,
         574.7368,  452.5820, 2038.2063, 2038.2064, 2038.2063, 2038.2064,
        2038.2063, 2038.2064, 2038.2063, 2038.2064, 2038.2063, 2038.2064,
        2038.2063, 2038.2064, 1345.4352, 1376.7557, 1415.0748, 1305.4635,
        1422.5497, 1370.5770, 1334.8534, 1388.8080,  782.9407,  799.0624,
         860.0678,  804.2766,  758.8239, 1040.1807,  959.4168,  845.5350,
         645.0699,  694.5557,  511.2455,  622.9760,  714.8847,  549.7668,
         722.6990,  640.6246], device='cuda:3')
sorted_norm is   tensor([ 452.5820,  477.7962,  484.7372,  502.5686,  506.6949,  511.2455,
         549.7668,  574.7368,  612.8285,  622.9760,  640.6246,  645.0699,
         694.5557,  698.8655,  714.8847,  722.6990,  758.8239,  782.9407,
         799.0624,  804.2766,  845.5350,  860.0678,  959.4168, 1040.1807,
        1305.4635, 1334.8534, 1345.4352, 1370.5770, 1376.7557, 1388.8080,
        1415.0748, 1422.5497, 2038.2063, 2038.2063, 2038.2063, 2038.2063,
        2038.2063, 2038.2063, 2038.2064, 2038.2064, 2038.2064, 2038.2064,
        2038.2064, 2038.2064], device='cuda:3')
used idx is  tensor([ 7,  1,  2,  5,  4, 38, 41,  6,  0, 39, 43, 36, 37,  3, 40, 42, 32, 28,
        29, 31, 35, 30, 34, 33, 23, 26, 20, 25, 21, 27, 22, 24, 10,  8, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 59.65% 

Test Accuracy: 78.72% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7402321137487888
distance x is tensor(126.7751, device='cuda:3')
benign distance is  tensor(126.7751, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5698212683200836
distance x is tensor(95.5764, device='cuda:3')
benign distance is  tensor(95.5764, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4145190045237541
distance x is tensor(97.9645, device='cuda:3')
benign distance is  tensor(97.9645, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6481363140046597
distance x is tensor(135.4782, device='cuda:3')
benign distance is  tensor(135.4782, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0321450904011726
distance x is tensor(124.6757, device='cuda:3')
benign distance is  tensor(124.6757, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4271864406764507
distance x is tensor(99.9422, device='cuda:3')
benign distance is  tensor(99.9422, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.651869211345911
distance x is tensor(95.3061, device='cuda:3')
benign distance is  tensor(95.3061, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2631702721118927
distance x is tensor(95.5221, device='cuda:3')
benign distance is  tensor(95.5221, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2745525743812323
distance x is tensor(97.4990, device='cuda:3')
benign distance is  tensor(97.4990, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.473898958414793
distance x is tensor(120.5693, device='cuda:3')
benign distance is  tensor(120.5693, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4152120687067509
distance x is tensor(73.7057, device='cuda:3')
benign distance is  tensor(73.7057, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.877416953444481
distance x is tensor(106.2407, device='cuda:3')
benign distance is  tensor(106.2407, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.036786697804928
distance x is tensor(138.4474, device='cuda:3')
benign distance is  tensor(138.4474, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.050170999020338
distance x is tensor(66.6423, device='cuda:3')
benign distance is  tensor(66.6423, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2407170198857784
distance x is tensor(134.7694, device='cuda:3')
benign distance is  tensor(134.7694, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.3335896134376526
distance x is tensor(113.2993, device='cuda:3')
benign distance is  tensor(113.2993, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.355274513363838
distance x is tensor(98.5498, device='cuda:3')
benign distance is  tensor(98.5498, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.4297031685709953
distance x is tensor(110.5246, device='cuda:3')
benign distance is  tensor(110.5246, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.295470453798771
distance x is tensor(125.8208, device='cuda:3')
benign distance is  tensor(125.8208, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7289710342884064
distance x is tensor(113.6559, device='cuda:3')
benign distance is  tensor(113.6559, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.538574367761612
distance x is tensor(87.9312, device='cuda:3')
benign distance is  tensor(87.9312, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0371041372418404
distance x is tensor(175.4811, device='cuda:3')
benign distance is  tensor(175.4811, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1103973351418972
distance x is tensor(148.9393, device='cuda:3')
benign distance is  tensor(148.9393, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2487809546291828
distance x is tensor(116.9961, device='cuda:3')
benign distance is  tensor(116.9961, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.341997668147087
distance x is tensor(101.0893, device='cuda:3')
benign distance is  tensor(101.0893, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.459294080734253
distance x is tensor(123.2742, device='cuda:3')
benign distance is  tensor(123.2742, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.831908293068409
distance x is tensor(132.0005, device='cuda:3')
benign distance is  tensor(132.0005, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.1613193824887276
distance x is tensor(90.1953, device='cuda:3')
benign distance is  tensor(90.1953, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.197974793612957
distance x is tensor(139.6691, device='cuda:3')
benign distance is  tensor(139.6691, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.363056443631649
distance x is tensor(123.9152, device='cuda:3')
benign distance is  tensor(123.9152, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.6509194411337376
distance x is tensor(88.2205, device='cuda:3')
benign distance is  tensor(88.2205, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6530032381415367
distance x is tensor(130.8480, device='cuda:3')
benign distance is  tensor(130.8480, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(75.9773, device='cuda:3')
compute distance is  tensor(75.9773, device='cuda:3')
compute norm is  tensor(59.0033, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2094, device='cuda:3')
compute distance is  tensor(126.2094, device='cuda:3')
compute norm is  tensor(59.9649, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.4204, device='cuda:3')
compute distance is  tensor(90.4204, device='cuda:3')
compute norm is  tensor(59.1313, device='cuda:3', dtype=torch.float64)
distance x is tensor(84.4849, device='cuda:3')
compute distance is  tensor(84.4849, device='cuda:3')
compute norm is  tensor(59.1021, device='cuda:3', dtype=torch.float64)
distance x is tensor(81.2148, device='cuda:3')
compute distance is  tensor(81.2148, device='cuda:3')
compute norm is  tensor(58.9927, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.1615, device='cuda:3')
compute distance is  tensor(103.1615, device='cuda:3')
compute norm is  tensor(59.5106, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.8297, device='cuda:3')
compute distance is  tensor(106.8297, device='cuda:3')
compute norm is  tensor(59.5485, device='cuda:3', dtype=torch.float64)
distance x is tensor(85.2877, device='cuda:3')
compute distance is  tensor(85.2877, device='cuda:3')
compute norm is  tensor(59.0684, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.2580, device='cuda:3')
compute distance is  tensor(105.2580, device='cuda:3')
compute norm is  tensor(59.5070, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.2953, device='cuda:3')
compute distance is  tensor(92.2953, device='cuda:3')
compute norm is  tensor(59.4040, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.1322, device='cuda:3')
compute distance is  tensor(103.1322, device='cuda:3')
compute norm is  tensor(59.4414, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5674, device='cuda:3')
compute distance is  tensor(130.5674, device='cuda:3')
compute norm is  tensor(60.4834, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(130.5674, device='cuda:3')
distance x is tensor(101828.6641, device='cuda:3')
distance x is tensor(101828.6641, device='cuda:3')
________________________________
test distance is  tensor(101828.6641, device='cuda:3')
test distance1 is  tensor(101828.6641, device='cuda:3')
test similarity is  tensor(0.6374, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107601153780476.17
test entropy is  0.0
________________________________
cal ratio is  0.035092019001616605
distance x is tensor(3573.3787, device='cuda:3')
cal_distance is  tensor(3573.3787, device='cuda:3')
cal ratio is  0.187328496770182
distance x is tensor(669.3993, device='cuda:3')
cal_distance is  tensor(669.3993, device='cuda:3')
cal ratio is  0.43281344806828964
distance x is tensor(289.7275, device='cuda:3')
cal_distance is  tensor(289.7275, device='cuda:3')
cal ratio is  0.6578827654717107
distance x is tensor(190.6083, device='cuda:3')
cal_distance is  tensor(190.6083, device='cuda:3')
cal ratio is  0.8110964059244263
distance x is tensor(154.6026, device='cuda:3')
cal_distance is  tensor(154.6026, device='cuda:3')
cal ratio is  0.9006064193868487
distance x is tensor(139.2365, device='cuda:3')
cal_distance is  tensor(139.2365, device='cuda:3')
cal ratio is  0.9490013574770392
distance x is tensor(132.1359, device='cuda:3')
cal_distance is  tensor(132.1359, device='cuda:3')
cal ratio is  0.9741661181514969
distance x is tensor(128.7224, device='cuda:3')
cal_distance is  tensor(128.7224, device='cuda:3')
distance x is tensor(128.7224, device='cuda:3')
return_distance is  tensor(128.7224, device='cuda:3')
distance x is tensor(128.7135, device='cuda:3')
distance x is tensor(128.7135, device='cuda:3')
________________________________
test distance is  tensor(128.7135, device='cuda:3')
test distance1 is  tensor(128.7135, device='cuda:3')
test similarity is  tensor(0.9887, device='cuda:3')
test acc is  0.5720333334896733
test loss is 5.63337347527811
test entropy is  0.1859513858535778
________________________________
0
distance x is tensor(128.7135, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.18757522929864906
avg test loss is  5.66173333374422
avg accuracy is  0.7447666668229947
solo acc is  0.5697666668230067
compute similarity  is  tensor(0.9887, device='cuda:3')
compute_distance is  tensor(128.7135, device='cuda:3')
compute_norm is  tensor(63.8166, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(130.0341, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9165760924948304
avg test loss is  1.3675075391970717
avg accuracy is  0.7925666668229925
solo acc is  0.3094000001563397
compute similarity  is  tensor(0.9882, device='cuda:3')
compute_distance is  tensor(130.0341, device='cuda:3')
compute_norm is  tensor(63.3487, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(130.0341, device='cuda:3')
distance x is tensor(130.0341, device='cuda:3')
________________________________
test distance is  tensor(130.0341, device='cuda:3')
test distance1 is  tensor(130.0341, device='cuda:3')
test similarity is  tensor(0.9882, device='cuda:3')
test acc is  0.31131666682300646
test loss is 1.3661935652878239
test entropy is  0.9146365891260378
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.31400000016000007
mal loss is 1.3622654527425766
mal norm is  tensor(634.2527, device='cuda:3')
distance x is tensor(130.0425, device='cuda:3')
mal distance is  tensor(130.0425, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([532.2207, 407.5375, 411.9687, 557.5309, 491.9307, 402.0620, 393.5448,
        395.4656, 634.2527, 634.2527, 634.2527, 634.2527, 634.2527, 634.2527,
        634.2527, 634.2527, 634.2527, 634.2527, 634.2527, 634.2527],
       device='cuda:3')
sorted_norm is   tensor([393.5448, 395.4656, 402.0620, 407.5375, 411.9687, 491.9307, 532.2207,
        557.5309, 634.2527, 634.2527, 634.2527, 634.2527, 634.2527, 634.2527,
        634.2527, 634.2527, 634.2527, 634.2527, 634.2527, 634.2527],
       device='cuda:3')
used idx is  tensor([ 6,  7,  5,  1,  2,  4,  0,  3, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 80.13% 

Test Accuracy: 83.08% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9624136984348297
distance x is tensor(144.7494, device='cuda:3')
benign distance is  tensor(144.7494, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6092124059796333
distance x is tensor(108.8915, device='cuda:3')
benign distance is  tensor(108.8915, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4386619329452515
distance x is tensor(111.2645, device='cuda:3')
benign distance is  tensor(111.2645, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8580653443932533
distance x is tensor(147.2580, device='cuda:3')
benign distance is  tensor(147.2580, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.903571106493473
distance x is tensor(103.8471, device='cuda:3')
benign distance is  tensor(103.8471, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2004975974559784
distance x is tensor(111.4353, device='cuda:3')
benign distance is  tensor(111.4353, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2812537997961044
distance x is tensor(106.0117, device='cuda:3')
benign distance is  tensor(106.0117, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4764193445444107
distance x is tensor(87.4293, device='cuda:3')
benign distance is  tensor(87.4293, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(89.0485, device='cuda:3')
compute distance is  tensor(89.0485, device='cuda:3')
compute norm is  tensor(62.0801, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5690, device='cuda:3')
compute distance is  tensor(124.5690, device='cuda:3')
compute norm is  tensor(62.7372, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.1726, device='cuda:3')
compute distance is  tensor(99.1726, device='cuda:3')
compute norm is  tensor(62.1362, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.2692, device='cuda:3')
compute distance is  tensor(95.2692, device='cuda:3')
compute norm is  tensor(62.1542, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.3416, device='cuda:3')
compute distance is  tensor(92.3416, device='cuda:3')
compute norm is  tensor(61.9412, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.1614, device='cuda:3')
compute distance is  tensor(105.1614, device='cuda:3')
compute norm is  tensor(62.3384, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.8069, device='cuda:3')
compute distance is  tensor(106.8069, device='cuda:3')
compute norm is  tensor(62.4849, device='cuda:3', dtype=torch.float64)
distance x is tensor(88.6126, device='cuda:3')
compute distance is  tensor(88.6126, device='cuda:3')
compute norm is  tensor(61.9948, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.7249, device='cuda:3')
compute distance is  tensor(117.7249, device='cuda:3')
compute norm is  tensor(62.6331, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.7173, device='cuda:3')
compute distance is  tensor(96.7173, device='cuda:3')
compute norm is  tensor(62.2208, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.1985, device='cuda:3')
compute distance is  tensor(111.1985, device='cuda:3')
compute norm is  tensor(62.4055, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8223, device='cuda:3')
compute distance is  tensor(133.8223, device='cuda:3')
compute norm is  tensor(63.3532, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(133.8223, device='cuda:3')
distance x is tensor(101774.5000, device='cuda:3')
distance x is tensor(101774.5000, device='cuda:3')
________________________________
test distance is  tensor(101774.5000, device='cuda:3')
test distance1 is  tensor(101774.5000, device='cuda:3')
test similarity is  tensor(0.6889, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107599244030694.34
test entropy is  0.0
________________________________
cal ratio is  0.03553618832568948
distance x is tensor(3616.6824, device='cuda:3')
cal_distance is  tensor(3616.6824, device='cuda:3')
cal ratio is  0.18851033313594298
distance x is tensor(681.7855, device='cuda:3')
cal_distance is  tensor(681.7855, device='cuda:3')
cal ratio is  0.43417663072066864
distance x is tensor(296.0179, device='cuda:3')
cal_distance is  tensor(296.0179, device='cuda:3')
cal ratio is  0.6589179486237362
distance x is tensor(195.0531, device='cuda:3')
cal_distance is  tensor(195.0531, device='cuda:3')
cal ratio is  0.8117344130766271
distance x is tensor(158.3321, device='cuda:3')
cal_distance is  tensor(158.3321, device='cuda:3')
cal ratio is  0.9009606758071581
distance x is tensor(142.6515, device='cuda:3')
cal_distance is  tensor(142.6515, device='cuda:3')
cal ratio is  0.9491879709661702
distance x is tensor(135.4033, device='cuda:3')
cal_distance is  tensor(135.4033, device='cuda:3')
cal ratio is  0.9742619254694309
distance x is tensor(131.9184, device='cuda:3')
cal_distance is  tensor(131.9184, device='cuda:3')
distance x is tensor(131.9184, device='cuda:3')
return_distance is  tensor(131.9184, device='cuda:3')
distance x is tensor(131.9095, device='cuda:3')
distance x is tensor(131.9095, device='cuda:3')
________________________________
test distance is  tensor(131.9095, device='cuda:3')
test distance1 is  tensor(131.9095, device='cuda:3')
test similarity is  tensor(0.9909, device='cuda:3')
test acc is  0.1035333334896653
test loss is 68.29315098516469
test entropy is  0.004429856556327271
________________________________
0
distance x is tensor(131.9095, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.004306146580894004
avg test loss is  68.22664085583392
avg accuracy is  0.4734666668230085
solo acc is  0.10356666682299863
compute similarity  is  tensor(0.9909, device='cuda:3')
compute_distance is  tensor(131.9095, device='cuda:3')
compute_norm is  tensor(67.1942, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(470.1952, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.379287168669548
avg test loss is  2.5403852513604073
avg accuracy is  0.11760000015633192
solo acc is  0.10688333348966529
compute similarity  is  tensor(0.3982, device='cuda:3')
compute_distance is  tensor(470.1952, device='cuda:3')
compute_norm is  tensor(142.8795, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(468.1067, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7833498051679973
avg test loss is  3.2544092257648134
avg accuracy is  0.10896666682299862
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.3983, device='cuda:3')
compute_distance is  tensor(468.1067, device='cuda:3')
compute_norm is  tensor(142.2979, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(466.1676, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3430920141592209
avg test loss is  2.422993395120096
avg accuracy is  0.12576666682299859
solo acc is  0.10536666682299863
compute similarity  is  tensor(0.3981, device='cuda:3')
compute_distance is  tensor(466.1676, device='cuda:3')
compute_norm is  tensor(141.5001, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(464.2076, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7642691627875574
avg test loss is  3.169240444199617
avg accuracy is  0.11283333348966529
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3982, device='cuda:3')
compute_distance is  tensor(464.2076, device='cuda:3')
compute_norm is  tensor(140.9649, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(462.7422, device='cuda:3')
distance x is tensor(462.7422, device='cuda:3')
________________________________
test distance is  tensor(462.7422, device='cuda:3')
test distance1 is  tensor(462.7422, device='cuda:3')
test similarity is  tensor(0.3980, device='cuda:3')
test acc is  0.10375000015633197
test loss is 2.3358502928127867
test entropy is  1.3513538892081043
________________________________
cal ratio is  0.5270123531913268
distance x is tensor(243.8730, device='cuda:3')
cal_distance is  tensor(243.8730, device='cuda:3')
cal ratio is  0.7259529541544839
distance x is tensor(177.0407, device='cuda:3')
cal_distance is  tensor(177.0407, device='cuda:3')
cal ratio is  0.8520278420337298
distance x is tensor(150.8438, device='cuda:3')
cal_distance is  tensor(150.8438, device='cuda:3')
cal ratio is  0.9230528886480495
distance x is tensor(139.2369, device='cuda:3')
cal_distance is  tensor(139.2369, device='cuda:3')
cal ratio is  0.9607560644045239
distance x is tensor(133.7728, device='cuda:3')
cal_distance is  tensor(133.7728, device='cuda:3')
distance x is tensor(133.7728, device='cuda:3')
return_distance is  tensor(133.7728, device='cuda:3')
distance x is tensor(133.7700, device='cuda:3')
distance x is tensor(133.7700, device='cuda:3')
________________________________
test distance is  tensor(133.7700, device='cuda:3')
test distance1 is  tensor(133.7700, device='cuda:3')
test similarity is  tensor(0.8155, device='cuda:3')
test acc is  0.1241666668229986
test loss is 2.657995762092981
test entropy is  1.5894574164581705
________________________________
0
distance x is tensor(133.7700, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5907218800678944
avg test loss is  2.658847858910876
avg accuracy is  0.22298333348967064
solo acc is  0.12470000015633192
compute similarity  is  tensor(0.8155, device='cuda:3')
compute_distance is  tensor(133.7700, device='cuda:3')
compute_norm is  tensor(78.1868, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(135.1358, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7427844374672945
avg test loss is  2.9743360357243875
avg accuracy is  0.2236000001563373
solo acc is  0.10036666682299865
compute similarity  is  tensor(0.8153, device='cuda:3')
compute_distance is  tensor(135.1358, device='cuda:3')
compute_norm is  tensor(77.9502, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.5326, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2162794449181953
avg test loss is  1.987542514353673
avg accuracy is  0.29885000015633945
solo acc is  0.14005000015633226
compute similarity  is  tensor(0.8152, device='cuda:3')
compute_distance is  tensor(136.5326, device='cuda:3')
compute_norm is  tensor(77.5185, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(136.7941, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7032703773807615
avg test loss is  2.760003799822793
avg accuracy is  0.24801666682300486
solo acc is  0.1019333334896653
compute similarity  is  tensor(0.8152, device='cuda:3')
compute_distance is  tensor(136.7941, device='cuda:3')
compute_norm is  tensor(77.2426, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.5213, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.142220498783502
avg test loss is  1.8461322750109854
avg accuracy is  0.3147833334896732
solo acc is  0.1622000001563341
compute similarity  is  tensor(0.8150, device='cuda:3')
compute_distance is  tensor(138.5213, device='cuda:3')
compute_norm is  tensor(76.8479, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(138.9008, device='cuda:3')
distance x is tensor(138.9008, device='cuda:3')
________________________________
test distance is  tensor(138.9008, device='cuda:3')
test distance1 is  tensor(138.9008, device='cuda:3')
test similarity is  tensor(0.8149, device='cuda:3')
test acc is  0.1025333334896653
test loss is 2.6170882993161295
test entropy is  0.6784160437106069
________________________________
cal ratio is  0.9619176986269314
distance x is tensor(133.6128, device='cuda:3')
cal_distance is  tensor(133.6128, device='cuda:3')
distance x is tensor(133.6128, device='cuda:3')
return_distance is  tensor(133.6128, device='cuda:3')
distance x is tensor(133.6111, device='cuda:3')
distance x is tensor(133.6111, device='cuda:3')
________________________________
test distance is  tensor(133.6111, device='cuda:3')
test distance1 is  tensor(133.6111, device='cuda:3')
test similarity is  tensor(0.8253, device='cuda:3')
test acc is  0.1035333334896653
test loss is 2.538920441416027
test entropy is  0.7255259404685706
________________________________
0
distance x is tensor(133.6111, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.725492320208153
avg test loss is  2.5378501866417906
avg accuracy is  0.2618000001563386
solo acc is  0.10345000015633196
compute similarity  is  tensor(0.8253, device='cuda:3')
compute_distance is  tensor(133.6111, device='cuda:3')
compute_norm is  tensor(75.7465, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.0655, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.124745091141414
avg test loss is  1.7611448195443224
avg accuracy is  0.31148333348967305
solo acc is  0.17700000015633513
compute similarity  is  tensor(0.8251, device='cuda:3')
compute_distance is  tensor(136.0655, device='cuda:3')
compute_norm is  tensor(75.3764, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(136.6787, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6695834179041482
avg test loss is  2.535465054928875
avg accuracy is  0.2460666668230048
solo acc is  0.10280000015633196
compute similarity  is  tensor(0.8250, device='cuda:3')
compute_distance is  tensor(136.6787, device='cuda:3')
compute_norm is  tensor(75.1060, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.0690, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1039628023023544
avg test loss is  1.6607497277290328
avg accuracy is  0.30641666682300633
solo acc is  0.19508333348966944
compute similarity  is  tensor(0.8249, device='cuda:3')
compute_distance is  tensor(139.0690, device='cuda:3')
compute_norm is  tensor(74.7536, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(139.8283, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6525881437223349
avg test loss is  2.4607408678353724
avg accuracy is  0.24743333348967148
solo acc is  0.10296666682299864
compute similarity  is  tensor(0.8248, device='cuda:3')
compute_distance is  tensor(139.8283, device='cuda:3')
compute_norm is  tensor(74.4880, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.2427, device='cuda:3')
________________________________
test distance is  tensor(142.2427, device='cuda:3')
test similarity is  tensor(0.8246, device='cuda:3')
test acc is  0.30831666682300635
test loss is 1.6009286413314754
test entropy is  1.0618884909763011
________________________________
final entropy
distance x is tensor(142.2431, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0600118313008533
avg test loss is  1.5962424174046466
avg accuracy is  0.31083333348967307
solo acc is  0.20468333348966988
compute similarity  is  tensor(0.8246, device='cuda:3')
compute_distance is  tensor(142.2431, device='cuda:3')
compute_norm is  tensor(74.1466, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.11200000016000002
mal loss is 2.434235066175461
mal norm is  tensor(2063.3621, device='cuda:3')
distance x is tensor(143.3233, device='cuda:3')
mal distance is  tensor(143.3233, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 574.6152,  448.6263,  440.6318,  584.7332,  412.2224,  430.9625,
         431.4740,  359.2199, 2063.3623, 2063.3621, 2063.3623, 2063.3621,
        2063.3623, 2063.3621, 2063.3623, 2063.3621, 2063.3623, 2063.3621,
        2063.3623, 2063.3621,  689.3490,  638.6773,  699.0616,  667.2904,
         705.5050,  563.8983,  617.5012,  683.2509,  536.8967,  964.9775,
         580.9938,  590.4013,  629.9459,  640.3088,  564.2225,  625.8184,
         521.4380,  597.9859,  443.0280,  563.6439,  665.3352,  425.0132,
         650.7033,  582.5524], device='cuda:3')
sorted_norm is   tensor([ 359.2199,  412.2224,  425.0132,  430.9625,  431.4740,  440.6318,
         443.0280,  448.6263,  521.4380,  536.8967,  563.6439,  563.8983,
         564.2225,  574.6152,  580.9938,  582.5524,  584.7332,  590.4013,
         597.9859,  617.5012,  625.8184,  629.9459,  638.6773,  640.3088,
         650.7033,  665.3352,  667.2904,  683.2509,  689.3490,  699.0616,
         705.5050,  964.9775, 2063.3621, 2063.3621, 2063.3621, 2063.3621,
        2063.3621, 2063.3621, 2063.3623, 2063.3623, 2063.3623, 2063.3623,
        2063.3623, 2063.3623], device='cuda:3')
used idx is  tensor([ 7,  4, 41,  5,  6,  2, 38,  1, 36, 28, 39, 25, 34,  0, 30, 43,  3, 31,
        37, 26, 35, 32, 21, 33, 42, 40, 23, 27, 20, 22, 24, 29, 11,  9, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 17.35% 

Test Accuracy: 60.81% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8518116399645805
distance x is tensor(143.8480, device='cuda:3')
benign distance is  tensor(143.8480, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.8142183497548103
distance x is tensor(105.2763, device='cuda:3')
benign distance is  tensor(105.2763, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.502811513841152
distance x is tensor(97.6083, device='cuda:3')
benign distance is  tensor(97.6083, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  4.1610367596149445
distance x is tensor(149.0911, device='cuda:3')
benign distance is  tensor(149.0911, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.126382000744343
distance x is tensor(112.3792, device='cuda:3')
benign distance is  tensor(112.3792, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8876417055726051
distance x is tensor(106.6870, device='cuda:3')
benign distance is  tensor(106.6870, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5573895201087
distance x is tensor(113.5879, device='cuda:3')
benign distance is  tensor(113.5879, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.2100495770573616
distance x is tensor(99.3871, device='cuda:3')
benign distance is  tensor(99.3871, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.691095843911171
distance x is tensor(104.4907, device='cuda:3')
benign distance is  tensor(104.4907, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.467802584171295
distance x is tensor(140.4643, device='cuda:3')
benign distance is  tensor(140.4643, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.64219618588686
distance x is tensor(98.6493, device='cuda:3')
benign distance is  tensor(98.6493, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.404716074466705
distance x is tensor(118.4909, device='cuda:3')
benign distance is  tensor(118.4909, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.556166060268879
distance x is tensor(149.0831, device='cuda:3')
benign distance is  tensor(149.0831, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  3.446664720773697
distance x is tensor(97.8831, device='cuda:3')
benign distance is  tensor(97.8831, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.0547773241996765
distance x is tensor(128.4806, device='cuda:3')
benign distance is  tensor(128.4806, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.353374779224396
distance x is tensor(110.0612, device='cuda:3')
benign distance is  tensor(110.0612, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.099668473005295
distance x is tensor(131.4791, device='cuda:3')
benign distance is  tensor(131.4791, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.296209841966629
distance x is tensor(121.3885, device='cuda:3')
benign distance is  tensor(121.3885, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.4293098151683807
distance x is tensor(124.3741, device='cuda:3')
benign distance is  tensor(124.3741, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.8040921688079834
distance x is tensor(104.5152, device='cuda:3')
benign distance is  tensor(104.5152, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.9522932022809982
distance x is tensor(120.6632, device='cuda:3')
benign distance is  tensor(120.6632, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8464924991130829
distance x is tensor(114.1301, device='cuda:3')
benign distance is  tensor(114.1301, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.68045833427459
distance x is tensor(127.8190, device='cuda:3')
benign distance is  tensor(127.8190, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.7818152010440826
distance x is tensor(133.9630, device='cuda:3')
benign distance is  tensor(133.9630, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.872609805315733
distance x is tensor(133.5298, device='cuda:3')
benign distance is  tensor(133.5298, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  4.303606823086739
distance x is tensor(127.1236, device='cuda:3')
benign distance is  tensor(127.1236, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.257665142416954
distance x is tensor(124.8791, device='cuda:3')
benign distance is  tensor(124.8791, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.7174026519060135
distance x is tensor(122.1333, device='cuda:3')
benign distance is  tensor(122.1333, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9368905387818813
distance x is tensor(122.1245, device='cuda:3')
benign distance is  tensor(122.1245, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.4039536714553833
distance x is tensor(95.7634, device='cuda:3')
benign distance is  tensor(95.7634, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  3.743776559829712
distance x is tensor(96.4482, device='cuda:3')
benign distance is  tensor(96.4482, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8705073688179255
distance x is tensor(135.9774, device='cuda:3')
benign distance is  tensor(135.9774, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(103.0630, device='cuda:3')
compute distance is  tensor(103.0630, device='cuda:3')
compute norm is  tensor(60.6859, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2045, device='cuda:3')
compute distance is  tensor(135.2045, device='cuda:3')
compute norm is  tensor(61.3152, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.2272, device='cuda:3')
compute distance is  tensor(93.2272, device='cuda:3')
compute norm is  tensor(60.4825, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.2474, device='cuda:3')
compute distance is  tensor(104.2474, device='cuda:3')
compute norm is  tensor(60.8443, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.8365, device='cuda:3')
compute distance is  tensor(95.8365, device='cuda:3')
compute norm is  tensor(60.5765, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.3885, device='cuda:3')
compute distance is  tensor(109.3885, device='cuda:3')
compute norm is  tensor(60.8276, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.0279, device='cuda:3')
compute distance is  tensor(116.0279, device='cuda:3')
compute norm is  tensor(61.0433, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.1715, device='cuda:3')
compute distance is  tensor(89.1715, device='cuda:3')
compute norm is  tensor(60.5343, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.9915, device='cuda:3')
compute distance is  tensor(115.9915, device='cuda:3')
compute norm is  tensor(61.0249, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.9219, device='cuda:3')
compute distance is  tensor(97.9219, device='cuda:3')
compute norm is  tensor(60.8509, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.6229, device='cuda:3')
compute distance is  tensor(106.6229, device='cuda:3')
compute norm is  tensor(60.7608, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3029, device='cuda:3')
compute distance is  tensor(140.3029, device='cuda:3')
compute norm is  tensor(62.0959, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(140.3029, device='cuda:3')
distance x is tensor(101813.5469, device='cuda:3')
distance x is tensor(101813.5469, device='cuda:3')
________________________________
test distance is  tensor(101813.5469, device='cuda:3')
test distance1 is  tensor(101813.5469, device='cuda:3')
test similarity is  tensor(0.6508, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107468540744893.95
test entropy is  0.0
________________________________
cal ratio is  0.036379490484161434
distance x is tensor(3703.9294, device='cuda:3')
cal_distance is  tensor(3703.9294, device='cuda:3')
cal ratio is  0.19073396989634522
distance x is tensor(706.4688, device='cuda:3')
cal_distance is  tensor(706.4688, device='cuda:3')
cal ratio is  0.43672987900886195
distance x is tensor(308.5385, device='cuda:3')
cal_distance is  tensor(308.5385, device='cuda:3')
cal ratio is  0.6608527301328444
distance x is tensor(203.9001, device='cuda:3')
cal_distance is  tensor(203.9001, device='cuda:3')
cal ratio is  0.8129254847269389
distance x is tensor(165.7564, device='cuda:3')
cal_distance is  tensor(165.7564, device='cuda:3')
cal ratio is  0.90162150374041
distance x is tensor(149.4500, device='cuda:3')
cal_distance is  tensor(149.4500, device='cuda:3')
cal ratio is  0.9495359788820525
distance x is tensor(141.9084, device='cuda:3')
cal_distance is  tensor(141.9084, device='cuda:3')
cal ratio is  0.9744406465997442
distance x is tensor(138.2814, device='cuda:3')
cal_distance is  tensor(138.2814, device='cuda:3')
distance x is tensor(138.2814, device='cuda:3')
return_distance is  tensor(138.2814, device='cuda:3')
distance x is tensor(138.2725, device='cuda:3')
distance x is tensor(138.2725, device='cuda:3')
________________________________
test distance is  tensor(138.2725, device='cuda:3')
test distance1 is  tensor(138.2725, device='cuda:3')
test similarity is  tensor(0.9882, device='cuda:3')
test acc is  0.10000000015633198
test loss is 180.45451630712319
test entropy is  1.8916885143143512e-06
________________________________
0
distance x is tensor(138.2725, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.698643513264134e-06
avg test loss is  180.36655734291972
avg accuracy is  0.10336666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9882, device='cuda:3')
compute_distance is  tensor(138.2725, device='cuda:3')
compute_norm is  tensor(65.7120, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.2315, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0472025874454076
avg test loss is  1.5788137001523586
avg accuracy is  0.49108333348967537
solo acc is  0.24110000015633795
compute similarity  is  tensor(0.9825, device='cuda:3')
compute_distance is  tensor(165.2315, device='cuda:3')
compute_norm is  tensor(66.9689, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.1116, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6394992356361356
avg test loss is  2.400655545659665
avg accuracy is  0.4362166668230082
solo acc is  0.10546666682299861
compute similarity  is  tensor(0.9823, device='cuda:3')
compute_distance is  tensor(165.1116, device='cuda:3')
compute_norm is  tensor(66.7089, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.2561, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0095364880333069
avg test loss is  1.5043901346131427
avg accuracy is  0.5097500001563421
solo acc is  0.24236666682300465
compute similarity  is  tensor(0.9824, device='cuda:3')
compute_distance is  tensor(164.2561, device='cuda:3')
compute_norm is  tensor(66.3557, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.9880, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6197289922344151
avg test loss is  2.3199799983486185
avg accuracy is  0.4463833334896749
solo acc is  0.10485000015633197
compute similarity  is  tensor(0.9822, device='cuda:3')
compute_distance is  tensor(163.9880, device='cuda:3')
compute_norm is  tensor(66.1035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.2100, device='cuda:3')
distance x is tensor(163.2100, device='cuda:3')
________________________________
test distance is  tensor(163.2100, device='cuda:3')
test distance1 is  tensor(163.2100, device='cuda:3')
test similarity is  tensor(0.9822, device='cuda:3')
test acc is  0.24970000015633823
test loss is 1.4665362186777566
test entropy is  0.9552579096385411
________________________________
cal ratio is  0.9086278103769093
distance x is tensor(148.3045, device='cuda:3')
cal_distance is  tensor(148.3045, device='cuda:3')
cal ratio is  0.9531960084948247
distance x is tensor(141.3634, device='cuda:3')
cal_distance is  tensor(141.3634, device='cuda:3')
cal ratio is  0.9763170315396971
distance x is tensor(138.0156, device='cuda:3')
cal_distance is  tensor(138.0156, device='cuda:3')
distance x is tensor(138.0156, device='cuda:3')
return_distance is  tensor(138.0156, device='cuda:3')
distance x is tensor(138.0079, device='cuda:3')
distance x is tensor(138.0079, device='cuda:3')
________________________________
test distance is  tensor(138.0079, device='cuda:3')
test distance1 is  tensor(138.0079, device='cuda:3')
test similarity is  tensor(0.9867, device='cuda:3')
test acc is  0.2656500001563386
test loss is 1.412903152295013
test entropy is  1.2121307476242977
________________________________
0
distance x is tensor(138.0079, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2109898052998442
avg test loss is  1.4127687853790805
avg accuracy is  0.5386000001563424
solo acc is  0.26248333348967195
compute similarity  is  tensor(0.9867, device='cuda:3')
compute_distance is  tensor(138.0079, device='cuda:3')
compute_norm is  tensor(64.5599, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(138.6934, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6190462005036727
avg test loss is  2.278538366370618
avg accuracy is  0.46595000015634175
solo acc is  0.10351666682299863
compute similarity  is  tensor(0.9865, device='cuda:3')
compute_distance is  tensor(138.6934, device='cuda:3')
compute_norm is  tensor(64.3324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.4876, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9573828978325004
avg test loss is  1.4419621579936828
avg accuracy is  0.5385500001563424
solo acc is  0.24751666682300483
compute similarity  is  tensor(0.9864, device='cuda:3')
compute_distance is  tensor(138.4876, device='cuda:3')
compute_norm is  tensor(63.9990, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(138.4876, device='cuda:3')
distance x is tensor(138.4876, device='cuda:3')
________________________________
test distance is  tensor(138.4876, device='cuda:3')
test distance1 is  tensor(138.4876, device='cuda:3')
test similarity is  tensor(0.9864, device='cuda:3')
test acc is  0.24675000015633816
test loss is 1.4427921050138819
test entropy is  0.9573837682636562
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2600000001600001
mal loss is 1.4472579136490822
mal norm is  tensor(605.2618, device='cuda:3')
distance x is tensor(138.4953, device='cuda:3')
mal distance is  tensor(138.4953, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([627.8033, 479.2773, 432.8188, 613.0452, 487.8390, 448.2945, 491.3232,
        426.3010, 605.2618, 605.2618, 605.2618, 605.2618, 605.2618, 605.2618,
        605.2618, 605.2618, 605.2618, 605.2618, 605.2618, 605.2618, 478.9213,
        492.9659, 562.2208, 511.9660, 419.0551, 750.8708, 655.2896, 518.6659],
       device='cuda:3')
sorted_norm is   tensor([419.0551, 426.3010, 432.8188, 448.2945, 478.9213, 479.2773, 487.8390,
        491.3232, 492.9659, 511.9660, 518.6659, 562.2208, 605.2618, 605.2618,
        605.2618, 605.2618, 605.2618, 605.2618, 605.2618, 605.2618, 605.2618,
        605.2618, 605.2618, 605.2618, 613.0452, 627.8033, 655.2896, 750.8708],
       device='cuda:3')
used idx is  tensor([24,  7,  2,  5, 20,  1,  4,  6, 21, 23, 27, 22, 19, 18, 16, 17, 14, 15,
        11, 10, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 52.16% 

Test Accuracy: 63.54% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7208251487463713
distance x is tensor(143.7371, device='cuda:3')
benign distance is  tensor(143.7371, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.054793432354927
distance x is tensor(119.8365, device='cuda:3')
benign distance is  tensor(119.8365, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.459331512451172
distance x is tensor(111.8370, device='cuda:3')
benign distance is  tensor(111.8370, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0122377425432205
distance x is tensor(136.5092, device='cuda:3')
benign distance is  tensor(136.5092, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.358198218047619
distance x is tensor(103.1599, device='cuda:3')
benign distance is  tensor(103.1599, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.4220037385821342
distance x is tensor(112.3643, device='cuda:3')
benign distance is  tensor(112.3643, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.6871098279953003
distance x is tensor(106.2004, device='cuda:3')
benign distance is  tensor(106.2004, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.201328158378601
distance x is tensor(111.4084, device='cuda:3')
benign distance is  tensor(111.4084, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.015542387962341
distance x is tensor(114.4143, device='cuda:3')
benign distance is  tensor(114.4143, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.6280230432748795
distance x is tensor(130.4719, device='cuda:3')
benign distance is  tensor(130.4719, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.792365550994873
distance x is tensor(122.8160, device='cuda:3')
benign distance is  tensor(122.8160, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.2319019064307213
distance x is tensor(124.5971, device='cuda:3')
benign distance is  tensor(124.5971, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.716456599533558
distance x is tensor(127.0203, device='cuda:3')
benign distance is  tensor(127.0203, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4920687153935432
distance x is tensor(180.1851, device='cuda:3')
benign distance is  tensor(180.1851, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4828773215413094
distance x is tensor(190.9899, device='cuda:3')
benign distance is  tensor(190.9899, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.339598212391138
distance x is tensor(132.8555, device='cuda:3')
benign distance is  tensor(132.8555, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(97.2473, device='cuda:3')
compute distance is  tensor(97.2473, device='cuda:3')
compute norm is  tensor(62.2280, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4522, device='cuda:3')
compute distance is  tensor(145.4522, device='cuda:3')
compute norm is  tensor(63.2509, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.9812, device='cuda:3')
compute distance is  tensor(93.9812, device='cuda:3')
compute norm is  tensor(62.0492, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.1096, device='cuda:3')
compute distance is  tensor(108.1096, device='cuda:3')
compute norm is  tensor(62.5608, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.6215, device='cuda:3')
compute distance is  tensor(99.6215, device='cuda:3')
compute norm is  tensor(62.2750, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0344, device='cuda:3')
compute distance is  tensor(124.0344, device='cuda:3')
compute norm is  tensor(62.7454, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7501, device='cuda:3')
compute distance is  tensor(121.7501, device='cuda:3')
compute norm is  tensor(62.7108, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.2315, device='cuda:3')
compute distance is  tensor(97.2315, device='cuda:3')
compute norm is  tensor(62.0514, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7234, device='cuda:3')
compute distance is  tensor(137.7234, device='cuda:3')
compute norm is  tensor(62.8642, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7755, device='cuda:3')
compute distance is  tensor(140.7755, device='cuda:3')
compute norm is  tensor(63.3911, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.2523, device='cuda:3')
compute distance is  tensor(112.2523, device='cuda:3')
compute norm is  tensor(62.3448, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0567, device='cuda:3')
compute distance is  tensor(138.0567, device='cuda:3')
compute norm is  tensor(63.4510, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.4522, device='cuda:3')
distance x is tensor(101785.4219, device='cuda:3')
distance x is tensor(101785.4219, device='cuda:3')
________________________________
test distance is  tensor(101785.4219, device='cuda:3')
test distance1 is  tensor(101785.4219, device='cuda:3')
test similarity is  tensor(0.6803, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107612558334515.31
test entropy is  0.0
________________________________
cal ratio is  0.037046178843335886
distance x is tensor(3770.7659, device='cuda:3')
cal_distance is  tensor(3770.7659, device='cuda:3')
cal ratio is  0.19247371843676006
distance x is tensor(725.7769, device='cuda:3')
cal_distance is  tensor(725.7769, device='cuda:3')
cal ratio is  0.4387171708632954
distance x is tensor(318.4133, device='cuda:3')
cal_distance is  tensor(318.4133, device='cuda:3')
cal ratio is  0.6623546924123634
distance x is tensor(210.9041, device='cuda:3')
cal_distance is  tensor(210.9041, device='cuda:3')
cal ratio is  0.8138488398791451
distance x is tensor(171.6449, device='cuda:3')
cal_distance is  tensor(171.6449, device='cuda:3')
cal ratio is  0.9021334718700477
distance x is tensor(154.8470, device='cuda:3')
cal_distance is  tensor(154.8470, device='cuda:3')
cal ratio is  0.9498056929918537
distance x is tensor(147.0748, device='cuda:3')
cal_distance is  tensor(147.0748, device='cuda:3')
cal ratio is  0.9745790125213016
distance x is tensor(143.3362, device='cuda:3')
cal_distance is  tensor(143.3362, device='cuda:3')
distance x is tensor(143.3362, device='cuda:3')
return_distance is  tensor(143.3362, device='cuda:3')
distance x is tensor(143.3272, device='cuda:3')
distance x is tensor(143.3272, device='cuda:3')
________________________________
test distance is  tensor(143.3272, device='cuda:3')
test distance1 is  tensor(143.3272, device='cuda:3')
test similarity is  tensor(0.9892, device='cuda:3')
test acc is  0.19131666682300252
test loss is 9.948148928725644
test entropy is  0.2393316366255029
________________________________
0
distance x is tensor(143.3272, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.23892186258012044
avg test loss is  9.967969944736343
avg accuracy is  0.506150000156342
solo acc is  0.19295000015633593
compute similarity  is  tensor(0.9892, device='cuda:3')
compute_distance is  tensor(143.3272, device='cuda:3')
compute_norm is  tensor(67.7842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.5728, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9563283451965877
avg test loss is  1.4285416863620408
avg accuracy is  0.6082333334896702
solo acc is  0.2710333334896721
compute similarity  is  tensor(0.9894, device='cuda:3')
compute_distance is  tensor(140.5728, device='cuda:3')
compute_norm is  tensor(67.4628, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(140.5728, device='cuda:3')
distance x is tensor(140.5728, device='cuda:3')
________________________________
test distance is  tensor(140.5728, device='cuda:3')
test distance1 is  tensor(140.5728, device='cuda:3')
test similarity is  tensor(0.9894, device='cuda:3')
test acc is  0.2681000001563387
test loss is 1.426586731410484
test entropy is  0.9570773568615984
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2620000001600001
mal loss is 1.4649890214204788
mal norm is  tensor(698.1230, device='cuda:3')
distance x is tensor(140.5818, device='cuda:3')
mal distance is  tensor(140.5818, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([615.7772, 532.9140, 481.8045, 579.6371, 446.5978, 474.5166, 466.6640,
        473.4529, 698.1230, 698.1230, 698.1230, 698.1230, 698.1230, 698.1230,
        698.1230, 698.1230, 698.1230, 698.1230, 698.1230, 698.1230, 523.0728,
        632.9124, 482.7917, 565.0681, 697.7900, 536.2460, 592.7178, 538.3443],
       device='cuda:3')
sorted_norm is   tensor([446.5978, 466.6640, 473.4529, 474.5166, 481.8045, 482.7917, 523.0728,
        532.9140, 536.2460, 538.3443, 565.0681, 579.6371, 592.7178, 615.7772,
        632.9124, 697.7900, 698.1230, 698.1230, 698.1230, 698.1230, 698.1230,
        698.1230, 698.1230, 698.1230, 698.1230, 698.1230, 698.1230, 698.1230],
       device='cuda:3')
used idx is  tensor([ 4,  6,  7,  5,  2, 22, 20,  1, 25, 27, 23,  3, 26,  0, 21, 24, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 59.97% 

Test Accuracy: 75.80% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9210342392325401
distance x is tensor(123.5305, device='cuda:3')
benign distance is  tensor(123.5305, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.808764211833477
distance x is tensor(95.4771, device='cuda:3')
benign distance is  tensor(95.4771, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.762184798717499
distance x is tensor(99.9890, device='cuda:3')
benign distance is  tensor(99.9890, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.729466773569584
distance x is tensor(131.6258, device='cuda:3')
benign distance is  tensor(131.6258, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.6173934265971184
distance x is tensor(88.1716, device='cuda:3')
benign distance is  tensor(88.1716, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.5457603186368942
distance x is tensor(100.3486, device='cuda:3')
benign distance is  tensor(100.3486, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5139272660017014
distance x is tensor(98.9728, device='cuda:3')
benign distance is  tensor(98.9728, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9040216282010078
distance x is tensor(92.6720, device='cuda:3')
benign distance is  tensor(92.6720, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.1466385945677757
distance x is tensor(90.8778, device='cuda:3')
benign distance is  tensor(90.8778, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.4292424246668816
distance x is tensor(139.1955, device='cuda:3')
benign distance is  tensor(139.1955, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.106277324259281
distance x is tensor(71.6373, device='cuda:3')
benign distance is  tensor(71.6373, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.150191158056259
distance x is tensor(99.4056, device='cuda:3')
benign distance is  tensor(99.4056, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.698095977306366
distance x is tensor(130.6409, device='cuda:3')
benign distance is  tensor(130.6409, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.386849969625473
distance x is tensor(72.2708, device='cuda:3')
benign distance is  tensor(72.2708, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9356952831149101
distance x is tensor(131.4555, device='cuda:3')
benign distance is  tensor(131.4555, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.6335489973425865
distance x is tensor(109.4379, device='cuda:3')
benign distance is  tensor(109.4379, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(79.4538, device='cuda:3')
compute distance is  tensor(79.4538, device='cuda:3')
compute norm is  tensor(63.3657, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7803, device='cuda:3')
compute distance is  tensor(122.7803, device='cuda:3')
compute norm is  tensor(64.3071, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.3604, device='cuda:3')
compute distance is  tensor(94.3604, device='cuda:3')
compute norm is  tensor(63.5294, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.4736, device='cuda:3')
compute distance is  tensor(113.4736, device='cuda:3')
compute norm is  tensor(64.0073, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.6752, device='cuda:3')
compute distance is  tensor(89.6752, device='cuda:3')
compute norm is  tensor(63.5337, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.9498, device='cuda:3')
compute distance is  tensor(95.9498, device='cuda:3')
compute norm is  tensor(63.6687, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.4220, device='cuda:3')
compute distance is  tensor(105.4220, device='cuda:3')
compute norm is  tensor(63.8854, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.0568, device='cuda:3')
compute distance is  tensor(90.0568, device='cuda:3')
compute norm is  tensor(63.5051, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.9902, device='cuda:3')
compute distance is  tensor(100.9902, device='cuda:3')
compute norm is  tensor(63.8903, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.7419, device='cuda:3')
compute distance is  tensor(89.7419, device='cuda:3')
compute norm is  tensor(63.6540, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.9499, device='cuda:3')
compute distance is  tensor(105.9499, device='cuda:3')
compute norm is  tensor(63.7711, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8935, device='cuda:3')
compute distance is  tensor(128.8935, device='cuda:3')
compute norm is  tensor(64.6579, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(128.8935, device='cuda:3')
distance x is tensor(101769.3828, device='cuda:3')
distance x is tensor(101769.3828, device='cuda:3')
________________________________
test distance is  tensor(101769.3828, device='cuda:3')
test distance1 is  tensor(101769.3828, device='cuda:3')
test similarity is  tensor(0.6909, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107651400657031.38
test entropy is  0.0
________________________________
cal ratio is  0.03487650848020745
distance x is tensor(3549.3655, device='cuda:3')
cal_distance is  tensor(3549.3655, device='cuda:3')
cal ratio is  0.1867524092913334
distance x is tensor(662.8561, device='cuda:3')
cal_distance is  tensor(662.8561, device='cuda:3')
cal ratio is  0.4321474317952563
distance x is tensor(286.4541, device='cuda:3')
cal_distance is  tensor(286.4541, device='cuda:3')
cal ratio is  0.6573762858331628
distance x is tensor(188.3097, device='cuda:3')
cal_distance is  tensor(188.3097, device='cuda:3')
cal ratio is  0.8107841156125772
distance x is tensor(152.6794, device='cuda:3')
cal_distance is  tensor(152.6794, device='cuda:3')
cal ratio is  0.9004329739026132
distance x is tensor(137.4780, device='cuda:3')
cal_distance is  tensor(137.4780, device='cuda:3')
cal ratio is  0.9489099372529567
distance x is tensor(130.4545, device='cuda:3')
cal_distance is  tensor(130.4545, device='cuda:3')
cal ratio is  0.9741192246589798
distance x is tensor(127.0783, device='cuda:3')
cal_distance is  tensor(127.0783, device='cuda:3')
distance x is tensor(127.0783, device='cuda:3')
return_distance is  tensor(127.0783, device='cuda:3')
distance x is tensor(127.0694, device='cuda:3')
distance x is tensor(127.0694, device='cuda:3')
________________________________
test distance is  tensor(127.0694, device='cuda:3')
test distance1 is  tensor(127.0694, device='cuda:3')
test similarity is  tensor(0.9919, device='cuda:3')
test acc is  0.44143333348967484
test loss is 9.440092635815585
test entropy is  0.25568699403040446
________________________________
0
distance x is tensor(127.0694, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.2568650652509508
avg test loss is  9.446459663702226
avg accuracy is  0.7049833334896637
solo acc is  0.4393000001563415
compute similarity  is  tensor(0.9919, device='cuda:3')
compute_distance is  tensor(127.0694, device='cuda:3')
compute_norm is  tensor(68.4645, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(127.2237, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9477305208314964
avg test loss is  1.412526049339441
avg accuracy is  0.7127333334896633
solo acc is  0.28320000015633917
compute similarity  is  tensor(0.9917, device='cuda:3')
compute_distance is  tensor(127.2237, device='cuda:3')
compute_norm is  tensor(68.0535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(127.2237, device='cuda:3')
distance x is tensor(127.2237, device='cuda:3')
________________________________
test distance is  tensor(127.2237, device='cuda:3')
test distance1 is  tensor(127.2237, device='cuda:3')
test similarity is  tensor(0.9917, device='cuda:3')
test acc is  0.2788166668230057
test loss is 1.415108230703675
test entropy is  0.9477974917334534
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2720000001600001
mal loss is 1.4242245554924011
mal norm is  tensor(622.4522, device='cuda:3')
distance x is tensor(127.2323, device='cuda:3')
mal distance is  tensor(127.2323, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([538.0017, 415.3100, 410.5876, 539.1780, 365.7206, 396.2654, 409.8079,
        388.5191, 622.4522, 622.4522, 622.4522, 622.4522, 622.4522, 622.4522,
        622.4522, 622.4522, 622.4522, 622.4522, 622.4522, 622.4522],
       device='cuda:3')
sorted_norm is   tensor([365.7206, 388.5191, 396.2654, 409.8079, 410.5876, 415.3100, 538.0017,
        539.1780, 622.4522, 622.4522, 622.4522, 622.4522, 622.4522, 622.4522,
        622.4522, 622.4522, 622.4522, 622.4522, 622.4522, 622.4522],
       device='cuda:3')
used idx is  tensor([ 4,  7,  5,  6,  2,  1,  0,  3, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 74.40% 

Test Accuracy: 80.19% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7467470206320286
distance x is tensor(126.7843, device='cuda:3')
benign distance is  tensor(126.7843, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8222415149211884
distance x is tensor(101.8208, device='cuda:3')
benign distance is  tensor(101.8208, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8412402868270874
distance x is tensor(111.6644, device='cuda:3')
benign distance is  tensor(111.6644, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2507618740200996
distance x is tensor(132.6290, device='cuda:3')
benign distance is  tensor(132.6290, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1351386830210686
distance x is tensor(112.0597, device='cuda:3')
benign distance is  tensor(112.0597, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3697983622550964
distance x is tensor(101.6962, device='cuda:3')
benign distance is  tensor(101.6962, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0992980003356934
distance x is tensor(99.1056, device='cuda:3')
benign distance is  tensor(99.1056, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9358421564102173
distance x is tensor(91.7855, device='cuda:3')
benign distance is  tensor(91.7855, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.6933, device='cuda:3')
compute distance is  tensor(137.6933, device='cuda:3')
compute norm is  tensor(67.9264, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1550, device='cuda:3')
compute distance is  tensor(137.1550, device='cuda:3')
compute norm is  tensor(67.4432, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.5256, device='cuda:3')
compute distance is  tensor(98.5256, device='cuda:3')
compute norm is  tensor(66.6761, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.4422, device='cuda:3')
compute distance is  tensor(95.4422, device='cuda:3')
compute norm is  tensor(66.6713, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.5925, device='cuda:3')
compute distance is  tensor(99.5925, device='cuda:3')
compute norm is  tensor(66.6455, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2494, device='cuda:3')
compute distance is  tensor(134.2494, device='cuda:3')
compute norm is  tensor(67.8198, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.0864, device='cuda:3')
compute distance is  tensor(119.0864, device='cuda:3')
compute norm is  tensor(67.1763, device='cuda:3', dtype=torch.float64)
distance x is tensor(88.1800, device='cuda:3')
compute distance is  tensor(88.1800, device='cuda:3')
compute norm is  tensor(66.4362, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.9061, device='cuda:3')
compute distance is  tensor(115.9061, device='cuda:3')
compute norm is  tensor(67.0122, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.4344, device='cuda:3')
compute distance is  tensor(101.4344, device='cuda:3')
compute norm is  tensor(66.7440, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.0270, device='cuda:3')
compute distance is  tensor(108.0270, device='cuda:3')
compute norm is  tensor(66.8706, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4502, device='cuda:3')
compute distance is  tensor(132.4502, device='cuda:3')
compute norm is  tensor(67.8040, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.6933, device='cuda:3')
distance x is tensor(101718.1094, device='cuda:3')
distance x is tensor(101718.1094, device='cuda:3')
________________________________
test distance is  tensor(101718.1094, device='cuda:3')
test distance1 is  tensor(101718.1094, device='cuda:3')
test similarity is  tensor(0.7305, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107519038465868.97
test entropy is  0.0
________________________________
cal ratio is  0.03605648122003392
distance x is tensor(3667.6018, device='cuda:3')
cal_distance is  tensor(3667.6018, device='cuda:3')
cal ratio is  0.18988532215948375
distance x is tensor(696.4273, device='cuda:3')
cal_distance is  tensor(696.4273, device='cuda:3')
cal ratio is  0.43575720356536657
distance x is tensor(303.4758, device='cuda:3')
cal_distance is  tensor(303.4758, device='cuda:3')
cal ratio is  0.6601163154305995
distance x is tensor(200.3308, device='cuda:3')
cal_distance is  tensor(200.3308, device='cuda:3')
cal ratio is  0.8124723264823185
distance x is tensor(162.7641, device='cuda:3')
cal_distance is  tensor(162.7641, device='cuda:3')
cal ratio is  0.9013701419934819
distance x is tensor(146.7112, device='cuda:3')
cal_distance is  tensor(146.7112, device='cuda:3')
cal ratio is  0.9494037008561752
distance x is tensor(139.2884, device='cuda:3')
cal_distance is  tensor(139.2884, device='cuda:3')
cal ratio is  0.9743726165820634
distance x is tensor(135.7189, device='cuda:3')
cal_distance is  tensor(135.7189, device='cuda:3')
distance x is tensor(135.7189, device='cuda:3')
return_distance is  tensor(135.7189, device='cuda:3')
distance x is tensor(135.7100, device='cuda:3')
distance x is tensor(135.7100, device='cuda:3')
________________________________
test distance is  tensor(135.7100, device='cuda:3')
test distance1 is  tensor(135.7100, device='cuda:3')
test similarity is  tensor(0.9928, device='cuda:3')
test acc is  0.10506666682299862
test loss is 72.22718400690856
test entropy is  0.009293610390375675
________________________________
0
distance x is tensor(135.7100, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.009738842258652678
avg test loss is  72.28500403219195
avg accuracy is  0.450133333489675
solo acc is  0.10475000015633196
compute similarity  is  tensor(0.9928, device='cuda:3')
compute_distance is  tensor(135.7100, device='cuda:3')
compute_norm is  tensor(72.2536, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2709.1008, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.52592249948587
avg test loss is  2.9246333123270127
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1643, device='cuda:3')
compute_distance is  tensor(2709.1008, device='cuda:3')
compute_norm is  tensor(427.2828, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2696.6482, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8183466328867971
avg test loss is  3.6688676452331705
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1644, device='cuda:3')
compute_distance is  tensor(2696.6482, device='cuda:3')
compute_norm is  tensor(425.4243, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2684.1501, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.550341709971682
avg test loss is  2.873225897105772
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1643, device='cuda:3')
compute_distance is  tensor(2684.1501, device='cuda:3')
compute_norm is  tensor(423.1953, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2671.8120, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8270104591017847
avg test loss is  3.636332364987209
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1643, device='cuda:3')
compute_distance is  tensor(2671.8120, device='cuda:3')
compute_norm is  tensor(421.3985, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2659.4126, device='cuda:3')
distance x is tensor(2659.4126, device='cuda:3')
________________________________
test distance is  tensor(2659.4126, device='cuda:3')
test distance1 is  tensor(2659.4126, device='cuda:3')
test similarity is  tensor(0.1643, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.863165262665576
test entropy is  1.555366821634744
________________________________
cal ratio is  0.22299217204354593
distance x is tensor(593.0276, device='cuda:3')
cal_distance is  tensor(593.0276, device='cuda:3')
cal ratio is  0.4722206782431076
distance x is tensor(280.0398, device='cuda:3')
cal_distance is  tensor(280.0398, device='cuda:3')
cal ratio is  0.6871833422623086
distance x is tensor(192.4385, device='cuda:3')
cal_distance is  tensor(192.4385, device='cuda:3')
cal ratio is  0.8289654825459455
distance x is tensor(159.5248, device='cuda:3')
cal_distance is  tensor(159.5248, device='cuda:3')
cal ratio is  0.9104756042264366
distance x is tensor(145.2435, device='cuda:3')
cal_distance is  tensor(145.2435, device='cuda:3')
cal ratio is  0.9541885331964649
distance x is tensor(138.5896, device='cuda:3')
cal_distance is  tensor(138.5896, device='cuda:3')
cal ratio is  0.9768258325500548
distance x is tensor(135.3779, device='cuda:3')
cal_distance is  tensor(135.3779, device='cuda:3')
distance x is tensor(135.3779, device='cuda:3')
return_distance is  tensor(135.3779, device='cuda:3')
distance x is tensor(135.3787, device='cuda:3')
distance x is tensor(135.3787, device='cuda:3')
________________________________
test distance is  tensor(135.3787, device='cuda:3')
test distance1 is  tensor(135.3787, device='cuda:3')
test similarity is  tensor(0.9438, device='cuda:3')
test acc is  0.10018333348966532
test loss is 68322.3855152252
test entropy is  0.003819147762536445
________________________________
0
distance x is tensor(135.3787, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.003743687123294692
avg test loss is  68354.5443555104
avg accuracy is  0.10036666682299865
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9438, device='cuda:3')
compute_distance is  tensor(135.3787, device='cuda:3')
compute_norm is  tensor(74.6559, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3138.4875, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5440678740106921
avg test loss is  2.8873142565745535
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1311, device='cuda:3')
compute_distance is  tensor(3138.4875, device='cuda:3')
compute_norm is  tensor(243.9617, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3125.6343, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8281304959549325
avg test loss is  3.649606925846417
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1312, device='cuda:3')
compute_distance is  tensor(3125.6343, device='cuda:3')
compute_norm is  tensor(242.9906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3112.4248, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.548341884160601
avg test loss is  2.8764909566846737
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1310, device='cuda:3')
compute_distance is  tensor(3112.4248, device='cuda:3')
compute_norm is  tensor(241.6247, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3099.7458, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.83313251914246
avg test loss is  3.638731897512733
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1312, device='cuda:3')
compute_distance is  tensor(3099.7458, device='cuda:3')
compute_norm is  tensor(240.6886, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3086.7297, device='cuda:3')
distance x is tensor(3086.7297, device='cuda:3')
________________________________
test distance is  tensor(3086.7297, device='cuda:3')
test distance1 is  tensor(3086.7297, device='cuda:3')
test similarity is  tensor(0.1310, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.869705119366839
test entropy is  1.5540282827958878
________________________________
cal ratio is  0.2069822865616414
distance x is tensor(638.8943, device='cuda:3')
cal_distance is  tensor(638.8943, device='cuda:3')
cal ratio is  0.45495450269200505
distance x is tensor(290.6660, device='cuda:3')
cal_distance is  tensor(290.6660, device='cuda:3')
cal ratio is  0.6745052439554362
distance x is tensor(196.0547, device='cuda:3')
cal_distance is  tensor(196.0547, device='cuda:3')
cal ratio is  0.8212849139568046
distance x is tensor(161.0162, device='cuda:3')
cal_distance is  tensor(161.0162, device='cuda:3')
cal ratio is  0.9062493774017301
distance x is tensor(145.9205, device='cuda:3')
cal_distance is  tensor(145.9205, device='cuda:3')
cal ratio is  0.9519723206135582
distance x is tensor(138.9121, device='cuda:3')
cal_distance is  tensor(138.9121, device='cuda:3')
cal ratio is  0.975691276574262
distance x is tensor(135.5353, device='cuda:3')
cal_distance is  tensor(135.5353, device='cuda:3')
distance x is tensor(135.5353, device='cuda:3')
return_distance is  tensor(135.5353, device='cuda:3')
distance x is tensor(135.5419, device='cuda:3')
distance x is tensor(135.5419, device='cuda:3')
________________________________
test distance is  tensor(135.5419, device='cuda:3')
test distance1 is  tensor(135.5419, device='cuda:3')
test similarity is  tensor(0.9891, device='cuda:3')
test acc is  0.5886000001563385
test loss is 1.3219303190072715
test entropy is  0.8360194310323515
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.58000000016
mal loss is 1.4414955452084541
mal norm is  tensor(498.6605, device='cuda:3')
distance x is tensor(135.5353, device='cuda:3')
mal distance is  tensor(135.5353, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([532.2847, 424.3555, 448.3646, 540.4890, 441.4332, 407.1042, 400.4247,
        376.4062, 498.6605, 498.6604, 498.6605, 498.6604, 498.6605, 498.6604,
        498.6605, 498.6604, 498.6605, 498.6604, 498.6605, 498.6604, 826.0366,
        869.9141, 891.6920, 799.7798, 915.8577, 872.2880, 796.4105, 895.3074,
        810.7054, 837.2648, 806.1970, 748.1389, 781.5184, 775.2051, 817.3009,
        832.0251, 637.0347, 676.9619, 658.9058, 657.0229, 671.5591, 854.5731,
        880.2626, 681.8857, 501.6898, 653.6962, 440.9855, 532.5836, 638.8618,
        447.0421, 644.3792, 564.5792], device='cuda:3')
sorted_norm is   tensor([376.4062, 400.4247, 407.1042, 424.3555, 440.9855, 441.4332, 447.0421,
        448.3646, 498.6604, 498.6604, 498.6604, 498.6604, 498.6604, 498.6604,
        498.6605, 498.6605, 498.6605, 498.6605, 498.6605, 498.6605, 501.6898,
        532.2847, 532.5836, 540.4890, 564.5792, 637.0347, 638.8618, 644.3792,
        653.6962, 657.0229, 658.9058, 671.5591, 676.9619, 681.8857, 748.1389,
        775.2051, 781.5184, 796.4105, 799.7798, 806.1970, 810.7054, 817.3009,
        826.0366, 832.0251, 837.2648, 854.5731, 869.9141, 872.2880, 880.2626,
        891.6920, 895.3074, 915.8577], device='cuda:3')
used idx is  tensor([ 7,  6,  5,  1, 46,  4, 49,  2, 13, 15, 11,  9, 19, 17,  8, 10, 14, 12,
        16, 18, 44,  0, 47,  3, 51, 36, 48, 50, 45, 39, 38, 40, 37, 43, 31, 33,
        32, 26, 23, 30, 28], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 64.93% 

Test Accuracy: 74.80% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.690119594335556
distance x is tensor(136.3511, device='cuda:3')
benign distance is  tensor(136.3511, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.459264039993286
distance x is tensor(93.5563, device='cuda:3')
benign distance is  tensor(93.5563, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.76848953217268
distance x is tensor(95.2382, device='cuda:3')
benign distance is  tensor(95.2382, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3673107475042343
distance x is tensor(133.9743, device='cuda:3')
benign distance is  tensor(133.9743, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.07754272967577
distance x is tensor(98.7965, device='cuda:3')
benign distance is  tensor(98.7965, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6174339056015015
distance x is tensor(98.1782, device='cuda:3')
benign distance is  tensor(98.1782, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4873226657509804
distance x is tensor(96.3444, device='cuda:3')
benign distance is  tensor(96.3444, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.055926725268364
distance x is tensor(83.4255, device='cuda:3')
benign distance is  tensor(83.4255, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9459481537342072
distance x is tensor(103.6783, device='cuda:3')
benign distance is  tensor(103.6783, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8048463240265846
distance x is tensor(124.6834, device='cuda:3')
benign distance is  tensor(124.6834, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.541256681084633
distance x is tensor(89.4937, device='cuda:3')
benign distance is  tensor(89.4937, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.6264431476593018
distance x is tensor(774.1209, device='cuda:3')
benign distance is  tensor(774.1209, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.070754438638687
distance x is tensor(160.8313, device='cuda:3')
benign distance is  tensor(160.8313, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.7832091376185417
distance x is tensor(71.3526, device='cuda:3')
benign distance is  tensor(71.3526, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4244660139083862
distance x is tensor(130.9932, device='cuda:3')
benign distance is  tensor(130.9932, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.099378377199173
distance x is tensor(113.4644, device='cuda:3')
benign distance is  tensor(113.4644, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.7236085012555122
distance x is tensor(95.2372, device='cuda:3')
benign distance is  tensor(95.2372, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.0834761410951614
distance x is tensor(111.9187, device='cuda:3')
benign distance is  tensor(111.9187, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.952558472752571
distance x is tensor(105.4137, device='cuda:3')
benign distance is  tensor(105.4137, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3787476047873497
distance x is tensor(113.8145, device='cuda:3')
benign distance is  tensor(113.8145, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.929156482219696
distance x is tensor(87.8209, device='cuda:3')
benign distance is  tensor(87.8209, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2931452617049217
distance x is tensor(180.6899, device='cuda:3')
benign distance is  tensor(180.6899, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.889660120010376
distance x is tensor(146.5536, device='cuda:3')
benign distance is  tensor(146.5536, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.8804893270134926
distance x is tensor(120.0846, device='cuda:3')
benign distance is  tensor(120.0846, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.0836803317070007
distance x is tensor(112.8344, device='cuda:3')
benign distance is  tensor(112.8344, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1855003610253334
distance x is tensor(88.8886, device='cuda:3')
benign distance is  tensor(88.8886, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.9159279093146324
distance x is tensor(109.3303, device='cuda:3')
benign distance is  tensor(109.3303, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.594006672501564
distance x is tensor(95.6953, device='cuda:3')
benign distance is  tensor(95.6953, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5113336145877838
distance x is tensor(105.2658, device='cuda:3')
benign distance is  tensor(105.2658, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.2141901925206184
distance x is tensor(125.6361, device='cuda:3')
benign distance is  tensor(125.6361, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7336129527539015
distance x is tensor(108.1645, device='cuda:3')
benign distance is  tensor(108.1645, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.6111340075731277
distance x is tensor(134.2598, device='cuda:3')
benign distance is  tensor(134.2598, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.497270882129669
distance x is tensor(120.0528, device='cuda:3')
benign distance is  tensor(120.0528, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.8471959084272385
distance x is tensor(114.9160, device='cuda:3')
benign distance is  tensor(114.9160, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.499977335333824
distance x is tensor(137.2657, device='cuda:3')
benign distance is  tensor(137.2657, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.012589491903782
distance x is tensor(83.3773, device='cuda:3')
benign distance is  tensor(83.3773, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.822527676820755
distance x is tensor(136.8798, device='cuda:3')
benign distance is  tensor(136.8798, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.0392593070864677
distance x is tensor(123.4234, device='cuda:3')
benign distance is  tensor(123.4234, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.035071276128292
distance x is tensor(94.4516, device='cuda:3')
benign distance is  tensor(94.4516, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6998375654220581
distance x is tensor(142.5451, device='cuda:3')
benign distance is  tensor(142.5451, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(78.4566, device='cuda:3')
compute distance is  tensor(78.4566, device='cuda:3')
compute norm is  tensor(64.2161, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5387, device='cuda:3')
compute distance is  tensor(124.5387, device='cuda:3')
compute norm is  tensor(65.1187, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.0273, device='cuda:3')
compute distance is  tensor(92.0273, device='cuda:3')
compute norm is  tensor(64.3119, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.3479, device='cuda:3')
compute distance is  tensor(99.3479, device='cuda:3')
compute norm is  tensor(64.6590, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.6100, device='cuda:3')
compute distance is  tensor(96.6100, device='cuda:3')
compute norm is  tensor(64.3944, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.4012, device='cuda:3')
compute distance is  tensor(109.4012, device='cuda:3')
compute norm is  tensor(64.8175, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7757, device='cuda:3')
compute distance is  tensor(121.7757, device='cuda:3')
compute norm is  tensor(64.9715, device='cuda:3', dtype=torch.float64)
distance x is tensor(82.7419, device='cuda:3')
compute distance is  tensor(82.7419, device='cuda:3')
compute norm is  tensor(64.1701, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.9738, device='cuda:3')
compute distance is  tensor(115.9738, device='cuda:3')
compute norm is  tensor(64.8858, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.4731, device='cuda:3')
compute distance is  tensor(91.4731, device='cuda:3')
compute norm is  tensor(64.4594, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.5294, device='cuda:3')
compute distance is  tensor(101.5294, device='cuda:3')
compute norm is  tensor(64.4762, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4807, device='cuda:3')
compute distance is  tensor(137.4807, device='cuda:3')
compute norm is  tensor(65.7094, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.4807, device='cuda:3')
distance x is tensor(101785.3203, device='cuda:3')
distance x is tensor(101785.3203, device='cuda:3')
________________________________
test distance is  tensor(101785.3203, device='cuda:3')
test distance1 is  tensor(101785.3203, device='cuda:3')
test similarity is  tensor(0.6844, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107462386761902.67
test entropy is  0.0
________________________________
cal ratio is  0.036016731384204526
distance x is tensor(3665.9785, device='cuda:3')
cal_distance is  tensor(3665.9785, device='cuda:3')
cal ratio is  0.1897806368889681
distance x is tensor(695.7355, device='cuda:3')
cal_distance is  tensor(695.7355, device='cuda:3')
cal ratio is  0.4356370350668003
distance x is tensor(303.0906, device='cuda:3')
cal_distance is  tensor(303.0906, device='cuda:3')
cal ratio is  0.6600253414487232
distance x is tensor(200.0490, device='cuda:3')
cal_distance is  tensor(200.0490, device='cuda:3')
cal ratio is  0.8124163112968941
distance x is tensor(162.5240, device='cuda:3')
cal_distance is  tensor(162.5240, device='cuda:3')
cal ratio is  0.9013390224896093
distance x is tensor(146.4896, device='cuda:3')
cal_distance is  tensor(146.4896, device='cuda:3')
cal ratio is  0.9493873306211983
distance x is tensor(139.0756, device='cuda:3')
cal_distance is  tensor(139.0756, device='cuda:3')
cal ratio is  0.9743643034347258
distance x is tensor(135.5105, device='cuda:3')
cal_distance is  tensor(135.5105, device='cuda:3')
distance x is tensor(135.5105, device='cuda:3')
return_distance is  tensor(135.5105, device='cuda:3')
distance x is tensor(135.5015, device='cuda:3')
distance x is tensor(135.5015, device='cuda:3')
________________________________
test distance is  tensor(135.5015, device='cuda:3')
test distance1 is  tensor(135.5015, device='cuda:3')
test similarity is  tensor(0.9909, device='cuda:3')
test acc is  0.7172500001563297
test loss is 2.8445308174151602
test entropy is  0.2410287465463315
________________________________
0
distance x is tensor(135.5015, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.2412330029742804
avg test loss is  2.8534442179365707
avg accuracy is  0.7243333334896624
solo acc is  0.717133333489663
compute similarity  is  tensor(0.9909, device='cuda:3')
compute_distance is  tensor(135.5015, device='cuda:3')
compute_norm is  tensor(69.6758, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.1273, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9470113883775942
avg test loss is  1.3985870164086316
avg accuracy is  0.7377333334896617
solo acc is  0.2936666668230061
compute similarity  is  tensor(0.9905, device='cuda:3')
compute_distance is  tensor(137.1273, device='cuda:3')
compute_norm is  tensor(69.2492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(137.1273, device='cuda:3')
distance x is tensor(137.1273, device='cuda:3')
________________________________
test distance is  tensor(137.1273, device='cuda:3')
test distance1 is  tensor(137.1273, device='cuda:3')
test similarity is  tensor(0.9905, device='cuda:3')
test acc is  0.29356666682300603
test loss is 1.3977511915952159
test entropy is  0.9479797457708224
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.30900000016000007
mal loss is 1.4086934253573418
mal norm is  tensor(667.8605, device='cuda:3')
distance x is tensor(137.1359, device='cuda:3')
mal distance is  tensor(137.1359, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([576.2412, 403.7158, 400.8391, 546.4620, 398.9241, 399.3978, 407.6248,
        366.0591, 667.8605, 667.8605, 667.8605, 667.8605, 667.8605, 667.8605,
        667.8605, 667.8605, 667.8605, 667.8605, 667.8605, 667.8605, 649.7352,
        631.5300, 620.5762, 617.3954, 637.7956, 533.1105, 545.0457, 683.9203],
       device='cuda:3')
sorted_norm is   tensor([366.0591, 398.9241, 399.3978, 400.8391, 403.7158, 407.6248, 533.1105,
        545.0457, 546.4620, 576.2412, 617.3954, 620.5762, 631.5300, 637.7956,
        649.7352, 667.8605, 667.8605, 667.8605, 667.8605, 667.8605, 667.8605,
        667.8605, 667.8605, 667.8605, 667.8605, 667.8605, 667.8605, 683.9203],
       device='cuda:3')
used idx is  tensor([ 7,  4,  5,  2,  1,  6, 25, 26,  3,  0, 23, 22, 21, 24, 20, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 67.18% 

Test Accuracy: 80.04% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8451733626425266
distance x is tensor(128.6741, device='cuda:3')
benign distance is  tensor(128.6741, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5796819999814034
distance x is tensor(103.3008, device='cuda:3')
benign distance is  tensor(103.3008, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.082143396139145
distance x is tensor(96.3956, device='cuda:3')
benign distance is  tensor(96.3956, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5003678798675537
distance x is tensor(133.7457, device='cuda:3')
benign distance is  tensor(133.7457, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7562403082847595
distance x is tensor(97.7611, device='cuda:3')
benign distance is  tensor(97.7611, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.1110894978046417
distance x is tensor(98.7893, device='cuda:3')
benign distance is  tensor(98.7893, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8748880103230476
distance x is tensor(90.7336, device='cuda:3')
benign distance is  tensor(90.7336, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.454172909259796
distance x is tensor(91.8885, device='cuda:3')
benign distance is  tensor(91.8885, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9074474684894085
distance x is tensor(114.3598, device='cuda:3')
benign distance is  tensor(114.3598, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0625793114304543
distance x is tensor(102.5250, device='cuda:3')
benign distance is  tensor(102.5250, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1869922801852226
distance x is tensor(120.6193, device='cuda:3')
benign distance is  tensor(120.6193, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.4432853907346725
distance x is tensor(105.0111, device='cuda:3')
benign distance is  tensor(105.0111, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9084971807897091
distance x is tensor(107.4420, device='cuda:3')
benign distance is  tensor(107.4420, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9515079632401466
distance x is tensor(78.8730, device='cuda:3')
benign distance is  tensor(78.8730, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.6211466565728188
distance x is tensor(86.9358, device='cuda:3')
benign distance is  tensor(86.9358, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9374386388808489
distance x is tensor(120.0729, device='cuda:3')
benign distance is  tensor(120.0729, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(73.1167, device='cuda:3')
compute distance is  tensor(73.1167, device='cuda:3')
compute norm is  tensor(65.0481, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5447, device='cuda:3')
compute distance is  tensor(119.5447, device='cuda:3')
compute norm is  tensor(65.9942, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.2818, device='cuda:3')
compute distance is  tensor(90.2818, device='cuda:3')
compute norm is  tensor(65.1446, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.5872, device='cuda:3')
compute distance is  tensor(92.5872, device='cuda:3')
compute norm is  tensor(65.4595, device='cuda:3', dtype=torch.float64)
distance x is tensor(88.7323, device='cuda:3')
compute distance is  tensor(88.7323, device='cuda:3')
compute norm is  tensor(65.0387, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.1038, device='cuda:3')
compute distance is  tensor(99.1038, device='cuda:3')
compute norm is  tensor(65.4868, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3636, device='cuda:3')
compute distance is  tensor(107.3636, device='cuda:3')
compute norm is  tensor(65.7094, device='cuda:3', dtype=torch.float64)
distance x is tensor(82.7566, device='cuda:3')
compute distance is  tensor(82.7566, device='cuda:3')
compute norm is  tensor(65.1528, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.5584, device='cuda:3')
compute distance is  tensor(104.5584, device='cuda:3')
compute norm is  tensor(65.6189, device='cuda:3', dtype=torch.float64)
distance x is tensor(83.7286, device='cuda:3')
compute distance is  tensor(83.7286, device='cuda:3')
compute norm is  tensor(65.2912, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.0892, device='cuda:3')
compute distance is  tensor(106.0892, device='cuda:3')
compute norm is  tensor(65.5295, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0898, device='cuda:3')
compute distance is  tensor(134.0898, device='cuda:3')
compute norm is  tensor(66.4608, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(134.0898, device='cuda:3')
distance x is tensor(101761.9609, device='cuda:3')
distance x is tensor(101761.9609, device='cuda:3')
________________________________
test distance is  tensor(101761.9609, device='cuda:3')
test distance1 is  tensor(101761.9609, device='cuda:3')
test similarity is  tensor(0.7002, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107556389717784.56
test entropy is  0.0
________________________________
cal ratio is  0.03557388385022043
distance x is tensor(3620.0735, device='cuda:3')
cal_distance is  tensor(3620.0735, device='cuda:3')
cal ratio is  0.18861026042562595
distance x is tensor(682.7866, device='cuda:3')
cal_distance is  tensor(682.7866, device='cuda:3')
cal ratio is  0.43429168376918303
distance x is tensor(296.5311, device='cuda:3')
cal_distance is  tensor(296.5311, device='cuda:3')
cal ratio is  0.6590052751574574
distance x is tensor(195.4171, device='cuda:3')
cal_distance is  tensor(195.4171, device='cuda:3')
cal ratio is  0.8117882540541236
distance x is tensor(158.6381, device='cuda:3')
cal_distance is  tensor(158.6381, device='cuda:3')
cal ratio is  0.9009905059152299
distance x is tensor(142.9319, device='cuda:3')
cal_distance is  tensor(142.9319, device='cuda:3')
cal ratio is  0.9492037415624823
distance x is tensor(135.6717, device='cuda:3')
cal_distance is  tensor(135.6717, device='cuda:3')
cal ratio is  0.9742699750879291
distance x is tensor(132.1810, device='cuda:3')
cal_distance is  tensor(132.1810, device='cuda:3')
distance x is tensor(132.1810, device='cuda:3')
return_distance is  tensor(132.1810, device='cuda:3')
distance x is tensor(132.1721, device='cuda:3')
distance x is tensor(132.1721, device='cuda:3')
________________________________
test distance is  tensor(132.1721, device='cuda:3')
test distance1 is  tensor(132.1721, device='cuda:3')
test similarity is  tensor(0.9920, device='cuda:3')
test acc is  0.3397000001563403
test loss is 15.710899596529474
test entropy is  0.16533087406045338
________________________________
0
distance x is tensor(132.1721, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.16737430471219997
avg test loss is  15.669313150682429
avg accuracy is  0.7161500001563297
solo acc is  0.33735000015634026
compute similarity  is  tensor(0.9920, device='cuda:3')
compute_distance is  tensor(132.1721, device='cuda:3')
compute_norm is  tensor(70.5379, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.6005, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9463426164472535
avg test loss is  1.3965940716932577
avg accuracy is  0.7234500001563292
solo acc is  0.29463333348967274
compute similarity  is  tensor(0.9919, device='cuda:3')
compute_distance is  tensor(131.6005, device='cuda:3')
compute_norm is  tensor(70.1009, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(131.6005, device='cuda:3')
distance x is tensor(131.6005, device='cuda:3')
________________________________
test distance is  tensor(131.6005, device='cuda:3')
test distance1 is  tensor(131.6005, device='cuda:3')
test similarity is  tensor(0.9919, device='cuda:3')
test acc is  0.2967166668230061
test loss is 1.3935307134697432
test entropy is  0.9466326366355424
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3180000001600001
mal loss is 1.4201383665204048
mal norm is  tensor(645.2849, device='cuda:3')
distance x is tensor(131.6090, device='cuda:3')
mal distance is  tensor(131.6090, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 523.2029,  436.9719,  401.4515,  539.2321,  392.1628,  396.1950,
         384.6603,  368.8263,  645.2849,  645.2849,  645.2849,  645.2849,
         645.2849,  645.2849,  645.2849,  645.2849,  645.2849,  645.2849,
         645.2849,  645.2849,  449.6490,  532.3554,  382.0320, 4387.2397,
         686.9266,  343.9911,  562.3081,  500.0827], device='cuda:3')
sorted_norm is   tensor([ 343.9911,  368.8263,  382.0320,  384.6603,  392.1628,  396.1950,
         401.4515,  436.9719,  449.6490,  500.0827,  523.2029,  532.3554,
         539.2321,  562.3081,  645.2849,  645.2849,  645.2849,  645.2849,
         645.2849,  645.2849,  645.2849,  645.2849,  645.2849,  645.2849,
         645.2849,  645.2849,  686.9266, 4387.2397], device='cuda:3')
used idx is  tensor([25,  7, 22,  6,  4,  5,  2,  1, 20, 27,  0, 21,  3, 26, 19, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 68.00% 

Test Accuracy: 80.73% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8523983303457499
distance x is tensor(135.0936, device='cuda:3')
benign distance is  tensor(135.0936, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.268485948443413
distance x is tensor(106.5663, device='cuda:3')
benign distance is  tensor(106.5663, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6457690745592117
distance x is tensor(98.7307, device='cuda:3')
benign distance is  tensor(98.7307, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9224733337759972
distance x is tensor(133.8252, device='cuda:3')
benign distance is  tensor(133.8252, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9463187791407108
distance x is tensor(100.3846, device='cuda:3')
benign distance is  tensor(100.3846, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  3.072284944355488
distance x is tensor(103.3794, device='cuda:3')
benign distance is  tensor(103.3794, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.163367472589016
distance x is tensor(99.0172, device='cuda:3')
benign distance is  tensor(99.0172, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.434420332312584
distance x is tensor(96.2413, device='cuda:3')
benign distance is  tensor(96.2413, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.0889593958854675
distance x is tensor(3778.4075, device='cuda:3')
benign distance is  tensor(3778.4075, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.489263892173767
distance x is tensor(125.9911, device='cuda:3')
benign distance is  tensor(125.9911, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.7348930314183235
distance x is tensor(81.8097, device='cuda:3')
benign distance is  tensor(81.8097, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.298314154148102
distance x is tensor(99.6029, device='cuda:3')
benign distance is  tensor(99.6029, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.0976088270545006
distance x is tensor(137.9634, device='cuda:3')
benign distance is  tensor(137.9634, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3866055682301521
distance x is tensor(72.6815, device='cuda:3')
benign distance is  tensor(72.6815, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5543187595903873
distance x is tensor(129.9473, device='cuda:3')
benign distance is  tensor(129.9473, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.8908472806215286
distance x is tensor(112.7747, device='cuda:3')
benign distance is  tensor(112.7747, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(85.3242, device='cuda:3')
compute distance is  tensor(85.3242, device='cuda:3')
compute norm is  tensor(67.3887, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2209, device='cuda:3')
compute distance is  tensor(139.2209, device='cuda:3')
compute norm is  tensor(68.6362, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.7409, device='cuda:3')
compute distance is  tensor(86.7409, device='cuda:3')
compute norm is  tensor(67.3490, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.0224, device='cuda:3')
compute distance is  tensor(93.0224, device='cuda:3')
compute norm is  tensor(67.5028, device='cuda:3', dtype=torch.float64)
distance x is tensor(88.4366, device='cuda:3')
compute distance is  tensor(88.4366, device='cuda:3')
compute norm is  tensor(67.3186, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.8158, device='cuda:3')
compute distance is  tensor(102.8158, device='cuda:3')
compute norm is  tensor(67.7994, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.9782, device='cuda:3')
compute distance is  tensor(112.9782, device='cuda:3')
compute norm is  tensor(67.8864, device='cuda:3', dtype=torch.float64)
distance x is tensor(88.0790, device='cuda:3')
compute distance is  tensor(88.0790, device='cuda:3')
compute norm is  tensor(67.3475, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.6112, device='cuda:3')
compute distance is  tensor(115.6112, device='cuda:3')
compute norm is  tensor(67.8841, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.3386, device='cuda:3')
compute distance is  tensor(102.3386, device='cuda:3')
compute norm is  tensor(67.7451, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2447, device='cuda:3')
compute distance is  tensor(103.2447, device='cuda:3')
compute norm is  tensor(67.4874, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.4492, device='cuda:3')
compute distance is  tensor(141.4492, device='cuda:3')
compute norm is  tensor(68.7947, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.4492, device='cuda:3')
distance x is tensor(101731.4297, device='cuda:3')
distance x is tensor(101731.4297, device='cuda:3')
________________________________
test distance is  tensor(101731.4297, device='cuda:3')
test distance1 is  tensor(101731.4297, device='cuda:3')
test similarity is  tensor(0.7231, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107600774924825.11
test entropy is  0.0
________________________________
cal ratio is  0.036542537353819585
distance x is tensor(3717.5295, device='cuda:3')
cal_distance is  tensor(3717.5295, device='cuda:3')
cal ratio is  0.19116090022419638
distance x is tensor(710.6499, device='cuda:3')
cal_distance is  tensor(710.6499, device='cuda:3')
cal ratio is  0.4372184002599298
distance x is tensor(310.7117, device='cuda:3')
cal_distance is  tensor(310.7117, device='cuda:3')
cal ratio is  0.661222242356851
distance x is tensor(205.4510, device='cuda:3')
cal_distance is  tensor(205.4510, device='cuda:3')
cal ratio is  0.8131527611247266
distance x is tensor(167.0639, device='cuda:3')
cal_distance is  tensor(167.0639, device='cuda:3')
cal ratio is  0.9017474916167836
distance x is tensor(150.6499, device='cuda:3')
cal_distance is  tensor(150.6499, device='cuda:3')
cal ratio is  0.9496024726795712
distance x is tensor(143.0578, device='cuda:3')
cal_distance is  tensor(143.0578, device='cuda:3')
cal ratio is  0.97447468919947
distance x is tensor(139.4063, device='cuda:3')
cal_distance is  tensor(139.4063, device='cuda:3')
distance x is tensor(139.4063, device='cuda:3')
return_distance is  tensor(139.4063, device='cuda:3')
distance x is tensor(139.3973, device='cuda:3')
distance x is tensor(139.3973, device='cuda:3')
________________________________
test distance is  tensor(139.3973, device='cuda:3')
test distance1 is  tensor(139.3973, device='cuda:3')
test similarity is  tensor(0.9925, device='cuda:3')
test acc is  0.14513333348966606
test loss is 41.122614350146065
test entropy is  0.03780838958276158
________________________________
0
distance x is tensor(139.3973, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.037360916801565475
avg test loss is  41.128036885373376
avg accuracy is  0.6229166668230024
solo acc is  0.14528333348966607
compute similarity  is  tensor(0.9925, device='cuda:3')
compute_distance is  tensor(139.3973, device='cuda:3')
compute_norm is  tensor(73.2437, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.6031, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9445299630734458
avg test loss is  1.3963161732342197
avg accuracy is  0.7015500001563305
solo acc is  0.29635000015633944
compute similarity  is  tensor(0.9926, device='cuda:3')
compute_distance is  tensor(136.6031, device='cuda:3')
compute_norm is  tensor(72.9099, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(136.6031, device='cuda:3')
distance x is tensor(136.6031, device='cuda:3')
________________________________
test distance is  tensor(136.6031, device='cuda:3')
test distance1 is  tensor(136.6031, device='cuda:3')
test similarity is  tensor(0.9926, device='cuda:3')
test acc is  0.29298333348967276
test loss is 1.3991243330908736
test entropy is  0.9454962919388753
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29600000016000005
mal loss is 1.4019438326358795
mal norm is  tensor(676.5728, device='cuda:3')
distance x is tensor(136.6117, device='cuda:3')
mal distance is  tensor(136.6117, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([552.1400, 436.2703, 402.6115, 544.8651, 401.8044, 411.6971, 403.5793,
        385.9102, 676.5728, 676.5728, 676.5728, 676.5728, 676.5728, 676.5728,
        676.5728, 676.5728, 676.5728, 676.5728, 676.5728, 676.5728, 518.1816,
        559.0549, 538.8785, 552.5270, 465.2509, 802.7381, 672.6593, 571.5512],
       device='cuda:3')
sorted_norm is   tensor([385.9102, 401.8044, 402.6115, 403.5793, 411.6971, 436.2703, 465.2509,
        518.1816, 538.8785, 544.8651, 552.1400, 552.5270, 559.0549, 571.5512,
        672.6593, 676.5728, 676.5728, 676.5728, 676.5728, 676.5728, 676.5728,
        676.5728, 676.5728, 676.5728, 676.5728, 676.5728, 676.5728, 802.7381],
       device='cuda:3')
used idx is  tensor([ 7,  4,  2,  6,  5,  1, 24, 20, 22,  3,  0, 23, 21, 27, 26, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 64.93% 

Test Accuracy: 79.77% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8518023379147053
distance x is tensor(126.7194, device='cuda:3')
benign distance is  tensor(126.7194, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5962271243333817
distance x is tensor(108.4565, device='cuda:3')
benign distance is  tensor(108.4565, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6652308329939842
distance x is tensor(94.3010, device='cuda:3')
benign distance is  tensor(94.3010, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8482693657279015
distance x is tensor(137.8110, device='cuda:3')
benign distance is  tensor(137.8110, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3069693557918072
distance x is tensor(111.9432, device='cuda:3')
benign distance is  tensor(111.9432, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4777955301105976
distance x is tensor(108.8678, device='cuda:3')
benign distance is  tensor(108.8678, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.007038362324238
distance x is tensor(111.6811, device='cuda:3')
benign distance is  tensor(111.6811, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7477073147892952
distance x is tensor(91.1755, device='cuda:3')
benign distance is  tensor(91.1755, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.494294047355652
distance x is tensor(103.5732, device='cuda:3')
benign distance is  tensor(103.5732, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.7363557405769825
distance x is tensor(107.9273, device='cuda:3')
benign distance is  tensor(107.9273, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.5550222918391228
distance x is tensor(111.7004, device='cuda:3')
benign distance is  tensor(111.7004, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.2916113659739494
distance x is tensor(126.6515, device='cuda:3')
benign distance is  tensor(126.6515, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.2124028131365776
distance x is tensor(85.1686, device='cuda:3')
benign distance is  tensor(85.1686, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.17979371920228
distance x is tensor(181.6822, device='cuda:3')
benign distance is  tensor(181.6822, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5929113999009132
distance x is tensor(154.7675, device='cuda:3')
benign distance is  tensor(154.7675, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4159631542861462
distance x is tensor(116.8303, device='cuda:3')
benign distance is  tensor(116.8303, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(89.3524, device='cuda:3')
compute distance is  tensor(89.3524, device='cuda:3')
compute norm is  tensor(68.8443, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1275, device='cuda:3')
compute distance is  tensor(134.1275, device='cuda:3')
compute norm is  tensor(69.6917, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.2688, device='cuda:3')
compute distance is  tensor(92.2688, device='cuda:3')
compute norm is  tensor(68.7465, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.3870, device='cuda:3')
compute distance is  tensor(89.3870, device='cuda:3')
compute norm is  tensor(68.9360, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.0051, device='cuda:3')
compute distance is  tensor(86.0051, device='cuda:3')
compute norm is  tensor(68.6878, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.8716, device='cuda:3')
compute distance is  tensor(105.8716, device='cuda:3')
compute norm is  tensor(69.1377, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0523, device='cuda:3')
compute distance is  tensor(111.0523, device='cuda:3')
compute norm is  tensor(69.1873, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.3726, device='cuda:3')
compute distance is  tensor(87.3726, device='cuda:3')
compute norm is  tensor(68.6149, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.8971, device='cuda:3')
compute distance is  tensor(112.8971, device='cuda:3')
compute norm is  tensor(69.1496, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.1829, device='cuda:3')
compute distance is  tensor(95.1829, device='cuda:3')
compute norm is  tensor(68.9311, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.5902, device='cuda:3')
compute distance is  tensor(110.5902, device='cuda:3')
compute norm is  tensor(69.1609, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.4409, device='cuda:3')
compute distance is  tensor(127.4409, device='cuda:3')
compute norm is  tensor(69.8293, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(134.1275, device='cuda:3')
distance x is tensor(101717.9219, device='cuda:3')
distance x is tensor(101717.9219, device='cuda:3')
________________________________
test distance is  tensor(101717.9219, device='cuda:3')
test distance1 is  tensor(101717.9219, device='cuda:3')
test similarity is  tensor(0.7325, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107653318732819.66
test entropy is  0.0
________________________________
cal ratio is  0.035586582055912475
distance x is tensor(3619.7976, device='cuda:3')
cal_distance is  tensor(3619.7976, device='cuda:3')
cal ratio is  0.18864394655702427
distance x is tensor(682.8566, device='cuda:3')
cal_distance is  tensor(682.8566, device='cuda:3')
cal ratio is  0.4343304343929485
distance x is tensor(296.5879, device='cuda:3')
cal_distance is  tensor(296.5879, device='cuda:3')
cal ratio is  0.6590347867812278
distance x is tensor(195.4633, device='cuda:3')
cal_distance is  tensor(195.4633, device='cuda:3')
cal ratio is  0.8118062707678309
distance x is tensor(158.6792, device='cuda:3')
cal_distance is  tensor(158.6792, device='cuda:3')
cal ratio is  0.901000544366344
distance x is tensor(142.9705, device='cuda:3')
cal_distance is  tensor(142.9705, device='cuda:3')
cal ratio is  0.9492089280110889
distance x is tensor(135.7091, device='cuda:3')
cal_distance is  tensor(135.7091, device='cuda:3')
cal ratio is  0.9742727953764873
distance x is tensor(132.2178, device='cuda:3')
cal_distance is  tensor(132.2178, device='cuda:3')
distance x is tensor(132.2178, device='cuda:3')
return_distance is  tensor(132.2178, device='cuda:3')
distance x is tensor(132.2089, device='cuda:3')
distance x is tensor(132.2089, device='cuda:3')
________________________________
test distance is  tensor(132.2089, device='cuda:3')
test distance1 is  tensor(132.2089, device='cuda:3')
test similarity is  tensor(0.9936, device='cuda:3')
test acc is  0.3148666668230065
test loss is 16.0451836535163
test entropy is  0.14508866461545927
________________________________
0
distance x is tensor(132.2089, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.14532094390026287
avg test loss is  16.087004877611008
avg accuracy is  0.6929333334896645
solo acc is  0.3143333334896732
compute similarity  is  tensor(0.9936, device='cuda:3')
compute_distance is  tensor(132.2089, device='cuda:3')
compute_norm is  tensor(74.3361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(130.9552, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9461682184672813
avg test loss is  1.3810893245089029
avg accuracy is  0.7001000001563307
solo acc is  0.29513333348967274
compute similarity  is  tensor(0.9936, device='cuda:3')
compute_distance is  tensor(130.9552, device='cuda:3')
compute_norm is  tensor(73.8841, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(130.9552, device='cuda:3')
distance x is tensor(130.9552, device='cuda:3')
________________________________
test distance is  tensor(130.9552, device='cuda:3')
test distance1 is  tensor(130.9552, device='cuda:3')
test similarity is  tensor(0.9936, device='cuda:3')
test acc is  0.29940000015633955
test loss is 1.3828175586423894
test entropy is  0.9439709124280445
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2730000001600001
mal loss is 1.3941050246357918
mal norm is  tensor(642.5958, device='cuda:3')
distance x is tensor(130.9638, device='cuda:3')
mal distance is  tensor(130.9638, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([  540.2097,   444.3380,   400.6831,   559.3408,   461.3551,   422.2156,
          456.7021,   371.9034,   642.5958,   642.5958,   642.5958,   642.5958,
          642.5958,   642.5958,   642.5958,   642.5958,   642.5958,   642.5958,
          642.5958,   642.5958,   619.8021,   556.1451,   623.4703,   584.5298,
          602.9880,   679.1281,   626.3173,   708.1857, 38551.0547,   529.0089,
          369.5422,   434.4943,   589.7590,   337.9074,   548.2805,   494.2646],
       device='cuda:3')
sorted_norm is   tensor([  337.9074,   369.5422,   371.9034,   400.6831,   422.2156,   434.4943,
          444.3380,   456.7021,   461.3551,   494.2646,   529.0089,   540.2097,
          548.2805,   556.1451,   559.3408,   584.5298,   589.7590,   602.9880,
          619.8021,   623.4703,   626.3173,   642.5958,   642.5958,   642.5958,
          642.5958,   642.5958,   642.5958,   642.5958,   642.5958,   642.5958,
          642.5958,   642.5958,   642.5958,   679.1281,   708.1857, 38551.0547],
       device='cuda:3')
used idx is  tensor([33, 30,  7,  2,  5, 31,  1,  6,  4, 35, 29,  0, 34, 21,  3, 23, 32, 24,
        20, 22, 26, 11,  8, 10, 16, 18, 17,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 63.02% 

Test Accuracy: 79.75% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7951612863689661
distance x is tensor(167.7508, device='cuda:3')
benign distance is  tensor(167.7508, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5546896532177925
distance x is tensor(120.8859, device='cuda:3')
benign distance is  tensor(120.8859, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.7797255218029022
distance x is tensor(95.4500, device='cuda:3')
benign distance is  tensor(95.4500, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2752194851636887
distance x is tensor(146.7218, device='cuda:3')
benign distance is  tensor(146.7218, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.820043921470642
distance x is tensor(93.1298, device='cuda:3')
benign distance is  tensor(93.1298, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.385945800691843
distance x is tensor(107.0938, device='cuda:3')
benign distance is  tensor(107.0938, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.151161789894104
distance x is tensor(95.9759, device='cuda:3')
benign distance is  tensor(95.9759, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6605927422642708
distance x is tensor(90.9538, device='cuda:3')
benign distance is  tensor(90.9538, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5969763286411762
distance x is tensor(108.2964, device='cuda:3')
benign distance is  tensor(108.2964, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8019974678754807
distance x is tensor(118.8010, device='cuda:3')
benign distance is  tensor(118.8010, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.910646803677082
distance x is tensor(74.0295, device='cuda:3')
benign distance is  tensor(74.0295, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.9492875784635544
distance x is tensor(101.8159, device='cuda:3')
benign distance is  tensor(101.8159, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.132077507674694
distance x is tensor(145.0204, device='cuda:3')
benign distance is  tensor(145.0204, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.5205824561417103
distance x is tensor(59.3061, device='cuda:3')
benign distance is  tensor(59.3061, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9860743135213852
distance x is tensor(125.5720, device='cuda:3')
benign distance is  tensor(125.5720, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.3909392058849335
distance x is tensor(107.7188, device='cuda:3')
benign distance is  tensor(107.7188, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.5474755093455315
distance x is tensor(110.9008, device='cuda:3')
benign distance is  tensor(110.9008, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0706358440220356
distance x is tensor(81.6049, device='cuda:3')
benign distance is  tensor(81.6049, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.601743683218956
distance x is tensor(117.1520, device='cuda:3')
benign distance is  tensor(117.1520, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.1755105182528496
distance x is tensor(97.5494, device='cuda:3')
benign distance is  tensor(97.5494, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2480178140103817
distance x is tensor(106.7665, device='cuda:3')
benign distance is  tensor(106.7665, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.7685954570770264
distance x is tensor(110.8090, device='cuda:3')
benign distance is  tensor(110.8090, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6918800063431263
distance x is tensor(134.6349, device='cuda:3')
benign distance is  tensor(134.6349, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.386592447757721
distance x is tensor(138.7624, device='cuda:3')
benign distance is  tensor(138.7624, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(80.2033, device='cuda:3')
compute distance is  tensor(80.2033, device='cuda:3')
compute norm is  tensor(69.2653, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1710, device='cuda:3')
compute distance is  tensor(132.1710, device='cuda:3')
compute norm is  tensor(70.1523, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.6709, device='cuda:3')
compute distance is  tensor(96.6709, device='cuda:3')
compute norm is  tensor(69.4362, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.9836, device='cuda:3')
compute distance is  tensor(107.9836, device='cuda:3')
compute norm is  tensor(69.6651, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.4635, device='cuda:3')
compute distance is  tensor(95.4635, device='cuda:3')
compute norm is  tensor(69.3801, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.2836, device='cuda:3')
compute distance is  tensor(100.2836, device='cuda:3')
compute norm is  tensor(69.6894, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.8415, device='cuda:3')
compute distance is  tensor(107.8415, device='cuda:3')
compute norm is  tensor(69.7077, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.8191, device='cuda:3')
compute distance is  tensor(90.8191, device='cuda:3')
compute norm is  tensor(69.3515, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.3889, device='cuda:3')
compute distance is  tensor(110.3889, device='cuda:3')
compute norm is  tensor(69.7194, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.7720, device='cuda:3')
compute distance is  tensor(94.7720, device='cuda:3')
compute norm is  tensor(69.5970, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.4268, device='cuda:3')
compute distance is  tensor(97.4268, device='cuda:3')
compute norm is  tensor(69.5805, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7175, device='cuda:3')
compute distance is  tensor(131.7175, device='cuda:3')
compute norm is  tensor(70.6074, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(132.1710, device='cuda:3')
distance x is tensor(101716.1875, device='cuda:3')
distance x is tensor(101716.1875, device='cuda:3')
________________________________
test distance is  tensor(101716.1875, device='cuda:3')
test distance1 is  tensor(101716.1875, device='cuda:3')
test similarity is  tensor(0.7328, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107627868536797.06
test entropy is  0.0
________________________________
cal ratio is  0.0353263772136864
distance x is tensor(3593.2693, device='cuda:3')
cal_distance is  tensor(3593.2693, device='cuda:3')
cal ratio is  0.18795300217171848
distance x is tensor(675.3693, device='cuda:3')
cal_distance is  tensor(675.3693, device='cuda:3')
cal ratio is  0.4335343144894948
distance x is tensor(292.7983, device='cuda:3')
cal_distance is  tensor(292.7983, device='cuda:3')
cal ratio is  0.6584303491780747
distance x is tensor(192.7888, device='cuda:3')
cal_distance is  tensor(192.7888, device='cuda:3')
cal ratio is  0.8114340086650802
distance x is tensor(156.4363, device='cuda:3')
cal_distance is  tensor(156.4363, device='cuda:3')
cal ratio is  0.9007938123027197
distance x is tensor(140.9173, device='cuda:3')
cal_distance is  tensor(140.9173, device='cuda:3')
cal ratio is  0.9491000367957105
distance x is tensor(133.7448, device='cuda:3')
cal_distance is  tensor(133.7448, device='cuda:3')
cal ratio is  0.9742169462675209
distance x is tensor(130.2966, device='cuda:3')
cal_distance is  tensor(130.2966, device='cuda:3')
distance x is tensor(130.2966, device='cuda:3')
return_distance is  tensor(130.2966, device='cuda:3')
distance x is tensor(130.2877, device='cuda:3')
distance x is tensor(130.2877, device='cuda:3')
________________________________
test distance is  tensor(130.2877, device='cuda:3')
test distance1 is  tensor(130.2877, device='cuda:3')
test similarity is  tensor(0.9939, device='cuda:3')
test acc is  0.3058166668230064
test loss is 17.627956339036988
test entropy is  0.12258571089664375
________________________________
0
distance x is tensor(130.2877, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.12246101394073287
avg test loss is  17.553943265984053
avg accuracy is  0.7062333334896637
solo acc is  0.30506666682300626
compute similarity  is  tensor(0.9939, device='cuda:3')
compute_distance is  tensor(130.2877, device='cuda:3')
compute_norm is  tensor(74.8158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(129.4532, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9366151400085198
avg test loss is  1.4010372541860732
avg accuracy is  0.7160000001563298
solo acc is  0.2874500001563392
compute similarity  is  tensor(0.9938, device='cuda:3')
compute_distance is  tensor(129.4532, device='cuda:3')
compute_norm is  tensor(74.3731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(129.4532, device='cuda:3')
distance x is tensor(129.4532, device='cuda:3')
________________________________
test distance is  tensor(129.4532, device='cuda:3')
test distance1 is  tensor(129.4532, device='cuda:3')
test similarity is  tensor(0.9938, device='cuda:3')
test acc is  0.28971666682300595
test loss is 1.3999324452394106
test entropy is  0.9359015817327032
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29600000016000005
mal loss is 1.4025853797793388
mal norm is  tensor(634.3008, device='cuda:3')
distance x is tensor(129.4618, device='cuda:3')
mal distance is  tensor(129.4618, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([694.9499, 503.3832, 396.0320, 590.7773, 384.4676, 429.4753, 396.4644,
        371.7159, 634.3008, 634.3008, 634.3008, 634.3008, 634.3008, 634.3008,
        634.3008, 634.3008, 634.3008, 634.3008, 634.3008, 634.3008],
       device='cuda:3')
sorted_norm is   tensor([371.7159, 384.4676, 396.0320, 396.4644, 429.4753, 503.3832, 590.7773,
        634.3008, 634.3008, 634.3008, 634.3008, 634.3008, 634.3008, 634.3008,
        634.3008, 634.3008, 634.3008, 634.3008, 634.3008, 694.9499],
       device='cuda:3')
used idx is  tensor([ 7,  4,  2,  6,  5,  1,  3, 19, 15, 17, 13,  9, 11, 10, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 76.54% 

Test Accuracy: 80.23% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9463927485048771
distance x is tensor(135.4239, device='cuda:3')
benign distance is  tensor(135.4239, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3895408622920513
distance x is tensor(115.0585, device='cuda:3')
benign distance is  tensor(115.0585, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6209336072206497
distance x is tensor(100.4577, device='cuda:3')
benign distance is  tensor(100.4577, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2752703577280045
distance x is tensor(151.1256, device='cuda:3')
benign distance is  tensor(151.1256, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.919631615281105
distance x is tensor(133.8804, device='cuda:3')
benign distance is  tensor(133.8804, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6802630349993706
distance x is tensor(107.9660, device='cuda:3')
benign distance is  tensor(107.9660, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.213027410209179
distance x is tensor(115.1589, device='cuda:3')
benign distance is  tensor(115.1589, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1097626239061356
distance x is tensor(98.9554, device='cuda:3')
benign distance is  tensor(98.9554, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(85.2356, device='cuda:3')
compute distance is  tensor(85.2356, device='cuda:3')
compute norm is  tensor(72.9314, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2991, device='cuda:3')
compute distance is  tensor(135.2991, device='cuda:3')
compute norm is  tensor(73.9186, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.7604, device='cuda:3')
compute distance is  tensor(96.7604, device='cuda:3')
compute norm is  tensor(73.0040, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.9165, device='cuda:3')
compute distance is  tensor(105.9165, device='cuda:3')
compute norm is  tensor(73.2999, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.9916, device='cuda:3')
compute distance is  tensor(95.9916, device='cuda:3')
compute norm is  tensor(72.9861, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.1552, device='cuda:3')
compute distance is  tensor(103.1552, device='cuda:3')
compute norm is  tensor(73.3101, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.7927, device='cuda:3')
compute distance is  tensor(118.7927, device='cuda:3')
compute norm is  tensor(73.5526, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.0003, device='cuda:3')
compute distance is  tensor(95.0003, device='cuda:3')
compute norm is  tensor(72.9685, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.3956, device='cuda:3')
compute distance is  tensor(111.3956, device='cuda:3')
compute norm is  tensor(73.3256, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2073, device='cuda:3')
compute distance is  tensor(122.2073, device='cuda:3')
compute norm is  tensor(73.5817, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.0848, device='cuda:3')
compute distance is  tensor(110.0848, device='cuda:3')
compute norm is  tensor(73.2500, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.1360, device='cuda:3')
compute distance is  tensor(144.1360, device='cuda:3')
compute norm is  tensor(74.3385, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.1360, device='cuda:3')
distance x is tensor(101656.4141, device='cuda:3')
distance x is tensor(101656.4141, device='cuda:3')
________________________________
test distance is  tensor(101656.4141, device='cuda:3')
test distance1 is  tensor(101656.4141, device='cuda:3')
test similarity is  tensor(0.7689, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107499245455862.17
test entropy is  0.0
________________________________
cal ratio is  0.03690157598780205
distance x is tensor(3751.2861, device='cuda:3')
cal_distance is  tensor(3751.2861, device='cuda:3')
cal ratio is  0.19209771780254337
distance x is tensor(720.6172, device='cuda:3')
cal_distance is  tensor(720.6172, device='cuda:3')
cal ratio is  0.43828842880027236
distance x is tensor(315.8407, device='cuda:3')
cal_distance is  tensor(315.8407, device='cuda:3')
cal ratio is  0.6620309067581868
distance x is tensor(209.0978, device='cuda:3')
cal_distance is  tensor(209.0978, device='cuda:3')
cal ratio is  0.8136499003914806
distance x is tensor(170.1333, device='cuda:3')
cal_distance is  tensor(170.1333, device='cuda:3')
cal ratio is  0.9020231497219332
distance x is tensor(153.4646, device='cuda:3')
cal_distance is  tensor(153.4646, device='cuda:3')
cal ratio is  0.9497476818400843
distance x is tensor(145.7528, device='cuda:3')
cal_distance is  tensor(145.7528, device='cuda:3')
cal ratio is  0.9745492615410687
distance x is tensor(142.0435, device='cuda:3')
cal_distance is  tensor(142.0435, device='cuda:3')
distance x is tensor(142.0435, device='cuda:3')
return_distance is  tensor(142.0435, device='cuda:3')
distance x is tensor(142.0345, device='cuda:3')
distance x is tensor(142.0345, device='cuda:3')
________________________________
test distance is  tensor(142.0345, device='cuda:3')
test distance1 is  tensor(142.0345, device='cuda:3')
test similarity is  tensor(0.9945, device='cuda:3')
test acc is  0.10470000015633196
test loss is 54.02914271324174
test entropy is  0.010109707896751741
________________________________
0
distance x is tensor(142.0345, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.010639427373351341
avg test loss is  53.951157937934404
avg accuracy is  0.34510000015634035
solo acc is  0.10528333348966529
compute similarity  is  tensor(0.9945, device='cuda:3')
compute_distance is  tensor(142.0345, device='cuda:3')
compute_norm is  tensor(79.3067, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.0825, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9449291815127391
avg test loss is  1.3953470296697068
avg accuracy is  0.536366666823009
solo acc is  0.2861166668230059
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(138.0825, device='cuda:3')
compute_norm is  tensor(78.9969, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(138.0825, device='cuda:3')
distance x is tensor(138.0825, device='cuda:3')
________________________________
test distance is  tensor(138.0825, device='cuda:3')
test distance1 is  tensor(138.0825, device='cuda:3')
test similarity is  tensor(0.9948, device='cuda:3')
test acc is  0.28761666682300596
test loss is 1.3969342029933483
test entropy is  0.9433057893440921
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.30100000016000006
mal loss is 1.3890564069151878
mal norm is  tensor(684.6923, device='cuda:3')
distance x is tensor(138.0911, device='cuda:3')
mal distance is  tensor(138.0911, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([562.1235, 468.3389, 410.7320, 602.5625, 532.3566, 421.2867, 449.7910,
        398.5865, 684.6923, 684.6923, 684.6923, 684.6923, 684.6923, 684.6923,
        684.6923, 684.6923, 684.6923, 684.6923, 684.6923, 684.6923, 931.8234,
        921.3237, 965.6299, 860.4945, 980.6224, 940.6960, 874.8373, 984.9853,
        853.0295, 816.8945, 864.3369, 818.3363, 829.5851, 761.8891, 774.1680,
        851.0316, 602.0585, 604.6881, 616.7752, 663.4502, 523.7688, 842.3317,
        764.1258, 623.8147, 581.2166, 608.7679, 476.7639, 574.1840, 699.3849,
        444.6623, 647.6718, 588.0962], device='cuda:3')
sorted_norm is   tensor([398.5865, 410.7320, 421.2867, 444.6623, 449.7910, 468.3389, 476.7639,
        523.7688, 532.3566, 562.1235, 574.1840, 581.2166, 588.0962, 602.0585,
        602.5625, 604.6881, 608.7679, 616.7752, 623.8147, 647.6718, 663.4502,
        684.6923, 684.6923, 684.6923, 684.6923, 684.6923, 684.6923, 684.6923,
        684.6923, 684.6923, 684.6923, 684.6923, 684.6923, 699.3849, 761.8891,
        764.1258, 774.1680, 816.8945, 818.3363, 829.5851, 842.3317, 851.0316,
        853.0295, 860.4945, 864.3369, 874.8373, 921.3237, 931.8234, 940.6960,
        965.6299, 980.6224, 984.9853], device='cuda:3')
used idx is  tensor([ 7,  2,  5, 49,  6,  1, 46, 40,  4,  0, 47, 44, 51, 36,  3, 37, 45, 38,
        43, 50, 39, 11,  8, 10, 19, 18, 16, 17, 13, 12, 14, 15,  9, 48, 33, 42,
        34, 29, 31, 32, 41], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 67.66% 

Test Accuracy: 80.26% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8432066589593887
distance x is tensor(136.4384, device='cuda:3')
benign distance is  tensor(136.4384, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.552509367465973
distance x is tensor(103.3789, device='cuda:3')
benign distance is  tensor(103.3789, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.383401159197092
distance x is tensor(94.2277, device='cuda:3')
benign distance is  tensor(94.2277, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.57357207685709
distance x is tensor(127.6164, device='cuda:3')
benign distance is  tensor(127.6164, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.984182432293892
distance x is tensor(91.5142, device='cuda:3')
benign distance is  tensor(91.5142, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4869778975844383
distance x is tensor(102.2642, device='cuda:3')
benign distance is  tensor(102.2642, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9639705270528793
distance x is tensor(93.9131, device='cuda:3')
benign distance is  tensor(93.9131, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5306708104908466
distance x is tensor(86.4671, device='cuda:3')
benign distance is  tensor(86.4671, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9821510016918182
distance x is tensor(92.1046, device='cuda:3')
benign distance is  tensor(92.1046, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4372819885611534
distance x is tensor(150.0345, device='cuda:3')
benign distance is  tensor(150.0345, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.837734892964363
distance x is tensor(71.2699, device='cuda:3')
benign distance is  tensor(71.2699, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.8778090327978134
distance x is tensor(114.1810, device='cuda:3')
benign distance is  tensor(114.1810, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.0460977479815483
distance x is tensor(135.0538, device='cuda:3')
benign distance is  tensor(135.0538, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8161265328526497
distance x is tensor(69.1797, device='cuda:3')
benign distance is  tensor(69.1797, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6171232163906097
distance x is tensor(135.6958, device='cuda:3')
benign distance is  tensor(135.6958, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.189133733510971
distance x is tensor(128.9232, device='cuda:3')
benign distance is  tensor(128.9232, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.4994296431541443
distance x is tensor(91.4496, device='cuda:3')
benign distance is  tensor(91.4496, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.5548577941954136
distance x is tensor(106.0885, device='cuda:3')
benign distance is  tensor(106.0885, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.0216548815369606
distance x is tensor(108.7898, device='cuda:3')
benign distance is  tensor(108.7898, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.6285352259874344
distance x is tensor(112.8199, device='cuda:3')
benign distance is  tensor(112.8199, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.193444073200226
distance x is tensor(86.3562, device='cuda:3')
benign distance is  tensor(86.3562, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3887717574834824
distance x is tensor(175.3029, device='cuda:3')
benign distance is  tensor(175.3029, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4807666949927807
distance x is tensor(157.9422, device='cuda:3')
benign distance is  tensor(157.9422, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4605120532214642
distance x is tensor(111.6287, device='cuda:3')
benign distance is  tensor(111.6287, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9771600291132927
distance x is tensor(128.3573, device='cuda:3')
benign distance is  tensor(128.3573, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.260273389518261
distance x is tensor(114.5391, device='cuda:3')
benign distance is  tensor(114.5391, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.7171096950769424
distance x is tensor(110.5775, device='cuda:3')
benign distance is  tensor(110.5775, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.3070474714040756
distance x is tensor(104.2865, device='cuda:3')
benign distance is  tensor(104.2865, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.5607347786426544
distance x is tensor(112.0521, device='cuda:3')
benign distance is  tensor(112.0521, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.812111735343933
distance x is tensor(77.3249, device='cuda:3')
benign distance is  tensor(77.3249, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.062274418771267
distance x is tensor(84.0399, device='cuda:3')
benign distance is  tensor(84.0399, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8250680677592754
distance x is tensor(130.5609, device='cuda:3')
benign distance is  tensor(130.5609, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.9967209696769714
distance x is tensor(97.5724, device='cuda:3')
benign distance is  tensor(97.5724, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.8313145339488983
distance x is tensor(149.9678, device='cuda:3')
benign distance is  tensor(149.9678, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.160454176366329
distance x is tensor(133.9037, device='cuda:3')
benign distance is  tensor(133.9037, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  3.212035194039345
distance x is tensor(90.2632, device='cuda:3')
benign distance is  tensor(90.2632, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.9081443920731544
distance x is tensor(143.0781, device='cuda:3')
benign distance is  tensor(143.0781, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.180939480662346
distance x is tensor(133.4794, device='cuda:3')
benign distance is  tensor(133.4794, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.450072143226862
distance x is tensor(80.7417, device='cuda:3')
benign distance is  tensor(80.7417, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6123673841357231
distance x is tensor(134.7529, device='cuda:3')
benign distance is  tensor(134.7529, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(81.9280, device='cuda:3')
compute distance is  tensor(81.9280, device='cuda:3')
compute norm is  tensor(72.8095, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5661, device='cuda:3')
compute distance is  tensor(141.5661, device='cuda:3')
compute norm is  tensor(73.8152, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.2833, device='cuda:3')
compute distance is  tensor(93.2833, device='cuda:3')
compute norm is  tensor(72.9071, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.9092, device='cuda:3')
compute distance is  tensor(95.9092, device='cuda:3')
compute norm is  tensor(72.9678, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.5753, device='cuda:3')
compute distance is  tensor(92.5753, device='cuda:3')
compute norm is  tensor(72.8154, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.1426, device='cuda:3')
compute distance is  tensor(99.1426, device='cuda:3')
compute norm is  tensor(73.1314, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.1121, device='cuda:3')
compute distance is  tensor(120.1121, device='cuda:3')
compute norm is  tensor(73.6387, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.6221, device='cuda:3')
compute distance is  tensor(86.6221, device='cuda:3')
compute norm is  tensor(72.7740, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.6651, device='cuda:3')
compute distance is  tensor(103.6651, device='cuda:3')
compute norm is  tensor(73.1252, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.4337, device='cuda:3')
compute distance is  tensor(97.4337, device='cuda:3')
compute norm is  tensor(73.0335, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.9877, device='cuda:3')
compute distance is  tensor(94.9877, device='cuda:3')
compute norm is  tensor(72.9231, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7180, device='cuda:3')
compute distance is  tensor(126.7180, device='cuda:3')
compute norm is  tensor(73.9076, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.5661, device='cuda:3')
distance x is tensor(101669.9688, device='cuda:3')
distance x is tensor(101669.9688, device='cuda:3')
________________________________
test distance is  tensor(101669.9688, device='cuda:3')
test distance1 is  tensor(101669.9688, device='cuda:3')
test similarity is  tensor(0.7610, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107638292804186.61
test entropy is  0.0
________________________________
cal ratio is  0.03656868904219138
distance x is tensor(3717.9426, device='cuda:3')
cal_distance is  tensor(3717.9426, device='cuda:3')
cal ratio is  0.191229285640834
distance x is tensor(710.9832, device='cuda:3')
cal_distance is  tensor(710.9832, device='cuda:3')
cal ratio is  0.4372965738856561
distance x is tensor(310.9130, device='cuda:3')
cal_distance is  tensor(310.9130, device='cuda:3')
cal ratio is  0.6612814126729055
distance x is tensor(205.6025, device='cuda:3')
cal_distance is  tensor(205.6025, device='cuda:3')
cal ratio is  0.813189120861523
distance x is tensor(167.1946, device='cuda:3')
cal_distance is  tensor(167.1946, device='cuda:3')
cal ratio is  0.9017676467739326
distance x is tensor(150.7711, device='cuda:3')
cal_distance is  tensor(150.7711, device='cuda:3')
cal ratio is  0.949613022038162
distance x is tensor(143.1744, device='cuda:3')
cal_distance is  tensor(143.1744, device='cuda:3')
cal ratio is  0.9744801817249344
distance x is tensor(139.5208, device='cuda:3')
cal_distance is  tensor(139.5208, device='cuda:3')
distance x is tensor(139.5208, device='cuda:3')
return_distance is  tensor(139.5208, device='cuda:3')
distance x is tensor(139.5118, device='cuda:3')
distance x is tensor(139.5118, device='cuda:3')
________________________________
test distance is  tensor(139.5118, device='cuda:3')
test distance1 is  tensor(139.5118, device='cuda:3')
test similarity is  tensor(0.9945, device='cuda:3')
test acc is  0.23975000015633796
test loss is 19.337214216748787
test entropy is  0.12518289647916994
________________________________
0
distance x is tensor(139.5118, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.12335654546711236
avg test loss is  19.251889612120607
avg accuracy is  0.6635333334896663
solo acc is  0.24135000015633798
compute similarity  is  tensor(0.9945, device='cuda:3')
compute_distance is  tensor(139.5118, device='cuda:3')
compute_norm is  tensor(79.0039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.5082, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9404250855511948
avg test loss is  1.3961998236967301
avg accuracy is  0.6928000001563311
solo acc is  0.29213333348967274
compute similarity  is  tensor(0.9945, device='cuda:3')
compute_distance is  tensor(137.5082, device='cuda:3')
compute_norm is  tensor(78.5645, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(137.5082, device='cuda:3')
distance x is tensor(137.5082, device='cuda:3')
________________________________
test distance is  tensor(137.5082, device='cuda:3')
test distance1 is  tensor(137.5082, device='cuda:3')
test similarity is  tensor(0.9945, device='cuda:3')
test acc is  0.2901000001563393
test loss is 1.397006288901575
test entropy is  0.9404299663328158
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.30600000016000006
mal loss is 1.387086734175682
mal norm is  tensor(676.3741, device='cuda:3')
distance x is tensor(137.5169, device='cuda:3')
mal distance is  tensor(137.5169, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([564.7899, 442.2181, 393.8233, 523.1944, 373.0205, 415.5347, 389.5309,
        362.1443, 676.3741, 676.3741, 676.3741, 676.3741, 676.3741, 676.3741,
        676.3741, 676.3741, 676.3741, 676.3741, 676.3741, 676.3741],
       device='cuda:3')
sorted_norm is   tensor([362.1443, 373.0205, 389.5309, 393.8233, 415.5347, 442.2181, 523.1944,
        564.7899, 676.3741, 676.3741, 676.3741, 676.3741, 676.3741, 676.3741,
        676.3741, 676.3741, 676.3741, 676.3741, 676.3741, 676.3741],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  2,  5,  1,  3,  0, 18, 16, 12, 14, 10,  8, 17, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 79.76% 

Test Accuracy: 81.06% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7935329005122185
distance x is tensor(139.6178, device='cuda:3')
benign distance is  tensor(139.6178, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.320849195122719
distance x is tensor(109.6315, device='cuda:3')
benign distance is  tensor(109.6315, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8207155466079712
distance x is tensor(105.5774, device='cuda:3')
benign distance is  tensor(105.5774, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.1762217059731483
distance x is tensor(138.4815, device='cuda:3')
benign distance is  tensor(138.4815, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9348056390881538
distance x is tensor(115.5877, device='cuda:3')
benign distance is  tensor(115.5877, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7170720249414444
distance x is tensor(105.3985, device='cuda:3')
benign distance is  tensor(105.3985, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.568498007953167
distance x is tensor(105.0160, device='cuda:3')
benign distance is  tensor(105.0160, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.561550047248602
distance x is tensor(100.3660, device='cuda:3')
benign distance is  tensor(100.3660, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.8852, device='cuda:3')
compute distance is  tensor(104.8852, device='cuda:3')
compute norm is  tensor(76.6117, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.7338, device='cuda:3')
compute distance is  tensor(134.7338, device='cuda:3')
compute norm is  tensor(77.2190, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2624, device='cuda:3')
compute distance is  tensor(135.2624, device='cuda:3')
compute norm is  tensor(77.9940, device='cuda:3', dtype=torch.float64)
distance x is tensor(227.2402, device='cuda:3')
compute distance is  tensor(227.2402, device='cuda:3')
compute norm is  tensor(81.1099, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.7329, device='cuda:3')
compute distance is  tensor(105.7329, device='cuda:3')
compute norm is  tensor(76.5453, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.2851, device='cuda:3')
compute distance is  tensor(112.2851, device='cuda:3')
compute norm is  tensor(76.7303, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9785, device='cuda:3')
compute distance is  tensor(116.9785, device='cuda:3')
compute norm is  tensor(76.9475, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.0589, device='cuda:3')
compute distance is  tensor(91.0589, device='cuda:3')
compute norm is  tensor(76.4190, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.7671, device='cuda:3')
compute distance is  tensor(110.7671, device='cuda:3')
compute norm is  tensor(76.9453, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2327, device='cuda:3')
compute distance is  tensor(126.2327, device='cuda:3')
compute norm is  tensor(77.3903, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.6286, device='cuda:3')
compute distance is  tensor(178.6286, device='cuda:3')
compute norm is  tensor(78.5212, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.3424, device='cuda:3')
compute distance is  tensor(168.3424, device='cuda:3')
compute norm is  tensor(78.4837, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(227.2402, device='cuda:3')
distance x is tensor(101613.2578, device='cuda:3')
distance x is tensor(101613.2578, device='cuda:3')
________________________________
test distance is  tensor(101613.2578, device='cuda:3')
test distance1 is  tensor(101613.2578, device='cuda:3')
test similarity is  tensor(0.7891, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107590470119083.39
test entropy is  0.0
________________________________
cal ratio is  0.04634399066203092
distance x is tensor(4709.1694, device='cuda:3')
cal_distance is  tensor(4709.1694, device='cuda:3')
cal ratio is  0.215276421550654
distance x is tensor(1013.7766, device='cuda:3')
cal_distance is  tensor(1013.7766, device='cuda:3')
cal ratio is  0.4639781181220602
distance x is tensor(470.3725, device='cuda:3')
cal_distance is  tensor(470.3725, device='cuda:3')
cal ratio is  0.6811576638422112
distance x is tensor(320.3993, device='cuda:3')
cal_distance is  tensor(320.3993, device='cuda:3')
cal ratio is  0.825320925310282
distance x is tensor(264.4330, device='cuda:3')
cal_distance is  tensor(264.4330, device='cuda:3')
cal ratio is  0.9084703576753216
distance x is tensor(240.2299, device='cuda:3')
cal_distance is  tensor(240.2299, device='cuda:3')
cal ratio is  0.9531363718949105
distance x is tensor(228.9721, device='cuda:3')
cal_distance is  tensor(228.9721, device='cuda:3')
cal ratio is  0.9762865712719347
distance x is tensor(223.5425, device='cuda:3')
cal_distance is  tensor(223.5425, device='cuda:3')
distance x is tensor(223.5425, device='cuda:3')
return_distance is  tensor(223.5425, device='cuda:3')
distance x is tensor(223.5336, device='cuda:3')
distance x is tensor(223.5336, device='cuda:3')
________________________________
test distance is  tensor(223.5336, device='cuda:3')
test distance1 is  tensor(223.5336, device='cuda:3')
test similarity is  tensor(0.9903, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1750.410596900403
test entropy is  5.0497446564115424e-30
________________________________
0
distance x is tensor(223.5336, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.3081859086913568e-29
avg test loss is  1747.503461955707
avg accuracy is  0.1127166668229986
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9903, device='cuda:3')
compute_distance is  tensor(223.5336, device='cuda:3')
compute_norm is  tensor(87.5862, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(226181.3125, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.532905801781205
avg test loss is  2.9483469434892697
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1833, device='cuda:3')
compute_distance is  tensor(226181.3125, device='cuda:3')
compute_norm is  tensor(17335.4002, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(225125.2188, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8216833704188943
avg test loss is  3.7036360387863128
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1833, device='cuda:3')
compute_distance is  tensor(225125.2188, device='cuda:3')
compute_norm is  tensor(17254.3824, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(224074.1562, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.55437778130269
avg test loss is  2.8717450289838093
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1833, device='cuda:3')
compute_distance is  tensor(224074.1562, device='cuda:3')
compute_norm is  tensor(17173.4492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(223027.8906, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8282728769631782
avg test loss is  3.649756485973594
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1833, device='cuda:3')
compute_distance is  tensor(223027.8906, device='cuda:3')
compute_norm is  tensor(17093.2385, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(221986.5156, device='cuda:3')
distance x is tensor(221986.5156, device='cuda:3')
________________________________
test distance is  tensor(221986.5156, device='cuda:3')
test distance1 is  tensor(221986.5156, device='cuda:3')
test similarity is  tensor(-0.1833, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8650138708574175
test entropy is  1.5549657344818115
________________________________
cal ratio is  0.0313548923679211
distance x is tensor(6960.3604, device='cuda:3')
cal_distance is  tensor(6960.3604, device='cuda:3')
cal ratio is  0.17707316983919955
distance x is tensor(1232.4904, device='cuda:3')
cal_distance is  tensor(1232.4904, device='cuda:3')
cal ratio is  0.4208010842514098
distance x is tensor(518.6317, device='cuda:3')
cal_distance is  tensor(518.6317, device='cuda:3')
cal ratio is  0.6486928375874297
distance x is tensor(336.4318, device='cuda:3')
cal_distance is  tensor(336.4318, device='cuda:3')
cal ratio is  0.8054156819278507
distance x is tensor(270.9670, device='cuda:3')
cal_distance is  tensor(270.9670, device='cuda:3')
cal ratio is  0.8974502502269971
distance x is tensor(243.1793, device='cuda:3')
cal_distance is  tensor(243.1793, device='cuda:3')
cal ratio is  0.9473388235601738
distance x is tensor(230.3731, device='cuda:3')
cal_distance is  tensor(230.3731, device='cuda:3')
cal ratio is  0.9733135439355737
distance x is tensor(224.2252, device='cuda:3')
cal_distance is  tensor(224.2252, device='cuda:3')
distance x is tensor(224.2252, device='cuda:3')
return_distance is  tensor(224.2252, device='cuda:3')
distance x is tensor(224.2323, device='cuda:3')
distance x is tensor(224.2323, device='cuda:3')
________________________________
test distance is  tensor(224.2323, device='cuda:3')
test distance1 is  tensor(224.2323, device='cuda:3')
test similarity is  tensor(0.9753, device='cuda:3')
test acc is  0.10655000015633195
test loss is 9732.589030121435
test entropy is  0.05263242688503706
________________________________
0
distance x is tensor(224.2323, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.05121036430609926
avg test loss is  9725.617865263526
avg accuracy is  0.1038833334896653
solo acc is  0.10665000015633196
compute similarity  is  tensor(0.9753, device='cuda:3')
compute_distance is  tensor(224.2323, device='cuda:3')
compute_norm is  tensor(76.8552, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(877.9562, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3176270315387864
avg test loss is  2.4146215343780355
avg accuracy is  0.2474666668230049
solo acc is  0.1440000001563326
compute similarity  is  tensor(0.7440, device='cuda:3')
compute_distance is  tensor(877.9562, device='cuda:3')
compute_norm is  tensor(105.8858, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(876.6234, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7554500784828211
avg test loss is  3.1506221134271195
avg accuracy is  0.25560000015633844
solo acc is  0.10346666682299864
compute similarity  is  tensor(0.7440, device='cuda:3')
compute_distance is  tensor(876.6234, device='cuda:3')
compute_norm is  tensor(105.5231, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(875.7606, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2923136431016902
avg test loss is  2.2943682570193116
avg accuracy is  0.23065000015633755
solo acc is  0.1127166668229986
compute similarity  is  tensor(0.7438, device='cuda:3')
compute_distance is  tensor(875.7606, device='cuda:3')
compute_norm is  tensor(104.8989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(874.2382, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7576535034662625
avg test loss is  2.7949684375384725
avg accuracy is  0.2292333334896709
solo acc is  0.1012333334896653
compute similarity  is  tensor(0.7438, device='cuda:3')
compute_distance is  tensor(874.2382, device='cuda:3')
compute_norm is  tensor(104.5279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(872.7997, device='cuda:3')
distance x is tensor(872.7997, device='cuda:3')
________________________________
test distance is  tensor(872.7997, device='cuda:3')
test distance1 is  tensor(872.7997, device='cuda:3')
test similarity is  tensor(0.7437, device='cuda:3')
test acc is  0.11285000015633194
test loss is 2.196769627045467
test entropy is  1.1811273188224987
________________________________
cal ratio is  0.5000475688717697
distance x is tensor(436.4363, device='cuda:3')
cal_distance is  tensor(436.4363, device='cuda:3')
cal ratio is  0.7071445071055276
distance x is tensor(308.6225, device='cuda:3')
cal_distance is  tensor(308.6225, device='cuda:3')
cal ratio is  0.8409202474116475
distance x is tensor(259.5264, device='cuda:3')
cal_distance is  tensor(259.5264, device='cuda:3')
cal ratio is  0.9170179851311621
distance x is tensor(237.9901, device='cuda:3')
cal_distance is  tensor(237.9901, device='cuda:3')
cal ratio is  0.9576110652048654
distance x is tensor(227.9018, device='cuda:3')
cal_distance is  tensor(227.9018, device='cuda:3')
cal ratio is  0.9785763281962078
distance x is tensor(223.0192, device='cuda:3')
cal_distance is  tensor(223.0192, device='cuda:3')
distance x is tensor(223.0192, device='cuda:3')
return_distance is  tensor(223.0192, device='cuda:3')
distance x is tensor(223.0260, device='cuda:3')
distance x is tensor(223.0260, device='cuda:3')
________________________________
test distance is  tensor(223.0260, device='cuda:3')
test distance1 is  tensor(223.0260, device='cuda:3')
test similarity is  tensor(0.9798, device='cuda:3')
test acc is  0.12288333348966525
test loss is 433.6195428518852
test entropy is  0.052615346456097445
________________________________
0
distance x is tensor(223.0260, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.05206262521953641
avg test loss is  432.77583306481336
avg accuracy is  0.19730000015633625
solo acc is  0.1224166668229986
compute similarity  is  tensor(0.9798, device='cuda:3')
compute_distance is  tensor(223.0260, device='cuda:3')
compute_norm is  tensor(76.8150, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1073.1090, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5427392761844563
avg test loss is  2.8911795036625
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5766, device='cuda:3')
compute_distance is  tensor(1073.1090, device='cuda:3')
compute_norm is  tensor(131.5666, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1069.9462, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8236167791809863
avg test loss is  3.6572294802045517
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5767, device='cuda:3')
compute_distance is  tensor(1069.9462, device='cuda:3')
compute_norm is  tensor(131.1069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1066.5308, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5435240142889368
avg test loss is  2.88304036080456
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5765, device='cuda:3')
compute_distance is  tensor(1066.5308, device='cuda:3')
compute_norm is  tensor(130.2727, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1063.5651, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8311631458400409
avg test loss is  3.60403749200581
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5766, device='cuda:3')
compute_distance is  tensor(1063.5651, device='cuda:3')
compute_norm is  tensor(129.8231, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1060.6238, device='cuda:3')
________________________________
test distance is  tensor(1060.6238, device='cuda:3')
test similarity is  tensor(0.5764, device='cuda:3')
test acc is  0.10005000015633199
test loss is 2.870969244157836
test entropy is  1.553498299391285
________________________________
final entropy
distance x is tensor(1060.6288, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5536182280034145
avg test loss is  2.8700132502167466
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5764, device='cuda:3')
compute_distance is  tensor(1060.6288, device='cuda:3')
compute_norm is  tensor(129.0169, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.6025291681289673
mal norm is  tensor(5090.3696, device='cuda:3')
distance x is tensor(1057.7260, device='cuda:3')
mal distance is  tensor(1057.7260, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 571.9114,  453.5996,  439.5564,  566.1185,  472.3065,  413.4627,
         418.2833,  405.7277, 5090.3691, 5090.3696, 5090.3691, 5090.3696,
        5090.3691, 5090.3696, 5090.3691, 5090.3696, 5090.3691, 5090.3696,
        5090.3691, 5090.3696,  786.5922,  737.2540,  804.8671,  760.8497,
         781.9285,  798.8863,  834.9899,  883.1575,  520.4998,  712.9872,
         455.7201,  592.7161,  662.3386,  451.2443,  660.5150,  625.8234],
       device='cuda:3')
sorted_norm is   tensor([ 405.7277,  413.4627,  418.2833,  439.5564,  451.2443,  453.5996,
         455.7201,  472.3065,  520.4998,  566.1185,  571.9114,  592.7161,
         625.8234,  660.5150,  662.3386,  712.9872,  737.2540,  760.8497,
         781.9285,  786.5922,  798.8863,  804.8671,  834.9899,  883.1575,
        5090.3691, 5090.3691, 5090.3691, 5090.3691, 5090.3691, 5090.3691,
        5090.3696, 5090.3696, 5090.3696, 5090.3696, 5090.3696, 5090.3696],
       device='cuda:3')
used idx is  tensor([ 7,  5,  6,  2, 33,  1, 30,  4, 28,  3,  0, 31, 35, 34, 32, 29, 21, 23,
        24, 20, 25, 22, 26, 27, 10,  8, 18, 16], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 0.01% 

Test Accuracy: 15.93% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  3.015877842903137
distance x is tensor(20386.6738, device='cuda:3')
benign distance is  tensor(20386.6738, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3487277030944824
distance x is tensor(70231.5312, device='cuda:3')
benign distance is  tensor(70231.5312, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.346744030714035
distance x is tensor(360.7542, device='cuda:3')
benign distance is  tensor(360.7542, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.969431594014168
distance x is tensor(466380.3125, device='cuda:3')
benign distance is  tensor(466380.3125, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1781378239393234
distance x is tensor(164937.6250, device='cuda:3')
benign distance is  tensor(164937.6250, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.696456328034401
distance x is tensor(83278.3047, device='cuda:3')
benign distance is  tensor(83278.3047, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0346777588129044
distance x is tensor(185261.4062, device='cuda:3')
benign distance is  tensor(185261.4062, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9556533843278885
distance x is tensor(15253.2627, device='cuda:3')
benign distance is  tensor(15253.2627, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.131959483027458
distance x is tensor(29074610., device='cuda:3')
benign distance is  tensor(29074610., device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.9247111827135086
distance x is tensor(686.0066, device='cuda:3')
benign distance is  tensor(686.0066, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.2793015837669373
distance x is tensor(134150.5625, device='cuda:3')
benign distance is  tensor(134150.5625, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.497194081544876
distance x is tensor(13169.5107, device='cuda:3')
benign distance is  tensor(13169.5107, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.1416036635637283
distance x is tensor(151896.2969, device='cuda:3')
benign distance is  tensor(151896.2969, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.7081849724054337
distance x is tensor(97248., device='cuda:3')
benign distance is  tensor(97248., device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.6828671991825104
distance x is tensor(34081.6680, device='cuda:3')
benign distance is  tensor(34081.6680, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.4655799716711044
distance x is tensor(9866.7812, device='cuda:3')
benign distance is  tensor(9866.7812, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.981450840830803
distance x is tensor(18490.2910, device='cuda:3')
benign distance is  tensor(18490.2910, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  4.442219495773315
distance x is tensor(38530.8516, device='cuda:3')
benign distance is  tensor(38530.8516, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:3')
benign distance is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.4808328598737717
distance x is tensor(4208.2725, device='cuda:3')
benign distance is  tensor(4208.2725, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.658384934067726
distance x is tensor(5.6938e+10, device='cuda:3')
benign distance is  tensor(5.6938e+10, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  3.000869572162628
distance x is tensor(42934.3125, device='cuda:3')
benign distance is  tensor(42934.3125, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.6479820907115936
distance x is tensor(132081.5469, device='cuda:3')
benign distance is  tensor(132081.5469, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.3970627933740616
distance x is tensor(1094.1110, device='cuda:3')
benign distance is  tensor(1094.1110, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(25285.9902, device='cuda:3')
compute distance is  tensor(25285.9902, device='cuda:3')
compute norm is  tensor(2688.3204, device='cuda:3', dtype=torch.float64)
distance x is tensor(380855.0938, device='cuda:3')
compute distance is  tensor(380855.0938, device='cuda:3')
compute norm is  tensor(28957.8725, device='cuda:3', dtype=torch.float64)
distance x is tensor(575.2392, device='cuda:3')
compute distance is  tensor(575.2392, device='cuda:3')
compute norm is  tensor(124.2130, device='cuda:3', dtype=torch.float64)
distance x is tensor(1152.3370, device='cuda:3')
compute distance is  tensor(1152.3370, device='cuda:3')
compute norm is  tensor(222.3706, device='cuda:3', dtype=torch.float64)
distance x is tensor(9643.0908, device='cuda:3')
compute distance is  tensor(9643.0908, device='cuda:3')
compute norm is  tensor(818.2086, device='cuda:3', dtype=torch.float64)
distance x is tensor(530149.5000, device='cuda:3')
compute distance is  tensor(530149.5000, device='cuda:3')
compute norm is  tensor(60437.7065, device='cuda:3', dtype=torch.float64)
distance x is tensor(319.8659, device='cuda:3')
compute distance is  tensor(319.8659, device='cuda:3')
compute norm is  tensor(94.8601, device='cuda:3', dtype=torch.float64)
distance x is tensor(nan, device='cuda:3')
compute distance is  tensor(nan, device='cuda:3')
compute norm is  tensor(nan, device='cuda:3', dtype=torch.float64)
distance x is tensor(21826.1719, device='cuda:3')
compute distance is  tensor(21826.1719, device='cuda:3')
compute norm is  tensor(1800.9408, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.3309e+08, device='cuda:3')
compute distance is  tensor(8.3309e+08, device='cuda:3')
compute norm is  tensor(3.1035e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(455640.6875, device='cuda:3')
compute distance is  tensor(455640.6875, device='cuda:3')
compute norm is  tensor(57112.6842, device='cuda:3', dtype=torch.float64)
distance x is tensor(614.7194, device='cuda:3')
compute distance is  tensor(614.7194, device='cuda:3')
compute norm is  tensor(131.1881, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(8.3309e+08, device='cuda:3')
distance x is tensor(101705.7812, device='cuda:3')
distance x is tensor(101705.7812, device='cuda:3')
________________________________
test distance is  tensor(101705.7812, device='cuda:3')
test distance1 is  tensor(101705.7812, device='cuda:3')
test similarity is  tensor(0.7253, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107535285983306.23
test entropy is  0.0
________________________________
0
distance x is tensor(101705.7812, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107569269960328.45
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7253, device='cuda:3')
compute_distance is  tensor(101705.7812, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.9230e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.212921137457588e-05
avg test loss is  25469.14695077156
avg accuracy is  0.10000000015633198
solo acc is  0.10003333348966531
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(2.9230e+10, device='cuda:3')
compute_norm is  tensor(3.5456e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.9093e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.165136196974244
avg test loss is  19266.360795107987
avg accuracy is  0.09966666682299866
solo acc is  0.09993333348966532
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(2.9093e+10, device='cuda:3')
compute_norm is  tensor(3.5290e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.8957e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6223531969066368
avg test loss is  33634.536373104114
avg accuracy is  0.10106666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(2.8957e+10, device='cuda:3')
compute_norm is  tensor(3.5125e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.8822e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2569016572127718
avg test loss is  11609.992711349083
avg accuracy is  0.09998333348966532
solo acc is  0.09995000015633197
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(2.8822e+10, device='cuda:3')
compute_norm is  tensor(3.4960e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.8687e+10, device='cuda:3')
distance x is tensor(2.8687e+10, device='cuda:3')
________________________________
test distance is  tensor(2.8687e+10, device='cuda:3')
test distance1 is  tensor(2.8687e+10, device='cuda:3')
test similarity is  tensor(-0.0439, device='cuda:3')
test acc is  0.10003333348966531
test loss is 13846.936837587784
test entropy is  0.6462157995843175
________________________________
cal ratio is  0.16700523624636057
distance x is tensor(4.7909e+09, device='cuda:3')
cal_distance is  tensor(4.7909e+09, device='cuda:3')
cal ratio is  0.4086627446086115
distance x is tensor(1.9578e+09, device='cuda:3')
cal_distance is  tensor(1.9578e+09, device='cuda:3')
cal ratio is  0.6392673476475708
distance x is tensor(1.2516e+09, device='cuda:3')
cal_distance is  tensor(1.2516e+09, device='cuda:3')
cal ratio is  0.7995420121748433
distance x is tensor(1.0007e+09, device='cuda:3')
cal_distance is  tensor(1.0007e+09, device='cuda:3')
cal ratio is  0.8941711072479674
distance x is tensor(8.9479e+08, device='cuda:3')
cal_distance is  tensor(8.9479e+08, device='cuda:3')
cal ratio is  0.9456062032642957
distance x is tensor(8.4612e+08, device='cuda:3')
cal_distance is  tensor(8.4612e+08, device='cuda:3')
cal ratio is  0.9724228714117775
distance x is tensor(8.2279e+08, device='cuda:3')
cal_distance is  tensor(8.2279e+08, device='cuda:3')
distance x is tensor(8.2279e+08, device='cuda:3')
return_distance is  tensor(8.2279e+08, device='cuda:3')
distance x is tensor(8.2279e+08, device='cuda:3')
distance x is tensor(8.2279e+08, device='cuda:3')
________________________________
test distance is  tensor(8.2279e+08, device='cuda:3')
test distance1 is  tensor(8.2279e+08, device='cuda:3')
test similarity is  tensor(-0.0439, device='cuda:3')
test acc is  0.09811666682299865
test loss is 3834.6936221666683
test entropy is  1.8750715101959863
________________________________
0
distance x is tensor(8.2279e+08, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.875390538528784
avg test loss is  3396.310131456552
avg accuracy is  0.10140000015633197
solo acc is  0.10051666682299863
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(8.2279e+08, device='cuda:3')
compute_norm is  tensor(99802566.2842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.1894e+08, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7992557929014601
avg test loss is  4415.964043570734
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(8.1894e+08, device='cuda:3')
compute_norm is  tensor(99335593.8846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.1511e+08, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5431015021257055
avg test loss is  4702.673647993155
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(8.1511e+08, device='cuda:3')
compute_norm is  tensor(98870738.7419, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.1129e+08, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.825297117169732
avg test loss is  3014.786780533506
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(8.1129e+08, device='cuda:3')
compute_norm is  tensor(98408185.4204, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.0750e+08, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.548648314308256
avg test loss is  3255.3548441200114
avg accuracy is  0.10001666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(8.0750e+08, device='cuda:3')
compute_norm is  tensor(97947642.3256, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.0372e+08, device='cuda:3')
distance x is tensor(8.0372e+08, device='cuda:3')
________________________________
test distance is  tensor(8.0372e+08, device='cuda:3')
test distance1 is  tensor(8.0372e+08, device='cuda:3')
test similarity is  tensor(-0.0439, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2910.1262551327504
test entropy is  0.8254691704249839
________________________________
0
distance x is tensor(8.0372e+08, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8272914761292146
avg test loss is  2850.8683033912166
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(8.0372e+08, device='cuda:3')
compute_norm is  tensor(97489436.4269, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.9996e+08, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5506065753477214
avg test loss is  2873.993536807835
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(7.9996e+08, device='cuda:3')
compute_norm is  tensor(97033200.4736, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.9622e+08, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8302075740879279
avg test loss is  3377.534682165077
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(7.9622e+08, device='cuda:3')
compute_norm is  tensor(96579289.0308, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.9249e+08, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.551250787813272
avg test loss is  3998.784568053827
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(7.9249e+08, device='cuda:3')
compute_norm is  tensor(96127305.1447, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.8878e+08, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8325518003658954
avg test loss is  3575.6752914075914
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(7.8878e+08, device='cuda:3')
compute_norm is  tensor(95677579.0706, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.8509e+08, device='cuda:3')
________________________________
test distance is  tensor(7.8509e+08, device='cuda:3')
test similarity is  tensor(-0.0439, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2680.2786082128473
test entropy is  1.5537242027742268
________________________________
final entropy
distance x is tensor(7.8509e+08, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5530994545930483
avg test loss is  2983.868930662619
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0439, device='cuda:3')
compute_distance is  tensor(7.8509e+08, device='cuda:3')
compute_norm is  tensor(95229851.1911, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.5876821279525757
mal norm is  tensor(6.1056e+09, device='cuda:3')
distance x is tensor(7.8142e+08, device='cuda:3')
mal distance is  tensor(7.8142e+08, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([1.0066e+05, 2.8988e+05, 2.4263e+03, 6.3299e+06, 7.3085e+05, 4.4182e+05,
        1.4432e+06, 8.4784e+04, 6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09,
        6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09,
        6.1056e+09, 6.1056e+09, 8.1754e+02, 8.4110e+02, 8.5436e+02, 8.6311e+02,
        8.1335e+02, 9.9202e+02, 9.4826e+02, 8.5253e+02], device='cuda:3')
sorted_norm is   tensor([8.1335e+02, 8.1754e+02, 8.4110e+02, 8.5253e+02, 8.5436e+02, 8.6311e+02,
        9.4826e+02, 9.9202e+02, 2.4263e+03, 8.4784e+04, 1.0066e+05, 2.8988e+05,
        4.4182e+05, 7.3085e+05, 1.4432e+06, 6.3299e+06, 6.1056e+09, 6.1056e+09,
        6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09,
        6.1056e+09, 6.1056e+09, 6.1056e+09, 6.1056e+09], device='cuda:3')
used idx is  tensor([24, 20, 21, 27, 22, 23, 26, 25,  2,  7,  0,  1,  5,  4,  6,  3, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6796616315841675
distance x is tensor(5.2692, device='cuda:3')
benign distance is  tensor(5.2692, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.454653725028038
distance x is tensor(125141.9453, device='cuda:3')
benign distance is  tensor(125141.9453, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.4551133513450623
distance x is tensor(4.1313, device='cuda:3')
benign distance is  tensor(4.1313, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0515392422676086
distance x is tensor(6.8360, device='cuda:3')
benign distance is  tensor(6.8360, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.2342293709516525
distance x is tensor(5.6035, device='cuda:3')
benign distance is  tensor(5.6035, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.822459578514099
distance x is tensor(4.0496, device='cuda:3')
benign distance is  tensor(4.0496, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.080590084195137
distance x is tensor(288512.1875, device='cuda:3')
benign distance is  tensor(288512.1875, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.002689838409424
distance x is tensor(5.1725, device='cuda:3')
benign distance is  tensor(5.1725, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.458078756928444
distance x is tensor(6.0284, device='cuda:3')
benign distance is  tensor(6.0284, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.9911814481019974
distance x is tensor(4.9335, device='cuda:3')
benign distance is  tensor(4.9335, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.2946352511644363
distance x is tensor(8.0087, device='cuda:3')
benign distance is  tensor(8.0087, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.2067129015922546
distance x is tensor(438803.8750, device='cuda:3')
benign distance is  tensor(438803.8750, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.057570517063141
distance x is tensor(5.4261, device='cuda:3')
benign distance is  tensor(5.4261, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.8486429303884506
distance x is tensor(497346.4375, device='cuda:3')
benign distance is  tensor(497346.4375, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.07724429666996
distance x is tensor(8.0936, device='cuda:3')
benign distance is  tensor(8.0936, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.7719263583421707
distance x is tensor(502212.0312, device='cuda:3')
benign distance is  tensor(502212.0312, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(4.2355, device='cuda:3')
compute distance is  tensor(4.2355, device='cuda:3')
compute norm is  tensor(25850405.1829, device='cuda:3', dtype=torch.float64)
distance x is tensor(302756.6250, device='cuda:3')
compute distance is  tensor(302756.6250, device='cuda:3')
compute norm is  tensor(25852717.9609, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.5243, device='cuda:3')
compute distance is  tensor(4.5243, device='cuda:3')
compute norm is  tensor(25850405.4500, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.3254, device='cuda:3')
compute distance is  tensor(6.3254, device='cuda:3')
compute norm is  tensor(25850405.5018, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.3202, device='cuda:3')
compute distance is  tensor(6.3202, device='cuda:3')
compute norm is  tensor(25850405.5611, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.1736, device='cuda:3')
compute distance is  tensor(4.1736, device='cuda:3')
compute norm is  tensor(25850405.4734, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.5148, device='cuda:3')
compute distance is  tensor(6.5148, device='cuda:3')
compute norm is  tensor(25850405.6192, device='cuda:3', dtype=torch.float64)
distance x is tensor(285726.3750, device='cuda:3')
compute distance is  tensor(285726.3750, device='cuda:3')
compute norm is  tensor(25852136.1070, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.6777, device='cuda:3')
compute distance is  tensor(4.6777, device='cuda:3')
compute norm is  tensor(25850405.4831, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.3808, device='cuda:3')
compute distance is  tensor(6.3808, device='cuda:3')
compute norm is  tensor(25850405.7819, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.9767, device='cuda:3')
compute distance is  tensor(6.9767, device='cuda:3')
compute norm is  tensor(25850405.5778, device='cuda:3', dtype=torch.float64)
distance x is tensor(379411.0938, device='cuda:3')
compute distance is  tensor(379411.0938, device='cuda:3')
compute norm is  tensor(25854003.9166, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(379411.0938, device='cuda:3')
distance x is tensor(2.1321e+08, device='cuda:3')
distance x is tensor(2.1321e+08, device='cuda:3')
________________________________
test distance is  tensor(2.1321e+08, device='cuda:3')
test distance1 is  tensor(2.1321e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107610374926519.4
test entropy is  0.0
________________________________
cal ratio is  0.04134069393704454
distance x is tensor(8814231., device='cuda:3')
cal_distance is  tensor(8814231., device='cuda:3')
cal ratio is  0.20332410767061118
distance x is tensor(1792145.7500, device='cuda:3')
cal_distance is  tensor(1792145.7500, device='cuda:3')
cal ratio is  0.4509147371361455
distance x is tensor(808104.8125, device='cuda:3')
cal_distance is  tensor(808104.8125, device='cuda:3')
cal ratio is  0.6715018904234009
distance x is tensor(542643.7500, device='cuda:3')
cal_distance is  tensor(542643.7500, device='cuda:3')
cal ratio is  0.8194523145046294
distance x is tensor(444670.5938, device='cuda:3')
cal_distance is  tensor(444670.5938, device='cuda:3')
cal ratio is  0.9052361309508233
distance x is tensor(402532.0312, device='cuda:3')
cal_distance is  tensor(402532.0312, device='cuda:3')
cal ratio is  0.9514388275457976
distance x is tensor(382984.7500, device='cuda:3')
cal_distance is  tensor(382984.7500, device='cuda:3')
cal ratio is  0.9754170707689307
distance x is tensor(373569.8125, device='cuda:3')
cal_distance is  tensor(373569.8125, device='cuda:3')
distance x is tensor(373569.8125, device='cuda:3')
return_distance is  tensor(373569.8125, device='cuda:3')
distance x is tensor(373569.8125, device='cuda:3')
distance x is tensor(373569.8125, device='cuda:3')
________________________________
test distance is  tensor(373569.8125, device='cuda:3')
test distance1 is  tensor(373569.8125, device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.09955000015633199
test loss is 515.487409845344
test entropy is  2.0425604520830265
________________________________
0
distance x is tensor(373569.8125, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0426980244325423
avg test loss is  604.760653865617
avg accuracy is  0.10075000015633198
solo acc is  0.10003333348966531
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(373569.8125, device='cuda:3')
compute_norm is  tensor(25805099.4316, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1368940.3750, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8426279036093877
avg test loss is  659.0042248882972
avg accuracy is  0.10001666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(1368940.3750, device='cuda:3')
compute_norm is  tensor(25684379.3247, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2359747.7500, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.557834766948147
avg test loss is  378.77270313010797
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2359747.7500, device='cuda:3')
compute_norm is  tensor(25564185.5343, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3345905., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8372334534171294
avg test loss is  400.9062204726978
avg accuracy is  0.10001666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(3345905., device='cuda:3')
compute_norm is  tensor(25444578.9216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4327358.5000, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5561989433984005
avg test loss is  476.9293920508326
avg accuracy is  0.10001666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(4327358.5000, device='cuda:3')
compute_norm is  tensor(25325522.4648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5304327.5000, device='cuda:3')
distance x is tensor(5304327.5000, device='cuda:3')
________________________________
test distance is  tensor(5304327.5000, device='cuda:3')
test distance1 is  tensor(5304327.5000, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 540.278878478099
test entropy is  0.8402639814277193
________________________________
cal ratio is  0.2620993440644404
distance x is tensor(1390260.6250, device='cuda:3')
cal_distance is  tensor(1390260.6250, device='cuda:3')
cal ratio is  0.5119564013679736
distance x is tensor(711752.6875, device='cuda:3')
cal_distance is  tensor(711752.6875, device='cuda:3')
cal ratio is  0.7155113590079902
distance x is tensor(509267.2812, device='cuda:3')
cal_distance is  tensor(509267.2812, device='cuda:3')
cal ratio is  0.845878933872181
distance x is tensor(430778.0625, device='cuda:3')
cal_distance is  tensor(430778.0625, device='cuda:3')
cal ratio is  0.9197171766215758
distance x is tensor(396194.2812, device='cuda:3')
cal_distance is  tensor(396194.2812, device='cuda:3')
cal ratio is  0.9590184958546878
distance x is tensor(379957.6562, device='cuda:3')
cal_distance is  tensor(379957.6562, device='cuda:3')
cal ratio is  0.9792948820674354
distance x is tensor(372090.6562, device='cuda:3')
cal_distance is  tensor(372090.6562, device='cuda:3')
distance x is tensor(372090.6562, device='cuda:3')
return_distance is  tensor(372090.6562, device='cuda:3')
distance x is tensor(372090.6250, device='cuda:3')
distance x is tensor(372090.6250, device='cuda:3')
________________________________
test distance is  tensor(372090.6250, device='cuda:3')
test distance1 is  tensor(372090.6250, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10030000015633199
test loss is 526.9880868196487
test entropy is  2.027727394978375
________________________________
0
distance x is tensor(372090.6250, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.027707304908777
avg test loss is  544.5009298014488
avg accuracy is  0.10010000015633197
solo acc is  0.09991666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(372090.6250, device='cuda:3')
compute_norm is  tensor(25805273.2200, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1367468.5000, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8396077205631525
avg test loss is  444.4913978757126
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(1367468.5000, device='cuda:3')
compute_norm is  tensor(25684552.1032, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2358282.2500, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.557257528879495
avg test loss is  487.27075782742327
avg accuracy is  0.10001666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2358282.2500, device='cuda:3')
compute_norm is  tensor(25564357.6384, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3344446.5000, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8428968928261861
avg test loss is  518.9570652991216
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(3344446.5000, device='cuda:3')
compute_norm is  tensor(25444750.1472, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4325906., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5578405644847895
avg test loss is  482.2527553661546
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(4325906., device='cuda:3')
compute_norm is  tensor(25325692.8700, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5302881.5000, device='cuda:3')
distance x is tensor(5302881.5000, device='cuda:3')
________________________________
test distance is  tensor(5302881.5000, device='cuda:3')
test distance1 is  tensor(5302881.5000, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 388.5100187698661
test entropy is  0.8415774528914169
________________________________
cal ratio is  0.2621350648061471
distance x is tensor(1390071.3750, device='cuda:3')
cal_distance is  tensor(1390071.3750, device='cuda:3')
cal ratio is  0.5119912584441465
distance x is tensor(711704.5000, device='cuda:3')
cal_distance is  tensor(711704.5000, device='cuda:3')
cal ratio is  0.7155355600328125
distance x is tensor(509250., device='cuda:3')
cal_distance is  tensor(509250., device='cuda:3')
cal ratio is  0.8458932807111633
distance x is tensor(430771.2188, device='cuda:3')
cal_distance is  tensor(430771.2188, device='cuda:3')
cal ratio is  0.9197244899335132
distance x is tensor(396190.5938, device='cuda:3')
cal_distance is  tensor(396190.5938, device='cuda:3')
cal ratio is  0.959022972632311
distance x is tensor(379955.7500, device='cuda:3')
cal_distance is  tensor(379955.7500, device='cuda:3')
cal ratio is  0.9792973371579966
distance x is tensor(372089.5938, device='cuda:3')
cal_distance is  tensor(372089.5938, device='cuda:3')
distance x is tensor(372089.5938, device='cuda:3')
return_distance is  tensor(372089.5938, device='cuda:3')
distance x is tensor(372089.5938, device='cuda:3')
distance x is tensor(372089.5938, device='cuda:3')
________________________________
test distance is  tensor(372089.5938, device='cuda:3')
test distance1 is  tensor(372089.5938, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10045000015633197
test loss is 536.253076260278
test entropy is  2.028131332478798
________________________________
0
distance x is tensor(372089.5938, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.02808194119793
avg test loss is  628.6273300876495
avg accuracy is  0.09981666682299865
solo acc is  0.10011666682299863
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(372089.5938, device='cuda:3')
compute_norm is  tensor(25805272.8451, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1367467.3750, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8395776334983199
avg test loss is  504.4865083747835
avg accuracy is  0.10003333348966531
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(1367467.3750, device='cuda:3')
compute_norm is  tensor(25684551.7199, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2358281.5000, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5584453930224438
avg test loss is  528.5818290115674
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(2358281.5000, device='cuda:3')
compute_norm is  tensor(25564357.2517, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3344445.5000, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8408055682299234
avg test loss is  583.8730286275909
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(3344445.5000, device='cuda:3')
compute_norm is  tensor(25444749.7615, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4325905.5000, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.559829576564496
avg test loss is  487.6424563096276
avg accuracy is  0.10001666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(4325905.5000, device='cuda:3')
compute_norm is  tensor(25325692.5258, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5302880.5000, device='cuda:3')
________________________________
test distance is  tensor(5302880.5000, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10001666682299865
test loss is 515.4946928555523
test entropy is  0.8406646672342377
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.5818976908922195
mal norm is  tensor(41431788., device='cuda:3')
distance x is tensor(5302880.5000, device='cuda:3')
mal distance is  tensor(5302880.5000, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([1.8089e+02, 2.9394e+06, 1.5295e+02, 2.2810e+02, 2.0584e+02, 1.4896e+02,
        5.8909e+06, 1.8884e+02, 4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07,
        4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07,
        4.1432e+07, 4.1432e+07, 1.7077e+09, 1.6652e+09, 1.6652e+09, 1.6652e+09,
        1.6652e+09, 1.6652e+09, 1.6652e+09, 1.6652e+09], device='cuda:3')
sorted_norm is   tensor([1.4896e+02, 1.5295e+02, 1.8089e+02, 1.8884e+02, 2.0584e+02, 2.2810e+02,
        2.9394e+06, 5.8909e+06, 4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07,
        4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07, 4.1432e+07,
        4.1432e+07, 4.1432e+07, 1.6652e+09, 1.6652e+09, 1.6652e+09, 1.6652e+09,
        1.6652e+09, 1.6652e+09, 1.6652e+09, 1.7077e+09], device='cuda:3')
used idx is  tensor([ 5,  2,  0,  7,  4,  3,  1,  6, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 27, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.730465605854988
distance x is tensor(17.9757, device='cuda:3')
benign distance is  tensor(17.9757, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3484475761651993
distance x is tensor(21.8943, device='cuda:3')
benign distance is  tensor(21.8943, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.2916035503149033
distance x is tensor(9.9316, device='cuda:3')
benign distance is  tensor(9.9316, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0997426956892014
distance x is tensor(19.2368, device='cuda:3')
benign distance is  tensor(19.2368, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.198389306664467
distance x is tensor(18.9132, device='cuda:3')
benign distance is  tensor(18.9132, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.698416620492935
distance x is tensor(18.9568, device='cuda:3')
benign distance is  tensor(18.9568, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0976330041885376
distance x is tensor(20.1558, device='cuda:3')
benign distance is  tensor(20.1558, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9257248640060425
distance x is tensor(16.6488, device='cuda:3')
benign distance is  tensor(16.6488, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.064831033349037
distance x is tensor(26.3962, device='cuda:3')
benign distance is  tensor(26.3962, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.912041202187538
distance x is tensor(22.6942, device='cuda:3')
benign distance is  tensor(22.6942, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.302935317158699
distance x is tensor(18.7519, device='cuda:3')
benign distance is  tensor(18.7519, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.4461192935705185
distance x is tensor(28.6316, device='cuda:3')
benign distance is  tensor(28.6316, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.1619941145181656
distance x is tensor(21.6259, device='cuda:3')
benign distance is  tensor(21.6259, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.717917025089264
distance x is tensor(18.7788, device='cuda:3')
benign distance is  tensor(18.7788, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.7167992144823074
distance x is tensor(21.3904, device='cuda:3')
benign distance is  tensor(21.3904, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.4982889890670776
distance x is tensor(27.6444, device='cuda:3')
benign distance is  tensor(27.6444, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(20.1297, device='cuda:3')
compute distance is  tensor(20.1297, device='cuda:3')
compute norm is  tensor(23149533.7778, device='cuda:3', dtype=torch.float64)
distance x is tensor(19.3385, device='cuda:3')
compute distance is  tensor(19.3385, device='cuda:3')
compute norm is  tensor(23149534.8675, device='cuda:3', dtype=torch.float64)
distance x is tensor(19.3381, device='cuda:3')
compute distance is  tensor(19.3381, device='cuda:3')
compute norm is  tensor(23149534.5431, device='cuda:3', dtype=torch.float64)
distance x is tensor(20.1682, device='cuda:3')
compute distance is  tensor(20.1682, device='cuda:3')
compute norm is  tensor(23149534.5377, device='cuda:3', dtype=torch.float64)
distance x is tensor(15.9896, device='cuda:3')
compute distance is  tensor(15.9896, device='cuda:3')
compute norm is  tensor(23149534.4963, device='cuda:3', dtype=torch.float64)
distance x is tensor(25.2644, device='cuda:3')
compute distance is  tensor(25.2644, device='cuda:3')
compute norm is  tensor(23149534.5779, device='cuda:3', dtype=torch.float64)
distance x is tensor(28.5054, device='cuda:3')
compute distance is  tensor(28.5054, device='cuda:3')
compute norm is  tensor(23149534.5412, device='cuda:3', dtype=torch.float64)
distance x is tensor(20.3546, device='cuda:3')
compute distance is  tensor(20.3546, device='cuda:3')
compute norm is  tensor(23149534.5154, device='cuda:3', dtype=torch.float64)
distance x is tensor(22.5082, device='cuda:3')
compute distance is  tensor(22.5082, device='cuda:3')
compute norm is  tensor(23149534.5959, device='cuda:3', dtype=torch.float64)
distance x is tensor(25.3242, device='cuda:3')
compute distance is  tensor(25.3242, device='cuda:3')
compute norm is  tensor(23149534.6408, device='cuda:3', dtype=torch.float64)
distance x is tensor(20.5912, device='cuda:3')
compute distance is  tensor(20.5912, device='cuda:3')
compute norm is  tensor(23149534.3820, device='cuda:3', dtype=torch.float64)
distance x is tensor(25845510., device='cuda:3')
compute distance is  tensor(25845510., device='cuda:3')
compute norm is  tensor(31616395.9472, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(25845510., device='cuda:3')
distance x is tensor(1.9096e+08, device='cuda:3')
distance x is tensor(1.9096e+08, device='cuda:3')
________________________________
test distance is  tensor(1.9096e+08, device='cuda:3')
test distance1 is  tensor(1.9096e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107604352093780.06
test entropy is  0.0
________________________________
cal ratio is  0.36053600117165835
distance x is tensor(68847560., device='cuda:3')
cal_distance is  tensor(68847560., device='cuda:3')
cal ratio is  0.600446546800696
distance x is tensor(41339284., device='cuda:3')
cal_distance is  tensor(41339284., device='cuda:3')
cal ratio is  0.7748848059166541
distance x is tensor(32033184., device='cuda:3')
cal_distance is  tensor(32033184., device='cuda:3')
cal ratio is  0.8802754045578313
distance x is tensor(28198024., device='cuda:3')
cal_distance is  tensor(28198024., device='cuda:3')
cal ratio is  0.9382299496032717
distance x is tensor(26456232., device='cuda:3')
cal_distance is  tensor(26456232., device='cuda:3')
cal ratio is  0.9686226881356291
distance x is tensor(25626104., device='cuda:3')
cal_distance is  tensor(25626104., device='cuda:3')
distance x is tensor(25626104., device='cuda:3')
return_distance is  tensor(25626104., device='cuda:3')
distance x is tensor(25626104., device='cuda:3')
distance x is tensor(25626104., device='cuda:3')
________________________________
test distance is  tensor(25626104., device='cuda:3')
test distance1 is  tensor(25626104., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633201
test loss is 6013417.685994306
test entropy is  0.0010853163618634743
________________________________
0
distance x is tensor(25626104., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0012433106575806608
avg test loss is  4295063.969768902
avg accuracy is  0.10000000015633201
solo acc is  0.10000000015633201
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(25626104., device='cuda:3')
compute_norm is  tensor(20041989.8275, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(26399320., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5171455545211905
avg test loss is  4133882.8178451606
avg accuracy is  0.09993333348966535
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(26399320., device='cuda:3')
compute_norm is  tensor(19948194.8916, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(27168816., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0059176132495977
avg test loss is  3716581.7588354438
avg accuracy is  0.09978333348966535
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(27168816., device='cuda:3')
compute_norm is  tensor(19854869.0592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(27934770., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8800441726946882
avg test loss is  3116703.8033087025
avg accuracy is  0.09986666682299868
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(27934770., device='cuda:3')
compute_norm is  tensor(19761975.0250, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(28697118., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.479337815028518
avg test loss is  2725306.0541214524
avg accuracy is  0.09998333348966534
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(28697118., device='cuda:3')
compute_norm is  tensor(19669501.9541, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29455904., device='cuda:3')
distance x is tensor(29455904., device='cuda:3')
________________________________
test distance is  tensor(29455904., device='cuda:3')
test distance1 is  tensor(29455904., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10016666682299866
test loss is 5263745.996584477
test entropy is  1.0300464334010062
________________________________
cal ratio is  0.9179783810633814
distance x is tensor(27039884., device='cuda:3')
cal_distance is  tensor(27039884., device='cuda:3')
cal ratio is  0.9581118758709306
distance x is tensor(25907232., device='cuda:3')
cal_distance is  tensor(25907232., device='cuda:3')
cal ratio is  0.9788319290334443
distance x is tensor(25358828., device='cuda:3')
cal_distance is  tensor(25358828., device='cuda:3')
distance x is tensor(25358828., device='cuda:3')
return_distance is  tensor(25358828., device='cuda:3')
distance x is tensor(25358828., device='cuda:3')
distance x is tensor(25358828., device='cuda:3')
________________________________
test distance is  tensor(25358828., device='cuda:3')
test distance1 is  tensor(25358828., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10018333348966532
test loss is 3453593.6915678694
test entropy is  1.4367641727807425
________________________________
0
distance x is tensor(25358828., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4367047488562334
avg test loss is  2862214.546510511
avg accuracy is  0.10006666682299868
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(25358828., device='cuda:3')
compute_norm is  tensor(20074314.5897, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(26133248., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9431938659280602
avg test loss is  3355928.257922738
avg accuracy is  0.09981666682299867
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(26133248., device='cuda:3')
compute_norm is  tensor(19980378.4204, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(26904014., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.50343728141744
avg test loss is  3624059.4535797588
avg accuracy is  0.10005000015633202
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(26904014., device='cuda:3')
compute_norm is  tensor(19886901.1973, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(27671198., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0145094409934494
avg test loss is  6289323.11579137
avg accuracy is  0.100100000156332
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(27671198., device='cuda:3')
compute_norm is  tensor(19793854.4186, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(28434774., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8787108829407804
avg test loss is  3040500.7536555068
avg accuracy is  0.09958333348966535
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(28434774., device='cuda:3')
compute_norm is  tensor(19701236.0623, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(29194800., device='cuda:3')
distance x is tensor(29194800., device='cuda:3')
________________________________
test distance is  tensor(29194800., device='cuda:3')
test distance1 is  tensor(29194800., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10018333348966532
test loss is 3879061.61406655
test entropy is  1.4968649382784422
________________________________
cal ratio is  0.9220742181470203
distance x is tensor(26919770., device='cuda:3')
cal_distance is  tensor(26919770., device='cuda:3')
cal ratio is  0.9602470051496025
distance x is tensor(25849628., device='cuda:3')
cal_distance is  tensor(25849628., device='cuda:3')
cal ratio is  0.9799219285146387
distance x is tensor(25330618., device='cuda:3')
cal_distance is  tensor(25330618., device='cuda:3')
distance x is tensor(25330618., device='cuda:3')
return_distance is  tensor(25330618., device='cuda:3')
distance x is tensor(25330618., device='cuda:3')
distance x is tensor(25330618., device='cuda:3')
________________________________
test distance is  tensor(25330618., device='cuda:3')
test distance1 is  tensor(25330618., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10018333348966532
test loss is 5015993.9788265815
test entropy is  1.786309208824182
________________________________
0
distance x is tensor(25330618., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7863126270044078
avg test loss is  4555397.852658452
avg accuracy is  0.09998333348966534
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(25330618., device='cuda:3')
compute_norm is  tensor(20077669.4863, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(26105162., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0366272392557627
avg test loss is  3651081.6202089866
avg accuracy is  0.10001666682299866
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(26105162., device='cuda:3')
compute_norm is  tensor(19983719.4383, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(26876066., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8793184926896207
avg test loss is  3348487.4070400293
avg accuracy is  0.100200000156332
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(26876066., device='cuda:3')
compute_norm is  tensor(19890225.7727, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(27643382., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5090302448791226
avg test loss is  3079541.908135309
avg accuracy is  0.09998333348966534
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(27643382., device='cuda:3')
compute_norm is  tensor(19797162.5623, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(28407086., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9998475806926613
avg test loss is  3484525.9466745155
avg accuracy is  0.09986666682299868
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(28407086., device='cuda:3')
compute_norm is  tensor(19704529.8331, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(29167242., device='cuda:3')
________________________________
test distance is  tensor(29167242., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.09998333348966534
test loss is 4043167.7456494663
test entropy is  1.5156354735146707
________________________________
final entropy
distance x is tensor(29167242., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5158758985716652
avg test loss is  3149744.5447842455
avg accuracy is  0.10003333348966534
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(29167242., device='cuda:3')
compute_norm is  tensor(19612334.8001, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.3448372334241867
mal norm is  tensor(2.3372e+08, device='cuda:3')
distance x is tensor(29923810., device='cuda:3')
mal distance is  tensor(29923810., device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([1.3377e+03, 1.7410e+03, 6.5124e+02, 1.3736e+03, 1.4642e+03, 1.6050e+03,
        1.5279e+03, 1.2824e+03, 2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08,
        2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08,
        2.3372e+08, 2.3372e+08, 1.4912e+09, 1.4912e+09, 1.4912e+09, 1.4912e+09,
        1.4912e+09, 1.4912e+09, 1.4912e+09, 1.4912e+09], device='cuda:3')
sorted_norm is   tensor([6.5124e+02, 1.2824e+03, 1.3377e+03, 1.3736e+03, 1.4642e+03, 1.5279e+03,
        1.6050e+03, 1.7410e+03, 2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08,
        2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08, 2.3372e+08,
        2.3372e+08, 2.3372e+08, 1.4912e+09, 1.4912e+09, 1.4912e+09, 1.4912e+09,
        1.4912e+09, 1.4912e+09, 1.4912e+09, 1.4912e+09], device='cuda:3')
used idx is  tensor([ 2,  7,  0,  3,  4,  6,  5,  1, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 25, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6738404035568237
distance x is tensor(23.3039, device='cuda:3')
benign distance is  tensor(23.3039, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3680184185504913
distance x is tensor(35.3458, device='cuda:3')
benign distance is  tensor(35.3458, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.333569973707199
distance x is tensor(17.5767, device='cuda:3')
benign distance is  tensor(17.5767, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.1275130957365036
distance x is tensor(20.5329, device='cuda:3')
benign distance is  tensor(20.5329, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1805482655763626
distance x is tensor(18.2999, device='cuda:3')
benign distance is  tensor(18.2999, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7612928450107574
distance x is tensor(26.6770, device='cuda:3')
benign distance is  tensor(26.6770, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0284307301044464
distance x is tensor(24.1073, device='cuda:3')
benign distance is  tensor(24.1073, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.8927067816257477
distance x is tensor(17.5007, device='cuda:3')
benign distance is  tensor(17.5007, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.6364649534225464
distance x is tensor(21.5976, device='cuda:3')
benign distance is  tensor(21.5976, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  3.103199914097786
distance x is tensor(1108258.3750, device='cuda:3')
benign distance is  tensor(1108258.3750, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.160725951194763
distance x is tensor(21.4303, device='cuda:3')
benign distance is  tensor(21.4303, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.730861097574234
distance x is tensor(29.2317, device='cuda:3')
benign distance is  tensor(29.2317, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.9583262652158737
distance x is tensor(22.9707, device='cuda:3')
benign distance is  tensor(22.9707, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.8423718065023422
distance x is tensor(22.9119, device='cuda:3')
benign distance is  tensor(22.9119, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.8950936049222946
distance x is tensor(26.8633, device='cuda:3')
benign distance is  tensor(26.8633, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.6610346138477325
distance x is tensor(1675336., device='cuda:3')
benign distance is  tensor(1675336., device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(27.1355, device='cuda:3')
compute distance is  tensor(27.1355, device='cuda:3')
compute norm is  tensor(19065594.8832, device='cuda:3', dtype=torch.float64)
distance x is tensor(31.1956, device='cuda:3')
compute distance is  tensor(31.1956, device='cuda:3')
compute norm is  tensor(19065595.6943, device='cuda:3', dtype=torch.float64)
distance x is tensor(22.0790, device='cuda:3')
compute distance is  tensor(22.0790, device='cuda:3')
compute norm is  tensor(19065595.5718, device='cuda:3', dtype=torch.float64)
distance x is tensor(28.4903, device='cuda:3')
compute distance is  tensor(28.4903, device='cuda:3')
compute norm is  tensor(19065595.4611, device='cuda:3', dtype=torch.float64)
distance x is tensor(22.0906, device='cuda:3')
compute distance is  tensor(22.0906, device='cuda:3')
compute norm is  tensor(19065595.4569, device='cuda:3', dtype=torch.float64)
distance x is tensor(20.8078, device='cuda:3')
compute distance is  tensor(20.8078, device='cuda:3')
compute norm is  tensor(19065595.4457, device='cuda:3', dtype=torch.float64)
distance x is tensor(18.7909, device='cuda:3')
compute distance is  tensor(18.7909, device='cuda:3')
compute norm is  tensor(19065595.4438, device='cuda:3', dtype=torch.float64)
distance x is tensor(20.7249, device='cuda:3')
compute distance is  tensor(20.7249, device='cuda:3')
compute norm is  tensor(19065595.6570, device='cuda:3', dtype=torch.float64)
distance x is tensor(32.3455, device='cuda:3')
compute distance is  tensor(32.3455, device='cuda:3')
compute norm is  tensor(19065595.4493, device='cuda:3', dtype=torch.float64)
distance x is tensor(26.4213, device='cuda:3')
compute distance is  tensor(26.4213, device='cuda:3')
compute norm is  tensor(19065595.7014, device='cuda:3', dtype=torch.float64)
distance x is tensor(26.4021, device='cuda:3')
compute distance is  tensor(26.4021, device='cuda:3')
compute norm is  tensor(19065595.3707, device='cuda:3', dtype=torch.float64)
distance x is tensor(9693048., device='cuda:3')
compute distance is  tensor(9693048., device='cuda:3')
compute norm is  tensor(20926773.5539, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(9693048., device='cuda:3')
distance x is tensor(1.5729e+08, device='cuda:3')
distance x is tensor(1.5729e+08, device='cuda:3')
________________________________
test distance is  tensor(1.5729e+08, device='cuda:3')
test distance1 is  tensor(1.5729e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107512820128481.98
test entropy is  0.0
________________________________
cal ratio is  0.24328318335414795
distance x is tensor(38264892., device='cuda:3')
cal_distance is  tensor(38264892., device='cuda:3')
cal ratio is  0.4932374227639124
distance x is tensor(18873678., device='cuda:3')
cal_distance is  tensor(18873678., device='cuda:3')
cal ratio is  0.7023086141553657
distance x is tensor(13255146., device='cuda:3')
cal_distance is  tensor(13255146., device='cuda:3')
cal ratio is  0.8380385620268183
distance x is tensor(11108323., device='cuda:3')
cal_distance is  tensor(11108323., device='cuda:3')
cal ratio is  0.9154444765361743
distance x is tensor(10169053., device='cuda:3')
cal_distance is  tensor(10169053., device='cuda:3')
cal ratio is  0.9567886118198365
distance x is tensor(9729634., device='cuda:3')
cal_distance is  tensor(9729634., device='cuda:3')
cal ratio is  0.9781557282931806
distance x is tensor(9517098., device='cuda:3')
cal_distance is  tensor(9517098., device='cuda:3')
distance x is tensor(9517098., device='cuda:3')
return_distance is  tensor(9517098., device='cuda:3')
distance x is tensor(9517098., device='cuda:3')
distance x is tensor(9517098., device='cuda:3')
________________________________
test distance is  tensor(9517098., device='cuda:3')
test distance1 is  tensor(9517098., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.09943333348966533
test loss is 3036660.1882935665
test entropy is  0.934242750091085
________________________________
0
distance x is tensor(9517098., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9334565296229015
avg test loss is  2329210.5496935803
avg accuracy is  0.09991666682299868
solo acc is  0.10101666682299865
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(9517098., device='cuda:3')
compute_norm is  tensor(17911538.5069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10208178., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.529525180488253
avg test loss is  2982696.351418337
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(10208178., device='cuda:3')
compute_norm is  tensor(17827717.0122, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10895811., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9888152943364085
avg test loss is  2655523.112450972
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(10895811., device='cuda:3')
compute_norm is  tensor(17744306.1766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11580437., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5071799203531067
avg test loss is  2286600.2649815544
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(11580437., device='cuda:3')
compute_norm is  tensor(17661279.5554, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12261663., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0058982383086483
avg test loss is  1950423.9101400399
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(12261663., device='cuda:3')
compute_norm is  tensor(17578641.5916, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12939871., device='cuda:3')
distance x is tensor(12939871., device='cuda:3')
________________________________
test distance is  tensor(12939871., device='cuda:3')
test distance1 is  tensor(12939871., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10018333348966532
test loss is 1812529.931967376
test entropy is  0.8743745930540536
________________________________
cal ratio is  0.848186357973148
distance x is tensor(10975420., device='cuda:3')
cal_distance is  tensor(10975420., device='cuda:3')
cal ratio is  0.920970420702047
distance x is tensor(10108039., device='cuda:3')
cal_distance is  tensor(10108039., device='cuda:3')
cal ratio is  0.9596719439831696
distance x is tensor(9700401., device='cuda:3')
cal_distance is  tensor(9700401., device='cuda:3')
cal ratio is  0.9796285133795304
distance x is tensor(9502789., device='cuda:3')
cal_distance is  tensor(9502789., device='cuda:3')
distance x is tensor(9502789., device='cuda:3')
return_distance is  tensor(9502789., device='cuda:3')
distance x is tensor(9502789., device='cuda:3')
distance x is tensor(9502789., device='cuda:3')
________________________________
test distance is  tensor(9502789., device='cuda:3')
test distance1 is  tensor(9502789., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10018333348966532
test loss is 2656350.491612391
test entropy is  1.1490249181352954
________________________________
0
distance x is tensor(9502789., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1491477872008709
avg test loss is  2579334.6593652484
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(9502789., device='cuda:3')
compute_norm is  tensor(17913201.3205, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10193939., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8976885512439426
avg test loss is  2785365.3068920053
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(10193939., device='cuda:3')
compute_norm is  tensor(17829370.6258, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10881640., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5135713053156319
avg test loss is  2306930.5719536743
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(10881640., device='cuda:3')
compute_norm is  tensor(17745952.6935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11566331., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9894081133642176
avg test loss is  2645246.73774011
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(11566331., device='cuda:3')
compute_norm is  tensor(17662918.8102, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(12247623., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5193152955091838
avg test loss is  1468751.683685019
avg accuracy is  0.10016666682299866
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(12247623., device='cuda:3')
compute_norm is  tensor(17580272.7652, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12925896., device='cuda:3')
distance x is tensor(12925896., device='cuda:3')
________________________________
test distance is  tensor(12925896., device='cuda:3')
test distance1 is  tensor(12925896., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10018333348966532
test loss is 2345150.864461882
test entropy is  0.9943027544631633
________________________________
cal ratio is  0.8486447627904141
distance x is tensor(10969493., device='cuda:3')
cal_distance is  tensor(10969493., device='cuda:3')
cal ratio is  0.9212191995831659
distance x is tensor(10105308., device='cuda:3')
cal_distance is  tensor(10105308., device='cuda:3')
cal ratio is  0.9598016140268248
distance x is tensor(9699091., device='cuda:3')
cal_distance is  tensor(9699091., device='cuda:3')
cal ratio is  0.9796946592297497
distance x is tensor(9502147., device='cuda:3')
cal_distance is  tensor(9502147., device='cuda:3')
distance x is tensor(9502147., device='cuda:3')
return_distance is  tensor(9502147., device='cuda:3')
distance x is tensor(9502147., device='cuda:3')
distance x is tensor(9502147., device='cuda:3')
________________________________
test distance is  tensor(9502147., device='cuda:3')
test distance1 is  tensor(9502147., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10016666682299866
test loss is 2448430.949140816
test entropy is  1.2457227990317192
________________________________
0
distance x is tensor(9502147., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.246689932051498
avg test loss is  2202415.0446728645
avg accuracy is  0.10018333348966532
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(9502147., device='cuda:3')
compute_norm is  tensor(17913226.7721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10193301., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9111637192875591
avg test loss is  2116172.573192571
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(10193301., device='cuda:3')
compute_norm is  tensor(17829396.0805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10881002., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5212214890319402
avg test loss is  3165129.631686885
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(10881002., device='cuda:3')
compute_norm is  tensor(17745977.9303, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11565698., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9785303723837521
avg test loss is  2440450.941536448
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(11565698., device='cuda:3')
compute_norm is  tensor(17662943.9087, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(12246994., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5246958535617348
avg test loss is  2146129.2006778126
avg accuracy is  0.10018333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(12246994., device='cuda:3')
compute_norm is  tensor(17580297.6975, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12925270., device='cuda:3')
________________________________
test distance is  tensor(12925270., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10018333348966532
test loss is 2381146.803560206
test entropy is  0.9833173882732513
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.373356729745865
mal norm is  tensor(1.0096e+08, device='cuda:3')
distance x is tensor(12925270., device='cuda:3')
mal distance is  tensor(12925270., device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1.7999e+03, 3.0230e+03, 1.3857e+03, 1.4618e+03, 1.3945e+03, 2.2863e+03,
        1.9418e+03, 1.3220e+03, 1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08,
        1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08,
        1.0096e+08, 1.0096e+08, 1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09,
        1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09,
               nan, 1.2281e+09, 2.8701e+12, 1.2281e+09, 1.2282e+09, 1.2281e+09,
        4.3703e+08, 4.3703e+08, 4.3703e+08, 4.3717e+08, 4.3703e+08, 4.3717e+08,
        4.3703e+08, 4.3716e+08, 2.6305e+08, 2.6305e+08, 2.6305e+08, 2.6305e+08,
        2.6305e+08, 2.6305e+08, 2.6305e+08, 2.6305e+08], device='cuda:3')
sorted_norm is   tensor([1.3220e+03, 1.3857e+03, 1.3945e+03, 1.4618e+03, 1.7999e+03, 1.9418e+03,
        2.2863e+03, 3.0230e+03, 1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08,
        1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08, 1.0096e+08,
        1.0096e+08, 1.0096e+08, 2.6305e+08, 2.6305e+08, 2.6305e+08, 2.6305e+08,
        2.6305e+08, 2.6305e+08, 2.6305e+08, 2.6305e+08, 4.3703e+08, 4.3703e+08,
        4.3703e+08, 4.3703e+08, 4.3703e+08, 4.3716e+08, 4.3717e+08, 4.3717e+08,
        1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09,
        1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09, 1.2281e+09,
        1.2281e+09, 1.2282e+09, 2.8701e+12,        nan], device='cuda:3')
used idx is  tensor([ 7,  2,  4,  3,  0,  6,  5,  1, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 49, 48, 50, 51, 47, 46, 44, 45, 40, 42, 37, 38, 36, 43, 41, 39,
        31, 33, 26, 24, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 9.99% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7427619099617004
distance x is tensor(9.2791, device='cuda:3')
benign distance is  tensor(9.2791, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3171150386333466
distance x is tensor(24160270., device='cuda:3')
benign distance is  tensor(24160270., device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.2046889066696167
distance x is tensor(9.0792, device='cuda:3')
benign distance is  tensor(9.0792, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0424144566059113
distance x is tensor(10.9143, device='cuda:3')
benign distance is  tensor(10.9143, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1460079550743103
distance x is tensor(10.2283, device='cuda:3')
benign distance is  tensor(10.2283, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7363784164190292
distance x is tensor(11.4353, device='cuda:3')
benign distance is  tensor(11.4353, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.001891613006592
distance x is tensor(33144006., device='cuda:3')
benign distance is  tensor(33144006., device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9074392318725586
distance x is tensor(7.5610, device='cuda:3')
benign distance is  tensor(7.5610, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.0839770138263702
distance x is tensor(11.1404, device='cuda:3')
benign distance is  tensor(11.1404, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.8792592138051987
distance x is tensor(2235953.7500, device='cuda:3')
benign distance is  tensor(2235953.7500, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.2716341614723206
distance x is tensor(7.7730, device='cuda:3')
benign distance is  tensor(7.7730, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.4757619947195053
distance x is tensor(10.3651, device='cuda:3')
benign distance is  tensor(10.3651, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3783507050498.972
distance x is tensor(2723526.7500, device='cuda:3')
benign distance is  tensor(2723526.7500, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.673628106713295
distance x is tensor(6.8698, device='cuda:3')
benign distance is  tensor(6.8698, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.677394524216652
distance x is tensor(9.8053, device='cuda:3')
benign distance is  tensor(9.8053, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.4501781910657883
distance x is tensor(11.4675, device='cuda:3')
benign distance is  tensor(11.4675, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.152461424469948
distance x is tensor(7.3993, device='cuda:3')
benign distance is  tensor(7.3993, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.931645482778549
distance x is tensor(11.8820, device='cuda:3')
benign distance is  tensor(11.8820, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.2890012711286545
distance x is tensor(10.6042, device='cuda:3')
benign distance is  tensor(10.6042, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.051553398370743
distance x is tensor(7.8390, device='cuda:3')
benign distance is  tensor(7.8390, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.948626607656479
distance x is tensor(9.0421, device='cuda:3')
benign distance is  tensor(9.0421, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.7706975042819977
distance x is tensor(10.1788, device='cuda:3')
benign distance is  tensor(10.1788, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.0152619183063507
distance x is tensor(14.0923, device='cuda:3')
benign distance is  tensor(14.0923, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.838249921798706
distance x is tensor(29550930., device='cuda:3')
benign distance is  tensor(29550930., device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.9147291779518127
distance x is tensor(11.4690, device='cuda:3')
benign distance is  tensor(11.4690, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.7241652756929398
distance x is tensor(8.6970, device='cuda:3')
benign distance is  tensor(8.6970, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.110840931534767
distance x is tensor(10.2643, device='cuda:3')
benign distance is  tensor(10.2643, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.4321600645780563
distance x is tensor(9.9787, device='cuda:3')
benign distance is  tensor(9.9787, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.824554353952408
distance x is tensor(9.5085, device='cuda:3')
benign distance is  tensor(9.5085, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  3.0536267906427383
distance x is tensor(7.7951, device='cuda:3')
benign distance is  tensor(7.7951, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.6055721640586853
distance x is tensor(7.7254, device='cuda:3')
benign distance is  tensor(7.7254, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.3597650676965714
distance x is tensor(10.6677, device='cuda:3')
benign distance is  tensor(10.6677, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.760894387960434
distance x is tensor(13.1928, device='cuda:3')
benign distance is  tensor(13.1928, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.44743549823761
distance x is tensor(11.5878, device='cuda:3')
benign distance is  tensor(11.5878, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.8838362097740173
distance x is tensor(44413640., device='cuda:3')
benign distance is  tensor(44413640., device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  3.1417225301265717
distance x is tensor(9.1638, device='cuda:3')
benign distance is  tensor(9.1638, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.7229160368442535
distance x is tensor(8.0346, device='cuda:3')
benign distance is  tensor(8.0346, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  3.1413631588220596
distance x is tensor(15625847., device='cuda:3')
benign distance is  tensor(15625847., device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.1308329105377197
distance x is tensor(9.9466, device='cuda:3')
benign distance is  tensor(9.9466, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.4971813708543777
distance x is tensor(9.5244, device='cuda:3')
benign distance is  tensor(9.5244, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(9.2348, device='cuda:3')
compute distance is  tensor(9.2348, device='cuda:3')
compute norm is  tensor(18402477.7101, device='cuda:3', dtype=torch.float64)
distance x is tensor(7839871.5000, device='cuda:3')
compute distance is  tensor(7839871.5000, device='cuda:3')
compute norm is  tensor(19870278.3000, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.8795, device='cuda:3')
compute distance is  tensor(5.8795, device='cuda:3')
compute norm is  tensor(18402478.4688, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.0665, device='cuda:3')
compute distance is  tensor(13.0665, device='cuda:3')
compute norm is  tensor(18402478.5811, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.7599, device='cuda:3')
compute distance is  tensor(8.7599, device='cuda:3')
compute norm is  tensor(18402478.3093, device='cuda:3', dtype=torch.float64)
distance x is tensor(12.9537, device='cuda:3')
compute distance is  tensor(12.9537, device='cuda:3')
compute norm is  tensor(18402478.3471, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.0942, device='cuda:3')
compute distance is  tensor(9.0942, device='cuda:3')
compute norm is  tensor(18402478.3241, device='cuda:3', dtype=torch.float64)
distance x is tensor(14940487., device='cuda:3')
compute distance is  tensor(14940487., device='cuda:3')
compute norm is  tensor(23190195.8642, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.4183, device='cuda:3')
compute distance is  tensor(10.4183, device='cuda:3')
compute norm is  tensor(18402478.4118, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.1738, device='cuda:3')
compute distance is  tensor(10.1738, device='cuda:3')
compute norm is  tensor(18402478.8510, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.4267, device='cuda:3')
compute distance is  tensor(11.4267, device='cuda:3')
compute norm is  tensor(18402478.2891, device='cuda:3', dtype=torch.float64)
distance x is tensor(15047577., device='cuda:3')
compute distance is  tensor(15047577., device='cuda:3')
compute norm is  tensor(21917357.7551, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(15047577., device='cuda:3')
distance x is tensor(1.5183e+08, device='cuda:3')
distance x is tensor(1.5183e+08, device='cuda:3')
________________________________
test distance is  tensor(1.5183e+08, device='cuda:3')
test distance1 is  tensor(1.5183e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107516186983050.64
test entropy is  0.0
________________________________
cal ratio is  0.30851305729427086
distance x is tensor(46843052., device='cuda:3')
cal_distance is  tensor(46843052., device='cuda:3')
cal ratio is  0.555439523842804
distance x is tensor(26018482., device='cuda:3')
cal_distance is  tensor(26018482., device='cuda:3')
cal ratio is  0.7452781391980207
distance x is tensor(19391006., device='cuda:3')
cal_distance is  tensor(19391006., device='cuda:3')
cal ratio is  0.8632949379918923
distance x is tensor(16740157., device='cuda:3')
cal_distance is  tensor(16740157., device='cuda:3')
cal ratio is  0.9291366674957505
distance x is tensor(15553895., device='cuda:3')
cal_distance is  tensor(15553895., device='cuda:3')
cal ratio is  0.963917318828744
distance x is tensor(14992667., device='cuda:3')
cal_distance is  tensor(14992667., device='cuda:3')
distance x is tensor(14992667., device='cuda:3')
return_distance is  tensor(14992667., device='cuda:3')
distance x is tensor(14992667., device='cuda:3')
distance x is tensor(14992667., device='cuda:3')
________________________________
test distance is  tensor(14992667., device='cuda:3')
test distance1 is  tensor(14992667., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.099300000156332
test loss is 4640027.2792198965
test entropy is  1.5489469694176208
________________________________
0
distance x is tensor(14992667., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.54889882703834
avg test loss is  4530683.669765679
avg accuracy is  0.100500000156332
solo acc is  0.10038333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(14992667., device='cuda:3')
compute_norm is  tensor(16584661.0992, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15632391., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0725381253624775
avg test loss is  4318759.130190037
avg accuracy is  0.09865000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15632391., device='cuda:3')
compute_norm is  tensor(16507052.6815, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16269327., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9191146501218841
avg test loss is  4105605.1734433523
avg accuracy is  0.09995000015633197
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16269327., device='cuda:3')
compute_norm is  tensor(16429826.0802, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16903172., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4472243243189
avg test loss is  3929287.9952317295
avg accuracy is  0.09928333348966531
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16903172., device='cuda:3')
compute_norm is  tensor(16352946.1051, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17534030., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0625591513190442
avg test loss is  3893019.501662696
avg accuracy is  0.10058333348966532
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(17534030., device='cuda:3')
compute_norm is  tensor(16276431.5576, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18162108., device='cuda:3')
distance x is tensor(18162108., device='cuda:3')
________________________________
test distance is  tensor(18162108., device='cuda:3')
test distance1 is  tensor(18162108., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10015000015633198
test loss is 5282490.5162323015
test entropy is  0.9173009661850391
________________________________
cal ratio is  0.8920233657095589
distance x is tensor(16201027., device='cuda:3')
cal_distance is  tensor(16201027., device='cuda:3')
cal ratio is  0.9444698436076792
distance x is tensor(15301378., device='cuda:3')
cal_distance is  tensor(15301378., device='cuda:3')
cal ratio is  0.9718384927350886
distance x is tensor(14870469., device='cuda:3')
cal_distance is  tensor(14870469., device='cuda:3')
distance x is tensor(14870469., device='cuda:3')
return_distance is  tensor(14870469., device='cuda:3')
distance x is tensor(14870469., device='cuda:3')
distance x is tensor(14870469., device='cuda:3')
________________________________
test distance is  tensor(14870469., device='cuda:3')
test distance1 is  tensor(14870469., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10018333348966532
test loss is 4844135.797047201
test entropy is  1.2046863781109547
________________________________
0
distance x is tensor(14870469., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2043802454781685
avg test loss is  5063850.968347855
avg accuracy is  0.1009333334896653
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(14870469., device='cuda:3')
compute_norm is  tensor(16599395.0782, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15510804., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9544104213780685
avg test loss is  5770502.452200945
avg accuracy is  0.09968333348966532
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15510804., device='cuda:3')
compute_norm is  tensor(16521717.3751, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16148237., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4743394776702181
avg test loss is  3499733.4903363017
avg accuracy is  0.09866666682299866
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16148237., device='cuda:3')
compute_norm is  tensor(16444424.8566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16782748., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0532953096096958
avg test loss is  3837179.5176978977
avg accuracy is  0.10040000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16782748., device='cuda:3')
compute_norm is  tensor(16367464.9226, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17414066., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9084757639528084
avg test loss is  4617739.1123475265
avg accuracy is  0.09980000015633197
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(17414066., device='cuda:3')
compute_norm is  tensor(16290901.5378, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18042784., device='cuda:3')
distance x is tensor(18042784., device='cuda:3')
________________________________
test distance is  tensor(18042784., device='cuda:3')
test distance1 is  tensor(18042784., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 4976649.050463446
test entropy is  1.4684742345992945
________________________________
cal ratio is  0.8949681776798765
distance x is tensor(16147717., device='cuda:3')
cal_distance is  tensor(16147717., device='cuda:3')
cal ratio is  0.9460275689940777
distance x is tensor(15276186., device='cuda:3')
cal_distance is  tensor(15276186., device='cuda:3')
cal ratio is  0.9726394804340023
distance x is tensor(14858222., device='cuda:3')
cal_distance is  tensor(14858222., device='cuda:3')
distance x is tensor(14858222., device='cuda:3')
return_distance is  tensor(14858222., device='cuda:3')
distance x is tensor(14858222., device='cuda:3')
distance x is tensor(14858222., device='cuda:3')
________________________________
test distance is  tensor(14858222., device='cuda:3')
test distance1 is  tensor(14858222., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 4775003.8054770855
test entropy is  1.651550115171526
________________________________
0
distance x is tensor(14858222., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6519321584498197
avg test loss is  6766947.072817889
avg accuracy is  0.09921666682299865
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(14858222., device='cuda:3')
compute_norm is  tensor(16600812.0489, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15498617., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0977178062203088
avg test loss is  3881682.489938493
avg accuracy is  0.10091666682299863
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15498617., device='cuda:3')
compute_norm is  tensor(16523128.4172, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16136100., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9180219835564017
avg test loss is  3354815.3049295284
avg accuracy is  0.10016666682299863
solo acc is  0.10016666682299866
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16136100., device='cuda:3')
compute_norm is  tensor(16445829.6606, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16770677., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4841779983882457
avg test loss is  4124207.933857917
avg accuracy is  0.09928333348966531
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16770677., device='cuda:3')
compute_norm is  tensor(16368861.7204, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17402044., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.042908938200489
avg test loss is  5971703.321737336
avg accuracy is  0.10000000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(17402044., device='cuda:3')
compute_norm is  tensor(16292293.1476, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18030822., device='cuda:3')
________________________________
test distance is  tensor(18030822., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.0999833334896653
test loss is 6014464.985211796
test entropy is  0.9008499457637893
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.4779566824436188
mal norm is  tensor(1.4082e+08, device='cuda:3')
distance x is tensor(18030822., device='cuda:3')
mal distance is  tensor(18030822., device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([4.4758e+02, 9.7606e+08, 5.4461e+02, 5.3294e+02, 5.4315e+02, 8.3463e+02,
        1.5637e+09, 3.8696e+02, 1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08,
        1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08,
        1.4082e+08, 1.4082e+08], device='cuda:3')
sorted_norm is   tensor([3.8696e+02, 4.4758e+02, 5.3294e+02, 5.4315e+02, 5.4461e+02, 8.3463e+02,
        1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08,
        1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08, 1.4082e+08,
        9.7606e+08, 1.5637e+09], device='cuda:3')
used idx is  tensor([ 7,  0,  3,  4,  2,  5, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.01% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7213351726531982
distance x is tensor(7.0492, device='cuda:3')
benign distance is  tensor(7.0492, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.449691593647003
distance x is tensor(19674978., device='cuda:3')
benign distance is  tensor(19674978., device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.3932637125253677
distance x is tensor(6.3229, device='cuda:3')
benign distance is  tensor(6.3229, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0353750735521317
distance x is tensor(7.7672, device='cuda:3')
benign distance is  tensor(7.7672, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.2147130221128464
distance x is tensor(6.3911, device='cuda:3')
benign distance is  tensor(6.3911, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7208148688077927
distance x is tensor(5.1160, device='cuda:3')
benign distance is  tensor(5.1160, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.997977375984192
distance x is tensor(18173494., device='cuda:3')
benign distance is  tensor(18173494., device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.8768805265426636
distance x is tensor(5.9501, device='cuda:3')
benign distance is  tensor(5.9501, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.1428, device='cuda:3')
compute distance is  tensor(5.1428, device='cuda:3')
compute norm is  tensor(17035957.0832, device='cuda:3', dtype=torch.float64)
distance x is tensor(6704892., device='cuda:3')
compute distance is  tensor(6704892., device='cuda:3')
compute norm is  tensor(18666504.5126, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.5496, device='cuda:3')
compute distance is  tensor(5.5496, device='cuda:3')
compute norm is  tensor(17035957.7569, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.9430, device='cuda:3')
compute distance is  tensor(7.9430, device='cuda:3')
compute norm is  tensor(17035957.6661, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.3906, device='cuda:3')
compute distance is  tensor(8.3906, device='cuda:3')
compute norm is  tensor(17035957.5904, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.1107, device='cuda:3')
compute distance is  tensor(7.1107, device='cuda:3')
compute norm is  tensor(17035957.5059, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2509, device='cuda:3')
compute distance is  tensor(7.2509, device='cuda:3')
compute norm is  tensor(17035957.5190, device='cuda:3', dtype=torch.float64)
distance x is tensor(3048894., device='cuda:3')
compute distance is  tensor(3048894., device='cuda:3')
compute norm is  tensor(17964811.4539, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.7599, device='cuda:3')
compute distance is  tensor(6.7599, device='cuda:3')
compute norm is  tensor(17035957.5575, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.7802, device='cuda:3')
compute distance is  tensor(6.7802, device='cuda:3')
compute norm is  tensor(17035957.9894, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2905, device='cuda:3')
compute distance is  tensor(7.2905, device='cuda:3')
compute norm is  tensor(17035957.4795, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.6260, device='cuda:3')
compute distance is  tensor(5.6260, device='cuda:3')
compute norm is  tensor(17035957.6926, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(6704892., device='cuda:3')
distance x is tensor(1.4057e+08, device='cuda:3')
distance x is tensor(1.4057e+08, device='cuda:3')
________________________________
test distance is  tensor(1.4057e+08, device='cuda:3')
test distance1 is  tensor(1.4057e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107516114749802.44
test entropy is  0.0
________________________________
cal ratio is  0.21403380779813275
distance x is tensor(30085804., device='cuda:3')
cal_distance is  tensor(30085804., device='cuda:3')
cal ratio is  0.4626378486346691
distance x is tensor(13918830., device='cuda:3')
cal_distance is  tensor(13918830., device='cuda:3')
cal ratio is  0.6801749087227443
distance x is tensor(9467239., device='cuda:3')
cal_distance is  tensor(9467239., device='cuda:3')
cal ratio is  0.8247271630946227
distance x is tensor(7807889.5000, device='cuda:3')
cal_distance is  tensor(7807889.5000, device='cuda:3')
cal ratio is  0.9081448752216393
distance x is tensor(7090694.5000, device='cuda:3')
cal_distance is  tensor(7090694.5000, device='cuda:3')
cal ratio is  0.9529663901136419
distance x is tensor(6757192.5000, device='cuda:3')
cal_distance is  tensor(6757192.5000, device='cuda:3')
cal ratio is  0.976200051892093
distance x is tensor(6596372.5000, device='cuda:3')
cal_distance is  tensor(6596372.5000, device='cuda:3')
distance x is tensor(6596372.5000, device='cuda:3')
return_distance is  tensor(6596372.5000, device='cuda:3')
distance x is tensor(6596372.5000, device='cuda:3')
distance x is tensor(6596372.5000, device='cuda:3')
________________________________
test distance is  tensor(6596372.5000, device='cuda:3')
test distance1 is  tensor(6596372.5000, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 5579086.506339757
test entropy is  1.2578224622364491
________________________________
0
distance x is tensor(6596372.5000, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2580232615155706
avg test loss is  4739144.124452105
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6596372.5000, device='cuda:3')
compute_norm is  tensor(16236174.2196, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7222655.5000, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9499561411739667
avg test loss is  5301581.637130524
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(7222655.5000, device='cuda:3')
compute_norm is  tensor(16160220.4848, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7846125.5000, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4704446058029306
avg test loss is  4354671.476114481
avg accuracy is  0.10013333348966531
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(7846125.5000, device='cuda:3')
compute_norm is  tensor(16084606.1380, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8466771., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0401330333528742
avg test loss is  3817481.167627481
avg accuracy is  0.10015000015633198
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(8466771., device='cuda:3')
compute_norm is  tensor(16009331.8220, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9084269., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9004873869134419
avg test loss is  4286250.929035734
avg accuracy is  0.10011666682299865
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(9084269., device='cuda:3')
compute_norm is  tensor(15934448.1003, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9699217., device='cuda:3')
distance x is tensor(9699217., device='cuda:3')
________________________________
test distance is  tensor(9699217., device='cuda:3')
test distance1 is  tensor(9699217., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 6968109.900046149
test entropy is  1.4668136223801163
________________________________
cal ratio is  0.8148049069561629
distance x is tensor(7902970., device='cuda:3')
cal_distance is  tensor(7902970., device='cuda:3')
cal ratio is  0.9026654115660641
distance x is tensor(7133738., device='cuda:3')
cal_distance is  tensor(7133738., device='cuda:3')
cal ratio is  0.9500870495491457
distance x is tensor(6777671., device='cuda:3')
cal_distance is  tensor(6777671., device='cuda:3')
cal ratio is  0.9747241419918551
distance x is tensor(6606359., device='cuda:3')
cal_distance is  tensor(6606359., device='cuda:3')
distance x is tensor(6606359., device='cuda:3')
return_distance is  tensor(6606359., device='cuda:3')
distance x is tensor(6606359., device='cuda:3')
distance x is tensor(6606359., device='cuda:3')
________________________________
test distance is  tensor(6606359., device='cuda:3')
test distance1 is  tensor(6606359., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 3917232.090875965
test entropy is  1.54140142489598
________________________________
0
distance x is tensor(6606359., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5419080251061332
avg test loss is  4589888.325525636
avg accuracy is  0.10016666682299866
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6606359., device='cuda:3')
compute_norm is  tensor(16234895.6196, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7232590., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0478685988800358
avg test loss is  3321023.1753473384
avg accuracy is  0.10016666682299866
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(7232590., device='cuda:3')
compute_norm is  tensor(16158947.4290, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7856019.5000, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8987497584397859
avg test loss is  2682081.817934505
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(7856019.5000, device='cuda:3')
compute_norm is  tensor(16083340.2408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8476614., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4815735838560662
avg test loss is  4286102.015285722
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(8476614., device='cuda:3')
compute_norm is  tensor(16008070.7968, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9094068., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0371845666406505
avg test loss is  4826969.102109828
avg accuracy is  0.10013333348966531
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(9094068., device='cuda:3')
compute_norm is  tensor(15933192.7545, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9708970., device='cuda:3')
distance x is tensor(9708970., device='cuda:3')
________________________________
test distance is  tensor(9708970., device='cuda:3')
test distance1 is  tensor(9708970., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10015000015633198
test loss is 4160782.2819321617
test entropy is  0.8959657715073527
________________________________
cal ratio is  0.8143955323126029
distance x is tensor(7906943., device='cuda:3')
cal_distance is  tensor(7906943., device='cuda:3')
cal ratio is  0.9024386040047865
distance x is tensor(7135530., device='cuda:3')
cal_distance is  tensor(7135530., device='cuda:3')
cal ratio is  0.9499677136857675
distance x is tensor(6778524., device='cuda:3')
cal_distance is  tensor(6778524., device='cuda:3')
cal ratio is  0.9746628272800801
distance x is tensor(6606774.5000, device='cuda:3')
cal_distance is  tensor(6606774.5000, device='cuda:3')
distance x is tensor(6606774.5000, device='cuda:3')
return_distance is  tensor(6606774.5000, device='cuda:3')
distance x is tensor(6606774.5000, device='cuda:3')
distance x is tensor(6606774.5000, device='cuda:3')
________________________________
test distance is  tensor(6606774.5000, device='cuda:3')
test distance1 is  tensor(6606774.5000, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10013333348966531
test loss is 5012453.288476759
test entropy is  1.1426940124426315
________________________________
0
distance x is tensor(6606774.5000, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1436100013728843
avg test loss is  4963316.907932548
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6606774.5000, device='cuda:3')
compute_norm is  tensor(16234800.4363, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7233002., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9157856549662567
avg test loss is  5463892.798069332
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(7233002., device='cuda:3')
compute_norm is  tensor(16158852.5121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7856431., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4908513833464845
avg test loss is  4149762.4381711334
avg accuracy is  0.10015000015633198
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(7856431., device='cuda:3')
compute_norm is  tensor(16083245.5379, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8477023., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0287175184246828
avg test loss is  4979582.236239224
avg accuracy is  0.10016666682299866
solo acc is  0.10013333348966531
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(8477023., device='cuda:3')
compute_norm is  tensor(16007977.0439, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9094475., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8901603134202042
avg test loss is  3944186.492747154
avg accuracy is  0.10018333348966532
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(9094475., device='cuda:3')
compute_norm is  tensor(15933099.2445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9709377., device='cuda:3')
________________________________
test distance is  tensor(9709377., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10016666682299866
test loss is 4797833.725190011
test entropy is  1.487464592782165
________________________________
final entropy
distance x is tensor(9709377., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.487339005287268
avg test loss is  5812458.34169923
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(9709377., device='cuda:3')
compute_norm is  tensor(15858525.5321, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.3098347038030624
mal norm is  tensor(80617704., device='cuda:3')
distance x is tensor(10321075., device='cuda:3')
mal distance is  tensor(10321075., device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([2.5237e+02, 7.2940e+08, 2.3666e+02, 2.6775e+02, 2.3185e+02, 2.0422e+02,
        7.5683e+08, 2.1468e+02, 8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07,
        8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07,
        8.0618e+07, 8.0618e+07, 8.8011e+07, 1.1325e+08, 8.8011e+07, 8.8011e+07,
        1.1807e+08, 8.8011e+07, 8.8011e+07, 8.8011e+07], device='cuda:3')
sorted_norm is   tensor([2.0422e+02, 2.1468e+02, 2.3185e+02, 2.3666e+02, 2.5237e+02, 2.6775e+02,
        8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07,
        8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07, 8.0618e+07,
        8.8011e+07, 8.8011e+07, 8.8011e+07, 8.8011e+07, 8.8011e+07, 8.8011e+07,
        1.1325e+08, 1.1807e+08, 7.2940e+08, 7.5683e+08], device='cuda:3')
used idx is  tensor([ 5,  7,  4,  2,  0,  3, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,
        26, 22, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.01% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7104913741350174
distance x is tensor(6.8198, device='cuda:3')
benign distance is  tensor(6.8198, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.400958225131035
distance x is tensor(18270306., device='cuda:3')
benign distance is  tensor(18270306., device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.4401292949914932
distance x is tensor(6.0790, device='cuda:3')
benign distance is  tensor(6.0790, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.029865548014641
distance x is tensor(7.3491, device='cuda:3')
benign distance is  tensor(7.3491, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.119573086500168
distance x is tensor(6.0002, device='cuda:3')
benign distance is  tensor(6.0002, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.738065868616104
distance x is tensor(4.7552, device='cuda:3')
benign distance is  tensor(4.7552, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.9937285631895065
distance x is tensor(23192958., device='cuda:3')
benign distance is  tensor(23192958., device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.866024985909462
distance x is tensor(5.6234, device='cuda:3')
benign distance is  tensor(5.6234, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.0444299280643463
distance x is tensor(7.3692, device='cuda:3')
benign distance is  tensor(7.3692, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.8835058361291885
distance x is tensor(3980012.5000, device='cuda:3')
benign distance is  tensor(3980012.5000, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.307628646492958
distance x is tensor(6.0700, device='cuda:3')
benign distance is  tensor(6.0700, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.6235226690769196
distance x is tensor(8.0550, device='cuda:3')
benign distance is  tensor(8.0550, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1557420802.9456449
distance x is tensor(984094.5625, device='cuda:3')
benign distance is  tensor(984094.5625, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.7197118997573853
distance x is tensor(5.1421, device='cuda:3')
benign distance is  tensor(5.1421, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.6754565238952637
distance x is tensor(6.3804, device='cuda:3')
benign distance is  tensor(6.3804, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.5334673523902893
distance x is tensor(8.5367, device='cuda:3')
benign distance is  tensor(8.5367, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.0813, device='cuda:3')
compute distance is  tensor(5.0813, device='cuda:3')
compute norm is  tensor(16601712.5066, device='cuda:3', dtype=torch.float64)
distance x is tensor(9632089., device='cuda:3')
compute distance is  tensor(9632089., device='cuda:3')
compute norm is  tensor(18979535.6163, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.4591, device='cuda:3')
compute distance is  tensor(5.4591, device='cuda:3')
compute norm is  tensor(16601713.0999, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.6400, device='cuda:3')
compute distance is  tensor(7.6400, device='cuda:3')
compute norm is  tensor(16601713.0725, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.2325, device='cuda:3')
compute distance is  tensor(8.2325, device='cuda:3')
compute norm is  tensor(16601712.9649, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.0060, device='cuda:3')
compute distance is  tensor(7.0060, device='cuda:3')
compute norm is  tensor(16601712.9163, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.8559, device='cuda:3')
compute distance is  tensor(6.8559, device='cuda:3')
compute norm is  tensor(16601712.9222, device='cuda:3', dtype=torch.float64)
distance x is tensor(14718276., device='cuda:3')
compute distance is  tensor(14718276., device='cuda:3')
compute norm is  tensor(21178967.4831, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.1929, device='cuda:3')
compute distance is  tensor(6.1929, device='cuda:3')
compute norm is  tensor(16601712.9376, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.6817, device='cuda:3')
compute distance is  tensor(6.6817, device='cuda:3')
compute norm is  tensor(16601713.4096, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2212, device='cuda:3')
compute distance is  tensor(7.2212, device='cuda:3')
compute norm is  tensor(16601712.8885, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.6469, device='cuda:3')
compute distance is  tensor(5.6469, device='cuda:3')
compute norm is  tensor(16601713.0718, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(14718276., device='cuda:3')
distance x is tensor(1.3698e+08, device='cuda:3')
distance x is tensor(1.3698e+08, device='cuda:3')
________________________________
test distance is  tensor(1.3698e+08, device='cuda:3')
test distance1 is  tensor(1.3698e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107524465600123.36
test entropy is  0.0
________________________________
cal ratio is  0.3212315254799405
distance x is tensor(44003872., device='cuda:3')
cal_distance is  tensor(44003872., device='cuda:3')
cal ratio is  0.5667729229273034
distance x is tensor(24940206., device='cuda:3')
cal_distance is  tensor(24940206., device='cuda:3')
cal ratio is  0.752843212880426
distance x is tensor(18776066., device='cuda:3')
cal_distance is  tensor(18776066., device='cuda:3')
cal ratio is  0.8676653479606269
distance x is tensor(16291341., device='cuda:3')
cal_distance is  tensor(16291341., device='cuda:3')
cal ratio is  0.9314855755842464
distance x is tensor(15175149., device='cuda:3')
cal_distance is  tensor(15175149., device='cuda:3')
cal ratio is  0.9651349958315452
distance x is tensor(14646068., device='cuda:3')
cal_distance is  tensor(14646068., device='cuda:3')
distance x is tensor(14646068., device='cuda:3')
return_distance is  tensor(14646068., device='cuda:3')
distance x is tensor(14646068., device='cuda:3')
distance x is tensor(14646068., device='cuda:3')
________________________________
test distance is  tensor(14646068., device='cuda:3')
test distance1 is  tensor(14646068., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 3952698.154373355
test entropy is  0.8843377384422685
________________________________
0
distance x is tensor(14646068., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8841633405258407
avg test loss is  3539880.2182965907
avg accuracy is  0.10016666682299866
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(14646068., device='cuda:3')
compute_norm is  tensor(14825947.1896, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15217978., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4442715558416046
avg test loss is  3105836.7140617264
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15217978., device='cuda:3')
compute_norm is  tensor(14756586.4405, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15787287., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0424411891620042
avg test loss is  3110946.396986288
avg accuracy is  0.10013333348966531
solo acc is  0.10013333348966531
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(15787287., device='cuda:3')
compute_norm is  tensor(14687537.2906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16353919., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9111282732059707
avg test loss is  3006131.721659395
avg accuracy is  0.10011666682299865
solo acc is  0.10011666682299865
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16353919., device='cuda:3')
compute_norm is  tensor(14618819.0074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16917898., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.4496692506743392
avg test loss is  3914362.098616058
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16917898., device='cuda:3')
compute_norm is  tensor(14550417.0873, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17479270., device='cuda:3')
distance x is tensor(17479270., device='cuda:3')
________________________________
test distance is  tensor(17479270., device='cuda:3')
test distance1 is  tensor(17479270., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10016666682299866
test loss is 3490783.5551621765
test entropy is  1.0540244862723198
________________________________
cal ratio is  0.8992757839407002
distance x is tensor(15718684., device='cuda:3')
cal_distance is  tensor(15718684., device='cuda:3')
cal ratio is  0.948301531652895
distance x is tensor(14906053., device='cuda:3')
cal_distance is  tensor(14906053., device='cuda:3')
cal ratio is  0.9738077193477591
distance x is tensor(14515629., device='cuda:3')
cal_distance is  tensor(14515629., device='cuda:3')
distance x is tensor(14515629., device='cuda:3')
return_distance is  tensor(14515629., device='cuda:3')
distance x is tensor(14515629., device='cuda:3')
distance x is tensor(14515629., device='cuda:3')
________________________________
test distance is  tensor(14515629., device='cuda:3')
test distance1 is  tensor(14515629., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10015000015633198
test loss is 3935943.486826961
test entropy is  1.197349272557159
________________________________
0
distance x is tensor(14515629., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1975893016054686
avg test loss is  3766388.355572852
avg accuracy is  0.10016666682299866
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(14515629., device='cuda:3')
compute_norm is  tensor(14841676.3064, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15088143., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.948702038923052
avg test loss is  3835916.7709021475
avg accuracy is  0.10015000015633198
solo acc is  0.10013333348966531
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(15088143., device='cuda:3')
compute_norm is  tensor(14772238.1930, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15658051., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4632339142024644
avg test loss is  2827704.493378816
avg accuracy is  0.10016666682299866
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15658051., device='cuda:3')
compute_norm is  tensor(14703113.9855, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16225298., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0749127820356568
avg test loss is  2766441.631164987
avg accuracy is  0.10018333348966532
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16225298., device='cuda:3')
compute_norm is  tensor(14634324.2381, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16789880., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9306698873607334
avg test loss is  3117332.3912134403
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16789880., device='cuda:3')
compute_norm is  tensor(14565847.8908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17351834., device='cuda:3')
distance x is tensor(17351834., device='cuda:3')
________________________________
test distance is  tensor(17351834., device='cuda:3')
test distance1 is  tensor(17351834., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 3703742.2235113033
test entropy is  1.4459573451135712
________________________________
cal ratio is  0.902571993542593
distance x is tensor(15661280., device='cuda:3')
cal_distance is  tensor(15661280., device='cuda:3')
cal ratio is  0.9500378829404783
distance x is tensor(14878810., device='cuda:3')
cal_distance is  tensor(14878810., device='cuda:3')
cal ratio is  0.9746988295850324
distance x is tensor(14502357., device='cuda:3')
cal_distance is  tensor(14502357., device='cuda:3')
distance x is tensor(14502357., device='cuda:3')
return_distance is  tensor(14502357., device='cuda:3')
distance x is tensor(14502357., device='cuda:3')
distance x is tensor(14502357., device='cuda:3')
________________________________
test distance is  tensor(14502357., device='cuda:3')
test distance1 is  tensor(14502357., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10018333348966532
test loss is 3405994.730668007
test entropy is  1.5234411041111326
________________________________
0
distance x is tensor(14502357., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5232287292033115
avg test loss is  4316649.799210891
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(14502357., device='cuda:3')
compute_norm is  tensor(14843213.0281, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15074935., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.052413339808043
avg test loss is  3619862.176717022
avg accuracy is  0.10016666682299866
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15074935., device='cuda:3')
compute_norm is  tensor(14773767.6829, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15644900., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9057383677725599
avg test loss is  3352784.002233565
avg accuracy is  0.10015000015633198
solo acc is  0.10016666682299866
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15644900., device='cuda:3')
compute_norm is  tensor(14704636.2940, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16212214., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.462482941811527
avg test loss is  4514570.848173459
avg accuracy is  0.10016666682299866
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16212214., device='cuda:3')
compute_norm is  tensor(14635839.0092, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16776854., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0575172425841473
avg test loss is  3014523.344178024
avg accuracy is  0.10016666682299866
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16776854., device='cuda:3')
compute_norm is  tensor(14567355.5350, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17338870., device='cuda:3')
________________________________
test distance is  tensor(17338870., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10013333348966531
test loss is 2591104.7248480143
test entropy is  0.9129949911062651
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.4568075984716415
mal norm is  tensor(1.3541e+08, device='cuda:3')
distance x is tensor(17338870., device='cuda:3')
mal distance is  tensor(17338870., device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([2.4017e+02, 7.0925e+08, 2.2526e+02, 2.4517e+02, 2.1161e+02, 1.8217e+02,
        7.8631e+08, 2.0041e+02, 1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08,
        1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08,
        1.3541e+08, 1.3541e+08, 1.1598e+08, 1.1598e+08, 1.1598e+08, 1.1598e+08,
        1.1598e+08, 1.1598e+08, 1.1598e+08, 1.2363e+09], device='cuda:3')
sorted_norm is   tensor([1.8217e+02, 2.0041e+02, 2.1161e+02, 2.2526e+02, 2.4017e+02, 2.4517e+02,
        1.1598e+08, 1.1598e+08, 1.1598e+08, 1.1598e+08, 1.1598e+08, 1.1598e+08,
        1.1598e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08,
        1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08, 1.3541e+08,
        1.3541e+08, 7.0925e+08, 7.8631e+08, 1.2363e+09], device='cuda:3')
used idx is  tensor([ 5,  7,  4,  2,  0,  3, 25, 23, 21, 20, 22, 26, 24, 15, 19, 17, 13,  9,
        11, 18,  8, 10], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.01% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7907870411872864
distance x is tensor(7.3859, device='cuda:3')
benign distance is  tensor(7.3859, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.4699128419160843
distance x is tensor(19945806., device='cuda:3')
benign distance is  tensor(19945806., device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.410237416625023
distance x is tensor(5.7474, device='cuda:3')
benign distance is  tensor(5.7474, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0861286371946335
distance x is tensor(6.7746, device='cuda:3')
benign distance is  tensor(6.7746, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1875263899564743
distance x is tensor(5.7876, device='cuda:3')
benign distance is  tensor(5.7876, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.762242615222931
distance x is tensor(4.2717, device='cuda:3')
benign distance is  tensor(4.2717, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0763211846351624
distance x is tensor(16487237., device='cuda:3')
benign distance is  tensor(16487237., device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.940513402223587
distance x is tensor(5.3950, device='cuda:3')
benign distance is  tensor(5.3950, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.286680817604065
distance x is tensor(6.6153, device='cuda:3')
benign distance is  tensor(6.6153, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.9604794085025787
distance x is tensor(4.6008, device='cuda:3')
benign distance is  tensor(4.6008, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.3322926610708237
distance x is tensor(7.6022, device='cuda:3')
benign distance is  tensor(7.6022, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.1196358948946
distance x is tensor(21330254., device='cuda:3')
benign distance is  tensor(21330254., device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.0716902017593384
distance x is tensor(4.9307, device='cuda:3')
benign distance is  tensor(4.9307, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.8301721662282944
distance x is tensor(5.5489, device='cuda:3')
benign distance is  tensor(5.5489, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.0206103920936584
distance x is tensor(8.0056, device='cuda:3')
benign distance is  tensor(8.0056, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.834146037697792
distance x is tensor(16223509., device='cuda:3')
benign distance is  tensor(16223509., device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(4.7864, device='cuda:3')
compute distance is  tensor(4.7864, device='cuda:3')
compute norm is  tensor(16314563.4263, device='cuda:3', dtype=torch.float64)
distance x is tensor(14860873., device='cuda:3')
compute distance is  tensor(14860873., device='cuda:3')
compute norm is  tensor(20979985.3987, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.1308, device='cuda:3')
compute distance is  tensor(5.1308, device='cuda:3')
compute norm is  tensor(16314564.0521, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.3178, device='cuda:3')
compute distance is  tensor(7.3178, device='cuda:3')
compute norm is  tensor(16314563.9289, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.0944, device='cuda:3')
compute distance is  tensor(8.0944, device='cuda:3')
compute norm is  tensor(16314563.8563, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.9070, device='cuda:3')
compute distance is  tensor(6.9070, device='cuda:3')
compute norm is  tensor(16314563.7804, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.6612, device='cuda:3')
compute distance is  tensor(6.6612, device='cuda:3')
compute norm is  tensor(16314563.8318, device='cuda:3', dtype=torch.float64)
distance x is tensor(4982920., device='cuda:3')
compute distance is  tensor(4982920., device='cuda:3')
compute norm is  tensor(17451283.8114, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.2083, device='cuda:3')
compute distance is  tensor(6.2083, device='cuda:3')
compute norm is  tensor(16314563.8357, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.5623, device='cuda:3')
compute distance is  tensor(6.5623, device='cuda:3')
compute norm is  tensor(16314564.2501, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.8551, device='cuda:3')
compute distance is  tensor(6.8551, device='cuda:3')
compute norm is  tensor(16314563.8053, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.1690, device='cuda:3')
compute distance is  tensor(5.1690, device='cuda:3')
compute norm is  tensor(16314563.9806, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(14860873., device='cuda:3')
distance x is tensor(1.3462e+08, device='cuda:3')
distance x is tensor(1.3462e+08, device='cuda:3')
________________________________
test distance is  tensor(1.3462e+08, device='cuda:3')
test distance1 is  tensor(1.3462e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107605732332803.83
test entropy is  0.0
________________________________
cal ratio is  0.32561068756459155
distance x is tensor(43832648., device='cuda:3')
cal_distance is  tensor(43832648., device='cuda:3')
cal ratio is  0.5706231364045311
distance x is tensor(25011928., device='cuda:3')
cal_distance is  tensor(25011928., device='cuda:3')
cal ratio is  0.7553959493975149
distance x is tensor(18893908., device='cuda:3')
cal_distance is  tensor(18893908., device='cuda:3')
cal ratio is  0.8691352155401357
distance x is tensor(16421359., device='cuda:3')
cal_distance is  tensor(16421359., device='cuda:3')
cal ratio is  0.9322742604397823
distance x is tensor(15309212., device='cuda:3')
cal_distance is  tensor(15309212., device='cuda:3')
cal ratio is  0.9655434519829545
distance x is tensor(14781708., device='cuda:3')
cal_distance is  tensor(14781708., device='cuda:3')
distance x is tensor(14781708., device='cuda:3')
return_distance is  tensor(14781708., device='cuda:3')
distance x is tensor(14781708., device='cuda:3')
distance x is tensor(14781708., device='cuda:3')
________________________________
test distance is  tensor(14781708., device='cuda:3')
test distance1 is  tensor(14781708., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 2872701.8461968843
test entropy is  0.9334649042025812
________________________________
0
distance x is tensor(14781708., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9335915375111709
avg test loss is  3843227.905795788
avg accuracy is  0.10016666682299866
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(14781708., device='cuda:3')
compute_norm is  tensor(14522354.2020, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15341974., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4362307615371654
avg test loss is  3910152.6455469723
avg accuracy is  0.09980000015633197
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(15341974., device='cuda:3')
compute_norm is  tensor(14454399.3646, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15899637., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0412084160328927
avg test loss is  2893553.0786170885
avg accuracy is  0.10016666682299866
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(15899637., device='cuda:3')
compute_norm is  tensor(14386768.7395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16454673., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9118284705732422
avg test loss is  2125304.70911299
avg accuracy is  0.10016666682299866
solo acc is  0.10013333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16454673., device='cuda:3')
compute_norm is  tensor(14319453.6814, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17007118., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.4410618480080482
avg test loss is  2443755.349132665
avg accuracy is  0.10025000015633198
solo acc is  0.10013333348966531
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(17007118., device='cuda:3')
compute_norm is  tensor(14252449.5417, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17556968., device='cuda:3')
distance x is tensor(17556968., device='cuda:3')
________________________________
test distance is  tensor(17556968., device='cuda:3')
test distance1 is  tensor(17556968., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10013333348966531
test loss is 3963547.021951417
test entropy is  1.0549116641727847
________________________________
cal ratio is  0.9016198847340132
distance x is tensor(15829712., device='cuda:3')
cal_distance is  tensor(15829712., device='cuda:3')
cal ratio is  0.9495366420344801
distance x is tensor(15030891., device='cuda:3')
cal_distance is  tensor(15030891., device='cuda:3')
cal ratio is  0.9744417333965426
distance x is tensor(14646726., device='cuda:3')
cal_distance is  tensor(14646726., device='cuda:3')
distance x is tensor(14646726., device='cuda:3')
return_distance is  tensor(14646726., device='cuda:3')
distance x is tensor(14646726., device='cuda:3')
distance x is tensor(14646726., device='cuda:3')
________________________________
test distance is  tensor(14646726., device='cuda:3')
test distance1 is  tensor(14646726., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 3280937.7506957147
test entropy is  1.2111939579439062
________________________________
0
distance x is tensor(14646726., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2112168836186943
avg test loss is  3644266.2899924526
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(14646726., device='cuda:3')
compute_norm is  tensor(14538638.3548, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15207649., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.960008746525372
avg test loss is  2567385.9546275735
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(15207649., device='cuda:3')
compute_norm is  tensor(14470603.0889, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15765913., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4567747377891784
avg test loss is  2983658.3648393247
avg accuracy is  0.10016666682299866
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(15765913., device='cuda:3')
compute_norm is  tensor(14402904.1821, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16321594., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0794257484773584
avg test loss is  3158119.5998937385
avg accuracy is  0.10013333348966531
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16321594., device='cuda:3')
compute_norm is  tensor(14335505.3793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16874638., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9368812364937146
avg test loss is  2382916.334422268
avg accuracy is  0.10015000015633198
solo acc is  0.10018333348966532
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16874638., device='cuda:3')
compute_norm is  tensor(14268434.5702, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17425144., device='cuda:3')
distance x is tensor(17425144., device='cuda:3')
________________________________
test distance is  tensor(17425144., device='cuda:3')
test distance1 is  tensor(17425144., device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.10016666682299866
test loss is 2909036.4241112364
test entropy is  1.4387375254875052
________________________________
cal ratio is  0.9050239147535625
distance x is tensor(15770174., device='cuda:3')
cal_distance is  tensor(15770174., device='cuda:3')
cal ratio is  0.9513273634386331
distance x is tensor(15002599., device='cuda:3')
cal_distance is  tensor(15002599., device='cuda:3')
cal ratio is  0.9753601133732639
distance x is tensor(14632935., device='cuda:3')
cal_distance is  tensor(14632935., device='cuda:3')
distance x is tensor(14632935., device='cuda:3')
return_distance is  tensor(14632935., device='cuda:3')
distance x is tensor(14632935., device='cuda:3')
distance x is tensor(14632935., device='cuda:3')
________________________________
test distance is  tensor(14632935., device='cuda:3')
test distance1 is  tensor(14632935., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10015000015633198
test loss is 3367165.4476713445
test entropy is  1.5287525885140718
________________________________
0
distance x is tensor(14632935., device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5289481226315123
avg test loss is  3499929.6996238623
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(14632935., device='cuda:3')
compute_norm is  tensor(14540239.2387, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15193922., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0651197485578086
avg test loss is  3033425.912598725
avg accuracy is  0.10013333348966531
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(15193922., device='cuda:3')
compute_norm is  tensor(14472196.7740, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15752251., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9163970421753458
avg test loss is  3443698.2473017555
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(15752251., device='cuda:3')
compute_norm is  tensor(14404490.9197, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16307997., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4590377413641924
avg test loss is  2362037.79547537
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16307997., device='cuda:3')
compute_norm is  tensor(14337083.7892, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16861104., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0622569029010944
avg test loss is  3111506.724772135
avg accuracy is  0.10015000015633198
solo acc is  0.10015000015633198
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(16861104., device='cuda:3')
compute_norm is  tensor(14270006.5771, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17411678., device='cuda:3')
________________________________
test distance is  tensor(17411678., device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10016666682299866
test loss is 3101811.043102466
test entropy is  0.9186452350763878
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.4485882073640823
mal norm is  tensor(1.3598e+08, device='cuda:3')
distance x is tensor(17411678., device='cuda:3')
mal distance is  tensor(17411678., device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([2.6393e+02, 7.9069e+08, 2.1273e+02, 2.2713e+02, 2.0051e+02, 1.6494e+02,
        7.4285e+08, 1.9245e+02, 1.3598e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08,
        1.3598e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08,
        1.3598e+08, 1.3598e+08, 1.7720e+08, 1.8082e+08, 1.7720e+08, 1.7720e+08,
        1.7720e+08, 1.7720e+08, 1.7720e+08, 1.8520e+08, 1.3447e+08, 1.3447e+08,
        1.3447e+08, 1.3447e+08, 1.3447e+08, 1.3447e+08, 1.3447e+08, 1.3447e+08,
        1.8492e+07, 1.5291e+08, 1.8492e+07, 1.8492e+07, 3.6848e+07, 1.8492e+07,
        1.8492e+07, 1.8492e+07], device='cuda:3')
sorted_norm is   tensor([1.6494e+02, 1.9245e+02, 2.0051e+02, 2.1273e+02, 2.2713e+02, 2.6393e+02,
        1.8492e+07, 1.8492e+07, 1.8492e+07, 1.8492e+07, 1.8492e+07, 1.8492e+07,
        3.6848e+07, 1.3447e+08, 1.3447e+08, 1.3447e+08, 1.3447e+08, 1.3447e+08,
        1.3447e+08, 1.3447e+08, 1.3447e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08,
        1.3598e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08, 1.3598e+08,
        1.3598e+08, 1.3598e+08, 1.3598e+08, 1.5291e+08, 1.7720e+08, 1.7720e+08,
        1.7720e+08, 1.7720e+08, 1.7720e+08, 1.7720e+08, 1.8082e+08, 1.8520e+08,
        7.4285e+08, 7.9069e+08], device='cuda:3')
used idx is  tensor([ 5,  7,  4,  2,  3,  0, 39, 43, 41, 42, 38, 36, 40, 35, 31, 33, 29, 28,
        32, 34, 30, 18, 12, 14, 10, 16,  8,  9, 17, 11, 15, 13, 19, 37, 26],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.02% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7058973610401154
distance x is tensor(6.5914, device='cuda:3')
benign distance is  tensor(6.5914, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.5211700797080994
distance x is tensor(7.1596, device='cuda:3')
benign distance is  tensor(7.1596, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.464534103870392
distance x is tensor(5.8814, device='cuda:3')
benign distance is  tensor(5.8814, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.040436401963234
distance x is tensor(6.8416, device='cuda:3')
benign distance is  tensor(6.8416, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.212719440460205
distance x is tensor(6.6588, device='cuda:3')
benign distance is  tensor(6.6588, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7530965209007263
distance x is tensor(4.6510, device='cuda:3')
benign distance is  tensor(4.6510, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.1087483763694763
distance x is tensor(5.3875, device='cuda:3')
benign distance is  tensor(5.3875, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.891360878944397
distance x is tensor(5.0960, device='cuda:3')
benign distance is  tensor(5.0960, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.3022695928812027
distance x is tensor(7.7789, device='cuda:3')
benign distance is  tensor(7.7789, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.867155835032463
distance x is tensor(6.3806, device='cuda:3')
benign distance is  tensor(6.3806, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.3870060443878174
distance x is tensor(4.7773, device='cuda:3')
benign distance is  tensor(4.7773, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.596777692437172
distance x is tensor(7.3168, device='cuda:3')
benign distance is  tensor(7.3168, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.1765989661216736
distance x is tensor(7.4054, device='cuda:3')
benign distance is  tensor(7.4054, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.6831354200839996
distance x is tensor(4.5622, device='cuda:3')
benign distance is  tensor(4.5622, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.7492336332798004
distance x is tensor(6.1212, device='cuda:3')
benign distance is  tensor(6.1212, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.5159370750188828
distance x is tensor(7.4994, device='cuda:3')
benign distance is  tensor(7.4994, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.9550970792770386
distance x is tensor(6.3254, device='cuda:3')
benign distance is  tensor(6.3254, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.760453224182129
distance x is tensor(5.8982, device='cuda:3')
benign distance is  tensor(5.8982, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.158219501376152
distance x is tensor(5.5155, device='cuda:3')
benign distance is  tensor(5.5155, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.5924470126628876
distance x is tensor(6.9198, device='cuda:3')
benign distance is  tensor(6.9198, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.788961723446846
distance x is tensor(4.9821, device='cuda:3')
benign distance is  tensor(4.9821, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.9907786548137665
distance x is tensor(6.4888, device='cuda:3')
benign distance is  tensor(6.4888, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.593256637454033
distance x is tensor(4.9916, device='cuda:3')
benign distance is  tensor(4.9916, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.3332832157611847
distance x is tensor(7.5399, device='cuda:3')
benign distance is  tensor(7.5399, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.5995911806821823
distance x is tensor(6.6121, device='cuda:3')
benign distance is  tensor(6.6121, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  3.020459085702896
distance x is tensor(81145088., device='cuda:3')
benign distance is  tensor(81145088., device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.2415907979011536
distance x is tensor(6.1189, device='cuda:3')
benign distance is  tensor(6.1189, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.615378215909004
distance x is tensor(8.3479, device='cuda:3')
benign distance is  tensor(8.3479, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.908753290772438
distance x is tensor(8.1093, device='cuda:3')
benign distance is  tensor(8.1093, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.833230286836624
distance x is tensor(4.0673, device='cuda:3')
benign distance is  tensor(4.0673, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.9646600782871246
distance x is tensor(5.7407, device='cuda:3')
benign distance is  tensor(5.7407, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.686621740460396
distance x is tensor(27398944., device='cuda:3')
benign distance is  tensor(27398944., device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.2119, device='cuda:3')
compute distance is  tensor(5.2119, device='cuda:3')
compute norm is  tensor(16213320.8275, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.6401, device='cuda:3')
compute distance is  tensor(6.6401, device='cuda:3')
compute norm is  tensor(16213321.4334, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.8286, device='cuda:3')
compute distance is  tensor(4.8286, device='cuda:3')
compute norm is  tensor(16213321.3537, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.7082, device='cuda:3')
compute distance is  tensor(6.7082, device='cuda:3')
compute norm is  tensor(16213321.2933, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.8852, device='cuda:3')
compute distance is  tensor(6.8852, device='cuda:3')
compute norm is  tensor(16213321.1604, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2615, device='cuda:3')
compute distance is  tensor(7.2615, device='cuda:3')
compute norm is  tensor(16213321.1812, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.4183, device='cuda:3')
compute distance is  tensor(6.4183, device='cuda:3')
compute norm is  tensor(16213321.2049, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.3757, device='cuda:3')
compute distance is  tensor(6.3757, device='cuda:3')
compute norm is  tensor(16213321.5377, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.9107, device='cuda:3')
compute distance is  tensor(5.9107, device='cuda:3')
compute norm is  tensor(16213321.2009, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.0407, device='cuda:3')
compute distance is  tensor(7.0407, device='cuda:3')
compute norm is  tensor(16213321.6097, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.9743, device='cuda:3')
compute distance is  tensor(6.9743, device='cuda:3')
compute norm is  tensor(16213321.2399, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.2611e+09, device='cuda:3')
compute distance is  tensor(1.2611e+09, device='cuda:3')
compute norm is  tensor(6.1089e+08, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(1.2611e+09, device='cuda:3')
distance x is tensor(1.3385e+08, device='cuda:3')
distance x is tensor(1.3385e+08, device='cuda:3')
________________________________
test distance is  tensor(1.3385e+08, device='cuda:3')
test distance1 is  tensor(1.3385e+08, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107495963784119.95
test entropy is  0.0
________________________________
0
distance x is tensor(1.3385e+08, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107537888097312.75
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1420, device='cuda:3')
compute_distance is  tensor(1.3385e+08, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.9229e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.44042309935861e-05
avg test loss is  18099.93576351768
avg accuracy is  0.09970000015633199
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9952, device='cuda:3')
compute_distance is  tensor(2.9229e+10, device='cuda:3')
compute_norm is  tensor(3.5606e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.9092e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1553838535793808
avg test loss is  14538.562999234526
avg accuracy is  0.10086666682299866
solo acc is  0.09978333348966531
compute similarity  is  tensor(0.9952, device='cuda:3')
compute_distance is  tensor(2.9092e+10, device='cuda:3')
compute_norm is  tensor(3.5440e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.8955e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.623655329253882
avg test loss is  15097.668085410396
avg accuracy is  0.100550000156332
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9952, device='cuda:3')
compute_distance is  tensor(2.8955e+10, device='cuda:3')
compute_norm is  tensor(3.5274e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.8819e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2697998986188284
avg test loss is  10511.292498696841
avg accuracy is  0.09946666682299866
solo acc is  0.09971666682299865
compute similarity  is  tensor(0.9952, device='cuda:3')
compute_distance is  tensor(2.8819e+10, device='cuda:3')
compute_norm is  tensor(3.5109e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.8684e+10, device='cuda:3')
distance x is tensor(2.8684e+10, device='cuda:3')
________________________________
test distance is  tensor(2.8684e+10, device='cuda:3')
test distance1 is  tensor(2.8684e+10, device='cuda:3')
test similarity is  tensor(0.9952, device='cuda:3')
test acc is  0.10001666682299865
test loss is 19189.82355653884
test entropy is  0.6500463955628593
________________________________
cal ratio is  0.20549021848779378
distance x is tensor(5.8942e+09, device='cuda:3')
cal_distance is  tensor(5.8942e+09, device='cuda:3')
cal ratio is  0.4533102802709818
distance x is tensor(2.6719e+09, device='cuda:3')
cal_distance is  tensor(2.6719e+09, device='cuda:3')
cal ratio is  0.6732832175983212
distance x is tensor(1.7990e+09, device='cuda:3')
cal_distance is  tensor(1.7990e+09, device='cuda:3')
cal ratio is  0.8205383567654841
distance x is tensor(1.4761e+09, device='cuda:3')
cal_distance is  tensor(1.4761e+09, device='cuda:3')
cal ratio is  0.9058357656938122
distance x is tensor(1.3371e+09, device='cuda:3')
cal_distance is  tensor(1.3371e+09, device='cuda:3')
cal ratio is  0.951754015274035
distance x is tensor(1.2726e+09, device='cuda:3')
cal_distance is  tensor(1.2726e+09, device='cuda:3')
cal ratio is  0.9755788280697694
distance x is tensor(1.2415e+09, device='cuda:3')
cal_distance is  tensor(1.2415e+09, device='cuda:3')
distance x is tensor(1.2415e+09, device='cuda:3')
return_distance is  tensor(1.2415e+09, device='cuda:3')
distance x is tensor(1.2415e+09, device='cuda:3')
distance x is tensor(1.2415e+09, device='cuda:3')
________________________________
test distance is  tensor(1.2415e+09, device='cuda:3')
test distance1 is  tensor(1.2415e+09, device='cuda:3')
test similarity is  tensor(0.9960, device='cuda:3')
test acc is  0.10018333348966532
test loss is 290870138211.67755
test entropy is  1.832139352110149
________________________________
0
distance x is tensor(1.2415e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8318041613869576
avg test loss is  321622063291.3198
avg accuracy is  0.10000000015633201
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.2415e+09, device='cuda:3')
compute_norm is  tensor(1.6671e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2351e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.168294190597941
avg test loss is  300665390283.0225
avg accuracy is  0.09961666682299866
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.2351e+09, device='cuda:3')
compute_norm is  tensor(1.6593e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2287e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9637692122698338
avg test loss is  279610161946.95135
avg accuracy is  0.099450000156332
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.2287e+09, device='cuda:3')
compute_norm is  tensor(1.6515e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2223e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4564564724975049
avg test loss is  348619680986.49084
avg accuracy is  0.09918333348966533
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.2223e+09, device='cuda:3')
compute_norm is  tensor(1.6438e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2160e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0749705506286134
avg test loss is  410717061663.9318
avg accuracy is  0.09933333348966535
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.2160e+09, device='cuda:3')
compute_norm is  tensor(1.6361e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2097e+09, device='cuda:3')
distance x is tensor(1.2097e+09, device='cuda:3')
________________________________
test distance is  tensor(1.2097e+09, device='cuda:3')
test distance1 is  tensor(1.2097e+09, device='cuda:3')
test similarity is  tensor(0.9960, device='cuda:3')
test acc is  0.10018333348966532
test loss is 320754253553.8402
test entropy is  0.9286728252861292
________________________________
0
distance x is tensor(1.2097e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9286171722132514
avg test loss is  356756438134.54755
avg accuracy is  0.09943333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.2097e+09, device='cuda:3')
compute_norm is  tensor(1.6284e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2034e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4466859398366037
avg test loss is  240133935527.0776
avg accuracy is  0.10006666682299867
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.2034e+09, device='cuda:3')
compute_norm is  tensor(1.6208e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.1971e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.073722025860093
avg test loss is  189654030353.18518
avg accuracy is  0.09986666682299865
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.1971e+09, device='cuda:3')
compute_norm is  tensor(1.6132e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.1909e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.930835836096359
avg test loss is  263886259873.45264
avg accuracy is  0.09936666682299866
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.1909e+09, device='cuda:3')
compute_norm is  tensor(1.6057e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.1847e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.4423692206075704
avg test loss is  286583795881.4641
avg accuracy is  0.09938333348966533
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.1847e+09, device='cuda:3')
compute_norm is  tensor(1.5982e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.1785e+09, device='cuda:3')
________________________________
test distance is  tensor(1.1785e+09, device='cuda:3')
test similarity is  tensor(0.9960, device='cuda:3')
test acc is  0.09976666682299866
test loss is 307685693964.66327
test entropy is  1.118948173548367
________________________________
final entropy
distance x is tensor(1.1785e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.118899180055427
avg test loss is  277522589598.9665
avg accuracy is  0.09973333348966532
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9960, device='cuda:3')
compute_distance is  tensor(1.1785e+09, device='cuda:3')
compute_norm is  tensor(1.5907e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.399225428700447
mal norm is  tensor(9.1590e+09, device='cuda:3')
distance x is tensor(1.1724e+09, device='cuda:3')
mal distance is  tensor(1.1724e+09, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([2.4147e+02, 2.5542e+02, 2.2210e+02, 2.3133e+02, 2.4023e+02, 1.7508e+02,
        1.7861e+02, 1.8071e+02, 9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09,
        9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09,
        9.1590e+09, 9.1590e+09], device='cuda:3')
sorted_norm is   tensor([1.7508e+02, 1.7861e+02, 1.8071e+02, 2.2210e+02, 2.3133e+02, 2.4023e+02,
        2.4147e+02, 2.5542e+02, 9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09,
        9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09, 9.1590e+09,
        9.1590e+09, 9.1590e+09], device='cuda:3')
used idx is  tensor([ 5,  6,  7,  2,  3,  4,  0,  1, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.02% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6822619885206223
distance x is tensor(7.2129, device='cuda:3')
benign distance is  tensor(7.2129, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.4700014293193817
distance x is tensor(7.1445, device='cuda:3')
benign distance is  tensor(7.1445, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.3312265276908875
distance x is tensor(5.9408, device='cuda:3')
benign distance is  tensor(5.9408, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.105902686715126
distance x is tensor(6.8244, device='cuda:3')
benign distance is  tensor(6.8244, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.154247060418129
distance x is tensor(6.0761, device='cuda:3')
benign distance is  tensor(6.0761, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.744895711541176
distance x is tensor(4.5409, device='cuda:3')
benign distance is  tensor(4.5409, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.104116141796112
distance x is tensor(6.2790, device='cuda:3')
benign distance is  tensor(6.2790, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9956085979938507
distance x is tensor(5.5212, device='cuda:3')
benign distance is  tensor(5.5212, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.1525, device='cuda:3')
compute distance is  tensor(5.1525, device='cuda:3')
compute norm is  tensor(87245763.1774, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.8589, device='cuda:3')
compute distance is  tensor(6.8589, device='cuda:3')
compute norm is  tensor(87245763.6968, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.1851, device='cuda:3')
compute distance is  tensor(5.1851, device='cuda:3')
compute norm is  tensor(87245763.6799, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.1530, device='cuda:3')
compute distance is  tensor(7.1530, device='cuda:3')
compute norm is  tensor(87245763.5591, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.0955, device='cuda:3')
compute distance is  tensor(8.0955, device='cuda:3')
compute norm is  tensor(87245763.5378, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.9404, device='cuda:3')
compute distance is  tensor(6.9404, device='cuda:3')
compute norm is  tensor(87245763.4538, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.6084, device='cuda:3')
compute distance is  tensor(6.6084, device='cuda:3')
compute norm is  tensor(87245763.4743, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.3437, device='cuda:3')
compute distance is  tensor(6.3437, device='cuda:3')
compute norm is  tensor(87245763.8658, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.0980, device='cuda:3')
compute distance is  tensor(6.0980, device='cuda:3')
compute norm is  tensor(87245763.4819, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.5031, device='cuda:3')
compute distance is  tensor(6.5031, device='cuda:3')
compute norm is  tensor(87245763.8325, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.3419, device='cuda:3')
compute distance is  tensor(7.3419, device='cuda:3')
compute norm is  tensor(87245763.5185, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.7331e+09, device='cuda:3')
compute distance is  tensor(8.7331e+09, device='cuda:3')
compute norm is  tensor(4.6437e+09, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(8.7331e+09, device='cuda:3')
distance x is tensor(7.1978e+08, device='cuda:3')
distance x is tensor(7.1978e+08, device='cuda:3')
________________________________
test distance is  tensor(7.1978e+08, device='cuda:3')
test distance1 is  tensor(7.1978e+08, device='cuda:3')
test similarity is  tensor(-0.1421, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107564605643874.25
test entropy is  0.0
________________________________
0
distance x is tensor(7.1978e+08, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107555763586002.16
avg accuracy is  0.10018333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1421, device='cuda:3')
compute_distance is  tensor(7.1978e+08, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.8190e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.328121022976089e-05
avg test loss is  10995.314635986459
avg accuracy is  0.09945000015633197
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9964, device='cuda:3')
compute_distance is  tensor(2.8190e+10, device='cuda:3')
compute_norm is  tensor(3.5053e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.8055e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1516354382673561
avg test loss is  23631.96797566526
avg accuracy is  0.10015000015633199
solo acc is  0.10046666682299864
compute similarity  is  tensor(0.9964, device='cuda:3')
compute_distance is  tensor(2.8055e+10, device='cuda:3')
compute_norm is  tensor(3.4889e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.7920e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6279448754688316
avg test loss is  11331.667665921803
avg accuracy is  0.10091666682299869
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9964, device='cuda:3')
compute_distance is  tensor(2.7920e+10, device='cuda:3')
compute_norm is  tensor(3.4725e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.7786e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2714619796032083
avg test loss is  21139.549056096625
avg accuracy is  0.10101666682299866
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9964, device='cuda:3')
compute_distance is  tensor(2.7786e+10, device='cuda:3')
compute_norm is  tensor(3.4563e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.7653e+10, device='cuda:3')
distance x is tensor(2.7653e+10, device='cuda:3')
________________________________
test distance is  tensor(2.7653e+10, device='cuda:3')
test distance1 is  tensor(2.7653e+10, device='cuda:3')
test similarity is  tensor(0.9964, device='cuda:3')
test acc is  0.10005000015633199
test loss is 11844.198976979073
test entropy is  0.6533288310395121
________________________________
cal ratio is  0.5507337287801419
distance x is tensor(1.5229e+10, device='cuda:3')
cal_distance is  tensor(1.5229e+10, device='cuda:3')
cal ratio is  0.7421143692287088
distance x is tensor(1.1302e+10, device='cuda:3')
cal_distance is  tensor(1.1302e+10, device='cuda:3')
cal ratio is  0.8614605373752603
distance x is tensor(9.7361e+09, device='cuda:3')
cal_distance is  tensor(9.7361e+09, device='cuda:3')
cal ratio is  0.9281489930310854
distance x is tensor(9.0365e+09, device='cuda:3')
cal_distance is  tensor(9.0365e+09, device='cuda:3')
cal ratio is  0.963404909090598
distance x is tensor(8.7059e+09, device='cuda:3')
cal_distance is  tensor(8.7059e+09, device='cuda:3')
distance x is tensor(8.7059e+09, device='cuda:3')
return_distance is  tensor(8.7059e+09, device='cuda:3')
distance x is tensor(8.7059e+09, device='cuda:3')
distance x is tensor(8.7059e+09, device='cuda:3')
________________________________
test distance is  tensor(8.7059e+09, device='cuda:3')
test distance1 is  tensor(8.7059e+09, device='cuda:3')
test similarity is  tensor(0.9968, device='cuda:3')
test acc is  0.10003333348966531
test loss is 5641959915170.336
test entropy is  0.7692888330803243
________________________________
0
distance x is tensor(8.7059e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7696268909267271
avg test loss is  5254924743736.182
avg accuracy is  0.09903333348966532
solo acc is  0.10051666682299865
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.7059e+09, device='cuda:3')
compute_norm is  tensor(1.1427e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.6618e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3725171164154752
avg test loss is  8446721280490.963
avg accuracy is  0.09896666682299866
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.6618e+09, device='cuda:3')
compute_norm is  tensor(1.1373e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.6179e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.808304098178583
avg test loss is  7730981355031.954
avg accuracy is  0.099600000156332
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.6179e+09, device='cuda:3')
compute_norm is  tensor(1.1320e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.5742e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4827542894684684
avg test loss is  3599185978789.8374
avg accuracy is  0.099150000156332
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.5742e+09, device='cuda:3')
compute_norm is  tensor(1.1267e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.5307e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8519289912953814
avg test loss is  6546790950672.807
avg accuracy is  0.09965000015633198
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.5307e+09, device='cuda:3')
compute_norm is  tensor(1.1214e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.4874e+09, device='cuda:3')
distance x is tensor(8.4874e+09, device='cuda:3')
________________________________
test distance is  tensor(8.4874e+09, device='cuda:3')
test distance1 is  tensor(8.4874e+09, device='cuda:3')
test similarity is  tensor(0.9968, device='cuda:3')
test acc is  0.10016666682299866
test loss is 5927822077524.794
test entropy is  1.493309701683679
________________________________
0
distance x is tensor(8.4874e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4922948089489805
avg test loss is  8426044113116.457
avg accuracy is  0.10098333348966532
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.4874e+09, device='cuda:3')
compute_norm is  tensor(1.1162e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.4444e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8635925392606365
avg test loss is  6677987906237.129
avg accuracy is  0.10078333348966531
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.4444e+09, device='cuda:3')
compute_norm is  tensor(1.1110e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.4015e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4987112933130406
avg test loss is  6911792213322.717
avg accuracy is  0.10016666682299867
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.4015e+09, device='cuda:3')
compute_norm is  tensor(1.1058e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.3588e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.873999044203809
avg test loss is  5802280456317.49
avg accuracy is  0.09960000015633198
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.3588e+09, device='cuda:3')
compute_norm is  tensor(1.1006e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.3163e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5058704393504778
avg test loss is  2178493092737.9885
avg accuracy is  0.09991666682299868
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(8.3163e+09, device='cuda:3')
compute_norm is  tensor(1.0954e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.2741e+09, device='cuda:3')
________________________________
test distance is  tensor(8.2741e+09, device='cuda:3')
test similarity is  tensor(0.9968, device='cuda:3')
test acc is  0.10006666682299865
test loss is 6044841648353.656
test entropy is  0.881715675279784
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.4988408386707306
mal norm is  tensor(6.4634e+10, device='cuda:3')
distance x is tensor(8.2741e+09, device='cuda:3')
mal distance is  tensor(8.2741e+09, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([2.4885e+02, 2.5242e+02, 2.0740e+02, 2.2839e+02, 2.1825e+02, 1.6894e+02,
        2.0746e+02, 1.9708e+02, 6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10,
        6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10,
        6.4634e+10, 6.4634e+10, 4.4391e+09, 4.4391e+09, 4.6841e+09, 4.4391e+09,
        4.4391e+09, 4.5121e+09, 4.4391e+09, 4.4391e+09, 4.5729e+09, 4.5729e+09,
        4.5729e+09, 4.7179e+09, 4.5729e+09, 4.5729e+09, 4.5729e+09, 4.6218e+09,
        4.5795e+09, 4.5795e+09, 4.5795e+09, 4.5795e+09, 4.5795e+09, 4.5795e+09,
        4.5795e+09, 4.5795e+09], device='cuda:3')
sorted_norm is   tensor([1.6894e+02, 1.9708e+02, 2.0740e+02, 2.0746e+02, 2.1825e+02, 2.2839e+02,
        2.4885e+02, 2.5242e+02, 4.4391e+09, 4.4391e+09, 4.4391e+09, 4.4391e+09,
        4.4391e+09, 4.4391e+09, 4.5121e+09, 4.5729e+09, 4.5729e+09, 4.5729e+09,
        4.5729e+09, 4.5729e+09, 4.5729e+09, 4.5795e+09, 4.5795e+09, 4.5795e+09,
        4.5795e+09, 4.5795e+09, 4.5795e+09, 4.5795e+09, 4.5795e+09, 4.6218e+09,
        4.6841e+09, 4.7179e+09, 6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10,
        6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10, 6.4634e+10,
        6.4634e+10, 6.4634e+10], device='cuda:3')
used idx is  tensor([ 5,  7,  2,  6,  4,  3,  0,  1, 21, 20, 26, 24, 27, 23, 25, 34, 28, 32,
        33, 29, 30, 40, 36, 42, 38, 43, 41, 39, 37, 35, 22, 31, 10,  8, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6601212471723557
distance x is tensor(6.8105, device='cuda:3')
benign distance is  tensor(6.8105, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.469049170613289
distance x is tensor(7.4612, device='cuda:3')
benign distance is  tensor(7.4612, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.420744612812996
distance x is tensor(6.6659, device='cuda:3')
benign distance is  tensor(6.6659, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.1011694371700287
distance x is tensor(6.3577, device='cuda:3')
benign distance is  tensor(6.3577, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.200520321726799
distance x is tensor(6.9351, device='cuda:3')
benign distance is  tensor(6.9351, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.761243224143982
distance x is tensor(4.1212, device='cuda:3')
benign distance is  tensor(4.1212, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0630006790161133
distance x is tensor(5.4719, device='cuda:3')
benign distance is  tensor(5.4719, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.907759189605713
distance x is tensor(5.0139, device='cuda:3')
benign distance is  tensor(5.0139, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.080572947859764
distance x is tensor(7.5301, device='cuda:3')
benign distance is  tensor(7.5301, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.8973288387060165
distance x is tensor(3.3233e+10, device='cuda:3')
benign distance is  tensor(3.3233e+10, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.306734636425972
distance x is tensor(5.5704, device='cuda:3')
benign distance is  tensor(5.5704, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5705947130918503
distance x is tensor(7.2157, device='cuda:3')
benign distance is  tensor(7.2157, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.1794063299894333
distance x is tensor(7.9862, device='cuda:3')
benign distance is  tensor(7.9862, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.6983502954244614
distance x is tensor(4.7607, device='cuda:3')
benign distance is  tensor(4.7607, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.7234524935483932
distance x is tensor(5.3712, device='cuda:3')
benign distance is  tensor(5.3712, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.51991768181324
distance x is tensor(7.5091, device='cuda:3')
benign distance is  tensor(7.5091, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.400742217898369
distance x is tensor(5.9504, device='cuda:3')
benign distance is  tensor(5.9504, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.976163938641548
distance x is tensor(4.1509, device='cuda:3')
benign distance is  tensor(4.1509, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.3247572481632233
distance x is tensor(7.0186, device='cuda:3')
benign distance is  tensor(7.0186, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.1069883853197098
distance x is tensor(5.2819e+11, device='cuda:3')
benign distance is  tensor(5.2819e+11, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.0372808277606964
distance x is tensor(4.9957, device='cuda:3')
benign distance is  tensor(4.9957, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.796195313334465
distance x is tensor(7.1677, device='cuda:3')
benign distance is  tensor(7.1677, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.020599141716957
distance x is tensor(7.8947, device='cuda:3')
benign distance is  tensor(7.8947, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.834135428071022
distance x is tensor(1.2581e+11, device='cuda:3')
benign distance is  tensor(1.2581e+11, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.856573700904846
distance x is tensor(8.0924, device='cuda:3')
benign distance is  tensor(8.0924, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.533050000667572
distance x is tensor(7.3574, device='cuda:3')
benign distance is  tensor(7.3574, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.9518823474645615
distance x is tensor(1.6631e+11, device='cuda:3')
benign distance is  tensor(1.6631e+11, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  3.2131805419921875
distance x is tensor(8.4672, device='cuda:3')
benign distance is  tensor(8.4672, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.6861241459846497
distance x is tensor(5.0870, device='cuda:3')
benign distance is  tensor(5.0870, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  3.324812576174736
distance x is tensor(8.6195, device='cuda:3')
benign distance is  tensor(8.6195, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.2266719341278076
distance x is tensor(5.5262, device='cuda:3')
benign distance is  tensor(5.5262, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.541720926761627
distance x is tensor(5.9255, device='cuda:3')
benign distance is  tensor(5.9255, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(6.1275, device='cuda:3')
compute distance is  tensor(6.1275, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.9640e+10, device='cuda:3')
compute distance is  tensor(8.9640e+10, device='cuda:3')
compute norm is  tensor(7.8268e+10, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.9249, device='cuda:3')
compute distance is  tensor(4.9249, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.1220, device='cuda:3')
compute distance is  tensor(6.1220, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.1596, device='cuda:3')
compute distance is  tensor(7.1596, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2029, device='cuda:3')
compute distance is  tensor(7.2029, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2685, device='cuda:3')
compute distance is  tensor(7.2685, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.1421e+10, device='cuda:3')
compute distance is  tensor(6.1421e+10, device='cuda:3')
compute norm is  tensor(5.4860e+10, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.5560, device='cuda:3')
compute distance is  tensor(5.5560, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2907, device='cuda:3')
compute distance is  tensor(7.2907, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.5122, device='cuda:3')
compute distance is  tensor(7.5122, device='cuda:3')
compute norm is  tensor(1.2499e+08, device='cuda:3', dtype=torch.float64)
distance x is tensor(nan, device='cuda:3')
compute distance is  tensor(nan, device='cuda:3')
compute norm is  tensor(nan, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(nan, device='cuda:3')
distance x is tensor(1.0322e+09, device='cuda:3')
distance x is tensor(1.0322e+09, device='cuda:3')
________________________________
test distance is  tensor(1.0322e+09, device='cuda:3')
test distance1 is  tensor(1.0322e+09, device='cuda:3')
test similarity is  tensor(-0.1422, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107663601493871.89
test entropy is  0.0
________________________________
0
distance x is tensor(1.0322e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107531671673744.64
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1422, device='cuda:3')
compute_distance is  tensor(1.0322e+09, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.8501e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.329151754679063e-05
avg test loss is  17210.50070052157
avg accuracy is  0.09928333348966531
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.8501e+10, device='cuda:3')
compute_norm is  tensor(3.5825e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.8363e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.168431470071329
avg test loss is  16217.114863821438
avg accuracy is  0.10010000015633198
solo acc is  0.1001333334896653
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.8363e+10, device='cuda:3')
compute_norm is  tensor(3.5658e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.8225e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6218927902644122
avg test loss is  18798.27607992158
avg accuracy is  0.10003333348966531
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.8225e+10, device='cuda:3')
compute_norm is  tensor(3.5491e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.8088e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.265014740831054
avg test loss is  23612.22244506528
avg accuracy is  0.09993333348966532
solo acc is  0.10036666682299863
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.8088e+10, device='cuda:3')
compute_norm is  tensor(3.5325e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.7952e+10, device='cuda:3')
distance x is tensor(2.7952e+10, device='cuda:3')
________________________________
test distance is  tensor(2.7952e+10, device='cuda:3')
test distance1 is  tensor(2.7952e+10, device='cuda:3')
test similarity is  tensor(0.9959, device='cuda:3')
test acc is  0.10003333348966531
test loss is 24790.856738750615
test entropy is  0.6537611078478889
________________________________
0
distance x is tensor(2.7952e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.649752455829049
avg test loss is  21998.698192493746
avg accuracy is  0.10030000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7952e+10, device='cuda:3')
compute_norm is  tensor(3.5159e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.7817e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3113248805755746
avg test loss is  21998.408480634058
avg accuracy is  0.10025000015633198
solo acc is  0.10021666682299865
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7817e+10, device='cuda:3')
compute_norm is  tensor(3.4995e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.7682e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6757660928184289
avg test loss is  27553.69564266093
avg accuracy is  0.10010000015633198
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7682e+10, device='cuda:3')
compute_norm is  tensor(3.4831e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.7547e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3205060182349768
avg test loss is  13305.681860631208
avg accuracy is  0.10035000015633198
solo acc is  0.09988333348966531
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7547e+10, device='cuda:3')
compute_norm is  tensor(3.4668e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.7414e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6788084700163494
avg test loss is  10005.715682690587
avg accuracy is  0.09996666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7414e+10, device='cuda:3')
compute_norm is  tensor(3.4506e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.7281e+10, device='cuda:3')
distance x is tensor(2.7281e+10, device='cuda:3')
________________________________
test distance is  tensor(2.7281e+10, device='cuda:3')
test distance1 is  tensor(2.7281e+10, device='cuda:3')
test similarity is  tensor(0.9959, device='cuda:3')
test acc is  0.09981666682299865
test loss is 12450.96379110503
test entropy is  1.3349527528545242
________________________________
0
distance x is tensor(2.7281e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3371936473002566
avg test loss is  19808.837002075303
avg accuracy is  0.09993333348966532
solo acc is  0.10020000015633197
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7281e+10, device='cuda:3')
compute_norm is  tensor(3.4345e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.7148e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6793805110429142
avg test loss is  8588.544266796569
avg accuracy is  0.09986666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7148e+10, device='cuda:3')
compute_norm is  tensor(3.4184e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.7016e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3489959018825213
avg test loss is  19803.00732211035
avg accuracy is  0.09988333348966531
solo acc is  0.10015000015633198
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.7016e+10, device='cuda:3')
compute_norm is  tensor(3.4024e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.6885e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7021391495331518
avg test loss is  13363.413130368504
avg accuracy is  0.09941666682299866
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.6885e+10, device='cuda:3')
compute_norm is  tensor(3.3865e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2.6754e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.373462632520875
avg test loss is  7673.051372765986
avg accuracy is  0.10075000015633198
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.9959, device='cuda:3')
compute_distance is  tensor(2.6754e+10, device='cuda:3')
compute_norm is  tensor(3.3706e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2.6624e+10, device='cuda:3')
________________________________
test distance is  tensor(2.6624e+10, device='cuda:3')
test similarity is  tensor(0.9959, device='cuda:3')
test acc is  0.10021666682299865
test loss is 4607.4973370652715
test entropy is  0.7051110000752691
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.8938608914613724
mal norm is  tensor(2.0813e+11, device='cuda:3')
distance x is tensor(2.6624e+10, device='cuda:3')
mal distance is  tensor(2.6624e+10, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([2.4929e+02, 2.7179e+02, 2.4121e+02, 2.1309e+02, 2.4253e+02, 1.4962e+02,
        1.8590e+02, 1.8007e+02, 2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11,
        2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11,
        2.0813e+11, 2.0813e+11], device='cuda:3')
sorted_norm is   tensor([1.4962e+02, 1.8007e+02, 1.8590e+02, 2.1309e+02, 2.4121e+02, 2.4253e+02,
        2.4929e+02, 2.7179e+02, 2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11,
        2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11, 2.0813e+11,
        2.0813e+11, 2.0813e+11], device='cuda:3')
used idx is  tensor([ 5,  7,  6,  3,  2,  4,  0,  1, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 6.33% 

Test Accuracy: 10.01% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.761476993560791
distance x is tensor(7037.5000, device='cuda:3')
benign distance is  tensor(7037.5000, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.6894827783107758
distance x is tensor(11052.9121, device='cuda:3')
benign distance is  tensor(11052.9121, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.57173390686512
distance x is tensor(9044.6621, device='cuda:3')
benign distance is  tensor(9044.6621, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.267211928963661
distance x is tensor(8042.1094, device='cuda:3')
benign distance is  tensor(8042.1094, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.188118740916252
distance x is tensor(8040.6279, device='cuda:3')
benign distance is  tensor(8040.6279, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.9008390605449677
distance x is tensor(9044.5703, device='cuda:3')
benign distance is  tensor(9044.5703, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.1259325593709946
distance x is tensor(10048.3975, device='cuda:3')
benign distance is  tensor(10048.3975, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.1588162034749985
distance x is tensor(6031.8740, device='cuda:3')
benign distance is  tensor(6031.8740, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(7035.7368, device='cuda:3')
compute distance is  tensor(7035.7368, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.2821e+13, device='cuda:3')
compute distance is  tensor(1.2821e+13, device='cuda:3')
compute norm is  tensor(1.1047e+13, device='cuda:3', dtype=torch.float64)
distance x is tensor(10047.8965, device='cuda:3')
compute distance is  tensor(10047.8965, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8040.9790, device='cuda:3')
compute distance is  tensor(8040.9790, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9045.3477, device='cuda:3')
compute distance is  tensor(9045.3477, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(10049.0830, device='cuda:3')
compute distance is  tensor(10049.0830, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7037.1885, device='cuda:3')
compute distance is  tensor(7037.1885, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3906e+13, device='cuda:3')
compute distance is  tensor(1.3906e+13, device='cuda:3')
compute norm is  tensor(1.1980e+13, device='cuda:3', dtype=torch.float64)
distance x is tensor(8040.9521, device='cuda:3')
compute distance is  tensor(8040.9521, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8040.3940, device='cuda:3')
compute distance is  tensor(8040.3940, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(10049.1680, device='cuda:3')
compute distance is  tensor(10049.1680, device='cuda:3')
compute norm is  tensor(1.7397e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.4577e+13, device='cuda:3')
compute distance is  tensor(4.4577e+13, device='cuda:3')
compute norm is  tensor(2.9215e+13, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(4.4577e+13, device='cuda:3')
distance x is tensor(1.4341e+10, device='cuda:3')
distance x is tensor(1.4341e+10, device='cuda:3')
________________________________
test distance is  tensor(1.4341e+10, device='cuda:3')
test distance1 is  tensor(1.4341e+10, device='cuda:3')
test similarity is  tensor(-0.1420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107611392300117.16
test entropy is  0.0
________________________________
0
distance x is tensor(1.4341e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107542937878353.33
avg accuracy is  0.10051666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1420, device='cuda:3')
compute_distance is  tensor(1.4341e+10, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4698e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.317058524376761e-05
avg test loss is  28002.842569375596
avg accuracy is  0.10020000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.4698e+10, device='cuda:3')
compute_norm is  tensor(3.5169e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4562e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1673798679288772
avg test loss is  13531.643975885183
avg accuracy is  0.10028333348966531
solo acc is  0.09993333348966532
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.4562e+10, device='cuda:3')
compute_norm is  tensor(3.5004e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.4428e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6235710249653758
avg test loss is  11970.566225101444
avg accuracy is  0.10020000015633199
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.4428e+10, device='cuda:3')
compute_norm is  tensor(3.4840e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4293e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2707596690034562
avg test loss is  16458.056316984235
avg accuracy is  0.10025000015633198
solo acc is  0.1000833334896653
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.4293e+10, device='cuda:3')
compute_norm is  tensor(3.4677e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.4160e+10, device='cuda:3')
distance x is tensor(1.4160e+10, device='cuda:3')
________________________________
test distance is  tensor(1.4160e+10, device='cuda:3')
test distance1 is  tensor(1.4160e+10, device='cuda:3')
test similarity is  tensor(0.9949, device='cuda:3')
test acc is  0.10001666682299865
test loss is 12390.02404995844
test entropy is  0.653970069531947
________________________________
0
distance x is tensor(1.4160e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6509968059848367
avg test loss is  10026.131873808945
avg accuracy is  0.10028333348966531
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.4160e+10, device='cuda:3')
compute_norm is  tensor(3.4515e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4027e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3031383252093025
avg test loss is  26147.430393811992
avg accuracy is  0.09966666682299866
solo acc is  0.10026666682299865
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.4027e+10, device='cuda:3')
compute_norm is  tensor(3.4354e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3895e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.667666057533801
avg test loss is  12352.554532417611
avg accuracy is  0.10023333348966532
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.3895e+10, device='cuda:3')
compute_norm is  tensor(3.4193e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3763e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3342606596855213
avg test loss is  13866.623188431075
avg accuracy is  0.10011666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.3763e+10, device='cuda:3')
compute_norm is  tensor(3.4033e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3632e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6804979259271358
avg test loss is  21542.507124258256
avg accuracy is  0.10008333348966532
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.3632e+10, device='cuda:3')
compute_norm is  tensor(3.3874e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3502e+10, device='cuda:3')
distance x is tensor(1.3502e+10, device='cuda:3')
________________________________
test distance is  tensor(1.3502e+10, device='cuda:3')
test distance1 is  tensor(1.3502e+10, device='cuda:3')
test similarity is  tensor(0.9949, device='cuda:3')
test acc is  0.10016666682299866
test loss is 23950.72550780941
test entropy is  1.3338783276614858
________________________________
0
distance x is tensor(1.3502e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3302774642830464
avg test loss is  18697.251513887317
avg accuracy is  0.10018333348966532
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.3502e+10, device='cuda:3')
compute_norm is  tensor(3.3715e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3372e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6852885074834071
avg test loss is  2909.478943891871
avg accuracy is  0.09946666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.3372e+10, device='cuda:3')
compute_norm is  tensor(3.3557e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3243e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3551589605142313
avg test loss is  14064.351066448795
avg accuracy is  0.09968333348966532
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.3243e+10, device='cuda:3')
compute_norm is  tensor(3.3400e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3115e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.70269577665878
avg test loss is  14787.993577416772
avg accuracy is  0.10045000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.3115e+10, device='cuda:3')
compute_norm is  tensor(3.3244e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2987e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.361557192385578
avg test loss is  15662.022041354352
avg accuracy is  0.09981666682299865
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9949, device='cuda:3')
compute_distance is  tensor(1.2987e+10, device='cuda:3')
compute_norm is  tensor(3.3089e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2860e+10, device='cuda:3')
________________________________
test distance is  tensor(1.2860e+10, device='cuda:3')
test similarity is  tensor(0.9949, device='cuda:3')
test acc is  0.09936666682299865
test loss is 10644.577600362458
test entropy is  0.7064484382616177
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.955374076962471
mal norm is  tensor(1.0131e+11, device='cuda:3')
distance x is tensor(1.2860e+10, device='cuda:3')
mal distance is  tensor(1.2860e+10, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([7.0289e+05, 1.1045e+06, 9.0378e+05, 8.0337e+05, 8.0335e+05, 9.0383e+05,
        1.0041e+06, 6.0250e+05, 1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11,
        1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11,
        1.0131e+11, 1.0131e+11, 1.1104e+11, 1.1104e+11, 1.1104e+11, 1.1104e+11,
        1.1104e+11, 1.1104e+11, 1.1104e+11, 1.1104e+11, 1.0407e+11, 2.7382e+12,
        1.0407e+11, 1.0407e+11, 1.0407e+11, 1.0407e+11, 1.0407e+11, 1.0407e+11],
       device='cuda:3')
sorted_norm is   tensor([6.0250e+05, 7.0289e+05, 8.0335e+05, 8.0337e+05, 9.0378e+05, 9.0383e+05,
        1.0041e+06, 1.1045e+06, 1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11,
        1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11, 1.0131e+11,
        1.0131e+11, 1.0131e+11, 1.0407e+11, 1.0407e+11, 1.0407e+11, 1.0407e+11,
        1.0407e+11, 1.0407e+11, 1.0407e+11, 1.1104e+11, 1.1104e+11, 1.1104e+11,
        1.1104e+11, 1.1104e+11, 1.1104e+11, 1.1104e+11, 1.1104e+11, 2.7382e+12],
       device='cuda:3')
used idx is  tensor([ 7,  0,  4,  3,  2,  5,  6,  1, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 35, 31, 33, 34, 28, 32, 30, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.02% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.8346516489982605
distance x is tensor(9.5737, device='cuda:3')
benign distance is  tensor(9.5737, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.706658035516739
distance x is tensor(9.0632, device='cuda:3')
benign distance is  tensor(9.0632, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.657593935728073
distance x is tensor(8.2665, device='cuda:3')
benign distance is  tensor(8.2665, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.1503583043813705
distance x is tensor(9.0278, device='cuda:3')
benign distance is  tensor(9.0278, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.2305040657520294
distance x is tensor(8.0479, device='cuda:3')
benign distance is  tensor(8.0479, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.881823167204857
distance x is tensor(6.8730, device='cuda:3')
benign distance is  tensor(6.8730, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.2196029871702194
distance x is tensor(8.2611, device='cuda:3')
benign distance is  tensor(8.2611, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.0216899514198303
distance x is tensor(7.4431, device='cuda:3')
benign distance is  tensor(7.4431, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.2547332644462585
distance x is tensor(8.9146, device='cuda:3')
benign distance is  tensor(8.9146, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  3.0080322325229645
distance x is tensor(5.7569e+12, device='cuda:3')
benign distance is  tensor(5.7569e+12, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.449659079313278
distance x is tensor(8.0469, device='cuda:3')
benign distance is  tensor(8.0469, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.6679753363132477
distance x is tensor(9.4268, device='cuda:3')
benign distance is  tensor(9.4268, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.356299325823784
distance x is tensor(9.5428, device='cuda:3')
benign distance is  tensor(9.5428, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.8122279345989227
distance x is tensor(6.8818, device='cuda:3')
benign distance is  tensor(6.8818, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.854745000600815
distance x is tensor(8.4047, device='cuda:3')
benign distance is  tensor(8.4047, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.675842359662056
distance x is tensor(9.8287, device='cuda:3')
benign distance is  tensor(9.8287, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  3.098628342151642
distance x is tensor(9.2985, device='cuda:3')
benign distance is  tensor(9.2985, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.8899006992578506
distance x is tensor(7.2680, device='cuda:3')
benign distance is  tensor(7.2680, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.2773347347974777
distance x is tensor(8.5343, device='cuda:3')
benign distance is  tensor(8.5343, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.7723258435726166
distance x is tensor(10.2694, device='cuda:3')
benign distance is  tensor(10.2694, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.9079525619745255
distance x is tensor(8.1254, device='cuda:3')
benign distance is  tensor(8.1254, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  3.1624151468276978
distance x is tensor(9.5376, device='cuda:3')
benign distance is  tensor(9.5376, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.6786764562129974
distance x is tensor(6.8474, device='cuda:3')
benign distance is  tensor(6.8474, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.7227768301963806
distance x is tensor(10.1075, device='cuda:3')
benign distance is  tensor(10.1075, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(7.4893, device='cuda:3')
compute distance is  tensor(7.4893, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.6932e+12, device='cuda:3')
compute distance is  tensor(4.6932e+12, device='cuda:3')
compute norm is  tensor(2.3006e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.1552, device='cuda:3')
compute distance is  tensor(7.1552, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.7745, device='cuda:3')
compute distance is  tensor(8.7745, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.2521, device='cuda:3')
compute distance is  tensor(9.2521, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.9245, device='cuda:3')
compute distance is  tensor(8.9245, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.9133, device='cuda:3')
compute distance is  tensor(8.9133, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1055e+13, device='cuda:3')
compute distance is  tensor(2.1055e+13, device='cuda:3')
compute norm is  tensor(1.7647e+13, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.6197, device='cuda:3')
compute distance is  tensor(8.6197, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.1350, device='cuda:3')
compute distance is  tensor(8.1350, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.3383, device='cuda:3')
compute distance is  tensor(8.3383, device='cuda:3')
compute norm is  tensor(1.9388e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.9481e+13, device='cuda:3')
compute distance is  tensor(1.9481e+13, device='cuda:3')
compute norm is  tensor(1.2366e+13, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(2.1055e+13, device='cuda:3')
distance x is tensor(1.5986e+10, device='cuda:3')
distance x is tensor(1.5986e+10, device='cuda:3')
________________________________
test distance is  tensor(1.5986e+10, device='cuda:3')
test distance1 is  tensor(1.5986e+10, device='cuda:3')
test similarity is  tensor(-0.1421, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107505350627528.88
test entropy is  0.0
________________________________
0
distance x is tensor(1.5986e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107611996637616.31
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1421, device='cuda:3')
compute_distance is  tensor(1.5986e+10, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3492e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.00010470118405776961
avg test loss is  11305.245276925914
avg accuracy is  0.09908333348966532
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.3492e+10, device='cuda:3')
compute_norm is  tensor(3.5670e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3355e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.151569463805095
avg test loss is  20900.576976281747
avg accuracy is  0.09988333348966531
solo acc is  0.09963333348966531
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.3355e+10, device='cuda:3')
compute_norm is  tensor(3.5503e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3218e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6370117549004077
avg test loss is  7478.791656228017
avg accuracy is  0.10030000015633199
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.3218e+10, device='cuda:3')
compute_norm is  tensor(3.5337e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3082e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2752608531065333
avg test loss is  25057.536442236353
avg accuracy is  0.10010000015633198
solo acc is  0.10006666682299864
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.3082e+10, device='cuda:3')
compute_norm is  tensor(3.5172e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2947e+10, device='cuda:3')
distance x is tensor(1.2947e+10, device='cuda:3')
________________________________
test distance is  tensor(1.2947e+10, device='cuda:3')
test distance1 is  tensor(1.2947e+10, device='cuda:3')
test similarity is  tensor(0.9962, device='cuda:3')
test acc is  0.10001666682299865
test loss is 15136.474712237874
test entropy is  0.6508643758068207
________________________________
0
distance x is tensor(1.2947e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6529218787386981
avg test loss is  14435.40691646457
avg accuracy is  0.10090000015633196
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2947e+10, device='cuda:3')
compute_norm is  tensor(3.5007e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2812e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3047454779082015
avg test loss is  29435.908892475974
avg accuracy is  0.10100000015633198
solo acc is  0.0997833334896653
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2812e+10, device='cuda:3')
compute_norm is  tensor(3.4843e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2678e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6679543380671219
avg test loss is  13766.954619259977
avg accuracy is  0.10046666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2678e+10, device='cuda:3')
compute_norm is  tensor(3.4680e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2544e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3242385088761985
avg test loss is  12206.915183627529
avg accuracy is  0.10036666682299866
solo acc is  0.09986666682299865
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2544e+10, device='cuda:3')
compute_norm is  tensor(3.4518e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2412e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6863577490422264
avg test loss is  22871.613282621034
avg accuracy is  0.09931666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2412e+10, device='cuda:3')
compute_norm is  tensor(3.4356e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2279e+10, device='cuda:3')
distance x is tensor(1.2279e+10, device='cuda:3')
________________________________
test distance is  tensor(1.2279e+10, device='cuda:3')
test distance1 is  tensor(1.2279e+10, device='cuda:3')
test similarity is  tensor(0.9962, device='cuda:3')
test acc is  0.09991666682299866
test loss is 15131.068578821256
test entropy is  1.3367479410507024
________________________________
0
distance x is tensor(1.2279e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3410576125706182
avg test loss is  13296.982728781984
avg accuracy is  0.09898333348966531
solo acc is  0.1003833334896653
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2279e+10, device='cuda:3')
compute_norm is  tensor(3.4196e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2148e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6915257804429353
avg test loss is  11197.629221580177
avg accuracy is  0.09941666682299867
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2148e+10, device='cuda:3')
compute_norm is  tensor(3.4036e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2017e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3533838472640844
avg test loss is  20710.469957682115
avg accuracy is  0.09875000015633198
solo acc is  0.10035000015633198
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.2017e+10, device='cuda:3')
compute_norm is  tensor(3.3876e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.1886e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7029527382555801
avg test loss is  12593.38352479101
avg accuracy is  0.10075000015633197
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.1886e+10, device='cuda:3')
compute_norm is  tensor(3.3718e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.1757e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3662308237191712
avg test loss is  16289.81756586942
avg accuracy is  0.10048333348966533
solo acc is  0.09990000015633198
compute similarity  is  tensor(0.9962, device='cuda:3')
compute_distance is  tensor(1.1757e+10, device='cuda:3')
compute_norm is  tensor(3.3560e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.1628e+10, device='cuda:3')
________________________________
test distance is  tensor(1.1628e+10, device='cuda:3')
test similarity is  tensor(0.9962, device='cuda:3')
test acc is  0.10010000015633198
test loss is 17268.612536282428
test entropy is  0.7069733939699526
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.97072471678257
mal norm is  tensor(9.1424e+10, device='cuda:3')
distance x is tensor(1.1628e+10, device='cuda:3')
mal distance is  tensor(1.1628e+10, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([3.2476e+02, 3.2210e+02, 2.8030e+02, 3.0246e+02, 2.8344e+02, 2.4231e+02,
        2.8901e+02, 2.5992e+02, 9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10,
        9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10,
        9.1424e+10, 9.1424e+10, 1.2384e+11, 1.2388e+11, 1.2384e+11, 1.2384e+11,
        1.2384e+11, 1.2384e+11, 1.2384e+11, 1.2385e+11, 1.1686e+11, 1.1686e+11,
        1.1686e+11, 3.5084e+13, 1.1686e+11, 1.1686e+11, 1.1686e+11, 1.1252e+13],
       device='cuda:3')
sorted_norm is   tensor([2.4231e+02, 2.5992e+02, 2.8030e+02, 2.8344e+02, 2.8901e+02, 3.0246e+02,
        3.2210e+02, 3.2476e+02, 9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10,
        9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10, 9.1424e+10,
        9.1424e+10, 9.1424e+10, 1.1686e+11, 1.1686e+11, 1.1686e+11, 1.1686e+11,
        1.1686e+11, 1.1686e+11, 1.2384e+11, 1.2384e+11, 1.2384e+11, 1.2384e+11,
        1.2384e+11, 1.2384e+11, 1.2385e+11, 1.2388e+11, 1.1252e+13, 3.5084e+13],
       device='cuda:3')
used idx is  tensor([ 5,  7,  2,  4,  6,  3,  1,  0, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 30, 32, 33, 34, 28, 29, 23, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.02% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7630278319120407
distance x is tensor(10.3044, device='cuda:3')
benign distance is  tensor(10.3044, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.6591099947690964
distance x is tensor(9.5440, device='cuda:3')
benign distance is  tensor(9.5440, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.5619976967573166
distance x is tensor(9.0278, device='cuda:3')
benign distance is  tensor(9.0278, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.3752691745758057
distance x is tensor(9.7915, device='cuda:3')
benign distance is  tensor(9.7915, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.3633141815662384
distance x is tensor(8.7052, device='cuda:3')
benign distance is  tensor(8.7052, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.9050585627555847
distance x is tensor(7.0376, device='cuda:3')
benign distance is  tensor(7.0376, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.2449159920215607
distance x is tensor(9.0483, device='cuda:3')
benign distance is  tensor(9.0483, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.021673485636711
distance x is tensor(7.9031, device='cuda:3')
benign distance is  tensor(7.9031, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.4727187752723694
distance x is tensor(8.8480, device='cuda:3')
benign distance is  tensor(8.8480, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  3.177924707531929
distance x is tensor(7.8865, device='cuda:3')
benign distance is  tensor(7.8865, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.60133895277977
distance x is tensor(9.5590, device='cuda:3')
benign distance is  tensor(9.5590, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.2757683247327805
distance x is tensor(9.9710e+12, device='cuda:3')
benign distance is  tensor(9.9710e+12, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.334934711456299
distance x is tensor(7.4628, device='cuda:3')
benign distance is  tensor(7.4628, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.9169873148202896
distance x is tensor(9.6595, device='cuda:3')
benign distance is  tensor(9.6595, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.113065645098686
distance x is tensor(9.9317, device='cuda:3')
benign distance is  tensor(9.9317, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.910318285226822
distance x is tensor(2.7328e+13, device='cuda:3')
benign distance is  tensor(2.7328e+13, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.7068178951740265
distance x is tensor(9.5829, device='cuda:3')
benign distance is  tensor(9.5829, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  3.2126584500074387
distance x is tensor(1.3007e+12, device='cuda:3')
benign distance is  tensor(1.3007e+12, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.4357948154211044
distance x is tensor(9.5001, device='cuda:3')
benign distance is  tensor(9.5001, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.6509848833084106
distance x is tensor(9.7087, device='cuda:3')
benign distance is  tensor(9.7087, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.9747506976127625
distance x is tensor(10.5066, device='cuda:3')
benign distance is  tensor(10.5066, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.901608243584633
distance x is tensor(6.8884, device='cuda:3')
benign distance is  tensor(6.8884, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  3.1873055696487427
distance x is tensor(8.5936, device='cuda:3')
benign distance is  tensor(8.5936, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.7164883464574814
distance x is tensor(8.3111e+12, device='cuda:3')
benign distance is  tensor(8.3111e+12, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(7.9166, device='cuda:3')
compute distance is  tensor(7.9166, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3457e+13, device='cuda:3')
compute distance is  tensor(1.3457e+13, device='cuda:3')
compute norm is  tensor(1.1463e+13, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.2309, device='cuda:3')
compute distance is  tensor(8.2309, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.0709, device='cuda:3')
compute distance is  tensor(9.0709, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.0908, device='cuda:3')
compute distance is  tensor(10.0908, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.0419, device='cuda:3')
compute distance is  tensor(9.0419, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.6082, device='cuda:3')
compute distance is  tensor(9.6082, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2227e+12, device='cuda:3')
compute distance is  tensor(2.2227e+12, device='cuda:3')
compute norm is  tensor(1.5620e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.4987, device='cuda:3')
compute distance is  tensor(8.4987, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.6908, device='cuda:3')
compute distance is  tensor(8.6908, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.6615, device='cuda:3')
compute distance is  tensor(8.6615, device='cuda:3')
compute norm is  tensor(2.0122e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.1029e+13, device='cuda:3')
compute distance is  tensor(4.1029e+13, device='cuda:3')
compute norm is  tensor(2.7382e+13, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(4.1029e+13, device='cuda:3')
distance x is tensor(1.6598e+10, device='cuda:3')
distance x is tensor(1.6598e+10, device='cuda:3')
________________________________
test distance is  tensor(1.6598e+10, device='cuda:3')
test distance1 is  tensor(1.6598e+10, device='cuda:3')
test similarity is  tensor(-0.1422, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107555170007026.9
test entropy is  0.0
________________________________
0
distance x is tensor(1.6598e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107453420788729.45
avg accuracy is  0.10018333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1422, device='cuda:3')
compute_distance is  tensor(1.6598e+10, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3392e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.330249716075254e-05
avg test loss is  28650.867649490137
avg accuracy is  0.10033333348966532
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.3392e+10, device='cuda:3')
compute_norm is  tensor(3.6304e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3253e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1567679064106078
avg test loss is  17251.06435829795
avg accuracy is  0.10023333348966532
solo acc is  0.09980000015633199
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.3253e+10, device='cuda:3')
compute_norm is  tensor(3.6135e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3114e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6260306617217277
avg test loss is  14084.278868407837
avg accuracy is  0.10006666682299865
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.3114e+10, device='cuda:3')
compute_norm is  tensor(3.5965e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2975e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2795977179429678
avg test loss is  13246.279896810873
avg accuracy is  0.10013333348966531
solo acc is  0.10025000015633197
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2975e+10, device='cuda:3')
compute_norm is  tensor(3.5797e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2837e+10, device='cuda:3')
distance x is tensor(1.2837e+10, device='cuda:3')
________________________________
test distance is  tensor(1.2837e+10, device='cuda:3')
test distance1 is  tensor(1.2837e+10, device='cuda:3')
test similarity is  tensor(0.9968, device='cuda:3')
test acc is  0.10001666682299865
test loss is 18974.87267551595
test entropy is  0.6522252867852193
________________________________
0
distance x is tensor(1.2837e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6548477061458234
avg test loss is  19090.903485772706
avg accuracy is  0.09983333348966532
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2837e+10, device='cuda:3')
compute_norm is  tensor(3.5630e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2700e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.300200542216616
avg test loss is  14427.58249628976
avg accuracy is  0.09981666682299865
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2700e+10, device='cuda:3')
compute_norm is  tensor(3.5463e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2564e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6684409046668742
avg test loss is  7822.306857286994
avg accuracy is  0.10040000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2564e+10, device='cuda:3')
compute_norm is  tensor(3.5297e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2428e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3250426618275104
avg test loss is  26593.109180430107
avg accuracy is  0.09976666682299865
solo acc is  0.09993333348966532
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2428e+10, device='cuda:3')
compute_norm is  tensor(3.5132e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2293e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6896695973141107
avg test loss is  15026.023326240876
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2293e+10, device='cuda:3')
compute_norm is  tensor(3.4968e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2158e+10, device='cuda:3')
distance x is tensor(1.2158e+10, device='cuda:3')
________________________________
test distance is  tensor(1.2158e+10, device='cuda:3')
test distance1 is  tensor(1.2158e+10, device='cuda:3')
test similarity is  tensor(0.9968, device='cuda:3')
test acc is  0.10038333348966531
test loss is 20772.878999022785
test entropy is  1.3430012883916338
________________________________
0
distance x is tensor(1.2158e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3454204716407923
avg test loss is  18573.571147419243
avg accuracy is  0.10003333348966531
solo acc is  0.09985000015633198
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2158e+10, device='cuda:3')
compute_norm is  tensor(3.4804e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2024e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6945307629703205
avg test loss is  12337.846115676071
avg accuracy is  0.09981666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.2024e+10, device='cuda:3')
compute_norm is  tensor(3.4641e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.1891e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3607664489542752
avg test loss is  13001.871363003116
avg accuracy is  0.09961666682299865
solo acc is  0.09966666682299866
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.1891e+10, device='cuda:3')
compute_norm is  tensor(3.4479e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.1758e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.700150389406981
avg test loss is  20280.404819003554
avg accuracy is  0.10000000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.1758e+10, device='cuda:3')
compute_norm is  tensor(3.4318e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.1626e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3790734621253349
avg test loss is  19922.00983855465
avg accuracy is  0.09975000015633198
solo acc is  0.10020000015633199
compute similarity  is  tensor(0.9968, device='cuda:3')
compute_distance is  tensor(1.1626e+10, device='cuda:3')
compute_norm is  tensor(3.4157e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.1495e+10, device='cuda:3')
________________________________
test distance is  tensor(1.1495e+10, device='cuda:3')
test similarity is  tensor(0.9968, device='cuda:3')
test acc is  0.10001666682299865
test loss is 13415.69468680704
test entropy is  0.6986325533151119
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.9541907608509064
mal norm is  tensor(9.0509e+10, device='cuda:3')
distance x is tensor(1.1495e+10, device='cuda:3')
mal distance is  tensor(1.1495e+10, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([3.4480e+02, 3.4891e+02, 3.4694e+02, 3.4129e+02, 3.2178e+02, 2.5600e+02,
        3.4541e+02, 2.9764e+02, 9.0509e+10, 9.0509e+10, 9.0509e+10, 9.0509e+10,
        9.0509e+10, 9.0509e+10, 9.0509e+10, 9.0509e+10, 9.0509e+10, 9.0509e+10,
        9.0509e+10, 9.0509e+10, 9.2816e+09, 4.7198e+14, 9.2816e+09, 9.2816e+09,
        9.2816e+09, 9.2816e+09, 9.2816e+09, 9.2816e+09], device='cuda:3')
sorted_norm is   tensor([2.5600e+02, 2.9764e+02, 3.2178e+02, 3.4129e+02, 3.4480e+02, 3.4541e+02,
        3.4694e+02, 3.4891e+02, 9.2816e+09, 9.2816e+09, 9.2816e+09, 9.2816e+09,
        9.2816e+09, 9.2816e+09, 9.2816e+09, 9.0509e+10, 9.0509e+10, 9.0509e+10,
        9.0509e+10, 9.0509e+10, 9.0509e+10, 9.0509e+10, 9.0509e+10, 9.0509e+10,
        9.0509e+10, 9.0509e+10, 9.0509e+10, 4.7198e+14], device='cuda:3')
used idx is  tensor([ 5,  7,  4,  3,  0,  6,  2,  1, 25, 24, 26, 27, 22, 20, 23, 19, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.02% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7888937294483185
distance x is tensor(8.8296, device='cuda:3')
benign distance is  tensor(8.8296, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.7951392978429794
distance x is tensor(6.8526, device='cuda:3')
benign distance is  tensor(6.8526, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.552294909954071
distance x is tensor(6.4985, device='cuda:3')
benign distance is  tensor(6.4985, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.522382766008377
distance x is tensor(8.5719, device='cuda:3')
benign distance is  tensor(8.5719, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.348105877637863
distance x is tensor(7.9817, device='cuda:3')
benign distance is  tensor(7.9817, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.9822981357574463
distance x is tensor(6.6244, device='cuda:3')
benign distance is  tensor(6.6244, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.3167274445295334
distance x is tensor(7.0293, device='cuda:3')
benign distance is  tensor(7.0293, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.1516509652137756
distance x is tensor(6.0094, device='cuda:3')
benign distance is  tensor(6.0094, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.1712370812892914
distance x is tensor(6.9135, device='cuda:3')
benign distance is  tensor(6.9135, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  3.0325965732336044
distance x is tensor(1.1432e+13, device='cuda:3')
benign distance is  tensor(1.1432e+13, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.4435895830392838
distance x is tensor(6.6313, device='cuda:3')
benign distance is  tensor(6.6313, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.893036499619484
distance x is tensor(8.4250, device='cuda:3')
benign distance is  tensor(8.4250, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.398818254470825
distance x is tensor(9.2917, device='cuda:3')
benign distance is  tensor(9.2917, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.8811037838459015
distance x is tensor(5.4994, device='cuda:3')
benign distance is  tensor(5.4994, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.859055995941162
distance x is tensor(6.7824, device='cuda:3')
benign distance is  tensor(6.7824, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.7635343074798584
distance x is tensor(8.8243, device='cuda:3')
benign distance is  tensor(8.8243, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.9976, device='cuda:3')
compute distance is  tensor(5.9976, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.4728e+12, device='cuda:3')
compute distance is  tensor(4.4728e+12, device='cuda:3')
compute norm is  tensor(2.4097e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.6812, device='cuda:3')
compute distance is  tensor(6.6812, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2573, device='cuda:3')
compute distance is  tensor(7.2573, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.2813, device='cuda:3')
compute distance is  tensor(8.2813, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.6392, device='cuda:3')
compute distance is  tensor(7.6392, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.5868, device='cuda:3')
compute distance is  tensor(7.5868, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.1661e+13, device='cuda:3')
compute distance is  tensor(1.1661e+13, device='cuda:3')
compute norm is  tensor(7.9320e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.1242, device='cuda:3')
compute distance is  tensor(7.1242, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.4689, device='cuda:3')
compute distance is  tensor(7.4689, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.4773, device='cuda:3')
compute distance is  tensor(7.4773, device='cuda:3')
compute norm is  tensor(2.4283e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8952e+13, device='cuda:3')
compute distance is  tensor(2.8952e+13, device='cuda:3')
compute norm is  tensor(1.6574e+13, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(2.8952e+13, device='cuda:3')
distance x is tensor(2.0031e+10, device='cuda:3')
distance x is tensor(2.0031e+10, device='cuda:3')
________________________________
test distance is  tensor(2.0031e+10, device='cuda:3')
test distance1 is  tensor(2.0031e+10, device='cuda:3')
test similarity is  tensor(-0.1422, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107497765671427.28
test entropy is  0.0
________________________________
0
distance x is tensor(2.0031e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107519384330502.0
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1422, device='cuda:3')
compute_distance is  tensor(2.0031e+10, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.9067e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.403521778713067e-05
avg test loss is  7818.0244615499905
avg accuracy is  0.09981666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(8.9067e+09, device='cuda:3')
compute_norm is  tensor(3.4993e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.7726e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.164380536722476
avg test loss is  10252.336254326012
avg accuracy is  0.09973333348966534
solo acc is  0.09988333348966531
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(8.7726e+09, device='cuda:3')
compute_norm is  tensor(3.4829e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.6392e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.623323111042285
avg test loss is  13916.767062284036
avg accuracy is  0.09993333348966535
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(8.6392e+09, device='cuda:3')
compute_norm is  tensor(3.4666e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.5064e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2698742686939646
avg test loss is  11291.077535425167
avg accuracy is  0.100850000156332
solo acc is  0.09981666682299864
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(8.5064e+09, device='cuda:3')
compute_norm is  tensor(3.4504e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.3742e+09, device='cuda:3')
distance x is tensor(8.3742e+09, device='cuda:3')
________________________________
test distance is  tensor(8.3742e+09, device='cuda:3')
test distance1 is  tensor(8.3742e+09, device='cuda:3')
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.10005000015633199
test loss is 10762.16474211699
test entropy is  0.6422603500804414
________________________________
0
distance x is tensor(8.3742e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6483499981256436
avg test loss is  11070.14862349369
avg accuracy is  0.10093333348966534
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(8.3742e+09, device='cuda:3')
compute_norm is  tensor(3.4343e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.2427e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2967827203177185
avg test loss is  16531.910313335564
avg accuracy is  0.09965000015633202
solo acc is  0.09993333348966532
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(8.2427e+09, device='cuda:3')
compute_norm is  tensor(3.4182e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.1118e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6672739482510572
avg test loss is  7142.159155085906
avg accuracy is  0.10021666682299868
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(8.1118e+09, device='cuda:3')
compute_norm is  tensor(3.4022e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.9816e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3312531380511041
avg test loss is  14814.14149727674
avg accuracy is  0.09986666682299866
solo acc is  0.10020000015633199
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(7.9816e+09, device='cuda:3')
compute_norm is  tensor(3.3863e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.8520e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6917525523507011
avg test loss is  12328.11219381244
avg accuracy is  0.10021666682299867
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(7.8520e+09, device='cuda:3')
compute_norm is  tensor(3.3704e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.7230e+09, device='cuda:3')
distance x is tensor(7.7230e+09, device='cuda:3')
________________________________
test distance is  tensor(7.7230e+09, device='cuda:3')
test distance1 is  tensor(7.7230e+09, device='cuda:3')
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.09998333348966532
test loss is 10510.743381737391
test entropy is  1.349345702987744
________________________________
0
distance x is tensor(7.7230e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3493231509540127
avg test loss is  15206.563796300623
avg accuracy is  0.099950000156332
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(7.7230e+09, device='cuda:3')
compute_norm is  tensor(3.3547e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.5947e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.691213438315178
avg test loss is  8102.89914937238
avg accuracy is  0.100300000156332
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(7.5947e+09, device='cuda:3')
compute_norm is  tensor(3.3390e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.4670e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3541343205773246
avg test loss is  13979.689037128806
avg accuracy is  0.09975000015633201
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(7.4670e+09, device='cuda:3')
compute_norm is  tensor(3.3233e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.3399e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6999481439844631
avg test loss is  12857.792555266606
avg accuracy is  0.10028333348966534
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(7.3399e+09, device='cuda:3')
compute_norm is  tensor(3.3078e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.2135e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3757917493391139
avg test loss is  10399.265974926542
avg accuracy is  0.09980000015633202
solo acc is  0.10006666682299864
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(7.2135e+09, device='cuda:3')
compute_norm is  tensor(3.2923e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.0877e+09, device='cuda:3')
________________________________
test distance is  tensor(7.0877e+09, device='cuda:3')
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.10026666682299866
test loss is 12641.02105617396
test entropy is  0.7085660801513363
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.979566738009453
mal norm is  tensor(5.6847e+10, device='cuda:3')
distance x is tensor(7.0877e+09, device='cuda:3')
mal distance is  tensor(7.0877e+09, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([2.9380e+02, 2.2573e+02, 2.1252e+02, 2.8646e+02, 2.8263e+02, 2.7131e+02,
        2.3477e+02, 2.0373e+02, 5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10,
        5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10,
        5.6847e+10, 5.6847e+10], device='cuda:3')
sorted_norm is   tensor([2.0373e+02, 2.1252e+02, 2.2573e+02, 2.3477e+02, 2.7131e+02, 2.8263e+02,
        2.8646e+02, 2.9380e+02, 5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10,
        5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10, 5.6847e+10,
        5.6847e+10, 5.6847e+10], device='cuda:3')
used idx is  tensor([ 7,  2,  1,  6,  5,  4,  3,  0, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.826501250267029
distance x is tensor(871.1575, device='cuda:3')
benign distance is  tensor(871.1575, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.781309261918068
distance x is tensor(685.7316, device='cuda:3')
benign distance is  tensor(685.7316, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.6957992911338806
distance x is tensor(498.8734, device='cuda:3')
benign distance is  tensor(498.8734, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.3523688167333603
distance x is tensor(598.6984, device='cuda:3')
benign distance is  tensor(598.6984, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.314191699028015
distance x is tensor(603.0457, device='cuda:3')
benign distance is  tensor(603.0457, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.9252355247735977
distance x is tensor(499.9240, device='cuda:3')
benign distance is  tensor(499.9240, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.2556772232055664
distance x is tensor(875.5434, device='cuda:3')
benign distance is  tensor(875.5434, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.347785145044327
distance x is tensor(874.6370, device='cuda:3')
benign distance is  tensor(874.6370, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(679.2820, device='cuda:3')
compute distance is  tensor(679.2820, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.9387e+12, device='cuda:3')
compute distance is  tensor(8.9387e+12, device='cuda:3')
compute norm is  tensor(7.4392e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(330.2866, device='cuda:3')
compute distance is  tensor(330.2866, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(777.6235, device='cuda:3')
compute distance is  tensor(777.6235, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(489.1703, device='cuda:3')
compute distance is  tensor(489.1703, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(1256.4329, device='cuda:3')
compute distance is  tensor(1256.4329, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(1055.9415, device='cuda:3')
compute distance is  tensor(1055.9415, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2019e+12, device='cuda:3')
compute distance is  tensor(2.2019e+12, device='cuda:3')
compute norm is  tensor(1.1969e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(679.5691, device='cuda:3')
compute distance is  tensor(679.5691, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(781.5477, device='cuda:3')
compute distance is  tensor(781.5477, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(593.5776, device='cuda:3')
compute distance is  tensor(593.5776, device='cuda:3')
compute norm is  tensor(2.8506e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(inf, device='cuda:3')
compute distance is  tensor(inf, device='cuda:3')
compute norm is  tensor(2.6066e+23, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(inf, device='cuda:3')
distance x is tensor(2.3512e+10, device='cuda:3')
distance x is tensor(2.3512e+10, device='cuda:3')
________________________________
test distance is  tensor(2.3512e+10, device='cuda:3')
test distance1 is  tensor(2.3512e+10, device='cuda:3')
test similarity is  tensor(-0.1422, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107538758258888.88
test entropy is  0.0
________________________________
0
distance x is tensor(2.3512e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107503508219131.1
avg accuracy is  0.10016666682299867
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1422, device='cuda:3')
compute_distance is  tensor(2.3512e+10, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6.0796e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.348017354797411e-05
avg test loss is  12056.61089043729
avg accuracy is  0.10000000015633201
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(6.0796e+09, device='cuda:3')
compute_norm is  tensor(3.5690e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5.9442e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.172469853020426
avg test loss is  16142.334901203225
avg accuracy is  0.10003333348966535
solo acc is  0.09968333348966532
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.9442e+09, device='cuda:3')
compute_norm is  tensor(3.5523e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5.8095e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6235328850461476
avg test loss is  15029.291970766937
avg accuracy is  0.10015000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.8095e+09, device='cuda:3')
compute_norm is  tensor(3.5356e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5.6755e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2548983696935527
avg test loss is  23408.546609798475
avg accuracy is  0.09988333348966534
solo acc is  0.09986666682299865
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.6755e+09, device='cuda:3')
compute_norm is  tensor(3.5191e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5.5423e+09, device='cuda:3')
distance x is tensor(5.5423e+09, device='cuda:3')
________________________________
test distance is  tensor(5.5423e+09, device='cuda:3')
test distance1 is  tensor(5.5423e+09, device='cuda:3')
test similarity is  tensor(0.9965, device='cuda:3')
test acc is  0.10005000015633199
test loss is 14576.646315572358
test entropy is  0.6518722821845174
________________________________
0
distance x is tensor(5.5423e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6532259386167851
avg test loss is  11021.458054075618
avg accuracy is  0.10003333348966534
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.5423e+09, device='cuda:3')
compute_norm is  tensor(3.5026e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5.4097e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3162217864603885
avg test loss is  16247.858533702934
avg accuracy is  0.10000000015633201
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.4097e+09, device='cuda:3')
compute_norm is  tensor(3.4862e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5.2779e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6685575879077668
avg test loss is  13610.66422994508
avg accuracy is  0.10016666682299868
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.2779e+09, device='cuda:3')
compute_norm is  tensor(3.4699e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5.1468e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3162816639648063
avg test loss is  13093.323146505396
avg accuracy is  0.10006666682299867
solo acc is  0.09995000015633199
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.1468e+09, device='cuda:3')
compute_norm is  tensor(3.4537e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5.0163e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6816661746771351
avg test loss is  16096.750006355202
avg accuracy is  0.10001666682299867
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(5.0163e+09, device='cuda:3')
compute_norm is  tensor(3.4375e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4.8867e+09, device='cuda:3')
distance x is tensor(4.8867e+09, device='cuda:3')
________________________________
test distance is  tensor(4.8867e+09, device='cuda:3')
test distance1 is  tensor(4.8867e+09, device='cuda:3')
test similarity is  tensor(0.9965, device='cuda:3')
test acc is  0.10001666682299865
test loss is 10259.077396841192
test entropy is  1.3292095703102633
________________________________
0
distance x is tensor(4.8867e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3272568580946689
avg test loss is  11376.628855116585
avg accuracy is  0.10021666682299867
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(4.8867e+09, device='cuda:3')
compute_norm is  tensor(3.4215e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4.7577e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6867031620890856
avg test loss is  18524.96272780265
avg accuracy is  0.10028333348966535
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(4.7577e+09, device='cuda:3')
compute_norm is  tensor(3.4054e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4.6295e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3567289002160274
avg test loss is  22952.984356176625
avg accuracy is  0.09983333348966535
solo acc is  0.09970000015633199
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(4.6295e+09, device='cuda:3')
compute_norm is  tensor(3.3895e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4.5019e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7038786040821563
avg test loss is  9582.799594956929
avg accuracy is  0.10003333348966534
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(4.5019e+09, device='cuda:3')
compute_norm is  tensor(3.3736e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4.3751e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.358225765767128
avg test loss is  10766.150600704557
avg accuracy is  0.10008333348966533
solo acc is  0.09993333348966532
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(4.3751e+09, device='cuda:3')
compute_norm is  tensor(3.3579e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4.2491e+09, device='cuda:3')
________________________________
test distance is  tensor(4.2491e+09, device='cuda:3')
test similarity is  tensor(0.9965, device='cuda:3')
test acc is  0.10005000015633202
test loss is 10186.716884456464
test entropy is  0.7021237892636867
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 4.0082078874111176
mal norm is  tensor(3.5846e+10, device='cuda:3')
distance x is tensor(4.2491e+09, device='cuda:3')
mal distance is  tensor(4.2491e+09, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([8.6366e+04, 6.7919e+04, 4.9280e+04, 5.9104e+04, 5.9626e+04, 4.9488e+04,
        8.6917e+04, 8.6898e+04, 3.5846e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10,
        3.5846e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10,
        3.5846e+10, 3.5846e+10, 1.7555e+11, 1.7555e+11, 1.4053e+13, 1.7555e+11,
        1.7555e+11, 1.7555e+11, 1.7555e+11, 1.7555e+11, 5.9674e+10, 5.9674e+10,
        5.9674e+10, 5.9674e+10, 5.9674e+10, 5.9674e+10, 5.9674e+10, 5.9674e+10,
        5.4666e+10, 5.4666e+10, 5.4666e+10, 5.9952e+14, 5.4666e+10, 5.4666e+10,
        5.4666e+10, 2.0485e+15, 2.8424e+10, 8.8449e+14, 2.8424e+10, 2.8424e+10,
        2.8424e+10, 2.8424e+10, 2.8424e+10, 2.8424e+10], device='cuda:3')
sorted_norm is   tensor([4.9280e+04, 4.9488e+04, 5.9104e+04, 5.9626e+04, 6.7919e+04, 8.6366e+04,
        8.6898e+04, 8.6917e+04, 2.8424e+10, 2.8424e+10, 2.8424e+10, 2.8424e+10,
        2.8424e+10, 2.8424e+10, 2.8424e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10,
        3.5846e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10, 3.5846e+10,
        3.5846e+10, 3.5846e+10, 3.5846e+10, 5.4666e+10, 5.4666e+10, 5.4666e+10,
        5.4666e+10, 5.4666e+10, 5.4666e+10, 5.9674e+10, 5.9674e+10, 5.9674e+10,
        5.9674e+10, 5.9674e+10, 5.9674e+10, 5.9674e+10, 5.9674e+10, 1.7555e+11,
        1.7555e+11, 1.7555e+11, 1.7555e+11, 1.7555e+11, 1.7555e+11, 1.7555e+11,
        1.4053e+13, 5.9952e+14, 8.8449e+14, 2.0485e+15], device='cuda:3')
used idx is  tensor([ 2,  5,  3,  4,  1,  0,  7,  6, 49, 47, 51, 48, 44, 50, 46, 19, 11, 18,
        16, 17, 13, 10,  8,  9, 14, 12, 15, 42, 41, 40, 37, 38, 36, 32, 33, 35,
        31, 30, 28, 34, 29], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.02% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.780195862054825
distance x is tensor(8.1439, device='cuda:3')
benign distance is  tensor(8.1439, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.8648479878902435
distance x is tensor(7.0916, device='cuda:3')
benign distance is  tensor(7.0916, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.4613561183214188
distance x is tensor(6.5495, device='cuda:3')
benign distance is  tensor(6.5495, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.376550108194351
distance x is tensor(7.7967, device='cuda:3')
benign distance is  tensor(7.7967, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.30753156542778
distance x is tensor(6.8367, device='cuda:3')
benign distance is  tensor(6.8367, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  3.0866857171058655
distance x is tensor(5.1762, device='cuda:3')
benign distance is  tensor(5.1762, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.3153910785913467
distance x is tensor(6.4731, device='cuda:3')
benign distance is  tensor(6.4731, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.2409379482269287
distance x is tensor(6.0015, device='cuda:3')
benign distance is  tensor(6.0015, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.204628646373749
distance x is tensor(6.9014, device='cuda:3')
benign distance is  tensor(6.9014, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  3.045080289244652
distance x is tensor(4.1451e+12, device='cuda:3')
benign distance is  tensor(4.1451e+12, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.4444420337677
distance x is tensor(6.0635, device='cuda:3')
benign distance is  tensor(6.0635, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.7509252429008484
distance x is tensor(7.9523, device='cuda:3')
benign distance is  tensor(7.9523, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.4398140758275986
distance x is tensor(9.0819, device='cuda:3')
benign distance is  tensor(9.0819, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.8905018717050552
distance x is tensor(5.4030, device='cuda:3')
benign distance is  tensor(5.4030, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.8610627353191376
distance x is tensor(6.2059, device='cuda:3')
benign distance is  tensor(6.2059, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.6444109231233597
distance x is tensor(8.1466, device='cuda:3')
benign distance is  tensor(8.1466, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.5206675976514816
distance x is tensor(6.5636, device='cuda:3')
benign distance is  tensor(6.5636, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  3.1534761637449265
distance x is tensor(5.4670, device='cuda:3')
benign distance is  tensor(5.4670, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.7881692200899124
distance x is tensor(7.7678, device='cuda:3')
benign distance is  tensor(7.7678, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.350245237350464
distance x is tensor(2.5435e+13, device='cuda:3')
benign distance is  tensor(2.5435e+13, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.258926600217819
distance x is tensor(5.9773, device='cuda:3')
benign distance is  tensor(5.9773, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.9544883370399475
distance x is tensor(7.8554, device='cuda:3')
benign distance is  tensor(7.8554, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.186041235923767
distance x is tensor(8.5036, device='cuda:3')
benign distance is  tensor(8.5036, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  3.1026875376701355
distance x is tensor(3.3261e+13, device='cuda:3')
benign distance is  tensor(3.3261e+13, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  3.1219378113746643
distance x is tensor(6.6462, device='cuda:3')
benign distance is  tensor(6.6462, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.9658669531345367
distance x is tensor(5.7357, device='cuda:3')
benign distance is  tensor(5.7357, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.3933980017900467
distance x is tensor(7.2805, device='cuda:3')
benign distance is  tensor(7.2805, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.829269304871559
distance x is tensor(8.1262, device='cuda:3')
benign distance is  tensor(8.1262, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.9755866825580597
distance x is tensor(6.6922, device='cuda:3')
benign distance is  tensor(6.6922, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  3.357218623161316
distance x is tensor(7.4942, device='cuda:3')
benign distance is  tensor(7.4942, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.650978997349739
distance x is tensor(6.4899, device='cuda:3')
benign distance is  tensor(6.4899, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.764942228794098
distance x is tensor(8.1394, device='cuda:3')
benign distance is  tensor(8.1394, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.003353253006935
distance x is tensor(7.7147, device='cuda:3')
benign distance is  tensor(7.7147, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.7290983349084854
distance x is tensor(8.2098, device='cuda:3')
benign distance is  tensor(8.2098, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  3.0273378491401672
distance x is tensor(7.8004, device='cuda:3')
benign distance is  tensor(7.8004, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  3.505707934498787
distance x is tensor(7.3164, device='cuda:3')
benign distance is  tensor(7.3164, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.949400782585144
distance x is tensor(6.4315, device='cuda:3')
benign distance is  tensor(6.4315, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  3.811521977186203
distance x is tensor(7.8700, device='cuda:3')
benign distance is  tensor(7.8700, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.4890061616897583
distance x is tensor(6.4014, device='cuda:3')
benign distance is  tensor(6.4014, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.5980627983808517
distance x is tensor(6.0185, device='cuda:3')
benign distance is  tensor(6.0185, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.7005, device='cuda:3')
compute distance is  tensor(5.7005, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.8066e+12, device='cuda:3')
compute distance is  tensor(9.8066e+12, device='cuda:3')
compute norm is  tensor(8.1109e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.5092, device='cuda:3')
compute distance is  tensor(6.5092, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.6805, device='cuda:3')
compute distance is  tensor(6.6805, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.0854, device='cuda:3')
compute distance is  tensor(8.0854, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.5587, device='cuda:3')
compute distance is  tensor(7.5587, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.9040, device='cuda:3')
compute distance is  tensor(6.9040, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.7442e+12, device='cuda:3')
compute distance is  tensor(2.7442e+12, device='cuda:3')
compute norm is  tensor(1.4926e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.1498, device='cuda:3')
compute distance is  tensor(7.1498, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.2616, device='cuda:3')
compute distance is  tensor(7.2616, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.7315, device='cuda:3')
compute distance is  tensor(6.7315, device='cuda:3')
compute norm is  tensor(2.6195e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(nan, device='cuda:3')
compute distance is  tensor(nan, device='cuda:3')
compute norm is  tensor(nan, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(nan, device='cuda:3')
distance x is tensor(2.1612e+10, device='cuda:3')
distance x is tensor(2.1612e+10, device='cuda:3')
________________________________
test distance is  tensor(2.1612e+10, device='cuda:3')
test distance1 is  tensor(2.1612e+10, device='cuda:3')
test similarity is  tensor(-0.1423, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107537159209553.88
test entropy is  0.0
________________________________
0
distance x is tensor(2.1612e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107615738278735.14
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1423, device='cuda:3')
compute_distance is  tensor(2.1612e+10, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.9878e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.328326397351543e-05
avg test loss is  13953.737261092992
avg accuracy is  0.10070000015633199
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.9878e+09, device='cuda:3')
compute_norm is  tensor(3.5791e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.8507e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1534657514552826
avg test loss is  17837.850997250473
avg accuracy is  0.09970000015633199
solo acc is  0.09941666682299866
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.8507e+09, device='cuda:3')
compute_norm is  tensor(3.5624e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.7142e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.623226057936642
avg test loss is  26187.054043996053
avg accuracy is  0.10015000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.7142e+09, device='cuda:3')
compute_norm is  tensor(3.5457e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.5785e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2661985852189663
avg test loss is  9197.768499451406
avg accuracy is  0.09888333348966533
solo acc is  0.10031666682299864
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.5785e+09, device='cuda:3')
compute_norm is  tensor(3.5291e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.4433e+09, device='cuda:3')
distance x is tensor(7.4433e+09, device='cuda:3')
________________________________
test distance is  tensor(7.4433e+09, device='cuda:3')
test distance1 is  tensor(7.4433e+09, device='cuda:3')
test similarity is  tensor(0.9979, device='cuda:3')
test acc is  0.10001666682299865
test loss is 16142.90953944614
test entropy is  0.6552521784994394
________________________________
0
distance x is tensor(7.4433e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6520316096892489
avg test loss is  17242.237996552543
avg accuracy is  0.09996666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.4433e+09, device='cuda:3')
compute_norm is  tensor(3.5126e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.3089e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2882308322610632
avg test loss is  21458.380895487026
avg accuracy is  0.09788333348966533
solo acc is  0.09975000015633198
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.3089e+09, device='cuda:3')
compute_norm is  tensor(3.4962e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.1751e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6690236865711618
avg test loss is  19739.166086817855
avg accuracy is  0.100800000156332
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.1751e+09, device='cuda:3')
compute_norm is  tensor(3.4798e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(7.0419e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.325993768950261
avg test loss is  10130.36619069251
avg accuracy is  0.10073333348966532
solo acc is  0.09993333348966532
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(7.0419e+09, device='cuda:3')
compute_norm is  tensor(3.4635e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6.9095e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6868797003714515
avg test loss is  8482.714619128688
avg accuracy is  0.10050000015633198
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(6.9095e+09, device='cuda:3')
compute_norm is  tensor(3.4473e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6.7776e+09, device='cuda:3')
distance x is tensor(6.7776e+09, device='cuda:3')
________________________________
test distance is  tensor(6.7776e+09, device='cuda:3')
test distance1 is  tensor(6.7776e+09, device='cuda:3')
test similarity is  tensor(0.9979, device='cuda:3')
test acc is  0.10000000015633197
test loss is 19480.820011072068
test entropy is  1.342905561934148
________________________________
0
distance x is tensor(6.7776e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3417481227215928
avg test loss is  14917.567236769428
avg accuracy is  0.10123333348966532
solo acc is  0.09976666682299865
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(6.7776e+09, device='cuda:3')
compute_norm is  tensor(3.4312e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6.6465e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6945479622781913
avg test loss is  27723.970165399092
avg accuracy is  0.09946666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(6.6465e+09, device='cuda:3')
compute_norm is  tensor(3.4151e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6.5159e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3592277785608256
avg test loss is  6699.1015029589
avg accuracy is  0.099400000156332
solo acc is  0.09988333348966531
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(6.5159e+09, device='cuda:3')
compute_norm is  tensor(3.3992e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6.3861e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6990658895674545
avg test loss is  16910.248733923378
avg accuracy is  0.09858333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(6.3861e+09, device='cuda:3')
compute_norm is  tensor(3.3833e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6.2569e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3667140544604646
avg test loss is  14987.520242441946
avg accuracy is  0.09916666682299867
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(6.2569e+09, device='cuda:3')
compute_norm is  tensor(3.3674e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6.1283e+09, device='cuda:3')
________________________________
test distance is  tensor(6.1283e+09, device='cuda:3')
test similarity is  tensor(0.9979, device='cuda:3')
test acc is  0.09878333348966534
test loss is 7731.314213338437
test entropy is  0.7051687004215428
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.9830562323331833
mal norm is  tensor(4.8824e+10, device='cuda:3')
distance x is tensor(6.1283e+09, device='cuda:3')
mal distance is  tensor(6.1283e+09, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([2.6695e+02, 2.3245e+02, 2.1909e+02, 2.5419e+02, 2.3367e+02, 1.7618e+02,
        2.0858e+02, 1.9422e+02, 4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10,
        4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10,
        4.8824e+10, 4.8824e+10], device='cuda:3')
sorted_norm is   tensor([1.7618e+02, 1.9422e+02, 2.0858e+02, 2.1909e+02, 2.3245e+02, 2.3367e+02,
        2.5419e+02, 2.6695e+02, 4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10,
        4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10, 4.8824e+10,
        4.8824e+10, 4.8824e+10], device='cuda:3')
used idx is  tensor([ 5,  7,  6,  2,  1,  4,  3,  0, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.92866687476635
distance x is tensor(12.5415, device='cuda:3')
benign distance is  tensor(12.5415, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.9143046736717224
distance x is tensor(9.4109, device='cuda:3')
benign distance is  tensor(9.4109, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.6704111844301224
distance x is tensor(11.0020, device='cuda:3')
benign distance is  tensor(11.0020, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.3278108537197113
distance x is tensor(13.2575, device='cuda:3')
benign distance is  tensor(13.2575, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1943218111991882
distance x is tensor(12.3019, device='cuda:3')
benign distance is  tensor(12.3019, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.9262794703245163
distance x is tensor(11.8801, device='cuda:3')
benign distance is  tensor(11.8801, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.319333463907242
distance x is tensor(9.2327, device='cuda:3')
benign distance is  tensor(9.2327, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.1729196310043335
distance x is tensor(10.8119, device='cuda:3')
benign distance is  tensor(10.8119, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(7.6388, device='cuda:3')
compute distance is  tensor(7.6388, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.5888e+12, device='cuda:3')
compute distance is  tensor(5.5888e+12, device='cuda:3')
compute norm is  tensor(4.8321e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.1303, device='cuda:3')
compute distance is  tensor(10.1303, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.0597, device='cuda:3')
compute distance is  tensor(10.0597, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.0443, device='cuda:3')
compute distance is  tensor(10.0443, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.6393, device='cuda:3')
compute distance is  tensor(9.6393, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.7047, device='cuda:3')
compute distance is  tensor(9.7047, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.7446e+12, device='cuda:3')
compute distance is  tensor(5.7446e+12, device='cuda:3')
compute norm is  tensor(5.1003e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(12.4686, device='cuda:3')
compute distance is  tensor(12.4686, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.7301, device='cuda:3')
compute distance is  tensor(9.7301, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.0421, device='cuda:3')
compute distance is  tensor(11.0421, device='cuda:3')
compute norm is  tensor(2.9844e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8835e+13, device='cuda:3')
compute distance is  tensor(2.8835e+13, device='cuda:3')
compute norm is  tensor(1.8785e+13, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(2.8835e+13, device='cuda:3')
distance x is tensor(2.4617e+10, device='cuda:3')
distance x is tensor(2.4617e+10, device='cuda:3')
________________________________
test distance is  tensor(2.4617e+10, device='cuda:3')
test distance1 is  tensor(2.4617e+10, device='cuda:3')
test similarity is  tensor(-0.1422, device='cuda:3')
test acc is  0.10000000015633198
test loss is 107659754136617.48
test entropy is  0.0
________________________________
0
distance x is tensor(2.4617e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  107513756611931.16
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1422, device='cuda:3')
compute_distance is  tensor(2.4617e+10, device='cuda:3')
compute_norm is  tensor(7912.0201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4.8750e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  9.244220734793328e-05
avg test loss is  11666.751059439644
avg accuracy is  0.09963333348966531
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(4.8750e+09, device='cuda:3')
compute_norm is  tensor(3.5552e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4.7407e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.159586585597443
avg test loss is  13585.113063376595
avg accuracy is  0.10028333348966534
solo acc is  0.10021666682299865
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(4.7407e+09, device='cuda:3')
compute_norm is  tensor(3.5385e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4.6070e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6262624577990473
avg test loss is  20225.077858569017
avg accuracy is  0.100500000156332
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(4.6070e+09, device='cuda:3')
compute_norm is  tensor(3.5220e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4.4741e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2680375201742786
avg test loss is  19233.289855080373
avg accuracy is  0.09953333348966535
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(4.4741e+09, device='cuda:3')
compute_norm is  tensor(3.5055e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4.3420e+09, device='cuda:3')
distance x is tensor(4.3420e+09, device='cuda:3')
________________________________
test distance is  tensor(4.3420e+09, device='cuda:3')
test distance1 is  tensor(4.3420e+09, device='cuda:3')
test similarity is  tensor(0.9975, device='cuda:3')
test acc is  0.10005000015633199
test loss is 23042.912402836246
test entropy is  0.6566747295767513
________________________________
0
distance x is tensor(4.3420e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6582203895044225
avg test loss is  17392.02112096434
avg accuracy is  0.10016666682299867
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(4.3420e+09, device='cuda:3')
compute_norm is  tensor(3.4891e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4.2106e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.295861368748679
avg test loss is  7656.865904415086
avg accuracy is  0.09998333348966533
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(4.2106e+09, device='cuda:3')
compute_norm is  tensor(3.4728e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4.0799e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6648297753415382
avg test loss is  22394.74670772029
avg accuracy is  0.10063333348966533
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(4.0799e+09, device='cuda:3')
compute_norm is  tensor(3.4565e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.9501e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3223254015959147
avg test loss is  16333.589228452396
avg accuracy is  0.100850000156332
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(3.9501e+09, device='cuda:3')
compute_norm is  tensor(3.4403e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.8209e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6719760717486521
avg test loss is  11143.293107846144
avg accuracy is  0.10018333348966535
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(3.8209e+09, device='cuda:3')
compute_norm is  tensor(3.4242e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.6926e+09, device='cuda:3')
distance x is tensor(3.6926e+09, device='cuda:3')
________________________________
test distance is  tensor(3.6926e+09, device='cuda:3')
test distance1 is  tensor(3.6926e+09, device='cuda:3')
test similarity is  tensor(0.9975, device='cuda:3')
test acc is  0.09990000015633198
test loss is 20238.196049820384
test entropy is  1.3437260048730033
________________________________
0
distance x is tensor(3.6926e+09, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3418665260140068
avg test loss is  4202.49773059725
avg accuracy is  0.10115000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(3.6926e+09, device='cuda:3')
compute_norm is  tensor(3.4082e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.5650e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6930704742098159
avg test loss is  12253.300837072227
avg accuracy is  0.09913333348966534
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(3.5650e+09, device='cuda:3')
compute_norm is  tensor(3.3923e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.4382e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3679147990527691
avg test loss is  8729.362899311824
avg accuracy is  0.09971666682299868
solo acc is  0.09985000015633198
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(3.4382e+09, device='cuda:3')
compute_norm is  tensor(3.3764e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.3122e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7023203565494847
avg test loss is  6548.313864222721
avg accuracy is  0.10078333348966532
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(3.3122e+09, device='cuda:3')
compute_norm is  tensor(3.3606e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.1869e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3687598507033227
avg test loss is  13986.474751195674
avg accuracy is  0.10086666682299866
solo acc is  0.09996666682299865
compute similarity  is  tensor(0.9975, device='cuda:3')
compute_distance is  tensor(3.1869e+09, device='cuda:3')
compute_norm is  tensor(3.3449e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.0625e+09, device='cuda:3')
________________________________
test distance is  tensor(3.0625e+09, device='cuda:3')
test similarity is  tensor(0.9975, device='cuda:3')
test acc is  0.101500000156332
test loss is 12046.576333324283
test entropy is  0.7131997181662618
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.968823090195656
mal norm is  tensor(2.6461e+10, device='cuda:3')
distance x is tensor(3.0625e+09, device='cuda:3')
mal distance is  tensor(3.0625e+09, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([5.5502e+02, 3.6959e+02, 5.3669e+02, 6.3718e+02, 6.3045e+02, 6.9646e+02,
        3.6997e+02, 5.6078e+02, 2.6461e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10,
        2.6461e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10,
        2.6461e+10, 2.6461e+10, 6.3175e+10, 6.8809e+13, 6.3175e+10, 6.3175e+10,
        6.3175e+10, 6.3175e+10, 6.3175e+10, 3.6105e+14, 2.4412e+10, 3.7479e+14,
        2.4412e+10, 2.4412e+10, 2.4412e+10, 2.4412e+10, 2.4412e+10, 2.4412e+10],
       device='cuda:3')
sorted_norm is   tensor([3.6959e+02, 3.6997e+02, 5.3669e+02, 5.5502e+02, 5.6078e+02, 6.3045e+02,
        6.3718e+02, 6.9646e+02, 2.4412e+10, 2.4412e+10, 2.4412e+10, 2.4412e+10,
        2.4412e+10, 2.4412e+10, 2.4412e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10,
        2.6461e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10, 2.6461e+10,
        2.6461e+10, 2.6461e+10, 2.6461e+10, 6.3175e+10, 6.3175e+10, 6.3175e+10,
        6.3175e+10, 6.3175e+10, 6.3175e+10, 6.8809e+13, 3.6105e+14, 3.7479e+14],
       device='cuda:3')
used idx is  tensor([ 1,  6,  2,  0,  7,  4,  3,  5, 35, 31, 33, 34, 28, 32, 30, 17, 11, 10,
         8,  9, 19, 13, 14, 12, 16, 18, 15, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.02% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 0.00%
|----0th round Training Accuracy : 91.98%
|----1th round Training Accuracy : 91.02%
|----2th round Training Accuracy : 83.12%
|----3th round Training Accuracy : 71.47%
|----4th round Training Accuracy : 55.08%
|----5th round Training Accuracy : 46.70%
|----6th round Training Accuracy : 78.24%
|----7th round Training Accuracy : 73.42%
|----8th round Training Accuracy : 72.93%
|----9th round Training Accuracy : 80.10%
|----10th round Training Accuracy : 80.44%
|----11th round Training Accuracy : 72.99%
|----12th round Training Accuracy : 77.53%
|----13th round Training Accuracy : 42.19%
|----14th round Training Accuracy : 69.25%
|----15th round Training Accuracy : 66.61%
|----16th round Training Accuracy : 66.54%
|----17th round Training Accuracy : 59.65%
|----18th round Training Accuracy : 80.13%
|----19th round Training Accuracy : 17.35%
|----20th round Training Accuracy : 52.16%
|----21th round Training Accuracy : 59.97%
|----22th round Training Accuracy : 74.40%
|----23th round Training Accuracy : 64.93%
|----24th round Training Accuracy : 67.18%
|----25th round Training Accuracy : 68.00%
|----26th round Training Accuracy : 64.93%
|----27th round Training Accuracy : 63.02%
|----28th round Training Accuracy : 76.54%
|----29th round Training Accuracy : 67.66%
|----30th round Training Accuracy : 79.76%
|----31th round Training Accuracy : 0.01%
|----32th round Training Accuracy : 0.00%
|----33th round Training Accuracy : 0.00%
|----34th round Training Accuracy : 0.00%
|----35th round Training Accuracy : 0.00%
|----36th round Training Accuracy : 0.00%
|----37th round Training Accuracy : 0.00%
|----38th round Training Accuracy : 0.00%
|----39th round Training Accuracy : 0.00%
|----40th round Training Accuracy : 0.00%
|----41th round Training Accuracy : 0.00%
|----42th round Training Accuracy : 6.33%
|----43th round Training Accuracy : 0.00%
|----44th round Training Accuracy : 0.00%
|----45th round Training Accuracy : 0.00%
|----46th round Training Accuracy : 0.00%
|----47th round Training Accuracy : 0.00%
|----48th round Training Accuracy : 0.00%
|----49th round Training Accuracy : 0.00%
|----Final Test Accuracy: 10.02%
|----0th round Final Test Accuracy : 83.95%
|----1th round Final Test Accuracy : 85.60%
|----2th round Final Test Accuracy : 81.21%
|----3th round Final Test Accuracy : 77.10%
|----4th round Final Test Accuracy : 69.33%
|----5th round Final Test Accuracy : 65.97%
|----6th round Final Test Accuracy : 80.82%
|----7th round Final Test Accuracy : 77.35%
|----8th round Final Test Accuracy : 80.70%
|----9th round Final Test Accuracy : 83.86%
|----10th round Final Test Accuracy : 81.70%
|----11th round Final Test Accuracy : 80.16%
|----12th round Final Test Accuracy : 80.89%
|----13th round Final Test Accuracy : 65.37%
|----14th round Final Test Accuracy : 78.79%
|----15th round Final Test Accuracy : 77.64%
|----16th round Final Test Accuracy : 76.36%
|----17th round Final Test Accuracy : 78.72%
|----18th round Final Test Accuracy : 83.08%
|----19th round Final Test Accuracy : 60.81%
|----20th round Final Test Accuracy : 63.54%
|----21th round Final Test Accuracy : 75.80%
|----22th round Final Test Accuracy : 80.19%
|----23th round Final Test Accuracy : 74.80%
|----24th round Final Test Accuracy : 80.04%
|----25th round Final Test Accuracy : 80.73%
|----26th round Final Test Accuracy : 79.77%
|----27th round Final Test Accuracy : 79.75%
|----28th round Final Test Accuracy : 80.23%
|----29th round Final Test Accuracy : 80.26%
|----30th round Final Test Accuracy : 81.06%
|----31th round Final Test Accuracy : 15.93%
|----32th round Final Test Accuracy : 10.00%
|----33th round Final Test Accuracy : 10.00%
|----34th round Final Test Accuracy : 10.00%
|----35th round Final Test Accuracy : 9.99%
|----36th round Final Test Accuracy : 10.01%
|----37th round Final Test Accuracy : 10.01%
|----38th round Final Test Accuracy : 10.01%
|----39th round Final Test Accuracy : 10.02%
|----40th round Final Test Accuracy : 10.02%
|----41th round Final Test Accuracy : 10.00%
|----42th round Final Test Accuracy : 10.01%
|----43th round Final Test Accuracy : 10.02%
|----44th round Final Test Accuracy : 10.02%
|----45th round Final Test Accuracy : 10.02%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 10.02%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 10.02%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 19758.3122
