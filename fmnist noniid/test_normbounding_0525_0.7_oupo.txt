
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.654032826423645
distance x is tensor(118.7336, device='cuda:3')
benign distance is  tensor(118.7336, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5291479229927063
distance x is tensor(123.1634, device='cuda:3')
benign distance is  tensor(123.1634, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6980900764465332
distance x is tensor(120.6253, device='cuda:3')
benign distance is  tensor(120.6253, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5047314763069153
distance x is tensor(115.4032, device='cuda:3')
benign distance is  tensor(115.4032, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7484031915664673
distance x is tensor(105.0081, device='cuda:3')
benign distance is  tensor(105.0081, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.28217747807502747
distance x is tensor(125.0382, device='cuda:3')
benign distance is  tensor(125.0382, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7585704326629639
distance x is tensor(109.5960, device='cuda:3')
benign distance is  tensor(109.5960, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5492132902145386
distance x is tensor(120.4947, device='cuda:3')
benign distance is  tensor(120.4947, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.46295061707496643
distance x is tensor(137.3017, device='cuda:3')
benign distance is  tensor(137.3017, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.35640978813171387
distance x is tensor(136.8780, device='cuda:3')
benign distance is  tensor(136.8780, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.32285818457603455
distance x is tensor(123.2137, device='cuda:3')
benign distance is  tensor(123.2137, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.19916915893554688
distance x is tensor(127.1318, device='cuda:3')
benign distance is  tensor(127.1318, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5488372445106506
distance x is tensor(127.7969, device='cuda:3')
benign distance is  tensor(127.7969, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.42274242639541626
distance x is tensor(142.0866, device='cuda:3')
benign distance is  tensor(142.0866, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.49616751074790955
distance x is tensor(139.4785, device='cuda:3')
benign distance is  tensor(139.4785, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.24857673048973083
distance x is tensor(138.5289, device='cuda:3')
benign distance is  tensor(138.5289, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4679196774959564
distance x is tensor(126.9397, device='cuda:3')
benign distance is  tensor(126.9397, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6488051414489746
distance x is tensor(144.0657, device='cuda:3')
benign distance is  tensor(144.0657, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6465486288070679
distance x is tensor(125.3733, device='cuda:3')
benign distance is  tensor(125.3733, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9110391736030579
distance x is tensor(127.7527, device='cuda:3')
benign distance is  tensor(127.7527, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.13527913391590118
distance x is tensor(128.2605, device='cuda:3')
benign distance is  tensor(128.2605, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.385130912065506
distance x is tensor(122.5103, device='cuda:3')
benign distance is  tensor(122.5103, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.24303273856639862
distance x is tensor(138.8371, device='cuda:3')
benign distance is  tensor(138.8371, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8932528495788574
distance x is tensor(132.7998, device='cuda:3')
benign distance is  tensor(132.7998, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.7176088094711304
distance x is tensor(143.2568, device='cuda:3')
benign distance is  tensor(143.2568, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6694191694259644
distance x is tensor(120.6141, device='cuda:3')
benign distance is  tensor(120.6141, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.37337735295295715
distance x is tensor(138.5492, device='cuda:3')
benign distance is  tensor(138.5492, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4589696526527405
distance x is tensor(139.8394, device='cuda:3')
benign distance is  tensor(139.8394, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8751451373100281
distance x is tensor(124.2809, device='cuda:3')
benign distance is  tensor(124.2809, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6897904276847839
distance x is tensor(136.2939, device='cuda:3')
benign distance is  tensor(136.2939, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5694698691368103
distance x is tensor(124.2161, device='cuda:3')
benign distance is  tensor(124.2161, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.018214464187622
distance x is tensor(132.3574, device='cuda:3')
benign distance is  tensor(132.3574, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5057200789451599
distance x is tensor(135.9143, device='cuda:3')
benign distance is  tensor(135.9143, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.2982335388660431
distance x is tensor(130.4648, device='cuda:3')
benign distance is  tensor(130.4648, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5174297094345093
distance x is tensor(138.0593, device='cuda:3')
benign distance is  tensor(138.0593, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04887809976935387
distance x is tensor(126.2493, device='cuda:3')
benign distance is  tensor(126.2493, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5700920820236206
distance x is tensor(125.7121, device='cuda:3')
benign distance is  tensor(125.7121, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.36263507604599
distance x is tensor(121.2820, device='cuda:3')
benign distance is  tensor(121.2820, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.45801490545272827
distance x is tensor(124.4931, device='cuda:3')
benign distance is  tensor(124.4931, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.12363545596599579
distance x is tensor(133.7208, device='cuda:3')
benign distance is  tensor(133.7208, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1725870668888092
distance x is tensor(123.4613, device='cuda:3')
benign distance is  tensor(123.4613, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6077139973640442
distance x is tensor(124.7450, device='cuda:3')
benign distance is  tensor(124.7450, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07587523013353348
distance x is tensor(127.2574, device='cuda:3')
benign distance is  tensor(127.2574, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.22132208943367004
distance x is tensor(135.8469, device='cuda:3')
benign distance is  tensor(135.8469, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.38620251417160034
distance x is tensor(138.0164, device='cuda:3')
benign distance is  tensor(138.0164, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6538048982620239
distance x is tensor(135.9611, device='cuda:3')
benign distance is  tensor(135.9611, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8921825289726257
distance x is tensor(135.3139, device='cuda:3')
benign distance is  tensor(135.3139, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4983558654785156
distance x is tensor(131.5959, device='cuda:3')
benign distance is  tensor(131.5959, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(114.0190, device='cuda:3')
compute distance is  tensor(114.0190, device='cuda:3')
compute norm is  tensor(45.5682, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.5898, device='cuda:3')
compute distance is  tensor(112.5898, device='cuda:3')
compute norm is  tensor(45.4922, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6496, device='cuda:3')
compute distance is  tensor(126.6496, device='cuda:3')
compute norm is  tensor(46.0058, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.1990, device='cuda:3')
compute distance is  tensor(107.1990, device='cuda:3')
compute norm is  tensor(45.5071, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3273, device='cuda:3')
compute distance is  tensor(123.3273, device='cuda:3')
compute norm is  tensor(45.7449, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5359, device='cuda:3')
compute distance is  tensor(127.5359, device='cuda:3')
compute norm is  tensor(46.0331, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5034, device='cuda:3')
compute distance is  tensor(119.5034, device='cuda:3')
compute norm is  tensor(45.7388, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5488, device='cuda:3')
compute distance is  tensor(127.5488, device='cuda:3')
compute norm is  tensor(45.9410, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4011, device='cuda:3')
compute distance is  tensor(123.4011, device='cuda:3')
compute norm is  tensor(45.8245, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0950, device='cuda:3')
compute distance is  tensor(129.0950, device='cuda:3')
compute norm is  tensor(46.0470, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9262, device='cuda:3')
compute distance is  tensor(120.9262, device='cuda:3')
compute norm is  tensor(45.9185, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5121, device='cuda:3')
compute distance is  tensor(128.5121, device='cuda:3')
compute norm is  tensor(45.8865, device='cuda:3', dtype=torch.float64)
batch acc is 0.1023166668229986
mal_rand_acc is 0.10000000049999999
mal_rand loss is 119521490763776.0
len of model dicts is  12
distance x is tensor(114.0190, device='cuda:3')
compute distance is  tensor(114.0190, device='cuda:3')
compute norm is  tensor(45.5682, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.5898, device='cuda:3')
compute distance is  tensor(112.5898, device='cuda:3')
compute norm is  tensor(45.4922, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6496, device='cuda:3')
compute distance is  tensor(126.6496, device='cuda:3')
compute norm is  tensor(46.0058, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.1990, device='cuda:3')
compute distance is  tensor(107.1990, device='cuda:3')
compute norm is  tensor(45.5071, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3273, device='cuda:3')
compute distance is  tensor(123.3273, device='cuda:3')
compute norm is  tensor(45.7449, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5359, device='cuda:3')
compute distance is  tensor(127.5359, device='cuda:3')
compute norm is  tensor(46.0331, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5034, device='cuda:3')
compute distance is  tensor(119.5034, device='cuda:3')
compute norm is  tensor(45.7388, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5488, device='cuda:3')
compute distance is  tensor(127.5488, device='cuda:3')
compute norm is  tensor(45.9410, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4011, device='cuda:3')
compute distance is  tensor(123.4011, device='cuda:3')
compute norm is  tensor(45.8245, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0950, device='cuda:3')
compute distance is  tensor(129.0950, device='cuda:3')
compute norm is  tensor(46.0470, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9262, device='cuda:3')
compute distance is  tensor(120.9262, device='cuda:3')
compute norm is  tensor(45.9185, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5121, device='cuda:3')
compute distance is  tensor(128.5121, device='cuda:3')
compute norm is  tensor(45.8865, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(129.0950, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
________________________________
test distance is  tensor(107710.2031, device='cuda:3')
test distance1 is  tensor(107710.2031, device='cuda:3')
test similarity is  tensor(-0.1075, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130124715708267.53
test entropy is  0.0
________________________________
cal ratio is  0.033927542327666496
distance x is tensor(3654.3481, device='cuda:3')
cal_distance is  tensor(3654.3481, device='cuda:3')
cal ratio is  0.18419415795124208
distance x is tensor(673.1138, device='cuda:3')
cal_distance is  tensor(673.1138, device='cuda:3')
cal ratio is  0.42917713346803776
distance x is tensor(288.8880, device='cuda:3')
cal_distance is  tensor(288.8880, device='cuda:3')
cal ratio is  0.6551127727901828
distance x is tensor(189.2560, device='cuda:3')
cal_distance is  tensor(189.2560, device='cuda:3')
cal ratio is  0.8093865124682716
distance x is tensor(153.1823, device='cuda:3')
cal_distance is  tensor(153.1823, device='cuda:3')
cal ratio is  0.8996561754106007
distance x is tensor(137.8119, device='cuda:3')
cal_distance is  tensor(137.8119, device='cuda:3')
cal ratio is  0.9485002930419019
distance x is tensor(130.7149, device='cuda:3')
cal_distance is  tensor(130.7149, device='cuda:3')
cal ratio is  0.9739087343911024
distance x is tensor(127.3045, device='cuda:3')
cal_distance is  tensor(127.3045, device='cuda:3')
distance x is tensor(127.3045, device='cuda:3')
return_distance is  tensor(127.3045, device='cuda:3')
distance x is tensor(127.2942, device='cuda:3')
distance x is tensor(127.2942, device='cuda:3')
________________________________
test distance is  tensor(127.2942, device='cuda:3')
test distance1 is  tensor(127.2942, device='cuda:3')
test similarity is  tensor(0.9458, device='cuda:3')
test acc is  0.10010000015633198
test loss is 284.00077779155805
test entropy is  1.778061222762517e-05
________________________________
0
distance x is tensor(127.2942, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.156485828869807e-05
avg test loss is  284.28304660040686
avg accuracy is  0.3820333334896742
solo acc is  0.10020000015633199
compute similarity  is  tensor(0.9458, device='cuda:3')
compute_distance is  tensor(127.2942, device='cuda:3')
compute_norm is  tensor(44.2524, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(107.2758, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9574333369604814
avg test loss is  1.410343334618916
avg accuracy is  0.8548000001563232
solo acc is  0.3598333334896739
compute similarity  is  tensor(0.9529, device='cuda:3')
compute_distance is  tensor(107.2758, device='cuda:3')
compute_norm is  tensor(43.0914, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.8069, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8673796431342168
avg test loss is  1.5590398319240317
avg accuracy is  0.8544333334896566
solo acc is  0.2772333334896723
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(109.8069, device='cuda:3')
compute_norm is  tensor(42.7935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.9252, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8760422410360024
avg test loss is  1.49785855380711
avg accuracy is  0.8580666668229898
solo acc is  0.27463333348967217
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(111.9252, device='cuda:3')
compute_norm is  tensor(42.5255, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.9283, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8700513043510381
avg test loss is  1.4526907594473377
avg accuracy is  0.8597333334896563
solo acc is  0.27588333348967226
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(113.9283, device='cuda:3')
compute_norm is  tensor(42.2750, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.8129, device='cuda:3')
distance x is tensor(115.8129, device='cuda:3')
________________________________
test distance is  tensor(115.8129, device='cuda:3')
test distance1 is  tensor(115.8129, device='cuda:3')
test similarity is  tensor(0.9512, device='cuda:3')
test acc is  0.2776833334896724
test loss is 1.4207732727024347
test entropy is  0.8693904144042082
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2813295125961304
mal norm is  tensor(605.2045, device='cuda:3')
distance x is tensor(115.8205, device='cuda:3')
mal distance is  tensor(115.8205, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([532.2544, 568.7947, 542.6058, 525.3312, 476.9521, 571.7781, 490.4940,
        565.4054, 605.2045, 605.2045, 605.2045, 605.2045, 605.2045, 605.2045,
        605.2045, 605.2045, 605.2045, 605.2045, 605.2045, 605.2045],
       device='cuda:3')
sorted_norm is   tensor([476.9521, 490.4940, 525.3312, 532.2544, 542.6058, 565.4054, 568.7947,
        571.7781, 605.2045, 605.2045, 605.2045, 605.2045, 605.2045, 605.2045,
        605.2045, 605.2045, 605.2045, 605.2045, 605.2045, 605.2045],
       device='cuda:3')
used idx is  tensor([ 4,  6,  3,  0,  2,  7,  1,  5, 19, 17, 13, 15, 11,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 87.82% 

Test Accuracy: 86.78% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.33865946531295776
distance x is tensor(117.8145, device='cuda:3')
benign distance is  tensor(117.8145, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2364163398742676
distance x is tensor(145.1009, device='cuda:3')
benign distance is  tensor(145.1009, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31958484649658203
distance x is tensor(146.8568, device='cuda:3')
benign distance is  tensor(146.8568, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.61863774061203
distance x is tensor(139.6594, device='cuda:3')
benign distance is  tensor(139.6594, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1922835111618042
distance x is tensor(123.9835, device='cuda:3')
benign distance is  tensor(123.9835, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4356600344181061
distance x is tensor(132.4357, device='cuda:3')
benign distance is  tensor(132.4357, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.43960055708885193
distance x is tensor(131.9921, device='cuda:3')
benign distance is  tensor(131.9921, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.11809825897216797
distance x is tensor(129.9911, device='cuda:3')
benign distance is  tensor(129.9911, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(126.1019, device='cuda:3')
compute distance is  tensor(126.1019, device='cuda:3')
compute norm is  tensor(44.7931, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9757, device='cuda:3')
compute distance is  tensor(123.9757, device='cuda:3')
compute norm is  tensor(44.8333, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.5871, device='cuda:3')
compute distance is  tensor(154.5871, device='cuda:3')
compute norm is  tensor(45.6771, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0861, device='cuda:3')
compute distance is  tensor(126.0861, device='cuda:3')
compute norm is  tensor(44.9596, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4808, device='cuda:3')
compute distance is  tensor(144.4808, device='cuda:3')
compute norm is  tensor(45.4049, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4218, device='cuda:3')
compute distance is  tensor(136.4218, device='cuda:3')
compute norm is  tensor(45.2913, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1845, device='cuda:3')
compute distance is  tensor(135.1845, device='cuda:3')
compute norm is  tensor(45.1089, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9047, device='cuda:3')
compute distance is  tensor(135.9047, device='cuda:3')
compute norm is  tensor(45.0691, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8215, device='cuda:3')
compute distance is  tensor(132.8215, device='cuda:3')
compute norm is  tensor(44.9726, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.6696, device='cuda:3')
compute distance is  tensor(136.6696, device='cuda:3')
compute norm is  tensor(45.2925, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6325, device='cuda:3')
compute distance is  tensor(139.6325, device='cuda:3')
compute norm is  tensor(45.2225, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6911, device='cuda:3')
compute distance is  tensor(128.6911, device='cuda:3')
compute norm is  tensor(45.0029, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.5871, device='cuda:3')
distance x is tensor(107680.2266, device='cuda:3')
distance x is tensor(107680.2266, device='cuda:3')
________________________________
test distance is  tensor(107680.2266, device='cuda:3')
test distance1 is  tensor(107680.2266, device='cuda:3')
test similarity is  tensor(0.0083, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129996962565331.78
test entropy is  0.0
________________________________
cal ratio is  0.03713169620128857
distance x is tensor(3998.3552, device='cuda:3')
cal_distance is  tensor(3998.3552, device='cuda:3')
cal ratio is  0.19269572118564635
distance x is tensor(770.4701, device='cuda:3')
cal_distance is  tensor(770.4701, device='cuda:3')
cal ratio is  0.43897003561138376
distance x is tensor(338.2162, device='cuda:3')
cal_distance is  tensor(338.2162, device='cuda:3')
cal ratio is  0.6625452763182995
distance x is tensor(224.0853, device='cuda:3')
cal_distance is  tensor(224.0853, device='cuda:3')
cal ratio is  0.8139656976705647
distance x is tensor(182.3987, device='cuda:3')
cal_distance is  tensor(182.3987, device='cuda:3')
cal ratio is  0.9021980660945914
distance x is tensor(164.5603, device='cuda:3')
cal_distance is  tensor(164.5603, device='cuda:3')
cal ratio is  0.9498396241063456
distance x is tensor(156.3061, device='cuda:3')
cal_distance is  tensor(156.3061, device='cuda:3')
cal ratio is  0.9745963105512926
distance x is tensor(152.3355, device='cuda:3')
cal_distance is  tensor(152.3355, device='cuda:3')
distance x is tensor(152.3355, device='cuda:3')
return_distance is  tensor(152.3355, device='cuda:3')
distance x is tensor(152.3252, device='cuda:3')
distance x is tensor(152.3252, device='cuda:3')
________________________________
test distance is  tensor(152.3252, device='cuda:3')
test distance1 is  tensor(152.3252, device='cuda:3')
test similarity is  tensor(0.9272, device='cuda:3')
test acc is  0.10000000015633198
test loss is 718.874698793456
test entropy is  1.2907034479986272e-43
________________________________
0
distance x is tensor(152.3252, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.601986407616e-42
avg test loss is  719.6891987033998
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9272, device='cuda:3')
compute_distance is  tensor(152.3252, device='cuda:3')
compute_norm is  tensor(45.2476, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.7858, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0313882884313303
avg test loss is  1.5790561887501144
avg accuracy is  0.6354166668230017
solo acc is  0.28633333348967255
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(131.7858, device='cuda:3')
compute_norm is  tensor(44.8489, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(132.6416, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.617105064583994
avg test loss is  2.480809295355384
avg accuracy is  0.5060833334896755
solo acc is  0.11753333348966527
compute similarity  is  tensor(0.9347, device='cuda:3')
compute_distance is  tensor(132.6416, device='cuda:3')
compute_norm is  tensor(44.6835, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(132.8133, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9461945388744126
avg test loss is  1.4351670524713074
avg accuracy is  0.6494666668230007
solo acc is  0.2975333334896728
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(132.8133, device='cuda:3')
compute_norm is  tensor(44.3989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(132.8133, device='cuda:3')
distance x is tensor(132.8133, device='cuda:3')
________________________________
test distance is  tensor(132.8133, device='cuda:3')
test distance1 is  tensor(132.8133, device='cuda:3')
test similarity is  tensor(0.9350, device='cuda:3')
test acc is  0.2994333334896728
test loss is 1.4333365313025679
test entropy is  0.9471921688203873
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2536158561706543
mal norm is  tensor(717.6908, device='cuda:3')
distance x is tensor(132.8213, device='cuda:3')
mal distance is  tensor(132.8213, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([524.8168, 630.2525, 624.7533, 606.9067, 533.6689, 587.4459, 580.2678,
        571.1697, 717.6908, 717.6908, 717.6908, 717.6908, 717.6908, 717.6908,
        717.6908, 717.6908, 717.6908, 717.6908, 717.6908, 717.6908, 677.9789,
        673.5295, 622.9609, 641.1006, 648.0526, 711.0917, 695.6061, 682.5537],
       device='cuda:3')
sorted_norm is   tensor([524.8168, 533.6689, 571.1697, 580.2678, 587.4459, 606.9067, 622.9609,
        624.7533, 630.2525, 641.1006, 648.0526, 673.5295, 677.9789, 682.5537,
        695.6061, 711.0917, 717.6908, 717.6908, 717.6908, 717.6908, 717.6908,
        717.6908, 717.6908, 717.6908, 717.6908, 717.6908, 717.6908, 717.6908],
       device='cuda:3')
used idx is  tensor([ 0,  4,  7,  6,  5,  3, 22,  2,  1, 23, 24, 21, 20, 27, 26, 25, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 89.01% 

Test Accuracy: 88.21% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46885499358177185
distance x is tensor(117.1430, device='cuda:3')
benign distance is  tensor(117.1430, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6424833536148071
distance x is tensor(123.5454, device='cuda:3')
benign distance is  tensor(123.5454, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14817847311496735
distance x is tensor(114.6267, device='cuda:3')
benign distance is  tensor(114.6267, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.22407278418540955
distance x is tensor(128.3405, device='cuda:3')
benign distance is  tensor(128.3405, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1370525360107422
distance x is tensor(119.2990, device='cuda:3')
benign distance is  tensor(119.2990, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9891074895858765
distance x is tensor(123.3658, device='cuda:3')
benign distance is  tensor(123.3658, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33941084146499634
distance x is tensor(121.0157, device='cuda:3')
benign distance is  tensor(121.0157, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10587012767791748
distance x is tensor(120.9309, device='cuda:3')
benign distance is  tensor(120.9309, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.621378481388092
distance x is tensor(146.7565, device='cuda:3')
benign distance is  tensor(146.7565, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4053575098514557
distance x is tensor(136.7732, device='cuda:3')
benign distance is  tensor(136.7732, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3524695038795471
distance x is tensor(137.0459, device='cuda:3')
benign distance is  tensor(137.0459, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6606374979019165
distance x is tensor(129.3767, device='cuda:3')
benign distance is  tensor(129.3767, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5628076195716858
distance x is tensor(127.1013, device='cuda:3')
benign distance is  tensor(127.1013, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.33397457003593445
distance x is tensor(147.0607, device='cuda:3')
benign distance is  tensor(147.0607, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3740793466567993
distance x is tensor(147.5012, device='cuda:3')
benign distance is  tensor(147.5012, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8837094306945801
distance x is tensor(145.4016, device='cuda:3')
benign distance is  tensor(145.4016, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(120.4208, device='cuda:3')
compute distance is  tensor(120.4208, device='cuda:3')
compute norm is  tensor(45.2580, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7957, device='cuda:3')
compute distance is  tensor(122.7957, device='cuda:3')
compute norm is  tensor(45.3022, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9026, device='cuda:3')
compute distance is  tensor(125.9026, device='cuda:3')
compute norm is  tensor(45.4578, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4530, device='cuda:3')
compute distance is  tensor(129.4530, device='cuda:3')
compute norm is  tensor(45.5158, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.4024, device='cuda:3')
compute distance is  tensor(133.4024, device='cuda:3')
compute norm is  tensor(45.4700, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9384, device='cuda:3')
compute distance is  tensor(126.9384, device='cuda:3')
compute norm is  tensor(45.5775, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7384, device='cuda:3')
compute distance is  tensor(121.7384, device='cuda:3')
compute norm is  tensor(45.3231, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0293, device='cuda:3')
compute distance is  tensor(133.0293, device='cuda:3')
compute norm is  tensor(45.7297, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9289, device='cuda:3')
compute distance is  tensor(130.9289, device='cuda:3')
compute norm is  tensor(45.3356, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.5290, device='cuda:3')
compute distance is  tensor(116.5290, device='cuda:3')
compute norm is  tensor(45.3138, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6128, device='cuda:3')
compute distance is  tensor(133.6128, device='cuda:3')
compute norm is  tensor(45.6145, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9843, device='cuda:3')
compute distance is  tensor(127.9843, device='cuda:3')
compute norm is  tensor(45.4989, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(133.6128, device='cuda:3')
distance x is tensor(107687.7344, device='cuda:3')
distance x is tensor(107687.7344, device='cuda:3')
________________________________
test distance is  tensor(107687.7344, device='cuda:3')
test distance1 is  tensor(107687.7344, device='cuda:3')
test similarity is  tensor(-0.0042, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130033392760609.3
test entropy is  0.0
________________________________
cal ratio is  0.03451969642541366
distance x is tensor(3717.3528, device='cuda:3')
cal_distance is  tensor(3717.3528, device='cuda:3')
cal ratio is  0.1857946487211893
distance x is tensor(690.6685, device='cuda:3')
cal_distance is  tensor(690.6685, device='cuda:3')
cal ratio is  0.43103772411491614
distance x is tensor(297.7071, device='cuda:3')
cal_distance is  tensor(297.7071, device='cuda:3')
cal ratio is  0.6565313720223654
distance x is tensor(195.4558, device='cuda:3')
cal_distance is  tensor(195.4558, device='cuda:3')
cal ratio is  0.8102625753732734
distance x is tensor(158.3715, device='cuda:3')
cal_distance is  tensor(158.3715, device='cuda:3')
cal ratio is  0.9001430606918676
distance x is tensor(142.5576, device='cuda:3')
cal_distance is  tensor(142.5576, device='cuda:3')
cal ratio is  0.9487569673882975
distance x is tensor(135.2528, device='cuda:3')
cal_distance is  tensor(135.2528, device='cuda:3')
cal ratio is  0.9740405348919297
distance x is tensor(131.7418, device='cuda:3')
cal_distance is  tensor(131.7418, device='cuda:3')
distance x is tensor(131.7418, device='cuda:3')
return_distance is  tensor(131.7418, device='cuda:3')
distance x is tensor(131.7316, device='cuda:3')
distance x is tensor(131.7316, device='cuda:3')
________________________________
test distance is  tensor(131.7316, device='cuda:3')
test distance1 is  tensor(131.7316, device='cuda:3')
test similarity is  tensor(0.9447, device='cuda:3')
test acc is  0.10001666682299865
test loss is 323.64718686492205
test entropy is  2.5062003995525687e-05
________________________________
0
distance x is tensor(131.7316, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1717153727408432e-05
avg test loss is  323.3681903830978
avg accuracy is  0.14385000015633262
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9447, device='cuda:3')
compute_distance is  tensor(131.7316, device='cuda:3')
compute_norm is  tensor(45.0898, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(114.7750, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.934677389194208
avg test loss is  1.4725611996549024
avg accuracy is  0.7802333334896598
solo acc is  0.32460000015633994
compute similarity  is  tensor(0.9501, device='cuda:3')
compute_distance is  tensor(114.7750, device='cuda:3')
compute_norm is  tensor(44.3872, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(114.7750, device='cuda:3')
distance x is tensor(114.7750, device='cuda:3')
________________________________
test distance is  tensor(114.7750, device='cuda:3')
test distance1 is  tensor(114.7750, device='cuda:3')
test similarity is  tensor(0.9501, device='cuda:3')
test acc is  0.32371666682300665
test loss is 1.468376114932713
test entropy is  0.9367254572763626
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5360090732574463
mal norm is  tensor(628.6921, device='cuda:3')
distance x is tensor(114.7841, device='cuda:3')
mal distance is  tensor(114.7841, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([514.1854, 541.9781, 497.2348, 563.7802, 508.5486, 549.4973, 526.0079,
        537.5508, 628.6921, 628.6921, 628.6921, 628.6921, 628.6921, 628.6921,
        628.6921, 628.6921, 628.6921, 628.6921, 628.6921, 628.6921, 632.6052,
        711.3218, 629.1062, 645.4352, 635.8460, 619.3512, 686.9681, 649.2419],
       device='cuda:3')
sorted_norm is   tensor([497.2348, 508.5486, 514.1854, 526.0079, 537.5508, 541.9781, 549.4973,
        563.7802, 619.3512, 628.6921, 628.6921, 628.6921, 628.6921, 628.6921,
        628.6921, 628.6921, 628.6921, 628.6921, 628.6921, 628.6921, 628.6921,
        629.1062, 632.6052, 635.8460, 645.4352, 649.2419, 686.9681, 711.3218],
       device='cuda:3')
used idx is  tensor([ 2,  4,  0,  6,  7,  1,  5,  3, 25, 18, 16, 17, 19, 12, 14, 15, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 84.59% 

Test Accuracy: 83.52% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5929661989212036
distance x is tensor(157.8598, device='cuda:3')
benign distance is  tensor(157.8598, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8847874402999878
distance x is tensor(148.9952, device='cuda:3')
benign distance is  tensor(148.9952, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14624790847301483
distance x is tensor(154.4651, device='cuda:3')
benign distance is  tensor(154.4651, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5937487483024597
distance x is tensor(156.1232, device='cuda:3')
benign distance is  tensor(156.1232, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6904918551445007
distance x is tensor(165.4327, device='cuda:3')
benign distance is  tensor(165.4327, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6083046197891235
distance x is tensor(156.6472, device='cuda:3')
benign distance is  tensor(156.6472, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1773880124092102
distance x is tensor(148.4600, device='cuda:3')
benign distance is  tensor(148.4600, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43456149101257324
distance x is tensor(148.7036, device='cuda:3')
benign distance is  tensor(148.7036, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4230922758579254
distance x is tensor(163.9629, device='cuda:3')
benign distance is  tensor(163.9629, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5701557397842407
distance x is tensor(174.9468, device='cuda:3')
benign distance is  tensor(174.9468, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5997713208198547
distance x is tensor(159.7370, device='cuda:3')
benign distance is  tensor(159.7370, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.45888271927833557
distance x is tensor(163.5439, device='cuda:3')
benign distance is  tensor(163.5439, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.41452521085739136
distance x is tensor(171.3646, device='cuda:3')
benign distance is  tensor(171.3646, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7062772512435913
distance x is tensor(151.0455, device='cuda:3')
benign distance is  tensor(151.0455, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4407881200313568
distance x is tensor(165.5024, device='cuda:3')
benign distance is  tensor(165.5024, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9143961071968079
distance x is tensor(162.6326, device='cuda:3')
benign distance is  tensor(162.6326, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(147.5989, device='cuda:3')
compute distance is  tensor(147.5989, device='cuda:3')
compute norm is  tensor(45.7224, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.2903, device='cuda:3')
compute distance is  tensor(159.2903, device='cuda:3')
compute norm is  tensor(46.0793, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.2113, device='cuda:3')
compute distance is  tensor(159.2113, device='cuda:3')
compute norm is  tensor(46.2405, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9727, device='cuda:3')
compute distance is  tensor(153.9727, device='cuda:3')
compute norm is  tensor(46.0692, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.4276, device='cuda:3')
compute distance is  tensor(158.4276, device='cuda:3')
compute norm is  tensor(46.0639, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.4362, device='cuda:3')
compute distance is  tensor(171.4362, device='cuda:3')
compute norm is  tensor(46.4170, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.6522, device='cuda:3')
compute distance is  tensor(167.6522, device='cuda:3')
compute norm is  tensor(46.3103, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.0773, device='cuda:3')
compute distance is  tensor(162.0773, device='cuda:3')
compute norm is  tensor(46.1944, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.0791, device='cuda:3')
compute distance is  tensor(157.0791, device='cuda:3')
compute norm is  tensor(46.0142, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.9920, device='cuda:3')
compute distance is  tensor(156.9920, device='cuda:3')
compute norm is  tensor(46.1449, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.1004, device='cuda:3')
compute distance is  tensor(158.1004, device='cuda:3')
compute norm is  tensor(46.0949, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.9883, device='cuda:3')
compute distance is  tensor(155.9883, device='cuda:3')
compute norm is  tensor(46.0395, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(171.4362, device='cuda:3')
distance x is tensor(107649.0391, device='cuda:3')
distance x is tensor(107649.0391, device='cuda:3')
________________________________
test distance is  tensor(107649.0391, device='cuda:3')
test distance1 is  tensor(107649.0391, device='cuda:3')
test similarity is  tensor(0.1368, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130110318889462.17
test entropy is  0.0
________________________________
cal ratio is  0.039108596232487
distance x is tensor(4210.0088, device='cuda:3')
cal_distance is  tensor(4210.0088, device='cuda:3')
cal ratio is  0.19775879422398754
distance x is tensor(832.5703, device='cuda:3')
cal_distance is  tensor(832.5703, device='cuda:3')
cal ratio is  0.44469971451031753
distance x is tensor(370.2466, device='cuda:3')
cal_distance is  tensor(370.2466, device='cuda:3')
cal ratio is  0.6668555619035532
distance x is tensor(246.9027, device='cuda:3')
cal_distance is  tensor(246.9027, device='cuda:3')
cal ratio is  0.8166093814149803
distance x is tensor(201.6240, device='cuda:3')
cal_distance is  tensor(201.6240, device='cuda:3')
cal ratio is  0.9036623148108632
distance x is tensor(182.2005, device='cuda:3')
cal_distance is  tensor(182.2005, device='cuda:3')
cal ratio is  0.9506102813243362
distance x is tensor(173.2020, device='cuda:3')
cal_distance is  tensor(173.2020, device='cuda:3')
cal ratio is  0.9749917026802504
distance x is tensor(168.8706, device='cuda:3')
cal_distance is  tensor(168.8706, device='cuda:3')
distance x is tensor(168.8706, device='cuda:3')
return_distance is  tensor(168.8706, device='cuda:3')
distance x is tensor(168.8604, device='cuda:3')
distance x is tensor(168.8604, device='cuda:3')
________________________________
test distance is  tensor(168.8604, device='cuda:3')
test distance1 is  tensor(168.8604, device='cuda:3')
test similarity is  tensor(0.9247, device='cuda:3')
test acc is  0.10000000015633198
test loss is 782.2406571963703
test entropy is  3.889186995125353e-18
________________________________
0
distance x is tensor(168.8604, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0316676453481123e-37
avg test loss is  782.1641042745952
avg accuracy is  0.10030000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9247, device='cuda:3')
compute_distance is  tensor(168.8604, device='cuda:3')
compute_norm is  tensor(47.7450, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.1723, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5421755510860924
avg test loss is  2.740599230408414
avg accuracy is  0.27591666682300564
solo acc is  0.10496666682299864
compute similarity  is  tensor(0.9217, device='cuda:3')
compute_distance is  tensor(168.1723, device='cuda:3')
compute_norm is  tensor(48.7684, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.1030, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8579723815292691
avg test loss is  3.4780219048579366
avg accuracy is  0.21585000015633699
solo acc is  0.10056666682299865
compute similarity  is  tensor(0.9207, device='cuda:3')
compute_distance is  tensor(169.1030, device='cuda:3')
compute_norm is  tensor(48.9065, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.8823, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4169997959248801
avg test loss is  2.320550809791093
avg accuracy is  0.3136833334896731
solo acc is  0.13793333348966538
compute similarity  is  tensor(0.9217, device='cuda:3')
compute_distance is  tensor(169.8823, device='cuda:3')
compute_norm is  tensor(48.4380, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.0488, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7790659588537237
avg test loss is  3.0780051463702596
avg accuracy is  0.23996666682300463
solo acc is  0.10280000015633196
compute similarity  is  tensor(0.9209, device='cuda:3')
compute_distance is  tensor(171.0488, device='cuda:3')
compute_norm is  tensor(48.4965, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.3562, device='cuda:3')
distance x is tensor(172.3562, device='cuda:3')
________________________________
test distance is  tensor(172.3562, device='cuda:3')
test distance1 is  tensor(172.3562, device='cuda:3')
test similarity is  tensor(0.9214, device='cuda:3')
test acc is  0.15481666682300022
test loss is 2.0807881566253044
test entropy is  1.2346461834683855
________________________________
cal ratio is  0.9773809907741561
distance x is tensor(168.4644, device='cuda:3')
cal_distance is  tensor(168.4644, device='cuda:3')
distance x is tensor(168.4644, device='cuda:3')
return_distance is  tensor(168.4644, device='cuda:3')
distance x is tensor(168.4576, device='cuda:3')
distance x is tensor(168.4576, device='cuda:3')
________________________________
test distance is  tensor(168.4576, device='cuda:3')
test distance1 is  tensor(168.4576, device='cuda:3')
test similarity is  tensor(0.9244, device='cuda:3')
test acc is  0.15268333348966673
test loss is 2.0657859726755348
test entropy is  1.267055205063525
________________________________
0
distance x is tensor(168.4576, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2680889551065115
avg test loss is  2.062092359005007
avg accuracy is  0.36850000015634077
solo acc is  0.15176666682300002
compute similarity  is  tensor(0.9244, device='cuda:3')
compute_distance is  tensor(168.4576, device='cuda:3')
compute_norm is  tensor(47.9344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.2148, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7287797666053528
avg test loss is  2.8510360199251155
avg accuracy is  0.3002666668230062
solo acc is  0.10330000015633196
compute similarity  is  tensor(0.9237, device='cuda:3')
compute_distance is  tensor(169.2148, device='cuda:3')
compute_norm is  tensor(47.8862, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.8680, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1222953532042026
avg test loss is  1.91612831844704
avg accuracy is  0.42695000015634144
solo acc is  0.16825000015633454
compute similarity  is  tensor(0.9242, device='cuda:3')
compute_distance is  tensor(169.8680, device='cuda:3')
compute_norm is  tensor(47.5880, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.3855, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.666782748406884
avg test loss is  2.5925979042358236
avg accuracy is  0.34890000015634043
solo acc is  0.10678333348966529
compute similarity  is  tensor(0.9237, device='cuda:3')
compute_distance is  tensor(170.3855, device='cuda:3')
compute_norm is  tensor(47.4933, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.3472, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0334026460835675
avg test loss is  1.610411008283782
avg accuracy is  0.4479666668230083
solo acc is  0.22988333348967094
compute similarity  is  tensor(0.9238, device='cuda:3')
compute_distance is  tensor(171.3472, device='cuda:3')
compute_norm is  tensor(47.1895, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.8409, device='cuda:3')
distance x is tensor(171.8409, device='cuda:3')
________________________________
test distance is  tensor(171.8409, device='cuda:3')
test distance1 is  tensor(171.8409, device='cuda:3')
test similarity is  tensor(0.9232, device='cuda:3')
test acc is  0.10565000015633196
test loss is 2.4276116482738748
test entropy is  0.6359882495169447
________________________________
cal ratio is  0.978845175175122
distance x is tensor(168.2123, device='cuda:3')
cal_distance is  tensor(168.2123, device='cuda:3')
distance x is tensor(168.2123, device='cuda:3')
return_distance is  tensor(168.2123, device='cuda:3')
distance x is tensor(168.2056, device='cuda:3')
distance x is tensor(168.2056, device='cuda:3')
________________________________
test distance is  tensor(168.2056, device='cuda:3')
test distance1 is  tensor(168.2056, device='cuda:3')
test similarity is  tensor(0.9261, device='cuda:3')
test acc is  0.10598333348966528
test loss is 2.3655827497876785
test entropy is  0.6761279209082061
________________________________
0
distance x is tensor(168.2056, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6755995659558758
avg test loss is  2.3659733376269148
avg accuracy is  0.3655000001563407
solo acc is  0.10653333348966529
compute similarity  is  tensor(0.9261, device='cuda:3')
compute_distance is  tensor(168.2056, device='cuda:3')
compute_norm is  tensor(46.9262, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.2330, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9933925937614969
avg test loss is  1.534754708504626
avg accuracy is  0.47005000015634185
solo acc is  0.23588333348967108
compute similarity  is  tensor(0.9260, device='cuda:3')
compute_distance is  tensor(169.2330, device='cuda:3')
compute_norm is  tensor(46.6371, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(169.2396, device='cuda:3')
________________________________
test distance is  tensor(169.2396, device='cuda:3')
test similarity is  tensor(0.9260, device='cuda:3')
test acc is  0.47046666682300853
test loss is 1.5325717637533827
test entropy is  0.9932295559311727
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2782316207885742
mal norm is  tensor(803.1922, device='cuda:3')
distance x is tensor(169.2396, device='cuda:3')
mal distance is  tensor(169.2396, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([667.3680, 620.4996, 639.1805, 649.6488, 675.3097, 658.7810, 617.4926,
        628.5749, 803.1922, 803.1922, 803.1922, 803.1922, 803.1922, 803.1922,
        803.1922, 803.1922, 803.1922, 803.1922, 803.1922, 803.1922, 853.1487,
        770.9669, 836.6186, 835.2484, 786.4451, 833.9819, 791.0329, 825.3207,
        735.0800, 695.9415, 696.5270, 663.2500, 663.5005, 719.7298, 731.6552,
        716.8655], device='cuda:3')
sorted_norm is   tensor([617.4926, 620.4996, 628.5749, 639.1805, 649.6488, 658.7810, 663.2500,
        663.5005, 667.3680, 675.3097, 695.9415, 696.5270, 716.8655, 719.7298,
        731.6552, 735.0800, 770.9669, 786.4451, 791.0329, 803.1922, 803.1922,
        803.1922, 803.1922, 803.1922, 803.1922, 803.1922, 803.1922, 803.1922,
        803.1922, 803.1922, 803.1922, 825.3207, 833.9819, 835.2484, 836.6186,
        853.1487], device='cuda:3')
used idx is  tensor([ 6,  1,  7,  2,  3,  5, 31, 32,  0,  4, 29, 30, 35, 33, 34, 28, 21, 24,
        26, 19, 13, 11,  8, 10, 16], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.42% 

Test Accuracy: 87.53% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4454866349697113
distance x is tensor(131.4265, device='cuda:3')
benign distance is  tensor(131.4265, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6727853417396545
distance x is tensor(131.8635, device='cuda:3')
benign distance is  tensor(131.8635, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.30120500922203064
distance x is tensor(140.8644, device='cuda:3')
benign distance is  tensor(140.8644, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48655539751052856
distance x is tensor(139.0233, device='cuda:3')
benign distance is  tensor(139.0233, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8448607325553894
distance x is tensor(133.7524, device='cuda:3')
benign distance is  tensor(133.7524, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5527763962745667
distance x is tensor(139.5255, device='cuda:3')
benign distance is  tensor(139.5255, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.57048100233078
distance x is tensor(134.4747, device='cuda:3')
benign distance is  tensor(134.4747, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4743890166282654
distance x is tensor(139.3592, device='cuda:3')
benign distance is  tensor(139.3592, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8934769630432129
distance x is tensor(141.2213, device='cuda:3')
benign distance is  tensor(141.2213, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7083200216293335
distance x is tensor(139.2065, device='cuda:3')
benign distance is  tensor(139.2065, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4485413432121277
distance x is tensor(131.8641, device='cuda:3')
benign distance is  tensor(131.8641, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0668284893035889
distance x is tensor(149.2517, device='cuda:3')
benign distance is  tensor(149.2517, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.32689616084098816
distance x is tensor(147.2599, device='cuda:3')
benign distance is  tensor(147.2599, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4141108989715576
distance x is tensor(144.3289, device='cuda:3')
benign distance is  tensor(144.3289, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5412015914916992
distance x is tensor(144.5338, device='cuda:3')
benign distance is  tensor(144.5338, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.41652965545654297
distance x is tensor(142.4607, device='cuda:3')
benign distance is  tensor(142.4607, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6295784711837769
distance x is tensor(137.1200, device='cuda:3')
benign distance is  tensor(137.1200, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.17983821034431458
distance x is tensor(143.4338, device='cuda:3')
benign distance is  tensor(143.4338, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.18938003480434418
distance x is tensor(143.9011, device='cuda:3')
benign distance is  tensor(143.9011, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.43897074460983276
distance x is tensor(132.4495, device='cuda:3')
benign distance is  tensor(132.4495, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.43191665410995483
distance x is tensor(144.9079, device='cuda:3')
benign distance is  tensor(144.9079, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9340451955795288
distance x is tensor(142.2780, device='cuda:3')
benign distance is  tensor(142.2780, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.19742007553577423
distance x is tensor(131.7979, device='cuda:3')
benign distance is  tensor(131.7979, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.257174551486969
distance x is tensor(142.9701, device='cuda:3')
benign distance is  tensor(142.9701, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(131.8767, device='cuda:3')
compute distance is  tensor(131.8767, device='cuda:3')
compute norm is  tensor(45.5316, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5769, device='cuda:3')
compute distance is  tensor(126.5769, device='cuda:3')
compute norm is  tensor(45.4915, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7241, device='cuda:3')
compute distance is  tensor(137.7241, device='cuda:3')
compute norm is  tensor(45.8739, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5620, device='cuda:3')
compute distance is  tensor(132.5620, device='cuda:3')
compute norm is  tensor(45.5535, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.7066, device='cuda:3')
compute distance is  tensor(149.7066, device='cuda:3')
compute norm is  tensor(46.0812, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6123, device='cuda:3')
compute distance is  tensor(133.6123, device='cuda:3')
compute norm is  tensor(45.8128, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6755, device='cuda:3')
compute distance is  tensor(128.6755, device='cuda:3')
compute norm is  tensor(45.5310, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6812, device='cuda:3')
compute distance is  tensor(137.6812, device='cuda:3')
compute norm is  tensor(45.7541, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2177, device='cuda:3')
compute distance is  tensor(134.2177, device='cuda:3')
compute norm is  tensor(45.7268, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1779, device='cuda:3')
compute distance is  tensor(129.1779, device='cuda:3')
compute norm is  tensor(45.6303, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4899, device='cuda:3')
compute distance is  tensor(137.4899, device='cuda:3')
compute norm is  tensor(45.9125, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3149, device='cuda:3')
compute distance is  tensor(135.3149, device='cuda:3')
compute norm is  tensor(45.5670, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.7066, device='cuda:3')
distance x is tensor(107663.8438, device='cuda:3')
distance x is tensor(107663.8438, device='cuda:3')
________________________________
test distance is  tensor(107663.8438, device='cuda:3')
test distance1 is  tensor(107663.8438, device='cuda:3')
test similarity is  tensor(0.1110, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130153403450881.1
test entropy is  0.0
________________________________
cal ratio is  0.03654362349303376
distance x is tensor(3934.4321, device='cuda:3')
cal_distance is  tensor(3934.4321, device='cuda:3')
cal ratio is  0.19116374503613692
distance x is tensor(752.1249, device='cuda:3')
cal_distance is  tensor(752.1249, device='cuda:3')
cal ratio is  0.4372215588959079
distance x is tensor(328.8481, device='cuda:3')
cal_distance is  tensor(328.8481, device='cuda:3')
cal ratio is  0.6612244499765304
distance x is tensor(217.4442, device='cuda:3')
cal_distance is  tensor(217.4442, device='cuda:3')
cal ratio is  0.8131537466956603
distance x is tensor(176.8165, device='cuda:3')
cal_distance is  tensor(176.8165, device='cuda:3')
cal ratio is  0.9017480312095366
distance x is tensor(159.4444, device='cuda:3')
cal_distance is  tensor(159.4444, device='cuda:3')
cal ratio is  0.9496025631031428
distance x is tensor(151.4091, device='cuda:3')
cal_distance is  tensor(151.4091, device='cuda:3')
cal ratio is  0.97447468919947
distance x is tensor(147.5445, device='cuda:3')
cal_distance is  tensor(147.5445, device='cuda:3')
distance x is tensor(147.5445, device='cuda:3')
return_distance is  tensor(147.5445, device='cuda:3')
distance x is tensor(147.5343, device='cuda:3')
distance x is tensor(147.5343, device='cuda:3')
________________________________
test distance is  tensor(147.5343, device='cuda:3')
test distance1 is  tensor(147.5343, device='cuda:3')
test similarity is  tensor(0.9386, device='cuda:3')
test acc is  0.10938333348966528
test loss is 184.18854665857896
test entropy is  0.00424994747635698
________________________________
0
distance x is tensor(147.5343, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.004280598803101956
avg test loss is  184.19952179475635
avg accuracy is  0.46596666682300847
solo acc is  0.10906666682299862
compute similarity  is  tensor(0.9386, device='cuda:3')
compute_distance is  tensor(147.5343, device='cuda:3')
compute_norm is  tensor(46.6749, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.5324, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9782699319218268
avg test loss is  1.5417695168747323
avg accuracy is  0.7143000001563299
solo acc is  0.2843666668230058
compute similarity  is  tensor(0.9417, device='cuda:3')
compute_distance is  tensor(138.5324, device='cuda:3')
compute_norm is  tensor(46.4908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(138.5324, device='cuda:3')
distance x is tensor(138.5324, device='cuda:3')
________________________________
test distance is  tensor(138.5324, device='cuda:3')
test distance1 is  tensor(138.5324, device='cuda:3')
test similarity is  tensor(0.9417, device='cuda:3')
test acc is  0.2822500001563391
test loss is 1.5449916248890891
test entropy is  0.979496878474506
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.1139233112335205
mal norm is  tensor(725.8495, device='cuda:3')
distance x is tensor(138.5419, device='cuda:3')
mal distance is  tensor(138.5419, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([568.9745, 567.4299, 594.1714, 599.0901, 563.1777, 597.1323, 567.5167,
        599.2438, 725.8495, 725.8495, 725.8495, 725.8495, 725.8495, 725.8495,
        725.8495, 725.8495, 725.8495, 725.8495, 725.8495, 725.8495, 815.2092,
        799.4651, 826.6583, 781.7638, 792.9825, 766.7227, 779.5944, 797.7786],
       device='cuda:3')
sorted_norm is   tensor([563.1777, 567.4299, 567.5167, 568.9745, 594.1714, 597.1323, 599.0901,
        599.2438, 725.8495, 725.8495, 725.8495, 725.8495, 725.8495, 725.8495,
        725.8495, 725.8495, 725.8495, 725.8495, 725.8495, 725.8495, 766.7227,
        779.5944, 781.7638, 792.9825, 797.7786, 799.4651, 815.2092, 826.6583],
       device='cuda:3')
used idx is  tensor([ 4,  1,  6,  0,  2,  5,  3,  7, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 81.63% 

Test Accuracy: 80.84% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7636546492576599
distance x is tensor(166.8318, device='cuda:3')
benign distance is  tensor(166.8318, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3279484212398529
distance x is tensor(185.8418, device='cuda:3')
benign distance is  tensor(185.8418, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3137539029121399
distance x is tensor(182.5909, device='cuda:3')
benign distance is  tensor(182.5909, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9425600171089172
distance x is tensor(189.7356, device='cuda:3')
benign distance is  tensor(189.7356, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6595174670219421
distance x is tensor(172.8979, device='cuda:3')
benign distance is  tensor(172.8979, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3958154618740082
distance x is tensor(194.4666, device='cuda:3')
benign distance is  tensor(194.4666, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4763867259025574
distance x is tensor(181.9496, device='cuda:3')
benign distance is  tensor(181.9496, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20502321422100067
distance x is tensor(176.8487, device='cuda:3')
benign distance is  tensor(176.8487, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.47220486402511597
distance x is tensor(178.0715, device='cuda:3')
benign distance is  tensor(178.0715, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.46089038252830505
distance x is tensor(178.6100, device='cuda:3')
benign distance is  tensor(178.6100, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5005711317062378
distance x is tensor(177.0237, device='cuda:3')
benign distance is  tensor(177.0237, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.0704686641693115
distance x is tensor(186.8090, device='cuda:3')
benign distance is  tensor(186.8090, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.2887178659439087
distance x is tensor(187.4842, device='cuda:3')
benign distance is  tensor(187.4842, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.201613426208496
distance x is tensor(193.4501, device='cuda:3')
benign distance is  tensor(193.4501, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6406322717666626
distance x is tensor(190.3969, device='cuda:3')
benign distance is  tensor(190.3969, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2501077950000763
distance x is tensor(174.4871, device='cuda:3')
benign distance is  tensor(174.4871, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(170.3864, device='cuda:3')
compute distance is  tensor(170.3864, device='cuda:3')
compute norm is  tensor(47.6997, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.2188, device='cuda:3')
compute distance is  tensor(178.2188, device='cuda:3')
compute norm is  tensor(47.7999, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.6163, device='cuda:3')
compute distance is  tensor(171.6163, device='cuda:3')
compute norm is  tensor(47.7263, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.7667, device='cuda:3')
compute distance is  tensor(177.7667, device='cuda:3')
compute norm is  tensor(47.8774, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.5286, device='cuda:3')
compute distance is  tensor(172.5286, device='cuda:3')
compute norm is  tensor(47.8200, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.6754, device='cuda:3')
compute distance is  tensor(178.6754, device='cuda:3')
compute norm is  tensor(47.9301, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.7842, device='cuda:3')
compute distance is  tensor(183.7842, device='cuda:3')
compute norm is  tensor(47.8864, device='cuda:3', dtype=torch.float64)
distance x is tensor(181.3460, device='cuda:3')
compute distance is  tensor(181.3460, device='cuda:3')
compute norm is  tensor(47.9210, device='cuda:3', dtype=torch.float64)
distance x is tensor(187.9952, device='cuda:3')
compute distance is  tensor(187.9952, device='cuda:3')
compute norm is  tensor(48.1403, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.3127, device='cuda:3')
compute distance is  tensor(185.3127, device='cuda:3')
compute norm is  tensor(47.8116, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.8792, device='cuda:3')
compute distance is  tensor(173.8792, device='cuda:3')
compute norm is  tensor(47.7783, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.1958, device='cuda:3')
compute distance is  tensor(185.1958, device='cuda:3')
compute norm is  tensor(47.8671, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(187.9952, device='cuda:3')
distance x is tensor(107606.7734, device='cuda:3')
distance x is tensor(107606.7734, device='cuda:3')
________________________________
test distance is  tensor(107606.7734, device='cuda:3')
test distance1 is  tensor(107606.7734, device='cuda:3')
test similarity is  tensor(0.2845, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130136484970006.92
test entropy is  0.0
________________________________
cal ratio is  0.04096185560400749
distance x is tensor(4407.7783, device='cuda:3')
cal_distance is  tensor(4407.7783, device='cuda:3')
cal ratio is  0.2023902345565379
distance x is tensor(892.0954, device='cuda:3')
cal_distance is  tensor(892.0954, device='cuda:3')
cal ratio is  0.4498769840009652
distance x is tensor(401.3360, device='cuda:3')
cal_distance is  tensor(401.3360, device='cuda:3')
cal ratio is  0.6707263876558276
distance x is tensor(269.1883, device='cuda:3')
cal_distance is  tensor(269.1883, device='cuda:3')
cal ratio is  0.8189763118627539
distance x is tensor(220.4597, device='cuda:3')
cal_distance is  tensor(220.4597, device='cuda:3')
cal ratio is  0.9049712878093216
distance x is tensor(199.5102, device='cuda:3')
cal_distance is  tensor(199.5102, device='cuda:3')
cal ratio is  0.9512985400950084
distance x is tensor(189.7940, device='cuda:3')
cal_distance is  tensor(189.7940, device='cuda:3')
cal ratio is  0.9753447363603623
distance x is tensor(185.1147, device='cuda:3')
cal_distance is  tensor(185.1147, device='cuda:3')
distance x is tensor(185.1147, device='cuda:3')
return_distance is  tensor(185.1147, device='cuda:3')
distance x is tensor(185.1046, device='cuda:3')
distance x is tensor(185.1046, device='cuda:3')
________________________________
test distance is  tensor(185.1046, device='cuda:3')
test distance1 is  tensor(185.1046, device='cuda:3')
test similarity is  tensor(0.9306, device='cuda:3')
test acc is  0.10013333348966531
test loss is 512.6953426271614
test entropy is  3.4116833772224067e-06
________________________________
0
distance x is tensor(185.1046, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.960285474605888e-05
avg test loss is  511.65286869789236
avg accuracy is  0.14003333348966562
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9306, device='cuda:3')
compute_distance is  tensor(185.1046, device='cuda:3')
compute_norm is  tensor(50.8978, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(249.6089, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4175216797064107
avg test loss is  2.461078907126811
avg accuracy is  0.11721666682299861
solo acc is  0.1373333334896653
compute similarity  is  tensor(0.9012, device='cuda:3')
compute_distance is  tensor(249.6089, device='cuda:3')
compute_norm is  tensor(56.1814, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(249.4381, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8193885489567511
avg test loss is  3.179986166039001
avg accuracy is  0.10685000015633195
solo acc is  0.10271666682299864
compute similarity  is  tensor(0.9009, device='cuda:3')
compute_distance is  tensor(249.4381, device='cuda:3')
compute_norm is  tensor(56.2309, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(248.9902, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3270684412039164
avg test loss is  2.2774841775263805
avg accuracy is  0.12175000015633192
solo acc is  0.140466666822999
compute similarity  is  tensor(0.9012, device='cuda:3')
compute_distance is  tensor(248.9902, device='cuda:3')
compute_norm is  tensor(55.7243, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(248.7509, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8037377925061467
avg test loss is  2.9954336355489963
avg accuracy is  0.10851666682299863
solo acc is  0.10106666682299864
compute similarity  is  tensor(0.9009, device='cuda:3')
compute_distance is  tensor(248.7509, device='cuda:3')
compute_norm is  tensor(55.7516, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(248.7094, device='cuda:3')
distance x is tensor(248.7094, device='cuda:3')
________________________________
test distance is  tensor(248.7094, device='cuda:3')
test distance1 is  tensor(248.7094, device='cuda:3')
test similarity is  tensor(0.9011, device='cuda:3')
test acc is  0.13770000015633205
test loss is 2.1733139630065543
test entropy is  1.2830198946029647
________________________________
cal ratio is  0.8520270022089286
distance x is tensor(211.9120, device='cuda:3')
cal_distance is  tensor(211.9120, device='cuda:3')
cal ratio is  0.9230424698552204
distance x is tensor(195.6039, device='cuda:3')
cal_distance is  tensor(195.6039, device='cuda:3')
cal ratio is  0.9607505232109493
distance x is tensor(187.9267, device='cuda:3')
cal_distance is  tensor(187.9267, device='cuda:3')
distance x is tensor(187.9267, device='cuda:3')
return_distance is  tensor(187.9267, device='cuda:3')
distance x is tensor(187.9214, device='cuda:3')
distance x is tensor(187.9214, device='cuda:3')
________________________________
test distance is  tensor(187.9214, device='cuda:3')
test distance1 is  tensor(187.9214, device='cuda:3')
test similarity is  tensor(0.9368, device='cuda:3')
test acc is  0.12136666682299858
test loss is 2.1048231957309538
test entropy is  1.5799447078186313
________________________________
0
distance x is tensor(187.9214, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.579249113099153
avg test loss is  2.1071918380540064
avg accuracy is  0.16571666682300104
solo acc is  0.12231666682299859
compute similarity  is  tensor(0.9368, device='cuda:3')
compute_distance is  tensor(187.9214, device='cuda:3')
compute_norm is  tensor(51.9711, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(188.5768, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8141969918315091
avg test loss is  2.900900058654834
avg accuracy is  0.12483333348966526
solo acc is  0.10146666682299864
compute similarity  is  tensor(0.9362, device='cuda:3')
compute_distance is  tensor(188.5768, device='cuda:3')
compute_norm is  tensor(52.0627, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.8621, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2240663896491533
avg test loss is  2.017522647945103
avg accuracy is  0.15738333348966713
solo acc is  0.14310000015633256
compute similarity  is  tensor(0.9362, device='cuda:3')
compute_distance is  tensor(189.8621, device='cuda:3')
compute_norm is  tensor(51.7830, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(190.0035, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7447189121866531
avg test loss is  2.73935375894819
avg accuracy is  0.12606666682299858
solo acc is  0.1037333334896653
compute similarity  is  tensor(0.9357, device='cuda:3')
compute_distance is  tensor(190.0035, device='cuda:3')
compute_norm is  tensor(51.7668, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.0413, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.101646226860567
avg test loss is  1.799605103189757
avg accuracy is  0.16488333348966766
solo acc is  0.18585000015633565
compute similarity  is  tensor(0.9356, device='cuda:3')
compute_distance is  tensor(191.0413, device='cuda:3')
compute_norm is  tensor(51.4669, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.1316, device='cuda:3')
distance x is tensor(191.1316, device='cuda:3')
________________________________
test distance is  tensor(191.1316, device='cuda:3')
test distance1 is  tensor(191.1316, device='cuda:3')
test similarity is  tensor(0.9352, device='cuda:3')
test acc is  0.10360000015633197
test loss is 2.553427715799702
test entropy is  0.6748309498275521
________________________________
cal ratio is  0.9719260482505925
distance x is tensor(185.7707, device='cuda:3')
cal_distance is  tensor(185.7707, device='cuda:3')
distance x is tensor(185.7707, device='cuda:3')
return_distance is  tensor(185.7707, device='cuda:3')
distance x is tensor(185.7657, device='cuda:3')
distance x is tensor(185.7657, device='cuda:3')
________________________________
test distance is  tensor(185.7657, device='cuda:3')
test distance1 is  tensor(185.7657, device='cuda:3')
test similarity is  tensor(0.9383, device='cuda:3')
test acc is  0.10296666682299864
test loss is 2.4875495133877816
test entropy is  0.7303566443386362
________________________________
0
distance x is tensor(185.7657, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.731448044464278
avg test loss is  2.4895320157252394
avg accuracy is  0.1327000001563319
solo acc is  0.10296666682299864
compute similarity  is  tensor(0.9383, device='cuda:3')
compute_distance is  tensor(185.7657, device='cuda:3')
compute_norm is  tensor(51.1083, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(186.8844, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0530044861566792
avg test loss is  1.6786480716296606
avg accuracy is  0.17786666682300184
solo acc is  0.20476666682300323
compute similarity  is  tensor(0.9379, device='cuda:3')
compute_distance is  tensor(186.8844, device='cuda:3')
compute_norm is  tensor(50.7984, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(186.9711, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6328385397950723
avg test loss is  2.479822722325193
avg accuracy is  0.13696666682299863
solo acc is  0.1036833334896653
compute similarity  is  tensor(0.9375, device='cuda:3')
compute_distance is  tensor(186.9711, device='cuda:3')
compute_norm is  tensor(50.6676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(187.7084, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0159454496938791
avg test loss is  1.619262074610826
avg accuracy is  0.18591666682300229
solo acc is  0.20436666682300322
compute similarity  is  tensor(0.9372, device='cuda:3')
compute_distance is  tensor(187.7084, device='cuda:3')
compute_norm is  tensor(50.3601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(187.7894, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6269080170563289
avg test loss is  2.391113247317292
avg accuracy is  0.1428833334896659
solo acc is  0.10306666682299863
compute similarity  is  tensor(0.9368, device='cuda:3')
compute_distance is  tensor(187.7894, device='cuda:3')
compute_norm is  tensor(50.2130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(188.5403, device='cuda:3')
________________________________
test distance is  tensor(188.5403, device='cuda:3')
test similarity is  tensor(0.9364, device='cuda:3')
test acc is  0.19980000015633634
test loss is 1.5312068109064976
test entropy is  0.9773461883510354
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.3530645370483398
mal norm is  tensor(800.2997, device='cuda:3')
distance x is tensor(188.5403, device='cuda:3')
mal distance is  tensor(188.5403, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 685.3227,  763.9727,  747.3344,  765.1622,  692.2140,  778.2072,
         725.2065,  709.2042,  800.2997,  800.2997,  800.2997,  800.2997,
         800.2997,  800.2997,  800.2997,  800.2997,  800.2997,  800.2997,
         800.2997,  800.2997, 1071.2606, 1062.3231, 1072.4177, 1089.8440,
        1095.9133, 1081.4556, 1098.7936, 1094.4357,  811.6285,  856.1783,
         794.4129,  816.2627,  831.4066,  764.7941,  836.2440,  788.5037,
         755.0025,  753.4543,  717.4790,  792.0608,  779.3872,  766.4664,
         767.5637,  762.5902], device='cuda:3')
sorted_norm is   tensor([ 685.3227,  692.2140,  709.2042,  717.4790,  725.2065,  747.3344,
         753.4543,  755.0025,  762.5902,  763.9727,  764.7941,  765.1622,
         766.4664,  767.5637,  778.2072,  779.3872,  788.5037,  792.0608,
         794.4129,  800.2997,  800.2997,  800.2997,  800.2997,  800.2997,
         800.2997,  800.2997,  800.2997,  800.2997,  800.2997,  800.2997,
         800.2997,  811.6285,  816.2627,  831.4066,  836.2440,  856.1783,
        1062.3231, 1071.2606, 1072.4177, 1081.4556, 1089.8440, 1094.4357,
        1095.9133, 1098.7936], device='cuda:3')
used idx is  tensor([ 0,  4,  7, 38,  6,  2, 37, 36, 43,  1, 33,  3, 41, 42,  5, 40, 35, 39,
        30, 11,  9, 17, 19, 15, 13, 16,  8, 14, 18, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 43.52% 

Test Accuracy: 43.35% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.96533203125
distance x is tensor(173.2715, device='cuda:3')
benign distance is  tensor(173.2715, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7000463604927063
distance x is tensor(173.7117, device='cuda:3')
benign distance is  tensor(173.7117, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1506744921207428
distance x is tensor(166.0962, device='cuda:3')
benign distance is  tensor(166.0962, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8089175224304199
distance x is tensor(162.3956, device='cuda:3')
benign distance is  tensor(162.3956, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.347188949584961
distance x is tensor(169.2038, device='cuda:3')
benign distance is  tensor(169.2038, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.12139228731393814
distance x is tensor(163.3982, device='cuda:3')
benign distance is  tensor(163.3982, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2679169774055481
distance x is tensor(170.2698, device='cuda:3')
benign distance is  tensor(170.2698, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7946959733963013
distance x is tensor(159.1299, device='cuda:3')
benign distance is  tensor(159.1299, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.10779484361410141
distance x is tensor(175.6379, device='cuda:3')
benign distance is  tensor(175.6379, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8187605738639832
distance x is tensor(175.0534, device='cuda:3')
benign distance is  tensor(175.0534, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4436473250389099
distance x is tensor(184.8546, device='cuda:3')
benign distance is  tensor(184.8546, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4682629108428955
distance x is tensor(177.5147, device='cuda:3')
benign distance is  tensor(177.5147, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8409573435783386
distance x is tensor(162.1357, device='cuda:3')
benign distance is  tensor(162.1357, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5957273244857788
distance x is tensor(168.1072, device='cuda:3')
benign distance is  tensor(168.1072, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6186356544494629
distance x is tensor(183.8257, device='cuda:3')
benign distance is  tensor(183.8257, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2806752622127533
distance x is tensor(165.3046, device='cuda:3')
benign distance is  tensor(165.3046, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.31679970026016235
distance x is tensor(166.4446, device='cuda:3')
benign distance is  tensor(166.4446, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6345678567886353
distance x is tensor(179.4847, device='cuda:3')
benign distance is  tensor(179.4847, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.33402353525161743
distance x is tensor(170.5092, device='cuda:3')
benign distance is  tensor(170.5092, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9103884696960449
distance x is tensor(167.4848, device='cuda:3')
benign distance is  tensor(167.4848, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4135372042655945
distance x is tensor(170.9751, device='cuda:3')
benign distance is  tensor(170.9751, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.21871452033519745
distance x is tensor(170.4859, device='cuda:3')
benign distance is  tensor(170.4859, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.20661267638206482
distance x is tensor(177.0103, device='cuda:3')
benign distance is  tensor(177.0103, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5638815760612488
distance x is tensor(162.8490, device='cuda:3')
benign distance is  tensor(162.8490, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4480923116207123
distance x is tensor(156.4824, device='cuda:3')
benign distance is  tensor(156.4824, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.522731363773346
distance x is tensor(171.3553, device='cuda:3')
benign distance is  tensor(171.3553, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.17962414026260376
distance x is tensor(171.2663, device='cuda:3')
benign distance is  tensor(171.2663, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.700255274772644
distance x is tensor(173.1402, device='cuda:3')
benign distance is  tensor(173.1402, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5129579305648804
distance x is tensor(169.3951, device='cuda:3')
benign distance is  tensor(169.3951, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7146978378295898
distance x is tensor(170.5321, device='cuda:3')
benign distance is  tensor(170.5321, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6190964579582214
distance x is tensor(167.3266, device='cuda:3')
benign distance is  tensor(167.3266, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6293958425521851
distance x is tensor(158.7983, device='cuda:3')
benign distance is  tensor(158.7983, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(167.1345, device='cuda:3')
compute distance is  tensor(167.1345, device='cuda:3')
compute norm is  tensor(47.8752, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.2505, device='cuda:3')
compute distance is  tensor(160.2505, device='cuda:3')
compute norm is  tensor(47.9163, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.1111, device='cuda:3')
compute distance is  tensor(172.1111, device='cuda:3')
compute norm is  tensor(48.2360, device='cuda:3', dtype=torch.float64)
distance x is tensor(198.8232, device='cuda:3')
compute distance is  tensor(198.8232, device='cuda:3')
compute norm is  tensor(48.6306, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.0703, device='cuda:3')
compute distance is  tensor(166.0703, device='cuda:3')
compute norm is  tensor(48.0744, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.2035, device='cuda:3')
compute distance is  tensor(179.2035, device='cuda:3')
compute norm is  tensor(48.5070, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.6634, device='cuda:3')
compute distance is  tensor(167.6634, device='cuda:3')
compute norm is  tensor(48.0415, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.4326, device='cuda:3')
compute distance is  tensor(163.4326, device='cuda:3')
compute norm is  tensor(47.9962, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.8793, device='cuda:3')
compute distance is  tensor(171.8793, device='cuda:3')
compute norm is  tensor(48.1594, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.5789, device='cuda:3')
compute distance is  tensor(172.5789, device='cuda:3')
compute norm is  tensor(48.4031, device='cuda:3', dtype=torch.float64)
distance x is tensor(186.4576, device='cuda:3')
compute distance is  tensor(186.4576, device='cuda:3')
compute norm is  tensor(48.6267, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.0502, device='cuda:3')
compute distance is  tensor(175.0502, device='cuda:3')
compute norm is  tensor(48.2711, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(198.8232, device='cuda:3')
distance x is tensor(107621.3516, device='cuda:3')
distance x is tensor(107621.3516, device='cuda:3')
________________________________
test distance is  tensor(107621.3516, device='cuda:3')
test distance1 is  tensor(107621.3516, device='cuda:3')
test similarity is  tensor(0.2673, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130131816629167.22
test entropy is  0.0
________________________________
cal ratio is  0.0421221322274816
distance x is tensor(4533.2461, device='cuda:3')
cal_distance is  tensor(4533.2461, device='cuda:3')
cal ratio is  0.20523665516199852
distance x is tensor(930.3924, device='cuda:3')
cal_distance is  tensor(930.3924, device='cuda:3')
cal ratio is  0.45302950307895146
distance x is tensor(421.4980, device='cuda:3')
cal_distance is  tensor(421.4980, device='cuda:3')
cal ratio is  0.6730724560552698
distance x is tensor(283.7003, device='cuda:3')
cal_distance is  tensor(283.7003, device='cuda:3')
cal ratio is  0.8204075731242021
distance x is tensor(232.7508, device='cuda:3')
cal_distance is  tensor(232.7508, device='cuda:3')
cal ratio is  0.9057617297132959
distance x is tensor(210.8173, device='cuda:3')
cal_distance is  tensor(210.8173, device='cuda:3')
cal ratio is  0.9517140172710119
distance x is tensor(200.6380, device='cuda:3')
cal_distance is  tensor(200.6380, device='cuda:3')
cal ratio is  0.9755577627029473
distance x is tensor(195.7341, device='cuda:3')
cal_distance is  tensor(195.7341, device='cuda:3')
distance x is tensor(195.7341, device='cuda:3')
return_distance is  tensor(195.7341, device='cuda:3')
distance x is tensor(195.7240, device='cuda:3')
distance x is tensor(195.7240, device='cuda:3')
________________________________
test distance is  tensor(195.7240, device='cuda:3')
test distance1 is  tensor(195.7240, device='cuda:3')
test similarity is  tensor(0.9228, device='cuda:3')
test acc is  0.1144166668229986
test loss is 247.37085182173675
test entropy is  0.007932245081968181
________________________________
0
distance x is tensor(195.7240, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.008056995762011509
avg test loss is  247.270930666405
avg accuracy is  0.7258333334896625
solo acc is  0.1153666668229986
compute similarity  is  tensor(0.9228, device='cuda:3')
compute_distance is  tensor(195.7240, device='cuda:3')
compute_norm is  tensor(51.5556, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.7194, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3237067960472757
avg test loss is  2.184856913364264
avg accuracy is  0.15676666682300042
solo acc is  0.1412333334896657
compute similarity  is  tensor(0.9267, device='cuda:3')
compute_distance is  tensor(191.7194, device='cuda:3')
compute_norm is  tensor(53.0002, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.1196, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7787588979643799
avg test loss is  2.913633219723
avg accuracy is  0.13310000015633192
solo acc is  0.10326666682299863
compute similarity  is  tensor(0.9265, device='cuda:3')
compute_distance is  tensor(192.1196, device='cuda:3')
compute_norm is  tensor(53.0270, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.0742, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2031054337904143
avg test loss is  2.0098552499244464
avg accuracy is  0.16298333348966756
solo acc is  0.15398333348966686
compute similarity  is  tensor(0.9269, device='cuda:3')
compute_distance is  tensor(192.0742, device='cuda:3')
compute_norm is  tensor(52.6766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.3844, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7115134568865111
avg test loss is  2.7627852872998986
avg accuracy is  0.13491666682299858
solo acc is  0.10200000015633197
compute similarity  is  tensor(0.9267, device='cuda:3')
compute_distance is  tensor(192.3844, device='cuda:3')
compute_norm is  tensor(52.6165, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.4319, device='cuda:3')
distance x is tensor(192.4319, device='cuda:3')
________________________________
test distance is  tensor(192.4319, device='cuda:3')
test distance1 is  tensor(192.4319, device='cuda:3')
test similarity is  tensor(0.9270, device='cuda:3')
test acc is  0.16118333348966743
test loss is 1.8581383915852383
test entropy is  1.1468326986979829
________________________________
0
distance x is tensor(192.4319, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1472768540829739
avg test loss is  1.8595647205676098
avg accuracy is  0.16753333348966784
solo acc is  0.16025000015633403
compute similarity  is  tensor(0.9270, device='cuda:3')
compute_distance is  tensor(192.4319, device='cuda:3')
compute_norm is  tensor(52.2746, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.5810, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6771049679342364
avg test loss is  2.6264044486129206
avg accuracy is  0.13795000015633205
solo acc is  0.1022833334896653
compute similarity  is  tensor(0.9268, device='cuda:3')
compute_distance is  tensor(192.5810, device='cuda:3')
compute_norm is  tensor(52.1587, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.7540, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0778720752516788
avg test loss is  1.7137064107699689
avg accuracy is  0.1734000001563349
solo acc is  0.1756833334896684
compute similarity  is  tensor(0.9271, device='cuda:3')
compute_distance is  tensor(192.7540, device='cuda:3')
compute_norm is  tensor(51.8562, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.8615, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6371673407839306
avg test loss is  2.4660069228235337
avg accuracy is  0.14158333348966573
solo acc is  0.10365000015633197
compute similarity  is  tensor(0.9269, device='cuda:3')
compute_distance is  tensor(192.8615, device='cuda:3')
compute_norm is  tensor(51.7142, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.9834, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0124103815825
avg test loss is  1.5997997025436939
avg accuracy is  0.1822500001563354
solo acc is  0.20918333348967003
compute similarity  is  tensor(0.9270, device='cuda:3')
compute_distance is  tensor(192.9834, device='cuda:3')
compute_norm is  tensor(51.4104, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.0625, device='cuda:3')
distance x is tensor(193.0625, device='cuda:3')
________________________________
test distance is  tensor(193.0625, device='cuda:3')
test distance1 is  tensor(193.0625, device='cuda:3')
test similarity is  tensor(0.9267, device='cuda:3')
test acc is  0.10246666682299864
test loss is 2.3950745439224406
test entropy is  0.6201325426223689
________________________________
0
distance x is tensor(193.0625, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6210700288129005
avg test loss is  2.3971330128244754
avg accuracy is  0.1426666668229992
solo acc is  0.10310000015633197
compute similarity  is  tensor(0.9267, device='cuda:3')
compute_distance is  tensor(193.0625, device='cuda:3')
compute_norm is  tensor(51.2547, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.3106, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0187730564872848
avg test loss is  1.5897014502014941
avg accuracy is  0.17701666682300177
solo acc is  0.18081666682300204
compute similarity  is  tensor(0.9267, device='cuda:3')
compute_distance is  tensor(193.3106, device='cuda:3')
compute_norm is  tensor(50.9658, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.4459, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.602109029285435
avg test loss is  2.3468124875381813
avg accuracy is  0.14620000015633283
solo acc is  0.1027333334896653
compute similarity  is  tensor(0.9264, device='cuda:3')
compute_distance is  tensor(193.4459, device='cuda:3')
compute_norm is  tensor(50.8049, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.7074, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9978314028111602
avg test loss is  1.5012574630505495
avg accuracy is  0.18421666682300217
solo acc is  0.21155000015633688
compute similarity  is  tensor(0.9264, device='cuda:3')
compute_distance is  tensor(193.7074, device='cuda:3')
compute_norm is  tensor(50.5273, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(193.7156, device='cuda:3')
________________________________
test distance is  tensor(193.7156, device='cuda:3')
test similarity is  tensor(0.9264, device='cuda:3')
test acc is  0.1867666668230024
test loss is 1.5008356824104212
test entropy is  0.9988852345994287
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3298077583312988
mal norm is  tensor(912.1292, device='cuda:3')
distance x is tensor(193.7156, device='cuda:3')
mal distance is  tensor(193.7156, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([681.9169, 716.0244, 692.3378, 645.3000, 668.3988, 667.1691, 668.4082,
        644.4744, 912.1292, 912.1292, 912.1292, 912.1292, 912.1292, 912.1292,
        912.1292, 912.1292, 912.1292, 912.1292, 912.1292, 912.1292],
       device='cuda:3')
sorted_norm is   tensor([644.4744, 645.3000, 667.1691, 668.3988, 668.4082, 681.9169, 692.3378,
        716.0244, 912.1292, 912.1292, 912.1292, 912.1292, 912.1292, 912.1292,
        912.1292, 912.1292, 912.1292, 912.1292, 912.1292, 912.1292],
       device='cuda:3')
used idx is  tensor([ 7,  3,  5,  4,  6,  0,  2,  1, 19, 18, 16, 17, 13, 12],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 62.72% 

Test Accuracy: 61.80% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.645941972732544
distance x is tensor(170.6470, device='cuda:3')
benign distance is  tensor(170.6470, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.24567274749279022
distance x is tensor(191.4303, device='cuda:3')
benign distance is  tensor(191.4303, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3109140992164612
distance x is tensor(168.1478, device='cuda:3')
benign distance is  tensor(168.1478, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7274762392044067
distance x is tensor(164.8063, device='cuda:3')
benign distance is  tensor(164.8063, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.43199390172958374
distance x is tensor(172.5897, device='cuda:3')
benign distance is  tensor(172.5897, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7110341191291809
distance x is tensor(181.1798, device='cuda:3')
benign distance is  tensor(181.1798, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3870265483856201
distance x is tensor(177.0888, device='cuda:3')
benign distance is  tensor(177.0888, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3998994529247284
distance x is tensor(173.0896, device='cuda:3')
benign distance is  tensor(173.0896, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(163.3688, device='cuda:3')
compute distance is  tensor(163.3688, device='cuda:3')
compute norm is  tensor(49.9353, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.7237, device='cuda:3')
compute distance is  tensor(165.7237, device='cuda:3')
compute norm is  tensor(49.8288, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.9340, device='cuda:3')
compute distance is  tensor(173.9340, device='cuda:3')
compute norm is  tensor(50.1991, device='cuda:3', dtype=torch.float64)
distance x is tensor(189.1092, device='cuda:3')
compute distance is  tensor(189.1092, device='cuda:3')
compute norm is  tensor(50.3289, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.8925, device='cuda:3')
compute distance is  tensor(161.8925, device='cuda:3')
compute norm is  tensor(49.6988, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.5311, device='cuda:3')
compute distance is  tensor(168.5311, device='cuda:3')
compute norm is  tensor(50.1120, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.7673, device='cuda:3')
compute distance is  tensor(165.7673, device='cuda:3')
compute norm is  tensor(49.8840, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.3562, device='cuda:3')
compute distance is  tensor(167.3562, device='cuda:3')
compute norm is  tensor(49.8759, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.4146, device='cuda:3')
compute distance is  tensor(177.4146, device='cuda:3')
compute norm is  tensor(50.1016, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.6010, device='cuda:3')
compute distance is  tensor(169.6010, device='cuda:3')
compute norm is  tensor(50.2355, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.1842, device='cuda:3')
compute distance is  tensor(170.1842, device='cuda:3')
compute norm is  tensor(50.0657, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.5315, device='cuda:3')
compute distance is  tensor(162.5315, device='cuda:3')
compute norm is  tensor(49.7674, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(189.1092, device='cuda:3')
distance x is tensor(107590.5391, device='cuda:3')
distance x is tensor(107590.5391, device='cuda:3')
________________________________
test distance is  tensor(107590.5391, device='cuda:3')
test distance1 is  tensor(107590.5391, device='cuda:3')
test similarity is  tensor(0.3831, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130141177734395.1
test entropy is  0.0
________________________________
cal ratio is  0.04108614304182485
distance x is tensor(4420.4858, device='cuda:3')
cal_distance is  tensor(4420.4858, device='cuda:3')
cal ratio is  0.2026970438277693
distance x is tensor(896.0235, device='cuda:3')
cal_distance is  tensor(896.0235, device='cuda:3')
cal ratio is  0.4502178537944093
distance x is tensor(403.4085, device='cuda:3')
cal_distance is  tensor(403.4085, device='cuda:3')
cal ratio is  0.6709804594094759
distance x is tensor(270.6809, device='cuda:3')
cal_distance is  tensor(270.6809, device='cuda:3')
cal ratio is  0.8191314344131578
distance x is tensor(221.7242, device='cuda:3')
cal_distance is  tensor(221.7242, device='cuda:3')
cal ratio is  0.9050569631632276
distance x is tensor(200.6735, device='cuda:3')
cal_distance is  tensor(200.6735, device='cuda:3')
cal ratio is  0.9513437002905198
distance x is tensor(190.9097, device='cuda:3')
cal_distance is  tensor(190.9097, device='cuda:3')
cal ratio is  0.9753678017888057
distance x is tensor(186.2073, device='cuda:3')
cal_distance is  tensor(186.2073, device='cuda:3')
distance x is tensor(186.2073, device='cuda:3')
return_distance is  tensor(186.2073, device='cuda:3')
distance x is tensor(186.1972, device='cuda:3')
distance x is tensor(186.1972, device='cuda:3')
________________________________
test distance is  tensor(186.1972, device='cuda:3')
test distance1 is  tensor(186.1972, device='cuda:3')
test similarity is  tensor(0.9441, device='cuda:3')
test acc is  0.3527166668230071
test loss is 20.200963330421366
test entropy is  0.10426188090335586
________________________________
0
distance x is tensor(186.1972, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.10336402567353711
avg test loss is  20.316475553044885
avg accuracy is  0.7961500001563256
solo acc is  0.35090000015634043
compute similarity  is  tensor(0.9441, device='cuda:3')
compute_distance is  tensor(186.1972, device='cuda:3')
compute_norm is  tensor(53.8410, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.6853, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0128092395979713
avg test loss is  1.526700368313901
avg accuracy is  0.4387500001563415
solo acc is  0.2548333334896717
compute similarity  is  tensor(0.9460, device='cuda:3')
compute_distance is  tensor(177.6853, device='cuda:3')
compute_norm is  tensor(53.7057, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.9386, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6281044710038314
avg test loss is  2.351032998007752
avg accuracy is  0.3162166668230064
solo acc is  0.11006666682299862
compute similarity  is  tensor(0.9457, device='cuda:3')
compute_distance is  tensor(177.9386, device='cuda:3')
compute_norm is  tensor(53.5030, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.6722, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9912401013918268
avg test loss is  1.4518486195281624
avg accuracy is  0.4079166668230079
solo acc is  0.24978333348967152
compute similarity  is  tensor(0.9460, device='cuda:3')
compute_distance is  tensor(177.6722, device='cuda:3')
compute_norm is  tensor(53.2105, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(177.6722, device='cuda:3')
distance x is tensor(177.6722, device='cuda:3')
________________________________
test distance is  tensor(177.6722, device='cuda:3')
test distance1 is  tensor(177.6722, device='cuda:3')
test similarity is  tensor(0.9460, device='cuda:3')
test acc is  0.24873333348967153
test loss is 1.453584240952026
test entropy is  0.9917412224863129
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4350022077560425
mal norm is  tensor(911.7098, device='cuda:3')
distance x is tensor(177.6820, device='cuda:3')
mal distance is  tensor(177.6820, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 693.8206,  779.2441,  691.7123,  683.5052,  719.5725,  740.6784,
         697.1308,  708.3155,  911.7098,  911.7098,  911.7098,  911.7098,
         911.7098,  911.7098,  911.7098,  911.7098,  911.7098,  911.7098,
         911.7098,  911.7098,  994.3884, 1004.8405, 1017.5452,  975.4908,
        1012.7913, 1008.3696,  980.5023, 1020.1446,  818.5136,  814.1078,
         837.6700,  809.7784,  764.9187,  779.9545,  827.9757,  782.2710],
       device='cuda:3')
sorted_norm is   tensor([ 683.5052,  691.7123,  693.8206,  697.1308,  708.3155,  719.5725,
         740.6784,  764.9187,  779.2441,  779.9545,  782.2710,  809.7784,
         814.1078,  818.5136,  827.9757,  837.6700,  911.7098,  911.7098,
         911.7098,  911.7098,  911.7098,  911.7098,  911.7098,  911.7098,
         911.7098,  911.7098,  911.7098,  911.7098,  975.4908,  980.5023,
         994.3884, 1004.8405, 1008.3696, 1012.7913, 1017.5452, 1020.1446],
       device='cuda:3')
used idx is  tensor([ 3,  2,  0,  6,  7,  4,  5, 32,  1, 33, 35, 31, 29, 28, 34, 30, 18, 16,
        10,  8, 12, 14,  9, 11, 15], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 84.46% 

Test Accuracy: 83.32% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7311039566993713
distance x is tensor(141.8228, device='cuda:3')
benign distance is  tensor(141.8228, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8442338705062866
distance x is tensor(156.5018, device='cuda:3')
benign distance is  tensor(156.5018, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24059543013572693
distance x is tensor(155.7568, device='cuda:3')
benign distance is  tensor(155.7568, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3394230306148529
distance x is tensor(160.9019, device='cuda:3')
benign distance is  tensor(160.9019, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6699121594429016
distance x is tensor(173.9005, device='cuda:3')
benign distance is  tensor(173.9005, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7918633222579956
distance x is tensor(160.4590, device='cuda:3')
benign distance is  tensor(160.4590, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3400292992591858
distance x is tensor(142.9491, device='cuda:3')
benign distance is  tensor(142.9491, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37283673882484436
distance x is tensor(153.3486, device='cuda:3')
benign distance is  tensor(153.3486, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5544904470443726
distance x is tensor(157.6692, device='cuda:3')
benign distance is  tensor(157.6692, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5641257166862488
distance x is tensor(151.7764, device='cuda:3')
benign distance is  tensor(151.7764, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9306041598320007
distance x is tensor(144.9113, device='cuda:3')
benign distance is  tensor(144.9113, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3677182197570801
distance x is tensor(144.6188, device='cuda:3')
benign distance is  tensor(144.6188, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3575696349143982
distance x is tensor(143.4492, device='cuda:3')
benign distance is  tensor(143.4492, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15348957479000092
distance x is tensor(156.3181, device='cuda:3')
benign distance is  tensor(156.3181, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.45356112718582153
distance x is tensor(147.5608, device='cuda:3')
benign distance is  tensor(147.5608, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4279108941555023
distance x is tensor(162.5672, device='cuda:3')
benign distance is  tensor(162.5672, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.08541803061962128
distance x is tensor(165.8031, device='cuda:3')
benign distance is  tensor(165.8031, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3826848566532135
distance x is tensor(147.7650, device='cuda:3')
benign distance is  tensor(147.7650, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7058431506156921
distance x is tensor(164.2610, device='cuda:3')
benign distance is  tensor(164.2610, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5663465857505798
distance x is tensor(156.5832, device='cuda:3')
benign distance is  tensor(156.5832, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6275324821472168
distance x is tensor(167.4978, device='cuda:3')
benign distance is  tensor(167.4978, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4281565546989441
distance x is tensor(155.7726, device='cuda:3')
benign distance is  tensor(155.7726, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.37296342849731445
distance x is tensor(145.7223, device='cuda:3')
benign distance is  tensor(145.7223, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.29686418175697327
distance x is tensor(147.2540, device='cuda:3')
benign distance is  tensor(147.2540, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.7556, device='cuda:3')
compute distance is  tensor(140.7556, device='cuda:3')
compute norm is  tensor(50.6145, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7377, device='cuda:3')
compute distance is  tensor(144.7377, device='cuda:3')
compute norm is  tensor(50.8802, device='cuda:3', dtype=torch.float64)
distance x is tensor(188.7332, device='cuda:3')
compute distance is  tensor(188.7332, device='cuda:3')
compute norm is  tensor(51.8723, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.5560, device='cuda:3')
compute distance is  tensor(153.5560, device='cuda:3')
compute norm is  tensor(51.1186, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.2564, device='cuda:3')
compute distance is  tensor(172.2564, device='cuda:3')
compute norm is  tensor(51.5498, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.3072, device='cuda:3')
compute distance is  tensor(165.3072, device='cuda:3')
compute norm is  tensor(51.5585, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.0258, device='cuda:3')
compute distance is  tensor(159.0258, device='cuda:3')
compute norm is  tensor(51.2975, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.3407, device='cuda:3')
compute distance is  tensor(158.3407, device='cuda:3')
compute norm is  tensor(51.1098, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.2838, device='cuda:3')
compute distance is  tensor(154.2838, device='cuda:3')
compute norm is  tensor(50.9416, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.1446, device='cuda:3')
compute distance is  tensor(154.1446, device='cuda:3')
compute norm is  tensor(51.1867, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.9058, device='cuda:3')
compute distance is  tensor(157.9058, device='cuda:3')
compute norm is  tensor(51.0967, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.7782, device='cuda:3')
compute distance is  tensor(151.7782, device='cuda:3')
compute norm is  tensor(51.0273, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(188.7332, device='cuda:3')
distance x is tensor(107565.1484, device='cuda:3')
distance x is tensor(107565.1484, device='cuda:3')
________________________________
test distance is  tensor(107565.1484, device='cuda:3')
test distance1 is  tensor(107565.1484, device='cuda:3')
test similarity is  tensor(0.4369, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130142071630902.58
test entropy is  0.0
________________________________
cal ratio is  0.04105011571040551
distance x is tensor(4415.5674, device='cuda:3')
cal_distance is  tensor(4415.5674, device='cuda:3')
cal ratio is  0.20260815246350286
distance x is tensor(894.6339, device='cuda:3')
cal_distance is  tensor(894.6339, device='cuda:3')
cal ratio is  0.45011916023344495
distance x is tensor(402.6947, device='cuda:3')
cal_distance is  tensor(402.6947, device='cuda:3')
cal ratio is  0.6709068290352227
distance x is tensor(270.1723, device='cuda:3')
cal_distance is  tensor(270.1723, device='cuda:3')
cal ratio is  0.8190865326186089
distance x is tensor(221.2954, device='cuda:3')
cal_distance is  tensor(221.2954, device='cuda:3')
cal ratio is  0.9050321374371645
distance x is tensor(200.2799, device='cuda:3')
cal_distance is  tensor(200.2799, device='cuda:3')
cal ratio is  0.9513305526067111
distance x is tensor(190.5327, device='cuda:3')
cal_distance is  tensor(190.5327, device='cuda:3')
cal ratio is  0.9753611404551832
distance x is tensor(185.8383, device='cuda:3')
cal_distance is  tensor(185.8383, device='cuda:3')
distance x is tensor(185.8383, device='cuda:3')
return_distance is  tensor(185.8383, device='cuda:3')
distance x is tensor(185.8282, device='cuda:3')
distance x is tensor(185.8282, device='cuda:3')
________________________________
test distance is  tensor(185.8282, device='cuda:3')
test distance1 is  tensor(185.8282, device='cuda:3')
test similarity is  tensor(0.9520, device='cuda:3')
test acc is  0.1027833334896653
test loss is 282.4297139507367
test entropy is  0.0015170045445996744
________________________________
0
distance x is tensor(185.8282, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0013236987651124585
avg test loss is  281.13776122786595
avg accuracy is  0.6073166668230037
solo acc is  0.1026833334896653
compute similarity  is  tensor(0.9520, device='cuda:3')
compute_distance is  tensor(185.8282, device='cuda:3')
compute_norm is  tensor(55.5728, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(563.2985, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4778493128097387
avg test loss is  2.674388224382136
avg accuracy is  0.10410000015633197
solo acc is  0.10105000015633196
compute similarity  is  tensor(0.6583, device='cuda:3')
compute_distance is  tensor(563.2985, device='cuda:3')
compute_norm is  tensor(84.2846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(561.6251, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8202549523509133
avg test loss is  3.304286638048412
avg accuracy is  0.10186666682299864
solo acc is  0.10031666682299864
compute similarity  is  tensor(0.6585, device='cuda:3')
compute_distance is  tensor(561.6251, device='cuda:3')
compute_norm is  tensor(84.2212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(560.1254, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.346850572110239
avg test loss is  2.47042991205065
avg accuracy is  0.10646666682299862
solo acc is  0.10681666682299862
compute similarity  is  tensor(0.6582, device='cuda:3')
compute_distance is  tensor(560.1254, device='cuda:3')
compute_norm is  tensor(83.5382, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(558.3112, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7989004201599276
avg test loss is  3.1374261234360716
avg accuracy is  0.1020833334896653
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.6584, device='cuda:3')
compute_distance is  tensor(558.3112, device='cuda:3')
compute_norm is  tensor(83.4633, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(556.5064, device='cuda:3')
distance x is tensor(556.5064, device='cuda:3')
________________________________
test distance is  tensor(556.5064, device='cuda:3')
test distance1 is  tensor(556.5064, device='cuda:3')
test similarity is  tensor(0.6582, device='cuda:3')
test acc is  0.11781666682299859
test loss is 2.1751342605171935
test entropy is  1.2485925451016375
________________________________
cal ratio is  0.5707094793886327
distance x is tensor(317.6068, device='cuda:3')
cal_distance is  tensor(317.6068, device='cuda:3')
cal ratio is  0.7554492591150367
distance x is tensor(239.9363, device='cuda:3')
cal_distance is  tensor(239.9363, device='cuda:3')
cal ratio is  0.8691648865474589
distance x is tensor(208.5445, device='cuda:3')
cal_distance is  tensor(208.5445, device='cuda:3')
cal ratio is  0.9322894882233527
distance x is tensor(194.4240, device='cuda:3')
cal_distance is  tensor(194.4240, device='cuda:3')
cal ratio is  0.9655510999925262
distance x is tensor(187.7263, device='cuda:3')
cal_distance is  tensor(187.7263, device='cuda:3')
distance x is tensor(187.7263, device='cuda:3')
return_distance is  tensor(187.7263, device='cuda:3')
distance x is tensor(187.7221, device='cuda:3')
distance x is tensor(187.7221, device='cuda:3')
________________________________
test distance is  tensor(187.7221, device='cuda:3')
test distance1 is  tensor(187.7221, device='cuda:3')
test similarity is  tensor(0.9192, device='cuda:3')
test acc is  0.15633333348966702
test loss is 2.039648731380129
test entropy is  1.9074375007960842
________________________________
0
distance x is tensor(187.7221, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9061354004752153
avg test loss is  2.0388761204697174
avg accuracy is  0.20266666682300316
solo acc is  0.15515000015633362
compute similarity  is  tensor(0.9192, device='cuda:3')
compute_distance is  tensor(187.7221, device='cuda:3')
compute_norm is  tensor(55.9073, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.5393, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7677690135136342
avg test loss is  2.790308382973742
avg accuracy is  0.16345000015633426
solo acc is  0.1041333334896653
compute similarity  is  tensor(0.9189, device='cuda:3')
compute_distance is  tensor(189.5393, device='cuda:3')
compute_norm is  tensor(55.9344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.7632, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.082389940775788
avg test loss is  1.640878096445283
avg accuracy is  0.20553333348966996
solo acc is  0.18770000015633567
compute similarity  is  tensor(0.9189, device='cuda:3')
compute_distance is  tensor(189.7632, device='cuda:3')
compute_norm is  tensor(55.6377, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.9175, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6428245811192974
avg test loss is  2.36171221758511
avg accuracy is  0.1632333334896676
solo acc is  0.10430000015633195
compute similarity  is  tensor(0.9186, device='cuda:3')
compute_distance is  tensor(189.9175, device='cuda:3')
compute_norm is  tensor(55.4454, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.7595, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0246332421231625
avg test loss is  1.5417622819638201
avg accuracy is  0.2134666668230036
solo acc is  0.20410000015633653
compute similarity  is  tensor(0.9187, device='cuda:3')
compute_distance is  tensor(189.7595, device='cuda:3')
compute_norm is  tensor(55.1432, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.8621, device='cuda:3')
distance x is tensor(189.8621, device='cuda:3')
________________________________
test distance is  tensor(189.8621, device='cuda:3')
test distance1 is  tensor(189.8621, device='cuda:3')
test similarity is  tensor(0.9184, device='cuda:3')
test acc is  0.1035333334896653
test loss is 2.2787266235107553
test entropy is  0.6295246705571725
________________________________
cal ratio is  0.9770820670712744
distance x is tensor(185.5146, device='cuda:3')
cal_distance is  tensor(185.5146, device='cuda:3')
distance x is tensor(185.5146, device='cuda:3')
return_distance is  tensor(185.5146, device='cuda:3')
distance x is tensor(185.5108, device='cuda:3')
distance x is tensor(185.5108, device='cuda:3')
________________________________
test distance is  tensor(185.5108, device='cuda:3')
test distance1 is  tensor(185.5108, device='cuda:3')
test similarity is  tensor(0.9216, device='cuda:3')
test acc is  0.10346666682299864
test loss is 2.1646270609613674
test entropy is  0.7069730848264593
________________________________
0
distance x is tensor(185.5108, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7079805999930734
avg test loss is  2.1662333322994747
avg accuracy is  0.16970000015633463
solo acc is  0.10390000015633197
compute similarity  is  tensor(0.9216, device='cuda:3')
compute_distance is  tensor(185.5108, device='cuda:3')
compute_norm is  tensor(54.7124, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(185.8151, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9821436815678692
avg test loss is  1.4827592206407967
avg accuracy is  0.2196000001563372
solo acc is  0.21810000015633715
compute similarity  is  tensor(0.9215, device='cuda:3')
compute_distance is  tensor(185.8151, device='cuda:3')
compute_norm is  tensor(54.4297, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(185.8188, device='cuda:3')
________________________________
test distance is  tensor(185.8188, device='cuda:3')
test similarity is  tensor(0.9215, device='cuda:3')
test acc is  0.2191000001563372
test loss is 1.4801080320943902
test entropy is  0.9830271954348346
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.331546425819397
mal norm is  tensor(978.3417, device='cuda:3')
distance x is tensor(185.8188, device='cuda:3')
mal distance is  tensor(185.8188, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([575.8206, 632.4083, 647.4781, 640.8956, 694.5263, 644.6146, 573.1314,
        616.1785, 978.3417, 978.3417, 978.3417, 978.3417, 978.3417, 978.3417,
        978.3417, 978.3417, 978.3417, 978.3417, 978.3417, 978.3417, 847.4153,
        910.1090, 870.6674, 867.1718, 856.2023, 859.5731, 886.3152, 836.7397],
       device='cuda:3')
sorted_norm is   tensor([573.1314, 575.8206, 616.1785, 632.4083, 640.8956, 644.6146, 647.4781,
        694.5263, 836.7397, 847.4153, 856.2023, 859.5731, 867.1718, 870.6674,
        886.3152, 910.1090, 978.3417, 978.3417, 978.3417, 978.3417, 978.3417,
        978.3417, 978.3417, 978.3417, 978.3417, 978.3417, 978.3417, 978.3417],
       device='cuda:3')
used idx is  tensor([ 6,  0,  7,  1,  3,  5,  2,  4, 27, 20, 24, 25, 23, 22, 26, 21, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 79.38% 

Test Accuracy: 78.26% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0535955429077148
distance x is tensor(128.0722, device='cuda:3')
benign distance is  tensor(128.0722, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.31976714730262756
distance x is tensor(134.0663, device='cuda:3')
benign distance is  tensor(134.0663, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16436469554901123
distance x is tensor(128.4305, device='cuda:3')
benign distance is  tensor(128.4305, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.668155312538147
distance x is tensor(127.6390, device='cuda:3')
benign distance is  tensor(127.6390, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4594498574733734
distance x is tensor(120.6056, device='cuda:3')
benign distance is  tensor(120.6056, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8330284357070923
distance x is tensor(133.2729, device='cuda:3')
benign distance is  tensor(133.2729, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9405103921890259
distance x is tensor(129.7530, device='cuda:3')
benign distance is  tensor(129.7530, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2668946385383606
distance x is tensor(139.5351, device='cuda:3')
benign distance is  tensor(139.5351, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6430484056472778
distance x is tensor(140.1918, device='cuda:3')
benign distance is  tensor(140.1918, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6578315496444702
distance x is tensor(138.9464, device='cuda:3')
benign distance is  tensor(138.9464, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.602501392364502
distance x is tensor(132.5008, device='cuda:3')
benign distance is  tensor(132.5008, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.21271058917045593
distance x is tensor(143.0466, device='cuda:3')
benign distance is  tensor(143.0466, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20956043899059296
distance x is tensor(139.0109, device='cuda:3')
benign distance is  tensor(139.0109, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7830905914306641
distance x is tensor(125.7910, device='cuda:3')
benign distance is  tensor(125.7910, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2792457640171051
distance x is tensor(153.3545, device='cuda:3')
benign distance is  tensor(153.3545, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.45135849714279175
distance x is tensor(142.2121, device='cuda:3')
benign distance is  tensor(142.2121, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.2923, device='cuda:3')
compute distance is  tensor(140.2923, device='cuda:3')
compute norm is  tensor(50.1665, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2999, device='cuda:3')
compute distance is  tensor(128.2999, device='cuda:3')
compute norm is  tensor(49.9424, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6959, device='cuda:3')
compute distance is  tensor(134.6959, device='cuda:3')
compute norm is  tensor(50.2516, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7332, device='cuda:3')
compute distance is  tensor(128.7332, device='cuda:3')
compute norm is  tensor(49.9769, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9306, device='cuda:3')
compute distance is  tensor(126.9306, device='cuda:3')
compute norm is  tensor(50.1053, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.8361, device='cuda:3')
compute distance is  tensor(151.8361, device='cuda:3')
compute norm is  tensor(50.6583, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.7195, device='cuda:3')
compute distance is  tensor(145.7195, device='cuda:3')
compute norm is  tensor(50.4654, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.0199, device='cuda:3')
compute distance is  tensor(146.0199, device='cuda:3')
compute norm is  tensor(50.3617, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0240, device='cuda:3')
compute distance is  tensor(141.0240, device='cuda:3')
compute norm is  tensor(50.3001, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0450, device='cuda:3')
compute distance is  tensor(135.0450, device='cuda:3')
compute norm is  tensor(50.1782, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5462, device='cuda:3')
compute distance is  tensor(139.5462, device='cuda:3')
compute norm is  tensor(50.1563, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5093, device='cuda:3')
compute distance is  tensor(133.5093, device='cuda:3')
compute norm is  tensor(50.2270, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.8361, device='cuda:3')
distance x is tensor(107615.9844, device='cuda:3')
distance x is tensor(107615.9844, device='cuda:3')
________________________________
test distance is  tensor(107615.9844, device='cuda:3')
test distance1 is  tensor(107615.9844, device='cuda:3')
test similarity is  tensor(0.3360, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130063122175165.95
test entropy is  0.0
________________________________
cal ratio is  0.03681079988645161
distance x is tensor(3961.4363, device='cuda:3')
cal_distance is  tensor(3961.4363, device='cuda:3')
cal ratio is  0.19186127097874267
distance x is tensor(760.0501, device='cuda:3')
cal_distance is  tensor(760.0501, device='cuda:3')
cal ratio is  0.4380185733658242
distance x is tensor(332.9189, device='cuda:3')
cal_distance is  tensor(332.9189, device='cuda:3')
cal ratio is  0.6618268547342214
distance x is tensor(220.3364, device='cuda:3')
cal_distance is  tensor(220.3364, device='cuda:3')
cal ratio is  0.8135243071064683
distance x is tensor(179.2500, device='cuda:3')
cal_distance is  tensor(179.2500, device='cuda:3')
cal ratio is  0.9019534338896475
distance x is tensor(161.6756, device='cuda:3')
cal_distance is  tensor(161.6756, device='cuda:3')
cal ratio is  0.9497108240831437
distance x is tensor(153.5453, device='cuda:3')
cal_distance is  tensor(153.5453, device='cuda:3')
cal ratio is  0.9745302298355328
distance x is tensor(149.6347, device='cuda:3')
cal_distance is  tensor(149.6347, device='cuda:3')
distance x is tensor(149.6347, device='cuda:3')
return_distance is  tensor(149.6347, device='cuda:3')
distance x is tensor(149.6247, device='cuda:3')
distance x is tensor(149.6247, device='cuda:3')
________________________________
test distance is  tensor(149.6247, device='cuda:3')
test distance1 is  tensor(149.6247, device='cuda:3')
test similarity is  tensor(0.9590, device='cuda:3')
test acc is  0.3603833334896739
test loss is 17.151445343041978
test entropy is  0.11801975013922526
________________________________
0
distance x is tensor(149.6247, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.11953553546275665
avg test loss is  16.936842425291474
avg accuracy is  0.8475500001563234
solo acc is  0.3657666668230073
compute similarity  is  tensor(0.9590, device='cuda:3')
compute_distance is  tensor(149.6247, device='cuda:3')
compute_norm is  tensor(52.7414, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.3898, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9453505981070146
avg test loss is  1.4396398230148022
avg accuracy is  0.6866333334896648
solo acc is  0.2926500001563393
compute similarity  is  tensor(0.9594, device='cuda:3')
compute_distance is  tensor(144.3898, device='cuda:3')
compute_norm is  tensor(52.4137, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(144.3898, device='cuda:3')
distance x is tensor(144.3898, device='cuda:3')
________________________________
test distance is  tensor(144.3898, device='cuda:3')
test distance1 is  tensor(144.3898, device='cuda:3')
test similarity is  tensor(0.9594, device='cuda:3')
test acc is  0.29618333348967285
test loss is 1.4321776210372128
test entropy is  0.9434104294283812
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.0698308944702148
mal norm is  tensor(749.4448, device='cuda:3')
distance x is tensor(144.3988, device='cuda:3')
mal distance is  tensor(144.3988, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([527.5573, 556.7424, 509.2883, 513.3101, 491.6258, 542.1367, 515.1946,
        568.0913, 749.4448, 749.4447, 749.4448, 749.4447, 749.4448, 749.4447,
        749.4448, 749.4447, 749.4448, 749.4447, 749.4448, 749.4447, 811.7687,
        816.0137, 805.0801, 839.7689, 850.0090, 848.6420, 850.1815, 812.8660,
        666.7859, 630.5200, 620.1890, 612.5178, 626.3834, 663.6328, 617.4055,
        678.6754], device='cuda:3')
sorted_norm is   tensor([491.6258, 509.2883, 513.3101, 515.1946, 527.5573, 542.1367, 556.7424,
        568.0913, 612.5178, 617.4055, 620.1890, 626.3834, 630.5200, 663.6328,
        666.7859, 678.6754, 749.4447, 749.4447, 749.4447, 749.4447, 749.4447,
        749.4447, 749.4448, 749.4448, 749.4448, 749.4448, 749.4448, 749.4448,
        805.0801, 811.7687, 812.8660, 816.0137, 839.7689, 848.6420, 850.0090,
        850.1815], device='cuda:3')
used idx is  tensor([ 4,  2,  3,  6,  0,  5,  1,  7, 31, 34, 30, 32, 29, 33, 28, 35, 19, 17,
        11,  9, 13, 15,  8, 10, 14], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 87.23% 

Test Accuracy: 86.44% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5895363688468933
distance x is tensor(152.8936, device='cuda:3')
benign distance is  tensor(152.8936, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45394572615623474
distance x is tensor(132.8705, device='cuda:3')
benign distance is  tensor(132.8705, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5247277617454529
distance x is tensor(137.5274, device='cuda:3')
benign distance is  tensor(137.5274, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5858205556869507
distance x is tensor(129.9731, device='cuda:3')
benign distance is  tensor(129.9731, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6314502954483032
distance x is tensor(136.0646, device='cuda:3')
benign distance is  tensor(136.0646, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7904388904571533
distance x is tensor(149.4489, device='cuda:3')
benign distance is  tensor(149.4489, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5988482236862183
distance x is tensor(138.4363, device='cuda:3')
benign distance is  tensor(138.4363, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5272101163864136
distance x is tensor(142.7111, device='cuda:3')
benign distance is  tensor(142.7111, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.704290509223938
distance x is tensor(156.6556, device='cuda:3')
benign distance is  tensor(156.6556, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.42534366250038147
distance x is tensor(150.9016, device='cuda:3')
benign distance is  tensor(150.9016, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6123723387718201
distance x is tensor(132.5274, device='cuda:3')
benign distance is  tensor(132.5274, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7716041803359985
distance x is tensor(160.7333, device='cuda:3')
benign distance is  tensor(160.7333, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5234915614128113
distance x is tensor(141.5050, device='cuda:3')
benign distance is  tensor(141.5050, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35361233353614807
distance x is tensor(166.8875, device='cuda:3')
benign distance is  tensor(166.8875, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6440758109092712
distance x is tensor(139.9596, device='cuda:3')
benign distance is  tensor(139.9596, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.30673307180404663
distance x is tensor(151.2780, device='cuda:3')
benign distance is  tensor(151.2780, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3642772138118744
distance x is tensor(139.4207, device='cuda:3')
benign distance is  tensor(139.4207, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.01967824064195156
distance x is tensor(139.9239, device='cuda:3')
benign distance is  tensor(139.9239, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.37216678261756897
distance x is tensor(144.2134, device='cuda:3')
benign distance is  tensor(144.2134, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.5178036689758301
distance x is tensor(142.8773, device='cuda:3')
benign distance is  tensor(142.8773, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5014500021934509
distance x is tensor(142.0234, device='cuda:3')
benign distance is  tensor(142.0234, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.475548654794693
distance x is tensor(148.2914, device='cuda:3')
benign distance is  tensor(148.2914, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.594419002532959
distance x is tensor(140.3458, device='cuda:3')
benign distance is  tensor(140.3458, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.09737525135278702
distance x is tensor(140.1150, device='cuda:3')
benign distance is  tensor(140.1150, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(146.5747, device='cuda:3')
compute distance is  tensor(146.5747, device='cuda:3')
compute norm is  tensor(52.4138, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.9693, device='cuda:3')
compute distance is  tensor(140.9693, device='cuda:3')
compute norm is  tensor(52.0914, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7986, device='cuda:3')
compute distance is  tensor(130.7986, device='cuda:3')
compute norm is  tensor(52.1696, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.6631, device='cuda:3')
compute distance is  tensor(149.6631, device='cuda:3')
compute norm is  tensor(52.2966, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.9860, device='cuda:3')
compute distance is  tensor(155.9860, device='cuda:3')
compute norm is  tensor(52.5321, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4660, device='cuda:3')
compute distance is  tensor(136.4660, device='cuda:3')
compute norm is  tensor(52.1998, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.2818, device='cuda:3')
compute distance is  tensor(150.2818, device='cuda:3')
compute norm is  tensor(52.5501, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1052, device='cuda:3')
compute distance is  tensor(137.1052, device='cuda:3')
compute norm is  tensor(52.1348, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.7996, device='cuda:3')
compute distance is  tensor(141.7996, device='cuda:3')
compute norm is  tensor(52.1008, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4180, device='cuda:3')
compute distance is  tensor(150.4180, device='cuda:3')
compute norm is  tensor(52.3781, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2488, device='cuda:3')
compute distance is  tensor(135.2488, device='cuda:3')
compute norm is  tensor(52.1167, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5790, device='cuda:3')
compute distance is  tensor(148.5790, device='cuda:3')
compute norm is  tensor(52.2325, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(155.9860, device='cuda:3')
distance x is tensor(107566.3984, device='cuda:3')
distance x is tensor(107566.3984, device='cuda:3')
________________________________
test distance is  tensor(107566.3984, device='cuda:3')
test distance1 is  tensor(107566.3984, device='cuda:3')
test similarity is  tensor(0.4445, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130159447630749.75
test entropy is  0.0
________________________________
cal ratio is  0.03731905262602592
distance x is tensor(4014.2817, device='cuda:3')
cal_distance is  tensor(4014.2817, device='cuda:3')
cal ratio is  0.1931812568085847
distance x is tensor(775.4880, device='cuda:3')
cal_distance is  tensor(775.4880, device='cuda:3')
cal ratio is  0.4395227555377298
distance x is tensor(340.8474, device='cuda:3')
cal_distance is  tensor(340.8474, device='cuda:3')
cal ratio is  0.6629623950507126
distance x is tensor(225.9707, device='cuda:3')
cal_distance is  tensor(225.9707, device='cuda:3')
cal ratio is  0.8142219664766903
distance x is tensor(183.9913, device='cuda:3')
cal_distance is  tensor(183.9913, device='cuda:3')
cal ratio is  0.902340245927885
distance x is tensor(166.0232, device='cuda:3')
cal_distance is  tensor(166.0232, device='cuda:3')
cal ratio is  0.9499144129221192
distance x is tensor(157.7081, device='cuda:3')
cal_distance is  tensor(157.7081, device='cuda:3')
cal ratio is  0.9746347527817764
distance x is tensor(153.7079, device='cuda:3')
cal_distance is  tensor(153.7079, device='cuda:3')
distance x is tensor(153.7079, device='cuda:3')
return_distance is  tensor(153.7079, device='cuda:3')
distance x is tensor(153.6979, device='cuda:3')
distance x is tensor(153.6979, device='cuda:3')
________________________________
test distance is  tensor(153.6979, device='cuda:3')
test distance1 is  tensor(153.6979, device='cuda:3')
test similarity is  tensor(0.9668, device='cuda:3')
test acc is  0.11245000015633194
test loss is 131.40662601202536
test entropy is  0.005872863116811498
________________________________
0
distance x is tensor(153.6979, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.006088271756955731
avg test loss is  130.7137868023122
avg accuracy is  0.7579500001563275
solo acc is  0.11358333348966528
compute similarity  is  tensor(0.9668, device='cuda:3')
compute_distance is  tensor(153.6979, device='cuda:3')
compute_norm is  tensor(55.6064, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.9390, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1025060434331264
avg test loss is  1.7629477844309451
avg accuracy is  0.4803500001563419
solo acc is  0.19675000015633626
compute similarity  is  tensor(0.9669, device='cuda:3')
compute_distance is  tensor(154.9390, device='cuda:3')
compute_norm is  tensor(56.0058, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.7849, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.663613075767753
avg test loss is  2.5293089293721898
avg accuracy is  0.37753333348967416
solo acc is  0.10771666682299862
compute similarity  is  tensor(0.9667, device='cuda:3')
compute_distance is  tensor(155.7849, device='cuda:3')
compute_norm is  tensor(55.8412, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.3383, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0229035169203906
avg test loss is  1.5409976240160115
avg accuracy is  0.5447000001563423
solo acc is  0.22553333348967078
compute similarity  is  tensor(0.9670, device='cuda:3')
compute_distance is  tensor(155.3383, device='cuda:3')
compute_norm is  tensor(55.5592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.9264, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6215410089886773
avg test loss is  2.3377239738446054
avg accuracy is  0.4519166668230083
solo acc is  0.10653333348966529
compute similarity  is  tensor(0.9667, device='cuda:3')
compute_distance is  tensor(155.9264, device='cuda:3')
compute_norm is  tensor(55.3745, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.2812, device='cuda:3')
distance x is tensor(155.2812, device='cuda:3')
________________________________
test distance is  tensor(155.2812, device='cuda:3')
test distance1 is  tensor(155.2812, device='cuda:3')
test similarity is  tensor(0.9669, device='cuda:3')
test acc is  0.23481666682300437
test loss is 1.4591453421090457
test entropy is  1.0045556194746672
________________________________
0
distance x is tensor(155.2812, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0050848835566912
avg test loss is  1.4535648184798673
avg accuracy is  0.5630833334896741
solo acc is  0.2344666668230044
compute similarity  is  tensor(0.9669, device='cuda:3')
compute_distance is  tensor(155.2812, device='cuda:3')
compute_norm is  tensor(55.0803, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.8541, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.607073537512883
avg test loss is  2.2724337950189994
avg accuracy is  0.4648833334896751
solo acc is  0.10396666682299864
compute similarity  is  tensor(0.9666, device='cuda:3')
compute_distance is  tensor(155.8541, device='cuda:3')
compute_norm is  tensor(54.8836, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.5047, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.942657255478251
avg test loss is  1.4103562437903399
avg accuracy is  0.5796500001563393
solo acc is  0.24995000015633825
compute similarity  is  tensor(0.9667, device='cuda:3')
compute_distance is  tensor(155.5047, device='cuda:3')
compute_norm is  tensor(54.5909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(155.5047, device='cuda:3')
distance x is tensor(155.5047, device='cuda:3')
________________________________
test distance is  tensor(155.5047, device='cuda:3')
test distance1 is  tensor(155.5047, device='cuda:3')
test similarity is  tensor(0.9667, device='cuda:3')
test acc is  0.25103333348967155
test loss is 1.4071404621291008
test entropy is  0.9422914474122306
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3631681203842163
mal norm is  tensor(732.3608, device='cuda:3')
distance x is tensor(155.5140, device='cuda:3')
mal distance is  tensor(155.5140, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([612.5418, 539.0424, 554.6895, 523.5445, 549.6472, 608.4982, 544.2424,
        582.0853, 732.3608, 732.3608, 732.3608, 732.3608, 732.3608, 732.3608,
        732.3608, 732.3608, 732.3608, 732.3608, 732.3608, 732.3608],
       device='cuda:3')
sorted_norm is   tensor([523.5445, 539.0424, 544.2424, 549.6472, 554.6895, 582.0853, 608.4982,
        612.5418, 732.3608, 732.3608, 732.3608, 732.3608, 732.3608, 732.3608,
        732.3608, 732.3608, 732.3608, 732.3608, 732.3608, 732.3608],
       device='cuda:3')
used idx is  tensor([ 3,  1,  6,  4,  2,  7,  5,  0, 19, 18, 16, 17, 13, 12],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 79.92% 

Test Accuracy: 79.29% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3706813454627991
distance x is tensor(171.1425, device='cuda:3')
benign distance is  tensor(171.1425, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6553704142570496
distance x is tensor(144.7300, device='cuda:3')
benign distance is  tensor(144.7300, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2656150460243225
distance x is tensor(146.0811, device='cuda:3')
benign distance is  tensor(146.0811, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9059046506881714
distance x is tensor(160.5073, device='cuda:3')
benign distance is  tensor(160.5073, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33849719166755676
distance x is tensor(158.2102, device='cuda:3')
benign distance is  tensor(158.2102, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9473285675048828
distance x is tensor(158.0288, device='cuda:3')
benign distance is  tensor(158.0288, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6546478271484375
distance x is tensor(148.5650, device='cuda:3')
benign distance is  tensor(148.5650, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1414700746536255
distance x is tensor(144.0298, device='cuda:3')
benign distance is  tensor(144.0298, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(163.6301, device='cuda:3')
compute distance is  tensor(163.6301, device='cuda:3')
compute norm is  tensor(54.6094, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.8047, device='cuda:3')
compute distance is  tensor(141.8047, device='cuda:3')
compute norm is  tensor(54.0797, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3898, device='cuda:3')
compute distance is  tensor(156.3898, device='cuda:3')
compute norm is  tensor(54.5527, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.9075, device='cuda:3')
compute distance is  tensor(156.9075, device='cuda:3')
compute norm is  tensor(54.5912, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.6592, device='cuda:3')
compute distance is  tensor(155.6592, device='cuda:3')
compute norm is  tensor(54.4940, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.1820, device='cuda:3')
compute distance is  tensor(150.1820, device='cuda:3')
compute norm is  tensor(54.5142, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.1536, device='cuda:3')
compute distance is  tensor(140.1536, device='cuda:3')
compute norm is  tensor(54.2149, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3853, device='cuda:3')
compute distance is  tensor(156.3853, device='cuda:3')
compute norm is  tensor(54.6405, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.7702, device='cuda:3')
compute distance is  tensor(153.7702, device='cuda:3')
compute norm is  tensor(54.3194, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0188, device='cuda:3')
compute distance is  tensor(142.0188, device='cuda:3')
compute norm is  tensor(54.4004, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3988, device='cuda:3')
compute distance is  tensor(139.3988, device='cuda:3')
compute norm is  tensor(54.2345, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.8553, device='cuda:3')
compute distance is  tensor(153.8553, device='cuda:3')
compute norm is  tensor(54.5830, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(163.6301, device='cuda:3')
distance x is tensor(107534.5703, device='cuda:3')
distance x is tensor(107534.5703, device='cuda:3')
________________________________
test distance is  tensor(107534.5703, device='cuda:3')
test distance1 is  tensor(107534.5703, device='cuda:3')
test similarity is  tensor(0.5166, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130010239585456.86
test entropy is  0.0
________________________________
cal ratio is  0.038228184845849354
distance x is tensor(4110.8569, device='cuda:3')
cal_distance is  tensor(4110.8569, device='cuda:3')
cal ratio is  0.1955201628458751
distance x is tensor(803.7594, device='cuda:3')
cal_distance is  tensor(803.7594, device='cuda:3')
cal ratio is  0.44217552795648235
distance x is tensor(355.4055, device='cuda:3')
cal_distance is  tensor(355.4055, device='cuda:3')
cal ratio is  0.6649601996583043
distance x is tensor(236.3322, device='cuda:3')
cal_distance is  tensor(236.3322, device='cuda:3')
cal ratio is  0.8154479802694142
distance x is tensor(192.7176, device='cuda:3')
cal_distance is  tensor(192.7176, device='cuda:3')
cal ratio is  0.9030193990723216
distance x is tensor(174.0282, device='cuda:3')
cal_distance is  tensor(174.0282, device='cuda:3')
cal ratio is  0.9502719739547575
distance x is tensor(165.3744, device='cuda:3')
cal_distance is  tensor(165.3744, device='cuda:3')
cal ratio is  0.9748181914989871
distance x is tensor(161.2101, device='cuda:3')
cal_distance is  tensor(161.2101, device='cuda:3')
distance x is tensor(161.2101, device='cuda:3')
return_distance is  tensor(161.2101, device='cuda:3')
distance x is tensor(161.2001, device='cuda:3')
distance x is tensor(161.2001, device='cuda:3')
________________________________
test distance is  tensor(161.2001, device='cuda:3')
test distance1 is  tensor(161.2001, device='cuda:3')
test similarity is  tensor(0.9713, device='cuda:3')
test acc is  0.4290333334896748
test loss is 14.04937270658611
test entropy is  0.1191575350021439
________________________________
0
distance x is tensor(161.2001, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.11945403358146453
avg test loss is  14.02909347090894
avg accuracy is  0.8338666668229906
solo acc is  0.4279166668230082
compute similarity  is  tensor(0.9713, device='cuda:3')
compute_distance is  tensor(161.2001, device='cuda:3')
compute_norm is  tensor(58.4870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.6602, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9608393478622315
avg test loss is  1.4060215624664891
avg accuracy is  0.625433333489669
solo acc is  0.277750000156339
compute similarity  is  tensor(0.9721, device='cuda:3')
compute_distance is  tensor(153.6602, device='cuda:3')
compute_norm is  tensor(58.2007, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(153.6602, device='cuda:3')
distance x is tensor(153.6602, device='cuda:3')
________________________________
test distance is  tensor(153.6602, device='cuda:3')
test distance1 is  tensor(153.6602, device='cuda:3')
test similarity is  tensor(0.9721, device='cuda:3')
test acc is  0.27675000015633894
test loss is 1.4060808054165546
test entropy is  0.9609114475595926
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.1822588443756104
mal norm is  tensor(801.6337, device='cuda:3')
distance x is tensor(153.6694, device='cuda:3')
mal distance is  tensor(153.6694, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 687.7187,  590.2163,  589.4871,  634.5544,  618.3944,  628.1125,
         594.2234,  582.4219,  801.6337,  801.6337,  801.6337,  801.6337,
         801.6337,  801.6337,  801.6337,  801.6337,  801.6337,  801.6337,
         801.6337,  801.6337, 1084.1443, 1127.1509, 1130.8751, 1135.5901,
        1118.9574, 1116.8451, 1118.2875, 1096.2732,  779.6533,  713.4982,
         781.6097,  751.1368,  784.4623,  740.1837,  713.2614,  712.7744,
         852.4761,  861.6089,  824.7706,  859.0505,  847.9346,  820.6782,
         898.0156,  856.1996,  727.3765,  686.2903,  625.8394,  719.8984,
         652.7238,  759.9987,  652.3176,  702.9883], device='cuda:3')
sorted_norm is   tensor([ 582.4219,  589.4871,  590.2163,  594.2234,  618.3944,  625.8394,
         628.1125,  634.5544,  652.3176,  652.7238,  686.2903,  687.7187,
         702.9883,  712.7744,  713.2614,  713.4982,  719.8984,  727.3765,
         740.1837,  751.1368,  759.9987,  779.6533,  781.6097,  784.4623,
         801.6337,  801.6337,  801.6337,  801.6337,  801.6337,  801.6337,
         801.6337,  801.6337,  801.6337,  801.6337,  801.6337,  801.6337,
         820.6782,  824.7706,  847.9346,  852.4761,  856.1996,  859.0505,
         861.6089,  898.0156, 1084.1443, 1096.2732, 1116.8451, 1118.2875,
        1118.9574, 1127.1509, 1130.8751, 1135.5901], device='cuda:3')
used idx is  tensor([ 7,  2,  1,  6,  4, 46,  5,  3, 50, 48, 45,  0, 51, 35, 34, 29, 47, 44,
        33, 31, 49, 28, 30, 32, 11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 86.06% 

Test Accuracy: 85.15% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3949592411518097
distance x is tensor(141.1622, device='cuda:3')
benign distance is  tensor(141.1622, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4441685080528259
distance x is tensor(137.0607, device='cuda:3')
benign distance is  tensor(137.0607, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4729708731174469
distance x is tensor(141.9356, device='cuda:3')
benign distance is  tensor(141.9356, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6923791766166687
distance x is tensor(140.2212, device='cuda:3')
benign distance is  tensor(140.2212, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5927714109420776
distance x is tensor(136.7438, device='cuda:3')
benign distance is  tensor(136.7438, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4680193066596985
distance x is tensor(163.6832, device='cuda:3')
benign distance is  tensor(163.6832, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7723480463027954
distance x is tensor(139.8203, device='cuda:3')
benign distance is  tensor(139.8203, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21654286980628967
distance x is tensor(148.6759, device='cuda:3')
benign distance is  tensor(148.6759, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5813426375389099
distance x is tensor(154.8558, device='cuda:3')
benign distance is  tensor(154.8558, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.367901474237442
distance x is tensor(145.5406, device='cuda:3')
benign distance is  tensor(145.5406, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5263240337371826
distance x is tensor(128.7347, device='cuda:3')
benign distance is  tensor(128.7347, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0836527347564697
distance x is tensor(168.1129, device='cuda:3')
benign distance is  tensor(168.1129, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1376186609268188
distance x is tensor(142.0009, device='cuda:3')
benign distance is  tensor(142.0009, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.21707038581371307
distance x is tensor(138.7148, device='cuda:3')
benign distance is  tensor(138.7148, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5785795450210571
distance x is tensor(128.7996, device='cuda:3')
benign distance is  tensor(128.7996, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2575185298919678
distance x is tensor(140.7452, device='cuda:3')
benign distance is  tensor(140.7452, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.270285427570343
distance x is tensor(133.5470, device='cuda:3')
benign distance is  tensor(133.5470, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5680149793624878
distance x is tensor(144.8582, device='cuda:3')
benign distance is  tensor(144.8582, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.17708028852939606
distance x is tensor(141.9561, device='cuda:3')
benign distance is  tensor(141.9561, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5211893320083618
distance x is tensor(133.8177, device='cuda:3')
benign distance is  tensor(133.8177, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.21979618072509766
distance x is tensor(155.0804, device='cuda:3')
benign distance is  tensor(155.0804, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5074803829193115
distance x is tensor(137.3454, device='cuda:3')
benign distance is  tensor(137.3454, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2749304175376892
distance x is tensor(156.0163, device='cuda:3')
benign distance is  tensor(156.0163, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.767846405506134
distance x is tensor(142.1656, device='cuda:3')
benign distance is  tensor(142.1656, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.20527653396129608
distance x is tensor(135.7001, device='cuda:3')
benign distance is  tensor(135.7001, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8608940243721008
distance x is tensor(127.6654, device='cuda:3')
benign distance is  tensor(127.6654, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3316327929496765
distance x is tensor(148.2629, device='cuda:3')
benign distance is  tensor(148.2629, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5776373147964478
distance x is tensor(144.0753, device='cuda:3')
benign distance is  tensor(144.0753, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9223743677139282
distance x is tensor(147.6550, device='cuda:3')
benign distance is  tensor(147.6550, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6466147899627686
distance x is tensor(149.8128, device='cuda:3')
benign distance is  tensor(149.8128, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5560294985771179
distance x is tensor(152.2952, device='cuda:3')
benign distance is  tensor(152.2952, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.22782142460346222
distance x is tensor(136.6648, device='cuda:3')
benign distance is  tensor(136.6648, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.24232280254364014
distance x is tensor(143.1835, device='cuda:3')
benign distance is  tensor(143.1835, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7577834129333496
distance x is tensor(137.0748, device='cuda:3')
benign distance is  tensor(137.0748, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.19682082533836365
distance x is tensor(132.5464, device='cuda:3')
benign distance is  tensor(132.5464, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.31242409348487854
distance x is tensor(142.6374, device='cuda:3')
benign distance is  tensor(142.6374, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.27600693702697754
distance x is tensor(126.4634, device='cuda:3')
benign distance is  tensor(126.4634, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4017910957336426
distance x is tensor(144.9580, device='cuda:3')
benign distance is  tensor(144.9580, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7452632188796997
distance x is tensor(147.8000, device='cuda:3')
benign distance is  tensor(147.8000, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3195979595184326
distance x is tensor(137.2195, device='cuda:3')
benign distance is  tensor(137.2195, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.1690, device='cuda:3')
compute distance is  tensor(135.1690, device='cuda:3')
compute norm is  tensor(54.9857, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3927, device='cuda:3')
compute distance is  tensor(142.3927, device='cuda:3')
compute norm is  tensor(55.0646, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.4940, device='cuda:3')
compute distance is  tensor(151.4940, device='cuda:3')
compute norm is  tensor(55.4937, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3377, device='cuda:3')
compute distance is  tensor(138.3377, device='cuda:3')
compute norm is  tensor(55.1699, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1664, device='cuda:3')
compute distance is  tensor(137.1664, device='cuda:3')
compute norm is  tensor(55.2360, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5161, device='cuda:3')
compute distance is  tensor(143.5161, device='cuda:3')
compute norm is  tensor(55.2736, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6654, device='cuda:3')
compute distance is  tensor(138.6654, device='cuda:3')
compute norm is  tensor(55.3733, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3540, device='cuda:3')
compute distance is  tensor(130.3540, device='cuda:3')
compute norm is  tensor(55.0499, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.5130, device='cuda:3')
compute distance is  tensor(157.5130, device='cuda:3')
compute norm is  tensor(55.5356, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2750, device='cuda:3')
compute distance is  tensor(134.2750, device='cuda:3')
compute norm is  tensor(55.1528, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.1732, device='cuda:3')
compute distance is  tensor(148.1732, device='cuda:3')
compute norm is  tensor(55.4866, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2165, device='cuda:3')
compute distance is  tensor(132.2165, device='cuda:3')
compute norm is  tensor(55.0451, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.5130, device='cuda:3')
distance x is tensor(107522.1172, device='cuda:3')
distance x is tensor(107522.1172, device='cuda:3')
________________________________
test distance is  tensor(107522.1172, device='cuda:3')
test distance1 is  tensor(107522.1172, device='cuda:3')
test similarity is  tensor(0.5375, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130114276953090.19
test entropy is  0.0
________________________________
cal ratio is  0.037508990595223834
distance x is tensor(4033.0515, device='cuda:3')
cal_distance is  tensor(4033.0515, device='cuda:3')
cal ratio is  0.19367224413970077
distance x is tensor(781.0941, device='cuda:3')
cal_distance is  tensor(781.0941, device='cuda:3')
cal ratio is  0.44008097621455267
distance x is tensor(343.7475, device='cuda:3')
cal_distance is  tensor(343.7475, device='cuda:3')
cal ratio is  0.6633832856450267
distance x is tensor(228.0381, device='cuda:3')
cal_distance is  tensor(228.0381, device='cuda:3')
cal ratio is  0.8144803685743206
distance x is tensor(185.7334, device='cuda:3')
cal_distance is  tensor(185.7334, device='cuda:3')
cal ratio is  0.9024834816681132
distance x is tensor(167.6218, device='cuda:3')
cal_distance is  tensor(167.6218, device='cuda:3')
cal ratio is  0.9499898586861248
distance x is tensor(159.2393, device='cuda:3')
cal_distance is  tensor(159.2393, device='cuda:3')
cal ratio is  0.9746734284231839
distance x is tensor(155.2065, device='cuda:3')
cal_distance is  tensor(155.2065, device='cuda:3')
distance x is tensor(155.2065, device='cuda:3')
return_distance is  tensor(155.2065, device='cuda:3')
distance x is tensor(155.1965, device='cuda:3')
distance x is tensor(155.1965, device='cuda:3')
________________________________
test distance is  tensor(155.1965, device='cuda:3')
test distance1 is  tensor(155.1965, device='cuda:3')
test similarity is  tensor(0.9751, device='cuda:3')
test acc is  0.1310000001563319
test loss is 86.85878509651623
test entropy is  0.014523751184138983
________________________________
0
distance x is tensor(155.1965, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.015127817106171955
avg test loss is  86.38981826879831
avg accuracy is  0.795633333489659
solo acc is  0.1314000001563319
compute similarity  is  tensor(0.9751, device='cuda:3')
compute_distance is  tensor(155.1965, device='cuda:3')
compute_norm is  tensor(59.2660, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.3376, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0485394171306066
avg test loss is  1.5769452620416815
avg accuracy is  0.591816666823005
solo acc is  0.2550000001563384
compute similarity  is  tensor(0.9757, device='cuda:3')
compute_distance is  tensor(153.3376, device='cuda:3')
compute_norm is  tensor(59.5887, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(153.9342, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6250480770874125
avg test loss is  2.4559062856600993
avg accuracy is  0.47935000015634194
solo acc is  0.10891666682299862
compute similarity  is  tensor(0.9755, device='cuda:3')
compute_distance is  tensor(153.9342, device='cuda:3')
compute_norm is  tensor(59.3905, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.9319, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9812395075109722
avg test loss is  1.4722244941603655
avg accuracy is  0.5983166668230043
solo acc is  0.2391000001563379
compute similarity  is  tensor(0.9757, device='cuda:3')
compute_distance is  tensor(152.9319, device='cuda:3')
compute_norm is  tensor(59.0902, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.9319, device='cuda:3')
distance x is tensor(152.9319, device='cuda:3')
________________________________
test distance is  tensor(152.9319, device='cuda:3')
test distance1 is  tensor(152.9319, device='cuda:3')
test similarity is  tensor(0.9757, device='cuda:3')
test acc is  0.24083333348967123
test loss is 1.474999595806797
test entropy is  0.9798161436372729
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3665117025375366
mal norm is  tensor(758.4355, device='cuda:3')
distance x is tensor(152.9414, device='cuda:3')
mal distance is  tensor(152.9414, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([573.2498, 547.6414, 564.7861, 555.2009, 545.6108, 639.4961, 558.2084,
        609.9559, 758.4354, 758.4355, 758.4354, 758.4355, 758.4354, 758.4355,
        758.4354, 758.4355, 758.4354, 758.4355, 758.4354, 758.4355],
       device='cuda:3')
sorted_norm is   tensor([545.6108, 547.6414, 555.2009, 558.2084, 564.7861, 573.2498, 609.9559,
        639.4961, 758.4354, 758.4354, 758.4354, 758.4354, 758.4354, 758.4354,
        758.4355, 758.4355, 758.4355, 758.4355, 758.4355, 758.4355],
       device='cuda:3')
used idx is  tensor([ 4,  1,  3,  6,  2,  0,  7,  5, 18, 16, 12, 14, 10,  8],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 80.81% 

Test Accuracy: 80.38% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5513288974761963
distance x is tensor(154.1043, device='cuda:3')
benign distance is  tensor(154.1043, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6969234347343445
distance x is tensor(141.8995, device='cuda:3')
benign distance is  tensor(141.8995, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18842057883739471
distance x is tensor(161.1105, device='cuda:3')
benign distance is  tensor(161.1105, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.35030597448349
distance x is tensor(139.3791, device='cuda:3')
benign distance is  tensor(139.3791, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5884342193603516
distance x is tensor(148.4024, device='cuda:3')
benign distance is  tensor(148.4024, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8047261238098145
distance x is tensor(151.8939, device='cuda:3')
benign distance is  tensor(151.8939, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3127725124359131
distance x is tensor(148.5504, device='cuda:3')
benign distance is  tensor(148.5504, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.14720307290554047
distance x is tensor(158.4297, device='cuda:3')
benign distance is  tensor(158.4297, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.4381, device='cuda:3')
compute distance is  tensor(144.4381, device='cuda:3')
compute norm is  tensor(58.0702, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.8228, device='cuda:3')
compute distance is  tensor(148.8228, device='cuda:3')
compute norm is  tensor(58.1356, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.8331, device='cuda:3')
compute distance is  tensor(150.8331, device='cuda:3')
compute norm is  tensor(58.2839, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0763, device='cuda:3')
compute distance is  tensor(147.0763, device='cuda:3')
compute norm is  tensor(57.9152, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.9659, device='cuda:3')
compute distance is  tensor(137.9659, device='cuda:3')
compute norm is  tensor(57.9707, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.1205, device='cuda:3')
compute distance is  tensor(155.1205, device='cuda:3')
compute norm is  tensor(58.5180, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9761, device='cuda:3')
compute distance is  tensor(142.9761, device='cuda:3')
compute norm is  tensor(58.0563, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7727, device='cuda:3')
compute distance is  tensor(138.7727, device='cuda:3')
compute norm is  tensor(57.9357, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7893, device='cuda:3')
compute distance is  tensor(158.7893, device='cuda:3')
compute norm is  tensor(58.2356, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.3009, device='cuda:3')
compute distance is  tensor(150.3009, device='cuda:3')
compute norm is  tensor(58.1651, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7951, device='cuda:3')
compute distance is  tensor(146.7951, device='cuda:3')
compute norm is  tensor(58.1917, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.6306, device='cuda:3')
compute distance is  tensor(143.6306, device='cuda:3')
compute norm is  tensor(58.0568, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.7893, device='cuda:3')
distance x is tensor(107486.1484, device='cuda:3')
distance x is tensor(107486.1484, device='cuda:3')
________________________________
test distance is  tensor(107486.1484, device='cuda:3')
test distance1 is  tensor(107486.1484, device='cuda:3')
test similarity is  tensor(0.5957, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130097437019277.92
test entropy is  0.0
________________________________
cal ratio is  0.037666945277232286
distance x is tensor(4048.6804, device='cuda:3')
cal_distance is  tensor(4048.6804, device='cuda:3')
cal ratio is  0.19407961418640685
distance x is tensor(785.7703, device='cuda:3')
cal_distance is  tensor(785.7703, device='cuda:3')
cal ratio is  0.4405435624110544
distance x is tensor(346.1688, device='cuda:3')
cal_distance is  tensor(346.1688, device='cuda:3')
cal ratio is  0.6637318977664086
distance x is tensor(229.7650, device='cuda:3')
cal_distance is  tensor(229.7650, device='cuda:3')
cal ratio is  0.8146944231266667
distance x is tensor(187.1892, device='cuda:3')
cal_distance is  tensor(187.1892, device='cuda:3')
cal ratio is  0.9026020240838972
distance x is tensor(168.9578, device='cuda:3')
cal_distance is  tensor(168.9578, device='cuda:3')
cal ratio is  0.9500522837180219
distance x is tensor(160.5190, device='cuda:3')
cal_distance is  tensor(160.5190, device='cuda:3')
cal ratio is  0.9747054954450207
distance x is tensor(156.4589, device='cuda:3')
cal_distance is  tensor(156.4589, device='cuda:3')
distance x is tensor(156.4589, device='cuda:3')
return_distance is  tensor(156.4589, device='cuda:3')
distance x is tensor(156.4489, device='cuda:3')
distance x is tensor(156.4489, device='cuda:3')
________________________________
test distance is  tensor(156.4489, device='cuda:3')
test distance1 is  tensor(156.4489, device='cuda:3')
test similarity is  tensor(0.9802, device='cuda:3')
test acc is  0.4023166668230078
test loss is 14.769968182293336
test entropy is  0.12241285460304095
________________________________
0
distance x is tensor(156.4489, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.12456551189822301
avg test loss is  14.702137519555814
avg accuracy is  0.826666666822991
solo acc is  0.4013500001563411
compute similarity  is  tensor(0.9802, device='cuda:3')
compute_distance is  tensor(156.4489, device='cuda:3')
compute_norm is  tensor(62.6187, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.3685, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9519168104825497
avg test loss is  1.3853697728500691
avg accuracy is  0.6372166668230014
solo acc is  0.28626666682300583
compute similarity  is  tensor(0.9806, device='cuda:3')
compute_distance is  tensor(150.3685, device='cuda:3')
compute_norm is  tensor(62.2699, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(150.3685, device='cuda:3')
distance x is tensor(150.3685, device='cuda:3')
________________________________
test distance is  tensor(150.3685, device='cuda:3')
test distance1 is  tensor(150.3685, device='cuda:3')
test similarity is  tensor(0.9806, device='cuda:3')
test acc is  0.28655000015633925
test loss is 1.386705123793596
test entropy is  0.952514602240723
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1317516565322876
mal norm is  tensor(779.1046, device='cuda:3')
distance x is tensor(150.3775, device='cuda:3')
mal distance is  tensor(150.3775, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([606.9296, 567.0571, 624.3438, 546.7444, 597.3047, 609.9149, 579.3199,
        622.7520, 779.1046, 779.1046, 779.1046, 779.1046, 779.1046, 779.1046,
        779.1046, 779.1046, 779.1046, 779.1046, 779.1046, 779.1046, 709.2665,
        672.5539, 612.6788, 748.5345, 661.6329, 654.9393, 622.3254, 661.9286],
       device='cuda:3')
sorted_norm is   tensor([546.7444, 567.0571, 579.3199, 597.3047, 606.9296, 609.9149, 612.6788,
        622.3254, 622.7520, 624.3438, 654.9393, 661.6329, 661.9286, 672.5539,
        709.2665, 748.5345, 779.1046, 779.1046, 779.1046, 779.1046, 779.1046,
        779.1046, 779.1046, 779.1046, 779.1046, 779.1046, 779.1046, 779.1046],
       device='cuda:3')
used idx is  tensor([ 3,  1,  6,  4,  0,  5, 22, 26,  7,  2, 25, 24, 27, 21, 20, 23, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.27% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.15107545256614685
distance x is tensor(145.3304, device='cuda:3')
benign distance is  tensor(145.3304, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8542718887329102
distance x is tensor(131.4881, device='cuda:3')
benign distance is  tensor(131.4881, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19648514688014984
distance x is tensor(131.4220, device='cuda:3')
benign distance is  tensor(131.4220, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.862840473651886
distance x is tensor(135.5061, device='cuda:3')
benign distance is  tensor(135.5061, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8105281591415405
distance x is tensor(111.6032, device='cuda:3')
benign distance is  tensor(111.6032, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.014463186264038
distance x is tensor(143.3354, device='cuda:3')
benign distance is  tensor(143.3354, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18027600646018982
distance x is tensor(137.2195, device='cuda:3')
benign distance is  tensor(137.2195, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7503651976585388
distance x is tensor(132.3499, device='cuda:3')
benign distance is  tensor(132.3499, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7682323455810547
distance x is tensor(138.4769, device='cuda:3')
benign distance is  tensor(138.4769, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4390726089477539
distance x is tensor(136.7924, device='cuda:3')
benign distance is  tensor(136.7924, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5962386131286621
distance x is tensor(124.8221, device='cuda:3')
benign distance is  tensor(124.8221, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5859657526016235
distance x is tensor(138.2117, device='cuda:3')
benign distance is  tensor(138.2117, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8231847882270813
distance x is tensor(124.0658, device='cuda:3')
benign distance is  tensor(124.0658, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4571256637573242
distance x is tensor(137.3895, device='cuda:3')
benign distance is  tensor(137.3895, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.23767247796058655
distance x is tensor(132.6915, device='cuda:3')
benign distance is  tensor(132.6915, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.45582419633865356
distance x is tensor(138.7483, device='cuda:3')
benign distance is  tensor(138.7483, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(131.4256, device='cuda:3')
compute distance is  tensor(131.4256, device='cuda:3')
compute norm is  tensor(58.2680, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3378, device='cuda:3')
compute distance is  tensor(122.3378, device='cuda:3')
compute norm is  tensor(58.1413, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.0847, device='cuda:3')
compute distance is  tensor(136.0847, device='cuda:3')
compute norm is  tensor(58.3293, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2977, device='cuda:3')
compute distance is  tensor(133.2977, device='cuda:3')
compute norm is  tensor(58.3212, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0658, device='cuda:3')
compute distance is  tensor(141.0658, device='cuda:3')
compute norm is  tensor(58.4504, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8297, device='cuda:3')
compute distance is  tensor(120.8297, device='cuda:3')
compute norm is  tensor(58.2180, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2957, device='cuda:3')
compute distance is  tensor(120.2957, device='cuda:3')
compute norm is  tensor(58.1038, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7364, device='cuda:3')
compute distance is  tensor(131.7364, device='cuda:3')
compute norm is  tensor(58.3023, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9388, device='cuda:3')
compute distance is  tensor(144.9388, device='cuda:3')
compute norm is  tensor(58.5236, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2596, device='cuda:3')
compute distance is  tensor(140.2596, device='cuda:3')
compute norm is  tensor(58.5279, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2416, device='cuda:3')
compute distance is  tensor(126.2416, device='cuda:3')
compute norm is  tensor(58.2680, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8398, device='cuda:3')
compute distance is  tensor(127.8398, device='cuda:3')
compute norm is  tensor(58.3678, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.9388, device='cuda:3')
distance x is tensor(107503.6719, device='cuda:3')
distance x is tensor(107503.6719, device='cuda:3')
________________________________
test distance is  tensor(107503.6719, device='cuda:3')
test distance1 is  tensor(107503.6719, device='cuda:3')
test similarity is  tensor(0.5739, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130075791012267.94
test entropy is  0.0
________________________________
cal ratio is  0.0359837816727198
distance x is tensor(3868.3943, device='cuda:3')
cal_distance is  tensor(3868.3943, device='cuda:3')
cal ratio is  0.18969377468436757
distance x is tensor(733.8143, device='cuda:3')
cal_distance is  tensor(733.8143, device='cuda:3')
cal ratio is  0.4355373046986782
distance x is tensor(319.6063, device='cuda:3')
cal_distance is  tensor(319.6063, device='cuda:3')
cal ratio is  0.6599495997294661
distance x is tensor(210.9258, device='cuda:3')
cal_distance is  tensor(210.9258, device='cuda:3')
cal ratio is  0.8123694880935843
distance x is tensor(171.3506, device='cuda:3')
cal_distance is  tensor(171.3506, device='cuda:3')
cal ratio is  0.9013129511393547
distance x is tensor(154.4410, device='cuda:3')
cal_distance is  tensor(154.4410, device='cuda:3')
cal ratio is  0.9493735227265708
distance x is tensor(146.6225, device='cuda:3')
cal_distance is  tensor(146.6225, device='cuda:3')
cal ratio is  0.9743571652339473
distance x is tensor(142.8628, device='cuda:3')
cal_distance is  tensor(142.8628, device='cuda:3')
distance x is tensor(142.8628, device='cuda:3')
return_distance is  tensor(142.8628, device='cuda:3')
distance x is tensor(142.8528, device='cuda:3')
distance x is tensor(142.8528, device='cuda:3')
________________________________
test distance is  tensor(142.8528, device='cuda:3')
test distance1 is  tensor(142.8528, device='cuda:3')
test similarity is  tensor(0.9823, device='cuda:3')
test acc is  0.22855000015633747
test loss is 45.066934345627644
test entropy is  0.04421969239405398
________________________________
0
distance x is tensor(142.8528, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.04359315561755165
avg test loss is  44.788578204254605
avg accuracy is  0.8558333334896564
solo acc is  0.23011666682300425
compute similarity  is  tensor(0.9823, device='cuda:3')
compute_distance is  tensor(142.8528, device='cuda:3')
compute_norm is  tensor(62.2900, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.3472, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9296925716054465
avg test loss is  1.3874361183978856
avg accuracy is  0.7859833334896593
solo acc is  0.3022333334896729
compute similarity  is  tensor(0.9822, device='cuda:3')
compute_distance is  tensor(142.3472, device='cuda:3')
compute_norm is  tensor(62.0575, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.3472, device='cuda:3')
distance x is tensor(142.3472, device='cuda:3')
________________________________
test distance is  tensor(142.3472, device='cuda:3')
test distance1 is  tensor(142.3472, device='cuda:3')
test similarity is  tensor(0.9822, device='cuda:3')
test acc is  0.3039000001563396
test loss is 1.3826622220753098
test entropy is  0.9291697548015285
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3136687278747559
mal norm is  tensor(716.2775, device='cuda:3')
distance x is tensor(142.3565, device='cuda:3')
mal distance is  tensor(142.3565, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([577.9180, 539.5217, 536.4213, 543.9407, 458.1724, 580.2890, 539.0145,
        552.2491, 716.2775, 716.2775, 716.2775, 716.2775, 716.2775, 716.2775,
        716.2775, 716.2775, 716.2775, 716.2775, 716.2775, 716.2775, 857.9552,
        869.2574, 866.2950, 871.1360, 865.5320, 887.1746, 860.9748, 865.4882,
        605.6812, 650.8499, 635.3459, 598.8884, 667.2818, 616.5809, 676.9542,
        626.3121], device='cuda:3')
sorted_norm is   tensor([458.1724, 536.4213, 539.0145, 539.5217, 543.9407, 552.2491, 577.9180,
        580.2890, 598.8884, 605.6812, 616.5809, 626.3121, 635.3459, 650.8499,
        667.2818, 676.9542, 716.2775, 716.2775, 716.2775, 716.2775, 716.2775,
        716.2775, 716.2775, 716.2775, 716.2775, 716.2775, 716.2775, 716.2775,
        857.9552, 860.9748, 865.4882, 865.5320, 866.2950, 869.2574, 871.1360,
        887.1746], device='cuda:3')
used idx is  tensor([ 4,  2,  6,  1,  3,  7,  0,  5, 31, 28, 33, 35, 30, 29, 32, 34, 11, 10,
         8,  9, 13, 12, 14, 15, 19], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 86.26% 

Test Accuracy: 85.34% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4467131495475769
distance x is tensor(137.0028, device='cuda:3')
benign distance is  tensor(137.0028, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.34315794706344604
distance x is tensor(131.9908, device='cuda:3')
benign distance is  tensor(131.9908, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5828876495361328
distance x is tensor(141.8148, device='cuda:3')
benign distance is  tensor(141.8148, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7702959179878235
distance x is tensor(136.9408, device='cuda:3')
benign distance is  tensor(136.9408, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5459937453269958
distance x is tensor(131.7315, device='cuda:3')
benign distance is  tensor(131.7315, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8152706027030945
distance x is tensor(155.3499, device='cuda:3')
benign distance is  tensor(155.3499, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16398636996746063
distance x is tensor(159.3376, device='cuda:3')
benign distance is  tensor(159.3376, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3167588710784912
distance x is tensor(136.1906, device='cuda:3')
benign distance is  tensor(136.1906, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4647568166255951
distance x is tensor(131.0184, device='cuda:3')
benign distance is  tensor(131.0184, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9194124341011047
distance x is tensor(147.7971, device='cuda:3')
benign distance is  tensor(147.7971, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4161927103996277
distance x is tensor(149.1165, device='cuda:3')
benign distance is  tensor(149.1165, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3637922704219818
distance x is tensor(146.9627, device='cuda:3')
benign distance is  tensor(146.9627, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20785510540008545
distance x is tensor(135.5742, device='cuda:3')
benign distance is  tensor(135.5742, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3842024803161621
distance x is tensor(127.8540, device='cuda:3')
benign distance is  tensor(127.8540, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3244587779045105
distance x is tensor(144.7038, device='cuda:3')
benign distance is  tensor(144.7038, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8511936068534851
distance x is tensor(134.8515, device='cuda:3')
benign distance is  tensor(134.8515, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4616335928440094
distance x is tensor(136.1875, device='cuda:3')
benign distance is  tensor(136.1875, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.06606308370828629
distance x is tensor(142.6441, device='cuda:3')
benign distance is  tensor(142.6441, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.13344696164131165
distance x is tensor(137.5013, device='cuda:3')
benign distance is  tensor(137.5013, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.27802205085754395
distance x is tensor(140.3618, device='cuda:3')
benign distance is  tensor(140.3618, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.38977697491645813
distance x is tensor(137.4305, device='cuda:3')
benign distance is  tensor(137.4305, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0512980222702026
distance x is tensor(150.7046, device='cuda:3')
benign distance is  tensor(150.7046, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2252216637134552
distance x is tensor(141.7072, device='cuda:3')
benign distance is  tensor(141.7072, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.27856308221817017
distance x is tensor(136.8091, device='cuda:3')
benign distance is  tensor(136.8091, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.8446, device='cuda:3')
compute distance is  tensor(129.8446, device='cuda:3')
compute norm is  tensor(59.3796, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9656, device='cuda:3')
compute distance is  tensor(136.9656, device='cuda:3')
compute norm is  tensor(59.5798, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3918, device='cuda:3')
compute distance is  tensor(142.3918, device='cuda:3')
compute norm is  tensor(59.7758, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0208, device='cuda:3')
compute distance is  tensor(144.0208, device='cuda:3')
compute norm is  tensor(59.6610, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.7307, device='cuda:3')
compute distance is  tensor(149.7307, device='cuda:3')
compute norm is  tensor(59.9515, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0583, device='cuda:3')
compute distance is  tensor(149.0583, device='cuda:3')
compute norm is  tensor(59.9836, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5451, device='cuda:3')
compute distance is  tensor(121.5451, device='cuda:3')
compute norm is  tensor(59.3656, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5148, device='cuda:3')
compute distance is  tensor(136.5148, device='cuda:3')
compute norm is  tensor(59.5623, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5150, device='cuda:3')
compute distance is  tensor(141.5150, device='cuda:3')
compute norm is  tensor(59.4822, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6880, device='cuda:3')
compute distance is  tensor(131.6880, device='cuda:3')
compute norm is  tensor(59.6160, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9171, device='cuda:3')
compute distance is  tensor(139.9171, device='cuda:3')
compute norm is  tensor(59.7032, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2887, device='cuda:3')
compute distance is  tensor(121.2887, device='cuda:3')
compute norm is  tensor(59.3603, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.7307, device='cuda:3')
distance x is tensor(107480.4531, device='cuda:3')
distance x is tensor(107480.4531, device='cuda:3')
________________________________
test distance is  tensor(107480.4531, device='cuda:3')
test distance1 is  tensor(107480.4531, device='cuda:3')
test similarity is  tensor(0.6055, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130055386841192.8
test entropy is  0.0
________________________________
cal ratio is  0.0365777271417464
distance x is tensor(3931.3960, device='cuda:3')
cal_distance is  tensor(3931.3960, device='cuda:3')
cal ratio is  0.19125291404498693
distance x is tensor(751.8949, device='cuda:3')
cal_distance is  tensor(751.8949, device='cuda:3')
cal ratio is  0.43732357220510143
distance x is tensor(328.8242, device='cuda:3')
cal_distance is  tensor(328.8242, device='cuda:3')
cal ratio is  0.6613015821778034
distance x is tensor(217.4537, device='cuda:3')
cal_distance is  tensor(217.4537, device='cuda:3')
cal ratio is  0.8132013342708735
distance x is tensor(176.8345, device='cuda:3')
cal_distance is  tensor(176.8345, device='cuda:3')
cal ratio is  0.9017743756394804
distance x is tensor(159.4654, device='cuda:3')
cal_distance is  tensor(159.4654, device='cuda:3')
cal ratio is  0.9496164882304052
distance x is tensor(151.4312, device='cuda:3')
cal_distance is  tensor(151.4312, device='cuda:3')
cal ratio is  0.9744818852826922
distance x is tensor(147.5671, device='cuda:3')
cal_distance is  tensor(147.5671, device='cuda:3')
distance x is tensor(147.5671, device='cuda:3')
return_distance is  tensor(147.5671, device='cuda:3')
distance x is tensor(147.5571, device='cuda:3')
distance x is tensor(147.5571, device='cuda:3')
________________________________
test distance is  tensor(147.5571, device='cuda:3')
test distance1 is  tensor(147.5571, device='cuda:3')
test similarity is  tensor(0.9835, device='cuda:3')
test acc is  0.17725000015633519
test loss is 42.00322746976352
test entropy is  0.038011455062482914
________________________________
0
distance x is tensor(147.5571, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.037212701133593346
avg test loss is  42.26213303100326
avg accuracy is  0.8321000001563239
solo acc is  0.17508333348966834
compute similarity  is  tensor(0.9835, device='cuda:3')
compute_distance is  tensor(147.5571, device='cuda:3')
compute_norm is  tensor(63.9623, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.5451, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9614045339733807
avg test loss is  1.3927635664878877
avg accuracy is  0.7045833334896637
solo acc is  0.2981666668230061
compute similarity  is  tensor(0.9839, device='cuda:3')
compute_distance is  tensor(143.5451, device='cuda:3')
compute_norm is  tensor(63.7721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(143.5451, device='cuda:3')
distance x is tensor(143.5451, device='cuda:3')
________________________________
test distance is  tensor(143.5451, device='cuda:3')
test distance1 is  tensor(143.5451, device='cuda:3')
test similarity is  tensor(0.9839, device='cuda:3')
test acc is  0.2984833334896729
test loss is 1.3889903520216058
test entropy is  0.9614800081959666
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.2253957986831665
mal norm is  tensor(733.7200, device='cuda:3')
distance x is tensor(143.5546, device='cuda:3')
mal distance is  tensor(143.5546, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([549.2296, 533.5116, 572.4753, 548.1673, 517.6938, 618.1849, 606.4813,
        550.0789, 733.7200, 733.7200, 733.7200, 733.7200, 733.7200, 733.7200,
        733.7200, 733.7200, 733.7200, 733.7200, 733.7200, 733.7200, 685.1614,
        665.4601, 727.3248, 715.3535, 721.4115, 734.0664, 749.2144, 690.3836,
        601.2054, 598.3566, 552.4552, 609.7568, 552.5806, 588.0471, 573.9973,
        607.8057], device='cuda:3')
sorted_norm is   tensor([517.6938, 533.5116, 548.1673, 549.2296, 550.0789, 552.4552, 552.5806,
        572.4753, 573.9973, 588.0471, 598.3566, 601.2054, 606.4813, 607.8057,
        609.7568, 618.1849, 665.4601, 685.1614, 690.3836, 715.3535, 721.4115,
        727.3248, 733.7200, 733.7200, 733.7200, 733.7200, 733.7200, 733.7200,
        733.7200, 733.7200, 733.7200, 733.7200, 733.7200, 733.7200, 734.0664,
        749.2144], device='cuda:3')
used idx is  tensor([ 4,  1,  3,  0,  7, 30, 32,  2, 34, 33, 29, 28,  6, 35, 31,  5, 21, 20,
        27, 23, 24, 22, 11, 10, 16], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 88.23% 

Test Accuracy: 87.16% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.38520437479019165
distance x is tensor(124.1518, device='cuda:3')
benign distance is  tensor(124.1518, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7278004884719849
distance x is tensor(147.5525, device='cuda:3')
benign distance is  tensor(147.5525, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22063753008842468
distance x is tensor(128.4133, device='cuda:3')
benign distance is  tensor(128.4133, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49619778990745544
distance x is tensor(140.3442, device='cuda:3')
benign distance is  tensor(140.3442, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5682772397994995
distance x is tensor(138.3263, device='cuda:3')
benign distance is  tensor(138.3263, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.537663996219635
distance x is tensor(140.1853, device='cuda:3')
benign distance is  tensor(140.1853, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21812736988067627
distance x is tensor(124.4619, device='cuda:3')
benign distance is  tensor(124.4619, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4899430274963379
distance x is tensor(131.9714, device='cuda:3')
benign distance is  tensor(131.9714, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8606902956962585
distance x is tensor(129.5110, device='cuda:3')
benign distance is  tensor(129.5110, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3685230314731598
distance x is tensor(141.8686, device='cuda:3')
benign distance is  tensor(141.8686, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5648525953292847
distance x is tensor(121.5301, device='cuda:3')
benign distance is  tensor(121.5301, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.41198617219924927
distance x is tensor(133.9858, device='cuda:3')
benign distance is  tensor(133.9858, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.23224039375782013
distance x is tensor(124.1055, device='cuda:3')
benign distance is  tensor(124.1055, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4010200500488281
distance x is tensor(127.4775, device='cuda:3')
benign distance is  tensor(127.4775, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.34232205152511597
distance x is tensor(130.2122, device='cuda:3')
benign distance is  tensor(130.2122, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5256195068359375
distance x is tensor(132.0925, device='cuda:3')
benign distance is  tensor(132.0925, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6530675292015076
distance x is tensor(133.7921, device='cuda:3')
benign distance is  tensor(133.7921, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.39478009939193726
distance x is tensor(129.1829, device='cuda:3')
benign distance is  tensor(129.1829, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6856539845466614
distance x is tensor(134.1662, device='cuda:3')
benign distance is  tensor(134.1662, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4379223883152008
distance x is tensor(143.7196, device='cuda:3')
benign distance is  tensor(143.7196, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3751860857009888
distance x is tensor(122.2135, device='cuda:3')
benign distance is  tensor(122.2135, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4103682041168213
distance x is tensor(137.4867, device='cuda:3')
benign distance is  tensor(137.4867, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.46374741196632385
distance x is tensor(131.2877, device='cuda:3')
benign distance is  tensor(131.2877, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5625295639038086
distance x is tensor(123.8296, device='cuda:3')
benign distance is  tensor(123.8296, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(132.7538, device='cuda:3')
compute distance is  tensor(132.7538, device='cuda:3')
compute norm is  tensor(59.5723, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7600, device='cuda:3')
compute distance is  tensor(121.7600, device='cuda:3')
compute norm is  tensor(59.1719, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4358, device='cuda:3')
compute distance is  tensor(137.4358, device='cuda:3')
compute norm is  tensor(59.4996, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7879, device='cuda:3')
compute distance is  tensor(137.7879, device='cuda:3')
compute norm is  tensor(59.3581, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6914, device='cuda:3')
compute distance is  tensor(137.6914, device='cuda:3')
compute norm is  tensor(59.6320, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0087, device='cuda:3')
compute distance is  tensor(131.0087, device='cuda:3')
compute norm is  tensor(59.4524, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.7843, device='cuda:3')
compute distance is  tensor(124.7843, device='cuda:3')
compute norm is  tensor(59.2597, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7878, device='cuda:3')
compute distance is  tensor(122.7878, device='cuda:3')
compute norm is  tensor(59.2217, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5020, device='cuda:3')
compute distance is  tensor(136.5020, device='cuda:3')
compute norm is  tensor(59.4176, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.5797, device='cuda:3')
compute distance is  tensor(117.5797, device='cuda:3')
compute norm is  tensor(59.2224, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.4859, device='cuda:3')
compute distance is  tensor(130.4859, device='cuda:3')
compute norm is  tensor(59.4709, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9193, device='cuda:3')
compute distance is  tensor(127.9193, device='cuda:3')
compute norm is  tensor(59.4185, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.7879, device='cuda:3')
distance x is tensor(107503.6719, device='cuda:3')
distance x is tensor(107503.6719, device='cuda:3')
________________________________
test distance is  tensor(107503.6719, device='cuda:3')
test distance1 is  tensor(107503.6719, device='cuda:3')
test similarity is  tensor(0.5763, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130131250559102.64
test entropy is  0.0
________________________________
cal ratio is  0.035084876721482514
distance x is tensor(3771.7583, device='cuda:3')
cal_distance is  tensor(3771.7583, device='cuda:3')
cal ratio is  0.18730944464552454
distance x is tensor(706.4901, device='cuda:3')
cal_distance is  tensor(706.4901, device='cuda:3')
cal ratio is  0.432791343399109
distance x is tensor(305.7656, device='cuda:3')
cal_distance is  tensor(305.7656, device='cuda:3')
cal ratio is  0.6578657324720038
distance x is tensor(201.1544, device='cuda:3')
cal_distance is  tensor(201.1544, device='cuda:3')
cal ratio is  0.8110857488112261
distance x is tensor(163.1545, device='cuda:3')
cal_distance is  tensor(163.1545, device='cuda:3')
cal ratio is  0.9006003492000986
distance x is tensor(146.9375, device='cuda:3')
cal_distance is  tensor(146.9375, device='cuda:3')
cal ratio is  0.9489980398400043
distance x is tensor(139.4436, device='cuda:3')
cal_distance is  tensor(139.4436, device='cuda:3')
cal ratio is  0.9741644434227767
distance x is tensor(135.8412, device='cuda:3')
cal_distance is  tensor(135.8412, device='cuda:3')
distance x is tensor(135.8412, device='cuda:3')
return_distance is  tensor(135.8412, device='cuda:3')
distance x is tensor(135.8312, device='cuda:3')
distance x is tensor(135.8312, device='cuda:3')
________________________________
test distance is  tensor(135.8312, device='cuda:3')
test distance1 is  tensor(135.8312, device='cuda:3')
test similarity is  tensor(0.9844, device='cuda:3')
test acc is  0.3462500001563404
test loss is 21.168585438718164
test entropy is  0.07776723081456509
________________________________
0
distance x is tensor(135.8312, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0754719599962298
avg test loss is  20.9930375166285
avg accuracy is  0.8696166668229892
solo acc is  0.3476666668230071
compute similarity  is  tensor(0.9844, device='cuda:3')
compute_distance is  tensor(135.8312, device='cuda:3')
compute_norm is  tensor(63.1336, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.4336, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9310082464711245
avg test loss is  1.3716143697563774
avg accuracy is  0.7982000001563254
solo acc is  0.3174666668230065
compute similarity  is  tensor(0.9840, device='cuda:3')
compute_distance is  tensor(135.4336, device='cuda:3')
compute_norm is  tensor(62.7529, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(135.4336, device='cuda:3')
distance x is tensor(135.4336, device='cuda:3')
________________________________
test distance is  tensor(135.4336, device='cuda:3')
test distance1 is  tensor(135.4336, device='cuda:3')
test similarity is  tensor(0.9840, device='cuda:3')
test acc is  0.31211666682300643
test loss is 1.376314619075515
test entropy is  0.9321964329748011
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.003459095954895
mal norm is  tensor(682.6123, device='cuda:3')
distance x is tensor(135.4426, device='cuda:3')
mal distance is  tensor(135.4426, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([511.5063, 604.9211, 518.1014, 565.0329, 563.4945, 574.9254, 506.9550,
        551.0849, 682.6122, 682.6123, 682.6122, 682.6123, 682.6122, 682.6123,
        682.6122, 682.6123, 682.6122, 682.6123, 682.6122, 682.6123],
       device='cuda:3')
sorted_norm is   tensor([506.9550, 511.5063, 518.1014, 551.0849, 563.4945, 565.0329, 574.9254,
        604.9211, 682.6122, 682.6122, 682.6122, 682.6122, 682.6122, 682.6122,
        682.6123, 682.6123, 682.6123, 682.6123, 682.6123, 682.6123],
       device='cuda:3')
used idx is  tensor([ 6,  0,  2,  7,  4,  3,  5,  1, 18, 16, 12, 14, 10,  8],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 86.56% 

Test Accuracy: 85.42% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8938363790512085
distance x is tensor(133.0651, device='cuda:3')
benign distance is  tensor(133.0651, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9426742792129517
distance x is tensor(143.2963, device='cuda:3')
benign distance is  tensor(143.2963, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.30213648080825806
distance x is tensor(132.5492, device='cuda:3')
benign distance is  tensor(132.5492, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4500087797641754
distance x is tensor(133.6247, device='cuda:3')
benign distance is  tensor(133.6247, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.503117024898529
distance x is tensor(143.0646, device='cuda:3')
benign distance is  tensor(143.0646, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3744489550590515
distance x is tensor(147.1825, device='cuda:3')
benign distance is  tensor(147.1825, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39278489351272583
distance x is tensor(137.6710, device='cuda:3')
benign distance is  tensor(137.6710, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6366666555404663
distance x is tensor(150.4197, device='cuda:3')
benign distance is  tensor(150.4197, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.2032, device='cuda:3')
compute distance is  tensor(144.2032, device='cuda:3')
compute norm is  tensor(62.1426, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0430, device='cuda:3')
compute distance is  tensor(131.0430, device='cuda:3')
compute norm is  tensor(61.9530, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1224, device='cuda:3')
compute distance is  tensor(143.1224, device='cuda:3')
compute norm is  tensor(62.1650, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1634, device='cuda:3')
compute distance is  tensor(137.1634, device='cuda:3')
compute norm is  tensor(61.9761, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1769, device='cuda:3')
compute distance is  tensor(137.1769, device='cuda:3')
compute norm is  tensor(62.1154, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1472, device='cuda:3')
compute distance is  tensor(134.1472, device='cuda:3')
compute norm is  tensor(62.1712, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6399, device='cuda:3')
compute distance is  tensor(130.6399, device='cuda:3')
compute norm is  tensor(61.9219, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7863, device='cuda:3')
compute distance is  tensor(129.7863, device='cuda:3')
compute norm is  tensor(61.9398, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.1421, device='cuda:3')
compute distance is  tensor(162.1421, device='cuda:3')
compute norm is  tensor(62.6056, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1279, device='cuda:3')
compute distance is  tensor(138.1279, device='cuda:3')
compute norm is  tensor(62.0623, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3714, device='cuda:3')
compute distance is  tensor(138.3714, device='cuda:3')
compute norm is  tensor(62.2231, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.7935, device='cuda:3')
compute distance is  tensor(141.7935, device='cuda:3')
compute norm is  tensor(62.1988, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.1421, device='cuda:3')
distance x is tensor(107462.4141, device='cuda:3')
distance x is tensor(107462.4141, device='cuda:3')
________________________________
test distance is  tensor(107462.4141, device='cuda:3')
test distance1 is  tensor(107462.4141, device='cuda:3')
test similarity is  tensor(0.6263, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130164618420590.81
test entropy is  0.0
________________________________
cal ratio is  0.038066737835708714
distance x is tensor(4090.7488, device='cuda:3')
cal_distance is  tensor(4090.7488, device='cuda:3')
cal ratio is  0.19510687030401327
distance x is tensor(798.1371, device='cuda:3')
cal_distance is  tensor(798.1371, device='cuda:3')
cal ratio is  0.4417079442149392
distance x is tensor(352.5463, device='cuda:3')
cal_distance is  tensor(352.5463, device='cuda:3')
cal ratio is  0.6646084635436724
distance x is tensor(234.3070, device='cuda:3')
cal_distance is  tensor(234.3070, device='cuda:3')
cal ratio is  0.8152322276826954
distance x is tensor(191.0155, device='cuda:3')
cal_distance is  tensor(191.0155, device='cuda:3')
cal ratio is  0.9028999287468475
distance x is tensor(172.4684, device='cuda:3')
cal_distance is  tensor(172.4684, device='cuda:3')
cal ratio is  0.9502091717704135
distance x is tensor(163.8813, device='cuda:3')
cal_distance is  tensor(163.8813, device='cuda:3')
cal ratio is  0.9747859520094815
distance x is tensor(159.7493, device='cuda:3')
cal_distance is  tensor(159.7493, device='cuda:3')
distance x is tensor(159.7493, device='cuda:3')
return_distance is  tensor(159.7493, device='cuda:3')
distance x is tensor(159.7393, device='cuda:3')
distance x is tensor(159.7393, device='cuda:3')
________________________________
test distance is  tensor(159.7393, device='cuda:3')
test distance1 is  tensor(159.7393, device='cuda:3')
test similarity is  tensor(0.9835, device='cuda:3')
test acc is  0.10956666682299862
test loss is 111.25986290384712
test entropy is  0.0056434283677305516
________________________________
0
distance x is tensor(159.7393, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0056286460481773425
avg test loss is  111.5405290518234
avg accuracy is  0.7773333334896598
solo acc is  0.10915000015633196
compute similarity  is  tensor(0.9835, device='cuda:3')
compute_distance is  tensor(159.7393, device='cuda:3')
compute_norm is  tensor(67.1772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3508.7075, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5490843989193313
avg test loss is  2.882061824615576
avg accuracy is  0.1026833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1160, device='cuda:3')
compute_distance is  tensor(3508.7075, device='cuda:3')
compute_norm is  tensor(345.7286, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3493.0178, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8390005855545052
avg test loss is  3.6487706424330852
avg accuracy is  0.1024333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1161, device='cuda:3')
compute_distance is  tensor(3493.0178, device='cuda:3')
compute_norm is  tensor(344.3035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3476.8567, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5533920478210774
avg test loss is  2.8708315185392337
avg accuracy is  0.10261666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1159, device='cuda:3')
compute_distance is  tensor(3476.8567, device='cuda:3')
compute_norm is  tensor(342.4513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3461.3516, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8420348177586537
avg test loss is  3.630351876907511
avg accuracy is  0.10260000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1160, device='cuda:3')
compute_distance is  tensor(3461.3516, device='cuda:3')
compute_norm is  tensor(341.0667, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3445.4148, device='cuda:3')
distance x is tensor(3445.4148, device='cuda:3')
________________________________
test distance is  tensor(3445.4148, device='cuda:3')
test distance1 is  tensor(3445.4148, device='cuda:3')
test similarity is  tensor(0.1159, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8658438216902806
test entropy is  1.5572348725058631
________________________________
cal ratio is  0.21259507352480636
distance x is tensor(732.4768, device='cuda:3')
cal_distance is  tensor(732.4768, device='cuda:3')
cal ratio is  0.461080781760097
distance x is tensor(337.7304, device='cuda:3')
cal_distance is  tensor(337.7304, device='cuda:3')
cal ratio is  0.6790299004086597
distance x is tensor(229.3286, device='cuda:3')
cal_distance is  tensor(229.3286, device='cuda:3')
cal ratio is  0.8240333961234058
distance x is tensor(188.9742, device='cuda:3')
cal_distance is  tensor(188.9742, device='cuda:3')
cal ratio is  0.9077633743782206
distance x is tensor(171.5438, device='cuda:3')
cal_distance is  tensor(171.5438, device='cuda:3')
cal ratio is  0.9527664875845081
distance x is tensor(163.4411, device='cuda:3')
cal_distance is  tensor(163.4411, device='cuda:3')
cal ratio is  0.976097778500078
distance x is tensor(159.5345, device='cuda:3')
cal_distance is  tensor(159.5345, device='cuda:3')
distance x is tensor(159.5345, device='cuda:3')
return_distance is  tensor(159.5345, device='cuda:3')
distance x is tensor(159.5369, device='cuda:3')
distance x is tensor(159.5369, device='cuda:3')
________________________________
test distance is  tensor(159.5369, device='cuda:3')
test distance1 is  tensor(159.5369, device='cuda:3')
test similarity is  tensor(0.9605, device='cuda:3')
test acc is  0.13205000015633192
test loss is 209.2745915394602
test entropy is  0.33799432403147855
________________________________
0
distance x is tensor(159.5369, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.33753033132473037
avg test loss is  209.270009656959
avg accuracy is  0.37491666682300745
solo acc is  0.13213333348966524
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(159.5369, device='cuda:3')
compute_norm is  tensor(63.1791, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1986.8271, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.334407649187645
avg test loss is  2.331876561585774
avg accuracy is  0.10545000015633196
solo acc is  0.11308333348966527
compute similarity  is  tensor(0.1466, device='cuda:3')
compute_distance is  tensor(1986.8271, device='cuda:3')
compute_norm is  tensor(232.5552, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1978.3259, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8054809645294889
avg test loss is  3.076178145052782
avg accuracy is  0.1023833334896653
solo acc is  0.1002333334896653
compute similarity  is  tensor(0.1466, device='cuda:3')
compute_distance is  tensor(1978.3259, device='cuda:3')
compute_norm is  tensor(231.6432, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1969.6313, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2510674744526715
avg test loss is  2.220707231874405
avg accuracy is  0.11490000015633194
solo acc is  0.1114666668229986
compute similarity  is  tensor(0.1465, device='cuda:3')
compute_distance is  tensor(1969.6313, device='cuda:3')
compute_norm is  tensor(230.4761, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1961.2386, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7768043261219952
avg test loss is  2.9358798916151785
avg accuracy is  0.10555000015633195
solo acc is  0.10030000015633199
compute similarity  is  tensor(0.1466, device='cuda:3')
compute_distance is  tensor(1961.2386, device='cuda:3')
compute_norm is  tensor(229.5764, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1952.7382, device='cuda:3')
distance x is tensor(1952.7382, device='cuda:3')
________________________________
test distance is  tensor(1952.7382, device='cuda:3')
test distance1 is  tensor(1952.7382, device='cuda:3')
test similarity is  tensor(0.1465, device='cuda:3')
test acc is  0.12000000015633193
test loss is 2.1277116586658744
test entropy is  1.2125029561362033
________________________________
cal ratio is  0.282391717374326
distance x is tensor(551.4344, device='cuda:3')
cal_distance is  tensor(551.4344, device='cuda:3')
cal ratio is  0.5314067098160739
distance x is tensor(293.0350, device='cuda:3')
cal_distance is  tensor(293.0350, device='cuda:3')
cal ratio is  0.7289776040955394
distance x is tensor(213.6154, device='cuda:3')
cal_distance is  tensor(213.6154, device='cuda:3')
cal ratio is  0.8538029605139051
distance x is tensor(182.3852, device='cuda:3')
cal_distance is  tensor(182.3852, device='cuda:3')
cal ratio is  0.9240153135959732
distance x is tensor(168.5266, device='cuda:3')
cal_distance is  tensor(168.5266, device='cuda:3')
cal ratio is  0.9612575590483812
distance x is tensor(161.9973, device='cuda:3')
cal_distance is  tensor(161.9973, device='cuda:3')
distance x is tensor(161.9973, device='cuda:3')
return_distance is  tensor(161.9973, device='cuda:3')
distance x is tensor(162.0014, device='cuda:3')
distance x is tensor(162.0014, device='cuda:3')
________________________________
test distance is  tensor(162.0014, device='cuda:3')
test distance1 is  tensor(162.0014, device='cuda:3')
test similarity is  tensor(0.9111, device='cuda:3')
test acc is  0.3160500001563398
test loss is 1.691008589160976
test entropy is  1.7342996596019151
________________________________
0
distance x is tensor(162.0014, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7343007338834977
avg test loss is  1.6874725649605935
avg accuracy is  0.5042666668230088
solo acc is  0.3162166668230065
compute similarity  is  tensor(0.9111, device='cuda:3')
compute_distance is  tensor(162.0014, device='cuda:3')
compute_norm is  tensor(66.0096, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.9919, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.680495969331595
avg test loss is  2.5147716383944188
avg accuracy is  0.4039166668230079
solo acc is  0.12223333348966525
compute similarity  is  tensor(0.9109, device='cuda:3')
compute_distance is  tensor(164.9919, device='cuda:3')
compute_norm is  tensor(65.8495, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.5621, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9553942558989088
avg test loss is  1.4373586421836413
avg accuracy is  0.5209000001563423
solo acc is  0.2858666668230059
compute similarity  is  tensor(0.9107, device='cuda:3')
compute_distance is  tensor(166.5621, device='cuda:3')
compute_norm is  tensor(65.4819, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(166.5581, device='cuda:3')
________________________________
test distance is  tensor(166.5581, device='cuda:3')
test similarity is  tensor(0.9107, device='cuda:3')
test acc is  0.5201166668230088
test loss is 1.433232696452883
test entropy is  0.9561308043470769
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.0675201416015625
mal norm is  tensor(1311.9297, device='cuda:3')
distance x is tensor(166.5581, device='cuda:3')
mal distance is  tensor(166.5581, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 544.7943,  579.0681,  535.4868,  538.8464,  576.0800,  589.5131,
         548.1004,  596.8504, 1311.9297, 1311.9297, 1311.9297, 1311.9297,
        1311.9297, 1311.9297, 1311.9297, 1311.9297, 1311.9297, 1311.9297,
        1311.9297, 1311.9297,  843.6451,  811.6550,  819.6746,  845.3328,
         801.0374,  844.0715,  853.6257,  825.2288,  577.4536,  639.7923,
         646.6339,  631.7165,  592.6581,  565.6458,  635.6340,  594.7181,
         636.4194,  647.1053,  580.7743,  637.1910,  601.3408,  608.2360,
         620.5193,  620.3998], device='cuda:3')
sorted_norm is   tensor([ 535.4868,  538.8464,  544.7943,  548.1004,  565.6458,  576.0800,
         577.4536,  579.0681,  580.7743,  589.5131,  592.6581,  594.7181,
         596.8504,  601.3408,  608.2360,  620.3998,  620.5193,  631.7165,
         635.6340,  636.4194,  637.1910,  639.7923,  646.6339,  647.1053,
         801.0374,  811.6550,  819.6746,  825.2288,  843.6451,  844.0715,
         845.3328,  853.6257, 1311.9297, 1311.9297, 1311.9297, 1311.9297,
        1311.9297, 1311.9297, 1311.9297, 1311.9297, 1311.9297, 1311.9297,
        1311.9297, 1311.9297], device='cuda:3')
used idx is  tensor([ 2,  3,  0,  6, 33,  4, 28,  1, 38,  5, 32, 35,  7, 40, 41, 43, 42, 31,
        34, 36, 39, 29, 30, 37, 24, 21, 22, 27, 20, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.48% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3759048581123352
distance x is tensor(110.3690, device='cuda:3')
benign distance is  tensor(110.3690, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5759258270263672
distance x is tensor(134.1943, device='cuda:3')
benign distance is  tensor(134.1943, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25196418166160583
distance x is tensor(128.6408, device='cuda:3')
benign distance is  tensor(128.6408, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6626311540603638
distance x is tensor(125.8700, device='cuda:3')
benign distance is  tensor(125.8700, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8314152956008911
distance x is tensor(123.4026, device='cuda:3')
benign distance is  tensor(123.4026, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7735994458198547
distance x is tensor(142.9572, device='cuda:3')
benign distance is  tensor(142.9572, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.404975563287735
distance x is tensor(118.8308, device='cuda:3')
benign distance is  tensor(118.8308, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7380346059799194
distance x is tensor(124.3864, device='cuda:3')
benign distance is  tensor(124.3864, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4561144709587097
distance x is tensor(130.6162, device='cuda:3')
benign distance is  tensor(130.6162, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.37978610396385193
distance x is tensor(136.0350, device='cuda:3')
benign distance is  tensor(136.0350, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6874235272407532
distance x is tensor(117.8592, device='cuda:3')
benign distance is  tensor(117.8592, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7271668910980225
distance x is tensor(120.7758, device='cuda:3')
benign distance is  tensor(120.7758, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2382926046848297
distance x is tensor(120.8427, device='cuda:3')
benign distance is  tensor(120.8427, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.46799129247665405
distance x is tensor(123.1749, device='cuda:3')
benign distance is  tensor(123.1749, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7436939477920532
distance x is tensor(128.1524, device='cuda:3')
benign distance is  tensor(128.1524, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4201117157936096
distance x is tensor(119.4192, device='cuda:3')
benign distance is  tensor(119.4192, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3217082619667053
distance x is tensor(119.2330, device='cuda:3')
benign distance is  tensor(119.2330, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5691708326339722
distance x is tensor(131.0111, device='cuda:3')
benign distance is  tensor(131.0111, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6680005788803101
distance x is tensor(141.7204, device='cuda:3')
benign distance is  tensor(141.7204, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2866135537624359
distance x is tensor(136.8511, device='cuda:3')
benign distance is  tensor(136.8511, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.32242584228515625
distance x is tensor(135.8629, device='cuda:3')
benign distance is  tensor(135.8629, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.494201123714447
distance x is tensor(117.5798, device='cuda:3')
benign distance is  tensor(117.5798, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.22498802840709686
distance x is tensor(124.9557, device='cuda:3')
benign distance is  tensor(124.9557, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4841232895851135
distance x is tensor(122.0447, device='cuda:3')
benign distance is  tensor(122.0447, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.48030537366867065
distance x is tensor(122.9027, device='cuda:3')
benign distance is  tensor(122.9027, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.1773609220981598
distance x is tensor(136.1524, device='cuda:3')
benign distance is  tensor(136.1524, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.4089437425136566
distance x is tensor(127.2189, device='cuda:3')
benign distance is  tensor(127.2189, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.17098349332809448
distance x is tensor(136.4713, device='cuda:3')
benign distance is  tensor(136.4713, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4272173047065735
distance x is tensor(118.7902, device='cuda:3')
benign distance is  tensor(118.7902, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8633076548576355
distance x is tensor(121.5294, device='cuda:3')
benign distance is  tensor(121.5294, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5154021382331848
distance x is tensor(131.7582, device='cuda:3')
benign distance is  tensor(131.7582, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5303662419319153
distance x is tensor(120.1824, device='cuda:3')
benign distance is  tensor(120.1824, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(127.9538, device='cuda:3')
compute distance is  tensor(127.9538, device='cuda:3')
compute norm is  tensor(59.7560, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5941, device='cuda:3')
compute distance is  tensor(118.5941, device='cuda:3')
compute norm is  tensor(59.6538, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9125, device='cuda:3')
compute distance is  tensor(131.9125, device='cuda:3')
compute norm is  tensor(60.1566, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6893, device='cuda:3')
compute distance is  tensor(129.6893, device='cuda:3')
compute norm is  tensor(59.9934, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9599, device='cuda:3')
compute distance is  tensor(123.9599, device='cuda:3')
compute norm is  tensor(59.9143, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2414, device='cuda:3')
compute distance is  tensor(123.2414, device='cuda:3')
compute norm is  tensor(60.0076, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8598, device='cuda:3')
compute distance is  tensor(121.8598, device='cuda:3')
compute norm is  tensor(59.8997, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.6748, device='cuda:3')
compute distance is  tensor(116.6748, device='cuda:3')
compute norm is  tensor(59.7184, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.2200, device='cuda:3')
compute distance is  tensor(136.2200, device='cuda:3')
compute norm is  tensor(59.9462, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1114, device='cuda:3')
compute distance is  tensor(115.1114, device='cuda:3')
compute norm is  tensor(59.8073, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3881, device='cuda:3')
compute distance is  tensor(127.3881, device='cuda:3')
compute norm is  tensor(59.9898, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.3192, device='cuda:3')
compute distance is  tensor(121.3192, device='cuda:3')
compute norm is  tensor(59.9217, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.2200, device='cuda:3')
distance x is tensor(107512.2734, device='cuda:3')
distance x is tensor(107512.2734, device='cuda:3')
________________________________
test distance is  tensor(107512.2734, device='cuda:3')
test distance1 is  tensor(107512.2734, device='cuda:3')
test similarity is  tensor(0.5661, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130003494008853.83
test entropy is  0.0
________________________________
cal ratio is  0.034883292784647024
distance x is tensor(3750.3877, device='cuda:3')
cal_distance is  tensor(3750.3877, device='cuda:3')
cal ratio is  0.186770550864503
distance x is tensor(700.4661, device='cuda:3')
cal_distance is  tensor(700.4661, device='cuda:3')
cal ratio is  0.43216832760413093
distance x is tensor(302.7221, device='cuda:3')
cal_distance is  tensor(302.7221, device='cuda:3')
cal ratio is  0.6573920035780845
distance x is tensor(199.0088, device='cuda:3')
cal_distance is  tensor(199.0088, device='cuda:3')
cal ratio is  0.8107936470464582
distance x is tensor(161.3560, device='cuda:3')
cal_distance is  tensor(161.3560, device='cuda:3')
cal ratio is  0.9004381551845421
distance x is tensor(145.2916, device='cuda:3')
cal_distance is  tensor(145.2916, device='cuda:3')
cal ratio is  0.9489125614468298
distance x is tensor(137.8693, device='cuda:3')
cal_distance is  tensor(137.8693, device='cuda:3')
cal ratio is  0.9741204587271779
distance x is tensor(134.3014, device='cuda:3')
cal_distance is  tensor(134.3014, device='cuda:3')
distance x is tensor(134.3014, device='cuda:3')
return_distance is  tensor(134.3014, device='cuda:3')
distance x is tensor(134.2915, device='cuda:3')
distance x is tensor(134.2915, device='cuda:3')
________________________________
test distance is  tensor(134.2915, device='cuda:3')
test distance1 is  tensor(134.2915, device='cuda:3')
test similarity is  tensor(0.9846, device='cuda:3')
test acc is  0.4165000001563413
test loss is 17.023080934085318
test entropy is  0.07946103941728629
________________________________
0
distance x is tensor(134.2915, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.08063074612398265
avg test loss is  16.86338656492579
avg accuracy is  0.8736333334896557
solo acc is  0.41881666682300794
compute similarity  is  tensor(0.9846, device='cuda:3')
compute_distance is  tensor(134.2915, device='cuda:3')
compute_norm is  tensor(63.6383, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.0462, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9165118615637456
avg test loss is  1.3366099308802883
avg accuracy is  0.8497500001563232
solo acc is  0.3403000001563403
compute similarity  is  tensor(0.9837, device='cuda:3')
compute_distance is  tensor(135.0462, device='cuda:3')
compute_norm is  tensor(63.0806, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.6329, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8754221901202253
avg test loss is  1.4192165784490134
avg accuracy is  0.8503166668229899
solo acc is  0.27948333348967236
compute similarity  is  tensor(0.9835, device='cuda:3')
compute_distance is  tensor(135.6329, device='cuda:3')
compute_norm is  tensor(62.7585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.9792, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8568627959502532
avg test loss is  1.4119540249615081
avg accuracy is  0.8507833334896566
solo acc is  0.27033333348967215
compute similarity  is  tensor(0.9832, device='cuda:3')
compute_distance is  tensor(135.9792, device='cuda:3')
compute_norm is  tensor(62.4449, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.2315, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8586424206619832
avg test loss is  1.3805568574079827
avg accuracy is  0.8545666668229898
solo acc is  0.2703166668230055
compute similarity  is  tensor(0.9830, device='cuda:3')
compute_distance is  tensor(136.2315, device='cuda:3')
compute_norm is  tensor(62.1345, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.5378, device='cuda:3')
distance x is tensor(136.5378, device='cuda:3')
________________________________
test distance is  tensor(136.5378, device='cuda:3')
test distance1 is  tensor(136.5378, device='cuda:3')
test similarity is  tensor(0.9828, device='cuda:3')
test acc is  0.2617666668230053
test loss is 1.3752214034228945
test entropy is  0.8472878265101264
________________________________
cal ratio is  0.9788588597425114
distance x is tensor(133.6600, device='cuda:3')
cal_distance is  tensor(133.6600, device='cuda:3')
distance x is tensor(133.6600, device='cuda:3')
return_distance is  tensor(133.6600, device='cuda:3')
distance x is tensor(133.6511, device='cuda:3')
distance x is tensor(133.6511, device='cuda:3')
________________________________
test distance is  tensor(133.6511, device='cuda:3')
test distance1 is  tensor(133.6511, device='cuda:3')
test similarity is  tensor(0.9835, device='cuda:3')
test acc is  0.30703333348967304
test loss is 1.2912414000868035
test entropy is  0.8752353293682212
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 0.9200137257575989
mal norm is  tensor(637.0924, device='cuda:3')
distance x is tensor(133.6600, device='cuda:3')
mal distance is  tensor(133.6600, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([466.6212, 556.0195, 522.9688, 513.8478, 502.5112, 587.8267, 483.9478,
        518.9432, 637.0924, 637.0924, 637.0924, 637.0924, 637.0924, 637.0924,
        637.0924, 637.0924, 637.0924, 637.0924, 637.0924, 637.0924],
       device='cuda:3')
sorted_norm is   tensor([466.6212, 483.9478, 502.5112, 513.8478, 518.9432, 522.9688, 556.0195,
        587.8267, 637.0924, 637.0924, 637.0924, 637.0924, 637.0924, 637.0924,
        637.0924, 637.0924, 637.0924, 637.0924, 637.0924, 637.0924],
       device='cuda:3')
used idx is  tensor([ 0,  6,  4,  3,  7,  2,  1,  5, 19, 18, 16, 17, 13, 12],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.25% 

Test Accuracy: 87.34% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2366526573896408
distance x is tensor(129.9453, device='cuda:3')
benign distance is  tensor(129.9453, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.20574931800365448
distance x is tensor(133.6445, device='cuda:3')
benign distance is  tensor(133.6445, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2618161737918854
distance x is tensor(124.4562, device='cuda:3')
benign distance is  tensor(124.4562, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5535515546798706
distance x is tensor(131.9536, device='cuda:3')
benign distance is  tensor(131.9536, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5325003862380981
distance x is tensor(122.9281, device='cuda:3')
benign distance is  tensor(122.9281, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0040403604507446
distance x is tensor(137.3310, device='cuda:3')
benign distance is  tensor(137.3310, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8940609693527222
distance x is tensor(152.5481, device='cuda:3')
benign distance is  tensor(152.5481, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5869556069374084
distance x is tensor(138.3077, device='cuda:3')
benign distance is  tensor(138.3077, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(132.8145, device='cuda:3')
compute distance is  tensor(132.8145, device='cuda:3')
compute norm is  tensor(61.7110, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.3970, device='cuda:3')
compute distance is  tensor(121.3970, device='cuda:3')
compute norm is  tensor(61.5608, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5543, device='cuda:3')
compute distance is  tensor(139.5543, device='cuda:3')
compute norm is  tensor(61.9118, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5160, device='cuda:3')
compute distance is  tensor(137.5160, device='cuda:3')
compute norm is  tensor(62.1352, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5301, device='cuda:3')
compute distance is  tensor(136.5301, device='cuda:3')
compute norm is  tensor(62.0171, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2805, device='cuda:3')
compute distance is  tensor(140.2805, device='cuda:3')
compute norm is  tensor(62.1803, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5026, device='cuda:3')
compute distance is  tensor(129.5026, device='cuda:3')
compute norm is  tensor(61.9055, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.2093, device='cuda:3')
compute distance is  tensor(127.2093, device='cuda:3')
compute norm is  tensor(61.7640, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2092, device='cuda:3')
compute distance is  tensor(140.2092, device='cuda:3')
compute norm is  tensor(61.9164, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9060, device='cuda:3')
compute distance is  tensor(131.9060, device='cuda:3')
compute norm is  tensor(61.8462, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.7083, device='cuda:3')
compute distance is  tensor(145.7083, device='cuda:3')
compute norm is  tensor(62.0735, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6267, device='cuda:3')
compute distance is  tensor(130.6267, device='cuda:3')
compute norm is  tensor(61.9054, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.7083, device='cuda:3')
distance x is tensor(107470.3438, device='cuda:3')
distance x is tensor(107470.3438, device='cuda:3')
________________________________
test distance is  tensor(107470.3438, device='cuda:3')
test distance1 is  tensor(107470.3438, device='cuda:3')
test similarity is  tensor(0.6185, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130098785403054.67
test entropy is  0.0
________________________________
cal ratio is  0.036084760617538965
distance x is tensor(3878.0471, device='cuda:3')
cal_distance is  tensor(3878.0471, device='cuda:3')
cal ratio is  0.18995976068225137
distance x is tensor(736.6769, device='cuda:3')
cal_distance is  tensor(736.6769, device='cuda:3')
cal ratio is  0.4358425511902812
distance x is tensor(321.0780, device='cuda:3')
cal_distance is  tensor(321.0780, device='cuda:3')
cal ratio is  0.6601808091691046
distance x is tensor(211.9712, device='cuda:3')
cal_distance is  tensor(211.9712, device='cuda:3')
cal ratio is  0.8125118518551813
distance x is tensor(172.2301, device='cuda:3')
cal_distance is  tensor(172.2301, device='cuda:3')
cal ratio is  0.901391925006946
distance x is tensor(155.2473, device='cuda:3')
cal_distance is  tensor(155.2473, device='cuda:3')
cal ratio is  0.9494150663965785
distance x is tensor(147.3944, device='cuda:3')
cal_distance is  tensor(147.3944, device='cuda:3')
cal ratio is  0.9743784328055212
distance x is tensor(143.6180, device='cuda:3')
cal_distance is  tensor(143.6180, device='cuda:3')
distance x is tensor(143.6180, device='cuda:3')
return_distance is  tensor(143.6180, device='cuda:3')
distance x is tensor(143.6080, device='cuda:3')
distance x is tensor(143.6080, device='cuda:3')
________________________________
test distance is  tensor(143.6080, device='cuda:3')
test distance1 is  tensor(143.6080, device='cuda:3')
test similarity is  tensor(0.9859, device='cuda:3')
test acc is  0.1053333334896653
test loss is 91.47024562160598
test entropy is  0.003202946116932644
________________________________
0
distance x is tensor(143.6080, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0036933385950449747
avg test loss is  91.704688407719
avg accuracy is  0.7424666668229949
solo acc is  0.10490000015633197
compute similarity  is  tensor(0.9859, device='cuda:3')
compute_distance is  tensor(143.6080, device='cuda:3')
compute_norm is  tensor(66.2086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(465.5395, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2881224018170128
avg test loss is  2.262750993278235
avg accuracy is  0.2135500001563369
solo acc is  0.1290000001563319
compute similarity  is  tensor(0.6417, device='cuda:3')
compute_distance is  tensor(465.5395, device='cuda:3')
compute_norm is  tensor(104.5415, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(463.6735, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7329781388423082
avg test loss is  3.0339228659550517
avg accuracy is  0.15400000015633356
solo acc is  0.10070000015633197
compute similarity  is  tensor(0.6417, device='cuda:3')
compute_distance is  tensor(463.6735, device='cuda:3')
compute_norm is  tensor(104.1797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(461.9415, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.274482412633103
avg test loss is  2.224952389309401
avg accuracy is  0.21588333348967037
solo acc is  0.1178166668229986
compute similarity  is  tensor(0.6416, device='cuda:3')
compute_distance is  tensor(461.9415, device='cuda:3')
compute_norm is  tensor(103.6349, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(460.0764, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7238279312912589
avg test loss is  2.938372011632045
avg accuracy is  0.15913333348966724
solo acc is  0.10030000015633199
compute similarity  is  tensor(0.6417, device='cuda:3')
compute_distance is  tensor(460.0764, device='cuda:3')
compute_norm is  tensor(103.2707, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(458.5774, device='cuda:3')
distance x is tensor(458.5774, device='cuda:3')
________________________________
test distance is  tensor(458.5774, device='cuda:3')
test distance1 is  tensor(458.5774, device='cuda:3')
test similarity is  tensor(0.6416, device='cuda:3')
test acc is  0.12270000015633192
test loss is 2.1280713335537453
test entropy is  1.2383917934858977
________________________________
cal ratio is  0.5524104095874679
distance x is tensor(253.3247, device='cuda:3')
cal_distance is  tensor(253.3247, device='cuda:3')
cal ratio is  0.7432405599635541
distance x is tensor(188.2814, device='cuda:3')
cal_distance is  tensor(188.2814, device='cuda:3')
cal ratio is  0.8621133634460308
distance x is tensor(162.3201, device='cuda:3')
cal_distance is  tensor(162.3201, device='cuda:3')
cal ratio is  0.9285001084343555
distance x is tensor(150.7143, device='cuda:3')
cal_distance is  tensor(150.7143, device='cuda:3')
cal ratio is  0.9635868914876453
distance x is tensor(145.2264, device='cuda:3')
cal_distance is  tensor(145.2264, device='cuda:3')
distance x is tensor(145.2264, device='cuda:3')
return_distance is  tensor(145.2264, device='cuda:3')
distance x is tensor(145.2241, device='cuda:3')
distance x is tensor(145.2241, device='cuda:3')
________________________________
test distance is  tensor(145.2241, device='cuda:3')
test distance1 is  tensor(145.2241, device='cuda:3')
test similarity is  tensor(0.9274, device='cuda:3')
test acc is  0.29083333348967266
test loss is 1.7556116465312332
test entropy is  1.5829591135988865
________________________________
0
distance x is tensor(145.2241, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5837666856200456
avg test loss is  1.7572082673817047
avg accuracy is  0.4430000001563416
solo acc is  0.29085000015633933
compute similarity  is  tensor(0.9274, device='cuda:3')
compute_distance is  tensor(145.2241, device='cuda:3')
compute_norm is  tensor(68.4595, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(146.4739, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7168924162891119
avg test loss is  2.6381859237959646
avg accuracy is  0.3161666668230065
solo acc is  0.10883333348966528
compute similarity  is  tensor(0.9273, device='cuda:3')
compute_distance is  tensor(146.4739, device='cuda:3')
compute_norm is  tensor(68.2643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.1401, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0213769010262195
avg test loss is  1.57331966489617
avg accuracy is  0.49485000015634206
solo acc is  0.27473333348967227
compute similarity  is  tensor(0.9274, device='cuda:3')
compute_distance is  tensor(147.1401, device='cuda:3')
compute_norm is  tensor(67.9368, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(147.7184, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6434400748532972
avg test loss is  2.4092356491444717
avg accuracy is  0.3612666668230073
solo acc is  0.10845000015633195
compute similarity  is  tensor(0.9272, device='cuda:3')
compute_distance is  tensor(147.7184, device='cuda:3')
compute_norm is  tensor(67.6796, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.8530, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9945833277600661
avg test loss is  1.495037955261751
avg accuracy is  0.5211833334896756
solo acc is  0.2570833334896718
compute similarity  is  tensor(0.9271, device='cuda:3')
compute_distance is  tensor(148.8530, device='cuda:3')
compute_norm is  tensor(67.3341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(148.8530, device='cuda:3')
distance x is tensor(148.8530, device='cuda:3')
________________________________
test distance is  tensor(148.8530, device='cuda:3')
test distance1 is  tensor(148.8530, device='cuda:3')
test similarity is  tensor(0.9271, device='cuda:3')
test acc is  0.2599333334896719
test loss is 1.4936956763267517
test entropy is  0.9932933272456309
________________________________
cal ratio is  0.969592661533365
distance x is tensor(144.3286, device='cuda:3')
cal_distance is  tensor(144.3286, device='cuda:3')
distance x is tensor(144.3286, device='cuda:3')
return_distance is  tensor(144.3286, device='cuda:3')
distance x is tensor(144.3268, device='cuda:3')
distance x is tensor(144.3268, device='cuda:3')
________________________________
test distance is  tensor(144.3268, device='cuda:3')
test distance1 is  tensor(144.3268, device='cuda:3')
test similarity is  tensor(0.9310, device='cuda:3')
test acc is  0.27510000015633895
test loss is 1.459516974908711
test entropy is  1.0179698110135125
________________________________
0
distance x is tensor(144.3268, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.018428114431499
avg test loss is  1.4663530239926728
avg accuracy is  0.5317500001563423
solo acc is  0.2747500001563389
compute similarity  is  tensor(0.9310, device='cuda:3')
compute_distance is  tensor(144.3268, device='cuda:3')
compute_norm is  tensor(66.9781, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(145.0624, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6103188597889089
avg test loss is  2.329244453896846
avg accuracy is  0.39993333348967436
solo acc is  0.10666666682299862
compute similarity  is  tensor(0.9307, device='cuda:3')
compute_distance is  tensor(145.0624, device='cuda:3')
compute_norm is  tensor(66.7236, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.1693, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9816955710524944
avg test loss is  1.4738592790133918
avg accuracy is  0.5382833334896756
solo acc is  0.2301833334896709
compute similarity  is  tensor(0.9306, device='cuda:3')
compute_distance is  tensor(146.1693, device='cuda:3')
compute_norm is  tensor(66.3835, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(146.1707, device='cuda:3')
________________________________
test distance is  tensor(146.1707, device='cuda:3')
test similarity is  tensor(0.9306, device='cuda:3')
test acc is  0.5428500001563423
test loss is 1.4804347237544273
test entropy is  0.9835896340768728
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.214430332183838
mal norm is  tensor(1162.1315, device='cuda:3')
distance x is tensor(146.1707, device='cuda:3')
mal distance is  tensor(146.1707, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 30
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 542.2372,  544.5104,  518.4001,  527.7827,  500.8840,  553.5818,
         603.9358,  570.8020, 1162.1315, 1162.1315, 1162.1315, 1162.1315,
        1162.1315, 1162.1315, 1162.1315, 1162.1315, 1162.1315, 1162.1315,
        1162.1315, 1162.1315,  597.7159,  617.6560,  590.1410,  600.9822,
         595.9828,  628.4325,  590.9854,  588.7980,  624.3389,  605.1138,
         631.6169,  645.0588,  586.2841,  636.7382,  620.5701,  598.6015,
         626.2551,  622.4872,  575.7975,  581.2100,  593.4610,  590.5434,
         605.8221,  578.7786], device='cuda:3')
sorted_norm is   tensor([ 500.8840,  518.4001,  527.7827,  542.2372,  544.5104,  553.5818,
         570.8020,  575.7975,  578.7786,  581.2100,  586.2841,  588.7980,
         590.1410,  590.5434,  590.9854,  593.4610,  595.9828,  597.7159,
         598.6015,  600.9822,  603.9358,  605.1138,  605.8221,  617.6560,
         620.5701,  622.4872,  624.3389,  626.2551,  628.4325,  631.6169,
         636.7382,  645.0588, 1162.1315, 1162.1315, 1162.1315, 1162.1315,
        1162.1315, 1162.1315, 1162.1315, 1162.1315, 1162.1315, 1162.1315,
        1162.1315, 1162.1315], device='cuda:3')
used idx is  tensor([ 4,  2,  3,  0,  1,  5,  7, 38, 43, 39, 32, 27, 22, 41, 26, 40, 24, 20,
        35, 23,  6, 29, 42, 21, 34, 37, 28, 36, 25, 30], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 87.70% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2755250930786133
distance x is tensor(129.9643, device='cuda:3')
benign distance is  tensor(129.9643, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1665198802947998
distance x is tensor(122.6259, device='cuda:3')
benign distance is  tensor(122.6259, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21551081538200378
distance x is tensor(120.1859, device='cuda:3')
benign distance is  tensor(120.1859, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42937859892845154
distance x is tensor(129.4276, device='cuda:3')
benign distance is  tensor(129.4276, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8366056680679321
distance x is tensor(126.1646, device='cuda:3')
benign distance is  tensor(126.1646, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7667622566223145
distance x is tensor(134.7391, device='cuda:3')
benign distance is  tensor(134.7391, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8538455963134766
distance x is tensor(135.3392, device='cuda:3')
benign distance is  tensor(135.3392, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7941396832466125
distance x is tensor(122.8692, device='cuda:3')
benign distance is  tensor(122.8692, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.29877030849456787
distance x is tensor(127.0769, device='cuda:3')
benign distance is  tensor(127.0769, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.251149445772171
distance x is tensor(133.8827, device='cuda:3')
benign distance is  tensor(133.8827, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5150882005691528
distance x is tensor(111.3254, device='cuda:3')
benign distance is  tensor(111.3254, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.21152183413505554
distance x is tensor(120.9062, device='cuda:3')
benign distance is  tensor(120.9062, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.583609938621521
distance x is tensor(126.0153, device='cuda:3')
benign distance is  tensor(126.0153, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2586556375026703
distance x is tensor(135.1066, device='cuda:3')
benign distance is  tensor(135.1066, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2935422956943512
distance x is tensor(116.5435, device='cuda:3')
benign distance is  tensor(116.5435, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2453068047761917
distance x is tensor(123.4313, device='cuda:3')
benign distance is  tensor(123.4313, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5712701082229614
distance x is tensor(138.5688, device='cuda:3')
benign distance is  tensor(138.5688, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6524189114570618
distance x is tensor(119.5519, device='cuda:3')
benign distance is  tensor(119.5519, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.44936075806617737
distance x is tensor(140.7338, device='cuda:3')
benign distance is  tensor(140.7338, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.666879415512085
distance x is tensor(130.0931, device='cuda:3')
benign distance is  tensor(130.0931, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8093186616897583
distance x is tensor(126.6184, device='cuda:3')
benign distance is  tensor(126.6184, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3447587490081787
distance x is tensor(127.7504, device='cuda:3')
benign distance is  tensor(127.7504, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6400419473648071
distance x is tensor(122.4769, device='cuda:3')
benign distance is  tensor(122.4769, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.34684237837791443
distance x is tensor(112.6591, device='cuda:3')
benign distance is  tensor(112.6591, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3126513361930847
distance x is tensor(133.0027, device='cuda:3')
benign distance is  tensor(133.0027, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1947512924671173
distance x is tensor(128.5125, device='cuda:3')
benign distance is  tensor(128.5125, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.29970139265060425
distance x is tensor(132.2541, device='cuda:3')
benign distance is  tensor(132.2541, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.10304279625415802
distance x is tensor(121.1783, device='cuda:3')
benign distance is  tensor(121.1783, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8484426736831665
distance x is tensor(125.6059, device='cuda:3')
benign distance is  tensor(125.6059, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5550194978713989
distance x is tensor(119.8628, device='cuda:3')
benign distance is  tensor(119.8628, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6188430190086365
distance x is tensor(130.0922, device='cuda:3')
benign distance is  tensor(130.0922, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3789341449737549
distance x is tensor(127.3655, device='cuda:3')
benign distance is  tensor(127.3655, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.8853, device='cuda:3')
compute distance is  tensor(118.8853, device='cuda:3')
compute norm is  tensor(60.8555, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2127, device='cuda:3')
compute distance is  tensor(130.2127, device='cuda:3')
compute norm is  tensor(60.9310, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6438, device='cuda:3')
compute distance is  tensor(127.6438, device='cuda:3')
compute norm is  tensor(60.8961, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2006, device='cuda:3')
compute distance is  tensor(132.2006, device='cuda:3')
compute norm is  tensor(61.0883, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3765, device='cuda:3')
compute distance is  tensor(130.3765, device='cuda:3')
compute norm is  tensor(61.0734, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6173, device='cuda:3')
compute distance is  tensor(125.6173, device='cuda:3')
compute norm is  tensor(61.1965, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3959, device='cuda:3')
compute distance is  tensor(123.3959, device='cuda:3')
compute norm is  tensor(60.8708, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9484, device='cuda:3')
compute distance is  tensor(123.9484, device='cuda:3')
compute norm is  tensor(60.8697, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9171, device='cuda:3')
compute distance is  tensor(131.9171, device='cuda:3')
compute norm is  tensor(61.0243, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5305, device='cuda:3')
compute distance is  tensor(128.5305, device='cuda:3')
compute norm is  tensor(61.1260, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5697, device='cuda:3')
compute distance is  tensor(136.5697, device='cuda:3')
compute norm is  tensor(61.2175, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7540, device='cuda:3')
compute distance is  tensor(123.7540, device='cuda:3')
compute norm is  tensor(61.1231, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.5697, device='cuda:3')
distance x is tensor(107506.9375, device='cuda:3')
distance x is tensor(107506.9375, device='cuda:3')
________________________________
test distance is  tensor(107506.9375, device='cuda:3')
test distance1 is  tensor(107506.9375, device='cuda:3')
test similarity is  tensor(0.5716, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130095713249764.7
test entropy is  0.0
________________________________
cal ratio is  0.03492891353256511
distance x is tensor(3755.1057, device='cuda:3')
cal_distance is  tensor(3755.1057, device='cuda:3')
cal ratio is  0.18689265891353254
distance x is tensor(701.8058, device='cuda:3')
cal_distance is  tensor(701.8058, device='cuda:3')
cal ratio is  0.43230957134656184
distance x is tensor(303.4002, device='cuda:3')
cal_distance is  tensor(303.4002, device='cuda:3')
cal ratio is  0.6574994706652145
distance x is tensor(199.4872, device='cuda:3')
cal_distance is  tensor(199.4872, device='cuda:3')
cal ratio is  0.8108598697674443
distance x is tensor(161.7571, device='cuda:3')
cal_distance is  tensor(161.7571, device='cuda:3')
cal ratio is  0.9004749001076682
distance x is tensor(145.6587, device='cuda:3')
cal_distance is  tensor(145.6587, device='cuda:3')
cal ratio is  0.9489319259634614
distance x is tensor(138.2205, device='cuda:3')
cal_distance is  tensor(138.2205, device='cuda:3')
cal ratio is  0.9741303899809984
distance x is tensor(134.6449, device='cuda:3')
cal_distance is  tensor(134.6449, device='cuda:3')
distance x is tensor(134.6449, device='cuda:3')
return_distance is  tensor(134.6449, device='cuda:3')
distance x is tensor(134.6349, device='cuda:3')
distance x is tensor(134.6349, device='cuda:3')
________________________________
test distance is  tensor(134.6349, device='cuda:3')
test distance1 is  tensor(134.6349, device='cuda:3')
test similarity is  tensor(0.9852, device='cuda:3')
test acc is  0.3980166668230078
test loss is 19.200043968046142
test entropy is  0.07734915726919418
________________________________
0
distance x is tensor(134.6349, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07787110206625386
avg test loss is  19.367373008972038
avg accuracy is  0.8803666668229887
solo acc is  0.39635000015634103
compute similarity  is  tensor(0.9852, device='cuda:3')
compute_distance is  tensor(134.6349, device='cuda:3')
compute_norm is  tensor(64.7295, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.2064, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9340169361786548
avg test loss is  1.3511437660595502
avg accuracy is  0.8431500001563236
solo acc is  0.3312166668230068
compute similarity  is  tensor(0.9845, device='cuda:3')
compute_distance is  tensor(136.2064, device='cuda:3')
compute_norm is  tensor(64.2202, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.7652, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.889382448913192
avg test loss is  1.4269255525521887
avg accuracy is  0.8416500001563237
solo acc is  0.2770166668230057
compute similarity  is  tensor(0.9842, device='cuda:3')
compute_distance is  tensor(136.7652, device='cuda:3')
compute_norm is  tensor(63.8923, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.9886, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8650241009970464
avg test loss is  1.4099362881453052
avg accuracy is  0.8444333334896568
solo acc is  0.2700000001563388
compute similarity  is  tensor(0.9840, device='cuda:3')
compute_distance is  tensor(136.9886, device='cuda:3')
compute_norm is  tensor(63.5729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.1726, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8635341440563771
avg test loss is  1.4016240465361427
avg accuracy is  0.8474833334896567
solo acc is  0.2603333334896719
compute similarity  is  tensor(0.9838, device='cuda:3')
compute_distance is  tensor(137.1726, device='cuda:3')
compute_norm is  tensor(63.2571, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.3832, device='cuda:3')
distance x is tensor(137.3832, device='cuda:3')
________________________________
test distance is  tensor(137.3832, device='cuda:3')
test distance1 is  tensor(137.3832, device='cuda:3')
test similarity is  tensor(0.9836, device='cuda:3')
test acc is  0.2616000001563386
test loss is 1.3835335607721861
test entropy is  0.8540884910234764
________________________________
cal ratio is  0.9770943409693494
distance x is tensor(134.2452, device='cuda:3')
cal_distance is  tensor(134.2452, device='cuda:3')
distance x is tensor(134.2452, device='cuda:3')
return_distance is  tensor(134.2452, device='cuda:3')
distance x is tensor(134.2363, device='cuda:3')
distance x is tensor(134.2363, device='cuda:3')
________________________________
test distance is  tensor(134.2363, device='cuda:3')
test distance1 is  tensor(134.2363, device='cuda:3')
test similarity is  tensor(0.9843, device='cuda:3')
test acc is  0.30460000015633965
test loss is 1.2983812841016855
test entropy is  0.8879616447349092
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.1046364307403564
mal norm is  tensor(635.5881, device='cuda:3')
distance x is tensor(134.2452, device='cuda:3')
mal distance is  tensor(134.2452, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([535.9872, 507.6532, 496.8067, 532.3934, 522.5235, 547.2422, 557.2203,
        515.9838, 635.5881, 635.5881, 635.5881, 635.5881, 635.5881, 635.5881,
        635.5881, 635.5881, 635.5881, 635.5881, 635.5881, 635.5881, 505.7817,
        569.6104, 587.7842, 573.5642, 567.1454, 503.3433, 536.2653, 526.5215],
       device='cuda:3')
sorted_norm is   tensor([496.8067, 503.3433, 505.7817, 507.6532, 515.9838, 522.5235, 526.5215,
        532.3934, 535.9872, 536.2653, 547.2422, 557.2203, 567.1454, 569.6104,
        573.5642, 587.7842, 635.5881, 635.5881, 635.5881, 635.5881, 635.5881,
        635.5881, 635.5881, 635.5881, 635.5881, 635.5881, 635.5881, 635.5881],
       device='cuda:3')
used idx is  tensor([ 2, 25, 20,  1,  7,  4, 27,  3,  0, 26,  5,  6, 24, 21, 23, 22, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.78% 

Test Accuracy: 87.51% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49930477142333984
distance x is tensor(123.1531, device='cuda:3')
benign distance is  tensor(123.1531, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5641804337501526
distance x is tensor(136.8922, device='cuda:3')
benign distance is  tensor(136.8922, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.30972564220428467
distance x is tensor(120.4001, device='cuda:3')
benign distance is  tensor(120.4001, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42285436391830444
distance x is tensor(129.4387, device='cuda:3')
benign distance is  tensor(129.4387, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5448289513587952
distance x is tensor(114.2466, device='cuda:3')
benign distance is  tensor(114.2466, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3188297748565674
distance x is tensor(122.8411, device='cuda:3')
benign distance is  tensor(122.8411, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6895632743835449
distance x is tensor(124.6850, device='cuda:3')
benign distance is  tensor(124.6850, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5319873094558716
distance x is tensor(137.7764, device='cuda:3')
benign distance is  tensor(137.7764, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3314718008041382
distance x is tensor(116.2356, device='cuda:3')
benign distance is  tensor(116.2356, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6153619885444641
distance x is tensor(131.6035, device='cuda:3')
benign distance is  tensor(131.6035, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3071269094944
distance x is tensor(134.4395, device='cuda:3')
benign distance is  tensor(134.4395, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2491658478975296
distance x is tensor(129.7427, device='cuda:3')
benign distance is  tensor(129.7427, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2508273720741272
distance x is tensor(126.9248, device='cuda:3')
benign distance is  tensor(126.9248, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4025703966617584
distance x is tensor(110.2527, device='cuda:3')
benign distance is  tensor(110.2527, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2833276391029358
distance x is tensor(137.3107, device='cuda:3')
benign distance is  tensor(137.3107, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5092299580574036
distance x is tensor(117.4163, device='cuda:3')
benign distance is  tensor(117.4163, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(120.1925, device='cuda:3')
compute distance is  tensor(120.1925, device='cuda:3')
compute norm is  tensor(61.3814, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.9263, device='cuda:3')
compute distance is  tensor(115.9263, device='cuda:3')
compute norm is  tensor(61.3251, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7983, device='cuda:3')
compute distance is  tensor(129.7983, device='cuda:3')
compute norm is  tensor(61.7221, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5464, device='cuda:3')
compute distance is  tensor(134.5464, device='cuda:3')
compute norm is  tensor(61.7102, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.1155, device='cuda:3')
compute distance is  tensor(147.1155, device='cuda:3')
compute norm is  tensor(61.8849, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7868, device='cuda:3')
compute distance is  tensor(127.7868, device='cuda:3')
compute norm is  tensor(61.8274, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5318, device='cuda:3')
compute distance is  tensor(119.5318, device='cuda:3')
compute norm is  tensor(61.4221, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.8751, device='cuda:3')
compute distance is  tensor(115.8751, device='cuda:3')
compute norm is  tensor(61.3570, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3690, device='cuda:3')
compute distance is  tensor(132.3690, device='cuda:3')
compute norm is  tensor(61.4932, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.1730, device='cuda:3')
compute distance is  tensor(120.1730, device='cuda:3')
compute norm is  tensor(61.4869, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4165, device='cuda:3')
compute distance is  tensor(132.4165, device='cuda:3')
compute norm is  tensor(61.7376, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0320, device='cuda:3')
compute distance is  tensor(126.0320, device='cuda:3')
compute norm is  tensor(61.5096, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.1155, device='cuda:3')
distance x is tensor(107500.6406, device='cuda:3')
distance x is tensor(107500.6406, device='cuda:3')
________________________________
test distance is  tensor(107500.6406, device='cuda:3')
test distance1 is  tensor(107500.6406, device='cuda:3')
test similarity is  tensor(0.5791, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130140746525960.19
test entropy is  0.0
________________________________
cal ratio is  0.036253489585077285
distance x is tensor(3897.2791, device='cuda:3')
cal_distance is  tensor(3897.2791, device='cuda:3')
cal ratio is  0.19040335673299158
distance x is tensor(742.0590, device='cuda:3')
cal_distance is  tensor(742.0590, device='cuda:3')
cal ratio is  0.43635115426265914
distance x is tensor(323.8011, device='cuda:3')
cal_distance is  tensor(323.8011, device='cuda:3')
cal ratio is  0.6605659495103106
distance x is tensor(213.8937, device='cuda:3')
cal_distance is  tensor(213.8937, device='cuda:3')
cal ratio is  0.8127488228605458
distance x is tensor(173.8428, device='cuda:3')
cal_distance is  tensor(173.8428, device='cuda:3')
cal ratio is  0.9015233422540505
distance x is tensor(156.7239, device='cuda:3')
cal_distance is  tensor(156.7239, device='cuda:3')
cal ratio is  0.9494843118555747
distance x is tensor(148.8071, device='cuda:3')
cal_distance is  tensor(148.8071, device='cuda:3')
cal ratio is  0.9744140343863917
distance x is tensor(144.9999, device='cuda:3')
cal_distance is  tensor(144.9999, device='cuda:3')
distance x is tensor(144.9999, device='cuda:3')
return_distance is  tensor(144.9999, device='cuda:3')
distance x is tensor(144.9899, device='cuda:3')
distance x is tensor(144.9899, device='cuda:3')
________________________________
test distance is  tensor(144.9899, device='cuda:3')
test distance1 is  tensor(144.9899, device='cuda:3')
test similarity is  tensor(0.9838, device='cuda:3')
test acc is  0.17931666682300193
test loss is 49.103355497185355
test entropy is  0.02777147052888034
________________________________
0
distance x is tensor(144.9899, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.027603914189222666
avg test loss is  49.45715513819062
avg accuracy is  0.8626500001563228
solo acc is  0.17933333348966857
compute similarity  is  tensor(0.9838, device='cuda:3')
compute_distance is  tensor(144.9899, device='cuda:3')
compute_norm is  tensor(65.8460, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.6246, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9654996874871284
avg test loss is  1.4104164714243874
avg accuracy is  0.779866666822993
solo acc is  0.31146666682300644
compute similarity  is  tensor(0.9837, device='cuda:3')
compute_distance is  tensor(145.6246, device='cuda:3')
compute_norm is  tensor(65.6584, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(145.6246, device='cuda:3')
distance x is tensor(145.6246, device='cuda:3')
________________________________
test distance is  tensor(145.6246, device='cuda:3')
test distance1 is  tensor(145.6246, device='cuda:3')
test similarity is  tensor(0.9837, device='cuda:3')
test acc is  0.3098666668230064
test loss is 1.4083885442473487
test entropy is  0.9679909424105687
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3899047374725342
mal norm is  tensor(727.8324, device='cuda:3')
distance x is tensor(145.6339, device='cuda:3')
mal distance is  tensor(145.6339, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([511.5023, 565.7909, 503.6671, 532.8559, 475.1854, 510.1678, 502.2886,
        571.5999, 727.8324, 727.8324, 727.8324, 727.8324, 727.8324, 727.8324,
        727.8324, 727.8324, 727.8324, 727.8324, 727.8324, 727.8324, 551.6861,
        567.9576, 480.5955, 525.9511, 547.9287, 566.9158, 507.6327, 531.3110],
       device='cuda:3')
sorted_norm is   tensor([475.1854, 480.5955, 502.2886, 503.6671, 507.6327, 510.1678, 511.5023,
        525.9511, 531.3110, 532.8559, 547.9287, 551.6861, 565.7909, 566.9158,
        567.9576, 571.5999, 727.8324, 727.8324, 727.8324, 727.8324, 727.8324,
        727.8324, 727.8324, 727.8324, 727.8324, 727.8324, 727.8324, 727.8324],
       device='cuda:3')
used idx is  tensor([ 4, 22,  6,  2, 26,  5,  0, 23, 27,  3, 24, 20,  1, 25, 21,  7, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.48% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.26751798391342163
distance x is tensor(116.6381, device='cuda:3')
benign distance is  tensor(116.6381, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5100301504135132
distance x is tensor(148.1419, device='cuda:3')
benign distance is  tensor(148.1419, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4989112913608551
distance x is tensor(116.7529, device='cuda:3')
benign distance is  tensor(116.7529, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.101954460144043
distance x is tensor(132.7107, device='cuda:3')
benign distance is  tensor(132.7107, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4750238358974457
distance x is tensor(129.3948, device='cuda:3')
benign distance is  tensor(129.3948, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2519126236438751
distance x is tensor(146.7452, device='cuda:3')
benign distance is  tensor(146.7452, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5329468846321106
distance x is tensor(135.8579, device='cuda:3')
benign distance is  tensor(135.8579, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.795042872428894
distance x is tensor(121.8212, device='cuda:3')
benign distance is  tensor(121.8212, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4952871799468994
distance x is tensor(123.5641, device='cuda:3')
benign distance is  tensor(123.5641, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.37026163935661316
distance x is tensor(135.4512, device='cuda:3')
benign distance is  tensor(135.4512, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8649294972419739
distance x is tensor(124.0874, device='cuda:3')
benign distance is  tensor(124.0874, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4308876097202301
distance x is tensor(126.8235, device='cuda:3')
benign distance is  tensor(126.8235, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6249149441719055
distance x is tensor(119.7334, device='cuda:3')
benign distance is  tensor(119.7334, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23922455310821533
distance x is tensor(134.6390, device='cuda:3')
benign distance is  tensor(134.6390, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5941588282585144
distance x is tensor(119.8288, device='cuda:3')
benign distance is  tensor(119.8288, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4539203643798828
distance x is tensor(132.4118, device='cuda:3')
benign distance is  tensor(132.4118, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(124.7382, device='cuda:3')
compute distance is  tensor(124.7382, device='cuda:3')
compute norm is  tensor(62.4924, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.7909, device='cuda:3')
compute distance is  tensor(117.7909, device='cuda:3')
compute norm is  tensor(62.3444, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.4432, device='cuda:3')
compute distance is  tensor(133.4432, device='cuda:3')
compute norm is  tensor(62.8592, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9627, device='cuda:3')
compute distance is  tensor(119.9627, device='cuda:3')
compute norm is  tensor(62.5037, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6859, device='cuda:3')
compute distance is  tensor(138.6859, device='cuda:3')
compute norm is  tensor(62.9268, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1314, device='cuda:3')
compute distance is  tensor(125.1314, device='cuda:3')
compute norm is  tensor(62.7924, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1731, device='cuda:3')
compute distance is  tensor(137.1731, device='cuda:3')
compute norm is  tensor(63.1441, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.6548, device='cuda:3')
compute distance is  tensor(120.6548, device='cuda:3')
compute norm is  tensor(62.5777, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.4718, device='cuda:3')
compute distance is  tensor(135.4718, device='cuda:3')
compute norm is  tensor(62.7527, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6986, device='cuda:3')
compute distance is  tensor(129.6986, device='cuda:3')
compute norm is  tensor(62.7634, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1064, device='cuda:3')
compute distance is  tensor(130.1064, device='cuda:3')
compute norm is  tensor(62.7454, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3641, device='cuda:3')
compute distance is  tensor(122.3641, device='cuda:3')
compute norm is  tensor(62.6885, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.6859, device='cuda:3')
distance x is tensor(107492.7656, device='cuda:3')
distance x is tensor(107492.7656, device='cuda:3')
________________________________
test distance is  tensor(107492.7656, device='cuda:3')
test distance1 is  tensor(107492.7656, device='cuda:3')
test similarity is  tensor(0.5868, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130095765647263.94
test entropy is  0.0
________________________________
cal ratio is  0.03520080089974188
distance x is tensor(3783.8374, device='cuda:3')
cal_distance is  tensor(3783.8374, device='cuda:3')
cal ratio is  0.18761861364174837
distance x is tensor(709.9223, device='cuda:3')
cal_distance is  tensor(709.9223, device='cuda:3')
cal ratio is  0.43314843451555995
distance x is tensor(307.5046, device='cuda:3')
cal_distance is  tensor(307.5046, device='cuda:3')
cal ratio is  0.6581370768385415
distance x is tensor(202.3819, device='cuda:3')
cal_distance is  tensor(202.3819, device='cuda:3')
cal ratio is  0.8112530705022086
distance x is tensor(164.1839, device='cuda:3')
cal_distance is  tensor(164.1839, device='cuda:3')
cal ratio is  0.9006932090486753
distance x is tensor(147.8798, device='cuda:3')
cal_distance is  tensor(147.8798, device='cuda:3')
cal ratio is  0.9490468984131053
distance x is tensor(140.3452, device='cuda:3')
cal_distance is  tensor(140.3452, device='cuda:3')
cal ratio is  0.9741895052903345
distance x is tensor(136.7229, device='cuda:3')
cal_distance is  tensor(136.7229, device='cuda:3')
distance x is tensor(136.7229, device='cuda:3')
return_distance is  tensor(136.7229, device='cuda:3')
distance x is tensor(136.7129, device='cuda:3')
distance x is tensor(136.7129, device='cuda:3')
________________________________
test distance is  tensor(136.7129, device='cuda:3')
test distance1 is  tensor(136.7129, device='cuda:3')
test similarity is  tensor(0.9862, device='cuda:3')
test acc is  0.36685000015634067
test loss is 19.08758383874954
test entropy is  0.07729842861308091
________________________________
0
distance x is tensor(136.7129, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07733237818340218
avg test loss is  19.03806228881706
avg accuracy is  0.8780000001563222
solo acc is  0.36555000015634076
compute similarity  is  tensor(0.9862, device='cuda:3')
compute_distance is  tensor(136.7129, device='cuda:3')
compute_norm is  tensor(66.6934, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.8552, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9301284979909722
avg test loss is  1.3804225883504222
avg accuracy is  0.815483333489658
solo acc is  0.32318333348967326
compute similarity  is  tensor(0.9857, device='cuda:3')
compute_distance is  tensor(136.8552, device='cuda:3')
compute_norm is  tensor(66.2326, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.3332, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8748900738479232
avg test loss is  1.4606242986884452
avg accuracy is  0.8087833334896583
solo acc is  0.26911666682300556
compute similarity  is  tensor(0.9855, device='cuda:3')
compute_distance is  tensor(137.3332, device='cuda:3')
compute_norm is  tensor(65.8971, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.4769, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8669250676753932
avg test loss is  1.4397918293471021
avg accuracy is  0.8127000001563248
solo acc is  0.26041666682300524
compute similarity  is  tensor(0.9853, device='cuda:3')
compute_distance is  tensor(137.4769, device='cuda:3')
compute_norm is  tensor(65.5665, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.5559, device='cuda:3')
exit early
distance x is tensor(137.5559, device='cuda:3')
distance x is tensor(137.5559, device='cuda:3')
________________________________
test distance is  tensor(137.5559, device='cuda:3')
test distance1 is  tensor(137.5559, device='cuda:3')
test similarity is  tensor(0.9852, device='cuda:3')
test acc is  0.24515000015633812
test loss is 1.4406200001743048
test entropy is  0.859455041793872
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.352125883102417
mal norm is  tensor(662.6330, device='cuda:3')
distance x is tensor(137.5648, device='cuda:3')
mal distance is  tensor(137.5648, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([494.5456, 590.6813, 493.0392, 547.7870, 522.2971, 603.7244, 539.2498,
        515.4210, 662.6330, 662.6330, 662.6330, 662.6330, 662.6330, 662.6330,
        662.6330, 662.6330, 662.6330, 662.6330, 662.6330, 662.6330],
       device='cuda:3')
sorted_norm is   tensor([493.0392, 494.5456, 515.4210, 522.2971, 539.2498, 547.7870, 590.6813,
        603.7244, 662.6330, 662.6330, 662.6330, 662.6330, 662.6330, 662.6330,
        662.6330, 662.6330, 662.6330, 662.6330, 662.6330, 662.6330],
       device='cuda:3')
used idx is  tensor([ 2,  0,  7,  4,  6,  3,  1,  5, 19, 18, 16, 17, 13, 12],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 87.24% 

Test Accuracy: 86.24% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5837613344192505
distance x is tensor(133.6016, device='cuda:3')
benign distance is  tensor(133.6016, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8278958201408386
distance x is tensor(120.4961, device='cuda:3')
benign distance is  tensor(120.4961, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08741799741983414
distance x is tensor(143.2005, device='cuda:3')
benign distance is  tensor(143.2005, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40290147066116333
distance x is tensor(128.4141, device='cuda:3')
benign distance is  tensor(128.4141, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3408566415309906
distance x is tensor(133.9387, device='cuda:3')
benign distance is  tensor(133.9387, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.37216055393219
distance x is tensor(150.8735, device='cuda:3')
benign distance is  tensor(150.8735, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9732722043991089
distance x is tensor(130.5202, device='cuda:3')
benign distance is  tensor(130.5202, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2924771308898926
distance x is tensor(138.8870, device='cuda:3')
benign distance is  tensor(138.8870, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(136.1910, device='cuda:3')
compute distance is  tensor(136.1910, device='cuda:3')
compute norm is  tensor(64.8925, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1614, device='cuda:3')
compute distance is  tensor(141.1614, device='cuda:3')
compute norm is  tensor(65.1639, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.8774, device='cuda:3')
compute distance is  tensor(144.8774, device='cuda:3')
compute norm is  tensor(65.0108, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7873, device='cuda:3')
compute distance is  tensor(136.7873, device='cuda:3')
compute norm is  tensor(64.9569, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1208, device='cuda:3')
compute distance is  tensor(138.1208, device='cuda:3')
compute norm is  tensor(65.0058, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.4495, device='cuda:3')
compute distance is  tensor(141.4495, device='cuda:3')
compute norm is  tensor(65.1924, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0615, device='cuda:3')
compute distance is  tensor(124.0615, device='cuda:3')
compute norm is  tensor(64.5930, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5149, device='cuda:3')
compute distance is  tensor(135.5149, device='cuda:3')
compute norm is  tensor(64.9255, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2362, device='cuda:3')
compute distance is  tensor(151.2362, device='cuda:3')
compute norm is  tensor(64.8575, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3311, device='cuda:3')
compute distance is  tensor(132.3311, device='cuda:3')
compute norm is  tensor(64.9000, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9553, device='cuda:3')
compute distance is  tensor(126.9553, device='cuda:3')
compute norm is  tensor(64.7155, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5607, device='cuda:3')
compute distance is  tensor(130.5607, device='cuda:3')
compute norm is  tensor(64.7979, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.2362, device='cuda:3')
distance x is tensor(107450.8438, device='cuda:3')
distance x is tensor(107450.8438, device='cuda:3')
________________________________
test distance is  tensor(107450.8438, device='cuda:3')
test distance1 is  tensor(107450.8438, device='cuda:3')
test similarity is  tensor(0.6351, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130025650209571.48
test entropy is  0.0
________________________________
cal ratio is  0.036766227926613076
distance x is tensor(3950.5679, device='cuda:3')
cal_distance is  tensor(3950.5679, device='cuda:3')
cal ratio is  0.19174507935755533
distance x is tensor(757.5059, device='cuda:3')
cal_distance is  tensor(757.5059, device='cuda:3')
cal ratio is  0.4378859200679982
distance x is tensor(331.7040, device='cuda:3')
cal_distance is  tensor(331.7040, device='cuda:3')
cal ratio is  0.6617266434127771
distance x is tensor(219.4991, device='cuda:3')
cal_distance is  tensor(219.4991, device='cuda:3')
cal ratio is  0.8134626995027396
distance x is tensor(178.5553, device='cuda:3')
cal_distance is  tensor(178.5553, device='cuda:3')
cal ratio is  0.9019192245146007
distance x is tensor(161.0429, device='cuda:3')
cal_distance is  tensor(161.0429, device='cuda:3')
cal ratio is  0.9496928919506994
distance x is tensor(152.9416, device='cuda:3')
cal_distance is  tensor(152.9416, device='cuda:3')
cal ratio is  0.9745210075482375
distance x is tensor(149.0449, device='cuda:3')
cal_distance is  tensor(149.0449, device='cuda:3')
distance x is tensor(149.0449, device='cuda:3')
return_distance is  tensor(149.0449, device='cuda:3')
distance x is tensor(149.0349, device='cuda:3')
distance x is tensor(149.0349, device='cuda:3')
________________________________
test distance is  tensor(149.0349, device='cuda:3')
test distance1 is  tensor(149.0349, device='cuda:3')
test similarity is  tensor(0.9869, device='cuda:3')
test acc is  0.10793333348966529
test loss is 92.18480128062559
test entropy is  0.005482892591793401
________________________________
0
distance x is tensor(149.0349, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.005536431676298759
avg test loss is  92.48786928709636
avg accuracy is  0.7739666668229933
solo acc is  0.10758333348966528
compute similarity  is  tensor(0.9869, device='cuda:3')
compute_distance is  tensor(149.0349, device='cuda:3')
compute_norm is  tensor(69.6728, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2969.3025, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.550169346683315
avg test loss is  2.885132034704375
avg accuracy is  0.10356666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1470, device='cuda:3')
compute_distance is  tensor(2969.3025, device='cuda:3')
compute_norm is  tensor(306.6863, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2956.2075, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.830453818795015
avg test loss is  3.6605131697298874
avg accuracy is  0.10281666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1471, device='cuda:3')
compute_distance is  tensor(2956.2075, device='cuda:3')
compute_norm is  tensor(305.4166, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2942.6672, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.551169340544418
avg test loss is  2.876458255466876
avg accuracy is  0.10356666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1470, device='cuda:3')
compute_distance is  tensor(2942.6672, device='cuda:3')
compute_norm is  tensor(303.7669, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2929.7405, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8372460761939539
avg test loss is  3.63647971859873
avg accuracy is  0.10305000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1471, device='cuda:3')
compute_distance is  tensor(2929.7405, device='cuda:3')
compute_norm is  tensor(302.5341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2916.4104, device='cuda:3')
distance x is tensor(2916.4104, device='cuda:3')
________________________________
test distance is  tensor(2916.4104, device='cuda:3')
test distance1 is  tensor(2916.4104, device='cuda:3')
test similarity is  tensor(0.1469, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.871731360329748
test entropy is  1.5526026778383804
________________________________
cal ratio is  0.22316684286147337
distance x is tensor(650.8445, device='cuda:3')
cal_distance is  tensor(650.8445, device='cuda:3')
cal ratio is  0.4724059473579166
distance x is tensor(307.4622, device='cuda:3')
cal_distance is  tensor(307.4622, device='cuda:3')
cal ratio is  0.687318675170684
distance x is tensor(211.3241, device='cuda:3')
cal_distance is  tensor(211.3241, device='cuda:3')
cal ratio is  0.8290476195275733
distance x is tensor(175.1975, device='cuda:3')
cal_distance is  tensor(175.1975, device='cuda:3')
cal ratio is  0.9105210288105442
distance x is tensor(159.5209, device='cuda:3')
cal_distance is  tensor(159.5209, device='cuda:3')
cal ratio is  0.9542126199423258
distance x is tensor(152.2168, device='cuda:3')
cal_distance is  tensor(152.2168, device='cuda:3')
cal ratio is  0.9768382268709411
distance x is tensor(148.6912, device='cuda:3')
cal_distance is  tensor(148.6912, device='cuda:3')
distance x is tensor(148.6912, device='cuda:3')
return_distance is  tensor(148.6912, device='cuda:3')
distance x is tensor(148.6937, device='cuda:3')
distance x is tensor(148.6937, device='cuda:3')
________________________________
test distance is  tensor(148.6937, device='cuda:3')
test distance1 is  tensor(148.6937, device='cuda:3')
test similarity is  tensor(0.9661, device='cuda:3')
test acc is  0.1712833334896681
test loss is 67.44472665929082
test entropy is  0.5362099423083161
________________________________
0
distance x is tensor(148.6937, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.5371680668453926
avg test loss is  67.34551512305416
avg accuracy is  0.6169000001563362
solo acc is  0.17063333348966808
compute similarity  is  tensor(0.9661, device='cuda:3')
compute_distance is  tensor(148.6937, device='cuda:3')
compute_norm is  tensor(65.8594, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(727.7686, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.243536136297783
avg test loss is  2.1486336626986198
avg accuracy is  0.1574333334896671
solo acc is  0.1314000001563319
compute similarity  is  tensor(0.3796, device='cuda:3')
compute_distance is  tensor(727.7686, device='cuda:3')
compute_norm is  tensor(133.1264, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(725.5656, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.748220094676211
avg test loss is  2.8740406173632853
avg accuracy is  0.12706666682299858
solo acc is  0.1020833334896653
compute similarity  is  tensor(0.3797, device='cuda:3')
compute_distance is  tensor(725.5656, device='cuda:3')
compute_norm is  tensor(132.6374, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(723.5374, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1764129231225198
avg test loss is  2.0805316990626648
avg accuracy is  0.1586500001563338
solo acc is  0.13211666682299858
compute similarity  is  tensor(0.3795, device='cuda:3')
compute_distance is  tensor(723.5374, device='cuda:3')
compute_norm is  tensor(131.9637, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(721.3481, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7183615852520664
avg test loss is  2.824902074423426
avg accuracy is  0.12756666682299858
solo acc is  0.1012833334896653
compute similarity  is  tensor(0.3796, device='cuda:3')
compute_distance is  tensor(721.3481, device='cuda:3')
compute_norm is  tensor(131.4571, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(719.4642, device='cuda:3')
distance x is tensor(719.4642, device='cuda:3')
________________________________
test distance is  tensor(719.4642, device='cuda:3')
test distance1 is  tensor(719.4642, device='cuda:3')
test similarity is  tensor(0.3794, device='cuda:3')
test acc is  0.15316666682300006
test loss is 1.9742601642222293
test entropy is  1.1842094155262783
________________________________
cal ratio is  0.44931341573627465
distance x is tensor(323.2620, device='cuda:3')
cal_distance is  tensor(323.2620, device='cuda:3')
cal ratio is  0.6703114955867898
distance x is tensor(216.6856, device='cuda:3')
cal_distance is  tensor(216.6856, device='cuda:3')
cal ratio is  0.8187267052197601
distance x is tensor(177.4059, device='cuda:3')
cal_distance is  tensor(177.4059, device='cuda:3')
cal ratio is  0.9048360693369607
distance x is tensor(160.5231, device='cuda:3')
cal_distance is  tensor(160.5231, device='cuda:3')
cal ratio is  0.9512292762559167
distance x is tensor(152.6942, device='cuda:3')
cal_distance is  tensor(152.6942, device='cuda:3')
cal ratio is  0.9753100785014835
distance x is tensor(148.9241, device='cuda:3')
cal_distance is  tensor(148.9241, device='cuda:3')
distance x is tensor(148.9241, device='cuda:3')
return_distance is  tensor(148.9241, device='cuda:3')
distance x is tensor(148.9281, device='cuda:3')
distance x is tensor(148.9281, device='cuda:3')
________________________________
test distance is  tensor(148.9281, device='cuda:3')
test distance1 is  tensor(148.9281, device='cuda:3')
test similarity is  tensor(0.9048, device='cuda:3')
test acc is  0.20556666682300326
test loss is 1.9365348979862513
test entropy is  1.6563802159417158
________________________________
0
distance x is tensor(148.9281, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6555169182799772
avg test loss is  1.9356672906163912
avg accuracy is  0.3869666668230077
solo acc is  0.2076000001563367
compute similarity  is  tensor(0.9048, device='cuda:3')
compute_distance is  tensor(148.9281, device='cuda:3')
compute_norm is  tensor(70.0612, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.3196, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6802234131771364
avg test loss is  2.490332330849125
avg accuracy is  0.33460000015634017
solo acc is  0.11828333348966527
compute similarity  is  tensor(0.9047, device='cuda:3')
compute_distance is  tensor(151.3196, device='cuda:3')
compute_norm is  tensor(69.8548, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.0822, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9611613946809952
avg test loss is  1.3960392495462381
avg accuracy is  0.4889666668230087
solo acc is  0.304383333489673
compute similarity  is  tensor(0.9046, device='cuda:3')
compute_distance is  tensor(153.0822, device='cuda:3')
compute_norm is  tensor(69.4945, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(153.0779, device='cuda:3')
________________________________
test distance is  tensor(153.0779, device='cuda:3')
test similarity is  tensor(0.9046, device='cuda:3')
test acc is  0.4906666668230087
test loss is 1.396951925462243
test entropy is  0.9608238327350698
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.1127337217330933
mal norm is  tensor(1437.8723, device='cuda:3')
distance x is tensor(153.0779, device='cuda:3')
mal distance is  tensor(153.0779, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 547.1464,  497.6551,  573.8427,  507.0877,  539.5024,  607.7136,
         525.1933,  560.5286, 1437.8723, 1437.8722, 1437.8723, 1437.8722,
        1437.8723, 1437.8722, 1437.8723, 1437.8722, 1437.8723, 1437.8722,
        1437.8723, 1437.8722,  697.0174,  740.9981,  720.9934,  746.6978,
         694.9058,  694.2726,  734.6667,  701.7863,  700.7415,  653.4236,
         712.4376,  676.6379,  670.5773,  682.3833,  668.9177,  640.7855,
         621.8693,  679.3398,  679.6172,  668.8302,  642.8400,  598.4798,
         681.4164,  621.9901,  606.4645,  645.8377,  593.9000,  601.0547,
         592.9327,  646.3494,  592.7147,  638.6841], device='cuda:3')
sorted_norm is   tensor([ 497.6551,  507.0877,  525.1933,  539.5024,  547.1464,  560.5286,
         573.8427,  592.7147,  592.9327,  593.9000,  598.4798,  601.0547,
         606.4645,  607.7136,  621.8693,  621.9901,  638.6841,  640.7855,
         642.8400,  645.8377,  646.3494,  653.4236,  668.8302,  668.9177,
         670.5773,  676.6379,  679.3398,  679.6172,  681.4164,  682.3833,
         694.2726,  694.9058,  697.0174,  700.7415,  701.7863,  712.4376,
         720.9934,  734.6667,  740.9981,  746.6978, 1437.8722, 1437.8722,
        1437.8722, 1437.8722, 1437.8722, 1437.8722, 1437.8723, 1437.8723,
        1437.8723, 1437.8723, 1437.8723, 1437.8723], device='cuda:3')
used idx is  tensor([ 1,  3,  6,  4,  0,  7,  2, 50, 48, 46, 41, 47, 44,  5, 36, 43, 51, 35,
        40, 45, 49, 29, 39, 34, 32, 31, 37, 38, 42, 33, 25, 24, 20, 28, 27, 30],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 87.95% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6099123358726501
distance x is tensor(124.7960, device='cuda:3')
benign distance is  tensor(124.7960, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6225709319114685
distance x is tensor(122.3269, device='cuda:3')
benign distance is  tensor(122.3269, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19388750195503235
distance x is tensor(126.5837, device='cuda:3')
benign distance is  tensor(126.5837, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5297551155090332
distance x is tensor(111.3870, device='cuda:3')
benign distance is  tensor(111.3870, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9723281860351562
distance x is tensor(119.2575, device='cuda:3')
benign distance is  tensor(119.2575, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7785863280296326
distance x is tensor(124.4141, device='cuda:3')
benign distance is  tensor(124.4141, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.30859076976776123
distance x is tensor(114.9560, device='cuda:3')
benign distance is  tensor(114.9560, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3719378411769867
distance x is tensor(118.2642, device='cuda:3')
benign distance is  tensor(118.2642, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6878988742828369
distance x is tensor(123.5300, device='cuda:3')
benign distance is  tensor(123.5300, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3668908178806305
distance x is tensor(126.8030, device='cuda:3')
benign distance is  tensor(126.8030, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5957093238830566
distance x is tensor(123.3974, device='cuda:3')
benign distance is  tensor(123.3974, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7145518660545349
distance x is tensor(135.7307, device='cuda:3')
benign distance is  tensor(135.7307, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.09781165421009064
distance x is tensor(117.4110, device='cuda:3')
benign distance is  tensor(117.4110, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1679879128932953
distance x is tensor(126.5699, device='cuda:3')
benign distance is  tensor(126.5699, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.41348347067832947
distance x is tensor(118.7985, device='cuda:3')
benign distance is  tensor(118.7985, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8333421945571899
distance x is tensor(123.2819, device='cuda:3')
benign distance is  tensor(123.2819, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.36415091156959534
distance x is tensor(116.8062, device='cuda:3')
benign distance is  tensor(116.8062, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.44778972864151
distance x is tensor(135.0465, device='cuda:3')
benign distance is  tensor(135.0465, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16316182911396027
distance x is tensor(122.1274, device='cuda:3')
benign distance is  tensor(122.1274, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2572154104709625
distance x is tensor(117.2498, device='cuda:3')
benign distance is  tensor(117.2498, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.7027392983436584
distance x is tensor(121.1542, device='cuda:3')
benign distance is  tensor(121.1542, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3209209144115448
distance x is tensor(118.2360, device='cuda:3')
benign distance is  tensor(118.2360, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5994400978088379
distance x is tensor(134.2594, device='cuda:3')
benign distance is  tensor(134.2594, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3863007724285126
distance x is tensor(125.0906, device='cuda:3')
benign distance is  tensor(125.0906, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17493173480033875
distance x is tensor(124.4298, device='cuda:3')
benign distance is  tensor(124.4298, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7484816908836365
distance x is tensor(116.8638, device='cuda:3')
benign distance is  tensor(116.8638, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5411471724510193
distance x is tensor(130.8382, device='cuda:3')
benign distance is  tensor(130.8382, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7116798162460327
distance x is tensor(122.9610, device='cuda:3')
benign distance is  tensor(122.9610, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9956651926040649
distance x is tensor(127.3280, device='cuda:3')
benign distance is  tensor(127.3280, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4582034945487976
distance x is tensor(125.6471, device='cuda:3')
benign distance is  tensor(125.6471, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.08255092054605484
distance x is tensor(126.9779, device='cuda:3')
benign distance is  tensor(126.9779, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5479938387870789
distance x is tensor(123.2867, device='cuda:3')
benign distance is  tensor(123.2867, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.157883420586586
distance x is tensor(127.6566, device='cuda:3')
benign distance is  tensor(127.6566, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8268551826477051
distance x is tensor(116.1016, device='cuda:3')
benign distance is  tensor(116.1016, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08065028488636017
distance x is tensor(121.5185, device='cuda:3')
benign distance is  tensor(121.5185, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.462662935256958
distance x is tensor(142.6506, device='cuda:3')
benign distance is  tensor(142.6506, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.1871858537197113
distance x is tensor(120.7098, device='cuda:3')
benign distance is  tensor(120.7098, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9705642461776733
distance x is tensor(125.5917, device='cuda:3')
benign distance is  tensor(125.5917, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.2980179190635681
distance x is tensor(132.4655, device='cuda:3')
benign distance is  tensor(132.4655, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.118861123919487
distance x is tensor(119.8508, device='cuda:3')
benign distance is  tensor(119.8508, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(116.9348, device='cuda:3')
compute distance is  tensor(116.9348, device='cuda:3')
compute norm is  tensor(62.6488, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.9495, device='cuda:3')
compute distance is  tensor(118.9495, device='cuda:3')
compute norm is  tensor(62.6555, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4752, device='cuda:3')
compute distance is  tensor(124.4752, device='cuda:3')
compute norm is  tensor(62.7737, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9953, device='cuda:3')
compute distance is  tensor(131.9953, device='cuda:3')
compute norm is  tensor(62.9133, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6615, device='cuda:3')
compute distance is  tensor(137.6615, device='cuda:3')
compute norm is  tensor(63.0323, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5023, device='cuda:3')
compute distance is  tensor(133.5023, device='cuda:3')
compute norm is  tensor(63.1330, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.1246, device='cuda:3')
compute distance is  tensor(113.1246, device='cuda:3')
compute norm is  tensor(62.5797, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.7806, device='cuda:3')
compute distance is  tensor(116.7806, device='cuda:3')
compute norm is  tensor(62.6200, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4783, device='cuda:3')
compute distance is  tensor(129.4783, device='cuda:3')
compute norm is  tensor(62.8940, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6966, device='cuda:3')
compute distance is  tensor(130.6966, device='cuda:3')
compute norm is  tensor(62.9090, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0952, device='cuda:3')
compute distance is  tensor(123.0952, device='cuda:3')
compute norm is  tensor(62.7884, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.8643, device='cuda:3')
compute distance is  tensor(110.8643, device='cuda:3')
compute norm is  tensor(62.6766, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.6615, device='cuda:3')
distance x is tensor(107502.7656, device='cuda:3')
distance x is tensor(107502.7656, device='cuda:3')
________________________________
test distance is  tensor(107502.7656, device='cuda:3')
test distance1 is  tensor(107502.7656, device='cuda:3')
test similarity is  tensor(0.5750, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130014159202788.7
test entropy is  0.0
________________________________
cal ratio is  0.03506892840070643
distance x is tensor(3770.0120, device='cuda:3')
cal_distance is  tensor(3770.0120, device='cuda:3')
cal ratio is  0.1872668735731481
distance x is tensor(706.0023, device='cuda:3')
cal_distance is  tensor(706.0023, device='cuda:3')
cal ratio is  0.432742203171449
distance x is tensor(305.5199, device='cuda:3')
cal_distance is  tensor(305.5199, device='cuda:3')
cal ratio is  0.6578283583933597
distance x is tensor(200.9813, device='cuda:3')
cal_distance is  tensor(200.9813, device='cuda:3')
cal ratio is  0.8110627402615153
distance x is tensor(163.0094, device='cuda:3')
cal_distance is  tensor(163.0094, device='cuda:3')
cal ratio is  0.9005876048529103
distance x is tensor(146.8048, device='cuda:3')
cal_distance is  tensor(146.8048, device='cuda:3')
cal ratio is  0.9489912537281264
distance x is tensor(139.3167, device='cuda:3')
cal_distance is  tensor(139.3167, device='cuda:3')
cal ratio is  0.974160829524676
distance x is tensor(135.7170, device='cuda:3')
cal_distance is  tensor(135.7170, device='cuda:3')
distance x is tensor(135.7170, device='cuda:3')
return_distance is  tensor(135.7170, device='cuda:3')
distance x is tensor(135.7070, device='cuda:3')
distance x is tensor(135.7070, device='cuda:3')
________________________________
test distance is  tensor(135.7070, device='cuda:3')
test distance1 is  tensor(135.7070, device='cuda:3')
test similarity is  tensor(0.9860, device='cuda:3')
test acc is  0.4220666668230081
test loss is 16.982777948318514
test entropy is  0.07606655875169265
________________________________
0
distance x is tensor(135.7070, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0751085723184351
avg test loss is  17.21094175696627
avg accuracy is  0.8850166668229885
solo acc is  0.4210833334896747
compute similarity  is  tensor(0.9860, device='cuda:3')
compute_distance is  tensor(135.7070, device='cuda:3')
compute_norm is  tensor(66.7375, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.4939, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9022320773301602
avg test loss is  1.367694067421244
avg accuracy is  0.8534333334896566
solo acc is  0.3318833334896734
compute similarity  is  tensor(0.9851, device='cuda:3')
compute_distance is  tensor(137.4939, device='cuda:3')
compute_norm is  tensor(66.1561, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.1351, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8875494094164387
avg test loss is  1.4136657942332693
avg accuracy is  0.8509666668229899
solo acc is  0.2810833334896725
compute similarity  is  tensor(0.9848, device='cuda:3')
compute_distance is  tensor(138.1351, device='cuda:3')
compute_norm is  tensor(65.8157, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.4773, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.859442777725171
avg test loss is  1.4259531669525196
avg accuracy is  0.8520500001563233
solo acc is  0.263933333489672
compute similarity  is  tensor(0.9846, device='cuda:3')
compute_distance is  tensor(138.4773, device='cuda:3')
compute_norm is  tensor(65.4865, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.6322, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8662350778894892
avg test loss is  1.3820604973637474
avg accuracy is  0.8558666668229896
solo acc is  0.26900000015633885
compute similarity  is  tensor(0.9844, device='cuda:3')
compute_distance is  tensor(138.6322, device='cuda:3')
compute_norm is  tensor(65.1624, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.8485, device='cuda:3')
distance x is tensor(138.8485, device='cuda:3')
________________________________
test distance is  tensor(138.8485, device='cuda:3')
test distance1 is  tensor(138.8485, device='cuda:3')
test similarity is  tensor(0.9843, device='cuda:3')
test acc is  0.25411666682300504
test loss is 1.3981310924741506
test entropy is  0.8409951576418968
________________________________
cal ratio is  0.9758021868619673
distance x is tensor(135.4973, device='cuda:3')
cal_distance is  tensor(135.4973, device='cuda:3')
distance x is tensor(135.4973, device='cuda:3')
return_distance is  tensor(135.4973, device='cuda:3')
distance x is tensor(135.4885, device='cuda:3')
distance x is tensor(135.4885, device='cuda:3')
________________________________
test distance is  tensor(135.4885, device='cuda:3')
test distance1 is  tensor(135.4885, device='cuda:3')
test similarity is  tensor(0.9849, device='cuda:3')
test acc is  0.31136666682300645
test loss is 1.2889427395898905
test entropy is  0.8791313445898515
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2372196912765503
mal norm is  tensor(640.9514, device='cuda:3')
distance x is tensor(135.4973, device='cuda:3')
mal distance is  tensor(135.4973, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([521.1398, 510.3807, 530.4024, 458.9231, 480.5389, 516.5915, 481.5717,
        493.5238, 640.9514, 640.9514, 640.9514, 640.9514, 640.9514, 640.9514,
        640.9514, 640.9514, 640.9514, 640.9514, 640.9514, 640.9514, 571.8332,
        561.1533, 576.0165, 529.5607, 541.2282, 513.4231, 533.0206, 546.6334],
       device='cuda:3')
sorted_norm is   tensor([458.9231, 480.5389, 481.5717, 493.5238, 510.3807, 513.4231, 516.5915,
        521.1398, 529.5607, 530.4024, 533.0206, 541.2282, 546.6334, 561.1533,
        571.8332, 576.0165, 640.9514, 640.9514, 640.9514, 640.9514, 640.9514,
        640.9514, 640.9514, 640.9514, 640.9514, 640.9514, 640.9514, 640.9514],
       device='cuda:3')
used idx is  tensor([ 3,  4,  6,  7,  1, 25,  5,  0, 23,  2, 26, 24, 27, 21, 20, 22, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.87% 

Test Accuracy: 87.96% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2132402658462524
distance x is tensor(132.0480, device='cuda:3')
benign distance is  tensor(132.0480, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7791784405708313
distance x is tensor(123.1563, device='cuda:3')
benign distance is  tensor(123.1563, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5238969326019287
distance x is tensor(118.3496, device='cuda:3')
benign distance is  tensor(118.3496, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9295377731323242
distance x is tensor(131.5517, device='cuda:3')
benign distance is  tensor(131.5517, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9626437425613403
distance x is tensor(101.4770, device='cuda:3')
benign distance is  tensor(101.4770, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2867432832717896
distance x is tensor(131.2116, device='cuda:3')
benign distance is  tensor(131.2116, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5805409550666809
distance x is tensor(119.6032, device='cuda:3')
benign distance is  tensor(119.6032, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.558613121509552
distance x is tensor(124.2407, device='cuda:3')
benign distance is  tensor(124.2407, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.42937031388282776
distance x is tensor(122.7438, device='cuda:3')
benign distance is  tensor(122.7438, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.27102428674697876
distance x is tensor(119.0143, device='cuda:3')
benign distance is  tensor(119.0143, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.36639803647994995
distance x is tensor(119.4977, device='cuda:3')
benign distance is  tensor(119.4977, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.41115623712539673
distance x is tensor(128.9549, device='cuda:3')
benign distance is  tensor(128.9549, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7973528504371643
distance x is tensor(122.7275, device='cuda:3')
benign distance is  tensor(122.7275, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3648587167263031
distance x is tensor(107.2095, device='cuda:3')
benign distance is  tensor(107.2095, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3267122805118561
distance x is tensor(120.9193, device='cuda:3')
benign distance is  tensor(120.9193, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.41502848267555237
distance x is tensor(115.6020, device='cuda:3')
benign distance is  tensor(115.6020, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(109.2450, device='cuda:3')
compute distance is  tensor(109.2450, device='cuda:3')
compute norm is  tensor(62.7795, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8345, device='cuda:3')
compute distance is  tensor(114.8345, device='cuda:3')
compute norm is  tensor(62.7243, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6150, device='cuda:3')
compute distance is  tensor(124.6150, device='cuda:3')
compute norm is  tensor(63.0478, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.3065, device='cuda:3')
compute distance is  tensor(117.3065, device='cuda:3')
compute norm is  tensor(62.8952, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.1855, device='cuda:3')
compute distance is  tensor(123.1855, device='cuda:3')
compute norm is  tensor(63.0443, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9409, device='cuda:3')
compute distance is  tensor(128.9409, device='cuda:3')
compute norm is  tensor(63.1865, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.8401, device='cuda:3')
compute distance is  tensor(119.8401, device='cuda:3')
compute norm is  tensor(62.7888, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.6416, device='cuda:3')
compute distance is  tensor(122.6416, device='cuda:3')
compute norm is  tensor(63.0985, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0930, device='cuda:3')
compute distance is  tensor(132.0930, device='cuda:3')
compute norm is  tensor(62.9571, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.9124, device='cuda:3')
compute distance is  tensor(121.9124, device='cuda:3')
compute norm is  tensor(63.0490, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2909, device='cuda:3')
compute distance is  tensor(123.2909, device='cuda:3')
compute norm is  tensor(63.0287, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0776, device='cuda:3')
compute distance is  tensor(120.0776, device='cuda:3')
compute norm is  tensor(63.0222, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(132.0930, device='cuda:3')
distance x is tensor(107494.9688, device='cuda:3')
distance x is tensor(107494.9688, device='cuda:3')
________________________________
test distance is  tensor(107494.9688, device='cuda:3')
test distance1 is  tensor(107494.9688, device='cuda:3')
test similarity is  tensor(0.5847, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130017999593384.67
test entropy is  0.0
________________________________
cal ratio is  0.034353577625892764
distance x is tensor(3692.8418, device='cuda:3')
cal_distance is  tensor(3692.8418, device='cuda:3')
cal ratio is  0.1853470488904148
distance x is tensor(684.4614, device='cuda:3')
cal_distance is  tensor(684.4614, device='cuda:3')
cal ratio is  0.4305182400828461
distance x is tensor(294.6760, device='cuda:3')
cal_distance is  tensor(294.6760, device='cuda:3')
cal ratio is  0.6561356843564273
distance x is tensor(193.3492, device='cuda:3')
cal_distance is  tensor(193.3492, device='cuda:3')
cal ratio is  0.8100183753737366
distance x is tensor(156.6173, device='cuda:3')
cal_distance is  tensor(156.6173, device='cuda:3')
cal ratio is  0.9000074666428783
distance x is tensor(140.9573, device='cuda:3')
cal_distance is  tensor(140.9573, device='cuda:3')
cal ratio is  0.9486854965788946
distance x is tensor(133.7244, device='cuda:3')
cal_distance is  tensor(133.7244, device='cuda:3')
cal ratio is  0.9740039793051714
distance x is tensor(130.2482, device='cuda:3')
cal_distance is  tensor(130.2482, device='cuda:3')
distance x is tensor(130.2482, device='cuda:3')
return_distance is  tensor(130.2482, device='cuda:3')
distance x is tensor(130.2382, device='cuda:3')
distance x is tensor(130.2382, device='cuda:3')
________________________________
test distance is  tensor(130.2382, device='cuda:3')
test distance1 is  tensor(130.2382, device='cuda:3')
test similarity is  tensor(0.9873, device='cuda:3')
test acc is  0.31856666682300655
test loss is 21.240552574840944
test entropy is  0.07467528455940359
________________________________
0
distance x is tensor(130.2382, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07578594415688883
avg test loss is  21.191634491308413
avg accuracy is  0.8784500001563221
solo acc is  0.31723333348967325
compute similarity  is  tensor(0.9873, device='cuda:3')
compute_distance is  tensor(130.2382, device='cuda:3')
compute_norm is  tensor(66.7578, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.5491, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9095700574454977
avg test loss is  1.3638836750343664
avg accuracy is  0.8197500001563246
solo acc is  0.32836666682300675
compute similarity  is  tensor(0.9868, device='cuda:3')
compute_distance is  tensor(131.5491, device='cuda:3')
compute_norm is  tensor(66.2982, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.0426, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8821401352694294
avg test loss is  1.44672631925103
avg accuracy is  0.8144500001563248
solo acc is  0.26268333348967193
compute similarity  is  tensor(0.9866, device='cuda:3')
compute_distance is  tensor(132.0426, device='cuda:3')
compute_norm is  tensor(65.9601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.1558, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8695782790306026
avg test loss is  1.416498786414356
avg accuracy is  0.8152000001563248
solo acc is  0.266183333489672
compute similarity  is  tensor(0.9865, device='cuda:3')
compute_distance is  tensor(132.1558, device='cuda:3')
compute_norm is  tensor(65.6295, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.2397, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.859199756688909
avg test loss is  1.4065850494004517
avg accuracy is  0.8205000001563245
solo acc is  0.2598666668230052
compute similarity  is  tensor(0.9863, device='cuda:3')
compute_distance is  tensor(132.2397, device='cuda:3')
compute_norm is  tensor(65.3047, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.3914, device='cuda:3')
distance x is tensor(132.3914, device='cuda:3')
________________________________
test distance is  tensor(132.3914, device='cuda:3')
test distance1 is  tensor(132.3914, device='cuda:3')
test similarity is  tensor(0.9861, device='cuda:3')
test acc is  0.24776666682300483
test loss is 1.401468312943668
test entropy is  0.8507709899055425
________________________________
cal ratio is  0.9788951170730469
distance x is tensor(129.6062, device='cuda:3')
cal_distance is  tensor(129.6062, device='cuda:3')
distance x is tensor(129.6062, device='cuda:3')
return_distance is  tensor(129.6062, device='cuda:3')
distance x is tensor(129.5972, device='cuda:3')
distance x is tensor(129.5972, device='cuda:3')
________________________________
test distance is  tensor(129.5972, device='cuda:3')
test distance1 is  tensor(129.5972, device='cuda:3')
test similarity is  tensor(0.9867, device='cuda:3')
test acc is  0.28821666682300595
test loss is 1.3275622152951734
test entropy is  0.8828955877310177
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.1592366695404053
mal norm is  tensor(611.0877, device='cuda:3')
distance x is tensor(129.6062, device='cuda:3')
mal distance is  tensor(129.6062, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([551.2886, 514.1828, 492.5567, 538.3381, 418.3996, 555.6584, 485.9576,
        522.2035, 611.0877, 611.0877, 611.0877, 611.0877, 611.0877, 611.0877,
        611.0877, 611.0877, 611.0877, 611.0877, 611.0877, 611.0877, 544.3242,
        549.4288, 526.3026, 576.5291, 517.8636, 549.7524, 520.5295, 538.3761],
       device='cuda:3')
sorted_norm is   tensor([418.3996, 485.9576, 492.5567, 514.1828, 517.8636, 520.5295, 522.2035,
        526.3026, 538.3381, 538.3761, 544.3242, 549.4288, 549.7524, 551.2886,
        555.6584, 576.5291, 611.0877, 611.0877, 611.0877, 611.0877, 611.0877,
        611.0877, 611.0877, 611.0877, 611.0877, 611.0877, 611.0877, 611.0877],
       device='cuda:3')
used idx is  tensor([ 4,  6,  2,  1, 24, 26,  7, 22,  3, 27, 20, 21, 25,  0,  5, 23, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 88.06% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5138373374938965
distance x is tensor(123.7378, device='cuda:3')
benign distance is  tensor(123.7378, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5940468311309814
distance x is tensor(119.7156, device='cuda:3')
benign distance is  tensor(119.7156, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38667187094688416
distance x is tensor(119.5897, device='cuda:3')
benign distance is  tensor(119.5897, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.364736944437027
distance x is tensor(126.5176, device='cuda:3')
benign distance is  tensor(126.5176, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6683380007743835
distance x is tensor(114.3611, device='cuda:3')
benign distance is  tensor(114.3611, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7024709582328796
distance x is tensor(125.7800, device='cuda:3')
benign distance is  tensor(125.7800, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19774478673934937
distance x is tensor(127.6716, device='cuda:3')
benign distance is  tensor(127.6716, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.06432981789112091
distance x is tensor(129.9032, device='cuda:3')
benign distance is  tensor(129.9032, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.27365347743034363
distance x is tensor(120.5079, device='cuda:3')
benign distance is  tensor(120.5079, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8075197339057922
distance x is tensor(133.5385, device='cuda:3')
benign distance is  tensor(133.5385, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5096392631530762
distance x is tensor(122.6040, device='cuda:3')
benign distance is  tensor(122.6040, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3951212465763092
distance x is tensor(140.9562, device='cuda:3')
benign distance is  tensor(140.9562, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8405211567878723
distance x is tensor(125.0344, device='cuda:3')
benign distance is  tensor(125.0344, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1436278522014618
distance x is tensor(126.2069, device='cuda:3')
benign distance is  tensor(126.2069, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6669330596923828
distance x is tensor(138.2423, device='cuda:3')
benign distance is  tensor(138.2423, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9692381024360657
distance x is tensor(120.8305, device='cuda:3')
benign distance is  tensor(120.8305, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(125.8610, device='cuda:3')
compute distance is  tensor(125.8610, device='cuda:3')
compute norm is  tensor(63.9131, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.0609, device='cuda:3')
compute distance is  tensor(115.0609, device='cuda:3')
compute norm is  tensor(63.7437, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.8681, device='cuda:3')
compute distance is  tensor(141.8681, device='cuda:3')
compute norm is  tensor(64.3229, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9460, device='cuda:3')
compute distance is  tensor(126.9460, device='cuda:3')
compute norm is  tensor(63.9607, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1393, device='cuda:3')
compute distance is  tensor(124.1393, device='cuda:3')
compute norm is  tensor(63.9858, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9232, device='cuda:3')
compute distance is  tensor(136.9232, device='cuda:3')
compute norm is  tensor(64.2164, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.6457, device='cuda:3')
compute distance is  tensor(121.6457, device='cuda:3')
compute norm is  tensor(63.7774, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8481, device='cuda:3')
compute distance is  tensor(124.8481, device='cuda:3')
compute norm is  tensor(63.8508, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7153, device='cuda:3')
compute distance is  tensor(132.7153, device='cuda:3')
compute norm is  tensor(64.0815, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2712, device='cuda:3')
compute distance is  tensor(124.2712, device='cuda:3')
compute norm is  tensor(63.8716, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5836, device='cuda:3')
compute distance is  tensor(128.5836, device='cuda:3')
compute norm is  tensor(64.0092, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.4635, device='cuda:3')
compute distance is  tensor(142.4635, device='cuda:3')
compute norm is  tensor(64.3595, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(142.4635, device='cuda:3')
distance x is tensor(107488.4297, device='cuda:3')
distance x is tensor(107488.4297, device='cuda:3')
________________________________
test distance is  tensor(107488.4297, device='cuda:3')
test distance1 is  tensor(107488.4297, device='cuda:3')
test similarity is  tensor(0.5899, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130047897969530.81
test entropy is  0.0
________________________________
cal ratio is  0.03567770900744733
distance x is tensor(3834.9463, device='cuda:3')
cal_distance is  tensor(3834.9463, device='cuda:3')
cal ratio is  0.18888530167399245
distance x is tensor(724.3690, device='cuda:3')
cal_distance is  tensor(724.3690, device='cuda:3')
cal ratio is  0.4346081613375929
distance x is tensor(314.8195, device='cuda:3')
cal_distance is  tensor(314.8195, device='cuda:3')
cal ratio is  0.6592451735320929
distance x is tensor(207.5450, device='cuda:3')
cal_distance is  tensor(207.5450, device='cuda:3')
cal ratio is  0.8119357959957594
distance x is tensor(168.5141, device='cuda:3')
cal_distance is  tensor(168.5141, device='cuda:3')
cal ratio is  0.901072271563025
distance x is tensor(151.8439, device='cuda:3')
cal_distance is  tensor(151.8439, device='cuda:3')
cal ratio is  0.9492466495259883
distance x is tensor(144.1376, device='cuda:3')
cal_distance is  tensor(144.1376, device='cuda:3')
cal ratio is  0.9742920083750383
distance x is tensor(140.4322, device='cuda:3')
cal_distance is  tensor(140.4322, device='cuda:3')
distance x is tensor(140.4322, device='cuda:3')
return_distance is  tensor(140.4322, device='cuda:3')
distance x is tensor(140.4222, device='cuda:3')
distance x is tensor(140.4222, device='cuda:3')
________________________________
test distance is  tensor(140.4222, device='cuda:3')
test distance1 is  tensor(140.4222, device='cuda:3')
test similarity is  tensor(0.9862, device='cuda:3')
test acc is  0.2103333334896701
test loss is 38.63888321858225
test entropy is  0.03747881829401906
________________________________
0
distance x is tensor(140.4222, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.036645049834301245
avg test loss is  38.73147877447133
avg accuracy is  0.8723833334896556
solo acc is  0.2113166668230035
compute similarity  is  tensor(0.9862, device='cuda:3')
compute_distance is  tensor(140.4222, device='cuda:3')
compute_norm is  tensor(68.2455, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.7201, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9483168482272102
avg test loss is  1.3673551536318083
avg accuracy is  0.7951666668229923
solo acc is  0.32355000015634
compute similarity  is  tensor(0.9859, device='cuda:3')
compute_distance is  tensor(140.7201, device='cuda:3')
compute_norm is  tensor(67.8846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(140.7201, device='cuda:3')
distance x is tensor(140.7201, device='cuda:3')
________________________________
test distance is  tensor(140.7201, device='cuda:3')
test distance1 is  tensor(140.7201, device='cuda:3')
test similarity is  tensor(0.9859, device='cuda:3')
test acc is  0.3237166668230067
test loss is 1.3662344138505362
test entropy is  0.9484592089647932
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2267842292785645
mal norm is  tensor(704.9675, device='cuda:3')
distance x is tensor(140.7291, device='cuda:3')
mal distance is  tensor(140.7291, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([530.6338, 496.1270, 503.9967, 527.0448, 482.5017, 523.0480, 505.1323,
        549.0749, 704.9675, 704.9675, 704.9675, 704.9675, 704.9675, 704.9675,
        704.9675, 704.9675, 704.9675, 704.9675, 704.9675, 704.9675, 514.9500,
        590.1615, 546.8532, 527.5053, 544.4077, 526.4615, 585.7415, 545.9857],
       device='cuda:3')
sorted_norm is   tensor([482.5017, 496.1270, 503.9967, 505.1323, 514.9500, 523.0480, 526.4615,
        527.0448, 527.5053, 530.6338, 544.4077, 545.9857, 546.8532, 549.0749,
        585.7415, 590.1615, 704.9675, 704.9675, 704.9675, 704.9675, 704.9675,
        704.9675, 704.9675, 704.9675, 704.9675, 704.9675, 704.9675, 704.9675],
       device='cuda:3')
used idx is  tensor([ 4,  1,  2,  6, 20,  5, 25,  3, 23,  0, 24, 27, 22,  7, 26, 21, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.14% 

Test Accuracy: 88.11% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5744078755378723
distance x is tensor(119.7378, device='cuda:3')
benign distance is  tensor(119.7378, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9308497309684753
distance x is tensor(133.3465, device='cuda:3')
benign distance is  tensor(133.3465, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2857862114906311
distance x is tensor(128.5213, device='cuda:3')
benign distance is  tensor(128.5213, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6153267025947571
distance x is tensor(112.1448, device='cuda:3')
benign distance is  tensor(112.1448, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7560755014419556
distance x is tensor(149.3518, device='cuda:3')
benign distance is  tensor(149.3518, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.32850760221481323
distance x is tensor(120.8095, device='cuda:3')
benign distance is  tensor(120.8095, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9621890187263489
distance x is tensor(128.1549, device='cuda:3')
benign distance is  tensor(128.1549, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4197649359703064
distance x is tensor(122.2578, device='cuda:3')
benign distance is  tensor(122.2578, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5503062009811401
distance x is tensor(125.7064, device='cuda:3')
benign distance is  tensor(125.7064, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.43397730588912964
distance x is tensor(121.4453, device='cuda:3')
benign distance is  tensor(121.4453, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3315306007862091
distance x is tensor(133.3173, device='cuda:3')
benign distance is  tensor(133.3173, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.401501178741455
distance x is tensor(129.9837, device='cuda:3')
benign distance is  tensor(129.9837, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.10615001618862152
distance x is tensor(119.0962, device='cuda:3')
benign distance is  tensor(119.0962, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3665243685245514
distance x is tensor(114.1215, device='cuda:3')
benign distance is  tensor(114.1215, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6887609362602234
distance x is tensor(133.1270, device='cuda:3')
benign distance is  tensor(133.1270, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.914057731628418
distance x is tensor(126.0726, device='cuda:3')
benign distance is  tensor(126.0726, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.6950, device='cuda:3')
compute distance is  tensor(121.6950, device='cuda:3')
compute norm is  tensor(64.6775, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8761, device='cuda:3')
compute distance is  tensor(127.8761, device='cuda:3')
compute norm is  tensor(64.5271, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9650, device='cuda:3')
compute distance is  tensor(136.9650, device='cuda:3')
compute norm is  tensor(64.8561, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.6407, device='cuda:3')
compute distance is  tensor(121.6407, device='cuda:3')
compute norm is  tensor(64.5213, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.2716, device='cuda:3')
compute distance is  tensor(127.2716, device='cuda:3')
compute norm is  tensor(64.7516, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3489, device='cuda:3')
compute distance is  tensor(133.3489, device='cuda:3')
compute norm is  tensor(64.9539, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.7389, device='cuda:3')
compute distance is  tensor(118.7389, device='cuda:3')
compute norm is  tensor(64.7701, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.9152, device='cuda:3')
compute distance is  tensor(117.9152, device='cuda:3')
compute norm is  tensor(64.6516, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3244, device='cuda:3')
compute distance is  tensor(126.3244, device='cuda:3')
compute norm is  tensor(64.8572, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8732, device='cuda:3')
compute distance is  tensor(131.8732, device='cuda:3')
compute norm is  tensor(64.7846, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.6402, device='cuda:3')
compute distance is  tensor(135.6402, device='cuda:3')
compute norm is  tensor(65.0339, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.6094, device='cuda:3')
compute distance is  tensor(121.6094, device='cuda:3')
compute norm is  tensor(64.7403, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.9650, device='cuda:3')
distance x is tensor(107483.7500, device='cuda:3')
distance x is tensor(107483.7500, device='cuda:3')
________________________________
test distance is  tensor(107483.7500, device='cuda:3')
test distance1 is  tensor(107483.7500, device='cuda:3')
test similarity is  tensor(0.5955, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129997535754087.17
test entropy is  0.0
________________________________
cal ratio is  0.03498318807643412
distance x is tensor(3760.1296, device='cuda:3')
cal_distance is  tensor(3760.1296, device='cuda:3')
cal ratio is  0.18703780555948069
distance x is tensor(703.2904, device='cuda:3')
cal_distance is  tensor(703.2904, device='cuda:3')
cal ratio is  0.43247744105881875
distance x is tensor(304.1601, device='cuda:3')
cal_distance is  tensor(304.1601, device='cuda:3')
cal ratio is  0.6576270282984541
distance x is tensor(200.0256, device='cuda:3')
cal_distance is  tensor(200.0256, device='cuda:3')
cal ratio is  0.8109385816386806
distance x is tensor(162.2095, device='cuda:3')
cal_distance is  tensor(162.2095, device='cuda:3')
cal ratio is  0.9005186360547316
distance x is tensor(146.0732, device='cuda:3')
cal_distance is  tensor(146.0732, device='cuda:3')
cal ratio is  0.9489548491795405
distance x is tensor(138.6171, device='cuda:3')
cal_distance is  tensor(138.6171, device='cuda:3')
cal ratio is  0.9741422897227968
distance x is tensor(135.0329, device='cuda:3')
cal_distance is  tensor(135.0329, device='cuda:3')
distance x is tensor(135.0329, device='cuda:3')
return_distance is  tensor(135.0329, device='cuda:3')
distance x is tensor(135.0229, device='cuda:3')
distance x is tensor(135.0229, device='cuda:3')
________________________________
test distance is  tensor(135.0229, device='cuda:3')
test distance1 is  tensor(135.0229, device='cuda:3')
test similarity is  tensor(0.9875, device='cuda:3')
test acc is  0.33516666682300694
test loss is 21.765939372943155
test entropy is  0.07297250671363843
________________________________
0
distance x is tensor(135.0229, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0713409061656832
avg test loss is  21.755436921678882
avg accuracy is  0.8792500001563222
solo acc is  0.33491666682300686
compute similarity  is  tensor(0.9875, device='cuda:3')
compute_distance is  tensor(135.0229, device='cuda:3')
compute_norm is  tensor(68.8214, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.5650, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.951643307707203
avg test loss is  1.3562196808329015
avg accuracy is  0.8142500001563248
solo acc is  0.3302500001563401
compute similarity  is  tensor(0.9872, device='cuda:3')
compute_distance is  tensor(135.5650, device='cuda:3')
compute_norm is  tensor(68.3517, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.9776, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8940958731464231
avg test loss is  1.4573553022799461
avg accuracy is  0.8110333334896582
solo acc is  0.2641500001563387
compute similarity  is  tensor(0.9869, device='cuda:3')
compute_distance is  tensor(135.9776, device='cuda:3')
compute_norm is  tensor(68.0084, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.1485, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8718946135755795
avg test loss is  1.4318185052129506
avg accuracy is  0.8145333334896582
solo acc is  0.26445000015633874
compute similarity  is  tensor(0.9868, device='cuda:3')
compute_distance is  tensor(136.1485, device='cuda:3')
compute_norm is  tensor(67.6691, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.2666, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8692876536454728
avg test loss is  1.4160199719451383
avg accuracy is  0.8173166668229913
solo acc is  0.25346666682300506
compute similarity  is  tensor(0.9866, device='cuda:3')
compute_distance is  tensor(136.2666, device='cuda:3')
compute_norm is  tensor(67.3322, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.3737, device='cuda:3')
distance x is tensor(136.3737, device='cuda:3')
________________________________
test distance is  tensor(136.3737, device='cuda:3')
test distance1 is  tensor(136.3737, device='cuda:3')
test similarity is  tensor(0.9865, device='cuda:3')
test acc is  0.24981666682300485
test loss is 1.411573534962465
test entropy is  0.8463841904836423
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2455933094024658
mal norm is  tensor(644.9284, device='cuda:3')
distance x is tensor(136.3827, device='cuda:3')
mal distance is  tensor(136.3827, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([500.6911, 559.0256, 543.8180, 465.4770, 611.5173, 507.6660, 519.8686,
        515.4217, 644.9284, 644.9284, 644.9284, 644.9284, 644.9284, 644.9284,
        644.9284, 644.9284, 644.9284, 644.9284, 644.9284, 644.9284, 558.2274,
        524.0525, 593.1981, 550.4625, 575.0183, 557.9575, 582.7368, 558.6531,
        534.3640, 566.6045, 536.6914, 600.3365, 551.0345, 542.8644, 571.6792,
        529.7808], device='cuda:3')
sorted_norm is   tensor([465.4770, 500.6911, 507.6660, 515.4217, 519.8686, 524.0525, 529.7808,
        534.3640, 536.6914, 542.8644, 543.8180, 550.4625, 551.0345, 557.9575,
        558.2274, 558.6531, 559.0256, 566.6045, 571.6792, 575.0183, 582.7368,
        593.1981, 600.3365, 611.5173, 644.9284, 644.9284, 644.9284, 644.9284,
        644.9284, 644.9284, 644.9284, 644.9284, 644.9284, 644.9284, 644.9284,
        644.9284], device='cuda:3')
used idx is  tensor([ 3,  0,  5,  7,  6, 21, 35, 28, 30, 33,  2, 23, 32, 25, 20, 27,  1, 29,
        34, 24, 26, 22, 31,  4, 11], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 87.92% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8272632360458374
distance x is tensor(105.9396, device='cuda:3')
benign distance is  tensor(105.9396, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.650973916053772
distance x is tensor(108.5389, device='cuda:3')
benign distance is  tensor(108.5389, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06809462606906891
distance x is tensor(113.8553, device='cuda:3')
benign distance is  tensor(113.8553, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5894295573234558
distance x is tensor(112.2906, device='cuda:3')
benign distance is  tensor(112.2906, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8125249147415161
distance x is tensor(100.7962, device='cuda:3')
benign distance is  tensor(100.7962, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.550950288772583
distance x is tensor(128.7472, device='cuda:3')
benign distance is  tensor(128.7472, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27130523324012756
distance x is tensor(119.3930, device='cuda:3')
benign distance is  tensor(119.3930, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8384554982185364
distance x is tensor(127.8040, device='cuda:3')
benign distance is  tensor(127.8040, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8936767578125
distance x is tensor(119.7464, device='cuda:3')
benign distance is  tensor(119.7464, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4624168276786804
distance x is tensor(115.9105, device='cuda:3')
benign distance is  tensor(115.9105, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.45416775345802307
distance x is tensor(110.7341, device='cuda:3')
benign distance is  tensor(110.7341, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1617237329483032
distance x is tensor(132.1539, device='cuda:3')
benign distance is  tensor(132.1539, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7529054880142212
distance x is tensor(123.3857, device='cuda:3')
benign distance is  tensor(123.3857, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6050466299057007
distance x is tensor(117.7115, device='cuda:3')
benign distance is  tensor(117.7115, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5496203899383545
distance x is tensor(117.9422, device='cuda:3')
benign distance is  tensor(117.9422, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.49660301208496094
distance x is tensor(119.1097, device='cuda:3')
benign distance is  tensor(119.1097, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.36016422510147095
distance x is tensor(127.9227, device='cuda:3')
benign distance is  tensor(127.9227, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5814254879951477
distance x is tensor(119.1399, device='cuda:3')
benign distance is  tensor(119.1399, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5638595819473267
distance x is tensor(127.9575, device='cuda:3')
benign distance is  tensor(127.9575, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.589799702167511
distance x is tensor(122.8251, device='cuda:3')
benign distance is  tensor(122.8251, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7936739325523376
distance x is tensor(122.6702, device='cuda:3')
benign distance is  tensor(122.6702, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5871996283531189
distance x is tensor(147.8568, device='cuda:3')
benign distance is  tensor(147.8568, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.22346553206443787
distance x is tensor(126.7387, device='cuda:3')
benign distance is  tensor(126.7387, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4721597731113434
distance x is tensor(111.4696, device='cuda:3')
benign distance is  tensor(111.4696, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(115.3904, device='cuda:3')
compute distance is  tensor(115.3904, device='cuda:3')
compute norm is  tensor(64.3544, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.3778, device='cuda:3')
compute distance is  tensor(119.3778, device='cuda:3')
compute norm is  tensor(64.4327, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.4899, device='cuda:3')
compute distance is  tensor(138.4899, device='cuda:3')
compute norm is  tensor(64.7891, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9079, device='cuda:3')
compute distance is  tensor(130.9079, device='cuda:3')
compute norm is  tensor(64.5006, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2420, device='cuda:3')
compute distance is  tensor(133.2420, device='cuda:3')
compute norm is  tensor(64.8725, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8086, device='cuda:3')
compute distance is  tensor(132.8086, device='cuda:3')
compute norm is  tensor(64.8973, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.0637, device='cuda:3')
compute distance is  tensor(125.0637, device='cuda:3')
compute norm is  tensor(64.5818, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6649, device='cuda:3')
compute distance is  tensor(125.6649, device='cuda:3')
compute norm is  tensor(64.5534, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1256, device='cuda:3')
compute distance is  tensor(131.1256, device='cuda:3')
compute norm is  tensor(64.6270, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.2889, device='cuda:3')
compute distance is  tensor(114.2889, device='cuda:3')
compute norm is  tensor(64.4062, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.2909, device='cuda:3')
compute distance is  tensor(136.2909, device='cuda:3')
compute norm is  tensor(64.9969, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.8414, device='cuda:3')
compute distance is  tensor(116.8414, device='cuda:3')
compute norm is  tensor(64.5926, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.4899, device='cuda:3')
distance x is tensor(107496.8047, device='cuda:3')
distance x is tensor(107496.8047, device='cuda:3')
________________________________
test distance is  tensor(107496.8047, device='cuda:3')
test distance1 is  tensor(107496.8047, device='cuda:3')
test similarity is  tensor(0.5790, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130139331051205.6
test entropy is  0.0
________________________________
cal ratio is  0.03517526122690551
distance x is tensor(3781.2336, device='cuda:3')
cal_distance is  tensor(3781.2336, device='cuda:3')
cal ratio is  0.18755055224900613
distance x is tensor(709.1765, device='cuda:3')
cal_distance is  tensor(709.1765, device='cuda:3')
cal ratio is  0.4330698260412845
distance x is tensor(307.1258, device='cuda:3')
cal_distance is  tensor(307.1258, device='cuda:3')
cal ratio is  0.6580773410947783
distance x is tensor(202.1143, device='cuda:3')
cal_distance is  tensor(202.1143, device='cuda:3')
cal ratio is  0.8112162005932089
distance x is tensor(163.9593, device='cuda:3')
cal_distance is  tensor(163.9593, device='cuda:3')
cal ratio is  0.9006728391761133
distance x is tensor(147.6742, device='cuda:3')
cal_distance is  tensor(147.6742, device='cuda:3')
cal ratio is  0.9490361316473332
distance x is tensor(140.1484, device='cuda:3')
cal_distance is  tensor(140.1484, device='cuda:3')
cal ratio is  0.9741840111260138
distance x is tensor(136.5305, device='cuda:3')
cal_distance is  tensor(136.5305, device='cuda:3')
distance x is tensor(136.5305, device='cuda:3')
return_distance is  tensor(136.5305, device='cuda:3')
distance x is tensor(136.5205, device='cuda:3')
distance x is tensor(136.5205, device='cuda:3')
________________________________
test distance is  tensor(136.5205, device='cuda:3')
test distance1 is  tensor(136.5205, device='cuda:3')
test similarity is  tensor(0.9867, device='cuda:3')
test acc is  0.3211333334896733
test loss is 24.467080013584226
test entropy is  0.057412673459092435
________________________________
0
distance x is tensor(136.5205, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.05648070675502621
avg test loss is  24.441418376304448
avg accuracy is  0.8834500001563219
solo acc is  0.32170000015634
compute similarity  is  tensor(0.9867, device='cuda:3')
compute_distance is  tensor(136.5205, device='cuda:3')
compute_norm is  tensor(68.6516, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.0065, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9348046892106152
avg test loss is  1.3702534045110633
avg accuracy is  0.838933333489657
solo acc is  0.33541666682300686
compute similarity  is  tensor(0.9862, device='cuda:3')
compute_distance is  tensor(138.0065, device='cuda:3')
compute_norm is  tensor(68.1647, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.7183, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8791169997598571
avg test loss is  1.4569970017303027
avg accuracy is  0.8348666668229905
solo acc is  0.2714666668230056
compute similarity  is  tensor(0.9859, device='cuda:3')
compute_distance is  tensor(138.7183, device='cuda:3')
compute_norm is  tensor(67.8149, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.9369, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8730335478970745
avg test loss is  1.431438806468744
avg accuracy is  0.8337666668229906
solo acc is  0.26470000015633877
compute similarity  is  tensor(0.9857, device='cuda:3')
compute_distance is  tensor(138.9369, device='cuda:3')
compute_norm is  tensor(67.4724, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.1342, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8638303406965504
avg test loss is  1.412603646834522
avg accuracy is  0.840233333489657
solo acc is  0.25886666682300513
compute similarity  is  tensor(0.9855, device='cuda:3')
compute_distance is  tensor(139.1342, device='cuda:3')
compute_norm is  tensor(67.1357, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.3174, device='cuda:3')
distance x is tensor(139.3174, device='cuda:3')
________________________________
test distance is  tensor(139.3174, device='cuda:3')
test distance1 is  tensor(139.3174, device='cuda:3')
test similarity is  tensor(0.9854, device='cuda:3')
test acc is  0.25181666682300496
test loss is 1.4002425666811116
test entropy is  0.8589501035238888
________________________________
cal ratio is  0.9770851721770031
distance x is tensor(136.1338, device='cuda:3')
cal_distance is  tensor(136.1338, device='cuda:3')
distance x is tensor(136.1338, device='cuda:3')
return_distance is  tensor(136.1338, device='cuda:3')
distance x is tensor(136.1249, device='cuda:3')
distance x is tensor(136.1249, device='cuda:3')
________________________________
test distance is  tensor(136.1249, device='cuda:3')
test distance1 is  tensor(136.1249, device='cuda:3')
test similarity is  tensor(0.9859, device='cuda:3')
test acc is  0.290566666823006
test loss is 1.3274991938046046
test entropy is  0.8893896205338843
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.0133830308914185
mal norm is  tensor(641.4615, device='cuda:3')
distance x is tensor(136.1338, device='cuda:3')
mal distance is  tensor(136.1338, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([449.1732, 467.2931, 480.7281, 477.7885, 431.9584, 544.2524, 492.6953,
        542.2466, 641.4616, 641.4615, 641.4616, 641.4615, 641.4616, 641.4615,
        641.4616, 641.4615, 641.4616, 641.4615, 641.4616, 641.4615],
       device='cuda:3')
sorted_norm is   tensor([431.9584, 449.1732, 467.2931, 477.7885, 480.7281, 492.6953, 542.2466,
        544.2524, 641.4615, 641.4615, 641.4615, 641.4615, 641.4615, 641.4615,
        641.4616, 641.4616, 641.4616, 641.4616, 641.4616, 641.4616],
       device='cuda:3')
used idx is  tensor([ 4,  0,  1,  3,  2,  6,  7,  5, 19, 17, 13, 15, 11,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 87.92% 

Test Accuracy: 87.24% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9877269864082336
distance x is tensor(113.0591, device='cuda:3')
benign distance is  tensor(113.0591, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3622223734855652
distance x is tensor(139.3358, device='cuda:3')
benign distance is  tensor(139.3358, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27538037300109863
distance x is tensor(149.9831, device='cuda:3')
benign distance is  tensor(149.9831, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6004247665405273
distance x is tensor(133.2961, device='cuda:3')
benign distance is  tensor(133.2961, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7615935802459717
distance x is tensor(124.4035, device='cuda:3')
benign distance is  tensor(124.4035, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6330479383468628
distance x is tensor(139.3162, device='cuda:3')
benign distance is  tensor(139.3162, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38629239797592163
distance x is tensor(123.1592, device='cuda:3')
benign distance is  tensor(123.1592, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4302161633968353
distance x is tensor(137.0225, device='cuda:3')
benign distance is  tensor(137.0225, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.4173, device='cuda:3')
compute distance is  tensor(129.4173, device='cuda:3')
compute norm is  tensor(66.4551, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.7263, device='cuda:3')
compute distance is  tensor(153.7263, device='cuda:3')
compute norm is  tensor(66.8603, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.3191, device='cuda:3')
compute distance is  tensor(144.3191, device='cuda:3')
compute norm is  tensor(66.5967, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5596, device='cuda:3')
compute distance is  tensor(130.5596, device='cuda:3')
compute norm is  tensor(66.5297, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2266, device='cuda:3')
compute distance is  tensor(132.2266, device='cuda:3')
compute norm is  tensor(66.5724, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.1864, device='cuda:3')
compute distance is  tensor(133.1864, device='cuda:3')
compute norm is  tensor(66.6823, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.4914, device='cuda:3')
compute distance is  tensor(135.4914, device='cuda:3')
compute norm is  tensor(66.4384, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6305, device='cuda:3')
compute distance is  tensor(123.6305, device='cuda:3')
compute norm is  tensor(66.3266, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.4694, device='cuda:3')
compute distance is  tensor(154.4694, device='cuda:3')
compute norm is  tensor(66.8204, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7621, device='cuda:3')
compute distance is  tensor(132.7621, device='cuda:3')
compute norm is  tensor(66.4232, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2764, device='cuda:3')
compute distance is  tensor(132.2764, device='cuda:3')
compute norm is  tensor(66.3057, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7694, device='cuda:3')
compute distance is  tensor(133.7694, device='cuda:3')
compute norm is  tensor(66.4873, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.4694, device='cuda:3')
distance x is tensor(107452.2266, device='cuda:3')
distance x is tensor(107452.2266, device='cuda:3')
________________________________
test distance is  tensor(107452.2266, device='cuda:3')
test distance1 is  tensor(107452.2266, device='cuda:3')
test similarity is  tensor(0.6287, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130136200633756.66
test entropy is  0.0
________________________________
cal ratio is  0.03715691268349399
distance x is tensor(3992.5984, device='cuda:3')
cal_distance is  tensor(3992.5984, device='cuda:3')
cal ratio is  0.1927611585182943
distance x is tensor(769.6219, device='cuda:3')
cal_distance is  tensor(769.6219, device='cuda:3')
cal ratio is  0.4390445888775679
distance x is tensor(337.9012, device='cuda:3')
cal_distance is  tensor(337.9012, device='cuda:3')
cal ratio is  0.6626016287047147
distance x is tensor(223.8956, device='cuda:3')
cal_distance is  tensor(223.8956, device='cuda:3')
cal ratio is  0.8140003333050048
distance x is tensor(182.2520, device='cuda:3')
cal_distance is  tensor(182.2520, device='cuda:3')
cal ratio is  0.9022172911838541
distance x is tensor(164.4314, device='cuda:3')
cal_distance is  tensor(164.4314, device='cuda:3')
cal ratio is  0.9498498694976856
distance x is tensor(156.1854, device='cuda:3')
cal_distance is  tensor(156.1854, device='cuda:3')
cal ratio is  0.9746015674469451
distance x is tensor(152.2187, device='cuda:3')
cal_distance is  tensor(152.2187, device='cuda:3')
distance x is tensor(152.2187, device='cuda:3')
return_distance is  tensor(152.2187, device='cuda:3')
distance x is tensor(152.2086, device='cuda:3')
distance x is tensor(152.2086, device='cuda:3')
________________________________
test distance is  tensor(152.2086, device='cuda:3')
test distance1 is  tensor(152.2086, device='cuda:3')
test similarity is  tensor(0.9867, device='cuda:3')
test acc is  0.10901666682299863
test loss is 90.84349725800537
test entropy is  0.006254592670926325
________________________________
0
distance x is tensor(152.2086, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.006463890044296306
avg test loss is  91.13658825319204
avg accuracy is  0.8143666668229913
solo acc is  0.10885000015633195
compute similarity  is  tensor(0.9867, device='cuda:3')
compute_distance is  tensor(152.2086, device='cuda:3')
compute_norm is  tensor(71.4580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5046.5171, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.544581361289726
avg test loss is  2.8930511327186372
avg accuracy is  0.10326666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0595, device='cuda:3')
compute_distance is  tensor(5046.5171, device='cuda:3')
compute_norm is  tensor(465.4272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5023.8901, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8343608981129457
avg test loss is  3.6621215590027605
avg accuracy is  0.10275000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0596, device='cuda:3')
compute_distance is  tensor(5023.8901, device='cuda:3')
compute_norm is  tensor(463.3945, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5000.9058, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5558847558777977
avg test loss is  2.8742628483884114
avg accuracy is  0.10291666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0595, device='cuda:3')
compute_distance is  tensor(5000.9058, device='cuda:3')
compute_norm is  tensor(461.0084, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4978.5068, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8389802892833377
avg test loss is  3.6367358363259323
avg accuracy is  0.1024833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0595, device='cuda:3')
compute_distance is  tensor(4978.5068, device='cuda:3')
compute_norm is  tensor(459.0430, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4955.7979, device='cuda:3')
distance x is tensor(4955.7979, device='cuda:3')
________________________________
test distance is  tensor(4955.7979, device='cuda:3')
test distance1 is  tensor(4955.7979, device='cuda:3')
test similarity is  tensor(0.0594, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8678947552434924
test entropy is  1.5566692469216614
________________________________
cal ratio is  0.1730177025133256
distance x is tensor(857.4389, device='cuda:3')
cal_distance is  tensor(857.4389, device='cuda:3')
cal ratio is  0.41595442059676485
distance x is tensor(356.6546, device='cuda:3')
cal_distance is  tensor(356.6546, device='cuda:3')
cal ratio is  0.6449460727211724
distance x is tensor(230.0225, device='cuda:3')
cal_distance is  tensor(230.0225, device='cuda:3')
cal ratio is  0.8030861957096338
distance x is tensor(184.7276, device='cuda:3')
cal_distance is  tensor(184.7276, device='cuda:3')
cal ratio is  0.8961514351992763
distance x is tensor(165.5438, device='cuda:3')
cal_distance is  tensor(165.5438, device='cuda:3')
cal ratio is  0.9466532491616816
distance x is tensor(156.7125, device='cuda:3')
cal_distance is  tensor(156.7125, device='cuda:3')
cal ratio is  0.9729612441268854
distance x is tensor(152.4751, device='cuda:3')
cal_distance is  tensor(152.4751, device='cuda:3')
distance x is tensor(152.4751, device='cuda:3')
return_distance is  tensor(152.4751, device='cuda:3')
distance x is tensor(152.4781, device='cuda:3')
distance x is tensor(152.4781, device='cuda:3')
________________________________
test distance is  tensor(152.4781, device='cuda:3')
test distance1 is  tensor(152.4781, device='cuda:3')
test similarity is  tensor(0.9696, device='cuda:3')
test acc is  0.20021666682300307
test loss is 115.85695120724026
test entropy is  0.41136425662078835
________________________________
0
distance x is tensor(152.4781, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.4100581183235274
avg test loss is  115.93872452595595
avg accuracy is  0.6508166668230004
solo acc is  0.20085000015633642
compute similarity  is  tensor(0.9696, device='cuda:3')
compute_distance is  tensor(152.4781, device='cuda:3')
compute_norm is  tensor(66.9689, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3020.0461, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5280754094693199
avg test loss is  2.915879542639515
avg accuracy is  0.10185000015633197
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.0964, device='cuda:3')
compute_distance is  tensor(3020.0461, device='cuda:3')
compute_norm is  tensor(307.1728, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3006.7976, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8224124488418799
avg test loss is  3.663311773780058
avg accuracy is  0.10070000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0964, device='cuda:3')
compute_distance is  tensor(3006.7976, device='cuda:3')
compute_norm is  tensor(305.8826, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2993.4160, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5495107997455069
avg test loss is  2.8760296141923365
avg accuracy is  0.1020833334896653
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.0963, device='cuda:3')
compute_distance is  tensor(2993.4160, device='cuda:3')
compute_norm is  tensor(304.2161, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2980.3201, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8333543583528319
avg test loss is  3.633385266830672
avg accuracy is  0.10091666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0964, device='cuda:3')
compute_distance is  tensor(2980.3201, device='cuda:3')
compute_norm is  tensor(302.9760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2967.0618, device='cuda:3')
distance x is tensor(2967.0618, device='cuda:3')
________________________________
test distance is  tensor(2967.0618, device='cuda:3')
test distance1 is  tensor(2967.0618, device='cuda:3')
test similarity is  tensor(0.0963, device='cuda:3')
test acc is  0.10041666682299864
test loss is 2.863304585790329
test entropy is  1.5530457337782073
________________________________
cal ratio is  0.22360630704233048
distance x is tensor(663.4514, device='cuda:3')
cal_distance is  tensor(663.4514, device='cuda:3')
cal ratio is  0.4728710950924154
distance x is tensor(313.7260, device='cuda:3')
cal_distance is  tensor(313.7260, device='cuda:3')
cal ratio is  0.6876573591736921
distance x is tensor(215.7354, device='cuda:3')
cal_distance is  tensor(215.7354, device='cuda:3')
cal ratio is  0.8292521843028978
distance x is tensor(178.8987, device='cuda:3')
cal_distance is  tensor(178.8987, device='cuda:3')
cal ratio is  0.9106336531427607
distance x is tensor(162.9110, device='cuda:3')
cal_distance is  tensor(162.9110, device='cuda:3')
cal ratio is  0.9542717693709997
distance x is tensor(155.4613, device='cuda:3')
cal_distance is  tensor(155.4613, device='cuda:3')
cal ratio is  0.9768686699372333
distance x is tensor(151.8653, device='cuda:3')
cal_distance is  tensor(151.8653, device='cuda:3')
distance x is tensor(151.8653, device='cuda:3')
return_distance is  tensor(151.8653, device='cuda:3')
distance x is tensor(151.8690, device='cuda:3')
distance x is tensor(151.8690, device='cuda:3')
________________________________
test distance is  tensor(151.8690, device='cuda:3')
test distance1 is  tensor(151.8690, device='cuda:3')
test similarity is  tensor(0.9451, device='cuda:3')
test acc is  0.4073166668230078
test loss is 1.4798357864178575
test entropy is  1.5101055593124584
________________________________
0
distance x is tensor(151.8690, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.513666993900657
avg test loss is  1.4808883199305423
avg accuracy is  0.626733333489669
solo acc is  0.4071500001563412
compute similarity  is  tensor(0.9451, device='cuda:3')
compute_distance is  tensor(151.8690, device='cuda:3')
compute_norm is  tensor(68.3857, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.2915, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6138675416519901
avg test loss is  2.4664380016611585
avg accuracy is  0.4352666668230082
solo acc is  0.1231666668229986
compute similarity  is  tensor(0.9449, device='cuda:3')
compute_distance is  tensor(156.2915, device='cuda:3')
compute_norm is  tensor(68.1230, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.3181, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.941417241274421
avg test loss is  1.4236522493586103
avg accuracy is  0.5841666668230056
solo acc is  0.2859500001563392
compute similarity  is  tensor(0.9449, device='cuda:3')
compute_distance is  tensor(158.3181, device='cuda:3')
compute_norm is  tensor(67.7312, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(158.3134, device='cuda:3')
________________________________
test distance is  tensor(158.3134, device='cuda:3')
test similarity is  tensor(0.9449, device='cuda:3')
test acc is  0.5849666668230055
test loss is 1.4222888924928108
test entropy is  0.939921780499314
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3458714485168457
mal norm is  tensor(1082.9430, device='cuda:3')
distance x is tensor(158.3134, device='cuda:3')
mal distance is  tensor(158.3134, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 36
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 472.4979,  569.6583,  597.8234,  556.4838,  515.7874,  570.2363,
         498.2914,  568.2568, 1082.9430, 1082.9430, 1082.9430, 1082.9430,
        1082.9430, 1082.9430, 1082.9430, 1082.9430, 1082.9430, 1082.9430,
        1082.9430, 1082.9430,  652.4656,  618.1401,  644.4592,  708.1718,
         631.1233,  652.3378,  673.9655,  640.6578,  633.2817,  617.1818,
         623.6248,  646.2179,  634.3265,  581.0333,  623.2784,  612.4695,
         597.8760,  587.8139,  625.1107,  607.1565,  567.1095,  557.5317,
         618.4337,  603.1312,  593.5785,  577.8171,  555.5955,  634.7881,
         601.7432,  577.9167,  583.1391,  590.8137], device='cuda:3')
sorted_norm is   tensor([ 472.4979,  498.2914,  515.7874,  555.5955,  556.4838,  557.5317,
         567.1095,  568.2568,  569.6583,  570.2363,  577.8171,  577.9167,
         581.0333,  583.1391,  587.8139,  590.8137,  593.5785,  597.8234,
         597.8760,  601.7432,  603.1312,  607.1565,  612.4695,  617.1818,
         618.1401,  618.4337,  623.2784,  623.6248,  625.1107,  631.1233,
         633.2817,  634.3265,  634.7881,  640.6578,  644.4592,  646.2179,
         652.3378,  652.4656,  673.9655,  708.1718, 1082.9430, 1082.9430,
        1082.9430, 1082.9430, 1082.9430, 1082.9430, 1082.9430, 1082.9430,
        1082.9430, 1082.9430, 1082.9430, 1082.9430], device='cuda:3')
used idx is  tensor([ 0,  6,  4, 46,  3, 41, 40,  7,  1,  5, 45, 49, 33, 50, 37, 51, 44,  2,
        36, 48, 43, 39, 35, 29, 21, 42, 34, 30, 38, 24, 28, 32, 47, 27, 22, 31],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.04% 

Test Accuracy: 88.20% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4811336100101471
distance x is tensor(125.9038, device='cuda:3')
benign distance is  tensor(125.9038, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6695760488510132
distance x is tensor(120.0878, device='cuda:3')
benign distance is  tensor(120.0878, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1484345942735672
distance x is tensor(108.1228, device='cuda:3')
benign distance is  tensor(108.1228, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3911929726600647
distance x is tensor(110.7199, device='cuda:3')
benign distance is  tensor(110.7199, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6240447759628296
distance x is tensor(104.2910, device='cuda:3')
benign distance is  tensor(104.2910, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5551307797431946
distance x is tensor(117.0412, device='cuda:3')
benign distance is  tensor(117.0412, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.403144896030426
distance x is tensor(119.5173, device='cuda:3')
benign distance is  tensor(119.5173, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.14631429314613342
distance x is tensor(116.7380, device='cuda:3')
benign distance is  tensor(116.7380, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.31927868723869324
distance x is tensor(120.3093, device='cuda:3')
benign distance is  tensor(120.3093, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4527098536491394
distance x is tensor(119.5481, device='cuda:3')
benign distance is  tensor(119.5481, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5701569318771362
distance x is tensor(118.3643, device='cuda:3')
benign distance is  tensor(118.3643, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9377870559692383
distance x is tensor(127.4880, device='cuda:3')
benign distance is  tensor(127.4880, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.39136141538619995
distance x is tensor(123.6757, device='cuda:3')
benign distance is  tensor(123.6757, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.41656938195228577
distance x is tensor(132.3186, device='cuda:3')
benign distance is  tensor(132.3186, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5003058314323425
distance x is tensor(112.1796, device='cuda:3')
benign distance is  tensor(112.1796, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6443750858306885
distance x is tensor(131.0816, device='cuda:3')
benign distance is  tensor(131.0816, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.289901465177536
distance x is tensor(123.6867, device='cuda:3')
benign distance is  tensor(123.6867, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7013057470321655
distance x is tensor(130.3295, device='cuda:3')
benign distance is  tensor(130.3295, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7824615240097046
distance x is tensor(118.6413, device='cuda:3')
benign distance is  tensor(118.6413, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5907842516899109
distance x is tensor(132.2241, device='cuda:3')
benign distance is  tensor(132.2241, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.27189531922340393
distance x is tensor(116.1443, device='cuda:3')
benign distance is  tensor(116.1443, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.30118653178215027
distance x is tensor(121.0472, device='cuda:3')
benign distance is  tensor(121.0472, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.21053509414196014
distance x is tensor(124.3823, device='cuda:3')
benign distance is  tensor(124.3823, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5028371810913086
distance x is tensor(107.9193, device='cuda:3')
benign distance is  tensor(107.9193, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5499190092086792
distance x is tensor(115.7602, device='cuda:3')
benign distance is  tensor(115.7602, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09327748417854309
distance x is tensor(123.4275, device='cuda:3')
benign distance is  tensor(123.4275, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.365237295627594
distance x is tensor(136.9539, device='cuda:3')
benign distance is  tensor(136.9539, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2836460471153259
distance x is tensor(120.3777, device='cuda:3')
benign distance is  tensor(120.3777, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3100569248199463
distance x is tensor(117.6901, device='cuda:3')
benign distance is  tensor(117.6901, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.273328959941864
distance x is tensor(115.9294, device='cuda:3')
benign distance is  tensor(115.9294, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.19113674759864807
distance x is tensor(122.3770, device='cuda:3')
benign distance is  tensor(122.3770, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5214461088180542
distance x is tensor(122.5576, device='cuda:3')
benign distance is  tensor(122.5576, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.6480962038040161
distance x is tensor(125.4593, device='cuda:3')
benign distance is  tensor(125.4593, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2602580487728119
distance x is tensor(126.4366, device='cuda:3')
benign distance is  tensor(126.4366, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.10329697281122208
distance x is tensor(113.3549, device='cuda:3')
benign distance is  tensor(113.3549, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.1751299351453781
distance x is tensor(118.3111, device='cuda:3')
benign distance is  tensor(118.3111, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4713671803474426
distance x is tensor(109.5150, device='cuda:3')
benign distance is  tensor(109.5150, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3830110728740692
distance x is tensor(120.3759, device='cuda:3')
benign distance is  tensor(120.3759, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6479419469833374
distance x is tensor(123.9438, device='cuda:3')
benign distance is  tensor(123.9438, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.28868359327316284
distance x is tensor(126.0790, device='cuda:3')
benign distance is  tensor(126.0790, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(113.4296, device='cuda:3')
compute distance is  tensor(113.4296, device='cuda:3')
compute norm is  tensor(64.7967, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.7185, device='cuda:3')
compute distance is  tensor(119.7185, device='cuda:3')
compute norm is  tensor(64.8487, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7736, device='cuda:3')
compute distance is  tensor(128.7736, device='cuda:3')
compute norm is  tensor(64.9802, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3638, device='cuda:3')
compute distance is  tensor(123.3638, device='cuda:3')
compute norm is  tensor(64.9407, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6021, device='cuda:3')
compute distance is  tensor(131.6021, device='cuda:3')
compute norm is  tensor(65.2743, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1409, device='cuda:3')
compute distance is  tensor(132.1409, device='cuda:3')
compute norm is  tensor(65.2991, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7027, device='cuda:3')
compute distance is  tensor(123.7027, device='cuda:3')
compute norm is  tensor(64.9918, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.1812, device='cuda:3')
compute distance is  tensor(121.1812, device='cuda:3')
compute norm is  tensor(64.9939, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0014, device='cuda:3')
compute distance is  tensor(129.0014, device='cuda:3')
compute norm is  tensor(65.1308, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4866, device='cuda:3')
compute distance is  tensor(128.4866, device='cuda:3')
compute norm is  tensor(65.0950, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3720, device='cuda:3')
compute distance is  tensor(132.3720, device='cuda:3')
compute norm is  tensor(65.2517, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1009, device='cuda:3')
compute distance is  tensor(122.1009, device='cuda:3')
compute norm is  tensor(65.0992, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(132.3720, device='cuda:3')
distance x is tensor(107494.9766, device='cuda:3')
distance x is tensor(107494.9766, device='cuda:3')
________________________________
test distance is  tensor(107494.9766, device='cuda:3')
test distance1 is  tensor(107494.9766, device='cuda:3')
test similarity is  tensor(0.5817, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130094826552435.72
test entropy is  0.0
________________________________
cal ratio is  0.03438982877937249
distance x is tensor(3696.7390, device='cuda:3')
cal_distance is  tensor(3696.7390, device='cuda:3')
cal ratio is  0.18544482215382288
distance x is tensor(685.5452, device='cuda:3')
cal_distance is  tensor(685.5452, device='cuda:3')
cal ratio is  0.4306317614839789
distance x is tensor(295.2204, device='cuda:3')
cal_distance is  tensor(295.2204, device='cuda:3')
cal ratio is  0.6562222034925349
distance x is tensor(193.7319, device='cuda:3')
cal_distance is  tensor(193.7319, device='cuda:3')
cal ratio is  0.8100718004140011
distance x is tensor(156.9377, device='cuda:3')
cal_distance is  tensor(156.9377, device='cuda:3')
cal ratio is  0.9000370739347441
distance x is tensor(141.2503, device='cuda:3')
cal_distance is  tensor(141.2503, device='cuda:3')
cal ratio is  0.9487011548487125
distance x is tensor(134.0046, device='cuda:3')
cal_distance is  tensor(134.0046, device='cuda:3')
cal ratio is  0.9740119722837793
distance x is tensor(130.5222, device='cuda:3')
cal_distance is  tensor(130.5222, device='cuda:3')
distance x is tensor(130.5222, device='cuda:3')
return_distance is  tensor(130.5222, device='cuda:3')
distance x is tensor(130.5121, device='cuda:3')
distance x is tensor(130.5121, device='cuda:3')
________________________________
test distance is  tensor(130.5121, device='cuda:3')
test distance1 is  tensor(130.5121, device='cuda:3')
test similarity is  tensor(0.9879, device='cuda:3')
test acc is  0.46551666682300846
test loss is 13.234110807813307
test entropy is  0.08605885787058805
________________________________
0
distance x is tensor(130.5121, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.08347788489838717
avg test loss is  13.375480233479156
avg accuracy is  0.8880500001563217
solo acc is  0.4674833334896752
compute similarity  is  tensor(0.9879, device='cuda:3')
compute_distance is  tensor(130.5121, device='cuda:3')
compute_norm is  tensor(68.8470, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.7120, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9119406134716229
avg test loss is  1.3328997507405433
avg accuracy is  0.8659166668229893
solo acc is  0.34328333348967366
compute similarity  is  tensor(0.9869, device='cuda:3')
compute_distance is  tensor(133.7120, device='cuda:3')
compute_norm is  tensor(68.1802, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.3485, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8707314998483353
avg test loss is  1.4244976132663327
avg accuracy is  0.8664333334896559
solo acc is  0.27743333348967236
compute similarity  is  tensor(0.9866, device='cuda:3')
compute_distance is  tensor(134.3485, device='cuda:3')
compute_norm is  tensor(67.8264, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.6530, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8636533110889036
avg test loss is  1.4010051331286237
avg accuracy is  0.8667666668229893
solo acc is  0.2764666668230056
compute similarity  is  tensor(0.9864, device='cuda:3')
compute_distance is  tensor(134.6530, device='cuda:3')
compute_norm is  tensor(67.4827, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.9402, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.857885959623719
avg test loss is  1.3775523238853096
avg accuracy is  0.8700833334896557
solo acc is  0.2722166668230056
compute similarity  is  tensor(0.9862, device='cuda:3')
compute_distance is  tensor(134.9402, device='cuda:3')
compute_norm is  tensor(67.1460, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.2423, device='cuda:3')
distance x is tensor(135.2423, device='cuda:3')
________________________________
test distance is  tensor(135.2423, device='cuda:3')
test distance1 is  tensor(135.2423, device='cuda:3')
test similarity is  tensor(0.9861, device='cuda:3')
test acc is  0.26231666682300525
test loss is 1.3729881484117081
test entropy is  0.8455640238993711
________________________________
cal ratio is  0.969544661202456
distance x is tensor(131.1320, device='cuda:3')
cal_distance is  tensor(131.1320, device='cuda:3')
distance x is tensor(131.1320, device='cuda:3')
return_distance is  tensor(131.1320, device='cuda:3')
distance x is tensor(131.1233, device='cuda:3')
distance x is tensor(131.1233, device='cuda:3')
________________________________
test distance is  tensor(131.1233, device='cuda:3')
test distance1 is  tensor(131.1233, device='cuda:3')
test similarity is  tensor(0.9868, device='cuda:3')
test acc is  0.3355000001563402
test loss is 1.2466746129588024
test entropy is  0.8854340377138622
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal loss is 0.9884700775146484
mal norm is  tensor(614.5887, device='cuda:3')
distance x is tensor(131.1320, device='cuda:3')
mal distance is  tensor(131.1320, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 14
weight size is  torch.Size([20, 215370])
norm res is  tensor([532.2182, 504.1737, 462.8475, 456.5034, 429.9721, 489.4041, 489.9440,
        494.3120, 614.5888, 614.5887, 614.5888, 614.5887, 614.5888, 614.5887,
        614.5888, 614.5887, 614.5888, 614.5887, 614.5888, 614.5887],
       device='cuda:3')
sorted_norm is   tensor([429.9721, 456.5034, 462.8475, 489.4041, 489.9440, 494.3120, 504.1737,
        532.2182, 614.5887, 614.5887, 614.5887, 614.5887, 614.5887, 614.5887,
        614.5888, 614.5888, 614.5888, 614.5888, 614.5888, 614.5888],
       device='cuda:3')
used idx is  tensor([ 4,  3,  2,  5,  6,  7,  1,  0, 19, 17, 13, 15, 11,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.57% 

Test Accuracy: 87.62% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4296814799308777
distance x is tensor(121.2987, device='cuda:3')
benign distance is  tensor(121.2987, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.17673203349113464
distance x is tensor(135.0993, device='cuda:3')
benign distance is  tensor(135.0993, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.36994805932044983
distance x is tensor(129.0894, device='cuda:3')
benign distance is  tensor(129.0894, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4015563130378723
distance x is tensor(164.8331, device='cuda:3')
benign distance is  tensor(164.8331, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6906373500823975
distance x is tensor(121.5763, device='cuda:3')
benign distance is  tensor(121.5763, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.699378252029419
distance x is tensor(135.5457, device='cuda:3')
benign distance is  tensor(135.5457, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6011431813240051
distance x is tensor(123.4296, device='cuda:3')
benign distance is  tensor(123.4296, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.19677208364009857
distance x is tensor(134.9929, device='cuda:3')
benign distance is  tensor(134.9929, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.2409, device='cuda:3')
compute distance is  tensor(118.2409, device='cuda:3')
compute norm is  tensor(66.2875, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.9514, device='cuda:3')
compute distance is  tensor(118.9514, device='cuda:3')
compute norm is  tensor(66.5040, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5310, device='cuda:3')
compute distance is  tensor(136.5310, device='cuda:3')
compute norm is  tensor(66.7233, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8328, device='cuda:3')
compute distance is  tensor(128.8328, device='cuda:3')
compute norm is  tensor(66.6680, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8120, device='cuda:3')
compute distance is  tensor(133.8120, device='cuda:3')
compute norm is  tensor(66.6606, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9077, device='cuda:3')
compute distance is  tensor(127.9077, device='cuda:3')
compute norm is  tensor(66.7574, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3373, device='cuda:3')
compute distance is  tensor(136.3373, device='cuda:3')
compute norm is  tensor(66.7928, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1024, device='cuda:3')
compute distance is  tensor(118.1024, device='cuda:3')
compute norm is  tensor(66.5507, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8451, device='cuda:3')
compute distance is  tensor(137.8451, device='cuda:3')
compute norm is  tensor(66.7043, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3986, device='cuda:3')
compute distance is  tensor(127.3986, device='cuda:3')
compute norm is  tensor(66.6974, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9706, device='cuda:3')
compute distance is  tensor(145.9706, device='cuda:3')
compute norm is  tensor(66.9523, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4546, device='cuda:3')
compute distance is  tensor(137.4546, device='cuda:3')
compute norm is  tensor(66.9515, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.9706, device='cuda:3')
distance x is tensor(107452.4688, device='cuda:3')
distance x is tensor(107452.4688, device='cuda:3')
________________________________
test distance is  tensor(107452.4688, device='cuda:3')
test distance1 is  tensor(107452.4688, device='cuda:3')
test similarity is  tensor(0.6294, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130093352402140.52
test entropy is  0.0
________________________________
cal ratio is  0.03612023388451351
distance x is tensor(3881.2134, device='cuda:3')
cal_distance is  tensor(3881.2134, device='cuda:3')
cal ratio is  0.19005310904096365
distance x is tensor(737.6407, device='cuda:3')
cal_distance is  tensor(737.6407, device='cuda:3')
cal ratio is  0.43594961435993523
distance x is tensor(321.5771, device='cuda:3')
cal_distance is  tensor(321.5771, device='cuda:3')
cal ratio is  0.660261878073957
distance x is tensor(212.3268, device='cuda:3')
cal_distance is  tensor(212.3268, device='cuda:3')
cal ratio is  0.812561731399608
distance x is tensor(172.5296, device='cuda:3')
cal_distance is  tensor(172.5296, device='cuda:3')
cal ratio is  0.9014195816897708
distance x is tensor(155.5220, device='cuda:3')
cal_distance is  tensor(155.5220, device='cuda:3')
cal ratio is  0.9494296273543007
distance x is tensor(147.6575, device='cuda:3')
cal_distance is  tensor(147.6575, device='cuda:3')
cal ratio is  0.9743859820942931
distance x is tensor(143.8755, device='cuda:3')
cal_distance is  tensor(143.8755, device='cuda:3')
distance x is tensor(143.8755, device='cuda:3')
return_distance is  tensor(143.8755, device='cuda:3')
distance x is tensor(143.8654, device='cuda:3')
distance x is tensor(143.8654, device='cuda:3')
________________________________
test distance is  tensor(143.8654, device='cuda:3')
test distance1 is  tensor(143.8654, device='cuda:3')
test similarity is  tensor(0.9881, device='cuda:3')
test acc is  0.10121666682299864
test loss is 107.56858161161703
test entropy is  0.0012950841314865943
________________________________
0
distance x is tensor(143.8654, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0013930490417937763
avg test loss is  107.10467273085865
avg accuracy is  0.7281500001563289
solo acc is  0.10145000015633197
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(143.8654, device='cuda:3')
compute_norm is  tensor(71.3321, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4703.3237, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.542475406803302
avg test loss is  2.8953410857267725
avg accuracy is  0.10161666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0483, device='cuda:3')
compute_distance is  tensor(4703.3237, device='cuda:3')
compute_norm is  tensor(721.6145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4681.7861, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8326019781357699
avg test loss is  3.663440174893784
avg accuracy is  0.10160000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0483, device='cuda:3')
compute_distance is  tensor(4681.7861, device='cuda:3')
compute_norm is  tensor(718.4116, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4659.8232, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5507777605229602
avg test loss is  2.877792621980598
avg accuracy is  0.1017333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0483, device='cuda:3')
compute_distance is  tensor(4659.8232, device='cuda:3')
compute_norm is  tensor(714.8066, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4638.5181, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8391993822954865
avg test loss is  3.639345330470152
avg accuracy is  0.1014833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0483, device='cuda:3')
compute_distance is  tensor(4638.5181, device='cuda:3')
compute_norm is  tensor(711.6650, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4616.8188, device='cuda:3')
distance x is tensor(4616.8188, device='cuda:3')
________________________________
test distance is  tensor(4616.8188, device='cuda:3')
test distance1 is  tensor(4616.8188, device='cuda:3')
test similarity is  tensor(0.0482, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8701640245502693
test entropy is  1.5543244580215991
________________________________
cal ratio is  0.17425583568718167
distance x is tensor(804.5065, device='cuda:3')
cal_distance is  tensor(804.5065, device='cuda:3')
cal ratio is  0.4174399045205861
distance x is tensor(335.8325, device='cuda:3')
cal_distance is  tensor(335.8325, device='cuda:3')
cal ratio is  0.6460964634664216
distance x is tensor(216.9798, device='cuda:3')
cal_distance is  tensor(216.9798, device='cuda:3')
cal ratio is  0.8038019239760469
distance x is tensor(174.4086, device='cuda:3')
cal_distance is  tensor(174.4086, device='cuda:3')
cal ratio is  0.8965506153110109
distance x is tensor(156.3660, device='cuda:3')
cal_distance is  tensor(156.3660, device='cuda:3')
cal ratio is  0.9468639643186552
distance x is tensor(148.0573, device='cuda:3')
cal_distance is  tensor(148.0573, device='cuda:3')
cal ratio is  0.9730694065004479
distance x is tensor(144.0700, device='cuda:3')
cal_distance is  tensor(144.0700, device='cuda:3')
distance x is tensor(144.0700, device='cuda:3')
return_distance is  tensor(144.0700, device='cuda:3')
distance x is tensor(144.0721, device='cuda:3')
distance x is tensor(144.0721, device='cuda:3')
________________________________
test distance is  tensor(144.0721, device='cuda:3')
test distance1 is  tensor(144.0721, device='cuda:3')
test similarity is  tensor(0.8932, device='cuda:3')
test acc is  0.09846666682299865
test loss is 530.7979091977768
test entropy is  0.07705365826384718
________________________________
0
distance x is tensor(144.0721, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07656621683261364
avg test loss is  533.6793063881555
avg accuracy is  0.16000000015633392
solo acc is  0.09918333348966532
compute similarity  is  tensor(0.8932, device='cuda:3')
compute_distance is  tensor(144.0721, device='cuda:3')
compute_norm is  tensor(73.8501, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(271.6078, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.992451037552311
avg test loss is  1.5957273929866391
avg accuracy is  0.449633333489675
solo acc is  0.3017000001563396
compute similarity  is  tensor(0.7876, device='cuda:3')
compute_distance is  tensor(271.6078, device='cuda:3')
compute_norm is  tensor(85.7931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(271.6078, device='cuda:3')
distance x is tensor(271.6078, device='cuda:3')
________________________________
test distance is  tensor(271.6078, device='cuda:3')
test distance1 is  tensor(271.6078, device='cuda:3')
test similarity is  tensor(0.7876, device='cuda:3')
test acc is  0.3016333334896729
test loss is 1.5924663186581658
test entropy is  0.9927058142385503
________________________________
cal ratio is  0.7184352783626737
distance x is tensor(195.1291, device='cuda:3')
cal_distance is  tensor(195.1291, device='cuda:3')
cal ratio is  0.8476132396984211
distance x is tensor(165.3937, device='cuda:3')
cal_distance is  tensor(165.3937, device='cuda:3')
cal ratio is  0.9206600520627553
distance x is tensor(152.2712, device='cuda:3')
cal_distance is  tensor(152.2712, device='cuda:3')
cal ratio is  0.9595107863442623
distance x is tensor(146.1058, device='cuda:3')
cal_distance is  tensor(146.1058, device='cuda:3')
cal ratio is  0.9795464968411272
distance x is tensor(143.1174, device='cuda:3')
cal_distance is  tensor(143.1174, device='cuda:3')
distance x is tensor(143.1174, device='cuda:3')
return_distance is  tensor(143.1174, device='cuda:3')
distance x is tensor(143.1214, device='cuda:3')
distance x is tensor(143.1214, device='cuda:3')
________________________________
test distance is  tensor(143.1214, device='cuda:3')
test distance1 is  tensor(143.1214, device='cuda:3')
test similarity is  tensor(0.9261, device='cuda:3')
test acc is  0.4362166668230082
test loss is 1.3933160667226259
test entropy is  1.2429705986590274
________________________________
0
distance x is tensor(143.1214, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2430083376766523
avg test loss is  1.3905806070578886
avg accuracy is  0.6251000001563355
solo acc is  0.4360833334896748
compute similarity  is  tensor(0.9261, device='cuda:3')
compute_distance is  tensor(143.1214, device='cuda:3')
compute_norm is  tensor(72.1986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(146.8426, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6434141529013099
avg test loss is  2.4489556608169574
avg accuracy is  0.4588000001563417
solo acc is  0.11783333348966525
compute similarity  is  tensor(0.9258, device='cuda:3')
compute_distance is  tensor(146.8426, device='cuda:3')
compute_norm is  tensor(71.9035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.8320, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9616752877545509
avg test loss is  1.4567028135378985
avg accuracy is  0.5768333334896728
solo acc is  0.2847333334896725
compute similarity  is  tensor(0.9256, device='cuda:3')
compute_distance is  tensor(149.8320, device='cuda:3')
compute_norm is  tensor(71.5496, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(149.8274, device='cuda:3')
________________________________
test distance is  tensor(149.8274, device='cuda:3')
test similarity is  tensor(0.9256, device='cuda:3')
test acc is  0.575783333489673
test loss is 1.451954771651388
test entropy is  0.961912287196625
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3148705959320068
mal norm is  tensor(1288.2332, device='cuda:3')
distance x is tensor(149.8274, device='cuda:3')
mal distance is  tensor(149.8274, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 25
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 507.5597,  552.4473,  550.9957,  652.0132,  516.1099,  568.3143,
         499.2935,  554.8878, 1288.2330, 1288.2332, 1288.2330, 1288.2332,
        1288.2330, 1288.2332, 1288.2330, 1288.2332, 1288.2330, 1288.2332,
        1288.2330, 1288.2332,  630.4182,  599.8788,  632.8506,  614.2963,
         608.1075,  712.8629,  624.7705,  576.0967,  593.9634,  575.9548,
         588.1699,  609.2735,  603.4490,  621.8080,  559.2101,  626.5269],
       device='cuda:3')
sorted_norm is   tensor([ 499.2935,  507.5597,  516.1099,  550.9957,  552.4473,  554.8878,
         559.2101,  568.3143,  575.9548,  576.0967,  588.1699,  593.9634,
         599.8788,  603.4490,  608.1075,  609.2735,  614.2963,  621.8080,
         624.7705,  626.5269,  630.4182,  632.8506,  652.0132,  712.8629,
        1288.2330, 1288.2330, 1288.2330, 1288.2330, 1288.2330, 1288.2330,
        1288.2332, 1288.2332, 1288.2332, 1288.2332, 1288.2332, 1288.2332],
       device='cuda:3')
used idx is  tensor([ 6,  0,  4,  2,  1,  7, 34,  5, 29, 27, 30, 28, 21, 32, 24, 31, 23, 33,
        26, 35, 20, 22,  3, 25, 10], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 88.85% 

Test Accuracy: 87.82% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7090771198272705
distance x is tensor(140.8346, device='cuda:3')
benign distance is  tensor(140.8346, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5820103883743286
distance x is tensor(132.7856, device='cuda:3')
benign distance is  tensor(132.7856, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17933779954910278
distance x is tensor(142.0597, device='cuda:3')
benign distance is  tensor(142.0597, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9182198643684387
distance x is tensor(105.5338, device='cuda:3')
benign distance is  tensor(105.5338, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.47870057821273804
distance x is tensor(99.8242, device='cuda:3')
benign distance is  tensor(99.8242, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5412648320198059
distance x is tensor(127.9634, device='cuda:3')
benign distance is  tensor(127.9634, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.56920325756073
distance x is tensor(122.5941, device='cuda:3')
benign distance is  tensor(122.5941, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.385337769985199
distance x is tensor(114.6343, device='cuda:3')
benign distance is  tensor(114.6343, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.43681392073631287
distance x is tensor(118.5603, device='cuda:3')
benign distance is  tensor(118.5603, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.27999570965766907
distance x is tensor(129.5427, device='cuda:3')
benign distance is  tensor(129.5427, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6467915773391724
distance x is tensor(116.8278, device='cuda:3')
benign distance is  tensor(116.8278, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7652942538261414
distance x is tensor(121.0445, device='cuda:3')
benign distance is  tensor(121.0445, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7189249396324158
distance x is tensor(113.9359, device='cuda:3')
benign distance is  tensor(113.9359, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6205264329910278
distance x is tensor(122.9595, device='cuda:3')
benign distance is  tensor(122.9595, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.17837342619895935
distance x is tensor(114.7044, device='cuda:3')
benign distance is  tensor(114.7044, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6593979597091675
distance x is tensor(123.1704, device='cuda:3')
benign distance is  tensor(123.1704, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.13680467009544373
distance x is tensor(128.2475, device='cuda:3')
benign distance is  tensor(128.2475, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8094118237495422
distance x is tensor(120.5661, device='cuda:3')
benign distance is  tensor(120.5661, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.36649030447006226
distance x is tensor(124.4390, device='cuda:3')
benign distance is  tensor(124.4390, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.30413228273391724
distance x is tensor(127.9993, device='cuda:3')
benign distance is  tensor(127.9993, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6776273846626282
distance x is tensor(124.4402, device='cuda:3')
benign distance is  tensor(124.4402, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4912812113761902
distance x is tensor(122.1366, device='cuda:3')
benign distance is  tensor(122.1366, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.36687254905700684
distance x is tensor(128.8273, device='cuda:3')
benign distance is  tensor(128.8273, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.41757744550704956
distance x is tensor(114.8748, device='cuda:3')
benign distance is  tensor(114.8748, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(125.3720, device='cuda:3')
compute distance is  tensor(125.3720, device='cuda:3')
compute norm is  tensor(65.9378, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1357, device='cuda:3')
compute distance is  tensor(114.1357, device='cuda:3')
compute norm is  tensor(65.8031, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8118, device='cuda:3')
compute distance is  tensor(122.8118, device='cuda:3')
compute norm is  tensor(66.0217, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8876, device='cuda:3')
compute distance is  tensor(122.8876, device='cuda:3')
compute norm is  tensor(65.8631, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6600, device='cuda:3')
compute distance is  tensor(124.6600, device='cuda:3')
compute norm is  tensor(66.0357, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5104, device='cuda:3')
compute distance is  tensor(127.5104, device='cuda:3')
compute norm is  tensor(66.2376, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0697, device='cuda:3')
compute distance is  tensor(120.0697, device='cuda:3')
compute norm is  tensor(65.9067, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.4456, device='cuda:3')
compute distance is  tensor(114.4456, device='cuda:3')
compute norm is  tensor(65.7469, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7741, device='cuda:3')
compute distance is  tensor(126.7741, device='cuda:3')
compute norm is  tensor(65.9114, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.2831, device='cuda:3')
compute distance is  tensor(117.2831, device='cuda:3')
compute norm is  tensor(66.0429, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4879, device='cuda:3')
compute distance is  tensor(129.4879, device='cuda:3')
compute norm is  tensor(66.0865, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.9233, device='cuda:3')
compute distance is  tensor(118.9233, device='cuda:3')
compute norm is  tensor(65.9813, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(129.4879, device='cuda:3')
distance x is tensor(107492.3828, device='cuda:3')
distance x is tensor(107492.3828, device='cuda:3')
________________________________
test distance is  tensor(107492.3828, device='cuda:3')
test distance1 is  tensor(107492.3828, device='cuda:3')
test similarity is  tensor(0.5844, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130110853640864.48
test entropy is  0.0
________________________________
cal ratio is  0.03401353754985789
distance x is tensor(3656.2014, device='cuda:3')
cal_distance is  tensor(3656.2014, device='cuda:3')
cal ratio is  0.1844274563400912
distance x is tensor(674.3080, device='cuda:3')
cal_distance is  tensor(674.3080, device='cuda:3')
cal ratio is  0.42944889564784106
distance x is tensor(289.5837, device='cuda:3')
cal_distance is  tensor(289.5837, device='cuda:3')
cal ratio is  0.6553202475734228
distance x is tensor(189.7718, device='cuda:3')
cal_distance is  tensor(189.7718, device='cuda:3')
cal ratio is  0.8095148337944824
distance x is tensor(153.6240, device='cuda:3')
cal_distance is  tensor(153.6240, device='cuda:3')
cal ratio is  0.8997276280375752
distance x is tensor(138.2203, device='cuda:3')
cal_distance is  tensor(138.2203, device='cuda:3')
cal ratio is  0.9485379220377665
distance x is tensor(131.1075, device='cuda:3')
cal_distance is  tensor(131.1075, device='cuda:3')
cal ratio is  0.9739280721250584
distance x is tensor(127.6894, device='cuda:3')
cal_distance is  tensor(127.6894, device='cuda:3')
distance x is tensor(127.6894, device='cuda:3')
return_distance is  tensor(127.6894, device='cuda:3')
distance x is tensor(127.6794, device='cuda:3')
distance x is tensor(127.6794, device='cuda:3')
________________________________
test distance is  tensor(127.6794, device='cuda:3')
test distance1 is  tensor(127.6794, device='cuda:3')
test similarity is  tensor(0.9888, device='cuda:3')
test acc is  0.15436666682300024
test loss is 45.397226018437955
test entropy is  0.027093427320473148
________________________________
0
distance x is tensor(127.6794, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.02696616214876652
avg test loss is  45.40759709445653
avg accuracy is  0.8370000001563237
solo acc is  0.15438333348966687
compute similarity  is  tensor(0.9888, device='cuda:3')
compute_distance is  tensor(127.6794, device='cuda:3')
compute_norm is  tensor(69.7522, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(129.8053, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9362868180534224
avg test loss is  1.3826358745347207
avg accuracy is  0.8238500001563243
solo acc is  0.33085000015634014
compute similarity  is  tensor(0.9883, device='cuda:3')
compute_distance is  tensor(129.8053, device='cuda:3')
compute_norm is  tensor(69.3440, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.2719, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8857764092716836
avg test loss is  1.465737146228107
avg accuracy is  0.8223666668229911
solo acc is  0.26976666682300554
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(130.2719, device='cuda:3')
compute_norm is  tensor(68.9956, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.4662, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8787233737358915
avg test loss is  1.449844149511252
avg accuracy is  0.8269833334896576
solo acc is  0.25888333348967185
compute similarity  is  tensor(0.9879, device='cuda:3')
compute_distance is  tensor(130.4662, device='cuda:3')
compute_norm is  tensor(68.6515, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.6717, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8598372556888727
avg test loss is  1.4325904804252103
avg accuracy is  0.8288166668229907
solo acc is  0.2584500001563385
compute similarity  is  tensor(0.9878, device='cuda:3')
compute_distance is  tensor(130.6717, device='cuda:3')
compute_norm is  tensor(68.3109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.9431, device='cuda:3')
distance x is tensor(130.9431, device='cuda:3')
________________________________
test distance is  tensor(130.9431, device='cuda:3')
test distance1 is  tensor(130.9431, device='cuda:3')
test similarity is  tensor(0.9876, device='cuda:3')
test acc is  0.25915000015633854
test loss is 1.4041035857790314
test entropy is  0.851032903834955
________________________________
cal ratio is  0.9745390702264584
distance x is tensor(127.6182, device='cuda:3')
cal_distance is  tensor(127.6182, device='cuda:3')
distance x is tensor(127.6182, device='cuda:3')
return_distance is  tensor(127.6182, device='cuda:3')
distance x is tensor(127.6091, device='cuda:3')
distance x is tensor(127.6091, device='cuda:3')
________________________________
test distance is  tensor(127.6091, device='cuda:3')
test distance1 is  tensor(127.6091, device='cuda:3')
test similarity is  tensor(0.9882, device='cuda:3')
test acc is  0.2975833334896728
test loss is 1.3277389996849907
test entropy is  0.8815345199885907
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.114776372909546
mal norm is  tensor(597.1978, device='cuda:3')
distance x is tensor(127.6182, device='cuda:3')
mal distance is  tensor(127.6182, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([607.0258, 555.1764, 579.0155, 458.0072, 422.8157, 543.7901, 500.3600,
        493.5556, 597.1978, 597.1979, 597.1978, 597.1979, 597.1978, 597.1979,
        597.1978, 597.1979, 597.1978, 597.1979, 597.1978, 597.1979, 539.1037,
        575.4261, 521.4087, 571.2264, 525.1581, 525.2275, 548.9358, 484.5201],
       device='cuda:3')
sorted_norm is   tensor([422.8157, 458.0072, 484.5201, 493.5556, 500.3600, 521.4087, 525.1581,
        525.2275, 539.1037, 543.7901, 548.9358, 555.1764, 571.2264, 575.4261,
        579.0155, 597.1978, 597.1978, 597.1978, 597.1978, 597.1978, 597.1978,
        597.1979, 597.1979, 597.1979, 597.1979, 597.1979, 597.1979, 607.0258],
       device='cuda:3')
used idx is  tensor([ 4,  3, 27,  7,  6, 22, 24, 25, 20,  5, 26,  1, 23, 21,  2, 18, 14, 16,
        12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.04% 

Test Accuracy: 88.27% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5646263957023621
distance x is tensor(124.2038, device='cuda:3')
benign distance is  tensor(124.2038, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7076030969619751
distance x is tensor(117.3659, device='cuda:3')
benign distance is  tensor(117.3659, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.30265840888023376
distance x is tensor(116.1531, device='cuda:3')
benign distance is  tensor(116.1531, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8583534359931946
distance x is tensor(118.1412, device='cuda:3')
benign distance is  tensor(118.1412, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5632501840591431
distance x is tensor(106.2059, device='cuda:3')
benign distance is  tensor(106.2059, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7244327068328857
distance x is tensor(123.1491, device='cuda:3')
benign distance is  tensor(123.1491, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6483416557312012
distance x is tensor(112.5067, device='cuda:3')
benign distance is  tensor(112.5067, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7912023663520813
distance x is tensor(116.1874, device='cuda:3')
benign distance is  tensor(116.1874, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.39456653594970703
distance x is tensor(124.5290, device='cuda:3')
benign distance is  tensor(124.5290, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.41383758187294006
distance x is tensor(128.7283, device='cuda:3')
benign distance is  tensor(128.7283, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0676894187927246
distance x is tensor(126.9821, device='cuda:3')
benign distance is  tensor(126.9821, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8178925514221191
distance x is tensor(124.5654, device='cuda:3')
benign distance is  tensor(124.5654, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.34929198026657104
distance x is tensor(122.7055, device='cuda:3')
benign distance is  tensor(122.7055, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5780450105667114
distance x is tensor(115.8781, device='cuda:3')
benign distance is  tensor(115.8781, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.15344053506851196
distance x is tensor(133.6587, device='cuda:3')
benign distance is  tensor(133.6587, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6160309314727783
distance x is tensor(127.1764, device='cuda:3')
benign distance is  tensor(127.1764, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.7189, device='cuda:3')
compute distance is  tensor(123.7189, device='cuda:3')
compute norm is  tensor(66.4811, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.1377, device='cuda:3')
compute distance is  tensor(119.1377, device='cuda:3')
compute norm is  tensor(66.4121, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3298, device='cuda:3')
compute distance is  tensor(130.3298, device='cuda:3')
compute norm is  tensor(66.7099, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7874, device='cuda:3')
compute distance is  tensor(126.7874, device='cuda:3')
compute norm is  tensor(66.5986, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1212, device='cuda:3')
compute distance is  tensor(124.1212, device='cuda:3')
compute norm is  tensor(66.6696, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8498, device='cuda:3')
compute distance is  tensor(128.8498, device='cuda:3')
compute norm is  tensor(66.8416, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0871, device='cuda:3')
compute distance is  tensor(118.0871, device='cuda:3')
compute norm is  tensor(66.6499, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.5741, device='cuda:3')
compute distance is  tensor(122.5741, device='cuda:3')
compute norm is  tensor(66.6134, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1134, device='cuda:3')
compute distance is  tensor(131.1134, device='cuda:3')
compute norm is  tensor(66.6454, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3430, device='cuda:3')
compute distance is  tensor(129.3430, device='cuda:3')
compute norm is  tensor(66.8346, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9080, device='cuda:3')
compute distance is  tensor(136.9080, device='cuda:3')
compute norm is  tensor(67.1027, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.7917, device='cuda:3')
compute distance is  tensor(112.7917, device='cuda:3')
compute norm is  tensor(66.5020, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.9080, device='cuda:3')
distance x is tensor(107477.6797, device='cuda:3')
distance x is tensor(107477.6797, device='cuda:3')
________________________________
test distance is  tensor(107477.6797, device='cuda:3')
test distance1 is  tensor(107477.6797, device='cuda:3')
test similarity is  tensor(0.6006, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130042407473562.47
test entropy is  0.0
________________________________
cal ratio is  0.03497690103538316
distance x is tensor(3759.2412, device='cuda:3')
cal_distance is  tensor(3759.2412, device='cuda:3')
cal ratio is  0.1870210003414586
distance x is tensor(703.0612, device='cuda:3')
cal_distance is  tensor(703.0612, device='cuda:3')
cal ratio is  0.4324579666155559
distance x is tensor(304.0472, device='cuda:3')
cal_distance is  tensor(304.0472, device='cuda:3')
cal ratio is  0.657612317231795
distance x is tensor(199.9470, device='cuda:3')
cal_distance is  tensor(199.9470, device='cuda:3')
cal ratio is  0.8109294401587828
distance x is tensor(162.1438, device='cuda:3')
cal_distance is  tensor(162.1438, device='cuda:3')
cal ratio is  0.9005136141571325
distance x is tensor(146.0132, device='cuda:3')
cal_distance is  tensor(146.0132, device='cuda:3')
cal ratio is  0.9489522552644533
distance x is tensor(138.5598, device='cuda:3')
cal_distance is  tensor(138.5598, device='cuda:3')
cal ratio is  0.9741409087725623
distance x is tensor(134.9770, device='cuda:3')
cal_distance is  tensor(134.9770, device='cuda:3')
distance x is tensor(134.9770, device='cuda:3')
return_distance is  tensor(134.9770, device='cuda:3')
distance x is tensor(134.9669, device='cuda:3')
distance x is tensor(134.9669, device='cuda:3')
________________________________
test distance is  tensor(134.9669, device='cuda:3')
test distance1 is  tensor(134.9669, device='cuda:3')
test similarity is  tensor(0.9884, device='cuda:3')
test acc is  0.2846500001563391
test loss is 23.94425117537411
test entropy is  0.06720192781858035
________________________________
0
distance x is tensor(134.9669, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.06780013591765977
avg test loss is  23.760484777788108
avg accuracy is  0.8783666668229888
solo acc is  0.28626666682300583
compute similarity  is  tensor(0.9884, device='cuda:3')
compute_distance is  tensor(134.9669, device='cuda:3')
compute_norm is  tensor(70.7911, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.1724, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9296929663432433
avg test loss is  1.342278074671719
avg accuracy is  0.8070166668229918
solo acc is  0.3312666668230068
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(135.1724, device='cuda:3')
compute_norm is  tensor(70.3388, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.6094, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8721147726085394
avg test loss is  1.4418135764502258
avg accuracy is  0.8005500001563254
solo acc is  0.2644333334896719
compute similarity  is  tensor(0.9879, device='cuda:3')
compute_distance is  tensor(135.6094, device='cuda:3')
compute_norm is  tensor(69.9865, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.7272, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8535025002859803
avg test loss is  1.427611248452526
avg accuracy is  0.8018500001563252
solo acc is  0.2572000001563385
compute similarity  is  tensor(0.9877, device='cuda:3')
compute_distance is  tensor(135.7272, device='cuda:3')
compute_norm is  tensor(69.6369, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.8522, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8554226133996236
avg test loss is  1.3995273385220752
avg accuracy is  0.8047666668229918
solo acc is  0.2566000001563385
compute similarity  is  tensor(0.9876, device='cuda:3')
compute_distance is  tensor(135.8522, device='cuda:3')
compute_norm is  tensor(69.2908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.9672, device='cuda:3')
distance x is tensor(135.9672, device='cuda:3')
________________________________
test distance is  tensor(135.9672, device='cuda:3')
test distance1 is  tensor(135.9672, device='cuda:3')
test similarity is  tensor(0.9875, device='cuda:3')
test acc is  0.2506666668230049
test loss is 1.3874064450706247
test entropy is  0.8438646415276314
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2288081645965576
mal norm is  tensor(641.6234, device='cuda:3')
distance x is tensor(135.9763, device='cuda:3')
mal distance is  tensor(135.9763, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([526.8860, 503.7681, 494.9978, 500.3484, 449.5394, 523.2846, 469.3829,
        492.8230, 641.6234, 641.6234, 641.6234, 641.6234, 641.6234, 641.6234,
        641.6234, 641.6234, 641.6234, 641.6234, 641.6234, 641.6234, 522.5993,
        573.9027, 522.7212, 534.0623, 526.3856, 546.7931, 514.7302, 555.5175],
       device='cuda:3')
sorted_norm is   tensor([449.5394, 469.3829, 492.8230, 494.9978, 500.3484, 503.7681, 514.7302,
        522.5993, 522.7212, 523.2846, 526.3856, 526.8860, 534.0623, 546.7931,
        555.5175, 573.9027, 641.6234, 641.6234, 641.6234, 641.6234, 641.6234,
        641.6234, 641.6234, 641.6234, 641.6234, 641.6234, 641.6234, 641.6234],
       device='cuda:3')
used idx is  tensor([ 4,  6,  7,  2,  3,  1, 26, 20, 22,  5, 24,  0, 23, 25, 27, 21, 11, 10,
         8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.16% 

Test Accuracy: 88.11% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19369721412658691
distance x is tensor(134.4002, device='cuda:3')
benign distance is  tensor(134.4002, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6442813277244568
distance x is tensor(126.2639, device='cuda:3')
benign distance is  tensor(126.2639, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10554959625005722
distance x is tensor(125.3275, device='cuda:3')
benign distance is  tensor(125.3275, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5472275018692017
distance x is tensor(99.6587, device='cuda:3')
benign distance is  tensor(99.6587, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6380314826965332
distance x is tensor(104.7303, device='cuda:3')
benign distance is  tensor(104.7303, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.157904028892517
distance x is tensor(131.4444, device='cuda:3')
benign distance is  tensor(131.4444, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34429025650024414
distance x is tensor(118.8427, device='cuda:3')
benign distance is  tensor(118.8427, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16596290469169617
distance x is tensor(123.3276, device='cuda:3')
benign distance is  tensor(123.3276, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6109941005706787
distance x is tensor(136.3289, device='cuda:3')
benign distance is  tensor(136.3289, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.45267611742019653
distance x is tensor(117.1879, device='cuda:3')
benign distance is  tensor(117.1879, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6888233423233032
distance x is tensor(118.2595, device='cuda:3')
benign distance is  tensor(118.2595, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5603772401809692
distance x is tensor(126.2937, device='cuda:3')
benign distance is  tensor(126.2937, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0829224586486816
distance x is tensor(137.6447, device='cuda:3')
benign distance is  tensor(137.6447, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.561933696269989
distance x is tensor(127.3921, device='cuda:3')
benign distance is  tensor(127.3921, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7122482061386108
distance x is tensor(129.0250, device='cuda:3')
benign distance is  tensor(129.0250, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.458382785320282
distance x is tensor(118.6425, device='cuda:3')
benign distance is  tensor(118.6425, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.0807, device='cuda:3')
compute distance is  tensor(129.0807, device='cuda:3')
compute norm is  tensor(67.3471, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5847, device='cuda:3')
compute distance is  tensor(121.5847, device='cuda:3')
compute norm is  tensor(67.3008, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1413, device='cuda:3')
compute distance is  tensor(136.1413, device='cuda:3')
compute norm is  tensor(67.6610, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4963, device='cuda:3')
compute distance is  tensor(131.4963, device='cuda:3')
compute norm is  tensor(67.3792, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.0444, device='cuda:3')
compute distance is  tensor(140.0444, device='cuda:3')
compute norm is  tensor(67.7000, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1225, device='cuda:3')
compute distance is  tensor(128.1225, device='cuda:3')
compute norm is  tensor(67.6084, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5598, device='cuda:3')
compute distance is  tensor(119.5598, device='cuda:3')
compute norm is  tensor(67.1220, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7722, device='cuda:3')
compute distance is  tensor(123.7722, device='cuda:3')
compute norm is  tensor(67.2668, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9322, device='cuda:3')
compute distance is  tensor(136.9322, device='cuda:3')
compute norm is  tensor(67.4611, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1882, device='cuda:3')
compute distance is  tensor(134.1882, device='cuda:3')
compute norm is  tensor(67.6032, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8734, device='cuda:3')
compute distance is  tensor(131.8734, device='cuda:3')
compute norm is  tensor(67.4093, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6322, device='cuda:3')
compute distance is  tensor(125.6322, device='cuda:3')
compute norm is  tensor(67.4071, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(140.0444, device='cuda:3')
distance x is tensor(107472.3984, device='cuda:3')
distance x is tensor(107472.3984, device='cuda:3')
________________________________
test distance is  tensor(107472.3984, device='cuda:3')
test distance1 is  tensor(107472.3984, device='cuda:3')
test similarity is  tensor(0.6051, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130160299074461.75
test entropy is  0.0
________________________________
cal ratio is  0.035376137488915965
distance x is tensor(3801.9639, device='cuda:3')
cal_distance is  tensor(3801.9639, device='cuda:3')
cal ratio is  0.18808531855543742
distance x is tensor(715.0976, device='cuda:3')
cal_distance is  tensor(715.0976, device='cuda:3')
cal ratio is  0.4336868280187585
distance x is tensor(310.1313, device='cuda:3')
cal_distance is  tensor(310.1313, device='cuda:3')
cal ratio is  0.6585459699664116
distance x is tensor(204.2374, device='cuda:3')
cal_distance is  tensor(204.2374, device='cuda:3')
cal ratio is  0.8115050464662422
distance x is tensor(165.7406, device='cuda:3')
cal_distance is  tensor(165.7406, device='cuda:3')
cal ratio is  0.9008331798793886
distance x is tensor(149.3052, device='cuda:3')
cal_distance is  tensor(149.3052, device='cuda:3')
cal ratio is  0.9491206640608956
distance x is tensor(141.7089, device='cuda:3')
cal_distance is  tensor(141.7089, device='cuda:3')
cal ratio is  0.9742273759865366
distance x is tensor(138.0568, device='cuda:3')
cal_distance is  tensor(138.0568, device='cuda:3')
distance x is tensor(138.0568, device='cuda:3')
return_distance is  tensor(138.0568, device='cuda:3')
distance x is tensor(138.0468, device='cuda:3')
distance x is tensor(138.0468, device='cuda:3')
________________________________
test distance is  tensor(138.0468, device='cuda:3')
test distance1 is  tensor(138.0468, device='cuda:3')
test similarity is  tensor(0.9883, device='cuda:3')
test acc is  0.18153333348966874
test loss is 45.22634842146689
test entropy is  0.03076139706740978
________________________________
0
distance x is tensor(138.0468, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0307320336618866
avg test loss is  45.24640130895033
avg accuracy is  0.8730333334896556
solo acc is  0.18160000015633534
compute similarity  is  tensor(0.9883, device='cuda:3')
compute_distance is  tensor(138.0468, device='cuda:3')
compute_norm is  tensor(71.7250, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.3734, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9714177362700261
avg test loss is  1.410505710888519
avg accuracy is  0.7786000001563264
solo acc is  0.2990500001563395
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(139.3734, device='cuda:3')
compute_norm is  tensor(71.4472, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(139.3734, device='cuda:3')
distance x is tensor(139.3734, device='cuda:3')
________________________________
test distance is  tensor(139.3734, device='cuda:3')
test distance1 is  tensor(139.3734, device='cuda:3')
test similarity is  tensor(0.9881, device='cuda:3')
test acc is  0.29841666682300616
test loss is 1.4133934256618719
test entropy is  0.9704920804576833
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2321240901947021
mal norm is  tensor(692.8939, device='cuda:3')
distance x is tensor(139.3826, device='cuda:3')
mal distance is  tensor(139.3826, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 19
weight size is  torch.Size([28, 215370])
norm res is  tensor([580.6542, 521.8195, 534.9630, 425.2789, 432.7829, 548.9921, 488.4062,
        517.7921, 692.8939, 692.8939, 692.8939, 692.8939, 692.8939, 692.8939,
        692.8939, 692.8939, 692.8939, 692.8939, 692.8939, 692.8939, 540.3505,
        594.9918, 627.2691, 560.8395, 555.7977, 545.9574, 573.0797, 577.9741],
       device='cuda:3')
sorted_norm is   tensor([425.2789, 432.7829, 488.4062, 517.7921, 521.8195, 534.9630, 540.3505,
        545.9574, 548.9921, 555.7977, 560.8395, 573.0797, 577.9741, 580.6542,
        594.9918, 627.2691, 692.8939, 692.8939, 692.8939, 692.8939, 692.8939,
        692.8939, 692.8939, 692.8939, 692.8939, 692.8939, 692.8939, 692.8939],
       device='cuda:3')
used idx is  tensor([ 3,  4,  6,  7,  1,  2, 20, 25,  5, 24, 23, 26, 27,  0, 21, 22, 19, 17,
        13], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 88.19% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.402620792388916
distance x is tensor(135.2446, device='cuda:3')
benign distance is  tensor(135.2446, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4186744689941406
distance x is tensor(121.1163, device='cuda:3')
benign distance is  tensor(121.1163, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2414703369140625
distance x is tensor(129.8671, device='cuda:3')
benign distance is  tensor(129.8671, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48803940415382385
distance x is tensor(108.0455, device='cuda:3')
benign distance is  tensor(108.0455, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31443923711776733
distance x is tensor(136.2760, device='cuda:3')
benign distance is  tensor(136.2760, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.43109893798828125
distance x is tensor(132.2991, device='cuda:3')
benign distance is  tensor(132.2991, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13686612248420715
distance x is tensor(118.3735, device='cuda:3')
benign distance is  tensor(118.3735, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7556486129760742
distance x is tensor(130.1760, device='cuda:3')
benign distance is  tensor(130.1760, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3812861740589142
distance x is tensor(129.1579, device='cuda:3')
benign distance is  tensor(129.1579, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09788133203983307
distance x is tensor(137.1177, device='cuda:3')
benign distance is  tensor(137.1177, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4438968598842621
distance x is tensor(126.2690, device='cuda:3')
benign distance is  tensor(126.2690, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04730532318353653
distance x is tensor(133.1886, device='cuda:3')
benign distance is  tensor(133.1886, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8112964630126953
distance x is tensor(119.1877, device='cuda:3')
benign distance is  tensor(119.1877, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5878518223762512
distance x is tensor(121.9818, device='cuda:3')
benign distance is  tensor(121.9818, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7707238793373108
distance x is tensor(129.9162, device='cuda:3')
benign distance is  tensor(129.9162, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3113067150115967
distance x is tensor(120.0595, device='cuda:3')
benign distance is  tensor(120.0595, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.4823, device='cuda:3')
compute distance is  tensor(123.4823, device='cuda:3')
compute norm is  tensor(67.5179, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9580, device='cuda:3')
compute distance is  tensor(125.9580, device='cuda:3')
compute norm is  tensor(67.5891, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.8128, device='cuda:3')
compute distance is  tensor(141.8128, device='cuda:3')
compute norm is  tensor(67.8776, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4569, device='cuda:3')
compute distance is  tensor(145.4569, device='cuda:3')
compute norm is  tensor(67.9530, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5382, device='cuda:3')
compute distance is  tensor(121.5382, device='cuda:3')
compute norm is  tensor(67.4193, device='cuda:3', d