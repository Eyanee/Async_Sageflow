
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8087362051010132
distance x is tensor(120.6342, device='cuda:3')
benign distance is  tensor(120.6342, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1009868383407593
distance x is tensor(122.0533, device='cuda:3')
benign distance is  tensor(122.0533, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5746656656265259
distance x is tensor(121.3942, device='cuda:3')
benign distance is  tensor(121.3942, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49743932485580444
distance x is tensor(113.3678, device='cuda:3')
benign distance is  tensor(113.3678, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.734969437122345
distance x is tensor(102.3600, device='cuda:3')
benign distance is  tensor(102.3600, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.596369743347168
distance x is tensor(127.6515, device='cuda:3')
benign distance is  tensor(127.6515, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8305988311767578
distance x is tensor(113.6417, device='cuda:3')
benign distance is  tensor(113.6417, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6503576040267944
distance x is tensor(124.8828, device='cuda:3')
benign distance is  tensor(124.8828, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1081370860338211
distance x is tensor(139.2042, device='cuda:3')
benign distance is  tensor(139.2042, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6107112765312195
distance x is tensor(137.9439, device='cuda:3')
benign distance is  tensor(137.9439, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2812019884586334
distance x is tensor(124.0231, device='cuda:3')
benign distance is  tensor(124.0231, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.10104022175073624
distance x is tensor(129.7627, device='cuda:3')
benign distance is  tensor(129.7627, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5553322434425354
distance x is tensor(124.2283, device='cuda:3')
benign distance is  tensor(124.2283, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.29297202825546265
distance x is tensor(144.1652, device='cuda:3')
benign distance is  tensor(144.1652, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7567850351333618
distance x is tensor(138.4178, device='cuda:3')
benign distance is  tensor(138.4178, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2940196990966797
distance x is tensor(135.8298, device='cuda:3')
benign distance is  tensor(135.8298, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.40013378858566284
distance x is tensor(124.8409, device='cuda:3')
benign distance is  tensor(124.8409, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9251242876052856
distance x is tensor(144.7107, device='cuda:3')
benign distance is  tensor(144.7107, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.49444085359573364
distance x is tensor(126.4674, device='cuda:3')
benign distance is  tensor(126.4674, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.47599396109580994
distance x is tensor(121.6128, device='cuda:3')
benign distance is  tensor(121.6128, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20919468998908997
distance x is tensor(128.5849, device='cuda:3')
benign distance is  tensor(128.5849, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.148911714553833
distance x is tensor(126.1337, device='cuda:3')
benign distance is  tensor(126.1337, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.38524967432022095
distance x is tensor(143.3571, device='cuda:3')
benign distance is  tensor(143.3571, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1003302335739136
distance x is tensor(139.1093, device='cuda:3')
benign distance is  tensor(139.1093, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.42300358414649963
distance x is tensor(146.3061, device='cuda:3')
benign distance is  tensor(146.3061, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4608542323112488
distance x is tensor(120.4939, device='cuda:3')
benign distance is  tensor(120.4939, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4907809793949127
distance x is tensor(140.1572, device='cuda:3')
benign distance is  tensor(140.1572, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2221032828092575
distance x is tensor(138.9011, device='cuda:3')
benign distance is  tensor(138.9011, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5242608785629272
distance x is tensor(127.6719, device='cuda:3')
benign distance is  tensor(127.6719, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5102739334106445
distance x is tensor(136.3024, device='cuda:3')
benign distance is  tensor(136.3024, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5267711877822876
distance x is tensor(125.0881, device='cuda:3')
benign distance is  tensor(125.0881, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7215346097946167
distance x is tensor(133.4551, device='cuda:3')
benign distance is  tensor(133.4551, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.33531397581100464
distance x is tensor(131.9875, device='cuda:3')
benign distance is  tensor(131.9875, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.26218080520629883
distance x is tensor(128.1734, device='cuda:3')
benign distance is  tensor(128.1734, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4419406056404114
distance x is tensor(138.4602, device='cuda:3')
benign distance is  tensor(138.4602, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11159269511699677
distance x is tensor(126.6045, device='cuda:3')
benign distance is  tensor(126.6045, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.28545379638671875
distance x is tensor(131.2718, device='cuda:3')
benign distance is  tensor(131.2718, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.25319892168045044
distance x is tensor(127.5809, device='cuda:3')
benign distance is  tensor(127.5809, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5246950387954712
distance x is tensor(126.9829, device='cuda:3')
benign distance is  tensor(126.9829, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.13394993543624878
distance x is tensor(129.0975, device='cuda:3')
benign distance is  tensor(129.0975, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.15854506194591522
distance x is tensor(125.3524, device='cuda:3')
benign distance is  tensor(125.3524, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2210768759250641
distance x is tensor(124.4713, device='cuda:3')
benign distance is  tensor(124.4713, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.12388819456100464
distance x is tensor(128.0177, device='cuda:3')
benign distance is  tensor(128.0177, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.24786050617694855
distance x is tensor(152.8790, device='cuda:3')
benign distance is  tensor(152.8790, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.49723997712135315
distance x is tensor(135.5239, device='cuda:3')
benign distance is  tensor(135.5239, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.515698254108429
distance x is tensor(128.3427, device='cuda:3')
benign distance is  tensor(128.3427, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8443067669868469
distance x is tensor(139.0401, device='cuda:3')
benign distance is  tensor(139.0401, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.17182840406894684
distance x is tensor(131.1454, device='cuda:3')
benign distance is  tensor(131.1454, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(108.3604, device='cuda:3')
compute distance is  tensor(108.3604, device='cuda:3')
compute norm is  tensor(45.4404, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5385, device='cuda:3')
compute distance is  tensor(118.5385, device='cuda:3')
compute norm is  tensor(45.6500, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.6069, device='cuda:3')
compute distance is  tensor(135.6069, device='cuda:3')
compute norm is  tensor(46.3337, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.4025, device='cuda:3')
compute distance is  tensor(109.4025, device='cuda:3')
compute norm is  tensor(45.5903, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.4549, device='cuda:3')
compute distance is  tensor(116.4549, device='cuda:3')
compute norm is  tensor(45.7601, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.3615, device='cuda:3')
compute distance is  tensor(121.3615, device='cuda:3')
compute norm is  tensor(45.8688, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3181, device='cuda:3')
compute distance is  tensor(124.3181, device='cuda:3')
compute norm is  tensor(45.8632, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9328, device='cuda:3')
compute distance is  tensor(125.9328, device='cuda:3')
compute norm is  tensor(45.8450, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4739, device='cuda:3')
compute distance is  tensor(126.4739, device='cuda:3')
compute norm is  tensor(45.8424, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1828, device='cuda:3')
compute distance is  tensor(125.1828, device='cuda:3')
compute norm is  tensor(45.9490, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.3895, device='cuda:3')
compute distance is  tensor(120.3895, device='cuda:3')
compute norm is  tensor(45.8925, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1149, device='cuda:3')
compute distance is  tensor(128.1149, device='cuda:3')
compute norm is  tensor(45.9342, device='cuda:3', dtype=torch.float64)
batch acc is 0.1023166668229986
mal_rand_acc is 0.10000000049999999
mal_rand loss is 119521490763776.0
len of model dicts is  12
distance x is tensor(108.3604, device='cuda:3')
compute distance is  tensor(108.3604, device='cuda:3')
compute norm is  tensor(45.4404, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5385, device='cuda:3')
compute distance is  tensor(118.5385, device='cuda:3')
compute norm is  tensor(45.6500, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.6069, device='cuda:3')
compute distance is  tensor(135.6069, device='cuda:3')
compute norm is  tensor(46.3337, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.4025, device='cuda:3')
compute distance is  tensor(109.4025, device='cuda:3')
compute norm is  tensor(45.5903, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.4549, device='cuda:3')
compute distance is  tensor(116.4549, device='cuda:3')
compute norm is  tensor(45.7601, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.3615, device='cuda:3')
compute distance is  tensor(121.3615, device='cuda:3')
compute norm is  tensor(45.8688, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3181, device='cuda:3')
compute distance is  tensor(124.3181, device='cuda:3')
compute norm is  tensor(45.8632, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9328, device='cuda:3')
compute distance is  tensor(125.9328, device='cuda:3')
compute norm is  tensor(45.8450, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4739, device='cuda:3')
compute distance is  tensor(126.4739, device='cuda:3')
compute norm is  tensor(45.8424, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1828, device='cuda:3')
compute distance is  tensor(125.1828, device='cuda:3')
compute norm is  tensor(45.9490, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.3895, device='cuda:3')
compute distance is  tensor(120.3895, device='cuda:3')
compute norm is  tensor(45.8925, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1149, device='cuda:3')
compute distance is  tensor(128.1149, device='cuda:3')
compute norm is  tensor(45.9342, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.6069, device='cuda:3')
distance x is tensor(107710.2109, device='cuda:3')
distance x is tensor(107710.2109, device='cuda:3')
________________________________
test distance is  tensor(107710.2109, device='cuda:3')
test distance1 is  tensor(107710.2109, device='cuda:3')
test similarity is  tensor(-0.1075, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130124723318827.67
test entropy is  0.0
________________________________
cal ratio is  0.03477270578287002
distance x is tensor(3745.3806, device='cuda:3')
cal_distance is  tensor(3745.3806, device='cuda:3')
cal ratio is  0.18647427970655317
distance x is tensor(698.4214, device='cuda:3')
cal_distance is  tensor(698.4214, device='cuda:3')
cal ratio is  0.43182537277459343
distance x is tensor(301.5990, device='cuda:3')
cal_distance is  tensor(301.5990, device='cuda:3')
cal ratio is  0.6571310446901826
distance x is tensor(198.1919, device='cuda:3')
cal_distance is  tensor(198.1919, device='cuda:3')
cal ratio is  0.8106324801397681
distance x is tensor(160.6617, device='cuda:3')
cal_distance is  tensor(160.6617, device='cuda:3')
cal ratio is  0.9003485752042749
distance x is tensor(144.6521, device='cuda:3')
cal_distance is  tensor(144.6521, device='cuda:3')
cal ratio is  0.9488652343528885
distance x is tensor(137.2556, device='cuda:3')
cal_distance is  tensor(137.2556, device='cuda:3')
cal ratio is  0.9740961884323086
distance x is tensor(133.7003, device='cuda:3')
cal_distance is  tensor(133.7003, device='cuda:3')
distance x is tensor(133.7003, device='cuda:3')
return_distance is  tensor(133.7003, device='cuda:3')
distance x is tensor(133.6900, device='cuda:3')
distance x is tensor(133.6900, device='cuda:3')
________________________________
test distance is  tensor(133.6900, device='cuda:3')
test distance1 is  tensor(133.6900, device='cuda:3')
test similarity is  tensor(0.9405, device='cuda:3')
test acc is  0.10008333348966532
test loss is 339.04339355598887
test entropy is  1.7170443344794812e-05
________________________________
0
distance x is tensor(133.6900, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.7205455925778882e-05
avg test loss is  339.36324507137857
avg accuracy is  0.30470000015633963
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9405, device='cuda:3')
compute_distance is  tensor(133.6900, device='cuda:3')
compute_norm is  tensor(44.3615, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(111.2924, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9601339046507756
avg test loss is  1.422424054984599
avg accuracy is  0.8515333334896567
solo acc is  0.3559500001563405
compute similarity  is  tensor(0.9486, device='cuda:3')
compute_distance is  tensor(111.2924, device='cuda:3')
compute_norm is  tensor(43.2069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.7551, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8706220955228501
avg test loss is  1.5632979263628979
avg accuracy is  0.8501833334896567
solo acc is  0.2776000001563389
compute similarity  is  tensor(0.9481, device='cuda:3')
compute_distance is  tensor(113.7551, device='cuda:3')
compute_norm is  tensor(42.9103, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.8086, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8805946149170272
avg test loss is  1.5048056124115803
avg accuracy is  0.8540500001563233
solo acc is  0.2718166668230055
compute similarity  is  tensor(0.9477, device='cuda:3')
compute_distance is  tensor(115.8086, device='cuda:3')
compute_norm is  tensor(42.6433, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.7456, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8700397713606292
avg test loss is  1.462137526413525
avg accuracy is  0.8565333334896565
solo acc is  0.2744666668230055
compute similarity  is  tensor(0.9473, device='cuda:3')
compute_distance is  tensor(117.7456, device='cuda:3')
compute_norm is  tensor(42.3938, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.5789, device='cuda:3')
distance x is tensor(119.5789, device='cuda:3')
________________________________
test distance is  tensor(119.5789, device='cuda:3')
test distance1 is  tensor(119.5789, device='cuda:3')
test similarity is  tensor(0.9470, device='cuda:3')
test acc is  0.2740000001563389
test loss is 1.429617040701258
test entropy is  0.872817080094616
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2797703742980957
mal norm is  tensor(630.9057, device='cuda:3')
distance x is tensor(119.5866, device='cuda:3')
mal distance is  tensor(119.5866, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([538.5692, 569.4269, 550.1042, 519.4702, 468.7155, 576.3741, 506.9939,
        576.3711, 630.9057, 630.9057, 630.9057, 630.9057, 630.9057, 630.9057,
        630.9057, 630.9057, 630.9057, 630.9057, 630.9057, 630.9057],
       device='cuda:3')
sorted_norm is   tensor([468.7155, 506.9939, 519.4702, 538.5692, 550.1042, 569.4269, 576.3711,
        576.3741, 630.9057, 630.9057, 630.9057, 630.9057, 630.9057, 630.9057,
        630.9057, 630.9057, 630.9057, 630.9057, 630.9057, 630.9057],
       device='cuda:3')
used idx is  tensor([ 4,  6,  3,  0,  2,  1,  7,  5, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 88.54% 

Test Accuracy: 87.62% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7030848860740662
distance x is tensor(104.2456, device='cuda:3')
benign distance is  tensor(104.2456, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4846693277359009
distance x is tensor(128.9653, device='cuda:3')
benign distance is  tensor(128.9653, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11818430572748184
distance x is tensor(130.7899, device='cuda:3')
benign distance is  tensor(130.7899, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.41700562834739685
distance x is tensor(134.7772, device='cuda:3')
benign distance is  tensor(134.7772, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8781733512878418
distance x is tensor(109.4150, device='cuda:3')
benign distance is  tensor(109.4150, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8370952606201172
distance x is tensor(131.1506, device='cuda:3')
benign distance is  tensor(131.1506, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6480379700660706
distance x is tensor(122.8464, device='cuda:3')
benign distance is  tensor(122.8464, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2725058794021606
distance x is tensor(130.1185, device='cuda:3')
benign distance is  tensor(130.1185, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(133.2211, device='cuda:3')
compute distance is  tensor(133.2211, device='cuda:3')
compute norm is  tensor(45.3142, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9386, device='cuda:3')
compute distance is  tensor(116.9386, device='cuda:3')
compute norm is  tensor(44.9822, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.9406, device='cuda:3')
compute distance is  tensor(150.9406, device='cuda:3')
compute norm is  tensor(45.8742, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0696, device='cuda:3')
compute distance is  tensor(132.0696, device='cuda:3')
compute norm is  tensor(45.4172, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3809, device='cuda:3')
compute distance is  tensor(146.3809, device='cuda:3')
compute norm is  tensor(45.5806, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7070, device='cuda:3')
compute distance is  tensor(136.7070, device='cuda:3')
compute norm is  tensor(45.5321, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.8230, device='cuda:3')
compute distance is  tensor(135.8230, device='cuda:3')
compute norm is  tensor(45.4640, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4160, device='cuda:3')
compute distance is  tensor(144.4160, device='cuda:3')
compute norm is  tensor(45.6247, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9296, device='cuda:3')
compute distance is  tensor(132.9296, device='cuda:3')
compute norm is  tensor(45.3631, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5862, device='cuda:3')
compute distance is  tensor(135.5862, device='cuda:3')
compute norm is  tensor(45.3907, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.4506, device='cuda:3')
compute distance is  tensor(148.4506, device='cuda:3')
compute norm is  tensor(45.9331, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.7606, device='cuda:3')
compute distance is  tensor(134.7606, device='cuda:3')
compute norm is  tensor(45.3641, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(150.9406, device='cuda:3')
distance x is tensor(107686.1641, device='cuda:3')
distance x is tensor(107686.1641, device='cuda:3')
________________________________
test distance is  tensor(107686.1641, device='cuda:3')
test distance1 is  tensor(107686.1641, device='cuda:3')
test similarity is  tensor(-0.0131, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129996970426298.12
test entropy is  0.0
________________________________
cal ratio is  0.03669012015218414
distance x is tensor(3951.0244, device='cuda:3')
cal_distance is  tensor(3951.0244, device='cuda:3')
cal ratio is  0.19154650089293662
distance x is tensor(756.8091, device='cuda:3')
cal_distance is  tensor(756.8091, device='cuda:3')
cal ratio is  0.4376590631769777
distance x is tensor(331.2272, device='cuda:3')
cal_distance is  tensor(331.2272, device='cuda:3')
cal ratio is  0.6615551633792921
distance x is tensor(219.1268, device='cuda:3')
cal_distance is  tensor(219.1268, device='cuda:3')
cal ratio is  0.8133571711272105
distance x is tensor(178.2294, device='cuda:3')
cal_distance is  tensor(178.2294, device='cuda:3')
cal ratio is  0.9018607037997972
distance x is tensor(160.7386, device='cuda:3')
cal_distance is  tensor(160.7386, device='cuda:3')
cal ratio is  0.9496619393893374
distance x is tensor(152.6476, device='cuda:3')
cal_distance is  tensor(152.6476, device='cuda:3')
cal ratio is  0.9745052061015266
distance x is tensor(148.7560, device='cuda:3')
cal_distance is  tensor(148.7560, device='cuda:3')
distance x is tensor(148.7560, device='cuda:3')
return_distance is  tensor(148.7560, device='cuda:3')
distance x is tensor(148.7457, device='cuda:3')
distance x is tensor(148.7457, device='cuda:3')
________________________________
test distance is  tensor(148.7457, device='cuda:3')
test distance1 is  tensor(148.7457, device='cuda:3')
test similarity is  tensor(0.9300, device='cuda:3')
test acc is  0.10000000015633198
test loss is 626.8216881335163
test entropy is  3.298091064671177e-30
________________________________
0
distance x is tensor(148.7457, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.269061469271828e-29
avg test loss is  627.5846757705787
avg accuracy is  0.1015833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9300, device='cuda:3')
compute_distance is  tensor(148.7457, device='cuda:3')
compute_norm is  tensor(45.2162, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(124.9037, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9729479217071777
avg test loss is  1.5076379262562245
avg accuracy is  0.6831000001563319
solo acc is  0.30930000015633974
compute similarity  is  tensor(0.9391, device='cuda:3')
compute_distance is  tensor(124.9037, device='cuda:3')
compute_norm is  tensor(44.5329, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(124.9037, device='cuda:3')
distance x is tensor(124.9037, device='cuda:3')
________________________________
test distance is  tensor(124.9037, device='cuda:3')
test distance1 is  tensor(124.9037, device='cuda:3')
test similarity is  tensor(0.9391, device='cuda:3')
test acc is  0.3076000001563396
test loss is 1.511487059374608
test entropy is  0.9732671692046021
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.0951440334320068
mal norm is  tensor(696.8160, device='cuda:3')
distance x is tensor(124.9124, device='cuda:3')
mal distance is  tensor(124.9124, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([474.4813, 579.9294, 563.9335, 589.1976, 489.3687, 575.7865, 539.8492,
        579.4444, 696.8160, 696.8160, 696.8160, 696.8160, 696.8160, 696.8160,
        696.8160, 696.8160, 696.8160, 696.8160, 696.8160, 696.8160, 674.8954,
        661.9139, 618.5469, 637.8897, 615.5339, 710.9440, 680.7854, 660.4186],
       device='cuda:3')
sorted_norm is   tensor([474.4813, 489.3687, 539.8492, 563.9335, 575.7865, 579.4444, 579.9294,
        589.1976, 615.5339, 618.5469, 637.8897, 660.4186, 661.9139, 674.8954,
        680.7854, 696.8160, 696.8160, 696.8160, 696.8160, 696.8160, 696.8160,
        696.8160, 696.8160, 696.8160, 696.8160, 696.8160, 696.8160, 710.9440],
       device='cuda:3')
used idx is  tensor([ 0,  4,  6,  2,  5,  7,  1,  3, 24, 22, 23, 27, 21, 20, 26, 17],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 89.42% 

Test Accuracy: 88.78% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9860659837722778
distance x is tensor(117.4397, device='cuda:3')
benign distance is  tensor(117.4397, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8619357347488403
distance x is tensor(129.5239, device='cuda:3')
benign distance is  tensor(129.5239, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27819326519966125
distance x is tensor(135.9018, device='cuda:3')
benign distance is  tensor(135.9018, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7883297204971313
distance x is tensor(110.5449, device='cuda:3')
benign distance is  tensor(110.5449, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8664800524711609
distance x is tensor(116.7588, device='cuda:3')
benign distance is  tensor(116.7588, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8320876359939575
distance x is tensor(118.7561, device='cuda:3')
benign distance is  tensor(118.7561, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4120578169822693
distance x is tensor(121.8505, device='cuda:3')
benign distance is  tensor(121.8505, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49173736572265625
distance x is tensor(119.0572, device='cuda:3')
benign distance is  tensor(119.0572, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.34917134046554565
distance x is tensor(142.4299, device='cuda:3')
benign distance is  tensor(142.4299, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8130788803100586
distance x is tensor(137.6213, device='cuda:3')
benign distance is  tensor(137.6213, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8951554298400879
distance x is tensor(134.7052, device='cuda:3')
benign distance is  tensor(134.7052, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5048941373825073
distance x is tensor(143.0142, device='cuda:3')
benign distance is  tensor(143.0142, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6145483255386353
distance x is tensor(119.4192, device='cuda:3')
benign distance is  tensor(119.4192, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.250352680683136
distance x is tensor(136.8324, device='cuda:3')
benign distance is  tensor(136.8324, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.28441861271858215
distance x is tensor(134.5341, device='cuda:3')
benign distance is  tensor(134.5341, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3434317111968994
distance x is tensor(128.9738, device='cuda:3')
benign distance is  tensor(128.9738, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.2888, device='cuda:3')
compute distance is  tensor(135.2888, device='cuda:3')
compute norm is  tensor(45.9950, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5795, device='cuda:3')
compute distance is  tensor(125.5795, device='cuda:3')
compute norm is  tensor(45.8008, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7041, device='cuda:3')
compute distance is  tensor(129.7041, device='cuda:3')
compute norm is  tensor(45.9994, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0643, device='cuda:3')
compute distance is  tensor(133.0643, device='cuda:3')
compute norm is  tensor(46.1249, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3268, device='cuda:3')
compute distance is  tensor(130.3268, device='cuda:3')
compute norm is  tensor(45.9617, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8743, device='cuda:3')
compute distance is  tensor(124.8743, device='cuda:3')
compute norm is  tensor(45.9328, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1270, device='cuda:3')
compute distance is  tensor(122.1270, device='cuda:3')
compute norm is  tensor(45.8961, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0013, device='cuda:3')
compute distance is  tensor(127.0013, device='cuda:3')
compute norm is  tensor(45.7283, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6507, device='cuda:3')
compute distance is  tensor(126.6507, device='cuda:3')
compute norm is  tensor(45.9399, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3291, device='cuda:3')
compute distance is  tensor(127.3291, device='cuda:3')
compute norm is  tensor(46.0153, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1263, device='cuda:3')
compute distance is  tensor(130.1263, device='cuda:3')
compute norm is  tensor(46.0512, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4689, device='cuda:3')
compute distance is  tensor(131.4689, device='cuda:3')
compute norm is  tensor(45.9609, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.2888, device='cuda:3')
distance x is tensor(107696.2344, device='cuda:3')
distance x is tensor(107696.2344, device='cuda:3')
________________________________
test distance is  tensor(107696.2344, device='cuda:3')
test distance1 is  tensor(107696.2344, device='cuda:3')
test similarity is  tensor(-0.0465, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130055947876303.97
test entropy is  0.0
________________________________
cal ratio is  0.03473415204994736
distance x is tensor(3740.7434, device='cuda:3')
cal_distance is  tensor(3740.7434, device='cuda:3')
cal ratio is  0.18637085555398125
distance x is tensor(697.1696, device='cuda:3')
cal_distance is  tensor(697.1696, device='cuda:3')
cal ratio is  0.43170565130027594
distance x is tensor(300.9750, device='cuda:3')
cal_distance is  tensor(300.9750, device='cuda:3')
cal ratio is  0.657039896959156
distance x is tensor(197.7543, device='cuda:3')
cal_distance is  tensor(197.7543, device='cuda:3')
cal ratio is  0.8105763731219366
distance x is tensor(160.2960, device='cuda:3')
cal_distance is  tensor(160.2960, device='cuda:3')
cal ratio is  0.9003173568075542
distance x is tensor(144.3178, device='cuda:3')
cal_distance is  tensor(144.3178, device='cuda:3')
cal ratio is  0.9488487341673599
distance x is tensor(136.9360, device='cuda:3')
cal_distance is  tensor(136.9360, device='cuda:3')
cal ratio is  0.9740877553916844
distance x is tensor(133.3878, device='cuda:3')
cal_distance is  tensor(133.3878, device='cuda:3')
distance x is tensor(133.3878, device='cuda:3')
return_distance is  tensor(133.3878, device='cuda:3')
distance x is tensor(133.3776, device='cuda:3')
distance x is tensor(133.3776, device='cuda:3')
________________________________
test distance is  tensor(133.3776, device='cuda:3')
test distance1 is  tensor(133.3776, device='cuda:3')
test similarity is  tensor(0.9429, device='cuda:3')
test acc is  0.10000000015633198
test loss is 364.0328463491346
test entropy is  1.749862204687551e-07
________________________________
0
distance x is tensor(133.3776, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2330973078429514e-05
avg test loss is  364.1804705784519
avg accuracy is  0.17030000015633467
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9429, device='cuda:3')
compute_distance is  tensor(133.3776, device='cuda:3')
compute_norm is  tensor(45.1300, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(113.8154, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9441374652802563
avg test loss is  1.4738669812298024
avg accuracy is  0.8168166668229915
solo acc is  0.3295333334896734
compute similarity  is  tensor(0.9495, device='cuda:3')
compute_distance is  tensor(113.8154, device='cuda:3')
compute_norm is  tensor(44.2474, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.9216, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9032718627564689
avg test loss is  1.5278479439109118
avg accuracy is  0.8166500001563248
solo acc is  0.2774166668230056
compute similarity  is  tensor(0.9491, device='cuda:3')
compute_distance is  tensor(115.9216, device='cuda:3')
compute_norm is  tensor(43.9662, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.7774, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8746349776604536
avg test loss is  1.5078853138728436
avg accuracy is  0.8197666668229913
solo acc is  0.2706000001563388
compute similarity  is  tensor(0.9488, device='cuda:3')
compute_distance is  tensor(117.7774, device='cuda:3')
compute_norm is  tensor(43.7120, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.5413, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8696586131287027
avg test loss is  1.4758284860836672
avg accuracy is  0.8240166668229911
solo acc is  0.26716666682300544
compute similarity  is  tensor(0.9484, device='cuda:3')
compute_distance is  tensor(119.5413, device='cuda:3')
compute_norm is  tensor(43.4697, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.2552, device='cuda:3')
distance x is tensor(121.2552, device='cuda:3')
________________________________
test distance is  tensor(121.2552, device='cuda:3')
test distance1 is  tensor(121.2552, device='cuda:3')
test similarity is  tensor(0.9481, device='cuda:3')
test acc is  0.26058333348967194
test loss is 1.4605668244331376
test entropy is  0.8612819361661289
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2422575950622559
mal norm is  tensor(631.5237, device='cuda:3')
distance x is tensor(121.2634, device='cuda:3')
mal distance is  tensor(121.2634, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([513.9896, 566.0934, 607.2231, 495.3894, 516.0585, 539.5305, 534.6562,
        528.9294, 631.5237, 631.5237, 631.5237, 631.5237, 631.5237, 631.5237,
        631.5237, 631.5237, 631.5237, 631.5237, 631.5237, 631.5237, 603.3271,
        699.2723, 613.3697, 598.3440, 616.5616, 608.7401, 686.0837, 656.4500],
       device='cuda:3')
sorted_norm is   tensor([495.3894, 513.9896, 516.0585, 528.9294, 534.6562, 539.5305, 566.0934,
        598.3440, 603.3271, 607.2231, 608.7401, 613.3697, 616.5616, 631.5237,
        631.5237, 631.5237, 631.5237, 631.5237, 631.5237, 631.5237, 631.5237,
        631.5237, 631.5237, 631.5237, 631.5237, 656.4500, 686.0837, 699.2723],
       device='cuda:3')
used idx is  tensor([ 3,  0,  4,  7,  6,  5,  1, 23, 20,  2, 25, 22, 24, 19, 16, 17],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 89.32% 

Test Accuracy: 88.54% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4118115305900574
distance x is tensor(122.4195, device='cuda:3')
benign distance is  tensor(122.4195, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7641168832778931
distance x is tensor(136.1990, device='cuda:3')
benign distance is  tensor(136.1990, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21528835594654083
distance x is tensor(123.0600, device='cuda:3')
benign distance is  tensor(123.0600, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44371575117111206
distance x is tensor(115.1685, device='cuda:3')
benign distance is  tensor(115.1685, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5723062753677368
distance x is tensor(101.6199, device='cuda:3')
benign distance is  tensor(101.6199, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4875361919403076
distance x is tensor(126.4769, device='cuda:3')
benign distance is  tensor(126.4769, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.184549018740654
distance x is tensor(111.4857, device='cuda:3')
benign distance is  tensor(111.4857, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.18906766176223755
distance x is tensor(119.4265, device='cuda:3')
benign distance is  tensor(119.4265, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4278186857700348
distance x is tensor(135.1894, device='cuda:3')
benign distance is  tensor(135.1894, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.433540403842926
distance x is tensor(143.3353, device='cuda:3')
benign distance is  tensor(143.3353, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.28703853487968445
distance x is tensor(132.7459, device='cuda:3')
benign distance is  tensor(132.7459, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.22908811271190643
distance x is tensor(128.2588, device='cuda:3')
benign distance is  tensor(128.2588, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.7652543783187866
distance x is tensor(133.0438, device='cuda:3')
benign distance is  tensor(133.0438, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6163620352745056
distance x is tensor(141.8421, device='cuda:3')
benign distance is  tensor(141.8421, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2578745484352112
distance x is tensor(142.5033, device='cuda:3')
benign distance is  tensor(142.5033, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4113456606864929
distance x is tensor(129.2321, device='cuda:3')
benign distance is  tensor(129.2321, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.2978, device='cuda:3')
compute distance is  tensor(123.2978, device='cuda:3')
compute norm is  tensor(45.6006, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.9413, device='cuda:3')
compute distance is  tensor(122.9413, device='cuda:3')
compute norm is  tensor(45.5728, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6117, device='cuda:3')
compute distance is  tensor(139.6117, device='cuda:3')
compute norm is  tensor(46.1255, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2157, device='cuda:3')
compute distance is  tensor(135.2157, device='cuda:3')
compute norm is  tensor(45.8950, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.4780, device='cuda:3')
compute distance is  tensor(119.4780, device='cuda:3')
compute norm is  tensor(45.5348, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.8501, device='cuda:3')
compute distance is  tensor(136.8501, device='cuda:3')
compute norm is  tensor(46.0752, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5275, device='cuda:3')
compute distance is  tensor(126.5275, device='cuda:3')
compute norm is  tensor(45.6558, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2140, device='cuda:3')
compute distance is  tensor(133.2140, device='cuda:3')
compute norm is  tensor(45.8489, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4823, device='cuda:3')
compute distance is  tensor(132.4823, device='cuda:3')
compute norm is  tensor(45.9232, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4215, device='cuda:3')
compute distance is  tensor(122.4215, device='cuda:3')
compute norm is  tensor(45.7698, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7662, device='cuda:3')
compute distance is  tensor(137.7662, device='cuda:3')
compute norm is  tensor(46.1588, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3727, device='cuda:3')
compute distance is  tensor(134.3727, device='cuda:3')
compute norm is  tensor(45.9080, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.6117, device='cuda:3')
distance x is tensor(107689.8359, device='cuda:3')
distance x is tensor(107689.8359, device='cuda:3')
________________________________
test distance is  tensor(107689.8359, device='cuda:3')
test distance1 is  tensor(107689.8359, device='cuda:3')
test similarity is  tensor(-0.0184, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130096472239927.12
test entropy is  0.0
________________________________
cal ratio is  0.035285770063283206
distance x is tensor(3799.9250, device='cuda:3')
cal_distance is  tensor(3799.9250, device='cuda:3')
cal ratio is  0.1878449163968661
distance x is tensor(713.8007, device='cuda:3')
cal_distance is  tensor(713.8007, device='cuda:3')
cal ratio is  0.43340955081012544
distance x is tensor(309.3710, device='cuda:3')
cal_distance is  tensor(309.3710, device='cuda:3')
cal ratio is  0.6583353380301491
distance x is tensor(203.6716, device='cuda:3')
cal_distance is  tensor(203.6716, device='cuda:3')
cal ratio is  0.8113750997139825
distance x is tensor(165.2550, device='cuda:3')
cal_distance is  tensor(165.2550, device='cuda:3')
cal ratio is  0.9007610523377989
distance x is tensor(148.8558, device='cuda:3')
cal_distance is  tensor(148.8558, device='cuda:3')
cal ratio is  0.9490826661194134
distance x is tensor(141.2768, device='cuda:3')
cal_distance is  tensor(141.2768, device='cuda:3')
cal ratio is  0.9742077503944679
distance x is tensor(137.6330, device='cuda:3')
cal_distance is  tensor(137.6330, device='cuda:3')
distance x is tensor(137.6330, device='cuda:3')
return_distance is  tensor(137.6330, device='cuda:3')
distance x is tensor(137.6228, device='cuda:3')
distance x is tensor(137.6228, device='cuda:3')
________________________________
test distance is  tensor(137.6228, device='cuda:3')
test distance1 is  tensor(137.6228, device='cuda:3')
test similarity is  tensor(0.9403, device='cuda:3')
test acc is  0.10000000015633198
test loss is 426.7201587538729
test entropy is  3.6610898568590553e-06
________________________________
0
distance x is tensor(137.6228, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.0622186058385093e-11
avg test loss is  426.9715933728574
avg accuracy is  0.11725000015633194
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9403, device='cuda:3')
compute_distance is  tensor(137.6228, device='cuda:3')
compute_norm is  tensor(45.4012, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.3303, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9444087643994451
avg test loss is  1.4795137280340134
avg accuracy is  0.7719333334896603
solo acc is  0.3209666668230066
compute similarity  is  tensor(0.9473, device='cuda:3')
compute_distance is  tensor(117.3303, device='cuda:3')
compute_norm is  tensor(44.6481, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(117.3303, device='cuda:3')
distance x is tensor(117.3303, device='cuda:3')
________________________________
test distance is  tensor(117.3303, device='cuda:3')
test distance1 is  tensor(117.3303, device='cuda:3')
test similarity is  tensor(0.9473, device='cuda:3')
test acc is  0.32385000015634
test loss is 1.476506147811662
test entropy is  0.9432267087227755
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4484179019927979
mal norm is  tensor(649.6230, device='cuda:3')
distance x is tensor(117.3393, device='cuda:3')
mal distance is  tensor(117.3393, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([557.6130, 607.3757, 545.1142, 507.9261, 439.9445, 549.4832, 490.2542,
        532.5474, 649.6230, 649.6230, 649.6230, 649.6230, 649.6230, 649.6230,
        649.6230, 649.6230, 649.6230, 649.6230, 649.6230, 649.6230, 711.7055,
        586.0898, 683.5517, 664.2986, 628.0472, 674.8704, 629.4723, 675.1622,
        641.7393, 625.4434, 619.1678, 644.7829, 560.6766, 614.2452, 613.5045,
        600.4727], device='cuda:3')
sorted_norm is   tensor([439.9445, 490.2542, 507.9261, 532.5474, 545.1142, 549.4832, 557.6130,
        560.6766, 586.0898, 600.4727, 607.3757, 613.5045, 614.2452, 619.1678,
        625.4434, 628.0472, 629.4723, 641.7393, 644.7829, 649.6230, 649.6230,
        649.6230, 649.6230, 649.6230, 649.6230, 649.6230, 649.6230, 649.6230,
        649.6230, 649.6230, 649.6230, 664.2986, 674.8704, 675.1622, 683.5517,
        711.7055], device='cuda:3')
used idx is  tensor([ 4,  6,  3,  7,  2,  5,  0, 32, 21, 35,  1, 34, 33, 30, 29, 24, 26, 28,
        31, 19, 13], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.53% 

Test Accuracy: 88.85% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.051070354878902435
distance x is tensor(112.2981, device='cuda:3')
benign distance is  tensor(112.2981, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5686043500900269
distance x is tensor(113.0882, device='cuda:3')
benign distance is  tensor(113.0882, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4821542203426361
distance x is tensor(122.8065, device='cuda:3')
benign distance is  tensor(122.8065, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47703972458839417
distance x is tensor(117.2229, device='cuda:3')
benign distance is  tensor(117.2229, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5259477496147156
distance x is tensor(116.0185, device='cuda:3')
benign distance is  tensor(116.0185, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.36822509765625
distance x is tensor(122.3934, device='cuda:3')
benign distance is  tensor(122.3934, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.08835626393556595
distance x is tensor(126.2888, device='cuda:3')
benign distance is  tensor(126.2888, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23788230121135712
distance x is tensor(113.9284, device='cuda:3')
benign distance is  tensor(113.9284, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3652295470237732
distance x is tensor(138.1059, device='cuda:3')
benign distance is  tensor(138.1059, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7015436887741089
distance x is tensor(139.9716, device='cuda:3')
benign distance is  tensor(139.9716, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4936630129814148
distance x is tensor(133.8165, device='cuda:3')
benign distance is  tensor(133.8165, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6551019549369812
distance x is tensor(140.2771, device='cuda:3')
benign distance is  tensor(140.2771, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49782857298851013
distance x is tensor(125.6842, device='cuda:3')
benign distance is  tensor(125.6842, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.08454380184412003
distance x is tensor(126.9316, device='cuda:3')
benign distance is  tensor(126.9316, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4363328516483307
distance x is tensor(135.2431, device='cuda:3')
benign distance is  tensor(135.2431, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5345712304115295
distance x is tensor(137.7942, device='cuda:3')
benign distance is  tensor(137.7942, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5974072217941284
distance x is tensor(140.6611, device='cuda:3')
benign distance is  tensor(140.6611, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7803493738174438
distance x is tensor(132.4328, device='cuda:3')
benign distance is  tensor(132.4328, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.1751045286655426
distance x is tensor(143.0814, device='cuda:3')
benign distance is  tensor(143.0814, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3957909941673279
distance x is tensor(133.8173, device='cuda:3')
benign distance is  tensor(133.8173, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9078713655471802
distance x is tensor(142.0565, device='cuda:3')
benign distance is  tensor(142.0565, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.41723084449768066
distance x is tensor(137.6644, device='cuda:3')
benign distance is  tensor(137.6644, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1634226143360138
distance x is tensor(134.9692, device='cuda:3')
benign distance is  tensor(134.9692, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.19233331084251404
distance x is tensor(142.9883, device='cuda:3')
benign distance is  tensor(142.9883, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.1053, device='cuda:3')
compute distance is  tensor(121.1053, device='cuda:3')
compute norm is  tensor(45.9838, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.4872, device='cuda:3')
compute distance is  tensor(114.4872, device='cuda:3')
compute norm is  tensor(45.8851, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5245, device='cuda:3')
compute distance is  tensor(119.5245, device='cuda:3')
compute norm is  tensor(46.0526, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.4520, device='cuda:3')
compute distance is  tensor(117.4520, device='cuda:3')
compute norm is  tensor(45.8908, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4164, device='cuda:3')
compute distance is  tensor(131.4164, device='cuda:3')
compute norm is  tensor(46.3000, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.7789, device='cuda:3')
compute distance is  tensor(124.7789, device='cuda:3')
compute norm is  tensor(46.1643, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1903, device='cuda:3')
compute distance is  tensor(122.1903, device='cuda:3')
compute norm is  tensor(46.0621, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9452, device='cuda:3')
compute distance is  tensor(126.9452, device='cuda:3')
compute norm is  tensor(46.0771, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1512, device='cuda:3')
compute distance is  tensor(122.1512, device='cuda:3')
compute norm is  tensor(45.9744, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7774, device='cuda:3')
compute distance is  tensor(126.7774, device='cuda:3')
compute norm is  tensor(46.1210, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7617, device='cuda:3')
compute distance is  tensor(125.7617, device='cuda:3')
compute norm is  tensor(46.1569, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8900, device='cuda:3')
compute distance is  tensor(124.8900, device='cuda:3')
compute norm is  tensor(46.0782, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(131.4164, device='cuda:3')
distance x is tensor(107690.8984, device='cuda:3')
distance x is tensor(107690.8984, device='cuda:3')
________________________________
test distance is  tensor(107690.8984, device='cuda:3')
test distance1 is  tensor(107690.8984, device='cuda:3')
test similarity is  tensor(-0.0245, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130109575576517.05
test entropy is  0.0
________________________________
cal ratio is  0.03423428669722354
distance x is tensor(3686.7266, device='cuda:3')
cal_distance is  tensor(3686.7266, device='cuda:3')
cal ratio is  0.1850249577413796
distance x is tensor(682.1406, device='cuda:3')
cal_distance is  tensor(682.1406, device='cuda:3')
cal ratio is  0.43014394421058766
distance x is tensor(293.4216, device='cuda:3')
cal_distance is  tensor(293.4216, device='cuda:3')
cal ratio is  0.6558503324374919
distance x is tensor(192.4424, device='cuda:3')
cal_distance is  tensor(192.4424, device='cuda:3')
cal ratio is  0.8098421396264874
distance x is tensor(155.8490, device='cuda:3')
cal_distance is  tensor(155.8490, device='cuda:3')
cal ratio is  0.8999094153488089
distance x is tensor(140.2505, device='cuda:3')
cal_distance is  tensor(140.2505, device='cuda:3')
cal ratio is  0.9486337228872366
distance x is tensor(133.0466, device='cuda:3')
cal_distance is  tensor(133.0466, device='cuda:3')
cal ratio is  0.9739772963869044
distance x is tensor(129.5845, device='cuda:3')
cal_distance is  tensor(129.5845, device='cuda:3')
distance x is tensor(129.5845, device='cuda:3')
return_distance is  tensor(129.5845, device='cuda:3')
distance x is tensor(129.5743, device='cuda:3')
distance x is tensor(129.5743, device='cuda:3')
________________________________
test distance is  tensor(129.5743, device='cuda:3')
test distance1 is  tensor(129.5743, device='cuda:3')
test similarity is  tensor(0.9471, device='cuda:3')
test acc is  0.10001666682299865
test loss is 335.9388134271097
test entropy is  2.1682925483737088e-05
________________________________
0
distance x is tensor(129.5743, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.3258483958007455e-05
avg test loss is  336.41655511591733
avg accuracy is  0.17490000015633497
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(129.5743, device='cuda:3')
compute_norm is  tensor(45.5242, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(112.1276, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9176859316159921
avg test loss is  1.4735983807140831
avg accuracy is  0.8141500001563248
solo acc is  0.3310000001563401
compute similarity  is  tensor(0.9528, device='cuda:3')
compute_distance is  tensor(112.1276, device='cuda:3')
compute_norm is  tensor(44.7037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.2700, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8953838978749095
avg test loss is  1.5229398036308126
avg accuracy is  0.8138833334896582
solo acc is  0.2758666668230056
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(114.2700, device='cuda:3')
compute_norm is  tensor(44.4268, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.0305, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8865987394791423
avg test loss is  1.4890685868161573
avg accuracy is  0.8151166668229914
solo acc is  0.27378333348967215
compute similarity  is  tensor(0.9520, device='cuda:3')
compute_distance is  tensor(116.0305, device='cuda:3')
compute_norm is  tensor(44.1741, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.7335, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8699357411754665
avg test loss is  1.4827762655357817
avg accuracy is  0.8200833334896579
solo acc is  0.2609333334896719
compute similarity  is  tensor(0.9516, device='cuda:3')
compute_distance is  tensor(117.7335, device='cuda:3')
compute_norm is  tensor(43.9351, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.4042, device='cuda:3')
distance x is tensor(119.4042, device='cuda:3')
________________________________
test distance is  tensor(119.4042, device='cuda:3')
test distance1 is  tensor(119.4042, device='cuda:3')
test similarity is  tensor(0.9513, device='cuda:3')
test acc is  0.2592000001563385
test loss is 1.4631007015069664
test entropy is  0.858478234647942
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.304286241531372
mal norm is  tensor(616.6182, device='cuda:3')
distance x is tensor(119.4124, device='cuda:3')
mal distance is  tensor(119.4124, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([509.3088, 510.0136, 535.2183, 516.6960, 513.6721, 549.9340, 542.7251,
        518.8191, 616.6182, 616.6182, 616.6182, 616.6182, 616.6182, 616.6182,
        616.6182, 616.6182, 616.6182, 616.6182, 616.6182, 616.6182, 655.6768,
        633.9257, 684.0833, 631.6481, 656.9034, 620.4423, 637.9047, 625.9882],
       device='cuda:3')
sorted_norm is   tensor([509.3088, 510.0136, 513.6721, 516.6960, 518.8191, 535.2183, 542.7251,
        549.9340, 616.6182, 616.6182, 616.6182, 616.6182, 616.6182, 616.6182,
        616.6182, 616.6182, 616.6182, 616.6182, 616.6182, 616.6182, 620.4423,
        625.9882, 631.6481, 633.9257, 637.9047, 655.6768, 656.9034, 684.0833],
       device='cuda:3')
used idx is  tensor([ 0,  1,  4,  3,  7,  2,  6,  5, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 86.59% 

Test Accuracy: 85.44% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.438058465719223
distance x is tensor(145.3564, device='cuda:3')
benign distance is  tensor(145.3564, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.559475302696228
distance x is tensor(156.8635, device='cuda:3')
benign distance is  tensor(156.8635, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5175578594207764
distance x is tensor(155.4941, device='cuda:3')
benign distance is  tensor(155.4941, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5937690734863281
distance x is tensor(146.5409, device='cuda:3')
benign distance is  tensor(146.5409, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5218837857246399
distance x is tensor(137.2094, device='cuda:3')
benign distance is  tensor(137.2094, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6569530963897705
distance x is tensor(144.4995, device='cuda:3')
benign distance is  tensor(144.4995, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4534277319908142
distance x is tensor(136.5057, device='cuda:3')
benign distance is  tensor(136.5057, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4006732106208801
distance x is tensor(150.3810, device='cuda:3')
benign distance is  tensor(150.3810, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4394145905971527
distance x is tensor(153.4698, device='cuda:3')
benign distance is  tensor(153.4698, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09617529064416885
distance x is tensor(158.9027, device='cuda:3')
benign distance is  tensor(158.9027, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.33343368768692017
distance x is tensor(150.6514, device='cuda:3')
benign distance is  tensor(150.6514, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.10649368911981583
distance x is tensor(159.4158, device='cuda:3')
benign distance is  tensor(159.4158, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8060871362686157
distance x is tensor(146.2173, device='cuda:3')
benign distance is  tensor(146.2173, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6276721954345703
distance x is tensor(151.7699, device='cuda:3')
benign distance is  tensor(151.7699, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8842487335205078
distance x is tensor(150.7657, device='cuda:3')
benign distance is  tensor(150.7657, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1738850623369217
distance x is tensor(148.8464, device='cuda:3')
benign distance is  tensor(148.8464, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(146.4252, device='cuda:3')
compute distance is  tensor(146.4252, device='cuda:3')
compute norm is  tensor(45.8178, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0594, device='cuda:3')
compute distance is  tensor(144.0594, device='cuda:3')
compute norm is  tensor(45.6121, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.5990, device='cuda:3')
compute distance is  tensor(157.5990, device='cuda:3')
compute norm is  tensor(46.2334, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.7420, device='cuda:3')
compute distance is  tensor(160.7420, device='cuda:3')
compute norm is  tensor(46.1147, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.3293, device='cuda:3')
compute distance is  tensor(144.3293, device='cuda:3')
compute norm is  tensor(45.8801, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9202, device='cuda:3')
compute distance is  tensor(153.9202, device='cuda:3')
compute norm is  tensor(46.1589, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.2677, device='cuda:3')
compute distance is  tensor(152.2677, device='cuda:3')
compute norm is  tensor(45.9480, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.6095, device='cuda:3')
compute distance is  tensor(151.6095, device='cuda:3')
compute norm is  tensor(46.0492, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.8137, device='cuda:3')
compute distance is  tensor(165.8137, device='cuda:3')
compute norm is  tensor(46.3797, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.2678, device='cuda:3')
compute distance is  tensor(148.2678, device='cuda:3')
compute norm is  tensor(45.9933, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.0119, device='cuda:3')
compute distance is  tensor(154.0119, device='cuda:3')
compute norm is  tensor(46.1780, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.5848, device='cuda:3')
compute distance is  tensor(154.5848, device='cuda:3')
compute norm is  tensor(45.9027, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(165.8137, device='cuda:3')
distance x is tensor(107658.1172, device='cuda:3')
distance x is tensor(107658.1172, device='cuda:3')
________________________________
test distance is  tensor(107658.1172, device='cuda:3')
test distance1 is  tensor(107658.1172, device='cuda:3')
test similarity is  tensor(0.1050, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130145446301722.2
test entropy is  0.0
________________________________
cal ratio is  0.038460316900899634
distance x is tensor(4140.5713, device='cuda:3')
cal_distance is  tensor(4140.5713, device='cuda:3')
cal ratio is  0.1961128749449994
distance x is tensor(812.0233, device='cuda:3')
cal_distance is  tensor(812.0233, device='cuda:3')
cal ratio is  0.44284527053663486
distance x is tensor(359.6035, device='cuda:3')
cal_distance is  tensor(359.6035, device='cuda:3')
cal ratio is  0.6654635739130774
distance x is tensor(239.3048, device='cuda:3')
cal_distance is  tensor(239.3048, device='cuda:3')
cal ratio is  0.8157565203039888
distance x is tensor(195.2154, device='cuda:3')
cal_distance is  tensor(195.2154, device='cuda:3')
cal ratio is  0.9031901929484043
distance x is tensor(176.3171, device='cuda:3')
cal_distance is  tensor(176.3171, device='cuda:3')
cal ratio is  0.9503619078888771
distance x is tensor(167.5653, device='cuda:3')
cal_distance is  tensor(167.5653, device='cuda:3')
cal ratio is  0.9748642586459806
distance x is tensor(163.3536, device='cuda:3')
cal_distance is  tensor(163.3536, device='cuda:3')
distance x is tensor(163.3536, device='cuda:3')
return_distance is  tensor(163.3536, device='cuda:3')
distance x is tensor(163.3434, device='cuda:3')
distance x is tensor(163.3434, device='cuda:3')
________________________________
test distance is  tensor(163.3434, device='cuda:3')
test distance1 is  tensor(163.3434, device='cuda:3')
test similarity is  tensor(0.9265, device='cuda:3')
test acc is  0.10000000015633198
test loss is 742.1261416437275
test entropy is  1.2311570410607532e-33
________________________________
0
distance x is tensor(163.3434, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.345456917899747e-46
avg test loss is  743.0257334109308
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9265, device='cuda:3')
compute_distance is  tensor(163.3434, device='cuda:3')
compute_norm is  tensor(47.2522, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.5751, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.528076552251763
avg test loss is  2.6690745727339786
avg accuracy is  0.4026000001563412
solo acc is  0.11533333348966528
compute similarity  is  tensor(0.9253, device='cuda:3')
compute_distance is  tensor(159.5751, device='cuda:3')
compute_norm is  tensor(47.8409, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.7435, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8501442984731467
avg test loss is  3.40402783691756
avg accuracy is  0.29711666682300614
solo acc is  0.10165000015633197
compute similarity  is  tensor(0.9242, device='cuda:3')
compute_distance is  tensor(160.7435, device='cuda:3')
compute_norm is  tensor(47.9767, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.5093, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.124401663539252
avg test loss is  1.898279095001058
avg accuracy is  0.5293666668230089
solo acc is  0.20363333348966983
compute similarity  is  tensor(0.9261, device='cuda:3')
compute_distance is  tensor(161.5093, device='cuda:3')
compute_norm is  tensor(47.6731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.4475, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.658573268382534
avg test loss is  2.6830878524637933
avg accuracy is  0.4097000001563412
solo acc is  0.10886666682299861
compute similarity  is  tensor(0.9258, device='cuda:3')
compute_distance is  tensor(162.4475, device='cuda:3')
compute_norm is  tensor(47.5801, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.0919, device='cuda:3')
distance x is tensor(163.0919, device='cuda:3')
________________________________
test distance is  tensor(163.0919, device='cuda:3')
test distance1 is  tensor(163.0919, device='cuda:3')
test similarity is  tensor(0.9266, device='cuda:3')
test acc is  0.23300000015633773
test loss is 1.6506954070601636
test entropy is  1.019188474109178
________________________________
0
distance x is tensor(163.0919, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0207309170064134
avg test loss is  1.6502142556186423
avg accuracy is  0.5370500001563423
solo acc is  0.23193333348967096
compute similarity  is  tensor(0.9266, device='cuda:3')
compute_distance is  tensor(163.0919, device='cuda:3')
compute_norm is  tensor(47.1877, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.6699, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6184125606820527
avg test loss is  2.473338085196928
avg accuracy is  0.4088500001563412
solo acc is  0.10780000015633195
compute similarity  is  tensor(0.9262, device='cuda:3')
compute_distance is  tensor(163.6699, device='cuda:3')
compute_norm is  tensor(47.0590, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.3179, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9778833245036445
avg test loss is  1.5459739236689325
avg accuracy is  0.5538000001563417
solo acc is  0.2466333334896715
compute similarity  is  tensor(0.9265, device='cuda:3')
compute_distance is  tensor(164.3179, device='cuda:3')
compute_norm is  tensor(46.7147, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.3179, device='cuda:3')
distance x is tensor(164.3179, device='cuda:3')
________________________________
test distance is  tensor(164.3179, device='cuda:3')
test distance1 is  tensor(164.3179, device='cuda:3')
test similarity is  tensor(0.9265, device='cuda:3')
test acc is  0.24461666682300473
test loss is 1.54559983881806
test entropy is  0.9795416715556878
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4261466264724731
mal norm is  tensor(803.1152, device='cuda:3')
distance x is tensor(164.3254, device='cuda:3')
mal distance is  tensor(164.3254, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 26
weight size is  torch.Size([44, 215370])
norm res is  tensor([622.3524, 680.8019, 657.2438, 613.6799, 577.2513, 612.8765, 576.9795,
        644.9373, 803.1152, 803.1152, 803.1152, 803.1152, 803.1152, 803.1152,
        803.1152, 803.1152, 803.1152, 803.1152, 803.1152, 803.1152, 774.8776,
        763.3779, 781.9155, 848.0588, 809.0829, 768.5521, 817.1522, 794.4907,
        697.0385, 717.0687, 677.1785, 670.9500, 687.4367, 718.7227, 705.6845,
        659.2109, 699.1467, 699.7181, 658.3958, 696.1411, 652.1224, 659.2456,
        696.9146, 701.9241], device='cuda:3')
sorted_norm is   tensor([576.9795, 577.2513, 612.8765, 613.6799, 622.3524, 644.9373, 652.1224,
        657.2438, 658.3958, 659.2109, 659.2456, 670.9500, 677.1785, 680.8019,
        687.4367, 696.1411, 696.9146, 697.0385, 699.1467, 699.7181, 701.9241,
        705.6845, 717.0687, 718.7227, 763.3779, 768.5521, 774.8776, 781.9155,
        794.4907, 803.1152, 803.1152, 803.1152, 803.1152, 803.1152, 803.1152,
        803.1152, 803.1152, 803.1152, 803.1152, 803.1152, 803.1152, 809.0829,
        817.1522, 848.0588], device='cuda:3')
used idx is  tensor([ 6,  4,  5,  3,  0,  7, 40,  2, 38, 35, 41, 31, 30,  1, 32, 39, 42, 28,
        36, 37, 43, 34, 29, 33, 21, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.92% 

Test Accuracy: 88.95% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46437302231788635
distance x is tensor(113.8337, device='cuda:3')
benign distance is  tensor(113.8337, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4902324676513672
distance x is tensor(116.5739, device='cuda:3')
benign distance is  tensor(116.5739, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.030573343858122826
distance x is tensor(116.1260, device='cuda:3')
benign distance is  tensor(116.1260, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0008766651153564
distance x is tensor(108.3180, device='cuda:3')
benign distance is  tensor(108.3180, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.36249619722366333
distance x is tensor(87.4448, device='cuda:3')
benign distance is  tensor(87.4448, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8537789583206177
distance x is tensor(119.6565, device='cuda:3')
benign distance is  tensor(119.6565, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.614593505859375
distance x is tensor(110.4813, device='cuda:3')
benign distance is  tensor(110.4813, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.694252073764801
distance x is tensor(113.8526, device='cuda:3')
benign distance is  tensor(113.8526, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5035714507102966
distance x is tensor(126.6909, device='cuda:3')
benign distance is  tensor(126.6909, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0375572443008423
distance x is tensor(128.4354, device='cuda:3')
benign distance is  tensor(128.4354, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5111570954322815
distance x is tensor(121.8953, device='cuda:3')
benign distance is  tensor(121.8953, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9634819030761719
distance x is tensor(131.7118, device='cuda:3')
benign distance is  tensor(131.7118, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.053151458501815796
distance x is tensor(125.0952, device='cuda:3')
benign distance is  tensor(125.0952, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7014549970626831
distance x is tensor(129.0551, device='cuda:3')
benign distance is  tensor(129.0551, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3624599575996399
distance x is tensor(127.2587, device='cuda:3')
benign distance is  tensor(127.2587, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5284394025802612
distance x is tensor(137.2204, device='cuda:3')
benign distance is  tensor(137.2204, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.32176119089126587
distance x is tensor(125.6157, device='cuda:3')
benign distance is  tensor(125.6157, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.889792799949646
distance x is tensor(140.0843, device='cuda:3')
benign distance is  tensor(140.0843, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.18297426402568817
distance x is tensor(130.3954, device='cuda:3')
benign distance is  tensor(130.3954, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.05001821368932724
distance x is tensor(121.7181, device='cuda:3')
benign distance is  tensor(121.7181, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.08470679819583893
distance x is tensor(135.2737, device='cuda:3')
benign distance is  tensor(135.2737, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4836205542087555
distance x is tensor(125.1640, device='cuda:3')
benign distance is  tensor(125.1640, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3864780366420746
distance x is tensor(131.8154, device='cuda:3')
benign distance is  tensor(131.8154, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.42833489179611206
distance x is tensor(127.8704, device='cuda:3')
benign distance is  tensor(127.8704, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3445044457912445
distance x is tensor(131.0307, device='cuda:3')
benign distance is  tensor(131.0307, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.13578298687934875
distance x is tensor(126.9653, device='cuda:3')
benign distance is  tensor(126.9653, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3903694748878479
distance x is tensor(119.8469, device='cuda:3')
benign distance is  tensor(119.8469, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.45398420095443726
distance x is tensor(140.9330, device='cuda:3')
benign distance is  tensor(140.9330, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3606567680835724
distance x is tensor(123.7600, device='cuda:3')
benign distance is  tensor(123.7600, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.28482159972190857
distance x is tensor(137.0931, device='cuda:3')
benign distance is  tensor(137.0931, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7771334648132324
distance x is tensor(136.3939, device='cuda:3')
benign distance is  tensor(136.3939, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6388420462608337
distance x is tensor(132.4081, device='cuda:3')
benign distance is  tensor(132.4081, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.6668, device='cuda:3')
compute distance is  tensor(123.6668, device='cuda:3')
compute norm is  tensor(46.1949, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.8048, device='cuda:3')
compute distance is  tensor(115.8048, device='cuda:3')
compute norm is  tensor(46.0653, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0236, device='cuda:3')
compute distance is  tensor(127.0236, device='cuda:3')
compute norm is  tensor(46.3495, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.3986, device='cuda:3')
compute distance is  tensor(120.3986, device='cuda:3')
compute norm is  tensor(46.1280, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6794, device='cuda:3')
compute distance is  tensor(128.6794, device='cuda:3')
compute norm is  tensor(46.3754, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.3304, device='cuda:3')
compute distance is  tensor(114.3304, device='cuda:3')
compute norm is  tensor(46.1179, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.6430, device='cuda:3')
compute distance is  tensor(113.6430, device='cuda:3')
compute norm is  tensor(46.0708, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7890, device='cuda:3')
compute distance is  tensor(127.7890, device='cuda:3')
compute norm is  tensor(46.3167, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6452, device='cuda:3')
compute distance is  tensor(124.6452, device='cuda:3')
compute norm is  tensor(46.2273, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5719, device='cuda:3')
compute distance is  tensor(121.5719, device='cuda:3')
compute norm is  tensor(46.2612, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5214, device='cuda:3')
compute distance is  tensor(125.5214, device='cuda:3')
compute norm is  tensor(46.3033, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4056, device='cuda:3')
compute distance is  tensor(118.4056, device='cuda:3')
compute norm is  tensor(46.0625, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(128.6794, device='cuda:3')
distance x is tensor(107691.8672, device='cuda:3')
distance x is tensor(107691.8672, device='cuda:3')
________________________________
test distance is  tensor(107691.8672, device='cuda:3')
test distance1 is  tensor(107691.8672, device='cuda:3')
test similarity is  tensor(-0.0158, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130096051083512.9
test entropy is  0.0
________________________________
cal ratio is  0.033875768129572485
distance x is tensor(3648.1501, device='cuda:3')
cal_distance is  tensor(3648.1501, device='cuda:3')
cal ratio is  0.18405357238802206
distance x is tensor(671.4592, device='cuda:3')
cal_distance is  tensor(671.4592, device='cuda:3')
cal ratio is  0.42901332636649925
distance x is tensor(288.0678, device='cuda:3')
cal_distance is  tensor(288.0678, device='cuda:3')
cal ratio is  0.6549878281270447
distance x is tensor(188.6827, device='cuda:3')
cal_distance is  tensor(188.6827, device='cuda:3')
cal ratio is  0.8093092764898424
distance x is tensor(152.7037, device='cuda:3')
cal_distance is  tensor(152.7037, device='cuda:3')
cal ratio is  0.8996132883839001
distance x is tensor(137.3748, device='cuda:3')
cal_distance is  tensor(137.3748, device='cuda:3')
cal ratio is  0.9484776304323899
distance x is tensor(130.2972, device='cuda:3')
cal_distance is  tensor(130.2972, device='cuda:3')
cal ratio is  0.9738970962992677
distance x is tensor(126.8962, device='cuda:3')
cal_distance is  tensor(126.8962, device='cuda:3')
distance x is tensor(126.8962, device='cuda:3')
return_distance is  tensor(126.8962, device='cuda:3')
distance x is tensor(126.8859, device='cuda:3')
distance x is tensor(126.8859, device='cuda:3')
________________________________
test distance is  tensor(126.8859, device='cuda:3')
test distance1 is  tensor(126.8859, device='cuda:3')
test similarity is  tensor(0.9498, device='cuda:3')
test acc is  0.10036666682299865
test loss is 256.1559075231491
test entropy is  0.0001135802775509391
________________________________
0
distance x is tensor(126.8859, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  9.246939229851362e-05
avg test loss is  256.2571612360127
avg accuracy is  0.31695000015633984
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9498, device='cuda:3')
compute_distance is  tensor(126.8859, device='cuda:3')
compute_norm is  tensor(45.6932, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(111.1731, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9123270202165982
avg test loss is  1.438374713031468
avg accuracy is  0.8538166668229898
solo acc is  0.33070000015634016
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(111.1731, device='cuda:3')
compute_norm is  tensor(44.9143, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.0930, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.874433110581278
avg test loss is  1.5061224186852542
avg accuracy is  0.8544333334896564
solo acc is  0.27490000015633886
compute similarity  is  tensor(0.9540, device='cuda:3')
compute_distance is  tensor(113.0930, device='cuda:3')
compute_norm is  tensor(44.6356, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.8054, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8596309722740767
avg test loss is  1.487875101154547
avg accuracy is  0.8550666668229898
solo acc is  0.265383333489672
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(114.8054, device='cuda:3')
compute_norm is  tensor(44.3798, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.3764, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8484168167688699
avg test loss is  1.465741756628317
avg accuracy is  0.8570166668229897
solo acc is  0.26300000015633856
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(116.3764, device='cuda:3')
compute_norm is  tensor(44.1362, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.9373, device='cuda:3')
distance x is tensor(117.9373, device='cuda:3')
________________________________
test distance is  tensor(117.9373, device='cuda:3')
test distance1 is  tensor(117.9373, device='cuda:3')
test similarity is  tensor(0.9531, device='cuda:3')
test acc is  0.2654166668230053
test loss is 1.4316571721517202
test entropy is  0.8541666910465338
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3708302974700928
mal norm is  tensor(608.1066, device='cuda:3')
distance x is tensor(117.9454, device='cuda:3')
mal distance is  tensor(117.9454, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([506.3033, 530.8173, 502.1077, 469.3403, 378.1674, 524.7939, 488.9590,
        498.8155, 608.1066, 608.1066, 608.1066, 608.1066, 608.1066, 608.1066,
        608.1066, 608.1066, 608.1066, 608.1066, 608.1066, 608.1066],
       device='cuda:3')
sorted_norm is   tensor([378.1674, 469.3403, 488.9590, 498.8155, 502.1077, 506.3033, 524.7939,
        530.8173, 608.1066, 608.1066, 608.1066, 608.1066, 608.1066, 608.1066,
        608.1066, 608.1066, 608.1066, 608.1066, 608.1066, 608.1066],
       device='cuda:3')
used idx is  tensor([ 4,  3,  6,  7,  2,  0,  5,  1, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 88.86% 

Test Accuracy: 87.92% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.119033932685852
distance x is tensor(114.8679, device='cuda:3')
benign distance is  tensor(114.8679, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3552986681461334
distance x is tensor(135.9428, device='cuda:3')
benign distance is  tensor(135.9428, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11777882277965546
distance x is tensor(128.0277, device='cuda:3')
benign distance is  tensor(128.0277, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4865798056125641
distance x is tensor(129.5834, device='cuda:3')
benign distance is  tensor(129.5834, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6109429001808167
distance x is tensor(126.0456, device='cuda:3')
benign distance is  tensor(126.0456, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6673844456672668
distance x is tensor(123.3731, device='cuda:3')
benign distance is  tensor(123.3731, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4425220489501953
distance x is tensor(131.7685, device='cuda:3')
benign distance is  tensor(131.7685, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3705293536186218
distance x is tensor(146.5981, device='cuda:3')
benign distance is  tensor(146.5981, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(131.5749, device='cuda:3')
compute distance is  tensor(131.5749, device='cuda:3')
compute norm is  tensor(46.0202, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8830, device='cuda:3')
compute distance is  tensor(131.8830, device='cuda:3')
compute norm is  tensor(46.0811, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7565, device='cuda:3')
compute distance is  tensor(138.7565, device='cuda:3')
compute norm is  tensor(46.2951, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2179, device='cuda:3')
compute distance is  tensor(131.2179, device='cuda:3')
compute norm is  tensor(46.1597, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4072, device='cuda:3')
compute distance is  tensor(147.4072, device='cuda:3')
compute norm is  tensor(46.4328, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7876, device='cuda:3')
compute distance is  tensor(138.7876, device='cuda:3')
compute norm is  tensor(46.4214, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7516, device='cuda:3')
compute distance is  tensor(142.7516, device='cuda:3')
compute norm is  tensor(46.4258, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0267, device='cuda:3')
compute distance is  tensor(137.0267, device='cuda:3')
compute norm is  tensor(46.2302, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0316, device='cuda:3')
compute distance is  tensor(144.0316, device='cuda:3')
compute norm is  tensor(46.2689, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4754, device='cuda:3')
compute distance is  tensor(126.4754, device='cuda:3')
compute norm is  tensor(46.0057, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2458, device='cuda:3')
compute distance is  tensor(141.2458, device='cuda:3')
compute norm is  tensor(46.4130, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.7677, device='cuda:3')
compute distance is  tensor(147.7677, device='cuda:3')
compute norm is  tensor(46.5108, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.7677, device='cuda:3')
distance x is tensor(107668.4453, device='cuda:3')
distance x is tensor(107668.4453, device='cuda:3')
________________________________
test distance is  tensor(107668.4453, device='cuda:3')
test distance1 is  tensor(107668.4453, device='cuda:3')
test similarity is  tensor(0.0704, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130053050989474.11
test entropy is  0.0
________________________________
cal ratio is  0.03630543296695883
distance x is tensor(3908.9551, device='cuda:3')
cal_distance is  tensor(3908.9551, device='cuda:3')
cal ratio is  0.190539707942118
distance x is tensor(744.8152, device='cuda:3')
cal_distance is  tensor(744.8152, device='cuda:3')
cal ratio is  0.43650735553926934
distance x is tensor(325.1202, device='cuda:3')
cal_distance is  tensor(325.1202, device='cuda:3')
cal ratio is  0.6606841208043414
distance x is tensor(214.8035, device='cuda:3')
cal_distance is  tensor(214.8035, device='cuda:3')
cal ratio is  0.8128214712062181
distance x is tensor(174.5979, device='cuda:3')
cal_distance is  tensor(174.5979, device='cuda:3')
cal ratio is  0.9015636303925989
distance x is tensor(157.4116, device='cuda:3')
cal_distance is  tensor(157.4116, device='cuda:3')
cal ratio is  0.9495053829368967
distance x is tensor(149.4634, device='cuda:3')
cal_distance is  tensor(149.4634, device='cuda:3')
cal ratio is  0.9744248438498858
distance x is tensor(145.6410, device='cuda:3')
cal_distance is  tensor(145.6410, device='cuda:3')
distance x is tensor(145.6410, device='cuda:3')
return_distance is  tensor(145.6410, device='cuda:3')
distance x is tensor(145.6308, device='cuda:3')
distance x is tensor(145.6308, device='cuda:3')
________________________________
test distance is  tensor(145.6308, device='cuda:3')
test distance1 is  tensor(145.6308, device='cuda:3')
test similarity is  tensor(0.9392, device='cuda:3')
test acc is  0.10000000015633198
test loss is 485.9701256335163
test entropy is  4.819596138441344e-20
________________________________
0
distance x is tensor(145.6308, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1789718962788946e-11
avg test loss is  486.246195160758
avg accuracy is  0.10735000015633195
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(145.6308, device='cuda:3')
compute_norm is  tensor(46.8506, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.0344, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0535969484462413
avg test loss is  1.6146677459226741
avg accuracy is  0.7208333334896628
solo acc is  0.265633333489672
compute similarity  is  tensor(0.9437, device='cuda:3')
compute_distance is  tensor(133.0344, device='cuda:3')
compute_norm is  tensor(46.6759, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(133.9823, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6244253821210313
avg test loss is  2.463514530836646
avg accuracy is  0.6211166668230026
solo acc is  0.11430000015633193
compute similarity  is  tensor(0.9434, device='cuda:3')
compute_distance is  tensor(133.9823, device='cuda:3')
compute_norm is  tensor(46.5045, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.6754, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9468612248328194
avg test loss is  1.4389964564522701
avg accuracy is  0.7468666668229946
solo acc is  0.2924833334896727
compute similarity  is  tensor(0.9438, device='cuda:3')
compute_distance is  tensor(133.6754, device='cuda:3')
compute_norm is  tensor(46.2172, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(133.6754, device='cuda:3')
distance x is tensor(133.6754, device='cuda:3')
________________________________
test distance is  tensor(133.6754, device='cuda:3')
test distance1 is  tensor(133.6754, device='cuda:3')
test similarity is  tensor(0.9438, device='cuda:3')
test acc is  0.29141666682300604
test loss is 1.438737464357795
test entropy is  0.9465920392638331
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5283024311065674
mal norm is  tensor(698.4714, device='cuda:3')
distance x is tensor(133.6839, device='cuda:3')
mal distance is  tensor(133.6839, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([507.2602, 593.9980, 542.7208, 552.3244, 533.1376, 532.8182, 562.4802,
        624.2891, 698.4714, 698.4714, 698.4714, 698.4714, 698.4714, 698.4714,
        698.4714, 698.4714, 698.4714, 698.4714, 698.4714, 698.4714, 683.3416,
        640.2502, 700.6027, 654.4570, 685.4659, 666.9771, 692.7396, 716.3651,
        604.2838, 620.0665, 576.5843, 625.8760, 601.3861, 617.6603, 624.0534,
        644.1562], device='cuda:3')
sorted_norm is   tensor([507.2602, 532.8182, 533.1376, 542.7208, 552.3244, 562.4802, 576.5843,
        593.9980, 601.3861, 604.2838, 617.6603, 620.0665, 624.0534, 624.2891,
        625.8760, 640.2502, 644.1562, 654.4570, 666.9771, 683.3416, 685.4659,
        692.7396, 698.4714, 698.4714, 698.4714, 698.4714, 698.4714, 698.4714,
        698.4714, 698.4714, 698.4714, 698.4714, 698.4714, 698.4714, 700.6027,
        716.3651], device='cuda:3')
used idx is  tensor([ 0,  5,  4,  2,  3,  6, 30,  1, 32, 28, 33, 29, 34,  7, 31, 21, 35, 23,
        25, 20, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.70% 

Test Accuracy: 88.97% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4055754542350769
distance x is tensor(101.6207, device='cuda:3')
benign distance is  tensor(101.6207, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9372138977050781
distance x is tensor(109.1053, device='cuda:3')
benign distance is  tensor(109.1053, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04846911132335663
distance x is tensor(117.7073, device='cuda:3')
benign distance is  tensor(117.7073, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0034587383270264
distance x is tensor(118.4491, device='cuda:3')
benign distance is  tensor(118.4491, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8607336282730103
distance x is tensor(120.9746, device='cuda:3')
benign distance is  tensor(120.9746, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5778442621231079
distance x is tensor(117.4750, device='cuda:3')
benign distance is  tensor(117.4750, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26774105429649353
distance x is tensor(108.6377, device='cuda:3')
benign distance is  tensor(108.6377, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29599979519844055
distance x is tensor(121.8519, device='cuda:3')
benign distance is  tensor(121.8519, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.43084678053855896
distance x is tensor(134.6495, device='cuda:3')
benign distance is  tensor(134.6495, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3946903347969055
distance x is tensor(133.9885, device='cuda:3')
benign distance is  tensor(133.9885, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6710463762283325
distance x is tensor(125.6635, device='cuda:3')
benign distance is  tensor(125.6635, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2234435081481934
distance x is tensor(126.6834, device='cuda:3')
benign distance is  tensor(126.6834, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4572322368621826
distance x is tensor(131.6834, device='cuda:3')
benign distance is  tensor(131.6834, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.06479462236166
distance x is tensor(136.4667, device='cuda:3')
benign distance is  tensor(136.4667, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3369024693965912
distance x is tensor(126.7639, device='cuda:3')
benign distance is  tensor(126.7639, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6955946087837219
distance x is tensor(124.9624, device='cuda:3')
benign distance is  tensor(124.9624, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2682950794696808
distance x is tensor(130.5523, device='cuda:3')
benign distance is  tensor(130.5523, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0477941036224365
distance x is tensor(125.6778, device='cuda:3')
benign distance is  tensor(125.6778, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.47209280729293823
distance x is tensor(130.1458, device='cuda:3')
benign distance is  tensor(130.1458, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3454917371273041
distance x is tensor(142.8021, device='cuda:3')
benign distance is  tensor(142.8021, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.605553925037384
distance x is tensor(129.6773, device='cuda:3')
benign distance is  tensor(129.6773, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.636080801486969
distance x is tensor(128.2897, device='cuda:3')
benign distance is  tensor(128.2897, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.11392103135585785
distance x is tensor(128.9983, device='cuda:3')
benign distance is  tensor(128.9983, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.12972494959831238
distance x is tensor(134.1742, device='cuda:3')
benign distance is  tensor(134.1742, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(125.3286, device='cuda:3')
compute distance is  tensor(125.3286, device='cuda:3')
compute norm is  tensor(46.5374, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.3666, device='cuda:3')
compute distance is  tensor(116.3666, device='cuda:3')
compute norm is  tensor(46.4223, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7726, device='cuda:3')
compute distance is  tensor(123.7726, device='cuda:3')
compute norm is  tensor(46.6950, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3993, device='cuda:3')
compute distance is  tensor(128.3993, device='cuda:3')
compute norm is  tensor(46.7412, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3015, device='cuda:3')
compute distance is  tensor(123.3015, device='cuda:3')
compute norm is  tensor(46.4525, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9377, device='cuda:3')
compute distance is  tensor(119.9377, device='cuda:3')
compute norm is  tensor(46.5653, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.0073, device='cuda:3')
compute distance is  tensor(116.0073, device='cuda:3')
compute norm is  tensor(46.4632, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4860, device='cuda:3')
compute distance is  tensor(137.4860, device='cuda:3')
compute norm is  tensor(46.8771, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7991, device='cuda:3')
compute distance is  tensor(120.7991, device='cuda:3')
compute norm is  tensor(46.4926, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5303, device='cuda:3')
compute distance is  tensor(124.5303, device='cuda:3')
compute norm is  tensor(46.7044, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2747, device='cuda:3')
compute distance is  tensor(123.2747, device='cuda:3')
compute norm is  tensor(46.5715, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7581, device='cuda:3')
compute distance is  tensor(120.7581, device='cuda:3')
compute norm is  tensor(46.4774, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.4860, device='cuda:3')
distance x is tensor(107689.8672, device='cuda:3')
distance x is tensor(107689.8672, device='cuda:3')
________________________________
test distance is  tensor(107689.8672, device='cuda:3')
test distance1 is  tensor(107689.8672, device='cuda:3')
test similarity is  tensor(-0.0044, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130067605921914.27
test entropy is  0.0
________________________________
cal ratio is  0.03501610867180832
distance x is tensor(3770.8848, device='cuda:3')
cal_distance is  tensor(3770.8848, device='cuda:3')
cal ratio is  0.18712580504782558
distance x is tensor(705.6340, device='cuda:3')
cal_distance is  tensor(705.6340, device='cuda:3')
cal ratio is  0.43257911749531813
distance x is tensor(305.2455, device='cuda:3')
cal_distance is  tensor(305.2455, device='cuda:3')
cal ratio is  0.657704299518257
distance x is tensor(200.7630, device='cuda:3')
cal_distance is  tensor(200.7630, device='cuda:3')
cal ratio is  0.8109861227316961
distance x is tensor(162.8170, device='cuda:3')
cal_distance is  tensor(162.8170, device='cuda:3')
cal ratio is  0.9005449846661033
distance x is tensor(146.6246, device='cuda:3')
cal_distance is  tensor(146.6246, device='cuda:3')
cal ratio is  0.948968723488689
distance x is tensor(139.1424, device='cuda:3')
cal_distance is  tensor(139.1424, device='cuda:3')
cal ratio is  0.9741494588797854
distance x is tensor(135.5456, device='cuda:3')
cal_distance is  tensor(135.5456, device='cuda:3')
distance x is tensor(135.5456, device='cuda:3')
return_distance is  tensor(135.5456, device='cuda:3')
distance x is tensor(135.5354, device='cuda:3')
distance x is tensor(135.5354, device='cuda:3')
________________________________
test distance is  tensor(135.5354, device='cuda:3')
test distance1 is  tensor(135.5354, device='cuda:3')
test similarity is  tensor(0.9447, device='cuda:3')
test acc is  0.10016666682299866
test loss is 317.8710566604061
test entropy is  5.980275481604558e-05
________________________________
0
distance x is tensor(135.5354, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.506984398651453e-05
avg test loss is  317.71576845213804
avg accuracy is  0.26706666682300545
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9447, device='cuda:3')
compute_distance is  tensor(135.5354, device='cuda:3')
compute_norm is  tensor(46.4234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(118.3048, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9293326582354523
avg test loss is  1.4250738728783532
avg accuracy is  0.8521500001563233
solo acc is  0.3314166668230068
compute similarity  is  tensor(0.9502, device='cuda:3')
compute_distance is  tensor(118.3048, device='cuda:3')
compute_norm is  tensor(45.7446, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.1204, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8739159623824203
avg test loss is  1.5173570814925725
avg accuracy is  0.8507333334896565
solo acc is  0.26943333348967213
compute similarity  is  tensor(0.9498, device='cuda:3')
compute_distance is  tensor(120.1204, device='cuda:3')
compute_norm is  tensor(45.4767, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.7879, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8839026939894344
avg test loss is  1.468396359161019
avg accuracy is  0.8523833334896566
solo acc is  0.2686000001563388
compute similarity  is  tensor(0.9495, device='cuda:3')
compute_distance is  tensor(121.7879, device='cuda:3')
compute_norm is  tensor(45.2257, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.2808, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8810597988588216
avg test loss is  1.4357020848595512
avg accuracy is  0.8545333334896564
solo acc is  0.26685000015633875
compute similarity  is  tensor(0.9492, device='cuda:3')
compute_distance is  tensor(123.2808, device='cuda:3')
compute_norm is  tensor(44.9870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.7535, device='cuda:3')
distance x is tensor(124.7535, device='cuda:3')
________________________________
test distance is  tensor(124.7535, device='cuda:3')
test distance1 is  tensor(124.7535, device='cuda:3')
test similarity is  tensor(0.9489, device='cuda:3')
test acc is  0.2622666668230052
test loss is 1.4292382404748312
test entropy is  0.8662095319614735
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4495422840118408
mal norm is  tensor(645.0012, device='cuda:3')
distance x is tensor(124.7618, device='cuda:3')
mal distance is  tensor(124.7618, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([461.2210, 481.1500, 509.3656, 520.3661, 524.5070, 526.3210, 471.0274,
        534.5281, 645.0012, 645.0012, 645.0012, 645.0012, 645.0012, 645.0012,
        645.0012, 645.0012, 645.0012, 645.0012, 645.0012, 645.0012, 575.2640,
        627.7267, 597.0307, 567.2664, 611.5499, 566.1968, 597.8731, 572.1298],
       device='cuda:3')
sorted_norm is   tensor([461.2210, 471.0274, 481.1500, 509.3656, 520.3661, 524.5070, 526.3210,
        534.5281, 566.1968, 567.2664, 572.1298, 575.2640, 597.0307, 597.8731,
        611.5499, 627.7267, 645.0012, 645.0012, 645.0012, 645.0012, 645.0012,
        645.0012, 645.0012, 645.0012, 645.0012, 645.0012, 645.0012, 645.0012],
       device='cuda:3')
used idx is  tensor([ 0,  6,  1,  2,  3,  4,  5,  7, 25, 23, 27, 20, 22, 26, 24, 21],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.82% 

Test Accuracy: 89.16% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.09210279583930969
distance x is tensor(108.6110, device='cuda:3')
benign distance is  tensor(108.6110, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8033844828605652
distance x is tensor(116.6094, device='cuda:3')
benign distance is  tensor(116.6094, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07691462337970734
distance x is tensor(118.7321, device='cuda:3')
benign distance is  tensor(118.7321, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8580819964408875
distance x is tensor(100.0106, device='cuda:3')
benign distance is  tensor(100.0106, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.23098962008953094
distance x is tensor(102.3324, device='cuda:3')
benign distance is  tensor(102.3324, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6639091372489929
distance x is tensor(102.5105, device='cuda:3')
benign distance is  tensor(102.5105, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4097862243652344
distance x is tensor(109.7563, device='cuda:3')
benign distance is  tensor(109.7563, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.08827217668294907
distance x is tensor(107.6551, device='cuda:3')
benign distance is  tensor(107.6551, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5052143931388855
distance x is tensor(132.0343, device='cuda:3')
benign distance is  tensor(132.0343, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7572139501571655
distance x is tensor(140.7987, device='cuda:3')
benign distance is  tensor(140.7987, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.06092854589223862
distance x is tensor(118.3277, device='cuda:3')
benign distance is  tensor(118.3277, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.03453758358955383
distance x is tensor(123.2986, device='cuda:3')
benign distance is  tensor(123.2986, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4192273020744324
distance x is tensor(129.2957, device='cuda:3')
benign distance is  tensor(129.2957, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6737596988677979
distance x is tensor(118.5598, device='cuda:3')
benign distance is  tensor(118.5598, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.37500494718551636
distance x is tensor(130.1956, device='cuda:3')
benign distance is  tensor(130.1956, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7687840461730957
distance x is tensor(132.9939, device='cuda:3')
benign distance is  tensor(132.9939, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.7657, device='cuda:3')
compute distance is  tensor(118.7657, device='cuda:3')
compute norm is  tensor(46.7820, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7331, device='cuda:3')
compute distance is  tensor(111.7331, device='cuda:3')
compute norm is  tensor(46.7181, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1936, device='cuda:3')
compute distance is  tensor(125.1936, device='cuda:3')
compute norm is  tensor(47.0595, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.1962, device='cuda:3')
compute distance is  tensor(120.1962, device='cuda:3')
compute norm is  tensor(46.8807, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7103, device='cuda:3')
compute distance is  tensor(131.7103, device='cuda:3')
compute norm is  tensor(47.0621, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9492, device='cuda:3')
compute distance is  tensor(120.9492, device='cuda:3')
compute norm is  tensor(46.9058, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1115, device='cuda:3')
compute distance is  tensor(116.1115, device='cuda:3')
compute norm is  tensor(46.8146, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6708, device='cuda:3')
compute distance is  tensor(126.6708, device='cuda:3')
compute norm is  tensor(46.9257, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.4421, device='cuda:3')
compute distance is  tensor(116.4421, device='cuda:3')
compute norm is  tensor(46.7540, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1629, device='cuda:3')
compute distance is  tensor(114.1629, device='cuda:3')
compute norm is  tensor(46.8857, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.8638, device='cuda:3')
compute distance is  tensor(135.8638, device='cuda:3')
compute norm is  tensor(47.3271, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2058, device='cuda:3')
compute distance is  tensor(125.2058, device='cuda:3')
compute norm is  tensor(46.9191, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.8638, device='cuda:3')
distance x is tensor(107695.3438, device='cuda:3')
distance x is tensor(107695.3438, device='cuda:3')
________________________________
test distance is  tensor(107695.3438, device='cuda:3')
test distance1 is  tensor(107695.3438, device='cuda:3')
test similarity is  tensor(-0.0189, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130097464250953.14
test entropy is  0.0
________________________________
cal ratio is  0.03480803221146999
distance x is tensor(3748.6685, device='cuda:3')
cal_distance is  tensor(3748.6685, device='cuda:3')
cal ratio is  0.18656896929410935
distance x is tensor(699.3895, device='cuda:3')
cal_distance is  tensor(699.3895, device='cuda:3')
cal ratio is  0.43193498891095833
distance x is tensor(302.0937, device='cuda:3')
cal_distance is  tensor(302.0937, device='cuda:3')
cal ratio is  0.6572144931268822
distance x is tensor(198.5422, device='cuda:3')
cal_distance is  tensor(198.5422, device='cuda:3')
cal ratio is  0.8106839228724588
distance x is tensor(160.9559, device='cuda:3')
cal_distance is  tensor(160.9559, device='cuda:3')
cal ratio is  0.9003772176079461
distance x is tensor(144.9215, device='cuda:3')
cal_distance is  tensor(144.9215, device='cuda:3')
cal ratio is  0.9488803768666443
distance x is tensor(137.5135, device='cuda:3')
cal_distance is  tensor(137.5135, device='cuda:3')
cal ratio is  0.9741039455898811
distance x is tensor(133.9526, device='cuda:3')
cal_distance is  tensor(133.9526, device='cuda:3')
distance x is tensor(133.9526, device='cuda:3')
return_distance is  tensor(133.9526, device='cuda:3')
distance x is tensor(133.9423, device='cuda:3')
distance x is tensor(133.9423, device='cuda:3')
________________________________
test distance is  tensor(133.9423, device='cuda:3')
test distance1 is  tensor(133.9423, device='cuda:3')
test similarity is  tensor(0.9461, device='cuda:3')
test acc is  0.10038333348966531
test loss is 292.5819568105344
test entropy is  0.00017130684739658053
________________________________
0
distance x is tensor(133.9423, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  9.631369212448468e-05
avg test loss is  292.88565434372504
avg accuracy is  0.29816666682300613
solo acc is  0.10031666682299865
compute similarity  is  tensor(0.9461, device='cuda:3')
compute_distance is  tensor(133.9423, device='cuda:3')
compute_norm is  tensor(46.5717, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.3129, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9082633740485095
avg test loss is  1.4569246874435116
avg accuracy is  0.8587833334896563
solo acc is  0.3287833334896734
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(117.3129, device='cuda:3')
compute_norm is  tensor(45.8337, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.4641, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8726116031217677
avg test loss is  1.5236353451000857
avg accuracy is  0.8590500001563229
solo acc is  0.27088333348967214
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(119.4641, device='cuda:3')
compute_norm is  tensor(45.5507, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.2154, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8808617073335627
avg test loss is  1.4586832290773453
avg accuracy is  0.8595833334896563
solo acc is  0.2753166668230056
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(121.2154, device='cuda:3')
compute_norm is  tensor(45.2903, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.9172, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8638925845307837
avg test loss is  1.4534211824697727
avg accuracy is  0.8612333334896561
solo acc is  0.26830000015633876
compute similarity  is  tensor(0.9503, device='cuda:3')
compute_distance is  tensor(122.9172, device='cuda:3')
compute_norm is  tensor(45.0445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.4914, device='cuda:3')
distance x is tensor(124.4914, device='cuda:3')
________________________________
test distance is  tensor(124.4914, device='cuda:3')
test distance1 is  tensor(124.4914, device='cuda:3')
test similarity is  tensor(0.9500, device='cuda:3')
test acc is  0.2680666668230054
test loss is 1.4133017805339432
test entropy is  0.8790365421314483
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3353990316390991
mal norm is  tensor(639.7405, device='cuda:3')
distance x is tensor(124.4992, device='cuda:3')
mal distance is  tensor(124.4992, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([485.9496, 516.7452, 525.9600, 432.8166, 445.4116, 452.5253, 478.7345,
        485.6062, 639.7405, 639.7405, 639.7405, 639.7405, 639.7405, 639.7405,
        639.7405, 639.7405, 639.7405, 639.7405, 639.7405, 639.7405, 688.8292,
        702.5340, 671.4985, 693.6873, 654.1368, 665.7037, 656.8947, 653.0709,
        615.7952, 604.3804, 576.5904, 574.8741, 602.6599, 623.6683, 590.0640,
        578.9816], device='cuda:3')
sorted_norm is   tensor([432.8166, 445.4116, 452.5253, 478.7345, 485.6062, 485.9496, 516.7452,
        525.9600, 574.8741, 576.5904, 578.9816, 590.0640, 602.6599, 604.3804,
        615.7952, 623.6683, 639.7405, 639.7405, 639.7405, 639.7405, 639.7405,
        639.7405, 639.7405, 639.7405, 639.7405, 639.7405, 639.7405, 639.7405,
        653.0709, 654.1368, 656.8947, 665.7037, 671.4985, 688.8292, 693.6873,
        702.5340], device='cuda:3')
used idx is  tensor([ 3,  4,  5,  6,  7,  0,  1,  2, 31, 30, 35, 34, 32, 29, 28, 33, 11, 10,
         8,  9, 13], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.53% 

Test Accuracy: 88.95% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5986731648445129
distance x is tensor(96.0932, device='cuda:3')
benign distance is  tensor(96.0932, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6346942186355591
distance x is tensor(118.2544, device='cuda:3')
benign distance is  tensor(118.2544, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15015842020511627
distance x is tensor(128.3195, device='cuda:3')
benign distance is  tensor(128.3195, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5055006146430969
distance x is tensor(109.6470, device='cuda:3')
benign distance is  tensor(109.6470, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5032472014427185
distance x is tensor(103.2031, device='cuda:3')
benign distance is  tensor(103.2031, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.05890575796365738
distance x is tensor(126.1886, device='cuda:3')
benign distance is  tensor(126.1886, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20954017341136932
distance x is tensor(104.8984, device='cuda:3')
benign distance is  tensor(104.8984, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.231767937541008
distance x is tensor(131.9635, device='cuda:3')
benign distance is  tensor(131.9635, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3485638499259949
distance x is tensor(144.2103, device='cuda:3')
benign distance is  tensor(144.2103, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.25203269720077515
distance x is tensor(138.8882, device='cuda:3')
benign distance is  tensor(138.8882, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3193487226963043
distance x is tensor(125.2985, device='cuda:3')
benign distance is  tensor(125.2985, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8581829071044922
distance x is tensor(125.9589, device='cuda:3')
benign distance is  tensor(125.9589, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6962661743164062
distance x is tensor(139.2982, device='cuda:3')
benign distance is  tensor(139.2982, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2851389944553375
distance x is tensor(155.8204, device='cuda:3')
benign distance is  tensor(155.8204, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6093167662620544
distance x is tensor(135.7461, device='cuda:3')
benign distance is  tensor(135.7461, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.606842041015625
distance x is tensor(144.5801, device='cuda:3')
benign distance is  tensor(144.5801, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6679518818855286
distance x is tensor(154.3642, device='cuda:3')
benign distance is  tensor(154.3642, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.268237829208374
distance x is tensor(146.2200, device='cuda:3')
benign distance is  tensor(146.2200, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.44985079765319824
distance x is tensor(135.6543, device='cuda:3')
benign distance is  tensor(135.6543, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.44258904457092285
distance x is tensor(139.9053, device='cuda:3')
benign distance is  tensor(139.9053, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.29250627756118774
distance x is tensor(134.4436, device='cuda:3')
benign distance is  tensor(134.4436, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.35119664669036865
distance x is tensor(135.3552, device='cuda:3')
benign distance is  tensor(135.3552, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7458063960075378
distance x is tensor(141.0627, device='cuda:3')
benign distance is  tensor(141.0627, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.20061001181602478
distance x is tensor(139.6988, device='cuda:3')
benign distance is  tensor(139.6988, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.7893, device='cuda:3')
compute distance is  tensor(118.7893, device='cuda:3')
compute norm is  tensor(46.4832, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0567, device='cuda:3')
compute distance is  tensor(132.0567, device='cuda:3')
compute norm is  tensor(46.8861, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3884, device='cuda:3')
compute distance is  tensor(138.3884, device='cuda:3')
compute norm is  tensor(47.2801, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1776, device='cuda:3')
compute distance is  tensor(124.1776, device='cuda:3')
compute norm is  tensor(46.6735, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0382, device='cuda:3')
compute distance is  tensor(132.0382, device='cuda:3')
compute norm is  tensor(46.8633, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.1809, device='cuda:3')
compute distance is  tensor(133.1809, device='cuda:3')
compute norm is  tensor(47.0075, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.0042, device='cuda:3')
compute distance is  tensor(125.0042, device='cuda:3')
compute norm is  tensor(46.7685, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.4786, device='cuda:3')
compute distance is  tensor(142.4786, device='cuda:3')
compute norm is  tensor(47.1696, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4081, device='cuda:3')
compute distance is  tensor(134.4081, device='cuda:3')
compute norm is  tensor(46.9086, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.0666, device='cuda:3')
compute distance is  tensor(125.0666, device='cuda:3')
compute norm is  tensor(46.8047, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8598, device='cuda:3')
compute distance is  tensor(137.8598, device='cuda:3')
compute norm is  tensor(47.0286, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1747, device='cuda:3')
compute distance is  tensor(138.1747, device='cuda:3')
compute norm is  tensor(47.1748, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(142.4786, device='cuda:3')
distance x is tensor(107677.8750, device='cuda:3')
distance x is tensor(107677.8750, device='cuda:3')
________________________________
test distance is  tensor(107677.8750, device='cuda:3')
test distance1 is  tensor(107677.8750, device='cuda:3')
test similarity is  tensor(0.0474, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130115778853759.19
test entropy is  0.0
________________________________
cal ratio is  0.035648203451607616
distance x is tensor(3838.5283, device='cuda:3')
cal_distance is  tensor(3838.5283, device='cuda:3')
cal ratio is  0.18880718029026264
distance x is tensor(724.7458, device='cuda:3')
cal_distance is  tensor(724.7458, device='cuda:3')
cal ratio is  0.4345182402610025
distance x is tensor(314.9182, device='cuda:3')
cal_distance is  tensor(314.9182, device='cuda:3')
cal ratio is  0.6591769191836401
distance x is tensor(207.5886, device='cuda:3')
cal_distance is  tensor(207.5886, device='cuda:3')
cal ratio is  0.8118937043259182
distance x is tensor(168.5408, device='cuda:3')
cal_distance is  tensor(168.5408, device='cuda:3')
cal ratio is  0.9010488607894853
distance x is tensor(151.8640, device='cuda:3')
cal_distance is  tensor(151.8640, device='cuda:3')
cal ratio is  0.9492343170773325
distance x is tensor(144.1548, device='cuda:3')
cal_distance is  tensor(144.1548, device='cuda:3')
cal ratio is  0.9742856628394383
distance x is tensor(140.4481, device='cuda:3')
cal_distance is  tensor(140.4481, device='cuda:3')
distance x is tensor(140.4481, device='cuda:3')
return_distance is  tensor(140.4481, device='cuda:3')
distance x is tensor(140.4378, device='cuda:3')
distance x is tensor(140.4378, device='cuda:3')
________________________________
test distance is  tensor(140.4378, device='cuda:3')
test distance1 is  tensor(140.4378, device='cuda:3')
test similarity is  tensor(0.9436, device='cuda:3')
test acc is  0.10006666682299865
test loss is 372.5799584947924
test entropy is  1.3347272362705664e-05
________________________________
0
distance x is tensor(140.4378, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.374943312474535e-06
avg test loss is  372.8326530863227
avg accuracy is  0.1542666668230002
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9436, device='cuda:3')
compute_distance is  tensor(140.4378, device='cuda:3')
compute_norm is  tensor(47.2246, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(124.2680, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9586327160472301
avg test loss is  1.442487689859069
avg accuracy is  0.7877666668229927
solo acc is  0.31668333348967315
compute similarity  is  tensor(0.9490, device='cuda:3')
compute_distance is  tensor(124.2680, device='cuda:3')
compute_norm is  tensor(46.7642, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(124.2680, device='cuda:3')
distance x is tensor(124.2680, device='cuda:3')
________________________________
test distance is  tensor(124.2680, device='cuda:3')
test distance1 is  tensor(124.2680, device='cuda:3')
test similarity is  tensor(0.9490, device='cuda:3')
test acc is  0.31368333348967314
test loss is 1.443653407254453
test entropy is  0.9592261224159045
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1330790519714355
mal norm is  tensor(672.8952, device='cuda:3')
distance x is tensor(124.2769, device='cuda:3')
mal distance is  tensor(124.2769, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([424.1226, 528.5010, 550.0258, 472.9937, 445.5893, 543.4185, 448.5663,
        572.5321, 672.8952, 672.8952, 672.8952, 672.8952, 672.8952, 672.8952,
        672.8952, 672.8952, 672.8952, 672.8952, 672.8952, 672.8952],
       device='cuda:3')
sorted_norm is   tensor([424.1226, 445.5893, 448.5663, 472.9937, 528.5010, 543.4185, 550.0258,
        572.5321, 672.8952, 672.8952, 672.8952, 672.8952, 672.8952, 672.8952,
        672.8952, 672.8952, 672.8952, 672.8952, 672.8952, 672.8952],
       device='cuda:3')
used idx is  tensor([ 0,  4,  6,  3,  1,  5,  2,  7, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.32% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5466652512550354
distance x is tensor(147.6082, device='cuda:3')
benign distance is  tensor(147.6082, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.48270678520202637
distance x is tensor(148.6369, device='cuda:3')
benign distance is  tensor(148.6369, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3192780017852783
distance x is tensor(144.6049, device='cuda:3')
benign distance is  tensor(144.6049, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0423840284347534
distance x is tensor(152.2411, device='cuda:3')
benign distance is  tensor(152.2411, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.10561372339725494
distance x is tensor(120.1526, device='cuda:3')
benign distance is  tensor(120.1526, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6920744180679321
distance x is tensor(147.0080, device='cuda:3')
benign distance is  tensor(147.0080, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.45958423614501953
distance x is tensor(125.9363, device='cuda:3')
benign distance is  tensor(125.9363, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1885528415441513
distance x is tensor(162.1209, device='cuda:3')
benign distance is  tensor(162.1209, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(148.7221, device='cuda:3')
compute distance is  tensor(148.7221, device='cuda:3')
compute norm is  tensor(47.6214, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.1036, device='cuda:3')
compute distance is  tensor(160.1036, device='cuda:3')
compute norm is  tensor(47.8477, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.4869, device='cuda:3')
compute distance is  tensor(156.4869, device='cuda:3')
compute norm is  tensor(47.9848, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.1853, device='cuda:3')
compute distance is  tensor(151.1853, device='cuda:3')
compute norm is  tensor(47.6654, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.2649, device='cuda:3')
compute distance is  tensor(149.2649, device='cuda:3')
compute norm is  tensor(47.5432, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.4969, device='cuda:3')
compute distance is  tensor(155.4969, device='cuda:3')
compute norm is  tensor(47.7369, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0704, device='cuda:3')
compute distance is  tensor(147.0704, device='cuda:3')
compute norm is  tensor(47.5687, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.2706, device='cuda:3')
compute distance is  tensor(158.2706, device='cuda:3')
compute norm is  tensor(47.8526, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.4631, device='cuda:3')
compute distance is  tensor(153.4631, device='cuda:3')
compute norm is  tensor(47.6084, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.0884, device='cuda:3')
compute distance is  tensor(156.0884, device='cuda:3')
compute norm is  tensor(47.7589, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.3407, device='cuda:3')
compute distance is  tensor(170.3407, device='cuda:3')
compute norm is  tensor(48.3008, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.9760, device='cuda:3')
compute distance is  tensor(160.9760, device='cuda:3')
compute norm is  tensor(48.0756, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.3407, device='cuda:3')
distance x is tensor(107654.9141, device='cuda:3')
distance x is tensor(107654.9141, device='cuda:3')
________________________________
test distance is  tensor(107654.9141, device='cuda:3')
test distance1 is  tensor(107654.9141, device='cuda:3')
test similarity is  tensor(0.1335, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130095859853656.97
test entropy is  0.0
________________________________
cal ratio is  0.038982374815093236
distance x is tensor(4196.6499, device='cuda:3')
cal_distance is  tensor(4196.6499, device='cuda:3')
cal ratio is  0.19743941897479797
distance x is tensor(828.5882, device='cuda:3')
cal_distance is  tensor(828.5882, device='cuda:3')
cal ratio is  0.4443404567547371
distance x is tensor(368.1781, device='cuda:3')
cal_distance is  tensor(368.1781, device='cuda:3')
cal ratio is  0.6665860704688977
distance x is tensor(245.4241, device='cuda:3')
cal_distance is  tensor(245.4241, device='cuda:3')
cal ratio is  0.8164443844444592
distance x is tensor(200.3761, device='cuda:3')
cal_distance is  tensor(200.3761, device='cuda:3')
cal ratio is  0.9035709954895628
distance x is tensor(181.0545, device='cuda:3')
cal_distance is  tensor(181.0545, device='cuda:3')
cal ratio is  0.9505622558779042
distance x is tensor(172.1038, device='cuda:3')
cal_distance is  tensor(172.1038, device='cuda:3')
cal ratio is  0.9749670724321551
distance x is tensor(167.7957, device='cuda:3')
cal_distance is  tensor(167.7957, device='cuda:3')
distance x is tensor(167.7957, device='cuda:3')
return_distance is  tensor(167.7957, device='cuda:3')
distance x is tensor(167.7855, device='cuda:3')
distance x is tensor(167.7855, device='cuda:3')
________________________________
test distance is  tensor(167.7855, device='cuda:3')
test distance1 is  tensor(167.7855, device='cuda:3')
test similarity is  tensor(0.9303, device='cuda:3')
test acc is  0.10001666682299865
test loss is 636.9718122014613
test entropy is  4.9830664953300725e-06
________________________________
0
distance x is tensor(167.7855, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9083639148935398e-09
avg test loss is  636.9132300663605
avg accuracy is  0.1117166668229986
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.9303, device='cuda:3')
compute_distance is  tensor(167.7855, device='cuda:3')
compute_norm is  tensor(49.3713, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.8045, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4935450998704825
avg test loss is  2.4735529102496248
avg accuracy is  0.47576666682300855
solo acc is  0.11643333348966527
compute similarity  is  tensor(0.9279, device='cuda:3')
compute_distance is  tensor(161.8045, device='cuda:3')
compute_norm is  tensor(50.2744, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.4084, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8171567249653945
avg test loss is  3.2364755459685823
avg accuracy is  0.392750000156341
solo acc is  0.1011833334896653
compute similarity  is  tensor(0.9270, device='cuda:3')
compute_distance is  tensor(163.4084, device='cuda:3')
compute_norm is  tensor(50.3364, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.9525, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2534397595218505
avg test loss is  1.944657482318024
avg accuracy is  0.5686833334896737
solo acc is  0.20168333348966974
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(163.9525, device='cuda:3')
compute_norm is  tensor(49.9690, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.9333, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7109667198744409
avg test loss is  2.82796203708852
avg accuracy is  0.4761833334896752
solo acc is  0.10596666682299861
compute similarity  is  tensor(0.9276, device='cuda:3')
compute_distance is  tensor(164.9333, device='cuda:3')
compute_norm is  tensor(49.9132, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.7176, device='cuda:3')
distance x is tensor(165.7176, device='cuda:3')
________________________________
test distance is  tensor(165.7176, device='cuda:3')
test distance1 is  tensor(165.7176, device='cuda:3')
test similarity is  tensor(0.9282, device='cuda:3')
test acc is  0.21706666682300368
test loss is 1.7303497938713286
test entropy is  1.084779990443797
________________________________
0
distance x is tensor(165.7176, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0832326179628433
avg test loss is  1.7330600367680287
avg accuracy is  0.5986166668230044
solo acc is  0.21513333348967037
compute similarity  is  tensor(0.9282, device='cuda:3')
compute_distance is  tensor(165.7176, device='cuda:3')
compute_norm is  tensor(49.5460, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.4913, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6532886386044753
avg test loss is  2.549041845905247
avg accuracy is  0.491850000156342
solo acc is  0.10651666682299862
compute similarity  is  tensor(0.9277, device='cuda:3')
compute_distance is  tensor(166.4913, device='cuda:3')
compute_norm is  tensor(49.4252, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.2230, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0374115120881655
avg test loss is  1.6287579488144246
avg accuracy is  0.6134500001563364
solo acc is  0.21733333348967038
compute similarity  is  tensor(0.9279, device='cuda:3')
compute_distance is  tensor(167.2230, device='cuda:3')
compute_norm is  tensor(49.0915, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(167.8551, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6326666025083456
avg test loss is  2.423552019128413
avg accuracy is  0.5014833334896754
solo acc is  0.10530000015633197
compute similarity  is  tensor(0.9273, device='cuda:3')
compute_distance is  tensor(167.8551, device='cuda:3')
compute_norm is  tensor(48.9560, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.5249, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9909983716412648
avg test loss is  1.5414587726979367
avg accuracy is  0.6224333334896691
solo acc is  0.23533333348967114
compute similarity  is  tensor(0.9274, device='cuda:3')
compute_distance is  tensor(168.5249, device='cuda:3')
compute_norm is  tensor(48.6472, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(168.5249, device='cuda:3')
distance x is tensor(168.5249, device='cuda:3')
________________________________
test distance is  tensor(168.5249, device='cuda:3')
test distance1 is  tensor(168.5249, device='cuda:3')
test similarity is  tensor(0.9274, device='cuda:3')
test acc is  0.23686666682300453
test loss is 1.5366520093702305
test entropy is  0.9912171715231084
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3617182970046997
mal norm is  tensor(832.9703, device='cuda:3')
distance x is tensor(168.5324, device='cuda:3')
mal distance is  tensor(168.5324, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 31
weight size is  torch.Size([52, 215370])
norm res is  tensor([624.6963, 640.3397, 626.6957, 654.6089, 510.1937, 635.1101, 531.8202,
        691.0490, 832.9703, 832.9703, 832.9703, 832.9703, 832.9703, 832.9703,
        832.9703, 832.9703, 832.9703, 832.9703, 832.9703, 832.9703, 706.2394,
        675.1501, 668.3796, 737.2843, 678.9161, 719.0502, 717.6455, 714.3160,
        695.5523, 656.0105, 670.8773, 732.6671, 687.7730, 674.9745, 677.2234,
        714.7125, 697.1033, 746.3716, 654.2943, 681.5120, 699.8484, 649.0353,
        706.2847, 699.9133, 676.0759, 653.6617, 605.8729, 609.7724, 667.2434,
        735.0141, 653.4601, 674.1908], device='cuda:3')
sorted_norm is   tensor([510.1937, 531.8202, 605.8729, 609.7724, 624.6963, 626.6957, 635.1101,
        640.3397, 649.0353, 653.4601, 653.6617, 654.2943, 654.6089, 656.0105,
        667.2434, 668.3796, 670.8773, 674.1908, 674.9745, 675.1501, 676.0759,
        677.2234, 678.9161, 681.5120, 687.7730, 691.0490, 695.5523, 697.1033,
        699.8484, 699.9133, 706.2394, 706.2847, 714.3160, 714.7125, 717.6455,
        719.0502, 732.6671, 735.0141, 737.2843, 746.3716, 832.9703, 832.9703,
        832.9703, 832.9703, 832.9703, 832.9703, 832.9703, 832.9703, 832.9703,
        832.9703, 832.9703, 832.9703], device='cuda:3')
used idx is  tensor([ 4,  6, 46, 47,  0,  2,  5,  1, 41, 50, 45, 38,  3, 29, 48, 22, 30, 51,
        33, 21, 44, 34, 24, 39, 32,  7, 28, 36, 40, 43, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 90.00% 

Test Accuracy: 89.19% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.265051245689392
distance x is tensor(94.2576, device='cuda:3')
benign distance is  tensor(94.2576, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4600293040275574
distance x is tensor(110.4363, device='cuda:3')
benign distance is  tensor(110.4363, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7344551086425781
distance x is tensor(112.5188, device='cuda:3')
benign distance is  tensor(112.5188, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.833587646484375
distance x is tensor(101.0197, device='cuda:3')
benign distance is  tensor(101.0197, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.23275968432426453
distance x is tensor(90.0823, device='cuda:3')
benign distance is  tensor(90.0823, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5160832405090332
distance x is tensor(116.3981, device='cuda:3')
benign distance is  tensor(116.3981, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7675513029098511
distance x is tensor(104.4237, device='cuda:3')
benign distance is  tensor(104.4237, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.26835960149765015
distance x is tensor(105.3610, device='cuda:3')
benign distance is  tensor(105.3610, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.33665403723716736
distance x is tensor(123.6165, device='cuda:3')
benign distance is  tensor(123.6165, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.717194676399231
distance x is tensor(138.8303, device='cuda:3')
benign distance is  tensor(138.8303, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3017190098762512
distance x is tensor(124.6580, device='cuda:3')
benign distance is  tensor(124.6580, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0871893167495728
distance x is tensor(122.7700, device='cuda:3')
benign distance is  tensor(122.7700, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7703191041946411
distance x is tensor(116.9955, device='cuda:3')
benign distance is  tensor(116.9955, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5048448443412781
distance x is tensor(134.7233, device='cuda:3')
benign distance is  tensor(134.7233, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2199170589447021
distance x is tensor(130.0582, device='cuda:3')
benign distance is  tensor(130.0582, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9400704503059387
distance x is tensor(125.8369, device='cuda:3')
benign distance is  tensor(125.8369, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.20099373161792755
distance x is tensor(125.8832, device='cuda:3')
benign distance is  tensor(125.8832, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5162956118583679
distance x is tensor(135.7208, device='cuda:3')
benign distance is  tensor(135.7208, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.353665828704834
distance x is tensor(121.5188, device='cuda:3')
benign distance is  tensor(121.5188, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2056311070919037
distance x is tensor(134.3615, device='cuda:3')
benign distance is  tensor(134.3615, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1932341307401657
distance x is tensor(130.3705, device='cuda:3')
benign distance is  tensor(130.3705, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7358341217041016
distance x is tensor(116.1866, device='cuda:3')
benign distance is  tensor(116.1866, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.40572088956832886
distance x is tensor(140.0241, device='cuda:3')
benign distance is  tensor(140.0241, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3891715109348297
distance x is tensor(128.9264, device='cuda:3')
benign distance is  tensor(128.9264, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5108579397201538
distance x is tensor(135.6160, device='cuda:3')
benign distance is  tensor(135.6160, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.32682594656944275
distance x is tensor(127.3047, device='cuda:3')
benign distance is  tensor(127.3047, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3929603695869446
distance x is tensor(128.7977, device='cuda:3')
benign distance is  tensor(128.7977, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7748173475265503
distance x is tensor(138.2932, device='cuda:3')
benign distance is  tensor(138.2932, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.367261290550232
distance x is tensor(136.4402, device='cuda:3')
benign distance is  tensor(136.4402, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7607296109199524
distance x is tensor(135.1777, device='cuda:3')
benign distance is  tensor(135.1777, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.08050082623958588
distance x is tensor(130.5233, device='cuda:3')
benign distance is  tensor(130.5233, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.33247584104537964
distance x is tensor(133.5255, device='cuda:3')
benign distance is  tensor(133.5255, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.05900831148028374
distance x is tensor(124.5695, device='cuda:3')
benign distance is  tensor(124.5695, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.38751140236854553
distance x is tensor(131.9129, device='cuda:3')
benign distance is  tensor(131.9129, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.11583791673183441
distance x is tensor(126.3823, device='cuda:3')
benign distance is  tensor(126.3823, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4380185008049011
distance x is tensor(131.9023, device='cuda:3')
benign distance is  tensor(131.9023, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.22343988716602325
distance x is tensor(129.2543, device='cuda:3')
benign distance is  tensor(129.2543, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3055194318294525
distance x is tensor(135.3389, device='cuda:3')
benign distance is  tensor(135.3389, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7777515053749084
distance x is tensor(131.1419, device='cuda:3')
benign distance is  tensor(131.1419, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3774263262748718
distance x is tensor(137.6734, device='cuda:3')
benign distance is  tensor(137.6734, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(116.8781, device='cuda:3')
compute distance is  tensor(116.8781, device='cuda:3')
compute norm is  tensor(46.9841, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.6441, device='cuda:3')
compute distance is  tensor(119.6441, device='cuda:3')
compute norm is  tensor(47.1567, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9423, device='cuda:3')
compute distance is  tensor(120.9423, device='cuda:3')
compute norm is  tensor(47.3230, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8465, device='cuda:3')
compute distance is  tensor(120.8465, device='cuda:3')
compute norm is  tensor(47.0878, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9081, device='cuda:3')
compute distance is  tensor(119.9081, device='cuda:3')
compute norm is  tensor(47.1334, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.7865, device='cuda:3')
compute distance is  tensor(119.7865, device='cuda:3')
compute norm is  tensor(47.2407, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0521, device='cuda:3')
compute distance is  tensor(124.0521, device='cuda:3')
compute norm is  tensor(47.2486, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2883, device='cuda:3')
compute distance is  tensor(130.2883, device='cuda:3')
compute norm is  tensor(47.4140, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2746, device='cuda:3')
compute distance is  tensor(131.2746, device='cuda:3')
compute norm is  tensor(47.2682, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.6405, device='cuda:3')
compute distance is  tensor(122.6405, device='cuda:3')
compute norm is  tensor(47.2310, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9094, device='cuda:3')
compute distance is  tensor(128.9094, device='cuda:3')
compute norm is  tensor(47.4125, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.8507, device='cuda:3')
compute distance is  tensor(125.8507, device='cuda:3')
compute norm is  tensor(47.2675, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(131.2746, device='cuda:3')
distance x is tensor(107688.2734, device='cuda:3')
distance x is tensor(107688.2734, device='cuda:3')
________________________________
test distance is  tensor(107688.2734, device='cuda:3')
test distance1 is  tensor(107688.2734, device='cuda:3')
test similarity is  tensor(0.0174, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130094780280945.53
test entropy is  0.0
________________________________
cal ratio is  0.03421624118731606
distance x is tensor(3684.6936, device='cuda:3')
cal_distance is  tensor(3684.6936, device='cuda:3')
cal ratio is  0.18497618420044992
distance x is tensor(681.5848, device='cuda:3')
cal_distance is  tensor(681.5848, device='cuda:3')
cal ratio is  0.4300872143816567
distance x is tensor(293.1438, device='cuda:3')
cal_distance is  tensor(293.1438, device='cuda:3')
cal ratio is  0.6558071697876104
distance x is tensor(192.2476, device='cuda:3')
cal_distance is  tensor(192.2476, device='cuda:3')
cal ratio is  0.8098154199713478
distance x is tensor(155.6861, device='cuda:3')
cal_distance is  tensor(155.6861, device='cuda:3')
cal ratio is  0.8998945938215445
distance x is tensor(140.1016, device='cuda:3')
cal_distance is  tensor(140.1016, device='cuda:3')
cal ratio is  0.9486259686586604
distance x is tensor(132.9043, device='cuda:3')
cal_distance is  tensor(132.9043, device='cuda:3')
cal ratio is  0.9739732703765173
distance x is tensor(129.4453, device='cuda:3')
cal_distance is  tensor(129.4453, device='cuda:3')
distance x is tensor(129.4453, device='cuda:3')
return_distance is  tensor(129.4453, device='cuda:3')
distance x is tensor(129.4351, device='cuda:3')
distance x is tensor(129.4351, device='cuda:3')
________________________________
test distance is  tensor(129.4351, device='cuda:3')
test distance1 is  tensor(129.4351, device='cuda:3')
test similarity is  tensor(0.9513, device='cuda:3')
test acc is  0.10051666682299863
test loss is 229.76441563522891
test entropy is  0.0001877247732079417
________________________________
0
distance x is tensor(129.4351, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00026916435319931367
avg test loss is  229.98478680836365
avg accuracy is  0.4129500001563413
solo acc is  0.10075000015633197
compute similarity  is  tensor(0.9513, device='cuda:3')
compute_distance is  tensor(129.4351, device='cuda:3')
compute_norm is  tensor(47.1179, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(115.8930, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.910025161657252
avg test loss is  1.443735259682385
avg accuracy is  0.8591833334896561
solo acc is  0.32373333348967337
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(115.8930, device='cuda:3')
compute_norm is  tensor(46.4495, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.7833, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8736062450195426
avg test loss is  1.5036479094897761
avg accuracy is  0.8579166668229896
solo acc is  0.27288333348967225
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(117.7833, device='cuda:3')
compute_norm is  tensor(46.1755, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.2801, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.877239485857075
avg test loss is  1.4528450813374794
avg accuracy is  0.8587833334896563
solo acc is  0.2733500001563388
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(119.2801, device='cuda:3')
compute_norm is  tensor(45.9236, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.7810, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8762159541980036
avg test loss is  1.4325493838487149
avg accuracy is  0.8577833334896563
solo acc is  0.2681500001563387
compute similarity  is  tensor(0.9541, device='cuda:3')
compute_distance is  tensor(120.7810, device='cuda:3')
compute_norm is  tensor(45.6797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.2052, device='cuda:3')
distance x is tensor(122.2052, device='cuda:3')
________________________________
test distance is  tensor(122.2052, device='cuda:3')
test distance1 is  tensor(122.2052, device='cuda:3')
test similarity is  tensor(0.9539, device='cuda:3')
test acc is  0.2662500001563387
test loss is 1.4161228658293865
test entropy is  0.8635258032823168
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1713464260101318
mal norm is  tensor(623.0287, device='cuda:3')
distance x is tensor(122.2135, device='cuda:3')
mal distance is  tensor(122.2135, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([429.8950, 494.6521, 481.4319, 438.7887, 385.7123, 510.4877, 458.5087,
        465.5858, 623.0287, 623.0287, 623.0287, 623.0287, 623.0287, 623.0287,
        623.0287, 623.0287, 623.0287, 623.0287, 623.0287, 623.0287],
       device='cuda:3')
sorted_norm is   tensor([385.7123, 429.8950, 438.7887, 458.5087, 465.5858, 481.4319, 494.6521,
        510.4877, 623.0287, 623.0287, 623.0287, 623.0287, 623.0287, 623.0287,
        623.0287, 623.0287, 623.0287, 623.0287, 623.0287, 623.0287],
       device='cuda:3')
used idx is  tensor([ 4,  0,  3,  6,  7,  2,  1,  5, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 89.22% 

Test Accuracy: 88.24% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4899008274078369
distance x is tensor(112.8355, device='cuda:3')
benign distance is  tensor(112.8355, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3203768730163574
distance x is tensor(120.9665, device='cuda:3')
benign distance is  tensor(120.9665, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3478546440601349
distance x is tensor(139.1496, device='cuda:3')
benign distance is  tensor(139.1496, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5235158801078796
distance x is tensor(129.6781, device='cuda:3')
benign distance is  tensor(129.6781, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7369526028633118
distance x is tensor(130.1134, device='cuda:3')
benign distance is  tensor(130.1134, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6789954900741577
distance x is tensor(130.7423, device='cuda:3')
benign distance is  tensor(130.7423, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8246504068374634
distance x is tensor(120.0660, device='cuda:3')
benign distance is  tensor(120.0660, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.47719699144363403
distance x is tensor(121.4628, device='cuda:3')
benign distance is  tensor(121.4628, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.5111, device='cuda:3')
compute distance is  tensor(137.5111, device='cuda:3')
compute norm is  tensor(47.2097, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9482, device='cuda:3')
compute distance is  tensor(136.9482, device='cuda:3')
compute norm is  tensor(47.3746, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6410, device='cuda:3')
compute distance is  tensor(137.6410, device='cuda:3')
compute norm is  tensor(47.5246, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3599, device='cuda:3')
compute distance is  tensor(141.3599, device='cuda:3')
compute norm is  tensor(47.4592, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4463, device='cuda:3')
compute distance is  tensor(139.4463, device='cuda:3')
compute norm is  tensor(47.3634, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0817, device='cuda:3')
compute distance is  tensor(137.0817, device='cuda:3')
compute norm is  tensor(47.5200, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9750, device='cuda:3')
compute distance is  tensor(138.9750, device='cuda:3')
compute norm is  tensor(47.3743, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7588, device='cuda:3')
compute distance is  tensor(146.7588, device='cuda:3')
compute norm is  tensor(47.5707, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0521, device='cuda:3')
compute distance is  tensor(151.0521, device='cuda:3')
compute norm is  tensor(47.5659, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6305, device='cuda:3')
compute distance is  tensor(134.6305, device='cuda:3')
compute norm is  tensor(47.4968, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7382, device='cuda:3')
compute distance is  tensor(158.7382, device='cuda:3')
compute norm is  tensor(47.9116, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4916, device='cuda:3')
compute distance is  tensor(147.4916, device='cuda:3')
compute norm is  tensor(47.6717, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.7382, device='cuda:3')
distance x is tensor(107662.6016, device='cuda:3')
distance x is tensor(107662.6016, device='cuda:3')
________________________________
test distance is  tensor(107662.6016, device='cuda:3')
test distance1 is  tensor(107662.6016, device='cuda:3')
test similarity is  tensor(0.1042, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130058186749275.16
test entropy is  0.0
________________________________
cal ratio is  0.037630016865883915
distance x is tensor(4051.3511, device='cuda:3')
cal_distance is  tensor(4051.3511, device='cuda:3')
cal ratio is  0.19398445018393526
distance x is tensor(785.9033, device='cuda:3')
cal_distance is  tensor(785.9033, device='cuda:3')
cal ratio is  0.4404354876692461
distance x is tensor(346.1425, device='cuda:3')
cal_distance is  tensor(346.1425, device='cuda:3')
cal ratio is  0.6636503901784482
distance x is tensor(229.7194, device='cuda:3')
cal_distance is  tensor(229.7194, device='cuda:3')
cal ratio is  0.8146443228186712
distance x is tensor(187.1405, device='cuda:3')
cal_distance is  tensor(187.1405, device='cuda:3')
cal ratio is  0.9025741816516848
distance x is tensor(168.9087, device='cuda:3')
cal_distance is  tensor(168.9087, device='cuda:3')
cal ratio is  0.9500376117940376
distance x is tensor(160.4699, device='cuda:3')
cal_distance is  tensor(160.4699, device='cuda:3')
cal ratio is  0.9746979486309627
distance x is tensor(156.4098, device='cuda:3')
cal_distance is  tensor(156.4098, device='cuda:3')
distance x is tensor(156.4098, device='cuda:3')
return_distance is  tensor(156.4098, device='cuda:3')
distance x is tensor(156.3996, device='cuda:3')
distance x is tensor(156.3996, device='cuda:3')
________________________________
test distance is  tensor(156.3996, device='cuda:3')
test distance1 is  tensor(156.3996, device='cuda:3')
test similarity is  tensor(0.9362, device='cuda:3')
test acc is  0.10000000015633198
test loss is 558.7290043617362
test entropy is  1.4242470333038686e-15
________________________________
0
distance x is tensor(156.3996, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3101012544613046e-13
avg test loss is  559.7740346749963
avg accuracy is  0.1093166668229986
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9362, device='cuda:3')
compute_distance is  tensor(156.3996, device='cuda:3')
compute_norm is  tensor(48.6379, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.9367, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2196295659170984
avg test loss is  1.9547288796540772
avg accuracy is  0.6516500001563337
solo acc is  0.18290000015633545
compute similarity  is  tensor(0.9373, device='cuda:3')
compute_distance is  tensor(147.9367, device='cuda:3')
compute_norm is  tensor(49.1012, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(149.4558, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6999576354840162
avg test loss is  2.679213229018742
avg accuracy is  0.5469166668230091
solo acc is  0.10905000015633196
compute similarity  is  tensor(0.9368, device='cuda:3')
compute_distance is  tensor(149.4558, device='cuda:3')
compute_norm is  tensor(49.0452, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.2233, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0388546421456692
avg test loss is  1.634073728945718
avg accuracy is  0.6719500001563324
solo acc is  0.2357333334896711
compute similarity  is  tensor(0.9375, device='cuda:3')
compute_distance is  tensor(150.2233, device='cuda:3')
compute_norm is  tensor(48.7099, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.1167, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.627565902814682
avg test loss is  2.464199697412153
avg accuracy is  0.5621000001563408
solo acc is  0.10886666682299861
compute similarity  is  tensor(0.9370, device='cuda:3')
compute_distance is  tensor(151.1167, device='cuda:3')
compute_norm is  tensor(48.5708, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.8918, device='cuda:3')
distance x is tensor(151.8918, device='cuda:3')
________________________________
test distance is  tensor(151.8918, device='cuda:3')
test distance1 is  tensor(151.8918, device='cuda:3')
test similarity is  tensor(0.9373, device='cuda:3')
test acc is  0.25568333348967176
test loss is 1.5176915212480753
test entropy is  0.9873496093221311
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.21217942237854
mal norm is  tensor(768.3652, device='cuda:3')
distance x is tensor(151.8998, device='cuda:3')
mal distance is  tensor(151.8998, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([490.8887, 523.3506, 589.6132, 559.1257, 552.0016, 569.5271, 506.3235,
        530.2560, 768.3652, 768.3652, 768.3652, 768.3652, 768.3652, 768.3652,
        768.3652, 768.3652, 768.3652, 768.3652, 768.3652, 768.3652, 590.9103,
        648.4270, 594.5657, 585.3890, 569.6011, 644.2386, 619.9905, 604.2731],
       device='cuda:3')
sorted_norm is   tensor([490.8887, 506.3235, 523.3506, 530.2560, 552.0016, 559.1257, 569.5271,
        569.6011, 585.3890, 589.6132, 590.9103, 594.5657, 604.2731, 619.9905,
        644.2386, 648.4270, 768.3652, 768.3652, 768.3652, 768.3652, 768.3652,
        768.3652, 768.3652, 768.3652, 768.3652, 768.3652, 768.3652, 768.3652],
       device='cuda:3')
used idx is  tensor([ 0,  6,  1,  7,  4,  3,  5, 24, 23,  2, 20, 22, 27, 26, 25, 21],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 90.08% 

Test Accuracy: 89.23% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47883057594299316
distance x is tensor(91.4092, device='cuda:3')
benign distance is  tensor(91.4092, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.661347508430481
distance x is tensor(104.5754, device='cuda:3')
benign distance is  tensor(104.5754, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09340190142393112
distance x is tensor(117.2123, device='cuda:3')
benign distance is  tensor(117.2123, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3180510401725769
distance x is tensor(110.2866, device='cuda:3')
benign distance is  tensor(110.2866, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6676381826400757
distance x is tensor(103.3925, device='cuda:3')
benign distance is  tensor(103.3925, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9314706921577454
distance x is tensor(123.1226, device='cuda:3')
benign distance is  tensor(123.1226, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24714310467243195
distance x is tensor(116.3072, device='cuda:3')
benign distance is  tensor(116.3072, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5087865591049194
distance x is tensor(124.7862, device='cuda:3')
benign distance is  tensor(124.7862, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5454050898551941
distance x is tensor(138.3578, device='cuda:3')
benign distance is  tensor(138.3578, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5493988990783691
distance x is tensor(131.0261, device='cuda:3')
benign distance is  tensor(131.0261, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.17695946991443634
distance x is tensor(131.0525, device='cuda:3')
benign distance is  tensor(131.0525, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4726283550262451
distance x is tensor(145.5961, device='cuda:3')
benign distance is  tensor(145.5961, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4385080933570862
distance x is tensor(127.0489, device='cuda:3')
benign distance is  tensor(127.0489, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.05164305120706558
distance x is tensor(139.1431, device='cuda:3')
benign distance is  tensor(139.1431, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7544984221458435
distance x is tensor(123.4379, device='cuda:3')
benign distance is  tensor(123.4379, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.350972056388855
distance x is tensor(128.9704, device='cuda:3')
benign distance is  tensor(128.9704, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(122.2512, device='cuda:3')
compute distance is  tensor(122.2512, device='cuda:3')
compute norm is  tensor(47.7135, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7005, device='cuda:3')
compute distance is  tensor(120.7005, device='cuda:3')
compute norm is  tensor(47.6709, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6563, device='cuda:3')
compute distance is  tensor(129.6563, device='cuda:3')
compute norm is  tensor(48.0216, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.9059, device='cuda:3')
compute distance is  tensor(118.9059, device='cuda:3')
compute norm is  tensor(47.5341, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6279, device='cuda:3')
compute distance is  tensor(129.6279, device='cuda:3')
compute norm is  tensor(47.9711, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6212, device='cuda:3')
compute distance is  tensor(131.6212, device='cuda:3')
compute norm is  tensor(48.1071, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6054, device='cuda:3')
compute distance is  tensor(128.6054, device='cuda:3')
compute norm is  tensor(47.9084, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4304, device='cuda:3')
compute distance is  tensor(131.4304, device='cuda:3')
compute norm is  tensor(47.7751, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9995, device='cuda:3')
compute distance is  tensor(132.9995, device='cuda:3')
compute norm is  tensor(47.8106, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3481, device='cuda:3')
compute distance is  tensor(131.3481, device='cuda:3')
compute norm is  tensor(47.9747, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2494, device='cuda:3')
compute distance is  tensor(140.2494, device='cuda:3')
compute norm is  tensor(48.1801, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3611, device='cuda:3')
compute distance is  tensor(125.3611, device='cuda:3')
compute norm is  tensor(47.7220, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(140.2494, device='cuda:3')
distance x is tensor(107683.4453, device='cuda:3')
distance x is tensor(107683.4453, device='cuda:3')
________________________________
test distance is  tensor(107683.4453, device='cuda:3')
test distance1 is  tensor(107683.4453, device='cuda:3')
test similarity is  tensor(0.0396, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130001072008456.19
test entropy is  0.0
________________________________
cal ratio is  0.03536731867416194
distance x is tensor(3808.4805, device='cuda:3')
cal_distance is  tensor(3808.4805, device='cuda:3')
cal ratio is  0.1880618724143782
distance x is tensor(716.2341, device='cuda:3')
cal_distance is  tensor(716.2341, device='cuda:3')
cal ratio is  0.4336597517899854
distance x is tensor(310.6048, device='cuda:3')
cal_distance is  tensor(310.6048, device='cuda:3')
cal ratio is  0.6585253683499237
distance x is tensor(204.5429, device='cuda:3')
cal_distance is  tensor(204.5429, device='cuda:3')
cal ratio is  0.8114922784618921
distance x is tensor(165.9859, device='cuda:3')
cal_distance is  tensor(165.9859, device='cuda:3')
cal ratio is  0.9008260944780203
distance x is tensor(149.5250, device='cuda:3')
cal_distance is  tensor(149.5250, device='cuda:3')
cal ratio is  0.9491168643352035
distance x is tensor(141.9170, device='cuda:3')
cal_distance is  tensor(141.9170, device='cuda:3')
cal ratio is  0.9742254369486341
distance x is tensor(138.2593, device='cuda:3')
cal_distance is  tensor(138.2593, device='cuda:3')
distance x is tensor(138.2593, device='cuda:3')
return_distance is  tensor(138.2593, device='cuda:3')
distance x is tensor(138.2491, device='cuda:3')
distance x is tensor(138.2491, device='cuda:3')
________________________________
test distance is  tensor(138.2491, device='cuda:3')
test distance1 is  tensor(138.2491, device='cuda:3')
test similarity is  tensor(0.9472, device='cuda:3')
test acc is  0.1004833334896653
test loss is 295.4148536958674
test entropy is  0.00020604041931256037
________________________________
0
distance x is tensor(138.2491, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00022981008909857227
avg test loss is  295.27361011301787
avg accuracy is  0.3588666668230073
solo acc is  0.10051666682299863
compute similarity  is  tensor(0.9472, device='cuda:3')
compute_distance is  tensor(138.2491, device='cuda:3')
compute_norm is  tensor(48.0767, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(124.2910, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.946798249602572
avg test loss is  1.454110892342606
avg accuracy is  0.8510000001563234
solo acc is  0.308333333489673
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(124.2910, device='cuda:3')
compute_norm is  tensor(47.6424, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.3697, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8990676521238233
avg test loss is  1.5183957455508998
avg accuracy is  0.8498166668229901
solo acc is  0.2576000001563385
compute similarity  is  tensor(0.9512, device='cuda:3')
compute_distance is  tensor(125.3697, device='cuda:3')
compute_norm is  tensor(47.3929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.4088, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8947946917909041
avg test loss is  1.4750785339615746
avg accuracy is  0.8537000001563232
solo acc is  0.26006666682300517
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(126.4088, device='cuda:3')
compute_norm is  tensor(47.1487, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.5792, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8874651541842072
avg test loss is  1.44924914366655
avg accuracy is  0.8558166668229897
solo acc is  0.2583000001563384
compute similarity  is  tensor(0.9508, device='cuda:3')
compute_distance is  tensor(127.5792, device='cuda:3')
compute_norm is  tensor(46.9115, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.7431, device='cuda:3')
distance x is tensor(128.7431, device='cuda:3')
________________________________
test distance is  tensor(128.7431, device='cuda:3')
test distance1 is  tensor(128.7431, device='cuda:3')
test similarity is  tensor(0.9505, device='cuda:3')
test acc is  0.2574166668230052
test loss is 1.428400798265868
test entropy is  0.8690134929314351
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2912153005599976
mal norm is  tensor(661.2936, device='cuda:3')
distance x is tensor(128.7514, device='cuda:3')
mal distance is  tensor(128.7514, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([403.3188, 464.2311, 510.8676, 476.0471, 435.5674, 542.8051, 503.8383,
        545.2224, 661.2936, 661.2936, 661.2936, 661.2936, 661.2936, 661.2936,
        661.2936, 661.2936, 661.2936, 661.2936, 661.2936, 661.2936, 677.4598,
        655.9083, 619.5661, 618.9857, 604.5876, 608.1559, 624.1019, 619.9201,
        573.9482, 618.0667, 557.4903, 623.3734, 583.0873, 538.6384, 624.6855,
        580.0717], device='cuda:3')
sorted_norm is   tensor([403.3188, 435.5674, 464.2311, 476.0471, 503.8383, 510.8676, 538.6384,
        542.8051, 545.2224, 557.4903, 573.9482, 580.0717, 583.0873, 604.5876,
        608.1559, 618.0667, 618.9857, 619.5661, 619.9201, 623.3734, 624.1019,
        624.6855, 655.9083, 661.2936, 661.2936, 661.2936, 661.2936, 661.2936,
        661.2936, 661.2936, 661.2936, 661.2936, 661.2936, 661.2936, 661.2936,
        677.4598], device='cuda:3')
used idx is  tensor([ 0,  4,  1,  3,  6,  2, 33,  5,  7, 30, 28, 35, 32, 24, 25, 29, 23, 22,
        27, 31, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 90.13% 

Test Accuracy: 89.37% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41126713156700134
distance x is tensor(96.5018, device='cuda:3')
benign distance is  tensor(96.5018, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6674502491950989
distance x is tensor(114.4087, device='cuda:3')
benign distance is  tensor(114.4087, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4433247148990631
distance x is tensor(112.3231, device='cuda:3')
benign distance is  tensor(112.3231, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.912388026714325
distance x is tensor(91.6531, device='cuda:3')
benign distance is  tensor(91.6531, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6103032827377319
distance x is tensor(101.6858, device='cuda:3')
benign distance is  tensor(101.6858, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2852402925491333
distance x is tensor(106.6187, device='cuda:3')
benign distance is  tensor(106.6187, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6143896579742432
distance x is tensor(94.4058, device='cuda:3')
benign distance is  tensor(94.4058, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4407165050506592
distance x is tensor(101.2053, device='cuda:3')
benign distance is  tensor(101.2053, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.27545633912086487
distance x is tensor(132.8124, device='cuda:3')
benign distance is  tensor(132.8124, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9117833971977234
distance x is tensor(135.1890, device='cuda:3')
benign distance is  tensor(135.1890, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.20907528698444366
distance x is tensor(122.6597, device='cuda:3')
benign distance is  tensor(122.6597, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.21145963668823242
distance x is tensor(121.7835, device='cuda:3')
benign distance is  tensor(121.7835, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6969049572944641
distance x is tensor(118.7599, device='cuda:3')
benign distance is  tensor(118.7599, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9443634748458862
distance x is tensor(115.9309, device='cuda:3')
benign distance is  tensor(115.9309, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.08635352551937103
distance x is tensor(141.9936, device='cuda:3')
benign distance is  tensor(141.9936, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.35157161951065063
distance x is tensor(126.9097, device='cuda:3')
benign distance is  tensor(126.9097, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.57846599817276
distance x is tensor(139.0368, device='cuda:3')
benign distance is  tensor(139.0368, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.2021680325269699
distance x is tensor(134.7975, device='cuda:3')
benign distance is  tensor(134.7975, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6080712080001831
distance x is tensor(129.4207, device='cuda:3')
benign distance is  tensor(129.4207, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04140184074640274
distance x is tensor(123.5257, device='cuda:3')
benign distance is  tensor(123.5257, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.31082963943481445
distance x is tensor(128.8633, device='cuda:3')
benign distance is  tensor(128.8633, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.49188098311424255
distance x is tensor(117.2043, device='cuda:3')
benign distance is  tensor(117.2043, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0797138214111328
distance x is tensor(123.8883, device='cuda:3')
benign distance is  tensor(123.8883, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3172726333141327
distance x is tensor(125.7983, device='cuda:3')
benign distance is  tensor(125.7983, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.9986, device='cuda:3')
compute distance is  tensor(121.9986, device='cuda:3')
compute norm is  tensor(47.6738, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.0115, device='cuda:3')
compute distance is  tensor(116.0115, device='cuda:3')
compute norm is  tensor(47.5745, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0186, device='cuda:3')
compute distance is  tensor(129.0186, device='cuda:3')
compute norm is  tensor(48.0077, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.8310, device='cuda:3')
compute distance is  tensor(118.8310, device='cuda:3')
compute norm is  tensor(47.6754, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7186, device='cuda:3')
compute distance is  tensor(125.7186, device='cuda:3')
compute norm is  tensor(47.7301, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1789, device='cuda:3')
compute distance is  tensor(132.1789, device='cuda:3')
compute norm is  tensor(48.0611, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2466, device='cuda:3')
compute distance is  tensor(120.2466, device='cuda:3')
compute norm is  tensor(47.8909, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2825, device='cuda:3')
compute distance is  tensor(129.2825, device='cuda:3')
compute norm is  tensor(47.9098, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7042, device='cuda:3')
compute distance is  tensor(132.7042, device='cuda:3')
compute norm is  tensor(48.0145, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.3878, device='cuda:3')
compute distance is  tensor(118.3878, device='cuda:3')
compute norm is  tensor(47.7484, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4293, device='cuda:3')
compute distance is  tensor(124.4293, device='cuda:3')
compute norm is  tensor(47.7992, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9503, device='cuda:3')
compute distance is  tensor(116.9503, device='cuda:3')
compute norm is  tensor(47.5842, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(132.7042, device='cuda:3')
distance x is tensor(107689.1719, device='cuda:3')
distance x is tensor(107689.1719, device='cuda:3')
________________________________
test distance is  tensor(107689.1719, device='cuda:3')
test distance1 is  tensor(107689.1719, device='cuda:3')
test similarity is  tensor(0.0207, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130080802051890.77
test entropy is  0.0
________________________________
cal ratio is  0.034401891550120016
distance x is tensor(3704.7166, device='cuda:3')
cal_distance is  tensor(3704.7166, device='cuda:3')
cal ratio is  0.1854773374897772
distance x is tensor(687.1452, device='cuda:3')
cal_distance is  tensor(687.1452, device='cuda:3')
cal ratio is  0.43066947899697117
distance x is tensor(295.9354, device='cuda:3')
cal_distance is  tensor(295.9354, device='cuda:3')
cal ratio is  0.6562508807494293
distance x is tensor(194.2097, device='cuda:3')
cal_distance is  tensor(194.2097, device='cuda:3')
cal ratio is  0.810089395985283
distance x is tensor(157.3282, device='cuda:3')
cal_distance is  tensor(157.3282, device='cuda:3')
cal ratio is  0.9000467732116887
distance x is tensor(141.6032, device='cuda:3')
cal_distance is  tensor(141.6032, device='cuda:3')
cal ratio is  0.948706283705565
distance x is tensor(134.3401, device='cuda:3')
cal_distance is  tensor(134.3401, device='cuda:3')
cal ratio is  0.9740145288476507
distance x is tensor(130.8494, device='cuda:3')
cal_distance is  tensor(130.8494, device='cuda:3')
distance x is tensor(130.8494, device='cuda:3')
return_distance is  tensor(130.8494, device='cuda:3')
distance x is tensor(130.8391, device='cuda:3')
distance x is tensor(130.8391, device='cuda:3')
________________________________
test distance is  tensor(130.8391, device='cuda:3')
test distance1 is  tensor(130.8391, device='cuda:3')
test similarity is  tensor(0.9515, device='cuda:3')
test acc is  0.10076666682299863
test loss is 231.00965233906498
test entropy is  0.00035404233972462717
________________________________
0
distance x is tensor(130.8391, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00027059568782950835
avg test loss is  230.71069186277734
avg accuracy is  0.4401166668230082
solo acc is  0.10086666682299864
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(130.8391, device='cuda:3')
compute_norm is  tensor(47.7234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.0357, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8956883934769295
avg test loss is  1.4470870407151262
avg accuracy is  0.8619833334896562
solo acc is  0.3242333334896733
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(117.0357, device='cuda:3')
compute_norm is  tensor(47.0584, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.8529, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8798174153385895
avg test loss is  1.4806191350605442
avg accuracy is  0.8626666668229894
solo acc is  0.274700000156339
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(118.8529, device='cuda:3')
compute_norm is  tensor(46.7845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.4629, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8621427446667319
avg test loss is  1.4732541147071416
avg accuracy is  0.8628833334896561
solo acc is  0.2640666668230053
compute similarity  is  tensor(0.9546, device='cuda:3')
compute_distance is  tensor(120.4629, device='cuda:3')
compute_norm is  tensor(46.5279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.9289, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8585108681909566
avg test loss is  1.4362868975474636
avg accuracy is  0.8655166668229893
solo acc is  0.2676000001563387
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(121.9289, device='cuda:3')
compute_norm is  tensor(46.2804, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.3548, device='cuda:3')
distance x is tensor(123.3548, device='cuda:3')
________________________________
test distance is  tensor(123.3548, device='cuda:3')
test distance1 is  tensor(123.3548, device='cuda:3')
test similarity is  tensor(0.9541, device='cuda:3')
test acc is  0.262633333489672
test loss is 1.4184471725909187
test entropy is  0.8550105329388494
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4938139915466309
mal norm is  tensor(629.6375, device='cuda:3')
distance x is tensor(123.3630, device='cuda:3')
mal distance is  tensor(123.3630, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([432.8579, 507.2726, 479.6689, 397.4583, 438.9819, 465.4029, 415.6499,
        446.7024, 629.6375, 629.6376, 629.6375, 629.6376, 629.6375, 629.6376,
        629.6375, 629.6376, 629.6375, 629.6376, 629.6375, 629.6376, 609.1553,
        562.6257, 583.3419, 612.1400, 621.8457, 616.9922, 588.2363, 614.9539,
        616.3820, 597.4020, 591.3931, 652.9050, 581.3510, 634.4325, 568.3611,
        584.6243], device='cuda:3')
sorted_norm is   tensor([397.4583, 415.6499, 432.8579, 438.9819, 446.7024, 465.4029, 479.6689,
        507.2726, 562.6257, 568.3611, 581.3510, 583.3419, 584.6243, 588.2363,
        591.3931, 597.4020, 609.1553, 612.1400, 614.9539, 616.3820, 616.9922,
        621.8457, 629.6375, 629.6375, 629.6375, 629.6375, 629.6375, 629.6375,
        629.6376, 629.6376, 629.6376, 629.6376, 629.6376, 629.6376, 634.4325,
        652.9050], device='cuda:3')
used idx is  tensor([ 3,  6,  0,  4,  7,  5,  2,  1, 21, 34, 32, 22, 35, 26, 30, 29, 20, 23,
        27, 28, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 90.25% 

Test Accuracy: 89.30% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4932323396205902
distance x is tensor(95.2441, device='cuda:3')
benign distance is  tensor(95.2441, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6214107275009155
distance x is tensor(112.1315, device='cuda:3')
benign distance is  tensor(112.1315, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08868137001991272
distance x is tensor(103.8517, device='cuda:3')
benign distance is  tensor(103.8517, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.41704925894737244
distance x is tensor(101.3508, device='cuda:3')
benign distance is  tensor(101.3508, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.45913124084472656
distance x is tensor(94.8109, device='cuda:3')
benign distance is  tensor(94.8109, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4172958433628082
distance x is tensor(104.4771, device='cuda:3')
benign distance is  tensor(104.4771, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5940473675727844
distance x is tensor(110.6455, device='cuda:3')
benign distance is  tensor(110.6455, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10246056318283081
distance x is tensor(129.1309, device='cuda:3')
benign distance is  tensor(129.1309, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2615293860435486
distance x is tensor(133.2025, device='cuda:3')
benign distance is  tensor(133.2025, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.34004223346710205
distance x is tensor(123.2042, device='cuda:3')
benign distance is  tensor(123.2042, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5129188299179077
distance x is tensor(119.4451, device='cuda:3')
benign distance is  tensor(119.4451, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.49702948331832886
distance x is tensor(142.8103, device='cuda:3')
benign distance is  tensor(142.8103, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.15775533020496368
distance x is tensor(124.4533, device='cuda:3')
benign distance is  tensor(124.4533, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1937272995710373
distance x is tensor(130.7851, device='cuda:3')
benign distance is  tensor(130.7851, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6842072606086731
distance x is tensor(126.0715, device='cuda:3')
benign distance is  tensor(126.0715, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9297356605529785
distance x is tensor(137.7773, device='cuda:3')
benign distance is  tensor(137.7773, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17010533809661865
distance x is tensor(137.1774, device='cuda:3')
benign distance is  tensor(137.1774, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.49219369888305664
distance x is tensor(117.4775, device='cuda:3')
benign distance is  tensor(117.4775, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6778426170349121
distance x is tensor(146.8204, device='cuda:3')
benign distance is  tensor(146.8204, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3032834529876709
distance x is tensor(141.6103, device='cuda:3')
benign distance is  tensor(141.6103, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5217016935348511
distance x is tensor(139.9725, device='cuda:3')
benign distance is  tensor(139.9725, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5290797352790833
distance x is tensor(131.9358, device='cuda:3')
benign distance is  tensor(131.9358, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8600013852119446
distance x is tensor(127.0555, device='cuda:3')
benign distance is  tensor(127.0555, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.22604644298553467
distance x is tensor(132.0820, device='cuda:3')
benign distance is  tensor(132.0820, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(116.9869, device='cuda:3')
compute distance is  tensor(116.9869, device='cuda:3')
compute norm is  tensor(47.8975, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3973, device='cuda:3')
compute distance is  tensor(136.3973, device='cuda:3')
compute norm is  tensor(48.4677, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8187, device='cuda:3')
compute distance is  tensor(137.8187, device='cuda:3')
compute norm is  tensor(48.4573, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1991, device='cuda:3')
compute distance is  tensor(115.1991, device='cuda:3')
compute norm is  tensor(47.8758, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.9892, device='cuda:3')
compute distance is  tensor(129.9892, device='cuda:3')
compute norm is  tensor(48.2115, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2994, device='cuda:3')
compute distance is  tensor(120.2994, device='cuda:3')
compute norm is  tensor(48.1302, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6404, device='cuda:3')
compute distance is  tensor(126.6404, device='cuda:3')
compute norm is  tensor(48.1641, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5863, device='cuda:3')
compute distance is  tensor(130.5863, device='cuda:3')
compute norm is  tensor(48.2078, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0512, device='cuda:3')
compute distance is  tensor(124.0512, device='cuda:3')
compute norm is  tensor(48.0138, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6186, device='cuda:3')
compute distance is  tensor(132.6186, device='cuda:3')
compute norm is  tensor(48.3117, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8340, device='cuda:3')
compute distance is  tensor(128.8340, device='cuda:3')
compute norm is  tensor(48.3156, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8293, device='cuda:3')
compute distance is  tensor(127.8293, device='cuda:3')
compute norm is  tensor(48.1863, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.8187, device='cuda:3')
distance x is tensor(107690.3750, device='cuda:3')
distance x is tensor(107690.3750, device='cuda:3')
________________________________
test distance is  tensor(107690.3750, device='cuda:3')
test distance1 is  tensor(107690.3750, device='cuda:3')
test similarity is  tensor(0.0171, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130045009802202.88
test entropy is  0.0
________________________________
cal ratio is  0.03505836444304236
distance x is tensor(3775.4536, device='cuda:3')
cal_distance is  tensor(3775.4536, device='cuda:3')
cal ratio is  0.18723866263832167
distance x is tensor(706.9151, device='cuda:3')
cal_distance is  tensor(706.9151, device='cuda:3')
cal ratio is  0.4327095281144889
distance x is tensor(305.8918, device='cuda:3')
cal_distance is  tensor(305.8918, device='cuda:3')
cal ratio is  0.6578035136807354
distance x is tensor(201.2185, device='cuda:3')
cal_distance is  tensor(201.2185, device='cuda:3')
cal ratio is  0.8110472479408635
distance x is tensor(163.1987, device='cuda:3')
cal_distance is  tensor(163.1987, device='cuda:3')
cal ratio is  0.9005789284235846
distance x is tensor(146.9738, device='cuda:3')
cal_distance is  tensor(146.9738, device='cuda:3')
cal ratio is  0.948986669305082
distance x is tensor(139.4764, device='cuda:3')
cal_distance is  tensor(139.4764, device='cuda:3')
cal ratio is  0.9741586553030991
distance x is tensor(135.8723, device='cuda:3')
cal_distance is  tensor(135.8723, device='cuda:3')
distance x is tensor(135.8723, device='cuda:3')
return_distance is  tensor(135.8723, device='cuda:3')
distance x is tensor(135.8621, device='cuda:3')
distance x is tensor(135.8621, device='cuda:3')
________________________________
test distance is  tensor(135.8621, device='cuda:3')
test distance1 is  tensor(135.8621, device='cuda:3')
test similarity is  tensor(0.9486, device='cuda:3')
test acc is  0.10066666682299864
test loss is 285.07906896269907
test entropy is  0.00022372997135834888
________________________________
0
distance x is tensor(135.8621, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0002422945714983849
avg test loss is  284.7179629685782
avg accuracy is  0.36016666682300724
solo acc is  0.10055000015633196
compute similarity  is  tensor(0.9486, device='cuda:3')
compute_distance is  tensor(135.8621, device='cuda:3')
compute_norm is  tensor(48.1298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(120.4343, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9267761204669724
avg test loss is  1.4411649118100147
avg accuracy is  0.8574166668229897
solo acc is  0.32330000015634003
compute similarity  is  tensor(0.9531, device='cuda:3')
compute_distance is  tensor(120.4343, device='cuda:3')
compute_norm is  tensor(47.4944, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.1177, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8944979435853613
avg test loss is  1.493245539507632
avg accuracy is  0.8586666668229895
solo acc is  0.2723000001563389
compute similarity  is  tensor(0.9527, device='cuda:3')
compute_distance is  tensor(122.1177, device='cuda:3')
compute_norm is  tensor(47.2247, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.5727, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8865220014220362
avg test loss is  1.4605951442647336
avg accuracy is  0.8590000001563228
solo acc is  0.26948333348967224
compute similarity  is  tensor(0.9524, device='cuda:3')
compute_distance is  tensor(123.5727, device='cuda:3')
compute_norm is  tensor(46.9690, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.9825, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8731220414770692
avg test loss is  1.4466906791048517
avg accuracy is  0.8598500001563228
solo acc is  0.26141666682300524
compute similarity  is  tensor(0.9522, device='cuda:3')
compute_distance is  tensor(124.9825, device='cuda:3')
compute_norm is  tensor(46.7232, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.3928, device='cuda:3')
distance x is tensor(126.3928, device='cuda:3')
________________________________
test distance is  tensor(126.3928, device='cuda:3')
test distance1 is  tensor(126.3928, device='cuda:3')
test similarity is  tensor(0.9519, device='cuda:3')
test acc is  0.2592833334896718
test loss is 1.4268504552749683
test entropy is  0.8612041468940564
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2558917999267578
mal norm is  tensor(650.0913, device='cuda:3')
distance x is tensor(126.4009, device='cuda:3')
mal distance is  tensor(126.4009, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([428.7815, 505.1577, 459.1062, 440.9297, 420.5761, 462.8842, 484.4301,
        570.6018, 650.0913, 650.0914, 650.0913, 650.0914, 650.0913, 650.0914,
        650.0913, 650.0914, 650.0913, 650.0914, 650.0913, 650.0914],
       device='cuda:3')
sorted_norm is   tensor([420.5761, 428.7815, 440.9297, 459.1062, 462.8842, 484.4301, 505.1577,
        570.6018, 650.0913, 650.0913, 650.0913, 650.0913, 650.0913, 650.0913,
        650.0914, 650.0914, 650.0914, 650.0914, 650.0914, 650.0914],
       device='cuda:3')
used idx is  tensor([ 4,  0,  3,  2,  5,  6,  1,  7, 18, 16, 12, 14], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 89.09% 

Test Accuracy: 88.34% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4545711576938629
distance x is tensor(132.6364, device='cuda:3')
benign distance is  tensor(132.6364, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2256297618150711
distance x is tensor(131.9271, device='cuda:3')
benign distance is  tensor(131.9271, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25874313712120056
distance x is tensor(130.3764, device='cuda:3')
benign distance is  tensor(130.3764, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6720122694969177
distance x is tensor(112.6441, device='cuda:3')
benign distance is  tensor(112.6441, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.45944756269454956
distance x is tensor(127.0816, device='cuda:3')
benign distance is  tensor(127.0816, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1426410675048828
distance x is tensor(126.2457, device='cuda:3')
benign distance is  tensor(126.2457, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11675093322992325
distance x is tensor(118.3931, device='cuda:3')
benign distance is  tensor(118.3931, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3394066393375397
distance x is tensor(131.8141, device='cuda:3')
benign distance is  tensor(131.8141, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.2289, device='cuda:3')
compute distance is  tensor(135.2289, device='cuda:3')
compute norm is  tensor(48.0197, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6738, device='cuda:3')
compute distance is  tensor(123.6738, device='cuda:3')
compute norm is  tensor(48.0784, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.3864, device='cuda:3')
compute distance is  tensor(145.3864, device='cuda:3')
compute norm is  tensor(48.5639, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.3582, device='cuda:3')
compute distance is  tensor(144.3582, device='cuda:3')
compute norm is  tensor(48.3927, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7500, device='cuda:3')
compute distance is  tensor(146.7500, device='cuda:3')
compute norm is  tensor(48.4660, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.8180, device='cuda:3')
compute distance is  tensor(141.8180, device='cuda:3')
compute norm is  tensor(48.3618, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0300, device='cuda:3')
compute distance is  tensor(132.0300, device='cuda:3')
compute norm is  tensor(48.2300, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.0568, device='cuda:3')
compute distance is  tensor(140.0568, device='cuda:3')
compute norm is  tensor(48.3049, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3725, device='cuda:3')
compute distance is  tensor(138.3725, device='cuda:3')
compute norm is  tensor(48.2583, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1257, device='cuda:3')
compute distance is  tensor(132.1257, device='cuda:3')
compute norm is  tensor(48.1455, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.8839, device='cuda:3')
compute distance is  tensor(152.8839, device='cuda:3')
compute norm is  tensor(48.6769, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3424, device='cuda:3')
compute distance is  tensor(139.3424, device='cuda:3')
compute norm is  tensor(48.3098, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.8839, device='cuda:3')
distance x is tensor(107665.1094, device='cuda:3')
distance x is tensor(107665.1094, device='cuda:3')
________________________________
test distance is  tensor(107665.1094, device='cuda:3')
test distance1 is  tensor(107665.1094, device='cuda:3')
test similarity is  tensor(0.1058, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130041061468644.7
test entropy is  0.0
________________________________
cal ratio is  0.036929158285342524
distance x is tensor(3975.9873, device='cuda:3')
cal_distance is  tensor(3975.9873, device='cuda:3')
cal ratio is  0.1921694748109271
distance x is tensor(764.0676, device='cuda:3')
cal_distance is  tensor(764.0676, device='cuda:3')
cal ratio is  0.43837018224882257
distance x is tensor(334.9473, device='cuda:3')
cal_distance is  tensor(334.9473, device='cuda:3')
cal ratio is  0.6620924905250148
distance x is tensor(221.7678, device='cuda:3')
cal_distance is  tensor(221.7678, device='cuda:3')
cal ratio is  0.8136874690692771
distance x is tensor(180.4507, device='cuda:3')
cal_distance is  tensor(180.4507, device='cuda:3')
cal ratio is  0.9020438698659435
distance x is tensor(162.7749, device='cuda:3')
cal_distance is  tensor(162.7749, device='cuda:3')
cal ratio is  0.9497583802670093
distance x is tensor(154.5971, device='cuda:3')
cal_distance is  tensor(154.5971, device='cuda:3')
cal ratio is  0.9745546949073192
distance x is tensor(150.6635, device='cuda:3')
cal_distance is  tensor(150.6635, device='cuda:3')
distance x is tensor(150.6635, device='cuda:3')
return_distance is  tensor(150.6635, device='cuda:3')
distance x is tensor(150.6532, device='cuda:3')
distance x is tensor(150.6532, device='cuda:3')
________________________________
test distance is  tensor(150.6532, device='cuda:3')
test distance1 is  tensor(150.6532, device='cuda:3')
test similarity is  tensor(0.9424, device='cuda:3')
test acc is  0.10000000015633198
test loss is 464.18008178841075
test entropy is  1.1317489146253435e-05
________________________________
0
distance x is tensor(150.6532, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.547561699645078e-06
avg test loss is  464.12767620940707
avg accuracy is  0.12836666682299858
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9424, device='cuda:3')
compute_distance is  tensor(150.6532, device='cuda:3')
compute_norm is  tensor(49.3511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.0205, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1069802345116255
avg test loss is  1.7300580775559837
avg accuracy is  0.685433333489665
solo acc is  0.23373333348967104
compute similarity  is  tensor(0.9449, device='cuda:3')
compute_distance is  tensor(142.0205, device='cuda:3')
compute_norm is  tensor(49.4986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(143.3315, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6464738625326136
avg test loss is  2.547606009410134
avg accuracy is  0.5702000001563402
solo acc is  0.11170000015633194
compute similarity  is  tensor(0.9446, device='cuda:3')
compute_distance is  tensor(143.3315, device='cuda:3')
compute_norm is  tensor(49.3482, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.0274, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0017427172996343
avg test loss is  1.5379115162627783
avg accuracy is  0.7026666668229972
solo acc is  0.2512500001563383
compute similarity  is  tensor(0.9448, device='cuda:3')
compute_distance is  tensor(144.0274, device='cuda:3')
compute_norm is  tensor(49.0473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(144.9394, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6173382014163268
avg test loss is  2.3736838957648287
avg accuracy is  0.5950833334896714
solo acc is  0.10871666682299862
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(144.9394, device='cuda:3')
compute_norm is  tensor(48.8704, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.5651, device='cuda:3')
distance x is tensor(145.5651, device='cuda:3')
________________________________
test distance is  tensor(145.5651, device='cuda:3')
test distance1 is  tensor(145.5651, device='cuda:3')
test similarity is  tensor(0.9445, device='cuda:3')
test acc is  0.25241666682300506
test loss is 1.476830304685686
test entropy is  0.9675957326695863
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.5245392322540283
mal norm is  tensor(731.1384, device='cuda:3')
distance x is tensor(145.5732, device='cuda:3')
mal distance is  tensor(145.5732, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 26
weight size is  torch.Size([44, 215370])
norm res is  tensor([568.5310, 563.3474, 558.2845, 491.6399, 532.8760, 537.8242, 498.6272,
        581.9835, 731.1384, 731.1384, 731.1384, 731.1384, 731.1384, 731.1384,
        731.1384, 731.1384, 731.1384, 731.1384, 731.1384, 731.1384, 604.0020,
        642.5854, 622.1595, 655.1031, 628.8113, 655.9737, 644.5394, 671.7944,
        649.3939, 658.0223, 602.2612, 613.4095, 589.9713, 584.3094, 689.5145,
        616.7988, 650.3879, 603.3173, 578.6620, 666.4869, 616.7135, 635.1844,
        611.6456, 650.4977], device='cuda:3')
sorted_norm is   tensor([491.6399, 498.6272, 532.8760, 537.8242, 558.2845, 563.3474, 568.5310,
        578.6620, 581.9835, 584.3094, 589.9713, 602.2612, 603.3173, 604.0020,
        611.6456, 613.4095, 616.7135, 616.7988, 622.1595, 628.8113, 635.1844,
        642.5854, 644.5394, 649.3939, 650.3879, 650.4977, 655.1031, 655.9737,
        658.0223, 666.4869, 671.7944, 689.5145, 731.1384, 731.1384, 731.1384,
        731.1384, 731.1384, 731.1384, 731.1384, 731.1384, 731.1384, 731.1384,
        731.1384, 731.1384], device='cuda:3')
used idx is  tensor([ 3,  6,  4,  5,  2,  1,  0, 38,  7, 33, 32, 30, 37, 20, 42, 31, 40, 35,
        22, 24, 41, 21, 26, 28, 36, 43], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 90.37% 

Test Accuracy: 89.23% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.42225614190101624
distance x is tensor(96.2091, device='cuda:3')
benign distance is  tensor(96.2091, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4623298645019531
distance x is tensor(107.3368, device='cuda:3')
benign distance is  tensor(107.3368, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38142216205596924
distance x is tensor(121.8339, device='cuda:3')
benign distance is  tensor(121.8339, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6436765193939209
distance x is tensor(104.7152, device='cuda:3')
benign distance is  tensor(104.7152, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2951023578643799
distance x is tensor(94.0213, device='cuda:3')
benign distance is  tensor(94.0213, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.33079954981803894
distance x is tensor(112.8479, device='cuda:3')
benign distance is  tensor(112.8479, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.40449589490890503
distance x is tensor(113.6170, device='cuda:3')
benign distance is  tensor(113.6170, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.25432711839675903
distance x is tensor(109.5672, device='cuda:3')
benign distance is  tensor(109.5672, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19028928875923157
distance x is tensor(126.8445, device='cuda:3')
benign distance is  tensor(126.8445, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.23381750285625458
distance x is tensor(131.1283, device='cuda:3')
benign distance is  tensor(131.1283, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4620633125305176
distance x is tensor(114.8144, device='cuda:3')
benign distance is  tensor(114.8144, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5478326678276062
distance x is tensor(134.1463, device='cuda:3')
benign distance is  tensor(134.1463, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.27414292097091675
distance x is tensor(123.1353, device='cuda:3')
benign distance is  tensor(123.1353, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.32001689076423645
distance x is tensor(127.9445, device='cuda:3')
benign distance is  tensor(127.9445, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4237845540046692
distance x is tensor(125.8269, device='cuda:3')
benign distance is  tensor(125.8269, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5370539426803589
distance x is tensor(129.2429, device='cuda:3')
benign distance is  tensor(129.2429, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.13639914989471436
distance x is tensor(138.8688, device='cuda:3')
benign distance is  tensor(138.8688, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4218141436576843
distance x is tensor(137.1391, device='cuda:3')
benign distance is  tensor(137.1391, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3998135030269623
distance x is tensor(117.8783, device='cuda:3')
benign distance is  tensor(117.8783, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.18073326349258423
distance x is tensor(126.1066, device='cuda:3')
benign distance is  tensor(126.1066, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2586521506309509
distance x is tensor(138.5534, device='cuda:3')
benign distance is  tensor(138.5534, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8227556347846985
distance x is tensor(122.3338, device='cuda:3')
benign distance is  tensor(122.3338, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3643381595611572
distance x is tensor(138.2339, device='cuda:3')
benign distance is  tensor(138.2339, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.36925944685935974
distance x is tensor(124.4802, device='cuda:3')
benign distance is  tensor(124.4802, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2018042355775833
distance x is tensor(128.9136, device='cuda:3')
benign distance is  tensor(128.9136, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.19034619629383087
distance x is tensor(130.7058, device='cuda:3')
benign distance is  tensor(130.7058, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.10205996036529541
distance x is tensor(124.0801, device='cuda:3')
benign distance is  tensor(124.0801, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.36590462923049927
distance x is tensor(142.0140, device='cuda:3')
benign distance is  tensor(142.0140, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2698616087436676
distance x is tensor(124.8512, device='cuda:3')
benign distance is  tensor(124.8512, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9245920181274414
distance x is tensor(132.0065, device='cuda:3')
benign distance is  tensor(132.0065, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8352457880973816
distance x is tensor(130.7902, device='cuda:3')
benign distance is  tensor(130.7902, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3963519036769867
distance x is tensor(126.5393, device='cuda:3')
benign distance is  tensor(126.5393, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(120.7690, device='cuda:3')
compute distance is  tensor(120.7690, device='cuda:3')
compute norm is  tensor(48.1366, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9072, device='cuda:3')
compute distance is  tensor(119.9072, device='cuda:3')
compute norm is  tensor(48.1059, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2657, device='cuda:3')
compute distance is  tensor(122.2657, device='cuda:3')
compute norm is  tensor(48.3875, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.3458, device='cuda:3')
compute distance is  tensor(120.3458, device='cuda:3')
compute norm is  tensor(48.2114, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2954, device='cuda:3')
compute distance is  tensor(126.2954, device='cuda:3')
compute norm is  tensor(48.3417, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3072, device='cuda:3')
compute distance is  tensor(139.3072, device='cuda:3')
compute norm is  tensor(48.7092, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2569, device='cuda:3')
compute distance is  tensor(120.2569, device='cuda:3')
compute norm is  tensor(48.3084, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4094, device='cuda:3')
compute distance is  tensor(134.4094, device='cuda:3')
compute norm is  tensor(48.4738, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1898, device='cuda:3')
compute distance is  tensor(139.1898, device='cuda:3')
compute norm is  tensor(48.6250, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8942, device='cuda:3')
compute distance is  tensor(120.8942, device='cuda:3')
compute norm is  tensor(48.3042, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.0805, device='cuda:3')
compute distance is  tensor(115.0805, device='cuda:3')
compute norm is  tensor(48.2187, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6534, device='cuda:3')
compute distance is  tensor(125.6534, device='cuda:3')
compute norm is  tensor(48.4133, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.3072, device='cuda:3')
distance x is tensor(107689.1484, device='cuda:3')
distance x is tensor(107689.1484, device='cuda:3')
________________________________
test distance is  tensor(107689.1484, device='cuda:3')
test distance1 is  tensor(107689.1484, device='cuda:3')
test similarity is  tensor(0.0297, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130108206686260.4
test entropy is  0.0
________________________________
cal ratio is  0.035247388950577864
distance x is tensor(3795.7671, device='cuda:3')
cal_distance is  tensor(3795.7671, device='cuda:3')
cal ratio is  0.18774273325537705
distance x is tensor(712.6318, device='cuda:3')
cal_distance is  tensor(712.6318, device='cuda:3')
cal ratio is  0.4332916377514756
distance x is tensor(308.7803, device='cuda:3')
cal_distance is  tensor(308.7803, device='cuda:3')
cal ratio is  0.6582457919817535
distance x is tensor(203.2552, device='cuda:3')
cal_distance is  tensor(203.2552, device='cuda:3')
cal ratio is  0.8113198907367283
distance x is tensor(164.9059, device='cuda:3')
cal_distance is  tensor(164.9059, device='cuda:3')
cal ratio is  0.9007303566629057
distance x is tensor(148.5363, device='cuda:3')
cal_distance is  tensor(148.5363, device='cuda:3')
cal ratio is  0.9490664411380696
distance x is tensor(140.9711, device='cuda:3')
cal_distance is  tensor(140.9711, device='cuda:3')
cal ratio is  0.9741994652204508
distance x is tensor(137.3341, device='cuda:3')
cal_distance is  tensor(137.3341, device='cuda:3')
distance x is tensor(137.3341, device='cuda:3')
return_distance is  tensor(137.3341, device='cuda:3')
distance x is tensor(137.3238, device='cuda:3')
distance x is tensor(137.3238, device='cuda:3')
________________________________
test distance is  tensor(137.3238, device='cuda:3')
test distance1 is  tensor(137.3238, device='cuda:3')
test similarity is  tensor(0.9485, device='cuda:3')
test acc is  0.10053333348966531
test loss is 276.59143847239807
test entropy is  0.000212714080152197
________________________________
0
distance x is tensor(137.3238, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00016555368109533189
avg test loss is  276.4029773801629
avg accuracy is  0.37583333348967407
solo acc is  0.10061666682299863
compute similarity  is  tensor(0.9485, device='cuda:3')
compute_distance is  tensor(137.3238, device='cuda:3')
compute_norm is  tensor(48.4936, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(122.7567, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9305532495858573
avg test loss is  1.4264689673747082
avg accuracy is  0.8561500001563231
solo acc is  0.3189000001563399
compute similarity  is  tensor(0.9529, device='cuda:3')
compute_distance is  tensor(122.7567, device='cuda:3')
compute_norm is  tensor(47.9480, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.2068, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8919408763649621
avg test loss is  1.497552140562265
avg accuracy is  0.8558500001563231
solo acc is  0.2674166668230054
compute similarity  is  tensor(0.9526, device='cuda:3')
compute_distance is  tensor(124.2068, device='cuda:3')
compute_norm is  tensor(47.6854, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.5051, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.890450046896172
avg test loss is  1.455374970746193
avg accuracy is  0.8557000001563231
solo acc is  0.2652500001563386
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(125.5051, device='cuda:3')
compute_norm is  tensor(47.4331, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.7870, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8711800195896295
avg test loss is  1.4427100905477366
avg accuracy is  0.8597000001563229
solo acc is  0.2592666668230052
compute similarity  is  tensor(0.9520, device='cuda:3')
compute_distance is  tensor(126.7870, device='cuda:3')
compute_norm is  tensor(47.1901, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.0974, device='cuda:3')
distance x is tensor(128.0974, device='cuda:3')
________________________________
test distance is  tensor(128.0974, device='cuda:3')
test distance1 is  tensor(128.0974, device='cuda:3')
test similarity is  tensor(0.9518, device='cuda:3')
test acc is  0.2619333334896719
test loss is 1.4226676689536333
test entropy is  0.8593468878950391
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3683135509490967
mal norm is  tensor(656.7078, device='cuda:3')
distance x is tensor(128.1057, device='cuda:3')
mal distance is  tensor(128.1057, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([429.0864, 480.2232, 529.5704, 465.2700, 399.4921, 519.8622, 492.0170,
        479.8657, 656.7078, 656.7078, 656.7078, 656.7078, 656.7078, 656.7078,
        656.7078, 656.7078, 656.7078, 656.7078, 656.7078, 656.7078],
       device='cuda:3')
sorted_norm is   tensor([399.4921, 429.0864, 465.2700, 479.8657, 480.2232, 492.0170, 519.8622,
        529.5704, 656.7078, 656.7078, 656.7078, 656.7078, 656.7078, 656.7078,
        656.7078, 656.7078, 656.7078, 656.7078, 656.7078, 656.7078],
       device='cuda:3')
used idx is  tensor([ 4,  0,  3,  7,  1,  6,  5,  2, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 89.38% 

Test Accuracy: 88.45% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7975056767463684
distance x is tensor(112.1322, device='cuda:3')
benign distance is  tensor(112.1322, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7546981573104858
distance x is tensor(123.8595, device='cuda:3')
benign distance is  tensor(123.8595, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.143964484333992
distance x is tensor(139.2134, device='cuda:3')
benign distance is  tensor(139.2134, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5690399408340454
distance x is tensor(121.4713, device='cuda:3')
benign distance is  tensor(121.4713, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.34166091680526733
distance x is tensor(123.1081, device='cuda:3')
benign distance is  tensor(123.1081, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7156417369842529
distance x is tensor(137.6159, device='cuda:3')
benign distance is  tensor(137.6159, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.704388439655304
distance x is tensor(113.8397, device='cuda:3')
benign distance is  tensor(113.8397, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16840538382530212
distance x is tensor(130.1513, device='cuda:3')
benign distance is  tensor(130.1513, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(134.9242, device='cuda:3')
compute distance is  tensor(134.9242, device='cuda:3')
compute norm is  tensor(48.4263, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5349, device='cuda:3')
compute distance is  tensor(133.5349, device='cuda:3')
compute norm is  tensor(48.3867, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.7297, device='cuda:3')
compute distance is  tensor(139.7297, device='cuda:3')
compute norm is  tensor(48.6478, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3331, device='cuda:3')
compute distance is  tensor(127.3331, device='cuda:3')
compute norm is  tensor(48.3760, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5900, device='cuda:3')
compute distance is  tensor(140.5900, device='cuda:3')
compute norm is  tensor(48.6561, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7874, device='cuda:3')
compute distance is  tensor(144.7874, device='cuda:3')
compute norm is  tensor(48.7516, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.2528, device='cuda:3')
compute distance is  tensor(148.2528, device='cuda:3')
compute norm is  tensor(48.7848, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2927, device='cuda:3')
compute distance is  tensor(138.2927, device='cuda:3')
compute norm is  tensor(48.5014, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.6676, device='cuda:3')
compute distance is  tensor(148.6676, device='cuda:3')
compute norm is  tensor(48.7941, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.9249, device='cuda:3')
compute distance is  tensor(147.9249, device='cuda:3')
compute norm is  tensor(48.8156, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.8836, device='cuda:3')
compute distance is  tensor(151.8836, device='cuda:3')
compute norm is  tensor(48.8804, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3702, device='cuda:3')
compute distance is  tensor(148.3702, device='cuda:3')
compute norm is  tensor(49.0060, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.8836, device='cuda:3')
distance x is tensor(107662.6641, device='cuda:3')
distance x is tensor(107662.6641, device='cuda:3')
________________________________
test distance is  tensor(107662.6641, device='cuda:3')
test distance1 is  tensor(107662.6641, device='cuda:3')
test similarity is  tensor(0.1193, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130063464873949.06
test entropy is  0.0
________________________________
cal ratio is  0.0368085734815561
distance x is tensor(3962.9138, device='cuda:3')
cal_distance is  tensor(3962.9138, device='cuda:3')
cal ratio is  0.19185549010888608
distance x is tensor(760.3110, device='cuda:3')
cal_distance is  tensor(760.3110, device='cuda:3')
cal ratio is  0.4380118918290584
distance x is tensor(333.0281, device='cuda:3')
cal_distance is  tensor(333.0281, device='cuda:3')
cal ratio is  0.6618218164176398
distance x is tensor(220.4070, device='cuda:3')
cal_distance is  tensor(220.4070, device='cuda:3')
cal ratio is  0.8135211054555884
distance x is tensor(179.3067, device='cuda:3')
cal_distance is  tensor(179.3067, device='cuda:3')
cal ratio is  0.9019515933440542
distance x is tensor(161.7265, device='cuda:3')
cal_distance is  tensor(161.7265, device='cuda:3')
cal ratio is  0.9497098596745519
distance x is tensor(153.5935, device='cuda:3')
cal_distance is  tensor(153.5935, device='cuda:3')
cal ratio is  0.9745297011717402
distance x is tensor(149.6816, device='cuda:3')
cal_distance is  tensor(149.6816, device='cuda:3')
distance x is tensor(149.6816, device='cuda:3')
return_distance is  tensor(149.6816, device='cuda:3')
distance x is tensor(149.6713, device='cuda:3')
distance x is tensor(149.6713, device='cuda:3')
________________________________
test distance is  tensor(149.6713, device='cuda:3')
test distance1 is  tensor(149.6713, device='cuda:3')
test similarity is  tensor(0.9444, device='cuda:3')
test acc is  0.10005000015633199
test loss is 434.7305837928105
test entropy is  2.2822286123073452e-05
________________________________
0
distance x is tensor(149.6713, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.928775137171537e-06
avg test loss is  434.4362496251999
avg accuracy is  0.1388666668229988
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9444, device='cuda:3')
compute_distance is  tensor(149.6713, device='cuda:3')
compute_norm is  tensor(49.7287, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.1719, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0998618131253257
avg test loss is  1.6726081357327605
avg accuracy is  0.6810000001563319
solo acc is  0.24345000015633803
compute similarity  is  tensor(0.9470, device='cuda:3')
compute_distance is  tensor(140.1719, device='cuda:3')
compute_norm is  tensor(49.8620, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(141.4110, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6341251776035406
avg test loss is  2.525286022533994
avg accuracy is  0.5684333334896736
solo acc is  0.11248333348966529
compute similarity  is  tensor(0.9467, device='cuda:3')
compute_distance is  tensor(141.4110, device='cuda:3')
compute_norm is  tensor(49.7036, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.0551, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0105946366466694
avg test loss is  1.525055650200671
avg accuracy is  0.7059333334896636
solo acc is  0.2510666668230049
compute similarity  is  tensor(0.9470, device='cuda:3')
compute_distance is  tensor(142.0551, device='cuda:3')
compute_norm is  tensor(49.4087, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(143.0381, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6139003706893433
avg test loss is  2.357843437682845
avg accuracy is  0.6022333334896709
solo acc is  0.10918333348966527
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(143.0381, device='cuda:3')
compute_norm is  tensor(49.2299, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.6986, device='cuda:3')
distance x is tensor(143.6986, device='cuda:3')
________________________________
test distance is  tensor(143.6986, device='cuda:3')
test distance1 is  tensor(143.6986, device='cuda:3')
test similarity is  tensor(0.9467, device='cuda:3')
test acc is  0.253916666823005
test loss is 1.4582109641927137
test entropy is  0.9736651307357146
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.3441318273544312
mal norm is  tensor(724.3634, device='cuda:3')
distance x is tensor(143.7069, device='cuda:3')
mal distance is  tensor(143.7069, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 26
weight size is  torch.Size([44, 215370])
norm res is  tensor([502.3147, 541.4003, 603.8344, 522.4138, 532.4437, 608.6434, 479.4015,
        559.7406, 724.3634, 724.3634, 724.3634, 724.3634, 724.3634, 724.3634,
        724.3634, 724.3634, 724.3634, 724.3634, 724.3634, 724.3634, 683.8792,
        670.5352, 654.0106, 633.1084, 646.5135, 587.1854, 624.6107, 633.5579,
        685.9879, 596.8976, 723.6025, 677.9890, 664.3892, 660.9628, 639.0762,
        673.1855, 610.0471, 638.6811, 566.0936, 636.9539, 604.2476, 613.5931,
        614.2367, 618.9581], device='cuda:3')
sorted_norm is   tensor([479.4015, 502.3147, 522.4138, 532.4437, 541.4003, 559.7406, 566.0936,
        587.1854, 596.8976, 603.8344, 604.2476, 608.6434, 610.0471, 613.5931,
        614.2367, 618.9581, 624.6107, 633.1084, 633.5579, 636.9539, 638.6811,
        639.0762, 646.5135, 654.0106, 660.9628, 664.3892, 670.5352, 673.1855,
        677.9890, 683.8792, 685.9879, 723.6025, 724.3634, 724.3634, 724.3634,
        724.3634, 724.3634, 724.3634, 724.3634, 724.3634, 724.3634, 724.3634,
        724.3634, 724.3634], device='cuda:3')
used idx is  tensor([ 6,  0,  3,  4,  1,  7, 38, 25, 29,  2, 40,  5, 36, 41, 42, 43, 26, 23,
        27, 39, 37, 34, 24, 22, 33, 32], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 90.38% 

Test Accuracy: 89.19% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9133040308952332
distance x is tensor(84.0715, device='cuda:3')
benign distance is  tensor(84.0715, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9810488820075989
distance x is tensor(112.4268, device='cuda:3')
benign distance is  tensor(112.4268, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2880615293979645
distance x is tensor(116.2262, device='cuda:3')
benign distance is  tensor(116.2262, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.20876213908195496
distance x is tensor(114.4842, device='cuda:3')
benign distance is  tensor(114.4842, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5198496580123901
distance x is tensor(93.5899, device='cuda:3')
benign distance is  tensor(93.5899, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.698846161365509
distance x is tensor(111.2403, device='cuda:3')
benign distance is  tensor(111.2403, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4447804093360901
distance x is tensor(110.5094, device='cuda:3')
benign distance is  tensor(110.5094, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29613032937049866
distance x is tensor(116.0980, device='cuda:3')
benign distance is  tensor(116.0980, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.35620012879371643
distance x is tensor(130.7789, device='cuda:3')
benign distance is  tensor(130.7789, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2423937320709229
distance x is tensor(128.7150, device='cuda:3')
benign distance is  tensor(128.7150, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8064570426940918
distance x is tensor(124.8607, device='cuda:3')
benign distance is  tensor(124.8607, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4338226318359375
distance x is tensor(133.1692, device='cuda:3')
benign distance is  tensor(133.1692, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6602262854576111
distance x is tensor(123.4618, device='cuda:3')
benign distance is  tensor(123.4618, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23541858792304993
distance x is tensor(140.0994, device='cuda:3')
benign distance is  tensor(140.0994, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5510872602462769
distance x is tensor(121.2389, device='cuda:3')
benign distance is  tensor(121.2389, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44851332902908325
distance x is tensor(127.7340, device='cuda:3')
benign distance is  tensor(127.7340, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.38185206055641174
distance x is tensor(132.4356, device='cuda:3')
benign distance is  tensor(132.4356, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7453352212905884
distance x is tensor(127.2530, device='cuda:3')
benign distance is  tensor(127.2530, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.27598708868026733
distance x is tensor(135.7256, device='cuda:3')
benign distance is  tensor(135.7256, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4600679874420166
distance x is tensor(133.3254, device='cuda:3')
benign distance is  tensor(133.3254, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.005750298500061
distance x is tensor(131.5497, device='cuda:3')
benign distance is  tensor(131.5497, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4571174085140228
distance x is tensor(128.2460, device='cuda:3')
benign distance is  tensor(128.2460, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.33939242362976074
distance x is tensor(120.6378, device='cuda:3')
benign distance is  tensor(120.6378, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4688030183315277
distance x is tensor(137.2006, device='cuda:3')
benign distance is  tensor(137.2006, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2881326973438263
distance x is tensor(129.3071, device='cuda:3')
benign distance is  tensor(129.3071, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3033258616924286
distance x is tensor(141.8769, device='cuda:3')
benign distance is  tensor(141.8769, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8376528024673462
distance x is tensor(133.6177, device='cuda:3')
benign distance is  tensor(133.6177, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1776593029499054
distance x is tensor(132.4223, device='cuda:3')
benign distance is  tensor(132.4223, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.41911548376083374
distance x is tensor(133.5768, device='cuda:3')
benign distance is  tensor(133.5768, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5582848787307739
distance x is tensor(125.6421, device='cuda:3')
benign distance is  tensor(125.6421, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.34468352794647217
distance x is tensor(118.4899, device='cuda:3')
benign distance is  tensor(118.4899, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3366857171058655
distance x is tensor(126.7848, device='cuda:3')
benign distance is  tensor(126.7848, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(125.9636, device='cuda:3')
compute distance is  tensor(125.9636, device='cuda:3')
compute norm is  tensor(48.6312, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7645, device='cuda:3')
compute distance is  tensor(111.7645, device='cuda:3')
compute norm is  tensor(48.3314, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8303, device='cuda:3')
compute distance is  tensor(131.8303, device='cuda:3')
compute norm is  tensor(48.8787, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9737, device='cuda:3')
compute distance is  tensor(130.9737, device='cuda:3')
compute norm is  tensor(48.6624, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5248, device='cuda:3')
compute distance is  tensor(129.5248, device='cuda:3')
compute norm is  tensor(48.6955, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4806, device='cuda:3')
compute distance is  tensor(129.4806, device='cuda:3')
compute norm is  tensor(48.7859, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9616, device='cuda:3')
compute distance is  tensor(119.9616, device='cuda:3')
compute norm is  tensor(48.6057, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1366, device='cuda:3')
compute distance is  tensor(139.1366, device='cuda:3')
compute norm is  tensor(48.7959, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1478, device='cuda:3')
compute distance is  tensor(132.1478, device='cuda:3')
compute norm is  tensor(48.7646, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7064, device='cuda:3')
compute distance is  tensor(126.7064, device='cuda:3')
compute norm is  tensor(48.5855, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2848, device='cuda:3')
compute distance is  tensor(133.2848, device='cuda:3')
compute norm is  tensor(48.9288, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6516, device='cuda:3')
compute distance is  tensor(134.6516, device='cuda:3')
compute norm is  tensor(48.8281, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.1366, device='cuda:3')
distance x is tensor(107687.7422, device='cuda:3')
distance x is tensor(107687.7422, device='cuda:3')
________________________________
test distance is  tensor(107687.7422, device='cuda:3')
test distance1 is  tensor(107687.7422, device='cuda:3')
test similarity is  tensor(0.0380, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130156603257679.14
test entropy is  0.0
________________________________
cal ratio is  0.03522602370682478
distance x is tensor(3793.4165, device='cuda:3')
cal_distance is  tensor(3793.4165, device='cuda:3')
cal ratio is  0.18768584019698417
distance x is tensor(711.9747, device='cuda:3')
cal_distance is  tensor(711.9747, device='cuda:3')
cal ratio is  0.4332259551310881
distance x is tensor(308.4489, device='cuda:3')
cal_distance is  tensor(308.4489, device='cuda:3')
cal ratio is  0.6581958939605058
distance x is tensor(203.0216, device='cuda:3')
cal_distance is  tensor(203.0216, device='cuda:3')
cal ratio is  0.8112891625795473
distance x is tensor(164.7102, device='cuda:3')
cal_distance is  tensor(164.7102, device='cuda:3')
cal ratio is  0.900713260688568
distance x is tensor(148.3572, device='cuda:3')
cal_distance is  tensor(148.3572, device='cuda:3')
cal ratio is  0.9490574539472465
distance x is tensor(140.7997, device='cuda:3')
cal_distance is  tensor(140.7997, device='cuda:3')
cal ratio is  0.9741949112827379
distance x is tensor(137.1665, device='cuda:3')
cal_distance is  tensor(137.1665, device='cuda:3')
distance x is tensor(137.1665, device='cuda:3')
return_distance is  tensor(137.1665, device='cuda:3')
distance x is tensor(137.1563, device='cuda:3')
distance x is tensor(137.1563, device='cuda:3')
________________________________
test distance is  tensor(137.1563, device='cuda:3')
test distance1 is  tensor(137.1563, device='cuda:3')
test similarity is  tensor(0.9496, device='cuda:3')
test acc is  0.1009833334896653
test loss is 262.5152241558408
test entropy is  0.00036417945442150694
________________________________
0
distance x is tensor(137.1563, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0004200356707318083
avg test loss is  262.4363716141756
avg accuracy is  0.4325500001563415
solo acc is  0.1011833334896653
compute similarity  is  tensor(0.9496, device='cuda:3')
compute_distance is  tensor(137.1563, device='cuda:3')
compute_norm is  tensor(48.8906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(123.1168, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9374590722609685
avg test loss is  1.4029556385743847
avg accuracy is  0.857300000156323
solo acc is  0.32966666682300677
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(123.1168, device='cuda:3')
compute_norm is  tensor(48.3654, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.5502, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8887857332158444
avg test loss is  1.4959476831625265
avg accuracy is  0.8580833334896563
solo acc is  0.26361666682300533
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(124.5502, device='cuda:3')
compute_norm is  tensor(48.1021, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.8224, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8734427640305907
avg test loss is  1.466775036315674
avg accuracy is  0.8576666668229896
solo acc is  0.264783333489672
compute similarity  is  tensor(0.9531, device='cuda:3')
compute_distance is  tensor(125.8224, device='cuda:3')
compute_norm is  tensor(47.8504, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.1140, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8718805294047033
avg test loss is  1.450306031749701
avg accuracy is  0.8597166668229895
solo acc is  0.25606666682300505
compute similarity  is  tensor(0.9529, device='cuda:3')
compute_distance is  tensor(127.1140, device='cuda:3')
compute_norm is  tensor(47.6056, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.3136, device='cuda:3')
distance x is tensor(128.3136, device='cuda:3')
________________________________
test distance is  tensor(128.3136, device='cuda:3')
test distance1 is  tensor(128.3136, device='cuda:3')
test similarity is  tensor(0.9526, device='cuda:3')
test acc is  0.2602000001563385
test loss is 1.4120799514022209
test entropy is  0.873845188983722
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.392194151878357
mal norm is  tensor(656.6985, device='cuda:3')
distance x is tensor(128.3217, device='cuda:3')
mal distance is  tensor(128.3217, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([377.1616, 484.7434, 491.9999, 506.1739, 406.0220, 486.7659, 484.0470,
        516.5092, 656.6985, 656.6985, 656.6985, 656.6985, 656.6985, 656.6985,
        656.6985, 656.6985, 656.6985, 656.6985, 656.6985, 656.6985, 616.8741,
        616.4092, 534.2778, 580.9081, 614.4719, 550.2753, 623.0689, 555.4485],
       device='cuda:3')
sorted_norm is   tensor([377.1616, 406.0220, 484.0470, 484.7434, 486.7659, 491.9999, 506.1739,
        516.5092, 534.2778, 550.2753, 555.4485, 580.9081, 614.4719, 616.4092,
        616.8741, 623.0689, 656.6985, 656.6985, 656.6985, 656.6985, 656.6985,
        656.6985, 656.6985, 656.6985, 656.6985, 656.6985, 656.6985, 656.6985],
       device='cuda:3')
used idx is  tensor([ 0,  4,  6,  1,  5,  2,  3,  7, 22, 25, 27, 23, 24, 21, 20, 26],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 90.17% 

Test Accuracy: 89.47% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7145428657531738
distance x is tensor(100.0022, device='cuda:3')
benign distance is  tensor(100.0022, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2339799702167511
distance x is tensor(120.8660, device='cuda:3')
benign distance is  tensor(120.8660, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25031930208206177
distance x is tensor(113.4518, device='cuda:3')
benign distance is  tensor(113.4518, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5537863969802856
distance x is tensor(109.1498, device='cuda:3')
benign distance is  tensor(109.1498, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.530354380607605
distance x is tensor(105.1736, device='cuda:3')
benign distance is  tensor(105.1736, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5873088836669922
distance x is tensor(110.5093, device='cuda:3')
benign distance is  tensor(110.5093, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.42622002959251404
distance x is tensor(96.3087, device='cuda:3')
benign distance is  tensor(96.3087, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0101982355117798
distance x is tensor(117.7444, device='cuda:3')
benign distance is  tensor(117.7444, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.15576454997062683
distance x is tensor(129.3973, device='cuda:3')
benign distance is  tensor(129.3973, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.4517165422439575
distance x is tensor(146.7533, device='cuda:3')
benign distance is  tensor(146.7533, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4846358895301819
distance x is tensor(128.6583, device='cuda:3')
benign distance is  tensor(128.6583, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.32534581422805786
distance x is tensor(132.2894, device='cuda:3')
benign distance is  tensor(132.2894, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.27935996651649475
distance x is tensor(133.3083, device='cuda:3')
benign distance is  tensor(133.3083, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.361383080482483
distance x is tensor(120.4805, device='cuda:3')
benign distance is  tensor(120.4805, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.12638595700263977
distance x is tensor(142.7495, device='cuda:3')
benign distance is  tensor(142.7495, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4419897198677063
distance x is tensor(140.3516, device='cuda:3')
benign distance is  tensor(140.3516, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(127.6566, device='cuda:3')
compute distance is  tensor(127.6566, device='cuda:3')
compute norm is  tensor(49.1406, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.9834, device='cuda:3')
compute distance is  tensor(122.9834, device='cuda:3')
compute norm is  tensor(48.9127, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6635, device='cuda:3')
compute distance is  tensor(126.6635, device='cuda:3')
compute norm is  tensor(49.0427, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5045, device='cuda:3')
compute distance is  tensor(130.5045, device='cuda:3')
compute norm is  tensor(49.0540, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9424, device='cuda:3')
compute distance is  tensor(120.9424, device='cuda:3')
compute norm is  tensor(48.8886, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2179, device='cuda:3')
compute distance is  tensor(125.2179, device='cuda:3')
compute norm is  tensor(49.1553, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7280, device='cuda:3')
compute distance is  tensor(126.7280, device='cuda:3')
compute norm is  tensor(49.0548, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7538, device='cuda:3')
compute distance is  tensor(137.7538, device='cuda:3')
compute norm is  tensor(49.1335, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5326, device='cuda:3')
compute distance is  tensor(124.5326, device='cuda:3')
compute norm is  tensor(49.0167, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5314, device='cuda:3')
compute distance is  tensor(135.5314, device='cuda:3')
compute norm is  tensor(49.3358, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2266, device='cuda:3')
compute distance is  tensor(135.2266, device='cuda:3')
compute norm is  tensor(49.2698, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4220, device='cuda:3')
compute distance is  tensor(128.4220, device='cuda:3')
compute norm is  tensor(49.0080, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.7538, device='cuda:3')
distance x is tensor(107691.5938, device='cuda:3')
distance x is tensor(107691.5938, device='cuda:3')
________________________________
test distance is  tensor(107691.5938, device='cuda:3')
test distance1 is  tensor(107691.5938, device='cuda:3')
test similarity is  tensor(0.0265, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130128085827059.98
test entropy is  0.0
________________________________
cal ratio is  0.03504991226042141
distance x is tensor(3774.5864, device='cuda:3')
cal_distance is  tensor(3774.5864, device='cuda:3')
cal ratio is  0.18721608509662463
distance x is tensor(706.6675, device='cuda:3')
cal_distance is  tensor(706.6675, device='cuda:3')
cal ratio is  0.43268346567269217
distance x is tensor(305.7663, device='cuda:3')
cal_distance is  tensor(305.7663, device='cuda:3')
cal ratio is  0.6577836285323895
distance x is tensor(201.1298, device='cuda:3')
cal_distance is  tensor(201.1298, device='cuda:3')
cal ratio is  0.8110350373839326
distance x is tensor(163.1243, device='cuda:3')
cal_distance is  tensor(163.1243, device='cuda:3')
cal ratio is  0.9005721588437501
distance x is tensor(146.9057, device='cuda:3')
cal_distance is  tensor(146.9057, device='cuda:3')
cal ratio is  0.9489830801689527
distance x is tensor(139.4113, device='cuda:3')
cal_distance is  tensor(139.4113, device='cuda:3')
cal ratio is  0.97415665736548
distance x is tensor(135.8086, device='cuda:3')
cal_distance is  tensor(135.8086, device='cuda:3')
distance x is tensor(135.8086, device='cuda:3')
return_distance is  tensor(135.8086, device='cuda:3')
distance x is tensor(135.7983, device='cuda:3')
distance x is tensor(135.7983, device='cuda:3')
________________________________
test distance is  tensor(135.7983, device='cuda:3')
test distance1 is  tensor(135.7983, device='cuda:3')
test similarity is  tensor(0.9508, device='cuda:3')
test acc is  0.1008833334896653
test loss is 277.7643897375827
test entropy is  0.00027499444360698456
________________________________
0
distance x is tensor(135.7983, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0003838616667294302
avg test loss is  277.6658169191275
avg accuracy is  0.3985000001563411
solo acc is  0.10090000015633196
compute similarity  is  tensor(0.9508, device='cuda:3')
compute_distance is  tensor(135.7983, device='cuda:3')
compute_norm is  tensor(49.1005, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(123.3972, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9427896074013415
avg test loss is  1.4384904882546936
avg accuracy is  0.8548000001563231
solo acc is  0.3141666668230065
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(123.3972, device='cuda:3')
compute_norm is  tensor(48.5939, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.0837, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.903269292004327
avg test loss is  1.4770218187303685
avg accuracy is  0.8553000001563231
solo acc is  0.2739833334896722
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(125.0837, device='cuda:3')
compute_norm is  tensor(48.3255, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.5022, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8853048964349954
avg test loss is  1.4670828984998692
avg accuracy is  0.8566166668229896
solo acc is  0.26273333348967204
compute similarity  is  tensor(0.9541, device='cuda:3')
compute_distance is  tensor(126.5022, device='cuda:3')
compute_norm is  tensor(48.0688, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.8583, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.866147831558927
avg test loss is  1.4508960203829604
avg accuracy is  0.8587166668229895
solo acc is  0.2594500001563385
compute similarity  is  tensor(0.9538, device='cuda:3')
compute_distance is  tensor(127.8583, device='cuda:3')
compute_norm is  tensor(47.8201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.2364, device='cuda:3')
distance x is tensor(129.2364, device='cuda:3')
________________________________
test distance is  tensor(129.2364, device='cuda:3')
test distance1 is  tensor(129.2364, device='cuda:3')
test similarity is  tensor(0.9536, device='cuda:3')
test acc is  0.24986666682300485
test loss is 1.4304142163506448
test entropy is  0.8747123033126026
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1712567806243896
mal norm is  tensor(652.5437, device='cuda:3')
distance x is tensor(129.2439, device='cuda:3')
mal distance is  tensor(129.2439, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([445.4931, 545.0162, 498.7379, 475.0713, 452.8759, 499.1467, 425.3060,
        515.6030, 652.5437, 652.5438, 652.5437, 652.5438, 652.5437, 652.5438,
        652.5437, 652.5438, 652.5437, 652.5438, 652.5437, 652.5438, 588.0786,
        584.7213, 565.0451, 602.0196, 569.7805, 634.7409, 555.7916, 586.4975],
       device='cuda:3')
sorted_norm is   tensor([425.3060, 445.4931, 452.8759, 475.0713, 498.7379, 499.1467, 515.6030,
        545.0162, 555.7916, 565.0451, 569.7805, 584.7213, 586.4975, 588.0786,
        602.0196, 634.7409, 652.5437, 652.5437, 652.5437, 652.5437, 652.5437,
        652.5437, 652.5438, 652.5438, 652.5438, 652.5438, 652.5438, 652.5438],
       device='cuda:3')
used idx is  tensor([ 6,  0,  4,  3,  2,  5,  7,  1, 26, 22, 24, 21, 27, 20, 23, 25],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 90.42% 

Test Accuracy: 89.52% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.17809653282165527
distance x is tensor(120.0275, device='cuda:3')
benign distance is  tensor(120.0275, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6641508340835571
distance x is tensor(111.3437, device='cuda:3')
benign distance is  tensor(111.3437, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.35599857568740845
distance x is tensor(121.9485, device='cuda:3')
benign distance is  tensor(121.9485, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3311014771461487
distance x is tensor(104.0146, device='cuda:3')
benign distance is  tensor(104.0146, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.10525202751159668
distance x is tensor(86.5256, device='cuda:3')
benign distance is  tensor(86.5256, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0456199645996094
distance x is tensor(119.8180, device='cuda:3')
benign distance is  tensor(119.8180, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20833683013916016
distance x is tensor(112.1561, device='cuda:3')
benign distance is  tensor(112.1561, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2086648941040039
distance x is tensor(120.2883, device='cuda:3')
benign distance is  tensor(120.2883, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5764985680580139
distance x is tensor(131.8050, device='cuda:3')
benign distance is  tensor(131.8050, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6484256982803345
distance x is tensor(135.1866, device='cuda:3')
benign distance is  tensor(135.1866, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.34543219208717346
distance x is tensor(129.4413, device='cuda:3')
benign distance is  tensor(129.4413, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7360798716545105
distance x is tensor(123.5972, device='cuda:3')
benign distance is  tensor(123.5972, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.37492653727531433
distance x is tensor(114.4922, device='cuda:3')
benign distance is  tensor(114.4922, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.18811899423599243
distance x is tensor(135.7565, device='cuda:3')
benign distance is  tensor(135.7565, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9191560745239258
distance x is tensor(131.8336, device='cuda:3')
benign distance is  tensor(131.8336, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3405616879463196
distance x is tensor(131.2487, device='cuda:3')
benign distance is  tensor(131.2487, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(117.4143, device='cuda:3')
compute distance is  tensor(117.4143, device='cuda:3')
compute norm is  tensor(49.0777, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5798, device='cuda:3')
compute distance is  tensor(129.5798, device='cuda:3')
compute norm is  tensor(49.4521, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8749, device='cuda:3')
compute distance is  tensor(140.8749, device='cuda:3')
compute norm is  tensor(49.7626, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9156, device='cuda:3')
compute distance is  tensor(124.9156, device='cuda:3')
compute norm is  tensor(49.3470, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.4193, device='cuda:3')
compute distance is  tensor(127.4193, device='cuda:3')
compute norm is  tensor(49.4624, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.6074, device='cuda:3')
compute distance is  tensor(144.6074, device='cuda:3')
compute norm is  tensor(49.8014, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3780, device='cuda:3')
compute distance is  tensor(132.3780, device='cuda:3')
compute norm is  tensor(49.5728, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.8810, device='cuda:3')
compute distance is  tensor(136.8810, device='cuda:3')
compute norm is  tensor(49.5696, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3552, device='cuda:3')
compute distance is  tensor(140.3552, device='cuda:3')
compute norm is  tensor(49.6358, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1864, device='cuda:3')
compute distance is  tensor(118.1864, device='cuda:3')
compute norm is  tensor(49.3089, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9675, device='cuda:3')
compute distance is  tensor(128.9675, device='cuda:3')
compute norm is  tensor(49.4613, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.4245, device='cuda:3')
compute distance is  tensor(135.4245, device='cuda:3')
compute norm is  tensor(49.5435, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.6074, device='cuda:3')
distance x is tensor(107691.7578, device='cuda:3')
distance x is tensor(107691.7578, device='cuda:3')
________________________________
test distance is  tensor(107691.7578, device='cuda:3')
test distance1 is  tensor(107691.7578, device='cuda:3')
test similarity is  tensor(0.0262, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130152205158797.38
test entropy is  0.0
________________________________
cal ratio is  0.03591121982521078
distance x is tensor(3867.3477, device='cuda:3')
cal_distance is  tensor(3867.3477, device='cuda:3')
cal ratio is  0.1895024300706617
distance x is tensor(732.8761, device='cuda:3')
cal_distance is  tensor(732.8761, device='cuda:3')
cal ratio is  0.4353174920011515
distance x is tensor(319.0367, device='cuda:3')
cal_distance is  tensor(319.0367, device='cuda:3')
cal ratio is  0.6597829286644935
distance x is tensor(210.4967, device='cuda:3')
cal_distance is  tensor(210.4967, device='cuda:3')
cal ratio is  0.8122668833464649
distance x is tensor(170.9805, device='cuda:3')
cal_distance is  tensor(170.9805, device='cuda:3')
cal ratio is  0.9012559472045224
distance x is tensor(154.0977, device='cuda:3')
cal_distance is  tensor(154.0977, device='cuda:3')
cal ratio is  0.9493434039364878
distance x is tensor(146.2919, device='cuda:3')
cal_distance is  tensor(146.2919, device='cuda:3')
cal ratio is  0.9743416548890277
distance x is tensor(142.5384, device='cuda:3')
cal_distance is  tensor(142.5384, device='cuda:3')
distance x is tensor(142.5384, device='cuda:3')
return_distance is  tensor(142.5384, device='cuda:3')
distance x is tensor(142.5281, device='cuda:3')
distance x is tensor(142.5281, device='cuda:3')
________________________________
test distance is  tensor(142.5281, device='cuda:3')
test distance1 is  tensor(142.5281, device='cuda:3')
test similarity is  tensor(0.9471, device='cuda:3')
test acc is  0.10070000015633197
test loss is 341.8544700313479
test entropy is  0.00014703974531731534
________________________________
0
distance x is tensor(142.5281, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00018937688044662462
avg test loss is  342.33338905448346
avg accuracy is  0.33835000015634026
solo acc is  0.1004833334896653
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(142.5281, device='cuda:3')
compute_norm is  tensor(49.6725, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(129.3811, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9995671345480978
avg test loss is  1.508677595714008
avg accuracy is  0.8444500001563234
solo acc is  0.30090000015633955
compute similarity  is  tensor(0.9512, device='cuda:3')
compute_distance is  tensor(129.3811, device='cuda:3')
compute_norm is  tensor(49.2829, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.7579, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9297310597479724
avg test loss is  1.5294723256564597
avg accuracy is  0.8476333334896567
solo acc is  0.2600666668230053
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(130.7579, device='cuda:3')
compute_norm is  tensor(49.0283, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.0260, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8933247193725887
avg test loss is  1.5042473944519628
avg accuracy is  0.8510500001563233
solo acc is  0.2580666668230052
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(132.0260, device='cuda:3')
compute_norm is  tensor(48.7734, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.2575, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.883092513534306
avg test loss is  1.4726582913002226
avg accuracy is  0.8521666668229899
solo acc is  0.2570500001563385
compute similarity  is  tensor(0.9505, device='cuda:3')
compute_distance is  tensor(133.2575, device='cuda:3')
compute_norm is  tensor(48.5252, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.4996, device='cuda:3')
distance x is tensor(134.4996, device='cuda:3')
________________________________
test distance is  tensor(134.4996, device='cuda:3')
test distance1 is  tensor(134.4996, device='cuda:3')
test similarity is  tensor(0.9503, device='cuda:3')
test acc is  0.25495000015633834
test loss is 1.4503478424381346
test entropy is  0.8717844151993042
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3934996128082275
mal norm is  tensor(684.0219, device='cuda:3')
distance x is tensor(134.5074, device='cuda:3')
mal distance is  tensor(134.5074, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([532.2283, 492.1768, 538.8965, 455.0162, 389.5945, 531.9807, 479.1448,
        529.7397, 684.0219, 684.0219, 684.0219, 684.0219, 684.0219, 684.0219,
        684.0219, 684.0219, 684.0219, 684.0219, 684.0219, 684.0219],
       device='cuda:3')
sorted_norm is   tensor([389.5945, 455.0162, 479.1448, 492.1768, 529.7397, 531.9807, 532.2283,
        538.8965, 684.0219, 684.0219, 684.0219, 684.0219, 684.0219, 684.0219,
        684.0219, 684.0219, 684.0219, 684.0219, 684.0219, 684.0219],
       device='cuda:3')
used idx is  tensor([ 4,  3,  6,  1,  7,  5,  0,  2, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 89.03% 

Test Accuracy: 88.30% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.43662214279174805
distance x is tensor(108.8012, device='cuda:3')
benign distance is  tensor(108.8012, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.728299617767334
distance x is tensor(124.2850, device='cuda:3')
benign distance is  tensor(124.2850, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09454329311847687
distance x is tensor(137.9530, device='cuda:3')
benign distance is  tensor(137.9530, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5655735731124878
distance x is tensor(111.5968, device='cuda:3')
benign distance is  tensor(111.5968, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5840333104133606
distance x is tensor(141.1146, device='cuda:3')
benign distance is  tensor(141.1146, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.43880167603492737
distance x is tensor(131.9427, device='cuda:3')
benign distance is  tensor(131.9427, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17197585105895996
distance x is tensor(129.3073, device='cuda:3')
benign distance is  tensor(129.3073, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4513004720211029
distance x is tensor(121.5814, device='cuda:3')
benign distance is  tensor(121.5814, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(162.1858, device='cuda:3')
compute distance is  tensor(162.1858, device='cuda:3')
compute norm is  tensor(50.0358, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7086, device='cuda:3')
compute distance is  tensor(135.7086, device='cuda:3')
compute norm is  tensor(49.4870, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.9679, device='cuda:3')
compute distance is  tensor(162.9679, device='cuda:3')
compute norm is  tensor(50.2983, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1167, device='cuda:3')
compute distance is  tensor(145.1167, device='cuda:3')
compute norm is  tensor(49.7553, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.7547, device='cuda:3')
compute distance is  tensor(157.7547, device='cuda:3')
compute norm is  tensor(50.1282, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.8271, device='cuda:3')
compute distance is  tensor(149.8271, device='cuda:3')
compute norm is  tensor(49.9706, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0911, device='cuda:3')
compute distance is  tensor(139.0911, device='cuda:3')
compute norm is  tensor(49.5745, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.9788, device='cuda:3')
compute distance is  tensor(157.9788, device='cuda:3')
compute norm is  tensor(49.9437, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.9419, device='cuda:3')
compute distance is  tensor(149.9419, device='cuda:3')
compute norm is  tensor(49.7469, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5653, device='cuda:3')
compute distance is  tensor(139.5653, device='cuda:3')
compute norm is  tensor(49.6733, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3668, device='cuda:3')
compute distance is  tensor(142.3668, device='cuda:3')
compute norm is  tensor(49.6354, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.0865, device='cuda:3')
compute distance is  tensor(153.0865, device='cuda:3')
compute norm is  tensor(49.9569, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.9679, device='cuda:3')
distance x is tensor(107669.4062, device='cuda:3')
distance x is tensor(107669.4062, device='cuda:3')
________________________________
test distance is  tensor(107669.4062, device='cuda:3')
test distance1 is  tensor(107669.4062, device='cuda:3')
test similarity is  tensor(0.1144, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130160231750963.86
test entropy is  0.0
________________________________
cal ratio is  0.038126855099357926
distance x is tensor(4105.1021, device='cuda:3')
cal_distance is  tensor(4105.1021, device='cuda:3')
cal ratio is  0.19526084439977068
distance x is tensor(801.5696, device='cuda:3')
cal_distance is  tensor(801.5696, device='cuda:3')
cal ratio is  0.44188220244854665
distance x is tensor(354.2022, device='cuda:3')
cal_distance is  tensor(354.2022, device='cuda:3')
cal ratio is  0.66473950102378
distance x is tensor(235.4539, device='cuda:3')
cal_distance is  tensor(235.4539, device='cuda:3')
cal ratio is  0.8153125886781819
distance x is tensor(191.9695, device='cuda:3')
cal_distance is  tensor(191.9695, device='cuda:3')
cal ratio is  0.9029443713988382
distance x is tensor(173.3383, device='cuda:3')
cal_distance is  tensor(173.3383, device='cuda:3')
cal ratio is  0.9502324858714668
distance x is tensor(164.7119, device='cuda:3')
cal_distance is  tensor(164.7119, device='cuda:3')
cal ratio is  0.9747979318349905
distance x is tensor(160.5610, device='cuda:3')
cal_distance is  tensor(160.5610, device='cuda:3')
distance x is tensor(160.5610, device='cuda:3')
return_distance is  tensor(160.5610, device='cuda:3')
distance x is tensor(160.5507, device='cuda:3')
distance x is tensor(160.5507, device='cuda:3')
________________________________
test distance is  tensor(160.5507, device='cuda:3')
test distance1 is  tensor(160.5507, device='cuda:3')
test similarity is  tensor(0.9394, device='cuda:3')
test acc is  0.10011666682299865
test loss is 432.30167706129646
test entropy is  6.394415962572221e-05
________________________________
0
distance x is tensor(160.5507, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.6908389264860727e-05
avg test loss is  432.1116568884616
avg accuracy is  0.19880000015633628
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9394, device='cuda:3')
compute_distance is  tensor(160.5507, device='cuda:3')
compute_norm is  tensor(51.0791, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.9972, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1113667974212784
avg test loss is  1.6666974858688648
avg accuracy is  0.6166833334896696
solo acc is  0.2686166668230054
compute similarity  is  tensor(0.9416, device='cuda:3')
compute_distance is  tensor(151.9972, device='cuda:3')
compute_norm is  tensor(51.3945, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(153.3447, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6603003364127836
avg test loss is  2.5655260539766567
avg accuracy is  0.4911666668230087
solo acc is  0.1118666668229986
compute similarity  is  tensor(0.9413, device='cuda:3')
compute_distance is  tensor(153.3447, device='cuda:3')
compute_norm is  tensor(51.2497, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.8101, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0349935713861542
avg test loss is  1.58211139956517
avg accuracy is  0.6270833334896688
solo acc is  0.229833333489671
compute similarity  is  tensor(0.9416, device='cuda:3')
compute_distance is  tensor(153.8101, device='cuda:3')
compute_norm is  tensor(50.9413, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(154.6895, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.63001993781468
avg test loss is  2.3788681866517707
avg accuracy is  0.5085833334896755
solo acc is  0.10701666682299862
compute similarity  is  tensor(0.9413, device='cuda:3')
compute_distance is  tensor(154.6895, device='cuda:3')
compute_norm is  tensor(50.7617, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.2305, device='cuda:3')
distance x is tensor(155.2305, device='cuda:3')
________________________________
test distance is  tensor(155.2305, device='cuda:3')
test distance1 is  tensor(155.2305, device='cuda:3')
test similarity is  tensor(0.9414, device='cuda:3')
test acc is  0.25415000015633843
test loss is 1.4732942163054623
test entropy is  0.9784472500845822
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2970784902572632
mal norm is  tensor(781.5472, device='cuda:3')
distance x is tensor(155.2388, device='cuda:3')
mal distance is  tensor(155.2388, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 31
weight size is  torch.Size([52, 215370])
norm res is  tensor([472.2553, 527.6793, 597.3732, 473.7905, 588.1382, 585.3376, 552.7394,
        512.7126, 781.5472, 781.5472, 781.5472, 781.5472, 781.5472, 781.5472,
        781.5472, 781.5472, 781.5472, 781.5472, 781.5472, 781.5472, 645.9222,
        649.9619, 621.1786, 693.3834, 626.7335, 651.0979, 639.2347, 637.9203,
        644.9797, 619.6155, 656.1891, 651.5535, 632.6671, 628.8370, 603.6258,
        688.5727, 645.7877, 724.0670, 642.0638, 670.5430, 658.7480, 607.8185,
        702.2538, 683.2512, 639.9395, 653.6124, 636.4260, 601.6279, 569.8329,
        649.2496, 638.8420, 640.6708], device='cuda:3')
sorted_norm is   tensor([472.2553, 473.7905, 512.7126, 527.6793, 552.7394, 569.8329, 585.3376,
        588.1382, 597.3732, 601.6279, 603.6258, 607.8185, 619.6155, 621.1786,
        626.7335, 628.8370, 632.6671, 636.4260, 637.9203, 638.8420, 639.2347,
        639.9395, 640.6708, 642.0638, 644.9797, 645.7877, 645.9222, 649.2496,
        649.9619, 651.0979, 651.5535, 653.6124, 656.1891, 658.7480, 670.5430,
        683.2512, 688.5727, 693.3834, 702.2538, 724.0670, 781.5472, 781.5472,
        781.5472, 781.5472, 781.5472, 781.5472, 781.5472, 781.5472, 781.5472,
        781.5472, 781.5472, 781.5472], device='cuda:3')
used idx is  tensor([ 0,  3,  7,  1,  6, 48,  5,  4,  2, 47, 34, 41, 29, 22, 24, 33, 32, 46,
        27, 50, 26, 44, 51, 38, 28, 36, 20, 49, 21, 25, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 90.32% 

Test Accuracy: 89.36% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3787688612937927
distance x is tensor(88.5602, device='cuda:3')
benign distance is  tensor(88.5602, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4679884910583496
distance x is tensor(112.8754, device='cuda:3')
benign distance is  tensor(112.8754, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09358377009630203
distance x is tensor(111.7747, device='cuda:3')
benign distance is  tensor(111.7747, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0488380193710327
distance x is tensor(97.1862, device='cuda:3')
benign distance is  tensor(97.1862, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2371665984392166
distance x is tensor(84.6238, device='cuda:3')
benign distance is  tensor(84.6238, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9204375147819519
distance x is tensor(116.3746, device='cuda:3')
benign distance is  tensor(116.3746, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4351818561553955
distance x is tensor(103.1764, device='cuda:3')
benign distance is  tensor(103.1764, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3059668242931366
distance x is tensor(125.0887, device='cuda:3')
benign distance is  tensor(125.0887, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3871174454689026
distance x is tensor(127.1399, device='cuda:3')
benign distance is  tensor(127.1399, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.48968833684921265
distance x is tensor(126.7530, device='cuda:3')
benign distance is  tensor(126.7530, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4856805205345154
distance x is tensor(121.8381, device='cuda:3')
benign distance is  tensor(121.8381, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8667600750923157
distance x is tensor(136.1334, device='cuda:3')
benign distance is  tensor(136.1334, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4336429536342621
distance x is tensor(125.8966, device='cuda:3')
benign distance is  tensor(125.8966, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23057448863983154
distance x is tensor(141.3203, device='cuda:3')
benign distance is  tensor(141.3203, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5464363694190979
distance x is tensor(119.2873, device='cuda:3')
benign distance is  tensor(119.2873, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8849049806594849
distance x is tensor(129.0553, device='cuda:3')
benign distance is  tensor(129.0553, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.27708688378334045
distance x is tensor(128.8731, device='cuda:3')
benign distance is  tensor(128.8731, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4483482837677002
distance x is tensor(150.9537, device='cuda:3')
benign distance is  tensor(150.9537, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3228926658630371
distance x is tensor(122.3044, device='cuda:3')
benign distance is  tensor(122.3044, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.03996587544679642
distance x is tensor(129.6424, device='cuda:3')
benign distance is  tensor(129.6424, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.35047173500061035
distance x is tensor(138.0767, device='cuda:3')
benign distance is  tensor(138.0767, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8444241285324097
distance x is tensor(120.2744, device='cuda:3')
benign distance is  tensor(120.2744, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7157168984413147
distance x is tensor(134.0175, device='cuda:3')
benign distance is  tensor(134.0175, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3504101634025574
distance x is tensor(132.6585, device='cuda:3')
benign distance is  tensor(132.6585, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3470368981361389
distance x is tensor(134.7562, device='cuda:3')
benign distance is  tensor(134.7562, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6331706047058105
distance x is tensor(130.1516, device='cuda:3')
benign distance is  tensor(130.1516, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.1854974925518036
distance x is tensor(150.1495, device='cuda:3')
benign distance is  tensor(150.1495, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.14489689469337463
distance x is tensor(128.1324, device='cuda:3')
benign distance is  tensor(128.1324, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8594293594360352
distance x is tensor(124.2861, device='cuda:3')
benign distance is  tensor(124.2861, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.03332974761724472
distance x is tensor(135.9387, device='cuda:3')
benign distance is  tensor(135.9387, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3435758650302887
distance x is tensor(125.1086, device='cuda:3')
benign distance is  tensor(125.1086, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.47300639748573303
distance x is tensor(137.0594, device='cuda:3')
benign distance is  tensor(137.0594, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1882302463054657
distance x is tensor(125.3509, device='cuda:3')
benign distance is  tensor(125.3509, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.1959485411643982
distance x is tensor(123.2261, device='cuda:3')
benign distance is  tensor(123.2261, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.05728119611740112
distance x is tensor(125.7628, device='cuda:3')
benign distance is  tensor(125.7628, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3168969750404358
distance x is tensor(136.6581, device='cuda:3')
benign distance is  tensor(136.6581, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7678731083869934
distance x is tensor(137.5565, device='cuda:3')
benign distance is  tensor(137.5565, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6900311708450317
distance x is tensor(129.6540, device='cuda:3')
benign distance is  tensor(129.6540, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8036802411079407
distance x is tensor(138.4632, device='cuda:3')
benign distance is  tensor(138.4632, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6612849235534668
distance x is tensor(141.4553, device='cuda:3')
benign distance is  tensor(141.4553, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(136.0608, device='cuda:3')
compute distance is  tensor(136.0608, device='cuda:3')
compute norm is  tensor(49.5478, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4434, device='cuda:3')
compute distance is  tensor(131.4434, device='cuda:3')
compute norm is  tensor(49.3974, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1549, device='cuda:3')
compute distance is  tensor(132.1549, device='cuda:3')
compute norm is  tensor(49.6508, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.9089, device='cuda:3')
compute distance is  tensor(118.9089, device='cuda:3')
compute norm is  tensor(49.1962, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0401, device='cuda:3')
compute distance is  tensor(134.0401, device='cuda:3')
compute norm is  tensor(49.5007, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9813, device='cuda:3')
compute distance is  tensor(132.9813, device='cuda:3')
compute norm is  tensor(49.6403, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7856, device='cuda:3')
compute distance is  tensor(132.7856, device='cuda:3')
compute norm is  tensor(49.5399, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.4018, device='cuda:3')
compute distance is  tensor(127.4018, device='cuda:3')
compute norm is  tensor(49.5240, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9050, device='cuda:3')
compute distance is  tensor(134.9050, device='cuda:3')
compute norm is  tensor(49.5533, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8271, device='cuda:3')
compute distance is  tensor(120.8271, device='cuda:3')
compute norm is  tensor(49.3527, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.6544, device='cuda:3')
compute distance is  tensor(119.6544, device='cuda:3')
compute norm is  tensor(49.3715, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7541, device='cuda:3')
compute distance is  tensor(128.7541, device='cuda:3')
compute norm is  tensor(49.5285, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.0608, device='cuda:3')
distance x is tensor(107690.3828, device='cuda:3')
distance x is tensor(107690.3828, device='cuda:3')
________________________________
test distance is  tensor(107690.3828, device='cuda:3')
test distance1 is  tensor(107690.3828, device='cuda:3')
test similarity is  tensor(0.0393, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130064359360699.77
test entropy is  0.0
________________________________
cal ratio is  0.0348340674136792
distance x is tensor(3751.2993, device='cuda:3')
cal_distance is  tensor(3751.2993, device='cuda:3')
cal ratio is  0.18663874009650824
distance x is tensor(700.1420, device='cuda:3')
cal_distance is  tensor(700.1420, device='cuda:3')
cal ratio is  0.4320157583332308
distance x is tensor(302.4753, device='cuda:3')
cal_distance is  tensor(302.4753, device='cuda:3')
cal ratio is  0.6572758967436827
distance x is tensor(198.8115, device='cuda:3')
cal_distance is  tensor(198.8115, device='cuda:3')
cal ratio is  0.8107218761247806
distance x is tensor(161.1818, device='cuda:3')
cal_distance is  tensor(161.1818, device='cuda:3')
cal ratio is  0.9003981981467881
distance x is tensor(145.1284, device='cuda:3')
cal_distance is  tensor(145.1284, device='cuda:3')
cal ratio is  0.9488913867099819
distance x is tensor(137.7113, device='cuda:3')
cal_distance is  tensor(137.7113, device='cuda:3')
cal ratio is  0.9741096458859945
distance x is tensor(134.1460, device='cuda:3')
cal_distance is  tensor(134.1460, device='cuda:3')
distance x is tensor(134.1460, device='cuda:3')
return_distance is  tensor(134.1460, device='cuda:3')
distance x is tensor(134.1358, device='cuda:3')
distance x is tensor(134.1358, device='cuda:3')
________________________________
test distance is  tensor(134.1358, device='cuda:3')
test distance1 is  tensor(134.1358, device='cuda:3')
test similarity is  tensor(0.9531, device='cuda:3')
test acc is  0.1010833334896653
test loss is 240.84937868748648
test entropy is  0.0004849167056950247
________________________________
0
distance x is tensor(134.1358, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00041888881557854574
avg test loss is  241.12084337897392
avg accuracy is  0.46833333348967515
solo acc is  0.10105000015633196
compute similarity  is  tensor(0.9531, device='cuda:3')
compute_distance is  tensor(134.1358, device='cuda:3')
compute_norm is  tensor(49.5979, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.5133, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9368638680942023
avg test loss is  1.4043984504650906
avg accuracy is  0.8587000001563229
solo acc is  0.3285666668230067
compute similarity  is  tensor(0.9567, device='cuda:3')
compute_distance is  tensor(121.5133, device='cuda:3')
compute_norm is  tensor(49.0341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.1800, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8951350275768655
avg test loss is  1.4729286855471921
avg accuracy is  0.8593333334896562
solo acc is  0.27273333348967216
compute similarity  is  tensor(0.9564, device='cuda:3')
compute_distance is  tensor(123.1800, device='cuda:3')
compute_norm is  tensor(48.7603, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.5749, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8739416939236208
avg test loss is  1.466592681560435
avg accuracy is  0.8614500001563229
solo acc is  0.2627666668230052
compute similarity  is  tensor(0.9561, device='cuda:3')
compute_distance is  tensor(124.5749, device='cuda:3')
compute_norm is  tensor(48.5019, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.9116, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8758527728667391
avg test loss is  1.43671877551943
avg accuracy is  0.8614500001563229
solo acc is  0.25685000015633846
compute similarity  is  tensor(0.9559, device='cuda:3')
compute_distance is  tensor(125.9116, device='cuda:3')
compute_norm is  tensor(48.2502, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.2682, device='cuda:3')
distance x is tensor(127.2682, device='cuda:3')
________________________________
test distance is  tensor(127.2682, device='cuda:3')
test distance1 is  tensor(127.2682, device='cuda:3')
test similarity is  tensor(0.9556, device='cuda:3')
test acc is  0.2592333334896718
test loss is 1.4170504799529688
test entropy is  0.8661121931284476
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4183077812194824
mal norm is  tensor(644.6651, device='cuda:3')
distance x is tensor(127.2760, device='cuda:3')
mal distance is  tensor(127.2760, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([390.3279, 491.8175, 481.1573, 431.6442, 369.0128, 505.5924, 452.5833,
        541.6722, 644.6651, 644.6651, 644.6651, 644.6651, 644.6651, 644.6651,
        644.6651, 644.6651, 644.6651, 644.6651, 644.6651, 644.6651, 588.5457,
        630.9593, 604.7198, 586.3688, 608.1611, 569.2543, 533.6910, 567.5803],
       device='cuda:3')
sorted_norm is   tensor([369.0128, 390.3279, 431.6442, 452.5833, 481.1573, 491.8175, 505.5924,
        533.6910, 541.6722, 567.5803, 569.2543, 586.3688, 588.5457, 604.7198,
        608.1611, 630.9593, 644.6651, 644.6651, 644.6651, 644.6651, 644.6651,
        644.6651, 644.6651, 644.6651, 644.6651, 644.6651, 644.6651, 644.6651],
       device='cuda:3')
used idx is  tensor([ 4,  0,  3,  6,  2,  1,  5, 26,  7, 27, 25, 23, 20, 22, 24, 21],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 90.33% 

Test Accuracy: 89.54% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1251310408115387
distance x is tensor(96.9491, device='cuda:3')
benign distance is  tensor(96.9491, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.28696784377098083
distance x is tensor(106.3265, device='cuda:3')
benign distance is  tensor(106.3265, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24641053378582
distance x is tensor(124.4490, device='cuda:3')
benign distance is  tensor(124.4490, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48041439056396484
distance x is tensor(101.7682, device='cuda:3')
benign distance is  tensor(101.7682, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4085403382778168
distance x is tensor(103.4787, device='cuda:3')
benign distance is  tensor(103.4787, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0060462951660156
distance x is tensor(101.8732, device='cuda:3')
benign distance is  tensor(101.8732, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23147431015968323
distance x is tensor(104.6186, device='cuda:3')
benign distance is  tensor(104.6186, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40886393189430237
distance x is tensor(110.6147, device='cuda:3')
benign distance is  tensor(110.6147, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.20873072743415833
distance x is tensor(148.0508, device='cuda:3')
benign distance is  tensor(148.0508, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.19133220613002777
distance x is tensor(141.5309, device='cuda:3')
benign distance is  tensor(141.5309, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3152448534965515
distance x is tensor(140.4270, device='cuda:3')
benign distance is  tensor(140.4270, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.028162380680441856
distance x is tensor(130.4259, device='cuda:3')
benign distance is  tensor(130.4259, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7461907267570496
distance x is tensor(129.2790, device='cuda:3')
benign distance is  tensor(129.2790, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8161458969116211
distance x is tensor(129.2545, device='cuda:3')
benign distance is  tensor(129.2545, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.37422308325767517
distance x is tensor(129.2727, device='cuda:3')
benign distance is  tensor(129.2727, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.45431947708129883
distance x is tensor(122.8526, device='cuda:3')
benign distance is  tensor(122.8526, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(122.3464, device='cuda:3')
compute distance is  tensor(122.3464, device='cuda:3')
compute norm is  tensor(49.2931, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.5451, device='cuda:3')
compute distance is  tensor(120.5451, device='cuda:3')
compute norm is  tensor(49.3320, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0423, device='cuda:3')
compute distance is  tensor(133.0423, device='cuda:3')
compute norm is  tensor(49.6627, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5195, device='cuda:3')
compute distance is  tensor(118.5195, device='cuda:3')
compute norm is  tensor(49.3467, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7509, device='cuda:3')
compute distance is  tensor(135.7509, device='cuda:3')
compute norm is  tensor(49.6764, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6013, device='cuda:3')
compute distance is  tensor(131.6013, device='cuda:3')
compute norm is  tensor(49.5878, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2517, device='cuda:3')
compute distance is  tensor(123.2517, device='cuda:3')
compute norm is  tensor(49.5537, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.4059, device='cuda:3')
compute distance is  tensor(140.4059, device='cuda:3')
compute norm is  tensor(49.7399, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4783, device='cuda:3')
compute distance is  tensor(137.4783, device='cuda:3')
compute norm is  tensor(49.7752, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3292, device='cuda:3')
compute distance is  tensor(131.3292, device='cuda:3')
compute norm is  tensor(49.6489, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9049, device='cuda:3')
compute distance is  tensor(135.9049, device='cuda:3')
compute norm is  tensor(49.8120, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0415, device='cuda:3')
compute distance is  tensor(133.0415, device='cuda:3')
compute norm is  tensor(49.7015, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(140.4059, device='cuda:3')
distance x is tensor(107691.3828, device='cuda:3')
distance x is tensor(107691.3828, device='cuda:3')
________________________________
test distance is  tensor(107691.3828, device='cuda:3')
test distance1 is  tensor(107691.3828, device='cuda:3')
test similarity is  tensor(0.0327, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130144837787805.2
test entropy is  0.0
________________________________
cal ratio is  0.0353857455978034
distance x is tensor(3810.7454, device='cuda:3')
cal_distance is  tensor(3810.7454, device='cuda:3')
cal ratio is  0.1881108539275059
distance x is tensor(716.8468, device='cuda:3')
cal_distance is  tensor(716.8468, device='cuda:3')
cal ratio is  0.4337161958133995
distance x is tensor(310.9110, device='cuda:3')
cal_distance is  tensor(310.9110, device='cuda:3')
cal ratio is  0.6585682659264216
distance x is tensor(204.7579, device='cuda:3')
cal_distance is  tensor(204.7579, device='cuda:3')
cal ratio is  0.8115186607468143
distance x is tensor(166.1658, device='cuda:3')
cal_distance is  tensor(166.1658, device='cuda:3')
cal ratio is  0.9008406147249401
distance x is tensor(149.6895, device='cuda:3')
cal_distance is  tensor(149.6895, device='cuda:3')
cal ratio is  0.9491245843968561
distance x is tensor(142.0742, device='cuda:3')
cal_distance is  tensor(142.0742, device='cuda:3')
cal ratio is  0.9742294031583992
distance x is tensor(138.4130, device='cuda:3')
cal_distance is  tensor(138.4130, device='cuda:3')
distance x is tensor(138.4130, device='cuda:3')
return_distance is  tensor(138.4130, device='cuda:3')
distance x is tensor(138.4027, device='cuda:3')
distance x is tensor(138.4027, device='cuda:3')
________________________________
test distance is  tensor(138.4027, device='cuda:3')
test distance1 is  tensor(138.4027, device='cuda:3')
test similarity is  tensor(0.9503, device='cuda:3')
test acc is  0.10110000015633197
test loss is 266.4263006181859
test entropy is  0.0005651628314378077
________________________________
0
distance x is tensor(138.4027, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.000460449536994433
avg test loss is  266.94460094915524
avg accuracy is  0.452033333489675
solo acc is  0.1011333334896653
compute similarity  is  tensor(0.9503, device='cuda:3')
compute_distance is  tensor(138.4027, device='cuda:3')
compute_norm is  tensor(49.7377, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(125.3576, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9352692542299788
avg test loss is  1.4467429663580873
avg accuracy is  0.8503333334896567
solo acc is  0.32015000015633993
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(125.3576, device='cuda:3')
compute_norm is  tensor(49.2255, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.8493, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9050595463593123
avg test loss is  1.4980193440085534
avg accuracy is  0.8531500001563233
solo acc is  0.26655000015633873
compute similarity  is  tensor(0.9539, device='cuda:3')
compute_distance is  tensor(126.8493, device='cuda:3')
compute_norm is  tensor(48.9619, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.1174, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8846149177693609
avg test loss is  1.4867238723901288
avg accuracy is  0.8532333334896565
solo acc is  0.25783333348967186
compute similarity  is  tensor(0.9536, device='cuda:3')
compute_distance is  tensor(128.1174, device='cuda:3')
compute_norm is  tensor(48.7075, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.3123, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8843188181614825
avg test loss is  1.4580225164193843
avg accuracy is  0.8569166668229897
solo acc is  0.2560333334896717
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(129.3123, device='cuda:3')
compute_norm is  tensor(48.4599, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.5675, device='cuda:3')
distance x is tensor(130.5675, device='cuda:3')
________________________________
test distance is  tensor(130.5675, device='cuda:3')
test distance1 is  tensor(130.5675, device='cuda:3')
test similarity is  tensor(0.9532, device='cuda:3')
test acc is  0.2539833334896717
test loss is 1.4373113739210914
test entropy is  0.8754461288197971
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.493268609046936
mal norm is  tensor(664.1407, device='cuda:3')
distance x is tensor(130.5753, device='cuda:3')
mal distance is  tensor(130.5753, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([428.9066, 470.6170, 536.1479, 441.5116, 458.9123, 460.8677, 440.8805,
        490.1646, 664.1407, 664.1407, 664.1407, 664.1407, 664.1407, 664.1407,
        664.1407, 664.1407, 664.1407, 664.1407, 664.1407, 664.1407, 572.0653,
        570.8275, 547.2357, 614.7562, 577.9173, 623.7427, 549.8818, 589.7775],
       device='cuda:3')
sorted_norm is   tensor([428.9066, 440.8805, 441.5116, 458.9123, 460.8677, 470.6170, 490.1646,
        536.1479, 547.2357, 549.8818, 570.8275, 572.0653, 577.9173, 589.7775,
        614.7562, 623.7427, 664.1407, 664.1407, 664.1407, 664.1407, 664.1407,
        664.1407, 664.1407, 664.1407, 664.1407, 664.1407, 664.1407, 664.1407],
       device='cuda:3')
used idx is  tensor([ 0,  6,  3,  4,  5,  1,  7,  2, 22, 26, 21, 20, 24, 27, 23, 25],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 90.32% 

Test Accuracy: 89.31% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.40257900953292847
distance x is tensor(92.1216, device='cuda:3')
benign distance is  tensor(92.1216, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4683688282966614
distance x is tensor(122.6267, device='cuda:3')
benign distance is  tensor(122.6267, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.28157782554626465
distance x is tensor(111.7110, device='cuda:3')
benign distance is  tensor(111.7110, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4943656325340271
distance x is tensor(119.6260, device='cuda:3')
benign distance is  tensor(119.6260, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6190857291221619
distance x is tensor(102.9870, device='cuda:3')
benign distance is  tensor(102.9870, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6968473792076111
distance x is tensor(113.6615, device='cuda:3')
benign distance is  tensor(113.6615, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12712661921977997
distance x is tensor(98.2568, device='cuda:3')
benign distance is  tensor(98.2568, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3330239951610565
distance x is tensor(118.8954, device='cuda:3')
benign distance is  tensor(118.8954, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4326992928981781
distance x is tensor(131.2575, device='cuda:3')
benign distance is  tensor(131.2575, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.821398138999939
distance x is tensor(130.9192, device='cuda:3')
benign distance is  tensor(130.9192, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.017458761110901833
distance x is tensor(127.4940, device='cuda:3')
benign distance is  tensor(127.4940, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8333886861801147
distance x is tensor(143.1783, device='cuda:3')
benign distance is  tensor(143.1783, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2505127787590027
distance x is tensor(119.8899, device='cuda:3')
benign distance is  tensor(119.8899, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1542295664548874
distance x is tensor(125.7696, device='cuda:3')
benign distance is  tensor(125.7696, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5145595669746399
distance x is tensor(148.0068, device='cuda:3')
benign distance is  tensor(148.0068, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0576850175857544
distance x is tensor(137.4287, device='cuda:3')
benign distance is  tensor(137.4287, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(122.7945, device='cuda:3')
compute distance is  tensor(122.7945, device='cuda:3')
compute norm is  tensor(49.7604, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5116, device='cuda:3')
compute distance is  tensor(130.5116, device='cuda:3')
compute norm is  tensor(49.9350, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9772, device='cuda:3')
compute distance is  tensor(135.9772, device='cuda:3')
compute norm is  tensor(50.1843, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7569, device='cuda:3')
compute distance is  tensor(122.7569, device='cuda:3')
compute norm is  tensor(49.8613, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5246, device='cuda:3')
compute distance is  tensor(130.5246, device='cuda:3')
compute norm is  tensor(49.9749, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8771, device='cuda:3')
compute distance is  tensor(138.8771, device='cuda:3')
compute norm is  tensor(50.3316, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6658, device='cuda:3')
compute distance is  tensor(132.6658, device='cuda:3')
compute norm is  tensor(50.1054, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5453, device='cuda:3')
compute distance is  tensor(134.5453, device='cuda:3')
compute norm is  tensor(50.1281, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1923, device='cuda:3')
compute distance is  tensor(142.1923, device='cuda:3')
compute norm is  tensor(50.3861, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8525, device='cuda:3')
compute distance is  tensor(134.8525, device='cuda:3')
compute norm is  tensor(50.1633, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5225, device='cuda:3')
compute distance is  tensor(133.5225, device='cuda:3')
compute norm is  tensor(50.1420, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6411, device='cuda:3')
compute distance is  tensor(130.6411, device='cuda:3')
compute norm is  tensor(50.1285, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(142.1923, device='cuda:3')
distance x is tensor(107694.1875, device='cuda:3')
distance x is tensor(107694.1875, device='cuda:3')
________________________________
test distance is  tensor(107694.1875, device='cuda:3')
test distance1 is  tensor(107694.1875, device='cuda:3')
test similarity is  tensor(0.0300, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129976528828437.83
test entropy is  0.0
________________________________
cal ratio is  0.03560966823450031
distance x is tensor(3834.9604, device='cuda:3')
cal_distance is  tensor(3834.9604, device='cuda:3')
cal ratio is  0.18870509162080834
distance x is tensor(723.6805, device='cuda:3')
cal_distance is  tensor(723.6805, device='cuda:3')
cal ratio is  0.4344007928655192
distance x is tensor(314.3704, device='cuda:3')
cal_distance is  tensor(314.3704, device='cuda:3')
cal ratio is  0.6590877697505895
distance x is tensor(207.1994, device='cuda:3')
cal_distance is  tensor(207.1994, device='cuda:3')
cal ratio is  0.8118387068961098
distance x is tensor(168.2135, device='cuda:3')
cal_distance is  tensor(168.2135, device='cuda:3')
cal ratio is  0.9010183337518276
distance x is tensor(151.5639, device='cuda:3')
cal_distance is  tensor(151.5639, device='cuda:3')
cal ratio is  0.9492183057619161
distance x is tensor(143.8676, device='cuda:3')
cal_distance is  tensor(143.8676, device='cuda:3')
cal ratio is  0.9742774077058068
distance x is tensor(140.1671, device='cuda:3')
cal_distance is  tensor(140.1671, device='cuda:3')
distance x is tensor(140.1671, device='cuda:3')
return_distance is  tensor(140.1671, device='cuda:3')
distance x is tensor(140.1568, device='cuda:3')
distance x is tensor(140.1568, device='cuda:3')
________________________________
test distance is  tensor(140.1568, device='cuda:3')
test distance1 is  tensor(140.1568, device='cuda:3')
test similarity is  tensor(0.9500, device='cuda:3')
test acc is  0.10080000015633196
test loss is 293.6898340253688
test entropy is  0.0003779040973543238
________________________________
0
distance x is tensor(140.1568, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00034499265954816816
avg test loss is  292.66205068234444
avg accuracy is  0.41865000015634135
solo acc is  0.10106666682299864
compute similarity  is  tensor(0.9500, device='cuda:3')
compute_distance is  tensor(140.1568, device='cuda:3')
compute_norm is  tensor(50.2533, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(126.8974, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9653655051676704
avg test loss is  1.4359966864718048
avg accuracy is  0.8473333334896568
solo acc is  0.3200833334896732
compute similarity  is  tensor(0.9541, device='cuda:3')
compute_distance is  tensor(126.8974, device='cuda:3')
compute_norm is  tensor(49.8080, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.3937, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9051158831699062
avg test loss is  1.5048231371938547
avg accuracy is  0.8503333334896566
solo acc is  0.2701333334896721
compute similarity  is  tensor(0.9538, device='cuda:3')
compute_distance is  tensor(128.3937, device='cuda:3')
compute_norm is  tensor(49.5403, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.7726, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9017843478269922
avg test loss is  1.4822114108722093
avg accuracy is  0.8521333334896566
solo acc is  0.2572666668230051
compute similarity  is  tensor(0.9536, device='cuda:3')
compute_distance is  tensor(129.7726, device='cuda:3')
compute_norm is  tensor(49.2825, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.1608, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8664222076249275
avg test loss is  1.472718224215355
avg accuracy is  0.8544500001563231
solo acc is  0.25201666682300494
compute similarity  is  tensor(0.9533, device='cuda:3')
compute_distance is  tensor(131.1608, device='cuda:3')
compute_norm is  tensor(49.0298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.5041, device='cuda:3')
distance x is tensor(132.5041, device='cuda:3')
________________________________
test distance is  tensor(132.5041, device='cuda:3')
test distance1 is  tensor(132.5041, device='cuda:3')
test similarity is  tensor(0.9531, device='cuda:3')
test acc is  0.25233333348967163
test loss is 1.4377856431231062
test entropy is  0.8782179555786189
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1297770738601685
mal norm is  tensor(672.0208, device='cuda:3')
distance x is tensor(132.5116, device='cuda:3')
mal distance is  tensor(132.5116, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([409.4514, 533.7250, 489.0652, 520.8229, 448.0335, 508.5444, 424.8248,
        514.8803, 672.0207, 672.0208, 672.0207, 672.0208, 672.0207, 672.0208,
        672.0207, 672.0208, 672.0207, 672.0208, 672.0207, 672.0208, 575.7185,
        665.9241, 550.0355, 598.8365, 608.6066, 537.6515, 609.3987, 594.4000],
       device='cuda:3')
sorted_norm is   tensor([409.4514, 424.8248, 448.0335, 489.0652, 508.5444, 514.8803, 520.8229,
        533.7250, 537.6515, 550.0355, 575.7185, 594.4000, 598.8365, 608.6066,
        609.3987, 665.9241, 672.0207, 672.0207, 672.0207, 672.0207, 672.0207,
        672.0207, 672.0208, 672.0208, 672.0208, 672.0208, 672.0208, 672.0208],
       device='cuda:3')
used idx is  tensor([ 0,  6,  4,  2,  5,  7,  3,  1, 25, 22, 20, 27, 23, 24, 26, 21],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 90.23% 

Test Accuracy: 89.35% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6098189353942871
distance x is tensor(115.3853, device='cuda:3')
benign distance is  tensor(115.3853, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5288615822792053
distance x is tensor(101.4204, device='cuda:3')
benign distance is  tensor(101.4204, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.01165479514747858
distance x is tensor(103.5959, device='cuda:3')
benign distance is  tensor(103.5959, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4560064673423767
distance x is tensor(86.1182, device='cuda:3')
benign distance is  tensor(86.1182, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4151538908481598
distance x is tensor(101.9157, device='cuda:3')
benign distance is  tensor(101.9157, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9313376545906067
distance x is tensor(104.5289, device='cuda:3')
benign distance is  tensor(104.5289, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2629087567329407
distance x is tensor(100.7315, device='cuda:3')
benign distance is  tensor(100.7315, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6338441371917725
distance x is tensor(102.6570, device='cuda:3')
benign distance is  tensor(102.6570, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.31514793634414673
distance x is tensor(135.4039, device='cuda:3')
benign distance is  tensor(135.4039, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4080843925476074
distance x is tensor(147.0709, device='cuda:3')
benign distance is  tensor(147.0709, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2768920660018921
distance x is tensor(128.2675, device='cuda:3')
benign distance is  tensor(128.2675, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.15303637087345123
distance x is tensor(133.4671, device='cuda:3')
benign distance is  tensor(133.4671, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2157212197780609
distance x is tensor(132.4498, device='cuda:3')
benign distance is  tensor(132.4498, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.26708701252937317
distance x is tensor(129.2083, device='cuda:3')
benign distance is  tensor(129.2083, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4563589096069336
distance x is tensor(140.0188, device='cuda:3')
benign distance is  tensor(140.0188, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.14754001796245575
distance x is tensor(134.7916, device='cuda:3')
benign distance is  tensor(134.7916, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(127.4797, device='cuda:3')
compute distance is  tensor(127.4797, device='cuda:3')
compute norm is  tensor(50.1071, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9862, device='cuda:3')
compute distance is  tensor(123.9862, device='cuda:3')
compute norm is  tensor(50.1306, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1207, device='cuda:3')
compute distance is  tensor(134.1207, device='cuda:3')
compute norm is  tensor(50.5028, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3986, device='cuda:3')
compute distance is  tensor(134.3986, device='cuda:3')
compute norm is  tensor(50.2690, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3725, device='cuda:3')
compute distance is  tensor(133.3725, device='cuda:3')
compute norm is  tensor(50.3527, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0280, device='cuda:3')
compute distance is  tensor(151.0280, device='cuda:3')
compute norm is  tensor(50.6985, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9407, device='cuda:3')
compute distance is  tensor(130.9407, device='cuda:3')
compute norm is  tensor(50.3374, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1594, device='cuda:3')
compute distance is  tensor(135.1594, device='cuda:3')
compute norm is  tensor(50.3937, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8413, device='cuda:3')
compute distance is  tensor(120.8413, device='cuda:3')
compute norm is  tensor(50.1256, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.4588, device='cuda:3')
compute distance is  tensor(130.4588, device='cuda:3')
compute norm is  tensor(50.5456, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3084, device='cuda:3')
compute distance is  tensor(132.3084, device='cuda:3')
compute norm is  tensor(50.4811, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6293, device='cuda:3')
compute distance is  tensor(131.6293, device='cuda:3')
compute norm is  tensor(50.1463, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.0280, device='cuda:3')
distance x is tensor(107696.9062, device='cuda:3')
distance x is tensor(107696.9062, device='cuda:3')
________________________________
test distance is  tensor(107696.9062, device='cuda:3')
test distance1 is  tensor(107696.9062, device='cuda:3')
test similarity is  tensor(0.0277, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130082415428038.14
test entropy is  0.0
________________________________
cal ratio is  0.036698907471590825
distance x is tensor(3952.3638, device='cuda:3')
cal_distance is  tensor(3952.3638, device='cuda:3')
cal ratio is  0.1915694645234816
distance x is tensor(757.1564, device='cuda:3')
cal_distance is  tensor(757.1564, device='cuda:3')
cal ratio is  0.43768527075344027
distance x is tensor(331.3991, device='cuda:3')
cal_distance is  tensor(331.3991, device='cuda:3')
cal ratio is  0.6615749567973664
distance x is tensor(219.2471, device='cuda:3')
cal_distance is  tensor(219.2471, device='cuda:3')
cal ratio is  0.8133693468235387
distance x is tensor(178.3298, device='cuda:3')
cal_distance is  tensor(178.3298, device='cuda:3')
cal ratio is  0.9018674637075811
distance x is tensor(160.8304, device='cuda:3')
cal_distance is  tensor(160.8304, device='cuda:3')
cal ratio is  0.9496654958206163
distance x is tensor(152.7354, device='cuda:3')
cal_distance is  tensor(152.7354, device='cuda:3')
cal ratio is  0.9745069389864439
distance x is tensor(148.8418, device='cuda:3')
cal_distance is  tensor(148.8418, device='cuda:3')
distance x is tensor(148.8418, device='cuda:3')
return_distance is  tensor(148.8418, device='cuda:3')
distance x is tensor(148.8315, device='cuda:3')
distance x is tensor(148.8315, device='cuda:3')
________________________________
test distance is  tensor(148.8315, device='cuda:3')
test distance1 is  tensor(148.8315, device='cuda:3')
test similarity is  tensor(0.9446, device='cuda:3')
test acc is  0.1011833334896653
test loss is 342.61926409430595
test entropy is  0.00046076050856521126
________________________________
0
distance x is tensor(148.8315, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0004065083797936292
avg test loss is  342.40671469356965
avg accuracy is  0.35505000015634053
solo acc is  0.10115000015633197
compute similarity  is  tensor(0.9446, device='cuda:3')
compute_distance is  tensor(148.8315, device='cuda:3')
compute_norm is  tensor(50.6359, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.7760, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0191779775278909
avg test loss is  1.5739480433687727
avg accuracy is  0.8213000001563244
solo acc is  0.2819000001563391
compute similarity  is  tensor(0.9482, device='cuda:3')
compute_distance is  tensor(137.7760, device='cuda:3')
compute_norm is  tensor(50.3832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.3277, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9351895615490261
avg test loss is  1.5843702824131003
avg accuracy is  0.8222833334896577
solo acc is  0.24598333348967133
compute similarity  is  tensor(0.9479, device='cuda:3')
compute_distance is  tensor(139.3277, device='cuda:3')
compute_norm is  tensor(50.1347, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.5422, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9312783537515953
avg test loss is  1.5456305120799587
avg accuracy is  0.8279166668229908
solo acc is  0.23685000015633784
compute similarity  is  tensor(0.9477, device='cuda:3')
compute_distance is  tensor(140.5422, device='cuda:3')
compute_norm is  tensor(49.8856, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(141.7372, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9067051179373442
avg test loss is  1.5103345505718484
avg accuracy is  0.8294833334896574
solo acc is  0.2434333334896714
compute similarity  is  tensor(0.9475, device='cuda:3')
compute_distance is  tensor(141.7372, device='cuda:3')
compute_norm is  tensor(49.6378, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.9262, device='cuda:3')
distance x is tensor(142.9262, device='cuda:3')
________________________________
test distance is  tensor(142.9262, device='cuda:3')
test distance1 is  tensor(142.9262, device='cuda:3')
test similarity is  tensor(0.9473, device='cuda:3')
test acc is  0.24413333348967137
test loss is 1.483017544883655
test entropy is  0.8901415558130756
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3854180574417114
mal norm is  tensor(719.0346, device='cuda:3')
distance x is tensor(142.9335, device='cuda:3')
mal distance is  tensor(142.9335, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([522.4090, 451.6622, 446.7110, 378.2122, 446.3664, 468.0043, 433.7283,
        450.8967, 719.0346, 719.0346, 719.0346, 719.0346, 719.0346, 719.0346,
        719.0346, 719.0346, 719.0346, 719.0346, 719.0346, 719.0346, 608.3423,
        582.0164, 670.7878, 576.9064, 551.1896, 611.7625, 578.6970, 627.4268,
        603.6717, 599.8577, 572.0790, 643.0674, 558.8192, 581.2399, 657.3112,
        632.7675], device='cuda:3')
sorted_norm is   tensor([378.2122, 433.7283, 446.3664, 446.7110, 450.8967, 451.6622, 468.0043,
        522.4090, 551.1896, 558.8192, 572.0790, 576.9064, 578.6970, 581.2399,
        582.0164, 599.8577, 603.6717, 608.3423, 611.7625, 627.4268, 632.7675,
        643.0674, 657.3112, 670.7878, 719.0346, 719.0346, 719.0346, 719.0346,
        719.0346, 719.0346, 719.0346, 719.0346, 719.0346, 719.0346, 719.0346,
        719.0346], device='cuda:3')
used idx is  tensor([ 3,  6,  4,  2,  7,  1,  5,  0, 24, 32, 30, 23, 26, 33, 21, 29, 28, 20,
        25, 27, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 90.38% 

Test Accuracy: 89.52% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8698183298110962
distance x is tensor(83.0341, device='cuda:3')
benign distance is  tensor(83.0341, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.24463126063346863
distance x is tensor(125.9277, device='cuda:3')
benign distance is  tensor(125.9277, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17541919648647308
distance x is tensor(110.0546, device='cuda:3')
benign distance is  tensor(110.0546, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2240249663591385
distance x is tensor(116.0063, device='cuda:3')
benign distance is  tensor(116.0063, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7192150354385376
distance x is tensor(103.8731, device='cuda:3')
benign distance is  tensor(103.8731, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8688076138496399
distance x is tensor(113.2687, device='cuda:3')
benign distance is  tensor(113.2687, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13509853184223175
distance x is tensor(98.3761, device='cuda:3')
benign distance is  tensor(98.3761, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.17393800616264343
distance x is tensor(101.5382, device='cuda:3')
benign distance is  tensor(101.5382, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4200590252876282
distance x is tensor(139.6081, device='cuda:3')
benign distance is  tensor(139.6081, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5348379611968994
distance x is tensor(127.8601, device='cuda:3')
benign distance is  tensor(127.8601, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6045737266540527
distance x is tensor(132.3664, device='cuda:3')
benign distance is  tensor(132.3664, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7768480181694031
distance x is tensor(129.4154, device='cuda:3')
benign distance is  tensor(129.4154, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.45951271057128906
distance x is tensor(114.5817, device='cuda:3')
benign distance is  tensor(114.5817, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.47787341475486755
distance x is tensor(131.2494, device='cuda:3')
benign distance is  tensor(131.2494, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8190568089485168
distance x is tensor(132.4250, device='cuda:3')
benign distance is  tensor(132.4250, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5170994400978088
distance x is tensor(128.6570, device='cuda:3')
benign distance is  tensor(128.6570, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1105180978775024
distance x is tensor(130.2251, device='cuda:3')
benign distance is  tensor(130.2251, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7355254292488098
distance x is tensor(120.5933, device='cuda:3')
benign distance is  tensor(120.5933, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.49375447630882263
distance x is tensor(140.7437, device='cuda:3')
benign distance is  tensor(140.7437, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4749021530151367
distance x is tensor(139.4080, device='cuda:3')
benign distance is  tensor(139.4080, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.487138569355011
distance x is tensor(132.7743, device='cuda:3')
benign distance is  tensor(132.7743, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.983035683631897
distance x is tensor(141.6844, device='cuda:3')
benign distance is  tensor(141.6844, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.23438778519630432
distance x is tensor(129.1953, device='cuda:3')
benign distance is  tensor(129.1953, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.0699220523238182
distance x is tensor(131.8272, device='cuda:3')
benign distance is  tensor(131.8272, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.2740, device='cuda:3')
compute distance is  tensor(121.2740, device='cuda:3')
compute norm is  tensor(50.1509, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8293, device='cuda:3')
compute distance is  tensor(122.8293, device='cuda:3')
compute norm is  tensor(50.1283, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0438, device='cuda:3')
compute distance is  tensor(123.0438, device='cuda:3')
compute norm is  tensor(50.4252, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4537, device='cuda:3')
compute distance is  tensor(123.4537, device='cuda:3')
compute norm is  tensor(50.2525, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5023, device='cuda:3')
compute distance is  tensor(130.5023, device='cuda:3')
compute norm is  tensor(50.4923, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.4347, device='cuda:3')
compute distance is  tensor(127.4347, device='cuda:3')
compute norm is  tensor(50.4651, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1460, device='cuda:3')
compute distance is  tensor(137.1460, device='cuda:3')
compute norm is  tensor(50.5942, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8462, device='cuda:3')
compute distance is  tensor(139.8462, device='cuda:3')
compute norm is  tensor(50.6273, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1186, device='cuda:3')
compute distance is  tensor(142.1186, device='cuda:3')
compute norm is  tensor(50.5946, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7717, device='cuda:3')
compute distance is  tensor(128.7717, device='cuda:3')
compute norm is  tensor(50.4761, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8904, device='cuda:3')
compute distance is  tensor(132.8904, device='cuda:3')
compute norm is  tensor(50.6083, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8625, device='cuda:3')
compute distance is  tensor(127.8625, device='cuda:3')
compute norm is  tensor(50.3743, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(142.1186, device='cuda:3')
distance x is tensor(107696.6250, device='cuda:3')
distance x is tensor(107696.6250, device='cuda:3')
________________________________
test distance is  tensor(107696.6250, device='cuda:3')
test distance1 is  tensor(107696.6250, device='cuda:3')
test similarity is  tensor(0.0270, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130022684890301.95
test entropy is  0.0
________________________________
cal ratio is  0.03560003576414705
distance x is tensor(3834.0093, device='cuda:3')
cal_distance is  tensor(3834.0093, device='cuda:3')
cal ratio is  0.18867957978480276
distance x is tensor(723.4035, device='cuda:3')
cal_distance is  tensor(723.4035, device='cuda:3')
cal ratio is  0.4343713560431793
distance x is tensor(314.2286, device='cuda:3')
cal_distance is  tensor(314.2286, device='cuda:3')
cal ratio is  0.6590655347936005
distance x is tensor(207.0990, device='cuda:3')
cal_distance is  tensor(207.0990, device='cuda:3')
cal ratio is  0.8118250274696025
distance x is tensor(168.1292, device='cuda:3')
cal_distance is  tensor(168.1292, device='cuda:3')
cal ratio is  0.9010107097724852
distance x is tensor(151.4867, device='cuda:3')
cal_distance is  tensor(151.4867, device='cuda:3')
cal ratio is  0.9492141747384029
distance x is tensor(143.7936, device='cuda:3')
cal_distance is  tensor(143.7936, device='cuda:3')
cal ratio is  0.9742753218780548
distance x is tensor(140.0947, device='cuda:3')
cal_distance is  tensor(140.0947, device='cuda:3')
distance x is tensor(140.0947, device='cuda:3')
return_distance is  tensor(140.0947, device='cuda:3')
distance x is tensor(140.0844, device='cuda:3')
distance x is tensor(140.0844, device='cuda:3')
________________________________
test distance is  tensor(140.0844, device='cuda:3')
test distance1 is  tensor(140.0844, device='cuda:3')
test similarity is  tensor(0.9506, device='cuda:3')
test acc is  0.10141666682299863
test loss is 284.06121447142255
test entropy is  0.00035344013447983797
________________________________
0
distance x is tensor(140.0844, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0003637077516001644
avg test loss is  284.08467305392855
avg accuracy is  0.4415166668230083
solo acc is  0.10125000015633197
compute similarity  is  tensor(0.9506, device='cuda:3')
compute_distance is  tensor(140.0844, device='cuda:3')
compute_norm is  tensor(50.5595, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(127.2876, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9521377136204034
avg test loss is  1.4888834439869374
avg accuracy is  0.8516833334896565
solo acc is  0.30531666682300623
compute similarity  is  tensor(0.9545, device='cuda:3')
compute_distance is  tensor(127.2876, device='cuda:3')
compute_norm is  tensor(50.0562, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.7527, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.900301965060773
avg test loss is  1.5206934996505281
avg accuracy is  0.8525333334896564
solo acc is  0.26545000015633863
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(128.7527, device='cuda:3')
compute_norm is  tensor(49.7870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.0916, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9016121081324783
avg test loss is  1.4691913018602807
avg accuracy is  0.8531333334896565
solo acc is  0.2659000001563387
compute similarity  is  tensor(0.9539, device='cuda:3')
compute_distance is  tensor(130.0916, device='cuda:3')
compute_norm is  tensor(49.5266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.3138, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8819619931264727
avg test loss is  1.4598409802928916
avg accuracy is  0.8563333334896565
solo acc is  0.2588500001563385
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(131.3138, device='cuda:3')
compute_norm is  tensor(49.2715, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.6052, device='cuda:3')
distance x is tensor(132.6052, device='cuda:3')
________________________________
test distance is  tensor(132.6052, device='cuda:3')
test distance1 is  tensor(132.6052, device='cuda:3')
test similarity is  tensor(0.9534, device='cuda:3')
test acc is  0.2542833334896717
test loss is 1.4435061029533842
test entropy is  0.8717336676903625
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3046646118164062
mal norm is  tensor(673.1088, device='cuda:3')
distance x is tensor(132.6129, device='cuda:3')
mal distance is  tensor(132.6129, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([370.2181, 553.2722, 472.2067, 495.4534, 461.9778, 501.1643, 423.2377,
        445.0146, 673.1088, 673.1088, 673.1088, 673.1088, 673.1088, 673.1088,
        673.1088, 673.1088, 673.1088, 673.1088, 673.1088, 673.1088],
       device='cuda:3')
sorted_norm is   tensor([370.2181, 423.2377, 445.0146, 461.9778, 472.2067, 495.4534, 501.1643,
        553.2722, 673.1088, 673.1088, 673.1088, 673.1088, 673.1088, 673.1088,
        673.1088, 673.1088, 673.1088, 673.1088, 673.1088, 673.1088],
       device='cuda:3')
used idx is  tensor([ 0,  6,  7,  4,  2,  3,  5,  1, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 89.27% 

Test Accuracy: 88.53% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0836154222488403
distance x is tensor(125.8081, device='cuda:3')
benign distance is  tensor(125.8081, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9559959173202515
distance x is tensor(132.2312, device='cuda:3')
benign distance is  tensor(132.2312, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2665903568267822
distance x is tensor(127.2626, device='cuda:3')
benign distance is  tensor(127.2626, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4469843804836273
distance x is tensor(118.3002, device='cuda:3')
benign distance is  tensor(118.3002, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0656869411468506
distance x is tensor(104.3251, device='cuda:3')
benign distance is  tensor(104.3251, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3462679982185364
distance x is tensor(130.7075, device='cuda:3')
benign distance is  tensor(130.7075, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19757775962352753
distance x is tensor(124.0057, device='cuda:3')
benign distance is  tensor(124.0057, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4408349096775055
distance x is tensor(122.4615, device='cuda:3')
benign distance is  tensor(122.4615, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(133.2736, device='cuda:3')
compute distance is  tensor(133.2736, device='cuda:3')
compute norm is  tensor(50.3253, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8868, device='cuda:3')
compute distance is  tensor(137.8868, device='cuda:3')
compute norm is  tensor(50.4189, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1160, device='cuda:3')
compute distance is  tensor(139.1160, device='cuda:3')
compute norm is  tensor(50.7483, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.8080, device='cuda:3')
compute distance is  tensor(153.8080, device='cuda:3')
compute norm is  tensor(50.7125, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1465, device='cuda:3')
compute distance is  tensor(143.1465, device='cuda:3')
compute norm is  tensor(50.6565, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.8927, device='cuda:3')
compute distance is  tensor(148.8927, device='cuda:3')
compute norm is  tensor(50.6916, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2944, device='cuda:3')
compute distance is  tensor(147.2944, device='cuda:3')
compute norm is  tensor(50.6635, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.6722, device='cuda:3')
compute distance is  tensor(144.6722, device='cuda:3')
compute norm is  tensor(50.6267, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.8576, device='cuda:3')
compute distance is  tensor(158.8576, device='cuda:3')
compute norm is  tensor(50.9799, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.6264, device='cuda:3')
compute distance is  tensor(143.6264, device='cuda:3')
compute norm is  tensor(50.6910, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9276, device='cuda:3')
compute distance is  tensor(142.9276, device='cuda:3')
compute norm is  tensor(50.7215, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.1527, device='cuda:3')
compute distance is  tensor(159.1527, device='cuda:3')
compute norm is  tensor(50.9496, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(159.1527, device='cuda:3')
distance x is tensor(107671.7891, device='cuda:3')
distance x is tensor(107671.7891, device='cuda:3')
________________________________
test distance is  tensor(107671.7891, device='cuda:3')
test distance1 is  tensor(107671.7891, device='cuda:3')
test similarity is  tensor(0.1145, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130086481005360.58
test entropy is  0.0
________________________________
cal ratio is  0.03767750634875899
distance x is tensor(4056.8101, device='cuda:3')
cal_distance is  tensor(4056.8101, device='cuda:3')
cal ratio is  0.19410681244737685
distance x is tensor(787.4587, device='cuda:3')
cal_distance is  tensor(787.4587, device='cuda:3')
cal ratio is  0.44057437339397876
distance x is tensor(346.9370, device='cuda:3')
cal_distance is  tensor(346.9370, device='cuda:3')
cal ratio is  0.6637550113240953
distance x is tensor(230.2829, device='cuda:3')
cal_distance is  tensor(230.2829, device='cuda:3')
cal ratio is  0.8147085813509833
distance x is tensor(187.6144, device='cuda:3')
cal_distance is  tensor(187.6144, device='cuda:3')
cal ratio is  0.9026096980429315
distance x is tensor(169.3431, device='cuda:3')
cal_distance is  tensor(169.3431, device='cuda:3')
cal ratio is  0.9500564110972801
distance x is tensor(160.8858, device='cuda:3')
cal_distance is  tensor(160.8858, device='cuda:3')
cal ratio is  0.9747074628927798
distance x is tensor(156.8167, device='cuda:3')
cal_distance is  tensor(156.8167, device='cuda:3')
distance x is tensor(156.8167, device='cuda:3')
return_distance is  tensor(156.8167, device='cuda:3')
distance x is tensor(156.8064, device='cuda:3')
distance x is tensor(156.8064, device='cuda:3')
________________________________
test distance is  tensor(156.8064, device='cuda:3')
test distance1 is  tensor(156.8064, device='cuda:3')
test similarity is  tensor(0.9438, device='cuda:3')
test acc is  0.10015000015633198
test loss is 401.1682486462949
test entropy is  0.00011360385894630204
________________________________
0
distance x is tensor(156.8064, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.25266317257772e-05
avg test loss is  401.2484487114685
avg accuracy is  0.22791666682300413
solo acc is  0.10023333348966532
compute similarity  is  tensor(0.9438, device='cuda:3')
compute_distance is  tensor(156.8064, device='cuda:3')
compute_norm is  tensor(51.8758, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.6474, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1351243303909992
avg test loss is  1.7634934284793797
avg accuracy is  0.6395666668230013
solo acc is  0.21948333348967045
compute similarity  is  tensor(0.9459, device='cuda:3')
compute_distance is  tensor(148.6474, device='cuda:3')
compute_norm is  tensor(52.0929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(150.1904, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6571128527874123
avg test loss is  2.546031112609896
avg accuracy is  0.5295000001563424
solo acc is  0.1122666668229986
compute similarity  is  tensor(0.9455, device='cuda:3')
compute_distance is  tensor(150.1904, device='cuda:3')
compute_norm is  tensor(51.9388, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.7437, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0099291708677816
avg test loss is  1.5227480206662403
avg accuracy is  0.6683333334896661
solo acc is  0.25436666682300507
compute similarity  is  tensor(0.9458, device='cuda:3')
compute_distance is  tensor(150.7437, device='cuda:3')
compute_norm is  tensor(51.6265, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.8248, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6192808473415212
avg test loss is  2.3718633021372977
avg accuracy is  0.5522500001563417
solo acc is  0.10806666682299862
compute similarity  is  tensor(0.9455, device='cuda:3')
compute_distance is  tensor(151.8248, device='cuda:3')
compute_norm is  tensor(51.4432, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.3974, device='cuda:3')
distance x is tensor(152.3974, device='cuda:3')
________________________________
test distance is  tensor(152.3974, device='cuda:3')
test distance1 is  tensor(152.3974, device='cuda:3')
test similarity is  tensor(0.9456, device='cuda:3')
test acc is  0.27000000015633874
test loss is 1.4447288374656808
test entropy is  0.9673718118718438
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.391951322555542
mal norm is  tensor(763.2177, device='cuda:3')
distance x is tensor(152.4056, device='cuda:3')
mal distance is  tensor(152.4056, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 31
weight size is  torch.Size([52, 215370])
norm res is  tensor([546.1915, 585.2366, 547.9533, 503.7499, 442.2117, 561.5804, 515.0374,
        527.8173, 763.2178, 763.2178, 763.2178, 763.2178, 763.2178, 763.2178,
        763.2178, 763.2178, 763.2178, 763.2178, 763.2178, 763.2178, 615.0697,
        603.0138, 619.7930, 661.4037, 661.5170, 624.3247, 654.0743, 682.7654,
        726.0073, 703.5211, 690.9525, 659.2542, 651.1304, 623.5305, 655.2881,
        621.8545, 660.8316, 721.2727, 633.0801, 661.2043, 651.5557, 629.3430,
        681.0286, 648.2214, 672.7184, 617.1752, 635.5314, 628.2496, 564.0716,
        632.4863, 644.6058, 626.7630], device='cuda:3')
sorted_norm is   tensor([442.2117, 503.7499, 515.0374, 527.8173, 546.1915, 547.9533, 561.5804,
        564.0716, 585.2366, 603.0138, 615.0697, 617.1752, 619.7930, 621.8545,
        623.5305, 624.3247, 626.7630, 628.2496, 629.3430, 632.4863, 633.0801,
        635.5314, 644.6058, 648.2214, 651.1304, 651.5557, 654.0743, 655.2881,
        659.2542, 660.8316, 661.2043, 661.4037, 661.5170, 672.7184, 681.0286,
        682.7654, 690.9525, 703.5211, 721.2727, 726.0073, 763.2178, 763.2178,
        763.2178, 763.2178, 763.2178, 763.2178, 763.2178, 763.2178, 763.2178,
        763.2178, 763.2178, 763.2178], device='cuda:3')
used idx is  tensor([ 4,  3,  6,  7,  0,  2,  5, 48,  1, 21, 20, 45, 22, 35, 33, 25, 51, 47,
        41, 49, 38, 46, 50, 43, 32, 40, 26, 34, 31, 36, 39], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 90.43% 

Test Accuracy: 89.43% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5166312456130981
distance x is tensor(98.3763, device='cuda:3')
benign distance is  tensor(98.3763, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7005383372306824
distance x is tensor(104.0111, device='cuda:3')
benign distance is  tensor(104.0111, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3328816294670105
distance x is tensor(124.4723, device='cuda:3')
benign distance is  tensor(124.4723, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.31146547198295593
distance x is tensor(85.6860, device='cuda:3')
benign distance is  tensor(85.6860, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4190792143344879
distance x is tensor(86.0376, device='cuda:3')
benign distance is  tensor(86.0376, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5938908457756042
distance x is tensor(112.3853, device='cuda:3')
benign distance is  tensor(112.3853, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.43830180168151855
distance x is tensor(87.6709, device='cuda:3')
benign distance is  tensor(87.6709, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6580368280410767
distance x is tensor(101.1321, device='cuda:3')
benign distance is  tensor(101.1321, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3219239115715027
distance x is tensor(128.9962, device='cuda:3')
benign distance is  tensor(128.9962, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4611597955226898
distance x is tensor(121.9601, device='cuda:3')
benign distance is  tensor(121.9601, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.14482156932353973
distance x is tensor(116.6901, device='cuda:3')
benign distance is  tensor(116.6901, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5330053567886353
distance x is tensor(134.0622, device='cuda:3')
benign distance is  tensor(134.0622, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6108289361000061
distance x is tensor(126.6304, device='cuda:3')
benign distance is  tensor(126.6304, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.543672502040863
distance x is tensor(126.4728, device='cuda:3')
benign distance is  tensor(126.4728, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.27342909574508667
distance x is tensor(127.2788, device='cuda:3')
benign distance is  tensor(127.2788, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.18101291358470917
distance x is tensor(132.6042, device='cuda:3')
benign distance is  tensor(132.6042, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3256370723247528
distance x is tensor(120.4667, device='cuda:3')
benign distance is  tensor(120.4667, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.4511419534683228
distance x is tensor(146.1315, device='cuda:3')
benign distance is  tensor(146.1315, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4123310148715973
distance x is tensor(122.7946, device='cuda:3')
benign distance is  tensor(122.7946, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4196781516075134
distance x is tensor(132.7168, device='cuda:3')
benign distance is  tensor(132.7168, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5438985824584961
distance x is tensor(140.3521, device='cuda:3')
benign distance is  tensor(140.3521, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.2981128692626953
distance x is tensor(119.1366, device='cuda:3')
benign distance is  tensor(119.1366, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3521574139595032
distance x is tensor(149.3225, device='cuda:3')
benign distance is  tensor(149.3225, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.28460243344306946
distance x is tensor(135.5687, device='cuda:3')
benign distance is  tensor(135.5687, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.25120818614959717
distance x is tensor(140.3735, device='cuda:3')
benign distance is  tensor(140.3735, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.23500926792621613
distance x is tensor(134.1766, device='cuda:3')
benign distance is  tensor(134.1766, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5420238375663757
distance x is tensor(140.4997, device='cuda:3')
benign distance is  tensor(140.4997, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.10491355508565903
distance x is tensor(132.1875, device='cuda:3')
benign distance is  tensor(132.1875, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.350837767124176
distance x is tensor(128.6453, device='cuda:3')
benign distance is  tensor(128.6453, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3715028464794159
distance x is tensor(122.4606, device='cuda:3')
benign distance is  tensor(122.4606, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.275404691696167
distance x is tensor(129.5558, device='cuda:3')
benign distance is  tensor(129.5558, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.36384883522987366
distance x is tensor(126.2749, device='cuda:3')
benign distance is  tensor(126.2749, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.31065425276756287
distance x is tensor(125.4392, device='cuda:3')
benign distance is  tensor(125.4392, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2516871988773346
distance x is tensor(136.1281, device='cuda:3')
benign distance is  tensor(136.1281, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.038256239145994186
distance x is tensor(118.7140, device='cuda:3')
benign distance is  tensor(118.7140, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.1537819802761078
distance x is tensor(145.0588, device='cuda:3')
benign distance is  tensor(145.0588, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2059454619884491
distance x is tensor(133.1668, device='cuda:3')
benign distance is  tensor(133.1668, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5314103364944458
distance x is tensor(136.6984, device='cuda:3')
benign distance is  tensor(136.6984, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0809894800186157
distance x is tensor(131.9039, device='cuda:3')
benign distance is  tensor(131.9039, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6640603542327881
distance x is tensor(138.7473, device='cuda:3')
benign distance is  tensor(138.7473, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(131.6770, device='cuda:3')
compute distance is  tensor(131.6770, device='cuda:3')
compute norm is  tensor(50.5252, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.8251, device='cuda:3')
compute distance is  tensor(123.8251, device='cuda:3')
compute norm is  tensor(50.3654, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6581, device='cuda:3')
compute distance is  tensor(128.6581, device='cuda:3')
compute norm is  tensor(50.5876, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1694, device='cuda:3')
compute distance is  tensor(128.1694, device='cuda:3')
compute norm is  tensor(50.4031, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7396, device='cuda:3')
compute distance is  tensor(123.7396, device='cuda:3')
compute norm is  tensor(50.2868, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2370, device='cuda:3')
compute distance is  tensor(128.2370, device='cuda:3')
compute norm is  tensor(50.5644, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.3734, device='cuda:3')
compute distance is  tensor(118.3734, device='cuda:3')
compute norm is  tensor(50.4137, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1326, device='cuda:3')
compute distance is  tensor(139.1326, device='cuda:3')
compute norm is  tensor(50.5195, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1142, device='cuda:3')
compute distance is  tensor(126.1142, device='cuda:3')
compute norm is  tensor(50.4886, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9967, device='cuda:3')
compute distance is  tensor(134.9967, device='cuda:3')
compute norm is  tensor(50.5436, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5237, device='cuda:3')
compute distance is  tensor(143.5237, device='cuda:3')
compute norm is  tensor(50.8470, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9919, device='cuda:3')
compute distance is  tensor(138.9919, device='cuda:3')
compute norm is  tensor(50.6741, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.5237, device='cuda:3')
distance x is tensor(107694.1953, device='cuda:3')
distance x is tensor(107694.1953, device='cuda:3')
________________________________
test distance is  tensor(107694.1953, device='cuda:3')
test distance1 is  tensor(107694.1953, device='cuda:3')
test similarity is  tensor(0.0412, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130116739635553.7
test entropy is  0.0
________________________________
cal ratio is  0.035775992410533856
distance x is tensor(3852.8723, device='cuda:3')
cal_distance is  tensor(3852.8723, device='cuda:3')
cal ratio is  0.18914528410056575
distance x is tensor(728.7568, device='cuda:3')
cal_distance is  tensor(728.7568, device='cuda:3')
cal ratio is  0.43490713328530634
distance x is tensor(316.9445, device='cuda:3')
cal_distance is  tensor(316.9445, device='cuda:3')
cal ratio is  0.6594718123771909
distance x is tensor(209.0177, device='cuda:3')
cal_distance is  tensor(209.0177, device='cuda:3')
cal ratio is  0.812075275154773
distance x is tensor(169.7391, device='cuda:3')
cal_distance is  tensor(169.7391, device='cuda:3')
cal ratio is  0.9011496149099221
distance x is tensor(152.9608, device='cuda:3')
cal_distance is  tensor(152.9608, device='cuda:3')
cal ratio is  0.9492873545151918
distance x is tensor(145.2041, device='cuda:3')
cal_distance is  tensor(145.2041, device='cuda:3')
cal ratio is  0.9743128660943894
distance x is tensor(141.4743, device='cuda:3')
cal_distance is  tensor(141.4743, device='cuda:3')
distance x is tensor(141.4743, device='cuda:3')
return_distance is  tensor(141.4743, device='cuda:3')
distance x is tensor(141.4640, device='cuda:3')
distance x is tensor(141.4640, device='cuda:3')
________________________________
test distance is  tensor(141.4640, device='cuda:3')
test distance1 is  tensor(141.4640, device='cuda:3')
test similarity is  tensor(0.9504, device='cuda:3')
test acc is  0.10160000015633197
test loss is 276.46698341288294
test entropy is  0.0004844819522598252
________________________________
0
distance x is tensor(141.4640, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0005985625734565741
avg test loss is  275.94179212818267
avg accuracy is  0.43953333348967494
solo acc is  0.1012333334896653
compute similarity  is  tensor(0.9504, device='cuda:3')
compute_distance is  tensor(141.4640, device='cuda:3')
compute_norm is  tensor(50.8364, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(128.9027, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9761002732238282
avg test loss is  1.4724684949876912
avg accuracy is  0.8453166668229901
solo acc is  0.308083333489673
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(128.9027, device='cuda:3')
compute_norm is  tensor(50.4144, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.3177, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.899566204118322
avg test loss is  1.5335631033759127
avg accuracy is  0.8459833334896567
solo acc is  0.2575666668230051
compute similarity  is  tensor(0.9540, device='cuda:3')
compute_distance is  tensor(130.3177, device='cuda:3')
compute_norm is  tensor(50.1508, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.4901, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8969891303256631
avg test loss is  1.4886207771199598
avg accuracy is  0.8505333334896565
solo acc is  0.25381666682300513
compute similarity  is  tensor(0.9538, device='cuda:3')
compute_distance is  tensor(131.4901, device='cuda:3')
compute_norm is  tensor(49.8914, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.6752, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8899912288956551
avg test loss is  1.4618774061518183
avg accuracy is  0.8524500001563232
solo acc is  0.2504000001563382
compute similarity  is  tensor(0.9536, device='cuda:3')
compute_distance is  tensor(132.6752, device='cuda:3')
compute_norm is  tensor(49.6370, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.8617, device='cuda:3')
distance x is tensor(133.8617, device='cuda:3')
________________________________
test distance is  tensor(133.8617, device='cuda:3')
test distance1 is  tensor(133.8617, device='cuda:3')
test similarity is  tensor(0.9533, device='cuda:3')
test acc is  0.25525000015633836
test loss is 1.4321676513025248
test entropy is  0.8786941626305773
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.46244478225708
mal norm is  tensor(678.4073, device='cuda:3')
distance x is tensor(133.8697, device='cuda:3')
mal distance is  tensor(133.8697, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([440.3216, 462.1682, 547.3468, 369.2783, 369.2663, 499.8127, 380.0343,
        456.8459, 678.4073, 678.4073, 678.4073, 678.4073, 678.4073, 678.4073,
        678.4073, 678.4073, 678.4073, 678.4073, 678.4073, 678.4073],
       device='cuda:3')
sorted_norm is   tensor([369.2663, 369.2783, 380.0343, 440.3216, 456.8459, 462.1682, 499.8127,
        547.3468, 678.4073, 678.4073, 678.4073, 678.4073, 678.4073, 678.4073,
        678.4073, 678.4073, 678.4073, 678.4073, 678.4073, 678.4073],
       device='cuda:3')
used idx is  tensor([ 4,  3,  6,  0,  7,  1,  5,  2, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.23% 

Test Accuracy: 88.23% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6840081214904785
distance x is tensor(119.1446, device='cuda:3')
benign distance is  tensor(119.1446, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9484089016914368
distance x is tensor(149.4332, device='cuda:3')
benign distance is  tensor(149.4332, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5388470888137817
distance x is tensor(153.3395, device='cuda:3')
benign distance is  tensor(153.3395, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3488141894340515
distance x is tensor(109.5551, device='cuda:3')
benign distance is  tensor(109.5551, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7081090211868286
distance x is tensor(122.0322, device='cuda:3')
benign distance is  tensor(122.0322, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6260073781013489
distance x is tensor(147.1114, device='cuda:3')
benign distance is  tensor(147.1114, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4556015431880951
distance x is tensor(115.8513, device='cuda:3')
benign distance is  tensor(115.8513, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9203392863273621
distance x is tensor(106.3751, device='cuda:3')
benign distance is  tensor(106.3751, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(152.7316, device='cuda:3')
compute distance is  tensor(152.7316, device='cuda:3')
compute norm is  tensor(50.7907, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9386, device='cuda:3')
compute distance is  tensor(139.9386, device='cuda:3')
compute norm is  tensor(50.6114, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.2322, device='cuda:3')
compute distance is  tensor(153.2322, device='cuda:3')
compute norm is  tensor(50.9858, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.0422, device='cuda:3')
compute distance is  tensor(155.0422, device='cuda:3')
compute norm is  tensor(50.9589, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1796, device='cuda:3')
compute distance is  tensor(149.1796, device='cuda:3')
compute norm is  tensor(50.8913, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.1813, device='cuda:3')
compute distance is  tensor(156.1813, device='cuda:3')
compute norm is  tensor(51.1109, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0873, device='cuda:3')
compute distance is  tensor(145.0873, device='cuda:3')
compute norm is  tensor(50.7401, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.0296, device='cuda:3')
compute distance is  tensor(153.0296, device='cuda:3')
compute norm is  tensor(50.9581, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6474, device='cuda:3')
compute distance is  tensor(146.6474, device='cuda:3')
compute norm is  tensor(50.7485, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7285, device='cuda:3')
compute distance is  tensor(146.7285, device='cuda:3')
compute norm is  tensor(50.8035, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.3914, device='cuda:3')
compute distance is  tensor(166.3914, device='cuda:3')
compute norm is  tensor(51.1913, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2935, device='cuda:3')
compute distance is  tensor(151.2935, device='cuda:3')
compute norm is  tensor(50.9355, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(166.3914, device='cuda:3')
distance x is tensor(107667.3828, device='cuda:3')
distance x is tensor(107667.3828, device='cuda:3')
________________________________
test distance is  tensor(107667.3828, device='cuda:3')
test distance1 is  tensor(107667.3828, device='cuda:3')
test similarity is  tensor(0.1292, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130101585874551.0
test entropy is  0.0
________________________________
cal ratio is  0.03852559698736138
distance x is tensor(4147.9556, device='cuda:3')
cal_distance is  tensor(4147.9556, device='cuda:3')
cal ratio is  0.19627925729506826
distance x is tensor(814.1618, device='cuda:3')
cal_distance is  tensor(814.1618, device='cuda:3')
cal ratio is  0.443033020160758
distance x is tensor(360.7034, device='cuda:3')
cal_distance is  tensor(360.7034, device='cuda:3')
cal ratio is  0.6656046130322251
distance x is tensor(240.0876, device='cuda:3')
cal_distance is  tensor(240.0876, device='cuda:3')
cal ratio is  0.8158430744381239
distance x is tensor(195.8747, device='cuda:3')
cal_distance is  tensor(195.8747, device='cuda:3')
cal ratio is  0.903238107046558
distance x is tensor(176.9220, device='cuda:3')
cal_distance is  tensor(176.9220, device='cuda:3')
cal ratio is  0.9503870252234554
distance x is tensor(168.1447, device='cuda:3')
cal_distance is  tensor(168.1447, device='cuda:3')
cal ratio is  0.9748771770216739
distance x is tensor(163.9206, device='cuda:3')
cal_distance is  tensor(163.9206, device='cuda:3')
distance x is tensor(163.9206, device='cuda:3')
return_distance is  tensor(163.9206, device='cuda:3')
distance x is tensor(163.9103, device='cuda:3')
distance x is tensor(163.9103, device='cuda:3')
________________________________
test distance is  tensor(163.9103, device='cuda:3')
test distance1 is  tensor(163.9103, device='cuda:3')
test similarity is  tensor(0.9405, device='cuda:3')
test acc is  0.10011666682299865
test loss is 453.57354502078056
test entropy is  0.0001622507718840843
________________________________
0
distance x is tensor(163.9103, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.188168687072361e-05
avg test loss is  453.9753402352079
avg accuracy is  0.214600000156337
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9405, device='cuda:3')
compute_distance is  tensor(163.9103, device='cuda:3')
compute_norm is  tensor(52.4093, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.2404, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2059639544883516
avg test loss is  1.8479700187630237
avg accuracy is  0.5878666668230051
solo acc is  0.2145166668230036
compute similarity  is  tensor(0.9413, device='cuda:3')
compute_distance is  tensor(157.2404, device='cuda:3')
compute_norm is  tensor(52.9051, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(158.7509, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6994169083104205
avg test loss is  2.672375891762756
avg accuracy is  0.4795833334896753
solo acc is  0.10985000015633195
compute similarity  is  tensor(0.9410, device='cuda:3')
compute_distance is  tensor(158.7509, device='cuda:3')
compute_norm is  tensor(52.7960, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.1734, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0336476488154072
avg test loss is  1.5957818463412938
avg accuracy is  0.6099500001563368
solo acc is  0.24003333348967124
compute similarity  is  tensor(0.9415, device='cuda:3')
compute_distance is  tensor(159.1734, device='cuda:3')
compute_norm is  tensor(52.4890, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.1010, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6237511105184108
avg test loss is  2.423457057745472
avg accuracy is  0.49300000015634204
solo acc is  0.10908333348966529
compute similarity  is  tensor(0.9412, device='cuda:3')
compute_distance is  tensor(160.1010, device='cuda:3')
compute_norm is  tensor(52.3159, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.5767, device='cuda:3')
distance x is tensor(160.5767, device='cuda:3')
________________________________
test distance is  tensor(160.5767, device='cuda:3')
test distance1 is  tensor(160.5767, device='cuda:3')
test similarity is  tensor(0.9413, device='cuda:3')
test acc is  0.22478333348967072
test loss is 1.5396060483542078
test entropy is  1.0124201691989452
________________________________
0
distance x is tensor(160.5767, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0118441201730577
avg test loss is  1.5373415119612395
avg accuracy is  0.6269500001563355
solo acc is  0.22330000015633733
compute similarity  is  tensor(0.9413, device='cuda:3')
compute_distance is  tensor(160.5767, device='cuda:3')
compute_norm is  tensor(52.0034, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.4199, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.603314292392751
avg test loss is  2.3376374547161274
avg accuracy is  0.5120833334896755
solo acc is  0.10590000015633196
compute similarity  is  tensor(0.9410, device='cuda:3')
compute_distance is  tensor(161.4199, device='cuda:3')
compute_norm is  tensor(51.8210, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.0728, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9575294224438129
avg test loss is  1.4568379235420146
avg accuracy is  0.6487500001563339
solo acc is  0.2475166668230048
compute similarity  is  tensor(0.9410, device='cuda:3')
compute_distance is  tensor(162.0728, device='cuda:3')
compute_norm is  tensor(51.5213, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(162.0728, device='cuda:3')
distance x is tensor(162.0728, device='cuda:3')
________________________________
test distance is  tensor(162.0728, device='cuda:3')
test distance1 is  tensor(162.0728, device='cuda:3')
test similarity is  tensor(0.9410, device='cuda:3')
test acc is  0.24853333348967147
test loss is 1.4542490379896753
test entropy is  0.9589238018750637
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.298383355140686
mal norm is  tensor(799.7932, device='cuda:3')
distance x is tensor(162.0809, device='cuda:3')
mal distance is  tensor(162.0809, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([518.9144, 642.3360, 673.7001, 464.4980, 518.3708, 629.0908, 495.7173,
        446.3877, 799.7932, 799.7932, 799.7932, 799.7932, 799.7932, 799.7932,
        799.7932, 799.7932, 799.7932, 799.7932, 799.7932, 799.7932, 668.6461,
        609.5926, 700.8843, 684.2494, 661.7469, 696.2999, 653.3371, 664.9880,
        620.1958, 591.7217, 570.4823, 647.1241, 607.8218, 621.1721, 631.3992,
        630.8420], device='cuda:3')
sorted_norm is   tensor([446.3877, 464.4980, 495.7173, 518.3708, 518.9144, 570.4823, 591.7217,
        607.8218, 609.5926, 620.1958, 621.1721, 629.0908, 630.8420, 631.3992,
        642.3360, 647.1241, 653.3371, 661.7469, 664.9880, 668.6461, 673.7001,
        684.2494, 696.2999, 700.8843, 799.7932, 799.7932, 799.7932, 799.7932,
        799.7932, 799.7932, 799.7932, 799.7932, 799.7932, 799.7932, 799.7932,
        799.7932], device='cuda:3')
used idx is  tensor([ 7,  3,  6,  4,  0, 30, 29, 32, 21, 28, 33,  5, 35, 34,  1, 31, 26, 24,
        27, 20,  2], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 90.46% 

Test Accuracy: 89.34% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.43614450097084045
distance x is tensor(102.1327, device='cuda:3')
benign distance is  tensor(102.1327, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9160963296890259
distance x is tensor(100.7205, device='cuda:3')
benign distance is  tensor(100.7205, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06877055764198303
distance x is tensor(124.5450, device='cuda:3')
benign distance is  tensor(124.5450, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3090353012084961
distance x is tensor(122.3009, device='cuda:3')
benign distance is  tensor(122.3009, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.132400780916214
distance x is tensor(89.7109, device='cuda:3')
benign distance is  tensor(89.7109, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4186684191226959
distance x is tensor(116.2272, device='cuda:3')
benign distance is  tensor(116.2272, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44141945242881775
distance x is tensor(98.1670, device='cuda:3')
benign distance is  tensor(98.1670, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4941319525241852
distance x is tensor(92.6090, device='cuda:3')
benign distance is  tensor(92.6090, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.18784821033477783
distance x is tensor(134.4679, device='cuda:3')
benign distance is  tensor(134.4679, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2860885262489319
distance x is tensor(133.4226, device='cuda:3')
benign distance is  tensor(133.4226, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.39414453506469727
distance x is tensor(123.7361, device='cuda:3')
benign distance is  tensor(123.7361, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7339679598808289
distance x is tensor(133.0108, device='cuda:3')
benign distance is  tensor(133.0108, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8718002438545227
distance x is tensor(114.2036, device='cuda:3')
benign distance is  tensor(114.2036, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7921454310417175
distance x is tensor(132.6897, device='cuda:3')
benign distance is  tensor(132.6897, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4662014842033386
distance x is tensor(135.4715, device='cuda:3')
benign distance is  tensor(135.4715, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.653904139995575
distance x is tensor(133.6201, device='cuda:3')
benign distance is  tensor(133.6201, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3816961646080017
distance x is tensor(135.4091, device='cuda:3')
benign distance is  tensor(135.4091, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9237238764762878
distance x is tensor(120.2912, device='cuda:3')
benign distance is  tensor(120.2912, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.28837427496910095
distance x is tensor(136.0918, device='cuda:3')
benign distance is  tensor(136.0918, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.419664204120636
distance x is tensor(132.2543, device='cuda:3')
benign distance is  tensor(132.2543, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4828869700431824
distance x is tensor(132.0290, device='cuda:3')
benign distance is  tensor(132.0290, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.55458003282547
distance x is tensor(147.9663, device='cuda:3')
benign distance is  tensor(147.9663, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2932898998260498
distance x is tensor(132.9441, device='cuda:3')
benign distance is  tensor(132.9441, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4000248312950134
distance x is tensor(138.7093, device='cuda:3')
benign distance is  tensor(138.7093, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.4344, device='cuda:3')
compute distance is  tensor(129.4344, device='cuda:3')
compute norm is  tensor(50.9488, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3907, device='cuda:3')
compute distance is  tensor(132.3907, device='cuda:3')
compute norm is  tensor(51.0280, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7997, device='cuda:3')
compute distance is  tensor(135.7997, device='cuda:3')
compute norm is  tensor(51.2087, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.6034, device='cuda:3')
compute distance is  tensor(122.6034, device='cuda:3')
compute norm is  tensor(50.7924, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4700, device='cuda:3')
compute distance is  tensor(144.4700, device='cuda:3')
compute norm is  tensor(51.2160, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1574, device='cuda:3')
compute distance is  tensor(138.1574, device='cuda:3')
compute norm is  tensor(51.1836, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6329, device='cuda:3')
compute distance is  tensor(126.6329, device='cuda:3')
compute norm is  tensor(50.8498, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0512, device='cuda:3')
compute distance is  tensor(141.0512, device='cuda:3')
compute norm is  tensor(51.1155, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8067, device='cuda:3')
compute distance is  tensor(140.8067, device='cuda:3')
compute norm is  tensor(51.2869, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.8827, device='cuda:3')
compute distance is  tensor(136.8827, device='cuda:3')
compute norm is  tensor(51.1324, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.2361, device='cuda:3')
compute distance is  tensor(163.2361, device='cuda:3')
compute norm is  tensor(51.5859, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3406, device='cuda:3')
compute distance is  tensor(139.3406, device='cuda:3')
compute norm is  tensor(51.1932, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(163.2361, device='cuda:3')
distance x is tensor(107690.8359, device='cuda:3')
distance x is tensor(107690.8359, device='cuda:3')
________________________________
test distance is  tensor(107690.8359, device='cuda:3')
test distance1 is  tensor(107690.8359, device='cuda:3')
test similarity is  tensor(0.0569, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130124443785010.77
test entropy is  0.0
________________________________
cal ratio is  0.038154411681275646
distance x is tensor(4108.8862, device='cuda:3')
cal_distance is  tensor(4108.8862, device='cuda:3')
cal ratio is  0.19533141192999914
distance x is tensor(802.5988, device='cuda:3')
cal_distance is  tensor(802.5988, device='cuda:3')
cal ratio is  0.4419619635186558
distance x is tensor(354.7210, device='cuda:3')
cal_distance is  tensor(354.7210, device='cuda:3')
cal ratio is  0.6647994776866308
distance x is tensor(235.8201, device='cuda:3')
cal_distance is  tensor(235.8201, device='cuda:3')
cal ratio is  0.815349413766087
distance x is tensor(192.2767, device='cuda:3')
cal_distance is  tensor(192.2767, device='cuda:3')
cal ratio is  0.9029647217261503
distance x is tensor(173.6196, device='cuda:3')
cal_distance is  tensor(173.6196, device='cuda:3')
cal ratio is  0.9502432390819037
distance x is tensor(164.9811, device='cuda:3')
cal_distance is  tensor(164.9811, device='cuda:3')
cal ratio is  0.9748033931771737
distance x is tensor(160.8243, device='cuda:3')
cal_distance is  tensor(160.8243, device='cuda:3')
distance x is tensor(160.8243, device='cuda:3')
return_distance is  tensor(160.8243, device='cuda:3')
distance x is tensor(160.8140, device='cuda:3')
distance x is tensor(160.8140, device='cuda:3')
________________________________
test distance is  tensor(160.8140, device='cuda:3')
test distance1 is  tensor(160.8140, device='cuda:3')
test similarity is  tensor(0.9395, device='cuda:3')
test acc is  0.1005833334896653
test loss is 434.21222193866396
test entropy is  0.00032135757948512864
________________________________
0
distance x is tensor(160.8140, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00019956299128937198
avg test loss is  433.72337464940574
avg accuracy is  0.32320000015634
solo acc is  0.10065000015633196
compute similarity  is  tensor(0.9395, device='cuda:3')
compute_distance is  tensor(160.8140, device='cuda:3')
compute_norm is  tensor(52.0019, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.2004, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2269543546603432
avg test loss is  1.877204503077688
avg accuracy is  0.6578166668229999
solo acc is  0.20128333348966973
compute similarity  is  tensor(0.9397, device='cuda:3')
compute_distance is  tensor(157.2004, device='cuda:3')
compute_norm is  tensor(52.5177, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.1103, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.707507917494662
avg test loss is  2.7068095585938963
avg accuracy is  0.5916333334896716
solo acc is  0.10883333348966528
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(159.1103, device='cuda:3')
compute_norm is  tensor(52.3973, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.7523, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0699692153727323
avg test loss is  1.690220123542143
avg accuracy is  0.6857166668229981
solo acc is  0.2200500001563373
compute similarity  is  tensor(0.9393, device='cuda:3')
compute_distance is  tensor(160.7523, device='cuda:3')
compute_norm is  tensor(52.1142, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.1351, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6483275738479232
avg test loss is  2.497788798834469
avg accuracy is  0.6236500001563358
solo acc is  0.10868333348966529
compute similarity  is  tensor(0.9387, device='cuda:3')
compute_distance is  tensor(162.1351, device='cuda:3')
compute_norm is  tensor(51.9491, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.4241, device='cuda:3')
distance x is tensor(163.4241, device='cuda:3')
________________________________
test distance is  tensor(163.4241, device='cuda:3')
test distance1 is  tensor(163.4241, device='cuda:3')
test similarity is  tensor(0.9387, device='cuda:3')
test acc is  0.2612166668230053
test loss is 1.5317843469983734
test entropy is  0.9912425611319065
________________________________
cal ratio is  0.9794360105551764
distance x is tensor(160.0698, device='cuda:3')
cal_distance is  tensor(160.0698, device='cuda:3')
distance x is tensor(160.0698, device='cuda:3')
return_distance is  tensor(160.0698, device='cuda:3')
distance x is tensor(160.0634, device='cuda:3')
distance x is tensor(160.0634, device='cuda:3')
________________________________
test distance is  tensor(160.0634, device='cuda:3')
test distance1 is  tensor(160.0634, device='cuda:3')
test similarity is  tensor(0.9410, device='cuda:3')
test acc is  0.265583333489672
test loss is 1.503306255284657
test entropy is  1.0235575050560397
________________________________
0
distance x is tensor(160.0634, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0211797826198628
avg test loss is  1.499874877141737
avg accuracy is  0.7386166668229952
solo acc is  0.2674000001563387
compute similarity  is  tensor(0.9410, device='cuda:3')
compute_distance is  tensor(160.0634, device='cuda:3')
compute_norm is  tensor(51.5523, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.3427, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6155125493688116
avg test loss is  2.3819414749582695
avg accuracy is  0.6885833334896647
solo acc is  0.10820000015633195
compute similarity  is  tensor(0.9404, device='cuda:3')
compute_distance is  tensor(161.3427, device='cuda:3')
compute_norm is  tensor(51.3790, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.3338, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9557141457666466
avg test loss is  1.4627059868403844
avg accuracy is  0.752683333489661
solo acc is  0.24875000015633816
compute similarity  is  tensor(0.9404, device='cuda:3')
compute_distance is  tensor(162.3338, device='cuda:3')
compute_norm is  tensor(51.0832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(162.3338, device='cuda:3')
distance x is tensor(162.3338, device='cuda:3')
________________________________
test distance is  tensor(162.3338, device='cuda:3')
test distance1 is  tensor(162.3338, device='cuda:3')
test similarity is  tensor(0.9404, device='cuda:3')
test acc is  0.25165000015633837
test loss is 1.468926124989605
test entropy is  0.9568023607929124
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4126167297363281
mal norm is  tensor(786.2928, device='cuda:3')
distance x is tensor(162.3401, device='cuda:3')
mal distance is  tensor(162.3401, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([458.1460, 443.1236, 545.9144, 536.5021, 387.5536, 514.0839, 423.0925,
        406.9792, 786.2928, 786.2928, 786.2928, 786.2928, 786.2928, 786.2928,
        786.2928, 786.2928, 786.2928, 786.2928, 786.2928, 786.2928, 547.2095,
        652.9030, 566.1188, 611.9141, 640.1735, 533.6854, 668.0650, 600.7518],
       device='cuda:3')
sorted_norm is   tensor([387.5536, 406.9792, 423.0925, 443.1236, 458.1460, 514.0839, 533.6854,
        536.5021, 545.9144, 547.2095, 566.1188, 600.7518, 611.9141, 640.1735,
        652.9030, 668.0650, 786.2928, 786.2928, 786.2928, 786.2928, 786.2928,
        786.2928, 786.2928, 786.2928, 786.2928, 786.2928, 786.2928, 786.2928],
       device='cuda:3')
used idx is  tensor([ 4,  7,  6,  1,  0,  5, 25,  3,  2, 20, 22, 27, 23, 24, 21, 26],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 90.20% 

Test Accuracy: 89.57% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.536400556564331
distance x is tensor(97.6383, device='cuda:3')
benign distance is  tensor(97.6383, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7273901700973511
distance x is tensor(114.6665, device='cuda:3')
benign distance is  tensor(114.6665, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4626597762107849
distance x is tensor(124.5319, device='cuda:3')
benign distance is  tensor(124.5319, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5850581526756287
distance x is tensor(100.9650, device='cuda:3')
benign distance is  tensor(100.9650, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.50068199634552
distance x is tensor(97.9454, device='cuda:3')
benign distance is  tensor(97.9454, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6522569060325623
distance x is tensor(113.0560, device='cuda:3')
benign distance is  tensor(113.0560, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8175700902938843
distance x is tensor(106.6734, device='cuda:3')
benign distance is  tensor(106.6734, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.33867818117141724
distance x is tensor(119.0210, device='cuda:3')
benign distance is  tensor(119.0210, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.11131620407104492
distance x is tensor(144.5967, device='cuda:3')
benign distance is  tensor(144.5967, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.556092381477356
distance x is tensor(149.9696, device='cuda:3')
benign distance is  tensor(149.9696, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.18469364941120148
distance x is tensor(122.1883, device='cuda:3')
benign distance is  tensor(122.1883, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.348808228969574
distance x is tensor(131.7938, device='cuda:3')
benign distance is  tensor(131.7938, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3662112355232239
distance x is tensor(129.7663, device='cuda:3')
benign distance is  tensor(129.7663, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4128643870353699
distance x is tensor(119.5096, device='cuda:3')
benign distance is  tensor(119.5096, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.649867057800293
distance x is tensor(133.2692, device='cuda:3')
benign distance is  tensor(133.2692, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6048668622970581
distance x is tensor(128.4518, device='cuda:3')
benign distance is  tensor(128.4518, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(149.0272, device='cuda:3')
compute distance is  tensor(149.0272, device='cuda:3')
compute norm is  tensor(51.5247, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7782, device='cuda:3')
compute distance is  tensor(136.7782, device='cuda:3')
compute norm is  tensor(51.2715, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5305, device='cuda:3')
compute distance is  tensor(135.5305, device='cuda:3')
compute norm is  tensor(51.4040, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4699, device='cuda:3')
compute distance is  tensor(134.4699, device='cuda:3')
compute norm is  tensor(51.3265, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0315, device='cuda:3')
compute distance is  tensor(142.0315, device='cuda:3')
compute norm is  tensor(51.3958, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5891, device='cuda:3')
compute distance is  tensor(144.5891, device='cuda:3')
compute norm is  tensor(51.5974, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.4267, device='cuda:3')
compute distance is  tensor(133.4267, device='cuda:3')
compute norm is  tensor(51.4237, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.0651, device='cuda:3')
compute distance is  tensor(157.0651, device='cuda:3')
compute norm is  tensor(51.7595, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.8672, device='cuda:3')
compute distance is  tensor(141.8672, device='cuda:3')
compute norm is  tensor(51.4623, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4203, device='cuda:3')
compute distance is  tensor(126.4203, device='cuda:3')
compute norm is  tensor(51.2532, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5843, device='cuda:3')
compute distance is  tensor(134.5843, device='cuda:3')
compute norm is  tensor(51.4785, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.9686, device='cuda:3')
compute distance is  tensor(148.9686, device='cuda:3')
compute norm is  tensor(51.5817, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.0651, device='cuda:3')
distance x is tensor(107696.1875, device='cuda:3')
distance x is tensor(107696.1875, device='cuda:3')
________________________________
test distance is  tensor(107696.1875, device='cuda:3')
test distance1 is  tensor(107696.1875, device='cuda:3')
test similarity is  tensor(0.0421, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130103932949833.69
test entropy is  0.0
________________________________
cal ratio is  0.037425336192404936
distance x is tensor(4030.5715, device='cuda:3')
cal_distance is  tensor(4030.5715, device='cuda:3')
cal ratio is  0.1934561612813954
distance x is tensor(779.7430, device='cuda:3')
cal_distance is  tensor(779.7430, device='cuda:3')
cal ratio is  0.4398353552957329
distance x is tensor(342.9615, device='cuda:3')
cal_distance is  tensor(342.9615, device='cuda:3')
cal ratio is  0.6631979920396127
distance x is tensor(227.4531, device='cuda:3')
cal_distance is  tensor(227.4531, device='cuda:3')
cal ratio is  0.8143666072421772
distance x is tensor(185.2312, device='cuda:3')
cal_distance is  tensor(185.2312, device='cuda:3')
cal ratio is  0.9024202717094851
distance x is tensor(167.1569, device='cuda:3')
cal_distance is  tensor(167.1569, device='cuda:3')
cal ratio is  0.9499565656671113
distance x is tensor(158.7920, device='cuda:3')
cal_distance is  tensor(158.7920, device='cuda:3')
cal ratio is  0.9746563960595114
distance x is tensor(154.7678, device='cuda:3')
cal_distance is  tensor(154.7678, device='cuda:3')
distance x is tensor(154.7678, device='cuda:3')
return_distance is  tensor(154.7678, device='cuda:3')
distance x is tensor(154.7575, device='cuda:3')
distance x is tensor(154.7575, device='cuda:3')
________________________________
test distance is  tensor(154.7575, device='cuda:3')
test distance1 is  tensor(154.7575, device='cuda:3')
test similarity is  tensor(0.9433, device='cuda:3')
test acc is  0.10105000015633196
test loss is 387.9988022989302
test entropy is  0.0004381015110175982
________________________________
0
distance x is tensor(154.7575, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0004632338515390077
avg test loss is  388.9591052415274
avg accuracy is  0.33983333348967354
solo acc is  0.1012833334896653
compute similarity  is  tensor(0.9433, device='cuda:3')
compute_distance is  tensor(154.7575, device='cuda:3')
compute_norm is  tensor(51.9298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.1539, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0923840499508863
avg test loss is  1.6399529314498658
avg accuracy is  0.77678333348966
solo acc is  0.26925000015633876
compute similarity  is  tensor(0.9452, device='cuda:3')
compute_distance is  tensor(149.1539, device='cuda:3')
compute_norm is  tensor(52.0633, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.2030, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6380921768100023
avg test loss is  2.5262370878445313
avg accuracy is  0.7488833334896613
solo acc is  0.11740000015633192
compute similarity  is  tensor(0.9447, device='cuda:3')
compute_distance is  tensor(151.2030, device='cuda:3')
compute_norm is  tensor(51.8718, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.1617, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9817265448158484
avg test loss is  1.515558054960613
avg accuracy is  0.796233333489659
solo acc is  0.2659000001563387
compute similarity  is  tensor(0.9448, device='cuda:3')
compute_distance is  tensor(152.1617, device='cuda:3')
compute_norm is  tensor(51.5757, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.1617, device='cuda:3')
distance x is tensor(152.1617, device='cuda:3')
________________________________
test distance is  tensor(152.1617, device='cuda:3')
test distance1 is  tensor(152.1617, device='cuda:3')
test similarity is  tensor(0.9448, device='cuda:3')
test acc is  0.266883333489672
test loss is 1.5110528579652944
test entropy is  0.9821390414924256
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.234932780265808
mal norm is  tensor(765.0367, device='cuda:3')
distance x is tensor(152.1684, device='cuda:3')
mal distance is  tensor(152.1684, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([428.3197, 493.9202, 531.8773, 452.1904, 407.9699, 503.2916, 463.3860,
        528.1707, 765.0367, 765.0367, 765.0367, 765.0367, 765.0367, 765.0367,
        765.0367, 765.0367, 765.0367, 765.0367, 765.0367, 765.0367, 598.7391,
        605.3607, 551.0413, 611.6187, 531.9013, 598.5438, 615.8815, 600.2982],
       device='cuda:3')
sorted_norm is   tensor([407.9699, 428.3197, 452.1904, 463.3860, 493.9202, 503.2916, 528.1707,
        531.8773, 531.9013, 551.0413, 598.5438, 598.7391, 600.2982, 605.3607,
        611.6187, 615.8815, 765.0367, 765.0367, 765.0367, 765.0367, 765.0367,
        765.0367, 765.0367, 765.0367, 765.0367, 765.0367, 765.0367, 765.0367],
       device='cuda:3')
used idx is  tensor([ 4,  0,  3,  6,  1,  5,  7,  2, 24, 22, 25, 20, 27, 21, 23, 26],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 90.39% 

Test Accuracy: 89.37% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.14167702198028564
distance x is tensor(109.7873, device='cuda:3')
benign distance is  tensor(109.7873, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2840273380279541
distance x is tensor(101.7877, device='cuda:3')
benign distance is  tensor(101.7877, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16467638313770294
distance x is tensor(127.3501, device='cuda:3')
benign distance is  tensor(127.3501, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8560971021652222
distance x is tensor(110.6358, device='cuda:3')
benign distance is  tensor(110.6358, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5281170606613159
distance x is tensor(118.2686, device='cuda:3')
benign distance is  tensor(118.2686, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.713408350944519
distance x is tensor(115.0681, device='cuda:3')
benign distance is  tensor(115.0681, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3750112056732178
distance x is tensor(91.1196, device='cuda:3')
benign distance is  tensor(91.1196, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24700817465782166
distance x is tensor(106.0968, device='cuda:3')
benign distance is  tensor(106.0968, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.036199670284986496
distance x is tensor(141.2982, device='cuda:3')
benign distance is  tensor(141.2982, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5623682141304016
distance x is tensor(132.8209, device='cuda:3')
benign distance is  tensor(132.8209, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.34773561358451843
distance x is tensor(125.1491, device='cuda:3')
benign distance is  tensor(125.1491, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7692991495132446
distance x is tensor(139.4841, device='cuda:3')
benign distance is  tensor(139.4841, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5717708468437195
distance x is tensor(123.5661, device='cuda:3')
benign distance is  tensor(123.5661, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4073867201805115
distance x is tensor(133.0523, device='cuda:3')
benign distance is  tensor(133.0523, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.537958025932312
distance x is tensor(129.7156, device='cuda:3')
benign distance is  tensor(129.7156, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5833929181098938
distance x is tensor(137.6366, device='cuda:3')
benign distance is  tensor(137.6366, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(132.9878, device='cuda:3')
compute distance is  tensor(132.9878, device='cuda:3')
compute norm is  tensor(51.5884, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7924, device='cuda:3')
compute distance is  tensor(136.7924, device='cuda:3')
compute norm is  tensor(51.7466, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.9004, device='cuda:3')
compute distance is  tensor(140.9004, device='cuda:3')
compute norm is  tensor(51.9247, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2202, device='cuda:3')
compute distance is  tensor(124.2202, device='cuda:3')
compute norm is  tensor(51.5099, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9362, device='cuda:3')
compute distance is  tensor(144.9362, device='cuda:3')
compute norm is  tensor(51.8981, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.5016, device='cuda:3')
compute distance is  tensor(138.5016, device='cuda:3')
compute norm is  tensor(51.8784, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2166, device='cuda:3')
compute distance is  tensor(132.2166, device='cuda:3')
compute norm is  tensor(51.8243, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.6128, device='cuda:3')
compute distance is  tensor(142.6128, device='cuda:3')
compute norm is  tensor(51.7902, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.2126, device='cuda:3')
compute distance is  tensor(150.2126, device='cuda:3')
compute norm is  tensor(52.0694, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1978, device='cuda:3')
compute distance is  tensor(139.1978, device='cuda:3')
compute norm is  tensor(52.0359, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.8103, device='cuda:3')
compute distance is  tensor(142.8103, device='cuda:3')
compute norm is  tensor(51.8651, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2095, device='cuda:3')
compute distance is  tensor(141.2095, device='cuda:3')
compute norm is  tensor(51.7764, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(150.2126, device='cuda:3')
distance x is tensor(107697.4062, device='cuda:3')
distance x is tensor(107697.4062, device='cuda:3')
________________________________
test distance is  tensor(107697.4062, device='cuda:3')
test distance1 is  tensor(107697.4062, device='cuda:3')
test similarity is  tensor(0.0435, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130063184159645.75
test entropy is  0.0
________________________________
cal ratio is  0.03659962147957249
distance x is tensor(3941.6897, device='cuda:3')
cal_distance is  tensor(3941.6897, device='cuda:3')
cal ratio is  0.19131013955878692
distance x is tensor(754.0894, device='cuda:3')
cal_distance is  tensor(754.0894, device='cuda:3')
cal ratio is  0.43738893396117917
distance x is tensor(329.8332, device='cuda:3')
cal_distance is  tensor(329.8332, device='cuda:3')
cal ratio is  0.6613510078486521
distance x is tensor(218.1373, device='cuda:3')
cal_distance is  tensor(218.1373, device='cuda:3')
cal ratio is  0.8132315326338813
distance x is tensor(177.3971, device='cuda:3')
cal_distance is  tensor(177.3971, device='cuda:3')
cal ratio is  0.9017910071483393
distance x is tensor(159.9757, device='cuda:3')
cal_distance is  tensor(159.9757, device='cuda:3')
cal ratio is  0.9496252591473084
distance x is tensor(151.9172, device='cuda:3')
cal_distance is  tensor(151.9172, device='cuda:3')
cal ratio is  0.9744863497647559
distance x is tensor(148.0414, device='cuda:3')
cal_distance is  tensor(148.0414, device='cuda:3')
distance x is tensor(148.0414, device='cuda:3')
return_distance is  tensor(148.0414, device='cuda:3')
distance x is tensor(148.0310, device='cuda:3')
distance x is tensor(148.0310, device='cuda:3')
________________________________
test distance is  tensor(148.0310, device='cuda:3')
test distance1 is  tensor(148.0310, device='cuda:3')
test similarity is  tensor(0.9486, device='cuda:3')
test acc is  0.1020833334896653
test loss is 315.92674421298227
test entropy is  0.0008902501962159185
________________________________
0
distance x is tensor(148.0310, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0006843501528394454
avg test loss is  315.8652979153306
avg accuracy is  0.42536666682300805
solo acc is  0.10210000015633197
compute similarity  is  tensor(0.9486, device='cuda:3')
compute_distance is  tensor(148.0310, device='cuda:3')
compute_norm is  tensor(52.1793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.0376, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0096048320026032
avg test loss is  1.5349263477681288
avg accuracy is  0.8280000001563242
solo acc is  0.2876333334896726
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(137.0376, device='cuda:3')
compute_norm is  tensor(51.9413, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.4843, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9327146326428029
avg test loss is  1.564464392438372
avg accuracy is  0.8277500001563242
solo acc is  0.24816666682300484
compute similarity  is  tensor(0.9517, device='cuda:3')
compute_distance is  tensor(138.4843, device='cuda:3')
compute_norm is  tensor(51.6809, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.6573, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9077639703049081
avg test loss is  1.5229770503064464
avg accuracy is  0.8326333334896573
solo acc is  0.2496000001563383
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(139.6573, device='cuda:3')
compute_norm is  tensor(51.4220, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.8202, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9032461353456542
avg test loss is  1.494215705755677
avg accuracy is  0.8347833334896572
solo acc is  0.2449000001563381
compute similarity  is  tensor(0.9514, device='cuda:3')
compute_distance is  tensor(140.8202, device='cuda:3')
compute_norm is  tensor(51.1665, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.0160, device='cuda:3')
distance x is tensor(142.0160, device='cuda:3')
________________________________
test distance is  tensor(142.0160, device='cuda:3')
test distance1 is  tensor(142.0160, device='cuda:3')
test similarity is  tensor(0.9512, device='cuda:3')
test acc is  0.24483333348967135
test loss is 1.473321768139471
test entropy is  0.8870452930296916
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4480048418045044
mal norm is  tensor(713.8287, device='cuda:3')
distance x is tensor(142.0234, device='cuda:3')
mal distance is  tensor(142.0234, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([472.0344, 451.0823, 556.2983, 476.3133, 514.3770, 511.9880, 385.6936,
        463.6930, 713.8287, 713.8287, 713.8287, 713.8287, 713.8287, 713.8287,
        713.8287, 713.8287, 713.8287, 713.8287, 713.8287, 713.8287, 634.2198,
        614.7849, 650.3377, 596.0764, 596.6261, 561.0259, 594.8816, 577.1948],
       device='cuda:3')
sorted_norm is   tensor([385.6936, 451.0823, 463.6930, 472.0344, 476.3133, 511.9880, 514.3770,
        556.2983, 561.0259, 577.1948, 594.8816, 596.0764, 596.6261, 614.7849,
        634.2198, 650.3377, 713.8287, 713.8287, 713.8287, 713.8287, 713.8287,
        713.8287, 713.8287, 713.8287, 713.8287, 713.8287, 713.8287, 713.8287],
       device='cuda:3')
used idx is  tensor([ 6,  1,  7,  0,  3,  5,  4,  2, 25, 27, 26, 23, 24, 21, 20, 22],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 90.28% 

Test Accuracy: 89.37% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7075768709182739
distance x is tensor(89.4294, device='cuda:3')
benign distance is  tensor(89.4294, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4960278868675232
distance x is tensor(95.6786, device='cuda:3')
benign distance is  tensor(95.6786, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38150426745414734
distance x is tensor(121.5301, device='cuda:3')
benign distance is  tensor(121.5301, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6605210304260254
distance x is tensor(94.0366, device='cuda:3')
benign distance is  tensor(94.0366, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6237347722053528
distance x is tensor(95.8351, device='cuda:3')
benign distance is  tensor(95.8351, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3327895700931549
distance x is tensor(109.9356, device='cuda:3')
benign distance is  tensor(109.9356, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.057570524513721466
distance x is tensor(92.8956, device='cuda:3')
benign distance is  tensor(92.8956, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1340661346912384
distance x is tensor(122.5275, device='cuda:3')
benign distance is  tensor(122.5275, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.29192906618118286
distance x is tensor(141.2197, device='cuda:3')
benign distance is  tensor(141.2197, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3410692811012268
distance x is tensor(134.9405, device='cuda:3')
benign distance is  tensor(134.9405, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.23140358924865723
distance x is tensor(145.4469, device='cuda:3')
benign distance is  tensor(145.4469, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.75445556640625
distance x is tensor(123.0186, device='cuda:3')
benign distance is  tensor(123.0186, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.22191140055656433
distance x is tensor(127.0425, device='cuda:3')
benign distance is  tensor(127.0425, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7934061884880066
distance x is tensor(128.7789, device='cuda:3')
benign distance is  tensor(128.7789, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5405983924865723
distance x is tensor(130.8003, device='cuda:3')
benign distance is  tensor(130.8003, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3626231253147125
distance x is tensor(133.4304, device='cuda:3')
benign distance is  tensor(133.4304, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(128.0735, device='cuda:3')
compute distance is  tensor(128.0735, device='cuda:3')
compute norm is  tensor(51.3439, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5587, device='cuda:3')
compute distance is  tensor(126.5587, device='cuda:3')
compute norm is  tensor(51.4255, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1092, device='cuda:3')
compute distance is  tensor(136.1092, device='cuda:3')
compute norm is  tensor(51.7499, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1558, device='cuda:3')
compute distance is  tensor(124.1558, device='cuda:3')
compute norm is  tensor(51.2925, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4128, device='cuda:3')
compute distance is  tensor(128.4128, device='cuda:3')
compute norm is  tensor(51.3818, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2242, device='cuda:3')
compute distance is  tensor(140.2242, device='cuda:3')
compute norm is  tensor(51.7198, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0360, device='cuda:3')
compute distance is  tensor(126.0360, device='cuda:3')
compute norm is  tensor(51.4672, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.1119, device='cuda:3')
compute distance is  tensor(140.1119, device='cuda:3')
compute norm is  tensor(51.6605, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.6216, device='cuda:3')
compute distance is  tensor(136.6216, device='cuda:3')
compute norm is  tensor(51.5496, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2505, device='cuda:3')
compute distance is  tensor(125.2505, device='cuda:3')
compute norm is  tensor(51.4598, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7426, device='cuda:3')
compute distance is  tensor(140.7426, device='cuda:3')
compute norm is  tensor(51.6451, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0380, device='cuda:3')
compute distance is  tensor(144.0380, device='cuda:3')
compute norm is  tensor(51.8498, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.0380, device='cuda:3')
distance x is tensor(107698.5391, device='cuda:3')
distance x is tensor(107698.5391, device='cuda:3')
________________________________
test distance is  tensor(107698.5391, device='cuda:3')
test distance1 is  tensor(107698.5391, device='cuda:3')
test similarity is  tensor(0.0370, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130096433185501.61
test entropy is  0.0
________________________________
cal ratio is  0.035839312815826294
distance x is tensor(3859.8472, device='cuda:3')
cal_distance is  tensor(3859.8472, device='cuda:3')
cal ratio is  0.18931260240016168
distance x is tensor(730.7220, device='cuda:3')
cal_distance is  tensor(730.7220, device='cuda:3')
cal ratio is  0.43509941018183373
distance x is tensor(317.9396, device='cuda:3')
cal_distance is  tensor(317.9396, device='cuda:3')
cal ratio is  0.6596176474238976
distance x is tensor(209.7204, device='cuda:3')
cal_distance is  tensor(209.7204, device='cuda:3')
cal ratio is  0.8121650409565444
distance x is tensor(170.3285, device='cuda:3')
cal_distance is  tensor(170.3285, device='cuda:3')
cal ratio is  0.9011994160650693
distance x is tensor(153.5005, device='cuda:3')
cal_distance is  tensor(153.5005, device='cuda:3')
cal ratio is  0.9493136459952453
distance x is tensor(145.7204, device='cuda:3')
cal_distance is  tensor(145.7204, device='cuda:3')
cal ratio is  0.9743263205553103
distance x is tensor(141.9793, device='cuda:3')
cal_distance is  tensor(141.9793, device='cuda:3')
distance x is tensor(141.9793, device='cuda:3')
return_distance is  tensor(141.9793, device='cuda:3')
distance x is tensor(141.9690, device='cuda:3')
distance x is tensor(141.9690, device='cuda:3')
________________________________
test distance is  tensor(141.9690, device='cuda:3')
test distance1 is  tensor(141.9690, device='cuda:3')
test similarity is  tensor(0.9519, device='cuda:3')
test acc is  0.10155000015633196
test loss is 279.69559626792795
test entropy is  0.0006107061449583462
________________________________
0
distance x is tensor(141.9690, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0007263104498251386
avg test loss is  280.0056076863173
avg accuracy is  0.46780000015634177
solo acc is  0.1019333334896653
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(141.9690, device='cuda:3')
compute_norm is  tensor(51.8192, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(129.9528, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9671661535432852
avg test loss is  1.4659311906106944
avg accuracy is  0.8478833334896567
solo acc is  0.3112000001563397
compute similarity  is  tensor(0.9555, device='cuda:3')
compute_distance is  tensor(129.9528, device='cuda:3')
compute_norm is  tensor(51.3638, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.5638, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9135434695525464
avg test loss is  1.5163752232024919
avg accuracy is  0.8503833334896567
solo acc is  0.26030000015633853
compute similarity  is  tensor(0.9552, device='cuda:3')
compute_distance is  tensor(131.5638, device='cuda:3')
compute_norm is  tensor(51.0879, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.8959, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8940710614103753
avg test loss is  1.4860832132001929
avg accuracy is  0.8515500001563232
solo acc is  0.2596500001563385
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(132.8959, device='cuda:3')
compute_norm is  tensor(50.8207, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.2393, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8800625264771712
avg test loss is  1.4804845062146055
avg accuracy is  0.8526000001563232
solo acc is  0.24491666682300473
compute similarity  is  tensor(0.9548, device='cuda:3')
compute_distance is  tensor(134.2393, device='cuda:3')
compute_norm is  tensor(50.5596, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.4722, device='cuda:3')
distance x is tensor(135.4722, device='cuda:3')
________________________________
test distance is  tensor(135.4722, device='cuda:3')
test distance1 is  tensor(135.4722, device='cuda:3')
test similarity is  tensor(0.9546, device='cuda:3')
test acc is  0.2517500001563383
test loss is 1.4441449154160424
test entropy is  0.8798332460272287
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3303849697113037
mal norm is  tensor(682.0139, device='cuda:3')
distance x is tensor(135.4798, device='cuda:3')
mal distance is  tensor(135.4798, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 31
weight size is  torch.Size([52, 215370])
norm res is  tensor([387.9855, 426.6835, 527.2328, 408.5296, 411.3544, 489.2101, 397.3300,
        538.0541, 682.0139, 682.0139, 682.0139, 682.0139, 682.0139, 682.0139,
        682.0139, 682.0139, 682.0139, 682.0139, 682.0139, 682.0139, 573.0886,
        609.7751, 548.2465, 646.7200, 602.9929, 608.7876, 588.4823, 634.7261,
        631.0621, 551.3560, 627.4921, 594.7045, 599.8920, 670.7642, 614.4302,
        634.9063, 657.6597, 675.2728, 565.8584, 620.5225, 602.9800, 561.5721,
        611.4390, 583.4445, 646.2168, 594.2697, 574.3819, 617.1140, 575.7577,
        618.7758, 606.2206, 636.3076], device='cuda:3')
sorted_norm is   tensor([387.9855, 397.3300, 408.5296, 411.3544, 426.6835, 489.2101, 527.2328,
        538.0541, 548.2465, 551.3560, 561.5721, 565.8584, 573.0886, 574.3819,
        575.7577, 583.4445, 588.4823, 594.2697, 594.7045, 599.8920, 602.9800,
        602.9929, 606.2206, 608.7876, 609.7751, 611.4390, 614.4302, 617.1140,
        618.7758, 620.5225, 627.4921, 631.0621, 634.7261, 634.9063, 636.3076,
        646.2168, 646.7200, 657.6597, 670.7642, 675.2728, 682.0139, 682.0139,
        682.0139, 682.0139, 682.0139, 682.0139, 682.0139, 682.0139, 682.0139,
        682.0139, 682.0139, 682.0139], device='cuda:3')
used idx is  tensor([ 0,  6,  3,  4,  1,  5,  2,  7, 22, 29, 41, 38, 20, 46, 48, 43, 26, 45,
        31, 32, 40, 24, 50, 25, 21, 42, 34, 47, 49, 39, 30], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 90.57% 

Test Accuracy: 89.60% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45345503091812134
distance x is tensor(92.0072, device='cuda:3')
benign distance is  tensor(92.0072, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.30708980560302734
distance x is tensor(96.0838, device='cuda:3')
benign distance is  tensor(96.0838, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25303640961647034
distance x is tensor(119.7426, device='cuda:3')
benign distance is  tensor(119.7426, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40972137451171875
distance x is tensor(97.7317, device='cuda:3')
benign distance is  tensor(97.7317, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.36943957209587097
distance x is tensor(106.7369, device='cuda:3')
benign distance is  tensor(106.7369, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2168095111846924
distance x is tensor(105.3072, device='cuda:3')
benign distance is  tensor(105.3072, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7962437868118286
distance x is tensor(101.3546, device='cuda:3')
benign distance is  tensor(101.3546, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3613048493862152
distance x is tensor(109.7399, device='cuda:3')
benign distance is  tensor(109.7399, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7146458029747009
distance x is tensor(141.6516, device='cuda:3')
benign distance is  tensor(141.6516, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1072601079940796
distance x is tensor(121.5135, device='cuda:3')
benign distance is  tensor(121.5135, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8805935978889465
distance x is tensor(134.3863, device='cuda:3')
benign distance is  tensor(134.3863, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5460666418075562
distance x is tensor(140.4402, device='cuda:3')
benign distance is  tensor(140.4402, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7589781284332275
distance x is tensor(119.0443, device='cuda:3')
benign distance is  tensor(119.0443, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6597059369087219
distance x is tensor(130.6354, device='cuda:3')
benign distance is  tensor(130.6354, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4747108519077301
distance x is tensor(129.4615, device='cuda:3')
benign distance is  tensor(129.4615, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.15282902121543884
distance x is tensor(129.1121, device='cuda:3')
benign distance is  tensor(129.1121, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4220665395259857
distance x is tensor(123.1211, device='cuda:3')
benign distance is  tensor(123.1211, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.35509318113327026
distance x is tensor(146.6442, device='cuda:3')
benign distance is  tensor(146.6442, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2830080986022949
distance x is tensor(128.9120, device='cuda:3')
benign distance is  tensor(128.9120, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.39375972747802734
distance x is tensor(131.7110, device='cuda:3')
benign distance is  tensor(131.7110, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.18917803466320038
distance x is tensor(131.3298, device='cuda:3')
benign distance is  tensor(131.3298, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5223793983459473
distance x is tensor(123.4844, device='cuda:3')
benign distance is  tensor(123.4844, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.17860324680805206
distance x is tensor(145.6611, device='cuda:3')
benign distance is  tensor(145.6611, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3734734058380127
distance x is tensor(128.2720, device='cuda:3')
benign distance is  tensor(128.2720, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2348335236310959
distance x is tensor(142.6591, device='cuda:3')
benign distance is  tensor(142.6591, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6669069528579712
distance x is tensor(127.8708, device='cuda:3')
benign distance is  tensor(127.8708, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.35941067337989807
distance x is tensor(150.8459, device='cuda:3')
benign distance is  tensor(150.8459, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.33924245834350586
distance x is tensor(141.9576, device='cuda:3')
benign distance is  tensor(141.9576, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5996342897415161
distance x is tensor(133.8070, device='cuda:3')
benign distance is  tensor(133.8070, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.31844526529312134
distance x is tensor(131.4802, device='cuda:3')
benign distance is  tensor(131.4802, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6685757637023926
distance x is tensor(130.3320, device='cuda:3')
benign distance is  tensor(130.3320, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.337414413690567
distance x is tensor(133.6954, device='cuda:3')
benign distance is  tensor(133.6954, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.477910578250885
distance x is tensor(135.6435, device='cuda:3')
benign distance is  tensor(135.6435, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.382228821516037
distance x is tensor(126.2769, device='cuda:3')
benign distance is  tensor(126.2769, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.14761868119239807
distance x is tensor(125.9514, device='cuda:3')
benign distance is  tensor(125.9514, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3334827125072479
distance x is tensor(140.5433, device='cuda:3')
benign distance is  tensor(140.5433, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3456076979637146
distance x is tensor(124.3161, device='cuda:3')
benign distance is  tensor(124.3161, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3266240656375885
distance x is tensor(129.0116, device='cuda:3')
benign distance is  tensor(129.0116, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7110137939453125
distance x is tensor(129.5528, device='cuda:3')
benign distance is  tensor(129.5528, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6634330749511719
distance x is tensor(138.2792, device='cuda:3')
benign distance is  tensor(138.2792, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(122.4869, device='cuda:3')
compute distance is  tensor(122.4869, device='cuda:3')
compute norm is  tensor(51.4640, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5661, device='cuda:3')
compute distance is  tensor(133.5661, device='cuda:3')
compute norm is  tensor(51.6103, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9760, device='cuda:3')
compute distance is  tensor(126.9760, device='cuda:3')
compute norm is  tensor(51.6380, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7394, device='cuda:3')
compute distance is  tensor(125.7394, device='cuda:3')
compute norm is  tensor(51.6327, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9882, device='cuda:3')
compute distance is  tensor(126.9882, device='cuda:3')
compute norm is  tensor(51.4874, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9838, device='cuda:3')
compute distance is  tensor(134.9838, device='cuda:3')
compute norm is  tensor(51.7555, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.0931, device='cuda:3')
compute distance is  tensor(125.0931, device='cuda:3')
compute norm is  tensor(51.5799, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3320, device='cuda:3')
compute distance is  tensor(129.3320, device='cuda:3')
compute norm is  tensor(51.6601, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6123, device='cuda:3')
compute distance is  tensor(134.6123, device='cuda:3')
compute norm is  tensor(51.8603, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2500, device='cuda:3')
compute distance is  tensor(125.2500, device='cuda:3')
compute norm is  tensor(51.6188, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4485, device='cuda:3')
compute distance is  tensor(132.4485, device='cuda:3')
compute norm is  tensor(51.6609, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2841, device='cuda:3')
compute distance is  tensor(126.2841, device='cuda:3')
compute norm is  tensor(51.5460, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(134.9838, device='cuda:3')
distance x is tensor(107699.4688, device='cuda:3')
distance x is tensor(107699.4688, device='cuda:3')
________________________________
test distance is  tensor(107699.4688, device='cuda:3')
test distance1 is  tensor(107699.4688, device='cuda:3')
test similarity is  tensor(0.0368, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130092526177911.0
test entropy is  0.0
________________________________
cal ratio is  0.034694459820101345
distance x is tensor(3736.5808, device='cuda:3')
cal_distance is  tensor(3736.5808, device='cuda:3')
cal ratio is  0.18626434873747372
distance x is tensor(695.9960, device='cuda:3')
cal_distance is  tensor(695.9960, device='cuda:3')
cal ratio is  0.43158223249996364
distance x is tensor(300.3824, device='cuda:3')
cal_distance is  tensor(300.3824, device='cuda:3')
cal ratio is  0.6569459482037558
distance x is tensor(197.3368, device='cuda:3')
cal_distance is  tensor(197.3368, device='cuda:3')
cal ratio is  0.8105183199860003
distance x is tensor(159.9461, device='cuda:3')
cal_distance is  tensor(159.9461, device='cuda:3')
cal ratio is  0.9002850563900775
distance x is tensor(143.9976, device='cuda:3')
cal_distance is  tensor(143.9976, device='cuda:3')
cal ratio is  0.9488319018725768
distance x is tensor(136.6298, device='cuda:3')
cal_distance is  tensor(136.6298, device='cuda:3')
cal ratio is  0.974078969672407
distance x is tensor(133.0883, device='cuda:3')
cal_distance is  tensor(133.0883, device='cuda:3')
distance x is tensor(133.0883, device='cuda:3')
return_distance is  tensor(133.0883, device='cuda:3')
distance x is tensor(133.0780, device='cuda:3')
distance x is tensor(133.0780, device='cuda:3')
________________________________
test distance is  tensor(133.0780, device='cuda:3')
test distance1 is  tensor(133.0780, device='cuda:3')
test similarity is  tensor(0.9574, device='cuda:3')
test acc is  0.10470000015633195
test loss is 209.254146209912
test entropy is  0.0018087018409247053
________________________________
0
distance x is tensor(133.0780, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0015841149486511491
avg test loss is  209.4827435946922
avg accuracy is  0.5666166668230072
solo acc is  0.10515000015633197
compute similarity  is  tensor(0.9574, device='cuda:3')
compute_distance is  tensor(133.0780, device='cuda:3')
compute_norm is  tensor(51.7171, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(122.3880, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9445690104702135
avg test loss is  1.4156677837310823
avg accuracy is  0.8583000001563229
solo acc is  0.32333333348967336
compute similarity  is  tensor(0.9603, device='cuda:3')
compute_distance is  tensor(122.3880, device='cuda:3')
compute_norm is  tensor(51.1458, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.3413, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8886132369290537
avg test loss is  1.5005653543767137
avg accuracy is  0.8571000001563229
solo acc is  0.2675833334896721
compute similarity  is  tensor(0.9599, device='cuda:3')
compute_distance is  tensor(124.3413, device='cuda:3')
compute_norm is  tensor(50.8580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.9071, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8671606238335688
avg test loss is  1.485265766760942
avg accuracy is  0.8598333334896562
solo acc is  0.2574166668230051
compute similarity  is  tensor(0.9597, device='cuda:3')
compute_distance is  tensor(125.9071, device='cuda:3')
compute_norm is  tensor(50.5851, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.4223, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8677123324322039
avg test loss is  1.450281092861314
avg accuracy is  0.8619666668229894
solo acc is  0.2601333334896719
compute similarity  is  tensor(0.9594, device='cuda:3')
compute_distance is  tensor(127.4223, device='cuda:3')
compute_norm is  tensor(50.3212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.8724, device='cuda:3')
distance x is tensor(128.8724, device='cuda:3')
________________________________
test distance is  tensor(128.8724, device='cuda:3')
test distance1 is  tensor(128.8724, device='cuda:3')
test similarity is  tensor(0.9592, device='cuda:3')
test acc is  0.2539500001563384
test loss is 1.4292625970423602
test entropy is  0.8619448256009677
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1818684339523315
mal norm is  tensor(644.4229, device='cuda:3')
distance x is tensor(128.8796, device='cuda:3')
mal distance is  tensor(128.8796, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([405.2353, 431.9822, 513.6248, 432.3235, 458.0704, 462.1656, 432.6804,
        483.6963, 644.4229, 644.4229, 644.4229, 644.4229, 644.4229, 644.4229,
        644.4229, 644.4229, 644.4229, 644.4229, 644.4229, 644.4229],
       device='cuda:3')
sorted_norm is   tensor([405.2353, 431.9822, 432.3235, 432.6804, 458.0704, 462.1656, 483.6963,
        513.6248, 644.4229, 644.4229, 644.4229, 644.4229, 644.4229, 644.4229,
        644.4229, 644.4229, 644.4229, 644.4229, 644.4229, 644.4229],
       device='cuda:3')
used idx is  tensor([ 0,  1,  3,  6,  4,  5,  7,  2, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 89.38% 

Test Accuracy: 88.55% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5773978233337402
distance x is tensor(105.7878, device='cuda:3')
benign distance is  tensor(105.7878, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8433494567871094
distance x is tensor(118.1811, device='cuda:3')
benign distance is  tensor(118.1811, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07592013478279114
distance x is tensor(130.0777, device='cuda:3')
benign distance is  tensor(130.0777, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6358140707015991
distance x is tensor(117.2217, device='cuda:3')
benign distance is  tensor(117.2217, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.18277111649513245
distance x is tensor(113.3268, device='cuda:3')
benign distance is  tensor(113.3268, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4090745449066162
distance x is tensor(129.3907, device='cuda:3')
benign distance is  tensor(129.3907, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.47524088621139526
distance x is tensor(144.9773, device='cuda:3')
benign distance is  tensor(144.9773, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1425914466381073
distance x is tensor(121.7974, device='cuda:3')
benign distance is  tensor(121.7974, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(151.0439, device='cuda:3')
compute distance is  tensor(151.0439, device='cuda:3')
compute norm is  tensor(51.8928, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0169, device='cuda:3')
compute distance is  tensor(139.0169, device='cuda:3')
compute norm is  tensor(51.5238, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.8101, device='cuda:3')
compute distance is  tensor(143.8101, device='cuda:3')
compute norm is  tensor(51.9209, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.4919, device='cuda:3')
compute distance is  tensor(138.4919, device='cuda:3')
compute norm is  tensor(51.5644, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.2966, device='cuda:3')
compute distance is  tensor(176.2966, device='cuda:3')
compute norm is  tensor(52.3845, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.1102, device='cuda:3')
compute distance is  tensor(164.1102, device='cuda:3')
compute norm is  tensor(52.2504, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1473, device='cuda:3')
compute distance is  tensor(135.1473, device='cuda:3')
compute norm is  tensor(51.6006, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.7651, device='cuda:3')
compute distance is  tensor(155.7651, device='cuda:3')
compute norm is  tensor(52.0532, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.6209, device='cuda:3')
compute distance is  tensor(143.6209, device='cuda:3')
compute norm is  tensor(51.7166, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.9235, device='cuda:3')
compute distance is  tensor(149.9235, device='cuda:3')
compute norm is  tensor(51.8811, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.4212, device='cuda:3')
compute distance is  tensor(155.4212, device='cuda:3')
compute norm is  tensor(52.0897, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.0317, device='cuda:3')
compute distance is  tensor(136.0317, device='cuda:3')
compute norm is  tensor(51.5333, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(176.2966, device='cuda:3')
distance x is tensor(107673.8594, device='cuda:3')
distance x is tensor(107673.8594, device='cuda:3')
________________________________
test distance is  tensor(107673.8594, device='cuda:3')
test distance1 is  tensor(107673.8594, device='cuda:3')
test similarity is  tensor(0.1189, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130084603897816.7
test entropy is  0.0
________________________________
cal ratio is  0.03965454223513032
distance x is tensor(4269.7632, device='cuda:3')
cal_distance is  tensor(4269.7632, device='cuda:3')
cal ratio is  0.19913435244418462
distance x is tensor(850.2606, device='cuda:3')
cal_distance is  tensor(850.2606, device='cuda:3')
cal ratio is  0.4462436740557764
distance x is tensor(379.4263, device='cuda:3')
cal_distance is  tensor(379.4263, device='cuda:3')
cal ratio is  0.6680121828827084
distance x is tensor(253.4631, device='cuda:3')
cal_distance is  tensor(253.4631, device='cuda:3')
cal ratio is  0.8173173647038081
distance x is tensor(207.1607, device='cuda:3')
cal_distance is  tensor(207.1607, device='cuda:3')
cal ratio is  0.9040539678150553
distance x is tensor(187.2850, device='cuda:3')
cal_distance is  tensor(187.2850, device='cuda:3')
cal ratio is  0.9508162062024894
distance x is tensor(178.0739, device='cuda:3')
cal_distance is  tensor(178.0739, device='cuda:3')
cal ratio is  0.975097320932513
distance x is tensor(173.6395, device='cuda:3')
cal_distance is  tensor(173.6395, device='cuda:3')
distance x is tensor(173.6395, device='cuda:3')
return_distance is  tensor(173.6395, device='cuda:3')
distance x is tensor(173.6292, device='cuda:3')
distance x is tensor(173.6292, device='cuda:3')
________________________________
test distance is  tensor(173.6292, device='cuda:3')
test distance1 is  tensor(173.6292, device='cuda:3')
test similarity is  tensor(0.9359, device='cuda:3')
test acc is  0.10011666682299865
test loss is 606.5339031748172
test entropy is  2.385387233742531e-05
________________________________
0
distance x is tensor(173.6292, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.723501530602071e-05
avg test loss is  608.0425224385536
avg accuracy is  0.18063333348966865
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9359, device='cuda:3')
compute_distance is  tensor(173.6292, device='cuda:3')
compute_norm is  tensor(53.5954, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.4836, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3765140970124365
avg test loss is  2.1905904733804245
avg accuracy is  0.5185000001563422
solo acc is  0.1569666668230004
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(170.4836, device='cuda:3')
compute_norm is  tensor(54.5803, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(172.1190, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7815586452418045
avg test loss is  3.0189268050163287
avg accuracy is  0.41223333348967456
solo acc is  0.10461666682299864
compute similarity  is  tensor(0.9325, device='cuda:3')
compute_distance is  tensor(172.1190, device='cuda:3')
compute_norm is  tensor(54.5544, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.7163, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1693337536824029
avg test loss is  2.090616352014196
avg accuracy is  0.5673000001563402
solo acc is  0.1612333334896674
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(172.7163, device='cuda:3')
compute_norm is  tensor(54.1942, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(173.8277, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7055665116701553
avg test loss is  2.800388222055903
avg accuracy is  0.4789000001563419
solo acc is  0.10526666682299864
compute similarity  is  tensor(0.9327, device='cuda:3')
compute_distance is  tensor(173.8277, device='cuda:3')
compute_norm is  tensor(54.1076, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(174.5172, device='cuda:3')
distance x is tensor(174.5172, device='cuda:3')
________________________________
test distance is  tensor(174.5172, device='cuda:3')
test distance1 is  tensor(174.5172, device='cuda:3')
test similarity is  tensor(0.9332, device='cuda:3')
test acc is  0.20473333348966993
test loss is 1.7486546141252335
test entropy is  1.0733524825273038
________________________________
0
distance x is tensor(174.5172, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.071836023188349
avg test loss is  1.7494978517103297
avg accuracy is  0.6047333334896705
solo acc is  0.20598333348967
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(174.5172, device='cuda:3')
compute_norm is  tensor(53.7549, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(175.4913, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6603229487501482
avg test loss is  2.5175416032388522
avg accuracy is  0.5004666668230088
solo acc is  0.10623333348966528
compute similarity  is  tensor(0.9328, device='cuda:3')
compute_distance is  tensor(175.4913, device='cuda:3')
compute_norm is  tensor(53.6204, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.2895, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0295498353331836
avg test loss is  1.6132077869575923
avg accuracy is  0.6290333334896687
solo acc is  0.21520000015633703
compute similarity  is  tensor(0.9330, device='cuda:3')
compute_distance is  tensor(176.2895, device='cuda:3')
compute_norm is  tensor(53.2731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.1220, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6304062264306205
avg test loss is  2.4052082237912646
avg accuracy is  0.5257333334896755
solo acc is  0.10461666682299864
compute similarity  is  tensor(0.9325, device='cuda:3')
compute_distance is  tensor(177.1220, device='cuda:3')
compute_norm is  tensor(53.1159, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.9340, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9800860079875124
avg test loss is  1.5031710924116024
avg accuracy is  0.6542666668230002
solo acc is  0.24583333348967146
compute similarity  is  tensor(0.9326, device='cuda:3')
compute_distance is  tensor(177.9340, device='cuda:3')
compute_norm is  tensor(52.7846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(177.9340, device='cuda:3')
distance x is tensor(177.9340, device='cuda:3')
________________________________
test distance is  tensor(177.9340, device='cuda:3')
test distance1 is  tensor(177.9340, device='cuda:3')
test similarity is  tensor(0.9326, device='cuda:3')
test acc is  0.24930000015633832
test loss is 1.4991066497780368
test entropy is  0.9799016266743511
________________________________
cal ratio is  0.9754805386937061
distance x is tensor(173.5781, device='cuda:3')
cal_distance is  tensor(173.5781, device='cuda:3')
distance x is tensor(173.5781, device='cuda:3')
return_distance is  tensor(173.5781, device='cuda:3')
distance x is tensor(173.5711, device='cuda:3')
distance x is tensor(173.5711, device='cuda:3')
________________________________
test distance is  tensor(173.5711, device='cuda:3')
test distance1 is  tensor(173.5711, device='cuda:3')
test similarity is  tensor(0.9355, device='cuda:3')
test acc is  0.25638333348967174
test loss is 1.4697639728660015
test entropy is  1.0099517961682032
________________________________
0
distance x is tensor(173.5711, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.009219525211147
avg test loss is  1.4728858306972203
avg accuracy is  0.6698833334896659
solo acc is  0.2542333334896717
compute similarity  is  tensor(0.9355, device='cuda:3')
compute_distance is  tensor(173.5711, device='cuda:3')
compute_norm is  tensor(52.6436, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(174.4894, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6139759432786563
avg test loss is  2.3245125118094974
avg accuracy is  0.5641000001563407
solo acc is  0.1050333334896653
compute similarity  is  tensor(0.9351, device='cuda:3')
compute_distance is  tensor(174.4894, device='cuda:3')
compute_norm is  tensor(52.4859, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(175.3661, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9679865049782084
avg test loss is  1.4656938334772074
avg accuracy is  0.6789333334896653
solo acc is  0.24073333348967135
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(175.3661, device='cuda:3')
compute_norm is  tensor(52.1798, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(175.3731, device='cuda:3')
________________________________
test distance is  tensor(175.3731, device='cuda:3')
test similarity is  tensor(0.9350, device='cuda:3')
test acc is  0.6800000001563319
test loss is 1.4704209283979208
test entropy is  0.9667549853894248
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2933284044265747
mal norm is  tensor(843.2742, device='cuda:3')
distance x is tensor(175.3731, device='cuda:3')
mal distance is  tensor(175.3731, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([460.4083, 522.7584, 551.9426, 506.2105, 486.6283, 562.5556, 613.0719,
        533.1457, 843.2742, 843.2743, 843.2742, 843.2743, 843.2742, 843.2743,
        843.2742, 843.2743, 843.2742, 843.2743, 843.2742, 843.2743, 672.1479,
        587.9053, 627.5261, 661.3445, 566.1605, 622.8373, 627.3578, 614.2155],
       device='cuda:3')
sorted_norm is   tensor([460.4083, 486.6283, 506.2105, 522.7584, 533.1457, 551.9426, 562.5556,
        566.1605, 587.9053, 613.0719, 614.2155, 622.8373, 627.3578, 627.5261,
        661.3445, 672.1479, 843.2742, 843.2742, 843.2742, 843.2742, 843.2742,
        843.2742, 843.2743, 843.2743, 843.2743, 843.2743, 843.2743, 843.2743],
       device='cuda:3')
used idx is  tensor([ 0,  4,  3,  1,  7,  2,  5, 24, 21,  6, 27, 25, 26, 22, 23, 20],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 90.40% 

Test Accuracy: 89.17% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.15886887907981873
distance x is tensor(93.3682, device='cuda:3')
benign distance is  tensor(93.3682, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46540316939353943
distance x is tensor(121.5707, device='cuda:3')
benign distance is  tensor(121.5707, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13550731539726257
distance x is tensor(102.3192, device='cuda:3')
benign distance is  tensor(102.3192, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6179331541061401
distance x is tensor(102.2325, device='cuda:3')
benign distance is  tensor(102.2325, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8336144685745239
distance x is tensor(92.3796, device='cuda:3')
benign distance is  tensor(92.3796, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.743380606174469
distance x is tensor(112.1809, device='cuda:3')
benign distance is  tensor(112.1809, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.14177758991718292
distance x is tensor(99.6032, device='cuda:3')
benign distance is  tensor(99.6032, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7020280957221985
distance x is tensor(111.6079, device='cuda:3')
benign distance is  tensor(111.6079, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.24652285873889923
distance x is tensor(124.3260, device='cuda:3')
benign distance is  tensor(124.3260, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.099228858947754
distance x is tensor(125.9697, device='cuda:3')
benign distance is  tensor(125.9697, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.17347818613052368
distance x is tensor(123.9729, device='cuda:3')
benign distance is  tensor(123.9729, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8129734992980957
distance x is tensor(133.9250, device='cuda:3')
benign distance is  tensor(133.9250, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4982616901397705
distance x is tensor(123.8188, device='cuda:3')
benign distance is  tensor(123.8188, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1574314683675766
distance x is tensor(130.9886, device='cuda:3')
benign distance is  tensor(130.9886, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.37915390729904175
distance x is tensor(126.7828, device='cuda:3')
benign distance is  tensor(126.7828, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1096900701522827
distance x is tensor(128.8768, device='cuda:3')
benign distance is  tensor(128.8768, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.2519, device='cuda:3')
compute distance is  tensor(137.2519, device='cuda:3')
compute norm is  tensor(52.1133, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.0932, device='cuda:3')
compute distance is  tensor(146.0932, device='cuda:3')
compute norm is  tensor(52.3600, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1939, device='cuda:3')
compute distance is  tensor(132.1939, device='cuda:3')
compute norm is  tensor(52.3403, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6593, device='cuda:3')
compute distance is  tensor(137.6593, device='cuda:3')
compute norm is  tensor(52.1825, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.7515, device='cuda:3')
compute distance is  tensor(139.7515, device='cuda:3')
compute norm is  tensor(52.1831, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8940, device='cuda:3')
compute distance is  tensor(145.8940, device='cuda:3')
compute norm is  tensor(52.3441, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3575, device='cuda:3')
compute distance is  tensor(137.3575, device='cuda:3')
compute norm is  tensor(52.2756, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8750, device='cuda:3')
compute distance is  tensor(128.8750, device='cuda:3')
compute norm is  tensor(52.0399, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.7812, device='cuda:3')
compute distance is  tensor(143.7812, device='cuda:3')
compute norm is  tensor(52.2879, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3022, device='cuda:3')
compute distance is  tensor(136.3022, device='cuda:3')
compute norm is  tensor(52.2895, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.8881, device='cuda:3')
compute distance is  tensor(144.8881, device='cuda:3')
compute norm is  tensor(52.3431, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.0039, device='cuda:3')
compute distance is  tensor(153.0039, device='cuda:3')
compute norm is  tensor(52.3594, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.0039, device='cuda:3')
distance x is tensor(107694.1172, device='cuda:3')
distance x is tensor(107694.1172, device='cuda:3')
________________________________
test distance is  tensor(107694.1172, device='cuda:3')
test distance1 is  tensor(107694.1172, device='cuda:3')
test similarity is  tensor(0.0628, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130122409243506.08
test entropy is  0.0
________________________________
cal ratio is  0.036938681763900326
distance x is tensor(3978.0842, device='cuda:3')
cal_distance is  tensor(3978.0842, device='cuda:3')
cal ratio is  0.19219425347720515
distance x is tensor(764.5691, device='cuda:3')
cal_distance is  tensor(764.5691, device='cuda:3')
cal ratio is  0.43839845285667994
distance x is tensor(335.1888, device='cuda:3')
cal_distance is  tensor(335.1888, device='cuda:3')
cal ratio is  0.6621137808774121
distance x is tensor(221.9349, device='cuda:3')
cal_distance is  tensor(221.9349, device='cuda:3')
cal ratio is  0.8137005192059167
distance x is tensor(180.5895, device='cuda:3')
cal_distance is  tensor(180.5895, device='cuda:3')
cal ratio is  0.902051072622287
distance x is tensor(162.9015, device='cuda:3')
cal_distance is  tensor(162.9015, device='cuda:3')
cal ratio is  0.9497621774261803
distance x is tensor(154.7179, device='cuda:3')
cal_distance is  tensor(154.7179, device='cuda:3')
cal ratio is  0.9745565745512941
distance x is tensor(150.7815, device='cuda:3')
cal_distance is  tensor(150.7815, device='cuda:3')
distance x is tensor(150.7815, device='cuda:3')
return_distance is  tensor(150.7815, device='cuda:3')
distance x is tensor(150.7712, device='cuda:3')
distance x is tensor(150.7712, device='cuda:3')
________________________________
test distance is  tensor(150.7712, device='cuda:3')
test distance1 is  tensor(150.7712, device='cuda:3')
test similarity is  tensor(0.9486, device='cuda:3')
test acc is  0.1023833334896653
test loss is 324.6177527909594
test entropy is  0.0007425254008111809
________________________________
0
distance x is tensor(150.7712, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0007016217061283395
avg test loss is  325.8121735627717
avg accuracy is  0.4518166668230083
solo acc is  0.10210000015633197
compute similarity  is  tensor(0.9486, device='cuda:3')
compute_distance is  tensor(150.7712, device='cuda:3')
compute_norm is  tensor(52.9036, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.2722, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.05917597935398
avg test loss is  1.5893197116821305
avg accuracy is  0.8122500001563249
solo acc is  0.27193333348967214
compute similarity  is  tensor(0.9512, device='cuda:3')
compute_distance is  tensor(141.2722, device='cuda:3')
compute_norm is  tensor(52.8756, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.6724, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9701477368630326
avg test loss is  1.6373600443797325
avg accuracy is  0.8165666668229914
solo acc is  0.2283333334896709
compute similarity  is  tensor(0.9511, device='cuda:3')
compute_distance is  tensor(142.6724, device='cuda:3')
compute_norm is  tensor(52.6271, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.6101, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9426414435987533
avg test loss is  1.5772977513290927
avg accuracy is  0.8223500001563244
solo acc is  0.23326666682300431
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(143.6101, device='cuda:3')
compute_norm is  tensor(52.3755, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.6093, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9211136794039435
avg test loss is  1.522159349435428
avg accuracy is  0.8288500001563242
solo acc is  0.2410666668230046
compute similarity  is  tensor(0.9508, device='cuda:3')
compute_distance is  tensor(144.6093, device='cuda:3')
compute_norm is  tensor(52.1246, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.6237, device='cuda:3')
distance x is tensor(145.6237, device='cuda:3')
________________________________
test distance is  tensor(145.6237, device='cuda:3')
test distance1 is  tensor(145.6237, device='cuda:3')
test similarity is  tensor(0.9507, device='cuda:3')
test acc is  0.23178333348967095
test loss is 1.503948112540662
test entropy is  0.9115376243713313
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3220031261444092
mal norm is  tensor(731.3440, device='cuda:3')
distance x is tensor(145.6311, device='cuda:3')
mal distance is  tensor(145.6311, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([421.3408, 524.7596, 441.9775, 442.0782, 403.9044, 495.6574, 428.8230,
        488.1048, 731.3440, 731.3441, 731.3440, 731.3441, 731.3440, 731.3441,
        731.3440, 731.3441, 731.3440, 731.3441, 731.3440, 731.3441, 563.6304,
        664.7448, 586.6608, 621.1644, 600.9772, 563.3071, 663.1580, 580.4062],
       device='cuda:3')
sorted_norm is   tensor([403.9044, 421.3408, 428.8230, 441.9775, 442.0782, 488.1048, 495.6574,
        524.7596, 563.3071, 563.6304, 580.4062, 586.6608, 600.9772, 621.1644,
        663.1580, 664.7448, 731.3440, 731.3440, 731.3440, 731.3440, 731.3440,
        731.3440, 731.3441, 731.3441, 731.3441, 731.3441, 731.3441, 731.3441],
       device='cuda:3')
used idx is  tensor([ 4,  0,  6,  2,  3,  7,  5,  1, 25, 20, 27, 22, 24, 23, 26, 21],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 90.45% 

Test Accuracy: 89.70% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7072098851203918
distance x is tensor(99.9625, device='cuda:3')
benign distance is  tensor(99.9625, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7745307683944702
distance x is tensor(105.3532, device='cuda:3')
benign distance is  tensor(105.3532, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3485925495624542
distance x is tensor(131.7870, device='cuda:3')
benign distance is  tensor(131.7870, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3898058235645294
distance x is tensor(80.3996, device='cuda:3')
benign distance is  tensor(80.3996, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3910396099090576
distance x is tensor(93.6842, device='cuda:3')
benign distance is  tensor(93.6842, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7849808931350708
distance x is tensor(104.1183, device='cuda:3')
benign distance is  tensor(104.1183, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4942375719547272
distance x is tensor(97.6341, device='cuda:3')
benign distance is  tensor(97.6341, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.27134791016578674
distance x is tensor(106.7290, device='cuda:3')
benign distance is  tensor(106.7290, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.17642101645469666
distance x is tensor(126.9370, device='cuda:3')
benign distance is  tensor(126.9370, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.23557324707508087
distance x is tensor(143.4077, device='cuda:3')
benign distance is  tensor(143.4077, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5949373841285706
distance x is tensor(116.1521, device='cuda:3')
benign distance is  tensor(116.1521, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.14077666401863098
distance x is tensor(121.5950, device='cuda:3')
benign distance is  tensor(121.5950, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3393837511539459
distance x is tensor(122.6800, device='cuda:3')
benign distance is  tensor(122.6800, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6368715167045593
distance x is tensor(147.8306, device='cuda:3')
benign distance is  tensor(147.8306, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3309853971004486
distance x is tensor(129.7215, device='cuda:3')
benign distance is  tensor(129.7215, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4730857014656067
distance x is tensor(135.7129, device='cuda:3')
benign distance is  tensor(135.7129, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.8334, device='cuda:3')
compute distance is  tensor(137.8334, device='cuda:3')
compute norm is  tensor(52.3648, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7769, device='cuda:3')
compute distance is  tensor(126.7769, device='cuda:3')
compute norm is  tensor(52.1519, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.8396, device='cuda:3')
compute distance is  tensor(136.8396, device='cuda:3')
compute norm is  tensor(52.4239, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2629, device='cuda:3')
compute distance is  tensor(140.2629, device='cuda:3')
compute norm is  tensor(52.4935, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4098, device='cuda:3')
compute distance is  tensor(147.4098, device='cuda:3')
compute norm is  tensor(52.5543, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.0387, device='cuda:3')
compute distance is  tensor(140.0387, device='cuda:3')
compute norm is  tensor(52.5181, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7301, device='cuda:3')
compute distance is  tensor(131.7301, device='cuda:3')
compute norm is  tensor(52.4181, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5561, device='cuda:3')
compute distance is  tensor(148.5561, device='cuda:3')
compute norm is  tensor(52.6099, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8019, device='cuda:3')
compute distance is  tensor(139.8019, device='cuda:3')
compute norm is  tensor(52.5815, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2697, device='cuda:3')
compute distance is  tensor(139.2697, device='cuda:3')
compute norm is  tensor(52.4714, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5114, device='cuda:3')
compute distance is  tensor(141.5114, device='cuda:3')
compute norm is  tensor(52.5113, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5119, device='cuda:3')
compute distance is  tensor(141.5119, device='cuda:3')
compute norm is  tensor(52.5889, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(148.5561, device='cuda:3')
distance x is tensor(107700.3828, device='cuda:3')
distance x is tensor(107700.3828, device='cuda:3')
________________________________
test distance is  tensor(107700.3828, device='cuda:3')
test distance1 is  tensor(107700.3828, device='cuda:3')
test similarity is  tensor(0.0434, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130079834929453.31
test entropy is  0.0
________________________________
cal ratio is  0.03639676143271089
distance x is tensor(3919.9509, device='cuda:3')
cal_distance is  tensor(3919.9509, device='cuda:3')
cal ratio is  0.19077921796383557
distance x is tensor(747.8493, device='cuda:3')
cal_distance is  tensor(747.8493, device='cuda:3')
cal ratio is  0.43678158497406894
distance x is tensor(326.6497, device='cuda:3')
cal_distance is  tensor(326.6497, device='cuda:3')
cal ratio is  0.6608915572465268
distance x is tensor(215.8818, device='cuda:3')
cal_distance is  tensor(215.8818, device='cuda:3')
cal ratio is  0.8129490390890393
distance x is tensor(175.5019, device='cuda:3')
cal_distance is  tensor(175.5019, device='cuda:3')
cal ratio is  0.901634423942188
distance x is tensor(158.2391, device='cuda:3')
cal_distance is  tensor(158.2391, device='cuda:3')
cal ratio is  0.949542761100935
distance x is tensor(150.2550, device='cuda:3')
cal_distance is  tensor(150.2550, device='cuda:3')
cal ratio is  0.974443995104913
distance x is tensor(146.4152, device='cuda:3')
cal_distance is  tensor(146.4152, device='cuda:3')
distance x is tensor(146.4152, device='cuda:3')
return_distance is  tensor(146.4152, device='cuda:3')
distance x is tensor(146.4049, device='cuda:3')
distance x is tensor(146.4049, device='cuda:3')
________________________________
test distance is  tensor(146.4049, device='cuda:3')
test distance1 is  tensor(146.4049, device='cuda:3')
test similarity is  tensor(0.9508, device='cuda:3')
test acc is  0.10325000015633197
test loss is 289.4782741684904
test entropy is  0.0009993940410889714
________________________________
0
distance x is tensor(146.4049, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0009601473307217381
avg test loss is  289.49286791510673
avg accuracy is  0.49360000015634203
solo acc is  0.10321666682299864
compute similarity  is  tensor(0.9508, device='cuda:3')
compute_distance is  tensor(146.4049, device='cuda:3')
compute_norm is  tensor(52.7818, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(134.8518, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9985732075883381
avg test loss is  1.5325631279426852
avg accuracy is  0.8385000001563238
solo acc is  0.2934500001563394
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(134.8518, device='cuda:3')
compute_norm is  tensor(52.4867, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.1219, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9304987946425928
avg test loss is  1.563953899625522
avg accuracy is  0.8441500001563235
solo acc is  0.24828333348967152
compute similarity  is  tensor(0.9540, device='cuda:3')
compute_distance is  tensor(136.1219, device='cuda:3')
compute_norm is  tensor(52.2270, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.1947, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9057025601868944
avg test loss is  1.507888802841528
avg accuracy is  0.84766666682299
solo acc is  0.25070000015633825
compute similarity  is  tensor(0.9539, device='cuda:3')
compute_distance is  tensor(137.1947, device='cuda:3')
compute_norm is  tensor(51.9667, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.3708, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8980254985249119
avg test loss is  1.4733055189474304
avg accuracy is  0.8488000001563232
solo acc is  0.25233333348967163
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(138.3708, device='cuda:3')
compute_norm is  tensor(51.7091, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.5803, device='cuda:3')
distance x is tensor(139.5803, device='cuda:3')
________________________________
test distance is  tensor(139.5803, device='cuda:3')
test distance1 is  tensor(139.5803, device='cuda:3')
test similarity is  tensor(0.9535, device='cuda:3')
test acc is  0.24271666682300466
test loss is 1.4594260640998384
test entropy is  0.882277764999536
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.425207495689392
mal norm is  tensor(704.9202, device='cuda:3')
distance x is tensor(139.5880, device='cuda:3')
mal distance is  tensor(139.5880, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 26
weight size is  torch.Size([44, 215370])
norm res is  tensor([429.0309, 462.9889, 574.6981, 348.1221, 406.0349, 456.5439, 415.5989,
        465.4003, 704.9202, 704.9202, 704.9202, 704.9202, 704.9202, 704.9202,
        704.9202, 704.9202, 704.9202, 704.9202, 704.9202, 704.9202, 658.9345,
        630.0905, 678.1191, 591.4082, 608.6926, 593.3074, 605.1353, 608.5035,
        643.1481, 567.5703, 691.2972, 627.4018, 609.2606, 601.0204, 598.5766,
        616.1550, 564.3699, 577.0248, 569.8678, 618.9594, 568.5246, 602.4824,
        569.0384, 591.3759], device='cuda:3')
sorted_norm is   tensor([348.1221, 406.0349, 415.5989, 429.0309, 456.5439, 462.9889, 465.4003,
        564.3699, 567.5703, 568.5246, 569.0384, 569.8678, 574.6981, 577.0248,
        591.3759, 591.4082, 593.3074, 598.5766, 601.0204, 602.4824, 605.1353,
        608.5035, 608.6926, 609.2606, 616.1550, 618.9594, 627.4018, 630.0905,
        643.1481, 658.9345, 678.1191, 691.2972, 704.9202, 704.9202, 704.9202,
        704.9202, 704.9202, 704.9202, 704.9202, 704.9202, 704.9202, 704.9202,
        704.9202, 704.9202], device='cuda:3')
used idx is  tensor([ 3,  4,  6,  0,  5,  1,  7, 36, 29, 40, 42, 38,  2, 37, 43, 23, 25, 34,
        33, 41, 26, 27, 24, 32, 35, 39], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 90.51% 

Test Accuracy: 89.50% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.363558828830719
distance x is tensor(106.8497, device='cuda:3')
benign distance is  tensor(106.8497, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2761293053627014
distance x is tensor(109.1675, device='cuda:3')
benign distance is  tensor(109.1675, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23617272078990936
distance x is tensor(112.9207, device='cuda:3')
benign distance is  tensor(112.9207, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2412942349910736
distance x is tensor(97.5231, device='cuda:3')
benign distance is  tensor(97.5231, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6275814771652222
distance x is tensor(89.0861, device='cuda:3')
benign distance is  tensor(89.0861, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.40766024589538574
distance x is tensor(92.5613, device='cuda:3')
benign distance is  tensor(92.5613, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.09296947717666626
distance x is tensor(107.8177, device='cuda:3')
benign distance is  tensor(107.8177, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.25003737211227417
distance x is tensor(106.4085, device='cuda:3')
benign distance is  tensor(106.4085, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.036087460815906525
distance x is tensor(156.3746, device='cuda:3')
benign distance is  tensor(156.3746, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.35360532999038696
distance x is tensor(139.6408, device='cuda:3')
benign distance is  tensor(139.6408, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6408894658088684
distance x is tensor(125.3037, device='cuda:3')
benign distance is  tensor(125.3037, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.735409140586853
distance x is tensor(125.1222, device='cuda:3')
benign distance is  tensor(125.1222, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48048096895217896
distance x is tensor(123.1236, device='cuda:3')
benign distance is  tensor(123.1236, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.10717549175024033
distance x is tensor(132.2587, device='cuda:3')
benign distance is  tensor(132.2587, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2599307596683502
distance x is tensor(146.5160, device='cuda:3')
benign distance is  tensor(146.5160, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3131619393825531
distance x is tensor(128.4106, device='cuda:3')
benign distance is  tensor(128.4106, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.34841012954711914
distance x is tensor(144.2542, device='cuda:3')
benign distance is  tensor(144.2542, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4779585301876068
distance x is tensor(123.4872, device='cuda:3')
benign distance is  tensor(123.4872, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.15980741381645203
distance x is tensor(155.9992, device='cuda:3')
benign distance is  tensor(155.9992, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8103200197219849
distance x is tensor(143.2056, device='cuda:3')
benign distance is  tensor(143.2056, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6061891317367554
distance x is tensor(138.0248, device='cuda:3')
benign distance is  tensor(138.0248, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9965636134147644
distance x is tensor(149.7453, device='cuda:3')
benign distance is  tensor(149.7453, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.21516379714012146
distance x is tensor(120.8134, device='cuda:3')
benign distance is  tensor(120.8134, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1138363853096962
distance x is tensor(139.3164, device='cuda:3')
benign distance is  tensor(139.3164, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6357854008674622
distance x is tensor(139.9521, device='cuda:3')
benign distance is  tensor(139.9521, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.13558101654052734
distance x is tensor(138.8752, device='cuda:3')
benign distance is  tensor(138.8752, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.17381107807159424
distance x is tensor(152.1185, device='cuda:3')
benign distance is  tensor(152.1185, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6922822594642639
distance x is tensor(143.4297, device='cuda:3')
benign distance is  tensor(143.4297, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3920277953147888
distance x is tensor(127.7694, device='cuda:3')
benign distance is  tensor(127.7694, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6206551194190979
distance x is tensor(120.6943, device='cuda:3')
benign distance is  tensor(120.6943, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5040119886398315
distance x is tensor(123.0906, device='cuda:3')
benign distance is  tensor(123.0906, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1592867076396942
distance x is tensor(138.7803, device='cuda:3')
benign distance is  tensor(138.7803, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(132.1841, device='cuda:3')
compute distance is  tensor(132.1841, device='cuda:3')
compute norm is  tensor(52.2787, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.4298, device='cuda:3')
compute distance is  tensor(130.4298, device='cuda:3')
compute norm is  tensor(52.2641, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6976, device='cuda:3')
compute distance is  tensor(137.6976, device='cuda:3')
compute norm is  tensor(52.4644, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1861, device='cuda:3')
compute distance is  tensor(131.1861, device='cuda:3')
compute norm is  tensor(52.3481, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3598, device='cuda:3')
compute distance is  tensor(136.3598, device='cuda:3')
compute norm is  tensor(52.2781, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2383, device='cuda:3')
compute distance is  tensor(137.2383, device='cuda:3')
compute norm is  tensor(52.5256, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3130, device='cuda:3')
compute distance is  tensor(128.3130, device='cuda:3')
compute norm is  tensor(52.3640, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7419, device='cuda:3')
compute distance is  tensor(133.7419, device='cuda:3')
compute norm is  tensor(52.3608, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8200, device='cuda:3')
compute distance is  tensor(139.8200, device='cuda:3')
compute norm is  tensor(52.5779, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7544, device='cuda:3')
compute distance is  tensor(122.7544, device='cuda:3')
compute norm is  tensor(52.3646, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2310, device='cuda:3')
compute distance is  tensor(133.2310, device='cuda:3')
compute norm is  tensor(52.5540, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2665, device='cuda:3')
compute distance is  tensor(144.2665, device='cuda:3')
compute norm is  tensor(52.5591, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.2665, device='cuda:3')
distance x is tensor(107700.5234, device='cuda:3')
distance x is tensor(107700.5234, device='cuda:3')
________________________________
test distance is  tensor(107700.5234, device='cuda:3')
test distance1 is  tensor(107700.5234, device='cuda:3')
test similarity is  tensor(0.0417, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130126886846359.2
test entropy is  0.0
________________________________
cal ratio is  0.03586740028683412
distance x is tensor(3862.9438, device='cuda:3')
cal_distance is  tensor(3862.9438, device='cuda:3')
cal ratio is  0.18938676541042263
distance x is tensor(731.5946, device='cuda:3')
cal_distance is  tensor(731.5946, device='cuda:3')
cal ratio is  0.43518465661655764
distance x is tensor(318.3817, device='cuda:3')
cal_distance is  tensor(318.3817, device='cuda:3')
cal ratio is  0.6596821899146136
distance x is tensor(210.0325, device='cuda:3')
cal_distance is  tensor(210.0325, device='cuda:3')
cal ratio is  0.8122047574836008
distance x is tensor(170.5904, device='cuda:3')
cal_distance is  tensor(170.5904, device='cuda:3')
cal ratio is  0.9012214572794005
distance x is tensor(153.7403, device='cuda:3')
cal_distance is  tensor(153.7403, device='cuda:3')
cal ratio is  0.9493251935137973
distance x is tensor(145.9498, device='cuda:3')
cal_distance is  tensor(145.9498, device='cuda:3')
cal ratio is  0.9743323720644936
distance x is tensor(142.2037, device='cuda:3')
cal_distance is  tensor(142.2037, device='cuda:3')
distance x is tensor(142.2037, device='cuda:3')
return_distance is  tensor(142.2037, device='cuda:3')
distance x is tensor(142.1933, device='cuda:3')
distance x is tensor(142.1933, device='cuda:3')
________________________________
test distance is  tensor(142.1933, device='cuda:3')
test distance1 is  tensor(142.1933, device='cuda:3')
test similarity is  tensor(0.9534, device='cuda:3')
test acc is  0.10390000015633197
test loss is 261.5925061321462
test entropy is  0.0012587375060518467
________________________________
0
distance x is tensor(142.1933, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.001170513823663036
avg test loss is  261.00013267663496
avg accuracy is  0.524766666823009
solo acc is  0.10383333348966531
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(142.1933, device='cuda:3')
compute_norm is  tensor(52.7295, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(128.8012, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9458321388850588
avg test loss is  1.4544047785720338
avg accuracy is  0.8546666668229898
solo acc is  0.30921666682300636
compute similarity  is  tensor(0.9571, device='cuda:3')
compute_distance is  tensor(128.8012, device='cuda:3')
compute_norm is  tensor(52.2206, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.4409, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8926152904658938
avg test loss is  1.530956846818741
avg accuracy is  0.8530166668229898
solo acc is  0.2521833334896716
compute similarity  is  tensor(0.9567, device='cuda:3')
compute_distance is  tensor(130.4409, device='cuda:3')
compute_norm is  tensor(51.9363, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.7409, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8967667237273665
avg test loss is  1.474106269477527
avg accuracy is  0.8558666668229896
solo acc is  0.2572500001563385
compute similarity  is  tensor(0.9565, device='cuda:3')
compute_distance is  tensor(131.7409, device='cuda:3')
compute_norm is  tensor(51.6625, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.0629, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8889483170214493
avg test loss is  1.4457606633843134
avg accuracy is  0.8597666668229895
solo acc is  0.2558333334896717
compute similarity  is  tensor(0.9563, device='cuda:3')
compute_distance is  tensor(133.0629, device='cuda:3')
compute_norm is  tensor(51.3947, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.3927, device='cuda:3')
distance x is tensor(134.3927, device='cuda:3')
________________________________
test distance is  tensor(134.3927, device='cuda:3')
test distance1 is  tensor(134.3927, device='cuda:3')
test similarity is  tensor(0.9561, device='cuda:3')
test acc is  0.2552000001563384
test loss is 1.4244632109650162
test entropy is  0.8845760843901238
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3580821752548218
mal norm is  tensor(682.4006, device='cuda:3')
distance x is tensor(134.4003, device='cuda:3')
mal distance is  tensor(134.4003, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([472.3856, 482.9255, 478.9229, 421.8475, 388.2557, 403.5496, 464.0607,
        475.3923, 682.4006, 682.4006, 682.4006, 682.4006, 682.4006, 682.4006,
        682.4006, 682.4006, 682.4006, 682.4006, 682.4006, 682.4006],
       device='cuda:3')
sorted_norm is   tensor([388.2557, 403.5496, 421.8475, 464.0607, 472.3856, 475.3923, 478.9229,
        482.9255, 682.4006, 682.4006, 682.4006, 682.4006, 682.4006, 682.4006,
        682.4006, 682.4006, 682.4006, 682.4006, 682.4006, 682.4006],
       device='cuda:3')
used idx is  tensor([ 4,  5,  3,  6,  0,  7,  2,  1, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 89.47% 

Test Accuracy: 88.56% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5978201031684875
distance x is tensor(110.9547, device='cuda:3')
benign distance is  tensor(110.9547, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7445964813232422
distance x is tensor(134.8273, device='cuda:3')
benign distance is  tensor(134.8273, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05112239718437195
distance x is tensor(153.6562, device='cuda:3')
benign distance is  tensor(153.6562, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7492093443870544
distance x is tensor(122.8574, device='cuda:3')
benign distance is  tensor(122.8574, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33501896262168884
distance x is tensor(131.9556, device='cuda:3')
benign distance is  tensor(131.9556, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6280877590179443
distance x is tensor(132.4407, device='cuda:3')
benign distance is  tensor(132.4407, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26962074637413025
distance x is tensor(113.9521, device='cuda:3')
benign distance is  tensor(113.9521, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.08616776764392853
distance x is tensor(131.3914, device='cuda:3')
benign distance is  tensor(131.3914, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(149.1036, device='cuda:3')
compute distance is  tensor(149.1036, device='cuda:3')
compute norm is  tensor(52.4528, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5315, device='cuda:3')
compute distance is  tensor(139.5315, device='cuda:3')
compute norm is  tensor(52.5033, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5596, device='cuda:3')
compute distance is  tensor(148.5596, device='cuda:3')
compute norm is  tensor(52.7753, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.9350, device='cuda:3')
compute distance is  tensor(143.9350, device='cuda:3')
compute norm is  tensor(52.4322, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6903, device='cuda:3')
compute distance is  tensor(152.6903, device='cuda:3')
compute norm is  tensor(52.5865, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.4772, device='cuda:3')
compute distance is  tensor(163.4772, device='cuda:3')
compute norm is  tensor(53.1361, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.7939, device='cuda:3')
compute distance is  tensor(160.7939, device='cuda:3')
compute norm is  tensor(52.8830, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.2854, device='cuda:3')
compute distance is  tensor(152.2854, device='cuda:3')
compute norm is  tensor(52.6453, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.5362, device='cuda:3')
compute distance is  tensor(162.5362, device='cuda:3')
compute norm is  tensor(52.8599, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5050, device='cuda:3')
compute distance is  tensor(139.5050, device='cuda:3')
compute norm is  tensor(52.3999, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.0362, device='cuda:3')
compute distance is  tensor(167.0362, device='cuda:3')
compute norm is  tensor(53.0554, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.4299, device='cuda:3')
compute distance is  tensor(154.4299, device='cuda:3')
compute norm is  tensor(52.7722, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(167.0362, device='cuda:3')
distance x is tensor(107674.0312, device='cuda:3')
distance x is tensor(107674.0312, device='cuda:3')
________________________________
test distance is  tensor(107674.0312, device='cuda:3')
test distance1 is  tensor(107674.0312, device='cuda:3')
test similarity is  tensor(0.1275, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130228315231701.42
test entropy is  0.0
________________________________
cal ratio is  0.03859898079046316
distance x is tensor(4156.1128, device='cuda:3')
cal_distance is  tensor(4156.1128, device='cuda:3')
cal ratio is  0.19646612332855815
distance x is tensor(816.5396, device='cuda:3')
cal_distance is  tensor(816.5396, device='cuda:3')
cal ratio is  0.44324384073635115
distance x is tensor(361.9290, device='cuda:3')
cal_distance is  tensor(361.9290, device='cuda:3')
cal ratio is  0.6657629265778318
distance x is tensor(240.9607, device='cuda:3')
cal_distance is  tensor(240.9607, device='cuda:3')
cal ratio is  0.8159400729223188
distance x is tensor(196.6104, device='cuda:3')
cal_distance is  tensor(196.6104, device='cuda:3')
cal ratio is  0.9032917855635998
distance x is tensor(177.5971, device='cuda:3')
cal_distance is  tensor(177.5971, device='cuda:3')
cal ratio is  0.9504153040179749
distance x is tensor(168.7912, device='cuda:3')
cal_distance is  tensor(168.7912, device='cuda:3')
cal ratio is  0.9748917099897122
distance x is tensor(164.5533, device='cuda:3')
cal_distance is  tensor(164.5533, device='cuda:3')
distance x is tensor(164.5533, device='cuda:3')
return_distance is  tensor(164.5533, device='cuda:3')
distance x is tensor(164.5430, device='cuda:3')
distance x is tensor(164.5430, device='cuda:3')
________________________________
test distance is  tensor(164.5430, device='cuda:3')
test distance1 is  tensor(164.5430, device='cuda:3')
test similarity is  tensor(0.9438, device='cuda:3')
test acc is  0.10018333348966532
test loss is 463.4075086711566
test entropy is  0.00012888362155280542
________________________________
0
distance x is tensor(164.5430, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00010288909791178931
avg test loss is  463.0931641145556
avg accuracy is  0.23810000015633784
solo acc is  0.10021666682299865
compute similarity  is  tensor(0.9438, device='cuda:3')
compute_distance is  tensor(164.5430, device='cuda:3')
compute_norm is  tensor(54.2039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.5966, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2132728512861581
avg test loss is  1.8358260984105597
avg accuracy is  0.6123000001563366
solo acc is  0.21640000015633706
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(157.5966, device='cuda:3')
compute_norm is  tensor(54.6829, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.3296, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6937025443577309
avg test loss is  2.6593989593896277
avg accuracy is  0.5083166668230088
solo acc is  0.1126166668229986
compute similarity  is  tensor(0.9442, device='cuda:3')
compute_distance is  tensor(159.3296, device='cuda:3')
compute_norm is  tensor(54.5693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.0412, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0240512063254172
avg test loss is  1.5590462060625365
avg accuracy is  0.6275333334896688
solo acc is  0.2603500001563385
compute similarity  is  tensor(0.9446, device='cuda:3')
compute_distance is  tensor(160.0412, device='cuda:3')
compute_norm is  tensor(54.2611, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.0252, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6270628291279522
avg test loss is  2.4120497087171593
avg accuracy is  0.5121500001563422
solo acc is  0.10885000015633195
compute similarity  is  tensor(0.9443, device='cuda:3')
compute_distance is  tensor(161.0252, device='cuda:3')
compute_norm is  tensor(54.0779, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.8143, device='cuda:3')
distance x is tensor(161.8143, device='cuda:3')
________________________________
test distance is  tensor(161.8143, device='cuda:3')
test distance1 is  tensor(161.8143, device='cuda:3')
test similarity is  tensor(0.9445, device='cuda:3')
test acc is  0.23915000015633794
test loss is 1.5129373992429866
test entropy is  0.9968490585970726
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.5420087575912476
mal norm is  tensor(810.4241, device='cuda:3')
distance x is tensor(161.8223, device='cuda:3')
mal distance is  tensor(161.8223, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 26
weight size is  torch.Size([44, 215370])
norm res is  tensor([487.0612, 595.1249, 652.6098, 528.7998, 568.2048, 561.6819, 485.2187,
        576.2717, 810.4241, 810.4241, 810.4241, 810.4241, 810.4241, 810.4241,
        810.4241, 810.4241, 810.4241, 810.4241, 810.4241, 810.4241, 671.6720,
        619.8217, 620.0168, 684.1784, 621.3054, 640.6422, 641.9637, 684.9606,
        629.7452, 698.8896, 589.7823, 615.2492, 614.0157, 692.1722, 644.9556,
        659.3597, 731.6229, 670.8835, 598.8553, 603.9727, 604.0532, 637.7761,
        690.2525, 624.6379], device='cuda:3')
sorted_norm is   tensor([485.2187, 487.0612, 528.7998, 561.6819, 568.2048, 576.2717, 589.7823,
        595.1249, 598.8553, 603.9727, 604.0532, 614.0157, 615.2492, 619.8217,
        620.0168, 621.3054, 624.6379, 629.7452, 637.7761, 640.6422, 641.9637,
        644.9556, 652.6098, 659.3597, 670.8835, 671.6720, 684.1784, 684.9606,
        690.2525, 692.1722, 698.8896, 731.6229, 810.4241, 810.4241, 810.4241,
        810.4241, 810.4241, 810.4241, 810.4241, 810.4241, 810.4241, 810.4241,
        810.4241, 810.4241], device='cuda:3')
used idx is  tensor([ 6,  0,  3,  5,  4,  7, 30,  1, 38, 39, 40, 32, 31, 21, 22, 24, 43, 28,
        41, 25, 26, 34,  2, 35, 37, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 90.53% 

Test Accuracy: 89.60% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5337414741516113
distance x is tensor(100.3171, device='cuda:3')
benign distance is  tensor(100.3171, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.35820749402046204
distance x is tensor(99.8874, device='cuda:3')
benign distance is  tensor(99.8874, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11235177516937256
distance x is tensor(106.3049, device='cuda:3')
benign distance is  tensor(106.3049, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5709781050682068
distance x is tensor(93.0118, device='cuda:3')
benign distance is  tensor(93.0118, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33325251936912537
distance x is tensor(84.2429, device='cuda:3')
benign distance is  tensor(84.2429, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.48669877648353577
distance x is tensor(109.8428, device='cuda:3')
benign distance is  tensor(109.8428, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.14448252320289612
distance x is tensor(87.7645, device='cuda:3')
benign distance is  tensor(87.7645, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.26433277130126953
distance x is tensor(111.9663, device='cuda:3')
benign distance is  tensor(111.9663, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.04031985253095627
distance x is tensor(135.9347, device='cuda:3')
benign distance is  tensor(135.9347, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.21003353595733643
distance x is tensor(116.9452, device='cuda:3')
benign distance is  tensor(116.9452, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6965219974517822
distance x is tensor(109.0169, device='cuda:3')
benign distance is  tensor(109.0169, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0221388339996338
distance x is tensor(122.9306, device='cuda:3')
benign distance is  tensor(122.9306, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0320353507995605
distance x is tensor(119.6840, device='cuda:3')
benign distance is  tensor(119.6840, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1400168240070343
distance x is tensor(129.9317, device='cuda:3')
benign distance is  tensor(129.9317, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6313446760177612
distance x is tensor(126.5865, device='cuda:3')
benign distance is  tensor(126.5865, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5785642266273499
distance x is tensor(125.1472, device='cuda:3')
benign distance is  tensor(125.1472, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.040635429322719574
distance x is tensor(125.8408, device='cuda:3')
benign distance is  tensor(125.8408, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.45267948508262634
distance x is tensor(150.3812, device='cuda:3')
benign distance is  tensor(150.3812, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.09561888128519058
distance x is tensor(123.3651, device='cuda:3')
benign distance is  tensor(123.3651, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.427374929189682
distance x is tensor(126.9465, device='cuda:3')
benign distance is  tensor(126.9465, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6982724070549011
distance x is tensor(136.7867, device='cuda:3')
benign distance is  tensor(136.7867, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5224241018295288
distance x is tensor(130.9822, device='cuda:3')
benign distance is  tensor(130.9822, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4637737274169922
distance x is tensor(167.4663, device='cuda:3')
benign distance is  tensor(167.4663, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.435574471950531
distance x is tensor(121.9538, device='cuda:3')
benign distance is  tensor(121.9538, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1565522849559784
distance x is tensor(143.4250, device='cuda:3')
benign distance is  tensor(143.4250, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.29161131381988525
distance x is tensor(130.7543, device='cuda:3')
benign distance is  tensor(130.7543, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.031603578478097916
distance x is tensor(124.7980, device='cuda:3')
benign distance is  tensor(124.7980, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.11756887286901474
distance x is tensor(146.1316, device='cuda:3')
benign distance is  tensor(146.1316, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.0682082325220108
distance x is tensor(138.4997, device='cuda:3')
benign distance is  tensor(138.4997, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.37699073553085327
distance x is tensor(138.4243, device='cuda:3')
benign distance is  tensor(138.4243, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6120625734329224
distance x is tensor(143.7104, device='cuda:3')
benign distance is  tensor(143.7104, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.801224410533905
distance x is tensor(147.7886, device='cuda:3')
benign distance is  tensor(147.7886, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.6172, device='cuda:3')
compute distance is  tensor(121.6172, device='cuda:3')
compute norm is  tensor(52.4542, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5165, device='cuda:3')
compute distance is  tensor(133.5165, device='cuda:3')
compute norm is  tensor(52.5659, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3370, device='cuda:3')
compute distance is  tensor(133.3370, device='cuda:3')
compute norm is  tensor(52.8011, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4380, device='cuda:3')
compute distance is  tensor(125.4380, device='cuda:3')
compute norm is  tensor(52.4839, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8082, device='cuda:3')
compute distance is  tensor(146.8082, device='cuda:3')
compute norm is  tensor(52.8740, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5102, device='cuda:3')
compute distance is  tensor(137.5102, device='cuda:3')
compute norm is  tensor(52.8096, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8522, device='cuda:3')
compute distance is  tensor(140.8522, device='cuda:3')
compute norm is  tensor(52.7438, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2212, device='cuda:3')
compute distance is  tensor(137.2212, device='cuda:3')
compute norm is  tensor(52.7796, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9239, device='cuda:3')
compute distance is  tensor(141.9239, device='cuda:3')
compute norm is  tensor(52.8022, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.6089, device='cuda:3')
compute distance is  tensor(135.6089, device='cuda:3')
compute norm is  tensor(52.8148, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1868, device='cuda:3')
compute distance is  tensor(138.1868, device='cuda:3')
compute norm is  tensor(52.8175, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2425, device='cuda:3')
compute distance is  tensor(139.2425, device='cuda:3')
compute norm is  tensor(52.7387, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.8082, device='cuda:3')
distance x is tensor(107698.5547, device='cuda:3')
distance x is tensor(107698.5547, device='cuda:3')
________________________________
test distance is  tensor(107698.5547, device='cuda:3')
test distance1 is  tensor(107698.5547, device='cuda:3')
test similarity is  tensor(0.0549, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130065361226998.72
test entropy is  0.0
________________________________
cal ratio is  0.036182312234573244
distance x is tensor(3896.7878, device='cuda:3')
cal_distance is  tensor(3896.7878, device='cuda:3')
cal ratio is  0.19021636549045898
distance x is tensor(741.2371, device='cuda:3')
cal_distance is  tensor(741.2371, device='cuda:3')
cal ratio is  0.43613673939626135
distance x is tensor(323.2836, device='cuda:3')
cal_distance is  tensor(323.2836, device='cuda:3')
cal ratio is  0.6604035513495151
distance x is tensor(213.4994, device='cuda:3')
cal_distance is  tensor(213.4994, device='cuda:3')
cal ratio is  0.8126487666898351
distance x is tensor(173.5010, device='cuda:3')
cal_distance is  tensor(173.5010, device='cuda:3')
cal ratio is  0.9014678121523478
distance x is tensor(156.4061, device='cuda:3')
cal_distance is  tensor(156.4061, device='cuda:3')
cal ratio is  0.9494550105188951
distance x is tensor(148.5009, device='cuda:3')
cal_distance is  tensor(148.5009, device='cuda:3')
cal ratio is  0.9743988774367147
distance x is tensor(144.6992, device='cuda:3')
cal_distance is  tensor(144.6992, device='cuda:3')
distance x is tensor(144.6992, device='cuda:3')
return_distance is  tensor(144.6992, device='cuda:3')
distance x is tensor(144.6888, device='cuda:3')
distance x is tensor(144.6888, device='cuda:3')
________________________________
test distance is  tensor(144.6888, device='cuda:3')
test distance1 is  tensor(144.6888, device='cuda:3')
test similarity is  tensor(0.9528, device='cuda:3')
test acc is  0.10290000015633197
test loss is 265.5612462090531
test entropy is  0.0012045801503101675
________________________________
0
distance x is tensor(144.6888, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0010743925221705552
avg test loss is  265.04426137114893
avg accuracy is  0.5257333334896755
solo acc is  0.1033833334896653
compute similarity  is  tensor(0.9528, device='cuda:3')
compute_distance is  tensor(144.6888, device='cuda:3')
compute_norm is  tensor(53.1494, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(133.2620, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.974157264873163
avg test loss is  1.502486212929683
avg accuracy is  0.8324166668229906
solo acc is  0.29950000015633943
compute similarity  is  tensor(0.9560, device='cuda:3')
compute_distance is  tensor(133.2620, device='cuda:3')
compute_norm is  tensor(52.8511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.6746, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9076405489114302
avg test loss is  1.5290329815990635
avg accuracy is  0.8354666668229905
solo acc is  0.25783333348967186
compute similarity  is  tensor(0.9558, device='cuda:3')
compute_distance is  tensor(134.6746, device='cuda:3')
compute_norm is  tensor(52.5808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.9987, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9094247064356611
avg test loss is  1.4960719369876105
avg accuracy is  0.8388500001563237
solo acc is  0.2478166668230049
compute similarity  is  tensor(0.9556, device='cuda:3')
compute_distance is  tensor(135.9987, device='cuda:3')
compute_norm is  tensor(52.3120, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.2502, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8824503695024356
avg test loss is  1.4740500781836032
avg accuracy is  0.8380166668229904
solo acc is  0.24811666682300482
compute similarity  is  tensor(0.9554, device='cuda:3')
compute_distance is  tensor(137.2502, device='cuda:3')
compute_norm is  tensor(52.0487, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.5197, device='cuda:3')
distance x is tensor(138.5197, device='cuda:3')
________________________________
test distance is  tensor(138.5197, device='cuda:3')
test distance1 is  tensor(138.5197, device='cuda:3')
test similarity is  tensor(0.9552, device='cuda:3')
test acc is  0.2489500001563382
test loss is 1.4481677860339313
test entropy is  0.8739724396896769
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2970435619354248
mal norm is  tensor(696.5908, device='cuda:3')
distance x is tensor(138.5274, device='cuda:3')
mal distance is  tensor(138.5274, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([441.8864, 431.8100, 461.3843, 403.3088, 362.8537, 467.5212, 382.6229,
        484.5577, 696.5908, 696.5909, 696.5908, 696.5909, 696.5908, 696.5909,
        696.5908, 696.5909, 696.5908, 696.5909, 696.5908, 696.5909],
       device='cuda:3')
sorted_norm is   tensor([362.8537, 382.6229, 403.3088, 431.8100, 441.8864, 461.3843, 467.5212,
        484.5577, 696.5908, 696.5908, 696.5908, 696.5908, 696.5908, 696.5908,
        696.5909, 696.5909, 696.5909, 696.5909, 696.5909, 696.5909],
       device='cuda:3')
used idx is  tensor([ 4,  6,  3,  1,  0,  2,  5,  7, 18, 16, 12, 14], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 88.07% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6038188338279724
distance x is tensor(103.7214, device='cuda:3')
benign distance is  tensor(103.7214, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4581504762172699
distance x is tensor(137.1292, device='cuda:3')
benign distance is  tensor(137.1292, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10944273322820663
distance x is tensor(130.9280, device='cuda:3')
benign distance is  tensor(130.9280, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3906865119934082
distance x is tensor(118.3646, device='cuda:3')
benign distance is  tensor(118.3646, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3905089199542999
distance x is tensor(124.1387, device='cuda:3')
benign distance is  tensor(124.1387, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.45661765336990356
distance x is tensor(127.5930, device='cuda:3')
benign distance is  tensor(127.5930, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.181692972779274
distance x is tensor(137.4245, device='cuda:3')
benign distance is  tensor(137.4245, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44184646010398865
distance x is tensor(131.6543, device='cuda:3')
benign distance is  tensor(131.6543, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(150.5565, device='cuda:3')
compute distance is  tensor(150.5565, device='cuda:3')
compute norm is  tensor(52.9590, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.7718, device='cuda:3')
compute distance is  tensor(159.7718, device='cuda:3')
compute norm is  tensor(52.9997, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.4617, device='cuda:3')
compute distance is  tensor(159.4617, device='cuda:3')
compute norm is  tensor(53.2484, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.4225, device='cuda:3')
compute distance is  tensor(149.4225, device='cuda:3')
compute norm is  tensor(52.9273, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.4348, device='cuda:3')
compute distance is  tensor(159.4348, device='cuda:3')
compute norm is  tensor(53.0025, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.5406, device='cuda:3')
compute distance is  tensor(153.5406, device='cuda:3')
compute norm is  tensor(53.2083, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.4431, device='cuda:3')
compute distance is  tensor(157.4431, device='cuda:3')
compute norm is  tensor(53.1395, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.2523, device='cuda:3')
compute distance is  tensor(155.2523, device='cuda:3')
compute norm is  tensor(53.1304, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.8347, device='cuda:3')
compute distance is  tensor(150.8347, device='cuda:3')
compute norm is  tensor(52.9454, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.0072, device='cuda:3')
compute distance is  tensor(150.0072, device='cuda:3')
compute norm is  tensor(53.1898, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.5366, device='cuda:3')
compute distance is  tensor(160.5366, device='cuda:3')
compute norm is  tensor(53.2032, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.6021, device='cuda:3')
compute distance is  tensor(164.6021, device='cuda:3')
compute norm is  tensor(53.3818, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.6021, device='cuda:3')
distance x is tensor(107670.4531, device='cuda:3')
distance x is tensor(107670.4531, device='cuda:3')
________________________________
test distance is  tensor(107670.4531, device='cuda:3')
test distance1 is  tensor(107670.4531, device='cuda:3')
test similarity is  tensor(0.1406, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130128327826774.78
test entropy is  0.0
________________________________
cal ratio is  0.038317349459818364
distance x is tensor(4125.6519, device='cuda:3')
cal_distance is  tensor(4125.6519, device='cuda:3')
cal ratio is  0.1957480503948302
distance x is tensor(807.5925, device='cuda:3')
cal_distance is  tensor(807.5925, device='cuda:3')
cal ratio is  0.4424330956789076
distance x is tensor(357.3085, device='cuda:3')
cal_distance is  tensor(357.3085, device='cuda:3')
cal ratio is  0.66515375919606
distance x is tensor(237.6669, device='cuda:3')
cal_distance is  tensor(237.6669, device='cuda:3')
cal ratio is  0.8155665742402719
distance x is tensor(193.8341, device='cuda:3')
cal_distance is  tensor(193.8341, device='cuda:3')
cal ratio is  0.9030850709054391
distance x is tensor(175.0492, device='cuda:3')
cal_distance is  tensor(175.0492, device='cuda:3')
cal ratio is  0.9503064907979093
distance x is tensor(166.3506, device='cuda:3')
cal_distance is  tensor(166.3506, device='cuda:3')
cal ratio is  0.9748358376168585
distance x is tensor(162.1647, device='cuda:3')
cal_distance is  tensor(162.1647, device='cuda:3')
distance x is tensor(162.1647, device='cuda:3')
return_distance is  tensor(162.1647, device='cuda:3')
distance x is tensor(162.1544, device='cuda:3')
distance x is tensor(162.1544, device='cuda:3')
________________________________
test distance is  tensor(162.1544, device='cuda:3')
test distance1 is  tensor(162.1544, device='cuda:3')
test similarity is  tensor(0.9466, device='cuda:3')
test acc is  0.10110000015633197
test loss is 353.6720823438437
test entropy is  0.0007107286583166238
________________________________
0
distance x is tensor(162.1544, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0006698894465863971
avg test loss is  354.0139944893973
avg accuracy is  0.3677333334896741
solo acc is  0.1013333334896653
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(162.1544, device='cuda:3')
compute_norm is  tensor(54.5850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.8768, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0859354460544424
avg test loss is  1.6708103066314257
avg accuracy is  0.6169833334896696
solo acc is  0.2520333334896716
compute similarity  is  tensor(0.9483, device='cuda:3')
compute_distance is  tensor(154.8768, device='cuda:3')
compute_norm is  tensor(54.9037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.3412, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6551895624538983
avg test loss is  2.5126531271537993
avg accuracy is  0.4975000001563421
solo acc is  0.1115166668229986
compute similarity  is  tensor(0.9481, device='cuda:3')
compute_distance is  tensor(156.3412, device='cuda:3')
compute_norm is  tensor(54.7252, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.0961, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9908002933332407
avg test loss is  1.5111181783015286
avg accuracy is  0.6372666668230014
solo acc is  0.26240000015633863
compute similarity  is  tensor(0.9483, device='cuda:3')
compute_distance is  tensor(157.0961, device='cuda:3')
compute_norm is  tensor(54.4164, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(157.0961, device='cuda:3')
distance x is tensor(157.0961, device='cuda:3')
________________________________
test distance is  tensor(157.0961, device='cuda:3')
test distance1 is  tensor(157.0961, device='cuda:3')
test similarity is  tensor(0.9483, device='cuda:3')
test acc is  0.2633000001563386
test loss is 1.5139511291152123
test entropy is  0.9897983488497704
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4539744853973389
mal norm is  tensor(798.1444, device='cuda:3')
distance x is tensor(157.1043, device='cuda:3')
mal distance is  tensor(157.1043, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([447.2742, 601.7759, 567.6817, 511.8505, 528.4834, 552.6951, 591.6491,
        577.1139, 798.1444, 798.1444, 798.1444, 798.1444, 798.1444, 798.1444,
        798.1444, 798.1444, 798.1444, 798.1444, 798.1444, 798.1444, 723.2367,
        622.4708, 744.0508, 688.0530, 680.8560, 738.6430, 629.1483, 686.5800,
        646.4092, 583.6156, 544.2302, 591.6892, 588.5372, 627.3337, 608.9145,
        601.9452], device='cuda:3')
sorted_norm is   tensor([447.2742, 511.8505, 528.4834, 544.2302, 552.6951, 567.6817, 577.1139,
        583.6156, 588.5372, 591.6491, 591.6892, 601.7759, 601.9452, 608.9145,
        622.4708, 627.3337, 629.1483, 646.4092, 680.8560, 686.5800, 688.0530,
        723.2367, 738.6430, 744.0508, 798.1444, 798.1444, 798.1444, 798.1444,
        798.1444, 798.1444, 798.1444, 798.1444, 798.1444, 798.1444, 798.1444,
        798.1444], device='cuda:3')
used idx is  tensor([ 0,  3,  4, 30,  5,  2,  7, 29, 32,  6, 31,  1, 35, 34, 21, 33, 26, 28,
        24, 27, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 90.53% 

Test Accuracy: 89.28% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.16976982355117798
distance x is tensor(96.3562, device='cuda:3')
benign distance is  tensor(96.3562, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9109381437301636
distance x is tensor(87.0618, device='cuda:3')
benign distance is  tensor(87.0618, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.086960569024086
distance x is tensor(115.5307, device='cuda:3')
benign distance is  tensor(115.5307, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5158332586288452
distance x is tensor(93.3040, device='cuda:3')
benign distance is  tensor(93.3040, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1547867059707642
distance x is tensor(103.4211, device='cuda:3')
benign distance is  tensor(103.4211, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5097311735153198
distance x is tensor(103.8679, device='cuda:3')
benign distance is  tensor(103.8679, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25858184695243835
distance x is tensor(95.1239, device='cuda:3')
benign distance is  tensor(95.1239, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23247447609901428
distance x is tensor(118.1479, device='cuda:3')
benign distance is  tensor(118.1479, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.007448351476341486
distance x is tensor(132.1669, device='cuda:3')
benign distance is  tensor(132.1669, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7985283136367798
distance x is tensor(131.1284, device='cuda:3')
benign distance is  tensor(131.1284, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6843641400337219
distance x is tensor(125.1500, device='cuda:3')
benign distance is  tensor(125.1500, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.40740853548049927
distance x is tensor(138.8276, device='cuda:3')
benign distance is  tensor(138.8276, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3648238778114319
distance x is tensor(108.7549, device='cuda:3')
benign distance is  tensor(108.7549, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15927530825138092
distance x is tensor(127.1876, device='cuda:3')
benign distance is  tensor(127.1876, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2931060194969177
distance x is tensor(132.2687, device='cuda:3')
benign distance is  tensor(132.2687, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3449363708496094
distance x is tensor(134.1799, device='cuda:3')
benign distance is  tensor(134.1799, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.37177592515945435
distance x is tensor(161.7427, device='cuda:3')
benign distance is  tensor(161.7427, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5085477828979492
distance x is tensor(113.0599, device='cuda:3')
benign distance is  tensor(113.0599, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.05089712142944336
distance x is tensor(147.7198, device='cuda:3')
benign distance is  tensor(147.7198, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.30271047353744507
distance x is tensor(133.7589, device='cuda:3')
benign distance is  tensor(133.7589, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.010794997215271
distance x is tensor(129.7900, device='cuda:3')
benign distance is  tensor(129.7900, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.509816586971283
distance x is tensor(144.9508, device='cuda:3')
benign distance is  tensor(144.9508, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.24827489256858826
distance x is tensor(138.0539, device='cuda:3')
benign distance is  tensor(138.0539, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2555880546569824
distance x is tensor(136.4827, device='cuda:3')
benign distance is  tensor(136.4827, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.2286, device='cuda:3')
compute distance is  tensor(140.2286, device='cuda:3')
compute norm is  tensor(53.1995, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5155, device='cuda:3')
compute distance is  tensor(135.5155, device='cuda:3')
compute norm is  tensor(53.0727, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3534, device='cuda:3')
compute distance is  tensor(136.3534, device='cuda:3')
compute norm is  tensor(53.1682, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1336, device='cuda:3')
compute distance is  tensor(146.1336, device='cuda:3')
compute norm is  tensor(53.4139, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2527, device='cuda:3')
compute distance is  tensor(134.2527, device='cuda:3')
compute norm is  tensor(53.0362, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.1089, device='cuda:3')
compute distance is  tensor(133.1089, device='cuda:3')
compute norm is  tensor(52.9613, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6872, device='cuda:3')
compute distance is  tensor(134.6872, device='cuda:3')
compute norm is  tensor(53.1377, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3711, device='cuda:3')
compute distance is  tensor(146.3711, device='cuda:3')
compute norm is  tensor(53.2764, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.4586, device='cuda:3')
compute distance is  tensor(140.4586, device='cuda:3')
compute norm is  tensor(53.1358, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2543, device='cuda:3')
compute distance is  tensor(141.2543, device='cuda:3')
compute norm is  tensor(53.3621, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5982, device='cuda:3')
compute distance is  tensor(140.5982, device='cuda:3')
compute norm is  tensor(53.2408, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.0359, device='cuda:3')
compute distance is  tensor(161.0359, device='cuda:3')
compute norm is  tensor(53.5488, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(161.0359, device='cuda:3')
distance x is tensor(107695.4531, device='cuda:3')
distance x is tensor(107695.4531, device='cuda:3')
________________________________
test distance is  tensor(107695.4531, device='cuda:3')
test distance1 is  tensor(107695.4531, device='cuda:3')
test similarity is  tensor(0.0713, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130149724885297.67
test entropy is  0.0
________________________________
cal ratio is  0.03789560273314273
distance x is tensor(4081.1892, device='cuda:3')
cal_distance is  tensor(4081.1892, device='cuda:3')
cal ratio is  0.1946678078797063
distance x is tensor(794.4803, device='cuda:3')
cal_distance is  tensor(794.4803, device='cuda:3')
cal ratio is  0.44121059251884087
distance x is tensor(350.5360, device='cuda:3')
cal_distance is  tensor(350.5360, device='cuda:3')
cal ratio is  0.6642340914296789
distance x is tensor(232.8397, device='cuda:3')
cal_distance is  tensor(232.8397, device='cuda:3')
cal ratio is  0.8150025460577904
distance x is tensor(189.7659, device='cuda:3')
cal_distance is  tensor(189.7659, device='cuda:3')
cal ratio is  0.9027725798752302
distance x is tensor(171.3160, device='cuda:3')
cal_distance is  tensor(171.3160, device='cuda:3')
cal ratio is  0.9501419673298491
distance x is tensor(162.7748, device='cuda:3')
cal_distance is  tensor(162.7748, device='cuda:3')
cal ratio is  0.9747515679180746
distance x is tensor(158.6651, device='cuda:3')
cal_distance is  tensor(158.6651, device='cuda:3')
distance x is tensor(158.6651, device='cuda:3')
return_distance is  tensor(158.6651, device='cuda:3')
distance x is tensor(158.6548, device='cuda:3')
distance x is tensor(158.6548, device='cuda:3')
________________________________
test distance is  tensor(158.6548, device='cuda:3')
test distance1 is  tensor(158.6548, device='cuda:3')
test similarity is  tensor(0.9459, device='cuda:3')
test acc is  0.10325000015633197
test loss is 346.0691911091428
test entropy is  0.001069499458360413
________________________________
0
distance x is tensor(158.6548, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0010100392481303103
avg test loss is  346.73273635571445
avg accuracy is  0.4565666668230084
solo acc is  0.1029833334896653
compute similarity  is  tensor(0.9459, device='cuda:3')
compute_distance is  tensor(158.6548, device='cuda:3')
compute_norm is  tensor(54.1129, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.9062, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1342510906363856
avg test loss is  1.763977043283011
avg accuracy is  0.7562666668229941
solo acc is  0.22903333348967087
compute similarity  is  tensor(0.9473, device='cuda:3')
compute_distance is  tensor(153.9062, device='cuda:3')
compute_norm is  tensor(54.3165, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.8419, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6685839885079277
avg test loss is  2.561586928265944
avg accuracy is  0.7227500001563293
solo acc is  0.1136666668229986
compute similarity  is  tensor(0.9468, device='cuda:3')
compute_distance is  tensor(155.8419, device='cuda:3')
compute_norm is  tensor(54.1264, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.5656, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0121867320557902
avg test loss is  1.5308610883348786
avg accuracy is  0.7842166668229928
solo acc is  0.25161666682300493
compute similarity  is  tensor(0.9470, device='cuda:3')
compute_distance is  tensor(156.5656, device='cuda:3')
compute_norm is  tensor(53.8283, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.9016, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.5975261778274833
avg test loss is  2.388487667417221
avg accuracy is  0.7523000001563276
solo acc is  0.11055000015633196
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(157.9016, device='cuda:3')
compute_norm is  tensor(53.6177, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.7634, device='cuda:3')
distance x is tensor(158.7634, device='cuda:3')
________________________________
test distance is  tensor(158.7634, device='cuda:3')
test distance1 is  tensor(158.7634, device='cuda:3')
test similarity is  tensor(0.9466, device='cuda:3')
test acc is  0.2873000001563393
test loss is 1.4041462097086632
test entropy is  0.9231623945586971
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3379390239715576
mal norm is  tensor(781.1115, device='cuda:3')
distance x is tensor(158.7703, device='cuda:3')
mal distance is  tensor(158.7703, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([420.9518, 384.2258, 501.9993, 400.6189, 443.4000, 453.9826, 403.6154,
        515.8799, 781.1115, 781.1115, 781.1115, 781.1115, 781.1115, 781.1115,
        781.1115, 781.1115, 781.1115, 781.1115, 781.1115, 781.1115, 654.2233,
        648.1633, 699.5020, 659.5413, 597.2026, 556.9388, 554.2698, 633.3486,
        571.4824, 680.1082, 560.2405, 580.8171, 621.5776, 586.5967, 746.3378,
        549.0497], device='cuda:3')
sorted_norm is   tensor([384.2258, 400.6189, 403.6154, 420.9518, 443.4000, 453.9826, 501.9993,
        515.8799, 549.0497, 554.2698, 556.9388, 560.2405, 571.4824, 580.8171,
        586.5967, 597.2026, 621.5776, 633.3486, 648.1633, 654.2233, 659.5413,
        680.1082, 699.5020, 746.3378, 781.1115, 781.1115, 781.1115, 781.1115,
        781.1115, 781.1115, 781.1115, 781.1115, 781.1115, 781.1115, 781.1115,
        781.1115], device='cuda:3')
used idx is  tensor([ 1,  3,  6,  0,  4,  5,  2,  7, 35, 26, 25, 30, 28, 31, 33, 24, 32, 27,
        21, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 90.45% 

Test Accuracy: 89.68% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7076820135116577
distance x is tensor(104.2874, device='cuda:3')
benign distance is  tensor(104.2874, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2750275433063507
distance x is tensor(105.0556, device='cuda:3')
benign distance is  tensor(105.0556, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15154746174812317
distance x is tensor(122.5434, device='cuda:3')
benign distance is  tensor(122.5434, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48131227493286133
distance x is tensor(103.5299, device='cuda:3')
benign distance is  tensor(103.5299, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5711792707443237
distance x is tensor(77.3680, device='cuda:3')
benign distance is  tensor(77.3680, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.23345792293548584
distance x is tensor(104.4855, device='cuda:3')
benign distance is  tensor(104.4855, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.32676786184310913
distance x is tensor(86.4859, device='cuda:3')
benign distance is  tensor(86.4859, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2423560619354248
distance x is tensor(104.3422, device='cuda:3')
benign distance is  tensor(104.3422, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.12190824747085571
distance x is tensor(119.3026, device='cuda:3')
benign distance is  tensor(119.3026, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4315001964569092
distance x is tensor(149.0892, device='cuda:3')
benign distance is  tensor(149.0892, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.12094782292842865
distance x is tensor(119.4741, device='cuda:3')
benign distance is  tensor(119.4741, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.17494671046733856
distance x is tensor(130.3839, device='cuda:3')
benign distance is  tensor(130.3839, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.18528573215007782
distance x is tensor(143.3074, device='cuda:3')
benign distance is  tensor(143.3074, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.319205641746521
distance x is tensor(124.2853, device='cuda:3')
benign distance is  tensor(124.2853, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.30787888169288635
distance x is tensor(134.1954, device='cuda:3')
benign distance is  tensor(134.1954, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6195443272590637
distance x is tensor(133.0729, device='cuda:3')
benign distance is  tensor(133.0729, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.48278337717056274
distance x is tensor(135.5863, device='cuda:3')
benign distance is  tensor(135.5863, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.05691339820623398
distance x is tensor(137.0130, device='cuda:3')
benign distance is  tensor(137.0130, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.12038692086935043
distance x is tensor(136.3220, device='cuda:3')
benign distance is  tensor(136.3220, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.15247760713100433
distance x is tensor(132.4369, device='cuda:3')
benign distance is  tensor(132.4369, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.31252673268318176
distance x is tensor(128.3314, device='cuda:3')
benign distance is  tensor(128.3314, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.14914265275001526
distance x is tensor(131.3047, device='cuda:3')
benign distance is  tensor(131.3047, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6310826539993286
distance x is tensor(129.0252, device='cuda:3')
benign distance is  tensor(129.0252, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1583918035030365
distance x is tensor(138.0842, device='cuda:3')
benign distance is  tensor(138.0842, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(138.8764, device='cuda:3')
compute distance is  tensor(138.8764, device='cuda:3')
compute norm is  tensor(53.0572, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3042, device='cuda:3')
compute distance is  tensor(135.3042, device='cuda:3')
compute norm is  tensor(53.0982, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8577, device='cuda:3')
compute distance is  tensor(137.8577, device='cuda:3')
compute norm is  tensor(53.3143, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6672, device='cuda:3')
compute distance is  tensor(131.6672, device='cuda:3')
compute norm is  tensor(53.1040, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.6766, device='cuda:3')
compute distance is  tensor(144.6766, device='cuda:3')
compute norm is  tensor(53.2914, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.9457, device='cuda:3')
compute distance is  tensor(143.9457, device='cuda:3')
compute norm is  tensor(53.3399, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7192, device='cuda:3')
compute distance is  tensor(132.7192, device='cuda:3')
compute norm is  tensor(53.2882, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0113, device='cuda:3')
compute distance is  tensor(133.0113, device='cuda:3')
compute norm is  tensor(53.0557, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1534, device='cuda:3')
compute distance is  tensor(138.1534, device='cuda:3')
compute norm is  tensor(53.1263, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2894, device='cuda:3')
compute distance is  tensor(132.2894, device='cuda:3')
compute norm is  tensor(53.2406, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.1350, device='cuda:3')
compute distance is  tensor(133.1350, device='cuda:3')
compute norm is  tensor(53.2696, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9108, device='cuda:3')
compute distance is  tensor(125.9108, device='cuda:3')
compute norm is  tensor(53.0232, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.6766, device='cuda:3')
distance x is tensor(107700.7656, device='cuda:3')
distance x is tensor(107700.7656, device='cuda:3')
________________________________
test distance is  tensor(107700.7656, device='cuda:3')
test distance1 is  tensor(107700.7656, device='cuda:3')
test similarity is  tensor(0.0514, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130023926547375.22
test entropy is  0.0
________________________________
cal ratio is  0.035918298953676625
distance x is tensor(3868.4333, device='cuda:3')
cal_distance is  tensor(3868.4333, device='cuda:3')
cal ratio is  0.18952111071631692
distance x is tensor(733.1539, device='cuda:3')
cal_distance is  tensor(733.1539, device='cuda:3')
cal ratio is  0.4353390081759539
distance x is tensor(319.1735, device='cuda:3')
cal_distance is  tensor(319.1735, device='cuda:3')
cal ratio is  0.659799153019774
distance x is tensor(210.5922, device='cuda:3')
cal_distance is  tensor(210.5922, device='cuda:3')
cal ratio is  0.8122767849876766
distance x is tensor(171.0601, device='cuda:3')
cal_distance is  tensor(171.0601, device='cuda:3')
cal ratio is  0.9012614095761927
distance x is tensor(154.1704, device='cuda:3')
cal_distance is  tensor(154.1704, device='cuda:3')
cal ratio is  0.9493462681268081
distance x is tensor(146.3614, device='cuda:3')
cal_distance is  tensor(146.3614, device='cuda:3')
cal ratio is  0.974343123682274
distance x is tensor(142.6063, device='cuda:3')
cal_distance is  tensor(142.6063, device='cuda:3')
distance x is tensor(142.6063, device='cuda:3')
return_distance is  tensor(142.6063, device='cuda:3')
distance x is tensor(142.5959, device='cuda:3')
distance x is tensor(142.5959, device='cuda:3')
________________________________
test distance is  tensor(142.5959, device='cuda:3')
test distance1 is  tensor(142.5959, device='cuda:3')
test similarity is  tensor(0.9547, device='cuda:3')
test acc is  0.1041333334896653
test loss is 249.3751728732957
test entropy is  0.0015273885512016579
________________________________
0
distance x is tensor(142.5959, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0016486033856704283
avg test loss is  248.82841275343253
avg accuracy is  0.5500166668230086
solo acc is  0.1040833334896653
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(142.5959, device='cuda:3')
compute_norm is  tensor(53.5420, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.6353, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9827114055787068
avg test loss is  1.4719272222854436
avg accuracy is  0.8438333334896568
solo acc is  0.3031166668230062
compute similarity  is  tensor(0.9579, device='cuda:3')
compute_distance is  tensor(131.6353, device='cuda:3')
compute_norm is  tensor(53.1376, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.2340, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9114806293043246
avg test loss is  1.512008610310585
avg accuracy is  0.8421833334896569
solo acc is  0.26236666682300525
compute similarity  is  tensor(0.9576, device='cuda:3')
compute_distance is  tensor(133.2340, device='cuda:3')
compute_norm is  tensor(52.8571, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.6304, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8987171056428189
avg test loss is  1.47804876863321
avg accuracy is  0.8458333334896567
solo acc is  0.25785000015633847
compute similarity  is  tensor(0.9574, device='cuda:3')
compute_distance is  tensor(134.6304, device='cuda:3')
compute_norm is  tensor(52.5828, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.9715, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8850071760001721
avg test loss is  1.4631362279086733
avg accuracy is  0.8495000001563232
solo acc is  0.25031666682300496
compute similarity  is  tensor(0.9572, device='cuda:3')
compute_distance is  tensor(135.9715, device='cuda:3')
compute_norm is  tensor(52.3145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.3145, device='cuda:3')
distance x is tensor(137.3145, device='cuda:3')
________________________________
test distance is  tensor(137.3145, device='cuda:3')
test distance1 is  tensor(137.3145, device='cuda:3')
test similarity is  tensor(0.9570, device='cuda:3')
test acc is  0.2490833334896715
test loss is 1.4500527047653442
test entropy is  0.8670341342624063
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2662793397903442
mal norm is  tensor(686.6992, device='cuda:3')
distance x is tensor(137.3220, device='cuda:3')
mal distance is  tensor(137.3220, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([28, 215370])
norm res is  tensor([461.8444, 464.7374, 529.2349, 455.3397, 338.4062, 462.2426, 375.0167,
        455.0643, 686.6992, 686.6992, 686.6992, 686.6992, 686.6992, 686.6992,
        686.6992, 686.6992, 686.6992, 686.6992, 686.6992, 686.6992, 601.6834,
        590.0169, 554.6815, 618.8583, 495.8430, 583.8314, 612.8438, 596.1365],
       device='cuda:3')
sorted_norm is   tensor([338.4062, 375.0167, 455.0643, 455.3397, 461.8444, 462.2426, 464.7374,
        495.8430, 529.2349, 554.6815, 583.8314, 590.0169, 596.1365, 601.6834,
        612.8438, 618.8583, 686.6992, 686.6992, 686.6992, 686.6992, 686.6992,
        686.6992, 686.6992, 686.6992, 686.6992, 686.6992, 686.6992, 686.6992],
       device='cuda:3')
used idx is  tensor([ 4,  6,  7,  3,  0,  5,  1, 24,  2, 22, 25, 21, 27, 20, 26, 23],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 90.42% 

Test Accuracy: 89.56% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.38393768668174744
distance x is tensor(91.1109, device='cuda:3')
benign distance is  tensor(91.1109, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5986121296882629
distance x is tensor(116.6724, device='cuda:3')
benign distance is  tensor(116.6724, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1557098925113678
distance x is tensor(121.0912, device='cuda:3')
benign distance is  tensor(121.0912, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3509056270122528
distance x is tensor(108.7196, device='cuda:3')
benign distance is  tensor(108.7196, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.21889981627464294
distance x is tensor(110.0770, device='cuda:3')
benign distance is  tensor(110.0770, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7520025968551636
distance x is tensor(105.7461, device='cuda:3')
benign distance is  tensor(105.7461, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.42374998331069946
distance x is tensor(114.6376, device='cuda:3')
benign distance is  tensor(114.6376, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21666660904884338
distance x is tensor(111.4340, device='cuda:3')
benign distance is  tensor(111.4340, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.28856560587882996
distance x is tensor(126.6559, device='cuda:3')
benign distance is  tensor(126.6559, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8003403544425964
distance x is tensor(148.8340, device='cuda:3')
benign distance is  tensor(148.8340, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.14393268525600433
distance x is tensor(142.8661, device='cuda:3')
benign distance is  tensor(142.8661, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0105072259902954
distance x is tensor(130.2957, device='cuda:3')
benign distance is  tensor(130.2957, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3138381838798523
distance x is tensor(120.6994, device='cuda:3')
benign distance is  tensor(120.6994, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.287070095539093
distance x is tensor(140.2053, device='cuda:3')
benign distance is  tensor(140.2053, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6507579684257507
distance x is tensor(131.2259, device='cuda:3')
benign distance is  tensor(131.2259, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.881374716758728
distance x is tensor(139.5891, device='cuda:3')
benign distance is  tensor(139.5891, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(133.7088, device='cuda:3')
compute distance is  tensor(133.7088, device='cuda:3')
compute norm is  tensor(53.5639, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.3448, device='cuda:3')
compute distance is  tensor(145.3448, device='cuda:3')
compute norm is  tensor(53.6176, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.3374, device='cuda:3')
compute distance is  tensor(155.3374, device='cuda:3')
compute norm is  tensor(54.1596, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.6358, device='cuda:3')
compute distance is  tensor(141.6358, device='cuda:3')
compute norm is  tensor(53.6433, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.9456, device='cuda:3')
compute distance is  tensor(146.9456, device='cuda:3')
compute norm is  tensor(53.8827, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.0667, device='cuda:3')
compute distance is  tensor(162.0667, device='cuda:3')
compute norm is  tensor(54.0746, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9573, device='cuda:3')
compute distance is  tensor(136.9573, device='cuda:3')
compute norm is  tensor(53.6550, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5087, device='cuda:3')
compute distance is  tensor(148.5087, device='cuda:3')
compute norm is  tensor(53.8697, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.6830, device='cuda:3')
compute distance is  tensor(156.6830, device='cuda:3')
compute norm is  tensor(53.8778, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.8963, device='cuda:3')
compute distance is  tensor(135.8963, device='cuda:3')
compute norm is  tensor(53.5890, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.1200, device='cuda:3')
compute distance is  tensor(151.1200, device='cuda:3')
compute norm is  tensor(54.0802, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.4324, device='cuda:3')
compute distance is  tensor(141.4324, device='cuda:3')
compute norm is  tensor(53.7621, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.0667, device='cuda:3')
distance x is tensor(107699.8281, device='cuda:3')
distance x is tensor(107699.8281, device='cuda:3')
________________________________
test distance is  tensor(107699.8281, device='cuda:3')
test distance1 is  tensor(107699.8281, device='cuda:3')
test similarity is  tensor(0.0566, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130065141504493.44
test entropy is  0.0
________________________________
cal ratio is  0.03801591435193748
distance x is tensor(4094.3125, device='cuda:3')
cal_distance is  tensor(4094.3125, device='cuda:3')
cal ratio is  0.19497658483516814
distance x is tensor(798.2993, device='cuda:3')
cal_distance is  tensor(798.2993, device='cuda:3')
cal ratio is  0.44156035646159936
distance x is tensor(352.5002, device='cuda:3')
cal_distance is  tensor(352.5002, device='cuda:3')
cal ratio is  0.6644973865727455
distance x is tensor(234.2372, device='cuda:3')
cal_distance is  tensor(234.2372, device='cuda:3')
cal ratio is  0.8151640076548728
distance x is tensor(190.9427, device='cuda:3')
cal_distance is  tensor(190.9427, device='cuda:3')
cal ratio is  0.902862109560567
distance x is tensor(172.3954, device='cuda:3')
cal_distance is  tensor(172.3954, device='cuda:3')
cal ratio is  0.950189140464442
distance x is tensor(163.8085, device='cuda:3')
cal_distance is  tensor(163.8085, device='cuda:3')
cal ratio is  0.974775733806673
distance x is tensor(159.6767, device='cuda:3')
cal_distance is  tensor(159.6767, device='cuda:3')
distance x is tensor(159.6767, device='cuda:3')
return_distance is  tensor(159.6767, device='cuda:3')
distance x is tensor(159.6664, device='cuda:3')
distance x is tensor(159.6664, device='cuda:3')
________________________________
test distance is  tensor(159.6664, device='cuda:3')
test distance1 is  tensor(159.6664, device='cuda:3')
test similarity is  tensor(0.9456, device='cuda:3')
test acc is  0.10206666682299863
test loss is 396.3585388899358
test entropy is  0.000701623355758629
________________________________
0
distance x is tensor(159.6664, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0007491183882857416
avg test loss is  395.4602048503819
avg accuracy is  0.4287333334896748
solo acc is  0.10196666682299864
compute similarity  is  tensor(0.9456, device='cuda:3')
compute_distance is  tensor(159.6664, device='cuda:3')
compute_norm is  tensor(54.4880, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.3056, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1438535409949735
avg test loss is  1.7256830351184935
avg accuracy is  0.7408500001563283
solo acc is  0.24808333348967151
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(154.3056, device='cuda:3')
compute_norm is  tensor(54.6825, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.4774, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6667475145635828
avg test loss is  2.6160536473239664
avg accuracy is  0.7016000001563305
solo acc is  0.11390000015633193
compute similarity  is  tensor(0.9461, device='cuda:3')
compute_distance is  tensor(156.4774, device='cuda:3')
compute_norm is  tensor(54.4964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.5778, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.030458980722468
avg test loss is  1.5821272381333147
avg accuracy is  0.758316666822994
solo acc is  0.23821666682300452
compute similarity  is  tensor(0.9461, device='cuda:3')
compute_distance is  tensor(157.5778, device='cuda:3')
compute_norm is  tensor(54.2062, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(158.9478, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6181465477259682
avg test loss is  2.41283388051397
avg accuracy is  0.7238666668229959
solo acc is  0.10980000015633196
compute similarity  is  tensor(0.9457, device='cuda:3')
compute_distance is  tensor(158.9478, device='cuda:3')
compute_norm is  tensor(53.9997, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.8809, device='cuda:3')
distance x is tensor(159.8809, device='cuda:3')
________________________________
test distance is  tensor(159.8809, device='cuda:3')
test distance1 is  tensor(159.8809, device='cuda:3')
test similarity is  tensor(0.9457, device='cuda:3')
test acc is  0.25606666682300505
test loss is 1.4822594551389405
test entropy is  0.9819232520264095
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.6969102621078491
mal norm is  tensor(791.3743, device='cuda:3')
distance x is tensor(159.8876, device='cuda:3')
mal distance is  tensor(159.8876, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([413.8456, 529.9398, 522.9915, 471.0588, 475.7979, 467.1678, 493.8461,
        498.6759, 791.3743, 791.3743, 791.3743, 791.3743, 791.3743, 791.3743,
        791.3743, 791.3743, 791.3743, 791.3743, 791.3743, 791.3743],
       device='cuda:3')
sorted_norm is   tensor([413.8456, 467.1678, 471.0588, 475.7979, 493.8461, 498.6759, 522.9915,
        529.9398, 791.3743, 791.3743, 791.3743, 791.3743, 791.3743, 791.3743,
        791.3743, 791.3743, 791.3743, 791.3743, 791.3743, 791.3743],
       device='cuda:3')
used idx is  tensor([ 0,  5,  3,  4,  6,  7,  2,  1, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.38% 

Test Accuracy: 87.30% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8294858932495117
distance x is tensor(150.5940, device='cuda:3')
benign distance is  tensor(150.5940, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9079713821411133
distance x is tensor(136.9667, device='cuda:3')
benign distance is  tensor(136.9667, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.057724762707948685
distance x is tensor(132.0289, device='cuda:3')
benign distance is  tensor(132.0289, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6301562190055847
distance x is tensor(130.2542, device='cuda:3')
benign distance is  tensor(130.2542, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.679977297782898
distance x is tensor(103.9138, device='cuda:3')
benign distance is  tensor(103.9138, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6308881640434265
distance x is tensor(152.2175, device='cuda:3')
benign distance is  tensor(152.2175, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16799648106098175
distance x is tensor(144.5806, device='cuda:3')
benign distance is  tensor(144.5806, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3437531292438507
distance x is tensor(160.7978, device='cuda:3')
benign distance is  tensor(160.7978, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(153.4015, device='cuda:3')
compute distance is  tensor(153.4015, device='cuda:3')
compute norm is  tensor(54.0436, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.0603, device='cuda:3')
compute distance is  tensor(169.0603, device='cuda:3')
compute norm is  tensor(54.3041, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.6481, device='cuda:3')
compute distance is  tensor(172.6481, device='cuda:3')
compute norm is  tensor(54.6915, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.8743, device='cuda:3')
compute distance is  tensor(153.8743, device='cuda:3')
compute norm is  tensor(54.0151, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.0388, device='cuda:3')
compute distance is  tensor(171.0388, device='cuda:3')
compute norm is  tensor(54.4885, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.8167, device='cuda:3')
compute distance is  tensor(160.8167, device='cuda:3')
compute norm is  tensor(54.4263, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.6146, device='cuda:3')
compute distance is  tensor(161.6146, device='cuda:3')
compute norm is  tensor(54.2016, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.6720, device='cuda:3')
compute distance is  tensor(167.6720, device='cuda:3')
compute norm is  tensor(54.3799, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.0297, device='cuda:3')
compute distance is  tensor(166.0297, device='cuda:3')
compute norm is  tensor(54.4444, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.0696, device='cuda:3')
compute distance is  tensor(159.0696, device='cuda:3')
compute norm is  tensor(54.3400, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.5959, device='cuda:3')
compute distance is  tensor(178.5959, device='cuda:3')
compute norm is  tensor(54.7700, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.9302, device='cuda:3')
compute distance is  tensor(164.9302, device='cuda:3')
compute norm is  tensor(54.3356, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(178.5959, device='cuda:3')
distance x is tensor(107675.2031, device='cuda:3')
distance x is tensor(107675.2031, device='cuda:3')
________________________________
test distance is  tensor(107675.2031, device='cuda:3')
test distance1 is  tensor(107675.2031, device='cuda:3')
test similarity is  tensor(0.1436, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130084424785832.67
test entropy is  0.0
________________________________
cal ratio is  0.039912044048722554
distance x is tensor(4297.5435, device='cuda:3')
cal_distance is  tensor(4297.5435, device='cuda:3')
cal ratio is  0.19977985258686257
distance x is tensor(858.5668, device='cuda:3')
cal_distance is  tensor(858.5668, device='cuda:3')
cal ratio is  0.44696628557182033
distance x is tensor(383.7532, device='cuda:3')
cal_distance is  tensor(383.7532, device='cuda:3')
cal ratio is  0.668552925653613
distance x is tensor(256.5611, device='cuda:3')
cal_distance is  tensor(256.5611, device='cuda:3')
cal ratio is  0.8176481282045686
distance x is tensor(209.7776, device='cuda:3')
cal_distance is  tensor(209.7776, device='cuda:3')
cal ratio is  0.9042369111779902
distance x is tensor(189.6892, device='cuda:3')
cal_distance is  tensor(189.6892, device='cuda:3')
cal ratio is  0.9509124397162378
distance x is tensor(180.3780, device='cuda:3')
cal_distance is  tensor(180.3780, device='cuda:3')
cal ratio is  0.9751467796884137
distance x is tensor(175.8952, device='cuda:3')
cal_distance is  tensor(175.8952, device='cuda:3')
distance x is tensor(175.8952, device='cuda:3')
return_distance is  tensor(175.8952, device='cuda:3')
distance x is tensor(175.8849, device='cuda:3')
distance x is tensor(175.8849, device='cuda:3')
________________________________
test distance is  tensor(175.8849, device='cuda:3')
test distance1 is  tensor(175.8849, device='cuda:3')
test similarity is  tensor(0.9409, device='cuda:3')
test acc is  0.13905000015633218
test loss is 187.02688901205815
test entropy is  0.015481140174722368
________________________________
0
distance x is tensor(175.8849, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.015266317776256708
avg test loss is  185.64958195798178
avg accuracy is  0.7007166668229972
solo acc is  0.1413833334896657
compute similarity  is  tensor(0.9409, device='cuda:3')
compute_distance is  tensor(175.8849, device='cuda:3')
compute_norm is  tensor(56.0887, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.7104, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9488161844231172
avg test loss is  1.4618413703782218
avg accuracy is  0.7634500001563271
solo acc is  0.3047833334896729
compute similarity  is  tensor(0.9443, device='cuda:3')
compute_distance is  tensor(160.7104, device='cuda:3')
compute_norm is  tensor(55.7310, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(160.7104, device='cuda:3')
distance x is tensor(160.7104, device='cuda:3')
________________________________
test distance is  tensor(160.7104, device='cuda:3')
test distance1 is  tensor(160.7104, device='cuda:3')
test similarity is  tensor(0.9443, device='cuda:3')
test acc is  0.30460000015633965
test loss is 1.4655883825664073
test entropy is  0.9465889562803037
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3330366611480713
mal norm is  tensor(860.7195, device='cuda:3')
distance x is tensor(160.7204, device='cuda:3')
mal distance is  tensor(160.7204, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 31
weight size is  torch.Size([52, 215370])
norm res is  tensor([650.8449, 582.9232, 568.2344, 562.0781, 445.7220, 653.7196, 619.5556,
        693.4304, 860.7195, 860.7195, 860.7195, 860.7195, 860.7195, 860.7195,
        860.7195, 860.7195, 860.7195, 860.7195, 860.7195, 860.7195, 715.0788,
        672.0952, 652.6036, 714.0048, 689.1799, 695.9543, 725.4944, 739.6417,
        780.5933, 568.1426, 701.4841, 657.6071, 647.5912, 712.9552, 670.2967,
        676.7529, 634.6354, 741.8546, 614.7126, 676.0919, 712.2059, 629.2971,
        676.9104, 668.7128, 630.5946, 709.4745, 689.8795, 635.7531, 611.6514,
        682.4954, 651.3907, 675.1901], device='cuda:3')
sorted_norm is   tensor([445.7220, 562.0781, 568.1426, 568.2344, 582.9232, 611.6514, 614.7126,
        619.5556, 629.2971, 630.5946, 634.6354, 635.7531, 647.5912, 650.8449,
        651.3907, 652.6036, 653.7196, 657.6071, 668.7128, 670.2967, 672.0952,
        675.1901, 676.0919, 676.7529, 676.9104, 682.4954, 689.1799, 689.8795,
        693.4304, 695.9543, 701.4841, 709.4745, 712.2059, 712.9552, 714.0048,
        715.0788, 725.4944, 739.6417, 741.8546, 780.5933, 860.7195, 860.7195,
        860.7195, 860.7195, 860.7195, 860.7195, 860.7195, 860.7195, 860.7195,
        860.7195, 860.7195, 860.7195], device='cuda:3')
used idx is  tensor([ 4,  3, 29,  2,  1, 48, 38,  6, 41, 44, 36, 47, 32,  0, 50, 22,  5, 31,
        43, 34, 21, 51, 39, 35, 42, 49, 24, 46,  7, 25, 30], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 90.62% 

Test Accuracy: 89.62% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6540127992630005
distance x is tensor(82.4254, device='cuda:3')
benign distance is  tensor(82.4254, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4723992943763733
distance x is tensor(103.8525, device='cuda:3')
benign distance is  tensor(103.8525, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19074484705924988
distance x is tensor(118.0590, device='cuda:3')
benign distance is  tensor(118.0590, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3204626142978668
distance x is tensor(89.8297, device='cuda:3')
benign distance is  tensor(89.8297, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2598939538002014
distance x is tensor(91.3594, device='cuda:3')
benign distance is  tensor(91.3594, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5040948987007141
distance x is tensor(88.3443, device='cuda:3')
benign distance is  tensor(88.3443, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.771004319190979
distance x is tensor(97.7843, device='cuda:3')
benign distance is  tensor(97.7843, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7483252286911011
distance x is tensor(98.0545, device='cuda:3')
benign distance is  tensor(98.0545, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3698691725730896
distance x is tensor(130.1321, device='cuda:3')
benign distance is  tensor(130.1321, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.34768152236938477
distance x is tensor(138.1241, device='cuda:3')
benign distance is  tensor(138.1241, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9078734517097473
distance x is tensor(117.7414, device='cuda:3')
benign distance is  tensor(117.7414, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8646098971366882
distance x is tensor(130.7801, device='cuda:3')
benign distance is  tensor(130.7801, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0796916484832764
distance x is tensor(123.8527, device='cuda:3')
benign distance is  tensor(123.8527, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3234124779701233
distance x is tensor(123.3853, device='cuda:3')
benign distance is  tensor(123.3853, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8572345972061157
distance x is tensor(125.4955, device='cuda:3')
benign distance is  tensor(125.4955, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.975372314453125
distance x is tensor(142.3282, device='cuda:3')
benign distance is  tensor(142.3282, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.21250620484352112
distance x is tensor(133.8437, device='cuda:3')
benign distance is  tensor(133.8437, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7026076316833496
distance x is tensor(150.9354, device='cuda:3')
benign distance is  tensor(150.9354, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2456340491771698
distance x is tensor(120.0878, device='cuda:3')
benign distance is  tensor(120.0878, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6208491325378418
distance x is tensor(131.6253, device='cuda:3')
benign distance is  tensor(131.6253, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3850036561489105
distance x is tensor(145.5130, device='cuda:3')
benign distance is  tensor(145.5130, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8997122049331665
distance x is tensor(127.5907, device='cuda:3')
benign distance is  tensor(127.5907, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.328962117433548
distance x is tensor(128.9732, device='cuda:3')
benign distance is  tensor(128.9732, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3432193398475647
distance x is tensor(128.2515, device='cuda:3')
benign distance is  tensor(128.2515, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.24839898943901062
distance x is tensor(152.8367, device='cuda:3')
benign distance is  tensor(152.8367, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7923062443733215
distance x is tensor(123.3949, device='cuda:3')
benign distance is  tensor(123.3949, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.17940323054790497
distance x is tensor(161.5616, device='cuda:3')
benign distance is  tensor(161.5616, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.16822457313537598
distance x is tensor(138.7390, device='cuda:3')
benign distance is  tensor(138.7390, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5732200741767883
distance x is tensor(127.5713, device='cuda:3')
benign distance is  tensor(127.5713, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4065667986869812
distance x is tensor(143.1369, device='cuda:3')
benign distance is  tensor(143.1369, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3318793773651123
distance x is tensor(139.6225, device='cuda:3')
benign distance is  tensor(139.6225, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.23896090686321259
distance x is tensor(135.5451, device='cuda:3')
benign distance is  tensor(135.5451, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3779227137565613
distance x is tensor(142.5837, device='cuda:3')
benign distance is  tensor(142.5837, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.21997413039207458
distance x is tensor(127.3810, device='cuda:3')
benign distance is  tensor(127.3810, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.278891921043396
distance x is tensor(122.6145, device='cuda:3')
benign distance is  tensor(122.6145, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.16156260669231415
distance x is tensor(149.4020, device='cuda:3')
benign distance is  tensor(149.4020, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4256202280521393
distance x is tensor(130.4450, device='cuda:3')
benign distance is  tensor(130.4450, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5489034652709961
distance x is tensor(134.9142, device='cuda:3')
benign distance is  tensor(134.9142, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6278037428855896
distance x is tensor(125.4455, device='cuda:3')
benign distance is  tensor(125.4455, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5287846922874451
distance x is tensor(151.7226, device='cuda:3')
benign distance is  tensor(151.7226, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(124.4919, device='cuda:3')
compute distance is  tensor(124.4919, device='cuda:3')
compute norm is  tensor(53.4777, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2512, device='cuda:3')
compute distance is  tensor(131.2512, device='cuda:3')
compute norm is  tensor(53.6464, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6201, device='cuda:3')
compute distance is  tensor(137.6201, device='cuda:3')
compute norm is  tensor(53.9809, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1019, device='cuda:3')
compute distance is  tensor(128.1019, device='cuda:3')
compute norm is  tensor(53.6265, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5620, device='cuda:3')
compute distance is  tensor(133.5620, device='cuda:3')
compute norm is  tensor(53.7255, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4210, device='cuda:3')
compute distance is  tensor(146.4210, device='cuda:3')
compute norm is  tensor(53.9998, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1929, device='cuda:3')
compute distance is  tensor(135.1929, device='cuda:3')
compute norm is  tensor(53.9034, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3810, device='cuda:3')
compute distance is  tensor(142.3810, device='cuda:3')
compute norm is  tensor(53.8156, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.6906, device='cuda:3')
compute distance is  tensor(141.6906, device='cuda:3')
compute norm is  tensor(53.8898, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7889, device='cuda:3')
compute distance is  tensor(128.7889, device='cuda:3')
compute norm is  tensor(53.7147, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.8335, device='cuda:3')
compute distance is  tensor(144.8335, device='cuda:3')
compute norm is  tensor(54.0217, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.7694, device='cuda:3')
compute distance is  tensor(139.7694, device='cuda:3')
compute norm is  tensor(53.9354, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.4210, device='cuda:3')
distance x is tensor(107700.2422, device='cuda:3')
distance x is tensor(107700.2422, device='cuda:3')
________________________________
test distance is  tensor(107700.2422, device='cuda:3')
test distance1 is  tensor(107700.2422, device='cuda:3')
test similarity is  tensor(0.0678, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130084826696741.12
test entropy is  0.0
________________________________
cal ratio is  0.036134282557765456
distance x is tensor(3891.6765, device='cuda:3')
cal_distance is  tensor(3891.6765, device='cuda:3')
cal ratio is  0.19009005912055368
distance x is tensor(739.7732, device='cuda:3')
cal_distance is  tensor(739.7732, device='cuda:3')
cal ratio is  0.4359919595985911
distance x is tensor(322.5381, device='cuda:3')
cal_distance is  tensor(322.5381, device='cuda:3')
cal ratio is  0.6602938476993556
distance x is tensor(212.9717, device='cuda:3')
cal_distance is  tensor(212.9717, device='cuda:3')
cal ratio is  0.8125812103620748
distance x is tensor(173.0578, device='cuda:3')
cal_distance is  tensor(173.0578, device='cuda:3')
cal ratio is  0.9014304091611002
distance x is tensor(156.0001, device='cuda:3')
cal_distance is  tensor(156.0001, device='cuda:3')
cal ratio is  0.9494352647665788
distance x is tensor(148.1123, device='cuda:3')
cal_distance is  tensor(148.1123, device='cuda:3')
cal ratio is  0.9743887726726125
distance x is tensor(144.3190, device='cuda:3')
cal_distance is  tensor(144.3190, device='cuda:3')
distance x is tensor(144.3190, device='cuda:3')
return_distance is  tensor(144.3190, device='cuda:3')
distance x is tensor(144.3087, device='cuda:3')
distance x is tensor(144.3087, device='cuda:3')
________________________________
test distance is  tensor(144.3087, device='cuda:3')
test distance1 is  tensor(144.3087, device='cuda:3')
test similarity is  tensor(0.9553, device='cuda:3')
test acc is  0.1149166668229986
test loss is 200.01363149939823
test entropy is  0.0051901746949351065
________________________________
0
distance x is tensor(144.3087, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.004596677992456335
avg test loss is  200.48113299534518
avg accuracy is  0.6518833334896671
solo acc is  0.11471666682299861
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(144.3087, device='cuda:3')
compute_norm is  tensor(54.3274, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.1173, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9469215191884844
avg test loss is  1.414030689674654
avg accuracy is  0.8435833334896568
solo acc is  0.31988333348967324
compute similarity  is  tensor(0.9579, device='cuda:3')
compute_distance is  tensor(135.1173, device='cuda:3')
compute_norm is  tensor(53.9516, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.6637, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9033799152384435
avg test loss is  1.502720904121521
avg accuracy is  0.8427833334896568
solo acc is  0.2562000001563384
compute similarity  is  tensor(0.9577, device='cuda:3')
compute_distance is  tensor(136.6637, device='cuda:3')
compute_norm is  tensor(53.6625, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(137.9941, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8837045400635775
avg test loss is  1.4833730161825478
avg accuracy is  0.8421666668229902
solo acc is  0.2542333334896717
compute similarity  is  tensor(0.9575, device='cuda:3')
compute_distance is  tensor(137.9941, device='cuda:3')
compute_norm is  tensor(53.3838, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.2530, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8817232001437816
avg test loss is  1.4472616286928466
avg accuracy is  0.84691666682299
solo acc is  0.25500000015633845
compute similarity  is  tensor(0.9573, device='cuda:3')
compute_distance is  tensor(139.2530, device='cuda:3')
compute_norm is  tensor(53.1109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(140.4734, device='cuda:3')
distance x is tensor(140.4734, device='cuda:3')
________________________________
test distance is  tensor(140.4734, device='cuda:3')
test distance1 is  tensor(140.4734, device='cuda:3')
test similarity is  tensor(0.9571, device='cuda:3')
test acc is  0.25673333348967187
test loss is 1.4184946961748575
test entropy is  0.8766386381852855
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3279359340667725
mal norm is  tensor(698.3247, device='cuda:3')
distance x is tensor(140.4810, device='cuda:3')
mal distance is  tensor(140.4810, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 12
weight size is  torch.Size([20, 215370])
norm res is  tensor([364.4098, 454.9291, 508.0182, 390.4220, 399.7261, 383.5672, 418.4664,
        431.7479, 698.3247, 698.3247, 698.3247, 698.3247, 698.3247, 698.3247,
        698.3247, 698.3247, 698.3247, 698.3247, 698.3247, 698.3247],
       device='cuda:3')
sorted_norm is   tensor([364.4098, 383.5672, 390.4220, 399.7261, 418.4664, 431.7479, 454.9291,
        508.0182, 698.3247, 698.3247, 698.3247, 698.3247, 698.3247, 698.3247,
        698.3247, 698.3247, 698.3247, 698.3247, 698.3247, 698.3247],
       device='cuda:3')
used idx is  tensor([ 0,  5,  3,  4,  6,  7,  1,  2, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.90% 

Test Accuracy: 88.02% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6352502703666687
distance x is tensor(137.4510, device='cuda:3')
benign distance is  tensor(137.4510, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7486144304275513
distance x is tensor(123.7956, device='cuda:3')
benign distance is  tensor(123.7956, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4181445240974426
distance x is tensor(136.8970, device='cuda:3')
benign distance is  tensor(136.8970, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4239770770072937
distance x is tensor(110.5687, device='cuda:3')
benign distance is  tensor(110.5687, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1634118556976318
distance x is tensor(126.0999, device='cuda:3')
benign distance is  tensor(126.0999, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5078542232513428
distance x is tensor(127.0561, device='cuda:3')
benign distance is  tensor(127.0561, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22037920355796814
distance x is tensor(135.2676, device='cuda:3')
benign distance is  tensor(135.2676, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6078876256942749
distance x is tensor(118.3201, device='cuda:3')
benign distance is  tensor(118.3201, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(163.4552, device='cuda:3')
compute distance is  tensor(163.4552, device='cuda:3')
compute norm is  tensor(54.3266, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3080, device='cuda:3')
compute distance is  tensor(148.3080, device='cuda:3')
compute norm is  tensor(53.8780, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3852, device='cuda:3')
compute distance is  tensor(148.3852, device='cuda:3')
compute norm is  tensor(54.1341, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.9017, device='cuda:3')
compute distance is  tensor(148.9017, device='cuda:3')
compute norm is  tensor(53.9347, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.6082, device='cuda:3')
compute distance is  tensor(165.6082, device='cuda:3')
compute norm is  tensor(54.3105, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.3618, device='cuda:3')
compute distance is  tensor(169.3618, device='cuda:3')
compute norm is  tensor(54.5062, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1757, device='cuda:3')
compute distance is  tensor(146.1757, device='cuda:3')
compute norm is  tensor(54.1057, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7142, device='cuda:3')
compute distance is  tensor(142.7142, device='cuda:3')
compute norm is  tensor(53.8964, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.7832, device='cuda:3')
compute distance is  tensor(153.7832, device='cuda:3')
compute norm is  tensor(54.1421, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4589, device='cuda:3')
compute distance is  tensor(150.4589, device='cuda:3')
compute norm is  tensor(54.2633, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.5636, device='cuda:3')
compute distance is  tensor(166.5636, device='cuda:3')
compute norm is  tensor(54.3081, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.4494, device='cuda:3')
compute distance is  tensor(155.4494, device='cuda:3')
compute norm is  tensor(53.9703, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(169.3618, device='cuda:3')
distance x is tensor(107669.8672, device='cuda:3')
distance x is tensor(107669.8672, device='cuda:3')
________________________________
test distance is  tensor(107669.8672, device='cuda:3')
test distance1 is  tensor(107669.8672, device='cuda:3')
test similarity is  tensor(0.1535, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130081018143506.02
test entropy is  0.0
________________________________
cal ratio is  0.038867510343773115
distance x is tensor(4184.8652, device='cuda:3')
cal_distance is  tensor(4184.8652, device='cuda:3')
cal ratio is  0.19714831046683653
distance x is tensor(825.0433, device='cuda:3')
cal_distance is  tensor(825.0433, device='cuda:3')
cal ratio is  0.44401273777449196
distance x is tensor(366.3326, device='cuda:3')
cal_distance is  tensor(366.3326, device='cuda:3')
cal ratio is  0.6663402026899204
distance x is tensor(244.1039, device='cuda:3')
cal_distance is  tensor(244.1039, device='cuda:3')
cal ratio is  0.8162937303018888
distance x is tensor(199.2614, device='cuda:3')
cal_distance is  tensor(199.2614, device='cuda:3')
cal ratio is  0.9034875552001703
distance x is tensor(180.0307, device='cuda:3')
cal_distance is  tensor(180.0307, device='cuda:3')
cal ratio is  0.9505183533783353
distance x is tensor(171.1228, device='cuda:3')
cal_distance is  tensor(171.1228, device='cuda:3')
cal ratio is  0.9749444672468677
distance x is tensor(166.8353, device='cuda:3')
cal_distance is  tensor(166.8353, device='cuda:3')
distance x is tensor(166.8353, device='cuda:3')
return_distance is  tensor(166.8353, device='cuda:3')
distance x is tensor(166.8250, device='cuda:3')
distance x is tensor(166.8250, device='cuda:3')
________________________________
test distance is  tensor(166.8250, device='cuda:3')
test distance1 is  tensor(166.8250, device='cuda:3')
test similarity is  tensor(0.9466, device='cuda:3')
test acc is  0.10086666682299864
test loss is 373.6950679689582
test entropy is  0.0003983140788082983
________________________________
0
distance x is tensor(166.8250, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.000512687500723126
avg test loss is  372.9173908355648
avg accuracy is  0.38268333348967426
solo acc is  0.10101666682299863
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(166.8250, device='cuda:3')
compute_norm is  tensor(55.8896, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.7728, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.149886599926552
avg test loss is  1.7482851096816154
avg accuracy is  0.5803166668230059
solo acc is  0.21985000015633716
compute similarity  is  tensor(0.9478, device='cuda:3')
compute_distance is  tensor(160.7728, device='cuda:3')
compute_norm is  tensor(56.3499, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.3211, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.668665812849236
avg test loss is  2.532664773814968
avg accuracy is  0.46180000015634176
solo acc is  0.11146666682299862
compute similarity  is  tensor(0.9476, device='cuda:3')
compute_distance is  tensor(162.3211, device='cuda:3')
compute_norm is  tensor(56.1744, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.0976, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0200244407536887
avg test loss is  1.5422677554047184
avg accuracy is  0.5852166668230055
solo acc is  0.24110000015633792
compute similarity  is  tensor(0.9479, device='cuda:3')
compute_distance is  tensor(163.0976, device='cuda:3')
compute_norm is  tensor(55.8676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.0746, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6187631827173457
avg test loss is  2.376630530682708
avg accuracy is  0.46091666682300847
solo acc is  0.10701666682299862
compute similarity  is  tensor(0.9476, device='cuda:3')
compute_distance is  tensor(164.0746, device='cuda:3')
compute_norm is  tensor(55.6626, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.7312, device='cuda:3')
distance x is tensor(164.7312, device='cuda:3')
________________________________
test distance is  tensor(164.7312, device='cuda:3')
test distance1 is  tensor(164.7312, device='cuda:3')
test similarity is  tensor(0.9477, device='cuda:3')
test acc is  0.2424666668230047
test loss is 1.4775006340256631
test entropy is  0.9873145514968108
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.7590219974517822
mal norm is  tensor(817.4970, device='cuda:3')
distance x is tensor(164.7393, device='cuda:3')
mal distance is  tensor(164.7393, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 21
weight size is  torch.Size([36, 215370])
norm res is  tensor([599.8451, 529.6259, 602.1436, 474.3125, 538.0056, 551.7257, 566.3698,
        512.2303, 817.4970, 817.4970, 817.4970, 817.4970, 817.4970, 817.4970,
        817.4970, 817.4970, 817.4970, 817.4970, 817.4970, 817.4970, 685.2278,
        699.8091, 685.3433, 664.1038, 655.3016, 655.7004, 652.3648, 682.7200,
        626.9746, 659.9644, 575.3243, 628.5342, 607.3594, 604.4238, 608.1144,
        683.3068], device='cuda:3')
sorted_norm is   tensor([474.3125, 512.2303, 529.6259, 538.0056, 551.7257, 566.3698, 575.3243,
        599.8451, 602.1436, 604.4238, 607.3594, 608.1144, 626.9746, 628.5342,
        652.3648, 655.3016, 655.7004, 659.9644, 664.1038, 682.7200, 683.3068,
        685.2278, 685.3433, 699.8091, 817.4970, 817.4970, 817.4970, 817.4970,
        817.4970, 817.4970, 817.4970, 817.4970, 817.4970, 817.4970, 817.4970,
        817.4970], device='cuda:3')
used idx is  tensor([ 3,  7,  1,  4,  5,  6, 30,  0,  2, 33, 32, 34, 28, 31, 26, 24, 25, 29,
        23, 27, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 90.31% 

Test Accuracy: 89.57% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 90.31%
|----0th round Training Accuracy : 88.54%
|----1th round Training Accuracy : 89.42%
|----2th round Training Accuracy : 89.32%
|----3th round Training Accuracy : 89.53%
|----4th round Training Accuracy : 86.59%
|----5th round Training Accuracy : 89.92%
|----6th round Training Accuracy : 88.86%
|----7th round Training Accuracy : 89.70%
|----8th round Training Accuracy : 89.82%
|----9th round Training Accuracy : 89.53%
|----10th round Training Accuracy : 88.34%
|----11th round Training Accuracy : 90.00%
|----12th round Training Accuracy : 89.22%
|----13th round Training Accuracy : 90.08%
|----14th round Training Accuracy : 90.13%
|----15th round Training Accuracy : 90.25%
|----16th round Training Accuracy : 89.09%
|----17th round Training Accuracy : 90.37%
|----18th round Training Accuracy : 89.38%
|----19th round Training Accuracy : 90.38%
|----20th round Training Accuracy : 90.17%
|----21th round Training Accuracy : 90.42%
|----22th round Training Accuracy : 89.03%
|----23th round Training Accuracy : 90.32%
|----24th round Training Accuracy : 90.33%
|----25th round Training Accuracy : 90.32%
|----26th round Training Accuracy : 90.23%
|----27th round Training Accuracy : 90.38%
|----28th round Training Accuracy : 89.27%
|----29th round Training Accuracy : 90.43%
|----30th round Training Accuracy : 89.23%
|----31th round Training Accuracy : 90.46%
|----32th round Training Accuracy : 90.20%
|----33th round Training Accuracy : 90.39%
|----34th round Training Accuracy : 90.28%
|----35th round Training Accuracy : 90.57%
|----36th round Training Accuracy : 89.38%
|----37th round Training Accuracy : 90.40%
|----38th round Training Accuracy : 90.45%
|----39th round Training Accuracy : 90.51%
|----40th round Training Accuracy : 89.47%
|----41th round Training Accuracy : 90.53%
|----42th round Training Accuracy : 88.98%
|----43th round Training Accuracy : 90.53%
|----44th round Training Accuracy : 90.45%
|----45th round Training Accuracy : 90.42%
|----46th round Training Accuracy : 88.38%
|----47th round Training Accuracy : 90.62%
|----48th round Training Accuracy : 88.90%
|----49th round Training Accuracy : 90.31%
|----Final Test Accuracy: 89.57%
|----0th round Final Test Accuracy : 87.62%
|----1th round Final Test Accuracy : 88.78%
|----2th round Final Test Accuracy : 88.54%
|----3th round Final Test Accuracy : 88.85%
|----4th round Final Test Accuracy : 85.44%
|----5th round Final Test Accuracy : 88.95%
|----6th round Final Test Accuracy : 87.92%
|----7th round Final Test Accuracy : 88.97%
|----8th round Final Test Accuracy : 89.16%
|----9th round Final Test Accuracy : 88.95%
|----10th round Final Test Accuracy : 87.32%
|----11th round Final Test Accuracy : 89.19%
|----12th round Final Test Accuracy : 88.24%
|----13th round Final Test Accuracy : 89.23%
|----14th round Final Test Accuracy : 89.37%
|----15th round Final Test Accuracy : 89.30%
|----16th round Final Test Accuracy : 88.34%
|----17th round Final Test Accuracy : 89.23%
|----18th round Final Test Accuracy : 88.45%
|----19th round Final Test Accuracy : 89.19%
|----20th round Final Test Accuracy : 89.47%
|----21th round Final Test Accuracy : 89.52%
|----22th round Final Test Accuracy : 88.30%
|----23th round Final Test Accuracy : 89.36%
|----24th round Final Test Accuracy : 89.54%
|----25th round Final Test Accuracy : 89.31%
|----26th round Final Test Accuracy : 89.35%
|----27th round Final Test Accuracy : 89.52%
|----28th round Final Test Accuracy : 88.53%
|----29th round Final Test Accuracy : 89.43%
|----30th round Final Test Accuracy : 88.23%
|----31th round Final Test Accuracy : 89.34%
|----32th round Final Test Accuracy : 89.57%
|----33th round Final Test Accuracy : 89.37%
|----34th round Final Test Accuracy : 89.37%
|----35th round Final Test Accuracy : 89.60%
|----36th round Final Test Accuracy : 88.55%
|----37th round Final Test Accuracy : 89.17%
|----38th round Final Test Accuracy : 89.70%
|----39th round Final Test Accuracy : 89.50%
|----40th round Final Test Accuracy : 88.56%
|----41th round Final Test Accuracy : 89.60%
|----42th round Final Test Accuracy : 88.07%
|----43th round Final Test Accuracy : 89.28%
|----44th round Final Test Accuracy : 89.68%
|----45th round Final Test Accuracy : 89.56%
|----46th round Final Test Accuracy : 87.30%
|----47th round Final Test Accuracy : 89.62%
|----48th round Final Test Accuracy : 88.02%
|----49th round Final Test Accuracy : 89.57%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 12514.1487
