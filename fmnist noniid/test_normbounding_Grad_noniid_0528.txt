
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7673109602183104
distance x is tensor(128.1844, device='cuda:3')
benign distance is  tensor(128.1844, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7837794721126556
distance x is tensor(108.6057, device='cuda:3')
benign distance is  tensor(108.6057, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5962155666202307
distance x is tensor(110.4066, device='cuda:3')
benign distance is  tensor(110.4066, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0186173431575298
distance x is tensor(156.0760, device='cuda:3')
benign distance is  tensor(156.0760, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8224674612283707
distance x is tensor(100.1433, device='cuda:3')
benign distance is  tensor(100.1433, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6501967119984329
distance x is tensor(92.9978, device='cuda:3')
benign distance is  tensor(92.9978, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9535393714904785
distance x is tensor(112.8942, device='cuda:3')
benign distance is  tensor(112.8942, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7471217513084412
distance x is tensor(88.1358, device='cuda:3')
benign distance is  tensor(88.1358, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.801770381629467
distance x is tensor(114.2893, device='cuda:3')
benign distance is  tensor(114.2893, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6853521154262125
distance x is tensor(128.6299, device='cuda:3')
benign distance is  tensor(128.6299, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0601457636803389
distance x is tensor(96.8499, device='cuda:3')
benign distance is  tensor(96.8499, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3456736914813519
distance x is tensor(123.4765, device='cuda:3')
benign distance is  tensor(123.4765, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1007660925388336
distance x is tensor(170.7378, device='cuda:3')
benign distance is  tensor(170.7378, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6142173307016492
distance x is tensor(66.9268, device='cuda:3')
benign distance is  tensor(66.9268, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9864748800173402
distance x is tensor(139.9382, device='cuda:3')
benign distance is  tensor(139.9382, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1244559176266193
distance x is tensor(128.6945, device='cuda:3')
benign distance is  tensor(128.6945, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.38190733268857
distance x is tensor(137.2812, device='cuda:3')
benign distance is  tensor(137.2812, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5871291132643819
distance x is tensor(112.3588, device='cuda:3')
benign distance is  tensor(112.3588, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0280118621885777
distance x is tensor(120.9762, device='cuda:3')
benign distance is  tensor(120.9762, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7112493608146906
distance x is tensor(120.3118, device='cuda:3')
benign distance is  tensor(120.3118, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0397490058094263
distance x is tensor(88.4418, device='cuda:3')
benign distance is  tensor(88.4418, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7939449064433575
distance x is tensor(207.7961, device='cuda:3')
benign distance is  tensor(207.7961, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0128703154623508
distance x is tensor(153.7574, device='cuda:3')
benign distance is  tensor(153.7574, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6297226250171661
distance x is tensor(113.3181, device='cuda:3')
benign distance is  tensor(113.3181, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9585544364526868
distance x is tensor(123.6442, device='cuda:3')
benign distance is  tensor(123.6442, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5795211885124445
distance x is tensor(78.2765, device='cuda:3')
benign distance is  tensor(78.2765, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.062519807368517
distance x is tensor(136.5578, device='cuda:3')
benign distance is  tensor(136.5578, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1853779181838036
distance x is tensor(114.4744, device='cuda:3')
benign distance is  tensor(114.4744, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.710788331925869
distance x is tensor(120.7766, device='cuda:3')
benign distance is  tensor(120.7766, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9381508640944958
distance x is tensor(128.3380, device='cuda:3')
benign distance is  tensor(128.3380, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4947897084057331
distance x is tensor(106.8300, device='cuda:3')
benign distance is  tensor(106.8300, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8232544865459204
distance x is tensor(180.1803, device='cuda:3')
benign distance is  tensor(180.1803, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7254830822348595
distance x is tensor(120.4457, device='cuda:3')
benign distance is  tensor(120.4457, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8186764810234308
distance x is tensor(106.4818, device='cuda:3')
benign distance is  tensor(106.4818, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6059881318360567
distance x is tensor(145.7755, device='cuda:3')
benign distance is  tensor(145.7755, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.0808923691511154
distance x is tensor(127.5875, device='cuda:3')
benign distance is  tensor(127.5875, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9282992742955685
distance x is tensor(118.1667, device='cuda:3')
benign distance is  tensor(118.1667, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7938502104952931
distance x is tensor(81.6787, device='cuda:3')
benign distance is  tensor(81.6787, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7441424150019884
distance x is tensor(99.5806, device='cuda:3')
benign distance is  tensor(99.5806, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8523106444627047
distance x is tensor(123.1372, device='cuda:3')
benign distance is  tensor(123.1372, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1965458448976278
distance x is tensor(111.3822, device='cuda:3')
benign distance is  tensor(111.3822, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1481023542582989
distance x is tensor(142.4266, device='cuda:3')
benign distance is  tensor(142.4266, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.246316086500883
distance x is tensor(138.6653, device='cuda:3')
benign distance is  tensor(138.6653, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0509992316365242
distance x is tensor(98.1393, device='cuda:3')
benign distance is  tensor(98.1393, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5339432191103697
distance x is tensor(154.5784, device='cuda:3')
benign distance is  tensor(154.5784, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7397977448999882
distance x is tensor(135.0389, device='cuda:3')
benign distance is  tensor(135.0389, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7632248420268297
distance x is tensor(104.1434, device='cuda:3')
benign distance is  tensor(104.1434, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5370955411344767
distance x is tensor(138.3096, device='cuda:3')
benign distance is  tensor(138.3096, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.84800000016
mal_loss is 0.5428008884191513
mal_entropy is 0.2545027881860733
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([583.0040, 503.4038, 510.4910, 719.9296, 459.4945, 420.3445, 528.3132,
        402.4641, 460.9740, 460.9741, 460.9740, 460.9741, 460.9740, 460.9741,
        460.9740, 460.9741, 460.9740, 460.9741, 460.9740, 460.9741],
       device='cuda:3')
sorted_norm is   tensor([402.4641, 420.3445, 459.4945, 460.9740, 460.9740, 460.9740, 460.9740,
        460.9740, 460.9740, 460.9741, 460.9741, 460.9741, 460.9741, 460.9741,
        460.9741, 503.4038, 510.4910, 528.3132, 583.0040, 719.9296],
       device='cuda:3')
used idx is  tensor([ 7,  5,  4, 18, 14, 16, 12,  8, 10, 11, 17, 19,  9, 15, 13,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 96.30% 

Test Accuracy: 87.27% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7428243961185217
distance x is tensor(125.4168, device='cuda:3')
benign distance is  tensor(125.4168, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9714244529604912
distance x is tensor(132.1710, device='cuda:3')
benign distance is  tensor(132.1710, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6956109758466482
distance x is tensor(120.0359, device='cuda:3')
benign distance is  tensor(120.0359, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9316357765346766
distance x is tensor(157.0864, device='cuda:3')
benign distance is  tensor(157.0864, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.764583382755518
distance x is tensor(95.3628, device='cuda:3')
benign distance is  tensor(95.3628, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7145822597667575
distance x is tensor(103.0643, device='cuda:3')
benign distance is  tensor(103.0643, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0767473299056292
distance x is tensor(119.2403, device='cuda:3')
benign distance is  tensor(119.2403, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6803207639604807
distance x is tensor(90.8944, device='cuda:3')
benign distance is  tensor(90.8944, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.70100000016
mal_loss is 1.8575401604175568
mal_entropy is 0.26327659375965595
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([586.6083, 602.8670, 571.8239, 726.5011, 426.1456, 469.4350, 551.8884,
        414.4348, 458.1769, 458.1769, 458.1769, 458.1769, 458.1769, 458.1769,
        458.1769, 458.1769, 458.1769, 458.1769, 458.1769, 458.1769, 622.5497,
        685.6792, 555.5311, 663.4824, 855.9859, 457.6476, 725.1619, 685.1631],
       device='cuda:3')
sorted_norm is   tensor([414.4348, 426.1456, 457.6476, 458.1769, 458.1769, 458.1769, 458.1769,
        458.1769, 458.1769, 458.1769, 458.1769, 458.1769, 458.1769, 458.1769,
        458.1769, 469.4350, 551.8884, 555.5311, 571.8239, 586.6083, 602.8670,
        622.5497, 663.4824, 685.1631, 685.6792, 725.1619, 726.5011, 855.9859],
       device='cuda:3')
used idx is  tensor([ 7,  4, 25, 18, 19, 15, 16, 17, 13, 12,  8,  9, 14, 10, 11,  5,  6, 22,
         2,  0,  1, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 95.84% 

Test Accuracy: 85.42% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.797709483653307
distance x is tensor(129.3501, device='cuda:3')
benign distance is  tensor(129.3501, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0063443277031183
distance x is tensor(121.3457, device='cuda:3')
benign distance is  tensor(121.3457, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7383935153484344
distance x is tensor(127.0091, device='cuda:3')
benign distance is  tensor(127.0091, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9024040196090937
distance x is tensor(161.9045, device='cuda:3')
benign distance is  tensor(161.9045, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8536492586135864
distance x is tensor(106.3660, device='cuda:3')
benign distance is  tensor(106.3660, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8347596465609968
distance x is tensor(121.9181, device='cuda:3')
benign distance is  tensor(121.9181, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3384068030864
distance x is tensor(129.5307, device='cuda:3')
benign distance is  tensor(129.5307, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7093444932252169
distance x is tensor(105.7490, device='cuda:3')
benign distance is  tensor(105.7490, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8648468907922506
distance x is tensor(117.6086, device='cuda:3')
benign distance is  tensor(117.6086, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6882786517962813
distance x is tensor(143.1171, device='cuda:3')
benign distance is  tensor(143.1171, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1629731878638268
distance x is tensor(97.2438, device='cuda:3')
benign distance is  tensor(97.2438, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6905259266495705
distance x is tensor(136.7643, device='cuda:3')
benign distance is  tensor(136.7643, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2443259470164776
distance x is tensor(211.5630, device='cuda:3')
benign distance is  tensor(211.5630, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8589460719376802
distance x is tensor(87.5565, device='cuda:3')
benign distance is  tensor(87.5565, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9213990513235331
distance x is tensor(151.0755, device='cuda:3')
benign distance is  tensor(151.0755, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3924420587718487
distance x is tensor(145.6997, device='cuda:3')
benign distance is  tensor(145.6997, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.4680000001600001
mal_loss is 6.378668516874313
mal_entropy is 0.22068584617227316
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 593.5795,  563.1518,  577.3352,  751.9130,  474.9415,  540.0193,
         588.8982,  475.3832,  457.8502,  457.8502,  457.8502,  457.8502,
         457.8502,  457.8502,  457.8502,  457.8502,  457.8502,  457.8502,
         457.8502,  457.8502,  753.3805,  666.6351,  687.8982,  708.4945,
         575.8092, 1034.2739,  817.2950,  676.4424], device='cuda:3')
sorted_norm is   tensor([ 457.8502,  457.8502,  457.8502,  457.8502,  457.8502,  457.8502,
         457.8502,  457.8502,  457.8502,  457.8502,  457.8502,  457.8502,
         474.9415,  475.3832,  540.0193,  563.1518,  575.8092,  577.3352,
         588.8982,  593.5795,  666.6351,  676.4424,  687.8982,  708.4945,
         751.9130,  753.3805,  817.2950, 1034.2739], device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  7,  5,  1, 24,  2,
         6,  0, 21, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 94.81% 

Test Accuracy: 82.36% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7683955151587725
distance x is tensor(146.6150, device='cuda:3')
benign distance is  tensor(146.6150, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9784075990319252
distance x is tensor(132.0536, device='cuda:3')
benign distance is  tensor(132.0536, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9451510570943356
distance x is tensor(132.3881, device='cuda:3')
benign distance is  tensor(132.3881, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9669923931360245
distance x is tensor(168.3280, device='cuda:3')
benign distance is  tensor(168.3280, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2182622160762548
distance x is tensor(129.7260, device='cuda:3')
benign distance is  tensor(129.7260, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7541157454252243
distance x is tensor(132.6317, device='cuda:3')
benign distance is  tensor(132.6317, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2386388089507818
distance x is tensor(135.1421, device='cuda:3')
benign distance is  tensor(135.1421, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7593569662421942
distance x is tensor(126.3271, device='cuda:3')
benign distance is  tensor(126.3271, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.341923549771309
distance x is tensor(156.6418, device='cuda:3')
benign distance is  tensor(156.6418, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6853020638227463
distance x is tensor(138.0210, device='cuda:3')
benign distance is  tensor(138.0210, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3785411715507507
distance x is tensor(149.2140, device='cuda:3')
benign distance is  tensor(149.2140, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9676549732685089
distance x is tensor(149.0336, device='cuda:3')
benign distance is  tensor(149.0336, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2212368361651897
distance x is tensor(108.7549, device='cuda:3')
benign distance is  tensor(108.7549, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7771105151623487
distance x is tensor(230.2989, device='cuda:3')
benign distance is  tensor(230.2989, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1808388568460941
distance x is tensor(174.5587, device='cuda:3')
benign distance is  tensor(174.5587, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.721004331484437
distance x is tensor(145.7434, device='cuda:3')
benign distance is  tensor(145.7434, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.34900000016000005
mal_loss is 17.844987452030182
mal_entropy is 0.14646765822544694
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([659.8327, 613.1203, 588.3171, 760.1344, 578.0977, 601.4661, 608.3040,
        566.3806, 459.3177, 459.3177, 459.3177, 459.3177, 459.3177, 459.3177,
        459.3177, 459.3177, 459.3177, 459.3177, 459.3177, 459.3177, 752.2625,
        615.5744, 805.9099, 734.4094, 748.8857, 757.2805, 684.7487, 963.9694,
        604.5493, 693.3191, 498.5598, 671.3113, 997.2128, 465.0152, 725.9383,
        704.5810], device='cuda:3')
sorted_norm is   tensor([459.3177, 459.3177, 459.3177, 459.3177, 459.3177, 459.3177, 459.3177,
        459.3177, 459.3177, 459.3177, 459.3177, 459.3177, 465.0152, 498.5598,
        566.3806, 578.0977, 588.3171, 601.4661, 604.5493, 608.3040, 613.1203,
        615.5744, 659.8327, 671.3113, 684.7487, 693.3191, 704.5810, 725.9383,
        734.4094, 748.8857, 752.2625, 757.2805, 760.1344, 805.9099, 963.9694,
        997.2128], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 30,  7,  4,  2,  5,
        28,  6,  1, 21,  0, 31, 26, 29, 35, 34], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 94.62% 

Test Accuracy: 82.95% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7977744527161121
distance x is tensor(132.7670, device='cuda:3')
benign distance is  tensor(132.7670, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9645260293036699
distance x is tensor(133.8916, device='cuda:3')
benign distance is  tensor(133.8916, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7099297866225243
distance x is tensor(137.6134, device='cuda:3')
benign distance is  tensor(137.6134, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9396362453699112
distance x is tensor(184.2380, device='cuda:3')
benign distance is  tensor(184.2380, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9523944929242134
distance x is tensor(124.0463, device='cuda:3')
benign distance is  tensor(124.0463, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8124785078689456
distance x is tensor(134.1627, device='cuda:3')
benign distance is  tensor(134.1627, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2504375707358122
distance x is tensor(126.5503, device='cuda:3')
benign distance is  tensor(126.5503, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6557849273085594
distance x is tensor(117.3046, device='cuda:3')
benign distance is  tensor(117.3046, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.225390985608101
distance x is tensor(141.4362, device='cuda:3')
benign distance is  tensor(141.4362, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6948196887969971
distance x is tensor(155.9953, device='cuda:3')
benign distance is  tensor(155.9953, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4328398890793324
distance x is tensor(116.8080, device='cuda:3')
benign distance is  tensor(116.8080, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6234664879739285
distance x is tensor(158.7325, device='cuda:3')
benign distance is  tensor(158.7325, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1228428669273853
distance x is tensor(187.2880, device='cuda:3')
benign distance is  tensor(187.2880, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7258914643898606
distance x is tensor(84.7701, device='cuda:3')
benign distance is  tensor(84.7701, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9575554560869932
distance x is tensor(172.4321, device='cuda:3')
benign distance is  tensor(172.4321, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.531532235443592
distance x is tensor(145.3475, device='cuda:3')
benign distance is  tensor(145.3475, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.225691193714738
distance x is tensor(127.2046, device='cuda:3')
benign distance is  tensor(127.2046, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7936585005372763
distance x is tensor(113.3652, device='cuda:3')
benign distance is  tensor(113.3652, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0388358794152737
distance x is tensor(153.2682, device='cuda:3')
benign distance is  tensor(153.2682, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.5654781870543957
distance x is tensor(146.8261, device='cuda:3')
benign distance is  tensor(146.8261, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7879112157970667
distance x is tensor(138.1147, device='cuda:3')
benign distance is  tensor(138.1147, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8829317800700665
distance x is tensor(154.2367, device='cuda:3')
benign distance is  tensor(154.2367, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6051455466076732
distance x is tensor(124.8532, device='cuda:3')
benign distance is  tensor(124.8532, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7351918201893568
distance x is tensor(184.7201, device='cuda:3')
benign distance is  tensor(184.7201, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.35900000016000005
mal_loss is 17.853435754776
mal_entropy is 0.14838971383869648
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([604.5235, 606.5635, 615.3648, 825.1113, 555.8192, 592.0042, 565.0216,
        527.3699, 461.0775, 461.0775, 461.0775, 461.0775, 461.0775, 461.0775,
        461.0775, 461.0775, 461.0775, 461.0775, 461.0775, 461.0775, 762.6740,
        719.0695, 845.7437, 788.5263, 727.3448, 636.4343, 687.2250, 756.0802],
       device='cuda:3')
sorted_norm is   tensor([461.0775, 461.0775, 461.0775, 461.0775, 461.0775, 461.0775, 461.0775,
        461.0775, 461.0775, 461.0775, 461.0775, 461.0775, 527.3699, 555.8192,
        565.0216, 592.0042, 604.5235, 606.5635, 615.3648, 636.4343, 687.2250,
        719.0695, 727.3448, 756.0802, 762.6740, 788.5263, 825.1113, 845.7437],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  4,  6,  5,  0,  1,
         2, 25, 26, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 93.82% 

Test Accuracy: 77.70% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8560818582773209
distance x is tensor(144.7603, device='cuda:3')
benign distance is  tensor(144.7603, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.180732622742653
distance x is tensor(147.0135, device='cuda:3')
benign distance is  tensor(147.0135, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.765261335298419
distance x is tensor(156.2943, device='cuda:3')
benign distance is  tensor(156.2943, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8523405324667692
distance x is tensor(186.8767, device='cuda:3')
benign distance is  tensor(186.8767, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1385494628921151
distance x is tensor(154.7387, device='cuda:3')
benign distance is  tensor(154.7387, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6059497790411115
distance x is tensor(145.5349, device='cuda:3')
benign distance is  tensor(145.5349, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2633301205933094
distance x is tensor(138.0127, device='cuda:3')
benign distance is  tensor(138.0127, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8658251352608204
distance x is tensor(130.8799, device='cuda:3')
benign distance is  tensor(130.8799, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8299535531550646
distance x is tensor(154.6923, device='cuda:3')
benign distance is  tensor(154.6923, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.0400973036885262
distance x is tensor(149.7189, device='cuda:3')
benign distance is  tensor(149.7189, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8445521928369999
distance x is tensor(193.3672, device='cuda:3')
benign distance is  tensor(193.3672, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.9246027544140816
distance x is tensor(167.2736, device='cuda:3')
benign distance is  tensor(167.2736, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9373175259679556
distance x is tensor(150.7372, device='cuda:3')
benign distance is  tensor(150.7372, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9334629494696856
distance x is tensor(116.8278, device='cuda:3')
benign distance is  tensor(116.8278, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0268811769783497
distance x is tensor(149.1516, device='cuda:3')
benign distance is  tensor(149.1516, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9984705150127411
distance x is tensor(150.3831, device='cuda:3')
benign distance is  tensor(150.3831, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3430000001600001
mal_loss is 32.8726270198822
mal_entropy is 0.09295007167384028
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 652.7296,  648.9905,  666.6903,  825.3609,  684.0041,  631.3012,
         612.1718,  562.0392,  461.6486,  461.6486,  461.6486,  461.6486,
         461.6486,  461.6486,  461.6486,  461.6486,  461.6486,  461.6486,
         461.6486,  461.6486,  774.9902,  880.6368,  854.5385,  717.5781,
         928.5213,  840.1490,  737.9127,  836.8856,  780.8294,  698.9664,
         717.5294,  732.7161,  576.7925, 1064.4570,  823.0947,  732.3002,
         664.5792,  735.7611,  575.0510,  776.6478,  860.3882,  441.6893,
         808.9802,  710.0817], device='cuda:3')
sorted_norm is   tensor([ 441.6893,  461.6486,  461.6486,  461.6486,  461.6486,  461.6486,
         461.6486,  461.6486,  461.6486,  461.6486,  461.6486,  461.6486,
         461.6486,  562.0392,  575.0510,  576.7925,  612.1718,  631.3012,
         648.9905,  652.7296,  664.5792,  666.6903,  684.0041,  698.9664,
         710.0817,  717.5294,  717.5781,  732.3002,  732.7161,  735.7611,
         737.9127,  774.9902,  776.6478,  780.8294,  808.9802,  823.0947,
         825.3609,  836.8856,  840.1490,  854.5385,  860.3882,  880.6368,
         928.5213, 1064.4570], device='cuda:3')
used idx is  tensor([41, 11, 19, 17, 13,  9, 15, 16, 14, 12,  8, 10, 18,  7, 38, 32,  6,  5,
         1,  0, 36,  2,  4, 29, 43, 30, 23, 35, 31, 37, 26, 20, 39, 28, 42],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 94.67% 

Test Accuracy: 85.04% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.731404846534133
distance x is tensor(133.9675, device='cuda:3')
benign distance is  tensor(133.9675, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8804269712418318
distance x is tensor(124.2703, device='cuda:3')
benign distance is  tensor(124.2703, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7168882042169571
distance x is tensor(131.1219, device='cuda:3')
benign distance is  tensor(131.1219, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9337669089436531
distance x is tensor(174.1301, device='cuda:3')
benign distance is  tensor(174.1301, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0742674823850393
distance x is tensor(128.9318, device='cuda:3')
benign distance is  tensor(128.9318, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7214416218921542
distance x is tensor(124.0100, device='cuda:3')
benign distance is  tensor(124.0100, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1305242348462343
distance x is tensor(112.4780, device='cuda:3')
benign distance is  tensor(112.4780, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.774575537070632
distance x is tensor(110.6622, device='cuda:3')
benign distance is  tensor(110.6622, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9163333866745234
distance x is tensor(124.6922, device='cuda:3')
benign distance is  tensor(124.6922, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6770938383415341
distance x is tensor(125.7317, device='cuda:3')
benign distance is  tensor(125.7317, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1217763237655163
distance x is tensor(98.6577, device='cuda:3')
benign distance is  tensor(98.6577, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3412993550300598
distance x is tensor(139.5413, device='cuda:3')
benign distance is  tensor(139.5413, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9298850875347853
distance x is tensor(168.9877, device='cuda:3')
benign distance is  tensor(168.9877, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7391731441020966
distance x is tensor(86.0317, device='cuda:3')
benign distance is  tensor(86.0317, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9441623501479626
distance x is tensor(151.0514, device='cuda:3')
benign distance is  tensor(151.0514, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4276898726820946
distance x is tensor(150.1484, device='cuda:3')
benign distance is  tensor(150.1484, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.109458714723587
distance x is tensor(128.1850, device='cuda:3')
benign distance is  tensor(128.1850, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.716783432289958
distance x is tensor(128.9680, device='cuda:3')
benign distance is  tensor(128.9680, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2240526415407658
distance x is tensor(136.0022, device='cuda:3')
benign distance is  tensor(136.0022, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8710719756782055
distance x is tensor(136.5348, device='cuda:3')
benign distance is  tensor(136.5348, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9362498633563519
distance x is tensor(95.7442, device='cuda:3')
benign distance is  tensor(95.7442, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7022491451352835
distance x is tensor(224.8402, device='cuda:3')
benign distance is  tensor(224.8402, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3629204221069813
distance x is tensor(176.4997, device='cuda:3')
benign distance is  tensor(176.4997, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7484393585473299
distance x is tensor(129.3265, device='cuda:3')
benign distance is  tensor(129.3265, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.8563613221049309
distance x is tensor(138.3541, device='cuda:3')
benign distance is  tensor(138.3541, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.443602692335844
distance x is tensor(158.1243, device='cuda:3')
benign distance is  tensor(158.1243, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.726769033819437
distance x is tensor(170.7258, device='cuda:3')
benign distance is  tensor(170.7258, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.2439723499119282
distance x is tensor(110.9582, device='cuda:3')
benign distance is  tensor(110.9582, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7615423705428839
distance x is tensor(170.1061, device='cuda:3')
benign distance is  tensor(170.1061, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8608339391648769
distance x is tensor(151.7061, device='cuda:3')
benign distance is  tensor(151.7061, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9891724605113268
distance x is tensor(128.5675, device='cuda:3')
benign distance is  tensor(128.5675, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6386357536539435
distance x is tensor(153.4456, device='cuda:3')
benign distance is  tensor(153.4456, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3850000001600001
mal_loss is 12.835740447044373
mal_entropy is 0.1435475768521428
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([615.4259, 572.7763, 594.5850, 780.5439, 581.2936, 547.3573, 509.0617,
        495.5182, 459.4062, 459.4062, 459.4062, 459.4062, 459.4062, 459.4062,
        459.4062, 459.4062, 459.4062, 459.4062, 459.4062, 459.4062],
       device='cuda:3')
sorted_norm is   tensor([459.4062, 459.4062, 459.4062, 459.4062, 459.4062, 459.4062, 459.4062,
        459.4062, 459.4062, 459.4062, 459.4062, 459.4062, 495.5182, 509.0617,
        547.3573, 572.7763, 581.2936, 594.5850, 615.4259, 780.5439],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  6,  5,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 91.47% 

Test Accuracy: 57.79% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9776323493570089
distance x is tensor(198.6815, device='cuda:3')
benign distance is  tensor(198.6815, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0027846824377775
distance x is tensor(168.5396, device='cuda:3')
benign distance is  tensor(168.5396, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9521309323608875
distance x is tensor(215.5391, device='cuda:3')
benign distance is  tensor(215.5391, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.028773982077837
distance x is tensor(213.9718, device='cuda:3')
benign distance is  tensor(213.9718, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4421651288866997
distance x is tensor(211.7610, device='cuda:3')
benign distance is  tensor(211.7610, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.867604473605752
distance x is tensor(170.3125, device='cuda:3')
benign distance is  tensor(170.3125, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.658915463835001
distance x is tensor(176.3537, device='cuda:3')
benign distance is  tensor(176.3537, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9903888739645481
distance x is tensor(171.9907, device='cuda:3')
benign distance is  tensor(171.9907, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2710000001600001
mal_loss is 69.65752005577087
mal_entropy is 0.0242313533090055
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([813.9434, 699.4979, 863.7653, 886.2646, 874.5708, 690.6857, 732.7302,
        696.8381, 461.9007, 461.9007, 461.9007, 461.9007, 461.9007, 461.9007,
        461.9007, 461.9007, 461.9007, 461.9007, 461.9007, 461.9007, 723.9054,
        672.8336, 824.9794, 799.6508, 756.1370, 831.4059, 705.0535, 955.0699,
        686.9406, 678.6592, 583.1752, 738.4030, 856.8810, 513.3381, 774.4006,
        775.7783], device='cuda:3')
sorted_norm is   tensor([461.9007, 461.9007, 461.9007, 461.9007, 461.9007, 461.9007, 461.9007,
        461.9007, 461.9007, 461.9007, 461.9007, 461.9007, 513.3381, 583.1752,
        672.8336, 678.6592, 686.9406, 690.6857, 696.8381, 699.4979, 705.0535,
        723.9054, 732.7302, 738.4030, 756.1370, 774.4006, 775.7783, 799.6508,
        813.9434, 824.9794, 831.4059, 856.8810, 863.7653, 874.5708, 886.2646,
        955.0699], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33, 30, 21, 29, 28,  5,
         7,  1, 26, 20,  6, 31, 24, 34, 35, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 93.00% 

Test Accuracy: 76.69% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8930554538965225
distance x is tensor(145.5570, device='cuda:3')
benign distance is  tensor(145.5570, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9402151256799698
distance x is tensor(143.2778, device='cuda:3')
benign distance is  tensor(143.2778, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9565115533769131
distance x is tensor(148.3816, device='cuda:3')
benign distance is  tensor(148.3816, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9919793494045734
distance x is tensor(174.4847, device='cuda:3')
benign distance is  tensor(174.4847, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2738173566758633
distance x is tensor(137.2720, device='cuda:3')
benign distance is  tensor(137.2720, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9248898644000292
distance x is tensor(137.2182, device='cuda:3')
benign distance is  tensor(137.2182, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6059091314673424
distance x is tensor(135.4433, device='cuda:3')
benign distance is  tensor(135.4433, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2446069493889809
distance x is tensor(121.8214, device='cuda:3')
benign distance is  tensor(121.8214, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.179753616452217
distance x is tensor(134.8526, device='cuda:3')
benign distance is  tensor(134.8526, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6508113029412925
distance x is tensor(158.0459, device='cuda:3')
benign distance is  tensor(158.0459, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3733283057808876
distance x is tensor(110.7534, device='cuda:3')
benign distance is  tensor(110.7534, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.331563673913479
distance x is tensor(152.7554, device='cuda:3')
benign distance is  tensor(152.7554, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2313447445631027
distance x is tensor(184.3542, device='cuda:3')
benign distance is  tensor(184.3542, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9384973905980587
distance x is tensor(102.0214, device='cuda:3')
benign distance is  tensor(102.0214, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2047368958592415
distance x is tensor(170.0629, device='cuda:3')
benign distance is  tensor(170.0629, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.0265597105026245
distance x is tensor(159.3626, device='cuda:3')
benign distance is  tensor(159.3626, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1664685234427452
distance x is tensor(155.5708, device='cuda:3')
benign distance is  tensor(155.5708, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.74168392829597
distance x is tensor(139.1591, device='cuda:3')
benign distance is  tensor(139.1591, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.471544273197651
distance x is tensor(170.6829, device='cuda:3')
benign distance is  tensor(170.6829, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.9708118215203285
distance x is tensor(142.1666, device='cuda:3')
benign distance is  tensor(142.1666, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9675750993192196
distance x is tensor(158.9084, device='cuda:3')
benign distance is  tensor(158.9084, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9338389690965414
distance x is tensor(150.2408, device='cuda:3')
benign distance is  tensor(150.2408, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6980890184640884
distance x is tensor(145.9882, device='cuda:3')
benign distance is  tensor(145.9882, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8187392354011536
distance x is tensor(193.2485, device='cuda:3')
benign distance is  tensor(193.2485, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.34600000016000004
mal_loss is 28.159957885742188
mal_entropy is 0.05589957477059215
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 650.7639,  645.9984,  644.4122,  790.2824,  614.7042,  610.7161,
         607.0319,  551.4336,  457.3252,  457.3252,  457.3252,  457.3252,
         457.3252,  457.3252,  457.3252,  457.3252,  457.3252,  457.3252,
         457.3252,  457.3252,  665.6339,  661.2086,  674.7175,  687.3850,
         509.0978, 1048.2018,  845.5038,  668.3421], device='cuda:3')
sorted_norm is   tensor([ 457.3252,  457.3252,  457.3252,  457.3252,  457.3252,  457.3252,
         457.3252,  457.3252,  457.3252,  457.3252,  457.3252,  457.3252,
         509.0978,  551.4336,  607.0319,  610.7161,  614.7042,  644.4122,
         645.9984,  650.7639,  661.2086,  665.6339,  668.3421,  674.7175,
         687.3850,  790.2824,  845.5038, 1048.2018], device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 24,  7,  6,  5,  4,  2,
         1,  0, 21, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 91.97% 

Test Accuracy: 68.98% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0004858169704676
distance x is tensor(171.2377, device='cuda:3')
benign distance is  tensor(171.2377, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1556417346000671
distance x is tensor(164.7080, device='cuda:3')
benign distance is  tensor(164.7080, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8984555974602699
distance x is tensor(160.1848, device='cuda:3')
benign distance is  tensor(160.1848, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.387438278645277
distance x is tensor(197.2190, device='cuda:3')
benign distance is  tensor(197.2190, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3152101300656796
distance x is tensor(139.7013, device='cuda:3')
benign distance is  tensor(139.7013, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9947489527985454
distance x is tensor(159.4881, device='cuda:3')
benign distance is  tensor(159.4881, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9454121515154839
distance x is tensor(135.3688, device='cuda:3')
benign distance is  tensor(135.3688, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8887629993259907
distance x is tensor(179.4776, device='cuda:3')
benign distance is  tensor(179.4776, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.0928979218006134
distance x is tensor(204.5674, device='cuda:3')
benign distance is  tensor(204.5674, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.124878991395235
distance x is tensor(165.6763, device='cuda:3')
benign distance is  tensor(165.6763, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.516127284616232
distance x is tensor(169.3155, device='cuda:3')
benign distance is  tensor(169.3155, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4928676150739193
distance x is tensor(190.5120, device='cuda:3')
benign distance is  tensor(190.5120, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.4286078363656998
distance x is tensor(141.5423, device='cuda:3')
benign distance is  tensor(141.5423, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.943739602342248
distance x is tensor(239.6771, device='cuda:3')
benign distance is  tensor(239.6771, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3696103170514107
distance x is tensor(202.8264, device='cuda:3')
benign distance is  tensor(202.8264, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8238580860197544
distance x is tensor(174.1350, device='cuda:3')
benign distance is  tensor(174.1350, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2680000001600001
mal_loss is 53.36867094039917
mal_entropy is 0.02814328481326811
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([742.2018, 715.9003, 681.7114, 838.1938, 609.6545, 683.4205, 604.4951,
        776.6592, 458.6998, 458.6998, 458.6998, 458.6998, 458.6998, 458.6998,
        458.6998, 458.6998, 458.6998, 458.6998, 458.6998, 458.6998, 819.6410,
        776.2245, 952.6187, 844.9155, 758.6660, 673.1434, 778.8078, 798.7597,
        660.7303, 731.2484, 554.5346, 721.9217, 843.4366, 499.1861, 790.4092,
        760.8542], device='cuda:3')
sorted_norm is   tensor([458.6998, 458.6998, 458.6998, 458.6998, 458.6998, 458.6998, 458.6998,
        458.6998, 458.6998, 458.6998, 458.6998, 458.6998, 499.1861, 554.5346,
        604.4951, 609.6545, 660.7303, 673.1434, 681.7114, 683.4205, 715.9003,
        721.9217, 731.2484, 742.2018, 758.6660, 760.8542, 776.2245, 776.6592,
        778.8078, 790.4092, 798.7597, 819.6410, 838.1938, 843.4366, 844.9155,
        952.6187], device='cuda:3')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 33, 30,  6,  4, 28, 25,
         2,  5,  1, 31, 29,  0, 24, 35, 21,  7], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 92.99% 

Test Accuracy: 80.28% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8071837332099676
distance x is tensor(153.1037, device='cuda:3')
benign distance is  tensor(153.1037, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1255503669381142
distance x is tensor(137.5973, device='cuda:3')
benign distance is  tensor(137.5973, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0144505314528942
distance x is tensor(144.2878, device='cuda:3')
benign distance is  tensor(144.2878, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4013333730399609
distance x is tensor(176.5746, device='cuda:3')
benign distance is  tensor(176.5746, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5560480058193207
distance x is tensor(130.8135, device='cuda:3')
benign distance is  tensor(130.8135, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0274160066619515
distance x is tensor(125.6373, device='cuda:3')
benign distance is  tensor(125.6373, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2379247099161148
distance x is tensor(146.2530, device='cuda:3')
benign distance is  tensor(146.2530, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8665000554174185
distance x is tensor(132.1381, device='cuda:3')
benign distance is  tensor(132.1381, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2183525264263153
distance x is tensor(144.7029, device='cuda:3')
benign distance is  tensor(144.7029, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8632127745077014
distance x is tensor(146.9663, device='cuda:3')
benign distance is  tensor(146.9663, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3799171522259712
distance x is tensor(122.2764, device='cuda:3')
benign distance is  tensor(122.2764, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.1154755204916
distance x is tensor(157.9405, device='cuda:3')
benign distance is  tensor(157.9405, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4599924832582474
distance x is tensor(190.2854, device='cuda:3')
benign distance is  tensor(190.2854, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.4287189282476902
distance x is tensor(111.4287, device='cuda:3')
benign distance is  tensor(111.4287, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9819735493510962
distance x is tensor(173.0207, device='cuda:3')
benign distance is  tensor(173.0207, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7649455145001411
distance x is tensor(159.2408, device='cuda:3')
benign distance is  tensor(159.2408, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9035467319190502
distance x is tensor(159.7101, device='cuda:3')
benign distance is  tensor(159.7101, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.862924963235855
distance x is tensor(145.8078, device='cuda:3')
benign distance is  tensor(145.8078, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7818310689181089
distance x is tensor(170.6199, device='cuda:3')
benign distance is  tensor(170.6199, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.51494812220335
distance x is tensor(169.3886, device='cuda:3')
benign distance is  tensor(169.3886, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8087272197008133
distance x is tensor(155.4106, device='cuda:3')
benign distance is  tensor(155.4106, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.3152730204164982
distance x is tensor(128.1955, device='cuda:3')
benign distance is  tensor(128.1955, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0407458692789078
distance x is tensor(129.2184, device='cuda:3')
benign distance is  tensor(129.2184, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8681341949850321
distance x is tensor(164.1435, device='cuda:3')
benign distance is  tensor(164.1435, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3450000001600001
mal_loss is 24.651223301887512
mal_entropy is 0.04912756406702101
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([689.2042, 602.8169, 631.1848, 776.3341, 567.9637, 551.9546, 656.9723,
        593.1172, 459.1526, 459.1526, 459.1526, 459.1526, 459.1526, 459.1526,
        459.1526, 459.1526, 459.1526, 459.1526, 459.1526, 459.1526],
       device='cuda:3')
sorted_norm is   tensor([459.1526, 459.1526, 459.1526, 459.1526, 459.1526, 459.1526, 459.1526,
        459.1526, 459.1526, 459.1526, 459.1526, 459.1526, 551.9546, 567.9637,
        593.1172, 602.8169, 631.1848, 656.9723, 689.2042, 776.3341],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  5,  4,  7,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 89.60% 

Test Accuracy: 45.91% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8026005402207375
distance x is tensor(252.8194, device='cuda:3')
benign distance is  tensor(252.8194, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3505157083272934
distance x is tensor(249.4629, device='cuda:3')
benign distance is  tensor(249.4629, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.560806915163994
distance x is tensor(238.8483, device='cuda:3')
benign distance is  tensor(238.8483, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6813518702983856
distance x is tensor(260.1934, device='cuda:3')
benign distance is  tensor(260.1934, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8852905929088593
distance x is tensor(268.3561, device='cuda:3')
benign distance is  tensor(268.3561, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0684984847903252
distance x is tensor(199.5128, device='cuda:3')
benign distance is  tensor(199.5128, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6898288577795029
distance x is tensor(222.4722, device='cuda:3')
benign distance is  tensor(222.4722, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9730531647801399
distance x is tensor(196.4869, device='cuda:3')
benign distance is  tensor(196.4869, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.11400000016
mal_loss is 113.66712188720703
mal_entropy is 0.007745304001346653
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1016.3448,  983.1747,  904.5390, 1017.9719, 1086.5804,  791.5060,
         888.8944,  785.9896,  460.6680,  460.6680,  460.6680,  460.6680,
         460.6680,  460.6680,  460.6680,  460.6680,  460.6680,  460.6680,
         460.6680,  460.6680,  902.8535,  954.0739,  986.4413,  793.0269,
        1016.7802,  943.0464,  860.2053,  937.8991,  845.6913,  781.1503,
         934.3005,  803.3985,  864.1859,  827.9811,  837.4532, 1006.2158,
         947.8765,  834.7551,  825.6371,  928.3672,  735.1803, 1122.9723,
         959.4949,  872.5394,  730.2977,  749.6246,  666.1309,  794.5283,
         943.3819,  612.7854,  842.7471,  814.2493], device='cuda:3')
sorted_norm is   tensor([ 460.6680,  460.6680,  460.6680,  460.6680,  460.6680,  460.6680,
         460.6680,  460.6680,  460.6680,  460.6680,  460.6680,  460.6680,
         612.7854,  666.1309,  730.2977,  735.1803,  749.6246,  781.1503,
         785.9896,  791.5060,  793.0269,  794.5283,  803.3985,  814.2493,
         825.6371,  827.9811,  834.7551,  837.4532,  842.7471,  845.6913,
         860.2053,  864.1859,  872.5394,  888.8944,  902.8535,  904.5390,
         928.3672,  934.3005,  937.8991,  943.0464,  943.3819,  947.8765,
         954.0739,  959.4949,  983.1747,  986.4413, 1006.2158, 1016.3448,
        1016.7802, 1017.9719, 1086.5804, 1122.9723], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 49, 46, 44, 40, 45, 29,
         7,  5, 23, 47, 31, 51, 38, 33, 37, 34, 50, 28, 26, 32, 43,  6, 20,  2,
        39, 30, 27, 25, 48], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 92.44% 

Test Accuracy: 83.44% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7745928689837456
distance x is tensor(150.1079, device='cuda:3')
benign distance is  tensor(150.1079, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2066796440631151
distance x is tensor(130.4406, device='cuda:3')
benign distance is  tensor(130.4406, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1714634709060192
distance x is tensor(130.4466, device='cuda:3')
benign distance is  tensor(130.4466, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0322898849844933
distance x is tensor(178.8116, device='cuda:3')
benign distance is  tensor(178.8116, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4339793417602777
distance x is tensor(130.0933, device='cuda:3')
benign distance is  tensor(130.0933, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8312322674319148
distance x is tensor(111.5330, device='cuda:3')
benign distance is  tensor(111.5330, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.66199304535985
distance x is tensor(118.5664, device='cuda:3')
benign distance is  tensor(118.5664, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9435345083475113
distance x is tensor(115.5831, device='cuda:3')
benign distance is  tensor(115.5831, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3521538339555264
distance x is tensor(129.8374, device='cuda:3')
benign distance is  tensor(129.8374, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7901507578790188
distance x is tensor(188.9240, device='cuda:3')
benign distance is  tensor(188.9240, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3045408837497234
distance x is tensor(92.2376, device='cuda:3')
benign distance is  tensor(92.2376, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6831747144460678
distance x is tensor(130.6522, device='cuda:3')
benign distance is  tensor(130.6522, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2446547448635101
distance x is tensor(184.8272, device='cuda:3')
benign distance is  tensor(184.8272, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7806427907198668
distance x is tensor(79.7690, device='cuda:3')
benign distance is  tensor(79.7690, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.268145103007555
distance x is tensor(155.8033, device='cuda:3')
benign distance is  tensor(155.8033, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.048541411757469
distance x is tensor(141.1156, device='cuda:3')
benign distance is  tensor(141.1156, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8810672834515572
distance x is tensor(116.5511, device='cuda:3')
benign distance is  tensor(116.5511, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9714213330298662
distance x is tensor(129.5259, device='cuda:3')
benign distance is  tensor(129.5259, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4622140415012836
distance x is tensor(140.1180, device='cuda:3')
benign distance is  tensor(140.1180, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.30779230594635
distance x is tensor(140.3992, device='cuda:3')
benign distance is  tensor(140.3992, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7356876395642757
distance x is tensor(95.2748, device='cuda:3')
benign distance is  tensor(95.2748, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8572785444557667
distance x is tensor(214.0345, device='cuda:3')
benign distance is  tensor(214.0345, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2064354419708252
distance x is tensor(166.8293, device='cuda:3')
benign distance is  tensor(166.8293, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7958245892077684
distance x is tensor(118.9470, device='cuda:3')
benign distance is  tensor(118.9470, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2411743961274624
distance x is tensor(138.3595, device='cuda:3')
benign distance is  tensor(138.3595, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9220678769052029
distance x is tensor(132.4731, device='cuda:3')
benign distance is  tensor(132.4731, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1507590226829052
distance x is tensor(145.1495, device='cuda:3')
benign distance is  tensor(145.1495, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.3138268887996674
distance x is tensor(145.5467, device='cuda:3')
benign distance is  tensor(145.5467, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0438008345663548
distance x is tensor(135.9677, device='cuda:3')
benign distance is  tensor(135.9677, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9872828824445605
distance x is tensor(136.4920, device='cuda:3')
benign distance is  tensor(136.4920, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6668838728219271
distance x is tensor(122.9134, device='cuda:3')
benign distance is  tensor(122.9134, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8375229556113482
distance x is tensor(179.0612, device='cuda:3')
benign distance is  tensor(179.0612, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.8284602984786034
distance x is tensor(130.6384, device='cuda:3')
benign distance is  tensor(130.6384, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3979625813663006
distance x is tensor(158.2068, device='cuda:3')
benign distance is  tensor(158.2068, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.3343200273811817
distance x is tensor(146.4941, device='cuda:3')
benign distance is  tensor(146.4941, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.417094636708498
distance x is tensor(110.6498, device='cuda:3')
benign distance is  tensor(110.6498, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7823405582457781
distance x is tensor(170.1644, device='cuda:3')
benign distance is  tensor(170.1644, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.954313088208437
distance x is tensor(154.9867, device='cuda:3')
benign distance is  tensor(154.9867, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1413866002112627
distance x is tensor(115.3727, device='cuda:3')
benign distance is  tensor(115.3727, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.706350983120501
distance x is tensor(158.2500, device='cuda:3')
benign distance is  tensor(158.2500, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.47200000016000004
mal_loss is 6.540754437446594
mal_entropy is 0.1657457947731018
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([669.3206, 610.0694, 595.3214, 798.0643, 585.1270, 494.8391, 535.2208,
        525.2536, 448.4023, 448.4023, 448.4023, 448.4023, 448.4023, 448.4023,
        448.4023, 448.4023, 448.4023, 448.4023, 448.4023, 448.4023],
       device='cuda:3')
sorted_norm is   tensor([448.4023, 448.4023, 448.4023, 448.4023, 448.4023, 448.4023, 448.4023,
        448.4023, 448.4023, 448.4023, 448.4023, 448.4023, 494.8391, 525.2536,
        535.2208, 585.1270, 595.3214, 610.0694, 669.3206, 798.0643],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  5,  7,  6,  4],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 90.69% 

Test Accuracy: 68.41% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9773524310439825
distance x is tensor(193.0323, device='cuda:3')
benign distance is  tensor(193.0323, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2203563340008259
distance x is tensor(167.3647, device='cuda:3')
benign distance is  tensor(167.3647, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5474674440920353
distance x is tensor(173.0101, device='cuda:3')
benign distance is  tensor(173.0101, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1558238007128239
distance x is tensor(208.0926, device='cuda:3')
benign distance is  tensor(208.0926, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.522531434893608
distance x is tensor(176.1749, device='cuda:3')
benign distance is  tensor(176.1749, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8089794851839542
distance x is tensor(168.4016, device='cuda:3')
benign distance is  tensor(168.4016, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.352856382727623
distance x is tensor(159.7855, device='cuda:3')
benign distance is  tensor(159.7855, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3638413585722446
distance x is tensor(151.3788, device='cuda:3')
benign distance is  tensor(151.3788, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2810000001600001
mal_loss is 41.92579889297485
mal_entropy is 0.029338176711462438
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([854.5432, 727.6169, 744.7982, 900.5561, 773.9537, 712.3892, 694.0823,
        661.5078, 453.2297, 453.2297, 453.2297, 453.2297, 453.2297, 453.2297,
        453.2297, 453.2297, 453.2297, 453.2297, 453.2297, 453.2297, 698.3231,
        941.6576, 546.0835, 687.8313, 912.2981, 498.6208, 781.5406, 739.0021],
       device='cuda:3')
sorted_norm is   tensor([453.2297, 453.2297, 453.2297, 453.2297, 453.2297, 453.2297, 453.2297,
        453.2297, 453.2297, 453.2297, 453.2297, 453.2297, 498.6208, 546.0835,
        661.5078, 687.8313, 694.0823, 698.3231, 712.3892, 727.6169, 739.0021,
        744.7982, 773.9537, 781.5406, 854.5432, 900.5561, 912.2981, 941.6576],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25, 22,  7, 23,  6, 20,
         5,  1, 27,  2], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.89% 

Test Accuracy: 67.41% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.044572588056326
distance x is tensor(192.8674, device='cuda:3')
benign distance is  tensor(192.8674, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5268337950110435
distance x is tensor(180.6719, device='cuda:3')
benign distance is  tensor(180.6719, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.223985254764557
distance x is tensor(185.6100, device='cuda:3')
benign distance is  tensor(185.6100, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.523782905191183
distance x is tensor(206.4906, device='cuda:3')
benign distance is  tensor(206.4906, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7024542912840843
distance x is tensor(182.3420, device='cuda:3')
benign distance is  tensor(182.3420, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1908161863684654
distance x is tensor(161.7894, device='cuda:3')
benign distance is  tensor(161.7894, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3930840007960796
distance x is tensor(158.8040, device='cuda:3')
benign distance is  tensor(158.8040, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.100664434954524
distance x is tensor(151.9142, device='cuda:3')
benign distance is  tensor(151.9142, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4687138199806213
distance x is tensor(159.3402, device='cuda:3')
benign distance is  tensor(159.3402, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0964018367230892
distance x is tensor(183.8532, device='cuda:3')
benign distance is  tensor(183.8532, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2385919950902462
distance x is tensor(155.1456, device='cuda:3')
benign distance is  tensor(155.1456, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.2022574692964554
distance x is tensor(187.6619, device='cuda:3')
benign distance is  tensor(187.6619, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7862275391817093
distance x is tensor(208.9210, device='cuda:3')
benign distance is  tensor(208.9210, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2405134961009026
distance x is tensor(139.3576, device='cuda:3')
benign distance is  tensor(139.3576, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3486084453761578
distance x is tensor(186.4597, device='cuda:3')
benign distance is  tensor(186.4597, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.973800003528595
distance x is tensor(188.2170, device='cuda:3')
benign distance is  tensor(188.2170, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2210000001600001
mal_loss is 49.915483236312866
mal_entropy is 0.025904832291416824
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 862.7019,  759.1105,  767.5265,  877.8302,  749.3055,  673.4968,
         686.5984,  661.1748,  459.6855,  459.6855,  459.6855,  459.6855,
         459.6855,  459.6855,  459.6855,  459.6855,  459.6855,  459.6855,
         459.6855,  459.6855,  853.0823,  800.5468,  888.5573,  875.8214,
         819.0963,  740.1335,  720.7450,  861.3010,  663.0560,  719.8217,
         729.6353,  769.9014,  586.4083, 1048.9803,  847.4597,  688.4902],
       device='cuda:3')
sorted_norm is   tensor([ 459.6855,  459.6855,  459.6855,  459.6855,  459.6855,  459.6855,
         459.6855,  459.6855,  459.6855,  459.6855,  459.6855,  459.6855,
         586.4083,  661.1748,  663.0560,  673.4968,  686.5984,  688.4902,
         719.8217,  720.7450,  729.6353,  740.1335,  749.3055,  759.1105,
         767.5265,  769.9014,  800.5468,  819.0963,  847.4597,  853.0823,
         861.3010,  862.7019,  875.8214,  877.8302,  888.5573, 1048.9803],
       device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 32,  7, 28,  5,  6, 35,
        29, 26, 30, 25,  4,  1,  2, 31, 21, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 91.37% 

Test Accuracy: 79.63% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1754090040922165
distance x is tensor(181.7604, device='cuda:3')
benign distance is  tensor(181.7604, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9722226001322269
distance x is tensor(151.7199, device='cuda:3')
benign distance is  tensor(151.7199, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8867703266441822
distance x is tensor(159.1529, device='cuda:3')
benign distance is  tensor(159.1529, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.264080934226513
distance x is tensor(201.2705, device='cuda:3')
benign distance is  tensor(201.2705, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6276097409427166
distance x is tensor(127.1549, device='cuda:3')
benign distance is  tensor(127.1549, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8414037134498358
distance x is tensor(147.7099, device='cuda:3')
benign distance is  tensor(147.7099, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4593919049948454
distance x is tensor(130.1970, device='cuda:3')
benign distance is  tensor(130.1970, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0124436356127262
distance x is tensor(138.7811, device='cuda:3')
benign distance is  tensor(138.7811, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.9748038575053215
distance x is tensor(177.0962, device='cuda:3')
benign distance is  tensor(177.0962, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0927826128900051
distance x is tensor(139.7767, device='cuda:3')
benign distance is  tensor(139.7767, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.9662805199623108
distance x is tensor(155.6405, device='cuda:3')
benign distance is  tensor(155.6405, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3731640204787254
distance x is tensor(152.0587, device='cuda:3')
benign distance is  tensor(152.0587, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6333350948989391
distance x is tensor(133.0975, device='cuda:3')
benign distance is  tensor(133.0975, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9290007203817368
distance x is tensor(227.4458, device='cuda:3')
benign distance is  tensor(227.4458, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7278773337602615
distance x is tensor(194.0900, device='cuda:3')
benign distance is  tensor(194.0900, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0486413147300482
distance x is tensor(155.4729, device='cuda:3')
benign distance is  tensor(155.4729, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9749861136078835
distance x is tensor(166.7435, device='cuda:3')
benign distance is  tensor(166.7435, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.2188218906521797
distance x is tensor(137.3226, device='cuda:3')
benign distance is  tensor(137.3226, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.034702181816101
distance x is tensor(172.0673, device='cuda:3')
benign distance is  tensor(172.0673, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.9791489392518997
distance x is tensor(160.0186, device='cuda:3')
benign distance is  tensor(160.0186, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9361871685832739
distance x is tensor(148.9239, device='cuda:3')
benign distance is  tensor(148.9239, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.445357259362936
distance x is tensor(130.9032, device='cuda:3')
benign distance is  tensor(130.9032, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.1878914944827557
distance x is tensor(130.3903, device='cuda:3')
benign distance is  tensor(130.3903, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0969144143164158
distance x is tensor(168.8863, device='cuda:3')
benign distance is  tensor(168.8863, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.31000000016000007
mal_loss is 25.449812173843384
mal_entropy is 0.05826837895438075
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([799.6998, 668.3642, 694.3658, 858.9662, 565.6062, 649.6284, 580.1270,
        621.1431, 460.6864, 460.6864, 460.6864, 460.6864, 460.6864, 460.6864,
        460.6864, 460.6864, 460.6864, 460.6864, 460.6864, 460.6864, 703.5347,
        698.8079, 750.3869, 749.7205, 713.8919, 729.3973, 645.3058, 895.2307,
        694.8856, 789.1061, 658.5071, 797.7303, 879.6702, 609.2622, 790.7401,
        797.3873], device='cuda:3')
sorted_norm is   tensor([460.6864, 460.6864, 460.6864, 460.6864, 460.6864, 460.6864, 460.6864,
        460.6864, 460.6864, 460.6864, 460.6864, 460.6864, 565.6062, 580.1270,
        609.2622, 621.1431, 645.3058, 649.6284, 658.5071, 668.3642, 694.3658,
        694.8856, 698.8079, 703.5347, 713.8919, 729.3973, 749.7205, 750.3869,
        789.1061, 790.7401, 797.3873, 797.7303, 799.6998, 858.9662, 879.6702,
        895.2307], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  4,  6, 33,  7, 26,  5,
        30,  1,  2, 28, 21, 20, 24, 25, 23, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 91.20% 

Test Accuracy: 80.95% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7946931757032871
distance x is tensor(144.9057, device='cuda:3')
benign distance is  tensor(144.9057, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5758025720715523
distance x is tensor(151.9849, device='cuda:3')
benign distance is  tensor(151.9849, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3268561884760857
distance x is tensor(135.7594, device='cuda:3')
benign distance is  tensor(135.7594, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2663979679346085
distance x is tensor(172.9579, device='cuda:3')
benign distance is  tensor(172.9579, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2182977348566055
distance x is tensor(146.2350, device='cuda:3')
benign distance is  tensor(146.2350, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9521708618849516
distance x is tensor(144.3460, device='cuda:3')
benign distance is  tensor(144.3460, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4308262169361115
distance x is tensor(141.4399, device='cuda:3')
benign distance is  tensor(141.4399, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.456716787070036
distance x is tensor(131.9978, device='cuda:3')
benign distance is  tensor(131.9978, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4067677184939384
distance x is tensor(141.1106, device='cuda:3')
benign distance is  tensor(141.1106, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0343022160232067
distance x is tensor(170.0558, device='cuda:3')
benign distance is  tensor(170.0558, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7257839292287827
distance x is tensor(142.2343, device='cuda:3')
benign distance is  tensor(142.2343, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3824796229600906
distance x is tensor(145.6255, device='cuda:3')
benign distance is  tensor(145.6255, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9207938984036446
distance x is tensor(189.6520, device='cuda:3')
benign distance is  tensor(189.6520, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1435393001884222
distance x is tensor(94.4100, device='cuda:3')
benign distance is  tensor(94.4100, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5109971314668655
distance x is tensor(178.7614, device='cuda:3')
benign distance is  tensor(178.7614, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.753182828426361
distance x is tensor(144.3199, device='cuda:3')
benign distance is  tensor(144.3199, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7323466539382935
distance x is tensor(142.7086, device='cuda:3')
benign distance is  tensor(142.7086, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9132995251566172
distance x is tensor(139.4006, device='cuda:3')
benign distance is  tensor(139.4006, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3613292649388313
distance x is tensor(159.2416, device='cuda:3')
benign distance is  tensor(159.2416, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.2362097650766373
distance x is tensor(157.1266, device='cuda:3')
benign distance is  tensor(157.1266, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1394713371992111
distance x is tensor(151.8909, device='cuda:3')
benign distance is  tensor(151.8909, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5679548121988773
distance x is tensor(127.0734, device='cuda:3')
benign distance is  tensor(127.0734, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6763268364593387
distance x is tensor(158.5345, device='cuda:3')
benign distance is  tensor(158.5345, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1605196706950665
distance x is tensor(189.8636, device='cuda:3')
benign distance is  tensor(189.8636, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.29900000016000006
mal_loss is 24.477219462394714
mal_entropy is 0.04562520538456738
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([641.1603, 664.3480, 584.8001, 745.2433, 642.9785, 620.7715, 628.0005,
        571.7289, 461.2291, 461.2291, 461.2291, 461.2291, 461.2291, 461.2291,
        461.2291, 461.2291, 461.2291, 461.2291, 461.2291, 461.2291],
       device='cuda:3')
sorted_norm is   tensor([461.2291, 461.2291, 461.2291, 461.2291, 461.2291, 461.2291, 461.2291,
        461.2291, 461.2291, 461.2291, 461.2291, 461.2291, 571.7289, 584.8001,
        620.7715, 628.0005, 641.1603, 642.9785, 664.3480, 745.2433],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  5,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 84.06% 

Test Accuracy: 48.89% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9622928090393543
distance x is tensor(244.8844, device='cuda:3')
benign distance is  tensor(244.8844, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.416634265333414
distance x is tensor(280.1726, device='cuda:3')
benign distance is  tensor(280.1726, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.895728699862957
distance x is tensor(215.3258, device='cuda:3')
benign distance is  tensor(215.3258, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0717199966311455
distance x is tensor(253.0517, device='cuda:3')
benign distance is  tensor(253.0517, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5981492474675179
distance x is tensor(283.2582, device='cuda:3')
benign distance is  tensor(283.2582, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1191941536962986
distance x is tensor(212.7715, device='cuda:3')
benign distance is  tensor(212.7715, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0493949353694916
distance x is tensor(213.6636, device='cuda:3')
benign distance is  tensor(213.6636, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5470789670944214
distance x is tensor(271.8876, device='cuda:3')
benign distance is  tensor(271.8876, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.09500000015999997
mal_loss is 112.75081443786621
mal_entropy is 0.002035977411012993
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 944.0966, 1087.9340,  806.3667,  963.1202, 1092.8828,  821.7338,
         834.9176, 1028.9076,  460.9090,  460.9090,  460.9090,  460.9090,
         460.9090,  460.9090,  460.9090,  460.9090,  460.9090,  460.9090,
         460.9090,  460.9090,  847.3546,  930.3589,  888.3362,  758.8095,
         971.9565,  914.4507,  779.1973,  928.1824,  906.7512,  757.3726,
         781.5911,  809.2308,  720.8229, 1070.8480,  941.7855,  825.4227,
         707.0359,  845.7618,  722.4855,  726.0138,  899.7286,  542.7668,
         859.4816,  765.4067], device='cuda:3')
sorted_norm is   tensor([ 460.9090,  460.9090,  460.9090,  460.9090,  460.9090,  460.9090,
         460.9090,  460.9090,  460.9090,  460.9090,  460.9090,  460.9090,
         542.7668,  707.0359,  720.8229,  722.4855,  726.0138,  757.3726,
         758.8095,  765.4067,  779.1973,  781.5911,  806.3667,  809.2308,
         821.7338,  825.4227,  834.9176,  845.7618,  847.3546,  859.4816,
         888.3362,  899.7286,  906.7512,  914.4507,  928.1824,  930.3589,
         941.7855,  944.0966,  963.1202,  971.9565, 1028.9076, 1070.8480,
        1087.9340, 1092.8828], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 41, 36, 32, 38, 39, 29,
        23, 43, 26, 30,  2, 31,  5, 35,  6, 37, 20, 42, 22, 40, 28, 25, 27],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.98% 

Test Accuracy: 81.45% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0307416170835495
distance x is tensor(158.5622, device='cuda:3')
benign distance is  tensor(158.5622, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4102450236678123
distance x is tensor(127.1845, device='cuda:3')
benign distance is  tensor(127.1845, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9918654710054398
distance x is tensor(121.2599, device='cuda:3')
benign distance is  tensor(121.2599, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3069172650575638
distance x is tensor(184.4024, device='cuda:3')
benign distance is  tensor(184.4024, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.140309315174818
distance x is tensor(142.4011, device='cuda:3')
benign distance is  tensor(142.4011, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.008581129834056
distance x is tensor(135.0800, device='cuda:3')
benign distance is  tensor(135.0800, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8131467215716839
distance x is tensor(145.1721, device='cuda:3')
benign distance is  tensor(145.1721, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0883026588708162
distance x is tensor(111.6904, device='cuda:3')
benign distance is  tensor(111.6904, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6716391295194626
distance x is tensor(129.6025, device='cuda:3')
benign distance is  tensor(129.6025, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9569176789373159
distance x is tensor(161.1777, device='cuda:3')
benign distance is  tensor(161.1777, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.515618372708559
distance x is tensor(113.1862, device='cuda:3')
benign distance is  tensor(113.1862, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.8595492243766785
distance x is tensor(153.2838, device='cuda:3')
benign distance is  tensor(153.2838, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.312407560646534
distance x is tensor(192.9320, device='cuda:3')
benign distance is  tensor(192.9320, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1018827762454748
distance x is tensor(92.4646, device='cuda:3')
benign distance is  tensor(92.4646, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3786633759737015
distance x is tensor(163.3028, device='cuda:3')
benign distance is  tensor(163.3028, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.609750010073185
distance x is tensor(149.8711, device='cuda:3')
benign distance is  tensor(149.8711, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.0013969391584396
distance x is tensor(146.0134, device='cuda:3')
benign distance is  tensor(146.0134, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.316102597862482
distance x is tensor(152.5494, device='cuda:3')
benign distance is  tensor(152.5494, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.470264371484518
distance x is tensor(146.1126, device='cuda:3')
benign distance is  tensor(146.1126, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5731551013886929
distance x is tensor(149.3340, device='cuda:3')
benign distance is  tensor(149.3340, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.8635044917464256
distance x is tensor(119.6503, device='cuda:3')
benign distance is  tensor(119.6503, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.95302414894104
distance x is tensor(224.2643, device='cuda:3')
benign distance is  tensor(224.2643, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.684296727180481
distance x is tensor(184.0081, device='cuda:3')
benign distance is  tensor(184.0081, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2123294956982136
distance x is tensor(157.3198, device='cuda:3')
benign distance is  tensor(157.3198, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.179851397871971
distance x is tensor(150.5448, device='cuda:3')
benign distance is  tensor(150.5448, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.0937681049108505
distance x is tensor(157.7656, device='cuda:3')
benign distance is  tensor(157.7656, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.0386757031083107
distance x is tensor(174.3640, device='cuda:3')
benign distance is  tensor(174.3640, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1234233416616917
distance x is tensor(124.0552, device='cuda:3')
benign distance is  tensor(124.0552, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7878022901713848
distance x is tensor(181.2990, device='cuda:3')
benign distance is  tensor(181.2990, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0452114753425121
distance x is tensor(165.7316, device='cuda:3')
benign distance is  tensor(165.7316, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.4915447682142258
distance x is tensor(152.0431, device='cuda:3')
benign distance is  tensor(152.0431, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6713813152164221
distance x is tensor(168.3478, device='cuda:3')
benign distance is  tensor(168.3478, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.35900000016000005
mal_loss is 12.363767385482788
mal_entropy is 0.13282138062641025
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([708.3912, 576.7410, 535.3154, 793.1924, 630.5710, 580.9308, 654.6437,
        506.8589, 457.1765, 457.1765, 457.1765, 457.1765, 457.1765, 457.1765,
        457.1765, 457.1765, 457.1765, 457.1765, 457.1765, 457.1765],
       device='cuda:3')
sorted_norm is   tensor([457.1765, 457.1765, 457.1765, 457.1765, 457.1765, 457.1765, 457.1765,
        457.1765, 457.1765, 457.1765, 457.1765, 457.1765, 506.8589, 535.3154,
        576.7410, 580.9308, 630.5710, 654.6437, 708.3912, 793.1924],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  1,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 85.46% 

Test Accuracy: 58.98% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0349170956760645
distance x is tensor(237.6419, device='cuda:3')
benign distance is  tensor(237.6419, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4832639396190643
distance x is tensor(198.2846, device='cuda:3')
benign distance is  tensor(198.2846, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6312650293111801
distance x is tensor(185.3364, device='cuda:3')
benign distance is  tensor(185.3364, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3678313381969929
distance x is tensor(240.0565, device='cuda:3')
benign distance is  tensor(240.0565, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9947109743952751
distance x is tensor(216.5148, device='cuda:3')
benign distance is  tensor(216.5148, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0618183203041553
distance x is tensor(183.9537, device='cuda:3')
benign distance is  tensor(183.9537, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.6049418225884438
distance x is tensor(191.2328, device='cuda:3')
benign distance is  tensor(191.2328, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6678158044815063
distance x is tensor(195.4204, device='cuda:3')
benign distance is  tensor(195.4204, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.12500000016000004
mal_loss is 74.6439688205719
mal_entropy is 0.007007489522948163
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([963.4506, 780.6185, 742.6428, 992.1310, 862.0931, 774.1285, 788.2463,
        827.3102, 458.9135, 458.9135, 458.9135, 458.9135, 458.9135, 458.9135,
        458.9135, 458.9135, 458.9135, 458.9135, 458.9135, 458.9135, 871.5250,
        763.3656, 897.1277, 857.3885, 805.8928, 742.1997, 743.3287, 862.1273,
        757.1649, 749.7482, 825.1290, 832.6426, 798.2797, 708.1622, 840.1838,
        955.1028, 678.4988, 799.0107, 615.2065, 782.2191, 922.2682, 543.4041,
        809.4792, 770.5751], device='cuda:3')
sorted_norm is   tensor([458.9135, 458.9135, 458.9135, 458.9135, 458.9135, 458.9135, 458.9135,
        458.9135, 458.9135, 458.9135, 458.9135, 458.9135, 543.4041, 615.2065,
        678.4988, 708.1622, 742.1997, 742.6428, 743.3287, 749.7482, 757.1649,
        763.3656, 770.5751, 774.1285, 780.6185, 782.2191, 788.2463, 798.2797,
        799.0107, 805.8928, 809.4792, 825.1290, 827.3102, 832.6426, 840.1838,
        857.3885, 862.0931, 862.1273, 871.5250, 897.1277, 922.2682, 955.1028,
        963.4506, 992.1310], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 41, 38, 36, 33, 25,  2,
        26, 29, 28, 21, 43,  5,  1, 39,  6, 32, 37, 24, 42, 30,  7, 31, 34],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.56% 

Test Accuracy: 81.27% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9025747124105692
distance x is tensor(183.1794, device='cuda:3')
benign distance is  tensor(183.1794, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1740975640714169
distance x is tensor(126.6981, device='cuda:3')
benign distance is  tensor(126.6981, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4135891236364841
distance x is tensor(131.3657, device='cuda:3')
benign distance is  tensor(131.3657, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7128784619271755
distance x is tensor(176.7094, device='cuda:3')
benign distance is  tensor(176.7094, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.450776742771268
distance x is tensor(138.1432, device='cuda:3')
benign distance is  tensor(138.1432, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0388484261929989
distance x is tensor(140.6784, device='cuda:3')
benign distance is  tensor(140.6784, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7782207280397415
distance x is tensor(158.5845, device='cuda:3')
benign distance is  tensor(158.5845, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0745239183306694
distance x is tensor(117.8590, device='cuda:3')
benign distance is  tensor(117.8590, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5925153456628323
distance x is tensor(132.3378, device='cuda:3')
benign distance is  tensor(132.3378, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9247393291443586
distance x is tensor(160.5293, device='cuda:3')
benign distance is  tensor(160.5293, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4905891604721546
distance x is tensor(112.9368, device='cuda:3')
benign distance is  tensor(112.9368, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.1987136900424957
distance x is tensor(145.2955, device='cuda:3')
benign distance is  tensor(145.2955, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9205471649765968
distance x is tensor(196.3732, device='cuda:3')
benign distance is  tensor(196.3732, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0192333664745092
distance x is tensor(102.2266, device='cuda:3')
benign distance is  tensor(102.2266, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2848020531237125
distance x is tensor(161.8511, device='cuda:3')
benign distance is  tensor(161.8511, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2125792279839516
distance x is tensor(143.2494, device='cuda:3')
benign distance is  tensor(143.2494, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.763053998351097
distance x is tensor(148.2686, device='cuda:3')
benign distance is  tensor(148.2686, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1312411464750767
distance x is tensor(127.4789, device='cuda:3')
benign distance is  tensor(127.4789, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.796401508152485
distance x is tensor(165.8631, device='cuda:3')
benign distance is  tensor(165.8631, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.146797150373459
distance x is tensor(140.8377, device='cuda:3')
benign distance is  tensor(140.8377, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2890340946614742
distance x is tensor(151.1102, device='cuda:3')
benign distance is  tensor(151.1102, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.7553853876888752
distance x is tensor(145.9324, device='cuda:3')
benign distance is  tensor(145.9324, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8300398029386997
distance x is tensor(144.1420, device='cuda:3')
benign distance is  tensor(144.1420, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3645046465098858
distance x is tensor(184.8294, device='cuda:3')
benign distance is  tensor(184.8294, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9944512210786343
distance x is tensor(156.8985, device='cuda:3')
benign distance is  tensor(156.8985, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.504775732755661
distance x is tensor(143.5314, device='cuda:3')
benign distance is  tensor(143.5314, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8776153773069382
distance x is tensor(168.5068, device='cuda:3')
benign distance is  tensor(168.5068, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.692661628127098
distance x is tensor(158.7172, device='cuda:3')
benign distance is  tensor(158.7172, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0735326446592808
distance x is tensor(146.3314, device='cuda:3')
benign distance is  tensor(146.3314, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.208484224975109
distance x is tensor(117.9423, device='cuda:3')
benign distance is  tensor(117.9423, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.3866839855909348
distance x is tensor(129.0673, device='cuda:3')
benign distance is  tensor(129.0673, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0608344934880733
distance x is tensor(157.6079, device='cuda:3')
benign distance is  tensor(157.6079, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.29600000016000005
mal_loss is 16.617809116840363
mal_entropy is 0.09838325111195445
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([772.7037, 566.9918, 570.6901, 762.1832, 599.1921, 600.7155, 676.7067,
        518.7632, 460.0836, 460.0837, 460.0836, 460.0837, 460.0836, 460.0837,
        460.0836, 460.0837, 460.0836, 460.0837, 460.0836, 460.0837, 685.1361,
        717.0233, 657.1423, 687.7488, 570.6049, 979.0047, 834.4435, 720.2465],
       device='cuda:3')
sorted_norm is   tensor([460.0836, 460.0836, 460.0836, 460.0836, 460.0836, 460.0836, 460.0837,
        460.0837, 460.0837, 460.0837, 460.0837, 460.0837, 518.7632, 566.9918,
        570.6049, 570.6901, 599.1921, 600.7155, 657.1423, 676.7067, 685.1361,
        687.7488, 717.0233, 720.2465, 762.1832, 772.7037, 834.4435, 979.0047],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  7,  1, 24,  2,  4,  5,
        22,  6, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.60% 

Test Accuracy: 77.22% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8704287596046925
distance x is tensor(182.8724, device='cuda:3')
benign distance is  tensor(182.8724, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3337532207369804
distance x is tensor(140.3667, device='cuda:3')
benign distance is  tensor(140.3667, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2669926807284355
distance x is tensor(157.8402, device='cuda:3')
benign distance is  tensor(157.8402, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4010783769190311
distance x is tensor(192.2662, device='cuda:3')
benign distance is  tensor(192.2662, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5729465931653976
distance x is tensor(158.0647, device='cuda:3')
benign distance is  tensor(158.0647, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1446255631744862
distance x is tensor(150.0164, device='cuda:3')
benign distance is  tensor(150.0164, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.2222298681735992
distance x is tensor(196.0564, device='cuda:3')
benign distance is  tensor(196.0564, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.053782396018505
distance x is tensor(133.6821, device='cuda:3')
benign distance is  tensor(133.6821, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.7033914625644684
distance x is tensor(152.8266, device='cuda:3')
benign distance is  tensor(152.8266, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2605538330972195
distance x is tensor(153.3126, device='cuda:3')
benign distance is  tensor(153.3126, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4308847784996033
distance x is tensor(150.6481, device='cuda:3')
benign distance is  tensor(150.6481, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5863669142127037
distance x is tensor(169.3886, device='cuda:3')
benign distance is  tensor(169.3886, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.524788849055767
distance x is tensor(173.5465, device='cuda:3')
benign distance is  tensor(173.5465, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1811478435993195
distance x is tensor(237.6923, device='cuda:3')
benign distance is  tensor(237.6923, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4951904602348804
distance x is tensor(201.9371, device='cuda:3')
benign distance is  tensor(201.9371, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2026943303644657
distance x is tensor(161.6068, device='cuda:3')
benign distance is  tensor(161.6068, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.17000000016000008
mal_loss is 42.2097373008728
mal_entropy is 0.027844249285408296
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([795.2325, 602.7477, 669.4059, 817.4273, 658.7823, 632.8323, 830.9079,
        582.5289, 460.9588, 460.9588, 460.9588, 460.9588, 460.9588, 460.9588,
        460.9588, 460.9588, 460.9588, 460.9588, 460.9588, 460.9588, 625.0739,
        733.0349, 560.1422, 691.6149, 897.2139, 510.6219, 753.2380, 678.4020],
       device='cuda:3')
sorted_norm is   tensor([460.9588, 460.9588, 460.9588, 460.9588, 460.9588, 460.9588, 460.9588,
        460.9588, 460.9588, 460.9588, 460.9588, 460.9588, 510.6219, 560.1422,
        582.5289, 602.7477, 625.0739, 632.8323, 658.7823, 669.4059, 678.4020,
        691.6149, 733.0349, 753.2380, 795.2325, 817.4273, 830.9079, 897.2139],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25, 22,  7,  1, 20,  5,
         4,  2, 27, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.04% 

Test Accuracy: 74.52% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0969584062695503
distance x is tensor(185.4716, device='cuda:3')
benign distance is  tensor(185.4716, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7612023204565048
distance x is tensor(167.6636, device='cuda:3')
benign distance is  tensor(167.6636, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5119077935814857
distance x is tensor(151.4995, device='cuda:3')
benign distance is  tensor(151.4995, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.609337106347084
distance x is tensor(214.0954, device='cuda:3')
benign distance is  tensor(214.0954, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4592151194810867
distance x is tensor(167.2224, device='cuda:3')
benign distance is  tensor(167.2224, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3143615424633026
distance x is tensor(157.6988, device='cuda:3')
benign distance is  tensor(157.6988, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.562711402773857
distance x is tensor(151.7772, device='cuda:3')
benign distance is  tensor(151.7772, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3142877966165543
distance x is tensor(149.3026, device='cuda:3')
benign distance is  tensor(149.3026, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8243336789309978
distance x is tensor(156.9700, device='cuda:3')
benign distance is  tensor(156.9700, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9708095639944077
distance x is tensor(191.1108, device='cuda:3')
benign distance is  tensor(191.1108, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.9480973333120346
distance x is tensor(147.5500, device='cuda:3')
benign distance is  tensor(147.5500, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.420544795691967
distance x is tensor(179.4168, device='cuda:3')
benign distance is  tensor(179.4168, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3552602417767048
distance x is tensor(191.4023, device='cuda:3')
benign distance is  tensor(191.4023, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1093991212546825
distance x is tensor(145.3226, device='cuda:3')
benign distance is  tensor(145.3226, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5653176866471767
distance x is tensor(193.4431, device='cuda:3')
benign distance is  tensor(193.4431, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.045520767569542
distance x is tensor(173.7726, device='cuda:3')
benign distance is  tensor(173.7726, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.13100000016000002
mal_loss is 58.47615718841553
mal_entropy is 0.014903604761457245
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([767.5585, 689.9856, 636.2320, 873.3882, 662.1686, 680.9442, 622.0633,
        626.9077, 460.7946, 460.7946, 460.7946, 460.7946, 460.7946, 460.7946,
        460.7946, 460.7946, 460.7946, 460.7946, 460.7946, 460.7946],
       device='cuda:3')
sorted_norm is   tensor([460.7946, 460.7946, 460.7946, 460.7946, 460.7946, 460.7946, 460.7946,
        460.7946, 460.7946, 460.7946, 460.7946, 460.7946, 622.0633, 626.9077,
        636.2320, 662.1686, 680.9442, 689.9856, 767.5585, 873.3882],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  7,  2,  4],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 82.31% 

Test Accuracy: 48.11% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0886413641273975
distance x is tensor(242.7161, device='cuda:3')
benign distance is  tensor(242.7161, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.162085212767124
distance x is tensor(339.4268, device='cuda:3')
benign distance is  tensor(339.4268, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.226416654884815
distance x is tensor(232.8161, device='cuda:3')
benign distance is  tensor(232.8161, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0076872780919075
distance x is tensor(344.3891, device='cuda:3')
benign distance is  tensor(344.3891, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4427434541285038
distance x is tensor(303.0945, device='cuda:3')
benign distance is  tensor(303.0945, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1871540918946266
distance x is tensor(227.2291, device='cuda:3')
benign distance is  tensor(227.2291, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8681801930069923
distance x is tensor(241.9170, device='cuda:3')
benign distance is  tensor(241.9170, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7105205357074738
distance x is tensor(246.0710, device='cuda:3')
benign distance is  tensor(246.0710, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.09400000015999997
mal_loss is 139.7210817337036
mal_entropy is 0.001556904670504291
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 938.8187, 1270.2433,  848.1921, 1304.0747, 1118.2688,  839.5329,
         924.3548,  916.2444,  459.6532,  459.6532,  459.6532,  459.6532,
         459.6532,  459.6532,  459.6532,  459.6532,  459.6532,  459.6532,
         459.6532,  459.6532,  934.6036,  943.9989, 1012.3547,  836.1941,
        1046.4583,  983.6041,  943.4691,  987.0370,  844.7913,  808.9573,
         921.9341,  841.6512,  870.9054,  855.1740,  839.4426, 1003.2877,
         818.3073,  817.6035,  805.5332,  873.8768,  875.6159, 1120.2325,
         994.3329,  849.1540,  758.0818,  876.4502,  717.9890,  822.1631,
         905.0005,  712.0464,  909.5328,  835.1086], device='cuda:3')
sorted_norm is   tensor([ 459.6532,  459.6532,  459.6532,  459.6532,  459.6532,  459.6532,
         459.6532,  459.6532,  459.6532,  459.6532,  459.6532,  459.6532,
         712.0464,  717.9890,  758.0818,  805.5332,  808.9573,  817.6035,
         818.3073,  822.1631,  835.1086,  836.1941,  839.4426,  839.5329,
         841.6512,  844.7913,  848.1921,  849.1540,  855.1740,  870.9054,
         873.8768,  875.6159,  876.4502,  905.0005,  909.5328,  916.2444,
         921.9341,  924.3548,  934.6036,  938.8187,  943.4691,  943.9989,
         983.6041,  987.0370,  994.3329, 1003.2877, 1012.3547, 1046.4583,
        1118.2688, 1120.2325, 1270.2433, 1304.0747], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 49, 46, 44, 38, 29, 37,
        36, 47, 51, 23, 34,  5, 31, 28,  2, 43, 33, 32, 39, 40, 45, 48, 50,  7,
        30,  6, 20,  0, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.37% 

Test Accuracy: 83.34% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9667444229125977
distance x is tensor(153.6417, device='cuda:3')
benign distance is  tensor(153.6417, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3863689340651035
distance x is tensor(123.6479, device='cuda:3')
benign distance is  tensor(123.6479, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.285840965807438
distance x is tensor(128.0278, device='cuda:3')
benign distance is  tensor(128.0278, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.379833109676838
distance x is tensor(172.6939, device='cuda:3')
benign distance is  tensor(172.6939, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1898757107555866
distance x is tensor(134.0439, device='cuda:3')
benign distance is  tensor(134.0439, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1245833709836006
distance x is tensor(134.7112, device='cuda:3')
benign distance is  tensor(134.7112, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.399098813533783
distance x is tensor(126.4391, device='cuda:3')
benign distance is  tensor(126.4391, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1486524734646082
distance x is tensor(107.3456, device='cuda:3')
benign distance is  tensor(107.3456, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5088514350354671
distance x is tensor(128.4228, device='cuda:3')
benign distance is  tensor(128.4228, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0530386753380299
distance x is tensor(149.4137, device='cuda:3')
benign distance is  tensor(149.4137, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7864032983779907
distance x is tensor(97.7283, device='cuda:3')
benign distance is  tensor(97.7283, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.7842743396759033
distance x is tensor(138.5835, device='cuda:3')
benign distance is  tensor(138.5835, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.315566785633564
distance x is tensor(178.0249, device='cuda:3')
benign distance is  tensor(178.0249, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1622713580727577
distance x is tensor(86.0585, device='cuda:3')
benign distance is  tensor(86.0585, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.320159673690796
distance x is tensor(150.4492, device='cuda:3')
benign distance is  tensor(150.4492, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.060677409172058
distance x is tensor(143.2312, device='cuda:3')
benign distance is  tensor(143.2312, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8052008002996445
distance x is tensor(120.5262, device='cuda:3')
benign distance is  tensor(120.5262, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1199664659798145
distance x is tensor(138.1300, device='cuda:3')
benign distance is  tensor(138.1300, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7709747180342674
distance x is tensor(142.2761, device='cuda:3')
benign distance is  tensor(142.2761, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5126271359622478
distance x is tensor(150.7653, device='cuda:3')
benign distance is  tensor(150.7653, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9132573455572128
distance x is tensor(118.4366, device='cuda:3')
benign distance is  tensor(118.4366, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9195828288793564
distance x is tensor(212.9390, device='cuda:3')
benign distance is  tensor(212.9390, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.222634132951498
distance x is tensor(177.6968, device='cuda:3')
benign distance is  tensor(177.6968, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0452334471046925
distance x is tensor(141.1574, device='cuda:3')
benign distance is  tensor(141.1574, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7334541231393814
distance x is tensor(150.6910, device='cuda:3')
benign distance is  tensor(150.6910, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9374989420175552
distance x is tensor(111.6119, device='cuda:3')
benign distance is  tensor(111.6119, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3138160184025764
distance x is tensor(154.8842, device='cuda:3')
benign distance is  tensor(154.8842, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.981324926018715
distance x is tensor(135.3407, device='cuda:3')
benign distance is  tensor(135.3407, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.416985236108303
distance x is tensor(136.9195, device='cuda:3')
benign distance is  tensor(136.9195, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.369057808071375
distance x is tensor(138.6112, device='cuda:3')
benign distance is  tensor(138.6112, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7583808079361916
distance x is tensor(143.3479, device='cuda:3')
benign distance is  tensor(143.3479, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1647401824593544
distance x is tensor(178.1797, device='cuda:3')
benign distance is  tensor(178.1797, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.5181115195155144
distance x is tensor(131.1197, device='cuda:3')
benign distance is  tensor(131.1197, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.1434349417686462
distance x is tensor(152.8412, device='cuda:3')
benign distance is  tensor(152.8412, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.6867504753172398
distance x is tensor(167.6084, device='cuda:3')
benign distance is  tensor(167.6084, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.5261158682405949
distance x is tensor(115.1693, device='cuda:3')
benign distance is  tensor(115.1693, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.0036557465791702
distance x is tensor(175.5206, device='cuda:3')
benign distance is  tensor(175.5206, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.3280356228351593
distance x is tensor(153.7080, device='cuda:3')
benign distance is  tensor(153.7080, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.3305558897554874
distance x is tensor(137.5951, device='cuda:3')
benign distance is  tensor(137.5951, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7302606627345085
distance x is tensor(156.0477, device='cuda:3')
benign distance is  tensor(156.0477, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5580000001600001
mal_loss is 4.104593992233276
mal_entropy is 0.27783181704580784
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([684.0186, 551.0573, 551.0031, 760.9617, 594.0646, 582.4442, 564.1021,
        482.4542, 435.5356, 435.5356, 435.5356, 435.5356, 435.5356, 435.5356,
        435.5356, 435.5356, 435.5356, 435.5356, 435.5356, 435.5356, 761.6833,
        704.2247, 799.3552, 775.5397, 704.9858, 607.9541, 638.5636, 753.4905],
       device='cuda:3')
sorted_norm is   tensor([435.5356, 435.5356, 435.5356, 435.5356, 435.5356, 435.5356, 435.5356,
        435.5356, 435.5356, 435.5356, 435.5356, 435.5356, 482.4542, 551.0031,
        551.0573, 564.1021, 582.4442, 594.0646, 607.9541, 638.5636, 684.0186,
        704.2247, 704.9858, 753.4905, 760.9617, 761.6833, 775.5397, 799.3552],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  1,  6,  5,  4,
        25, 26,  0, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 89.07% 

Test Accuracy: 81.58% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0340255573391914
distance x is tensor(161.4276, device='cuda:3')
benign distance is  tensor(161.4276, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4529279470443726
distance x is tensor(139.6796, device='cuda:3')
benign distance is  tensor(139.6796, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5985447615385056
distance x is tensor(142.6113, device='cuda:3')
benign distance is  tensor(142.6113, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7350525483489037
distance x is tensor(175.1414, device='cuda:3')
benign distance is  tensor(175.1414, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7566128186881542
distance x is tensor(135.4701, device='cuda:3')
benign distance is  tensor(135.4701, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2316065728664398
distance x is tensor(141.4397, device='cuda:3')
benign distance is  tensor(141.4397, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8720230981707573
distance x is tensor(149.3015, device='cuda:3')
benign distance is  tensor(149.3015, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.442188736051321
distance x is tensor(118.0298, device='cuda:3')
benign distance is  tensor(118.0298, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8547193706035614
distance x is tensor(164.6247, device='cuda:3')
benign distance is  tensor(164.6247, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.1905051544308662
distance x is tensor(148.7016, device='cuda:3')
benign distance is  tensor(148.7016, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9789309427142143
distance x is tensor(167.5003, device='cuda:3')
benign distance is  tensor(167.5003, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.4345545768737793
distance x is tensor(172.0190, device='cuda:3')
benign distance is  tensor(172.0190, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0955184623599052
distance x is tensor(153.4176, device='cuda:3')
benign distance is  tensor(153.4176, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.5738157518208027
distance x is tensor(128.3443, device='cuda:3')
benign distance is  tensor(128.3443, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.1302054971456528
distance x is tensor(123.0730, device='cuda:3')
benign distance is  tensor(123.0730, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9299850948154926
distance x is tensor(152.2315, device='cuda:3')
benign distance is  tensor(152.2315, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3890000001600001
mal_loss is 10.095673441886902
mal_entropy is 0.19021420273929834
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([713.6744, 618.9333, 623.3899, 760.4683, 593.4465, 609.7684, 645.0534,
        528.9929, 446.0037, 446.0037, 446.0037, 446.0037, 446.0037, 446.0037,
        446.0037, 446.0037, 446.0037, 446.0037, 446.0037, 446.0037, 610.0993,
        689.1128, 494.2159, 657.3777, 818.2293, 439.4431, 706.3799, 676.2544],
       device='cuda:3')
sorted_norm is   tensor([439.4431, 446.0037, 446.0037, 446.0037, 446.0037, 446.0037, 446.0037,
        446.0037, 446.0037, 446.0037, 446.0037, 446.0037, 446.0037, 494.2159,
        528.9929, 593.4465, 609.7684, 610.0993, 618.9333, 623.3899, 645.0534,
        657.3777, 676.2544, 689.1128, 706.3799, 713.6744, 760.4683, 818.2293],
       device='cuda:3')
used idx is  tensor([25, 18, 16, 17, 19, 12, 14, 15, 11, 10,  8,  9, 13, 22,  7,  4,  5, 20,
         1,  2,  6, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.06% 

Test Accuracy: 79.23% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0959405153989792
distance x is tensor(165.1277, device='cuda:3')
benign distance is  tensor(165.1277, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.253705359995365
distance x is tensor(164.0127, device='cuda:3')
benign distance is  tensor(164.0127, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6751729547977448
distance x is tensor(146.9366, device='cuda:3')
benign distance is  tensor(146.9366, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.559374526143074
distance x is tensor(189.1907, device='cuda:3')
benign distance is  tensor(189.1907, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.5375344902276993
distance x is tensor(154.7811, device='cuda:3')
benign distance is  tensor(154.7811, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9857552908360958
distance x is tensor(147.7766, device='cuda:3')
benign distance is  tensor(147.7766, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0583079382777214
distance x is tensor(155.2986, device='cuda:3')
benign distance is  tensor(155.2986, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3648348450660706
distance x is tensor(153.6456, device='cuda:3')
benign distance is  tensor(153.6456, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5877043008804321
distance x is tensor(145.2623, device='cuda:3')
benign distance is  tensor(145.2623, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1996968500316143
distance x is tensor(184.1764, device='cuda:3')
benign distance is  tensor(184.1764, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2748291566967964
distance x is tensor(131.4414, device='cuda:3')
benign distance is  tensor(131.4414, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.3505923599004745
distance x is tensor(176.3502, device='cuda:3')
benign distance is  tensor(176.3502, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7980748191475868
distance x is tensor(198.9942, device='cuda:3')
benign distance is  tensor(198.9942, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.585368573665619
distance x is tensor(121.3069, device='cuda:3')
benign distance is  tensor(121.3069, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5783048905432224
distance x is tensor(191.7020, device='cuda:3')
benign distance is  tensor(191.7020, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.9059519320726395
distance x is tensor(189.6115, device='cuda:3')
benign distance is  tensor(189.6115, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.35300000016000005
mal_loss is 16.91473698616028
mal_entropy is 0.12855004612356424
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([721.5784, 713.3710, 613.2214, 808.2723, 656.1989, 641.0484, 663.6050,
        661.2100, 445.5353, 445.5353, 445.5353, 445.5353, 445.5353, 445.5353,
        445.5353, 445.5353, 445.5353, 445.5353, 445.5353, 445.5353, 643.1972,
        697.0721, 699.0583, 749.1130, 619.0901, 994.1229, 852.2097, 709.5839],
       device='cuda:3')
sorted_norm is   tensor([445.5353, 445.5353, 445.5353, 445.5353, 445.5353, 445.5353, 445.5353,
        445.5353, 445.5353, 445.5353, 445.5353, 445.5353, 613.2214, 619.0901,
        641.0484, 643.1972, 656.1989, 661.2100, 663.6050, 697.0721, 699.0583,
        709.5839, 713.3710, 721.5784, 749.1130, 808.2723, 852.2097, 994.1229],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2, 24,  5, 20,  4,  7,
         6, 21, 22, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 86.52% 

Test Accuracy: 77.58% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.201525967568159
distance x is tensor(178.7753, device='cuda:3')
benign distance is  tensor(178.7753, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.595718327909708
distance x is tensor(164.5229, device='cuda:3')
benign distance is  tensor(164.5229, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.616705760359764
distance x is tensor(152.6656, device='cuda:3')
benign distance is  tensor(152.6656, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6133244149386883
distance x is tensor(195.5117, device='cuda:3')
benign distance is  tensor(195.5117, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8884189501404762
distance x is tensor(161.7484, device='cuda:3')
benign distance is  tensor(161.7484, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.163693904876709
distance x is tensor(150.0302, device='cuda:3')
benign distance is  tensor(150.0302, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2309061139822006
distance x is tensor(162.8559, device='cuda:3')
benign distance is  tensor(162.8559, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.852011300623417
distance x is tensor(145.5573, device='cuda:3')
benign distance is  tensor(145.5573, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.4898459538817406
distance x is tensor(145.2112, device='cuda:3')
benign distance is  tensor(145.2112, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.8126165196299553
distance x is tensor(152.9539, device='cuda:3')
benign distance is  tensor(152.9539, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8563818261027336
distance x is tensor(167.1401, device='cuda:3')
benign distance is  tensor(167.1401, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.6878487914800644
distance x is tensor(172.7769, device='cuda:3')
benign distance is  tensor(172.7769, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.663105569779873
distance x is tensor(132.7413, device='cuda:3')
benign distance is  tensor(132.7413, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1361120715737343
distance x is tensor(231.0539, device='cuda:3')
benign distance is  tensor(231.0539, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9193175062537193
distance x is tensor(206.0956, device='cuda:3')
benign distance is  tensor(206.0956, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3254977427423
distance x is tensor(173.5276, device='cuda:3')
benign distance is  tensor(173.5276, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3200000001600001
mal_loss is 20.61476767063141
mal_entropy is 0.11834305943921208
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([763.6815, 704.8073, 651.1192, 829.2514, 672.9698, 651.8582, 702.9824,
        610.0214, 450.4855, 450.4855, 450.4855, 450.4855, 450.4855, 450.4855,
        450.4855, 450.4855, 450.4855, 450.4855, 450.4855, 450.4855, 761.2416,
        621.9093, 804.1143, 739.2532, 730.2794, 744.2920, 730.1129, 894.0237,
        661.4060, 822.3852, 629.8439, 792.3453, 852.6071, 560.7297, 837.2259,
        842.7201], device='cuda:3')
sorted_norm is   tensor([450.4855, 450.4855, 450.4855, 450.4855, 450.4855, 450.4855, 450.4855,
        450.4855, 450.4855, 450.4855, 450.4855, 450.4855, 560.7297, 610.0214,
        621.9093, 629.8439, 651.1192, 651.8582, 661.4060, 672.9698, 702.9824,
        704.8073, 730.1129, 730.2794, 739.2532, 744.2920, 761.2416, 763.6815,
        792.3453, 804.1143, 822.3852, 829.2514, 837.2259, 842.7201, 852.6071,
        894.0237], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33,  7, 21, 30,  2,  5,
        28,  4,  6,  1, 26, 24, 23, 25, 20,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 87.84% 

Test Accuracy: 80.88% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.978778712451458
distance x is tensor(183.9337, device='cuda:3')
benign distance is  tensor(183.9337, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3925674855709076
distance x is tensor(145.1314, device='cuda:3')
benign distance is  tensor(145.1314, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5619236826896667
distance x is tensor(138.0835, device='cuda:3')
benign distance is  tensor(138.0835, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6464647203683853
distance x is tensor(188.0456, device='cuda:3')
benign distance is  tensor(188.0456, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4016789235174656
distance x is tensor(146.9831, device='cuda:3')
benign distance is  tensor(146.9831, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1809907294809818
distance x is tensor(143.9518, device='cuda:3')
benign distance is  tensor(143.9518, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3144009858369827
distance x is tensor(137.8635, device='cuda:3')
benign distance is  tensor(137.8635, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4080208837985992
distance x is tensor(138.7939, device='cuda:3')
benign distance is  tensor(138.7939, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7349203117191792
distance x is tensor(133.0290, device='cuda:3')
benign distance is  tensor(133.0290, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.384843397885561
distance x is tensor(185.8517, device='cuda:3')
benign distance is  tensor(185.8517, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6459136381745338
distance x is tensor(108.6264, device='cuda:3')
benign distance is  tensor(108.6264, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.528989404439926
distance x is tensor(154.2730, device='cuda:3')
benign distance is  tensor(154.2730, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.4397646710276604
distance x is tensor(183.8441, device='cuda:3')
benign distance is  tensor(183.8441, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.5103730708360672
distance x is tensor(96.9442, device='cuda:3')
benign distance is  tensor(96.9442, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0950674377381802
distance x is tensor(180.0735, device='cuda:3')
benign distance is  tensor(180.0735, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.8036519438028336
distance x is tensor(151.9526, device='cuda:3')
benign distance is  tensor(151.9526, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6719567775726318
distance x is tensor(154.5155, device='cuda:3')
benign distance is  tensor(154.5155, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3164423294365406
distance x is tensor(135.8934, device='cuda:3')
benign distance is  tensor(135.8934, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.788003746420145
distance x is tensor(160.5258, device='cuda:3')
benign distance is  tensor(160.5258, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.9572199285030365
distance x is tensor(154.2431, device='cuda:3')
benign distance is  tensor(154.2431, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6848091185092926
distance x is tensor(150.7229, device='cuda:3')
benign distance is  tensor(150.7229, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5420725867152214
distance x is tensor(150.3243, device='cuda:3')
benign distance is  tensor(150.3243, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7916813064366579
distance x is tensor(161.8191, device='cuda:3')
benign distance is  tensor(161.8191, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1970594078302383
distance x is tensor(193.3152, device='cuda:3')
benign distance is  tensor(193.3152, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.35700000016000005
mal_loss is 13.22250634431839
mal_entropy is 0.14345141034573317
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([767.9504, 618.3763, 583.3486, 798.8984, 591.1936, 619.5073, 598.8672,
        597.6873, 446.4639, 446.4639, 446.4639, 446.4639, 446.4639, 446.4639,
        446.4639, 446.4639, 446.4639, 446.4639, 446.4639, 446.4639],
       device='cuda:3')
sorted_norm is   tensor([446.4639, 446.4639, 446.4639, 446.4639, 446.4639, 446.4639, 446.4639,
        446.4639, 446.4639, 446.4639, 446.4639, 446.4639, 583.3486, 591.1936,
        597.6873, 598.8672, 618.3763, 619.5073, 767.9504, 798.8984],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  4,  7,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 86.95% 

Test Accuracy: 65.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1628410555422306
distance x is tensor(205.4651, device='cuda:3')
benign distance is  tensor(205.4651, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7156502828001976
distance x is tensor(187.5552, device='cuda:3')
benign distance is  tensor(187.5552, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3435153886675835
distance x is tensor(173.7595, device='cuda:3')
benign distance is  tensor(173.7595, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.872572660446167
distance x is tensor(210.2802, device='cuda:3')
benign distance is  tensor(210.2802, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.33322311937809
distance x is tensor(194.3624, device='cuda:3')
benign distance is  tensor(194.3624, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3356601148843765
distance x is tensor(183.5403, device='cuda:3')
benign distance is  tensor(183.5403, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8757238686084747
distance x is tensor(194.9574, device='cuda:3')
benign distance is  tensor(194.9574, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6283555626869202
distance x is tensor(172.1033, device='cuda:3')
benign distance is  tensor(172.1033, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.18800000016000007
mal_loss is 54.304489612579346
mal_entropy is 0.03908157045952976
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 852.2305,  779.7397,  672.5956,  852.9117,  776.0816,  730.2133,
         793.4780,  689.1290,  449.4681,  449.4680,  449.4681,  449.4680,
         449.4681,  449.4680,  449.4681,  449.4680,  449.4681,  449.4680,
         449.4681,  449.4680,  824.0939,  903.2796,  932.2790,  766.7822,
         986.9995,  909.5510,  841.7981,  906.3547,  922.2758,  852.0455,
         906.4154,  908.8687,  851.3127,  775.2227,  761.5272,  851.0330,
         745.2825,  781.6249,  814.9933,  836.5639,  693.5425, 1058.4862,
         958.5876,  837.6242,  678.5957,  871.4050,  594.9475,  762.3190,
         882.3212,  537.6925,  848.9219,  765.5143], device='cuda:3')
sorted_norm is   tensor([ 449.4680,  449.4680,  449.4680,  449.4680,  449.4680,  449.4680,
         449.4681,  449.4681,  449.4681,  449.4681,  449.4681,  449.4681,
         537.6925,  594.9475,  672.5956,  678.5957,  689.1290,  693.5425,
         730.2133,  745.2825,  761.5272,  762.3190,  765.5143,  766.7822,
         775.2227,  776.0816,  779.7397,  781.6249,  793.4780,  814.9933,
         824.0939,  836.5639,  837.6242,  841.7981,  848.9219,  851.0330,
         851.3127,  852.0455,  852.2305,  852.9117,  871.4050,  882.3212,
         903.2796,  906.3547,  906.4154,  908.8687,  909.5510,  922.2758,
         932.2790,  958.5876,  986.9995, 1058.4862], device='cuda:3')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 49, 46,  2, 44,  7, 40,
         5, 36, 34, 47, 51, 23, 33,  4,  1, 37,  6, 38, 20, 39, 43, 26, 50, 35,
        32, 29,  0,  3, 45], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 85.77% 

Test Accuracy: 83.62% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8295732084661722
distance x is tensor(160.7610, device='cuda:3')
benign distance is  tensor(160.7610, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8300619572401047
distance x is tensor(132.4221, device='cuda:3')
benign distance is  tensor(132.4221, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3413220271468163
distance x is tensor(119.4234, device='cuda:3')
benign distance is  tensor(119.4234, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6450339704751968
distance x is tensor(171.5242, device='cuda:3')
benign distance is  tensor(171.5242, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9829287752509117
distance x is tensor(118.2669, device='cuda:3')
benign distance is  tensor(118.2669, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3555933386087418
distance x is tensor(139.1414, device='cuda:3')
benign distance is  tensor(139.1414, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3528108187019825
distance x is tensor(138.4362, device='cuda:3')
benign distance is  tensor(138.4362, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.233386941254139
distance x is tensor(122.3786, device='cuda:3')
benign distance is  tensor(122.3786, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6620745956897736
distance x is tensor(141.9649, device='cuda:3')
benign distance is  tensor(141.9649, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1120464000850916
distance x is tensor(152.4913, device='cuda:3')
benign distance is  tensor(152.4913, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.068922407925129
distance x is tensor(109.2082, device='cuda:3')
benign distance is  tensor(109.2082, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.16353876888752
distance x is tensor(145.7704, device='cuda:3')
benign distance is  tensor(145.7704, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.93490269780159
distance x is tensor(193.6732, device='cuda:3')
benign distance is  tensor(193.6732, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8832014054059982
distance x is tensor(86.0532, device='cuda:3')
benign distance is  tensor(86.0532, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3152148015797138
distance x is tensor(204.8856, device='cuda:3')
benign distance is  tensor(204.8856, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.1778346598148346
distance x is tensor(154.6433, device='cuda:3')
benign distance is  tensor(154.6433, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.091461144387722
distance x is tensor(123.1513, device='cuda:3')
benign distance is  tensor(123.1513, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.315988302230835
distance x is tensor(146.6604, device='cuda:3')
benign distance is  tensor(146.6604, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.7481759414076805
distance x is tensor(152.4198, device='cuda:3')
benign distance is  tensor(152.4198, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.6156557276844978
distance x is tensor(158.4874, device='cuda:3')
benign distance is  tensor(158.4874, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9382955953478813
distance x is tensor(113.0006, device='cuda:3')
benign distance is  tensor(113.0006, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1696245707571507
distance x is tensor(215.4757, device='cuda:3')
benign distance is  tensor(215.4757, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5954219922423363
distance x is tensor(187.3764, device='cuda:3')
benign distance is  tensor(187.3764, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4818022549152374
distance x is tensor(142.4059, device='cuda:3')
benign distance is  tensor(142.4059, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.949096079915762
distance x is tensor(145.6655, device='cuda:3')
benign distance is  tensor(145.6655, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.6163060143589973
distance x is tensor(130.6253, device='cuda:3')
benign distance is  tensor(130.6253, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9319885186851025
distance x is tensor(151.3129, device='cuda:3')
benign distance is  tensor(151.3129, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.91521680355072
distance x is tensor(150.2797, device='cuda:3')
benign distance is  tensor(150.2797, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0331009328365326
distance x is tensor(146.8180, device='cuda:3')
benign distance is  tensor(146.8180, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.1621362902224064
distance x is tensor(115.0858, device='cuda:3')
benign distance is  tensor(115.0858, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.6303749457001686
distance x is tensor(110.5110, device='cuda:3')
benign distance is  tensor(110.5110, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.121048104017973
distance x is tensor(148.9543, device='cuda:3')
benign distance is  tensor(148.9543, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.5918565914034843
distance x is tensor(148.2281, device='cuda:3')
benign distance is  tensor(148.2281, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.3598655313253403
distance x is tensor(152.0063, device='cuda:3')
benign distance is  tensor(152.0063, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.5094334222376347
distance x is tensor(169.2333, device='cuda:3')
benign distance is  tensor(169.2333, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.8067337200045586
distance x is tensor(103.8432, device='cuda:3')
benign distance is  tensor(103.8432, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.9972431994974613
distance x is tensor(173.1362, device='cuda:3')
benign distance is  tensor(173.1362, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.2557708509266376
distance x is tensor(152.4152, device='cuda:3')
benign distance is  tensor(152.4152, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.6265100724995136
distance x is tensor(132.7173, device='cuda:3')
benign distance is  tensor(132.7173, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7274347590282559
distance x is tensor(157.7727, device='cuda:3')
benign distance is  tensor(157.7727, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.62200000016
mal_loss is 2.8591642007231712
mal_entropy is 0.27485485281795263
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([706.2240, 582.2946, 509.7108, 743.1737, 502.4070, 582.7699, 613.6862,
        526.5767, 443.3571, 443.3571, 443.3571, 443.3571, 443.3571, 443.3571,
        443.3571, 443.3571, 443.3571, 443.3571, 443.3571, 443.3571],
       device='cuda:3')
sorted_norm is   tensor([443.3571, 443.3571, 443.3571, 443.3571, 443.3571, 443.3571, 443.3571,
        443.3571, 443.3571, 443.3571, 443.3571, 443.3571, 502.4070, 509.7108,
        526.5767, 582.2946, 582.7699, 613.6862, 706.2240, 743.1737],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  2,  7,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.74% 

Test Accuracy: 79.34% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1878390088677406
distance x is tensor(175.3930, device='cuda:3')
benign distance is  tensor(175.3930, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.758187748491764
distance x is tensor(160.2896, device='cuda:3')
benign distance is  tensor(160.2896, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.817523553967476
distance x is tensor(145.3624, device='cuda:3')
benign distance is  tensor(145.3624, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6762912645936012
distance x is tensor(194.1432, device='cuda:3')
benign distance is  tensor(194.1432, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6060347743332386
distance x is tensor(161.6482, device='cuda:3')
benign distance is  tensor(161.6482, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3073946349322796
distance x is tensor(154.9490, device='cuda:3')
benign distance is  tensor(154.9490, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.702629305422306
distance x is tensor(159.5013, device='cuda:3')
benign distance is  tensor(159.5013, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.762228824198246
distance x is tensor(157.7355, device='cuda:3')
benign distance is  tensor(157.7355, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2570000001600001
mal_loss is 25.31507396697998
mal_entropy is 0.08718283753842115
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([765.1315, 682.5153, 594.4089, 801.4243, 681.7874, 638.3312, 672.2926,
        685.3228, 450.8957, 450.8957, 450.8957, 450.8957, 450.8957, 450.8957,
        450.8957, 450.8957, 450.8957, 450.8957, 450.8957, 450.8957, 782.8799,
        722.0581, 814.7889, 795.1984, 768.1808, 782.2679, 807.4857, 930.6179,
        701.6636, 756.9859, 604.2367, 735.5187, 921.0541, 513.2079, 946.4439,
        779.9004], device='cuda:3')
sorted_norm is   tensor([450.8957, 450.8957, 450.8957, 450.8957, 450.8957, 450.8957, 450.8957,
        450.8957, 450.8957, 450.8957, 450.8957, 450.8957, 513.2079, 594.4089,
        604.2367, 638.3312, 672.2926, 681.7874, 682.5153, 685.3228, 701.6636,
        722.0581, 735.5187, 756.9859, 765.1315, 768.1808, 779.9004, 782.2679,
        782.8799, 795.1984, 801.4243, 807.4857, 814.7889, 921.0541, 930.6179,
        946.4439], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33,  2, 30,  5,  6,  4,
         1,  7, 28, 21, 31, 29,  0, 24, 35, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.01% 

Test Accuracy: 82.77% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8587782867252827
distance x is tensor(177.8799, device='cuda:3')
benign distance is  tensor(177.8799, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5200789980590343
distance x is tensor(138.6340, device='cuda:3')
benign distance is  tensor(138.6340, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4200024157762527
distance x is tensor(135.7294, device='cuda:3')
benign distance is  tensor(135.7294, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6909046694636345
distance x is tensor(182.4844, device='cuda:3')
benign distance is  tensor(182.4844, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5772792808711529
distance x is tensor(151.7916, device='cuda:3')
benign distance is  tensor(151.7916, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2388943322002888
distance x is tensor(133.0830, device='cuda:3')
benign distance is  tensor(133.0830, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.956756316125393
distance x is tensor(149.7103, device='cuda:3')
benign distance is  tensor(149.7103, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.889407642185688
distance x is tensor(146.3407, device='cuda:3')
benign distance is  tensor(146.3407, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.330204963684082
distance x is tensor(141.7027, device='cuda:3')
benign distance is  tensor(141.7027, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.5934101268649101
distance x is tensor(225.4137, device='cuda:3')
benign distance is  tensor(225.4137, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.314422532916069
distance x is tensor(130.9360, device='cuda:3')
benign distance is  tensor(130.9360, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3147204741835594
distance x is tensor(153.9231, device='cuda:3')
benign distance is  tensor(153.9231, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2626257985830307
distance x is tensor(185.2775, device='cuda:3')
benign distance is  tensor(185.2775, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.7288716286420822
distance x is tensor(115.4866, device='cuda:3')
benign distance is  tensor(115.4866, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8180230930447578
distance x is tensor(174.8841, device='cuda:3')
benign distance is  tensor(174.8841, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.495379686355591
distance x is tensor(148.3724, device='cuda:3')
benign distance is  tensor(148.3724, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.531890656799078
distance x is tensor(169.7476, device='cuda:3')
benign distance is  tensor(169.7476, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3111549764871597
distance x is tensor(135.1262, device='cuda:3')
benign distance is  tensor(135.1262, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.7352333813905716
distance x is tensor(172.8193, device='cuda:3')
benign distance is  tensor(172.8193, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.8250625655055046
distance x is tensor(144.1376, device='cuda:3')
benign distance is  tensor(144.1376, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.4687633365392685
distance x is tensor(176.6180, device='cuda:3')
benign distance is  tensor(176.6180, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5927763879299164
distance x is tensor(170.0036, device='cuda:3')
benign distance is  tensor(170.0036, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.710550932213664
distance x is tensor(154.7514, device='cuda:3')
benign distance is  tensor(154.7514, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.8187694400548935
distance x is tensor(188.3354, device='cuda:3')
benign distance is  tensor(188.3354, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.31400000016000007
mal_loss is 13.703083574771881
mal_entropy is 0.13175525981932878
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([752.5607, 599.9545, 574.8164, 777.3420, 641.7871, 546.8746, 643.1677,
        613.0623, 453.8267, 453.8267, 453.8267, 453.8267, 453.8267, 453.8267,
        453.8267, 453.8267, 453.8267, 453.8267, 453.8267, 453.8267, 641.8787,
        725.3373, 721.8439, 736.9245, 590.3921, 973.7402, 863.2086, 700.0408],
       device='cuda:3')
sorted_norm is   tensor([453.8267, 453.8267, 453.8267, 453.8267, 453.8267, 453.8267, 453.8267,
        453.8267, 453.8267, 453.8267, 453.8267, 453.8267, 546.8746, 574.8164,
        590.3921, 599.9545, 613.0623, 641.7871, 641.8787, 643.1677, 700.0408,
        721.8439, 725.3373, 736.9245, 752.5607, 777.3420, 863.2086, 973.7402],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  5,  2, 24,  1,  7,  4,
        20,  6, 27, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 87.64% 

Test Accuracy: 80.29% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9072983078658581
distance x is tensor(171.3245, device='cuda:3')
benign distance is  tensor(171.3245, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8958303555846214
distance x is tensor(141.6573, device='cuda:3')
benign distance is  tensor(141.6573, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4694832041859627
distance x is tensor(141.8905, device='cuda:3')
benign distance is  tensor(141.8905, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3359174579381943
distance x is tensor(186.1031, device='cuda:3')
benign distance is  tensor(186.1031, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4048344120383263
distance x is tensor(162.9793, device='cuda:3')
benign distance is  tensor(162.9793, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7201242335140705
distance x is tensor(149.7691, device='cuda:3')
benign distance is  tensor(149.7691, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8690935969352722
distance x is tensor(153.9920, device='cuda:3')
benign distance is  tensor(153.9920, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9337816461920738
distance x is tensor(133.1292, device='cuda:3')
benign distance is  tensor(133.1292, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.292255260050297
distance x is tensor(151.9583, device='cuda:3')
benign distance is  tensor(151.9583, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.5302810370922089
distance x is tensor(163.3289, device='cuda:3')
benign distance is  tensor(163.3289, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.0900253504514694
distance x is tensor(153.4731, device='cuda:3')
benign distance is  tensor(153.4731, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.0428075939416885
distance x is tensor(192.0843, device='cuda:3')
benign distance is  tensor(192.0843, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.295018956065178
distance x is tensor(140.1870, device='cuda:3')
benign distance is  tensor(140.1870, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.081363495439291
distance x is tensor(225.0923, device='cuda:3')
benign distance is  tensor(225.0923, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.031679220497608
distance x is tensor(207.9258, device='cuda:3')
benign distance is  tensor(207.9258, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4375877939164639
distance x is tensor(155.3399, device='cuda:3')
benign distance is  tensor(155.3399, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.16900000016000008
mal_loss is 33.643126010894775
mal_entropy is 0.04121456982102245
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([719.2100, 592.9673, 585.8248, 788.9217, 691.2651, 631.2415, 657.9606,
        544.1934, 456.7796, 456.7796, 456.7796, 456.7796, 456.7796, 456.7796,
        456.7796, 456.7796, 456.7796, 456.7796, 456.7796, 456.7796, 658.9849,
        981.8778, 605.0508, 714.9226, 836.7837, 542.9965, 771.2669, 689.2802],
       device='cuda:3')
sorted_norm is   tensor([456.7796, 456.7796, 456.7796, 456.7796, 456.7796, 456.7796, 456.7796,
        456.7796, 456.7796, 456.7796, 456.7796, 456.7796, 542.9965, 544.1934,
        585.8248, 592.9673, 605.0508, 631.2415, 657.9606, 658.9849, 689.2802,
        691.2651, 714.9226, 719.2100, 771.2669, 788.9217, 836.7837, 981.8778],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25,  7,  2,  1, 22,  5,
         6, 20, 27,  4], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 84.24% 

Test Accuracy: 76.38% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2112838048487902
distance x is tensor(186.3791, device='cuda:3')
benign distance is  tensor(186.3791, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4309809356927872
distance x is tensor(152.9026, device='cuda:3')
benign distance is  tensor(152.9026, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.767375886440277
distance x is tensor(157.4863, device='cuda:3')
benign distance is  tensor(157.4863, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.1799528524279594
distance x is tensor(218.5597, device='cuda:3')
benign distance is  tensor(218.5597, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4145298823714256
distance x is tensor(165.6709, device='cuda:3')
benign distance is  tensor(165.6709, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2178813852369785
distance x is tensor(148.5271, device='cuda:3')
benign distance is  tensor(148.5271, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.128120705485344
distance x is tensor(166.7059, device='cuda:3')
benign distance is  tensor(166.7059, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6300197094678879
distance x is tensor(149.4438, device='cuda:3')
benign distance is  tensor(149.4438, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.0598163083195686
distance x is tensor(163.9844, device='cuda:3')
benign distance is  tensor(163.9844, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3440904431045055
distance x is tensor(178.2087, device='cuda:3')
benign distance is  tensor(178.2087, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.9835814386606216
distance x is tensor(150.0239, device='cuda:3')
benign distance is  tensor(150.0239, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.649204581975937
distance x is tensor(168.4691, device='cuda:3')
benign distance is  tensor(168.4691, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.027261443436146
distance x is tensor(195.4894, device='cuda:3')
benign distance is  tensor(195.4894, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2626671716570854
distance x is tensor(112.9160, device='cuda:3')
benign distance is  tensor(112.9160, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5308522209525108
distance x is tensor(187.8478, device='cuda:3')
benign distance is  tensor(187.8478, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.5230979919433594
distance x is tensor(204.7771, device='cuda:3')
benign distance is  tensor(204.7771, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10600000015999997
mal_loss is 60.93054723739624
mal_entropy is 0.008562261181964459
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([749.6283, 637.9662, 621.4235, 880.9857, 679.8915, 608.6367, 683.1857,
        605.0772, 455.1194, 455.1194, 455.1194, 455.1194, 455.1194, 455.1194,
        455.1194, 455.1194, 455.1194, 455.1194, 455.1194, 455.1194, 813.8742,
        756.1077, 839.0783, 817.2278, 792.2967, 711.9888, 688.5231, 814.6354],
       device='cuda:3')
sorted_norm is   tensor([455.1194, 455.1194, 455.1194, 455.1194, 455.1194, 455.1194, 455.1194,
        455.1194, 455.1194, 455.1194, 455.1194, 455.1194, 605.0772, 608.6367,
        621.4235, 637.9662, 679.8915, 683.1857, 688.5231, 711.9888, 749.6283,
        756.1077, 792.2967, 813.8742, 814.6354, 817.2278, 839.0783, 880.9857],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  5,  2,  1,  4,  6,
        26, 25,  0, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 86.06% 

Test Accuracy: 77.82% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.968419011682272
distance x is tensor(177.5320, device='cuda:3')
benign distance is  tensor(177.5320, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7840507999062538
distance x is tensor(141.2175, device='cuda:3')
benign distance is  tensor(141.2175, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4370008744299412
distance x is tensor(148.2474, device='cuda:3')
benign distance is  tensor(148.2474, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7675870060920715
distance x is tensor(186.8788, device='cuda:3')
benign distance is  tensor(186.8788, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.70842569693923
distance x is tensor(170.8822, device='cuda:3')
benign distance is  tensor(170.8822, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3901217617094517
distance x is tensor(153.6145, device='cuda:3')
benign distance is  tensor(153.6145, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.459097720682621
distance x is tensor(162.9595, device='cuda:3')
benign distance is  tensor(162.9595, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5648225098848343
distance x is tensor(133.7590, device='cuda:3')
benign distance is  tensor(133.7590, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1805787943303585
distance x is tensor(169.6447, device='cuda:3')
benign distance is  tensor(169.6447, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.9198359102010727
distance x is tensor(164.0840, device='cuda:3')
benign distance is  tensor(164.0840, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.2615768164396286
distance x is tensor(173.5363, device='cuda:3')
benign distance is  tensor(173.5363, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.2627381831407547
distance x is tensor(170.8542, device='cuda:3')
benign distance is  tensor(170.8542, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.3320326507091522
distance x is tensor(183.0744, device='cuda:3')
benign distance is  tensor(183.0744, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.5912897139787674
distance x is tensor(149.4376, device='cuda:3')
benign distance is  tensor(149.4376, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.9994668141007423
distance x is tensor(142.3022, device='cuda:3')
benign distance is  tensor(142.3022, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.1927115730941296
distance x is tensor(185.0266, device='cuda:3')
benign distance is  tensor(185.0266, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.12900000016000002
mal_loss is 47.34596872329712
mal_entropy is 0.0232304000746808
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([762.2910, 599.2092, 611.7408, 779.4598, 709.9135, 622.9335, 675.7403,
        561.8308, 457.0012, 457.0012, 457.0012, 457.0012, 457.0012, 457.0012,
        457.0012, 457.0012, 457.0012, 457.0012, 457.0012, 457.0012, 846.0158,
        861.4677, 907.9020, 704.5307, 931.1108, 860.5834, 793.1638, 868.8820,
        820.7365, 698.0045, 860.6091, 753.7955, 838.7224, 799.9020, 769.6342,
        892.4629, 732.7775, 755.5890, 719.1126, 867.3687, 662.2272, 986.2202,
        942.6718, 740.9877, 700.2326, 770.2722, 633.8607, 748.5307, 848.0262,
        503.5782, 801.5472, 857.5802], device='cuda:3')
sorted_norm is   tensor([457.0012, 457.0012, 457.0012, 457.0012, 457.0012, 457.0012, 457.0012,
        457.0012, 457.0012, 457.0012, 457.0012, 457.0012, 503.5782, 561.8308,
        599.2092, 611.7408, 622.9335, 633.8607, 662.2272, 675.7403, 698.0045,
        700.2326, 704.5307, 709.9135, 719.1126, 732.7775, 740.9877, 748.5307,
        753.7955, 755.5890, 762.2910, 769.6342, 770.2722, 779.4598, 793.1638,
        799.9020, 801.5472, 820.7365, 838.7224, 846.0158, 848.0262, 857.5802,
        860.5834, 860.6091, 861.4677, 867.3687, 868.8820, 892.4629, 907.9020,
        931.1108, 942.6718, 986.2202], device='cuda:3')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19, 15, 13,  9, 11, 49,  7,  1,  2,  5, 46,
        40,  6, 29, 44, 23,  4, 38, 36, 43, 47, 31, 37,  0, 34, 45,  3, 26, 33,
        50, 28, 32, 20, 48], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 81.58% 

Test Accuracy: 83.00% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9541809074580669
distance x is tensor(161.5677, device='cuda:3')
benign distance is  tensor(161.5677, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5680714771151543
distance x is tensor(121.9829, device='cuda:3')
benign distance is  tensor(121.9829, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.645128808915615
distance x is tensor(123.3147, device='cuda:3')
benign distance is  tensor(123.3147, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.548813447356224
distance x is tensor(165.2236, device='cuda:3')
benign distance is  tensor(165.2236, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6129716336727142
distance x is tensor(131.2889, device='cuda:3')
benign distance is  tensor(131.2889, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0911854654550552
distance x is tensor(135.2166, device='cuda:3')
benign distance is  tensor(135.2166, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.490263320505619
distance x is tensor(108.1187, device='cuda:3')
benign distance is  tensor(108.1187, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7012705989181995
distance x is tensor(120.5635, device='cuda:3')
benign distance is  tensor(120.5635, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5549183264374733
distance x is tensor(122.5836, device='cuda:3')
benign distance is  tensor(122.5836, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4062357731163502
distance x is tensor(159.1248, device='cuda:3')
benign distance is  tensor(159.1248, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1159107983112335
distance x is tensor(93.7394, device='cuda:3')
benign distance is  tensor(93.7394, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.048923909664154
distance x is tensor(137.7637, device='cuda:3')
benign distance is  tensor(137.7637, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7504705861210823
distance x is tensor(169.5811, device='cuda:3')
benign distance is  tensor(169.5811, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1219580508768559
distance x is tensor(87.6065, device='cuda:3')
benign distance is  tensor(87.6065, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5072870552539825
distance x is tensor(157.9705, device='cuda:3')
benign distance is  tensor(157.9705, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.5334947779774666
distance x is tensor(138.5129, device='cuda:3')
benign distance is  tensor(138.5129, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.343201570212841
distance x is tensor(111.6286, device='cuda:3')
benign distance is  tensor(111.6286, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3225960806012154
distance x is tensor(131.1151, device='cuda:3')
benign distance is  tensor(131.1151, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.6101419851183891
distance x is tensor(133.3125, device='cuda:3')
benign distance is  tensor(133.3125, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7212295159697533
distance x is tensor(149.6204, device='cuda:3')
benign distance is  tensor(149.6204, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.8102139309048653
distance x is tensor(126.6913, device='cuda:3')
benign distance is  tensor(126.6913, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1097885444760323
distance x is tensor(253.7802, device='cuda:3')
benign distance is  tensor(253.7802, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.853492632508278
distance x is tensor(174.5850, device='cuda:3')
benign distance is  tensor(174.5850, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0723076723515987
distance x is tensor(147.1814, device='cuda:3')
benign distance is  tensor(147.1814, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.2878137677907944
distance x is tensor(159.7104, device='cuda:3')
benign distance is  tensor(159.7104, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3876254372298717
distance x is tensor(105.4437, device='cuda:3')
benign distance is  tensor(105.4437, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.6153789646923542
distance x is tensor(152.8922, device='cuda:3')
benign distance is  tensor(152.8922, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.1670384258031845
distance x is tensor(127.1202, device='cuda:3')
benign distance is  tensor(127.1202, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.13881940767169
distance x is tensor(142.0052, device='cuda:3')
benign distance is  tensor(142.0052, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8827420696616173
distance x is tensor(142.3448, device='cuda:3')
benign distance is  tensor(142.3448, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7926866486668587
distance x is tensor(145.5141, device='cuda:3')
benign distance is  tensor(145.5141, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.4001158475875854
distance x is tensor(167.4801, device='cuda:3')
benign distance is  tensor(167.4801, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.291609302163124
distance x is tensor(130.7474, device='cuda:3')
benign distance is  tensor(130.7474, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.922301672399044
distance x is tensor(154.7416, device='cuda:3')
benign distance is  tensor(154.7416, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.7217106707394123
distance x is tensor(175.4007, device='cuda:3')
benign distance is  tensor(175.4007, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.2785875126719475
distance x is tensor(106.2685, device='cuda:3')
benign distance is  tensor(106.2685, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.2912833988666534
distance x is tensor(170.7584, device='cuda:3')
benign distance is  tensor(170.7584, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.9622033461928368
distance x is tensor(151.7098, device='cuda:3')
benign distance is  tensor(151.7098, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.4074100852012634
distance x is tensor(143.0397, device='cuda:3')
benign distance is  tensor(143.0397, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7890886329114437
distance x is tensor(155.3905, device='cuda:3')
benign distance is  tensor(155.3905, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.66400000016
mal_loss is 2.324907936155796
mal_entropy is 0.2719201100990176
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([720.8598, 545.0585, 529.5980, 722.0139, 566.4664, 547.2242, 477.2284,
        522.8730, 442.2102, 442.2102, 442.2102, 442.2102, 442.2102, 442.2102,
        442.2102, 442.2102, 442.2102, 442.2102, 442.2102, 442.2102],
       device='cuda:3')
sorted_norm is   tensor([442.2102, 442.2102, 442.2102, 442.2102, 442.2102, 442.2102, 442.2102,
        442.2102, 442.2102, 442.2102, 442.2102, 442.2102, 477.2284, 522.8730,
        529.5980, 545.0585, 547.2242, 566.4664, 720.8598, 722.0139],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  7,  2,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 86.55% 

Test Accuracy: 78.61% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2780491262674332
distance x is tensor(193.2198, device='cuda:3')
benign distance is  tensor(193.2198, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2996529936790466
distance x is tensor(160.7924, device='cuda:3')
benign distance is  tensor(160.7924, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.603309027850628
distance x is tensor(143.6528, device='cuda:3')
benign distance is  tensor(143.6528, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6232679411768913
distance x is tensor(188.6811, device='cuda:3')
benign distance is  tensor(188.6811, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.822113297879696
distance x is tensor(154.6625, device='cuda:3')
benign distance is  tensor(154.6625, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5758014060556889
distance x is tensor(160.8029, device='cuda:3')
benign distance is  tensor(160.8029, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2375255078077316
distance x is tensor(150.6851, device='cuda:3')
benign distance is  tensor(150.6851, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.300777267664671
distance x is tensor(131.5753, device='cuda:3')
benign distance is  tensor(131.5753, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.21100000016000006
mal_loss is 29.05222511291504
mal_entropy is 0.06768813193775713
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([812.3136, 672.7296, 584.2479, 785.2414, 631.0967, 652.3324, 637.4240,
        561.9013, 448.5385, 448.5385, 448.5385, 448.5385, 448.5385, 448.5385,
        448.5385, 448.5385, 448.5385, 448.5385, 448.5385, 448.5385, 637.4423,
        758.9601, 526.1075, 719.8958, 822.4860, 511.9666, 752.2209, 714.8847],
       device='cuda:3')
sorted_norm is   tensor([448.5385, 448.5385, 448.5385, 448.5385, 448.5385, 448.5385, 448.5385,
        448.5385, 448.5385, 448.5385, 448.5385, 448.5385, 511.9666, 526.1075,
        561.9013, 584.2479, 631.0967, 637.4240, 637.4423, 652.3324, 672.7296,
        714.8847, 719.8958, 752.2209, 758.9601, 785.2414, 812.3136, 822.4860],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 25, 22,  7,  2,  4,  6,
        20,  5,  1, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 84.35% 

Test Accuracy: 77.04% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0885443724691868
distance x is tensor(176.0732, device='cuda:3')
benign distance is  tensor(176.0732, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6725503578782082
distance x is tensor(156.2885, device='cuda:3')
benign distance is  tensor(156.2885, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5437766686081886
distance x is tensor(146.9652, device='cuda:3')
benign distance is  tensor(146.9652, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.699982512742281
distance x is tensor(183.0837, device='cuda:3')
benign distance is  tensor(183.0837, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4289148263633251
distance x is tensor(143.0807, device='cuda:3')
benign distance is  tensor(143.0807, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5819420963525772
distance x is tensor(162.1036, device='cuda:3')
benign distance is  tensor(162.1036, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8962966352701187
distance x is tensor(152.7673, device='cuda:3')
benign distance is  tensor(152.7673, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8992039486765862
distance x is tensor(140.0203, device='cuda:3')
benign distance is  tensor(140.0203, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8035778775811195
distance x is tensor(138.1676, device='cuda:3')
benign distance is  tensor(138.1676, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4979632832109928
distance x is tensor(191.9308, device='cuda:3')
benign distance is  tensor(191.9308, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.322672352194786
distance x is tensor(154.7677, device='cuda:3')
benign distance is  tensor(154.7677, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.3025597631931305
distance x is tensor(174.6451, device='cuda:3')
benign distance is  tensor(174.6451, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.113058738410473
distance x is tensor(187.4027, device='cuda:3')
benign distance is  tensor(187.4027, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6134586408734322
distance x is tensor(113.6544, device='cuda:3')
benign distance is  tensor(113.6544, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4135013930499554
distance x is tensor(186.1238, device='cuda:3')
benign distance is  tensor(186.1238, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.1257825791835785
distance x is tensor(181.6201, device='cuda:3')
benign distance is  tensor(181.6201, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.13900000016000008
mal_loss is 43.81545948982239
mal_entropy is 0.026318549644201994
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 742.1472,  633.8894,  603.5792,  777.3006,  587.0370,  663.1531,
         641.7845,  591.2430,  446.9413,  446.9413,  446.9413,  446.9413,
         446.9413,  446.9413,  446.9413,  446.9413,  446.9413,  446.9413,
         446.9413,  446.9413,  650.1415,  707.5746,  706.8048,  775.9440,
         681.8922, 1090.4417,  840.5927,  774.9434], device='cuda:3')
sorted_norm is   tensor([ 446.9413,  446.9413,  446.9413,  446.9413,  446.9413,  446.9413,
         446.9413,  446.9413,  446.9413,  446.9413,  446.9413,  446.9413,
         587.0370,  591.2430,  603.5792,  633.8894,  641.7845,  650.1415,
         663.1531,  681.8922,  706.8048,  707.5746,  742.1472,  774.9434,
         775.9440,  777.3006,  840.5927, 1090.4417], device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  4,  7,  2,  1,  6, 20,
         5, 24, 22, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 82.79% 

Test Accuracy: 76.52% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.125119924545288
distance x is tensor(177.9273, device='cuda:3')
benign distance is  tensor(177.9273, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8022938594222069
distance x is tensor(163.8971, device='cuda:3')
benign distance is  tensor(163.8971, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6746307089924812
distance x is tensor(153.3581, device='cuda:3')
benign distance is  tensor(153.3581, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9183210954070091
distance x is tensor(182.1122, device='cuda:3')
benign distance is  tensor(182.1122, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.898752424865961
distance x is tensor(171.8358, device='cuda:3')
benign distance is  tensor(171.8358, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3792856186628342
distance x is tensor(207.8176, device='cuda:3')
benign distance is  tensor(207.8176, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.268573075532913
distance x is tensor(138.5340, device='cuda:3')
benign distance is  tensor(138.5340, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8024802207946777
distance x is tensor(145.3433, device='cuda:3')
benign distance is  tensor(145.3433, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.1582193821668625
distance x is tensor(166.5490, device='cuda:3')
benign distance is  tensor(166.5490, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.521865103393793
distance x is tensor(171.0103, device='cuda:3')
benign distance is  tensor(171.0103, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.0219268277287483
distance x is tensor(164.4393, device='cuda:3')
benign distance is  tensor(164.4393, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7947651520371437
distance x is tensor(189.6307, device='cuda:3')
benign distance is  tensor(189.6307, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9569385275244713
distance x is tensor(166.7952, device='cuda:3')
benign distance is  tensor(166.7952, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3140595518052578
distance x is tensor(221.7586, device='cuda:3')
benign distance is  tensor(221.7586, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.1701148375868797
distance x is tensor(200.7696, device='cuda:3')
benign distance is  tensor(200.7696, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4118336476385593
distance x is tensor(172.6606, device='cuda:3')
benign distance is  tensor(172.6606, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.17800000016000006
mal_loss is 34.06118714809418
mal_entropy is 0.056523835635744035
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([742.2333, 689.3828, 626.5604, 762.0904, 711.8425, 796.8241, 614.5322,
        608.5897, 451.7278, 451.7278, 451.7278, 451.7278, 451.7278, 451.7278,
        451.7278, 451.7278, 451.7278, 451.7278, 451.7278, 451.7278, 841.1922,
        791.0229, 842.5392, 817.3781, 877.3555, 762.7782, 723.5745, 873.7546,
        806.7130, 640.4542, 805.3160, 743.8574, 770.8404, 772.5688, 784.0682,
        863.6871, 608.1279, 799.6134, 673.2422, 765.2324, 807.4576, 522.3849,
        789.6357, 765.9505], device='cuda:3')
sorted_norm is   tensor([451.7278, 451.7278, 451.7278, 451.7278, 451.7278, 451.7278, 451.7278,
        451.7278, 451.7278, 451.7278, 451.7278, 451.7278, 522.3849, 608.1279,
        608.5897, 614.5322, 626.5604, 640.4542, 673.2422, 689.3828, 711.8425,
        723.5745, 742.2333, 743.8574, 762.0904, 762.7782, 765.2324, 765.9505,
        770.8404, 772.5688, 784.0682, 789.6357, 791.0229, 796.8241, 799.6134,
        805.3160, 806.7130, 807.4576, 817.3781, 841.1922, 842.5392, 863.6871,
        873.7546, 877.3555], device='cuda:3')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19, 15, 13,  9, 11, 41, 36,  7,  6,  2, 29,
        38,  1,  4, 26,  0, 31,  3, 25, 39, 43, 32, 33, 34, 42, 21,  5, 37],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 78.96% 

Test Accuracy: 81.31% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.206301897764206
distance x is tensor(167.0579, device='cuda:3')
benign distance is  tensor(167.0579, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1425467282533646
distance x is tensor(123.6401, device='cuda:3')
benign distance is  tensor(123.6401, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9432815909385681
distance x is tensor(128.9578, device='cuda:3')
benign distance is  tensor(128.9578, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.904391273856163
distance x is tensor(174.7737, device='cuda:3')
benign distance is  tensor(174.7737, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.333609089255333
distance x is tensor(140.3679, device='cuda:3')
benign distance is  tensor(140.3679, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.402792401611805
distance x is tensor(131.5182, device='cuda:3')
benign distance is  tensor(131.5182, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0005116686224937
distance x is tensor(153.8851, device='cuda:3')
benign distance is  tensor(153.8851, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8433444052934647
distance x is tensor(133.2171, device='cuda:3')
benign distance is  tensor(133.2171, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.880028374493122
distance x is tensor(131.3804, device='cuda:3')
benign distance is  tensor(131.3804, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3834233079105616
distance x is tensor(155.9863, device='cuda:3')
benign distance is  tensor(155.9863, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8075369969010353
distance x is tensor(97.5849, device='cuda:3')
benign distance is  tensor(97.5849, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.8778586983680725
distance x is tensor(146.9929, device='cuda:3')
benign distance is  tensor(146.9929, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.8999161124229431
distance x is tensor(175.8073, device='cuda:3')
benign distance is  tensor(175.8073, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.62105131149292
distance x is tensor(84.4398, device='cuda:3')
benign distance is  tensor(84.4398, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3851566687226295
distance x is tensor(162.3111, device='cuda:3')
benign distance is  tensor(162.3111, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.830395877361298
distance x is tensor(149.0558, device='cuda:3')
benign distance is  tensor(149.0558, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7355859279632568
distance x is tensor(131.7627, device='cuda:3')
benign distance is  tensor(131.7627, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.4647771380841732
distance x is tensor(114.7360, device='cuda:3')
benign distance is  tensor(114.7360, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.814965806901455
distance x is tensor(144.1591, device='cuda:3')
benign distance is  tensor(144.1591, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.447324588894844
distance x is tensor(132.5710, device='cuda:3')
benign distance is  tensor(132.5710, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6870998293161392
distance x is tensor(149.3543, device='cuda:3')
benign distance is  tensor(149.3543, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8949738442897797
distance x is tensor(150.3342, device='cuda:3')
benign distance is  tensor(150.3342, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9337432868778706
distance x is tensor(151.6723, device='cuda:3')
benign distance is  tensor(151.6723, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.6166165322065353
distance x is tensor(166.7553, device='cuda:3')
benign distance is  tensor(166.7553, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1478390581905842
distance x is tensor(152.7100, device='cuda:3')
benign distance is  tensor(152.7100, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.823389656841755
distance x is tensor(137.5606, device='cuda:3')
benign distance is  tensor(137.5606, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1967506743967533
distance x is tensor(147.8941, device='cuda:3')
benign distance is  tensor(147.8941, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.7373580634593964
distance x is tensor(158.2522, device='cuda:3')
benign distance is  tensor(158.2522, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.1400803551077843
distance x is tensor(161.1699, device='cuda:3')
benign distance is  tensor(161.1699, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.3799099922180176
distance x is tensor(122.9224, device='cuda:3')
benign distance is  tensor(122.9224, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.662852969020605
distance x is tensor(114.2132, device='cuda:3')
benign distance is  tensor(114.2132, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9104233235120773
distance x is tensor(150.5925, device='cuda:3')
benign distance is  tensor(150.5925, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.65200000016
mal_loss is 2.6918491423130035
mal_entropy is 0.24617472011595964
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([713.9401, 536.6149, 547.3370, 741.0065, 593.1659, 549.6738, 676.0299,
        569.4100, 432.8759, 432.8759, 432.8759, 432.8759, 432.8759, 432.8759,
        432.8759, 432.8759, 432.8759, 432.8759, 432.8759, 432.8759],
       device='cuda:3')
sorted_norm is   tensor([432.8759, 432.8759, 432.8759, 432.8759, 432.8759, 432.8759, 432.8759,
        432.8759, 432.8759, 432.8759, 432.8759, 432.8759, 536.6149, 547.3370,
        549.6738, 569.4100, 593.1659, 676.0299, 713.9401, 741.0065],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  1,  2,  5,  7],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 83.90% 

Test Accuracy: 77.71% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2005889751017094
distance x is tensor(171.4143, device='cuda:3')
benign distance is  tensor(171.4143, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.816247507929802
distance x is tensor(139.6861, device='cuda:3')
benign distance is  tensor(139.6861, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9874468222260475
distance x is tensor(143.8947, device='cuda:3')
benign distance is  tensor(143.8947, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9564406052231789
distance x is tensor(186.6613, device='cuda:3')
benign distance is  tensor(186.6613, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.385768510401249
distance x is tensor(156.0112, device='cuda:3')
benign distance is  tensor(156.0112, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4586380161345005
distance x is tensor(151.8710, device='cuda:3')
benign distance is  tensor(151.8710, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8516850396990776
distance x is tensor(165.7604, device='cuda:3')
benign distance is  tensor(165.7604, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6613444164395332
distance x is tensor(131.6202, device='cuda:3')
benign distance is  tensor(131.6202, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.29300000016000005
mal_loss is 20.395238876342773
mal_entropy is 0.11343698343262076
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([734.7581, 588.5576, 595.1589, 775.1317, 643.5576, 621.8454, 690.5731,
        562.2888, 443.3727, 443.3727, 443.3727, 443.3727, 443.3727, 443.3727,
        443.3727, 443.3727, 443.3727, 443.3727, 443.3727, 443.3727, 809.0906,
        892.4152, 944.3339, 723.8808, 950.5806, 872.9547, 833.9943, 871.2962,
        800.7550, 785.9906, 764.2589, 863.2605, 788.7484, 983.1506, 903.1897,
        799.2691, 669.6080, 763.2375, 541.8726, 735.0646, 836.7242, 506.5597,
        789.5760, 749.4287], device='cuda:3')
sorted_norm is   tensor([443.3727, 443.3727, 443.3727, 443.3727, 443.3727, 443.3727, 443.3727,
        443.3727, 443.3727, 443.3727, 443.3727, 443.3727, 506.5597, 541.8726,
        562.2888, 588.5576, 595.1589, 621.8454, 643.5576, 669.6080, 690.5731,
        723.8808, 734.7581, 735.0646, 749.4287, 763.2375, 764.2589, 775.1317,
        785.9906, 788.7484, 789.5760, 799.2691, 800.7550, 809.0906, 833.9943,
        836.7242, 863.2605, 871.2962, 872.9547, 892.4152, 903.1897, 944.3339,
        950.5806, 983.1506], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 41, 38,  7,  1,  2,  5,
         4, 36,  6, 23,  0, 39, 43, 37, 30,  3, 29, 32, 42, 35, 28, 20, 26],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 78.20% 

Test Accuracy: 81.50% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9687614180147648
distance x is tensor(165.2594, device='cuda:3')
benign distance is  tensor(165.2594, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6182073578238487
distance x is tensor(117.3611, device='cuda:3')
benign distance is  tensor(117.3611, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9099892675876617
distance x is tensor(116.4494, device='cuda:3')
benign distance is  tensor(116.4494, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7399344369769096
distance x is tensor(162.1300, device='cuda:3')
benign distance is  tensor(162.1300, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2571428790688515
distance x is tensor(139.3555, device='cuda:3')
benign distance is  tensor(139.3555, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5539420247077942
distance x is tensor(139.6061, device='cuda:3')
benign distance is  tensor(139.6061, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7531557008624077
distance x is tensor(132.7490, device='cuda:3')
benign distance is  tensor(132.7490, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8121999129652977
distance x is tensor(135.4077, device='cuda:3')
benign distance is  tensor(135.4077, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7646839693188667
distance x is tensor(145.4789, device='cuda:3')
benign distance is  tensor(145.4789, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3931771889328957
distance x is tensor(164.2947, device='cuda:3')
benign distance is  tensor(164.2947, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.770408384501934
distance x is tensor(107.2168, device='cuda:3')
benign distance is  tensor(107.2168, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.2540476620197296
distance x is tensor(133.3900, device='cuda:3')
benign distance is  tensor(133.3900, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.891551822423935
distance x is tensor(166.4988, device='cuda:3')
benign distance is  tensor(166.4988, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.435787495225668
distance x is tensor(89.1364, device='cuda:3')
benign distance is  tensor(89.1364, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3233811371028423
distance x is tensor(157.7150, device='cuda:3')
benign distance is  tensor(157.7150, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.8953643664717674
distance x is tensor(150.3123, device='cuda:3')
benign distance is  tensor(150.3123, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.5246099084615707
distance x is tensor(136.0356, device='cuda:3')
benign distance is  tensor(136.0356, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.658242516219616
distance x is tensor(150.1996, device='cuda:3')
benign distance is  tensor(150.1996, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2907633930444717
distance x is tensor(131.1617, device='cuda:3')
benign distance is  tensor(131.1617, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.2765979170799255
distance x is tensor(148.5811, device='cuda:3')
benign distance is  tensor(148.5811, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.929334506392479
distance x is tensor(126.5145, device='cuda:3')
benign distance is  tensor(126.5145, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0635708346962929
distance x is tensor(216.8168, device='cuda:3')
benign distance is  tensor(216.8168, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.86029052734375
distance x is tensor(183.8886, device='cuda:3')
benign distance is  tensor(183.8886, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4331925436854362
distance x is tensor(155.8703, device='cuda:3')
benign distance is  tensor(155.8703, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.595813810825348
distance x is tensor(118.1306, device='cuda:3')
benign distance is  tensor(118.1306, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.5985018759965897
distance x is tensor(161.9670, device='cuda:3')
benign distance is  tensor(161.9670, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.752713367342949
distance x is tensor(176.2677, device='cuda:3')
benign distance is  tensor(176.2677, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.6906569302082062
distance x is tensor(119.4734, device='cuda:3')
benign distance is  tensor(119.4734, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.0499664843082428
distance x is tensor(177.4434, device='cuda:3')
benign distance is  tensor(177.4434, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.2282486483454704
distance x is tensor(150.2120, device='cuda:3')
benign distance is  tensor(150.2120, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.8992858678102493
distance x is tensor(138.2893, device='cuda:3')
benign distance is  tensor(138.2893, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.648203557357192
distance x is tensor(172.2148, device='cuda:3')
benign distance is  tensor(172.2148, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5580000001600001
mal_loss is 5.006475180387497
mal_entropy is 0.21650745440274477
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([720.9901, 512.2639, 490.6701, 696.3409, 572.1469, 569.5710, 555.1386,
        555.0140, 443.9236, 443.9236, 443.9236, 443.9236, 443.9236, 443.9236,
        443.9236, 443.9236, 443.9236, 443.9236, 443.9236, 443.9236],
       device='cuda:3')
sorted_norm is   tensor([443.9236, 443.9236, 443.9236, 443.9236, 443.9236, 443.9236, 443.9236,
        443.9236, 443.9236, 443.9236, 443.9236, 443.9236, 490.6701, 512.2639,
        555.0140, 555.1386, 569.5710, 572.1469, 696.3409, 720.9901],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  2,  1,  7,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 82.71% 

Test Accuracy: 77.53% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2229812443256378
distance x is tensor(180.0743, device='cuda:3')
benign distance is  tensor(180.0743, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8114806413650513
distance x is tensor(153.2993, device='cuda:3')
benign distance is  tensor(153.2993, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8854735419154167
distance x is tensor(144.8102, device='cuda:3')
benign distance is  tensor(144.8102, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.835676796734333
distance x is tensor(187.9312, device='cuda:3')
benign distance is  tensor(187.9312, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4048896580934525
distance x is tensor(171.4088, device='cuda:3')
benign distance is  tensor(171.4088, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4024337269365788
distance x is tensor(172.3380, device='cuda:3')
benign distance is  tensor(172.3380, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.473134882748127
distance x is tensor(169.0093, device='cuda:3')
benign distance is  tensor(169.0093, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6683973483741283
distance x is tensor(139.1211, device='cuda:3')
benign distance is  tensor(139.1211, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2310000001600001
mal_loss is 30.430075526237488
mal_entropy is 0.0697144865989685
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([760.7265, 655.9162, 586.2427, 781.4996, 705.1655, 684.3615, 694.2211,
        590.1275, 446.6730, 446.6730, 446.6730, 446.6730, 446.6730, 446.6730,
        446.6730, 446.6730, 446.6730, 446.6730, 446.6730, 446.6730, 722.2477,
        672.3913, 785.3159, 746.5204, 794.2394, 811.9025, 791.0812, 870.2946,
        712.7815, 786.2314, 591.4044, 694.5697, 792.8704, 521.6521, 767.3074,
        772.5388], device='cuda:3')
sorted_norm is   tensor([446.6730, 446.6730, 446.6730, 446.6730, 446.6730, 446.6730, 446.6730,
        446.6730, 446.6730, 446.6730, 446.6730, 446.6730, 521.6521, 586.2427,
        590.1275, 591.4044, 655.9162, 672.3913, 684.3615, 694.2211, 694.5697,
        705.1655, 712.7815, 722.2477, 746.5204, 760.7265, 767.3074, 772.5388,
        781.4996, 785.3159, 786.2314, 791.0812, 792.8704, 794.2394, 811.9025,
        870.2946], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33,  2,  7, 30,  1, 21,
         5,  6, 31,  4, 28, 20, 23,  0, 34, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 82.72% 

Test Accuracy: 80.72% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0387830920517445
distance x is tensor(163.7910, device='cuda:3')
benign distance is  tensor(163.7910, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.793940082192421
distance x is tensor(152.8953, device='cuda:3')
benign distance is  tensor(152.8953, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.251464307308197
distance x is tensor(132.7025, device='cuda:3')
benign distance is  tensor(132.7025, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8725462332367897
distance x is tensor(180.1344, device='cuda:3')
benign distance is  tensor(180.1344, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.5042618215084076
distance x is tensor(158.3512, device='cuda:3')
benign distance is  tensor(158.3512, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.852222491055727
distance x is tensor(131.3953, device='cuda:3')
benign distance is  tensor(131.3953, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0173110961914062
distance x is tensor(138.4276, device='cuda:3')
benign distance is  tensor(138.4276, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8010131418704987
distance x is tensor(118.4504, device='cuda:3')
benign distance is  tensor(118.4504, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7910283245146275
distance x is tensor(163.3955, device='cuda:3')
benign distance is  tensor(163.3955, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.338326208293438
distance x is tensor(160.9513, device='cuda:3')
benign distance is  tensor(160.9513, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.081872083246708
distance x is tensor(122.3462, device='cuda:3')
benign distance is  tensor(122.3462, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.4317735731601715
distance x is tensor(139.8561, device='cuda:3')
benign distance is  tensor(139.8561, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9210310950875282
distance x is tensor(177.6728, device='cuda:3')
benign distance is  tensor(177.6728, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2940332181751728
distance x is tensor(97.6836, device='cuda:3')
benign distance is  tensor(97.6836, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9165483713150024
distance x is tensor(163.7070, device='cuda:3')
benign distance is  tensor(163.7070, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.093930795788765
distance x is tensor(144.3278, device='cuda:3')
benign distance is  tensor(144.3278, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7592512890696526
distance x is tensor(160.6272, device='cuda:3')
benign distance is  tensor(160.6272, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.484663650393486
distance x is tensor(111.7270, device='cuda:3')
benign distance is  tensor(111.7270, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.189004361629486
distance x is tensor(160.5423, device='cuda:3')
benign distance is  tensor(160.5423, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.0892226472496986
distance x is tensor(144.2820, device='cuda:3')
benign distance is  tensor(144.2820, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6364020369946957
distance x is tensor(153.5663, device='cuda:3')
benign distance is  tensor(153.5663, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5796619541943073
distance x is tensor(162.6196, device='cuda:3')
benign distance is  tensor(162.6196, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7635662332177162
distance x is tensor(159.2881, device='cuda:3')
benign distance is  tensor(159.2881, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.6936838775873184
distance x is tensor(172.1353, device='cuda:3')
benign distance is  tensor(172.1353, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.37700000016000007
mal_loss is 14.325778424739838
mal_entropy is 0.14407428167760372
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([700.7221, 637.0934, 561.7137, 742.0319, 649.8651, 540.4919, 585.0726,
        512.5073, 451.9389, 451.9389, 451.9389, 451.9389, 451.9389, 451.9389,
        451.9389, 451.9389, 451.9389, 451.9389, 451.9389, 451.9389, 783.9012,
        727.6654, 781.6745, 799.2178, 814.1365, 684.3661, 645.7344, 777.6054,
        660.9533, 713.8247, 643.3495, 721.8353, 627.4297, 985.8507, 856.5901,
        727.7472], device='cuda:3')
sorted_norm is   tensor([451.9389, 451.9389, 451.9389, 451.9389, 451.9389, 451.9389, 451.9389,
        451.9389, 451.9389, 451.9389, 451.9389, 451.9389, 512.5073, 540.4919,
        561.7137, 585.0726, 627.4297, 637.0934, 643.3495, 645.7344, 649.8651,
        660.9533, 684.3661, 700.7221, 713.8247, 721.8353, 727.6654, 727.7472,
        742.0319, 777.6054, 781.6745, 783.9012, 799.2178, 814.1365, 856.5901,
        985.8507], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  7,  5,  2,  6, 32,  1,
        30, 26,  4, 28, 25,  0, 29, 31, 21, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 78.47% 

Test Accuracy: 81.23% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.98569162376225
distance x is tensor(169.3698, device='cuda:3')
benign distance is  tensor(169.3698, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0117959678173065
distance x is tensor(138.2177, device='cuda:3')
benign distance is  tensor(138.2177, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.746723547577858
distance x is tensor(140.3790, device='cuda:3')
benign distance is  tensor(140.3790, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0558823123574257
distance x is tensor(171.6289, device='cuda:3')
benign distance is  tensor(171.6289, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1437986195087433
distance x is tensor(152.1396, device='cuda:3')
benign distance is  tensor(152.1396, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4141539204865694
distance x is tensor(144.3253, device='cuda:3')
benign distance is  tensor(144.3253, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.289165534079075
distance x is tensor(140.4952, device='cuda:3')
benign distance is  tensor(140.4952, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.603079117834568
distance x is tensor(151.8497, device='cuda:3')
benign distance is  tensor(151.8497, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.356646291911602
distance x is tensor(144.1276, device='cuda:3')
benign distance is  tensor(144.1276, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.223202347755432
distance x is tensor(145.9394, device='cuda:3')
benign distance is  tensor(145.9394, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.932167924940586
distance x is tensor(143.1317, device='cuda:3')
benign distance is  tensor(143.1317, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3592911064624786
distance x is tensor(157.4668, device='cuda:3')
benign distance is  tensor(157.4668, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.4933009818196297
distance x is tensor(122.8119, device='cuda:3')
benign distance is  tensor(122.8119, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.017168827354908
distance x is tensor(210.7268, device='cuda:3')
benign distance is  tensor(210.7268, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.6159876473248005
distance x is tensor(171.9508, device='cuda:3')
benign distance is  tensor(171.9508, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.340081062167883
distance x is tensor(158.3037, device='cuda:3')
benign distance is  tensor(158.3037, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.277230579406023
distance x is tensor(158.0343, device='cuda:3')
benign distance is  tensor(158.0343, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.8933483585715294
distance x is tensor(139.8224, device='cuda:3')
benign distance is  tensor(139.8224, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1473013535141945
distance x is tensor(154.3459, device='cuda:3')
benign distance is  tensor(154.3459, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.8949146419763565
distance x is tensor(160.7462, device='cuda:3')
benign distance is  tensor(160.7462, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.1724624820053577
distance x is tensor(140.6964, device='cuda:3')
benign distance is  tensor(140.6964, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.4556240402162075
distance x is tensor(125.8318, device='cuda:3')
benign distance is  tensor(125.8318, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.4900839105248451
distance x is tensor(123.6603, device='cuda:3')
benign distance is  tensor(123.6603, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9926553126424551
distance x is tensor(152.6843, device='cuda:3')
benign distance is  tensor(152.6843, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.41200000016000005
mal_loss is 10.250459164381027
mal_entropy is 0.15847670566290617
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([742.9662, 580.4678, 558.6352, 734.2111, 648.7089, 583.1517, 580.5651,
        624.8540, 449.8891, 449.8891, 449.8891, 449.8891, 449.8891, 449.8891,
        449.8891, 449.8891, 449.8891, 449.8891, 449.8891, 449.8891, 703.0010,
        680.1334, 538.8100, 625.2101, 748.4700, 447.3147, 716.6582, 647.6708],
       device='cuda:3')
sorted_norm is   tensor([447.3147, 449.8891, 449.8891, 449.8891, 449.8891, 449.8891, 449.8891,
        449.8891, 449.8891, 449.8891, 449.8891, 449.8891, 449.8891, 538.8100,
        558.6352, 580.4678, 580.5651, 583.1517, 624.8540, 625.2101, 647.6708,
        648.7089, 680.1334, 703.0010, 716.6582, 734.2111, 742.9662, 748.4700],
       device='cuda:3')
used idx is  tensor([25, 18, 16, 17, 19, 12, 14, 15, 11, 10,  8,  9, 13, 22,  2,  1,  6,  5,
         7, 23, 27,  4], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 77.22% 

Test Accuracy: 80.19% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1201398968696594
distance x is tensor(181.1858, device='cuda:3')
benign distance is  tensor(181.1858, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0681759864091873
distance x is tensor(136.9016, device='cuda:3')
benign distance is  tensor(136.9016, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.968045897781849
distance x is tensor(129.2091, device='cuda:3')
benign distance is  tensor(129.2091, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8434082306921482
distance x is tensor(173.1860, device='cuda:3')
benign distance is  tensor(173.1860, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.09416127204895
distance x is tensor(160.9472, device='cuda:3')
benign distance is  tensor(160.9472, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5211787596344948
distance x is tensor(160.4597, device='cuda:3')
benign distance is  tensor(160.4597, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3319184854626656
distance x is tensor(139.9348, device='cuda:3')
benign distance is  tensor(139.9348, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6364677473902702
distance x is tensor(126.1797, device='cuda:3')
benign distance is  tensor(126.1797, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.1631172969937325
distance x is tensor(137.0401, device='cuda:3')
benign distance is  tensor(137.0401, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2473318167030811
distance x is tensor(175.4496, device='cuda:3')
benign distance is  tensor(175.4496, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3946451619267464
distance x is tensor(125.9240, device='cuda:3')
benign distance is  tensor(125.9240, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.1051048040390015
distance x is tensor(151.4965, device='cuda:3')
benign distance is  tensor(151.4965, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9505867585539818
distance x is tensor(235.0497, device='cuda:3')
benign distance is  tensor(235.0497, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2502043806016445
distance x is tensor(92.5838, device='cuda:3')
benign distance is  tensor(92.5838, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.782283939421177
distance x is tensor(184.9947, device='cuda:3')
benign distance is  tensor(184.9947, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.216677576303482
distance x is tensor(148.7429, device='cuda:3')
benign distance is  tensor(148.7429, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.4010000001600001
mal_loss is 11.494277536869049
mal_entropy is 0.1461737637873739
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([778.0139, 584.6804, 532.1252, 741.4862, 676.1639, 628.8236, 575.8813,
        540.5265, 447.5243, 447.5244, 447.5243, 447.5244, 447.5243, 447.5244,
        447.5243, 447.5244, 447.5243, 447.5244, 447.5243, 447.5244],
       device='cuda:3')
sorted_norm is   tensor([447.5243, 447.5243, 447.5243, 447.5243, 447.5243, 447.5243, 447.5244,
        447.5244, 447.5244, 447.5244, 447.5244, 447.5244, 532.1252, 540.5265,
        575.8813, 584.6804, 628.8236, 676.1639, 741.4862, 778.0139],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  2,  7,  6,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 81.27% 

Test Accuracy: 73.27% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2518484219908714
distance x is tensor(198.7405, device='cuda:3')
benign distance is  tensor(198.7405, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.772382877767086
distance x is tensor(209.5571, device='cuda:3')
benign distance is  tensor(209.5571, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.84186489880085
distance x is tensor(146.3982, device='cuda:3')
benign distance is  tensor(146.3982, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.157996326684952
distance x is tensor(217.9310, device='cuda:3')
benign distance is  tensor(217.9310, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.831420876085758
distance x is tensor(198.1087, device='cuda:3')
benign distance is  tensor(198.1087, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5077869333326817
distance x is tensor(170.5915, device='cuda:3')
benign distance is  tensor(170.5915, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.3842547982931137
distance x is tensor(213.8032, device='cuda:3')
benign distance is  tensor(213.8032, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7522657439112663
distance x is tensor(139.9066, device='cuda:3')
benign distance is  tensor(139.9066, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.11900000016
mal_loss is 68.88706755638123
mal_entropy is 0.020683689377619885
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 804.5944,  808.8950,  577.2574,  852.8090,  784.5974,  684.1123,
         816.5422,  569.6357,  456.0907,  456.0907,  456.0907,  456.0907,
         456.0907,  456.0907,  456.0907,  456.0907,  456.0907,  456.0907,
         456.0907,  456.0907,  796.8202,  913.0103,  965.4317,  787.4522,
         974.8589,  889.4922,  841.2999,  964.5400,  812.2770,  671.9615,
         837.6758,  798.6760,  803.5436,  836.1348,  832.0768,  891.2577,
         782.1872,  787.3878,  757.8409,  830.0761,  692.7271, 1030.2141,
         887.7822,  830.1852,  680.1134,  827.4533,  635.0255,  754.7994,
        1062.9895,  521.0777,  854.0961,  737.5460], device='cuda:3')
sorted_norm is   tensor([ 456.0907,  456.0907,  456.0907,  456.0907,  456.0907,  456.0907,
         456.0907,  456.0907,  456.0907,  456.0907,  456.0907,  456.0907,
         521.0777,  569.6357,  577.2574,  635.0255,  671.9615,  680.1134,
         684.1123,  692.7271,  737.5460,  754.7994,  757.8409,  782.1872,
         784.5974,  787.3878,  787.4522,  796.8202,  798.6760,  803.5436,
         804.5944,  808.8950,  812.2770,  816.5422,  827.4533,  830.0761,
         830.1852,  832.0768,  836.1348,  837.6758,  841.2999,  852.8090,
         854.0961,  887.7822,  889.4922,  891.2577,  913.0103,  964.5400,
         965.4317,  974.8589, 1030.2141, 1062.9895], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 49,  7,  2, 46, 29, 44,
         5, 40, 51, 47, 38, 36,  4, 37, 23, 20, 31, 32,  0,  1, 28,  6, 45, 39,
        43, 34, 33, 30, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 73.96% 

Test Accuracy: 80.42% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.4124606996774673
distance x is tensor(156.3411, device='cuda:3')
benign distance is  tensor(156.3411, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5546852983534336
distance x is tensor(123.2025, device='cuda:3')
benign distance is  tensor(123.2025, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5964162349700928
distance x is tensor(122.2268, device='cuda:3')
benign distance is  tensor(122.2268, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9246792122721672
distance x is tensor(163.4129, device='cuda:3')
benign distance is  tensor(163.4129, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9565015956759453
distance x is tensor(140.8790, device='cuda:3')
benign distance is  tensor(140.8790, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6660043131560087
distance x is tensor(143.2551, device='cuda:3')
benign distance is  tensor(143.2551, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.098989225924015
distance x is tensor(123.8152, device='cuda:3')
benign distance is  tensor(123.8152, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6994872242212296
distance x is tensor(104.8193, device='cuda:3')
benign distance is  tensor(104.8193, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.6237142831087112
distance x is tensor(127.8678, device='cuda:3')
benign distance is  tensor(127.8678, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.592025876045227
distance x is tensor(158.7751, device='cuda:3')
benign distance is  tensor(158.7751, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3131167739629745
distance x is tensor(110.9408, device='cuda:3')
benign distance is  tensor(110.9408, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.248918667435646
distance x is tensor(132.1241, device='cuda:3')
benign distance is  tensor(132.1241, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9677718579769135
distance x is tensor(164.7510, device='cuda:3')
benign distance is  tensor(164.7510, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.7217651456594467
distance x is tensor(80.6753, device='cuda:3')
benign distance is  tensor(80.6753, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3509147502481937
distance x is tensor(164.9915, device='cuda:3')
benign distance is  tensor(164.9915, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.091738805174828
distance x is tensor(145.4884, device='cuda:3')
benign distance is  tensor(145.4884, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.2700939401984215
distance x is tensor(142.9542, device='cuda:3')
benign distance is  tensor(142.9542, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.519091621041298
distance x is tensor(136.0685, device='cuda:3')
benign distance is  tensor(136.0685, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8272621780633926
distance x is tensor(155.7802, device='cuda:3')
benign distance is  tensor(155.7802, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.328436329960823
distance x is tensor(152.2624, device='cuda:3')
benign distance is  tensor(152.2624, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.8734462037682533
distance x is tensor(113.9317, device='cuda:3')
benign distance is  tensor(113.9317, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.03666565194726
distance x is tensor(210.1178, device='cuda:3')
benign distance is  tensor(210.1178, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.6562641710042953
distance x is tensor(179.5157, device='cuda:3')
benign distance is  tensor(179.5157, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.496283859014511
distance x is tensor(146.5401, device='cuda:3')
benign distance is  tensor(146.5401, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9756881967186928
distance x is tensor(138.3010, device='cuda:3')
benign distance is  tensor(138.3010, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.4158223383128643
distance x is tensor(108.9121, device='cuda:3')
benign distance is  tensor(108.9121, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.0926916524767876
distance x is tensor(151.5346, device='cuda:3')
benign distance is  tensor(151.5346, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.749628588557243
distance x is tensor(126.3540, device='cuda:3')
benign distance is  tensor(126.3540, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6715495698153973
distance x is tensor(146.9711, device='cuda:3')
benign distance is  tensor(146.9711, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.4467094726860523
distance x is tensor(143.0791, device='cuda:3')
benign distance is  tensor(143.0791, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9559216871857643
distance x is tensor(136.6596, device='cuda:3')
benign distance is  tensor(136.6596, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.0029584914445877
distance x is tensor(170.6516, device='cuda:3')
benign distance is  tensor(170.6516, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.6835794895887375
distance x is tensor(118.0726, device='cuda:3')
benign distance is  tensor(118.0726, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.883193150162697
distance x is tensor(150.7854, device='cuda:3')
benign distance is  tensor(150.7854, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.6120032891631126
distance x is tensor(184.9244, device='cuda:3')
benign distance is  tensor(184.9244, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.9043720439076424
distance x is tensor(113.6020, device='cuda:3')
benign distance is  tensor(113.6020, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.4644888490438461
distance x is tensor(161.6997, device='cuda:3')
benign distance is  tensor(161.6997, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.674574762582779
distance x is tensor(151.2163, device='cuda:3')
benign distance is  tensor(151.2163, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.0052234902977943
distance x is tensor(120.6585, device='cuda:3')
benign distance is  tensor(120.6585, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8146349713206291
distance x is tensor(183.5762, device='cuda:3')
benign distance is  tensor(183.5762, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.69700000016
mal_loss is 2.0903560295701027
mal_entropy is 0.2256507370620966
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([682.3238, 527.4612, 513.7730, 706.6432, 590.6352, 583.2458, 529.9435,
        448.2255, 417.9739, 417.9739, 417.9739, 417.9739, 417.9739, 417.9739,
        417.9739, 417.9739, 417.9739, 417.9739, 417.9739, 417.9739],
       device='cuda:3')
sorted_norm is   tensor([417.9739, 417.9739, 417.9739, 417.9739, 417.9739, 417.9739, 417.9739,
        417.9739, 417.9739, 417.9739, 417.9739, 417.9739, 448.2255, 513.7730,
        527.4612, 529.9435, 583.2458, 590.6352, 682.3238, 706.6432],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  7,  2,  1,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 82.81% 

Test Accuracy: 78.57% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.216010671108961
distance x is tensor(173.8006, device='cuda:3')
benign distance is  tensor(173.8006, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0930477678775787
distance x is tensor(135.6888, device='cuda:3')
benign distance is  tensor(135.6888, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5384370721876621
distance x is tensor(132.7086, device='cuda:3')
benign distance is  tensor(132.7086, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.821070224046707
distance x is tensor(193.5505, device='cuda:3')
benign distance is  tensor(193.5505, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5071621350944042
distance x is tensor(172.0543, device='cuda:3')
benign distance is  tensor(172.0543, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6989903673529625
distance x is tensor(151.9003, device='cuda:3')
benign distance is  tensor(151.9003, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7825904786586761
distance x is tensor(143.6274, device='cuda:3')
benign distance is  tensor(143.6274, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6055621355772018
distance x is tensor(127.0188, device='cuda:3')
benign distance is  tensor(127.0188, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3220000001600001
mal_loss is 20.36271095275879
mal_entropy is 0.11502409353852272
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([747.6876, 580.7268, 547.1523, 808.4019, 690.4916, 628.0477, 604.1501,
        535.0104, 437.7830, 437.7830, 437.7830, 437.7830, 437.7830, 437.7830,
        437.7830, 437.7830, 437.7830, 437.7830, 437.7830, 437.7830, 833.5515,
        758.5633, 822.9811, 834.2454, 767.7464, 700.4148, 686.8206, 792.0409,
        645.8039, 771.8053, 595.1713, 672.8718, 789.1127, 475.7545, 775.2086,
        725.6866], device='cuda:3')
sorted_norm is   tensor([437.7830, 437.7830, 437.7830, 437.7830, 437.7830, 437.7830, 437.7830,
        437.7830, 437.7830, 437.7830, 437.7830, 437.7830, 475.7545, 535.0104,
        547.1523, 580.7268, 595.1713, 604.1501, 628.0477, 645.8039, 672.8718,
        686.8206, 690.4916, 700.4148, 725.6866, 747.6876, 758.5633, 767.7464,
        771.8053, 775.2086, 789.1127, 792.0409, 808.4019, 822.9811, 833.5515,
        834.2454], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 33,  7,  2,  1, 30,  6,
         5, 28, 31, 26,  4, 25, 35,  0, 21, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 82.05% 

Test Accuracy: 80.91% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 82.05%
|----0th round Training Accuracy : 96.30%
|----1th round Training Accuracy : 95.84%
|----2th round Training Accuracy : 94.81%
|----3th round Training Accuracy : 94.62%
|----4th round Training Accuracy : 93.82%
|----5th round Training Accuracy : 94.67%
|----6th round Training Accuracy : 91.47%
|----7th round Training Accuracy : 93.00%
|----8th round Training Accuracy : 91.97%
|----9th round Training Accuracy : 92.99%
|----10th round Training Accuracy : 89.60%
|----11th round Training Accuracy : 92.44%
|----12th round Training Accuracy : 90.69%
|----13th round Training Accuracy : 89.89%
|----14th round Training Accuracy : 91.37%
|----15th round Training Accuracy : 91.20%
|----16th round Training Accuracy : 84.06%
|----17th round Training Accuracy : 89.98%
|----18th round Training Accuracy : 85.46%
|----19th round Training Accuracy : 89.56%
|----20th round Training Accuracy : 88.60%
|----21th round Training Accuracy : 88.04%
|----22th round Training Accuracy : 82.31%
|----23th round Training Accuracy : 88.37%
|----24th round Training Accuracy : 89.07%
|----25th round Training Accuracy : 88.06%
|----26th round Training Accuracy : 86.52%
|----27th round Training Accuracy : 87.84%
|----28th round Training Accuracy : 86.95%
|----29th round Training Accuracy : 85.77%
|----30th round Training Accuracy : 89.74%
|----31th round Training Accuracy : 89.01%
|----32th round Training Accuracy : 87.64%
|----33th round Training Accuracy : 84.24%
|----34th round Training Accuracy : 86.06%
|----35th round Training Accuracy : 81.58%
|----36th round Training Accuracy : 86.55%
|----37th round Training Accuracy : 84.35%
|----38th round Training Accuracy : 82.79%
|----39th round Training Accuracy : 78.96%
|----40th round Training Accuracy : 83.90%
|----41th round Training Accuracy : 78.20%
|----42th round Training Accuracy : 82.71%
|----43th round Training Accuracy : 82.72%
|----44th round Training Accuracy : 78.47%
|----45th round Training Accuracy : 77.22%
|----46th round Training Accuracy : 81.27%
|----47th round Training Accuracy : 73.96%
|----48th round Training Accuracy : 82.81%
|----49th round Training Accuracy : 82.05%
|----Final Test Accuracy: 80.91%
|----0th round Final Test Accuracy : 87.27%
|----1th round Final Test Accuracy : 85.42%
|----2th round Final Test Accuracy : 82.36%
|----3th round Final Test Accuracy : 82.95%
|----4th round Final Test Accuracy : 77.70%
|----5th round Final Test Accuracy : 85.04%
|----6th round Final Test Accuracy : 57.79%
|----7th round Final Test Accuracy : 76.69%
|----8th round Final Test Accuracy : 68.98%
|----9th round Final Test Accuracy : 80.28%
|----10th round Final Test Accuracy : 45.91%
|----11th round Final Test Accuracy : 83.44%
|----12th round Final Test Accuracy : 68.41%
|----13th round Final Test Accuracy : 67.41%
|----14th round Final Test Accuracy : 79.63%
|----15th round Final Test Accuracy : 80.95%
|----16th round Final Test Accuracy : 48.89%
|----17th round Final Test Accuracy : 81.45%
|----18th round Final Test Accuracy : 58.98%
|----19th round Final Test Accuracy : 81.27%
|----20th round Final Test Accuracy : 77.22%
|----21th round Final Test Accuracy : 74.52%
|----22th round Final Test Accuracy : 48.11%
|----23th round Final Test Accuracy : 83.34%
|----24th round Final Test Accuracy : 81.58%
|----25th round Final Test Accuracy : 79.23%
|----26th round Final Test Accuracy : 77.58%
|----27th round Final Test Accuracy : 80.88%
|----28th round Final Test Accuracy : 65.00%
|----29th round Final Test Accuracy : 83.62%
|----30th round Final Test Accuracy : 79.34%
|----31th round Final Test Accuracy : 82.77%
|----32th round Final Test Accuracy : 80.29%
|----33th round Final Test Accuracy : 76.38%
|----34th round Final Test Accuracy : 77.82%
|----35th round Final Test Accuracy : 83.00%
|----36th round Final Test Accuracy : 78.61%
|----37th round Final Test Accuracy : 77.04%
|----38th round Final Test Accuracy : 76.52%
|----39th round Final Test Accuracy : 81.31%
|----40th round Final Test Accuracy : 77.71%
|----41th round Final Test Accuracy : 81.50%
|----42th round Final Test Accuracy : 77.53%
|----43th round Final Test Accuracy : 80.72%
|----44th round Final Test Accuracy : 81.23%
|----45th round Final Test Accuracy : 80.19%
|----46th round Final Test Accuracy : 73.27%
|----47th round Final Test Accuracy : 80.42%
|----48th round Final Test Accuracy : 78.57%
|----49th round Final Test Accuracy : 80.91%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3801.3164
