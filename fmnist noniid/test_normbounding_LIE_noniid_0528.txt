
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.980799674987793
distance x is tensor(170.9153, device='cuda:3')
benign distance is  tensor(170.9153, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.519722454249859
distance x is tensor(117.8978, device='cuda:3')
benign distance is  tensor(117.8978, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.1414166539907455
distance x is tensor(101.5879, device='cuda:3')
benign distance is  tensor(101.5879, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0761785954236984
distance x is tensor(173.0827, device='cuda:3')
benign distance is  tensor(173.0827, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.6340379640460014
distance x is tensor(129.7260, device='cuda:3')
benign distance is  tensor(129.7260, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.691758632659912
distance x is tensor(121.1881, device='cuda:3')
benign distance is  tensor(121.1881, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2308136746287346
distance x is tensor(137.0703, device='cuda:3')
benign distance is  tensor(137.0703, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.5276285260915756
distance x is tensor(114.2003, device='cuda:3')
benign distance is  tensor(114.2003, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.864917680621147
distance x is tensor(125.3397, device='cuda:3')
benign distance is  tensor(125.3397, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9458552077412605
distance x is tensor(143.5281, device='cuda:3')
benign distance is  tensor(143.5281, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8847809582948685
distance x is tensor(123.2892, device='cuda:3')
benign distance is  tensor(123.2892, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.8340340852737427
distance x is tensor(137.9916, device='cuda:3')
benign distance is  tensor(137.9916, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2076906636357307
distance x is tensor(165.1667, device='cuda:3')
benign distance is  tensor(165.1667, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9116883054375648
distance x is tensor(109.4067, device='cuda:3')
benign distance is  tensor(109.4067, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6013256013393402
distance x is tensor(157.8755, device='cuda:3')
benign distance is  tensor(157.8755, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.471110925078392
distance x is tensor(140.3930, device='cuda:3')
benign distance is  tensor(140.3930, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.470970094203949
distance x is tensor(131.6833, device='cuda:3')
benign distance is  tensor(131.6833, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1795047521591187
distance x is tensor(137.7096, device='cuda:3')
benign distance is  tensor(137.7096, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5584131479263306
distance x is tensor(135.9912, device='cuda:3')
benign distance is  tensor(135.9912, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.435691051185131
distance x is tensor(153.6360, device='cuda:3')
benign distance is  tensor(153.6360, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.60066806524992
distance x is tensor(138.8170, device='cuda:3')
benign distance is  tensor(138.8170, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.765004925429821
distance x is tensor(233.8659, device='cuda:3')
benign distance is  tensor(233.8659, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.1970487907528877
distance x is tensor(185.0801, device='cuda:3')
benign distance is  tensor(185.0801, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.149289846420288
distance x is tensor(147.4900, device='cuda:3')
benign distance is  tensor(147.4900, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.2554091438651085
distance x is tensor(153.4655, device='cuda:3')
benign distance is  tensor(153.4655, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.0729901641607285
distance x is tensor(96.1685, device='cuda:3')
benign distance is  tensor(96.1685, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.211707442998886
distance x is tensor(151.5824, device='cuda:3')
benign distance is  tensor(151.5824, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  5.1187717616558075
distance x is tensor(130.6155, device='cuda:3')
benign distance is  tensor(130.6155, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.7617062032222748
distance x is tensor(139.0921, device='cuda:3')
benign distance is  tensor(139.0921, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.196480266749859
distance x is tensor(143.5256, device='cuda:3')
benign distance is  tensor(143.5256, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9269331023097038
distance x is tensor(141.2721, device='cuda:3')
benign distance is  tensor(141.2721, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.649615302681923
distance x is tensor(168.7121, device='cuda:3')
benign distance is  tensor(168.7121, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1453365795314312
distance x is tensor(149.6129, device='cuda:3')
benign distance is  tensor(149.6129, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  3.591473802924156
distance x is tensor(145.1562, device='cuda:3')
benign distance is  tensor(145.1562, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.2732791006565094
distance x is tensor(140.5081, device='cuda:3')
benign distance is  tensor(140.5081, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  5.033507794141769
distance x is tensor(135.6508, device='cuda:3')
benign distance is  tensor(135.6508, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.563288502395153
distance x is tensor(150.8149, device='cuda:3')
benign distance is  tensor(150.8149, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9237299337983131
distance x is tensor(129.1600, device='cuda:3')
benign distance is  tensor(129.1600, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.015454575419426
distance x is tensor(110.8182, device='cuda:3')
benign distance is  tensor(110.8182, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.3508544005453587
distance x is tensor(139.4423, device='cuda:3')
benign distance is  tensor(139.4423, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.718503966927528
distance x is tensor(118.7750, device='cuda:3')
benign distance is  tensor(118.7750, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  4.179775252938271
distance x is tensor(160.8068, device='cuda:3')
benign distance is  tensor(160.8068, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.689687803387642
distance x is tensor(182.7873, device='cuda:3')
benign distance is  tensor(182.7873, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.451286569237709
distance x is tensor(98.7485, device='cuda:3')
benign distance is  tensor(98.7485, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.4233227521181107
distance x is tensor(158.0267, device='cuda:3')
benign distance is  tensor(158.0267, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.2900617122650146
distance x is tensor(137.3604, device='cuda:3')
benign distance is  tensor(137.3604, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  5.171113476157188
distance x is tensor(129.4010, device='cuda:3')
benign distance is  tensor(129.4010, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8035166375339031
distance x is tensor(155.8839, device='cuda:3')
benign distance is  tensor(155.8839, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.70800000016
mal_loss is 0.8165323138237
mal_entropy is 0.6627061478793621
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([741.1854, 517.1289, 461.7292, 748.8433, 579.3660, 547.9774, 616.4093,
        530.6984, 704.2108, 704.2107, 704.2108, 704.2107, 704.2108, 704.2107,
        704.2108, 704.2107, 704.2108, 704.2107, 704.2108, 704.2107],
       device='cuda:3')
sorted_norm is   tensor([461.7292, 517.1289, 530.6984, 547.9774, 579.3660, 616.4093, 704.2107,
        704.2107, 704.2107, 704.2107, 704.2107, 704.2107, 704.2108, 704.2108,
        704.2108, 704.2108, 704.2108, 704.2108, 741.1854, 748.8433],
       device='cuda:3')
used idx is  tensor([ 2,  1,  7,  5,  4,  6, 19, 17, 13, 15, 11,  9,  8, 10, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 70.51% 

Test Accuracy: 74.54% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9468482248485088
distance x is tensor(144.9822, device='cuda:3')
benign distance is  tensor(144.9822, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7417005077004433
distance x is tensor(100.6205, device='cuda:3')
benign distance is  tensor(100.6205, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.455051951110363
distance x is tensor(94.1408, device='cuda:3')
benign distance is  tensor(94.1408, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.12498939037323
distance x is tensor(146.9243, device='cuda:3')
benign distance is  tensor(146.9243, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6656895950436592
distance x is tensor(102.4757, device='cuda:3')
benign distance is  tensor(102.4757, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3284608572721481
distance x is tensor(106.7123, device='cuda:3')
benign distance is  tensor(106.7123, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0978375151753426
distance x is tensor(101.3072, device='cuda:3')
benign distance is  tensor(101.3072, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.65243761241436
distance x is tensor(88.9299, device='cuda:3')
benign distance is  tensor(88.9299, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.59200000016
mal_loss is 1.6748699471354485
mal_entropy is 0.46662510745227337
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([631.6425, 450.1065, 428.5864, 622.3116, 462.2755, 466.6281, 446.3695,
        403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 403.3246,
        403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 605.4141,
        679.6660, 637.2159, 696.4460, 754.5188, 563.9340, 712.1938, 703.4756],
       device='cuda:3')
sorted_norm is   tensor([403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 403.3246,
        403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 403.3246, 428.5864,
        446.3695, 450.1065, 462.2755, 466.6281, 563.9340, 605.4141, 622.3116,
        631.6425, 637.2159, 679.6660, 696.4460, 703.4756, 712.1938, 754.5188],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14,  7, 11, 10,  8,  9, 15,  2,  6,  1,  4,  5,
        25, 20,  3,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 21.49% 

Test Accuracy: 64.06% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8776034489274025
distance x is tensor(135.0389, device='cuda:3')
benign distance is  tensor(135.0389, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.869452878832817
distance x is tensor(104.7945, device='cuda:3')
benign distance is  tensor(104.7945, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5798728838562965
distance x is tensor(92.5147, device='cuda:3')
benign distance is  tensor(92.5147, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.485947959125042
distance x is tensor(146.5956, device='cuda:3')
benign distance is  tensor(146.5956, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.551466315984726
distance x is tensor(101.9182, device='cuda:3')
benign distance is  tensor(101.9182, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3165084198117256
distance x is tensor(109.1328, device='cuda:3')
benign distance is  tensor(109.1328, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9275136291980743
distance x is tensor(102.3959, device='cuda:3')
benign distance is  tensor(102.3959, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.874810479581356
distance x is tensor(81.5232, device='cuda:3')
benign distance is  tensor(81.5232, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.0703093856573105
distance x is tensor(96.0589, device='cuda:3')
benign distance is  tensor(96.0589, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.377254992723465
distance x is tensor(126.4240, device='cuda:3')
benign distance is  tensor(126.4240, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.327642671763897
distance x is tensor(82.7442, device='cuda:3')
benign distance is  tensor(82.7442, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.3128719329833984
distance x is tensor(101.1761, device='cuda:3')
benign distance is  tensor(101.1761, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2021562606096268
distance x is tensor(146.5326, device='cuda:3')
benign distance is  tensor(146.5326, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2950425893068314
distance x is tensor(74.1970, device='cuda:3')
benign distance is  tensor(74.1970, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.550584003329277
distance x is tensor(137.0685, device='cuda:3')
benign distance is  tensor(137.0685, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.523952916264534
distance x is tensor(118.4196, device='cuda:3')
benign distance is  tensor(118.4196, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.50400000016
mal_loss is 3.481010749936104
mal_entropy is 0.2635199949145317
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([580.5175, 449.6611, 416.2192, 606.9846, 433.3707, 467.9171, 433.4949,
        359.0895, 504.6335, 504.6335, 504.6335, 504.6335, 504.6335, 504.6335,
        504.6335, 504.6335, 504.6335, 504.6335, 504.6335, 504.6335, 727.5181,
        704.1645, 700.7905, 743.6984, 698.9333, 972.8721, 823.2911, 764.8405],
       device='cuda:3')
sorted_norm is   tensor([359.0895, 416.2192, 433.3707, 433.4949, 449.6611, 467.9171, 504.6335,
        504.6335, 504.6335, 504.6335, 504.6335, 504.6335, 504.6335, 504.6335,
        504.6335, 504.6335, 504.6335, 504.6335, 580.5175, 606.9846, 698.9333,
        700.7905, 704.1645, 727.5181, 743.6984, 764.8405, 823.2911, 972.8721],
       device='cuda:3')
used idx is  tensor([ 7,  2,  4,  6,  1,  5, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,
         0,  3, 24, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 8.92% 

Test Accuracy: 57.55% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9096389263868332
distance x is tensor(127.5792, device='cuda:3')
benign distance is  tensor(127.5792, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1350394561886787
distance x is tensor(103.8210, device='cuda:3')
benign distance is  tensor(103.8210, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.7577799037098885
distance x is tensor(92.5966, device='cuda:3')
benign distance is  tensor(92.5966, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2983445450663567
distance x is tensor(132.8538, device='cuda:3')
benign distance is  tensor(132.8538, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.760882057249546
distance x is tensor(99.6929, device='cuda:3')
benign distance is  tensor(99.6929, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3915384784340858
distance x is tensor(102.7488, device='cuda:3')
benign distance is  tensor(102.7488, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2360279113054276
distance x is tensor(93.6224, device='cuda:3')
benign distance is  tensor(93.6224, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6514312848448753
distance x is tensor(86.1198, device='cuda:3')
benign distance is  tensor(86.1198, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.8468828350305557
distance x is tensor(87.9348, device='cuda:3')
benign distance is  tensor(87.9348, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.7366220206022263
distance x is tensor(100.9928, device='cuda:3')
benign distance is  tensor(100.9928, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.0049705281853676
distance x is tensor(115.2329, device='cuda:3')
benign distance is  tensor(115.2329, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.714455246925354
distance x is tensor(120.5646, device='cuda:3')
benign distance is  tensor(120.5646, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.4471282064914703
distance x is tensor(83.5190, device='cuda:3')
benign distance is  tensor(83.5190, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5257284045219421
distance x is tensor(195.8838, device='cuda:3')
benign distance is  tensor(195.8838, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.340093620121479
distance x is tensor(138.7447, device='cuda:3')
benign distance is  tensor(138.7447, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6644094958901405
distance x is tensor(117.1095, device='cuda:3')
benign distance is  tensor(117.1095, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.6830000001600001
mal_loss is 1.6532602310180664
mal_entropy is 0.35407774802297354
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([552.3380, 444.4976, 410.4200, 549.8967, 430.8364, 426.3927, 396.9155,
        363.9259, 504.8848, 504.8848, 504.8848, 504.8848, 504.8848, 504.8848,
        504.8848, 504.8848, 504.8848, 504.8848, 504.8848, 504.8848, 829.9056,
        725.5624, 815.3469, 797.9584, 791.9177, 826.7795, 799.9905, 859.0089,
        485.2156, 574.2712, 428.3646, 467.3177, 641.3145, 419.2281, 607.7423,
        231.0524], device='cuda:3')
sorted_norm is   tensor([231.0524, 363.9259, 396.9155, 410.4200, 419.2281, 426.3927, 428.3646,
        430.8364, 444.4976, 467.3177, 485.2156, 504.8848, 504.8848, 504.8848,
        504.8848, 504.8848, 504.8848, 504.8848, 504.8848, 504.8848, 504.8848,
        504.8848, 504.8848, 549.8967, 552.3380, 574.2712, 607.7423, 641.3145,
        725.5624, 791.9177, 797.9584, 799.9905, 815.3469, 826.7795, 829.9056,
        859.0089], device='cuda:3')
used idx is  tensor([35,  7,  6,  2, 33,  5, 30,  4,  1, 31, 28, 19, 18, 15, 14, 17,  8, 13,
        11, 10, 16, 12,  9,  3,  0, 29, 34, 32], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 48.25% 

Test Accuracy: 74.47% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.003414411097765
distance x is tensor(125.1087, device='cuda:3')
benign distance is  tensor(125.1087, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6221893653273582
distance x is tensor(101.5366, device='cuda:3')
benign distance is  tensor(101.5366, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4960099682211876
distance x is tensor(96.2443, device='cuda:3')
benign distance is  tensor(96.2443, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5323947370052338
distance x is tensor(128.5203, device='cuda:3')
benign distance is  tensor(128.5203, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7005829960107803
distance x is tensor(100.6070, device='cuda:3')
benign distance is  tensor(100.6070, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4121630862355232
distance x is tensor(102.4032, device='cuda:3')
benign distance is  tensor(102.4032, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9452914968132973
distance x is tensor(94.5988, device='cuda:3')
benign distance is  tensor(94.5988, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7356648445129395
distance x is tensor(86.5358, device='cuda:3')
benign distance is  tensor(86.5358, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7484266832470894
distance x is tensor(89.6302, device='cuda:3')
benign distance is  tensor(89.6302, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.989749513566494
distance x is tensor(118.5668, device='cuda:3')
benign distance is  tensor(118.5668, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.9526017159223557
distance x is tensor(78.3631, device='cuda:3')
benign distance is  tensor(78.3631, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5020440220832825
distance x is tensor(99.3361, device='cuda:3')
benign distance is  tensor(99.3361, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2795968130230904
distance x is tensor(150.7712, device='cuda:3')
benign distance is  tensor(150.7712, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2656966373324394
distance x is tensor(61.9268, device='cuda:3')
benign distance is  tensor(61.9268, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.733549527823925
distance x is tensor(129.3687, device='cuda:3')
benign distance is  tensor(129.3687, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.5080369114875793
distance x is tensor(104.4337, device='cuda:3')
benign distance is  tensor(104.4337, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5417462550103664
distance x is tensor(105.0185, device='cuda:3')
benign distance is  tensor(105.0185, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.4552959725260735
distance x is tensor(154.9626, device='cuda:3')
benign distance is  tensor(154.9626, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.786488562822342
distance x is tensor(112.7984, device='cuda:3')
benign distance is  tensor(112.7984, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.7993472069501877
distance x is tensor(100.1617, device='cuda:3')
benign distance is  tensor(100.1617, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5587917789816856
distance x is tensor(114.4836, device='cuda:3')
benign distance is  tensor(114.4836, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5841059163212776
distance x is tensor(108.5341, device='cuda:3')
benign distance is  tensor(108.5341, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5829997826367617
distance x is tensor(103.5213, device='cuda:3')
benign distance is  tensor(103.5213, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.7344376519322395
distance x is tensor(141.1211, device='cuda:3')
benign distance is  tensor(141.1211, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.59600000016
mal_loss is 1.6961216479539871
mal_entropy is 0.47213550098240376
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([539.7956, 431.7607, 416.8307, 536.9755, 430.0816, 431.9094, 401.3705,
        377.2900, 595.3612, 595.3612, 595.3612, 595.3612, 595.3612, 595.3612,
        595.3612, 595.3612, 595.3612, 595.3612, 595.3612, 595.3612, 894.6660,
        856.7719, 863.1837, 862.8837, 869.3773, 838.9805, 817.7272, 878.3369],
       device='cuda:3')
sorted_norm is   tensor([377.2900, 401.3705, 416.8307, 430.0816, 431.7607, 431.9094, 536.9755,
        539.7956, 595.3612, 595.3612, 595.3612, 595.3612, 595.3612, 595.3612,
        595.3612, 595.3612, 595.3612, 595.3612, 595.3612, 595.3612, 817.7272,
        838.9805, 856.7719, 862.8837, 863.1837, 869.3773, 878.3369, 894.6660],
       device='cuda:3')
used idx is  tensor([ 7,  6,  2,  4,  1,  5,  3,  0, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 26, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 37.00% 

Test Accuracy: 71.97% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7364971563220024
distance x is tensor(125.5515, device='cuda:3')
benign distance is  tensor(125.5515, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.157251924276352
distance x is tensor(107.4053, device='cuda:3')
benign distance is  tensor(107.4053, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3933652117848396
distance x is tensor(95.4667, device='cuda:3')
benign distance is  tensor(95.4667, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.1025344878435135
distance x is tensor(132.8069, device='cuda:3')
benign distance is  tensor(132.8069, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5295725464820862
distance x is tensor(90.9819, device='cuda:3')
benign distance is  tensor(90.9819, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6682458966970444
distance x is tensor(103.6074, device='cuda:3')
benign distance is  tensor(103.6074, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8148717507719994
distance x is tensor(95.6421, device='cuda:3')
benign distance is  tensor(95.6421, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2581681087613106
distance x is tensor(84.4931, device='cuda:3')
benign distance is  tensor(84.4931, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.890740929171443
distance x is tensor(119.0071, device='cuda:3')
benign distance is  tensor(119.0071, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.573435701429844
distance x is tensor(94.9158, device='cuda:3')
benign distance is  tensor(94.9158, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.1520504876971245
distance x is tensor(124.1215, device='cuda:3')
benign distance is  tensor(124.1215, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.8476600348949432
distance x is tensor(108.7280, device='cuda:3')
benign distance is  tensor(108.7280, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8182044159621
distance x is tensor(110.8842, device='cuda:3')
benign distance is  tensor(110.8842, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.5947637595236301
distance x is tensor(88.3025, device='cuda:3')
benign distance is  tensor(88.3025, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.990902416408062
distance x is tensor(85.4450, device='cuda:3')
benign distance is  tensor(85.4450, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.735799403861165
distance x is tensor(114.7719, device='cuda:3')
benign distance is  tensor(114.7719, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.75200000016
mal_loss is 0.7649837248027325
mal_entropy is 0.3326681312173605
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([534.0495, 451.7690, 403.5196, 549.9349, 385.4144, 427.9026, 395.4324,
        355.7749, 504.1755, 504.1755, 504.1755, 504.1755, 504.1755, 504.1755,
        504.1755, 504.1755, 504.1755, 504.1755, 504.1755, 504.1755, 943.8652,
        971.0728, 980.6285, 891.2172, 919.9910, 914.1370, 919.6098, 670.0418,
        538.1561, 554.7165, 581.7559, 589.6862, 517.1929, 820.6232, 651.4604,
        462.6114, 498.9553, 573.7548, 457.2942, 525.0522, 698.3653, 421.8030,
        614.9916, 543.6320], device='cuda:3')
sorted_norm is   tensor([355.7749, 385.4144, 395.4324, 403.5196, 421.8030, 427.9026, 451.7690,
        457.2942, 462.6114, 498.9553, 504.1755, 504.1755, 504.1755, 504.1755,
        504.1755, 504.1755, 504.1755, 504.1755, 504.1755, 504.1755, 504.1755,
        504.1755, 517.1929, 525.0522, 534.0495, 538.1561, 543.6320, 549.9349,
        554.7165, 573.7548, 581.7559, 589.6862, 614.9916, 651.4604, 670.0418,
        698.3653, 820.6232, 891.2172, 914.1370, 919.6098, 919.9910, 943.8652,
        971.0728, 980.6285], device='cuda:3')
used idx is  tensor([ 7,  4,  6,  2, 41,  5,  1, 38, 35, 36, 14, 15, 19, 18, 16, 17, 13, 12,
        11, 10,  8,  9, 32, 39,  0, 28, 43,  3, 29, 37, 30, 31, 42, 34, 27],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 61.47% 

Test Accuracy: 78.63% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7320442795753479
distance x is tensor(118.0718, device='cuda:3')
benign distance is  tensor(118.0718, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.636570516973734
distance x is tensor(102.2005, device='cuda:3')
benign distance is  tensor(102.2005, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1484037153422832
distance x is tensor(100.4225, device='cuda:3')
benign distance is  tensor(100.4225, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4833691716194153
distance x is tensor(132.3032, device='cuda:3')
benign distance is  tensor(132.3032, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2480548620224
distance x is tensor(89.5136, device='cuda:3')
benign distance is  tensor(89.5136, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0432255640625954
distance x is tensor(101.8947, device='cuda:3')
benign distance is  tensor(101.8947, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7904308065772057
distance x is tensor(91.6161, device='cuda:3')
benign distance is  tensor(91.6161, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1903034001588821
distance x is tensor(87.4206, device='cuda:3')
benign distance is  tensor(87.4206, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3506924360990524
distance x is tensor(86.6566, device='cuda:3')
benign distance is  tensor(86.6566, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.373746383935213
distance x is tensor(112.4215, device='cuda:3')
benign distance is  tensor(112.4215, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5101429894566536
distance x is tensor(67.8769, device='cuda:3')
benign distance is  tensor(67.8769, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.2571928203105927
distance x is tensor(105.7666, device='cuda:3')
benign distance is  tensor(105.7666, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6968680918216705
distance x is tensor(138.2864, device='cuda:3')
benign distance is  tensor(138.2864, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9244891591370106
distance x is tensor(60.5761, device='cuda:3')
benign distance is  tensor(60.5761, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0387299805879593
distance x is tensor(129.0796, device='cuda:3')
benign distance is  tensor(129.0796, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.675680547952652
distance x is tensor(108.9229, device='cuda:3')
benign distance is  tensor(108.9229, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.9481022134423256
distance x is tensor(99.5361, device='cuda:3')
benign distance is  tensor(99.5361, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.172790750861168
distance x is tensor(100.2393, device='cuda:3')
benign distance is  tensor(100.2393, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.5835905149579048
distance x is tensor(107.3546, device='cuda:3')
benign distance is  tensor(107.3546, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.996649257838726
distance x is tensor(114.4370, device='cuda:3')
benign distance is  tensor(114.4370, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3035615608096123
distance x is tensor(79.3487, device='cuda:3')
benign distance is  tensor(79.3487, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.143925927579403
distance x is tensor(189.9205, device='cuda:3')
benign distance is  tensor(189.9205, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2912612855434418
distance x is tensor(132.1989, device='cuda:3')
benign distance is  tensor(132.1989, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.5813506320118904
distance x is tensor(102.6036, device='cuda:3')
benign distance is  tensor(102.6036, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.7012061476707458
distance x is tensor(89.4251, device='cuda:3')
benign distance is  tensor(89.4251, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.890741504728794
distance x is tensor(113.9387, device='cuda:3')
benign distance is  tensor(113.9387, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.3854161314666271
distance x is tensor(124.8109, device='cuda:3')
benign distance is  tensor(124.8109, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.4479125291109085
distance x is tensor(82.7827, device='cuda:3')
benign distance is  tensor(82.7827, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.9242926053702831
distance x is tensor(138.5908, device='cuda:3')
benign distance is  tensor(138.5908, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.3303968906402588
distance x is tensor(121.7319, device='cuda:3')
benign distance is  tensor(121.7319, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1531696654856205
distance x is tensor(94.3292, device='cuda:3')
benign distance is  tensor(94.3292, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6811653589829803
distance x is tensor(116.1557, device='cuda:3')
benign distance is  tensor(116.1557, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.79000000016
mal_loss is 0.7019998198375106
mal_entropy is 0.36535681411623955
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([500.9812, 431.9043, 424.0593, 547.7813, 374.4136, 424.6460, 389.8779,
        367.9225, 488.0336, 488.0336, 488.0336, 488.0336, 488.0336, 488.0336,
        488.0336, 488.0336, 488.0336, 488.0336, 488.0336, 488.0336],
       device='cuda:3')
sorted_norm is   tensor([367.9225, 374.4136, 389.8779, 424.0593, 424.6460, 431.9043, 488.0336,
        488.0336, 488.0336, 488.0336, 488.0336, 488.0336, 488.0336, 488.0336,
        488.0336, 488.0336, 488.0336, 488.0336, 500.9812, 547.7813],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  2,  5,  1, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 85.53% 

Test Accuracy: 83.33% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.890746284276247
distance x is tensor(132.3620, device='cuda:3')
benign distance is  tensor(132.3620, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2621207237243652
distance x is tensor(102.5559, device='cuda:3')
benign distance is  tensor(102.5559, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8524689450860023
distance x is tensor(102.4659, device='cuda:3')
benign distance is  tensor(102.4659, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.035670906305313
distance x is tensor(142.7255, device='cuda:3')
benign distance is  tensor(142.7255, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0353546310216188
distance x is tensor(100.8602, device='cuda:3')
benign distance is  tensor(100.8602, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7744044363498688
distance x is tensor(103.9221, device='cuda:3')
benign distance is  tensor(103.9221, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9123319685459137
distance x is tensor(93.4504, device='cuda:3')
benign distance is  tensor(93.4504, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8893453404307365
distance x is tensor(97.7935, device='cuda:3')
benign distance is  tensor(97.7935, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.71500000016
mal_loss is 0.9305875413119793
mal_entropy is 0.42049705795943737
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([554.6371, 430.2928, 427.9834, 587.7297, 429.0192, 430.2611, 394.9852,
        412.0923, 412.0923, 412.0923, 412.0923, 412.0923, 412.0923, 412.0923,
        412.0923, 412.0923, 412.0923, 412.0923, 412.0923, 412.0923, 585.7271,
        764.1423, 607.9180, 593.8828, 595.3585, 612.1063, 578.5305, 549.6161,
        473.5391, 554.1595, 421.4380, 539.4050, 628.2389, 400.8516, 592.1564,
        544.5726], device='cuda:3')
sorted_norm is   tensor([394.9852, 400.8516, 412.0923, 412.0923, 412.0923, 412.0923, 412.0923,
        412.0923, 412.0923, 412.0923, 412.0923, 412.0923, 412.0923, 412.0923,
        412.0923, 421.4380, 427.9834, 429.0192, 430.2611, 430.2928, 473.5391,
        539.4050, 544.5726, 549.6161, 554.1595, 554.6371, 578.5305, 585.7271,
        587.7297, 592.1564, 593.8828, 595.3585, 607.9180, 612.1063, 628.2389,
        764.1423], device='cuda:3')
used idx is  tensor([ 6, 33, 13, 19, 15,  9, 11, 17,  7, 14,  8, 10, 16, 12, 18, 30,  2,  4,
         5,  1, 28, 31, 35, 27, 29,  0, 26, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 77.93% 

Test Accuracy: 82.90% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7574507333338261
distance x is tensor(118.2185, device='cuda:3')
benign distance is  tensor(118.2185, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3189209401607513
distance x is tensor(110.6406, device='cuda:3')
benign distance is  tensor(110.6406, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0073252394795418
distance x is tensor(98.8975, device='cuda:3')
benign distance is  tensor(98.8975, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2938409820199013
distance x is tensor(134.6368, device='cuda:3')
benign distance is  tensor(134.6368, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1097086165100336
distance x is tensor(93.9910, device='cuda:3')
benign distance is  tensor(93.9910, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.990529976785183
distance x is tensor(101.8557, device='cuda:3')
benign distance is  tensor(101.8557, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.576627105474472
distance x is tensor(94.7826, device='cuda:3')
benign distance is  tensor(94.7826, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.202010877430439
distance x is tensor(78.8395, device='cuda:3')
benign distance is  tensor(78.8395, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.447828222066164
distance x is tensor(97.1343, device='cuda:3')
benign distance is  tensor(97.1343, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9900374133139849
distance x is tensor(117.4857, device='cuda:3')
benign distance is  tensor(117.4857, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.117102038115263
distance x is tensor(71.7429, device='cuda:3')
benign distance is  tensor(71.7429, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7917181923985481
distance x is tensor(106.9414, device='cuda:3')
benign distance is  tensor(106.9414, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.8983421921730042
distance x is tensor(147.6229, device='cuda:3')
benign distance is  tensor(147.6229, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0058238711208105
distance x is tensor(64.6426, device='cuda:3')
benign distance is  tensor(64.6426, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.095708467066288
distance x is tensor(132.3093, device='cuda:3')
benign distance is  tensor(132.3093, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.961734600365162
distance x is tensor(107.4637, device='cuda:3')
benign distance is  tensor(107.4637, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5081613548099995
distance x is tensor(110.8729, device='cuda:3')
benign distance is  tensor(110.8729, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9178217090666294
distance x is tensor(88.7060, device='cuda:3')
benign distance is  tensor(88.7060, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2084964588284492
distance x is tensor(119.0700, device='cuda:3')
benign distance is  tensor(119.0700, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.175645098090172
distance x is tensor(101.3692, device='cuda:3')
benign distance is  tensor(101.3692, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0058296732604504
distance x is tensor(107.4386, device='cuda:3')
benign distance is  tensor(107.4386, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.1562395729124546
distance x is tensor(106.8633, device='cuda:3')
benign distance is  tensor(106.8633, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5837226323783398
distance x is tensor(109.9048, device='cuda:3')
benign distance is  tensor(109.9048, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3653227090835571
distance x is tensor(154.7955, device='cuda:3')
benign distance is  tensor(154.7955, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.61200000016
mal_loss is 1.3808498159050941
mal_entropy is 0.4772012382745743
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([506.7392, 457.1176, 425.7080, 556.6144, 395.6492, 429.7168, 396.9355,
        340.7652, 636.4501, 636.4501, 636.4501, 636.4501, 636.4501, 636.4501,
        636.4501, 636.4501, 636.4501, 636.4501, 636.4501, 636.4501, 497.9427,
        491.5875, 495.5648, 540.3949, 424.4901, 790.0925, 601.5461, 502.0666],
       device='cuda:3')
sorted_norm is   tensor([340.7652, 395.6492, 396.9355, 424.4901, 425.7080, 429.7168, 457.1176,
        491.5875, 495.5648, 497.9427, 502.0666, 506.7392, 540.3949, 556.6144,
        601.5461, 636.4501, 636.4501, 636.4501, 636.4501, 636.4501, 636.4501,
        636.4501, 636.4501, 636.4501, 636.4501, 636.4501, 636.4501, 790.0925],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6, 24,  2,  5,  1, 21, 22, 20, 27,  0, 23,  3, 26, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 68.06% 

Test Accuracy: 81.30% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7704958897083998
distance x is tensor(126.9195, device='cuda:3')
benign distance is  tensor(126.9195, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2508615218102932
distance x is tensor(104.4551, device='cuda:3')
benign distance is  tensor(104.4551, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.088455580174923
distance x is tensor(98.9542, device='cuda:3')
benign distance is  tensor(98.9542, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4313492178916931
distance x is tensor(133.2943, device='cuda:3')
benign distance is  tensor(133.2943, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6735929436981678
distance x is tensor(88.2184, device='cuda:3')
benign distance is  tensor(88.2184, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1905165202915668
distance x is tensor(99.0864, device='cuda:3')
benign distance is  tensor(99.0864, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1463502794504166
distance x is tensor(92.5957, device='cuda:3')
benign distance is  tensor(92.5957, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2365016154944897
distance x is tensor(83.9126, device='cuda:3')
benign distance is  tensor(83.9126, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.10862947255373
distance x is tensor(95.9246, device='cuda:3')
benign distance is  tensor(95.9246, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1360074020922184
distance x is tensor(104.6721, device='cuda:3')
benign distance is  tensor(104.6721, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4799997732043266
distance x is tensor(106.4467, device='cuda:3')
benign distance is  tensor(106.4467, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2320573143661022
distance x is tensor(107.0806, device='cuda:3')
benign distance is  tensor(107.0806, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.4514115676283836
distance x is tensor(82.7161, device='cuda:3')
benign distance is  tensor(82.7161, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0459643229842186
distance x is tensor(196.7292, device='cuda:3')
benign distance is  tensor(196.7292, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.289132222533226
distance x is tensor(140.0896, device='cuda:3')
benign distance is  tensor(140.0896, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.186788372695446
distance x is tensor(105.3228, device='cuda:3')
benign distance is  tensor(105.3228, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.70700000016
mal_loss is 1.2364564314484596
mal_entropy is 0.304122993722558
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([537.9464, 434.5019, 424.2720, 551.3436, 379.9229, 416.3188, 385.9171,
        349.8563, 447.6258, 447.6258, 447.6258, 447.6258, 447.6258, 447.6258,
        447.6258, 447.6258, 447.6258, 447.6258, 447.6258, 447.6258, 589.2247,
        524.8323, 607.5209, 564.5754, 556.1525, 509.1359, 501.7402, 473.2885,
        456.8806, 528.0837, 370.2300, 509.2235, 636.0574, 363.2932, 578.4158,
        502.1044], device='cuda:3')
sorted_norm is   tensor([349.8563, 363.2932, 370.2300, 379.9229, 385.9171, 416.3188, 424.2720,
        434.5019, 447.6258, 447.6258, 447.6258, 447.6258, 447.6258, 447.6258,
        447.6258, 447.6258, 447.6258, 447.6258, 447.6258, 447.6258, 456.8806,
        473.2885, 501.7402, 502.1044, 509.1359, 509.2235, 524.8323, 528.0837,
        537.9464, 551.3436, 556.1525, 564.5754, 578.4158, 589.2247, 607.5209,
        636.0574], device='cuda:3')
used idx is  tensor([ 7, 33, 30,  4,  6,  5,  2,  1, 14, 15, 16, 17, 19, 12,  8, 18, 13, 10,
        11,  9, 28, 27, 26, 35, 25, 31, 21, 29], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 55.17% 

Test Accuracy: 78.16% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6710122581571341
distance x is tensor(125.5820, device='cuda:3')
benign distance is  tensor(125.5820, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0775660835206509
distance x is tensor(107.4863, device='cuda:3')
benign distance is  tensor(107.4863, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0229621082544327
distance x is tensor(101.0047, device='cuda:3')
benign distance is  tensor(101.0047, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4202012531459332
distance x is tensor(136.9808, device='cuda:3')
benign distance is  tensor(136.9808, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.460324041545391
distance x is tensor(91.6972, device='cuda:3')
benign distance is  tensor(91.6972, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0487194638699293
distance x is tensor(107.4544, device='cuda:3')
benign distance is  tensor(107.4544, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.649072177708149
distance x is tensor(87.6026, device='cuda:3')
benign distance is  tensor(87.6026, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3864888399839401
distance x is tensor(87.5181, device='cuda:3')
benign distance is  tensor(87.5181, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.622324950993061
distance x is tensor(100.5248, device='cuda:3')
benign distance is  tensor(100.5248, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2425692155957222
distance x is tensor(117.1127, device='cuda:3')
benign distance is  tensor(117.1127, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5744228959083557
distance x is tensor(76.9328, device='cuda:3')
benign distance is  tensor(76.9328, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.7355499118566513
distance x is tensor(102.3396, device='cuda:3')
benign distance is  tensor(102.3396, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6190728545188904
distance x is tensor(148.8324, device='cuda:3')
benign distance is  tensor(148.8324, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9764606803655624
distance x is tensor(66.0251, device='cuda:3')
benign distance is  tensor(66.0251, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.192623808979988
distance x is tensor(124.8897, device='cuda:3')
benign distance is  tensor(124.8897, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.173764504492283
distance x is tensor(112.6725, device='cuda:3')
benign distance is  tensor(112.6725, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8384671900421381
distance x is tensor(117.1549, device='cuda:3')
benign distance is  tensor(117.1549, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.5393940173089504
distance x is tensor(102.9271, device='cuda:3')
benign distance is  tensor(102.9271, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.2813888415694237
distance x is tensor(136.9207, device='cuda:3')
benign distance is  tensor(136.9207, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.340159550309181
distance x is tensor(110.2604, device='cuda:3')
benign distance is  tensor(110.2604, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9581308178603649
distance x is tensor(112.5929, device='cuda:3')
benign distance is  tensor(112.5929, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.524092759937048
distance x is tensor(84.3399, device='cuda:3')
benign distance is  tensor(84.3399, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.4389265328645706
distance x is tensor(87.4378, device='cuda:3')
benign distance is  tensor(87.4378, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7256301250308752
distance x is tensor(120.0497, device='cuda:3')
benign distance is  tensor(120.0497, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.78900000016
mal_loss is 0.7160525806248188
mal_entropy is 0.31747679598629475
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([525.9047, 452.2319, 428.4758, 561.8176, 379.6234, 442.0449, 365.6968,
        362.5554, 512.4116, 512.4116, 512.4116, 512.4116, 512.4116, 512.4116,
        512.4116, 512.4116, 512.4116, 512.4116, 512.4116, 512.4116],
       device='cuda:3')
sorted_norm is   tensor([362.5554, 365.6968, 379.6234, 428.4758, 442.0449, 452.2319, 512.4116,
        512.4116, 512.4116, 512.4116, 512.4116, 512.4116, 512.4116, 512.4116,
        512.4116, 512.4116, 512.4116, 512.4116, 525.9047, 561.8176],
       device='cuda:3')
used idx is  tensor([ 7,  6,  4,  2,  5,  1, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 92.25% 

Test Accuracy: 84.45% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6433850545436144
distance x is tensor(133.2985, device='cuda:3')
benign distance is  tensor(133.2985, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2419352307915688
distance x is tensor(107.0801, device='cuda:3')
benign distance is  tensor(107.0801, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8228597100824118
distance x is tensor(107.9002, device='cuda:3')
benign distance is  tensor(107.9002, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2413498535752296
distance x is tensor(143.7574, device='cuda:3')
benign distance is  tensor(143.7574, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9342457912862301
distance x is tensor(102.8092, device='cuda:3')
benign distance is  tensor(102.8092, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8159032464027405
distance x is tensor(101.5193, device='cuda:3')
benign distance is  tensor(101.5193, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3562546595931053
distance x is tensor(99.3213, device='cuda:3')
benign distance is  tensor(99.3213, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3384566456079483
distance x is tensor(96.9219, device='cuda:3')
benign distance is  tensor(96.9219, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.70900000016
mal_loss is 1.3545436076819897
mal_entropy is 0.25377229414880276
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([559.9965, 449.6550, 451.2425, 601.8450, 422.6656, 415.2334, 412.3390,
        411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 411.8708,
        411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 592.6084,
        667.3932, 667.3621, 569.4401, 709.9391, 653.2625, 603.4351, 563.8881,
        604.3530, 556.9308, 626.0636, 599.8568, 589.9850, 601.1668, 609.3671,
        636.1347, 561.7322, 573.1415, 565.2902, 582.5953, 494.0710, 862.4482,
        673.3809, 436.5281, 509.9866, 570.6210, 457.7795, 540.7639, 673.0136,
        421.9625, 595.7397, 575.9741], device='cuda:3')
sorted_norm is   tensor([411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 411.8708,
        411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 411.8708, 412.3390,
        415.2334, 421.9625, 422.6656, 436.5281, 449.6550, 451.2425, 457.7795,
        494.0710, 509.9866, 540.7639, 556.9308, 559.9965, 561.7322, 563.8881,
        565.2902, 569.4401, 570.6210, 573.1415, 575.9741, 582.5953, 589.9850,
        592.6084, 595.7397, 599.8568, 601.1668, 601.8450, 603.4351, 604.3530,
        609.3671, 626.0636, 636.1347, 653.2625, 667.3621, 667.3932, 673.0136,
        673.3809, 709.9391, 862.4482], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  6,  5, 49,  4, 43,
         1,  2, 46, 40, 44, 47, 29,  0, 36, 27, 38, 23, 45, 37, 51, 39, 32, 20,
        50, 31, 33,  3, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 66.88% 

Test Accuracy: 81.61% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8694125115871429
distance x is tensor(119.7718, device='cuda:3')
benign distance is  tensor(119.7718, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.407336287200451
distance x is tensor(105.0520, device='cuda:3')
benign distance is  tensor(105.0520, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2718553431332111
distance x is tensor(102.9250, device='cuda:3')
benign distance is  tensor(102.9250, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3025666140019894
distance x is tensor(138.7819, device='cuda:3')
benign distance is  tensor(138.7819, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.138172959908843
distance x is tensor(100.9858, device='cuda:3')
benign distance is  tensor(100.9858, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1206082683056593
distance x is tensor(103.5032, device='cuda:3')
benign distance is  tensor(103.5032, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.855112224817276
distance x is tensor(95.5058, device='cuda:3')
benign distance is  tensor(95.5058, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.174939602613449
distance x is tensor(70.7869, device='cuda:3')
benign distance is  tensor(70.7869, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1510250233113766
distance x is tensor(97.3390, device='cuda:3')
benign distance is  tensor(97.3390, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9127029404044151
distance x is tensor(116.7930, device='cuda:3')
benign distance is  tensor(116.7930, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.486540399491787
distance x is tensor(72.7671, device='cuda:3')
benign distance is  tensor(72.7671, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6259757950901985
distance x is tensor(104.9508, device='cuda:3')
benign distance is  tensor(104.9508, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5955669805407524
distance x is tensor(151.2915, device='cuda:3')
benign distance is  tensor(151.2915, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.127043940126896
distance x is tensor(58.8801, device='cuda:3')
benign distance is  tensor(58.8801, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0640753619372845
distance x is tensor(125.6382, device='cuda:3')
benign distance is  tensor(125.6382, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.215036518871784
distance x is tensor(109.6699, device='cuda:3')
benign distance is  tensor(109.6699, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.0621547624468803
distance x is tensor(89.5190, device='cuda:3')
benign distance is  tensor(89.5190, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2441559694707394
distance x is tensor(103.9710, device='cuda:3')
benign distance is  tensor(103.9710, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1848959513008595
distance x is tensor(107.4670, device='cuda:3')
benign distance is  tensor(107.4670, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4331551939249039
distance x is tensor(113.4970, device='cuda:3')
benign distance is  tensor(113.4970, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3211607076227665
distance x is tensor(81.1456, device='cuda:3')
benign distance is  tensor(81.1456, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0341794788837433
distance x is tensor(196.4937, device='cuda:3')
benign distance is  tensor(196.4937, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.046751294285059
distance x is tensor(136.6300, device='cuda:3')
benign distance is  tensor(136.6300, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.135649360716343
distance x is tensor(100.8380, device='cuda:3')
benign distance is  tensor(100.8380, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.444101970642805
distance x is tensor(110.5090, device='cuda:3')
benign distance is  tensor(110.5090, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.04244639351964
distance x is tensor(81.4642, device='cuda:3')
benign distance is  tensor(81.4642, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2848867774009705
distance x is tensor(115.4370, device='cuda:3')
benign distance is  tensor(115.4370, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.309441201388836
distance x is tensor(109.7435, device='cuda:3')
benign distance is  tensor(109.7435, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9956127181649208
distance x is tensor(111.1691, device='cuda:3')
benign distance is  tensor(111.1691, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.3216529376804829
distance x is tensor(101.3693, device='cuda:3')
benign distance is  tensor(101.3693, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6065427772700787
distance x is tensor(109.5297, device='cuda:3')
benign distance is  tensor(109.5297, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.7173039987683296
distance x is tensor(163.0525, device='cuda:3')
benign distance is  tensor(163.0525, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.001730002462864
distance x is tensor(101.3433, device='cuda:3')
benign distance is  tensor(101.3433, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.1077770367264748
distance x is tensor(130.5210, device='cuda:3')
benign distance is  tensor(130.5210, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.4718358851969242
distance x is tensor(126.8153, device='cuda:3')
benign distance is  tensor(126.8153, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.5134367533028126
distance x is tensor(87.8741, device='cuda:3')
benign distance is  tensor(87.8741, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8955496400594711
distance x is tensor(144.8670, device='cuda:3')
benign distance is  tensor(144.8670, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1224795170128345
distance x is tensor(130.7516, device='cuda:3')
benign distance is  tensor(130.7516, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.4334648810327053
distance x is tensor(100.6913, device='cuda:3')
benign distance is  tensor(100.6913, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6277157831937075
distance x is tensor(127.0116, device='cuda:3')
benign distance is  tensor(127.0116, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.81300000016
mal_loss is 0.637053269892931
mal_entropy is 0.2442214898765087
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([511.6613, 444.6253, 438.5467, 570.2679, 416.0545, 429.5285, 399.7254,
        304.8412, 522.4656, 522.4656, 522.4656, 522.4656, 522.4656, 522.4656,
        522.4656, 522.4656, 522.4656, 522.4656, 522.4656, 522.4656],
       device='cuda:3')
sorted_norm is   tensor([304.8412, 399.7254, 416.0545, 429.5285, 438.5467, 444.6253, 511.6613,
        522.4656, 522.4656, 522.4656, 522.4656, 522.4656, 522.4656, 522.4656,
        522.4656, 522.4656, 522.4656, 522.4656, 522.4656, 570.2679],
       device='cuda:3')
used idx is  tensor([ 7,  6,  4,  5,  2,  1,  0, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.52% 

Test Accuracy: 86.01% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9907568693161011
distance x is tensor(123.3851, device='cuda:3')
benign distance is  tensor(123.3851, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.304035123437643
distance x is tensor(106.6203, device='cuda:3')
benign distance is  tensor(106.6203, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8471578098833561
distance x is tensor(116.5426, device='cuda:3')
benign distance is  tensor(116.5426, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.13315012678504
distance x is tensor(141.6419, device='cuda:3')
benign distance is  tensor(141.6419, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.097554164007306
distance x is tensor(95.5212, device='cuda:3')
benign distance is  tensor(95.5212, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9286184031516314
distance x is tensor(103.0733, device='cuda:3')
benign distance is  tensor(103.0733, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6367992460727692
distance x is tensor(98.1095, device='cuda:3')
benign distance is  tensor(98.1095, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8460215944796801
distance x is tensor(92.3546, device='cuda:3')
benign distance is  tensor(92.3546, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.78500000016
mal_loss is 0.8662447240203619
mal_entropy is 0.22479309514164925
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([514.3834, 442.1963, 487.1105, 587.9009, 396.0321, 429.1805, 408.8908,
        384.7109, 384.7108, 384.7109, 384.7108, 384.7109, 384.7108, 384.7109,
        384.7108, 384.7109, 384.7108, 384.7109, 384.7108, 384.7109, 495.9492,
        563.4946, 429.2367, 537.2477, 689.3237, 393.9417, 586.1829, 551.0942],
       device='cuda:3')
sorted_norm is   tensor([384.7108, 384.7108, 384.7108, 384.7108, 384.7108, 384.7108, 384.7109,
        384.7109, 384.7109, 384.7109, 384.7109, 384.7109, 384.7109, 393.9417,
        396.0321, 408.8908, 429.1805, 429.2367, 442.1963, 487.1105, 495.9492,
        514.3834, 537.2477, 551.0942, 563.4946, 586.1829, 587.9009, 689.3237],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  7, 25,  4,  6,  5, 22,
         1,  2, 20,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 81.50% 

Test Accuracy: 84.58% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8913150802254677
distance x is tensor(127.7805, device='cuda:3')
benign distance is  tensor(127.7805, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5779118612408638
distance x is tensor(114.5039, device='cuda:3')
benign distance is  tensor(114.5039, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9545110650360584
distance x is tensor(113.3155, device='cuda:3')
benign distance is  tensor(113.3155, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4033983461558819
distance x is tensor(145.9567, device='cuda:3')
benign distance is  tensor(145.9567, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2791316621005535
distance x is tensor(104.7670, device='cuda:3')
benign distance is  tensor(104.7670, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8451833035796881
distance x is tensor(109.7234, device='cuda:3')
benign distance is  tensor(109.7234, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3095694612711668
distance x is tensor(105.7661, device='cuda:3')
benign distance is  tensor(105.7661, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3982045836746693
distance x is tensor(65.1484, device='cuda:3')
benign distance is  tensor(65.1484, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3000077977776527
distance x is tensor(102.1481, device='cuda:3')
benign distance is  tensor(102.1481, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8555235601961613
distance x is tensor(122.4206, device='cuda:3')
benign distance is  tensor(122.4206, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.072371294721961
distance x is tensor(83.8923, device='cuda:3')
benign distance is  tensor(83.8923, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.2450469732284546
distance x is tensor(118.4875, device='cuda:3')
benign distance is  tensor(118.4875, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1054522544145584
distance x is tensor(169.0696, device='cuda:3')
benign distance is  tensor(169.0696, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9814938940107822
distance x is tensor(72.8760, device='cuda:3')
benign distance is  tensor(72.8760, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0288381557911634
distance x is tensor(132.8609, device='cuda:3')
benign distance is  tensor(132.8609, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.4376812875270844
distance x is tensor(126.7098, device='cuda:3')
benign distance is  tensor(126.7098, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.63800000016
mal_loss is 2.4109488278627396
mal_entropy is 0.20574113773182034
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([528.9604, 475.9868, 480.5516, 600.5786, 431.8841, 453.8702, 439.5218,
        275.8355, 531.4503, 531.4503, 531.4503, 531.4503, 531.4503, 531.4503,
        531.4503, 531.4503, 531.4503, 531.4503, 531.4503, 531.4503, 639.6241,
        586.8312, 689.7743, 611.4659, 600.7849, 547.4164, 550.9079, 541.9547,
        503.9326, 552.9554, 540.2294, 576.9323, 464.7811, 861.0456, 642.9635,
        537.0605], device='cuda:3')
sorted_norm is   tensor([275.8355, 431.8841, 439.5218, 453.8702, 464.7811, 475.9868, 480.5516,
        503.9326, 528.9604, 531.4503, 531.4503, 531.4503, 531.4503, 531.4503,
        531.4503, 531.4503, 531.4503, 531.4503, 531.4503, 531.4503, 531.4503,
        537.0605, 540.2294, 541.9547, 547.4164, 550.9079, 552.9554, 576.9323,
        586.8312, 600.5786, 600.7849, 611.4659, 639.6241, 642.9635, 689.7743,
        861.0456], device='cuda:3')
used idx is  tensor([ 7,  4,  6,  5, 32,  1,  2, 28,  0, 15, 16, 18, 19, 12, 14, 17, 13, 11,
         8, 10,  9, 35, 30, 27, 25, 26, 29, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 74.77% 

Test Accuracy: 81.16% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9634154923260212
distance x is tensor(124.0348, device='cuda:3')
benign distance is  tensor(124.0348, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2554812394082546
distance x is tensor(106.5875, device='cuda:3')
benign distance is  tensor(106.5875, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.847096398472786
distance x is tensor(110.0610, device='cuda:3')
benign distance is  tensor(110.0610, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2236652486026287
distance x is tensor(140.4021, device='cuda:3')
benign distance is  tensor(140.4021, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7798039242625237
distance x is tensor(89.0234, device='cuda:3')
benign distance is  tensor(89.0234, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2320764884352684
distance x is tensor(109.6624, device='cuda:3')
benign distance is  tensor(109.6624, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2372803427278996
distance x is tensor(90.3991, device='cuda:3')
benign distance is  tensor(90.3991, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0033141933381557
distance x is tensor(81.3844, device='cuda:3')
benign distance is  tensor(81.3844, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.456738967448473
distance x is tensor(93.0047, device='cuda:3')
benign distance is  tensor(93.0047, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3664208687841892
distance x is tensor(111.1346, device='cuda:3')
benign distance is  tensor(111.1346, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3270363546907902
distance x is tensor(113.7224, device='cuda:3')
benign distance is  tensor(113.7224, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4171643741428852
distance x is tensor(119.4669, device='cuda:3')
benign distance is  tensor(119.4669, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.4302278980612755
distance x is tensor(76.6821, device='cuda:3')
benign distance is  tensor(76.6821, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8816312588751316
distance x is tensor(203.0170, device='cuda:3')
benign distance is  tensor(203.0170, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2440316826105118
distance x is tensor(140.2116, device='cuda:3')
benign distance is  tensor(140.2116, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9712195508182049
distance x is tensor(104.4767, device='cuda:3')
benign distance is  tensor(104.4767, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0003355741500854
distance x is tensor(118.4950, device='cuda:3')
benign distance is  tensor(118.4950, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.2473964989185333
distance x is tensor(98.5746, device='cuda:3')
benign distance is  tensor(98.5746, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.0127708204090595
distance x is tensor(143.2853, device='cuda:3')
benign distance is  tensor(143.2853, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.0034378096461296
distance x is tensor(114.4420, device='cuda:3')
benign distance is  tensor(114.4420, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.885452875867486
distance x is tensor(115.4273, device='cuda:3')
benign distance is  tensor(115.4273, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0666944980621338
distance x is tensor(87.4965, device='cuda:3')
benign distance is  tensor(87.4965, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.1699738502502441
distance x is tensor(92.0278, device='cuda:3')
benign distance is  tensor(92.0278, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8814077656716108
distance x is tensor(111.3034, device='cuda:3')
benign distance is  tensor(111.3034, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.79400000016
mal_loss is 0.8543673362582922
mal_entropy is 0.2011729208752513
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([515.5500, 445.8556, 473.5109, 582.9692, 374.8105, 455.8526, 380.9117,
        342.7787, 463.1886, 463.1886, 463.1886, 463.1886, 463.1886, 463.1886,
        463.1886, 463.1886, 463.1886, 463.1886, 463.1886, 463.1886, 539.0719,
        469.3087, 569.2244, 564.5115, 556.8392, 531.8870, 545.6292, 728.5728,
        490.8394, 554.9858, 425.8109, 537.3162, 743.6376, 403.8145, 591.4141,
        321.8122], device='cuda:3')
sorted_norm is   tensor([321.8122, 342.7787, 374.8105, 380.9117, 403.8145, 425.8109, 445.8556,
        455.8526, 463.1886, 463.1886, 463.1886, 463.1886, 463.1886, 463.1886,
        463.1886, 463.1886, 463.1886, 463.1886, 463.1886, 463.1886, 469.3087,
        473.5109, 490.8394, 515.5500, 531.8870, 537.3162, 539.0719, 545.6292,
        554.9858, 556.8392, 564.5115, 569.2244, 582.9692, 591.4141, 728.5728,
        743.6376], device='cuda:3')
used idx is  tensor([35,  7,  4,  6, 33, 30,  1,  5, 14, 12, 15, 17, 19, 10, 16, 18, 13, 11,
         8,  9, 21,  2, 28,  0, 25, 31, 20, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.86% 

Test Accuracy: 86.39% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7797857839614153
distance x is tensor(113.4757, device='cuda:3')
benign distance is  tensor(113.4757, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2059629410505295
distance x is tensor(103.2338, device='cuda:3')
benign distance is  tensor(103.2338, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.779825322329998
distance x is tensor(114.5916, device='cuda:3')
benign distance is  tensor(114.5916, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0769567303359509
distance x is tensor(146.6113, device='cuda:3')
benign distance is  tensor(146.6113, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.213459262624383
distance x is tensor(96.0980, device='cuda:3')
benign distance is  tensor(96.0980, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7232420677319169
distance x is tensor(104.1087, device='cuda:3')
benign distance is  tensor(104.1087, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.23464535176754
distance x is tensor(97.3413, device='cuda:3')
benign distance is  tensor(97.3413, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9604789018630981
distance x is tensor(78.3519, device='cuda:3')
benign distance is  tensor(78.3519, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9446415640413761
distance x is tensor(103.3732, device='cuda:3')
benign distance is  tensor(103.3732, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9972901232540607
distance x is tensor(132.1114, device='cuda:3')
benign distance is  tensor(132.1114, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3022821210324764
distance x is tensor(83.9218, device='cuda:3')
benign distance is  tensor(83.9218, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3254740983247757
distance x is tensor(109.2910, device='cuda:3')
benign distance is  tensor(109.2910, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1083071306347847
distance x is tensor(156.5176, device='cuda:3')
benign distance is  tensor(156.5176, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7504917755723
distance x is tensor(62.6824, device='cuda:3')
benign distance is  tensor(62.6824, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0440115667879581
distance x is tensor(133.2817, device='cuda:3')
benign distance is  tensor(133.2817, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.254066213965416
distance x is tensor(110.2940, device='cuda:3')
benign distance is  tensor(110.2940, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.3818022161722183
distance x is tensor(117.3986, device='cuda:3')
benign distance is  tensor(117.3986, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2219905108213425
distance x is tensor(78.4821, device='cuda:3')
benign distance is  tensor(78.4821, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3386472798883915
distance x is tensor(123.9014, device='cuda:3')
benign distance is  tensor(123.9014, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.5255502611398697
distance x is tensor(116.9410, device='cuda:3')
benign distance is  tensor(116.9410, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9857805352658033
distance x is tensor(126.6962, device='cuda:3')
benign distance is  tensor(126.6962, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0139915850013494
distance x is tensor(111.6438, device='cuda:3')
benign distance is  tensor(111.6438, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5305529665201902
distance x is tensor(112.5631, device='cuda:3')
benign distance is  tensor(112.5631, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9816878326237202
distance x is tensor(168.3640, device='cuda:3')
benign distance is  tensor(168.3640, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.69800000016
mal_loss is 0.9876502715051174
mal_entropy is 0.44845154508948326
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([480.7968, 431.6432, 485.2025, 595.9916, 395.8255, 433.1810, 403.5370,
        323.8075, 691.4799, 691.4799, 691.4799, 691.4799, 691.4799, 691.4799,
        691.4799, 691.4799, 691.4799, 691.4799, 691.4799, 691.4799],
       device='cuda:3')
sorted_norm is   tensor([323.8075, 395.8255, 403.5370, 431.6432, 433.1810, 480.7968, 485.2025,
        595.9916, 691.4799, 691.4799, 691.4799, 691.4799, 691.4799, 691.4799,
        691.4799, 691.4799, 691.4799, 691.4799, 691.4799, 691.4799],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  1,  5,  0,  2,  3, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 84.35% 

Test Accuracy: 84.89% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8673114143311977
distance x is tensor(140.3848, device='cuda:3')
benign distance is  tensor(140.3848, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.156219769269228
distance x is tensor(106.1364, device='cuda:3')
benign distance is  tensor(106.1364, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1131506226956844
distance x is tensor(112.0504, device='cuda:3')
benign distance is  tensor(112.0504, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.857295885682106
distance x is tensor(152.3736, device='cuda:3')
benign distance is  tensor(152.3736, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.095384931191802
distance x is tensor(103.8213, device='cuda:3')
benign distance is  tensor(103.8213, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.721119656227529
distance x is tensor(109.5257, device='cuda:3')
benign distance is  tensor(109.5257, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6184099987149239
distance x is tensor(95.2254, device='cuda:3')
benign distance is  tensor(95.2254, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1751855313777924
distance x is tensor(81.3865, device='cuda:3')
benign distance is  tensor(81.3865, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.69400000016
mal_loss is 1.1912657096982002
mal_entropy is 0.2903765067458153
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([585.4305, 447.8715, 470.7831, 622.5638, 425.2232, 448.9216, 397.1891,
        332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 332.4917,
        332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 645.4495,
        718.7749, 705.9873, 609.5277, 760.6324, 697.3940, 637.4458, 607.5183,
        565.8575, 608.8136, 604.8868, 634.7025, 512.8251, 892.7199, 693.8287,
        585.9588, 550.8348, 639.6425, 489.4203, 570.8010, 725.8680, 437.4245,
        644.9808, 579.6714], device='cuda:3')
sorted_norm is   tensor([332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 332.4917,
        332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 332.4917, 397.1891,
        425.2232, 437.4245, 447.8715, 448.9216, 470.7831, 489.4203, 512.8251,
        550.8348, 565.8575, 570.8010, 579.6714, 585.4305, 585.9588, 604.8868,
        607.5183, 608.8136, 609.5277, 622.5638, 634.7025, 637.4458, 639.6425,
        644.9808, 645.4495, 693.8287, 697.3940, 705.9873, 718.7749, 725.8680,
        760.6324, 892.7199], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  6,  4, 41,  1,  5,
         2, 38, 32, 36, 28, 39, 43,  0, 35, 30, 27, 29, 23,  3, 31, 26, 37],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 79.53% 

Test Accuracy: 84.37% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8916055448353291
distance x is tensor(117.8837, device='cuda:3')
benign distance is  tensor(117.8837, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1345640271902084
distance x is tensor(105.5687, device='cuda:3')
benign distance is  tensor(105.5687, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0655318349599838
distance x is tensor(106.8840, device='cuda:3')
benign distance is  tensor(106.8840, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2349274791777134
distance x is tensor(152.2223, device='cuda:3')
benign distance is  tensor(152.2223, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4666666369885206
distance x is tensor(94.0964, device='cuda:3')
benign distance is  tensor(94.0964, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8397565204650164
distance x is tensor(107.5332, device='cuda:3')
benign distance is  tensor(107.5332, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3427673894912004
distance x is tensor(107.9936, device='cuda:3')
benign distance is  tensor(107.9936, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.200151339173317
distance x is tensor(62.7474, device='cuda:3')
benign distance is  tensor(62.7474, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4362297169864178
distance x is tensor(101.6935, device='cuda:3')
benign distance is  tensor(101.6935, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7901946511119604
distance x is tensor(118.0004, device='cuda:3')
benign distance is  tensor(118.0004, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2862866166979074
distance x is tensor(81.2161, device='cuda:3')
benign distance is  tensor(81.2161, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.0012455508112907
distance x is tensor(120.4678, device='cuda:3')
benign distance is  tensor(120.4678, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4209471307694912
distance x is tensor(157.9760, device='cuda:3')
benign distance is  tensor(157.9760, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8493569530546665
distance x is tensor(63.2179, device='cuda:3')
benign distance is  tensor(63.2179, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9775900300592184
distance x is tensor(134.0839, device='cuda:3')
benign distance is  tensor(134.0839, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8550963327288628
distance x is tensor(113.0265, device='cuda:3')
benign distance is  tensor(113.0265, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.591340385377407
distance x is tensor(97.8576, device='cuda:3')
benign distance is  tensor(97.8576, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3463723883032799
distance x is tensor(114.9793, device='cuda:3')
benign distance is  tensor(114.9793, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2178704179823399
distance x is tensor(114.0148, device='cuda:3')
benign distance is  tensor(114.0148, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2614434957504272
distance x is tensor(116.8408, device='cuda:3')
benign distance is  tensor(116.8408, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.5574946217238903
distance x is tensor(94.7430, device='cuda:3')
benign distance is  tensor(94.7430, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8615997284650803
distance x is tensor(205.6949, device='cuda:3')
benign distance is  tensor(205.6949, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3422909267246723
distance x is tensor(155.2517, device='cuda:3')
benign distance is  tensor(155.2517, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0061635132879019
distance x is tensor(104.1532, device='cuda:3')
benign distance is  tensor(104.1532, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.6323300935328007
distance x is tensor(111.7944, device='cuda:3')
benign distance is  tensor(111.7944, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.83094921708107
distance x is tensor(149.4877, device='cuda:3')
benign distance is  tensor(149.4877, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.663798313587904
distance x is tensor(138.3352, device='cuda:3')
benign distance is  tensor(138.3352, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9278239645063877
distance x is tensor(99.9676, device='cuda:3')
benign distance is  tensor(99.9676, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7684058826416731
distance x is tensor(156.2630, device='cuda:3')
benign distance is  tensor(156.2630, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.019581861793995
distance x is tensor(136.5128, device='cuda:3')
benign distance is  tensor(136.5128, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.6326575689017773
distance x is tensor(96.8086, device='cuda:3')
benign distance is  tensor(96.8086, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7115437928587198
distance x is tensor(131.9668, device='cuda:3')
benign distance is  tensor(131.9668, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.81500000016
mal_loss is 0.7089872248470783
mal_entropy is 0.2125876909121871
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([499.7250, 439.0250, 450.0739, 633.0793, 390.6550, 445.7214, 449.3365,
        267.4593, 530.5903, 530.5903, 530.5903, 530.5903, 530.5903, 530.5903,
        530.5903, 530.5903, 530.5903, 530.5903, 530.5903, 530.5903],
       device='cuda:3')
sorted_norm is   tensor([267.4593, 390.6550, 439.0250, 445.7214, 449.3365, 450.0739, 499.7250,
        530.5903, 530.5903, 530.5903, 530.5903, 530.5903, 530.5903, 530.5903,
        530.5903, 530.5903, 530.5903, 530.5903, 530.5903, 633.0793],
       device='cuda:3')
used idx is  tensor([ 7,  4,  1,  5,  6,  2,  0, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 89.25% 

Test Accuracy: 86.05% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8975606132298708
distance x is tensor(139.5074, device='cuda:3')
benign distance is  tensor(139.5074, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2106214798986912
distance x is tensor(110.1142, device='cuda:3')
benign distance is  tensor(110.1142, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8830811642110348
distance x is tensor(117.3770, device='cuda:3')
benign distance is  tensor(117.3770, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3136235810816288
distance x is tensor(152.3574, device='cuda:3')
benign distance is  tensor(152.3574, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3717138282954693
distance x is tensor(102.7058, device='cuda:3')
benign distance is  tensor(102.7058, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7329347422346473
distance x is tensor(110.8004, device='cuda:3')
benign distance is  tensor(110.8004, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6571364365518093
distance x is tensor(99.1072, device='cuda:3')
benign distance is  tensor(99.1072, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8340772222727537
distance x is tensor(82.0848, device='cuda:3')
benign distance is  tensor(82.0848, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.7990000001600001
mal_loss is 0.7775772493332624
mal_entropy is 0.19747577887028456
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([580.9865, 457.6830, 489.4651, 622.6666, 423.0326, 450.9896, 420.8404,
        333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 333.7363,
        333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 631.4959,
        575.9706, 699.7793, 622.5001, 610.2224, 552.3883, 552.6006, 517.6160,
        618.0591, 504.6378, 628.0689, 618.6377, 634.3265, 617.8401, 601.9079,
        615.3475, 512.9964, 575.5289, 440.6972, 590.4644, 711.4681, 402.6453,
        618.8660, 563.0910], device='cuda:3')
sorted_norm is   tensor([333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 333.7363,
        333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 333.7363, 402.6453,
        420.8404, 423.0326, 440.6972, 450.9896, 457.6830, 489.4651, 504.6378,
        512.9964, 517.6160, 552.3883, 552.6006, 563.0910, 575.5289, 575.9706,
        580.9865, 590.4644, 601.9079, 610.2224, 615.3475, 617.8401, 618.0591,
        618.6377, 618.8660, 622.5001, 622.6666, 628.0689, 631.4959, 634.3265,
        699.7793, 711.4681], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 41,  6,  4, 38,  5,
         1,  2, 29, 36, 27, 25, 26, 43, 37, 21,  0, 39, 34, 24, 35, 33, 28],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 86.08% 

Test Accuracy: 85.99% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9115632027387619
distance x is tensor(119.5536, device='cuda:3')
benign distance is  tensor(119.5536, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1408194601535797
distance x is tensor(108.3257, device='cuda:3')
benign distance is  tensor(108.3257, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0161751471459866
distance x is tensor(110.3482, device='cuda:3')
benign distance is  tensor(110.3482, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5343474708497524
distance x is tensor(147.1606, device='cuda:3')
benign distance is  tensor(147.1606, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4375123251229525
distance x is tensor(100.7259, device='cuda:3')
benign distance is  tensor(100.7259, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9124640580266714
distance x is tensor(102.7018, device='cuda:3')
benign distance is  tensor(102.7018, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5734420642256737
distance x is tensor(111.8030, device='cuda:3')
benign distance is  tensor(111.8030, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0046078190207481
distance x is tensor(65.2572, device='cuda:3')
benign distance is  tensor(65.2572, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1190678030252457
distance x is tensor(92.8139, device='cuda:3')
benign distance is  tensor(92.8139, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8649844974279404
distance x is tensor(121.9703, device='cuda:3')
benign distance is  tensor(121.9703, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0630001947283745
distance x is tensor(86.1056, device='cuda:3')
benign distance is  tensor(86.1056, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.414143145084381
distance x is tensor(109.3447, device='cuda:3')
benign distance is  tensor(109.3447, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3996847309172153
distance x is tensor(174.9001, device='cuda:3')
benign distance is  tensor(174.9001, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6665738709270954
distance x is tensor(59.7208, device='cuda:3')
benign distance is  tensor(59.7208, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.934007428586483
distance x is tensor(131.4645, device='cuda:3')
benign distance is  tensor(131.4645, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9588364586234093
distance x is tensor(116.9124, device='cuda:3')
benign distance is  tensor(116.9124, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2381231971085072
distance x is tensor(113.7738, device='cuda:3')
benign distance is  tensor(113.7738, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9620429836213589
distance x is tensor(85.6527, device='cuda:3')
benign distance is  tensor(85.6527, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3136654905974865
distance x is tensor(131.0275, device='cuda:3')
benign distance is  tensor(131.0275, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.8510369285941124
distance x is tensor(111.3754, device='cuda:3')
benign distance is  tensor(111.3754, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8929745070636272
distance x is tensor(124.2761, device='cuda:3')
benign distance is  tensor(124.2761, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9575969511643052
distance x is tensor(109.9384, device='cuda:3')
benign distance is  tensor(109.9384, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6397838871926069
distance x is tensor(107.4795, device='cuda:3')
benign distance is  tensor(107.4795, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9811866916716099
distance x is tensor(168.7478, device='cuda:3')
benign distance is  tensor(168.7478, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7935650944709778
distance x is tensor(122.9424, device='cuda:3')
benign distance is  tensor(122.9424, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1953545808792114
distance x is tensor(108.0503, device='cuda:3')
benign distance is  tensor(108.0503, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7365611121058464
distance x is tensor(144.7922, device='cuda:3')
benign distance is  tensor(144.7922, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.7360122054815292
distance x is tensor(132.2733, device='cuda:3')
benign distance is  tensor(132.2733, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8072299286723137
distance x is tensor(114.9986, device='cuda:3')
benign distance is  tensor(114.9986, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.1452260538935661
distance x is tensor(92.7320, device='cuda:3')
benign distance is  tensor(92.7320, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.941022515296936
distance x is tensor(93.7542, device='cuda:3')
benign distance is  tensor(93.7542, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8991608414798975
distance x is tensor(115.5534, device='cuda:3')
benign distance is  tensor(115.5534, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.79300000016
mal_loss is 0.917197659611702
mal_entropy is 0.1600113739259541
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([516.2820, 450.3537, 468.9578, 601.7222, 430.2131, 417.4436, 469.9061,
        271.2230, 479.8187, 479.8187, 479.8187, 479.8187, 479.8187, 479.8187,
        479.8187, 479.8187, 479.8187, 479.8187, 479.8187, 479.8187, 456.9734,
        513.4169, 491.3693, 522.4339, 431.1994, 858.3071, 657.5195, 486.6683],
       device='cuda:3')
sorted_norm is   tensor([271.2230, 417.4436, 430.2131, 431.1994, 450.3537, 456.9734, 468.9578,
        469.9061, 479.8187, 479.8187, 479.8187, 479.8187, 479.8187, 479.8187,
        479.8187, 479.8187, 479.8187, 479.8187, 479.8187, 479.8187, 486.6683,
        491.3693, 513.4169, 516.2820, 522.4339, 601.7222, 657.5195, 858.3071],
       device='cuda:3')
used idx is  tensor([ 7,  5,  4, 24,  1, 20,  2,  6, 13, 15, 19, 17, 11,  9, 16, 18,  8, 10,
        14, 12, 27, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 93.03% 

Test Accuracy: 86.04% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7566974684596062
distance x is tensor(138.1200, device='cuda:3')
benign distance is  tensor(138.1200, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0090882442891598
distance x is tensor(105.2360, device='cuda:3')
benign distance is  tensor(105.2360, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9482609685510397
distance x is tensor(112.3439, device='cuda:3')
benign distance is  tensor(112.3439, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0486234985291958
distance x is tensor(162.4444, device='cuda:3')
benign distance is  tensor(162.4444, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1681747436523438
distance x is tensor(98.9525, device='cuda:3')
benign distance is  tensor(98.9525, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7422903925180435
distance x is tensor(106.2380, device='cuda:3')
benign distance is  tensor(106.2380, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.46054407954216
distance x is tensor(110.4277, device='cuda:3')
benign distance is  tensor(110.4277, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8248746357858181
distance x is tensor(74.7571, device='cuda:3')
benign distance is  tensor(74.7571, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2875770591199398
distance x is tensor(101.6322, device='cuda:3')
benign distance is  tensor(101.6322, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8031884953379631
distance x is tensor(113.0042, device='cuda:3')
benign distance is  tensor(113.0042, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.254008773714304
distance x is tensor(121.8551, device='cuda:3')
benign distance is  tensor(121.8551, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2431148923933506
distance x is tensor(131.7417, device='cuda:3')
benign distance is  tensor(131.7417, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1521026194095612
distance x is tensor(88.6328, device='cuda:3')
benign distance is  tensor(88.6328, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0116064213216305
distance x is tensor(207.5079, device='cuda:3')
benign distance is  tensor(207.5079, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.428714293986559
distance x is tensor(155.1633, device='cuda:3')
benign distance is  tensor(155.1633, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1807973198592663
distance x is tensor(110.7445, device='cuda:3')
benign distance is  tensor(110.7445, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.75700000016
mal_loss is 1.1437150910496712
mal_entropy is 0.18747622380033135
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([582.1248, 443.6411, 480.0662, 664.0895, 406.9492, 437.6675, 452.9354,
        319.7430, 463.5121, 463.5121, 463.5121, 463.5121, 463.5121, 463.5121,
        463.5121, 463.5121, 463.5121, 463.5121, 463.5121, 463.5121, 459.9435,
        573.3727, 439.5047, 537.1681, 798.4319, 362.9546, 599.8013, 554.9854],
       device='cuda:3')
sorted_norm is   tensor([319.7430, 362.9546, 406.9492, 437.6675, 439.5047, 443.6411, 452.9354,
        459.9435, 463.5121, 463.5121, 463.5121, 463.5121, 463.5121, 463.5121,
        463.5121, 463.5121, 463.5121, 463.5121, 463.5121, 463.5121, 480.0662,
        537.1681, 554.9854, 573.3727, 582.1248, 599.8013, 664.0895, 798.4319],
       device='cuda:3')
used idx is  tensor([ 7, 25,  4,  5, 22,  1,  6, 20, 14, 12, 15, 18, 19, 17, 16,  9, 13, 10,
         8, 11,  2, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 69.56% 

Test Accuracy: 81.95% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8339644744992256
distance x is tensor(116.7615, device='cuda:3')
benign distance is  tensor(116.7615, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4141553863883018
distance x is tensor(111.9191, device='cuda:3')
benign distance is  tensor(111.9191, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9350431971251965
distance x is tensor(115.0094, device='cuda:3')
benign distance is  tensor(115.0094, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9545798227190971
distance x is tensor(156.8500, device='cuda:3')
benign distance is  tensor(156.8500, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2410777602344751
distance x is tensor(105.9096, device='cuda:3')
benign distance is  tensor(105.9096, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8764087837189436
distance x is tensor(108.2406, device='cuda:3')
benign distance is  tensor(108.2406, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6535473242402077
distance x is tensor(93.5867, device='cuda:3')
benign distance is  tensor(93.5867, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.112763125449419
distance x is tensor(74.1733, device='cuda:3')
benign distance is  tensor(74.1733, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2863000519573689
distance x is tensor(102.5869, device='cuda:3')
benign distance is  tensor(102.5869, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8723569419234991
distance x is tensor(131.9689, device='cuda:3')
benign distance is  tensor(131.9689, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2758569158613682
distance x is tensor(89.9024, device='cuda:3')
benign distance is  tensor(89.9024, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3576937206089497
distance x is tensor(115.6571, device='cuda:3')
benign distance is  tensor(115.6571, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1048912964761257
distance x is tensor(190.8102, device='cuda:3')
benign distance is  tensor(190.8102, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.998839532956481
distance x is tensor(63.1803, device='cuda:3')
benign distance is  tensor(63.1803, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1396492086350918
distance x is tensor(141.1568, device='cuda:3')
benign distance is  tensor(141.1568, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.1001249998807907
distance x is tensor(122.5107, device='cuda:3')
benign distance is  tensor(122.5107, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.66700000016
mal_loss is 2.1378025114536285
mal_entropy is 0.17184446938335896
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([492.4872, 460.4704, 486.9652, 639.7768, 441.1817, 434.8436, 392.6385,
        307.2483, 509.0201, 509.0201, 509.0201, 509.0201, 509.0201, 509.0201,
        509.0201, 509.0201, 509.0201, 509.0201, 509.0201, 509.0201],
       device='cuda:3')
sorted_norm is   tensor([307.2483, 392.6385, 434.8436, 441.1817, 460.4704, 486.9652, 492.4872,
        509.0201, 509.0201, 509.0201, 509.0201, 509.0201, 509.0201, 509.0201,
        509.0201, 509.0201, 509.0201, 509.0201, 509.0201, 639.7768],
       device='cuda:3')
used idx is  tensor([ 7,  6,  5,  4,  1,  2,  0, 18, 14, 16, 12,  8, 10, 11, 17, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 73.99% 

Test Accuracy: 80.62% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7581525593996048
distance x is tensor(138.5930, device='cuda:3')
benign distance is  tensor(138.5930, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2310279794037342
distance x is tensor(117.1668, device='cuda:3')
benign distance is  tensor(117.1668, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8823943771421909
distance x is tensor(132.5152, device='cuda:3')
benign distance is  tensor(132.5152, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3477250225842
distance x is tensor(163.0856, device='cuda:3')
benign distance is  tensor(163.0856, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.391725804656744
distance x is tensor(115.5530, device='cuda:3')
benign distance is  tensor(115.5530, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8984787706285715
distance x is tensor(113.2981, device='cuda:3')
benign distance is  tensor(113.2981, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7864107713103294
distance x is tensor(104.4428, device='cuda:3')
benign distance is  tensor(104.4428, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8373619858175516
distance x is tensor(93.4884, device='cuda:3')
benign distance is  tensor(93.4884, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.78500000016
mal_loss is 0.8321626428514719
mal_entropy is 0.20114327874034643
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([567.5665, 478.1123, 534.6180, 672.8638, 475.9797, 470.3308, 433.8523,
        379.7405, 379.7405, 379.7405, 379.7405, 379.7405, 379.7405, 379.7405,
        379.7405, 379.7405, 379.7405, 379.7405, 379.7405, 379.7405, 647.2529,
        767.9935, 721.2558, 624.0378, 778.2263, 719.4573, 602.3289, 613.1642,
        622.0082, 570.3090, 679.4905, 625.4904, 659.2583, 634.5541, 615.3276,
        810.8463, 565.6024, 588.1848, 610.0126, 657.9639, 519.1781, 921.9702,
        728.0083, 388.4600, 524.2587, 611.8510, 462.2799, 554.8811, 817.0563,
        394.4964, 642.2093, 230.5558], device='cuda:3')
sorted_norm is   tensor([230.5558, 379.7405, 379.7405, 379.7405, 379.7405, 379.7405, 379.7405,
        379.7405, 379.7405, 379.7405, 379.7405, 379.7405, 379.7405, 379.7405,
        388.4600, 394.4964, 433.8523, 462.2799, 470.3308, 475.9797, 478.1123,
        519.1781, 524.2587, 534.6180, 554.8811, 565.6024, 567.5665, 570.3090,
        588.1848, 602.3289, 610.0126, 611.8510, 613.1642, 615.3276, 622.0082,
        624.0378, 625.4904, 634.5541, 642.2093, 647.2529, 657.9639, 659.2583,
        672.8638, 679.4905, 719.4573, 721.2558, 728.0083, 767.9935, 778.2263,
        810.8463, 817.0563, 921.9702], device='cuda:3')
used idx is  tensor([51, 11, 19, 10, 13, 18, 16, 17, 15, 12,  8,  9, 14,  7, 43, 49,  6, 46,
         5,  4,  1, 40, 44,  2, 47, 36,  0, 29, 37, 26, 38, 45, 27, 34, 28, 23,
        31, 33, 50, 20, 39], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 80.44% 

Test Accuracy: 85.42% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8257359731942415
distance x is tensor(119.5766, device='cuda:3')
benign distance is  tensor(119.5766, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1249324679374695
distance x is tensor(101.9599, device='cuda:3')
benign distance is  tensor(101.9599, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1081161350011826
distance x is tensor(112.7881, device='cuda:3')
benign distance is  tensor(112.7881, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.328372798860073
distance x is tensor(148.5610, device='cuda:3')
benign distance is  tensor(148.5610, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3199023269116879
distance x is tensor(88.9371, device='cuda:3')
benign distance is  tensor(88.9371, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7775832396000624
distance x is tensor(109.6723, device='cuda:3')
benign distance is  tensor(109.6723, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1582855265587568
distance x is tensor(88.9863, device='cuda:3')
benign distance is  tensor(88.9863, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9270617291331291
distance x is tensor(58.8613, device='cuda:3')
benign distance is  tensor(58.8613, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9593712333589792
distance x is tensor(112.7586, device='cuda:3')
benign distance is  tensor(112.7586, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.855812007561326
distance x is tensor(122.7103, device='cuda:3')
benign distance is  tensor(122.7103, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1382239311933517
distance x is tensor(81.8049, device='cuda:3')
benign distance is  tensor(81.8049, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.789858728647232
distance x is tensor(111.6940, device='cuda:3')
benign distance is  tensor(111.6940, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2642544284462929
distance x is tensor(162.7897, device='cuda:3')
benign distance is  tensor(162.7897, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9475653283298016
distance x is tensor(64.9975, device='cuda:3')
benign distance is  tensor(64.9975, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.180564858019352
distance x is tensor(133.7613, device='cuda:3')
benign distance is  tensor(133.7613, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9214080944657326
distance x is tensor(116.9417, device='cuda:3')
benign distance is  tensor(116.9417, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2652554996311665
distance x is tensor(94.2011, device='cuda:3')
benign distance is  tensor(94.2011, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9103790502995253
distance x is tensor(107.7606, device='cuda:3')
benign distance is  tensor(107.7606, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.5169145874679089
distance x is tensor(113.9271, device='cuda:3')
benign distance is  tensor(113.9271, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1940640658140182
distance x is tensor(130.3572, device='cuda:3')
benign distance is  tensor(130.3572, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2531278803944588
distance x is tensor(85.2481, device='cuda:3')
benign distance is  tensor(85.2481, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.069688107818365
distance x is tensor(208.6216, device='cuda:3')
benign distance is  tensor(208.6216, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2244478203356266
distance x is tensor(155.5278, device='cuda:3')
benign distance is  tensor(155.5278, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.97300735861063
distance x is tensor(94.0361, device='cuda:3')
benign distance is  tensor(94.0361, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4227190464735031
distance x is tensor(114.9783, device='cuda:3')
benign distance is  tensor(114.9783, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7664069756865501
distance x is tensor(79.7234, device='cuda:3')
benign distance is  tensor(79.7234, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1690392270684242
distance x is tensor(131.7456, device='cuda:3')
benign distance is  tensor(131.7456, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.9657747894525528
distance x is tensor(120.7434, device='cuda:3')
benign distance is  tensor(120.7434, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9368937499821186
distance x is tensor(121.3552, device='cuda:3')
benign distance is  tensor(121.3552, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.316475749015808
distance x is tensor(108.2000, device='cuda:3')
benign distance is  tensor(108.2000, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5492524169385433
distance x is tensor(111.5179, device='cuda:3')
benign distance is  tensor(111.5179, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1460601650178432
distance x is tensor(165.2475, device='cuda:3')
benign distance is  tensor(165.2475, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.8086316511034966
distance x is tensor(115.9742, device='cuda:3')
benign distance is  tensor(115.9742, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.500437706708908
distance x is tensor(131.5961, device='cuda:3')
benign distance is  tensor(131.5961, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2393677346408367
distance x is tensor(146.2968, device='cuda:3')
benign distance is  tensor(146.2968, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3794152066111565
distance x is tensor(101.6900, device='cuda:3')
benign distance is  tensor(101.6900, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8984215576201677
distance x is tensor(158.2557, device='cuda:3')
benign distance is  tensor(158.2557, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8827469553798437
distance x is tensor(137.3213, device='cuda:3')
benign distance is  tensor(137.3213, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.119361961260438
distance x is tensor(113.8635, device='cuda:3')
benign distance is  tensor(113.8635, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7979241944849491
distance x is tensor(115.7267, device='cuda:3')
benign distance is  tensor(115.7267, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.82100000016
mal_loss is 0.7729658540338278
mal_entropy is 0.1631387211382389
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([501.2812, 424.8382, 476.7342, 623.1284, 367.0072, 446.7002, 380.2469,
        233.1485, 470.0579, 470.0579, 470.0579, 470.0579, 470.0579, 470.0579,
        470.0579, 470.0579, 470.0579, 470.0579, 470.0579, 470.0579, 589.1365,
        514.4060, 665.4843, 611.4976, 554.7640, 487.3688, 484.7024, 426.9071],
       device='cuda:3')
sorted_norm is   tensor([233.1485, 367.0072, 380.2469, 424.8382, 426.9071, 446.7002, 470.0579,
        470.0579, 470.0579, 470.0579, 470.0579, 470.0579, 470.0579, 470.0579,
        470.0579, 470.0579, 470.0579, 470.0579, 476.7342, 484.7024, 487.3688,
        501.2812, 514.4060, 554.7640, 589.1365, 611.4976, 623.1284, 665.4843],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  1, 27,  5, 19, 17, 13,  9, 15, 11, 16, 12, 10, 18,  8, 14,
         2, 26, 25,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 89.34% 

Test Accuracy: 86.48% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9803784508258104
distance x is tensor(125.2528, device='cuda:3')
benign distance is  tensor(125.2528, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.320581678301096
distance x is tensor(118.0694, device='cuda:3')
benign distance is  tensor(118.0694, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8456757701933384
distance x is tensor(122.7257, device='cuda:3')
benign distance is  tensor(122.7257, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2319301590323448
distance x is tensor(159.0731, device='cuda:3')
benign distance is  tensor(159.0731, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8974306164309382
distance x is tensor(103.7271, device='cuda:3')
benign distance is  tensor(103.7271, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8306836746633053
distance x is tensor(115.7298, device='cuda:3')
benign distance is  tensor(115.7298, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.268217721953988
distance x is tensor(103.1349, device='cuda:3')
benign distance is  tensor(103.1349, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.994274128228426
distance x is tensor(69.3500, device='cuda:3')
benign distance is  tensor(69.3500, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7520450223237276
distance x is tensor(138.1702, device='cuda:3')
benign distance is  tensor(138.1702, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1427524462342262
distance x is tensor(109.2017, device='cuda:3')
benign distance is  tensor(109.2017, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8399241156876087
distance x is tensor(157.4708, device='cuda:3')
benign distance is  tensor(157.4708, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.8167561069130898
distance x is tensor(136.5866, device='cuda:3')
benign distance is  tensor(136.5866, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.902756292372942
distance x is tensor(119.8177, device='cuda:3')
benign distance is  tensor(119.8177, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8895862847566605
distance x is tensor(96.9671, device='cuda:3')
benign distance is  tensor(96.9671, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8546660840511322
distance x is tensor(102.5099, device='cuda:3')
benign distance is  tensor(102.5099, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8365285433828831
distance x is tensor(109.7864, device='cuda:3')
benign distance is  tensor(109.7864, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.79600000016
mal_loss is 0.9298837892711163
mal_entropy is 0.16160219023004174
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([546.8102, 487.2224, 522.0891, 648.7448, 423.5693, 466.6798, 427.9240,
        288.9667, 455.0127, 455.0127, 455.0127, 455.0127, 455.0127, 455.0127,
        455.0127, 455.0127, 455.0127, 455.0127, 455.0127, 455.0127, 530.5089,
        575.6263, 426.8740, 545.4243, 710.3526, 371.3885, 603.8253, 561.3458],
       device='cuda:3')
sorted_norm is   tensor([288.9667, 371.3885, 423.5693, 426.8740, 427.9240, 455.0127, 455.0127,
        455.0127, 455.0127, 455.0127, 455.0127, 455.0127, 455.0127, 455.0127,
        455.0127, 455.0127, 455.0127, 466.6798, 487.2224, 522.0891, 530.5089,
        545.4243, 546.8102, 561.3458, 575.6263, 603.8253, 648.7448, 710.3526],
       device='cuda:3')
used idx is  tensor([ 7, 25,  4, 22,  6, 14, 18, 16, 12, 10,  8, 11, 17, 19,  9, 13, 15,  5,
         1,  2, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 93.26% 

Test Accuracy: 86.62% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8365878257900476
distance x is tensor(134.4844, device='cuda:3')
benign distance is  tensor(134.4844, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3158221915364265
distance x is tensor(115.0781, device='cuda:3')
benign distance is  tensor(115.0781, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.740530364215374
distance x is tensor(118.3564, device='cuda:3')
benign distance is  tensor(118.3564, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9323283322155476
distance x is tensor(163.3995, device='cuda:3')
benign distance is  tensor(163.3995, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8496438674628735
distance x is tensor(102.5884, device='cuda:3')
benign distance is  tensor(102.5884, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8599665081128478
distance x is tensor(107.9284, device='cuda:3')
benign distance is  tensor(107.9284, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.269044453278184
distance x is tensor(107.6185, device='cuda:3')
benign distance is  tensor(107.6185, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7447519702836871
distance x is tensor(72.6260, device='cuda:3')
benign distance is  tensor(72.6260, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0488499384373426
distance x is tensor(115.9692, device='cuda:3')
benign distance is  tensor(115.9692, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6939624408259988
distance x is tensor(134.9670, device='cuda:3')
benign distance is  tensor(134.9670, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4577440954744816
distance x is tensor(88.6055, device='cuda:3')
benign distance is  tensor(88.6055, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.552889660000801
distance x is tensor(130.2431, device='cuda:3')
benign distance is  tensor(130.2431, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0408594906330109
distance x is tensor(171.4210, device='cuda:3')
benign distance is  tensor(171.4210, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.970597293227911
distance x is tensor(78.6642, device='cuda:3')
benign distance is  tensor(78.6642, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9723173584789038
distance x is tensor(151.3910, device='cuda:3')
benign distance is  tensor(151.3910, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4073858223855495
distance x is tensor(118.6106, device='cuda:3')
benign distance is  tensor(118.6106, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.73800000016
mal_loss is 1.414171688258648
mal_entropy is 0.17589868512004614
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([556.6514, 487.2379, 496.4587, 678.3913, 422.6295, 445.0962, 447.8715,
        305.4247, 494.7252, 494.7252, 494.7252, 494.7252, 494.7252, 494.7252,
        494.7252, 494.7252, 494.7252, 494.7252, 494.7252, 494.7252, 510.1722,
        549.9351, 552.0164, 617.5673, 464.8598, 909.6447, 707.8578, 513.2875],
       device='cuda:3')
sorted_norm is   tensor([305.4247, 422.6295, 445.0962, 447.8715, 464.8598, 487.2379, 494.7252,
        494.7252, 494.7252, 494.7252, 494.7252, 494.7252, 494.7252, 494.7252,
        494.7252, 494.7252, 494.7252, 494.7252, 496.4587, 510.1722, 513.2875,
        549.9351, 552.0164, 556.6514, 617.5673, 678.3913, 707.8578, 909.6447],
       device='cuda:3')
used idx is  tensor([ 7,  4,  5,  6, 24,  1, 16, 18, 14, 12, 15, 17, 19, 10,  8,  9, 13, 11,
         2, 20, 27, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 84.46% 

Test Accuracy: 83.62% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9854435846209526
distance x is tensor(126.0297, device='cuda:3')
benign distance is  tensor(126.0297, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2002338208258152
distance x is tensor(118.8092, device='cuda:3')
benign distance is  tensor(118.8092, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9486724101006985
distance x is tensor(127.0198, device='cuda:3')
benign distance is  tensor(127.0198, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.002609983086586
distance x is tensor(161.0007, device='cuda:3')
benign distance is  tensor(161.0007, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4150824397802353
distance x is tensor(101.3959, device='cuda:3')
benign distance is  tensor(101.3959, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8859732635319233
distance x is tensor(118.8931, device='cuda:3')
benign distance is  tensor(118.8931, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.31621528044343
distance x is tensor(101.5970, device='cuda:3')
benign distance is  tensor(101.5970, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1227817051112652
distance x is tensor(68.6035, device='cuda:3')
benign distance is  tensor(68.6035, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3813961036503315
distance x is tensor(97.1122, device='cuda:3')
benign distance is  tensor(97.1122, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0810999423265457
distance x is tensor(114.9391, device='cuda:3')
benign distance is  tensor(114.9391, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3282054141163826
distance x is tensor(124.5372, device='cuda:3')
benign distance is  tensor(124.5372, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1852394938468933
distance x is tensor(126.9659, device='cuda:3')
benign distance is  tensor(126.9659, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0577038675546646
distance x is tensor(93.8854, device='cuda:3')
benign distance is  tensor(93.8854, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8723704554140568
distance x is tensor(218.5459, device='cuda:3')
benign distance is  tensor(218.5459, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1878460571169853
distance x is tensor(147.0020, device='cuda:3')
benign distance is  tensor(147.0020, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.013639211654663
distance x is tensor(124.5431, device='cuda:3')
benign distance is  tensor(124.5431, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.77400000016
mal_loss is 1.0168592296540737
mal_entropy is 0.19963867589831352
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([531.8312, 494.3667, 545.9477, 657.2451, 417.9242, 491.2739, 427.1570,
        276.9286, 515.9558, 515.9558, 515.9558, 515.9558, 515.9558, 515.9558,
        515.9558, 515.9558, 515.9558, 515.9558, 515.9558, 515.9558, 594.9124,
        491.9729, 654.2794, 613.9390, 613.9989, 586.5745, 582.4372, 771.8428,
        557.4067, 626.3951, 447.0973, 590.7486, 745.0985, 421.1108, 676.5154,
        234.7240], device='cuda:3')
sorted_norm is   tensor([234.7240, 276.9286, 417.9242, 421.1108, 427.1570, 447.0973, 491.2739,
        491.9729, 494.3667, 515.9558, 515.9558, 515.9558, 515.9558, 515.9558,
        515.9558, 515.9558, 515.9558, 515.9558, 515.9558, 515.9558, 515.9558,
        531.8312, 545.9477, 557.4067, 582.4372, 586.5745, 590.7486, 594.9124,
        613.9390, 613.9989, 626.3951, 654.2794, 657.2451, 676.5154, 745.0985,
        771.8428], device='cuda:3')
used idx is  tensor([35,  7,  4, 33,  6, 30,  5, 21,  1, 14, 15, 12, 19, 17, 16, 18, 13, 10,
         8, 11,  9,  0,  2, 28, 26, 25, 31, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 83.98% 

Test Accuracy: 85.23% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9236410036683083
distance x is tensor(129.0868, device='cuda:3')
benign distance is  tensor(129.0868, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9286039397120476
distance x is tensor(108.5705, device='cuda:3')
benign distance is  tensor(108.5705, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6821310594677925
distance x is tensor(114.3958, device='cuda:3')
benign distance is  tensor(114.3958, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1821499429643154
distance x is tensor(162.4462, device='cuda:3')
benign distance is  tensor(162.4462, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0624816305935383
distance x is tensor(110.7929, device='cuda:3')
benign distance is  tensor(110.7929, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7550331242382526
distance x is tensor(108.3675, device='cuda:3')
benign distance is  tensor(108.3675, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9685035943984985
distance x is tensor(105.6831, device='cuda:3')
benign distance is  tensor(105.6831, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8444122262299061
distance x is tensor(72.3973, device='cuda:3')
benign distance is  tensor(72.3973, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3463526107370853
distance x is tensor(106.8152, device='cuda:3')
benign distance is  tensor(106.8152, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7241834960877895
distance x is tensor(146.6513, device='cuda:3')
benign distance is  tensor(146.6513, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.371014203876257
distance x is tensor(83.9821, device='cuda:3')
benign distance is  tensor(83.9821, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.430816289037466
distance x is tensor(117.6179, device='cuda:3')
benign distance is  tensor(117.6179, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1957012861967087
distance x is tensor(166.0318, device='cuda:3')
benign distance is  tensor(166.0318, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7491609361022711
distance x is tensor(66.6293, device='cuda:3')
benign distance is  tensor(66.6293, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0295424424111843
distance x is tensor(138.1300, device='cuda:3')
benign distance is  tensor(138.1300, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4700448289513588
distance x is tensor(112.4808, device='cuda:3')
benign distance is  tensor(112.4808, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2587798312306404
distance x is tensor(123.8479, device='cuda:3')
benign distance is  tensor(123.8479, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8852460812777281
distance x is tensor(90.6885, device='cuda:3')
benign distance is  tensor(90.6885, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0200436227023602
distance x is tensor(124.9562, device='cuda:3')
benign distance is  tensor(124.9562, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.014085717499256
distance x is tensor(118.2981, device='cuda:3')
benign distance is  tensor(118.2981, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0048176012933254
distance x is tensor(124.4641, device='cuda:3')
benign distance is  tensor(124.4641, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9330476392060518
distance x is tensor(110.1158, device='cuda:3')
benign distance is  tensor(110.1158, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6792073901742697
distance x is tensor(124.7938, device='cuda:3')
benign distance is  tensor(124.7938, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0797901153564453
distance x is tensor(164.2101, device='cuda:3')
benign distance is  tensor(164.2101, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.73200000016
mal_loss is 1.0982890129089355
mal_entropy is 0.2440741676837206
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([546.0120, 457.1595, 481.8434, 669.9009, 457.5399, 451.5120, 434.6899,
        301.6416, 672.8796, 672.8796, 672.8796, 672.8796, 672.8796, 672.8796,
        672.8796, 672.8796, 672.8796, 672.8796, 672.8796, 672.8796],
       device='cuda:3')
sorted_norm is   tensor([301.6416, 434.6899, 451.5120, 457.1595, 457.5399, 481.8434, 546.0120,
        669.9009, 672.8796, 672.8796, 672.8796, 672.8796, 672.8796, 672.8796,
        672.8796, 672.8796, 672.8796, 672.8796, 672.8796, 672.8796],
       device='cuda:3')
used idx is  tensor([ 7,  6,  5,  1,  4,  2,  0,  3, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 83.85% 

Test Accuracy: 85.22% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8743982370942831
distance x is tensor(122.1131, device='cuda:3')
benign distance is  tensor(122.1131, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4088909924030304
distance x is tensor(111.4482, device='cuda:3')
benign distance is  tensor(111.4482, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8863907158374786
distance x is tensor(116.8073, device='cuda:3')
benign distance is  tensor(116.8073, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0752330645918846
distance x is tensor(158.9467, device='cuda:3')
benign distance is  tensor(158.9467, device='cuda:3')
current submit client idx and staleness is  4 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7669199462980032
distance x is tensor(119.7568, device='cuda:3')
benign distance is  tensor(119.7568, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8588819429278374
distance x is tensor(105.2669, device='cuda:3')
benign distance is  tensor(105.2669, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6546134203672409
distance x is tensor(104.9682, device='cuda:3')
benign distance is  tensor(104.9682, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9385164845734835
distance x is tensor(149.9888, device='cuda:3')
benign distance is  tensor(149.9888, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9240348562598228
distance x is tensor(100.1727, device='cuda:3')
benign distance is  tensor(100.1727, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7741422252729535
distance x is tensor(98.7600, device='cuda:3')
benign distance is  tensor(98.7600, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1127351261675358
distance x is tensor(108.6783, device='cuda:3')
benign distance is  tensor(108.6783, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6732851415872574
distance x is tensor(90.5537, device='cuda:3')
benign distance is  tensor(90.5537, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8388738743960857
distance x is tensor(115.5105, device='cuda:3')
benign distance is  tensor(115.5105, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6427372368052602
distance x is tensor(128.2345, device='cuda:3')
benign distance is  tensor(128.2345, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2586824633181095
distance x is tensor(90.2507, device='cuda:3')
benign distance is  tensor(90.2507, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3467262722551823
distance x is tensor(121.3440, device='cuda:3')
benign distance is  tensor(121.3440, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.131135631352663
distance x is tensor(161.4848, device='cuda:3')
benign distance is  tensor(161.4848, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6172636235132813
distance x is tensor(67.0540, device='cuda:3')
benign distance is  tensor(67.0540, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9234688468277454
distance x is tensor(149.9099, device='cuda:3')
benign distance is  tensor(149.9099, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.217538133263588
distance x is tensor(129.2314, device='cuda:3')
benign distance is  tensor(129.2314, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0699695907533169
distance x is tensor(119.9448, device='cuda:3')
benign distance is  tensor(119.9448, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7449280228465796
distance x is tensor(118.3320, device='cuda:3')
benign distance is  tensor(118.3320, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9812963455915451
distance x is tensor(123.3525, device='cuda:3')
benign distance is  tensor(123.3525, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7203338947147131
distance x is tensor(123.1633, device='cuda:3')
benign distance is  tensor(123.1633, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0238051153719425
distance x is tensor(87.9374, device='cuda:3')
benign distance is  tensor(87.9374, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7519938349723816
distance x is tensor(216.2998, device='cuda:3')
benign distance is  tensor(216.2998, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.036557026207447
distance x is tensor(151.9651, device='cuda:3')
benign distance is  tensor(151.9651, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6682218052446842
distance x is tensor(116.0910, device='cuda:3')
benign distance is  tensor(116.0910, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0433165868744254
distance x is tensor(127.3692, device='cuda:3')
benign distance is  tensor(127.3692, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5559205543249846
distance x is tensor(78.1711, device='cuda:3')
benign distance is  tensor(78.1711, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0124201066792011
distance x is tensor(145.8599, device='cuda:3')
benign distance is  tensor(145.8599, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3217336237430573
distance x is tensor(117.0937, device='cuda:3')
benign distance is  tensor(117.0937, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6242963382974267
distance x is tensor(122.2233, device='cuda:3')
benign distance is  tensor(122.2233, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8160954248160124
distance x is tensor(123.2606, device='cuda:3')
benign distance is  tensor(123.2606, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4879448628053069
distance x is tensor(104.7045, device='cuda:3')
benign distance is  tensor(104.7045, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7513508349657059
distance x is tensor(171.3787, device='cuda:3')
benign distance is  tensor(171.3787, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6752456910908222
distance x is tensor(117.9572, device='cuda:3')
benign distance is  tensor(117.9572, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7364296037703753
distance x is tensor(105.2323, device='cuda:3')
benign distance is  tensor(105.2323, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6352582015097141
distance x is tensor(145.1060, device='cuda:3')
benign distance is  tensor(145.1060, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3835903145372868
distance x is tensor(124.8416, device='cuda:3')
benign distance is  tensor(124.8416, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7488634400069714
distance x is tensor(112.3294, device='cuda:3')
benign distance is  tensor(112.3294, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9258495150133967
distance x is tensor(83.6244, device='cuda:3')
benign distance is  tensor(83.6244, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7745192255824804
distance x is tensor(101.0381, device='cuda:3')
benign distance is  tensor(101.0381, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7554401233792305
distance x is tensor(115.0532, device='cuda:3')
benign distance is  tensor(115.0532, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2431125603616238
distance x is tensor(111.4108, device='cuda:3')
benign distance is  tensor(111.4108, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3374712392687798
distance x is tensor(141.8316, device='cuda:3')
benign distance is  tensor(141.8316, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0257578324526548
distance x is tensor(146.9762, device='cuda:3')
benign distance is  tensor(146.9762, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9927940033376217
distance x is tensor(103.8394, device='cuda:3')
benign distance is  tensor(103.8394, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5431975554674864
distance x is tensor(155.6168, device='cuda:3')
benign distance is  tensor(155.6168, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7161145322024822
distance x is tensor(134.5014, device='cuda:3')
benign distance is  tensor(134.5014, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7866788953542709
distance x is tensor(103.2861, device='cuda:3')
benign distance is  tensor(103.2861, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5486437762156129
distance x is tensor(126.0983, device='cuda:3')
benign distance is  tensor(126.0983, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.86100000016
mal_loss is 0.5693475920706987
mal_entropy is 0.16299018962308764
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([561.8727, 489.8712, 490.2984, 691.8542, 462.9576, 442.8646, 495.9867,
        411.6764, 553.7761, 553.7761, 553.7761, 553.7761, 553.7761, 553.7761,
        553.7761, 553.7761, 553.7761, 553.7761, 553.7761, 553.7761],
       device='cuda:3')
sorted_norm is   tensor([411.6764, 442.8646, 462.9576, 489.8712, 490.2984, 495.9867, 553.7761,
        553.7761, 553.7761, 553.7761, 553.7761, 553.7761, 553.7761, 553.7761,
        553.7761, 553.7761, 553.7761, 553.7761, 561.8727, 691.8542],
       device='cuda:3')
used idx is  tensor([ 7,  5,  4,  1,  2,  6, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 93.27% 

Test Accuracy: 87.50% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7653432283550501
distance x is tensor(127.2261, device='cuda:3')
benign distance is  tensor(127.2261, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7774367202073336
distance x is tensor(122.2152, device='cuda:3')
benign distance is  tensor(122.2152, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7291787657886744
distance x is tensor(118.4514, device='cuda:3')
benign distance is  tensor(118.4514, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8803336955606937
distance x is tensor(164.4101, device='cuda:3')
benign distance is  tensor(164.4101, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.802932315506041
distance x is tensor(93.2871, device='cuda:3')
benign distance is  tensor(93.2871, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.704041569493711
distance x is tensor(110.2262, device='cuda:3')
benign distance is  tensor(110.2262, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4575715325772762
distance x is tensor(106.8509, device='cuda:3')
benign distance is  tensor(106.8509, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7015126440674067
distance x is tensor(96.8665, device='cuda:3')
benign distance is  tensor(96.8665, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.83000000016
mal_loss is 0.7202103119343519
mal_entropy is 0.19430943112820387
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([577.5270, 569.0686, 545.1466, 751.5662, 422.2960, 502.3296, 484.6440,
        433.2364, 433.2364, 433.2364, 433.2364, 433.2364, 433.2364, 433.2364,
        433.2364, 433.2364, 433.2364, 433.2364, 433.2364, 433.2364, 623.2116,
        687.3238, 533.9546, 648.8544, 815.4427, 458.8332, 749.1441, 685.3005],
       device='cuda:3')
sorted_norm is   tensor([422.2960, 433.2364, 433.2364, 433.2364, 433.2364, 433.2364, 433.2364,
        433.2364, 433.2364, 433.2364, 433.2364, 433.2364, 433.2364, 433.2364,
        458.8332, 484.6440, 502.3296, 533.9546, 545.1466, 569.0686, 577.5270,
        623.2116, 648.8544, 685.3005, 687.3238, 749.1441, 751.5662, 815.4427],
       device='cuda:3')
used idx is  tensor([ 4, 18, 14, 16, 12,  8, 10, 17,  9, 13, 11, 19, 15,  7, 25,  6,  5, 22,
         2,  1,  0, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 91.65% 

Test Accuracy: 86.98% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6868673544377089
distance x is tensor(125.1917, device='cuda:3')
benign distance is  tensor(125.1917, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9435706418007612
distance x is tensor(125.9144, device='cuda:3')
benign distance is  tensor(125.9144, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.754615543410182
distance x is tensor(118.8332, device='cuda:3')
benign distance is  tensor(118.8332, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0486082434654236
distance x is tensor(154.8089, device='cuda:3')
benign distance is  tensor(154.8089, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.87878533359617
distance x is tensor(101.4675, device='cuda:3')
benign distance is  tensor(101.4675, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6963797649368644
distance x is tensor(121.9592, device='cuda:3')
benign distance is  tensor(121.9592, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.073186194524169
distance x is tensor(109.6869, device='cuda:3')
benign distance is  tensor(109.6869, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7170449290424585
distance x is tensor(71.4853, device='cuda:3')
benign distance is  tensor(71.4853, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.875309843569994
distance x is tensor(115.3689, device='cuda:3')
benign distance is  tensor(115.3689, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7092835213989019
distance x is tensor(141.7921, device='cuda:3')
benign distance is  tensor(141.7921, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2332386448979378
distance x is tensor(92.4738, device='cuda:3')
benign distance is  tensor(92.4738, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.442286141216755
distance x is tensor(121.4818, device='cuda:3')
benign distance is  tensor(121.4818, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1663694195449352
distance x is tensor(174.8315, device='cuda:3')
benign distance is  tensor(174.8315, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9160065427422523
distance x is tensor(80.6316, device='cuda:3')
benign distance is  tensor(80.6316, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9296852070838213
distance x is tensor(149.0213, device='cuda:3')
benign distance is  tensor(149.0213, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.405830278992653
distance x is tensor(142.2151, device='cuda:3')
benign distance is  tensor(142.2151, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.72600000016
mal_loss is 1.4621535316109657
mal_entropy is 0.21699802298098803
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 566.4838,  577.5168,  547.3411,  703.3726,  448.9291,  546.1792,
         482.5752,  322.3015,  634.1765,  634.1765,  634.1765,  634.1765,
         634.1765,  634.1765,  634.1765,  634.1765,  634.1765,  634.1765,
         634.1765,  634.1765,  660.6144,  652.0518,  671.9420,  684.0005,
         541.8724, 1024.5400,  779.5541,  652.5502], device='cuda:3')
sorted_norm is   tensor([ 322.3015,  448.9291,  482.5752,  541.8724,  546.1792,  547.3411,
         566.4838,  577.5168,  634.1765,  634.1765,  634.1765,  634.1765,
         634.1765,  634.1765,  634.1765,  634.1765,  634.1765,  634.1765,
         634.1765,  634.1765,  652.0518,  652.5502,  660.6144,  671.9420,
         684.0005,  703.3726,  779.5541, 1024.5400], device='cuda:3')
used idx is  tensor([ 7,  4,  6, 24,  5,  2,  0,  1, 15, 18, 16, 17, 19, 12, 14,  9, 13, 11,
         8, 10, 21, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 86.50% 

Test Accuracy: 84.75% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6692952755838633
distance x is tensor(115.4436, device='cuda:3')
benign distance is  tensor(115.4436, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8905472382903099
distance x is tensor(118.6411, device='cuda:3')
benign distance is  tensor(118.6411, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7621349450200796
distance x is tensor(111.4736, device='cuda:3')
benign distance is  tensor(111.4736, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9999115765094757
distance x is tensor(151.4854, device='cuda:3')
benign distance is  tensor(151.4854, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7651869626715779
distance x is tensor(97.6574, device='cuda:3')
benign distance is  tensor(97.6574, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7244043275713921
distance x is tensor(110.5397, device='cuda:3')
benign distance is  tensor(110.5397, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1431068778038025
distance x is tensor(106.4309, device='cuda:3')
benign distance is  tensor(106.4309, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.690617498010397
distance x is tensor(76.0299, device='cuda:3')
benign distance is  tensor(76.0299, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1924441941082478
distance x is tensor(92.9151, device='cuda:3')
benign distance is  tensor(92.9151, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7229566723108292
distance x is tensor(116.8388, device='cuda:3')
benign distance is  tensor(116.8388, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0880472511053085
distance x is tensor(132.5144, device='cuda:3')
benign distance is  tensor(132.5144, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8433394096791744
distance x is tensor(129.2505, device='cuda:3')
benign distance is  tensor(129.2505, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0412318333983421
distance x is tensor(73.4356, device='cuda:3')
benign distance is  tensor(73.4356, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7190307080745697
distance x is tensor(212.3231, device='cuda:3')
benign distance is  tensor(212.3231, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0824648477137089
distance x is tensor(159.2558, device='cuda:3')
benign distance is  tensor(159.2558, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6672067493200302
distance x is tensor(117.2369, device='cuda:3')
benign distance is  tensor(117.2369, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.83600000016
mal_loss is 0.5923827141523361
mal_entropy is 0.20876361057162285
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([515.0372, 529.7587, 510.1634, 672.8838, 442.2498, 499.2250, 474.2401,
        341.7347, 511.5896, 511.5896, 511.5896, 511.5896, 511.5896, 511.5896,
        511.5896, 511.5896, 511.5896, 511.5896, 511.5896, 511.5896, 746.5051,
        599.3853, 801.0374, 705.9857, 730.6518, 740.5842, 681.4097, 908.4117,
        639.9334, 718.9480, 532.0251, 631.1753, 858.1167, 503.3047, 749.5379,
        297.3800], device='cuda:3')
sorted_norm is   tensor([297.3800, 341.7347, 442.2498, 474.2401, 499.2250, 503.3047, 510.1634,
        511.5896, 511.5896, 511.5896, 511.5896, 511.5896, 511.5896, 511.5896,
        511.5896, 511.5896, 511.5896, 511.5896, 511.5896, 515.0372, 529.7587,
        532.0251, 599.3853, 631.1753, 639.9334, 672.8838, 681.4097, 705.9857,
        718.9480, 730.6518, 740.5842, 746.5051, 749.5379, 801.0374, 858.1167,
        908.4117], device='cuda:3')
used idx is  tensor([35,  7,  4,  6,  5, 33,  2, 14, 10, 12, 15, 17, 13, 19, 16, 18,  8, 11,
         9,  0,  1, 30, 21, 31, 28,  3, 26, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 90.26% 

Test Accuracy: 87.57% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6778615601360798
distance x is tensor(114.7948, device='cuda:3')
benign distance is  tensor(114.7948, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9508139882236719
distance x is tensor(114.5489, device='cuda:3')
benign distance is  tensor(114.5489, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6974456496536732
distance x is tensor(110.9317, device='cuda:3')
benign distance is  tensor(110.9317, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8402560167014599
distance x is tensor(153.9102, device='cuda:3')
benign distance is  tensor(153.9102, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8301149252802134
distance x is tensor(90.5032, device='cuda:3')
benign distance is  tensor(90.5032, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7445437866263092
distance x is tensor(103.7362, device='cuda:3')
benign distance is  tensor(103.7362, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1882394887506962
distance x is tensor(97.6809, device='cuda:3')
benign distance is  tensor(97.6809, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6797331068664789
distance x is tensor(73.7360, device='cuda:3')
benign distance is  tensor(73.7360, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9472241215407848
distance x is tensor(112.7898, device='cuda:3')
benign distance is  tensor(112.7898, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6521288026124239
distance x is tensor(112.6856, device='cuda:3')
benign distance is  tensor(112.6856, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0041926577687263
distance x is tensor(85.3166, device='cuda:3')
benign distance is  tensor(85.3166, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3416349813342094
distance x is tensor(106.8884, device='cuda:3')
benign distance is  tensor(106.8884, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9597774296998978
distance x is tensor(166.7642, device='cuda:3')
benign distance is  tensor(166.7642, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6702973153442144
distance x is tensor(66.6238, device='cuda:3')
benign distance is  tensor(66.6238, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0275008082389832
distance x is tensor(137.3125, device='cuda:3')
benign distance is  tensor(137.3125, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3678990304470062
distance x is tensor(105.2380, device='cuda:3')
benign distance is  tensor(105.2380, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.958470243960619
distance x is tensor(116.8852, device='cuda:3')
benign distance is  tensor(116.8852, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6044978853315115
distance x is tensor(81.8289, device='cuda:3')
benign distance is  tensor(81.8289, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8778581619262695
distance x is tensor(122.9086, device='cuda:3')
benign distance is  tensor(122.9086, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.490873757749796
distance x is tensor(110.4877, device='cuda:3')
benign distance is  tensor(110.4877, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7868680860847235
distance x is tensor(122.7732, device='cuda:3')
benign distance is  tensor(122.7732, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8527735900133848
distance x is tensor(182.6675, device='cuda:3')
benign distance is  tensor(182.6675, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5009025866165757
distance x is tensor(119.0767, device='cuda:3')
benign distance is  tensor(119.0767, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7248942870646715
distance x is tensor(170.0711, device='cuda:3')
benign distance is  tensor(170.0711, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.7990000001600001
mal_loss is 0.6942912321537733
mal_entropy is 0.3056447319686413
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([513.7587, 510.3531, 508.6859, 694.2527, 395.4178, 455.6604, 435.6736,
        328.8691, 760.1300, 760.1299, 760.1300, 760.1299, 760.1300, 760.1299,
        760.1300, 760.1299, 760.1300, 760.1299, 760.1300, 760.1299, 716.3718,
        660.8351, 795.8831, 725.0721, 670.3992, 595.5245, 641.8254, 701.1412],
       device='cuda:3')
sorted_norm is   tensor([328.8691, 395.4178, 435.6736, 455.6604, 508.6859, 510.3531, 513.7587,
        595.5245, 641.8254, 660.8351, 670.3992, 694.2527, 701.1412, 716.3718,
        725.0721, 760.1299, 760.1299, 760.1299, 760.1299, 760.1299, 760.1299,
        760.1300, 760.1300, 760.1300, 760.1300, 760.1300, 760.1300, 795.8831],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  5,  2,  1,  0, 25, 26, 21, 24,  3, 27, 20, 23, 19, 17,  9,
        13, 15, 11, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 91.83% 

Test Accuracy: 87.91% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7007865030318499
distance x is tensor(94.7353, device='cuda:3')
benign distance is  tensor(94.7353, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8129243087023497
distance x is tensor(105.1352, device='cuda:3')
benign distance is  tensor(105.1352, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6378488708287477
distance x is tensor(104.0359, device='cuda:3')
benign distance is  tensor(104.0359, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.825644114986062
distance x is tensor(147.8845, device='cuda:3')
benign distance is  tensor(147.8845, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8078453135676682
distance x is tensor(84.6437, device='cuda:3')
benign distance is  tensor(84.6437, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5987718962132931
distance x is tensor(102.5650, device='cuda:3')
benign distance is  tensor(102.5650, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1744954474270344
distance x is tensor(99.4102, device='cuda:3')
benign distance is  tensor(99.4102, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5884405365213752
distance x is tensor(79.4550, device='cuda:3')
benign distance is  tensor(79.4550, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6877003088593483
distance x is tensor(119.6631, device='cuda:3')
benign distance is  tensor(119.6631, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8086289130151272
distance x is tensor(90.0100, device='cuda:3')
benign distance is  tensor(90.0100, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7298769317567348
distance x is tensor(140.4578, device='cuda:3')
benign distance is  tensor(140.4578, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.6878831088542938
distance x is tensor(118.9303, device='cuda:3')
benign distance is  tensor(118.9303, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8036774452775717
distance x is tensor(106.6984, device='cuda:3')
benign distance is  tensor(106.6984, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7227169834077358
distance x is tensor(94.5425, device='cuda:3')
benign distance is  tensor(94.5425, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7689364440739155
distance x is tensor(82.4278, device='cuda:3')
benign distance is  tensor(82.4278, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7843150943517685
distance x is tensor(117.3001, device='cuda:3')
benign distance is  tensor(117.3001, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8010000001600001
mal_loss is 0.80971016921103
mal_entropy is 0.15098369726911187
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([431.1543, 489.8969, 483.7654, 677.2834, 377.9865, 457.4303, 451.2260,
        356.4410, 531.9967, 531.9967, 531.9967, 531.9967, 531.9967, 531.9967,
        531.9967, 531.9967, 531.9967, 531.9967, 531.9967, 531.9967, 648.9831,
        753.5628, 762.6509, 598.8843, 822.3278, 714.0702, 618.2883, 558.2244,
        540.6993, 616.9387, 665.8792, 661.7585, 472.3222, 961.9625, 758.9178,
        501.1454, 569.6670, 582.9439, 475.5337, 562.4899, 787.8499, 409.7083,
        666.0851, 576.3248], device='cuda:3')
sorted_norm is   tensor([356.4410, 377.9865, 409.7083, 431.1543, 451.2260, 457.4303, 472.3222,
        475.5337, 483.7654, 489.8969, 501.1454, 531.9967, 531.9967, 531.9967,
        531.9967, 531.9967, 531.9967, 531.9967, 531.9967, 531.9967, 531.9967,
        531.9967, 531.9967, 540.6993, 558.2244, 562.4899, 569.6670, 576.3248,
        582.9439, 598.8843, 616.9387, 618.2883, 648.9831, 661.7585, 665.8792,
        666.0851, 677.2834, 714.0702, 753.5628, 758.9178, 762.6509, 787.8499,
        822.3278, 961.9625], device='cuda:3')
used idx is  tensor([ 7,  4, 41,  0,  6,  5, 32, 38,  2,  1, 35, 15, 19, 18, 16, 17, 13,  8,
        10, 11, 14, 12,  9, 28, 27, 39, 36, 43, 37, 23, 29, 26, 20, 31, 30],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 93.14% 

Test Accuracy: 88.01% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.850346527993679
distance x is tensor(111.5863, device='cuda:3')
benign distance is  tensor(111.5863, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7227424308657646
distance x is tensor(105.8320, device='cuda:3')
benign distance is  tensor(105.8320, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6110151056200266
distance x is tensor(104.5371, device='cuda:3')
benign distance is  tensor(104.5371, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8471156861633062
distance x is tensor(152.8656, device='cuda:3')
benign distance is  tensor(152.8656, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7586479727178812
distance x is tensor(87.3939, device='cuda:3')
benign distance is  tensor(87.3939, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6066953274421394
distance x is tensor(108.3675, device='cuda:3')
benign distance is  tensor(108.3675, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1014052759855986
distance x is tensor(100.3304, device='cuda:3')
benign distance is  tensor(100.3304, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8402239251881838
distance x is tensor(73.5332, device='cuda:3')
benign distance is  tensor(73.5332, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9380018636584282
distance x is tensor(105.6745, device='cuda:3')
benign distance is  tensor(105.6745, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.560529621783644
distance x is tensor(116.8450, device='cuda:3')
benign distance is  tensor(116.8450, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0643675476312637
distance x is tensor(77.1556, device='cuda:3')
benign distance is  tensor(77.1556, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4946688078343868
distance x is tensor(117.6931, device='cuda:3')
benign distance is  tensor(117.6931, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0732045955955982
distance x is tensor(160.8715, device='cuda:3')
benign distance is  tensor(160.8715, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6484846621751785
distance x is tensor(75.8666, device='cuda:3')
benign distance is  tensor(75.8666, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8673661928623915
distance x is tensor(140.2842, device='cuda:3')
benign distance is  tensor(140.2842, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2776133827865124
distance x is tensor(110.7682, device='cuda:3')
benign distance is  tensor(110.7682, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0652773566544056
distance x is tensor(117.3254, device='cuda:3')
benign distance is  tensor(117.3254, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6490618791431189
distance x is tensor(105.4309, device='cuda:3')
benign distance is  tensor(105.4309, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.034044973552227
distance x is tensor(114.7418, device='cuda:3')
benign distance is  tensor(114.7418, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8607074096798897
distance x is tensor(121.5289, device='cuda:3')
benign distance is  tensor(121.5289, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9161178339272738
distance x is tensor(75.5522, device='cuda:3')
benign distance is  tensor(75.5522, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6717361658811569
distance x is tensor(207.4811, device='cuda:3')
benign distance is  tensor(207.4811, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1725199408829212
distance x is tensor(149.5982, device='cuda:3')
benign distance is  tensor(149.5982, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7360788136720657
distance x is tensor(100.8468, device='cuda:3')
benign distance is  tensor(100.8468, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.128272108733654
distance x is tensor(110.8007, device='cuda:3')
benign distance is  tensor(110.8007, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3066511303186417
distance x is tensor(139.7386, device='cuda:3')
benign distance is  tensor(139.7386, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0141882114112377
distance x is tensor(139.5806, device='cuda:3')
benign distance is  tensor(139.5806, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8859996031969786
distance x is tensor(95.4353, device='cuda:3')
benign distance is  tensor(95.4353, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5260026585310698
distance x is tensor(158.1108, device='cuda:3')
benign distance is  tensor(158.1108, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7043134868144989
distance x is tensor(125.7601, device='cuda:3')
benign distance is  tensor(125.7601, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8147544795647264
distance x is tensor(97.1233, device='cuda:3')
benign distance is  tensor(97.1233, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5699274428188801
distance x is tensor(119.8871, device='cuda:3')
benign distance is  tensor(119.8871, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85600000016
mal_loss is 0.5929133798927069
mal_entropy is 0.15896187536418438
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([501.3547, 488.4816, 477.2520, 689.1294, 386.6842, 482.3232, 450.9706,
        329.4794, 521.8378, 521.8378, 521.8378, 521.8378, 521.8378, 521.8378,
        521.8378, 521.8378, 521.8378, 521.8378, 521.8378, 521.8378],
       device='cuda:3')
sorted_norm is   tensor([329.4794, 386.6842, 450.9706, 477.2520, 482.3232, 488.4816, 501.3547,
        521.8378, 521.8378, 521.8378, 521.8378, 521.8378, 521.8378, 521.8378,
        521.8378, 521.8378, 521.8378, 521.8378, 521.8378, 689.1294],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  2,  5,  1,  0, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 92.83% 

Test Accuracy: 87.66% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.708294665440917
distance x is tensor(123.3686, device='cuda:3')
benign distance is  tensor(123.3686, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9226671569049358
distance x is tensor(107.0591, device='cuda:3')
benign distance is  tensor(107.0591, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7321625724434853
distance x is tensor(111.6759, device='cuda:3')
benign distance is  tensor(111.6759, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8253079783171415
distance x is tensor(165.3312, device='cuda:3')
benign distance is  tensor(165.3312, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9023759877309203
distance x is tensor(134.1501, device='cuda:3')
benign distance is  tensor(134.1501, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.693252744153142
distance x is tensor(99.3199, device='cuda:3')
benign distance is  tensor(99.3199, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3257722463458776
distance x is tensor(108.1540, device='cuda:3')
benign distance is  tensor(108.1540, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.742925975471735
distance x is tensor(84.8863, device='cuda:3')
benign distance is  tensor(84.8863, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.82200000016
mal_loss is 0.8095671236515045
mal_entropy is 0.15359563287347555
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 544.8976,  504.9340,  508.9522,  720.4637,  618.2515,  429.9031,
         487.7133,  381.1661,  381.1661,  381.1661,  381.1661,  381.1661,
         381.1661,  381.1661,  381.1661,  381.1661,  381.1661,  381.1661,
         381.1661,  381.1661,  641.3873,  536.1776,  667.5859,  645.6923,
         666.7194, 1000.0315,  638.9939,  736.6744,  561.4963,  611.1030,
         461.2351,  609.6414,  768.4760,  441.1804,  687.1914,  573.9303],
       device='cuda:3')
sorted_norm is   tensor([ 381.1661,  381.1661,  381.1661,  381.1661,  381.1661,  381.1661,
         381.1661,  381.1661,  381.1661,  381.1661,  381.1661,  381.1661,
         381.1661,  429.9031,  441.1804,  461.2351,  487.7133,  504.9340,
         508.9522,  536.1776,  544.8976,  561.4963,  573.9303,  609.6414,
         611.1030,  618.2515,  638.9939,  641.3873,  645.6923,  666.7194,
         667.5859,  687.1914,  720.4637,  736.6744,  768.4760, 1000.0315],
       device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  5, 33, 30,  6,  1,
         2, 21,  0, 28, 35, 31, 29,  4, 26, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 91.17% 

Test Accuracy: 87.32% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8512038886547089
distance x is tensor(134.9702, device='cuda:3')
benign distance is  tensor(134.9702, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9255614914000034
distance x is tensor(106.3135, device='cuda:3')
benign distance is  tensor(106.3135, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.657711491920054
distance x is tensor(109.5093, device='cuda:3')
benign distance is  tensor(109.5093, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9023102102801204
distance x is tensor(165.1194, device='cuda:3')
benign distance is  tensor(165.1194, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9132462134584785
distance x is tensor(96.7100, device='cuda:3')
benign distance is  tensor(96.7100, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6158283767290413
distance x is tensor(104.2912, device='cuda:3')
benign distance is  tensor(104.2912, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9974723551422358
distance x is tensor(121.4162, device='cuda:3')
benign distance is  tensor(121.4162, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7645234894007444
distance x is tensor(55.7621, device='cuda:3')
benign distance is  tensor(55.7621, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.080263925716281
distance x is tensor(103.7041, device='cuda:3')
benign distance is  tensor(103.7041, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6459910529665649
distance x is tensor(120.2826, device='cuda:3')
benign distance is  tensor(120.2826, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9188141413033009
distance x is tensor(83.8562, device='cuda:3')
benign distance is  tensor(83.8562, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.307176560163498
distance x is tensor(122.1312, device='cuda:3')
benign distance is  tensor(122.1312, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2705916725099087
distance x is tensor(163.3845, device='cuda:3')
benign distance is  tensor(163.3845, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9023565705865622
distance x is tensor(72.9149, device='cuda:3')
benign distance is  tensor(72.9149, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9279664251953363
distance x is tensor(152.4322, device='cuda:3')
benign distance is  tensor(152.4322, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1840602196753025
distance x is tensor(124.3074, device='cuda:3')
benign distance is  tensor(124.3074, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0431758128106594
distance x is tensor(132.4946, device='cuda:3')
benign distance is  tensor(132.4946, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6033690366894007
distance x is tensor(86.1751, device='cuda:3')
benign distance is  tensor(86.1751, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.89377854578197
distance x is tensor(138.6507, device='cuda:3')
benign distance is  tensor(138.6507, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.4973752684891224
distance x is tensor(118.6644, device='cuda:3')
benign distance is  tensor(118.6644, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.825137922540307
distance x is tensor(129.1125, device='cuda:3')
benign distance is  tensor(129.1125, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8418581150472164
distance x is tensor(113.7944, device='cuda:3')
benign distance is  tensor(113.7944, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5405336823314428
distance x is tensor(134.1133, device='cuda:3')
benign distance is  tensor(134.1133, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7561892382800579
distance x is tensor(179.7758, device='cuda:3')
benign distance is  tensor(179.7758, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.78600000016
mal_loss is 0.7397014498710632
mal_entropy is 0.2705750446766615
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([591.6697, 505.2126, 494.3658, 736.8882, 432.1088, 465.9261, 522.8102,
        255.1044, 798.6855, 798.6854, 798.6855, 798.6854, 798.6855, 798.6854,
        798.6855, 798.6854, 798.6855, 798.6854, 798.6855, 798.6854, 590.0494,
        536.9187, 577.4101, 612.7816, 424.8387, 951.3000, 709.8912, 522.0729],
       device='cuda:3')
sorted_norm is   tensor([255.1044, 424.8387, 432.1088, 465.9261, 494.3658, 505.2126, 522.0729,
        522.8102, 536.9187, 577.4101, 590.0494, 591.6697, 612.7816, 709.8912,
        736.8882, 798.6854, 798.6854, 798.6854, 798.6854, 798.6854, 798.6854,
        798.6855, 798.6855, 798.6855, 798.6855, 798.6855, 798.6855, 951.3000],
       device='cuda:3')
used idx is  tensor([ 7, 24,  4,  5,  2,  1, 27,  6, 21, 22, 20,  0, 23, 26,  3, 17, 19,  9,
        13, 15, 11, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.50% 

Test Accuracy: 87.66% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6944230981171131
distance x is tensor(104.8646, device='cuda:3')
benign distance is  tensor(104.8646, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7071551755070686
distance x is tensor(106.4439, device='cuda:3')
benign distance is  tensor(106.4439, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.64984798617661
distance x is tensor(109.0593, device='cuda:3')
benign distance is  tensor(109.0593, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.031686220318079
distance x is tensor(150.3230, device='cuda:3')
benign distance is  tensor(150.3230, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7203175369650126
distance x is tensor(84.8408, device='cuda:3')
benign distance is  tensor(84.8408, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7459068149328232
distance x is tensor(105.6777, device='cuda:3')
benign distance is  tensor(105.6777, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4797769449651241
distance x is tensor(90.6990, device='cuda:3')
benign distance is  tensor(90.6990, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6986533235758543
distance x is tensor(68.5606, device='cuda:3')
benign distance is  tensor(68.5606, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.8673608638346195
distance x is tensor(101.1825, device='cuda:3')
benign distance is  tensor(101.1825, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9707930311560631
distance x is tensor(113.1319, device='cuda:3')
benign distance is  tensor(113.1319, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9008401371538639
distance x is tensor(125.4898, device='cuda:3')
benign distance is  tensor(125.4898, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.862577660009265
distance x is tensor(118.8848, device='cuda:3')
benign distance is  tensor(118.8848, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9318685531616211
distance x is tensor(72.3230, device='cuda:3')
benign distance is  tensor(72.3230, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8421384245157242
distance x is tensor(211.9389, device='cuda:3')
benign distance is  tensor(211.9389, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1050515808165073
distance x is tensor(145.3183, device='cuda:3')
benign distance is  tensor(145.3183, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6532400008291006
distance x is tensor(111.0562, device='cuda:3')
benign distance is  tensor(111.0562, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8080000001600001
mal_loss is 0.6962692830711603
mal_entropy is 0.23496553488075733
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([472.8246, 486.8364, 489.5283, 672.0787, 368.6207, 462.8793, 404.6956,
        303.0788, 489.0928, 489.0929, 489.0928, 489.0929, 489.0928, 489.0929,
        489.0928, 489.0929, 489.0928, 489.0929, 489.0928, 489.0929, 664.3638,
        543.0380, 729.6467, 646.9321, 586.6030, 560.7111, 520.9303, 514.9407,
        544.1295, 608.8766, 467.1634, 605.9249, 763.0027, 422.8699, 717.5323,
        624.2249], device='cuda:3')
sorted_norm is   tensor([303.0788, 368.6207, 404.6956, 422.8699, 462.8793, 467.1634, 472.8246,
        486.8364, 489.0928, 489.0928, 489.0928, 489.0928, 489.0928, 489.0928,
        489.0929, 489.0929, 489.0929, 489.0929, 489.0929, 489.0929, 489.5283,
        514.9407, 520.9303, 543.0380, 544.1295, 560.7111, 586.6030, 605.9249,
        608.8766, 624.2249, 646.9321, 664.3638, 672.0787, 717.5323, 729.6467,
        763.0027], device='cuda:3')
used idx is  tensor([ 7,  4,  6, 33,  5, 30,  0,  1, 10, 14, 12,  8, 18, 16, 17, 11,  9, 13,
        15, 19,  2, 27, 26, 21, 28, 25, 24, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.84% 

Test Accuracy: 87.18% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.754528222605586
distance x is tensor(112.7165, device='cuda:3')
benign distance is  tensor(112.7165, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.799638319760561
distance x is tensor(100.4968, device='cuda:3')
benign distance is  tensor(100.4968, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7440876010805368
distance x is tensor(110.7582, device='cuda:3')
benign distance is  tensor(110.7582, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1432467587292194
distance x is tensor(159.7861, device='cuda:3')
benign distance is  tensor(159.7861, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.911654070019722
distance x is tensor(84.1178, device='cuda:3')
benign distance is  tensor(84.1178, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7504110187292099
distance x is tensor(99.7693, device='cuda:3')
benign distance is  tensor(99.7693, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0643238388001919
distance x is tensor(97.0079, device='cuda:3')
benign distance is  tensor(97.0079, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6938095893710852
distance x is tensor(68.1591, device='cuda:3')
benign distance is  tensor(68.1591, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9814814645797014
distance x is tensor(103.9079, device='cuda:3')
benign distance is  tensor(103.9079, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.664023180026561
distance x is tensor(124.0993, device='cuda:3')
benign distance is  tensor(124.0993, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0014673415571451
distance x is tensor(70.1067, device='cuda:3')
benign distance is  tensor(70.1067, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9178517032414675
distance x is tensor(116.7979, device='cuda:3')
benign distance is  tensor(116.7979, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.142180223017931
distance x is tensor(200.3226, device='cuda:3')
benign distance is  tensor(200.3226, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7416200675070286
distance x is tensor(64.8617, device='cuda:3')
benign distance is  tensor(64.8617, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8851470733061433
distance x is tensor(150.2236, device='cuda:3')
benign distance is  tensor(150.2236, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.139525705948472
distance x is tensor(119.6725, device='cuda:3')
benign distance is  tensor(119.6725, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6211540754884481
distance x is tensor(120.6048, device='cuda:3')
benign distance is  tensor(120.6048, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9248646050691605
distance x is tensor(108.1315, device='cuda:3')
benign distance is  tensor(108.1315, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.67575460113585
distance x is tensor(146.2182, device='cuda:3')
benign distance is  tensor(146.2182, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3253387436270714
distance x is tensor(127.4552, device='cuda:3')
benign distance is  tensor(127.4552, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7679303754121065
distance x is tensor(116.0724, device='cuda:3')
benign distance is  tensor(116.0724, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.853499349206686
distance x is tensor(91.8606, device='cuda:3')
benign distance is  tensor(91.8606, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6970120258629322
distance x is tensor(89.5580, device='cuda:3')
benign distance is  tensor(89.5580, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8179765436798334
distance x is tensor(118.4238, device='cuda:3')
benign distance is  tensor(118.4238, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.82400000016
mal_loss is 0.8100209515541792
mal_entropy is 0.14207079587504268
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([497.9564, 462.2002, 504.6221, 709.2580, 375.4380, 433.4185, 433.7160,
        302.2795, 530.4514, 530.4514, 530.4514, 530.4514, 530.4514, 530.4514,
        530.4514, 530.4514, 530.4514, 530.4514, 530.4514, 530.4514],
       device='cuda:3')
sorted_norm is   tensor([302.2795, 375.4380, 433.4185, 433.7160, 462.2002, 497.9564, 504.6221,
        530.4514, 530.4514, 530.4514, 530.4514, 530.4514, 530.4514, 530.4514,
        530.4514, 530.4514, 530.4514, 530.4514, 530.4514, 709.2580],
       device='cuda:3')
used idx is  tensor([ 7,  4,  5,  6,  1,  0,  2, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 95.01% 

Test Accuracy: 87.14% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8236735798418522
distance x is tensor(136.5606, device='cuda:3')
benign distance is  tensor(136.5606, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.906721718609333
distance x is tensor(115.5796, device='cuda:3')
benign distance is  tensor(115.5796, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7618918940424919
distance x is tensor(125.0953, device='cuda:3')
benign distance is  tensor(125.0953, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1216568611562252
distance x is tensor(159.7279, device='cuda:3')
benign distance is  tensor(159.7279, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9233905859291553
distance x is tensor(116.4880, device='cuda:3')
benign distance is  tensor(116.4880, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5973309655673802
distance x is tensor(108.1516, device='cuda:3')
benign distance is  tensor(108.1516, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0739905051887035
distance x is tensor(110.9293, device='cuda:3')
benign distance is  tensor(110.9293, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7216869480907917
distance x is tensor(75.5163, device='cuda:3')
benign distance is  tensor(75.5163, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85800000016
mal_loss is 0.671773417852819
mal_entropy is 0.12934332620352507
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([600.5009, 535.8897, 557.6729, 714.4722, 508.4957, 472.0676, 508.0180,
        336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 336.6208,
        336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 658.6393,
        752.3287, 737.3032, 601.1680, 829.9200, 703.7280, 615.2349, 601.2217,
        717.6979, 557.6970, 744.2012, 683.4144, 705.2505, 661.1726, 740.0795,
        742.8428, 599.1158, 610.4175, 654.0051, 646.5945, 483.3077, 992.9125,
        730.2280, 445.7753, 537.8672, 629.5874, 437.9821, 608.4699, 932.2126,
        411.3384, 721.5075, 605.7766], device='cuda:3')
sorted_norm is   tensor([336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 336.6208,
        336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 336.6208, 411.3384,
        437.9821, 445.7753, 472.0676, 483.3077, 508.0180, 508.4957, 535.8897,
        537.8672, 557.6729, 557.6970, 599.1158, 600.5009, 601.1680, 601.2217,
        605.7766, 608.4699, 610.4175, 615.2349, 629.5874, 646.5945, 654.0051,
        658.6393, 661.1726, 683.4144, 703.7280, 705.2505, 714.4722, 717.6979,
        721.5075, 730.2280, 737.3032, 740.0795, 742.8428, 744.2012, 752.3287,
        829.9200, 932.2126, 992.9125], device='cuda:3')
used idx is  tensor([11, 19, 13, 17, 15,  9,  7, 16, 14, 12, 10,  8, 18, 49, 46, 43,  5, 40,
         6,  4,  1, 44,  2, 29, 36,  0, 23, 27, 51, 47, 37, 26, 45, 39, 38, 20,
        33, 31, 25, 32,  3], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 90.64% 

Test Accuracy: 87.94% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6639166502282023
distance x is tensor(122.7005, device='cuda:3')
benign distance is  tensor(122.7005, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.718481594696641
distance x is tensor(102.9836, device='cuda:3')
benign distance is  tensor(102.9836, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9098309725522995
distance x is tensor(106.3974, device='cuda:3')
benign distance is  tensor(106.3974, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9769916962832212
distance x is tensor(164.0928, device='cuda:3')
benign distance is  tensor(164.0928, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8063624538481236
distance x is tensor(87.2062, device='cuda:3')
benign distance is  tensor(87.2062, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8655408276244998
distance x is tensor(106.3438, device='cuda:3')
benign distance is  tensor(106.3438, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3832941614091396
distance x is tensor(95.4943, device='cuda:3')
benign distance is  tensor(95.4943, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7381775230169296
distance x is tensor(51.8971, device='cuda:3')
benign distance is  tensor(51.8971, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.146160528063774
distance x is tensor(103.1804, device='cuda:3')
benign distance is  tensor(103.1804, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6414944604039192
distance x is tensor(129.2232, device='cuda:3')
benign distance is  tensor(129.2232, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9357453472912312
distance x is tensor(73.1945, device='cuda:3')
benign distance is  tensor(73.1945, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2181094121187925
distance x is tensor(113.9441, device='cuda:3')
benign distance is  tensor(113.9441, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.77754682675004
distance x is tensor(165.1366, device='cuda:3')
benign distance is  tensor(165.1366, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5878224801272154
distance x is tensor(53.5499, device='cuda:3')
benign distance is  tensor(53.5499, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8625836297869682
distance x is tensor(131.0761, device='cuda:3')
benign distance is  tensor(131.0761, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2550813853740692
distance x is tensor(114.7099, device='cuda:3')
benign distance is  tensor(114.7099, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9742132276296616
distance x is tensor(90.4579, device='cuda:3')
benign distance is  tensor(90.4579, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.670679610222578
distance x is tensor(110.5375, device='cuda:3')
benign distance is  tensor(110.5375, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8727994803339243
distance x is tensor(124.0905, device='cuda:3')
benign distance is  tensor(124.0905, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7418428119271994
distance x is tensor(123.9438, device='cuda:3')
benign distance is  tensor(123.9438, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9992374628782272
distance x is tensor(74.5379, device='cuda:3')
benign distance is  tensor(74.5379, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7060489635914564
distance x is tensor(216.8593, device='cuda:3')
benign distance is  tensor(216.8593, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2146354131400585
distance x is tensor(157.3679, device='cuda:3')
benign distance is  tensor(157.3679, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6288586463779211
distance x is tensor(78.2000, device='cuda:3')
benign distance is  tensor(78.2000, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1465383879840374
distance x is tensor(129.7027, device='cuda:3')
benign distance is  tensor(129.7027, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6667210925370455
distance x is tensor(80.9748, device='cuda:3')
benign distance is  tensor(80.9748, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8478159513324499
distance x is tensor(122.4527, device='cuda:3')
benign distance is  tensor(122.4527, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1995913051068783
distance x is tensor(116.4401, device='cuda:3')
benign distance is  tensor(116.4401, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7316729873418808
distance x is tensor(129.7442, device='cuda:3')
benign distance is  tensor(129.7442, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7502637216821313
distance x is tensor(113.5160, device='cuda:3')
benign distance is  tensor(113.5160, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5607185317203403
distance x is tensor(115.8352, device='cuda:3')
benign distance is  tensor(115.8352, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7248885072767735
distance x is tensor(168.7871, device='cuda:3')
benign distance is  tensor(168.7871, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.061913937330246
distance x is tensor(108.1744, device='cuda:3')
benign distance is  tensor(108.1744, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.0294928792864084
distance x is tensor(144.1432, device='cuda:3')
benign distance is  tensor(144.1432, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0287540070712566
distance x is tensor(141.2654, device='cuda:3')
benign distance is  tensor(141.2654, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0876104682683945
distance x is tensor(93.1780, device='cuda:3')
benign distance is  tensor(93.1780, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6083221836015582
distance x is tensor(159.7816, device='cuda:3')
benign distance is  tensor(159.7816, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8328527361154556
distance x is tensor(137.5093, device='cuda:3')
benign distance is  tensor(137.5093, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7122612372040749
distance x is tensor(114.3876, device='cuda:3')
benign distance is  tensor(114.3876, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5744819957762957
distance x is tensor(105.5939, device='cuda:3')
benign distance is  tensor(105.5939, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85000000016
mal_loss is 0.603262996301055
mal_entropy is 0.1455138004384935
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([547.4669, 478.4297, 478.2645, 724.8116, 390.4490, 460.8549, 422.7972,
        231.2285, 460.1296, 460.1296, 460.1296, 460.1296, 460.1296, 460.1296,
        460.1296, 460.1296, 460.1296, 460.1296, 460.1296, 460.1296],
       device='cuda:3')
sorted_norm is   tensor([231.2285, 390.4490, 422.7972, 460.1296, 460.1296, 460.1296, 460.1296,
        460.1296, 460.1296, 460.1296, 460.1296, 460.1296, 460.1296, 460.1296,
        460.1296, 460.8549, 478.2645, 478.4297, 547.4669, 724.8116],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6, 19, 15, 18, 16, 17, 13, 12, 14,  9,  8, 11, 10,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 91.77% 

Test Accuracy: 86.93% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9141709916293621
distance x is tensor(124.3419, device='cuda:3')
benign distance is  tensor(124.3419, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9151976369321346
distance x is tensor(113.2849, device='cuda:3')
benign distance is  tensor(113.2849, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7375854682177305
distance x is tensor(138.9920, device='cuda:3')
benign distance is  tensor(138.9920, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8364363815635443
distance x is tensor(162.4549, device='cuda:3')
benign distance is  tensor(162.4549, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9744143765419722
distance x is tensor(92.6523, device='cuda:3')
benign distance is  tensor(92.6523, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6163629963994026
distance x is tensor(118.1102, device='cuda:3')
benign distance is  tensor(118.1102, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2184092439711094
distance x is tensor(123.2065, device='cuda:3')
benign distance is  tensor(123.2065, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6526506934314966
distance x is tensor(82.0112, device='cuda:3')
benign distance is  tensor(82.0112, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85400000016
mal_loss is 0.6259703114628792
mal_entropy is 0.13585728034377098
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([556.5270, 520.7756, 615.0657, 711.7747, 396.7413, 502.7404, 537.6821,
        361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 361.6220,
        361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 561.5446,
        677.0524, 478.4996, 604.9941, 810.5212, 422.1389, 673.1509, 618.8188],
       device='cuda:3')
sorted_norm is   tensor([361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 361.6220,
        361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 361.6220, 396.7413,
        422.1389, 478.4996, 502.7404, 520.7756, 537.6821, 556.5270, 561.5446,
        604.9941, 615.0657, 618.8188, 673.1509, 677.0524, 711.7747, 810.5212],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14,  7, 11, 10,  8,  9, 15,  4, 25, 22,  5,  1,
         6,  0, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.85% 

Test Accuracy: 87.09% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8019247818738222
distance x is tensor(129.9541, device='cuda:3')
benign distance is  tensor(129.9541, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9412877298891544
distance x is tensor(112.7483, device='cuda:3')
benign distance is  tensor(112.7483, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7713193781673908
distance x is tensor(123.6637, device='cuda:3')
benign distance is  tensor(123.6637, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9267836716026068
distance x is tensor(161.7499, device='cuda:3')
benign distance is  tensor(161.7499, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9522857312113047
distance x is tensor(104.8636, device='cuda:3')
benign distance is  tensor(104.8636, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9159199325367808
distance x is tensor(110.6812, device='cuda:3')
benign distance is  tensor(110.6812, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4514244236052036
distance x is tensor(120.0153, device='cuda:3')
benign distance is  tensor(120.0153, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6917738695628941
distance x is tensor(41.7963, device='cuda:3')
benign distance is  tensor(41.7963, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8525888314470649
distance x is tensor(107.7105, device='cuda:3')
benign distance is  tensor(107.7105, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7816176060587168
distance x is tensor(153.4207, device='cuda:3')
benign distance is  tensor(153.4207, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.059841638430953
distance x is tensor(90.8948, device='cuda:3')
benign distance is  tensor(90.8948, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3908673450350761
distance x is tensor(124.2354, device='cuda:3')
benign distance is  tensor(124.2354, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8380055967718363
distance x is tensor(187.2643, device='cuda:3')
benign distance is  tensor(187.2643, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9906319957226515
distance x is tensor(73.8530, device='cuda:3')
benign distance is  tensor(73.8530, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8849014602601528
distance x is tensor(150.9750, device='cuda:3')
benign distance is  tensor(150.9750, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2630547061562538
distance x is tensor(143.4195, device='cuda:3')
benign distance is  tensor(143.4195, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.77000000016
mal_loss is 1.1935632824897766
mal_entropy is 0.20753865875303745
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 584.1258,  519.3849,  550.6249,  709.6594,  461.0683,  479.0756,
         530.5643,  178.2775,  637.2795,  637.2795,  637.2795,  637.2795,
         637.2795,  637.2795,  637.2795,  637.2795,  637.2795,  637.2795,
         637.2795,  637.2795,  662.3558,  616.3918,  761.4587,  698.4144,
         633.9270,  574.7551,  568.1011,  553.7966,  524.7970,  590.2072,
         621.3418,  651.6620,  460.9849, 1004.8035,  766.6844,  486.0417],
       device='cuda:3')
sorted_norm is   tensor([ 178.2775,  460.9849,  461.0683,  479.0756,  486.0417,  519.3849,
         524.7970,  530.5643,  550.6249,  553.7966,  568.1011,  574.7551,
         584.1258,  590.2072,  616.3918,  621.3418,  633.9270,  637.2795,
         637.2795,  637.2795,  637.2795,  637.2795,  637.2795,  637.2795,
         637.2795,  637.2795,  637.2795,  637.2795,  637.2795,  651.6620,
         662.3558,  698.4144,  709.6594,  761.4587,  766.6844, 1004.8035],
       device='cuda:3')
used idx is  tensor([ 7, 32,  4,  5, 35,  1, 28,  6,  2, 27, 26, 25,  0, 29, 21, 30, 24, 16,
        17, 18, 15, 11, 14,  8, 13, 12, 19, 10], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 88.37% 

Test Accuracy: 86.61% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8049492351710796
distance x is tensor(110.2422, device='cuda:3')
benign distance is  tensor(110.2422, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8054496068507433
distance x is tensor(116.6186, device='cuda:3')
benign distance is  tensor(116.6186, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6472076252102852
distance x is tensor(112.3346, device='cuda:3')
benign distance is  tensor(112.3346, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7154929209500551
distance x is tensor(150.6898, device='cuda:3')
benign distance is  tensor(150.6898, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0217606741935015
distance x is tensor(94.2657, device='cuda:3')
benign distance is  tensor(94.2657, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.609523176215589
distance x is tensor(104.3027, device='cuda:3')
benign distance is  tensor(104.3027, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0604949928820133
distance x is tensor(89.4255, device='cuda:3')
benign distance is  tensor(89.4255, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.717530645430088
distance x is tensor(63.0713, device='cuda:3')
benign distance is  tensor(63.0713, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0685200355947018
distance x is tensor(103.0625, device='cuda:3')
benign distance is  tensor(103.0625, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7263292167335749
distance x is tensor(113.9650, device='cuda:3')
benign distance is  tensor(113.9650, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.011475233361125
distance x is tensor(122.4965, device='cuda:3')
benign distance is  tensor(122.4965, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9584791045635939
distance x is tensor(124.8108, device='cuda:3')
benign distance is  tensor(124.8108, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9132222551852465
distance x is tensor(78.4348, device='cuda:3')
benign distance is  tensor(78.4348, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7515484597533941
distance x is tensor(216.2462, device='cuda:3')
benign distance is  tensor(216.2462, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9704124853014946
distance x is tensor(158.1442, device='cuda:3')
benign distance is  tensor(158.1442, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7532765045762062
distance x is tensor(92.3657, device='cuda:3')
benign distance is  tensor(92.3657, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7183942999690771
distance x is tensor(132.9322, device='cuda:3')
benign distance is  tensor(132.9322, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7416930552572012
distance x is tensor(100.7285, device='cuda:3')
benign distance is  tensor(100.7285, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7386691197752953
distance x is tensor(148.1249, device='cuda:3')
benign distance is  tensor(148.1249, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3107115253806114
distance x is tensor(129.2651, device='cuda:3')
benign distance is  tensor(129.2651, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8802941404283047
distance x is tensor(129.1585, device='cuda:3')
benign distance is  tensor(129.1585, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8689862657338381
distance x is tensor(99.9283, device='cuda:3')
benign distance is  tensor(99.9283, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7119926624000072
distance x is tensor(93.9763, device='cuda:3')
benign distance is  tensor(93.9763, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6859551928937435
distance x is tensor(113.4342, device='cuda:3')
benign distance is  tensor(113.4342, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.82700000016
mal_loss is 0.6713749151676893
mal_entropy is 0.1778100924566388
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([486.2396, 532.1614, 501.3068, 669.4474, 418.3805, 460.3290, 395.1537,
        271.6912, 499.0312, 499.0312, 499.0312, 499.0312, 499.0312, 499.0312,
        499.0312, 499.0312, 499.0312, 499.0312, 499.0312, 499.0312, 646.7869,
        490.9164, 624.7097, 615.3224, 641.9982, 611.6578, 609.2720, 827.7526,
        550.0650, 710.9015, 476.3633, 610.4084, 853.2689, 430.0740, 688.6674,
        404.2768], device='cuda:3')
sorted_norm is   tensor([271.6912, 395.1537, 404.2768, 418.3805, 430.0740, 460.3290, 476.3633,
        486.2396, 490.9164, 499.0312, 499.0312, 499.0312, 499.0312, 499.0312,
        499.0312, 499.0312, 499.0312, 499.0312, 499.0312, 499.0312, 499.0312,
        501.3068, 532.1614, 550.0650, 609.2720, 610.4084, 611.6578, 615.3224,
        624.7097, 641.9982, 646.7869, 669.4474, 688.6674, 710.9015, 827.7526,
        853.2689], device='cuda:3')
used idx is  tensor([ 7,  6, 35,  4, 33,  5, 30,  0, 21, 14, 15, 12, 19, 17, 16, 18, 13, 10,
         8, 11,  9,  2,  1, 28, 26, 31, 25, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 94.97% 

Test Accuracy: 88.83% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8302753120660782
distance x is tensor(132.1553, device='cuda:3')
benign distance is  tensor(132.1553, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.845875509083271
distance x is tensor(102.4066, device='cuda:3')
benign distance is  tensor(102.4066, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6943525783717632
distance x is tensor(115.6062, device='cuda:3')
benign distance is  tensor(115.6062, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9084906857460737
distance x is tensor(147.7780, device='cuda:3')
benign distance is  tensor(147.7780, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9960249522700906
distance x is tensor(92.0244, device='cuda:3')
benign distance is  tensor(92.0244, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8433196377009153
distance x is tensor(106.9782, device='cuda:3')
benign distance is  tensor(106.9782, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0733829345554113
distance x is tensor(87.2491, device='cuda:3')
benign distance is  tensor(87.2491, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7231036555022001
distance x is tensor(54.5544, device='cuda:3')
benign distance is  tensor(54.5544, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9265639632940292
distance x is tensor(107.1723, device='cuda:3')
benign distance is  tensor(107.1723, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6328417006880045
distance x is tensor(139.5309, device='cuda:3')
benign distance is  tensor(139.5309, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9310504179447889
distance x is tensor(75.1495, device='cuda:3')
benign distance is  tensor(75.1495, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1560267210006714
distance x is tensor(117.4256, device='cuda:3')
benign distance is  tensor(117.4256, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0688617154955864
distance x is tensor(186.3818, device='cuda:3')
benign distance is  tensor(186.3818, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7844739044085145
distance x is tensor(64.8126, device='cuda:3')
benign distance is  tensor(64.8126, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9599827751517296
distance x is tensor(142.1918, device='cuda:3')
benign distance is  tensor(142.1918, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.309530645608902
distance x is tensor(114.1113, device='cuda:3')
benign distance is  tensor(114.1113, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9909848943352699
distance x is tensor(128.2585, device='cuda:3')
benign distance is  tensor(128.2585, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6225257571786642
distance x is tensor(94.0106, device='cuda:3')
benign distance is  tensor(94.0106, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9881523922085762
distance x is tensor(144.0788, device='cuda:3')
benign distance is  tensor(144.0788, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.6521506235003471
distance x is tensor(111.3891, device='cuda:3')
benign distance is  tensor(111.3891, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7930763959884644
distance x is tensor(118.8079, device='cuda:3')
benign distance is  tensor(118.8079, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7907683365046978
distance x is tensor(117.0868, device='cuda:3')
benign distance is  tensor(117.0868, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5618814565241337
distance x is tensor(119.0528, device='cuda:3')
benign distance is  tensor(119.0528, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7036231644451618
distance x is tensor(188.3184, device='cuda:3')
benign distance is  tensor(188.3184, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8080000001600001
mal_loss is 0.6686125043779612
mal_entropy is 0.2502213157713413
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([599.6805, 464.9599, 519.6142, 655.6282, 395.9537, 466.5381, 386.1978,
        241.4100, 828.2635, 828.2635, 828.2635, 828.2635, 828.2635, 828.2635,
        828.2635, 828.2635, 828.2635, 828.2635, 828.2635, 828.2635],
       device='cuda:3')
sorted_norm is   tensor([241.4100, 386.1978, 395.9537, 464.9599, 466.5381, 519.6142, 599.6805,
        655.6282, 828.2635, 828.2635, 828.2635, 828.2635, 828.2635, 828.2635,
        828.2635, 828.2635, 828.2635, 828.2635, 828.2635, 828.2635],
       device='cuda:3')
used idx is  tensor([ 7,  6,  4,  1,  5,  2,  0,  3, 19, 17, 13, 15, 11,  9, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 92.83% 

Test Accuracy: 87.73% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8151364866644144
distance x is tensor(126.6683, device='cuda:3')
benign distance is  tensor(126.6683, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8589237462729216
distance x is tensor(108.0198, device='cuda:3')
benign distance is  tensor(108.0198, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7453150637447834
distance x is tensor(107.1668, device='cuda:3')
benign distance is  tensor(107.1668, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3916558995842934
distance x is tensor(151.9639, device='cuda:3')
benign distance is  tensor(151.9639, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9339957535266876
distance x is tensor(92.5343, device='cuda:3')
benign distance is  tensor(92.5343, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6803008825518191
distance x is tensor(105.0763, device='cuda:3')
benign distance is  tensor(105.0763, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.26555834710598
distance x is tensor(100.6672, device='cuda:3')
benign distance is  tensor(100.6672, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7465715371072292
distance x is tensor(74.0630, device='cuda:3')
benign distance is  tensor(74.0630, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.84600000016
mal_loss is 0.7899500466883183
mal_entropy is 0.12100807204842567
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 553.0818,  500.7418,  485.9694,  670.7089,  410.2545,  463.9423,
         442.5713,  317.4770,  317.4770,  317.4770,  317.4770,  317.4770,
         317.4770,  317.4770,  317.4770,  317.4770,  317.4770,  317.4770,
         317.4770,  317.4770,  708.4199,  824.9783,  812.9826,  669.9369,
         881.3071,  803.2801,  728.6283,  614.0299,  675.3723,  676.2419,
         703.3301,  709.1044,  572.6946, 1038.0253,  834.8133,  627.8230,
         635.0844,  750.6321,  540.7314,  665.0402,  911.3259,  502.8036,
         748.2108,  663.7573], device='cuda:3')
sorted_norm is   tensor([ 317.4770,  317.4770,  317.4770,  317.4770,  317.4770,  317.4770,
         317.4770,  317.4770,  317.4770,  317.4770,  317.4770,  317.4770,
         317.4770,  410.2545,  442.5713,  463.9423,  485.9694,  500.7418,
         502.8036,  540.7314,  553.0818,  572.6946,  614.0299,  627.8230,
         635.0844,  663.7573,  665.0402,  669.9369,  670.7089,  675.3723,
         676.2419,  703.3301,  708.4199,  709.1044,  728.6283,  748.2108,
         750.6321,  803.2801,  812.9826,  824.9783,  834.8133,  881.3071,
         911.3259, 1038.0253], device='cuda:3')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19,  7, 13,  9, 15, 11,  4,  6,  5,  2,  1,
        41, 38,  0, 32, 27, 35, 36, 43, 39, 23,  3, 28, 29, 30, 20, 31, 26],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 90.04% 

Test Accuracy: 87.80% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8918094243854284
distance x is tensor(128.1207, device='cuda:3')
benign distance is  tensor(128.1207, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8935815636068583
distance x is tensor(108.8590, device='cuda:3')
benign distance is  tensor(108.8590, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7208161056041718
distance x is tensor(113.8434, device='cuda:3')
benign distance is  tensor(113.8434, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0500061102211475
distance x is tensor(162.2968, device='cuda:3')
benign distance is  tensor(162.2968, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9028171636164188
distance x is tensor(93.1312, device='cuda:3')
benign distance is  tensor(93.1312, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6306803431361914
distance x is tensor(110.4641, device='cuda:3')
benign distance is  tensor(110.4641, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9258531536906958
distance x is tensor(86.6713, device='cuda:3')
benign distance is  tensor(86.6713, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7263725129887462
distance x is tensor(57.2483, device='cuda:3')
benign distance is  tensor(57.2483, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1181526072323322
distance x is tensor(103.0020, device='cuda:3')
benign distance is  tensor(103.0020, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.590634792111814
distance x is tensor(129.5839, device='cuda:3')
benign distance is  tensor(129.5839, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.340310100466013
distance x is tensor(79.7694, device='cuda:3')
benign distance is  tensor(79.7694, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3203614503145218
distance x is tensor(115.2795, device='cuda:3')
benign distance is  tensor(115.2795, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8773161629214883
distance x is tensor(166.6181, device='cuda:3')
benign distance is  tensor(166.6181, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7436565421521664
distance x is tensor(64.4794, device='cuda:3')
benign distance is  tensor(64.4794, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9695382043719292
distance x is tensor(138.7942, device='cuda:3')
benign distance is  tensor(138.7942, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7592921033501625
distance x is tensor(118.8591, device='cuda:3')
benign distance is  tensor(118.8591, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9174442496150732
distance x is tensor(94.9187, device='cuda:3')
benign distance is  tensor(94.9187, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9316551145166159
distance x is tensor(111.7488, device='cuda:3')
benign distance is  tensor(111.7488, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0572857223451138
distance x is tensor(146.0131, device='cuda:3')
benign distance is  tensor(146.0131, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9907210171222687
distance x is tensor(155.0593, device='cuda:3')
benign distance is  tensor(155.0593, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0718518048524857
distance x is tensor(80.0659, device='cuda:3')
benign distance is  tensor(80.0659, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6887577632442117
distance x is tensor(216.4563, device='cuda:3')
benign distance is  tensor(216.4563, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.24674504250288
distance x is tensor(176.2984, device='cuda:3')
benign distance is  tensor(176.2984, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6399148507043719
distance x is tensor(88.7858, device='cuda:3')
benign distance is  tensor(88.7858, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2781804483383894
distance x is tensor(119.7217, device='cuda:3')
benign distance is  tensor(119.7217, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.425796914845705
distance x is tensor(143.3000, device='cuda:3')
benign distance is  tensor(143.3000, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.8820158652961254
distance x is tensor(157.2204, device='cuda:3')
benign distance is  tensor(157.2204, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9107345975935459
distance x is tensor(109.4989, device='cuda:3')
benign distance is  tensor(109.4989, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5981247015297413
distance x is tensor(170.3792, device='cuda:3')
benign distance is  tensor(170.3792, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8579608332365751
distance x is tensor(141.3458, device='cuda:3')
benign distance is  tensor(141.3458, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7605514274910092
distance x is tensor(116.1889, device='cuda:3')
benign distance is  tensor(116.1889, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6234604916535318
distance x is tensor(109.7011, device='cuda:3')
benign distance is  tensor(109.7011, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85300000016
mal_loss is 0.5579939605668187
mal_entropy is 0.15714900195598602
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([588.5464, 495.7775, 504.6332, 729.4750, 420.2705, 472.9036, 388.7118,
        260.0160, 461.8240, 461.8240, 461.8240, 461.8240, 461.8240, 461.8240,
        461.8240, 461.8240, 461.8240, 461.8240, 461.8240, 461.8240],
       device='cuda:3')
sorted_norm is   tensor([260.0160, 388.7118, 420.2705, 461.8240, 461.8240, 461.8240, 461.8240,
        461.8240, 461.8240, 461.8240, 461.8240, 461.8240, 461.8240, 461.8240,
        461.8240, 472.9036, 495.7775, 504.6332, 588.5464, 729.4750],
       device='cuda:3')
used idx is  tensor([ 7,  6,  4, 19, 15, 18, 16, 17, 13, 12, 14,  9,  8, 11, 10,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 92.63% 

Test Accuracy: 87.15% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9592471551150084
distance x is tensor(137.1449, device='cuda:3')
benign distance is  tensor(137.1449, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9607940632849932
distance x is tensor(121.3908, device='cuda:3')
benign distance is  tensor(121.3908, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8072025291621685
distance x is tensor(130.2462, device='cuda:3')
benign distance is  tensor(130.2462, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9013793617486954
distance x is tensor(180.3794, device='cuda:3')
benign distance is  tensor(180.3794, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0037947725504637
distance x is tensor(91.8206, device='cuda:3')
benign distance is  tensor(91.8206, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7199399936944246
distance x is tensor(106.7923, device='cuda:3')
benign distance is  tensor(106.7923, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7014976926147938
distance x is tensor(118.8049, device='cuda:3')
benign distance is  tensor(118.8049, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7949927877634764
distance x is tensor(70.2298, device='cuda:3')
benign distance is  tensor(70.2298, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85800000016
mal_loss is 0.7137417430058122
mal_entropy is 0.11893343739211559
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([591.9209, 556.1720, 576.3593, 799.3373, 403.5577, 462.8027, 516.1115,
        303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 303.3795,
        303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 740.0701,
        631.4668, 792.5892, 725.3621, 709.5381, 632.3628, 615.1644, 571.1523,
        708.1874, 601.1385, 758.9195, 667.0889, 673.5261, 674.5683, 672.8800,
        721.9801, 561.3417, 674.6363, 496.4812, 633.4182, 808.3489, 448.1104,
        686.4254, 626.7244], device='cuda:3')
sorted_norm is   tensor([303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 303.3795,
        303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 303.3795, 403.5577,
        448.1104, 462.8027, 496.4812, 516.1115, 556.1720, 561.3417, 571.1523,
        576.3593, 591.9209, 601.1385, 615.1644, 626.7244, 631.4668, 632.3628,
        633.4182, 667.0889, 672.8800, 673.5261, 674.5683, 674.6363, 686.4254,
        708.1874, 709.5381, 721.9801, 725.3621, 740.0701, 758.9195, 792.5892,
        799.3373, 808.3489], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  4, 41,  5, 38,  6,
         1, 36, 27,  2,  0, 29, 26, 43, 21, 25, 39, 31, 34, 32, 33, 37, 42],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 90.26% 

Test Accuracy: 88.12% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6612762399017811
distance x is tensor(110.5180, device='cuda:3')
benign distance is  tensor(110.5180, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9254866279661655
distance x is tensor(111.3918, device='cuda:3')
benign distance is  tensor(111.3918, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7489052321761847
distance x is tensor(109.7607, device='cuda:3')
benign distance is  tensor(109.7607, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1759891211986542
distance x is tensor(170.2245, device='cuda:3')
benign distance is  tensor(170.2245, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9869948262348771
distance x is tensor(86.5249, device='cuda:3')
benign distance is  tensor(86.5249, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.72884117718786
distance x is tensor(104.7877, device='cuda:3')
benign distance is  tensor(104.7877, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3309093452990055
distance x is tensor(101.0436, device='cuda:3')
benign distance is  tensor(101.0436, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8028363138437271
distance x is tensor(39.3179, device='cuda:3')
benign distance is  tensor(39.3179, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9944964069873095
distance x is tensor(109.4252, device='cuda:3')
benign distance is  tensor(109.4252, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.719058146700263
distance x is tensor(145.4365, device='cuda:3')
benign distance is  tensor(145.4365, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1193092502653599
distance x is tensor(71.4378, device='cuda:3')
benign distance is  tensor(71.4378, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7957954555749893
distance x is tensor(129.1313, device='cuda:3')
benign distance is  tensor(129.1313, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1071288473904133
distance x is tensor(234.9784, device='cuda:3')
benign distance is  tensor(234.9784, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7023787088692188
distance x is tensor(67.1283, device='cuda:3')
benign distance is  tensor(67.1283, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0850312504917383
distance x is tensor(164.4583, device='cuda:3')
benign distance is  tensor(164.4583, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.100129995495081
distance x is tensor(115.7323, device='cuda:3')
benign distance is  tensor(115.7323, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9892413932830095
distance x is tensor(124.7074, device='cuda:3')
benign distance is  tensor(124.7074, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7318298276513815
distance x is tensor(112.6325, device='cuda:3')
benign distance is  tensor(112.6325, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1467938423156738
distance x is tensor(144.0617, device='cuda:3')
benign distance is  tensor(144.0617, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3148347493261099
distance x is tensor(112.5000, device='cuda:3')
benign distance is  tensor(112.5000, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6840743143111467
distance x is tensor(123.0325, device='cuda:3')
benign distance is  tensor(123.0325, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7952301483601332
distance x is tensor(127.9061, device='cuda:3')
benign distance is  tensor(127.9061, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5820730458945036
distance x is tensor(123.5347, device='cuda:3')
benign distance is  tensor(123.5347, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7480985801666975
distance x is tensor(181.3477, device='cuda:3')
benign distance is  tensor(181.3477, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6483733598142862
distance x is tensor(135.9028, device='cuda:3')
benign distance is  tensor(135.9028, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.792620025575161
distance x is tensor(102.0573, device='cuda:3')
benign distance is  tensor(102.0573, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7046219110488892
distance x is tensor(165.0121, device='cuda:3')
benign distance is  tensor(165.0121, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.4343331158161163
distance x is tensor(136.5092, device='cuda:3')
benign distance is  tensor(136.5092, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7907538022845984
distance x is tensor(128.4767, device='cuda:3')
benign distance is  tensor(128.4767, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7579431729391217
distance x is tensor(98.8391, device='cuda:3')
benign distance is  tensor(98.8391, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8460200428962708
distance x is tensor(100.7053, device='cuda:3')
benign distance is  tensor(100.7053, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.778195196762681
distance x is tensor(116.2779, device='cuda:3')
benign distance is  tensor(116.2779, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.81700000016
mal_loss is 0.8254692126065493
mal_entropy is 0.1405521845445037
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([490.3491, 508.8195, 488.1916, 769.8693, 379.2697, 451.2372, 439.1127,
        172.9621, 508.4881, 508.4881, 508.4881, 508.4881, 508.4881, 508.4881,
        508.4881, 508.4881, 508.4881, 508.4881, 508.4881, 508.4881, 478.3245,
        554.6268, 656.7091, 707.7168, 413.2523, 969.6184, 795.6570, 456.4457],
       device='cuda:3')
sorted_norm is   tensor([172.9621, 379.2697, 413.2523, 439.1127, 451.2372, 456.4457, 478.3245,
        488.1916, 490.3491, 508.4881, 508.4881, 508.4881, 508.4881, 508.4881,
        508.4881, 508.4881, 508.4881, 508.4881, 508.4881, 508.4881, 508.4881,
        508.8195, 554.6268, 656.7091, 707.7168, 769.8693, 795.6570, 969.6184],
       device='cuda:3')
used idx is  tensor([ 7,  4, 24,  6,  5, 27, 20,  2,  0, 15, 14, 16, 19, 18, 17,  9, 13, 12,
        11, 10,  8,  1], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 95.29% 

Test Accuracy: 87.20% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7925421688705683
distance x is tensor(127.4320, device='cuda:3')
benign distance is  tensor(127.4320, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.046689011156559
distance x is tensor(122.1934, device='cuda:3')
benign distance is  tensor(122.1934, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7384239695966244
distance x is tensor(134.0730, device='cuda:3')
benign distance is  tensor(134.0730, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0794443227350712
distance x is tensor(180.5554, device='cuda:3')
benign distance is  tensor(180.5554, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9318158226087689
distance x is tensor(114.4393, device='cuda:3')
benign distance is  tensor(114.4393, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6766870887950063
distance x is tensor(114.5815, device='cuda:3')
benign distance is  tensor(114.5815, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1745395474135876
distance x is tensor(115.0015, device='cuda:3')
benign distance is  tensor(115.0015, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7557025011628866
distance x is tensor(71.4496, device='cuda:3')
benign distance is  tensor(71.4496, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.8097630776464939
distance x is tensor(111.2664, device='cuda:3')
benign distance is  tensor(111.2664, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8601185213774443
distance x is tensor(132.3161, device='cuda:3')
benign distance is  tensor(132.3161, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9803991056978703
distance x is tensor(131.5566, device='cuda:3')
benign distance is  tensor(131.5566, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0010497998446226
distance x is tensor(146.8950, device='cuda:3')
benign distance is  tensor(146.8950, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9016623366624117
distance x is tensor(102.5384, device='cuda:3')
benign distance is  tensor(102.5384, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7222849223762751
distance x is tensor(235.8271, device='cuda:3')
benign distance is  tensor(235.8271, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1267916336655617
distance x is tensor(170.7940, device='cuda:3')
benign distance is  tensor(170.7940, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7918023662641644
distance x is tensor(102.2337, device='cuda:3')
benign distance is  tensor(102.2337, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.81900000016
mal_loss is 0.890941078774631
mal_entropy is 0.1413945946842432
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 562.2739,  545.2261,  599.5547,  789.7528,  499.7638,  498.2805,
         508.7917,  310.0907,  445.5922,  445.5921,  445.5922,  445.5921,
         445.5922,  445.5921,  445.5922,  445.5921,  445.5922,  445.5921,
         445.5922,  445.5921,  546.5491,  708.7433,  428.7121,  631.1263,
        1097.9392,  414.0127,  766.6960,  587.7316], device='cuda:3')
sorted_norm is   tensor([ 310.0907,  414.0127,  428.7121,  445.5921,  445.5921,  445.5921,
         445.5921,  445.5921,  445.5921,  445.5922,  445.5922,  445.5922,
         445.5922,  445.5922,  445.5922,  498.2805,  499.7638,  508.7917,
         545.2261,  546.5491,  562.2739,  587.7316,  599.5547,  631.1263,
         708.7433,  766.6960,  789.7528, 1097.9392], device='cuda:3')
used idx is  tensor([ 7, 25, 22, 19, 13,  9, 15, 17, 11,  8, 10, 12, 16, 18, 14,  5,  4,  6,
         1, 20,  0, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.15% 

Test Accuracy: 86.98% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8010138012468815
distance x is tensor(121.1002, device='cuda:3')
benign distance is  tensor(121.1002, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9297522213310003
distance x is tensor(113.1647, device='cuda:3')
benign distance is  tensor(113.1647, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6642012502998114
distance x is tensor(129.9440, device='cuda:3')
benign distance is  tensor(129.9440, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0472381226718426
distance x is tensor(178.7616, device='cuda:3')
benign distance is  tensor(178.7616, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9513772847130895
distance x is tensor(104.2152, device='cuda:3')
benign distance is  tensor(104.2152, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8695494746789336
distance x is tensor(115.7715, device='cuda:3')
benign distance is  tensor(115.7715, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1407739520072937
distance x is tensor(106.6544, device='cuda:3')
benign distance is  tensor(106.6544, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6838469412177801
distance x is tensor(57.5391, device='cuda:3')
benign distance is  tensor(57.5391, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0097397658973932
distance x is tensor(126.9718, device='cuda:3')
benign distance is  tensor(126.9718, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6402393849566579
distance x is tensor(154.6753, device='cuda:3')
benign distance is  tensor(154.6753, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9745857082307339
distance x is tensor(99.5533, device='cuda:3')
benign distance is  tensor(99.5533, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2283853255212307
distance x is tensor(126.3329, device='cuda:3')
benign distance is  tensor(126.3329, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1714990474283695
distance x is tensor(187.5042, device='cuda:3')
benign distance is  tensor(187.5042, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.074308943003416
distance x is tensor(74.4453, device='cuda:3')
benign distance is  tensor(74.4453, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.214907843619585
distance x is tensor(157.0709, device='cuda:3')
benign distance is  tensor(157.0709, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.606461014598608
distance x is tensor(155.2850, device='cuda:3')
benign distance is  tensor(155.2850, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.72700000016
mal_loss is 1.6627972945570946
mal_entropy is 0.15564105287194252
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([527.8117, 515.9750, 569.9927, 799.9189, 449.8674, 506.8281, 483.5390,
        248.2635, 670.5232, 670.5232, 670.5232, 670.5232, 670.5232, 670.5232,
        670.5232, 670.5232, 670.5232, 670.5232, 670.5232, 670.5232],
       device='cuda:3')
sorted_norm is   tensor([248.2635, 449.8674, 483.5390, 506.8281, 515.9750, 527.8117, 569.9927,
        670.5232, 670.5232, 670.5232, 670.5232, 670.5232, 670.5232, 670.5232,
        670.5232, 670.5232, 670.5232, 670.5232, 670.5232, 799.9189],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  5,  1,  0,  2, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 82.84% 

Test Accuracy: 84.07% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8247739411890507
distance x is tensor(125.5283, device='cuda:3')
benign distance is  tensor(125.5283, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9397497177124023
distance x is tensor(112.1327, device='cuda:3')
benign distance is  tensor(112.1327, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7264484819024801
distance x is tensor(130.8628, device='cuda:3')
benign distance is  tensor(130.8628, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0176574029028416
distance x is tensor(174.9940, device='cuda:3')
benign distance is  tensor(174.9940, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9845279864966869
distance x is tensor(91.9718, device='cuda:3')
benign distance is  tensor(91.9718, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7512498944997787
distance x is tensor(110.3606, device='cuda:3')
benign distance is  tensor(110.3606, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4091842398047447
distance x is tensor(114.0019, device='cuda:3')
benign distance is  tensor(114.0019, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.030953124165535
distance x is tensor(78.6006, device='cuda:3')
benign distance is  tensor(78.6006, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.81700000016
mal_loss is 0.9524278324097395
mal_entropy is 0.13509101327508688
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 548.7650,  504.8924,  570.2526,  763.8536,  407.3708,  472.1342,
         496.6136,  332.9294,  332.9294,  332.9294,  332.9294,  332.9294,
         332.9294,  332.9294,  332.9294,  332.9294,  332.9294,  332.9294,
         332.9294,  332.9294,  737.5035,  802.9940,  848.7606,  721.4248,
         916.7255,  805.8035,  724.4854,  608.8207,  730.4617,  714.1906,
         805.8480,  691.1583,  733.1160,  758.2466,  727.9924,  937.2395,
         663.5430,  715.8106,  701.4232,  776.8723,  619.4175, 1109.7439,
         851.6871,  466.3794,  674.8020,  777.2623,  557.7382,  670.8134,
         888.9075,  495.8302,  775.4145,  301.2024], device='cuda:3')
sorted_norm is   tensor([ 301.2024,  332.9294,  332.9294,  332.9294,  332.9294,  332.9294,
         332.9294,  332.9294,  332.9294,  332.9294,  332.9294,  332.9294,
         332.9294,  332.9294,  407.3708,  466.3794,  472.1342,  495.8302,
         496.6136,  504.8924,  548.7650,  557.7382,  570.2526,  608.8207,
         619.4175,  663.5430,  670.8134,  674.8020,  691.1583,  701.4232,
         714.1906,  715.8106,  721.4248,  724.4854,  727.9924,  730.4617,
         733.1160,  737.5035,  758.2466,  763.8536,  775.4145,  776.8723,
         777.2623,  802.9940,  805.8035,  805.8480,  848.7606,  851.6871,
         888.9075,  916.7255,  937.2395, 1109.7439], device='cuda:3')
used idx is  tensor([51, 19, 13, 17, 11,  9, 15,  7, 14, 12,  8, 18, 10, 16,  4, 43,  5, 49,
         6,  1,  0, 46,  2, 27, 40, 36, 47, 44, 31, 38, 29, 37, 23, 26, 34, 28,
        32, 20, 33,  3, 50], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.02% 

Test Accuracy: 87.53% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7431028019636869
distance x is tensor(126.3836, device='cuda:3')
benign distance is  tensor(126.3836, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8819942381232977
distance x is tensor(110.2473, device='cuda:3')
benign distance is  tensor(110.2473, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7098932303488255
distance x is tensor(105.4244, device='cuda:3')
benign distance is  tensor(105.4244, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8520638067275286
distance x is tensor(153.6799, device='cuda:3')
benign distance is  tensor(153.6799, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7359992936253548
distance x is tensor(79.0212, device='cuda:3')
benign distance is  tensor(79.0212, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7519189193844795
distance x is tensor(90.2971, device='cuda:3')
benign distance is  tensor(90.2971, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9285357836633921
distance x is tensor(85.3430, device='cuda:3')
benign distance is  tensor(85.3430, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.733863702043891
distance x is tensor(38.8489, device='cuda:3')
benign distance is  tensor(38.8489, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.904816260561347
distance x is tensor(101.0525, device='cuda:3')
benign distance is  tensor(101.0525, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5976646039634943
distance x is tensor(131.7714, device='cuda:3')
benign distance is  tensor(131.7714, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0982629209756851
distance x is tensor(75.6102, device='cuda:3')
benign distance is  tensor(75.6102, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2724724039435387
distance x is tensor(115.4405, device='cuda:3')
benign distance is  tensor(115.4405, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1565599031746387
distance x is tensor(179.5455, device='cuda:3')
benign distance is  tensor(179.5455, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.789018128067255
distance x is tensor(54.9755, device='cuda:3')
benign distance is  tensor(54.9755, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1751279830932617
distance x is tensor(159.2083, device='cuda:3')
benign distance is  tensor(159.2083, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1452889237552881
distance x is tensor(98.7346, device='cuda:3')
benign distance is  tensor(98.7346, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1230590865015984
distance x is tensor(114.0759, device='cuda:3')
benign distance is  tensor(114.0759, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7885061670094728
distance x is tensor(123.8610, device='cuda:3')
benign distance is  tensor(123.8610, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0558400489389896
distance x is tensor(127.3037, device='cuda:3')
benign distance is  tensor(127.3037, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9722722731530666
distance x is tensor(129.9581, device='cuda:3')
benign distance is  tensor(129.9581, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0673347599804401
distance x is tensor(80.4322, device='cuda:3')
benign distance is  tensor(80.4322, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9041189644485712
distance x is tensor(218.1115, device='cuda:3')
benign distance is  tensor(218.1115, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1861229166388512
distance x is tensor(161.6710, device='cuda:3')
benign distance is  tensor(161.6710, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6809552041813731
distance x is tensor(86.7185, device='cuda:3')
benign distance is  tensor(86.7185, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9962750412523746
distance x is tensor(140.4930, device='cuda:3')
benign distance is  tensor(140.4930, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6335358070209622
distance x is tensor(84.8933, device='cuda:3')
benign distance is  tensor(84.8933, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9548232890665531
distance x is tensor(145.0093, device='cuda:3')
benign distance is  tensor(145.0093, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2068650908768177
distance x is tensor(118.1290, device='cuda:3')
benign distance is  tensor(118.1290, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9441898092627525
distance x is tensor(128.8319, device='cuda:3')
benign distance is  tensor(128.8319, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7630459386855364
distance x is tensor(125.5701, device='cuda:3')
benign distance is  tensor(125.5701, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4835121762007475
distance x is tensor(116.5729, device='cuda:3')
benign distance is  tensor(116.5729, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0013078711926937
distance x is tensor(178.3000, device='cuda:3')
benign distance is  tensor(178.3000, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1198649611324072
distance x is tensor(123.9257, device='cuda:3')
benign distance is  tensor(123.9257, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.4143015090376139
distance x is tensor(135.8838, device='cuda:3')
benign distance is  tensor(135.8838, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2389497850090265
distance x is tensor(161.0184, device='cuda:3')
benign distance is  tensor(161.0184, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0450706742703915
distance x is tensor(106.7653, device='cuda:3')
benign distance is  tensor(106.7653, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6026821676641703
distance x is tensor(168.7140, device='cuda:3')
benign distance is  tensor(168.7140, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7949044220149517
distance x is tensor(147.6823, device='cuda:3')
benign distance is  tensor(147.6823, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9097596313804388
distance x is tensor(108.5679, device='cuda:3')
benign distance is  tensor(108.5679, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5914334701374173
distance x is tensor(104.5965, device='cuda:3')
benign distance is  tensor(104.5965, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.87300000016
mal_loss is 0.5454872464761138
mal_entropy is 0.12091416120529175
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([552.1495, 491.6256, 475.8589, 680.2026, 344.4334, 398.4246, 376.1046,
        170.1548, 443.5719, 443.5719, 443.5719, 443.5719, 443.5719, 443.5719,
        443.5719, 443.5719, 443.5719, 443.5719, 443.5719, 443.5719, 688.0084,
        537.1328, 785.5198, 682.3160, 619.9796, 529.6250, 547.8500, 465.1906],
       device='cuda:3')
sorted_norm is   tensor([170.1548, 344.4334, 376.1046, 398.4246, 443.5719, 443.5719, 443.5719,
        443.5719, 443.5719, 443.5719, 443.5719, 443.5719, 443.5719, 443.5719,
        443.5719, 443.5719, 465.1906, 475.8589, 491.6256, 529.6250, 537.1328,
        547.8500, 552.1495, 619.9796, 680.2026, 682.3160, 688.0084, 785.5198],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  5, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 27,  2,
         1, 25, 21, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 93.59% 

Test Accuracy: 88.46% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6981759471818805
distance x is tensor(124.8341, device='cuda:3')
benign distance is  tensor(124.8341, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8187894895672798
distance x is tensor(110.1703, device='cuda:3')
benign distance is  tensor(110.1703, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7202637884765863
distance x is tensor(121.0673, device='cuda:3')
benign distance is  tensor(121.0673, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8819566108286381
distance x is tensor(160.9304, device='cuda:3')
benign distance is  tensor(160.9304, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7420628713443875
distance x is tensor(87.4608, device='cuda:3')
benign distance is  tensor(87.4608, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6058070445433259
distance x is tensor(100.5194, device='cuda:3')
benign distance is  tensor(100.5194, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3158796317875385
distance x is tensor(115.9754, device='cuda:3')
benign distance is  tensor(115.9754, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6414587581530213
distance x is tensor(57.1272, device='cuda:3')
benign distance is  tensor(57.1272, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7077851314097643
distance x is tensor(147.6991, device='cuda:3')
benign distance is  tensor(147.6991, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8889671619981527
distance x is tensor(124.1757, device='cuda:3')
benign distance is  tensor(124.1757, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.731757391244173
distance x is tensor(165.1528, device='cuda:3')
benign distance is  tensor(165.1528, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1503987852483988
distance x is tensor(146.9835, device='cuda:3')
benign distance is  tensor(146.9835, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.81681595928967
distance x is tensor(132.4045, device='cuda:3')
benign distance is  tensor(132.4045, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8022835366427898
distance x is tensor(103.0062, device='cuda:3')
benign distance is  tensor(103.0062, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7308716187253594
distance x is tensor(104.2524, device='cuda:3')
benign distance is  tensor(104.2524, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7394808437675238
distance x is tensor(100.4071, device='cuda:3')
benign distance is  tensor(100.4071, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.83000000016
mal_loss is 0.7848077546805143
mal_entropy is 0.13209716277197003
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([549.9794, 503.8105, 534.3334, 719.8739, 378.7480, 448.5767, 512.0670,
        254.6752, 431.2697, 431.2697, 431.2697, 431.2697, 431.2697, 431.2697,
        431.2697, 431.2697, 431.2697, 431.2697, 431.2697, 431.2697, 507.4886,
        629.1941, 423.2882, 569.7237, 819.6639, 347.2089, 718.3796, 505.6474],
       device='cuda:3')
sorted_norm is   tensor([254.6752, 347.2089, 378.7480, 423.2882, 431.2697, 431.2697, 431.2697,
        431.2697, 431.2697, 431.2697, 431.2697, 431.2697, 431.2697, 431.2697,
        431.2697, 431.2697, 448.5767, 503.8105, 505.6474, 507.4886, 512.0670,
        534.3334, 549.9794, 569.7237, 629.1941, 718.3796, 719.8739, 819.6639],
       device='cuda:3')
used idx is  tensor([ 7, 25,  4, 22, 19, 17, 16, 18, 13, 12,  8,  9, 14, 15, 11, 10,  5,  1,
        27, 20,  6,  2], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 94.63% 

Test Accuracy: 88.40% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7938817553222179
distance x is tensor(127.0587, device='cuda:3')
benign distance is  tensor(127.0587, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7534266002476215
distance x is tensor(125.7232, device='cuda:3')
benign distance is  tensor(125.7232, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7685387898236513
distance x is tensor(140.4400, device='cuda:3')
benign distance is  tensor(140.4400, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7554869130253792
distance x is tensor(169.0463, device='cuda:3')
benign distance is  tensor(169.0463, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7625240348279476
distance x is tensor(114.3740, device='cuda:3')
benign distance is  tensor(114.3740, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6594174806959927
distance x is tensor(112.2098, device='cuda:3')
benign distance is  tensor(112.2098, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3970663398504257
distance x is tensor(112.4400, device='cuda:3')
benign distance is  tensor(112.4400, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6970816496759653
distance x is tensor(65.8783, device='cuda:3')
benign distance is  tensor(65.8783, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.18008291721344
distance x is tensor(118.6224, device='cuda:3')
benign distance is  tensor(118.6224, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6699948851019144
distance x is tensor(145.9146, device='cuda:3')
benign distance is  tensor(145.9146, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1013613417744637
distance x is tensor(85.3860, device='cuda:3')
benign distance is  tensor(85.3860, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6294844150543213
distance x is tensor(134.6261, device='cuda:3')
benign distance is  tensor(134.6261, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9406470656394958
distance x is tensor(185.9482, device='cuda:3')
benign distance is  tensor(185.9482, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8221204336732626
distance x is tensor(69.3220, device='cuda:3')
benign distance is  tensor(69.3220, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8918061042204499
distance x is tensor(156.7636, device='cuda:3')
benign distance is  tensor(156.7636, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3761480525135994
distance x is tensor(109.7855, device='cuda:3')
benign distance is  tensor(109.7855, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.77700000016
mal_loss is 1.4015727303922176
mal_entropy is 0.13442708924412727
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([560.0040, 572.6208, 614.8969, 755.3228, 509.2108, 489.2585, 496.9856,
        289.0036, 479.8114, 479.8114, 479.8114, 479.8114, 479.8114, 479.8114,
        479.8114, 479.8114, 479.8114, 479.8114, 479.8114, 479.8114, 589.2697,
        625.2496, 622.5440, 634.0675, 449.8922, 982.9078, 748.8297, 484.6588],
       device='cuda:3')
sorted_norm is   tensor([289.0036, 449.8922, 479.8114, 479.8114, 479.8114, 479.8114, 479.8114,
        479.8114, 479.8114, 479.8114, 479.8114, 479.8114, 479.8114, 479.8114,
        484.6588, 489.2585, 496.9856, 509.2108, 560.0040, 572.6208, 589.2697,
        614.8969, 622.5440, 625.2496, 634.0675, 748.8297, 755.3228, 982.9078],
       device='cuda:3')
used idx is  tensor([ 7, 24, 18, 16, 12,  8, 14, 10,  9, 13, 11, 19, 17, 15, 27,  5,  6,  4,
         0,  1, 20,  2], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.01% 

Test Accuracy: 86.34% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.925421230494976
distance x is tensor(136.8872, device='cuda:3')
benign distance is  tensor(136.8872, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7712406050413847
distance x is tensor(123.1302, device='cuda:3')
benign distance is  tensor(123.1302, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8033250197768211
distance x is tensor(140.3704, device='cuda:3')
benign distance is  tensor(140.3704, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8869771882891655
distance x is tensor(174.3121, device='cuda:3')
benign distance is  tensor(174.3121, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.931285148486495
distance x is tensor(94.3369, device='cuda:3')
benign distance is  tensor(94.3369, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6467779697850347
distance x is tensor(114.2661, device='cuda:3')
benign distance is  tensor(114.2661, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6815788112580776
distance x is tensor(126.1532, device='cuda:3')
benign distance is  tensor(126.1532, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7918483689427376
distance x is tensor(59.0959, device='cuda:3')
benign distance is  tensor(59.0959, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.002646904438734
distance x is tensor(104.9236, device='cuda:3')
benign distance is  tensor(104.9236, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9085284061729908
distance x is tensor(128.4292, device='cuda:3')
benign distance is  tensor(128.4292, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0425847694277763
distance x is tensor(145.0311, device='cuda:3')
benign distance is  tensor(145.0311, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0969406254589558
distance x is tensor(149.7256, device='cuda:3')
benign distance is  tensor(149.7256, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0422612261027098
distance x is tensor(84.2246, device='cuda:3')
benign distance is  tensor(84.2246, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7918466404080391
distance x is tensor(230.3289, device='cuda:3')
benign distance is  tensor(230.3289, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.155805665999651
distance x is tensor(164.1295, device='cuda:3')
benign distance is  tensor(164.1295, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6678704125806689
distance x is tensor(108.1650, device='cuda:3')
benign distance is  tensor(108.1650, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85400000016
mal_loss is 0.6668170122429729
mal_entropy is 0.12187304254621267
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([607.5856, 543.3303, 604.9116, 764.4257, 426.7917, 482.9519, 559.6658,
        258.5762, 477.1627, 477.1627, 477.1627, 477.1627, 477.1627, 477.1627,
        477.1627, 477.1627, 477.1627, 477.1627, 477.1627, 477.1627, 702.3577,
        522.0161, 725.5098, 636.2515, 667.9044, 669.0094, 612.0742, 853.1882,
        587.2353, 686.2168, 460.7864, 627.9240, 840.9686, 412.2208, 722.6210,
        229.8214], device='cuda:3')
sorted_norm is   tensor([229.8214, 258.5762, 412.2208, 426.7917, 460.7864, 477.1627, 477.1627,
        477.1627, 477.1627, 477.1627, 477.1627, 477.1627, 477.1627, 477.1627,
        477.1627, 477.1627, 477.1627, 482.9519, 522.0161, 543.3303, 559.6658,
        587.2353, 604.9116, 607.5856, 612.0742, 627.9240, 636.2515, 667.9044,
        669.0094, 686.2168, 702.3577, 722.6210, 725.5098, 764.4257, 840.9686,
        853.1882], device='cuda:3')
used idx is  tensor([35,  7, 33,  4, 30, 13,  8, 12, 14, 10,  9, 18, 19, 15, 16, 17, 11,  5,
        21,  1,  6, 28,  2,  0, 26, 31, 23, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 90.14% 

Test Accuracy: 88.02% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0500214844942093
distance x is tensor(131.5843, device='cuda:3')
benign distance is  tensor(131.5843, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8228449588641524
distance x is tensor(103.4147, device='cuda:3')
benign distance is  tensor(103.4147, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6355233546346426
distance x is tensor(127.7609, device='cuda:3')
benign distance is  tensor(127.7609, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.85275505669415
distance x is tensor(171.4437, device='cuda:3')
benign distance is  tensor(171.4437, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8091378398239613
distance x is tensor(98.8394, device='cuda:3')
benign distance is  tensor(98.8394, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7897429186850786
distance x is tensor(115.4741, device='cuda:3')
benign distance is  tensor(115.4741, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5232006311416626
distance x is tensor(96.6878, device='cuda:3')
benign distance is  tensor(96.6878, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7234310582280159
distance x is tensor(54.0044, device='cuda:3')
benign distance is  tensor(54.0044, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.10618812777102
distance x is tensor(119.8290, device='cuda:3')
benign distance is  tensor(119.8290, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6791192125529051
distance x is tensor(150.9136, device='cuda:3')
benign distance is  tensor(150.9136, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9187803342938423
distance x is tensor(88.4744, device='cuda:3')
benign distance is  tensor(88.4744, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2799751795828342
distance x is tensor(138.4317, device='cuda:3')
benign distance is  tensor(138.4317, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1544415280222893
distance x is tensor(202.7294, device='cuda:3')
benign distance is  tensor(202.7294, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7603189023211598
distance x is tensor(75.0609, device='cuda:3')
benign distance is  tensor(75.0609, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7432662229984999
distance x is tensor(154.5362, device='cuda:3')
benign distance is  tensor(154.5362, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1387006230652332
distance x is tensor(101.2341, device='cuda:3')
benign distance is  tensor(101.2341, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9923620019108057
distance x is tensor(141.7821, device='cuda:3')
benign distance is  tensor(141.7821, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7328641023486853
distance x is tensor(99.4538, device='cuda:3')
benign distance is  tensor(99.4538, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.980850774794817
distance x is tensor(141.1268, device='cuda:3')
benign distance is  tensor(141.1268, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2947327494621277
distance x is tensor(130.6664, device='cuda:3')
benign distance is  tensor(130.6664, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7940518483519554
distance x is tensor(138.7378, device='cuda:3')
benign distance is  tensor(138.7378, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7318191276863217
distance x is tensor(131.4470, device='cuda:3')
benign distance is  tensor(131.4470, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6789031475782394
distance x is tensor(136.2991, device='cuda:3')
benign distance is  tensor(136.2991, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7337483447045088
distance x is tensor(172.1583, device='cuda:3')
benign distance is  tensor(172.1583, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.81800000016
mal_loss is 0.7527936175465584
mal_entropy is 0.22576931957155466
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([569.6398, 468.8291, 564.3591, 755.4490, 432.4671, 505.2580, 424.5621,
        236.6245, 752.8669, 752.8669, 752.8669, 752.8669, 752.8669, 752.8669,
        752.8669, 752.8669, 752.8669, 752.8669, 752.8669, 752.8669],
       device='cuda:3')
sorted_norm is   tensor([236.6245, 424.5621, 432.4671, 468.8291, 505.2580, 564.3591, 569.6398,
        752.8669, 752.8669, 752.8669, 752.8669, 752.8669, 752.8669, 752.8669,
        752.8669, 752.8669, 752.8669, 752.8669, 752.8669, 755.4490],
       device='cuda:3')
used idx is  tensor([ 7,  6,  4,  1,  5,  2,  0, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 90.17% 

Test Accuracy: 87.55% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8996403850615025
distance x is tensor(135.0215, device='cuda:3')
benign distance is  tensor(135.0215, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8963735569268465
distance x is tensor(122.3333, device='cuda:3')
benign distance is  tensor(122.3333, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9939950834959745
distance x is tensor(131.4731, device='cuda:3')
benign distance is  tensor(131.4731, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0533555373549461
distance x is tensor(182.4393, device='cuda:3')
benign distance is  tensor(182.4393, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0008128434419632
distance x is tensor(110.5887, device='cuda:3')
benign distance is  tensor(110.5887, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8704017144627869
distance x is tensor(106.6856, device='cuda:3')
benign distance is  tensor(106.6856, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4979814942926168
distance x is tensor(117.3925, device='cuda:3')
benign distance is  tensor(117.3925, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7215027380734682
distance x is tensor(62.9341, device='cuda:3')
benign distance is  tensor(62.9341, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85000000016
mal_loss is 0.7807105770334601
mal_entropy is 0.10766576090827584
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 594.2242,  547.5865,  563.9639,  775.9858,  476.9418,  444.7853,
         517.1265,  270.5684,  270.5684,  270.5684,  270.5684,  270.5684,
         270.5684,  270.5684,  270.5684,  270.5684,  270.5684,  270.5684,
         270.5684,  270.5684,  762.0114,  796.9792,  864.5331,  705.6481,
         901.0039,  818.3799,  709.0167,  622.3199,  830.9610,  746.0700,
         879.5715,  829.3502,  780.5864,  698.9701,  701.8345,  598.1317,
         673.6841,  725.6852,  765.4700,  799.7564,  593.9226, 1081.6926,
         845.6597,  536.3247,  672.7637,  785.5114,  576.9774,  739.2724,
         960.3008,  544.8253,  780.9081,  619.4926], device='cuda:3')
sorted_norm is   tensor([ 270.5684,  270.5684,  270.5684,  270.5684,  270.5684,  270.5684,
         270.5684,  270.5684,  270.5684,  270.5684,  270.5684,  270.5684,
         270.5684,  444.7853,  476.9418,  517.1265,  536.3247,  544.8253,
         547.5865,  563.9639,  576.9774,  593.9226,  594.2242,  598.1317,
         619.4926,  622.3199,  672.7637,  673.6841,  698.9701,  701.8345,
         705.6481,  709.0167,  725.6852,  739.2724,  746.0700,  762.0114,
         765.4700,  775.9858,  780.5864,  780.9081,  785.5114,  796.9792,
         799.7564,  818.3799,  829.3502,  830.9610,  845.6597,  864.5331,
         879.5715,  901.0039,  960.3008, 1081.6926], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  5,  4,  6, 43, 49,
         1,  2, 46, 40,  0, 35, 51, 27, 44, 36, 33, 34, 23, 26, 37, 47, 29, 20,
        38,  3, 32, 50, 45], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.54% 

Test Accuracy: 88.12% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8512584082782269
distance x is tensor(119.1436, device='cuda:3')
benign distance is  tensor(119.1436, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7541477475315332
distance x is tensor(115.5293, device='cuda:3')
benign distance is  tensor(115.5293, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6586350351572037
distance x is tensor(119.4929, device='cuda:3')
benign distance is  tensor(119.4929, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8557760156691074
distance x is tensor(168.4871, device='cuda:3')
benign distance is  tensor(168.4871, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1141737690195441
distance x is tensor(133.1971, device='cuda:3')
benign distance is  tensor(133.1971, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7003366588614881
distance x is tensor(101.8441, device='cuda:3')
benign distance is  tensor(101.8441, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2332507222890854
distance x is tensor(97.8690, device='cuda:3')
benign distance is  tensor(97.8690, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6714235618710518
distance x is tensor(43.5858, device='cuda:3')
benign distance is  tensor(43.5858, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8724160846322775
distance x is tensor(117.7297, device='cuda:3')
benign distance is  tensor(117.7297, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7680252203717828
distance x is tensor(133.8607, device='cuda:3')
benign distance is  tensor(133.8607, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0365583430975676
distance x is tensor(80.2812, device='cuda:3')
benign distance is  tensor(80.2812, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2600802183151245
distance x is tensor(140.0576, device='cuda:3')
benign distance is  tensor(140.0576, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.068931519985199
distance x is tensor(213.6221, device='cuda:3')
benign distance is  tensor(213.6221, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6737481392920017
distance x is tensor(71.2604, device='cuda:3')
benign distance is  tensor(71.2604, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9326269365847111
distance x is tensor(171.4128, device='cuda:3')
benign distance is  tensor(171.4128, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4572877399623394
distance x is tensor(92.7735, device='cuda:3')
benign distance is  tensor(92.7735, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0785418562591076
distance x is tensor(105.3166, device='cuda:3')
benign distance is  tensor(105.3166, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7849222645163536
distance x is tensor(121.6405, device='cuda:3')
benign distance is  tensor(121.6405, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9744069408625364
distance x is tensor(135.9298, device='cuda:3')
benign distance is  tensor(135.9298, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7695277575403452
distance x is tensor(148.2840, device='cuda:3')
benign distance is  tensor(148.2840, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9355826489627361
distance x is tensor(75.4052, device='cuda:3')
benign distance is  tensor(75.4052, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8501293621957302
distance x is tensor(227.2453, device='cuda:3')
benign distance is  tensor(227.2453, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4795944653451443
distance x is tensor(157.1943, device='cuda:3')
benign distance is  tensor(157.1943, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7078244797885418
distance x is tensor(84.2408, device='cuda:3')
benign distance is  tensor(84.2408, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8200536966323853
distance x is tensor(136.6043, device='cuda:3')
benign distance is  tensor(136.6043, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8236722070723772
distance x is tensor(107.7375, device='cuda:3')
benign distance is  tensor(107.7375, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6197015270590782
distance x is tensor(163.7498, device='cuda:3')
benign distance is  tensor(163.7498, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1469920724630356
distance x is tensor(143.3279, device='cuda:3')
benign distance is  tensor(143.3279, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8494512941688299
distance x is tensor(128.9030, device='cuda:3')
benign distance is  tensor(128.9030, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8062257803976536
distance x is tensor(102.9381, device='cuda:3')
benign distance is  tensor(102.9381, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7985465452075005
distance x is tensor(97.1842, device='cuda:3')
benign distance is  tensor(97.1842, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7715991605073214
distance x is tensor(89.4739, device='cuda:3')
benign distance is  tensor(89.4739, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.176412047818303
distance x is tensor(112.2847, device='cuda:3')
benign distance is  tensor(112.2847, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.369117010384798
distance x is tensor(155.8958, device='cuda:3')
benign distance is  tensor(155.8958, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0132734198123217
distance x is tensor(166.4324, device='cuda:3')
benign distance is  tensor(166.4324, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9094207659363747
distance x is tensor(104.9843, device='cuda:3')
benign distance is  tensor(104.9843, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7571589834988117
distance x is tensor(173.2542, device='cuda:3')
benign distance is  tensor(173.2542, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7364197839051485
distance x is tensor(150.3141, device='cuda:3')
benign distance is  tensor(150.3141, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8288885373622179
distance x is tensor(107.9381, device='cuda:3')
benign distance is  tensor(107.9381, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6262557348236442
distance x is tensor(77.8949, device='cuda:3')
benign distance is  tensor(77.8949, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85900000016
mal_loss is 0.6780449133366346
mal_entropy is 0.10160754946991801
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([526.6531, 519.2997, 523.7727, 736.7418, 565.3757, 435.6088, 434.8991,
        178.8807, 327.3456, 327.3456, 327.3456, 327.3456, 327.3456, 327.3456,
        327.3456, 327.3456, 327.3456, 327.3456, 327.3456, 327.3456],
       device='cuda:3')
sorted_norm is   tensor([178.8807, 327.3456, 327.3456, 327.3456, 327.3456, 327.3456, 327.3456,
        327.3456, 327.3456, 327.3456, 327.3456, 327.3456, 327.3456, 434.8991,
        435.6088, 519.2997, 523.7727, 526.6531, 565.3757, 736.7418],
       device='cuda:3')
used idx is  tensor([ 7, 18, 14, 16, 12,  8, 10, 17,  9, 13, 11, 19, 15,  6,  5,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 93.12% 

Test Accuracy: 88.15% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8161288723349571
distance x is tensor(149.8049, device='cuda:3')
benign distance is  tensor(149.8049, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.016403965651989
distance x is tensor(126.1277, device='cuda:3')
benign distance is  tensor(126.1277, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6979272421449423
distance x is tensor(142.0933, device='cuda:3')
benign distance is  tensor(142.0933, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7931021600961685
distance x is tensor(177.0483, device='cuda:3')
benign distance is  tensor(177.0483, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0234280787408352
distance x is tensor(108.7515, device='cuda:3')
benign distance is  tensor(108.7515, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8130324799567461
distance x is tensor(135.6678, device='cuda:3')
benign distance is  tensor(135.6678, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2497145906090736
distance x is tensor(110.1233, device='cuda:3')
benign distance is  tensor(110.1233, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8360028490424156
distance x is tensor(88.5641, device='cuda:3')
benign distance is  tensor(88.5641, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.84400000016
mal_loss is 0.8339869547635317
mal_entropy is 0.11888122884556651
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([654.8845, 572.9485, 626.1592, 777.5694, 480.4805, 578.0200, 484.1466,
        379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 379.6533,
        379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 698.6423,
        540.7722, 707.8615, 665.1373, 706.6599, 677.1307, 679.6821, 633.6283,
        559.6359, 639.5707, 431.7253, 661.1662, 961.6650, 388.0055, 769.7000,
        481.0558], device='cuda:3')
sorted_norm is   tensor([379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 379.6533,
        379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 379.6533, 388.0055,
        431.7253, 480.4805, 481.0558, 484.1466, 540.7722, 559.6359, 572.9485,
        578.0200, 626.1592, 633.6283, 639.5707, 654.8845, 661.1662, 665.1373,
        677.1307, 679.6821, 698.6423, 706.6599, 707.8615, 769.7000, 777.5694,
        961.6650], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 33, 30,  4, 35,  6,
        21, 28,  1,  5,  2, 27, 29,  0, 31, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 90.67% 

Test Accuracy: 87.42% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.719225374981761
distance x is tensor(136.1616, device='cuda:3')
benign distance is  tensor(136.1616, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0138030350208282
distance x is tensor(100.5662, device='cuda:3')
benign distance is  tensor(100.5662, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7235626224428415
distance x is tensor(117.3074, device='cuda:3')
benign distance is  tensor(117.3074, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.984487272799015
distance x is tensor(169.4839, device='cuda:3')
benign distance is  tensor(169.4839, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9991709655150771
distance x is tensor(79.1889, device='cuda:3')
benign distance is  tensor(79.1889, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7453945083543658
distance x is tensor(95.0242, device='cuda:3')
benign distance is  tensor(95.0242, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.188645327463746
distance x is tensor(102.0819, device='cuda:3')
benign distance is  tensor(102.0819, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8134542498737574
distance x is tensor(28.5294, device='cuda:3')
benign distance is  tensor(28.5294, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8682355545461178
distance x is tensor(124.8545, device='cuda:3')
benign distance is  tensor(124.8545, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6508137816563249
distance x is tensor(176.4048, device='cuda:3')
benign distance is  tensor(176.4048, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0778067465871572
distance x is tensor(95.6467, device='cuda:3')
benign distance is  tensor(95.6467, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4513411410152912
distance x is tensor(156.2502, device='cuda:3')
benign distance is  tensor(156.2502, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1126375161111355
distance x is tensor(199.3945, device='cuda:3')
benign distance is  tensor(199.3945, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7759695854038
distance x is tensor(65.8975, device='cuda:3')
benign distance is  tensor(65.8975, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0815141201019287
distance x is tensor(173.1295, device='cuda:3')
benign distance is  tensor(173.1295, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2211244106292725
distance x is tensor(117.1991, device='cuda:3')
benign distance is  tensor(117.1991, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2297029756009579
distance x is tensor(131.5644, device='cuda:3')
benign distance is  tensor(131.5644, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7591394204646349
distance x is tensor(94.0527, device='cuda:3')
benign distance is  tensor(94.0527, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0338610131293535
distance x is tensor(144.7743, device='cuda:3')
benign distance is  tensor(144.7743, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.4900993146002293
distance x is tensor(118.9234, device='cuda:3')
benign distance is  tensor(118.9234, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8646953161805868
distance x is tensor(135.9064, device='cuda:3')
benign distance is  tensor(135.9064, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7989165000617504
distance x is tensor(132.9546, device='cuda:3')
benign distance is  tensor(132.9546, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5065627284348011
distance x is tensor(130.3418, device='cuda:3')
benign distance is  tensor(130.3418, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.797143341973424
distance x is tensor(179.5300, device='cuda:3')
benign distance is  tensor(179.5300, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8090000001600001
mal_loss is 0.8393558915704489
mal_entropy is 0.2067385921254754
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 592.2373,  447.2306,  521.5267,  727.6059,  343.3698,  414.8685,
         463.2391,  118.7438,  786.8457,  786.8457,  786.8457,  786.8457,
         786.8457,  786.8457,  786.8457,  786.8457,  786.8457,  786.8457,
         786.8457,  786.8457,  531.5098,  584.4088,  619.0984,  676.4786,
         397.9373, 1008.7343,  715.0809,  437.5179], device='cuda:3')
sorted_norm is   tensor([ 118.7438,  343.3698,  397.9373,  414.8685,  437.5179,  447.2306,
         463.2391,  521.5267,  531.5098,  584.4088,  592.2373,  619.0984,
         676.4786,  715.0809,  727.6059,  786.8457,  786.8457,  786.8457,
         786.8457,  786.8457,  786.8457,  786.8457,  786.8457,  786.8457,
         786.8457,  786.8457,  786.8457, 1008.7343], device='cuda:3')
used idx is  tensor([ 7,  4, 24,  5, 27,  1,  6,  2, 20, 21,  0, 22, 23, 26,  3, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 87.67% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7923500873148441
distance x is tensor(128.7431, device='cuda:3')
benign distance is  tensor(128.7431, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7362609207630157
distance x is tensor(103.2462, device='cuda:3')
benign distance is  tensor(103.2462, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.804097717627883
distance x is tensor(113.8256, device='cuda:3')
benign distance is  tensor(113.8256, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0468237716704607
distance x is tensor(163.1863, device='cuda:3')
benign distance is  tensor(163.1863, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9042811114341021
distance x is tensor(89.8934, device='cuda:3')
benign distance is  tensor(89.8934, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7626508111134171
distance x is tensor(104.6037, device='cuda:3')
benign distance is  tensor(104.6037, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0068421959877014
distance x is tensor(93.2002, device='cuda:3')
benign distance is  tensor(93.2002, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6868247492238879
distance x is tensor(48.9824, device='cuda:3')
benign distance is  tensor(48.9824, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6487408131361008
distance x is tensor(146.7573, device='cuda:3')
benign distance is  tensor(146.7573, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8217740301042795
distance x is tensor(117.5301, device='cuda:3')
benign distance is  tensor(117.5301, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9210962299257517
distance x is tensor(145.9159, device='cuda:3')
benign distance is  tensor(145.9159, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8893909398466349
distance x is tensor(133.8229, device='cuda:3')
benign distance is  tensor(133.8229, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1128697916865349
distance x is tensor(75.8882, device='cuda:3')
benign distance is  tensor(75.8882, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7802283633500338
distance x is tensor(220.1404, device='cuda:3')
benign distance is  tensor(220.1404, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1824479456990957
distance x is tensor(170.9805, device='cuda:3')
benign distance is  tensor(170.9805, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7376199075952172
distance x is tensor(81.0061, device='cuda:3')
benign distance is  tensor(81.0061, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.84300000016
mal_loss is 0.7352535873651505
mal_entropy is 0.12839101580902934
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([564.6893, 477.2640, 495.1462, 709.4287, 393.2390, 447.3922, 415.6955,
        205.7954, 353.0169, 353.0169, 353.0169, 353.0169, 353.0169, 353.0169,
        353.0169, 353.0169, 353.0169, 353.0169, 353.0169, 353.0169, 605.7316,
        817.3107, 484.9680, 729.6704, 903.2859, 408.7593, 778.5247, 588.1681],
       device='cuda:3')
sorted_norm is   tensor([205.7954, 353.0169, 353.0169, 353.0169, 353.0169, 353.0169, 353.0169,
        353.0169, 353.0169, 353.0169, 353.0169, 353.0169, 353.0169, 393.2390,
        408.7593, 415.6955, 447.3922, 477.2640, 484.9680, 495.1462, 564.6893,
        588.1681, 605.7316, 709.4287, 729.6704, 778.5247, 817.3107, 903.2859],
       device='cuda:3')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4, 25,  6,  5,  1,
        22,  2,  0, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.91% 

Test Accuracy: 87.61% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8419410772621632
distance x is tensor(128.1777, device='cuda:3')
benign distance is  tensor(128.1777, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8279632944613695
distance x is tensor(111.2169, device='cuda:3')
benign distance is  tensor(111.2169, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8217371497303247
distance x is tensor(123.8939, device='cuda:3')
benign distance is  tensor(123.8939, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9312626831233501
distance x is tensor(187.9937, device='cuda:3')
benign distance is  tensor(187.9937, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9923467547632754
distance x is tensor(104.2501, device='cuda:3')
benign distance is  tensor(104.2501, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7627198505215347
distance x is tensor(112.4829, device='cuda:3')
benign distance is  tensor(112.4829, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1323507893830538
distance x is tensor(90.4656, device='cuda:3')
benign distance is  tensor(90.4656, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8098548520356417
distance x is tensor(55.1271, device='cuda:3')
benign distance is  tensor(55.1271, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3141422756016254
distance x is tensor(124.8617, device='cuda:3')
benign distance is  tensor(124.8617, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7628832929767668
distance x is tensor(146.2290, device='cuda:3')
benign distance is  tensor(146.2290, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.068149222061038
distance x is tensor(78.9107, device='cuda:3')
benign distance is  tensor(78.9107, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1595891676843166
distance x is tensor(125.0019, device='cuda:3')
benign distance is  tensor(125.0019, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1395589150488377
distance x is tensor(207.3150, device='cuda:3')
benign distance is  tensor(207.3150, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6921457722783089
distance x is tensor(74.9661, device='cuda:3')
benign distance is  tensor(74.9661, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.017661226913333
distance x is tensor(154.3213, device='cuda:3')
benign distance is  tensor(154.3213, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2607009783387184
distance x is tensor(126.7894, device='cuda:3')
benign distance is  tensor(126.7894, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8040000001600001
mal_loss is 1.2173059284687042
mal_entropy is 0.14531027246266603
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([563.5978, 491.9087, 550.0601, 812.1873, 455.9510, 477.4174, 394.0655,
        230.0553, 544.2737, 544.2737, 544.2737, 544.2737, 544.2737, 544.2737,
        544.2737, 544.2737, 544.2737, 544.2737, 544.2737, 544.2737, 682.7369,
        573.5297, 784.3945, 704.1616, 642.5475, 546.2993, 542.0420, 512.2451],
       device='cuda:3')
sorted_norm is   tensor([230.0553, 394.0655, 455.9510, 477.4174, 491.9087, 512.2451, 542.0420,
        544.2737, 544.2737, 544.2737, 544.2737, 544.2737, 544.2737, 544.2737,
        544.2737, 544.2737, 544.2737, 544.2737, 544.2737, 546.2993, 550.0601,
        563.5978, 573.5297, 642.5475, 682.7369, 704.1616, 784.3945, 812.1873],
       device='cuda:3')
used idx is  tensor([ 7,  6,  4,  5,  1, 27, 26, 16, 14, 12, 15, 17, 19, 18,  8,  9, 13, 10,
        11, 25,  2,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 88.31% 

Test Accuracy: 86.95% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8588688373565674
distance x is tensor(122.2418, device='cuda:3')
benign distance is  tensor(122.2418, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.817728266119957
distance x is tensor(117.3511, device='cuda:3')
benign distance is  tensor(117.3511, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9191717877984047
distance x is tensor(124.3052, device='cuda:3')
benign distance is  tensor(124.3052, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1483173444867134
distance x is tensor(171.3470, device='cuda:3')
benign distance is  tensor(171.3470, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.054145023226738
distance x is tensor(97.1611, device='cuda:3')
benign distance is  tensor(97.1611, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6569307008758187
distance x is tensor(111.2469, device='cuda:3')
benign distance is  tensor(111.2469, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1421642545610666
distance x is tensor(97.7730, device='cuda:3')
benign distance is  tensor(97.7730, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6996650286018848
distance x is tensor(61.4088, device='cuda:3')
benign distance is  tensor(61.4088, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.961457148194313
distance x is tensor(153.1076, device='cuda:3')
benign distance is  tensor(153.1076, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9219710575416684
distance x is tensor(106.8807, device='cuda:3')
benign distance is  tensor(106.8807, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6840032730251551
distance x is tensor(165.4733, device='cuda:3')
benign distance is  tensor(165.4733, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.135167920961976
distance x is tensor(144.2363, device='cuda:3')
benign distance is  tensor(144.2363, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9928595460951328
distance x is tensor(154.7582, device='cuda:3')
benign distance is  tensor(154.7582, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9975881688296795
distance x is tensor(119.7346, device='cuda:3')
benign distance is  tensor(119.7346, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8810969945043325
distance x is tensor(110.3904, device='cuda:3')
benign distance is  tensor(110.3904, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.752466719597578
distance x is tensor(121.9824, device='cuda:3')
benign distance is  tensor(121.9824, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.83400000016
mal_loss is 0.7167312577366829
mal_entropy is 0.1323406253941357
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 540.0424,  521.8536,  540.9772,  749.3763,  411.9827,  486.0266,
         430.3547,  258.0400,  536.0540,  536.0540,  536.0540,  536.0540,
         536.0540,  536.0540,  536.0540,  536.0540,  536.0540,  536.0540,
         536.0540,  536.0540,  629.1633,  778.3574,  817.3735,  618.2791,
         862.6707,  771.6271,  608.6111,  475.3786,  684.5139,  578.2875,
         739.6875,  653.5218,  708.2897,  715.4669,  676.0718,  719.0720,
         742.6575,  611.0084,  695.6263,  679.9085,  477.4770, 1014.2527,
         803.4662,  385.7601,  605.9233,  702.3434,  466.4019,  628.5028,
        1006.2491,  443.9595,  719.5979,  257.5316], device='cuda:3')
sorted_norm is   tensor([ 257.5316,  258.0400,  385.7601,  411.9827,  430.3547,  443.9595,
         466.4019,  475.3786,  477.4770,  486.0266,  521.8536,  536.0540,
         536.0540,  536.0540,  536.0540,  536.0540,  536.0540,  536.0540,
         536.0540,  536.0540,  536.0540,  536.0540,  536.0540,  540.0424,
         540.9772,  578.2875,  605.9233,  608.6111,  611.0084,  618.2791,
         628.5028,  629.1633,  653.5218,  676.0718,  679.9085,  684.5139,
         695.6263,  702.3434,  708.2897,  715.4669,  719.0720,  719.5979,
         739.6875,  742.6575,  749.3763,  771.6271,  778.3574,  803.4662,
         817.3735,  862.6707, 1006.2491, 1014.2527], device='cuda:3')
used idx is  tensor([51,  7, 43,  4,  6, 49, 46, 27, 40,  5,  1, 14, 16, 12, 15, 18, 19, 11,
        13, 17,  8, 10,  9,  0,  2, 29, 44, 26, 37, 23, 47, 20, 31, 34, 39, 28,
        38, 45, 32, 33, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 93.11% 

Test Accuracy: 89.12% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7999430894851685
distance x is tensor(113.9599, device='cuda:3')
benign distance is  tensor(113.9599, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6756132859736681
distance x is tensor(99.6976, device='cuda:3')
benign distance is  tensor(99.6976, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6612778566777706
distance x is tensor(115.4572, device='cuda:3')
benign distance is  tensor(115.4572, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9921831712126732
distance x is tensor(179.7287, device='cuda:3')
benign distance is  tensor(179.7287, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.755938557907939
distance x is tensor(87.0759, device='cuda:3')
benign distance is  tensor(87.0759, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5889176088385284
distance x is tensor(111.3791, device='cuda:3')
benign distance is  tensor(111.3791, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.028410105034709
distance x is tensor(90.8521, device='cuda:3')
benign distance is  tensor(90.8521, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6746456390246749
distance x is tensor(50.1847, device='cuda:3')
benign distance is  tensor(50.1847, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7598662506788969
distance x is tensor(102.9583, device='cuda:3')
benign distance is  tensor(102.9583, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.775267499499023
distance x is tensor(146.6434, device='cuda:3')
benign distance is  tensor(146.6434, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0683736763894558
distance x is tensor(87.9205, device='cuda:3')
benign distance is  tensor(87.9205, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.24779911339283
distance x is tensor(121.9129, device='cuda:3')
benign distance is  tensor(121.9129, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1202854495495558
distance x is tensor(213.1707, device='cuda:3')
benign distance is  tensor(213.1707, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7447870951145887
distance x is tensor(60.1740, device='cuda:3')
benign distance is  tensor(60.1740, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1416779160499573
distance x is tensor(153.5436, device='cuda:3')
benign distance is  tensor(153.5436, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1333745680749416
distance x is tensor(115.3695, device='cuda:3')
benign distance is  tensor(115.3695, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2188500687479973
distance x is tensor(99.3973, device='cuda:3')
benign distance is  tensor(99.3973, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7922149822115898
distance x is tensor(123.5019, device='cuda:3')
benign distance is  tensor(123.5019, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1147218607366085
distance x is tensor(139.3892, device='cuda:3')
benign distance is  tensor(139.3892, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8615758903324604
distance x is tensor(131.1220, device='cuda:3')
benign distance is  tensor(131.1220, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0195873398333788
distance x is tensor(88.0897, device='cuda:3')
benign distance is  tensor(88.0897, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7889313120394945
distance x is tensor(233.6720, device='cuda:3')
benign distance is  tensor(233.6720, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.8905696012079716
distance x is tensor(171.3103, device='cuda:3')
benign distance is  tensor(171.3103, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7483946857973933
distance x is tensor(86.4190, device='cuda:3')
benign distance is  tensor(86.4190, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9376680292189121
distance x is tensor(123.5841, device='cuda:3')
benign distance is  tensor(123.5841, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5791574930772185
distance x is tensor(93.5686, device='cuda:3')
benign distance is  tensor(93.5686, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0221001971513033
distance x is tensor(146.1231, device='cuda:3')
benign distance is  tensor(146.1231, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3462186977267265
distance x is tensor(121.3693, device='cuda:3')
benign distance is  tensor(121.3693, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7468566196039319
distance x is tensor(132.2465, device='cuda:3')
benign distance is  tensor(132.2465, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7472841292619705
distance x is tensor(119.4776, device='cuda:3')
benign distance is  tensor(119.4776, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.636147316545248
distance x is tensor(135.5822, device='cuda:3')
benign distance is  tensor(135.5822, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6326960884034634
distance x is tensor(169.9627, device='cuda:3')
benign distance is  tensor(169.9627, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.0297529781237245
distance x is tensor(119.7546, device='cuda:3')
benign distance is  tensor(119.7546, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2427635826170444
distance x is tensor(150.6376, device='cuda:3')
benign distance is  tensor(150.6376, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2246242351830006
distance x is tensor(174.2048, device='cuda:3')
benign distance is  tensor(174.2048, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0172214210033417
distance x is tensor(113.2700, device='cuda:3')
benign distance is  tensor(113.2700, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7309043388813734
distance x is tensor(183.6349, device='cuda:3')
benign distance is  tensor(183.6349, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9238136615604162
distance x is tensor(149.1306, device='cuda:3')
benign distance is  tensor(149.1306, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8290843833237886
distance x is tensor(122.7009, device='cuda:3')
benign distance is  tensor(122.7009, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7043068837374449
distance x is tensor(113.9437, device='cuda:3')
benign distance is  tensor(113.9437, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.84700000016
mal_loss is 0.7731508975848556
mal_entropy is 0.11907639307901263
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([506.5118, 433.5935, 508.8473, 801.8118, 379.5776, 472.7280, 398.6985,
        216.5266, 487.6454, 487.6454, 487.6454, 487.6454, 487.6454, 487.6454,
        487.6454, 487.6454, 487.6454, 487.6454, 487.6454, 487.6454],
       device='cuda:3')
sorted_norm is   tensor([216.5266, 379.5776, 398.6985, 433.5935, 472.7280, 487.6454, 487.6454,
        487.6454, 487.6454, 487.6454, 487.6454, 487.6454, 487.6454, 487.6454,
        487.6454, 487.6454, 487.6454, 506.5118, 508.8473, 801.8118],
       device='cuda:3')
used idx is  tensor([ 7,  4,  6,  1,  5, 18, 14, 16, 12,  8, 10, 17,  9, 13, 11, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 92.35% 

Test Accuracy: 87.90% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7934829946607351
distance x is tensor(141.4725, device='cuda:3')
benign distance is  tensor(141.4725, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8322615213692188
distance x is tensor(134.5663, device='cuda:3')
benign distance is  tensor(134.5663, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7860016915947199
distance x is tensor(145.0973, device='cuda:3')
benign distance is  tensor(145.0973, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9302076809108257
distance x is tensor(183.6715, device='cuda:3')
benign distance is  tensor(183.6715, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1279925741255283
distance x is tensor(106.6527, device='cuda:3')
benign distance is  tensor(106.6527, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7400955595076084
distance x is tensor(95.2927, device='cuda:3')
benign distance is  tensor(95.2927, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1369425747543573
distance x is tensor(97.1309, device='cuda:3')
benign distance is  tensor(97.1309, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6774846538901329
distance x is tensor(83.0415, device='cuda:3')
benign distance is  tensor(83.0415, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85500000016
mal_loss is 0.7506725508719683
mal_entropy is 0.12199378851801157
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([609.3510, 610.4527, 623.4595, 785.0858, 462.1842, 402.1041, 430.1721,
        360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 360.4221,
        360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 561.7284,
        725.1189, 507.7067, 626.9440, 992.4304, 427.1912, 754.2107, 599.8719],
       device='cuda:3')
sorted_norm is   tensor([360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 360.4221,
        360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 360.4221, 402.1041,
        427.1912, 430.1721, 462.1842, 507.7067, 561.7284, 599.8719, 609.3510,
        610.4527, 623.4595, 626.9440, 725.1189, 754.2107, 785.0858, 992.4304],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14,  7, 11, 10,  8,  9, 15,  5, 25,  6,  4, 22,
        20, 27,  0,  1], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 91.01% 

Test Accuracy: 87.68% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7431469950824976
distance x is tensor(153.6398, device='cuda:3')
benign distance is  tensor(153.6398, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9143473133444786
distance x is tensor(105.9133, device='cuda:3')
benign distance is  tensor(105.9133, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7200928637757897
distance x is tensor(133.8290, device='cuda:3')
benign distance is  tensor(133.8290, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0081293676048517
distance x is tensor(188.9115, device='cuda:3')
benign distance is  tensor(188.9115, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9574281508103013
distance x is tensor(92.4290, device='cuda:3')
benign distance is  tensor(92.4290, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7627523234114051
distance x is tensor(110.0426, device='cuda:3')
benign distance is  tensor(110.0426, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1169043965637684
distance x is tensor(98.4752, device='cuda:3')
benign distance is  tensor(98.4752, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7543969284743071
distance x is tensor(31.1725, device='cuda:3')
benign distance is  tensor(31.1725, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9494967292994261
distance x is tensor(114.4770, device='cuda:3')
benign distance is  tensor(114.4770, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5220312206074595
distance x is tensor(139.2999, device='cuda:3')
benign distance is  tensor(139.2999, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2533575408160686
distance x is tensor(97.2604, device='cuda:3')
benign distance is  tensor(97.2604, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.296645237132907
distance x is tensor(135.9912, device='cuda:3')
benign distance is  tensor(135.9912, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8814519979059696
distance x is tensor(196.3987, device='cuda:3')
benign distance is  tensor(196.3987, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6377657260745764
distance x is tensor(78.2274, device='cuda:3')
benign distance is  tensor(78.2274, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.123998437076807
distance x is tensor(168.7057, device='cuda:3')
benign distance is  tensor(168.7057, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1625343337655067
distance x is tensor(111.9865, device='cuda:3')
benign distance is  tensor(111.9865, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.7980000001600001
mal_loss is 1.248313657939434
mal_entropy is 0.1393933859653771
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 658.1799,  469.4840,  584.9867,  818.6019,  406.8450,  466.4920,
         429.7784,  134.5992,  475.9662,  475.9662,  475.9662,  475.9662,
         475.9662,  475.9662,  475.9662,  475.9662,  475.9662,  475.9662,
         475.9662,  475.9662,  549.7900,  621.0770,  670.2522,  668.8643,
         500.0913, 1057.1704,  810.7772,  500.2191], device='cuda:3')
sorted_norm is   tensor([ 134.5992,  406.8450,  429.7784,  466.4920,  469.4840,  475.9662,
         475.9662,  475.9662,  475.9662,  475.9662,  475.9662,  475.9662,
         475.9662,  475.9662,  475.9662,  475.9662,  475.9662,  500.0913,
         500.2191,  549.7900,  584.9867,  621.0770,  658.1799,  668.8643,
         670.2522,  810.7772,  818.6019, 1057.1704], device='cuda:3')
used idx is  tensor([ 7,  4,  6,  5,  1, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11, 24,
        27, 20,  2, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 87.70% 

Test Accuracy: 86.10% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7603096831589937
distance x is tensor(134.5781, device='cuda:3')
benign distance is  tensor(134.5781, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8316002711653709
distance x is tensor(117.7837, device='cuda:3')
benign distance is  tensor(117.7837, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.845139816403389
distance x is tensor(138.8640, device='cuda:3')
benign distance is  tensor(138.8640, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.769533846527338
distance x is tensor(168.8062, device='cuda:3')
benign distance is  tensor(168.8062, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.871307778172195
distance x is tensor(94.5001, device='cuda:3')
benign distance is  tensor(94.5001, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.703520555049181
distance x is tensor(112.9940, device='cuda:3')
benign distance is  tensor(112.9940, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7715583369135857
distance x is tensor(117.7088, device='cuda:3')
benign distance is  tensor(117.7088, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8196303602308035
distance x is tensor(56.5493, device='cuda:3')
benign distance is  tensor(56.5493, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0536154806613922
distance x is tensor(108.8872, device='cuda:3')
benign distance is  tensor(108.8872, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8202356025576591
distance x is tensor(140.1085, device='cuda:3')
benign distance is  tensor(140.1085, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9929103422909975
distance x is tensor(135.6901, device='cuda:3')
benign distance is  tensor(135.6901, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.827733788639307
distance x is tensor(170.6450, device='cuda:3')
benign distance is  tensor(170.6450, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.046770753338933
distance x is tensor(96.6384, device='cuda:3')
benign distance is  tensor(96.6384, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.680916016921401
distance x is tensor(236.3175, device='cuda:3')
benign distance is  tensor(236.3175, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.087781123816967
distance x is tensor(190.3608, device='cuda:3')
benign distance is  tensor(190.3608, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7662360277026892
distance x is tensor(91.6222, device='cuda:3')
benign distance is  tensor(91.6222, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.84700000016
mal_loss is 0.7481358665972948
mal_entropy is 0.13154359674081206
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([579.2155, 523.0157, 610.5204, 732.5511, 421.6029, 473.8589, 509.3751,
        238.4771, 394.0880, 394.0880, 394.0880, 394.0880, 394.0880, 394.0880,
        394.0880, 394.0880, 394.0880, 394.0880, 394.0880, 394.0880, 785.4579,
        611.2507, 811.1661, 749.0430, 764.7804, 670.1094, 634.7274, 564.8134,
        643.7274, 551.9459, 725.6592, 647.4906, 668.5561, 652.7645, 700.8737,
        843.9037, 556.5695, 651.4998, 491.7444, 648.5571, 882.6777, 434.2982,
        765.2581, 228.6909], device='cuda:3')
sorted_norm is   tensor([228.6909, 238.4771, 394.0880, 394.0880, 394.0880, 394.0880, 394.0880,
        394.0880, 394.0880, 394.0880, 394.0880, 394.0880, 394.0880, 394.0880,
        421.6029, 434.2982, 473.8589, 491.7444, 509.3751, 523.0157, 551.9459,
        556.5695, 564.8134, 579.2155, 610.5204, 611.2507, 634.7274, 643.7274,
        647.4906, 648.5571, 651.4998, 652.7645, 668.5561, 670.1094, 700.8737,
        725.6592, 732.5511, 749.0430, 764.7804, 765.2581, 785.4579, 811.1661,
        843.9037, 882.6777], device='cuda:3')
used idx is  tensor([43,  7, 11, 10, 14, 19, 13, 18, 15, 12,  8,  9, 16, 17,  4, 41,  5, 38,
         6,  1, 29, 36, 27,  0,  2, 21, 26, 28, 31, 39, 37, 33, 32, 25, 34],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 90.01% 

Test Accuracy: 87.90% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.734243530780077
distance x is tensor(101.4125, device='cuda:3')
benign distance is  tensor(101.4125, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7940150499343872
distance x is tensor(92.5709, device='cuda:3')
benign distance is  tensor(92.5709, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7851409558206797
distance x is tensor(120.6236, device='cuda:3')
benign distance is  tensor(120.6236, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8863766938447952
distance x is tensor(179.9365, device='cuda:3')
benign distance is  tensor(179.9365, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8224817514419556
distance x is tensor(83.2853, device='cuda:3')
benign distance is  tensor(83.2853, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8600354939699173
distance x is tensor(94.0969, device='cuda:3')
benign distance is  tensor(94.0969, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1891268827021122
distance x is tensor(105.7309, device='cuda:3')
benign distance is  tensor(105.7309, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6336060920730233
distance x is tensor(41.9088, device='cuda:3')
benign distance is  tensor(41.9088, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0214919950813055
distance x is tensor(111.3211, device='cuda:3')
benign distance is  tensor(111.3211, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.73000867664814
distance x is tensor(155.7244, device='cuda:3')
benign distance is  tensor(155.7244, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.121102524921298
distance x is tensor(89.2650, device='cuda:3')
benign distance is  tensor(89.2650, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2186847515404224
distance x is tensor(130.5691, device='cuda:3')
benign distance is  tensor(130.5691, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0855615492910147
distance x is tensor(194.1593, device='cuda:3')
benign distance is  tensor(194.1593, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.649886948056519
distance x is tensor(63.1145, device='cuda:3')
benign distance is  tensor(63.1145, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9181594327092171
distance x is tensor(152.1160, device='cuda:3')
benign distance is  tensor(152.1160, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9860795810818672
distance x is tensor(84.2943, device='cuda:3')
benign distance is  tensor(84.2943, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2195969112217426
distance x is tensor(143.4668, device='cuda:3')
benign distance is  tensor(143.4668, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6299169175326824
distance x is tensor(96.9841, device='cuda:3')
benign distance is  tensor(96.9841, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9465305749326944
distance x is tensor(150.5287, device='cuda:3')
benign distance is  tensor(150.5287, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3551289588212967
distance x is tensor(127.3545, device='cuda:3')
benign distance is  tensor(127.3545, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8915745783597231
distance x is tensor(144.4051, device='cuda:3')
benign distance is  tensor(144.4051, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7447687424719334
distance x is tensor(115.7538, device='cuda:3')
benign distance is  tensor(115.7538, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5733476113528013
distance x is tensor(135.6039, device='cuda:3')
benign distance is  tensor(135.6039, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8179405014961958
distance x is tensor(187.2220, device='cuda:3')
benign distance is  tensor(187.2220, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7037127520889044
distance x is tensor(132.3278, device='cuda:3')
benign distance is  tensor(132.3278, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.881217435002327
distance x is tensor(109.6663, device='cuda:3')
benign distance is  tensor(109.6663, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6806311402469873
distance x is tensor(185.5050, device='cuda:3')
benign distance is  tensor(185.5050, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.6244021952152252
distance x is tensor(146.1558, device='cuda:3')
benign distance is  tensor(146.1558, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8358289990574121
distance x is tensor(132.6259, device='cuda:3')
benign distance is  tensor(132.6259, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0572324935346842
distance x is tensor(100.1152, device='cuda:3')
benign distance is  tensor(100.1152, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6876602228730917
distance x is tensor(113.1258, device='cuda:3')
benign distance is  tensor(113.1258, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.713621137663722
distance x is tensor(90.6620, device='cuda:3')
benign distance is  tensor(90.6620, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.83900000016
mal_loss is 0.7556497696787119
mal_entropy is 0.1379843014292419
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([442.0676, 423.5750, 541.3583, 790.2054, 364.4110, 406.7020, 462.9269,
        176.9345, 388.1247, 388.1247, 388.1247, 388.1247, 388.1247, 388.1247,
        388.1247, 388.1247, 388.1247, 388.1247, 388.1247, 388.1247],
       device='cuda:3')
sorted_norm is   tensor([176.9345, 364.4110, 388.1247, 388.1247, 388.1247, 388.1247, 388.1247,
        388.1247, 388.1247, 388.1247, 388.1247, 388.1247, 388.1247, 388.1247,
        406.7020, 423.5750, 442.0676, 462.9269, 541.3583, 790.2054],
       device='cuda:3')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  5,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 95.12% 

Test Accuracy: 86.42% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9062017872929573
distance x is tensor(144.1909, device='cuda:3')
benign distance is  tensor(144.1909, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0270079299807549
distance x is tensor(126.5477, device='cuda:3')
benign distance is  tensor(126.5477, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7438580803573132
distance x is tensor(140.5796, device='cuda:3')
benign distance is  tensor(140.5796, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0848680343478918
distance x is tensor(200.2945, device='cuda:3')
benign distance is  tensor(200.2945, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.329092413187027
distance x is tensor(94.8090, device='cuda:3')
benign distance is  tensor(94.8090, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8536394718103111
distance x is tensor(114.0676, device='cuda:3')
benign distance is  tensor(114.0676, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9545307625085115
distance x is tensor(127.6359, device='cuda:3')
benign distance is  tensor(127.6359, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7867134585976601
distance x is tensor(69.5984, device='cuda:3')
benign distance is  tensor(69.5984, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.84500000016
mal_loss is 0.829838503152132
mal_entropy is 0.09974201256409287
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 633.9339,  564.1791,  617.1302,  853.1758,  412.8461,  474.2402,
         553.5980,  306.8231,  306.8231,  306.8231,  306.8231,  306.8231,
         306.8231,  306.8231,  306.8231,  306.8231,  306.8231,  306.8231,
         306.8231,  306.8231,  662.0748,  769.5083,  832.8585,  614.2286,
         903.3257,  746.3198,  646.9034,  512.9421,  602.3502,  686.1107,
         658.9797,  795.3602,  521.4335, 1056.2510,  875.1138,  426.2975,
         562.9523,  729.4656,  490.5871,  642.6661,  879.8613,  395.0894,
         722.1811,  467.2705], device='cuda:3')
sorted_norm is   tensor([ 306.8231,  306.8231,  306.8231,  306.8231,  306.8231,  306.8231,
         306.8231,  306.8231,  306.8231,  306.8231,  306.8231,  306.8231,
         306.8231,  395.0894,  412.8461,  426.2975,  467.2705,  474.2402,
         490.5871,  512.9421,  521.4335,  553.5980,  562.9523,  564.1791,
         602.3502,  614.2286,  617.1302,  633.9339,  642.6661,  646.9034,
         658.9797,  662.0748,  686.1107,  722.1811,  729.4656,  746.3198,
         769.5083,  795.3602,  832.8585,  853.1758,  875.1138,  879.8613,
         903.3257, 1056.2510], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 41,  4, 35, 43,  5,
        38, 27, 32,  6, 36,  1, 28, 23,  2,  0, 39, 26, 30, 20, 29, 42, 37],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 91.07% 

Test Accuracy: 88.17% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8113761339336634
distance x is tensor(122.8105, device='cuda:3')
benign distance is  tensor(122.8105, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8818987980484962
distance x is tensor(105.9555, device='cuda:3')
benign distance is  tensor(105.9555, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8148844242095947
distance x is tensor(118.8008, device='cuda:3')
benign distance is  tensor(118.8008, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.013266284018755
distance x is tensor(181.7331, device='cuda:3')
benign distance is  tensor(181.7331, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0366225261241198
distance x is tensor(94.6425, device='cuda:3')
benign distance is  tensor(94.6425, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7706246599555016
distance x is tensor(94.5012, device='cuda:3')
benign distance is  tensor(94.5012, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3728899247944355
distance x is tensor(100.8245, device='cuda:3')
benign distance is  tensor(100.8245, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7570763602852821
distance x is tensor(33.0693, device='cuda:3')
benign distance is  tensor(33.0693, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.119345173239708
distance x is tensor(120.6496, device='cuda:3')
benign distance is  tensor(120.6496, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7917409697547555
distance x is tensor(150.3545, device='cuda:3')
benign distance is  tensor(150.3545, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0752333514392376
distance x is tensor(79.5645, device='cuda:3')
benign distance is  tensor(79.5645, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3672757558524609
distance x is tensor(137.4129, device='cuda:3')
benign distance is  tensor(137.4129, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0059235915541649
distance x is tensor(193.2633, device='cuda:3')
benign distance is  tensor(193.2633, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7570961229503155
distance x is tensor(72.6259, device='cuda:3')
benign distance is  tensor(72.6259, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8366146627813578
distance x is tensor(159.5828, device='cuda:3')
benign distance is  tensor(159.5828, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2453581504523754
distance x is tensor(99.4698, device='cuda:3')
benign distance is  tensor(99.4698, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1250495500862598
distance x is tensor(107.6181, device='cuda:3')
benign distance is  tensor(107.6181, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7625556271523237
distance x is tensor(132.2291, device='cuda:3')
benign distance is  tensor(132.2291, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1524119302630424
distance x is tensor(145.0259, device='cuda:3')
benign distance is  tensor(145.0259, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6989790573716164
distance x is tensor(149.0560, device='cuda:3')
benign distance is  tensor(149.0560, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1239024717360735
distance x is tensor(97.7298, device='cuda:3')
benign distance is  tensor(97.7298, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6982652153819799
distance x is tensor(240.6669, device='cuda:3')
benign distance is  tensor(240.6669, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0501295700669289
distance x is tensor(173.6120, device='cuda:3')
benign distance is  tensor(173.6120, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6713337870314717
distance x is tensor(70.8469, device='cuda:3')
benign distance is  tensor(70.8469, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1112060993909836
distance x is tensor(128.3584, device='cuda:3')
benign distance is  tensor(128.3584, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.365401741117239
distance x is tensor(164.8956, device='cuda:3')
benign distance is  tensor(164.8956, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2080210708081722
distance x is tensor(168.5140, device='cuda:3')
benign distance is  tensor(168.5140, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8663185685873032
distance x is tensor(118.3573, device='cuda:3')
benign distance is  tensor(118.3573, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.704371739178896
distance x is tensor(188.0209, device='cuda:3')
benign distance is  tensor(188.0209, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9050446674227715
distance x is tensor(162.1305, device='cuda:3')
benign distance is  tensor(162.1305, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8234990388154984
distance x is tensor(115.5418, device='cuda:3')
benign distance is  tensor(115.5418, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6621025446802378
distance x is tensor(90.1797, device='cuda:3')
benign distance is  tensor(90.1797, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.86900000016
mal_loss is 0.696050014346838
mal_entropy is 0.10839952924288809
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([531.6470, 478.8632, 516.4261, 799.5223, 402.3399, 418.2466, 433.5578,
        144.4916, 374.1223, 374.1223, 374.1223, 374.1223, 374.1223, 374.1223,
        374.1223, 374.1223, 374.1223, 374.1223, 374.1223, 374.1223],
       device='cuda:3')
sorted_norm is   tensor([144.4916, 374.1223, 374.1223, 374.1223, 374.1223, 374.1223, 374.1223,
        374.1223, 374.1223, 374.1223, 374.1223, 374.1223, 374.1223, 402.3399,
        418.2466, 433.5578, 478.8632, 516.4261, 531.6470, 799.5223],
       device='cuda:3')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  5,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 92.15% 

Test Accuracy: 88.11% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.951659681275487
distance x is tensor(131.9020, device='cuda:3')
benign distance is  tensor(131.9020, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.001226620748639
distance x is tensor(133.9460, device='cuda:3')
benign distance is  tensor(133.9460, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8958036806434393
distance x is tensor(135.6558, device='cuda:3')
benign distance is  tensor(135.6558, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9893070943653584
distance x is tensor(186.1829, device='cuda:3')
benign distance is  tensor(186.1829, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.098199911415577
distance x is tensor(108.3372, device='cuda:3')
benign distance is  tensor(108.3372, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7841642089188099
distance x is tensor(114.2568, device='cuda:3')
benign distance is  tensor(114.2568, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4694619961082935
distance x is tensor(122.7779, device='cuda:3')
benign distance is  tensor(122.7779, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7572335470467806
distance x is tensor(66.2420, device='cuda:3')
benign distance is  tensor(66.2420, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.86200000016
mal_loss is 0.6898313481360674
mal_entropy is 0.1081484011374414
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([577.3888, 582.8491, 589.5610, 799.7347, 461.7554, 486.7589, 531.7992,
        284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 284.7141,
        284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 700.6813,
        538.4979, 731.9184, 663.2614, 707.0149, 609.4043, 663.0742, 881.2004,
        588.5047, 715.0579, 454.2914, 674.9693, 895.9423, 420.8769, 734.1722,
        515.5020], device='cuda:3')
sorted_norm is   tensor([284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 284.7141,
        284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 284.7141, 420.8769,
        454.2914, 461.7554, 486.7589, 515.5020, 531.7992, 538.4979, 577.3888,
        582.8491, 588.5047, 589.5610, 609.4043, 663.0742, 663.2614, 674.9693,
        700.6813, 707.0149, 715.0579, 731.9184, 734.1722, 799.7347, 881.2004,
        895.9423], device='cuda:3')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 33, 30,  4,  5, 35,
         6, 21,  0,  1, 28,  2, 25, 26, 23, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 90.52% 

Test Accuracy: 87.86% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9066190049052238
distance x is tensor(136.7697, device='cuda:3')
benign distance is  tensor(136.7697, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.918952377513051
distance x is tensor(117.2052, device='cuda:3')
benign distance is  tensor(117.2052, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7056428641080856
distance x is tensor(119.9813, device='cuda:3')
benign distance is  tensor(119.9813, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0978338979184628
distance x is tensor(174.1615, device='cuda:3')
benign distance is  tensor(174.1615, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9558619186282158
distance x is tensor(93.8550, device='cuda:3')
benign distance is  tensor(93.8550, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7935593747533858
distance x is tensor(105.5748, device='cuda:3')
benign distance is  tensor(105.5748, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.285194106400013
distance x is tensor(104.2547, device='cuda:3')
benign distance is  tensor(104.2547, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6214099889621139
distance x is tensor(31.7532, device='cuda:3')
benign distance is  tensor(31.7532, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9379525575786829
distance x is tensor(112.7122, device='cuda:3')
benign distance is  tensor(112.7122, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6729415073059499
distance x is tensor(143.8749, device='cuda:3')
benign distance is  tensor(143.8749, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.010373568162322
distance x is tensor(82.4572, device='cuda:3')
benign distance is  tensor(82.4572, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.184791810810566
distance x is tensor(123.8811, device='cuda:3')
benign distance is  tensor(123.8811, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2450115717947483
distance x is tensor(207.2137, device='cuda:3')
benign distance is  tensor(207.2137, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.777065934613347
distance x is tensor(73.1650, device='cuda:3')
benign distance is  tensor(73.1650, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.170092947781086
distance x is tensor(163.1816, device='cuda:3')
benign distance is  tensor(163.1816, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5834875591099262
distance x is tensor(88.6148, device='cuda:3')
benign distance is  tensor(88.6148, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9928396251052618
distance x is tensor(145.2690, device='cuda:3')
benign distance is  tensor(145.2690, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6041091866791248
distance x is tensor(93.5638, device='cuda:3')
benign distance is  tensor(93.5638, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9085136651992798
distance x is tensor(162.8743, device='cuda:3')
benign distance is  tensor(162.8743, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2613868415355682
distance x is tensor(124.9922, device='cuda:3')
benign distance is  tensor(124.9922, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7117268927395344
distance x is tensor(134.7705, device='cuda:3')
benign distance is  tensor(134.7705, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8321757726371288
distance x is tensor(140.5647, device='cuda:3')
benign distance is  tensor(140.5647, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5873514637351036
distance x is tensor(130.4804, device='cuda:3')
benign distance is  tensor(130.4804, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8380679618567228
distance x is tensor(198.3693, device='cuda:3')
benign distance is  tensor(198.3693, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.79600000016
mal_loss is 0.812481515109539
mal_entropy is 0.22527531255036592
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 602.2325,  529.7215,  528.0922,  757.8973,  400.4685,  452.2428,
         457.1108,  146.5396,  853.9852,  853.9852,  853.9852,  853.9852,
         853.9852,  853.9852,  853.9852,  853.9852,  853.9852,  853.9852,
         853.9852,  853.9852,  645.5685,  539.9203,  848.8965,  687.1509,
         623.9046,  506.7813,  564.4145,  378.5280,  523.6525,  610.4366,
         649.8382,  679.1678,  452.5862, 1048.3240,  778.8013,  380.5725],
       device='cuda:3')
sorted_norm is   tensor([ 146.5396,  378.5280,  380.5725,  400.4685,  452.2428,  452.5862,
         457.1108,  506.7813,  523.6525,  528.0922,  529.7215,  539.9203,
         564.4145,  602.2325,  610.4366,  623.9046,  645.5685,  649.8382,
         679.1678,  687.1509,  757.8973,  778.8013,  848.8965,  853.9852,
         853.9852,  853.9852,  853.9852,  853.9852,  853.9852,  853.9852,
         853.9852,  853.9852,  853.9852,  853.9852,  853.9852, 1048.3240],
       device='cuda:3')
used idx is  tensor([ 7, 27, 35,  4,  5, 32,  6, 25, 28,  2,  1, 21, 26,  0, 29, 24, 20, 30,
        31, 23,  3, 34, 22, 11, 19,  9, 13, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 90.71% 

Test Accuracy: 88.42% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.778508884832263
distance x is tensor(115.3084, device='cuda:3')
benign distance is  tensor(115.3084, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8351845555007458
distance x is tensor(105.9374, device='cuda:3')
benign distance is  tensor(105.9374, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6695575211197138
distance x is tensor(119.0503, device='cuda:3')
benign distance is  tensor(119.0503, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9831357002258301
distance x is tensor(179.8454, device='cuda:3')
benign distance is  tensor(179.8454, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9513792330399156
distance x is tensor(82.4186, device='cuda:3')
benign distance is  tensor(82.4186, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.630248146597296
distance x is tensor(84.4598, device='cuda:3')
benign distance is  tensor(84.4598, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.188483253121376
distance x is tensor(73.3934, device='cuda:3')
benign distance is  tensor(73.3934, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.660649849101901
distance x is tensor(38.4416, device='cuda:3')
benign distance is  tensor(38.4416, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0795668326318264
distance x is tensor(97.8438, device='cuda:3')
benign distance is  tensor(97.8438, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.791904591023922
distance x is tensor(116.9446, device='cuda:3')
benign distance is  tensor(116.9446, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.755860204808414
distance x is tensor(128.5893, device='cuda:3')
benign distance is  tensor(128.5893, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7978081498295069
distance x is tensor(135.0384, device='cuda:3')
benign distance is  tensor(135.0384, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.859318932518363
distance x is tensor(63.0681, device='cuda:3')
benign distance is  tensor(63.0681, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7520374339073896
distance x is tensor(224.2363, device='cuda:3')
benign distance is  tensor(224.2363, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1613183841109276
distance x is tensor(158.6139, device='cuda:3')
benign distance is  tensor(158.6139, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5681749489158392
distance x is tensor(54.9799, device='cuda:3')
benign distance is  tensor(54.9799, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7917018868029118
distance x is tensor(123.9769, device='cuda:3')
benign distance is  tensor(123.9769, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9801758490502834
distance x is tensor(115.2882, device='cuda:3')
benign distance is  tensor(115.2882, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.67863654717803
distance x is tensor(157.8865, device='cuda:3')
benign distance is  tensor(157.8865, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.6156813018023968
distance x is tensor(148.7418, device='cuda:3')
benign distance is  tensor(148.7418, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7539317291229963
distance x is tensor(120.6165, device='cuda:3')
benign distance is  tensor(120.6165, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7865158319473267
distance x is tensor(89.4908, device='cuda:3')
benign distance is  tensor(89.4908, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6805955097079277
distance x is tensor(88.5794, device='cuda:3')
benign distance is  tensor(88.5794, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.894413910806179
distance x is tensor(67.8680, device='cuda:3')
benign distance is  tensor(67.8680, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.82900000016
mal_loss is 0.9008840620517731
mal_entropy is 0.11757923802360892
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([506.4818, 475.8294, 525.6025, 773.7401, 335.6894, 357.9817, 325.3371,
        156.5038, 283.0930, 283.0929, 283.0930, 283.0929, 283.0930, 283.0929,
        283.0930, 283.0929, 283.0930, 283.0929, 283.0930, 283.0929, 536.7372,
        648.5502, 423.1051, 588.8671, 954.8700, 379.3439, 727.8660, 439.6139],
       device='cuda:3')
sorted_norm is   tensor([156.5038, 283.0929, 283.0929, 283.0929, 283.0929, 283.0929, 283.0929,
        283.0930, 283.0930, 283.0930, 283.0930, 283.0930, 283.0930, 325.3371,
        335.6894, 357.9817, 379.3439, 423.1051, 439.6139, 475.8294, 506.4818,
        525.6025, 536.7372, 588.8671, 648.5502, 727.8660, 773.7401, 954.8700],
       device='cuda:3')
used idx is  tensor([ 7, 19, 15, 17, 13,  9, 11, 16,  8, 12, 10, 18, 14,  6,  4,  5, 25, 22,
        27,  1,  0,  2], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 95.20% 

Test Accuracy: 88.38% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7652940917760134
distance x is tensor(134.5792, device='cuda:3')
benign distance is  tensor(134.5792, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9595884885638952
distance x is tensor(118.9537, device='cuda:3')
benign distance is  tensor(118.9537, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7275525406002998
distance x is tensor(142.0102, device='cuda:3')
benign distance is  tensor(142.0102, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.786186208948493
distance x is tensor(182.8363, device='cuda:3')
benign distance is  tensor(182.8363, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.168390791863203
distance x is tensor(86.2762, device='cuda:3')
benign distance is  tensor(86.2762, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7837939206510782
distance x is tensor(132.8760, device='cuda:3')
benign distance is  tensor(132.8760, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2732757646590471
distance x is tensor(101.6027, device='cuda:3')
benign distance is  tensor(101.6027, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7053732005879283
distance x is tensor(42.9029, device='cuda:3')
benign distance is  tensor(42.9029, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2983377538621426
distance x is tensor(131.1095, device='cuda:3')
benign distance is  tensor(131.1095, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5807607807219028
distance x is tensor(143.7254, device='cuda:3')
benign distance is  tensor(143.7254, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.217213574796915
distance x is tensor(95.0068, device='cuda:3')
benign distance is  tensor(95.0068, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.858549304306507
distance x is tensor(142.0983, device='cuda:3')
benign distance is  tensor(142.0983, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1504706367850304
distance x is tensor(193.2796, device='cuda:3')
benign distance is  tensor(193.2796, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7317708265036345
distance x is tensor(75.2949, device='cuda:3')
benign distance is  tensor(75.2949, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0910813752561808
distance x is tensor(165.6861, device='cuda:3')
benign distance is  tensor(165.6861, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1062327213585377
distance x is tensor(95.4327, device='cuda:3')
benign distance is  tensor(95.4327, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.79600000016
mal_loss is 1.116532227024436
mal_entropy is 0.1374697322025895
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([589.6295, 539.8934, 639.8284, 795.2715, 371.1869, 574.2194, 440.3849,
        184.0418, 407.4352, 407.4352, 407.4352, 407.4352, 407.4352, 407.4352,
        407.4352, 407.4352, 407.4352, 407.4352, 407.4352, 407.4352],
       device='cuda:3')
sorted_norm is   tensor([184.0418, 371.1869, 407.4352, 407.4352, 407.4352, 407.4352, 407.4352,
        407.4352, 407.4352, 407.4352, 407.4352, 407.4352, 407.4352, 407.4352,
        440.3849, 539.8934, 574.2194, 589.6295, 639.8284, 795.2715],
       device='cuda:3')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  6,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 87.70% 

Test Accuracy: 85.08% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9434861931949854
distance x is tensor(138.1196, device='cuda:3')
benign distance is  tensor(138.1196, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7916345689445734
distance x is tensor(111.9964, device='cuda:3')
benign distance is  tensor(111.9964, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7296343892812729
distance x is tensor(143.3804, device='cuda:3')
benign distance is  tensor(143.3804, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8606557156890631
distance x is tensor(184.2477, device='cuda:3')
benign distance is  tensor(184.2477, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6789196152240038
distance x is tensor(119.8569, device='cuda:3')
benign distance is  tensor(119.8569, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8085073111578822
distance x is tensor(112.4484, device='cuda:3')
benign distance is  tensor(112.4484, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.68487910926342
distance x is tensor(117.7872, device='cuda:3')
benign distance is  tensor(117.7872, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7276716306805611
distance x is tensor(74.7086, device='cuda:3')
benign distance is  tensor(74.7086, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85000000016
mal_loss is 0.7580179255455732
mal_entropy is 0.1254410119727254
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 590.5126,  491.9261,  611.5259,  795.1373,  514.9074,  481.7881,
         502.9200,  307.6260,  307.6260,  307.6260,  307.6260,  307.6260,
         307.6260,  307.6260,  307.6260,  307.6260,  307.6260,  307.6260,
         307.6260,  307.6260,  656.4975,  798.1880,  804.8752,  638.5717,
         885.3721,  790.2198,  624.8866,  477.7764,  726.1364,  562.4277,
         798.8654,  666.9969,  701.6296,  740.9435,  691.3013,  815.9000,
         546.1604,  601.6437,  636.8410,  692.1725,  430.1544, 1035.7733,
         778.5153,  416.6447,  630.7710,  685.7856,  514.1080,  675.2672,
         881.6495,  441.5871,  766.3272,  112.5422], device='cuda:3')
sorted_norm is   tensor([ 112.5422,  307.6260,  307.6260,  307.6260,  307.6260,  307.6260,
         307.6260,  307.6260,  307.6260,  307.6260,  307.6260,  307.6260,
         307.6260,  307.6260,  416.6447,  430.1544,  441.5871,  477.7764,
         481.7881,  491.9261,  502.9200,  514.1080,  514.9074,  546.1604,
         562.4277,  590.5126,  601.6437,  611.5259,  624.8866,  630.7710,
         636.8410,  638.5717,  656.4975,  666.9969,  675.2672,  685.7856,
         691.3013,  692.1725,  701.6296,  726.1364,  740.9435,  766.3272,
         778.5153,  790.2198,  795.1373,  798.1880,  798.8654,  804.8752,
         815.9000,  881.6495,  885.3721, 1035.7733], device='cuda:3')
used idx is  tensor([51, 10, 18, 16, 12,  8, 14, 17,  7, 13, 15, 11,  9, 19, 43, 40, 49, 27,
         5,  1,  6, 46,  4, 36, 29,  0, 37,  2, 26, 44, 38, 23, 20, 31, 47, 45,
        34, 39, 32, 28, 33], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 90.58% 

Test Accuracy: 88.24% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6825485108420253
distance x is tensor(141.7860, device='cuda:3')
benign distance is  tensor(141.7860, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0208826661109924
distance x is tensor(105.2880, device='cuda:3')
benign distance is  tensor(105.2880, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9863176643848419
distance x is tensor(122.3612, device='cuda:3')
benign distance is  tensor(122.3612, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8878480456769466
distance x is tensor(178.2211, device='cuda:3')
benign distance is  tensor(178.2211, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9278665399178863
distance x is tensor(76.3664, device='cuda:3')
benign distance is  tensor(76.3664, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.697892174590379
distance x is tensor(99.2188, device='cuda:3')
benign distance is  tensor(99.2188, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0970849078148603
distance x is tensor(70.8165, device='cuda:3')
benign distance is  tensor(70.8165, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5841840421780944
distance x is tensor(30.6285, device='cuda:3')
benign distance is  tensor(30.6285, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0234125051647425
distance x is tensor(125.7500, device='cuda:3')
benign distance is  tensor(125.7500, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6504420787096024
distance x is tensor(142.6540, device='cuda:3')
benign distance is  tensor(142.6540, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1564805340021849
distance x is tensor(72.4915, device='cuda:3')
benign distance is  tensor(72.4915, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4140391163527966
distance x is tensor(142.9053, device='cuda:3')
benign distance is  tensor(142.9053, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9378427974879742
distance x is tensor(183.8270, device='cuda:3')
benign distance is  tensor(183.8270, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6638919822871685
distance x is tensor(63.2475, device='cuda:3')
benign distance is  tensor(63.2475, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0348162073642015
distance x is tensor(159.9992, device='cuda:3')
benign distance is  tensor(159.9992, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0711175939068198
distance x is tensor(66.7464, device='cuda:3')
benign distance is  tensor(66.7464, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1138214766979218
distance x is tensor(106.8798, device='cuda:3')
benign distance is  tensor(106.8798, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6749329185113311
distance x is tensor(128.0861, device='cuda:3')
benign distance is  tensor(128.0861, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.007601291872561
distance x is tensor(141.3596, device='cuda:3')
benign distance is  tensor(141.3596, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8714207876473665
distance x is tensor(136.5850, device='cuda:3')
benign distance is  tensor(136.5850, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1521847620606422
distance x is tensor(91.7247, device='cuda:3')
benign distance is  tensor(91.7247, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7711365390568972
distance x is tensor(230.4245, device='cuda:3')
benign distance is  tensor(230.4245, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.995515488088131
distance x is tensor(167.0654, device='cuda:3')
benign distance is  tensor(167.0654, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6089907474815845
distance x is tensor(62.1352, device='cuda:3')
benign distance is  tensor(62.1352, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0308892466127872
distance x is tensor(148.3111, device='cuda:3')
benign distance is  tensor(148.3111, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5919565008953214
distance x is tensor(91.3298, device='cuda:3')
benign distance is  tensor(91.3298, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0062567964196205
distance x is tensor(154.9326, device='cuda:3')
benign distance is  tensor(154.9326, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.23367340862751
distance x is tensor(127.5447, device='cuda:3')
benign distance is  tensor(127.5447, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6611548457294703
distance x is tensor(132.0146, device='cuda:3')
benign distance is  tensor(132.0146, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7227455507963896
distance x is tensor(115.4078, device='cuda:3')
benign distance is  tensor(115.4078, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5397927761077881
distance x is tensor(130.2345, device='cuda:3')
benign distance is  tensor(130.2345, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7266169171780348
distance x is tensor(179.3562, device='cuda:3')
benign distance is  tensor(179.3562, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3427648600190878
distance x is tensor(137.0163, device='cuda:3')
benign distance is  tensor(137.0163, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2567629590630531
distance x is tensor(183.2429, device='cuda:3')
benign distance is  tensor(183.2429, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1144997291266918
distance x is tensor(170.3595, device='cuda:3')
benign distance is  tensor(170.3595, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8474034778773785
distance x is tensor(107.6002, device='cuda:3')
benign distance is  tensor(107.6002, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6457746736705303
distance x is tensor(183.7854, device='cuda:3')
benign distance is  tensor(183.7854, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8013134840875864
distance x is tensor(163.0847, device='cuda:3')
benign distance is  tensor(163.0847, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9792303591966629
distance x is tensor(115.5739, device='cuda:3')
benign distance is  tensor(115.5739, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6619339762255549
distance x is tensor(71.9699, device='cuda:3')
benign distance is  tensor(71.9699, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.86200000016
mal_loss is 0.6863506445661187
mal_entropy is 0.10268693463876843
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([613.7686, 468.8251, 546.2549, 776.8202, 326.2269, 422.0525, 304.0201,
        128.5522, 307.5560, 307.5560, 307.5560, 307.5560, 307.5560, 307.5560,
        307.5560, 307.5560, 307.5560, 307.5560, 307.5560, 307.5560],
       device='cuda:3')
sorted_norm is   tensor([128.5522, 304.0201, 307.5560, 307.5560, 307.5560, 307.5560, 307.5560,
        307.5560, 307.5560, 307.5560, 307.5560, 307.5560, 307.5560, 307.5560,
        326.2269, 422.0525, 468.8251, 546.2549, 613.7686, 776.8202],
       device='cuda:3')
used idx is  tensor([ 7,  6, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  4,  5],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 90.16% 

Test Accuracy: 87.59% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8880692180246115
distance x is tensor(146.0360, device='cuda:3')
benign distance is  tensor(146.0360, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8209281414747238
distance x is tensor(127.4618, device='cuda:3')
benign distance is  tensor(127.4618, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8098923452198505
distance x is tensor(133.8253, device='cuda:3')
benign distance is  tensor(133.8253, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8144083358347416
distance x is tensor(195.8861, device='cuda:3')
benign distance is  tensor(195.8861, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8930736109614372
distance x is tensor(102.7093, device='cuda:3')
benign distance is  tensor(102.7093, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8373710024170578
distance x is tensor(109.5488, device='cuda:3')
benign distance is  tensor(109.5488, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.179998142644763
distance x is tensor(110.2144, device='cuda:3')
benign distance is  tensor(110.2144, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.762449361383915
distance x is tensor(50.4396, device='cuda:3')
benign distance is  tensor(50.4396, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.85700000016
mal_loss is 0.6591397859156132
mal_entropy is 0.09957590140402317
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([634.8374, 554.3674, 573.4498, 825.3340, 456.5797, 477.6842, 497.0662,
        212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 212.1603,
        212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 628.9421,
        584.0914, 754.4783, 707.0738, 608.9019, 498.9752, 499.4448, 367.8253,
        577.4877, 667.7308, 399.7990, 667.8100, 830.6458, 349.5797, 719.7246,
        373.1246], device='cuda:3')
sorted_norm is   tensor([212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 212.1603,
        212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 212.1603, 349.5797,
        367.8253, 373.1246, 399.7990, 456.5797, 477.6842, 497.0662, 498.9752,
        499.4448, 554.3674, 573.4498, 577.4877, 584.0914, 608.9019, 628.9421,
        634.8374, 667.7308, 667.8100, 707.0738, 719.7246, 754.4783, 825.3340,
        830.6458], device='cuda:3')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19,  7, 13,  9, 15, 11, 33, 27, 35, 30,  4,
         5,  6, 25, 26,  1,  2, 28, 21, 24, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 90.26% 

Test Accuracy: 87.99% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 90.26%
|----0th round Training Accuracy : 93.27%
|----1th round Training Accuracy : 91.65%
|----2th round Training Accuracy : 86.50%
|----3th round Training Accuracy : 90.26%
|----4th round Training Accuracy : 91.83%
|----5th round Training Accuracy : 93.14%
|----6th round Training Accuracy : 92.83%
|----7th round Training Accuracy : 91.17%
|----8th round Training Accuracy : 89.50%
|----9th round Training Accuracy : 88.84%
|----10th round Training Accuracy : 95.01%
|----11th round Training Accuracy : 90.64%
|----12th round Training Accuracy : 91.77%
|----13th round Training Accuracy : 89.85%
|----14th round Training Accuracy : 88.37%
|----15th round Training Accuracy : 94.97%
|----16th round Training Accuracy : 92.83%
|----17th round Training Accuracy : 90.04%
|----18th round Training Accuracy : 92.63%
|----19th round Training Accuracy : 90.26%
|----20th round Training Accuracy : 95.29%
|----21th round Training Accuracy : 88.15%
|----22th round Training Accuracy : 82.84%
|----23th round Training Accuracy : 88.02%
|----24th round Training Accuracy : 93.59%
|----25th round Training Accuracy : 94.63%
|----26th round Training Accuracy : 89.01%
|----27th round Training Accuracy : 90.14%
|----28th round Training Accuracy : 90.17%
|----29th round Training Accuracy : 89.54%
|----30th round Training Accuracy : 93.12%
|----31th round Training Accuracy : 90.67%
|----32th round Training Accuracy : 89.62%
|----33th round Training Accuracy : 89.91%
|----34th round Training Accuracy : 88.31%
|----35th round Training Accuracy : 93.11%
|----36th round Training Accuracy : 92.35%
|----37th round Training Accuracy : 91.01%
|----38th round Training Accuracy : 87.70%
|----39th round Training Accuracy : 90.01%
|----40th round Training Accuracy : 95.12%
|----41th round Training Accuracy : 91.07%
|----42th round Training Accuracy : 92.15%
|----43th round Training Accuracy : 90.52%
|----44th round Training Accuracy : 90.71%
|----45th round Training Accuracy : 95.20%
|----46th round Training Accuracy : 87.70%
|----47th round Training Accuracy : 90.58%
|----48th round Training Accuracy : 90.16%
|----49th round Training Accuracy : 90.26%
|----Final Test Accuracy: 87.99%
|----0th round Final Test Accuracy : 87.50%
|----1th round Final Test Accuracy : 86.98%
|----2th round Final Test Accuracy : 84.75%
|----3th round Final Test Accuracy : 87.57%
|----4th round Final Test Accuracy : 87.91%
|----5th round Final Test Accuracy : 88.01%
|----6th round Final Test Accuracy : 87.66%
|----7th round Final Test Accuracy : 87.32%
|----8th round Final Test Accuracy : 87.66%
|----9th round Final Test Accuracy : 87.18%
|----10th round Final Test Accuracy : 87.14%
|----11th round Final Test Accuracy : 87.94%
|----12th round Final Test Accuracy : 86.93%
|----13th round Final Test Accuracy : 87.09%
|----14th round Final Test Accuracy : 86.61%
|----15th round Final Test Accuracy : 88.83%
|----16th round Final Test Accuracy : 87.73%
|----17th round Final Test Accuracy : 87.80%
|----18th round Final Test Accuracy : 87.15%
|----19th round Final Test Accuracy : 88.12%
|----20th round Final Test Accuracy : 87.20%
|----21th round Final Test Accuracy : 86.98%
|----22th round Final Test Accuracy : 84.07%
|----23th round Final Test Accuracy : 87.53%
|----24th round Final Test Accuracy : 88.46%
|----25th round Final Test Accuracy : 88.40%
|----26th round Final Test Accuracy : 86.34%
|----27th round Final Test Accuracy : 88.02%
|----28th round Final Test Accuracy : 87.55%
|----29th round Final Test Accuracy : 88.12%
|----30th round Final Test Accuracy : 88.15%
|----31th round Final Test Accuracy : 87.42%
|----32th round Final Test Accuracy : 87.67%
|----33th round Final Test Accuracy : 87.61%
|----34th round Final Test Accuracy : 86.95%
|----35th round Final Test Accuracy : 89.12%
|----36th round Final Test Accuracy : 87.90%
|----37th round Final Test Accuracy : 87.68%
|----38th round Final Test Accuracy : 86.10%
|----39th round Final Test Accuracy : 87.90%
|----40th round Final Test Accuracy : 86.42%
|----41th round Final Test Accuracy : 88.17%
|----42th round Final Test Accuracy : 88.11%
|----43th round Final Test Accuracy : 87.86%
|----44th round Final Test Accuracy : 88.42%
|----45th round Final Test Accuracy : 88.38%
|----46th round Final Test Accuracy : 85.08%
|----47th round Final Test Accuracy : 88.24%
|----48th round Final Test Accuracy : 87.59%
|----49th round Final Test Accuracy : 87.99%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 4295.2440
