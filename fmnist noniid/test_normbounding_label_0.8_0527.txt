
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5836149454116821
distance x is tensor(108.8479, device='cuda:3')
benign distance is  tensor(108.8479, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5722787380218506
distance x is tensor(121.4718, device='cuda:3')
benign distance is  tensor(121.4718, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4393135607242584
distance x is tensor(126.6974, device='cuda:3')
benign distance is  tensor(126.6974, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5282260775566101
distance x is tensor(119.2631, device='cuda:3')
benign distance is  tensor(119.2631, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0261714458465576
distance x is tensor(109.2973, device='cuda:3')
benign distance is  tensor(109.2973, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3787105083465576
distance x is tensor(125.7756, device='cuda:3')
benign distance is  tensor(125.7756, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.770846426486969
distance x is tensor(108.1719, device='cuda:3')
benign distance is  tensor(108.1719, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20896907150745392
distance x is tensor(126.4846, device='cuda:3')
benign distance is  tensor(126.4846, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.41811633110046387
distance x is tensor(144.6978, device='cuda:3')
benign distance is  tensor(144.6978, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3376739025115967
distance x is tensor(138.2278, device='cuda:3')
benign distance is  tensor(138.2278, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5384906530380249
distance x is tensor(124.7823, device='cuda:3')
benign distance is  tensor(124.7823, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2877494990825653
distance x is tensor(126.9197, device='cuda:3')
benign distance is  tensor(126.9197, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6574972867965698
distance x is tensor(124.9888, device='cuda:3')
benign distance is  tensor(124.9888, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.36129292845726013
distance x is tensor(141.6940, device='cuda:3')
benign distance is  tensor(141.6940, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8309507369995117
distance x is tensor(138.3014, device='cuda:3')
benign distance is  tensor(138.3014, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.434903621673584
distance x is tensor(135.7580, device='cuda:3')
benign distance is  tensor(135.7580, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1962963491678238
distance x is tensor(128.4993, device='cuda:3')
benign distance is  tensor(128.4993, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4926122725009918
distance x is tensor(147.9624, device='cuda:3')
benign distance is  tensor(147.9624, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4004369378089905
distance x is tensor(128.0243, device='cuda:3')
benign distance is  tensor(128.0243, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4468611776828766
distance x is tensor(122.8403, device='cuda:3')
benign distance is  tensor(122.8403, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1646377146244049
distance x is tensor(127.3545, device='cuda:3')
benign distance is  tensor(127.3545, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.12855634093284607
distance x is tensor(123.6480, device='cuda:3')
benign distance is  tensor(123.6480, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.23370274901390076
distance x is tensor(138.8184, device='cuda:3')
benign distance is  tensor(138.8184, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8950031399726868
distance x is tensor(130.9164, device='cuda:3')
benign distance is  tensor(130.9164, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.23824100196361542
distance x is tensor(147.3337, device='cuda:3')
benign distance is  tensor(147.3337, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5850363373756409
distance x is tensor(124.3962, device='cuda:3')
benign distance is  tensor(124.3962, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7266198992729187
distance x is tensor(142.3498, device='cuda:3')
benign distance is  tensor(142.3498, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.47751593589782715
distance x is tensor(134.2982, device='cuda:3')
benign distance is  tensor(134.2982, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7750272750854492
distance x is tensor(124.7629, device='cuda:3')
benign distance is  tensor(124.7629, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9327930212020874
distance x is tensor(135.2908, device='cuda:3')
benign distance is  tensor(135.2908, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6455098390579224
distance x is tensor(127.8464, device='cuda:3')
benign distance is  tensor(127.8464, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9989250898361206
distance x is tensor(135.6098, device='cuda:3')
benign distance is  tensor(135.6098, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.29643550515174866
distance x is tensor(135.8269, device='cuda:3')
benign distance is  tensor(135.8269, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.16768494248390198
distance x is tensor(124.2478, device='cuda:3')
benign distance is  tensor(124.2478, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5319634079933167
distance x is tensor(136.6082, device='cuda:3')
benign distance is  tensor(136.6082, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.029849175363779068
distance x is tensor(128.6200, device='cuda:3')
benign distance is  tensor(128.6200, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5827991366386414
distance x is tensor(133.2022, device='cuda:3')
benign distance is  tensor(133.2022, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.37604016065597534
distance x is tensor(123.3731, device='cuda:3')
benign distance is  tensor(123.3731, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.49307316541671753
distance x is tensor(128.1529, device='cuda:3')
benign distance is  tensor(128.1529, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.38361719250679016
distance x is tensor(132.1881, device='cuda:3')
benign distance is  tensor(132.1881, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1823057383298874
distance x is tensor(123.8615, device='cuda:3')
benign distance is  tensor(123.8615, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2552648186683655
distance x is tensor(122.1461, device='cuda:3')
benign distance is  tensor(122.1461, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.20934593677520752
distance x is tensor(130.9556, device='cuda:3')
benign distance is  tensor(130.9556, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.723971426486969
distance x is tensor(134.6093, device='cuda:3')
benign distance is  tensor(134.6093, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3585709035396576
distance x is tensor(141.8803, device='cuda:3')
benign distance is  tensor(141.8803, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7594778537750244
distance x is tensor(130.3589, device='cuda:3')
benign distance is  tensor(130.3589, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8095606565475464
distance x is tensor(137.4062, device='cuda:3')
benign distance is  tensor(137.4062, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.09178651869297028
distance x is tensor(139.4058, device='cuda:3')
benign distance is  tensor(139.4058, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  13.462751388549805
distance x is tensor(262.0895, device='cuda:3')
benign distance is  tensor(262.0895, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  11.962824821472168
distance x is tensor(270.0923, device='cuda:3')
benign distance is  tensor(270.0923, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.195773124694824
distance x is tensor(265.9990, device='cuda:3')
benign distance is  tensor(265.9990, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.696868896484375
distance x is tensor(258.0615, device='cuda:3')
benign distance is  tensor(258.0615, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.743446350097656
distance x is tensor(255.7538, device='cuda:3')
benign distance is  tensor(255.7538, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  13.833767890930176
distance x is tensor(256.5817, device='cuda:3')
benign distance is  tensor(256.5817, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.727169036865234
distance x is tensor(278.7218, device='cuda:3')
benign distance is  tensor(278.7218, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  5.833661079406738
distance x is tensor(242.9524, device='cuda:3')
benign distance is  tensor(242.9524, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.126041412353516
distance x is tensor(260.8622, device='cuda:3')
benign distance is  tensor(260.8622, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.938508987426758
distance x is tensor(260.0048, device='cuda:3')
benign distance is  tensor(260.0048, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.193578720092773
distance x is tensor(266.7913, device='cuda:3')
benign distance is  tensor(266.7913, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.466673851013184
distance x is tensor(249.3516, device='cuda:3')
benign distance is  tensor(249.3516, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 487.9260,  564.6692,  569.1618,  544.2873,  494.1015,  569.9163,
         484.8250,  587.3010, 1011.8965, 1061.6198, 1040.8341,  992.5832,
        1000.1462, 1010.9664, 1105.8239,  936.0634,  998.0367,  996.0905,
        1022.8320,  966.0891], device='cuda:3')
sorted_norm is   tensor([ 484.8250,  487.9260,  494.1015,  544.2873,  564.6692,  569.1618,
         569.9163,  587.3010,  936.0634,  966.0891,  992.5832,  996.0905,
         998.0367, 1000.1462, 1010.9664, 1011.8965, 1022.8320, 1040.8341,
        1061.6198, 1105.8239], device='cuda:3')
used idx is  tensor([ 6,  0,  4,  3,  1,  2,  5,  7, 15, 19, 11, 17, 16, 12, 13,  8],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 32.54% 

Test Accuracy: 31.61% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5284479856491089
distance x is tensor(157.5650, device='cuda:3')
benign distance is  tensor(157.5650, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.418765127658844
distance x is tensor(158.3796, device='cuda:3')
benign distance is  tensor(158.3796, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11578354984521866
distance x is tensor(160.8531, device='cuda:3')
benign distance is  tensor(160.8531, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4626133441925049
distance x is tensor(151.0614, device='cuda:3')
benign distance is  tensor(151.0614, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.38814422488212585
distance x is tensor(153.3181, device='cuda:3')
benign distance is  tensor(153.3181, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9685357809066772
distance x is tensor(161.8659, device='cuda:3')
benign distance is  tensor(161.8659, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4118204712867737
distance x is tensor(154.9147, device='cuda:3')
benign distance is  tensor(154.9147, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3499961495399475
distance x is tensor(168.5039, device='cuda:3')
benign distance is  tensor(168.5039, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.884127616882324
distance x is tensor(139.8125, device='cuda:3')
benign distance is  tensor(139.8125, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.682463645935059
distance x is tensor(142.1842, device='cuda:3')
benign distance is  tensor(142.1842, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.327367782592773
distance x is tensor(148.6902, device='cuda:3')
benign distance is  tensor(148.6902, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.04081916809082
distance x is tensor(145.7891, device='cuda:3')
benign distance is  tensor(145.7891, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  12.138612747192383
distance x is tensor(143.9101, device='cuda:3')
benign distance is  tensor(143.9101, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  12.729915618896484
distance x is tensor(146.4024, device='cuda:3')
benign distance is  tensor(146.4024, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.135988235473633
distance x is tensor(147.6798, device='cuda:3')
benign distance is  tensor(147.6798, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  12.172338485717773
distance x is tensor(144.7950, device='cuda:3')
benign distance is  tensor(144.7950, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.512341499328613
distance x is tensor(145.7564, device='cuda:3')
benign distance is  tensor(145.7564, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.005013465881348
distance x is tensor(139.7514, device='cuda:3')
benign distance is  tensor(139.7514, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  11.748882293701172
distance x is tensor(149.7750, device='cuda:3')
benign distance is  tensor(149.7750, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  13.141453742980957
distance x is tensor(142.2925, device='cuda:3')
benign distance is  tensor(142.2925, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([665.1395, 673.0449, 686.4741, 639.1267, 638.3900, 683.3526, 636.1312,
        705.6122, 685.0098, 694.3148, 718.8074, 700.8032, 708.7915, 710.5312,
        726.5107, 713.4897, 709.9339, 689.9520, 718.0721, 691.7677, 740.1042,
        707.1971, 667.8723, 670.6086, 668.4359, 730.0460, 723.0643, 700.7279],
       device='cuda:3')
sorted_norm is   tensor([636.1312, 638.3900, 639.1267, 665.1395, 667.8723, 668.4359, 670.6086,
        673.0449, 683.3526, 685.0098, 686.4741, 689.9520, 691.7677, 694.3148,
        700.7279, 700.8032, 705.6122, 707.1971, 708.7915, 709.9339, 710.5312,
        713.4897, 718.0721, 718.8074, 723.0643, 726.5107, 730.0460, 740.1042],
       device='cuda:3')
used idx is  tensor([ 6,  4,  3,  0, 22, 24, 23,  1,  5,  8,  2, 17, 19,  9, 27, 11,  7, 21,
        12, 16, 13, 15], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 82.55% 

Test Accuracy: 82.15% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6287151575088501
distance x is tensor(122.0717, device='cuda:3')
benign distance is  tensor(122.0717, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7178864479064941
distance x is tensor(127.4441, device='cuda:3')
benign distance is  tensor(127.4441, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22809620201587677
distance x is tensor(136.5560, device='cuda:3')
benign distance is  tensor(136.5560, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3885955214500427
distance x is tensor(123.6953, device='cuda:3')
benign distance is  tensor(123.6953, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6472188234329224
distance x is tensor(107.1020, device='cuda:3')
benign distance is  tensor(107.1020, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6099700927734375
distance x is tensor(133.5139, device='cuda:3')
benign distance is  tensor(133.5139, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17660562694072723
distance x is tensor(115.4295, device='cuda:3')
benign distance is  tensor(115.4295, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7299104928970337
distance x is tensor(123.7167, device='cuda:3')
benign distance is  tensor(123.7167, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.33311980962753296
distance x is tensor(137.4566, device='cuda:3')
benign distance is  tensor(137.4566, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.19864384829998016
distance x is tensor(142.1482, device='cuda:3')
benign distance is  tensor(142.1482, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7368225455284119
distance x is tensor(138.9485, device='cuda:3')
benign distance is  tensor(138.9485, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7127485871315002
distance x is tensor(144.0292, device='cuda:3')
benign distance is  tensor(144.0292, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4043124318122864
distance x is tensor(133.3023, device='cuda:3')
benign distance is  tensor(133.3023, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.25326472520828247
distance x is tensor(135.4038, device='cuda:3')
benign distance is  tensor(135.4038, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5178016424179077
distance x is tensor(131.8663, device='cuda:3')
benign distance is  tensor(131.8663, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.43815499544143677
distance x is tensor(136.4716, device='cuda:3')
benign distance is  tensor(136.4716, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.521360397338867
distance x is tensor(156.3882, device='cuda:3')
benign distance is  tensor(156.3882, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.96660614013672
distance x is tensor(158.1530, device='cuda:3')
benign distance is  tensor(158.1530, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.41545295715332
distance x is tensor(163.2527, device='cuda:3')
benign distance is  tensor(163.2527, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.263522148132324
distance x is tensor(165.0787, device='cuda:3')
benign distance is  tensor(165.0787, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.40789794921875
distance x is tensor(160.8402, device='cuda:3')
benign distance is  tensor(160.8402, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  15.413983345031738
distance x is tensor(155.4698, device='cuda:3')
benign distance is  tensor(155.4698, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.7535982131958
distance x is tensor(163.1924, device='cuda:3')
benign distance is  tensor(163.1924, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.858485221862793
distance x is tensor(155.9209, device='cuda:3')
benign distance is  tensor(155.9209, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  13.147621154785156
distance x is tensor(160.5488, device='cuda:3')
benign distance is  tensor(160.5488, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.415616989135742
distance x is tensor(160.5542, device='cuda:3')
benign distance is  tensor(160.5542, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.743392944335938
distance x is tensor(165.8732, device='cuda:3')
benign distance is  tensor(165.8732, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  11.793485641479492
distance x is tensor(158.0151, device='cuda:3')
benign distance is  tensor(158.0151, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([547.2932, 575.0761, 588.3624, 518.8408, 456.7693, 591.4097, 503.1014,
        544.8273, 676.7742, 688.6270, 733.5029, 717.1345, 727.7277, 683.3746,
        727.3987, 701.5781, 710.4340, 719.3228, 725.2984, 696.9034, 651.1483,
        747.5174, 660.0639, 662.8904, 657.3097, 644.8558, 711.2460, 664.1828],
       device='cuda:3')
sorted_norm is   tensor([456.7693, 503.1014, 518.8408, 544.8273, 547.2932, 575.0761, 588.3624,
        591.4097, 644.8558, 651.1483, 657.3097, 660.0639, 662.8904, 664.1828,
        676.7742, 683.3746, 688.6270, 696.9034, 701.5781, 710.4340, 711.2460,
        717.1345, 719.3228, 725.2984, 727.3987, 727.7277, 733.5029, 747.5174],
       device='cuda:3')
used idx is  tensor([ 4,  6,  3,  7,  0,  1,  2,  5, 25, 20, 24, 22, 23, 27,  8, 13,  9, 19,
        15, 16, 26, 11], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 86.38% 

Test Accuracy: 85.37% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.053710710257291794
distance x is tensor(108.3299, device='cuda:3')
benign distance is  tensor(108.3299, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7861042618751526
distance x is tensor(130.3989, device='cuda:3')
benign distance is  tensor(130.3989, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4412810206413269
distance x is tensor(130.2274, device='cuda:3')
benign distance is  tensor(130.2274, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.918731689453125
distance x is tensor(117.1867, device='cuda:3')
benign distance is  tensor(117.1867, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8227680921554565
distance x is tensor(116.8268, device='cuda:3')
benign distance is  tensor(116.8268, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9664174318313599
distance x is tensor(135.1899, device='cuda:3')
benign distance is  tensor(135.1899, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8597806692123413
distance x is tensor(112.1631, device='cuda:3')
benign distance is  tensor(112.1631, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35170623660087585
distance x is tensor(120.5156, device='cuda:3')
benign distance is  tensor(120.5156, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.18974728882312775
distance x is tensor(133.9555, device='cuda:3')
benign distance is  tensor(133.9555, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.47079330682754517
distance x is tensor(151.1096, device='cuda:3')
benign distance is  tensor(151.1096, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16921429336071014
distance x is tensor(126.4852, device='cuda:3')
benign distance is  tensor(126.4852, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5110358595848083
distance x is tensor(138.6187, device='cuda:3')
benign distance is  tensor(138.6187, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.239798903465271
distance x is tensor(131.5110, device='cuda:3')
benign distance is  tensor(131.5110, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4644051492214203
distance x is tensor(129.8251, device='cuda:3')
benign distance is  tensor(129.8251, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5201928019523621
distance x is tensor(139.4671, device='cuda:3')
benign distance is  tensor(139.4671, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3845086693763733
distance x is tensor(123.6440, device='cuda:3')
benign distance is  tensor(123.6440, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.522668838500977
distance x is tensor(171.2198, device='cuda:3')
benign distance is  tensor(171.2198, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  12.271966934204102
distance x is tensor(168.6537, device='cuda:3')
benign distance is  tensor(168.6537, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.700101852416992
distance x is tensor(181.8416, device='cuda:3')
benign distance is  tensor(181.8416, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.771621704101562
distance x is tensor(169.8147, device='cuda:3')
benign distance is  tensor(169.8147, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  14.217645645141602
distance x is tensor(181.0075, device='cuda:3')
benign distance is  tensor(181.0075, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  13.548162460327148
distance x is tensor(177.8912, device='cuda:3')
benign distance is  tensor(177.8912, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.39726448059082
distance x is tensor(178.1867, device='cuda:3')
benign distance is  tensor(178.1867, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  12.035126686096191
distance x is tensor(167.4173, device='cuda:3')
benign distance is  tensor(167.4173, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.100367546081543
distance x is tensor(181.5320, device='cuda:3')
benign distance is  tensor(181.5320, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  13.431386947631836
distance x is tensor(166.5282, device='cuda:3')
benign distance is  tensor(166.5282, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.233197212219238
distance x is tensor(175.2263, device='cuda:3')
benign distance is  tensor(175.2263, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  11.969144821166992
distance x is tensor(167.6601, device='cuda:3')
benign distance is  tensor(167.6601, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([476.2466, 584.7194, 571.5699, 517.2195, 510.8624, 601.6171, 493.8156,
        541.1045, 723.7472, 726.4884, 765.8903, 740.3818, 771.3906, 759.6151,
        756.5504, 729.2427, 761.5865, 731.1946, 750.5228, 720.9133, 736.7145,
        623.5587, 706.4389, 658.6446, 642.1569, 691.3877, 653.3700, 694.6813,
        627.8155, 632.9579, 618.0370, 636.2345, 609.5027, 608.0292, 584.6011,
        600.4493], device='cuda:3')
sorted_norm is   tensor([476.2466, 493.8156, 510.8624, 517.2195, 541.1045, 571.5699, 584.6011,
        584.7194, 600.4493, 601.6171, 608.0292, 609.5027, 618.0370, 623.5587,
        627.8155, 632.9579, 636.2345, 642.1569, 653.3700, 658.6446, 691.3877,
        694.6813, 706.4389, 720.9133, 723.7472, 726.4884, 729.2427, 731.1946,
        736.7145, 740.3818, 750.5228, 756.5504, 759.6151, 761.5865, 765.8903,
        771.3906], device='cuda:3')
used idx is  tensor([ 0,  6,  4,  3,  7,  2, 34,  1, 35,  5, 33, 32, 30, 21, 28, 29, 31, 24,
        26, 23, 25, 27, 22, 19,  8,  9, 15, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 87.99% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5335259437561035
distance x is tensor(109.3122, device='cuda:3')
benign distance is  tensor(109.3122, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.645363986492157
distance x is tensor(119.7115, device='cuda:3')
benign distance is  tensor(119.7115, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17218954861164093
distance x is tensor(121.3997, device='cuda:3')
benign distance is  tensor(121.3997, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3739703893661499
distance x is tensor(107.0088, device='cuda:3')
benign distance is  tensor(107.0088, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7763592004776001
distance x is tensor(96.4314, device='cuda:3')
benign distance is  tensor(96.4314, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0926034450531006
distance x is tensor(110.3239, device='cuda:3')
benign distance is  tensor(110.3239, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4689275324344635
distance x is tensor(117.9519, device='cuda:3')
benign distance is  tensor(117.9519, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38002723455429077
distance x is tensor(110.9513, device='cuda:3')
benign distance is  tensor(110.9513, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3550952076911926
distance x is tensor(134.8723, device='cuda:3')
benign distance is  tensor(134.8723, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.26180943846702576
distance x is tensor(126.0272, device='cuda:3')
benign distance is  tensor(126.0272, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.406305730342865
distance x is tensor(119.8935, device='cuda:3')
benign distance is  tensor(119.8935, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8919164538383484
distance x is tensor(136.7856, device='cuda:3')
benign distance is  tensor(136.7856, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9068952798843384
distance x is tensor(118.1109, device='cuda:3')
benign distance is  tensor(118.1109, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.45489248633384705
distance x is tensor(127.6066, device='cuda:3')
benign distance is  tensor(127.6066, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3920533061027527
distance x is tensor(131.7726, device='cuda:3')
benign distance is  tensor(131.7726, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.1873568743467331
distance x is tensor(143.2870, device='cuda:3')
benign distance is  tensor(143.2870, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.7701544761657715
distance x is tensor(137.2345, device='cuda:3')
benign distance is  tensor(137.2345, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6149991154670715
distance x is tensor(120.1820, device='cuda:3')
benign distance is  tensor(120.1820, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.44684353470802307
distance x is tensor(125.7201, device='cuda:3')
benign distance is  tensor(125.7201, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4531653821468353
distance x is tensor(135.8869, device='cuda:3')
benign distance is  tensor(135.8869, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.49496540427207947
distance x is tensor(120.6465, device='cuda:3')
benign distance is  tensor(120.6465, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1789582073688507
distance x is tensor(129.0992, device='cuda:3')
benign distance is  tensor(129.0992, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5640788078308105
distance x is tensor(124.2020, device='cuda:3')
benign distance is  tensor(124.2020, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4512607157230377
distance x is tensor(134.5923, device='cuda:3')
benign distance is  tensor(134.5923, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  16.102521896362305
distance x is tensor(198.1264, device='cuda:3')
benign distance is  tensor(198.1264, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  12.283480644226074
distance x is tensor(195.6872, device='cuda:3')
benign distance is  tensor(195.6872, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.186009407043457
distance x is tensor(207.2166, device='cuda:3')
benign distance is  tensor(207.2166, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.855524063110352
distance x is tensor(202.9258, device='cuda:3')
benign distance is  tensor(202.9258, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  12.571624755859375
distance x is tensor(206.3468, device='cuda:3')
benign distance is  tensor(206.3468, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  12.446489334106445
distance x is tensor(199.0465, device='cuda:3')
benign distance is  tensor(199.0465, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.157690048217773
distance x is tensor(216.6802, device='cuda:3')
benign distance is  tensor(216.6802, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  12.418966293334961
distance x is tensor(200.1488, device='cuda:3')
benign distance is  tensor(200.1488, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.350408554077148
distance x is tensor(205.7760, device='cuda:3')
benign distance is  tensor(205.7760, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  13.583839416503906
distance x is tensor(204.5267, device='cuda:3')
benign distance is  tensor(204.5267, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.526998519897461
distance x is tensor(206.7111, device='cuda:3')
benign distance is  tensor(206.7111, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  13.23089599609375
distance x is tensor(195.8093, device='cuda:3')
benign distance is  tensor(195.8093, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([503.9160, 542.6163, 538.1668, 467.2815, 422.8988, 503.9090, 522.3824,
        496.1927, 798.9590, 792.8675, 832.6591, 829.7755, 839.8126, 802.8031,
        858.5034, 818.7903, 822.8368, 823.6763, 825.9484, 791.6764, 671.7798,
        628.8096, 684.2758, 641.7164, 669.2407, 616.5887, 642.3053, 650.3929],
       device='cuda:3')
sorted_norm is   tensor([422.8988, 467.2815, 496.1927, 503.9090, 503.9160, 522.3824, 538.1668,
        542.6163, 616.5887, 628.8096, 641.7164, 642.3053, 650.3929, 669.2407,
        671.7798, 684.2758, 791.6764, 792.8675, 798.9590, 802.8031, 818.7903,
        822.8368, 823.6763, 825.9484, 829.7755, 832.6591, 839.8126, 858.5034],
       device='cuda:3')
used idx is  tensor([ 4,  3,  7,  5,  0,  6,  2,  1, 25, 21, 23, 26, 27, 24, 20, 22, 19,  9,
         8, 13, 15, 16], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 78.17% 

Test Accuracy: 77.39% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8327743411064148
distance x is tensor(122.2143, device='cuda:3')
benign distance is  tensor(122.2143, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46392136812210083
distance x is tensor(121.9885, device='cuda:3')
benign distance is  tensor(121.9885, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1553109586238861
distance x is tensor(124.5723, device='cuda:3')
benign distance is  tensor(124.5723, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39438217878341675
distance x is tensor(117.3941, device='cuda:3')
benign distance is  tensor(117.3941, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.077787160873413
distance x is tensor(108.3737, device='cuda:3')
benign distance is  tensor(108.3737, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7432655096054077
distance x is tensor(123.5879, device='cuda:3')
benign distance is  tensor(123.5879, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07452061027288437
distance x is tensor(117.4619, device='cuda:3')
benign distance is  tensor(117.4619, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3571151793003082
distance x is tensor(123.7022, device='cuda:3')
benign distance is  tensor(123.7022, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4871009290218353
distance x is tensor(134.9896, device='cuda:3')
benign distance is  tensor(134.9896, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.21463386714458466
distance x is tensor(130.6353, device='cuda:3')
benign distance is  tensor(130.6353, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5718408823013306
distance x is tensor(145.5914, device='cuda:3')
benign distance is  tensor(145.5914, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1425555944442749
distance x is tensor(132.5109, device='cuda:3')
benign distance is  tensor(132.5109, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.46229618787765503
distance x is tensor(134.6953, device='cuda:3')
benign distance is  tensor(134.6953, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.29564327001571655
distance x is tensor(128.3956, device='cuda:3')
benign distance is  tensor(128.3956, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3336981236934662
distance x is tensor(123.5233, device='cuda:3')
benign distance is  tensor(123.5233, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.18215687572956085
distance x is tensor(136.8912, device='cuda:3')
benign distance is  tensor(136.8912, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.35008430480957
distance x is tensor(159.7765, device='cuda:3')
benign distance is  tensor(159.7765, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  14.278291702270508
distance x is tensor(160.8879, device='cuda:3')
benign distance is  tensor(160.8879, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  16.141538619995117
distance x is tensor(169.5704, device='cuda:3')
benign distance is  tensor(169.5704, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.547882080078125
distance x is tensor(168.1971, device='cuda:3')
benign distance is  tensor(168.1971, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  14.6459379196167
distance x is tensor(167.3124, device='cuda:3')
benign distance is  tensor(167.3124, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  12.694131851196289
distance x is tensor(162.9649, device='cuda:3')
benign distance is  tensor(162.9649, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.333282470703125
distance x is tensor(162.0614, device='cuda:3')
benign distance is  tensor(162.0614, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  12.29113483428955
distance x is tensor(161.9748, device='cuda:3')
benign distance is  tensor(161.9748, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.323923110961914
distance x is tensor(173.5932, device='cuda:3')
benign distance is  tensor(173.5932, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.529237747192383
distance x is tensor(163.9835, device='cuda:3')
benign distance is  tensor(163.9835, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.3870210647583
distance x is tensor(166.5346, device='cuda:3')
benign distance is  tensor(166.5346, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  12.459871292114258
distance x is tensor(166.8372, device='cuda:3')
benign distance is  tensor(166.8372, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([544.2032, 544.3602, 543.1323, 504.9385, 470.5033, 541.0255, 511.6830,
        556.8011, 698.9180, 707.1216, 754.5703, 739.3376, 735.1584, 720.1620,
        733.0403, 719.3608, 756.1920, 727.5149, 750.4949, 739.3962, 640.2258,
        626.2938, 655.7662, 677.7350, 699.5003, 645.2704, 684.3621, 693.3514,
        617.8937, 697.2145, 592.2825, 652.0072, 608.9136, 605.9436, 648.8937,
        567.4975, 627.5548, 594.7155, 560.7492, 641.6829, 559.5225, 603.3196,
        613.7389, 663.5294], device='cuda:3')
sorted_norm is   tensor([470.5033, 504.9385, 511.6830, 541.0255, 543.1323, 544.2032, 544.3602,
        556.8011, 559.5225, 560.7492, 567.4975, 592.2825, 594.7155, 603.3196,
        605.9436, 608.9136, 613.7389, 617.8937, 626.2938, 627.5548, 640.2258,
        641.6829, 645.2704, 648.8937, 652.0072, 655.7662, 663.5294, 677.7350,
        684.3621, 693.3514, 697.2145, 698.9180, 699.5003, 707.1216, 719.3608,
        720.1620, 727.5149, 733.0403, 735.1584, 739.3376, 739.3962, 750.4949,
        754.5703, 756.1920], device='cuda:3')
used idx is  tensor([ 4,  3,  6,  5,  2,  0,  1,  7, 40, 38, 35, 30, 37, 41, 33, 32, 42, 28,
        21, 36, 20, 39, 25, 34, 31, 22, 43, 23, 26, 27, 29,  8, 24,  9, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 89.07% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6443659067153931
distance x is tensor(91.6480, device='cuda:3')
benign distance is  tensor(91.6480, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5750812292098999
distance x is tensor(111.5945, device='cuda:3')
benign distance is  tensor(111.5945, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07231855392456055
distance x is tensor(114.2435, device='cuda:3')
benign distance is  tensor(114.2435, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7459771633148193
distance x is tensor(114.9993, device='cuda:3')
benign distance is  tensor(114.9993, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4633563458919525
distance x is tensor(99.0728, device='cuda:3')
benign distance is  tensor(99.0728, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5955867767333984
distance x is tensor(105.9536, device='cuda:3')
benign distance is  tensor(105.9536, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3467565178871155
distance x is tensor(100.4490, device='cuda:3')
benign distance is  tensor(100.4490, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7599688768386841
distance x is tensor(113.9031, device='cuda:3')
benign distance is  tensor(113.9031, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6179423332214355
distance x is tensor(129.3392, device='cuda:3')
benign distance is  tensor(129.3392, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.15599307417869568
distance x is tensor(136.0664, device='cuda:3')
benign distance is  tensor(136.0664, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5354795455932617
distance x is tensor(121.6236, device='cuda:3')
benign distance is  tensor(121.6236, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8069089651107788
distance x is tensor(121.5019, device='cuda:3')
benign distance is  tensor(121.5019, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.395338237285614
distance x is tensor(121.4827, device='cuda:3')
benign distance is  tensor(121.4827, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3726591169834137
distance x is tensor(135.9449, device='cuda:3')
benign distance is  tensor(135.9449, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6300269365310669
distance x is tensor(125.6428, device='cuda:3')
benign distance is  tensor(125.6428, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0478956699371338
distance x is tensor(141.6051, device='cuda:3')
benign distance is  tensor(141.6051, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.19980069994926453
distance x is tensor(124.1148, device='cuda:3')
benign distance is  tensor(124.1148, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7008190751075745
distance x is tensor(141.1509, device='cuda:3')
benign distance is  tensor(141.1509, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5752109289169312
distance x is tensor(131.5161, device='cuda:3')
benign distance is  tensor(131.5161, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2086714804172516
distance x is tensor(122.8100, device='cuda:3')
benign distance is  tensor(122.8100, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5768543481826782
distance x is tensor(125.1466, device='cuda:3')
benign distance is  tensor(125.1466, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7965495586395264
distance x is tensor(116.9390, device='cuda:3')
benign distance is  tensor(116.9390, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6642025709152222
distance x is tensor(127.7848, device='cuda:3')
benign distance is  tensor(127.7848, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.43392881751060486
distance x is tensor(126.3170, device='cuda:3')
benign distance is  tensor(126.3170, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.10953539609909058
distance x is tensor(119.0088, device='cuda:3')
benign distance is  tensor(119.0088, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.45200759172439575
distance x is tensor(126.8487, device='cuda:3')
benign distance is  tensor(126.8487, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07149486988782883
distance x is tensor(126.2088, device='cuda:3')
benign distance is  tensor(126.2088, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.21740703284740448
distance x is tensor(129.8428, device='cuda:3')
benign distance is  tensor(129.8428, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5551397204399109
distance x is tensor(118.7586, device='cuda:3')
benign distance is  tensor(118.7586, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6110836267471313
distance x is tensor(133.0874, device='cuda:3')
benign distance is  tensor(133.0874, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.47880154848098755
distance x is tensor(130.2767, device='cuda:3')
benign distance is  tensor(130.2767, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.35435155034065247
distance x is tensor(140.4147, device='cuda:3')
benign distance is  tensor(140.4147, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.887112617492676
distance x is tensor(230.5146, device='cuda:3')
benign distance is  tensor(230.5146, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  13.668439865112305
distance x is tensor(250.5252, device='cuda:3')
benign distance is  tensor(250.5252, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.951139450073242
distance x is tensor(239.9240, device='cuda:3')
benign distance is  tensor(239.9240, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  13.874959945678711
distance x is tensor(242.7621, device='cuda:3')
benign distance is  tensor(242.7621, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  11.209047317504883
distance x is tensor(233.1636, device='cuda:3')
benign distance is  tensor(233.1636, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  13.119832038879395
distance x is tensor(237.1705, device='cuda:3')
benign distance is  tensor(237.1705, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.881625175476074
distance x is tensor(241.0070, device='cuda:3')
benign distance is  tensor(241.0070, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  14.247957229614258
distance x is tensor(251.8494, device='cuda:3')
benign distance is  tensor(251.8494, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.914149284362793
distance x is tensor(240.8452, device='cuda:3')
benign distance is  tensor(240.8452, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.919052124023438
distance x is tensor(235.2639, device='cuda:3')
benign distance is  tensor(235.2639, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  11.8756103515625
distance x is tensor(234.7251, device='cuda:3')
benign distance is  tensor(234.7251, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.684575080871582
distance x is tensor(251.0809, device='cuda:3')
benign distance is  tensor(251.0809, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([419.2396, 515.5517, 504.0192, 514.5770, 445.0193, 480.8928, 449.0293,
        512.6763, 894.6357, 947.4625, 934.1110, 939.9686, 924.0542, 912.5047,
        924.1034, 976.2720, 924.7261, 921.5691, 907.1063, 960.0540],
       device='cuda:3')
sorted_norm is   tensor([419.2396, 445.0193, 449.0293, 480.8928, 504.0192, 512.6763, 514.5770,
        515.5517, 894.6357, 907.1063, 912.5047, 921.5691, 924.0542, 924.1034,
        924.7261, 934.1110, 939.9686, 947.4625, 960.0540, 976.2720],
       device='cuda:3')
used idx is  tensor([ 0,  4,  6,  5,  2,  7,  3,  1,  8, 18, 13, 17, 12, 14, 16, 10],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 4.30% 

Test Accuracy: 3.99% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5857754349708557
distance x is tensor(165.2392, device='cuda:3')
benign distance is  tensor(165.2392, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8523290753364563
distance x is tensor(169.1642, device='cuda:3')
benign distance is  tensor(169.1642, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09123216569423676
distance x is tensor(169.8606, device='cuda:3')
benign distance is  tensor(169.8606, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4502485394477844
distance x is tensor(174.0920, device='cuda:3')
benign distance is  tensor(174.0920, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6333844661712646
distance x is tensor(156.7977, device='cuda:3')
benign distance is  tensor(156.7977, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5498151779174805
distance x is tensor(168.9403, device='cuda:3')
benign distance is  tensor(168.9403, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1916530877351761
distance x is tensor(160.1491, device='cuda:3')
benign distance is  tensor(160.1491, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5558934211730957
distance x is tensor(161.2394, device='cuda:3')
benign distance is  tensor(161.2394, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  12.606550216674805
distance x is tensor(121.1801, device='cuda:3')
benign distance is  tensor(121.1801, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  13.642292976379395
distance x is tensor(124.6356, device='cuda:3')
benign distance is  tensor(124.6356, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.109838485717773
distance x is tensor(149.1036, device='cuda:3')
benign distance is  tensor(149.1036, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.589773178100586
distance x is tensor(133.6577, device='cuda:3')
benign distance is  tensor(133.6577, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  12.564451217651367
distance x is tensor(133.5330, device='cuda:3')
benign distance is  tensor(133.5330, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  14.608746528625488
distance x is tensor(135.7984, device='cuda:3')
benign distance is  tensor(135.7984, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.254984855651855
distance x is tensor(127.7950, device='cuda:3')
benign distance is  tensor(127.7950, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  13.087817192077637
distance x is tensor(124.2853, device='cuda:3')
benign distance is  tensor(124.2853, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  13.138509750366211
distance x is tensor(132.6393, device='cuda:3')
benign distance is  tensor(132.6393, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  13.331965446472168
distance x is tensor(124.2493, device='cuda:3')
benign distance is  tensor(124.2493, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.04814910888672
distance x is tensor(132.7694, device='cuda:3')
benign distance is  tensor(132.7694, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  16.26441192626953
distance x is tensor(129.0863, device='cuda:3')
benign distance is  tensor(129.0863, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([695.0486, 694.9218, 704.0087, 717.8252, 649.5088, 710.4608, 665.7734,
        681.5907, 565.7373, 602.1277, 696.8279, 626.9198, 633.0577, 628.9761,
        617.6647, 606.3078, 624.0250, 594.8391, 636.7745, 615.6461, 699.2787,
        623.2514, 664.7801, 701.9629, 635.4572, 667.6927, 663.9077, 698.7379,
        666.5719, 692.4052, 642.6180, 633.3182, 644.9519, 687.9260, 653.8018,
        719.3542], device='cuda:3')
sorted_norm is   tensor([565.7373, 594.8391, 602.1277, 606.3078, 615.6461, 617.6647, 623.2514,
        624.0250, 626.9198, 628.9761, 633.0577, 633.3182, 635.4572, 636.7745,
        642.6180, 644.9519, 649.5088, 653.8018, 663.9077, 664.7801, 665.7734,
        666.5719, 667.6927, 681.5907, 687.9260, 692.4052, 694.9218, 695.0486,
        696.8279, 698.7379, 699.2787, 701.9629, 704.0087, 710.4608, 717.8252,
        719.3542], device='cuda:3')
used idx is  tensor([ 8, 17,  9, 15, 19, 14, 21, 16, 11, 13, 12, 31, 24, 18, 30, 32,  4, 34,
        26, 22,  6, 28, 25,  7, 33, 29,  1,  0], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 85.75% 

Test Accuracy: 84.81% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.777448296546936
distance x is tensor(120.6625, device='cuda:3')
benign distance is  tensor(120.6625, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9352601766586304
distance x is tensor(127.1946, device='cuda:3')
benign distance is  tensor(127.1946, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19552800059318542
distance x is tensor(127.9546, device='cuda:3')
benign distance is  tensor(127.9546, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3522379994392395
distance x is tensor(123.0314, device='cuda:3')
benign distance is  tensor(123.0314, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6608492136001587
distance x is tensor(104.6627, device='cuda:3')
benign distance is  tensor(104.6627, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.594129204750061
distance x is tensor(127.0909, device='cuda:3')
benign distance is  tensor(127.0909, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5389603972434998
distance x is tensor(106.7337, device='cuda:3')
benign distance is  tensor(106.7337, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4343140125274658
distance x is tensor(120.1931, device='cuda:3')
benign distance is  tensor(120.1931, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19099752604961395
distance x is tensor(139.0053, device='cuda:3')
benign distance is  tensor(139.0053, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3483980596065521
distance x is tensor(139.2931, device='cuda:3')
benign distance is  tensor(139.2931, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.08564046770334244
distance x is tensor(122.9828, device='cuda:3')
benign distance is  tensor(122.9828, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6270096898078918
distance x is tensor(133.5980, device='cuda:3')
benign distance is  tensor(133.5980, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9078758955001831
distance x is tensor(131.7143, device='cuda:3')
benign distance is  tensor(131.7143, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.314338356256485
distance x is tensor(133.1554, device='cuda:3')
benign distance is  tensor(133.1554, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8325044512748718
distance x is tensor(127.9113, device='cuda:3')
benign distance is  tensor(127.9113, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4809665083885193
distance x is tensor(137.8621, device='cuda:3')
benign distance is  tensor(137.8621, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.36685895919799805
distance x is tensor(140.9627, device='cuda:3')
benign distance is  tensor(140.9627, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.32373982667922974
distance x is tensor(124.1509, device='cuda:3')
benign distance is  tensor(124.1509, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2671108841896057
distance x is tensor(133.0216, device='cuda:3')
benign distance is  tensor(133.0216, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8886951208114624
distance x is tensor(154.6232, device='cuda:3')
benign distance is  tensor(154.6232, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.132943034172058
distance x is tensor(130.9503, device='cuda:3')
benign distance is  tensor(130.9503, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.509975016117096
distance x is tensor(132.7710, device='cuda:3')
benign distance is  tensor(132.7710, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2335263192653656
distance x is tensor(126.7245, device='cuda:3')
benign distance is  tensor(126.7245, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.15655645728111267
distance x is tensor(132.8206, device='cuda:3')
benign distance is  tensor(132.8206, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.664584159851074
distance x is tensor(149.6410, device='cuda:3')
benign distance is  tensor(149.6410, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.698457717895508
distance x is tensor(162.3471, device='cuda:3')
benign distance is  tensor(162.3471, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.217462539672852
distance x is tensor(170.0468, device='cuda:3')
benign distance is  tensor(170.0468, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.866357803344727
distance x is tensor(177.6182, device='cuda:3')
benign distance is  tensor(177.6182, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  13.857481002807617
distance x is tensor(166.9600, device='cuda:3')
benign distance is  tensor(166.9600, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  15.61462688446045
distance x is tensor(164.8642, device='cuda:3')
benign distance is  tensor(164.8642, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.8496675491333
distance x is tensor(161.3502, device='cuda:3')
benign distance is  tensor(161.3502, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  13.629740715026855
distance x is tensor(161.6579, device='cuda:3')
benign distance is  tensor(161.6579, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  12.781657218933105
distance x is tensor(158.9333, device='cuda:3')
benign distance is  tensor(158.9333, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  15.782173156738281
distance x is tensor(157.8277, device='cuda:3')
benign distance is  tensor(157.8277, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  15.212081909179688
distance x is tensor(170.3997, device='cuda:3')
benign distance is  tensor(170.3997, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  12.458292961120605
distance x is tensor(162.8113, device='cuda:3')
benign distance is  tensor(162.8113, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([539.2371, 568.4946, 574.1387, 536.9387, 457.8309, 559.3771, 464.7421,
        538.9349, 636.6545, 703.8483, 723.9338, 752.4146, 717.3423, 695.4005,
        698.9847, 709.0770, 690.0869, 686.4151, 730.6134, 697.3007, 599.5821,
        681.2913, 626.4856, 607.5031, 610.4162, 577.0580, 623.9223, 613.2755],
       device='cuda:3')
sorted_norm is   tensor([457.8309, 464.7421, 536.9387, 538.9349, 539.2371, 559.3771, 568.4946,
        574.1387, 577.0580, 599.5821, 607.5031, 610.4162, 613.2755, 623.9223,
        626.4856, 636.6545, 681.2913, 686.4151, 690.0869, 695.4005, 697.3007,
        698.9847, 703.8483, 709.0770, 717.3423, 723.9338, 730.6134, 752.4146],
       device='cuda:3')
used idx is  tensor([ 4,  6,  3,  7,  0,  5,  1,  2, 25, 20, 23, 24, 27, 26, 22,  8, 21, 17,
        16, 13, 19, 14], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 87.80% 

Test Accuracy: 86.65% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.830314040184021
distance x is tensor(107.6066, device='cuda:3')
benign distance is  tensor(107.6066, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9464548230171204
distance x is tensor(122.4197, device='cuda:3')
benign distance is  tensor(122.4197, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3531119227409363
distance x is tensor(130.0100, device='cuda:3')
benign distance is  tensor(130.0100, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6134783625602722
distance x is tensor(113.8376, device='cuda:3')
benign distance is  tensor(113.8376, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1689212322235107
distance x is tensor(115.2153, device='cuda:3')
benign distance is  tensor(115.2153, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3863042891025543
distance x is tensor(112.2295, device='cuda:3')
benign distance is  tensor(112.2295, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5273358225822449
distance x is tensor(111.3127, device='cuda:3')
benign distance is  tensor(111.3127, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.037230439484119415
distance x is tensor(110.3514, device='cuda:3')
benign distance is  tensor(110.3514, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1305459886789322
distance x is tensor(124.7655, device='cuda:3')
benign distance is  tensor(124.7655, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6972165703773499
distance x is tensor(153.1501, device='cuda:3')
benign distance is  tensor(153.1501, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5010889768600464
distance x is tensor(133.8010, device='cuda:3')
benign distance is  tensor(133.8010, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.03441895171999931
distance x is tensor(127.2322, device='cuda:3')
benign distance is  tensor(127.2322, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.13443735241889954
distance x is tensor(129.7474, device='cuda:3')
benign distance is  tensor(129.7474, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4963386058807373
distance x is tensor(120.8958, device='cuda:3')
benign distance is  tensor(120.8958, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.16372650861740112
distance x is tensor(137.1145, device='cuda:3')
benign distance is  tensor(137.1145, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5598948001861572
distance x is tensor(130.5729, device='cuda:3')
benign distance is  tensor(130.5729, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.622601509094238
distance x is tensor(171.3623, device='cuda:3')
benign distance is  tensor(171.3623, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.08696174621582
distance x is tensor(177.7064, device='cuda:3')
benign distance is  tensor(177.7064, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.280233383178711
distance x is tensor(181.6510, device='cuda:3')
benign distance is  tensor(181.6510, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.366409301757812
distance x is tensor(181.2442, device='cuda:3')
benign distance is  tensor(181.2442, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  14.123674392700195
distance x is tensor(171.4809, device='cuda:3')
benign distance is  tensor(171.4809, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  12.340935707092285
distance x is tensor(175.4731, device='cuda:3')
benign distance is  tensor(175.4731, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.563751220703125
distance x is tensor(180.6292, device='cuda:3')
benign distance is  tensor(180.6292, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  14.01539421081543
distance x is tensor(175.9660, device='cuda:3')
benign distance is  tensor(175.9660, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.8557710647583
distance x is tensor(179.0378, device='cuda:3')
benign distance is  tensor(179.0378, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  14.77393627166748
distance x is tensor(179.6770, device='cuda:3')
benign distance is  tensor(179.6770, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.008776664733887
distance x is tensor(172.1671, device='cuda:3')
benign distance is  tensor(172.1671, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  16.925050735473633
distance x is tensor(173.9127, device='cuda:3')
benign distance is  tensor(173.9127, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([490.0628, 551.9221, 578.5250, 507.0869, 504.2469, 493.4055, 485.2084,
        499.9680, 708.3895, 722.9303, 771.9727, 752.2570, 730.9536, 732.0574,
        762.5179, 734.6673, 755.1615, 756.3117, 735.4073, 730.7610, 634.6241,
        623.9191, 683.9193, 625.4944, 637.2333, 604.0403, 598.4581, 643.9493,
        633.5668, 626.5323, 557.5062, 613.0837, 610.5047, 607.3182, 592.4463,
        617.1926], device='cuda:3')
sorted_norm is   tensor([485.2084, 490.0628, 493.4055, 499.9680, 504.2469, 507.0869, 551.9221,
        557.5062, 578.5250, 592.4463, 598.4581, 604.0403, 607.3182, 610.5047,
        613.0837, 617.1926, 623.9191, 625.4944, 626.5323, 633.5668, 634.6241,
        637.2333, 643.9493, 683.9193, 708.3895, 722.9303, 730.7610, 730.9536,
        732.0574, 734.6673, 735.4073, 752.2570, 755.1615, 756.3117, 762.5179,
        771.9727], device='cuda:3')
used idx is  tensor([ 6,  0,  5,  7,  4,  3,  1, 30,  2, 34, 26, 25, 33, 32, 31, 35, 21, 23,
        29, 28, 20, 24, 27, 22,  8,  9, 19, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 88.72% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3874562382698059
distance x is tensor(108.0088, device='cuda:3')
benign distance is  tensor(108.0088, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5794049501419067
distance x is tensor(120.4761, device='cuda:3')
benign distance is  tensor(120.4761, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2801355719566345
distance x is tensor(120.6041, device='cuda:3')
benign distance is  tensor(120.6041, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5508862733840942
distance x is tensor(104.3151, device='cuda:3')
benign distance is  tensor(104.3151, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2229173481464386
distance x is tensor(94.6670, device='cuda:3')
benign distance is  tensor(94.6670, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1415927410125732
distance x is tensor(117.4630, device='cuda:3')
benign distance is  tensor(117.4630, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6146625876426697
distance x is tensor(112.2456, device='cuda:3')
benign distance is  tensor(112.2456, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3110036253929138
distance x is tensor(107.7839, device='cuda:3')
benign distance is  tensor(107.7839, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16128158569335938
distance x is tensor(135.8500, device='cuda:3')
benign distance is  tensor(135.8500, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4008967876434326
distance x is tensor(143.1734, device='cuda:3')
benign distance is  tensor(143.1734, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6074941158294678
distance x is tensor(132.8095, device='cuda:3')
benign distance is  tensor(132.8095, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7206641435623169
distance x is tensor(126.6581, device='cuda:3')
benign distance is  tensor(126.6581, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7250089645385742
distance x is tensor(122.7135, device='cuda:3')
benign distance is  tensor(122.7135, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5637584924697876
distance x is tensor(128.6627, device='cuda:3')
benign distance is  tensor(128.6627, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3979869484901428
distance x is tensor(128.2964, device='cuda:3')
benign distance is  tensor(128.2964, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7241957783699036
distance x is tensor(146.6274, device='cuda:3')
benign distance is  tensor(146.6274, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.36083561182022095
distance x is tensor(130.1358, device='cuda:3')
benign distance is  tensor(130.1358, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.21917028725147247
distance x is tensor(138.4854, device='cuda:3')
benign distance is  tensor(138.4854, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.13148748874664307
distance x is tensor(138.8220, device='cuda:3')
benign distance is  tensor(138.8220, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.32273244857788086
distance x is tensor(132.6665, device='cuda:3')
benign distance is  tensor(132.6665, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.600776731967926
distance x is tensor(136.6115, device='cuda:3')
benign distance is  tensor(136.6115, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.38863030076026917
distance x is tensor(129.2097, device='cuda:3')
benign distance is  tensor(129.2097, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.46127375960350037
distance x is tensor(126.8083, device='cuda:3')
benign distance is  tensor(126.8083, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1349972039461136
distance x is tensor(128.9059, device='cuda:3')
benign distance is  tensor(128.9059, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.248886108398438
distance x is tensor(189.4736, device='cuda:3')
benign distance is  tensor(189.4736, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  14.864089965820312
distance x is tensor(209.9892, device='cuda:3')
benign distance is  tensor(209.9892, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.899446487426758
distance x is tensor(208.4843, device='cuda:3')
benign distance is  tensor(208.4843, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.716044425964355
distance x is tensor(204.8775, device='cuda:3')
benign distance is  tensor(204.8775, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  14.024839401245117
distance x is tensor(216.4059, device='cuda:3')
benign distance is  tensor(216.4059, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  14.073921203613281
distance x is tensor(206.2347, device='cuda:3')
benign distance is  tensor(206.2347, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.186762809753418
distance x is tensor(210.8555, device='cuda:3')
benign distance is  tensor(210.8555, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.144269943237305
distance x is tensor(197.5081, device='cuda:3')
benign distance is  tensor(197.5081, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  12.623505592346191
distance x is tensor(208.3358, device='cuda:3')
benign distance is  tensor(208.3358, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  14.503225326538086
distance x is tensor(196.0064, device='cuda:3')
benign distance is  tensor(196.0064, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.696346282958984
distance x is tensor(209.6155, device='cuda:3')
benign distance is  tensor(209.6155, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  12.373568534851074
distance x is tensor(205.7193, device='cuda:3')
benign distance is  tensor(205.7193, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([495.3834, 538.2473, 531.2326, 455.9141, 414.0784, 527.8325, 499.5511,
        492.1763, 756.1127, 843.8937, 817.9211, 821.8014, 861.0710, 818.1887,
        835.7913, 792.6876, 835.3765, 800.9920, 821.1671, 813.3069],
       device='cuda:3')
sorted_norm is   tensor([414.0784, 455.9141, 492.1763, 495.3834, 499.5511, 527.8325, 531.2326,
        538.2473, 756.1127, 792.6876, 800.9920, 813.3069, 817.9211, 818.1887,
        821.1671, 821.8014, 835.3765, 835.7913, 843.8937, 861.0710],
       device='cuda:3')
used idx is  tensor([ 4,  3,  7,  0,  6,  5,  2,  1,  8, 15, 17, 19, 10, 13, 18, 11],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 2.89% 

Test Accuracy: 2.98% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39413875341415405
distance x is tensor(168.2494, device='cuda:3')
benign distance is  tensor(168.2494, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5399106740951538
distance x is tensor(174.4255, device='cuda:3')
benign distance is  tensor(174.4255, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.017000794410705566
distance x is tensor(177.2157, device='cuda:3')
benign distance is  tensor(177.2157, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.27719825506210327
distance x is tensor(166.4517, device='cuda:3')
benign distance is  tensor(166.4517, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5832136869430542
distance x is tensor(171.6486, device='cuda:3')
benign distance is  tensor(171.6486, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6665429472923279
distance x is tensor(168.9969, device='cuda:3')
benign distance is  tensor(168.9969, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27201804518699646
distance x is tensor(159.5993, device='cuda:3')
benign distance is  tensor(159.5993, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24484257400035858
distance x is tensor(168.8042, device='cuda:3')
benign distance is  tensor(168.8042, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.795573234558105
distance x is tensor(118.4602, device='cuda:3')
benign distance is  tensor(118.4602, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  14.959650993347168
distance x is tensor(119.5394, device='cuda:3')
benign distance is  tensor(119.5394, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.864489555358887
distance x is tensor(130.8234, device='cuda:3')
benign distance is  tensor(130.8234, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.599761962890625
distance x is tensor(127.5006, device='cuda:3')
benign distance is  tensor(127.5006, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  11.461076736450195
distance x is tensor(128.1729, device='cuda:3')
benign distance is  tensor(128.1729, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  14.722265243530273
distance x is tensor(132.2075, device='cuda:3')
benign distance is  tensor(132.2075, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.174030303955078
distance x is tensor(130.1808, device='cuda:3')
benign distance is  tensor(130.1808, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  13.839428901672363
distance x is tensor(127.1564, device='cuda:3')
benign distance is  tensor(127.1564, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  12.439868927001953
distance x is tensor(132.7291, device='cuda:3')
benign distance is  tensor(132.7291, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.977071762084961
distance x is tensor(126.4684, device='cuda:3')
benign distance is  tensor(126.4684, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.809761047363281
distance x is tensor(134.5857, device='cuda:3')
benign distance is  tensor(134.5857, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  11.089258193969727
distance x is tensor(127.7220, device='cuda:3')
benign distance is  tensor(127.7220, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([705.2485, 727.3951, 738.7833, 689.6544, 713.7289, 691.1381, 649.7900,
        703.1573, 559.3172, 567.1755, 616.3121, 598.9807, 592.2723, 599.2501,
        623.3116, 598.9211, 622.8293, 595.6436, 619.8237, 594.5229, 675.9124,
        697.3244, 688.0629, 709.4639, 673.8664, 714.4468, 697.0068, 750.4222,
        701.8734, 629.2961, 659.4198, 738.9073, 649.8012, 660.8049, 641.3259,
        665.0762, 631.4365, 753.9662, 663.9160, 661.4541, 649.6860, 620.6351,
        687.0789, 646.8924, 671.4494, 699.9030, 663.0377, 636.8506, 617.5380,
        643.1992, 651.0824, 713.8198], device='cuda:3')
sorted_norm is   tensor([559.3172, 567.1755, 592.2723, 594.5229, 595.6436, 598.9211, 598.9807,
        599.2501, 616.3121, 617.5380, 619.8237, 620.6351, 622.8293, 623.3116,
        629.2961, 631.4365, 636.8506, 641.3259, 643.1992, 646.8924, 649.6860,
        649.7900, 649.8012, 651.0824, 659.4198, 660.8049, 661.4541, 663.0377,
        663.9160, 665.0762, 671.4494, 673.8664, 675.9124, 687.0789, 688.0629,
        689.6544, 691.1381, 697.0068, 697.3244, 699.9030, 701.8734, 703.1573,
        705.2485, 709.4639, 713.7289, 713.8198, 714.4468, 727.3951, 738.7833,
        738.9073, 750.4222, 753.9662], device='cuda:3')
used idx is  tensor([ 8,  9, 12, 19, 17, 15, 11, 13, 10, 48, 18, 41, 16, 14, 29, 36, 47, 34,
        49, 43, 40,  6, 32, 50, 30, 33, 39, 46, 38, 35, 44, 24, 20, 42, 22,  3,
         5, 26, 21, 45, 28], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.13% 

Test Accuracy: 88.22% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.709715723991394
distance x is tensor(107.0929, device='cuda:3')
benign distance is  tensor(107.0929, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5466274619102478
distance x is tensor(130.5413, device='cuda:3')
benign distance is  tensor(130.5413, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11878065764904022
distance x is tensor(125.5302, device='cuda:3')
benign distance is  tensor(125.5302, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.0985887199640274
distance x is tensor(105.8673, device='cuda:3')
benign distance is  tensor(105.8673, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6845734715461731
distance x is tensor(104.8969, device='cuda:3')
benign distance is  tensor(104.8969, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6388068199157715
distance x is tensor(109.7794, device='cuda:3')
benign distance is  tensor(109.7794, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4396703839302063
distance x is tensor(112.8851, device='cuda:3')
benign distance is  tensor(112.8851, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.463188499212265
distance x is tensor(112.3646, device='cuda:3')
benign distance is  tensor(112.3646, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.537128210067749
distance x is tensor(128.4501, device='cuda:3')
benign distance is  tensor(128.4501, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.276150643825531
distance x is tensor(130.2889, device='cuda:3')
benign distance is  tensor(130.2889, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23448798060417175
distance x is tensor(117.2437, device='cuda:3')
benign distance is  tensor(117.2437, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7398484349250793
distance x is tensor(130.2604, device='cuda:3')
benign distance is  tensor(130.2604, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5058668851852417
distance x is tensor(121.9357, device='cuda:3')
benign distance is  tensor(121.9357, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17760500311851501
distance x is tensor(133.5246, device='cuda:3')
benign distance is  tensor(133.5246, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5081464648246765
distance x is tensor(128.7975, device='cuda:3')
benign distance is  tensor(128.7975, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.489554226398468
distance x is tensor(137.6336, device='cuda:3')
benign distance is  tensor(137.6336, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2508474290370941
distance x is tensor(127.5421, device='cuda:3')
benign distance is  tensor(127.5421, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5480543375015259
distance x is tensor(146.2421, device='cuda:3')
benign distance is  tensor(146.2421, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7082390189170837
distance x is tensor(124.3068, device='cuda:3')
benign distance is  tensor(124.3068, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.504144549369812
distance x is tensor(128.0464, device='cuda:3')
benign distance is  tensor(128.0464, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1599186658859253
distance x is tensor(132.4276, device='cuda:3')
benign distance is  tensor(132.4276, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7073822021484375
distance x is tensor(119.9620, device='cuda:3')
benign distance is  tensor(119.9620, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.1470881998538971
distance x is tensor(144.6026, device='cuda:3')
benign distance is  tensor(144.6026, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3186425566673279
distance x is tensor(129.3136, device='cuda:3')
benign distance is  tensor(129.3136, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2464331090450287
distance x is tensor(135.8909, device='cuda:3')
benign distance is  tensor(135.8909, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4309172034263611
distance x is tensor(132.4595, device='cuda:3')
benign distance is  tensor(132.4595, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.16931279003620148
distance x is tensor(125.9396, device='cuda:3')
benign distance is  tensor(125.9396, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4669840931892395
distance x is tensor(131.3144, device='cuda:3')
benign distance is  tensor(131.3144, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9056910276412964
distance x is tensor(128.6395, device='cuda:3')
benign distance is  tensor(128.6395, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3896638751029968
distance x is tensor(126.0354, device='cuda:3')
benign distance is  tensor(126.0354, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6767475008964539
distance x is tensor(127.1291, device='cuda:3')
benign distance is  tensor(127.1291, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4379422664642334
distance x is tensor(139.2279, device='cuda:3')
benign distance is  tensor(139.2279, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.16888217628002167
distance x is tensor(121.2802, device='cuda:3')
benign distance is  tensor(121.2802, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.30879929661750793
distance x is tensor(124.1760, device='cuda:3')
benign distance is  tensor(124.1760, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.10888846963644028
distance x is tensor(130.2225, device='cuda:3')
benign distance is  tensor(130.2225, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6982170939445496
distance x is tensor(136.3288, device='cuda:3')
benign distance is  tensor(136.3288, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4370206892490387
distance x is tensor(131.5477, device='cuda:3')
benign distance is  tensor(131.5477, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7464415431022644
distance x is tensor(134.4436, device='cuda:3')
benign distance is  tensor(134.4436, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9934191703796387
distance x is tensor(132.9426, device='cuda:3')
benign distance is  tensor(132.9426, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3290537893772125
distance x is tensor(135.3546, device='cuda:3')
benign distance is  tensor(135.3546, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.467913627624512
distance x is tensor(176.9506, device='cuda:3')
benign distance is  tensor(176.9506, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  15.94532585144043
distance x is tensor(181.0407, device='cuda:3')
benign distance is  tensor(181.0407, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.547709465026855
distance x is tensor(181.5849, device='cuda:3')
benign distance is  tensor(181.5849, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.233400344848633
distance x is tensor(184.5573, device='cuda:3')
benign distance is  tensor(184.5573, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  13.134096145629883
distance x is tensor(177.7343, device='cuda:3')
benign distance is  tensor(177.7343, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  14.270161628723145
distance x is tensor(179.5441, device='cuda:3')
benign distance is  tensor(179.5441, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.162495613098145
distance x is tensor(188.3389, device='cuda:3')
benign distance is  tensor(188.3389, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  13.960357666015625
distance x is tensor(183.7434, device='cuda:3')
benign distance is  tensor(183.7434, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  13.325071334838867
distance x is tensor(180.2018, device='cuda:3')
benign distance is  tensor(180.2018, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  15.162816047668457
distance x is tensor(170.3039, device='cuda:3')
benign distance is  tensor(170.3039, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.483236312866211
distance x is tensor(191.9986, device='cuda:3')
benign distance is  tensor(191.9986, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  12.97601318359375
distance x is tensor(182.8744, device='cuda:3')
benign distance is  tensor(182.8744, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([482.6768, 581.3976, 566.6168, 461.9325, 456.9881, 493.9057, 505.5531,
        494.5920, 720.5629, 731.2894, 731.2936, 754.2646, 727.9224, 721.9489,
        753.8201, 751.0469, 746.0328, 703.1010, 773.6379, 742.6042],
       device='cuda:3')
sorted_norm is   tensor([456.9881, 461.9325, 482.6768, 493.9057, 494.5920, 505.5531, 566.6168,
        581.3976, 703.1010, 720.5629, 721.9489, 727.9224, 731.2894, 731.2936,
        742.6042, 746.0328, 751.0469, 753.8201, 754.2646, 773.6379],
       device='cuda:3')
used idx is  tensor([ 4,  3,  0,  5,  7,  6,  2,  1, 17,  8, 13, 12,  9, 10, 19, 16],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 4.25% 

Test Accuracy: 3.95% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8557429313659668
distance x is tensor(154.0792, device='cuda:3')
benign distance is  tensor(154.0792, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.25264328718185425
distance x is tensor(167.1387, device='cuda:3')
benign distance is  tensor(167.1387, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7760816812515259
distance x is tensor(168.5550, device='cuda:3')
benign distance is  tensor(168.5550, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.526749849319458
distance x is tensor(162.3788, device='cuda:3')
benign distance is  tensor(162.3788, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8323640823364258
distance x is tensor(166.5393, device='cuda:3')
benign distance is  tensor(166.5393, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7701695561408997
distance x is tensor(172.1877, device='cuda:3')
benign distance is  tensor(172.1877, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24912507832050323
distance x is tensor(149.7388, device='cuda:3')
benign distance is  tensor(149.7388, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.17895051836967468
distance x is tensor(168.9594, device='cuda:3')
benign distance is  tensor(168.9594, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  13.71082592010498
distance x is tensor(116.0813, device='cuda:3')
benign distance is  tensor(116.0813, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  13.805055618286133
distance x is tensor(124.9200, device='cuda:3')
benign distance is  tensor(124.9200, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.727533340454102
distance x is tensor(136.0515, device='cuda:3')
benign distance is  tensor(136.0515, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.907730102539062
distance x is tensor(139.7123, device='cuda:3')
benign distance is  tensor(139.7123, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  12.897976875305176
distance x is tensor(137.5188, device='cuda:3')
benign distance is  tensor(137.5188, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  10.919697761535645
distance x is tensor(134.1505, device='cuda:3')
benign distance is  tensor(134.1505, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.922457695007324
distance x is tensor(133.7320, device='cuda:3')
benign distance is  tensor(133.7320, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  13.7783842086792
distance x is tensor(125.5414, device='cuda:3')
benign distance is  tensor(125.5414, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.841145515441895
distance x is tensor(129.8252, device='cuda:3')
benign distance is  tensor(129.8252, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.983647346496582
distance x is tensor(126.5198, device='cuda:3')
benign distance is  tensor(126.5198, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  13.900209426879883
distance x is tensor(130.2644, device='cuda:3')
benign distance is  tensor(130.2644, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  14.191823959350586
distance x is tensor(128.4313, device='cuda:3')
benign distance is  tensor(128.4313, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([651.8745, 705.3889, 710.4131, 671.2708, 693.4746, 733.7632, 614.7983,
        715.8906, 528.8413, 575.3753, 630.3832, 653.9875, 643.0554, 613.8935,
        614.9870, 580.3234, 590.5460, 578.6826, 597.7363, 592.1536, 619.0187,
        638.0302, 575.5868, 621.1349, 600.1181, 655.0722, 627.7524, 656.1826],
       device='cuda:3')
sorted_norm is   tensor([528.8413, 575.3753, 575.5868, 578.6826, 580.3234, 590.5460, 592.1536,
        597.7363, 600.1181, 613.8935, 614.7983, 614.9870, 619.0187, 621.1349,
        627.7524, 630.3832, 638.0302, 643.0554, 651.8745, 653.9875, 655.0722,
        656.1826, 671.2708, 693.4746, 705.3889, 710.4131, 715.8906, 733.7632],
       device='cuda:3')
used idx is  tensor([ 8,  9, 22, 17, 15, 16, 19, 18, 24, 13,  6, 14, 20, 23, 26, 10, 21, 12,
         0, 11, 25, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 44.59% 

Test Accuracy: 43.86% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9058562517166138
distance x is tensor(129.1341, device='cuda:3')
benign distance is  tensor(129.1341, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7733834981918335
distance x is tensor(148.8224, device='cuda:3')
benign distance is  tensor(148.8224, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18078958988189697
distance x is tensor(149.5186, device='cuda:3')
benign distance is  tensor(149.5186, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4331887662410736
distance x is tensor(135.2019, device='cuda:3')
benign distance is  tensor(135.2019, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.38840335607528687
distance x is tensor(144.8909, device='cuda:3')
benign distance is  tensor(144.8909, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.33838191628456116
distance x is tensor(147.7808, device='cuda:3')
benign distance is  tensor(147.7808, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1769694983959198
distance x is tensor(130.8620, device='cuda:3')
benign distance is  tensor(130.8620, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4145236909389496
distance x is tensor(125.5816, device='cuda:3')
benign distance is  tensor(125.5816, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4041927456855774
distance x is tensor(154.5947, device='cuda:3')
benign distance is  tensor(154.5947, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5756956338882446
distance x is tensor(144.0439, device='cuda:3')
benign distance is  tensor(144.0439, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.49468326568603516
distance x is tensor(139.3257, device='cuda:3')
benign distance is  tensor(139.3257, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3430015444755554
distance x is tensor(156.6220, device='cuda:3')
benign distance is  tensor(156.6220, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6625858545303345
distance x is tensor(137.3708, device='cuda:3')
benign distance is  tensor(137.3708, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5362996459007263
distance x is tensor(148.4413, device='cuda:3')
benign distance is  tensor(148.4413, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5213541984558105
distance x is tensor(141.3851, device='cuda:3')
benign distance is  tensor(141.3851, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4102380871772766
distance x is tensor(154.2908, device='cuda:3')
benign distance is  tensor(154.2908, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.386878967285156
distance x is tensor(137.2456, device='cuda:3')
benign distance is  tensor(137.2456, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  11.684341430664062
distance x is tensor(136.3232, device='cuda:3')
benign distance is  tensor(136.3232, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.163426399230957
distance x is tensor(150.7558, device='cuda:3')
benign distance is  tensor(150.7558, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.457807540893555
distance x is tensor(141.2576, device='cuda:3')
benign distance is  tensor(141.2576, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  13.374334335327148
distance x is tensor(146.0704, device='cuda:3')
benign distance is  tensor(146.0704, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  15.789388656616211
distance x is tensor(141.5209, device='cuda:3')
benign distance is  tensor(141.5209, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.578351974487305
distance x is tensor(146.5382, device='cuda:3')
benign distance is  tensor(146.5382, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.275007247924805
distance x is tensor(138.2697, device='cuda:3')
benign distance is  tensor(138.2697, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  13.448297500610352
distance x is tensor(145.8836, device='cuda:3')
benign distance is  tensor(145.8836, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.34744930267334
distance x is tensor(134.2054, device='cuda:3')
benign distance is  tensor(134.2054, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.15600872039795
distance x is tensor(147.6968, device='cuda:3')
benign distance is  tensor(147.6968, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  11.35512924194336
distance x is tensor(137.6574, device='cuda:3')
benign distance is  tensor(137.6574, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([575.9521, 671.9083, 653.6982, 593.8303, 626.8516, 657.2676, 571.4825,
        564.3695, 595.3674, 596.8535, 666.2391, 627.2278, 638.0939, 630.6010,
        644.3881, 622.1964, 648.3754, 601.8742, 654.7654, 607.3414, 655.4686,
        682.1700, 693.3770, 660.6586, 687.2365, 638.9534, 633.2532, 633.6503,
        609.4593, 692.4512, 588.8472, 628.7944, 639.6219, 577.6131, 683.0525,
        616.0071], device='cuda:3')
sorted_norm is   tensor([564.3695, 571.4825, 575.9521, 577.6131, 588.8472, 593.8303, 595.3674,
        596.8535, 601.8742, 607.3414, 609.4593, 616.0071, 622.1964, 626.8516,
        627.2278, 628.7944, 630.6010, 633.2532, 633.6503, 638.0939, 638.9534,
        639.6219, 644.3881, 648.3754, 653.6982, 654.7654, 655.4686, 657.2676,
        660.6586, 666.2391, 671.9083, 682.1700, 683.0525, 687.2365, 692.4512,
        693.3770], device='cuda:3')
used idx is  tensor([ 7,  6,  0, 33, 30,  3,  8,  9, 17, 19, 28, 35, 15,  4, 11, 31, 13, 26,
        27, 12, 25, 32, 14, 16,  2, 18, 20,  5], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 81.92% 

Test Accuracy: 80.85% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3650018572807312
distance x is tensor(109.2974, device='cuda:3')
benign distance is  tensor(109.2974, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9762219190597534
distance x is tensor(128.4199, device='cuda:3')
benign distance is  tensor(128.4199, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.057028673589229584
distance x is tensor(126.4286, device='cuda:3')
benign distance is  tensor(126.4286, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9901668429374695
distance x is tensor(112.3119, device='cuda:3')
benign distance is  tensor(112.3119, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6517149209976196
distance x is tensor(128.0888, device='cuda:3')
benign distance is  tensor(128.0888, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5573657751083374
distance x is tensor(122.9165, device='cuda:3')
benign distance is  tensor(122.9165, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1285305768251419
distance x is tensor(126.0271, device='cuda:3')
benign distance is  tensor(126.0271, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.05116824433207512
distance x is tensor(116.0526, device='cuda:3')
benign distance is  tensor(116.0526, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6939343214035034
distance x is tensor(141.0217, device='cuda:3')
benign distance is  tensor(141.0217, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4159451127052307
distance x is tensor(148.5152, device='cuda:3')
benign distance is  tensor(148.5152, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.06727686524391174
distance x is tensor(144.3696, device='cuda:3')
benign distance is  tensor(144.3696, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3883989453315735
distance x is tensor(135.6213, device='cuda:3')
benign distance is  tensor(135.6213, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.36239951848983765
distance x is tensor(128.9894, device='cuda:3')
benign distance is  tensor(128.9894, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.22358305752277374
distance x is tensor(130.7274, device='cuda:3')
benign distance is  tensor(130.7274, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.11224830150604248
distance x is tensor(148.9058, device='cuda:3')
benign distance is  tensor(148.9058, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6341426968574524
distance x is tensor(137.1679, device='cuda:3')
benign distance is  tensor(137.1679, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.16465115547180176
distance x is tensor(145.3512, device='cuda:3')
benign distance is  tensor(145.3512, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.19258013367652893
distance x is tensor(144.4108, device='cuda:3')
benign distance is  tensor(144.4108, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4009462296962738
distance x is tensor(146.3786, device='cuda:3')
benign distance is  tensor(146.3786, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3725098669528961
distance x is tensor(136.1603, device='cuda:3')
benign distance is  tensor(136.1603, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.49358677864074707
distance x is tensor(144.9230, device='cuda:3')
benign distance is  tensor(144.9230, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.22372189164161682
distance x is tensor(129.0132, device='cuda:3')
benign distance is  tensor(129.0132, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4809579849243164
distance x is tensor(126.0351, device='cuda:3')
benign distance is  tensor(126.0351, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.10197760909795761
distance x is tensor(136.2240, device='cuda:3')
benign distance is  tensor(136.2240, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.979533195495605
distance x is tensor(157.2755, device='cuda:3')
benign distance is  tensor(157.2755, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  12.586034774780273
distance x is tensor(151.3548, device='cuda:3')
benign distance is  tensor(151.3548, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  17.484182357788086
distance x is tensor(168.8583, device='cuda:3')
benign distance is  tensor(168.8583, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.653364181518555
distance x is tensor(150.1758, device='cuda:3')
benign distance is  tensor(150.1758, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.645716667175293
distance x is tensor(161.5002, device='cuda:3')
benign distance is  tensor(161.5002, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  17.853857040405273
distance x is tensor(156.8483, device='cuda:3')
benign distance is  tensor(156.8483, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.843594551086426
distance x is tensor(161.5693, device='cuda:3')
benign distance is  tensor(161.5693, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.49016284942627
distance x is tensor(154.7600, device='cuda:3')
benign distance is  tensor(154.7600, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  17.53920555114746
distance x is tensor(163.0906, device='cuda:3')
benign distance is  tensor(163.0906, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.592100143432617
distance x is tensor(156.0771, device='cuda:3')
benign distance is  tensor(156.0771, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  13.563652038574219
distance x is tensor(163.6467, device='cuda:3')
benign distance is  tensor(163.6467, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  15.652593612670898
distance x is tensor(154.4295, device='cuda:3')
benign distance is  tensor(154.4295, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([482.2025, 584.1163, 564.9875, 499.1140, 577.1733, 546.7028, 559.3704,
        522.4931, 656.3000, 635.5210, 712.0776, 645.8365, 691.1168, 664.5916,
        693.1439, 654.6248, 694.5106, 671.5076, 695.8451, 645.7911, 648.3829,
        618.4208, 619.3652, 620.9283, 599.0812, 596.9788, 594.0010, 657.3111,
        703.1814, 646.5421, 627.4056, 694.5013, 622.9004, 673.6713, 632.7449,
        701.2337], device='cuda:3')
sorted_norm is   tensor([482.2025, 499.1140, 522.4931, 546.7028, 559.3704, 564.9875, 577.1733,
        584.1163, 594.0010, 596.9788, 599.0812, 618.4208, 619.3652, 620.9283,
        622.9004, 627.4056, 632.7449, 635.5210, 645.7911, 645.8365, 646.5421,
        648.3829, 654.6248, 656.3000, 657.3111, 664.5916, 671.5076, 673.6713,
        691.1168, 693.1439, 694.5013, 694.5106, 695.8451, 701.2337, 703.1814,
        712.0776], device='cuda:3')
used idx is  tensor([ 0,  3,  7,  5,  6,  2,  4,  1, 26, 25, 24, 21, 22, 23, 32, 30, 34,  9,
        19, 11, 29, 20, 15,  8, 27, 13, 17, 33], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 88.16% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.48176583647727966
distance x is tensor(100.9417, device='cuda:3')
benign distance is  tensor(100.9417, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7853248715400696
distance x is tensor(123.9681, device='cuda:3')
benign distance is  tensor(123.9681, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18244244158267975
distance x is tensor(127.8949, device='cuda:3')
benign distance is  tensor(127.8949, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1932182312011719
distance x is tensor(100.9897, device='cuda:3')
benign distance is  tensor(100.9897, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.29651325941085815
distance x is tensor(111.6562, device='cuda:3')
benign distance is  tensor(111.6562, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5553218126296997
distance x is tensor(114.7441, device='cuda:3')
benign distance is  tensor(114.7441, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.175387442111969
distance x is tensor(107.3051, device='cuda:3')
benign distance is  tensor(107.3051, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21357163786888123
distance x is tensor(115.3940, device='cuda:3')
benign distance is  tensor(115.3940, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6213116645812988
distance x is tensor(142.9972, device='cuda:3')
benign distance is  tensor(142.9972, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.39317795634269714
distance x is tensor(136.5316, device='cuda:3')
benign distance is  tensor(136.5316, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6896233558654785
distance x is tensor(144.5365, device='cuda:3')
benign distance is  tensor(144.5365, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7196935415267944
distance x is tensor(121.4260, device='cuda:3')
benign distance is  tensor(121.4260, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5488103032112122
distance x is tensor(133.1541, device='cuda:3')
benign distance is  tensor(133.1541, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13587722182273865
distance x is tensor(132.5746, device='cuda:3')
benign distance is  tensor(132.5746, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5199028253555298
distance x is tensor(136.2100, device='cuda:3')
benign distance is  tensor(136.2100, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.34813910722732544
distance x is tensor(139.9937, device='cuda:3')
benign distance is  tensor(139.9937, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.40963873267173767
distance x is tensor(134.5422, device='cuda:3')
benign distance is  tensor(134.5422, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.806864857673645
distance x is tensor(130.0046, device='cuda:3')
benign distance is  tensor(130.0046, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7454351186752319
distance x is tensor(141.0697, device='cuda:3')
benign distance is  tensor(141.0697, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.483062207698822
distance x is tensor(138.9898, device='cuda:3')
benign distance is  tensor(138.9898, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6071702837944031
distance x is tensor(126.1018, device='cuda:3')
benign distance is  tensor(126.1018, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3664608597755432
distance x is tensor(139.9275, device='cuda:3')
benign distance is  tensor(139.9275, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.44186392426490784
distance x is tensor(129.0332, device='cuda:3')
benign distance is  tensor(129.0332, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.126705139875412
distance x is tensor(135.1582, device='cuda:3')
benign distance is  tensor(135.1582, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.407763481140137
distance x is tensor(181.8307, device='cuda:3')
benign distance is  tensor(181.8307, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  15.298535346984863
distance x is tensor(175.0914, device='cuda:3')
benign distance is  tensor(175.0914, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.660058975219727
distance x is tensor(182.4127, device='cuda:3')
benign distance is  tensor(182.4127, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  13.991767883300781
distance x is tensor(176.6402, device='cuda:3')
benign distance is  tensor(176.6402, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  13.957967758178711
distance x is tensor(185.5322, device='cuda:3')
benign distance is  tensor(185.5322, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  18.51729393005371
distance x is tensor(184.9766, device='cuda:3')
benign distance is  tensor(184.9766, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  15.321017265319824
distance x is tensor(188.4531, device='cuda:3')
benign distance is  tensor(188.4531, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  16.25436782836914
distance x is tensor(184.4155, device='cuda:3')
benign distance is  tensor(184.4155, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  18.972625732421875
distance x is tensor(172.8406, device='cuda:3')
benign distance is  tensor(172.8406, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  14.916171073913574
distance x is tensor(183.6450, device='cuda:3')
benign distance is  tensor(183.6450, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.152618408203125
distance x is tensor(177.0402, device='cuda:3')
benign distance is  tensor(177.0402, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  16.434621810913086
distance x is tensor(178.5269, device='cuda:3')
benign distance is  tensor(178.5269, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([444.9482, 563.6173, 580.8772, 446.3517, 496.1555, 508.8506, 468.2676,
        526.4887, 738.3120, 709.8805, 756.2618, 718.4672, 759.1659, 754.1294,
        762.5427, 753.3342, 726.2971, 738.5641, 720.9614, 733.4779],
       device='cuda:3')
sorted_norm is   tensor([444.9482, 446.3517, 468.2676, 496.1555, 508.8506, 526.4887, 563.6173,
        580.8772, 709.8805, 718.4672, 720.9614, 726.2971, 733.4779, 738.3120,
        738.5641, 753.3342, 754.1294, 756.2618, 759.1659, 762.5427],
       device='cuda:3')
used idx is  tensor([ 0,  3,  6,  4,  5,  7,  1,  2,  9, 11, 18, 16, 19,  8, 17, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 3.08% 

Test Accuracy: 3.02% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47162818908691406
distance x is tensor(167.6555, device='cuda:3')
benign distance is  tensor(167.6555, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.22531981766223907
distance x is tensor(159.7421, device='cuda:3')
benign distance is  tensor(159.7421, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05511311814188957
distance x is tensor(172.4238, device='cuda:3')
benign distance is  tensor(172.4238, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.26099762320518494
distance x is tensor(176.1112, device='cuda:3')
benign distance is  tensor(176.1112, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.85491544008255
distance x is tensor(171.3384, device='cuda:3')
benign distance is  tensor(171.3384, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8410795331001282
distance x is tensor(164.4227, device='cuda:3')
benign distance is  tensor(164.4227, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26552966237068176
distance x is tensor(173.0684, device='cuda:3')
benign distance is  tensor(173.0684, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2978874444961548
distance x is tensor(173.3959, device='cuda:3')
benign distance is  tensor(173.3959, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.93323040008545
distance x is tensor(115.2138, device='cuda:3')
benign distance is  tensor(115.2138, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  15.61689567565918
distance x is tensor(126.6053, device='cuda:3')
benign distance is  tensor(126.6053, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.430596351623535
distance x is tensor(141.2598, device='cuda:3')
benign distance is  tensor(141.2598, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.184831619262695
distance x is tensor(129.0594, device='cuda:3')
benign distance is  tensor(129.0594, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.737661361694336
distance x is tensor(132.4801, device='cuda:3')
benign distance is  tensor(132.4801, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  11.629119873046875
distance x is tensor(134.3977, device='cuda:3')
benign distance is  tensor(134.3977, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.504935264587402
distance x is tensor(132.9601, device='cuda:3')
benign distance is  tensor(132.9601, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  13.402521133422852
distance x is tensor(135.8746, device='cuda:3')
benign distance is  tensor(135.8746, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  13.246052742004395
distance x is tensor(134.6239, device='cuda:3')
benign distance is  tensor(134.6239, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  13.286840438842773
distance x is tensor(118.7938, device='cuda:3')
benign distance is  tensor(118.7938, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.99724006652832
distance x is tensor(135.8450, device='cuda:3')
benign distance is  tensor(135.8450, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  14.461276054382324
distance x is tensor(124.1155, device='cuda:3')
benign distance is  tensor(124.1155, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([713.0776, 679.5958, 715.7920, 755.2258, 716.3834, 699.6334, 713.4319,
        737.8049, 524.2209, 572.0546, 646.7617, 590.1620, 605.3286, 597.4874,
        608.2758, 627.3942, 619.2584, 530.5742, 612.4572, 567.2888, 638.1672,
        644.9218, 656.7218, 695.2173, 688.2653, 682.1201, 678.6498, 693.2592,
        686.9520, 713.4943, 692.0654, 671.8041, 628.1851, 650.2375, 701.9509,
        668.1096, 690.1165, 652.6115, 690.8444, 596.6918, 650.9763, 648.0355,
        660.6310, 660.8251], device='cuda:3')
sorted_norm is   tensor([524.2209, 530.5742, 567.2888, 572.0546, 590.1620, 596.6918, 597.4874,
        605.3286, 608.2758, 612.4572, 619.2584, 627.3942, 628.1851, 638.1672,
        644.9218, 646.7617, 648.0355, 650.2375, 650.9763, 652.6115, 656.7218,
        660.6310, 660.8251, 668.1096, 671.8041, 678.6498, 679.5958, 682.1201,
        686.9520, 688.2653, 690.1165, 690.8444, 692.0654, 693.2592, 695.2173,
        699.6334, 701.9509, 713.0776, 713.4319, 713.4943, 715.7920, 716.3834,
        737.8049, 755.2258], device='cuda:3')
used idx is  tensor([ 8, 17, 19,  9, 11, 39, 13, 12, 14, 18, 16, 15, 32, 20, 21, 10, 41, 33,
        40, 37, 22, 42, 43, 35, 31, 26,  1, 25, 28, 24, 36, 38, 30, 27, 23],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.90% 

Test Accuracy: 88.14% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5515165328979492
distance x is tensor(105.6001, device='cuda:3')
benign distance is  tensor(105.6001, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9388148188591003
distance x is tensor(120.4439, device='cuda:3')
benign distance is  tensor(120.4439, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0562521293759346
distance x is tensor(123.0164, device='cuda:3')
benign distance is  tensor(123.0164, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.32752999663352966
distance x is tensor(101.6656, device='cuda:3')
benign distance is  tensor(101.6656, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5188941955566406
distance x is tensor(103.5238, device='cuda:3')
benign distance is  tensor(103.5238, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1166348457336426
distance x is tensor(116.3563, device='cuda:3')
benign distance is  tensor(116.3563, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.41828471422195435
distance x is tensor(102.4773, device='cuda:3')
benign distance is  tensor(102.4773, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22860197722911835
distance x is tensor(113.5934, device='cuda:3')
benign distance is  tensor(113.5934, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4074142575263977
distance x is tensor(131.6317, device='cuda:3')
benign distance is  tensor(131.6317, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6040416955947876
distance x is tensor(128.3569, device='cuda:3')
benign distance is  tensor(128.3569, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.13423600792884827
distance x is tensor(131.8156, device='cuda:3')
benign distance is  tensor(131.8156, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8677314519882202
distance x is tensor(130.9845, device='cuda:3')
benign distance is  tensor(130.9845, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6144981980323792
distance x is tensor(125.5569, device='cuda:3')
benign distance is  tensor(125.5569, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.08458416163921356
distance x is tensor(130.1101, device='cuda:3')
benign distance is  tensor(130.1101, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.26387715339660645
distance x is tensor(122.8215, device='cuda:3')
benign distance is  tensor(122.8215, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0910694599151611
distance x is tensor(130.8439, device='cuda:3')
benign distance is  tensor(130.8439, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.34457457065582275
distance x is tensor(128.4179, device='cuda:3')
benign distance is  tensor(128.4179, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5600839853286743
distance x is tensor(150.1711, device='cuda:3')
benign distance is  tensor(150.1711, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.37095555663108826
distance x is tensor(124.9477, device='cuda:3')
benign distance is  tensor(124.9477, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.12977668642997742
distance x is tensor(132.1878, device='cuda:3')
benign distance is  tensor(132.1878, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.21508069336414337
distance x is tensor(126.8735, device='cuda:3')
benign distance is  tensor(126.8735, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9477711915969849
distance x is tensor(123.6359, device='cuda:3')
benign distance is  tensor(123.6359, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3203328549861908
distance x is tensor(137.7018, device='cuda:3')
benign distance is  tensor(137.7018, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3224923014640808
distance x is tensor(132.9978, device='cuda:3')
benign distance is  tensor(132.9978, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1340240240097046
distance x is tensor(140.8869, device='cuda:3')
benign distance is  tensor(140.8869, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.38441604375839233
distance x is tensor(128.6962, device='cuda:3')
benign distance is  tensor(128.6962, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2329390048980713
distance x is tensor(128.3833, device='cuda:3')
benign distance is  tensor(128.3833, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.46198683977127075
distance x is tensor(144.1919, device='cuda:3')
benign distance is  tensor(144.1919, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3304824233055115
distance x is tensor(137.5787, device='cuda:3')
benign distance is  tensor(137.5787, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5052973628044128
distance x is tensor(131.6813, device='cuda:3')
benign distance is  tensor(131.6813, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1857712268829346
distance x is tensor(126.4389, device='cuda:3')
benign distance is  tensor(126.4389, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3650526702404022
distance x is tensor(125.1625, device='cuda:3')
benign distance is  tensor(125.1625, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.233838081359863
distance x is tensor(179.1536, device='cuda:3')
benign distance is  tensor(179.1536, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.57278823852539
distance x is tensor(176.7180, device='cuda:3')
benign distance is  tensor(176.7180, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.903402328491211
distance x is tensor(172.5071, device='cuda:3')
benign distance is  tensor(172.5071, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.126535415649414
distance x is tensor(166.3891, device='cuda:3')
benign distance is  tensor(166.3891, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.691001892089844
distance x is tensor(175.4030, device='cuda:3')
benign distance is  tensor(175.4030, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.10590934753418
distance x is tensor(165.1512, device='cuda:3')
benign distance is  tensor(165.1512, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  13.237767219543457
distance x is tensor(183.8529, device='cuda:3')
benign distance is  tensor(183.8529, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.295888900756836
distance x is tensor(168.3338, device='cuda:3')
benign distance is  tensor(168.3338, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.934211730957031
distance x is tensor(181.2305, device='cuda:3')
benign distance is  tensor(181.2305, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  16.240032196044922
distance x is tensor(172.7895, device='cuda:3')
benign distance is  tensor(172.7895, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.7605619430542
distance x is tensor(166.8074, device='cuda:3')
benign distance is  tensor(166.8074, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  12.257020950317383
distance x is tensor(171.3047, device='cuda:3')
benign distance is  tensor(171.3047, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([472.0995, 549.0809, 540.2823, 457.3716, 450.2928, 527.0715, 448.1500,
        521.6628, 705.8093, 711.3727, 710.3339, 679.9720, 718.8868, 692.0191,
        763.7909, 701.2254, 743.9285, 702.3675, 699.4675, 699.2235],
       device='cuda:3')
sorted_norm is   tensor([448.1500, 450.2928, 457.3716, 472.0995, 521.6628, 527.0715, 540.2823,
        549.0809, 679.9720, 692.0191, 699.2235, 699.4675, 701.2254, 702.3675,
        705.8093, 710.3339, 711.3727, 718.8868, 743.9285, 763.7909],
       device='cuda:3')
used idx is  tensor([ 6,  4,  3,  0,  7,  5,  2,  1, 11, 13, 19, 18, 15, 17,  8, 10],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 3.00% 

Test Accuracy: 2.80% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.15095940232276917
distance x is tensor(170.4069, device='cuda:3')
benign distance is  tensor(170.4069, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6313841938972473
distance x is tensor(184.9812, device='cuda:3')
benign distance is  tensor(184.9812, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6990391612052917
distance x is tensor(177.7311, device='cuda:3')
benign distance is  tensor(177.7311, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4662386178970337
distance x is tensor(169.8547, device='cuda:3')
benign distance is  tensor(169.8547, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1584528684616089
distance x is tensor(176.4688, device='cuda:3')
benign distance is  tensor(176.4688, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8670333027839661
distance x is tensor(190.2099, device='cuda:3')
benign distance is  tensor(190.2099, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35809555649757385
distance x is tensor(154.3673, device='cuda:3')
benign distance is  tensor(154.3673, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.27097854018211365
distance x is tensor(172.3950, device='cuda:3')
benign distance is  tensor(172.3950, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  12.418680191040039
distance x is tensor(116.8286, device='cuda:3')
benign distance is  tensor(116.8286, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  13.200650215148926
distance x is tensor(113.5925, device='cuda:3')
benign distance is  tensor(113.5925, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  17.206743240356445
distance x is tensor(139.8103, device='cuda:3')
benign distance is  tensor(139.8103, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.489400863647461
distance x is tensor(128.4582, device='cuda:3')
benign distance is  tensor(128.4582, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  12.466764450073242
distance x is tensor(136.9848, device='cuda:3')
benign distance is  tensor(136.9848, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  13.176745414733887
distance x is tensor(125.4574, device='cuda:3')
benign distance is  tensor(125.4574, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.63487434387207
distance x is tensor(133.5110, device='cuda:3')
benign distance is  tensor(133.5110, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  16.23031234741211
distance x is tensor(131.7866, device='cuda:3')
benign distance is  tensor(131.7866, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  15.168657302856445
distance x is tensor(136.8126, device='cuda:3')
benign distance is  tensor(136.8126, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  14.269452095031738
distance x is tensor(127.1725, device='cuda:3')
benign distance is  tensor(127.1725, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.58637809753418
distance x is tensor(132.3862, device='cuda:3')
benign distance is  tensor(132.3862, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  13.713007926940918
distance x is tensor(131.0983, device='cuda:3')
benign distance is  tensor(131.0983, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([724.4576, 794.0541, 747.5878, 703.8800, 758.7051, 807.3924, 647.1436,
        737.5568, 535.8304, 521.3959, 622.2265, 598.0077, 636.7898, 565.9837,
        618.0257, 607.3013, 622.7320, 582.0269, 605.4841, 587.6155, 724.2518,
        695.4761, 705.0493, 652.1819, 714.4386, 630.6960, 622.4889, 660.5730,
        653.6169, 626.6387, 683.5905, 674.1075, 626.6681, 677.3609, 640.9393,
        670.9017, 635.5518, 611.3114, 629.3454, 621.9664, 610.8806, 621.6445,
        598.0901, 635.8412], device='cuda:3')
sorted_norm is   tensor([521.3959, 535.8304, 565.9837, 582.0269, 587.6155, 598.0077, 598.0901,
        605.4841, 607.3013, 610.8806, 611.3114, 618.0257, 621.6445, 621.9664,
        622.2265, 622.4889, 622.7320, 626.6387, 626.6681, 629.3454, 630.6960,
        635.5518, 635.8412, 636.7898, 640.9393, 647.1436, 652.1819, 653.6169,
        660.5730, 670.9017, 674.1075, 677.3609, 683.5905, 695.4761, 703.8800,
        705.0493, 714.4386, 724.2518, 724.4576, 737.5568, 747.5878, 758.7051,
        794.0541, 807.3924], device='cuda:3')
used idx is  tensor([ 9,  8, 13, 17, 19, 11, 42, 18, 15, 40, 37, 14, 41, 39, 10, 26, 16, 29,
        32, 38, 25, 36, 43, 12, 34,  6, 23, 28, 27, 35, 31, 33, 30, 21,  3],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 88.47% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4989830553531647
distance x is tensor(108.4378, device='cuda:3')
benign distance is  tensor(108.4378, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1719268262386322
distance x is tensor(130.1297, device='cuda:3')
benign distance is  tensor(130.1297, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.043088801205158234
distance x is tensor(120.7105, device='cuda:3')
benign distance is  tensor(120.7105, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6951607465744019
distance x is tensor(107.2034, device='cuda:3')
benign distance is  tensor(107.2034, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.21071061491966248
distance x is tensor(104.5055, device='cuda:3')
benign distance is  tensor(104.5055, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4091130197048187
distance x is tensor(113.5689, device='cuda:3')
benign distance is  tensor(113.5689, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4833471179008484
distance x is tensor(115.4193, device='cuda:3')
benign distance is  tensor(115.4193, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3950224816799164
distance x is tensor(112.5242, device='cuda:3')
benign distance is  tensor(112.5242, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3504977524280548
distance x is tensor(147.9257, device='cuda:3')
benign distance is  tensor(147.9257, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.19854456186294556
distance x is tensor(134.3027, device='cuda:3')
benign distance is  tensor(134.3027, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.39661073684692383
distance x is tensor(134.5354, device='cuda:3')
benign distance is  tensor(134.5354, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0270944833755493
distance x is tensor(137.1765, device='cuda:3')
benign distance is  tensor(137.1765, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7170774340629578
distance x is tensor(125.1188, device='cuda:3')
benign distance is  tensor(125.1188, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2669074535369873
distance x is tensor(129.5759, device='cuda:3')
benign distance is  tensor(129.5759, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5846835970878601
distance x is tensor(137.8270, device='cuda:3')
benign distance is  tensor(137.8270, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6408019065856934
distance x is tensor(136.4687, device='cuda:3')
benign distance is  tensor(136.4687, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4087945818901062
distance x is tensor(145.6803, device='cuda:3')
benign distance is  tensor(145.6803, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6176205277442932
distance x is tensor(131.7869, device='cuda:3')
benign distance is  tensor(131.7869, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3802546262741089
distance x is tensor(141.9301, device='cuda:3')
benign distance is  tensor(141.9301, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.20325489342212677
distance x is tensor(133.3409, device='cuda:3')
benign distance is  tensor(133.3409, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8464863896369934
distance x is tensor(128.6911, device='cuda:3')
benign distance is  tensor(128.6911, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3128839433193207
distance x is tensor(137.5472, device='cuda:3')
benign distance is  tensor(137.5472, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6892246007919312
distance x is tensor(129.6073, device='cuda:3')
benign distance is  tensor(129.6073, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8712892532348633
distance x is tensor(132.0230, device='cuda:3')
benign distance is  tensor(132.0230, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5365391969680786
distance x is tensor(138.1851, device='cuda:3')
benign distance is  tensor(138.1851, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.038771890103816986
distance x is tensor(127.7313, device='cuda:3')
benign distance is  tensor(127.7313, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6500487923622131
distance x is tensor(150.4349, device='cuda:3')
benign distance is  tensor(150.4349, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04870716482400894
distance x is tensor(130.4766, device='cuda:3')
benign distance is  tensor(130.4766, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.41691017150878906
distance x is tensor(135.5150, device='cuda:3')
benign distance is  tensor(135.5150, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9109326601028442
distance x is tensor(126.5267, device='cuda:3')
benign distance is  tensor(126.5267, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5570250749588013
distance x is tensor(122.3389, device='cuda:3')
benign distance is  tensor(122.3389, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.10575860738754272
distance x is tensor(130.7540, device='cuda:3')
benign distance is  tensor(130.7540, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.253683090209961
distance x is tensor(175.9115, device='cuda:3')
benign distance is  tensor(175.9115, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  15.575085639953613
distance x is tensor(185.6623, device='cuda:3')
benign distance is  tensor(185.6623, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.064313888549805
distance x is tensor(192.6986, device='cuda:3')
benign distance is  tensor(192.6986, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  18.059904098510742
distance x is tensor(177.8356, device='cuda:3')
benign distance is  tensor(177.8356, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.8565673828125
distance x is tensor(175.4414, device='cuda:3')
benign distance is  tensor(175.4414, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  19.207687377929688
distance x is tensor(153.2527, device='cuda:3')
benign distance is  tensor(153.2527, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  15.976228713989258
distance x is tensor(184.5833, device='cuda:3')
benign distance is  tensor(184.5833, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.914413452148438
distance x is tensor(171.1179, device='cuda:3')
benign distance is  tensor(171.1179, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.558826446533203
distance x is tensor(174.5658, device='cuda:3')
benign distance is  tensor(174.5658, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.202335357666016
distance x is tensor(167.8788, device='cuda:3')
benign distance is  tensor(167.8788, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  18.78081512451172
distance x is tensor(186.2231, device='cuda:3')
benign distance is  tensor(186.2231, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  15.181605339050293
distance x is tensor(165.6678, device='cuda:3')
benign distance is  tensor(165.6678, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([488.7015, 596.2001, 541.4747, 474.0041, 454.8011, 506.5044, 510.7802,
        510.0700, 712.4301, 754.5616, 790.1145, 728.6274, 719.9672, 632.0639,
        734.8431, 692.2803, 736.5798, 689.2625, 758.7789, 669.8140, 585.0267,
        684.9289, 577.9503, 598.9562, 578.6801, 569.0666, 636.3875, 597.3499],
       device='cuda:3')
sorted_norm is   tensor([454.8011, 474.0041, 488.7015, 506.5044, 510.0700, 510.7802, 541.4747,
        569.0666, 577.9503, 578.6801, 585.0267, 596.2001, 597.3499, 598.9562,
        632.0639, 636.3875, 669.8140, 684.9289, 689.2625, 692.2803, 712.4301,
        719.9672, 728.6274, 734.8431, 736.5798, 754.5616, 758.7789, 790.1145],
       device='cuda:3')
used idx is  tensor([ 4,  3,  0,  5,  7,  6,  2, 25, 22, 24, 20,  1, 27, 23, 13, 26, 19, 21,
        17, 15,  8, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 67.87% 

Test Accuracy: 66.54% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.792363703250885
distance x is tensor(126.4985, device='cuda:3')
benign distance is  tensor(126.4985, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6434367895126343
distance x is tensor(138.6859, device='cuda:3')
benign distance is  tensor(138.6859, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3432663381099701
distance x is tensor(148.3567, device='cuda:3')
benign distance is  tensor(148.3567, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6397616863250732
distance x is tensor(136.9148, device='cuda:3')
benign distance is  tensor(136.9148, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8788937330245972
distance x is tensor(114.1646, device='cuda:3')
benign distance is  tensor(114.1646, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.36991366744041443
distance x is tensor(127.1448, device='cuda:3')
benign distance is  tensor(127.1448, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2847873270511627
distance x is tensor(115.1232, device='cuda:3')
benign distance is  tensor(115.1232, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1305786371231079
distance x is tensor(125.3828, device='cuda:3')
benign distance is  tensor(125.3828, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.34664416313171387
distance x is tensor(146.0513, device='cuda:3')
benign distance is  tensor(146.0513, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0721172094345093
distance x is tensor(150.7390, device='cuda:3')
benign distance is  tensor(150.7390, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.553415834903717
distance x is tensor(132.9050, device='cuda:3')
benign distance is  tensor(132.9050, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9304339289665222
distance x is tensor(135.0069, device='cuda:3')
benign distance is  tensor(135.0069, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5393616557121277
distance x is tensor(138.4528, device='cuda:3')
benign distance is  tensor(138.4528, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.081955909729004
distance x is tensor(129.5717, device='cuda:3')
benign distance is  tensor(129.5717, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.15398618578910828
distance x is tensor(148.0139, device='cuda:3')
benign distance is  tensor(148.0139, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.48623618483543396
distance x is tensor(146.2928, device='cuda:3')
benign distance is  tensor(146.2928, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  16.74053955078125
distance x is tensor(147.6338, device='cuda:3')
benign distance is  tensor(147.6338, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  13.772024154663086
distance x is tensor(154.9880, device='cuda:3')
benign distance is  tensor(154.9880, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.590177536010742
distance x is tensor(159.1084, device='cuda:3')
benign distance is  tensor(159.1084, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  16.333026885986328
distance x is tensor(153.4477, device='cuda:3')
benign distance is  tensor(153.4477, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.918103218078613
distance x is tensor(142.6702, device='cuda:3')
benign distance is  tensor(142.6702, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  14.540060043334961
distance x is tensor(150.1039, device='cuda:3')
benign distance is  tensor(150.1039, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.223958969116211
distance x is tensor(151.8674, device='cuda:3')
benign distance is  tensor(151.8674, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  14.051846504211426
distance x is tensor(142.5116, device='cuda:3')
benign distance is  tensor(142.5116, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  15.127116203308105
distance x is tensor(153.4675, device='cuda:3')
benign distance is  tensor(153.4675, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  14.0950345993042
distance x is tensor(160.2237, device='cuda:3')
benign distance is  tensor(160.2237, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  18.722030639648438
distance x is tensor(151.7229, device='cuda:3')
benign distance is  tensor(151.7229, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  12.63847541809082
distance x is tensor(154.3343, device='cuda:3')
benign distance is  tensor(154.3343, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([554.2955, 632.1462, 658.6948, 603.1373, 487.6800, 556.6008, 504.7975,
        570.8958, 637.6086, 648.5651, 689.3282, 663.2573, 627.5312, 652.1027,
        672.2592, 620.9405, 661.4064, 684.1594, 661.3676, 667.5168, 665.8824,
        614.0851, 616.6739, 626.0216, 584.6018, 606.5239, 647.5630, 637.6523],
       device='cuda:3')
sorted_norm is   tensor([487.6800, 504.7975, 554.2955, 556.6008, 570.8958, 584.6018, 603.1373,
        606.5239, 614.0851, 616.6739, 620.9405, 626.0216, 627.5312, 632.1462,
        637.6086, 637.6523, 647.5630, 648.5651, 652.1027, 658.6948, 661.3676,
        661.4064, 663.2573, 665.8824, 667.5168, 672.2592, 684.1594, 689.3282],
       device='cuda:3')
used idx is  tensor([ 4,  6,  0,  5,  7, 24,  3, 25, 21, 22, 15, 23, 12,  1,  8, 27, 26,  9,
        13,  2, 18, 16], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 87.04% 

Test Accuracy: 85.98% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7831739187240601
distance x is tensor(123.6408, device='cuda:3')
benign distance is  tensor(123.6408, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5889713764190674
distance x is tensor(125.8560, device='cuda:3')
benign distance is  tensor(125.8560, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12881623208522797
distance x is tensor(133.4845, device='cuda:3')
benign distance is  tensor(133.4845, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6856714487075806
distance x is tensor(119.7759, device='cuda:3')
benign distance is  tensor(119.7759, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.56633061170578
distance x is tensor(111.5374, device='cuda:3')
benign distance is  tensor(111.5374, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3376668393611908
distance x is tensor(122.1774, device='cuda:3')
benign distance is  tensor(122.1774, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25223419070243835
distance x is tensor(117.1140, device='cuda:3')
benign distance is  tensor(117.1140, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.41191259026527405
distance x is tensor(116.3286, device='cuda:3')
benign distance is  tensor(116.3286, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21574082970619202
distance x is tensor(143.0270, device='cuda:3')
benign distance is  tensor(143.0270, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7052198052406311
distance x is tensor(137.0846, device='cuda:3')
benign distance is  tensor(137.0846, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.17030365765094757
distance x is tensor(121.1674, device='cuda:3')
benign distance is  tensor(121.1674, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4500961899757385
distance x is tensor(146.7680, device='cuda:3')
benign distance is  tensor(146.7680, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.438070684671402
distance x is tensor(135.0545, device='cuda:3')
benign distance is  tensor(135.0545, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.46072378754615784
distance x is tensor(130.1271, device='cuda:3')
benign distance is  tensor(130.1271, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6437183022499084
distance x is tensor(125.5398, device='cuda:3')
benign distance is  tensor(125.5398, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0343341827392578
distance x is tensor(129.6443, device='cuda:3')
benign distance is  tensor(129.6443, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.409952163696289
distance x is tensor(156.6006, device='cuda:3')
benign distance is  tensor(156.6006, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  15.03772258758545
distance x is tensor(155.6751, device='cuda:3')
benign distance is  tensor(155.6751, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  14.853761672973633
distance x is tensor(166.4540, device='cuda:3')
benign distance is  tensor(166.4540, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  17.959386825561523
distance x is tensor(160.1330, device='cuda:3')
benign distance is  tensor(160.1330, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  14.257328987121582
distance x is tensor(163.3143, device='cuda:3')
benign distance is  tensor(163.3143, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  17.45656967163086
distance x is tensor(170.1970, device='cuda:3')
benign distance is  tensor(170.1970, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.919931411743164
distance x is tensor(170.1085, device='cuda:3')
benign distance is  tensor(170.1085, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.17512321472168
distance x is tensor(167.6089, device='cuda:3')
benign distance is  tensor(167.6089, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  15.14582633972168
distance x is tensor(165.5248, device='cuda:3')
benign distance is  tensor(165.5248, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  18.401899337768555
distance x is tensor(157.0424, device='cuda:3')
benign distance is  tensor(157.0424, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.002284049987793
distance x is tensor(170.3563, device='cuda:3')
benign distance is  tensor(170.3563, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  14.551831245422363
distance x is tensor(168.2366, device='cuda:3')
benign distance is  tensor(168.2366, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([545.3884, 571.2709, 587.8507, 540.3187, 493.6398, 542.3143, 524.3066,
        522.0596, 638.7568, 643.0320, 705.1688, 663.6385, 691.4111, 700.7819,
        716.9511, 717.0075, 689.3226, 669.0565, 697.1995, 704.7348],
       device='cuda:3')
sorted_norm is   tensor([493.6398, 522.0596, 524.3066, 540.3187, 542.3143, 545.3884, 571.2709,
        587.8507, 638.7568, 643.0320, 663.6385, 669.0565, 689.3226, 691.4111,
        697.1995, 700.7819, 704.7348, 705.1688, 716.9511, 717.0075],
       device='cuda:3')
used idx is  tensor([ 4,  7,  6,  3,  5,  0,  1,  2,  8,  9, 11, 17, 16, 12, 18, 13],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 4.79% 

Test Accuracy: 4.64% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.16874949634075165
distance x is tensor(167.9321, device='cuda:3')
benign distance is  tensor(167.9321, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5678108334541321
distance x is tensor(169.0780, device='cuda:3')
benign distance is  tensor(169.0780, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3096666932106018
distance x is tensor(179.4351, device='cuda:3')
benign distance is  tensor(179.4351, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9236960411071777
distance x is tensor(174.4600, device='cuda:3')
benign distance is  tensor(174.4600, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.360562801361084
distance x is tensor(171.3100, device='cuda:3')
benign distance is  tensor(171.3100, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6245749592781067
distance x is tensor(166.8608, device='cuda:3')
benign distance is  tensor(166.8608, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.293681800365448
distance x is tensor(157.7701, device='cuda:3')
benign distance is  tensor(157.7701, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31724077463150024
distance x is tensor(163.1282, device='cuda:3')
benign distance is  tensor(163.1282, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.166061401367188
distance x is tensor(119.8538, device='cuda:3')
benign distance is  tensor(119.8538, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  11.82693099975586
distance x is tensor(126.4179, device='cuda:3')
benign distance is  tensor(126.4179, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.746994018554688
distance x is tensor(133.4419, device='cuda:3')
benign distance is  tensor(133.4419, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.212278366088867
distance x is tensor(126.6783, device='cuda:3')
benign distance is  tensor(126.6783, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  14.478628158569336
distance x is tensor(135.9034, device='cuda:3')
benign distance is  tensor(135.9034, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  11.936363220214844
distance x is tensor(130.3097, device='cuda:3')
benign distance is  tensor(130.3097, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  13.632161140441895
distance x is tensor(138.1152, device='cuda:3')
benign distance is  tensor(138.1152, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.73741340637207
distance x is tensor(135.7286, device='cuda:3')
benign distance is  tensor(135.7286, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  17.226408004760742
distance x is tensor(139.5414, device='cuda:3')
benign distance is  tensor(139.5414, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.353857040405273
distance x is tensor(126.3159, device='cuda:3')
benign distance is  tensor(126.3159, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.53244400024414
distance x is tensor(142.2329, device='cuda:3')
benign distance is  tensor(142.2329, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  14.82886028289795
distance x is tensor(133.1573, device='cuda:3')
benign distance is  tensor(133.1573, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([726.0643, 733.1677, 748.8268, 738.3697, 742.3395, 704.8700, 674.9092,
        706.1841, 542.9996, 571.5431, 600.9905, 578.8448, 610.8931, 585.2024,
        631.3405, 615.9537, 626.3868, 566.3596, 626.3597, 589.2991, 702.8098,
        652.0565, 651.4053, 718.6044, 688.4902, 663.9803, 638.6664, 644.7334,
        721.3915, 644.3501, 681.5254, 651.3337, 633.8199, 674.0902, 647.9033,
        664.3606, 692.8926, 720.4136, 651.3135, 664.5438, 676.6486, 644.3468,
        708.9175, 685.2437, 672.0226, 649.1956, 580.9240, 692.1345, 639.0513,
        623.7644, 602.4912, 617.6134], device='cuda:3')
sorted_norm is   tensor([542.9996, 566.3596, 571.5431, 578.8448, 580.9240, 585.2024, 589.2991,
        600.9905, 602.4912, 610.8931, 615.9537, 617.6134, 623.7644, 626.3597,
        626.3868, 631.3405, 633.8199, 638.6664, 639.0513, 644.3468, 644.3501,
        644.7334, 647.9033, 649.1956, 651.3135, 651.3337, 651.4053, 652.0565,
        663.9803, 664.3606, 664.5438, 672.0226, 674.0902, 674.9092, 676.6486,
        681.5254, 685.2437, 688.4902, 692.1345, 692.8926, 702.8098, 704.8700,
        706.1841, 708.9175, 718.6044, 720.4136, 721.3915, 726.0643, 733.1677,
        738.3697, 742.3395, 748.8268], device='cuda:3')
used idx is  tensor([ 8, 17,  9, 11, 46, 13, 19, 10, 50, 12, 15, 51, 49, 18, 16, 14, 32, 26,
        48, 41, 29, 27, 34, 45, 38, 31, 22, 21, 25, 35, 39, 44, 33,  6, 40, 30,
        43, 24, 47, 36, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.70% 

Test Accuracy: 89.06% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5395864248275757
distance x is tensor(104.2007, device='cuda:3')
benign distance is  tensor(104.2007, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6894740462303162
distance x is tensor(122.8735, device='cuda:3')
benign distance is  tensor(122.8735, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03535833954811096
distance x is tensor(124.8085, device='cuda:3')
benign distance is  tensor(124.8085, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47503986954689026
distance x is tensor(113.0332, device='cuda:3')
benign distance is  tensor(113.0332, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33785486221313477
distance x is tensor(112.8697, device='cuda:3')
benign distance is  tensor(112.8697, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4128906726837158
distance x is tensor(120.6040, device='cuda:3')
benign distance is  tensor(120.6040, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29083889722824097
distance x is tensor(96.3098, device='cuda:3')
benign distance is  tensor(96.3098, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46469664573669434
distance x is tensor(107.0048, device='cuda:3')
benign distance is  tensor(107.0048, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2434752881526947
distance x is tensor(138.1301, device='cuda:3')
benign distance is  tensor(138.1301, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4371287226676941
distance x is tensor(139.0802, device='cuda:3')
benign distance is  tensor(139.0802, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.583675742149353
distance x is tensor(119.4704, device='cuda:3')
benign distance is  tensor(119.4704, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6817134618759155
distance x is tensor(129.7897, device='cuda:3')
benign distance is  tensor(129.7897, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4397273063659668
distance x is tensor(130.5197, device='cuda:3')
benign distance is  tensor(130.5197, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.39121612906455994
distance x is tensor(134.1822, device='cuda:3')
benign distance is  tensor(134.1822, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2571425139904022
distance x is tensor(130.4987, device='cuda:3')
benign distance is  tensor(130.4987, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9002760052680969
distance x is tensor(137.1481, device='cuda:3')
benign distance is  tensor(137.1481, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.18304722011089325
distance x is tensor(132.3589, device='cuda:3')
benign distance is  tensor(132.3589, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6827750205993652
distance x is tensor(152.4587, device='cuda:3')
benign distance is  tensor(152.4587, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.18114593625068665
distance x is tensor(129.4972, device='cuda:3')
benign distance is  tensor(129.4972, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.32293838262557983
distance x is tensor(123.3141, device='cuda:3')
benign distance is  tensor(123.3141, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.34234005212783813
distance x is tensor(127.6745, device='cuda:3')
benign distance is  tensor(127.6745, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5005267858505249
distance x is tensor(130.2079, device='cuda:3')
benign distance is  tensor(130.2079, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5534735918045044
distance x is tensor(138.4622, device='cuda:3')
benign distance is  tensor(138.4622, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.35316577553749084
distance x is tensor(135.2182, device='cuda:3')
benign distance is  tensor(135.2182, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.13721856474876404
distance x is tensor(144.9085, device='cuda:3')
benign distance is  tensor(144.9085, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.38018158078193665
distance x is tensor(125.1450, device='cuda:3')
benign distance is  tensor(125.1450, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3976185917854309
distance x is tensor(129.7963, device='cuda:3')
benign distance is  tensor(129.7963, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3311155438423157
distance x is tensor(135.6725, device='cuda:3')
benign distance is  tensor(135.6725, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6593058705329895
distance x is tensor(133.8188, device='cuda:3')
benign distance is  tensor(133.8188, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5543853640556335
distance x is tensor(129.9296, device='cuda:3')
benign distance is  tensor(129.9296, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6045724749565125
distance x is tensor(121.0848, device='cuda:3')
benign distance is  tensor(121.0848, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.26259395480155945
distance x is tensor(136.1356, device='cuda:3')
benign distance is  tensor(136.1356, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.38907963037490845
distance x is tensor(131.3630, device='cuda:3')
benign distance is  tensor(131.3630, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.11704938113689423
distance x is tensor(130.6957, device='cuda:3')
benign distance is  tensor(130.6957, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5324990749359131
distance x is tensor(129.7131, device='cuda:3')
benign distance is  tensor(129.7131, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.061343349516391754
distance x is tensor(139.3681, device='cuda:3')
benign distance is  tensor(139.3681, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3334633708000183
distance x is tensor(132.4739, device='cuda:3')
benign distance is  tensor(132.4739, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7244340181350708
distance x is tensor(131.4116, device='cuda:3')
benign distance is  tensor(131.4116, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8270221948623657
distance x is tensor(136.6142, device='cuda:3')
benign distance is  tensor(136.6142, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.24791845679283142
distance x is tensor(137.5699, device='cuda:3')
benign distance is  tensor(137.5699, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.282008171081543
distance x is tensor(181.6055, device='cuda:3')
benign distance is  tensor(181.6055, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.139820098876953
distance x is tensor(175.6925, device='cuda:3')
benign distance is  tensor(175.6925, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.774653434753418
distance x is tensor(183.7852, device='cuda:3')
benign distance is  tensor(183.7852, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  16.67464828491211
distance x is tensor(186.3530, device='cuda:3')
benign distance is  tensor(186.3530, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.86302661895752
distance x is tensor(181.4316, device='cuda:3')
benign distance is  tensor(181.4316, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  15.195963859558105
distance x is tensor(187.6023, device='cuda:3')
benign distance is  tensor(187.6023, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.261258125305176
distance x is tensor(183.3759, device='cuda:3')
benign distance is  tensor(183.3759, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  18.039762496948242
distance x is tensor(174.7857, device='cuda:3')
benign distance is  tensor(174.7857, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.2797794342041
distance x is tensor(184.7468, device='cuda:3')
benign distance is  tensor(184.7468, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.11525535583496
distance x is tensor(181.4507, device='cuda:3')
benign distance is  tensor(181.4507, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  15.871679306030273
distance x is tensor(187.3190, device='cuda:3')
benign distance is  tensor(187.3190, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  15.426475524902344
distance x is tensor(177.5794, device='cuda:3')
benign distance is  tensor(177.5794, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([470.1066, 573.3088, 553.3375, 508.5042, 502.7750, 550.1581, 425.5426,
        474.2752, 709.8958, 702.2657, 746.9858, 751.2371, 741.1733, 763.5168,
        737.4389, 707.6073, 747.3362, 716.7048, 750.3400, 720.1430, 639.3481,
        589.4327, 685.5159, 603.7065, 639.5222, 572.3259, 574.7175, 605.3530],
       device='cuda:3')
sorted_norm is   tensor([425.5426, 470.1066, 474.2752, 502.7750, 508.5042, 550.1581, 553.3375,
        572.3259, 573.3088, 574.7175, 589.4327, 603.7065, 605.3530, 639.3481,
        639.5222, 685.5159, 702.2657, 707.6073, 709.8958, 716.7048, 720.1430,
        737.4389, 741.1733, 746.9858, 747.3362, 750.3400, 751.2371, 763.5168],
       device='cuda:3')
used idx is  tensor([ 6,  0,  7,  4,  3,  5,  2, 25,  1, 26, 21, 23, 27, 20, 24, 22,  9, 15,
         8, 17, 19, 14], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 52.48% 

Test Accuracy: 51.26% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3771330118179321
distance x is tensor(123.7801, device='cuda:3')
benign distance is  tensor(123.7801, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.548500657081604
distance x is tensor(143.8087, device='cuda:3')
benign distance is  tensor(143.8087, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.02182600647211075
distance x is tensor(147.6631, device='cuda:3')
benign distance is  tensor(147.6631, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6825879216194153
distance x is tensor(128.9229, device='cuda:3')
benign distance is  tensor(128.9229, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0220582485198975
distance x is tensor(148.1297, device='cuda:3')
benign distance is  tensor(148.1297, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8389228582382202
distance x is tensor(137.7128, device='cuda:3')
benign distance is  tensor(137.7128, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.04803917929530144
distance x is tensor(129.9559, device='cuda:3')
benign distance is  tensor(129.9559, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.42159873247146606
distance x is tensor(132.1612, device='cuda:3')
benign distance is  tensor(132.1612, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7894530296325684
distance x is tensor(145.3575, device='cuda:3')
benign distance is  tensor(145.3575, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.23437651991844177
distance x is tensor(153.2163, device='cuda:3')
benign distance is  tensor(153.2163, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3828275799751282
distance x is tensor(151.4637, device='cuda:3')
benign distance is  tensor(151.4637, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.24936911463737488
distance x is tensor(146.4829, device='cuda:3')
benign distance is  tensor(146.4829, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5093966722488403
distance x is tensor(146.4759, device='cuda:3')
benign distance is  tensor(146.4759, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.636201024055481
distance x is tensor(148.1111, device='cuda:3')
benign distance is  tensor(148.1111, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.37708646059036255
distance x is tensor(135.3450, device='cuda:3')
benign distance is  tensor(135.3450, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.13718275725841522
distance x is tensor(141.8897, device='cuda:3')
benign distance is  tensor(141.8897, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.243861198425293
distance x is tensor(141.0549, device='cuda:3')
benign distance is  tensor(141.0549, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.475177764892578
distance x is tensor(140.8916, device='cuda:3')
benign distance is  tensor(140.8916, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.813029289245605
distance x is tensor(146.2033, device='cuda:3')
benign distance is  tensor(146.2033, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.825444221496582
distance x is tensor(144.5640, device='cuda:3')
benign distance is  tensor(144.5640, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  18.491403579711914
distance x is tensor(135.0506, device='cuda:3')
benign distance is  tensor(135.0506, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  17.646770477294922
distance x is tensor(150.3532, device='cuda:3')
benign distance is  tensor(150.3532, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.684257507324219
distance x is tensor(146.0908, device='cuda:3')
benign distance is  tensor(146.0908, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  18.13479995727539
distance x is tensor(145.8837, device='cuda:3')
benign distance is  tensor(145.8837, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.253376007080078
distance x is tensor(147.9957, device='cuda:3')
benign distance is  tensor(147.9957, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.351034164428711
distance x is tensor(136.8037, device='cuda:3')
benign distance is  tensor(136.8037, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  17.21622657775879
distance x is tensor(142.2318, device='cuda:3')
benign distance is  tensor(142.2318, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.552801132202148
distance x is tensor(141.1426, device='cuda:3')
benign distance is  tensor(141.1426, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([546.3262, 631.8506, 653.2013, 552.2966, 657.3177, 609.8155, 556.5586,
        583.4549, 603.6531, 605.5723, 650.2420, 642.4766, 601.2728, 655.1887,
        658.1003, 640.8785, 648.1686, 590.8772, 603.9647, 609.3967, 639.4982,
        638.3981, 571.7515, 601.6213, 619.8868, 633.8478, 611.6823, 637.3181],
       device='cuda:3')
sorted_norm is   tensor([546.3262, 552.2966, 556.5586, 571.7515, 583.4549, 590.8772, 601.2728,
        601.6213, 603.6531, 603.9647, 605.5723, 609.3967, 609.8155, 611.6823,
        619.8868, 631.8506, 633.8478, 637.3181, 638.3981, 639.4982, 640.8785,
        642.4766, 648.1686, 650.2420, 653.2013, 655.1887, 657.3177, 658.1003],
       device='cuda:3')
used idx is  tensor([ 0,  3,  6, 22,  7, 17, 12, 23,  8, 18,  9, 19,  5, 26, 24,  1, 25, 27,
        21, 20, 15, 11], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 82.28% 

Test Accuracy: 80.95% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.38747137784957886
distance x is tensor(119.9406, device='cuda:3')
benign distance is  tensor(119.9406, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8548504114151001
distance x is tensor(125.3694, device='cuda:3')
benign distance is  tensor(125.3694, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2709329128265381
distance x is tensor(127.6803, device='cuda:3')
benign distance is  tensor(127.6803, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4408940374851227
distance x is tensor(116.2738, device='cuda:3')
benign distance is  tensor(116.2738, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8128632307052612
distance x is tensor(121.3365, device='cuda:3')
benign distance is  tensor(121.3365, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4265512526035309
distance x is tensor(117.4355, device='cuda:3')
benign distance is  tensor(117.4355, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13491995632648468
distance x is tensor(120.6894, device='cuda:3')
benign distance is  tensor(120.6894, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5888737440109253
distance x is tensor(129.3060, device='cuda:3')
benign distance is  tensor(129.3060, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.566222608089447
distance x is tensor(134.8217, device='cuda:3')
benign distance is  tensor(134.8217, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.14806950092315674
distance x is tensor(148.0468, device='cuda:3')
benign distance is  tensor(148.0468, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.673064112663269
distance x is tensor(133.3332, device='cuda:3')
benign distance is  tensor(133.3332, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4748452603816986
distance x is tensor(137.0274, device='cuda:3')
benign distance is  tensor(137.0274, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.40278729796409607
distance x is tensor(135.4252, device='cuda:3')
benign distance is  tensor(135.4252, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.38008469343185425
distance x is tensor(139.3853, device='cuda:3')
benign distance is  tensor(139.3853, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31980493664741516
distance x is tensor(131.3615, device='cuda:3')
benign distance is  tensor(131.3615, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.14175300300121307
distance x is tensor(137.8055, device='cuda:3')
benign distance is  tensor(137.8055, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.962122917175293
distance x is tensor(153.0918, device='cuda:3')
benign distance is  tensor(153.0918, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  18.171554565429688
distance x is tensor(155.5879, device='cuda:3')
benign distance is  tensor(155.5879, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  18.314136505126953
distance x is tensor(167.2280, device='cuda:3')
benign distance is  tensor(167.2280, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  18.467851638793945
distance x is tensor(153.2569, device='cuda:3')
benign distance is  tensor(153.2569, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  16.397071838378906
distance x is tensor(160.9977, device='cuda:3')
benign distance is  tensor(160.9977, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.75112533569336
distance x is tensor(154.1163, device='cuda:3')
benign distance is  tensor(154.1163, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  13.557965278625488
distance x is tensor(163.3172, device='cuda:3')
benign distance is  tensor(163.3172, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.27019214630127
distance x is tensor(159.3485, device='cuda:3')
benign distance is  tensor(159.3485, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.701024055480957
distance x is tensor(153.4364, device='cuda:3')
benign distance is  tensor(153.4364, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  16.639848709106445
distance x is tensor(157.1439, device='cuda:3')
benign distance is  tensor(157.1439, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  15.91150951385498
distance x is tensor(178.4824, device='cuda:3')
benign distance is  tensor(178.4824, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  17.95620346069336
distance x is tensor(165.6601, device='cuda:3')
benign distance is  tensor(165.6601, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([525.6529, 558.3411, 566.7640, 514.7325, 531.1324, 524.1564, 534.9288,
        574.8482, 626.9825, 645.4501, 704.2304, 650.5594, 673.4966, 665.9562,
        704.1769, 687.2738, 642.4398, 660.2699, 738.0682, 680.6870, 617.4314,
        700.9692, 602.1526, 573.7932, 601.2814, 616.0340, 643.8677, 631.8193],
       device='cuda:3')
sorted_norm is   tensor([514.7325, 524.1564, 525.6529, 531.1324, 534.9288, 558.3411, 566.7640,
        573.7932, 574.8482, 601.2814, 602.1526, 616.0340, 617.4314, 626.9825,
        631.8193, 642.4398, 643.8677, 645.4501, 650.5594, 660.2699, 665.9562,
        673.4966, 680.6870, 687.2738, 700.9692, 704.1769, 704.2304, 738.0682],
       device='cuda:3')
used idx is  tensor([ 3,  5,  0,  4,  6,  1,  2, 23,  7, 24, 22, 25, 20,  8, 27, 16, 26,  9,
        11, 17, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 69.55% 

Test Accuracy: 68.79% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4166247248649597
distance x is tensor(117.6901, device='cuda:3')
benign distance is  tensor(117.6901, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.29962557554244995
distance x is tensor(139.3047, device='cuda:3')
benign distance is  tensor(139.3047, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08409304916858673
distance x is tensor(159.7847, device='cuda:3')
benign distance is  tensor(159.7847, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.25127410888671875
distance x is tensor(124.8971, device='cuda:3')
benign distance is  tensor(124.8971, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4138696789741516
distance x is tensor(128.8440, device='cuda:3')
benign distance is  tensor(128.8440, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7464057207107544
distance x is tensor(145.6686, device='cuda:3')
benign distance is  tensor(145.6686, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29085680842399597
distance x is tensor(107.8976, device='cuda:3')
benign distance is  tensor(107.8976, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.13840338587760925
distance x is tensor(129.7006, device='cuda:3')
benign distance is  tensor(129.7006, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5575511455535889
distance x is tensor(161.4998, device='cuda:3')
benign distance is  tensor(161.4998, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6644264459609985
distance x is tensor(149.9170, device='cuda:3')
benign distance is  tensor(149.9170, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.12751072645187378
distance x is tensor(145.5453, device='cuda:3')
benign distance is  tensor(145.5453, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1316235512495041
distance x is tensor(137.9950, device='cuda:3')
benign distance is  tensor(137.9950, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.21721872687339783
distance x is tensor(145.8326, device='cuda:3')
benign distance is  tensor(145.8326, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5497256517410278
distance x is tensor(146.5837, device='cuda:3')
benign distance is  tensor(146.5837, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.08836044371128082
distance x is tensor(151.0354, device='cuda:3')
benign distance is  tensor(151.0354, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7612637281417847
distance x is tensor(150.0325, device='cuda:3')
benign distance is  tensor(150.0325, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.341351509094238
distance x is tensor(148.4892, device='cuda:3')
benign distance is  tensor(148.4892, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  18.714237213134766
distance x is tensor(152.2598, device='cuda:3')
benign distance is  tensor(152.2598, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  18.558156967163086
distance x is tensor(156.1275, device='cuda:3')
benign distance is  tensor(156.1275, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.15709114074707
distance x is tensor(147.7133, device='cuda:3')
benign distance is  tensor(147.7133, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  17.02604103088379
distance x is tensor(164.1286, device='cuda:3')
benign distance is  tensor(164.1286, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  13.224599838256836
distance x is tensor(149.3786, device='cuda:3')
benign distance is  tensor(149.3786, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.957986831665039
distance x is tensor(159.5970, device='cuda:3')
benign distance is  tensor(159.5970, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.323501586914062
distance x is tensor(158.5888, device='cuda:3')
benign distance is  tensor(158.5888, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  15.712486267089844
distance x is tensor(160.9964, device='cuda:3')
benign distance is  tensor(160.9964, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.233253479003906
distance x is tensor(146.7279, device='cuda:3')
benign distance is  tensor(146.7279, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  17.030441284179688
distance x is tensor(160.7275, device='cuda:3')
benign distance is  tensor(160.7275, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  18.946653366088867
distance x is tensor(161.0352, device='cuda:3')
benign distance is  tensor(161.0352, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([519.4387, 625.2851, 708.4003, 546.4995, 570.0084, 655.3965, 470.1506,
        584.1040, 624.3994, 659.2393, 658.1003, 636.0585, 701.5994, 635.4953,
        678.7099, 669.8932, 687.1014, 640.3412, 699.8207, 680.4476, 689.4041,
        587.4324, 605.9656, 628.7064, 622.5015, 611.2391, 580.9022, 639.9575,
        615.6927, 665.2084, 604.3113, 622.9762, 627.6395, 645.5222, 609.2604,
        632.4706], device='cuda:3')
sorted_norm is   tensor([470.1506, 519.4387, 546.4995, 570.0084, 580.9022, 584.1040, 587.4324,
        604.3113, 605.9656, 609.2604, 611.2391, 615.6927, 622.5015, 622.9762,
        624.3994, 625.2851, 627.6395, 628.7064, 632.4706, 635.4953, 636.0585,
        639.9575, 640.3412, 645.5222, 655.3965, 658.1003, 659.2393, 665.2084,
        669.8932, 678.7099, 680.4476, 687.1014, 689.4041, 699.8207, 701.5994,
        708.4003], device='cuda:3')
used idx is  tensor([ 6,  0,  3,  4, 26,  7, 21, 30, 22, 34, 25, 28, 24, 31,  8,  1, 32, 23,
        35, 13, 11, 27, 17, 33,  5, 10,  9, 29], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 89.12% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.10502772033214569
distance x is tensor(101.6880, device='cuda:3')
benign distance is  tensor(101.6880, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5288863778114319
distance x is tensor(114.6709, device='cuda:3')
benign distance is  tensor(114.6709, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04511387273669243
distance x is tensor(122.3986, device='cuda:3')
benign distance is  tensor(122.3986, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4943862557411194
distance x is tensor(116.4966, device='cuda:3')
benign distance is  tensor(116.4966, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3592425286769867
distance x is tensor(105.0926, device='cuda:3')
benign distance is  tensor(105.0926, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.833586573600769
distance x is tensor(119.6048, device='cuda:3')
benign distance is  tensor(119.6048, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22988680005073547
distance x is tensor(106.5979, device='cuda:3')
benign distance is  tensor(106.5979, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6573842763900757
distance x is tensor(113.7792, device='cuda:3')
benign distance is  tensor(113.7792, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7117344737052917
distance x is tensor(138.7561, device='cuda:3')
benign distance is  tensor(138.7561, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3519001603126526
distance x is tensor(124.7464, device='cuda:3')
benign distance is  tensor(124.7464, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.645884096622467
distance x is tensor(121.3719, device='cuda:3')
benign distance is  tensor(121.3719, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9568421244621277
distance x is tensor(125.6822, device='cuda:3')
benign distance is  tensor(125.6822, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2923879027366638
distance x is tensor(121.4550, device='cuda:3')
benign distance is  tensor(121.4550, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.41031455993652344
distance x is tensor(142.1572, device='cuda:3')
benign distance is  tensor(142.1572, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7245673537254333
distance x is tensor(131.1885, device='cuda:3')
benign distance is  tensor(131.1885, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5824116468429565
distance x is tensor(123.0497, device='cuda:3')
benign distance is  tensor(123.0497, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.682407021522522
distance x is tensor(156.1681, device='cuda:3')
benign distance is  tensor(156.1681, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.569774866104126
distance x is tensor(129.4078, device='cuda:3')
benign distance is  tensor(129.4078, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.29467591643333435
distance x is tensor(122.5821, device='cuda:3')
benign distance is  tensor(122.5821, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4808627963066101
distance x is tensor(140.0253, device='cuda:3')
benign distance is  tensor(140.0253, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9980729222297668
distance x is tensor(125.2833, device='cuda:3')
benign distance is  tensor(125.2833, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4057648777961731
distance x is tensor(141.5535, device='cuda:3')
benign distance is  tensor(141.5535, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.43030452728271484
distance x is tensor(126.7854, device='cuda:3')
benign distance is  tensor(126.7854, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.21096602082252502
distance x is tensor(135.8372, device='cuda:3')
benign distance is  tensor(135.8372, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  20.63825225830078
distance x is tensor(191.1589, device='cuda:3')
benign distance is  tensor(191.1589, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  15.562591552734375
distance x is tensor(187.5587, device='cuda:3')
benign distance is  tensor(187.5587, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  16.53152084350586
distance x is tensor(202.4775, device='cuda:3')
benign distance is  tensor(202.4775, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  17.739459991455078
distance x is tensor(200.1328, device='cuda:3')
benign distance is  tensor(200.1328, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.564041137695312
distance x is tensor(199.6634, device='cuda:3')
benign distance is  tensor(199.6634, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.919334411621094
distance x is tensor(196.7489, device='cuda:3')
benign distance is  tensor(196.7489, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.351658821105957
distance x is tensor(200.0927, device='cuda:3')
benign distance is  tensor(200.0927, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.892962455749512
distance x is tensor(192.5720, device='cuda:3')
benign distance is  tensor(192.5720, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.489395141601562
distance x is tensor(189.0314, device='cuda:3')
benign distance is  tensor(189.0314, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.41863441467285
distance x is tensor(179.7645, device='cuda:3')
benign distance is  tensor(179.7645, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  18.037906646728516
distance x is tensor(194.4361, device='cuda:3')
benign distance is  tensor(194.4361, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  12.7727632522583
distance x is tensor(194.8680, device='cuda:3')
benign distance is  tensor(194.8680, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([444.9091, 516.7122, 542.6801, 506.4990, 464.3463, 523.4889, 467.4708,
        521.3638, 751.8141, 751.0146, 797.0071, 789.0012, 800.1813, 790.6269,
        799.2434, 779.3972, 759.2417, 720.8923, 789.7283, 773.5159],
       device='cuda:3')
sorted_norm is   tensor([444.9091, 464.3463, 467.4708, 506.4990, 516.7122, 521.3638, 523.4889,
        542.6801, 720.8923, 751.0146, 751.8141, 759.2417, 773.5159, 779.3972,
        789.0012, 789.7283, 790.6269, 797.0071, 799.2434, 800.1813],
       device='cuda:3')
used idx is  tensor([ 0,  4,  6,  3,  1,  7,  5,  2, 17,  9,  8, 16, 19, 15, 11, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 1.88% 

Test Accuracy: 1.78% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.165739506483078
distance x is tensor(196.6843, device='cuda:3')
benign distance is  tensor(196.6843, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3183412551879883
distance x is tensor(177.0911, device='cuda:3')
benign distance is  tensor(177.0911, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7626242637634277
distance x is tensor(196.7899, device='cuda:3')
benign distance is  tensor(196.7899, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9255889654159546
distance x is tensor(191.4476, device='cuda:3')
benign distance is  tensor(191.4476, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9189248085021973
distance x is tensor(178.8849, device='cuda:3')
benign distance is  tensor(178.8849, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3566676378250122
distance x is tensor(194.7380, device='cuda:3')
benign distance is  tensor(194.7380, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.646365761756897
distance x is tensor(186.2073, device='cuda:3')
benign distance is  tensor(186.2073, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.878635048866272
distance x is tensor(179.7591, device='cuda:3')
benign distance is  tensor(179.7591, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  16.479419708251953
distance x is tensor(118.1435, device='cuda:3')
benign distance is  tensor(118.1435, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.64212417602539
distance x is tensor(124.4919, device='cuda:3')
benign distance is  tensor(124.4919, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  14.481050491333008
distance x is tensor(140.6491, device='cuda:3')
benign distance is  tensor(140.6491, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.941067695617676
distance x is tensor(130.2108, device='cuda:3')
benign distance is  tensor(130.2108, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  17.75273323059082
distance x is tensor(126.7770, device='cuda:3')
benign distance is  tensor(126.7770, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  17.45609474182129
distance x is tensor(125.5840, device='cuda:3')
benign distance is  tensor(125.5840, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  16.503864288330078
distance x is tensor(132.1460, device='cuda:3')
benign distance is  tensor(132.1460, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  12.236628532409668
distance x is tensor(127.4606, device='cuda:3')
benign distance is  tensor(127.4606, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  15.723596572875977
distance x is tensor(118.3002, device='cuda:3')
benign distance is  tensor(118.3002, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  14.599775314331055
distance x is tensor(117.7838, device='cuda:3')
benign distance is  tensor(117.7838, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.864709854125977
distance x is tensor(147.4081, device='cuda:3')
benign distance is  tensor(147.4081, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  16.14438247680664
distance x is tensor(125.6755, device='cuda:3')
benign distance is  tensor(125.6755, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([827.1028, 744.4212, 828.5577, 812.9717, 751.8342, 827.9211, 782.7743,
        751.5486, 531.3126, 569.3449, 650.7961, 580.1309, 584.6035, 566.5168,
        611.9848, 596.3773, 549.7936, 538.8004, 655.1638, 566.1699, 659.2237,
        661.2731, 664.0163, 690.4649, 664.9966, 671.0714, 679.6834, 692.9183,
        734.2520, 747.6247, 734.3282, 718.2061, 734.8470, 725.7263, 674.5889,
        701.5643, 781.9231, 718.9444, 715.3323, 681.0555, 695.4868, 705.6613,
        728.5673, 717.6512, 667.3833, 611.4756, 616.4786, 620.7926, 602.7594,
        694.5544, 634.1923, 608.2679], device='cuda:3')
sorted_norm is   tensor([531.3126, 538.8004, 549.7936, 566.1699, 566.5168, 569.3449, 580.1309,
        584.6035, 596.3773, 602.7594, 608.2679, 611.4756, 611.9848, 616.4786,
        620.7926, 634.1923, 650.7961, 655.1638, 659.2237, 661.2731, 664.0163,
        664.9966, 667.3833, 671.0714, 674.5889, 679.6834, 681.0555, 690.4649,
        692.9183, 694.5544, 695.4868, 701.5643, 705.6613, 715.3323, 717.6512,
        718.2061, 718.9444, 725.7263, 728.5673, 734.2520, 734.3282, 734.8470,
        744.4212, 747.6247, 751.5486, 751.8342, 781.9231, 782.7743, 812.9717,
        827.1028, 827.9211, 828.5577], device='cuda:3')
used idx is  tensor([ 8, 17, 16, 19, 13,  9, 11, 12, 15, 48, 51, 45, 14, 46, 47, 50, 10, 18,
        20, 21, 22, 24, 44, 25, 34, 26, 39, 23, 27, 49, 40, 35, 41, 38, 43, 31,
        37, 33, 42, 28, 30], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.31% 

Test Accuracy: 88.86% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.31430426239967346
distance x is tensor(104.2440, device='cuda:3')
benign distance is  tensor(104.2440, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8114508390426636
distance x is tensor(122.8268, device='cuda:3')
benign distance is  tensor(122.8268, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4631546437740326
distance x is tensor(129.2440, device='cuda:3')
benign distance is  tensor(129.2440, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6548633575439453
distance x is tensor(119.7865, device='cuda:3')
benign distance is  tensor(119.7865, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6929880380630493
distance x is tensor(104.6430, device='cuda:3')
benign distance is  tensor(104.6430, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3481365740299225
distance x is tensor(119.2021, device='cuda:3')
benign distance is  tensor(119.2021, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3885655403137207
distance x is tensor(112.8391, device='cuda:3')
benign distance is  tensor(112.8391, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29322952032089233
distance x is tensor(111.0277, device='cuda:3')
benign distance is  tensor(111.0277, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.49909257888793945
distance x is tensor(140.8947, device='cuda:3')
benign distance is  tensor(140.8947, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2760801911354065
distance x is tensor(131.5757, device='cuda:3')
benign distance is  tensor(131.5757, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4229167103767395
distance x is tensor(126.8164, device='cuda:3')
benign distance is  tensor(126.8164, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4304162561893463
distance x is tensor(119.0281, device='cuda:3')
benign distance is  tensor(119.0281, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.46117743849754333
distance x is tensor(115.8691, device='cuda:3')
benign distance is  tensor(115.8691, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8990631103515625
distance x is tensor(134.2327, device='cuda:3')
benign distance is  tensor(134.2327, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.532827615737915
distance x is tensor(123.8716, device='cuda:3')
benign distance is  tensor(123.8716, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.81634122133255
distance x is tensor(132.2631, device='cuda:3')
benign distance is  tensor(132.2631, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.20004403591156006
distance x is tensor(135.2136, device='cuda:3')
benign distance is  tensor(135.2136, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6698946356773376
distance x is tensor(141.6573, device='cuda:3')
benign distance is  tensor(141.6573, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1429053246974945
distance x is tensor(124.0729, device='cuda:3')
benign distance is  tensor(124.0729, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.11815345287322998
distance x is tensor(131.2988, device='cuda:3')
benign distance is  tensor(131.2988, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.03029673732817173
distance x is tensor(135.9746, device='cuda:3')
benign distance is  tensor(135.9746, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8047429323196411
distance x is tensor(118.7813, device='cuda:3')
benign distance is  tensor(118.7813, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2726590633392334
distance x is tensor(139.7981, device='cuda:3')
benign distance is  tensor(139.7981, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7486516237258911
distance x is tensor(133.0880, device='cuda:3')
benign distance is  tensor(133.0880, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.34321314096450806
distance x is tensor(137.2336, device='cuda:3')
benign distance is  tensor(137.2336, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.0294804610311985
distance x is tensor(129.6754, device='cuda:3')
benign distance is  tensor(129.6754, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.37758105993270874
distance x is tensor(144.2245, device='cuda:3')
benign distance is  tensor(144.2245, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.18814145028591156
distance x is tensor(123.8126, device='cuda:3')
benign distance is  tensor(123.8126, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.356672078371048
distance x is tensor(131.9157, device='cuda:3')
benign distance is  tensor(131.9157, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2425111085176468
distance x is tensor(131.6564, device='cuda:3')
benign distance is  tensor(131.6564, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8064783811569214
distance x is tensor(127.4348, device='cuda:3')
benign distance is  tensor(127.4348, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2779342234134674
distance x is tensor(119.8645, device='cuda:3')
benign distance is  tensor(119.8645, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.23215487599372864
distance x is tensor(129.6953, device='cuda:3')
benign distance is  tensor(129.6953, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8468044400215149
distance x is tensor(124.0888, device='cuda:3')
benign distance is  tensor(124.0888, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1214856505393982
distance x is tensor(127.3516, device='cuda:3')
benign distance is  tensor(127.3516, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2587018311023712
distance x is tensor(140.9656, device='cuda:3')
benign distance is  tensor(140.9656, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.32229703664779663
distance x is tensor(124.8673, device='cuda:3')
benign distance is  tensor(124.8673, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4314141273498535
distance x is tensor(134.0071, device='cuda:3')
benign distance is  tensor(134.0071, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.6309818029403687
distance x is tensor(136.4054, device='cuda:3')
benign distance is  tensor(136.4054, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.39109915494918823
distance x is tensor(133.8299, device='cuda:3')
benign distance is  tensor(133.8299, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  18.350250244140625
distance x is tensor(175.9400, device='cuda:3')
benign distance is  tensor(175.9400, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  18.07114601135254
distance x is tensor(180.6357, device='cuda:3')
benign distance is  tensor(180.6357, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  16.99468994140625
distance x is tensor(187.7917, device='cuda:3')
benign distance is  tensor(187.7917, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.946998596191406
distance x is tensor(183.6067, device='cuda:3')
benign distance is  tensor(183.6067, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.474102973937988
distance x is tensor(200.0236, device='cuda:3')
benign distance is  tensor(200.0236, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  15.795282363891602
distance x is tensor(172.8340, device='cuda:3')
benign distance is  tensor(172.8340, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.32677936553955
distance x is tensor(184.6122, device='cuda:3')
benign distance is  tensor(184.6122, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.211278915405273
distance x is tensor(180.8387, device='cuda:3')
benign distance is  tensor(180.8387, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.647529602050781
distance x is tensor(173.5258, device='cuda:3')
benign distance is  tensor(173.5258, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  16.565885543823242
distance x is tensor(184.7133, device='cuda:3')
benign distance is  tensor(184.7133, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  15.878011703491211
distance x is tensor(187.4195, device='cuda:3')
benign distance is  tensor(187.4195, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  15.95750904083252
distance x is tensor(176.3312, device='cuda:3')
benign distance is  tensor(176.3312, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([467.4525, 554.8322, 577.0185, 527.4716, 463.4613, 536.7081, 471.6393,
        496.5705, 698.6764, 732.3008, 762.3878, 723.6473, 795.0544, 701.4521,
        742.6713, 725.0452, 696.3636, 743.3741, 759.8503, 711.9885],
       device='cuda:3')
sorted_norm is   tensor([463.4613, 467.4525, 471.6393, 496.5705, 527.4716, 536.7081, 554.8322,
        577.0185, 696.3636, 698.6764, 701.4521, 711.9885, 723.6473, 725.0452,
        732.3008, 742.6713, 743.3741, 759.8503, 762.3878, 795.0544],
       device='cuda:3')
used idx is  tensor([ 4,  0,  6,  7,  3,  5,  1,  2, 16,  8, 13, 19, 11, 15,  9, 14],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 2.25% 

Test Accuracy: 2.18% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5291441679000854
distance x is tensor(178.9775, device='cuda:3')
benign distance is  tensor(178.9775, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6874934434890747
distance x is tensor(177.7515, device='cuda:3')
benign distance is  tensor(177.7515, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07243848592042923
distance x is tensor(186.6304, device='cuda:3')
benign distance is  tensor(186.6304, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5595226287841797
distance x is tensor(181.4589, device='cuda:3')
benign distance is  tensor(181.4589, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7583650946617126
distance x is tensor(172.5780, device='cuda:3')
benign distance is  tensor(172.5780, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.27107518911361694
distance x is tensor(183.2372, device='cuda:3')
benign distance is  tensor(183.2372, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.41553038358688354
distance x is tensor(177.8507, device='cuda:3')
benign distance is  tensor(177.8507, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5098427534103394
distance x is tensor(167.3455, device='cuda:3')
benign distance is  tensor(167.3455, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.170114517211914
distance x is tensor(115.7504, device='cuda:3')
benign distance is  tensor(115.7504, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.867172241210938
distance x is tensor(111.0985, device='cuda:3')
benign distance is  tensor(111.0985, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.743730545043945
distance x is tensor(139.5720, device='cuda:3')
benign distance is  tensor(139.5720, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.815526008605957
distance x is tensor(115.3936, device='cuda:3')
benign distance is  tensor(115.3936, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  16.83633041381836
distance x is tensor(131.6901, device='cuda:3')
benign distance is  tensor(131.6901, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.362424850463867
distance x is tensor(123.6076, device='cuda:3')
benign distance is  tensor(123.6076, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.85743236541748
distance x is tensor(122.6016, device='cuda:3')
benign distance is  tensor(122.6016, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  18.38361167907715
distance x is tensor(125.5256, device='cuda:3')
benign distance is  tensor(125.5256, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.89591407775879
distance x is tensor(121.6164, device='cuda:3')
benign distance is  tensor(121.6164, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.39628028869629
distance x is tensor(119.3092, device='cuda:3')
benign distance is  tensor(119.3092, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  14.220149040222168
distance x is tensor(128.2214, device='cuda:3')
benign distance is  tensor(128.2214, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  18.348400115966797
distance x is tensor(121.1449, device='cuda:3')
benign distance is  tensor(121.1449, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([741.9482, 747.7589, 778.8962, 759.2272, 720.4220, 775.4731, 756.5273,
        710.5195, 529.5469, 503.3374, 626.4521, 525.2513, 591.1386, 557.0434,
        558.6710, 575.7175, 554.7939, 538.0351, 584.5194, 542.1966, 753.2932,
        624.3912, 610.7683, 675.1602, 617.8748, 686.5887, 633.4202, 670.1370,
        677.5444, 638.8639, 615.6614, 570.8058, 581.3251, 645.5262, 614.5562,
        625.8093], device='cuda:3')
sorted_norm is   tensor([503.3374, 525.2513, 529.5469, 538.0351, 542.1966, 554.7939, 557.0434,
        558.6710, 570.8058, 575.7175, 581.3251, 584.5194, 591.1386, 610.7683,
        614.5562, 615.6614, 617.8748, 624.3912, 625.8093, 626.4521, 633.4202,
        638.8639, 645.5262, 670.1370, 675.1602, 677.5444, 686.5887, 710.5195,
        720.4220, 741.9482, 747.7589, 753.2932, 756.5273, 759.2272, 775.4731,
        778.8962], device='cuda:3')
used idx is  tensor([ 9, 11,  8, 17, 19, 16, 13, 14, 31, 15, 32, 18, 12, 22, 34, 30, 24, 21,
        35, 10, 26, 29, 33, 27, 23, 28, 25,  7], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 69.13% 

Test Accuracy: 68.71% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4203720688819885
distance x is tensor(132.8559, device='cuda:3')
benign distance is  tensor(132.8559, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8566115498542786
distance x is tensor(138.5052, device='cuda:3')
benign distance is  tensor(138.5052, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14500895142555237
distance x is tensor(151.5795, device='cuda:3')
benign distance is  tensor(151.5795, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5563408732414246
distance x is tensor(126.6738, device='cuda:3')
benign distance is  tensor(126.6738, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7307420969009399
distance x is tensor(126.1366, device='cuda:3')
benign distance is  tensor(126.1366, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0786021947860718
distance x is tensor(140.0786, device='cuda:3')
benign distance is  tensor(140.0786, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26612696051597595
distance x is tensor(130.2258, device='cuda:3')
benign distance is  tensor(130.2258, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5218979120254517
distance x is tensor(129.0128, device='cuda:3')
benign distance is  tensor(129.0128, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5753549337387085
distance x is tensor(143.8767, device='cuda:3')
benign distance is  tensor(143.8767, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2765257954597473
distance x is tensor(147.4339, device='cuda:3')
benign distance is  tensor(147.4339, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.35841792821884155
distance x is tensor(144.3186, device='cuda:3')
benign distance is  tensor(144.3186, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6935492157936096
distance x is tensor(134.4055, device='cuda:3')
benign distance is  tensor(134.4055, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5530496835708618
distance x is tensor(138.5938, device='cuda:3')
benign distance is  tensor(138.5938, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1783914715051651
distance x is tensor(135.6759, device='cuda:3')
benign distance is  tensor(135.6759, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2830031216144562
distance x is tensor(145.5975, device='cuda:3')
benign distance is  tensor(145.5975, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.26227080821990967
distance x is tensor(131.2686, device='cuda:3')
benign distance is  tensor(131.2686, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.22563418745994568
distance x is tensor(154.5094, device='cuda:3')
benign distance is  tensor(154.5094, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.15901871025562286
distance x is tensor(146.4855, device='cuda:3')
benign distance is  tensor(146.4855, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.1747390478849411
distance x is tensor(149.2475, device='cuda:3')
benign distance is  tensor(149.2475, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5518134236335754
distance x is tensor(144.3395, device='cuda:3')
benign distance is  tensor(144.3395, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8527310490608215
distance x is tensor(143.7360, device='cuda:3')
benign distance is  tensor(143.7360, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5689219832420349
distance x is tensor(140.4912, device='cuda:3')
benign distance is  tensor(140.4912, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.24307648837566376
distance x is tensor(139.5395, device='cuda:3')
benign distance is  tensor(139.5395, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2424132078886032
distance x is tensor(150.6826, device='cuda:3')
benign distance is  tensor(150.6826, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  17.04703140258789
distance x is tensor(145.9259, device='cuda:3')
benign distance is  tensor(145.9259, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  17.35611343383789
distance x is tensor(151.6288, device='cuda:3')
benign distance is  tensor(151.6288, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  14.247586250305176
distance x is tensor(145.9098, device='cuda:3')
benign distance is  tensor(145.9098, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.07671070098877
distance x is tensor(149.3078, device='cuda:3')
benign distance is  tensor(149.3078, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  17.494068145751953
distance x is tensor(150.9769, device='cuda:3')
benign distance is  tensor(150.9769, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  18.806472778320312
distance x is tensor(147.4478, device='cuda:3')
benign distance is  tensor(147.4478, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.678570747375488
distance x is tensor(150.9974, device='cuda:3')
benign distance is  tensor(150.9974, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  14.467483520507812
distance x is tensor(147.8054, device='cuda:3')
benign distance is  tensor(147.8054, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.30218505859375
distance x is tensor(164.1568, device='cuda:3')
benign distance is  tensor(164.1568, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  18.448400497436523
distance x is tensor(155.9074, device='cuda:3')
benign distance is  tensor(155.9074, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.477264404296875
distance x is tensor(152.7604, device='cuda:3')
benign distance is  tensor(152.7604, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  15.891639709472656
distance x is tensor(154.4215, device='cuda:3')
benign distance is  tensor(154.4215, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([593.7897, 619.6814, 675.4363, 557.9877, 537.5015, 618.4053, 569.9409,
        570.6420, 622.5145, 637.9414, 642.2733, 632.8122, 659.1628, 638.6143,
        648.3726, 639.2548, 707.5020, 671.0660, 654.6281, 663.3947, 620.4618,
        651.2454, 572.0889, 612.6762, 625.7078, 550.5830, 658.9734, 612.7839],
       device='cuda:3')
sorted_norm is   tensor([537.5015, 550.5830, 557.9877, 569.9409, 570.6420, 572.0889, 593.7897,
        612.6762, 612.7839, 618.4053, 619.6814, 620.4618, 622.5145, 625.7078,
        632.8122, 637.9414, 638.6143, 639.2548, 642.2733, 648.3726, 651.2454,
        654.6281, 658.9734, 659.1628, 663.3947, 671.0660, 675.4363, 707.5020],
       device='cuda:3')
used idx is  tensor([ 4, 25,  3,  6,  7, 22,  0, 23, 27,  5,  1, 20,  8, 24, 11,  9, 13, 15,
        10, 14, 21, 18], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 71.93% 

Test Accuracy: 70.77% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3086388111114502
distance x is tensor(123.4948, device='cuda:3')
benign distance is  tensor(123.4948, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5526092648506165
distance x is tensor(130.4328, device='cuda:3')
benign distance is  tensor(130.4328, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.049274034798145294
distance x is tensor(137.0155, device='cuda:3')
benign distance is  tensor(137.0155, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.750937819480896
distance x is tensor(110.0555, device='cuda:3')
benign distance is  tensor(110.0555, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3995128273963928
distance x is tensor(144.3917, device='cuda:3')
benign distance is  tensor(144.3917, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8791415095329285
distance x is tensor(133.8752, device='cuda:3')
benign distance is  tensor(133.8752, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.056413255631923676
distance x is tensor(132.2282, device='cuda:3')
benign distance is  tensor(132.2282, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5278600454330444
distance x is tensor(147.2085, device='cuda:3')
benign distance is  tensor(147.2085, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4332967698574066
distance x is tensor(153.6574, device='cuda:3')
benign distance is  tensor(153.6574, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.39210882782936096
distance x is tensor(165.1543, device='cuda:3')
benign distance is  tensor(165.1543, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16622881591320038
distance x is tensor(142.7017, device='cuda:3')
benign distance is  tensor(142.7017, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.17786547541618347
distance x is tensor(148.0054, device='cuda:3')
benign distance is  tensor(148.0054, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3876045346260071
distance x is tensor(137.5473, device='cuda:3')
benign distance is  tensor(137.5473, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7818797826766968
distance x is tensor(135.2397, device='cuda:3')
benign distance is  tensor(135.2397, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.10730870068073273
distance x is tensor(153.8853, device='cuda:3')
benign distance is  tensor(153.8853, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0882625579833984
distance x is tensor(143.4025, device='cuda:3')
benign distance is  tensor(143.4025, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  16.683395385742188
distance x is tensor(143.4803, device='cuda:3')
benign distance is  tensor(143.4803, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  19.866649627685547
distance x is tensor(160.8394, device='cuda:3')
benign distance is  tensor(160.8394, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  18.7718448638916
distance x is tensor(176.0215, device='cuda:3')
benign distance is  tensor(176.0215, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.360081672668457
distance x is tensor(148.8421, device='cuda:3')
benign distance is  tensor(148.8421, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  16.261030197143555
distance x is tensor(153.8641, device='cuda:3')
benign distance is  tensor(153.8641, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  15.881692886352539
distance x is tensor(151.8473, device='cuda:3')
benign distance is  tensor(151.8473, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.09081745147705
distance x is tensor(150.5427, device='cuda:3')
benign distance is  tensor(150.5427, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.132060050964355
distance x is tensor(142.2960, device='cuda:3')
benign distance is  tensor(142.2960, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.397193908691406
distance x is tensor(165.6818, device='cuda:3')
benign distance is  tensor(165.6818, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  14.697708129882812
distance x is tensor(146.3629, device='cuda:3')
benign distance is  tensor(146.3629, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.440505981445312
distance x is tensor(154.5013, device='cuda:3')
benign distance is  tensor(154.5013, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  15.19067096710205
distance x is tensor(151.7062, device='cuda:3')
benign distance is  tensor(151.7062, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([546.7429, 585.2143, 604.3478, 483.2243, 647.0081, 597.7726, 574.2169,
        659.3450, 605.6201, 674.3676, 744.0930, 631.1545, 655.9478, 649.5590,
        653.4057, 630.9961, 702.9257, 617.6942, 645.9620, 637.0444, 653.3104,
        673.2559, 644.7563, 606.2162, 643.0079, 625.8315, 655.8563, 599.9476],
       device='cuda:3')
sorted_norm is   tensor([483.2243, 546.7429, 574.2169, 585.2143, 597.7726, 599.9476, 604.3478,
        605.6201, 606.2162, 617.6942, 625.8315, 630.9961, 631.1545, 637.0444,
        643.0079, 644.7563, 645.9620, 647.0081, 649.5590, 653.3104, 653.4057,
        655.8563, 655.9478, 659.3450, 673.2559, 674.3676, 702.9257, 744.0930],
       device='cuda:3')
used idx is  tensor([ 3,  0,  6,  1,  5, 27,  2,  8, 23, 17, 25, 15, 11, 19, 24, 22, 18,  4,
        13, 20, 14, 26], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 78.33% 

Test Accuracy: 77.64% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3645659387111664
distance x is tensor(117.0137, device='cuda:3')
benign distance is  tensor(117.0137, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5845752954483032
distance x is tensor(124.5126, device='cuda:3')
benign distance is  tensor(124.5126, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11106307804584503
distance x is tensor(133.2454, device='cuda:3')
benign distance is  tensor(133.2454, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3229994475841522
distance x is tensor(122.1661, device='cuda:3')
benign distance is  tensor(122.1661, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7144946455955505
distance x is tensor(112.3199, device='cuda:3')
benign distance is  tensor(112.3199, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6530064940452576
distance x is tensor(126.2322, device='cuda:3')
benign distance is  tensor(126.2322, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5018460154533386
distance x is tensor(129.9385, device='cuda:3')
benign distance is  tensor(129.9385, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43997400999069214
distance x is tensor(119.9593, device='cuda:3')
benign distance is  tensor(119.9593, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6238317489624023
distance x is tensor(145.2556, device='cuda:3')
benign distance is  tensor(145.2556, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.863322913646698
distance x is tensor(143.1889, device='cuda:3')
benign distance is  tensor(143.1889, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.683944821357727
distance x is tensor(144.0406, device='cuda:3')
benign distance is  tensor(144.0406, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.686018705368042
distance x is tensor(140.0218, device='cuda:3')
benign distance is  tensor(140.0218, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6150588989257812
distance x is tensor(137.9527, device='cuda:3')
benign distance is  tensor(137.9527, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2579672932624817
distance x is tensor(137.9237, device='cuda:3')
benign distance is  tensor(137.9237, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2847924530506134
distance x is tensor(136.7978, device='cuda:3')
benign distance is  tensor(136.7978, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5123688578605652
distance x is tensor(141.1266, device='cuda:3')
benign distance is  tensor(141.1266, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.670120239257812
distance x is tensor(154.2552, device='cuda:3')
benign distance is  tensor(154.2552, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  19.224849700927734
distance x is tensor(154.4989, device='cuda:3')
benign distance is  tensor(154.4989, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  17.120689392089844
distance x is tensor(166.1849, device='cuda:3')
benign distance is  tensor(166.1849, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  16.01919937133789
distance x is tensor(157.0551, device='cuda:3')
benign distance is  tensor(157.0551, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  16.178735733032227
distance x is tensor(161.5473, device='cuda:3')
benign distance is  tensor(161.5473, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.131269454956055
distance x is tensor(156.7637, device='cuda:3')
benign distance is  tensor(156.7637, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  13.85009765625
distance x is tensor(167.8201, device='cuda:3')
benign distance is  tensor(167.8201, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.710311889648438
distance x is tensor(159.9915, device='cuda:3')
benign distance is  tensor(159.9915, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  15.898094177246094
distance x is tensor(164.7317, device='cuda:3')
benign distance is  tensor(164.7317, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  19.673545837402344
distance x is tensor(158.0799, device='cuda:3')
benign distance is  tensor(158.0799, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  19.438175201416016
distance x is tensor(159.3807, device='cuda:3')
benign distance is  tensor(159.3807, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  18.376087188720703
distance x is tensor(158.4183, device='cuda:3')
benign distance is  tensor(158.4183, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([533.0918, 564.6833, 592.0366, 545.2527, 489.8669, 545.0491, 555.1458,
        535.3098, 634.6796, 641.6249, 729.2989, 652.1337, 688.7013, 665.0064,
        709.3433, 680.6479, 694.0469, 654.8669, 673.2499, 662.0602, 650.7472,
        620.1090, 693.1303, 591.0511, 632.5267, 617.9543, 604.5441, 583.9061],
       device='cuda:3')
sorted_norm is   tensor([489.8669, 533.0918, 535.3098, 545.0491, 545.2527, 555.1458, 564.6833,
        583.9061, 591.0511, 592.0366, 604.5441, 617.9543, 620.1090, 632.5267,
        634.6796, 641.6249, 650.7472, 652.1337, 654.8669, 662.0602, 665.0064,
        673.2499, 680.6479, 688.7013, 693.1303, 694.0469, 709.3433, 729.2989],
       device='cuda:3')
used idx is  tensor([ 4,  0,  7,  5,  3,  6,  1, 27, 23,  2, 26, 25, 21, 24,  8,  9, 20, 11,
        17, 19, 13, 18], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 67.49% 

Test Accuracy: 66.28% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24743559956550598
distance x is tensor(119.9495, device='cuda:3')
benign distance is  tensor(119.9495, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9877196550369263
distance x is tensor(131.8037, device='cuda:3')
benign distance is  tensor(131.8037, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11129973083734512
distance x is tensor(138.4193, device='cuda:3')
benign distance is  tensor(138.4193, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5590153336524963
distance x is tensor(137.6204, device='cuda:3')
benign distance is  tensor(137.6204, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9237653613090515
distance x is tensor(120.4646, device='cuda:3')
benign distance is  tensor(120.4646, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2131891250610352
distance x is tensor(138.3835, device='cuda:3')
benign distance is  tensor(138.3835, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16447661817073822
distance x is tensor(119.5030, device='cuda:3')
benign distance is  tensor(119.5030, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6312143206596375
distance x is tensor(122.1995, device='cuda:3')
benign distance is  tensor(122.1995, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3220618963241577
distance x is tensor(149.4003, device='cuda:3')
benign distance is  tensor(149.4003, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.18997690081596375
distance x is tensor(150.5654, device='cuda:3')
benign distance is  tensor(150.5654, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.16956497728824615
distance x is tensor(151.8534, device='cuda:3')
benign distance is  tensor(151.8534, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.5580052733421326
distance x is tensor(139.2504, device='cuda:3')
benign distance is  tensor(139.2504, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5151945948600769
distance x is tensor(152.3423, device='cuda:3')
benign distance is  tensor(152.3423, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.32113519310951233
distance x is tensor(135.8381, device='cuda:3')
benign distance is  tensor(135.8381, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.438753604888916
distance x is tensor(154.8992, device='cuda:3')
benign distance is  tensor(154.8992, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.120766282081604
distance x is tensor(138.5158, device='cuda:3')
benign distance is  tensor(138.5158, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.613202095031738
distance x is tensor(144.6353, device='cuda:3')
benign distance is  tensor(144.6353, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  15.362762451171875
distance x is tensor(134.5831, device='cuda:3')
benign distance is  tensor(134.5831, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.24858283996582
distance x is tensor(169.4654, device='cuda:3')
benign distance is  tensor(169.4654, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  13.812902450561523
distance x is tensor(152.1499, device='cuda:3')
benign distance is  tensor(152.1499, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  20.463512420654297
distance x is tensor(153.1399, device='cuda:3')
benign distance is  tensor(153.1399, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.991275787353516
distance x is tensor(150.3440, device='cuda:3')
benign distance is  tensor(150.3440, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  18.342973709106445
distance x is tensor(150.6210, device='cuda:3')
benign distance is  tensor(150.6210, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.448201179504395
distance x is tensor(153.3895, device='cuda:3')
benign distance is  tensor(153.3895, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  17.01903533935547
distance x is tensor(158.1383, device='cuda:3')
benign distance is  tensor(158.1383, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  15.61829948425293
distance x is tensor(143.0970, device='cuda:3')
benign distance is  tensor(143.0970, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  19.158893585205078
distance x is tensor(151.8474, device='cuda:3')
benign distance is  tensor(151.8474, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  17.94352912902832
distance x is tensor(146.7677, device='cuda:3')
benign distance is  tensor(146.7677, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([535.3892, 593.8989, 615.7331, 594.2213, 516.4721, 615.1931, 529.1476,
        538.1132, 599.3587, 557.9871, 723.0875, 638.5430, 645.5133, 633.4922,
        652.0386, 648.5655, 660.8708, 605.8071, 645.9502, 614.6550, 617.8787,
        592.5219, 610.7701, 665.3835, 606.1279, 631.3246, 646.4764, 630.8508,
        714.9827, 672.6725, 676.3751, 660.8702, 665.5825, 649.9064, 645.0173,
        704.9914, 711.8146, 761.8121, 651.9865, 678.7326, 623.4019, 626.4747,
        698.0844, 654.8763, 670.9225, 647.9542, 654.8345, 643.4836, 649.0709,
        640.9088, 640.3176, 646.3525], device='cuda:3')
sorted_norm is   tensor([516.4721, 529.1476, 535.3892, 538.1132, 557.9871, 592.5219, 593.8989,
        594.2213, 599.3587, 605.8071, 606.1279, 610.7701, 614.6550, 615.1931,
        615.7331, 617.8787, 623.4019, 626.4747, 630.8508, 631.3246, 633.4922,
        638.5430, 640.3176, 640.9088, 643.4836, 645.0173, 645.5133, 645.9502,
        646.3525, 646.4764, 647.9542, 648.5655, 649.0709, 649.9064, 651.9865,
        652.0386, 654.8345, 654.8763, 660.8702, 660.8708, 665.3835, 665.5825,
        670.9225, 672.6725, 676.3751, 678.7326, 698.0844, 704.9914, 711.8146,
        714.9827, 723.0875, 761.8121], device='cuda:3')
used idx is  tensor([ 4,  6,  0,  7,  9, 21,  1,  3,  8, 17, 24, 22, 19,  5,  2, 20, 40, 41,
        27, 25, 13, 11, 50, 49, 47, 34, 12, 18, 51, 26, 45, 15, 48, 33, 38, 14,
        46, 43, 31, 16, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.15% 

Test Accuracy: 88.52% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.12382018566131592
distance x is tensor(92.5670, device='cuda:3')
benign distance is  tensor(92.5670, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0649240016937256
distance x is tensor(122.7073, device='cuda:3')
benign distance is  tensor(122.7073, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06314070522785187
distance x is tensor(137.3501, device='cuda:3')
benign distance is  tensor(137.3501, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5060983300209045
distance x is tensor(110.2936, device='cuda:3')
benign distance is  tensor(110.2936, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1230672150850296
distance x is tensor(107.9531, device='cuda:3')
benign distance is  tensor(107.9531, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3136361241340637
distance x is tensor(121.2780, device='cuda:3')
benign distance is  tensor(121.2780, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6234779953956604
distance x is tensor(109.4493, device='cuda:3')
benign distance is  tensor(109.4493, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3245989680290222
distance x is tensor(113.4851, device='cuda:3')
benign distance is  tensor(113.4851, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.17335717380046844
distance x is tensor(146.9687, device='cuda:3')
benign distance is  tensor(146.9687, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4394112229347229
distance x is tensor(137.6126, device='cuda:3')
benign distance is  tensor(137.6126, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.15880419313907623
distance x is tensor(123.5296, device='cuda:3')
benign distance is  tensor(123.5296, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6542356610298157
distance x is tensor(141.5752, device='cuda:3')
benign distance is  tensor(141.5752, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3283379375934601
distance x is tensor(128.5686, device='cuda:3')
benign distance is  tensor(128.5686, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35993334650993347
distance x is tensor(123.0271, device='cuda:3')
benign distance is  tensor(123.0271, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4576801657676697
distance x is tensor(121.9334, device='cuda:3')
benign distance is  tensor(121.9334, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3272897005081177
distance x is tensor(124.0449, device='cuda:3')
benign distance is  tensor(124.0449, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5654159784317017
distance x is tensor(128.7320, device='cuda:3')
benign distance is  tensor(128.7320, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6195385456085205
distance x is tensor(149.3000, device='cuda:3')
benign distance is  tensor(149.3000, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3399272561073303
distance x is tensor(122.8148, device='cuda:3')
benign distance is  tensor(122.8148, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.24912111461162567
distance x is tensor(146.2868, device='cuda:3')
benign distance is  tensor(146.2868, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5284245610237122
distance x is tensor(132.9270, device='cuda:3')
benign distance is  tensor(132.9270, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3507331311702728
distance x is tensor(129.2510, device='cuda:3')
benign distance is  tensor(129.2510, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3356403410434723
distance x is tensor(153.5916, device='cuda:3')
benign distance is  tensor(153.5916, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3026016354560852
distance x is tensor(126.5564, device='cuda:3')
benign distance is  tensor(126.5564, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3601143956184387
distance x is tensor(149.1349, device='cuda:3')
benign distance is  tensor(149.1349, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5275777578353882
distance x is tensor(130.8520, device='cuda:3')
benign distance is  tensor(130.8520, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.47336435317993164
distance x is tensor(131.7776, device='cuda:3')
benign distance is  tensor(131.7776, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4068218767642975
distance x is tensor(146.1238, device='cuda:3')
benign distance is  tensor(146.1238, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5151556730270386
distance x is tensor(129.0321, device='cuda:3')
benign distance is  tensor(129.0321, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5095030069351196
distance x is tensor(130.0141, device='cuda:3')
benign distance is  tensor(130.0141, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.48438891768455505
distance x is tensor(139.0566, device='cuda:3')
benign distance is  tensor(139.0566, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3554585874080658
distance x is tensor(130.1276, device='cuda:3')
benign distance is  tensor(130.1276, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.5369113087654114
distance x is tensor(129.3769, device='cuda:3')
benign distance is  tensor(129.3769, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2516433894634247
distance x is tensor(131.6823, device='cuda:3')
benign distance is  tensor(131.6823, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.23447544872760773
distance x is tensor(128.6027, device='cuda:3')
benign distance is  tensor(128.6027, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.32966703176498413
distance x is tensor(128.0016, device='cuda:3')
benign distance is  tensor(128.0016, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2633039057254791
distance x is tensor(141.5051, device='cuda:3')
benign distance is  tensor(141.5051, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.2888609766960144
distance x is tensor(135.2209, device='cuda:3')
benign distance is  tensor(135.2209, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.44507843255996704
distance x is tensor(136.8275, device='cuda:3')
benign distance is  tensor(136.8275, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5272655487060547
distance x is tensor(134.5212, device='cuda:3')
benign distance is  tensor(134.5212, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  19.678722381591797
distance x is tensor(175.8695, device='cuda:3')
benign distance is  tensor(175.8695, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  17.879844665527344
distance x is tensor(169.5802, device='cuda:3')
benign distance is  tensor(169.5802, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  17.712825775146484
distance x is tensor(184.6451, device='cuda:3')
benign distance is  tensor(184.6451, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  17.857515335083008
distance x is tensor(174.9501, device='cuda:3')
benign distance is  tensor(174.9501, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.829254150390625
distance x is tensor(180.0895, device='cuda:3')
benign distance is  tensor(180.0895, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  20.121288299560547
distance x is tensor(178.8938, device='cuda:3')
benign distance is  tensor(178.8938, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  15.110957145690918
distance x is tensor(178.9502, device='cuda:3')
benign distance is  tensor(178.9502, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  16.345355987548828
distance x is tensor(175.6684, device='cuda:3')
benign distance is  tensor(175.6684, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.55316925048828
distance x is tensor(182.5194, device='cuda:3')
benign distance is  tensor(182.5194, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  15.14628791809082
distance x is tensor(162.9174, device='cuda:3')
benign distance is  tensor(162.9174, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  20.090742111206055
distance x is tensor(187.8096, device='cuda:3')
benign distance is  tensor(187.8096, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  16.779266357421875
distance x is tensor(187.4802, device='cuda:3')
benign distance is  tensor(187.4802, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([404.1464, 531.8931, 598.5714, 480.4928, 466.5487, 539.1484, 480.9483,
        510.6552, 722.3242, 677.3511, 761.9313, 705.9750, 733.0875, 718.7720,
        740.4883, 711.7672, 750.3508, 665.9969, 769.5717, 760.1891],
       device='cuda:3')
sorted_norm is   tensor([404.1464, 466.5487, 480.4928, 480.9483, 510.6552, 531.8931, 539.1484,
        598.5714, 665.9969, 677.3511, 705.9750, 711.7672, 718.7720, 722.3242,
        733.0875, 740.4883, 750.3508, 760.1891, 761.9313, 769.5717],
       device='cuda:3')
used idx is  tensor([ 0,  4,  3,  6,  7,  1,  5,  2, 17,  9, 11, 15, 13,  8, 12, 14],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 2.53% 

Test Accuracy: 2.19% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6444584131240845
distance x is tensor(181.6634, device='cuda:3')
benign distance is  tensor(181.6634, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.39958906173706055
distance x is tensor(180.0863, device='cuda:3')
benign distance is  tensor(180.0863, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04633750766515732
distance x is tensor(196.7123, device='cuda:3')
benign distance is  tensor(196.7123, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.296742707490921
distance x is tensor(169.3394, device='cuda:3')
benign distance is  tensor(169.3394, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6030513048171997
distance x is tensor(179.7680, device='cuda:3')
benign distance is  tensor(179.7680, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5176344513893127
distance x is tensor(172.5337, device='cuda:3')
benign distance is  tensor(172.5337, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5762562155723572
distance x is tensor(171.6054, device='cuda:3')
benign distance is  tensor(171.6054, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3427956998348236
distance x is tensor(173.2364, device='cuda:3')
benign distance is  tensor(173.2364, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.522074699401855
distance x is tensor(123.5720, device='cuda:3')
benign distance is  tensor(123.5720, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  17.814884185791016
distance x is tensor(118.8695, device='cuda:3')
benign distance is  tensor(118.8695, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.818339347839355
distance x is tensor(124.4798, device='cuda:3')
benign distance is  tensor(124.4798, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  16.253658294677734
distance x is tensor(120.5439, device='cuda:3')
benign distance is  tensor(120.5439, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  11.89606761932373
distance x is tensor(135.6224, device='cuda:3')
benign distance is  tensor(135.6224, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  13.915057182312012
distance x is tensor(125.6996, device='cuda:3')
benign distance is  tensor(125.6996, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  17.398605346679688
distance x is tensor(124.5051, device='cuda:3')
benign distance is  tensor(124.5051, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  14.5033597946167
distance x is tensor(124.5083, device='cuda:3')
benign distance is  tensor(124.5083, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  18.089567184448242
distance x is tensor(123.9746, device='cuda:3')
benign distance is  tensor(123.9746, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.544818878173828
distance x is tensor(124.0887, device='cuda:3')
benign distance is  tensor(124.0887, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  15.857698440551758
distance x is tensor(134.7139, device='cuda:3')
benign distance is  tensor(134.7139, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  14.359814643859863
distance x is tensor(123.5468, device='cuda:3')
benign distance is  tensor(123.5468, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([756.4045, 761.6832, 827.7606, 689.6409, 744.8263, 718.7448, 730.6249,
        732.2818, 545.2809, 545.0422, 569.9617, 544.1907, 602.9300, 562.3590,
        569.6075, 564.8364, 566.8293, 537.7474, 589.6785, 548.0772, 689.5695,
        654.0226, 592.6212, 668.0864, 620.4017, 598.5293, 584.0562, 607.6367],
       device='cuda:3')
sorted_norm is   tensor([537.7474, 544.1907, 545.0422, 545.2809, 548.0772, 562.3590, 564.8364,
        566.8293, 569.6075, 569.9617, 584.0562, 589.6785, 592.6212, 598.5293,
        602.9300, 607.6367, 620.4017, 654.0226, 668.0864, 689.5695, 689.6409,
        718.7448, 730.6249, 732.2818, 744.8263, 756.4045, 761.6832, 827.7606],
       device='cuda:3')
used idx is  tensor([17, 11,  9,  8, 19, 13, 15, 16, 14, 10, 26, 18, 22, 25, 12, 27, 24, 21,
        23, 20,  3,  5], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 35.43% 

Test Accuracy: 35.33% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.22728005051612854
distance x is tensor(133.6909, device='cuda:3')
benign distance is  tensor(133.6909, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6356889009475708
distance x is tensor(142.2841, device='cuda:3')
benign distance is  tensor(142.2841, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04581468924880028
distance x is tensor(159.2509, device='cuda:3')
benign distance is  tensor(159.2509, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7765278816223145
distance x is tensor(142.6755, device='cuda:3')
benign distance is  tensor(142.6755, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6170539259910583
distance x is tensor(136.2148, device='cuda:3')
benign distance is  tensor(136.2148, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.59144526720047
distance x is tensor(146.9776, device='cuda:3')
benign distance is  tensor(146.9776, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.06324232369661331
distance x is tensor(146.1695, device='cuda:3')
benign distance is  tensor(146.1695, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2916482985019684
distance x is tensor(134.5443, device='cuda:3')
benign distance is  tensor(134.5443, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.41632285714149475
distance x is tensor(159.8861, device='cuda:3')
benign distance is  tensor(159.8861, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2937176525592804
distance x is tensor(168.7142, device='cuda:3')
benign distance is  tensor(168.7142, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.184162974357605
distance x is tensor(141.4056, device='cuda:3')
benign distance is  tensor(141.4056, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3256591260433197
distance x is tensor(151.3337, device='cuda:3')
benign distance is  tensor(151.3337, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2523254454135895
distance x is tensor(142.7014, device='cuda:3')
benign distance is  tensor(142.7014, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2638740539550781
distance x is tensor(162.6093, device='cuda:3')
benign distance is  tensor(162.6093, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31469839811325073
distance x is tensor(155.8074, device='cuda:3')
benign distance is  tensor(155.8074, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3506893515586853
distance x is tensor(157.8831, device='cuda:3')
benign distance is  tensor(157.8831, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  13.968225479125977
distance x is tensor(127.6475, device='cuda:3')
benign distance is  tensor(127.6475, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.41415023803711
distance x is tensor(133.3496, device='cuda:3')
benign distance is  tensor(133.3496, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  18.371328353881836
distance x is tensor(152.8236, device='cuda:3')
benign distance is  tensor(152.8236, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.016420364379883
distance x is tensor(138.9818, device='cuda:3')
benign distance is  tensor(138.9818, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  18.90183448791504
distance x is tensor(138.9098, device='cuda:3')
benign distance is  tensor(138.9098, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  17.79441261291504
distance x is tensor(139.9234, device='cuda:3')
benign distance is  tensor(139.9234, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.348024368286133
distance x is tensor(136.0750, device='cuda:3')
benign distance is  tensor(136.0750, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  18.00449562072754
distance x is tensor(146.0895, device='cuda:3')
benign distance is  tensor(146.0895, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  18.529184341430664
distance x is tensor(141.4843, device='cuda:3')
benign distance is  tensor(141.4843, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  13.349023818969727
distance x is tensor(140.5649, device='cuda:3')
benign distance is  tensor(140.5649, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  15.026712417602539
distance x is tensor(152.6831, device='cuda:3')
benign distance is  tensor(152.6831, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  11.18976879119873
distance x is tensor(133.2699, device='cuda:3')
benign distance is  tensor(133.2699, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([580.6773, 630.0060, 701.4417, 632.9518, 587.3664, 643.5532, 631.4604,
        604.6205, 541.6118, 589.2078, 668.7598, 591.2924, 604.4401, 598.9644,
        607.8855, 646.8726, 629.7582, 604.7197, 674.4053, 574.2774, 605.2624,
        693.5642, 590.3061, 682.9930, 625.0259, 603.7806, 707.4442, 590.4022],
       device='cuda:3')
sorted_norm is   tensor([541.6118, 574.2774, 580.6773, 587.3664, 589.2078, 590.3061, 590.4022,
        591.2924, 598.9644, 603.7806, 604.4401, 604.6205, 604.7197, 605.2624,
        607.8855, 625.0259, 629.7582, 630.0060, 631.4604, 632.9518, 643.5532,
        646.8726, 668.7598, 674.4053, 682.9930, 693.5642, 701.4417, 707.4442],
       device='cuda:3')
used idx is  tensor([ 8, 19,  0,  4,  9, 22, 27, 11, 13, 25, 12,  7, 17, 20, 14, 24, 16,  1,
         6,  3,  5, 15], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 66.30% 

Test Accuracy: 66.30% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.21987664699554443
distance x is tensor(117.6046, device='cuda:3')
benign distance is  tensor(117.6046, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0087758302688599
distance x is tensor(122.2193, device='cuda:3')
benign distance is  tensor(122.2193, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.01432876754552126
distance x is tensor(133.0171, device='cuda:3')
benign distance is  tensor(133.0171, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5945178270339966
distance x is tensor(127.0327, device='cuda:3')
benign distance is  tensor(127.0327, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7804000377655029
distance x is tensor(128.0970, device='cuda:3')
benign distance is  tensor(128.0970, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.37680020928382874
distance x is tensor(149.5571, device='cuda:3')
benign distance is  tensor(149.5571, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.46784815192222595
distance x is tensor(125.7848, device='cuda:3')
benign distance is  tensor(125.7848, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2413279116153717
distance x is tensor(121.5170, device='cuda:3')
benign distance is  tensor(121.5170, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2243947684764862
distance x is tensor(165.2943, device='cuda:3')
benign distance is  tensor(165.2943, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.16268005967140198
distance x is tensor(164.5746, device='cuda:3')
benign distance is  tensor(164.5746, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.17202205955982208
distance x is tensor(140.6980, device='cuda:3')
benign distance is  tensor(140.6980, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.31753775477409363
distance x is tensor(154.8895, device='cuda:3')
benign distance is  tensor(154.8895, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.7529921531677246
distance x is tensor(136.0589, device='cuda:3')
benign distance is  tensor(136.0589, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5035476684570312
distance x is tensor(148.1500, device='cuda:3')
benign distance is  tensor(148.1500, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.487556129693985
distance x is tensor(148.8467, device='cuda:3')
benign distance is  tensor(148.8467, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7716593742370605
distance x is tensor(147.6553, device='cuda:3')
benign distance is  tensor(147.6553, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  16.101560592651367
distance x is tensor(146.0164, device='cuda:3')
benign distance is  tensor(146.0164, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.648008346557617
distance x is tensor(148.2545, device='cuda:3')
benign distance is  tensor(148.2545, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.188409805297852
distance x is tensor(152.7550, device='cuda:3')
benign distance is  tensor(152.7550, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.100095748901367
distance x is tensor(141.3354, device='cuda:3')
benign distance is  tensor(141.3354, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  20.090091705322266
distance x is tensor(155.0237, device='cuda:3')
benign distance is  tensor(155.0237, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.43161964416504
distance x is tensor(149.3741, device='cuda:3')
benign distance is  tensor(149.3741, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  15.794896125793457
distance x is tensor(152.1265, device='cuda:3')
benign distance is  tensor(152.1265, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.178326606750488
distance x is tensor(148.7542, device='cuda:3')
benign distance is  tensor(148.7542, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  19.383216857910156
distance x is tensor(159.4536, device='cuda:3')
benign distance is  tensor(159.4536, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  19.55333709716797
distance x is tensor(145.4641, device='cuda:3')
benign distance is  tensor(145.4641, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.35293197631836
distance x is tensor(155.5795, device='cuda:3')
benign distance is  tensor(155.5795, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  18.222455978393555
distance x is tensor(148.2951, device='cuda:3')
benign distance is  tensor(148.2951, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([521.0892, 547.4550, 585.2686, 556.8649, 550.3276, 658.6525, 542.3205,
        543.9374, 601.9233, 620.5677, 662.5615, 592.4465, 660.4211, 643.4351,
        658.5828, 647.1717, 683.1998, 609.8682, 673.5052, 619.1588, 706.0397,
        706.4161, 696.0310, 657.5732, 711.6032, 638.2006, 713.9208, 653.5815,
        679.5742, 604.2533, 616.6073, 668.5345, 608.7134, 609.0519, 658.1219,
        613.2966, 709.6061, 746.2764, 626.7832, 680.1487, 647.8744, 728.4877,
        694.6422, 707.4772], device='cuda:3')
sorted_norm is   tensor([521.0892, 542.3205, 543.9374, 547.4550, 550.3276, 556.8649, 585.2686,
        592.4465, 601.9233, 604.2533, 608.7134, 609.0519, 609.8682, 613.2966,
        616.6073, 619.1588, 620.5677, 626.7832, 638.2006, 643.4351, 647.1717,
        647.8744, 653.5815, 657.5732, 658.1219, 658.5828, 658.6525, 660.4211,
        662.5615, 668.5345, 673.5052, 679.5742, 680.1487, 683.1998, 694.6422,
        696.0310, 706.0397, 706.4161, 707.4772, 709.6061, 711.6032, 713.9208,
        728.4877, 746.2764], device='cuda:3')
used idx is  tensor([ 0,  6,  7,  1,  4,  3,  2, 11,  8, 29, 32, 33, 17, 35, 30, 19,  9, 38,
        25, 13, 15, 40, 27, 23, 34, 14,  5, 12, 10, 31, 18, 28, 39, 16, 42],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 86.05% 

Test Accuracy: 85.23% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.23293766379356384
distance x is tensor(126.2728, device='cuda:3')
benign distance is  tensor(126.2728, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.47080308198928833
distance x is tensor(117.2235, device='cuda:3')
benign distance is  tensor(117.2235, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06687898188829422
distance x is tensor(142.0709, device='cuda:3')
benign distance is  tensor(142.0709, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5381725430488586
distance x is tensor(113.3804, device='cuda:3')
benign distance is  tensor(113.3804, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6917269825935364
distance x is tensor(93.7837, device='cuda:3')
benign distance is  tensor(93.7837, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4808182120323181
distance x is tensor(131.1895, device='cuda:3')
benign distance is  tensor(131.1895, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6259987354278564
distance x is tensor(111.7428, device='cuda:3')
benign distance is  tensor(111.7428, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38542383909225464
distance x is tensor(118.1797, device='cuda:3')
benign distance is  tensor(118.1797, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.12029452621936798
distance x is tensor(146.1155, device='cuda:3')
benign distance is  tensor(146.1155, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6985293626785278
distance x is tensor(133.5255, device='cuda:3')
benign distance is  tensor(133.5255, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3406093716621399
distance x is tensor(130.2443, device='cuda:3')
benign distance is  tensor(130.2443, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.48179489374160767
distance x is tensor(141.8689, device='cuda:3')
benign distance is  tensor(141.8689, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.116332769393921
distance x is tensor(125.9391, device='cuda:3')
benign distance is  tensor(125.9391, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3255545198917389
distance x is tensor(137.8280, device='cuda:3')
benign distance is  tensor(137.8280, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.35256338119506836
distance x is tensor(134.1737, device='cuda:3')
benign distance is  tensor(134.1737, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5294204354286194
distance x is tensor(133.6065, device='cuda:3')
benign distance is  tensor(133.6065, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.42752283811569214
distance x is tensor(158.8199, device='cuda:3')
benign distance is  tensor(158.8199, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8157796859741211
distance x is tensor(138.0638, device='cuda:3')
benign distance is  tensor(138.0638, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5122522115707397
distance x is tensor(137.3839, device='cuda:3')
benign distance is  tensor(137.3839, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3275366425514221
distance x is tensor(141.5368, device='cuda:3')
benign distance is  tensor(141.5368, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5902116298675537
distance x is tensor(140.9437, device='cuda:3')
benign distance is  tensor(140.9437, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.29477810859680176
distance x is tensor(137.2418, device='cuda:3')
benign distance is  tensor(137.2418, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.10755614191293716
distance x is tensor(135.0561, device='cuda:3')
benign distance is  tensor(135.0561, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.07810753583908081
distance x is tensor(141.3329, device='cuda:3')
benign distance is  tensor(141.3329, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3410627543926239
distance x is tensor(146.6196, device='cuda:3')
benign distance is  tensor(146.6196, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.12904182076454163
distance x is tensor(136.2839, device='cuda:3')
benign distance is  tensor(136.2839, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.1632061004638672
distance x is tensor(146.6596, device='cuda:3')
benign distance is  tensor(146.6596, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2582516074180603
distance x is tensor(140.0512, device='cuda:3')
benign distance is  tensor(140.0512, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4197990894317627
distance x is tensor(141.9990, device='cuda:3')
benign distance is  tensor(141.9990, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5684564709663391
distance x is tensor(140.4979, device='cuda:3')
benign distance is  tensor(140.4979, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5160890221595764
distance x is tensor(128.1725, device='cuda:3')
benign distance is  tensor(128.1725, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3453478217124939
distance x is tensor(135.6037, device='cuda:3')
benign distance is  tensor(135.6037, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  18.294795989990234
distance x is tensor(157.4205, device='cuda:3')
benign distance is  tensor(157.4205, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.172752380371094
distance x is tensor(156.5427, device='cuda:3')
benign distance is  tensor(156.5427, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  16.48216438293457
distance x is tensor(169.4223, device='cuda:3')
benign distance is  tensor(169.4223, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.460897445678711
distance x is tensor(165.6383, device='cuda:3')
benign distance is  tensor(165.6383, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  16.050386428833008
distance x is tensor(165.9978, device='cuda:3')
benign distance is  tensor(165.9978, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  19.522449493408203
distance x is tensor(166.9868, device='cuda:3')
benign distance is  tensor(166.9868, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  15.960986137390137
distance x is tensor(174.9763, device='cuda:3')
benign distance is  tensor(174.9763, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.02589988708496
distance x is tensor(157.3689, device='cuda:3')
benign distance is  tensor(157.3689, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  17.624332427978516
distance x is tensor(158.2612, device='cuda:3')
benign distance is  tensor(158.2612, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.07158660888672
distance x is tensor(158.3676, device='cuda:3')
benign distance is  tensor(158.3676, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  20.181324005126953
distance x is tensor(165.5888, device='cuda:3')
benign distance is  tensor(165.5888, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  13.914868354797363
distance x is tensor(166.9053, device='cuda:3')
benign distance is  tensor(166.9053, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([556.7617, 519.8780, 633.2979, 500.9484, 403.5906, 575.2444, 470.9523,
        526.3184, 646.8121, 634.6780, 691.2938, 690.9872, 682.1729, 683.1747,
        703.3181, 659.4308, 666.5017, 647.1561, 691.0098, 687.8165],
       device='cuda:3')
sorted_norm is   tensor([403.5906, 470.9523, 500.9484, 519.8780, 526.3184, 556.7617, 575.2444,
        633.2979, 634.6780, 646.8121, 647.1561, 659.4308, 666.5017, 682.1729,
        683.1747, 687.8165, 690.9872, 691.0098, 691.2938, 703.3181],
       device='cuda:3')
used idx is  tensor([ 4,  6,  3,  1,  7,  0,  5,  2,  9,  8, 17, 15, 16, 12, 13, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 3.73% 

Test Accuracy: 3.50% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6984346508979797
distance x is tensor(152.6041, device='cuda:3')
benign distance is  tensor(152.6041, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0105276107788086
distance x is tensor(175.3847, device='cuda:3')
benign distance is  tensor(175.3847, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25884491205215454
distance x is tensor(169.2744, device='cuda:3')
benign distance is  tensor(169.2744, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6054876446723938
distance x is tensor(161.6754, device='cuda:3')
benign distance is  tensor(161.6754, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9543927311897278
distance x is tensor(165.9527, device='cuda:3')
benign distance is  tensor(165.9527, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.35513776540756226
distance x is tensor(194.2917, device='cuda:3')
benign distance is  tensor(194.2917, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.48871660232543945
distance x is tensor(180.2079, device='cuda:3')
benign distance is  tensor(180.2079, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2950112521648407
distance x is tensor(161.2500, device='cuda:3')
benign distance is  tensor(161.2500, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.115213394165039
distance x is tensor(118.1125, device='cuda:3')
benign distance is  tensor(118.1125, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  19.5361270904541
distance x is tensor(121.5854, device='cuda:3')
benign distance is  tensor(121.5854, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.55073070526123
distance x is tensor(143.5421, device='cuda:3')
benign distance is  tensor(143.5421, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  17.962671279907227
distance x is tensor(139.1952, device='cuda:3')
benign distance is  tensor(139.1952, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  15.980613708496094
distance x is tensor(129.7756, device='cuda:3')
benign distance is  tensor(129.7756, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.8250789642334
distance x is tensor(119.9813, device='cuda:3')
benign distance is  tensor(119.9813, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  15.305704116821289
distance x is tensor(141.7629, device='cuda:3')
benign distance is  tensor(141.7629, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  11.85669994354248
distance x is tensor(133.6058, device='cuda:3')
benign distance is  tensor(133.6058, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  20.884021759033203
distance x is tensor(123.2941, device='cuda:3')
benign distance is  tensor(123.2941, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  16.097578048706055
distance x is tensor(115.7857, device='cuda:3')
benign distance is  tensor(115.7857, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  17.94251823425293
distance x is tensor(140.2224, device='cuda:3')
benign distance is  tensor(140.2224, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  13.831735610961914
distance x is tensor(122.0147, device='cuda:3')
benign distance is  tensor(122.0147, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([644.2003, 746.0757, 715.1932, 675.6917, 695.8457, 840.5027, 758.7563,
        694.9476, 515.9959, 530.6443, 636.3588, 610.5273, 579.8278, 533.4545,
        638.4092, 591.3796, 555.1813, 509.9075, 630.7008, 526.9551, 634.3192,
        639.1290, 638.6281, 637.7185, 695.3569, 652.8787, 661.5007, 676.2629,
        776.2532, 779.9326, 672.9781, 731.1246, 642.5179, 700.6904, 700.7385,
        697.0225, 687.4990, 629.7289, 615.9800, 671.4532, 600.6159, 652.2394,
        631.5736, 627.5694], device='cuda:3')
sorted_norm is   tensor([509.9075, 515.9959, 526.9551, 530.6443, 533.4545, 555.1813, 579.8278,
        591.3796, 600.6159, 610.5273, 615.9800, 627.5694, 629.7289, 630.7008,
        631.5736, 634.3192, 636.3588, 637.7185, 638.4092, 638.6281, 639.1290,
        642.5179, 644.2003, 652.2394, 652.8787, 661.5007, 671.4532, 672.9781,
        675.6917, 676.2629, 687.4990, 694.9476, 695.3569, 695.8457, 697.0225,
        700.6904, 700.7385, 715.1932, 731.1246, 746.0757, 758.7563, 776.2532,
        779.9326, 840.5027], device='cuda:3')
used idx is  tensor([17,  8, 19,  9, 13, 16, 12, 15, 40, 11, 38, 43, 37, 18, 42, 20, 10, 23,
        14, 22, 21, 32,  0, 41, 25, 26, 39, 30,  3, 27, 36,  7, 24,  4, 35],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.39% 

Test Accuracy: 88.72% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7768744230270386
distance x is tensor(115.2142, device='cuda:3')
benign distance is  tensor(115.2142, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3413998484611511
distance x is tensor(114.9935, device='cuda:3')
benign distance is  tensor(114.9935, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08003615587949753
distance x is tensor(116.5410, device='cuda:3')
benign distance is  tensor(116.5410, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2209397852420807
distance x is tensor(118.6384, device='cuda:3')
benign distance is  tensor(118.6384, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5262425541877747
distance x is tensor(109.1434, device='cuda:3')
benign distance is  tensor(109.1434, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.517003059387207
distance x is tensor(117.8886, device='cuda:3')
benign distance is  tensor(117.8886, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12353868782520294
distance x is tensor(112.8783, device='cuda:3')
benign distance is  tensor(112.8783, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3122895658016205
distance x is tensor(106.0163, device='cuda:3')
benign distance is  tensor(106.0163, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16425104439258575
distance x is tensor(141.6877, device='cuda:3')
benign distance is  tensor(141.6877, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6688101887702942
distance x is tensor(133.7781, device='cuda:3')
benign distance is  tensor(133.7781, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3916155695915222
distance x is tensor(116.9821, device='cuda:3')
benign distance is  tensor(116.9821, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.027623176574707
distance x is tensor(132.9075, device='cuda:3')
benign distance is  tensor(132.9075, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8198710680007935
distance x is tensor(119.7469, device='cuda:3')
benign distance is  tensor(119.7469, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5839961171150208
distance x is tensor(125.7981, device='cuda:3')
benign distance is  tensor(125.7981, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.1858774572610855
distance x is tensor(121.9353, device='cuda:3')
benign distance is  tensor(121.9353, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0466663837432861
distance x is tensor(129.9674, device='cuda:3')
benign distance is  tensor(129.9674, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.19171223044395447
distance x is tensor(132.5436, device='cuda:3')
benign distance is  tensor(132.5436, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2317074537277222
distance x is tensor(150.3234, device='cuda:3')
benign distance is  tensor(150.3234, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.10723064839839935
distance x is tensor(129.3024, device='cuda:3')
benign distance is  tensor(129.3024, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.16133548319339752
distance x is tensor(140.2509, device='cuda:3')
benign distance is  tensor(140.2509, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.41262561082839966
distance x is tensor(131.4800, device='cuda:3')
benign distance is  tensor(131.4800, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7250897884368896
distance x is tensor(131.2514, device='cuda:3')
benign distance is  tensor(131.2514, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.16328847408294678
distance x is tensor(144.9285, device='cuda:3')
benign distance is  tensor(144.9285, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5079988837242126
distance x is tensor(124.8602, device='cuda:3')
benign distance is  tensor(124.8602, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.10640808194875717
distance x is tensor(126.5501, device='cuda:3')
benign distance is  tensor(126.5501, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5516929626464844
distance x is tensor(134.3337, device='cuda:3')
benign distance is  tensor(134.3337, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.36723026633262634
distance x is tensor(139.3698, device='cuda:3')
benign distance is  tensor(139.3698, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4709586203098297
distance x is tensor(146.7465, device='cuda:3')
benign distance is  tensor(146.7465, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.08078791946172714
distance x is tensor(136.7248, device='cuda:3')
benign distance is  tensor(136.7248, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5412085056304932
distance x is tensor(136.4517, device='cuda:3')
benign distance is  tensor(136.4517, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.4571253061294556
distance x is tensor(143.9549, device='cuda:3')
benign distance is  tensor(143.9549, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7648546099662781
distance x is tensor(135.2324, device='cuda:3')
benign distance is  tensor(135.2324, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  15.003608703613281
distance x is tensor(172.2631, device='cuda:3')
benign distance is  tensor(172.2631, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  18.26533317565918
distance x is tensor(172.0281, device='cuda:3')
benign distance is  tensor(172.0281, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.488805770874023
distance x is tensor(186.1314, device='cuda:3')
benign distance is  tensor(186.1314, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  19.1546630859375
distance x is tensor(180.3999, device='cuda:3')
benign distance is  tensor(180.3999, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  18.082847595214844
distance x is tensor(179.3452, device='cuda:3')
benign distance is  tensor(179.3452, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  21.72880744934082
distance x is tensor(176.4041, device='cuda:3')
benign distance is  tensor(176.4041, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  13.858779907226562
distance x is tensor(170.6808, device='cuda:3')
benign distance is  tensor(170.6808, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.41337776184082
distance x is tensor(175.6979, device='cuda:3')
benign distance is  tensor(175.6979, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  18.89923667907715
distance x is tensor(183.2899, device='cuda:3')
benign distance is  tensor(183.2899, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  18.98247528076172
distance x is tensor(165.7077, device='cuda:3')
benign distance is  tensor(165.7077, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  12.177057266235352
distance x is tensor(179.4004, device='cuda:3')
benign distance is  tensor(179.4004, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  18.802736282348633
distance x is tensor(181.2478, device='cuda:3')
benign distance is  tensor(181.2478, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([521.1218, 520.4587, 518.7255, 520.1313, 454.1841, 529.6464, 495.6630,
        470.9288, 687.9720, 693.9598, 762.5901, 735.2234, 719.4144, 694.2002,
        687.8416, 719.8047, 741.4506, 663.7058, 720.5694, 733.9789],
       device='cuda:3')
sorted_norm is   tensor([454.1841, 470.9288, 495.6630, 518.7255, 520.1313, 520.4587, 521.1218,
        529.6464, 663.7058, 687.8416, 687.9720, 693.9598, 694.2002, 719.4144,
        719.8047, 720.5694, 733.9789, 735.2234, 741.4506, 762.5901],
       device='cuda:3')
used idx is  tensor([ 4,  7,  6,  2,  3,  1,  0,  5, 17, 14,  8,  9, 13, 12, 15, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 2.09% 

Test Accuracy: 1.89% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.881910502910614
distance x is tensor(174.1227, device='cuda:3')
benign distance is  tensor(174.1227, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7351341843605042
distance x is tensor(182.7366, device='cuda:3')
benign distance is  tensor(182.7366, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09709562361240387
distance x is tensor(200.7767, device='cuda:3')
benign distance is  tensor(200.7767, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5195601582527161
distance x is tensor(174.6664, device='cuda:3')
benign distance is  tensor(174.6664, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4710117280483246
distance x is tensor(170.0308, device='cuda:3')
benign distance is  tensor(170.0308, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.408756822347641
distance x is tensor(182.4036, device='cuda:3')
benign distance is  tensor(182.4036, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5589332580566406
distance x is tensor(176.1023, device='cuda:3')
benign distance is  tensor(176.1023, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.08639703691005707
distance x is tensor(187.4657, device='cuda:3')
benign distance is  tensor(187.4657, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  16.53903579711914
distance x is tensor(110.0824, device='cuda:3')
benign distance is  tensor(110.0824, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  17.839069366455078
distance x is tensor(112.9969, device='cuda:3')
benign distance is  tensor(112.9969, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  17.116405487060547
distance x is tensor(132.3182, device='cuda:3')
benign distance is  tensor(132.3182, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.947941780090332
distance x is tensor(136.0741, device='cuda:3')
benign distance is  tensor(136.0741, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  13.905856132507324
distance x is tensor(134.9493, device='cuda:3')
benign distance is  tensor(134.9493, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  17.033023834228516
distance x is tensor(130.2508, device='cuda:3')
benign distance is  tensor(130.2508, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  15.683515548706055
distance x is tensor(128.7439, device='cuda:3')
benign distance is  tensor(128.7439, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  15.023587226867676
distance x is tensor(122.9554, device='cuda:3')
benign distance is  tensor(122.9554, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  15.953035354614258
distance x is tensor(135.8340, device='cuda:3')
benign distance is  tensor(135.8340, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  20.67190170288086
distance x is tensor(121.8317, device='cuda:3')
benign distance is  tensor(121.8317, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  17.174556732177734
distance x is tensor(136.9913, device='cuda:3')
benign distance is  tensor(136.9913, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  14.592618942260742
distance x is tensor(117.7307, device='cuda:3')
benign distance is  tensor(117.7307, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([737.0798, 775.3500, 850.3199, 735.6298, 721.6224, 781.4869, 726.9339,
        801.3722, 492.4676, 507.1914, 593.4437, 601.3062, 606.7734, 584.5007,
        574.5536, 543.7970, 617.7128, 545.7916, 618.9594, 525.1147, 743.4515,
        666.4125, 665.7853, 670.5297, 680.9100, 658.3373, 651.7477, 686.0461,
        675.6579, 648.1232, 569.0233, 632.1823, 585.8438, 614.6406, 585.1608,
        627.9732], device='cuda:3')
sorted_norm is   tensor([492.4676, 507.1914, 525.1147, 543.7970, 545.7916, 569.0233, 574.5536,
        584.5007, 585.1608, 585.8438, 593.4437, 601.3062, 606.7734, 614.6406,
        617.7128, 618.9594, 627.9732, 632.1823, 648.1232, 651.7477, 658.3373,
        665.7853, 666.4125, 670.5297, 675.6579, 680.9100, 686.0461, 721.6224,
        726.9339, 735.6298, 737.0798, 743.4515, 775.3500, 781.4869, 801.3722,
        850.3199], device='cuda:3')
used idx is  tensor([ 8,  9, 19, 15, 17, 30, 14, 13, 34, 32, 10, 11, 12, 33, 16, 18, 35, 31,
        29, 26, 25, 22, 21, 23, 28, 24, 27,  4], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 73.41% 

Test Accuracy: 72.18% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7954631447792053
distance x is tensor(138.1609, device='cuda:3')
benign distance is  tensor(138.1609, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.40541839599609375
distance x is tensor(118.4498, device='cuda:3')
benign distance is  tensor(118.4498, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04208038002252579
distance x is tensor(136.0550, device='cuda:3')
benign distance is  tensor(136.0550, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2874926030635834
distance x is tensor(124.3809, device='cuda:3')
benign distance is  tensor(124.3809, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7759544849395752
distance x is tensor(132.1260, device='cuda:3')
benign distance is  tensor(132.1260, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9253835678100586
distance x is tensor(135.4043, device='cuda:3')
benign distance is  tensor(135.4043, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.732480525970459
distance x is tensor(139.9938, device='cuda:3')
benign distance is  tensor(139.9938, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22225046157836914
distance x is tensor(120.9363, device='cuda:3')
benign distance is  tensor(120.9363, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1328973025083542
distance x is tensor(146.0737, device='cuda:3')
benign distance is  tensor(146.0737, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4378064274787903
distance x is tensor(156.4863, device='cuda:3')
benign distance is  tensor(156.4863, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.37140342593193054
distance x is tensor(134.1338, device='cuda:3')
benign distance is  tensor(134.1338, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.20470933616161346
distance x is tensor(150.6580, device='cuda:3')
benign distance is  tensor(150.6580, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8124696612358093
distance x is tensor(134.7417, device='cuda:3')
benign distance is  tensor(134.7417, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5228940844535828
distance x is tensor(137.0778, device='cuda:3')
benign distance is  tensor(137.0778, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4146038889884949
distance x is tensor(140.0022, device='cuda:3')
benign distance is  tensor(140.0022, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4813697934150696
distance x is tensor(150.8074, device='cuda:3')
benign distance is  tensor(150.8074, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.30630576610565186
distance x is tensor(162.9207, device='cuda:3')
benign distance is  tensor(162.9207, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.4625698328018188
distance x is tensor(130.8841, device='cuda:3')
benign distance is  tensor(130.8841, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9909679293632507
distance x is tensor(191.9130, device='cuda:3')
benign distance is  tensor(191.9130, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2846609055995941
distance x is tensor(151.5826, device='cuda:3')
benign distance is  tensor(151.5826, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6645986437797546
distance x is tensor(149.9875, device='cuda:3')
benign distance is  tensor(149.9875, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.33034271001815796
distance x is tensor(147.2385, device='cuda:3')
benign distance is  tensor(147.2385, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.16677798330783844
distance x is tensor(143.3742, device='cuda:3')
benign distance is  tensor(143.3742, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2993749976158142
distance x is tensor(152.5852, device='cuda:3')
benign distance is  tensor(152.5852, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  14.551551818847656
distance x is tensor(155.8758, device='cuda:3')
benign distance is  tensor(155.8758, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  18.0181941986084
distance x is tensor(146.3087, device='cuda:3')
benign distance is  tensor(146.3087, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.80396842956543
distance x is tensor(161.1555, device='cuda:3')
benign distance is  tensor(161.1555, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  18.311864852905273
distance x is tensor(151.7028, device='cuda:3')
benign distance is  tensor(151.7028, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  18.120044708251953
distance x is tensor(147.5261, device='cuda:3')
benign distance is  tensor(147.5261, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  24.651668548583984
distance x is tensor(157.4590, device='cuda:3')
benign distance is  tensor(157.4590, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.035608291625977
distance x is tensor(157.8135, device='cuda:3')
benign distance is  tensor(157.8135, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  16.334930419921875
distance x is tensor(145.4324, device='cuda:3')
benign distance is  tensor(145.4324, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.023311614990234
distance x is tensor(152.5807, device='cuda:3')
benign distance is  tensor(152.5807, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  16.324710845947266
distance x is tensor(134.7496, device='cuda:3')
benign distance is  tensor(134.7496, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  19.927974700927734
distance x is tensor(147.5944, device='cuda:3')
benign distance is  tensor(147.5944, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  18.602550506591797
distance x is tensor(147.7626, device='cuda:3')
benign distance is  tensor(147.7626, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([614.2461, 522.1334, 594.1748, 554.1310, 584.2048, 592.2396, 615.3673,
        535.2579, 649.4172, 622.9666, 676.9581, 635.8651, 643.5866, 684.5343,
        678.9411, 617.0855, 650.4207, 575.8088, 630.7104, 619.2935, 681.7953,
        645.2622, 677.4374, 647.0975, 657.8651, 650.7112, 583.1299, 622.5115,
        608.7190, 694.9591, 598.5834, 643.4258, 605.7865, 600.7241, 673.3041,
        576.1078], device='cuda:3')
sorted_norm is   tensor([522.1334, 535.2579, 554.1310, 575.8088, 576.1078, 583.1299, 584.2048,
        592.2396, 594.1748, 598.5834, 600.7241, 605.7865, 608.7190, 614.2461,
        615.3673, 617.0855, 619.2935, 622.5115, 622.9666, 630.7104, 635.8651,
        643.4258, 643.5866, 645.2622, 647.0975, 649.4172, 650.4207, 650.7112,
        657.8651, 673.3041, 676.9581, 677.4374, 678.9411, 681.7953, 684.5343,
        694.9591], device='cuda:3')
used idx is  tensor([ 1,  7,  3, 17, 35, 26,  4,  5,  2, 30, 33, 32, 28,  0,  6, 15, 19, 27,
         9, 18, 11, 31, 12, 21, 23,  8, 16, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 82.75% 

Test Accuracy: 81.73% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1815030872821808
distance x is tensor(97.3751, device='cuda:3')
benign distance is  tensor(97.3751, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.30619359016418457
distance x is tensor(139.9093, device='cuda:3')
benign distance is  tensor(139.9093, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20885567367076874
distance x is tensor(143.9501, device='cuda:3')
benign distance is  tensor(143.9501, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3450133204460144
distance x is tensor(124.3706, device='cuda:3')
benign distance is  tensor(124.3706, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6317572593688965
distance x is tensor(99.5950, device='cuda:3')
benign distance is  tensor(99.5950, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7115108370780945
distance x is tensor(140.5591, device='cuda:3')
benign distance is  tensor(140.5591, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2513993978500366
distance x is tensor(115.9270, device='cuda:3')
benign distance is  tensor(115.9270, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.374234676361084
distance x is tensor(115.9516, device='cuda:3')
benign distance is  tensor(115.9516, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4035674035549164
distance x is tensor(138.5682, device='cuda:3')
benign distance is  tensor(138.5682, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.560373842716217
distance x is tensor(160.3792, device='cuda:3')
benign distance is  tensor(160.3792, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2678852379322052
distance x is tensor(147.5168, device='cuda:3')
benign distance is  tensor(147.5168, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.12337358295917511
distance x is tensor(135.7577, device='cuda:3')
benign distance is  tensor(135.7577, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.34188491106033325
distance x is tensor(143.2881, device='cuda:3')
benign distance is  tensor(143.2881, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6028348207473755
distance x is tensor(140.6723, device='cuda:3')
benign distance is  tensor(140.6723, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2731507122516632
distance x is tensor(151.5345, device='cuda:3')
benign distance is  tensor(151.5345, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.808585524559021
distance x is tensor(141.0795, device='cuda:3')
benign distance is  tensor(141.0795, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.17332492768764496
distance x is tensor(145.6263, device='cuda:3')
benign distance is  tensor(145.6263, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.21331413090229034
distance x is tensor(137.1282, device='cuda:3')
benign distance is  tensor(137.1282, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9000388383865356
distance x is tensor(151.8043, device='cuda:3')
benign distance is  tensor(151.8043, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.07434404641389847
distance x is tensor(154.4924, device='cuda:3')
benign distance is  tensor(154.4924, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.18195705115795135
distance x is tensor(136.7764, device='cuda:3')
benign distance is  tensor(136.7764, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.43710774183273315
distance x is tensor(137.6035, device='cuda:3')
benign distance is  tensor(137.6035, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3980099856853485
distance x is tensor(143.8953, device='cuda:3')
benign distance is  tensor(143.8953, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.06923703104257584
distance x is tensor(138.8546, device='cuda:3')
benign distance is  tensor(138.8546, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  19.344783782958984
distance x is tensor(150.8877, device='cuda:3')
benign distance is  tensor(150.8877, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  19.046445846557617
distance x is tensor(160.3250, device='cuda:3')
benign distance is  tensor(160.3250, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  15.94989013671875
distance x is tensor(166.9200, device='cuda:3')
benign distance is  tensor(166.9200, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  20.113107681274414
distance x is tensor(166.4601, device='cuda:3')
benign distance is  tensor(166.4601, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  17.167728424072266
distance x is tensor(169.9066, device='cuda:3')
benign distance is  tensor(169.9066, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  13.762161254882812
distance x is tensor(163.5718, device='cuda:3')
benign distance is  tensor(163.5718, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.86298656463623
distance x is tensor(157.9796, device='cuda:3')
benign distance is  tensor(157.9796, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.001449584960938
distance x is tensor(166.9024, device='cuda:3')
benign distance is  tensor(166.9024, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.46230125427246
distance x is tensor(158.0721, device='cuda:3')
benign distance is  tensor(158.0721, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  15.385034561157227
distance x is tensor(158.2690, device='cuda:3')
benign distance is  tensor(158.2690, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.921167373657227
distance x is tensor(158.5997, device='cuda:3')
benign distance is  tensor(158.5997, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  21.60755157470703
distance x is tensor(158.6739, device='cuda:3')
benign distance is  tensor(158.6739, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([431.7973, 624.8397, 633.5560, 535.5958, 434.3398, 610.9972, 504.6859,
        512.2968, 638.5638, 668.9102, 703.3723, 690.1385, 698.1669, 683.5721,
        674.1893, 697.6540, 672.7168, 664.6812, 664.7827, 662.2632, 661.7937,
        697.3843, 610.2810, 678.2537, 617.6492, 622.2609, 641.4811, 686.0649],
       device='cuda:3')
sorted_norm is   tensor([431.7973, 434.3398, 504.6859, 512.2968, 535.5958, 610.2810, 610.9972,
        617.6492, 622.2609, 624.8397, 633.5560, 638.5638, 641.4811, 661.7937,
        662.2632, 664.6812, 664.7827, 668.9102, 672.7168, 674.1893, 678.2537,
        683.5721, 686.0649, 690.1385, 697.3843, 697.6540, 698.1669, 703.3723],
       device='cuda:3')
used idx is  tensor([ 0,  4,  6,  7,  3, 22,  5, 24, 25,  1,  2,  8, 26, 20, 19, 17, 18,  9,
        16, 14, 23, 13], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 64.21% 

Test Accuracy: 64.18% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5948706865310669
distance x is tensor(120.9621, device='cuda:3')
benign distance is  tensor(120.9621, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.79298996925354
distance x is tensor(141.1230, device='cuda:3')
benign distance is  tensor(141.1230, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14530853927135468
distance x is tensor(156.4601, device='cuda:3')
benign distance is  tensor(156.4601, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5704194903373718
distance x is tensor(124.2029, device='cuda:3')
benign distance is  tensor(124.2029, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3227778971195221
distance x is tensor(112.2474, device='cuda:3')
benign distance is  tensor(112.2474, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4468978941440582
distance x is tensor(130.1745, device='cuda:3')
benign distance is  tensor(130.1745, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.059586863964796066
distance x is tensor(128.0981, device='cuda:3')
benign distance is  tensor(128.0981, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3478551506996155
distance x is tensor(132.8391, device='cuda:3')
benign distance is  tensor(132.8391, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3665791451931
distance x is tensor(153.2403, device='cuda:3')
benign distance is  tensor(153.2403, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4701365530490875
distance x is tensor(154.1622, device='cuda:3')
benign distance is  tensor(154.1622, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2688366174697876
distance x is tensor(145.3099, device='cuda:3')
benign distance is  tensor(145.3099, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8647729754447937
distance x is tensor(144.1013, device='cuda:3')
benign distance is  tensor(144.1013, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.32479479908943176
distance x is tensor(143.1414, device='cuda:3')
benign distance is  tensor(143.1414, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5933719873428345
distance x is tensor(160.0715, device='cuda:3')
benign distance is  tensor(160.0715, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.050059668719768524
distance x is tensor(144.2289, device='cuda:3')
benign distance is  tensor(144.2289, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7854878902435303
distance x is tensor(155.6054, device='cuda:3')
benign distance is  tensor(155.6054, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  17.81601905822754
distance x is tensor(140.8976, device='cuda:3')
benign distance is  tensor(140.8976, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  17.919748306274414
distance x is tensor(138.8743, device='cuda:3')
benign distance is  tensor(138.8743, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  16.370525360107422
distance x is tensor(156.3476, device='cuda:3')
benign distance is  tensor(156.3476, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  19.12081527709961
distance x is tensor(146.2978, device='cuda:3')
benign distance is  tensor(146.2978, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  17.413419723510742
distance x is tensor(166.6246, device='cuda:3')
benign distance is  tensor(166.6246, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  21.720735549926758
distance x is tensor(153.4313, device='cuda:3')
benign distance is  tensor(153.4313, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.985318183898926
distance x is tensor(142.8769, device='cuda:3')
benign distance is  tensor(142.8769, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  19.667587280273438
distance x is tensor(149.7830, device='cuda:3')
benign distance is  tensor(149.7830, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  17.6495361328125
distance x is tensor(151.6581, device='cuda:3')
benign distance is  tensor(151.6581, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  17.830310821533203
distance x is tensor(145.1464, device='cuda:3')
benign distance is  tensor(145.1464, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  19.621994018554688
distance x is tensor(149.6585, device='cuda:3')
benign distance is  tensor(149.6585, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  16.791147232055664
distance x is tensor(141.9125, device='cuda:3')
benign distance is  tensor(141.9125, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([530.9209, 641.3734, 679.9612, 530.7795, 480.6479, 576.2750, 558.1648,
        573.6277, 589.4668, 593.8656, 667.2296, 641.1951, 704.9904, 658.7325,
        620.5714, 641.2205, 648.4049, 613.5555, 636.9116, 600.5857],
       device='cuda:3')
sorted_norm is   tensor([480.6479, 530.7795, 530.9209, 558.1648, 573.6277, 576.2750, 589.4668,
        593.8656, 600.5857, 613.5555, 620.5714, 636.9116, 641.1951, 641.2205,
        641.3734, 648.4049, 658.7325, 667.2296, 679.9612, 704.9904],
       device='cuda:3')
used idx is  tensor([ 4,  3,  0,  6,  7,  5,  8,  9, 19, 17, 14, 18, 11, 15,  1, 16],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 5.79% 

Test Accuracy: 5.71% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2686159908771515
distance x is tensor(171.6926, device='cuda:3')
benign distance is  tensor(171.6926, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9329811334609985
distance x is tensor(179.5689, device='cuda:3')
benign distance is  tensor(179.5689, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.02133919671177864
distance x is tensor(175.3277, device='cuda:3')
benign distance is  tensor(175.3277, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8544198274612427
distance x is tensor(178.5735, device='cuda:3')
benign distance is  tensor(178.5735, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.38980942964553833
distance x is tensor(173.9651, device='cuda:3')
benign distance is  tensor(173.9651, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5176674723625183
distance x is tensor(182.8299, device='cuda:3')
benign distance is  tensor(182.8299, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27208131551742554
distance x is tensor(158.2544, device='cuda:3')
benign distance is  tensor(158.2544, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2348196804523468
distance x is tensor(174.3779, device='cuda:3')
benign distance is  tensor(174.3779, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  17.970781326293945
distance x is tensor(122.2335, device='cuda:3')
benign distance is  tensor(122.2335, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.209962844848633
distance x is tensor(129.3412, device='cuda:3')
benign distance is  tensor(129.3412, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  17.329082489013672
distance x is tensor(152.7635, device='cuda:3')
benign distance is  tensor(152.7635, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  14.659950256347656
distance x is tensor(126.7611, device='cuda:3')
benign distance is  tensor(126.7611, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  16.85159683227539
distance x is tensor(139.8846, device='cuda:3')
benign distance is  tensor(139.8846, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.771114349365234
distance x is tensor(127.4412, device='cuda:3')
benign distance is  tensor(127.4412, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.001779556274414
distance x is tensor(124.5964, device='cuda:3')
benign distance is  tensor(124.5964, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  17.40345001220703
distance x is tensor(140.0040, device='cuda:3')
benign distance is  tensor(140.0040, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  14.227693557739258
distance x is tensor(140.2897, device='cuda:3')
benign distance is  tensor(140.2897, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  18.346420288085938
distance x is tensor(117.1109, device='cuda:3')
benign distance is  tensor(117.1109, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  17.043437957763672
distance x is tensor(133.0070, device='cuda:3')
benign distance is  tensor(133.0070, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  16.570491790771484
distance x is tensor(135.9877, device='cuda:3')
benign distance is  tensor(135.9877, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([731.9971, 786.6693, 755.8254, 778.1348, 733.8284, 792.5375, 670.7828,
        760.5076, 534.6028, 559.3542, 669.4359, 556.2237, 623.7401, 558.0502,
        558.3063, 627.0930, 625.8821, 522.2581, 593.1464, 593.7531, 642.4485,
        660.4281, 685.7216, 705.5432, 665.4079, 681.7905, 714.7376, 676.1913,
        775.4572, 618.3782, 879.2208, 707.6749, 712.6282, 691.1989, 668.7984,
        714.8934, 665.6791, 764.3984, 685.5573, 653.8635, 674.2814, 669.5772,
        708.1143, 680.8912, 703.6409, 707.8569, 664.6841, 660.9644, 675.8914,
        742.4402, 665.9442, 706.8134], device='cuda:3')
sorted_norm is   tensor([522.2581, 534.6028, 556.2237, 558.0502, 558.3063, 559.3542, 593.1464,
        593.7531, 618.3782, 623.7401, 625.8821, 627.0930, 642.4485, 653.8635,
        660.4281, 660.9644, 664.6841, 665.4079, 665.6791, 665.9442, 668.7984,
        669.4359, 669.5772, 670.7828, 674.2814, 675.8914, 676.1913, 680.8912,
        681.7905, 685.5573, 685.7216, 691.1989, 703.6409, 705.5432, 706.8134,
        707.6749, 707.8569, 708.1143, 712.6282, 714.7376, 714.8934, 731.9971,
        733.8284, 742.4402, 755.8254, 760.5076, 764.3984, 775.4572, 778.1348,
        786.6693, 792.5375, 879.2208], device='cuda:3')
used idx is  tensor([17,  8, 11, 13, 14,  9, 18, 19, 29, 12, 16, 15, 20, 39, 21, 47, 46, 24,
        36, 50, 34, 10, 41,  6, 40, 48, 27, 43, 25, 38, 22, 33, 44, 23, 51, 31,
        45, 42, 32, 26, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 89.22% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6463731527328491
distance x is tensor(105.5445, device='cuda:3')
benign distance is  tensor(105.5445, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7151340246200562
distance x is tensor(101.0565, device='cuda:3')
benign distance is  tensor(101.0565, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09514964371919632
distance x is tensor(129.3329, device='cuda:3')
benign distance is  tensor(129.3329, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.09088367223739624
distance x is tensor(107.0015, device='cuda:3')
benign distance is  tensor(107.0015, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1661196947097778
distance x is tensor(95.9837, device='cuda:3')
benign distance is  tensor(95.9837, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42793387174606323
distance x is tensor(115.0043, device='cuda:3')
benign distance is  tensor(115.0043, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15987078845500946
distance x is tensor(102.6514, device='cuda:3')
benign distance is  tensor(102.6514, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.14312303066253662
distance x is tensor(104.4205, device='cuda:3')
benign distance is  tensor(104.4205, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.18710169196128845
distance x is tensor(136.8548, device='cuda:3')
benign distance is  tensor(136.8548, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5263824462890625
distance x is tensor(114.6772, device='cuda:3')
benign distance is  tensor(114.6772, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23815269768238068
distance x is tensor(136.7019, device='cuda:3')
benign distance is  tensor(136.7019, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0530283451080322
distance x is tensor(134.1705, device='cuda:3')
benign distance is  tensor(134.1705, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5252874493598938
distance x is tensor(119.8944, device='cuda:3')
benign distance is  tensor(119.8944, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.06320874392986298
distance x is tensor(132.8270, device='cuda:3')
benign distance is  tensor(132.8270, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.309661328792572
distance x is tensor(121.8266, device='cuda:3')
benign distance is  tensor(121.8266, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.35847634077072144
distance x is tensor(129.3842, device='cuda:3')
benign distance is  tensor(129.3842, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4117504060268402
distance x is tensor(134.4073, device='cuda:3')
benign distance is  tensor(134.4073, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8401864171028137
distance x is tensor(155.0932, device='cuda:3')
benign distance is  tensor(155.0932, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.06484619528055191
distance x is tensor(125.5593, device='cuda:3')
benign distance is  tensor(125.5593, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.39742588996887207
distance x is tensor(134.6194, device='cuda:3')
benign distance is  tensor(134.6194, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.23357930779457092
distance x is tensor(129.3233, device='cuda:3')
benign distance is  tensor(129.3233, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4832325875759125
distance x is tensor(128.0166, device='cuda:3')
benign distance is  tensor(128.0166, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.14486084878444672
distance x is tensor(150.8169, device='cuda:3')
benign distance is  tensor(150.8169, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6186622977256775
distance x is tensor(140.0263, device='cuda:3')
benign distance is  tensor(140.0263, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.10533179342746735
distance x is tensor(142.5393, device='cuda:3')
benign distance is  tensor(142.5393, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.49366647005081177
distance x is tensor(120.1065, device='cuda:3')
benign distance is  tensor(120.1065, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.22130827605724335
distance x is tensor(136.5453, device='cuda:3')
benign distance is  tensor(136.5453, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5952007174491882
distance x is tensor(149.3569, device='cuda:3')
benign distance is  tensor(149.3569, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1861451864242554
distance x is tensor(141.0126, device='cuda:3')
benign distance is  tensor(141.0126, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2855111360549927
distance x is tensor(142.8517, device='cuda:3')
benign distance is  tensor(142.8517, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8473512530326843
distance x is tensor(138.0372, device='cuda:3')
benign distance is  tensor(138.0372, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.496359258890152
distance x is tensor(132.7285, device='cuda:3')
benign distance is  tensor(132.7285, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.21578529477119446
distance x is tensor(143.6650, device='cuda:3')
benign distance is  tensor(143.6650, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.21549110114574432
distance x is tensor(128.9751, device='cuda:3')
benign distance is  tensor(128.9751, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.09373794496059418
distance x is tensor(142.0214, device='cuda:3')
benign distance is  tensor(142.0214, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5943450927734375
distance x is tensor(148.9091, device='cuda:3')
benign distance is  tensor(148.9091, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.25577449798583984
distance x is tensor(126.0177, device='cuda:3')
benign distance is  tensor(126.0177, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6331059336662292
distance x is tensor(140.9410, device='cuda:3')
benign distance is  tensor(140.9410, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.843314528465271
distance x is tensor(136.3870, device='cuda:3')
benign distance is  tensor(136.3870, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3761470913887024
distance x is tensor(134.6091, device='cuda:3')
benign distance is  tensor(134.6091, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  16.153549194335938
distance x is tensor(185.5479, device='cuda:3')
benign distance is  tensor(185.5479, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  20.411697387695312
distance x is tensor(190.1668, device='cuda:3')
benign distance is  tensor(190.1668, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.237324714660645
distance x is tensor(208.4176, device='cuda:3')
benign distance is  tensor(208.4176, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  15.000490188598633
distance x is tensor(190.4580, device='cuda:3')
benign distance is  tensor(190.4580, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  14.430389404296875
distance x is tensor(201.1174, device='cuda:3')
benign distance is  tensor(201.1174, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  19.261642456054688
distance x is tensor(191.0652, device='cuda:3')
benign distance is  tensor(191.0652, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  14.171684265136719
distance x is tensor(193.7857, device='cuda:3')
benign distance is  tensor(193.7857, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  19.32665252685547
distance x is tensor(191.6621, device='cuda:3')
benign distance is  tensor(191.6621, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.0928897857666
distance x is tensor(204.9470, device='cuda:3')
benign distance is  tensor(204.9470, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  16.614261627197266
distance x is tensor(192.7394, device='cuda:3')
benign distance is  tensor(192.7394, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  17.488887786865234
distance x is tensor(210.7568, device='cuda:3')
benign distance is  tensor(210.7568, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  17.666244506835938
distance x is tensor(193.7841, device='cuda:3')
benign distance is  tensor(193.7841, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([465.9558, 447.9344, 575.7589, 464.7937, 421.2221, 513.4172, 446.0687,
        461.9093, 726.9189, 759.7466, 830.5530, 759.7889, 798.3593, 774.2093,
        769.3291, 756.1504, 814.8299, 767.4549, 824.0422, 769.2060],
       device='cuda:3')
sorted_norm is   tensor([421.2221, 446.0687, 447.9344, 461.9093, 464.7937, 465.9558, 513.4172,
        575.7589, 726.9189, 756.1504, 759.7466, 759.7889, 767.4549, 769.2060,
        769.3291, 774.2093, 798.3593, 814.8299, 824.0422, 830.5530],
       device='cuda:3')
used idx is  tensor([ 4,  6,  1,  7,  3,  0,  5,  2,  8, 15,  9, 11, 17, 19, 14, 13],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 1.74% 

Test Accuracy: 1.67% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41221752762794495
distance x is tensor(200.5780, device='cuda:3')
benign distance is  tensor(200.5780, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7192482948303223
distance x is tensor(193.3146, device='cuda:3')
benign distance is  tensor(193.3146, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.023798447102308273
distance x is tensor(220.0437, device='cuda:3')
benign distance is  tensor(220.0437, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7525802850723267
distance x is tensor(177.8996, device='cuda:3')
benign distance is  tensor(177.8996, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6077027916908264
distance x is tensor(181.0874, device='cuda:3')
benign distance is  tensor(181.0874, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.696529746055603
distance x is tensor(190.8969, device='cuda:3')
benign distance is  tensor(190.8969, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6143703460693359
distance x is tensor(185.7027, device='cuda:3')
benign distance is  tensor(185.7027, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49646124243736267
distance x is tensor(185.0807, device='cuda:3')
benign distance is  tensor(185.0807, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  18.66001319885254
distance x is tensor(108.4005, device='cuda:3')
benign distance is  tensor(108.4005, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  16.91221809387207
distance x is tensor(106.4745, device='cuda:3')
benign distance is  tensor(106.4745, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  14.079020500183105
distance x is tensor(129.0830, device='cuda:3')
benign distance is  tensor(129.0830, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  16.70209312438965
distance x is tensor(118.7727, device='cuda:3')
benign distance is  tensor(118.7727, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  18.32956886291504
distance x is tensor(127.1079, device='cuda:3')
benign distance is  tensor(127.1079, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  16.49833106994629
distance x is tensor(123.8984, device='cuda:3')
benign distance is  tensor(123.8984, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.671258926391602
distance x is tensor(129.0313, device='cuda:3')
benign distance is  tensor(129.0313, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  18.797712326049805
distance x is tensor(129.1455, device='cuda:3')
benign distance is  tensor(129.1455, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  16.770259857177734
distance x is tensor(127.0436, device='cuda:3')
benign distance is  tensor(127.0436, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  15.170854568481445
distance x is tensor(115.6077, device='cuda:3')
benign distance is  tensor(115.6077, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  16.435619354248047
distance x is tensor(134.5946, device='cuda:3')
benign distance is  tensor(134.5946, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  15.224691390991211
distance x is tensor(118.2035, device='cuda:3')
benign distance is  tensor(118.2035, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([846.5258, 817.3552, 958.2796, 740.4407, 746.2629, 811.7818, 792.4857,
        782.5970, 488.5999, 474.1425, 581.5857, 533.7570, 568.7617, 557.6587,
        573.4638, 584.2076, 572.8530, 512.2529, 597.9935, 515.7620, 704.3830,
        680.5666, 740.7173, 747.8010, 671.3243, 670.6025, 707.2050, 686.1224,
        665.7478, 567.4960, 653.1743, 648.6918, 589.4844, 650.8212, 600.7151,
        623.5208], device='cuda:3')
sorted_norm is   tensor([474.1425, 488.5999, 512.2529, 515.7620, 533.7570, 557.6587, 567.4960,
        568.7617, 572.8530, 573.4638, 581.5857, 584.2076, 589.4844, 597.9935,
        600.7151, 623.5208, 648.6918, 650.8212, 653.1743, 665.7478, 670.6025,
        671.3243, 680.5666, 686.1224, 704.3830, 707.2050, 740.4407, 740.7173,
        746.2629, 747.8010, 782.5970, 792.4857, 811.7818, 817.3552, 846.5258,
        958.2796], device='cuda:3')
used idx is  tensor([ 9,  8, 17, 19, 11, 13, 29, 12, 16, 14, 10, 15, 32, 18, 34, 35, 31, 33,
        30, 28, 25, 24, 21, 27, 20, 26,  3, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 62.89% 

Test Accuracy: 62.84% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 62.89%
|----0th round Training Accuracy : 32.54%
|----1th round Training Accuracy : 82.55%
|----2th round Training Accuracy : 86.38%
|----3th round Training Accuracy : 89.12%
|----4th round Training Accuracy : 78.17%
|----5th round Training Accuracy : 89.78%
|----6th round Training Accuracy : 4.30%
|----7th round Training Accuracy : 85.75%
|----8th round Training Accuracy : 87.80%
|----9th round Training Accuracy : 89.69%
|----10th round Training Accuracy : 2.89%
|----11th round Training Accuracy : 89.13%
|----12th round Training Accuracy : 4.25%
|----13th round Training Accuracy : 44.59%
|----14th round Training Accuracy : 81.92%
|----15th round Training Accuracy : 89.00%
|----16th round Training Accuracy : 3.08%
|----17th round Training Accuracy : 88.90%
|----18th round Training Accuracy : 3.00%
|----19th round Training Accuracy : 89.00%
|----20th round Training Accuracy : 67.87%
|----21th round Training Accuracy : 87.04%
|----22th round Training Accuracy : 4.79%
|----23th round Training Accuracy : 89.70%
|----24th round Training Accuracy : 52.48%
|----25th round Training Accuracy : 82.28%
|----26th round Training Accuracy : 69.55%
|----27th round Training Accuracy : 89.68%
|----28th round Training Accuracy : 1.88%
|----29th round Training Accuracy : 89.31%
|----30th round Training Accuracy : 2.25%
|----31th round Training Accuracy : 69.13%
|----32th round Training Accuracy : 71.93%
|----33th round Training Accuracy : 78.33%
|----34th round Training Accuracy : 67.49%
|----35th round Training Accuracy : 89.15%
|----36th round Training Accuracy : 2.53%
|----37th round Training Accuracy : 35.43%
|----38th round Training Accuracy : 66.30%
|----39th round Training Accuracy : 86.05%
|----40th round Training Accuracy : 3.73%
|----41th round Training Accuracy : 89.39%
|----42th round Training Accuracy : 2.09%
|----43th round Training Accuracy : 73.41%
|----44th round Training Accuracy : 82.75%
|----45th round Training Accuracy : 64.21%
|----46th round Training Accuracy : 5.79%
|----47th round Training Accuracy : 89.63%
|----48th round Training Accuracy : 1.74%
|----49th round Training Accuracy : 62.89%
|----Final Test Accuracy: 62.84%
|----0th round Final Test Accuracy : 31.61%
|----1th round Final Test Accuracy : 82.15%
|----2th round Final Test Accuracy : 85.37%
|----3th round Final Test Accuracy : 87.99%
|----4th round Final Test Accuracy : 77.39%
|----5th round Final Test Accuracy : 89.07%
|----6th round Final Test Accuracy : 3.99%
|----7th round Final Test Accuracy : 84.81%
|----8th round Final Test Accuracy : 86.65%
|----9th round Final Test Accuracy : 88.72%
|----10th round Final Test Accuracy : 2.98%
|----11th round Final Test Accuracy : 88.22%
|----12th round Final Test Accuracy : 3.95%
|----13th round Final Test Accuracy : 43.86%
|----14th round Final Test Accuracy : 80.85%
|----15th round Final Test Accuracy : 88.16%
|----16th round Final Test Accuracy : 3.02%
|----17th round Final Test Accuracy : 88.14%
|----18th round Final Test Accuracy : 2.80%
|----19th round Final Test Accuracy : 88.47%
|----20th round Final Test Accuracy : 66.54%
|----21th round Final Test Accuracy : 85.98%
|----22th round Final Test Accuracy : 4.64%
|----23th round Final Test Accuracy : 89.06%
|----24th round Final Test Accuracy : 51.26%
|----25th round Final Test Accuracy : 80.95%
|----26th round Final Test Accuracy : 68.79%
|----27th round Final Test Accuracy : 89.12%
|----28th round Final Test Accuracy : 1.78%
|----29th round Final Test Accuracy : 88.86%
|----30th round Final Test Accuracy : 2.18%
|----31th round Final Test Accuracy : 68.71%
|----32th round Final Test Accuracy : 70.77%
|----33th round Final Test Accuracy : 77.64%
|----34th round Final Test Accuracy : 66.28%
|----35th round Final Test Accuracy : 88.52%
|----36th round Final Test Accuracy : 2.19%
|----37th round Final Test Accuracy : 35.33%
|----38th round Final Test Accuracy : 66.30%
|----39th round Final Test Accuracy : 85.23%
|----40th round Final Test Accuracy : 3.50%
|----41th round Final Test Accuracy : 88.72%
|----42th round Final Test Accuracy : 1.89%
|----43th round Final Test Accuracy : 72.18%
|----44th round Final Test Accuracy : 81.73%
|----45th round Final Test Accuracy : 64.18%
|----46th round Final Test Accuracy : 5.71%
|----47th round Final Test Accuracy : 89.22%
|----48th round Final Test Accuracy : 1.67%
|----49th round Final Test Accuracy : 62.84%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!

 Total Run Time: 3386.1307
