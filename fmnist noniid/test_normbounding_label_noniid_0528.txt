
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0448892936110497
distance x is tensor(172.5645, device='cuda:1')
benign distance is  tensor(172.5645, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5515499114990234
distance x is tensor(118.1908, device='cuda:1')
benign distance is  tensor(118.1908, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.3437475115060806
distance x is tensor(101.9392, device='cuda:1')
benign distance is  tensor(101.9392, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.069586142897606
distance x is tensor(175.7843, device='cuda:1')
benign distance is  tensor(175.7843, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.7669938057661057
distance x is tensor(128.6922, device='cuda:1')
benign distance is  tensor(128.6922, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9248979166150093
distance x is tensor(121.9601, device='cuda:1')
benign distance is  tensor(121.9601, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1845689192414284
distance x is tensor(134.8718, device='cuda:1')
benign distance is  tensor(134.8718, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.551626518368721
distance x is tensor(113.7415, device='cuda:1')
benign distance is  tensor(113.7415, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.6924440935254097
distance x is tensor(125.2558, device='cuda:1')
benign distance is  tensor(125.2558, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8973328471183777
distance x is tensor(141.0284, device='cuda:1')
benign distance is  tensor(141.0284, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.9935051277279854
distance x is tensor(125.4457, device='cuda:1')
benign distance is  tensor(125.4457, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.7687196731567383
distance x is tensor(141.9793, device='cuda:1')
benign distance is  tensor(141.9793, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.4600849598646164
distance x is tensor(164.9416, device='cuda:1')
benign distance is  tensor(164.9416, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9328708499670029
distance x is tensor(109.2973, device='cuda:1')
benign distance is  tensor(109.2973, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.757959134876728
distance x is tensor(158.5599, device='cuda:1')
benign distance is  tensor(158.5599, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.270069867372513
distance x is tensor(141.8829, device='cuda:1')
benign distance is  tensor(141.8829, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.854736387729645
distance x is tensor(128.4696, device='cuda:1')
benign distance is  tensor(128.4696, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.067845605313778
distance x is tensor(137.4257, device='cuda:1')
benign distance is  tensor(137.4257, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5008606612682343
distance x is tensor(135.3556, device='cuda:1')
benign distance is  tensor(135.3556, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.558023639023304
distance x is tensor(154.2829, device='cuda:1')
benign distance is  tensor(154.2829, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.6359404996037483
distance x is tensor(139.5613, device='cuda:1')
benign distance is  tensor(139.5613, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.9774776175618172
distance x is tensor(230.4446, device='cuda:1')
benign distance is  tensor(230.4446, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.0686373487114906
distance x is tensor(180.8489, device='cuda:1')
benign distance is  tensor(180.8489, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.936008244752884
distance x is tensor(149.0085, device='cuda:1')
benign distance is  tensor(149.0085, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.48704431951046
distance x is tensor(149.7064, device='cuda:1')
benign distance is  tensor(149.7064, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.9771249517798424
distance x is tensor(94.7497, device='cuda:1')
benign distance is  tensor(94.7497, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.3833156675100327
distance x is tensor(150.0411, device='cuda:1')
benign distance is  tensor(150.0411, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.780907765030861
distance x is tensor(130.3586, device='cuda:1')
benign distance is  tensor(130.3586, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.9353365823626518
distance x is tensor(139.4431, device='cuda:1')
benign distance is  tensor(139.4431, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.354954607784748
distance x is tensor(144.8559, device='cuda:1')
benign distance is  tensor(144.8559, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.9500369019806385
distance x is tensor(142.3768, device='cuda:1')
benign distance is  tensor(142.3768, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.8488359451293945
distance x is tensor(169.5123, device='cuda:1')
benign distance is  tensor(169.5123, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.330144815146923
distance x is tensor(151.3443, device='cuda:1')
benign distance is  tensor(151.3443, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  3.266357347369194
distance x is tensor(142.7863, device='cuda:1')
benign distance is  tensor(142.7863, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.333342343568802
distance x is tensor(141.5178, device='cuda:1')
benign distance is  tensor(141.5178, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  5.139011055231094
distance x is tensor(137.1398, device='cuda:1')
benign distance is  tensor(137.1398, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.170696422457695
distance x is tensor(152.2522, device='cuda:1')
benign distance is  tensor(152.2522, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.8071072846651077
distance x is tensor(132.2865, device='cuda:1')
benign distance is  tensor(132.2865, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.298096090555191
distance x is tensor(111.2316, device='cuda:1')
benign distance is  tensor(111.2316, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.2599075511097908
distance x is tensor(138.5504, device='cuda:1')
benign distance is  tensor(138.5504, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.6849391013383865
distance x is tensor(116.2792, device='cuda:1')
benign distance is  tensor(116.2792, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  5.006510034203529
distance x is tensor(159.5608, device='cuda:1')
benign distance is  tensor(159.5608, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.4521616026759148
distance x is tensor(186.1224, device='cuda:1')
benign distance is  tensor(186.1224, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.4446453899145126
distance x is tensor(99.0419, device='cuda:1')
benign distance is  tensor(99.0419, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.5618612840771675
distance x is tensor(157.2422, device='cuda:1')
benign distance is  tensor(157.2422, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.56638540327549
distance x is tensor(138.3524, device='cuda:1')
benign distance is  tensor(138.3524, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  4.937487602233887
distance x is tensor(127.6780, device='cuda:1')
benign distance is  tensor(127.6780, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8479819260537624
distance x is tensor(155.1055, device='cuda:1')
benign distance is  tensor(155.1055, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.9731874018907547
distance x is tensor(109.4106, device='cuda:1')
benign distance is  tensor(109.4106, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  3.0566384494304657
distance x is tensor(151.3416, device='cuda:1')
benign distance is  tensor(151.3416, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  3.1583936661481857
distance x is tensor(120.2062, device='cuda:1')
benign distance is  tensor(120.2062, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.443047732114792
distance x is tensor(142.9275, device='cuda:1')
benign distance is  tensor(142.9275, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  4.307192325592041
distance x is tensor(117.4534, device='cuda:1')
benign distance is  tensor(117.4534, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.692349597811699
distance x is tensor(123.0272, device='cuda:1')
benign distance is  tensor(123.0272, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.6887907832860947
distance x is tensor(145.1250, device='cuda:1')
benign distance is  tensor(145.1250, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  3.4295626133680344
distance x is tensor(108.1983, device='cuda:1')
benign distance is  tensor(108.1983, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.674810141324997
distance x is tensor(126.1838, device='cuda:1')
benign distance is  tensor(126.1838, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  4.099754735827446
distance x is tensor(132.3770, device='cuda:1')
benign distance is  tensor(132.3770, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.3238900527358055
distance x is tensor(124.7278, device='cuda:1')
benign distance is  tensor(124.7278, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.50200018286705
distance x is tensor(163.5599, device='cuda:1')
benign distance is  tensor(163.5599, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([19.,  0., 19.,  0.,  0.,  0., 19.,  0.,  0., 11., 19., 19., 19., 19.,
        19., 19., 19.,  0., 19.,  0.])
count_res tensor([9.0906e-02, 5.0933e-10, 9.0906e-02, 5.0933e-10, 5.0933e-10, 5.0933e-10,
        9.0906e-02, 5.0933e-10, 5.0933e-10, 3.0496e-05, 9.0906e-02, 9.0906e-02,
        9.0906e-02, 9.0906e-02, 9.0906e-02, 9.0906e-02, 9.0906e-02, 5.0933e-10,
        9.0906e-02, 5.0933e-10])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 1.27% 

Test Accuracy: 45.79% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9616874195635319
distance x is tensor(148.7694, device='cuda:1')
benign distance is  tensor(148.7694, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.7091243267059326
distance x is tensor(106.4276, device='cuda:1')
benign distance is  tensor(106.4276, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8498798459768295
distance x is tensor(90.4518, device='cuda:1')
benign distance is  tensor(90.4518, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.1299131140112877
distance x is tensor(149.3743, device='cuda:1')
benign distance is  tensor(149.3743, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1626394391059875
distance x is tensor(107.6003, device='cuda:1')
benign distance is  tensor(107.6003, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7635660022497177
distance x is tensor(111.2823, device='cuda:1')
benign distance is  tensor(111.2823, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5800752490758896
distance x is tensor(113.8041, device='cuda:1')
benign distance is  tensor(113.8041, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.222130708396435
distance x is tensor(98.7926, device='cuda:1')
benign distance is  tensor(98.7926, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.0854379162192345
distance x is tensor(92.3986, device='cuda:1')
benign distance is  tensor(92.3986, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.454202190041542
distance x is tensor(135.2452, device='cuda:1')
benign distance is  tensor(135.2452, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  3.249825596809387
distance x is tensor(100.9597, device='cuda:1')
benign distance is  tensor(100.9597, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.540624149143696
distance x is tensor(104.6931, device='cuda:1')
benign distance is  tensor(104.6931, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  3.206919237971306
distance x is tensor(91.7816, device='cuda:1')
benign distance is  tensor(91.7816, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.6543536633253098
distance x is tensor(107.3193, device='cuda:1')
benign distance is  tensor(107.3193, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.6619085669517517
distance x is tensor(122.2598, device='cuda:1')
benign distance is  tensor(122.2598, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  3.5346699208021164
distance x is tensor(92.7253, device='cuda:1')
benign distance is  tensor(92.7253, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  3.164718046784401
distance x is tensor(115.6587, device='cuda:1')
benign distance is  tensor(115.6587, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  3.6107938289642334
distance x is tensor(107.7305, device='cuda:1')
benign distance is  tensor(107.7305, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.6923312693834305
distance x is tensor(111.5198, device='cuda:1')
benign distance is  tensor(111.5198, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.2838432788848877
distance x is tensor(155.7345, device='cuda:1')
benign distance is  tensor(155.7345, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  0., 27.,  0.,  0.,  0.,  0., 27.,  0., 27., 27.,  0., 27., 27.,
         0., 27., 27.,  0., 27., 27.,  0., 27., 27., 27., 27.,  0., 27., 15.])
count_res tensor([1.2530e-13, 1.2530e-13, 6.6667e-02, 1.2530e-13, 1.2530e-13, 1.2530e-13,
        1.2530e-13, 6.6667e-02, 1.2530e-13, 6.6667e-02, 6.6667e-02, 1.2530e-13,
        6.6667e-02, 6.6667e-02, 1.2530e-13, 6.6667e-02, 6.6667e-02, 1.2530e-13,
        6.6667e-02, 6.6667e-02, 1.2530e-13, 6.6667e-02, 6.6667e-02, 6.6667e-02,
        6.6667e-02, 1.2530e-13, 6.6667e-02, 4.0961e-07])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 1.77% 

Test Accuracy: 53.39% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9152426272630692
distance x is tensor(143.2829, device='cuda:1')
benign distance is  tensor(143.2829, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3433971628546715
distance x is tensor(102.0578, device='cuda:1')
benign distance is  tensor(102.0578, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.877152904868126
distance x is tensor(95.4136, device='cuda:1')
benign distance is  tensor(95.4136, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.597931355237961
distance x is tensor(138.3035, device='cuda:1')
benign distance is  tensor(138.3035, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.5915873870253563
distance x is tensor(112.3701, device='cuda:1')
benign distance is  tensor(112.3701, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5829150304198265
distance x is tensor(107.8521, device='cuda:1')
benign distance is  tensor(107.8521, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5686884820461273
distance x is tensor(100.3830, device='cuda:1')
benign distance is  tensor(100.3830, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2596500366926193
distance x is tensor(93.8025, device='cuda:1')
benign distance is  tensor(93.8025, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.2941921651363373
distance x is tensor(108.1939, device='cuda:1')
benign distance is  tensor(108.1939, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.0542041659355164
distance x is tensor(123.7432, device='cuda:1')
benign distance is  tensor(123.7432, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.977568931877613
distance x is tensor(87.0919, device='cuda:1')
benign distance is  tensor(87.0919, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5280537754297256
distance x is tensor(106.3033, device='cuda:1')
benign distance is  tensor(106.3033, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.1224546656012535
distance x is tensor(151.0170, device='cuda:1')
benign distance is  tensor(151.0170, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8181645944714546
distance x is tensor(73.8195, device='cuda:1')
benign distance is  tensor(73.8195, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8106423914432526
distance x is tensor(143.5449, device='cuda:1')
benign distance is  tensor(143.5449, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.328130230307579
distance x is tensor(117.1583, device='cuda:1')
benign distance is  tensor(117.1583, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.8670891597867012
distance x is tensor(90.1550, device='cuda:1')
benign distance is  tensor(90.1550, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.2090170457959175
distance x is tensor(135.7554, device='cuda:1')
benign distance is  tensor(135.7554, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  3.0428388565778732
distance x is tensor(92.6632, device='cuda:1')
benign distance is  tensor(92.6632, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.459793508052826
distance x is tensor(102.7668, device='cuda:1')
benign distance is  tensor(102.7668, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  3.4364717453718185
distance x is tensor(82.4604, device='cuda:1')
benign distance is  tensor(82.4604, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.8636325001716614
distance x is tensor(110.2596, device='cuda:1')
benign distance is  tensor(110.2596, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.0741686075925827
distance x is tensor(116.5748, device='cuda:1')
benign distance is  tensor(116.5748, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  3.2837778478860855
distance x is tensor(86.9215, device='cuda:1')
benign distance is  tensor(86.9215, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.2431886419653893
distance x is tensor(116.3269, device='cuda:1')
benign distance is  tensor(116.3269, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  3.2337878197431564
distance x is tensor(99.0005, device='cuda:1')
benign distance is  tensor(99.0005, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.2638312354683876
distance x is tensor(111.2453, device='cuda:1')
benign distance is  tensor(111.2453, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.114558458328247
distance x is tensor(148.4982, device='cuda:1')
benign distance is  tensor(148.4982, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0., 27., 27., 13.,  0.,  0.,  0.,  2.,  0., 27., 27., 27., 27., 27.,
        27.,  2., 27.,  0.,  0., 25., 27., 27., 27., 27.,  0.,  0., 27.,  0.])
count_res tensor([1.3297e-13, 7.0745e-02, 7.0745e-02, 5.8826e-08, 1.3297e-13, 1.3297e-13,
        1.3297e-13, 9.8250e-13, 1.3297e-13, 7.0745e-02, 7.0745e-02, 7.0745e-02,
        7.0745e-02, 7.0745e-02, 7.0745e-02, 9.8250e-13, 7.0745e-02, 1.3297e-13,
        1.3297e-13, 9.5743e-03, 7.0745e-02, 7.0745e-02, 7.0745e-02, 7.0745e-02,
        1.3297e-13, 1.3297e-13, 7.0745e-02, 1.3297e-13])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 7.93% 

Test Accuracy: 58.65% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.855046097189188
distance x is tensor(145.4995, device='cuda:1')
benign distance is  tensor(145.4995, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.985888361930847
distance x is tensor(106.0640, device='cuda:1')
benign distance is  tensor(106.0640, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8844852447509766
distance x is tensor(96.7201, device='cuda:1')
benign distance is  tensor(96.7201, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0463095903396606
distance x is tensor(142.7103, device='cuda:1')
benign distance is  tensor(142.7103, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.233887530863285
distance x is tensor(104.6205, device='cuda:1')
benign distance is  tensor(104.6205, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5515433549880981
distance x is tensor(106.0091, device='cuda:1')
benign distance is  tensor(106.0091, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.506920278072357
distance x is tensor(99.0967, device='cuda:1')
benign distance is  tensor(99.0967, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3404473662376404
distance x is tensor(92.8027, device='cuda:1')
benign distance is  tensor(92.8027, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.2939239144325256
distance x is tensor(103.2533, device='cuda:1')
benign distance is  tensor(103.2533, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2005728855729103
distance x is tensor(101.8538, device='cuda:1')
benign distance is  tensor(101.8538, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5837187469005585
distance x is tensor(118.7854, device='cuda:1')
benign distance is  tensor(118.7854, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.0968467742204666
distance x is tensor(126.7410, device='cuda:1')
benign distance is  tensor(126.7410, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.2297659665346146
distance x is tensor(96.2021, device='cuda:1')
benign distance is  tensor(96.2021, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.27718610689044
distance x is tensor(207.7488, device='cuda:1')
benign distance is  tensor(207.7488, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.013715013861656
distance x is tensor(150.6057, device='cuda:1')
benign distance is  tensor(150.6057, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4862815663218498
distance x is tensor(120.7643, device='cuda:1')
benign distance is  tensor(120.7643, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.86335988342762
distance x is tensor(86.9521, device='cuda:1')
benign distance is  tensor(86.9521, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  3.22244393825531
distance x is tensor(139.3935, device='cuda:1')
benign distance is  tensor(139.3935, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  3.072176516056061
distance x is tensor(93.9930, device='cuda:1')
benign distance is  tensor(93.9930, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  3.1559570282697678
distance x is tensor(93.6741, device='cuda:1')
benign distance is  tensor(93.6741, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  3.599067822098732
distance x is tensor(83.0864, device='cuda:1')
benign distance is  tensor(83.0864, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.4631752967834473
distance x is tensor(109.6804, device='cuda:1')
benign distance is  tensor(109.6804, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.402477778494358
distance x is tensor(116.4183, device='cuda:1')
benign distance is  tensor(116.4183, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.6546336114406586
distance x is tensor(88.5065, device='cuda:1')
benign distance is  tensor(88.5065, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  3.1967622488737106
distance x is tensor(114.5270, device='cuda:1')
benign distance is  tensor(114.5270, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  3.416995957493782
distance x is tensor(99.2799, device='cuda:1')
benign distance is  tensor(99.2799, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  3.3016632944345474
distance x is tensor(106.4686, device='cuda:1')
benign distance is  tensor(106.4686, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.7350009232759476
distance x is tensor(146.6609, device='cuda:1')
benign distance is  tensor(146.6609, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0., 35., 35.,  0.,  0., 34.,  0., 35.,  0.,  0., 35.,  0., 35., 35.,
        35., 35.,  0.,  0.,  0.,  3.,  0., 35., 35., 35., 35., 35.,  0., 35.,
         0.,  0., 35., 35.,  0., 35., 17., 35.])
count_res tensor([3.4327e-17, 5.4443e-02, 5.4443e-02, 3.4327e-17, 3.4327e-17, 2.0028e-02,
        3.4327e-17, 5.4443e-02, 3.4327e-17, 3.4327e-17, 5.4443e-02, 3.4327e-17,
        5.4443e-02, 5.4443e-02, 5.4443e-02, 5.4443e-02, 3.4327e-17, 3.4327e-17,
        3.4327e-17, 6.8947e-16, 3.4327e-17, 5.4443e-02, 5.4443e-02, 5.4443e-02,
        5.4443e-02, 5.4443e-02, 3.4327e-17, 5.4443e-02, 3.4327e-17, 3.4327e-17,
        5.4443e-02, 5.4443e-02, 3.4327e-17, 5.4443e-02, 8.2916e-10, 5.4443e-02])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 8.76% 

Test Accuracy: 59.21% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7413243688642979
distance x is tensor(142.0015, device='cuda:1')
benign distance is  tensor(142.0015, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.7238816618919373
distance x is tensor(103.9440, device='cuda:1')
benign distance is  tensor(103.9440, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.897930309176445
distance x is tensor(101.9734, device='cuda:1')
benign distance is  tensor(101.9734, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5395930856466293
distance x is tensor(146.8893, device='cuda:1')
benign distance is  tensor(146.8893, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.069521889090538
distance x is tensor(103.1832, device='cuda:1')
benign distance is  tensor(103.1832, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6962240785360336
distance x is tensor(110.9106, device='cuda:1')
benign distance is  tensor(110.9106, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0015110224485397
distance x is tensor(106.7023, device='cuda:1')
benign distance is  tensor(106.7023, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3266902565956116
distance x is tensor(95.5757, device='cuda:1')
benign distance is  tensor(95.5757, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.5199149176478386
distance x is tensor(101.4125, device='cuda:1')
benign distance is  tensor(101.4125, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.6112785264849663
distance x is tensor(129.2217, device='cuda:1')
benign distance is  tensor(129.2217, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.073101967573166
distance x is tensor(87.6799, device='cuda:1')
benign distance is  tensor(87.6799, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.240103527903557
distance x is tensor(102.2597, device='cuda:1')
benign distance is  tensor(102.2597, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.3885054886341095
distance x is tensor(146.9830, device='cuda:1')
benign distance is  tensor(146.9830, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9722728729248047
distance x is tensor(74.7652, device='cuda:1')
benign distance is  tensor(74.7652, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8844154924154282
distance x is tensor(137.4295, device='cuda:1')
benign distance is  tensor(137.4295, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.641146436333656
distance x is tensor(116.4346, device='cuda:1')
benign distance is  tensor(116.4346, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5419410392642021
distance x is tensor(124.1367, device='cuda:1')
benign distance is  tensor(124.1367, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.252554588019848
distance x is tensor(83.1090, device='cuda:1')
benign distance is  tensor(83.1090, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.698431432247162
distance x is tensor(120.1108, device='cuda:1')
benign distance is  tensor(120.1108, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.42782062292099
distance x is tensor(100.6097, device='cuda:1')
benign distance is  tensor(100.6097, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.9976066127419472
distance x is tensor(123.1157, device='cuda:1')
benign distance is  tensor(123.1157, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.7632636576890945
distance x is tensor(113.8510, device='cuda:1')
benign distance is  tensor(113.8510, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6692352369427681
distance x is tensor(118.6699, device='cuda:1')
benign distance is  tensor(118.6699, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.7803627848625183
distance x is tensor(155.8018, device='cuda:1')
benign distance is  tensor(155.8018, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.9675924703478813
distance x is tensor(87.7114, device='cuda:1')
benign distance is  tensor(87.7114, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.576205424964428
distance x is tensor(131.2171, device='cuda:1')
benign distance is  tensor(131.2171, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.779153823852539
distance x is tensor(91.3418, device='cuda:1')
benign distance is  tensor(91.3418, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.5972936898469925
distance x is tensor(96.5578, device='cuda:1')
benign distance is  tensor(96.5578, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  3.2773045897483826
distance x is tensor(79.4908, device='cuda:1')
benign distance is  tensor(79.4908, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.026398368179798
distance x is tensor(109.9655, device='cuda:1')
benign distance is  tensor(109.9655, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.161079205572605
distance x is tensor(115.9620, device='cuda:1')
benign distance is  tensor(115.9620, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.3406404480338097
distance x is tensor(88.3816, device='cuda:1')
benign distance is  tensor(88.3816, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.1931292042136192
distance x is tensor(120.3110, device='cuda:1')
benign distance is  tensor(120.3110, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  3.243061885237694
distance x is tensor(96.7687, device='cuda:1')
benign distance is  tensor(96.7687, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  3.0605563521385193
distance x is tensor(115.5100, device='cuda:1')
benign distance is  tensor(115.5100, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.2431506514549255
distance x is tensor(152.8166, device='cuda:1')
benign distance is  tensor(152.8166, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0., 21., 26.,  0.,  0.,  0.,  0.,  0.,  0., 21.,  2.,  0., 27., 26.,
        27., 27., 27.,  0.,  0., 27., 27.,  0., 27., 27., 27., 27., 27., 27.])
count_res tensor([1.4752e-13, 1.9455e-04, 2.8874e-02, 1.4752e-13, 1.4752e-13, 1.4752e-13,
        1.4752e-13, 1.4752e-13, 1.4752e-13, 1.9455e-04, 1.0900e-12, 1.4752e-13,
        7.8489e-02, 2.8874e-02, 7.8489e-02, 7.8489e-02, 7.8489e-02, 1.4752e-13,
        1.4752e-13, 7.8489e-02, 7.8489e-02, 1.4752e-13, 7.8489e-02, 7.8489e-02,
        7.8489e-02, 7.8489e-02, 7.8489e-02, 7.8489e-02])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 8.00% 

Test Accuracy: 55.32% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7968461476266384
distance x is tensor(142.5240, device='cuda:1')
benign distance is  tensor(142.5240, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.072139985859394
distance x is tensor(108.3156, device='cuda:1')
benign distance is  tensor(108.3156, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.902682587504387
distance x is tensor(98.9575, device='cuda:1')
benign distance is  tensor(98.9575, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4238300025463104
distance x is tensor(150.1519, device='cuda:1')
benign distance is  tensor(150.1519, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6559761464595795
distance x is tensor(114.7348, device='cuda:1')
benign distance is  tensor(114.7348, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3045810349285603
distance x is tensor(115.1323, device='cuda:1')
benign distance is  tensor(115.1323, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.6180195808410645
distance x is tensor(103.1701, device='cuda:1')
benign distance is  tensor(103.1701, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1248972937464714
distance x is tensor(99.1367, device='cuda:1')
benign distance is  tensor(99.1367, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9427732303738594
distance x is tensor(123.6295, device='cuda:1')
benign distance is  tensor(123.6295, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2673654183745384
distance x is tensor(112.8898, device='cuda:1')
benign distance is  tensor(112.8898, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.057128742337227
distance x is tensor(140.5473, device='cuda:1')
benign distance is  tensor(140.5473, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.122994154691696
distance x is tensor(120.6737, device='cuda:1')
benign distance is  tensor(120.6737, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.014454398304224
distance x is tensor(121.4063, device='cuda:1')
benign distance is  tensor(121.4063, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.81359151750803
distance x is tensor(100.7315, device='cuda:1')
benign distance is  tensor(100.7315, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.2609482631087303
distance x is tensor(99.5288, device='cuda:1')
benign distance is  tensor(99.5288, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8197758439928293
distance x is tensor(126.7934, device='cuda:1')
benign distance is  tensor(126.7934, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.6799147874116898
distance x is tensor(90.9935, device='cuda:1')
benign distance is  tensor(90.9935, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.0691674426198006
distance x is tensor(137.1335, device='cuda:1')
benign distance is  tensor(137.1335, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.8071049004793167
distance x is tensor(101.3551, device='cuda:1')
benign distance is  tensor(101.3551, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.7740986049175262
distance x is tensor(99.7843, device='cuda:1')
benign distance is  tensor(99.7843, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  3.3022242337465286
distance x is tensor(87.4180, device='cuda:1')
benign distance is  tensor(87.4180, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  1.9668031707406044
distance x is tensor(119.9245, device='cuda:1')
benign distance is  tensor(119.9245, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.3105176836252213
distance x is tensor(125.0799, device='cuda:1')
benign distance is  tensor(125.0799, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.5271807610988617
distance x is tensor(94.3509, device='cuda:1')
benign distance is  tensor(94.3509, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  3.4701497554779053
distance x is tensor(123.3000, device='cuda:1')
benign distance is  tensor(123.3000, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  3.279029920697212
distance x is tensor(108.6296, device='cuda:1')
benign distance is  tensor(108.6296, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.1555550768971443
distance x is tensor(121.6368, device='cuda:1')
benign distance is  tensor(121.6368, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.421048194169998
distance x is tensor(156.0751, device='cuda:1')
benign distance is  tensor(156.0751, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([ 0., 43., 43.,  0., 43., 43.,  0.,  0.,  0., 43., 43.,  0., 43., 43.,
        43.,  0.,  0.,  0., 43.,  1., 43., 43.,  1., 43., 43., 43., 43., 42.,
        43.,  4., 43., 43.,  0., 43.,  0., 35.,  0., 26.,  0.,  0.,  0.,  0.,
         0., 43.])
count_res tensor([9.8985e-21, 4.6798e-02, 4.6798e-02, 9.8985e-21, 4.6798e-02, 4.6798e-02,
        9.8985e-21, 9.8985e-21, 9.8985e-21, 4.6798e-02, 4.6798e-02, 9.8985e-21,
        4.6798e-02, 4.6798e-02, 4.6798e-02, 9.8985e-21, 9.8985e-21, 9.8985e-21,
        4.6798e-02, 2.6907e-20, 4.6798e-02, 4.6798e-02, 2.6907e-20, 4.6798e-02,
        4.6798e-02, 4.6798e-02, 4.6798e-02, 1.7216e-02, 4.6798e-02, 5.4044e-19,
        4.6798e-02, 4.6798e-02, 9.8985e-21, 4.6798e-02, 9.8985e-21, 1.5699e-05,
        9.8985e-21, 1.9374e-09, 9.8985e-21, 9.8985e-21, 9.8985e-21, 9.8985e-21,
        9.8985e-21, 4.6798e-02])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 12.99% 

Test Accuracy: 63.95% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8450482487678528
distance x is tensor(136.6204, device='cuda:1')
benign distance is  tensor(136.6204, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.529318153858185
distance x is tensor(103.0427, device='cuda:1')
benign distance is  tensor(103.0427, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.456203907728195
distance x is tensor(97.8502, device='cuda:1')
benign distance is  tensor(97.8502, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.560188814997673
distance x is tensor(141.7089, device='cuda:1')
benign distance is  tensor(141.7089, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.271821364760399
distance x is tensor(102.6979, device='cuda:1')
benign distance is  tensor(102.6979, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7138806283473969
distance x is tensor(110.6968, device='cuda:1')
benign distance is  tensor(110.6968, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.2678914815187454
distance x is tensor(99.3853, device='cuda:1')
benign distance is  tensor(99.3853, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.254763551056385
distance x is tensor(94.7192, device='cuda:1')
benign distance is  tensor(94.7192, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.839313842356205
distance x is tensor(98.6679, device='cuda:1')
benign distance is  tensor(98.6679, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9889806434512138
distance x is tensor(128.3461, device='cuda:1')
benign distance is  tensor(128.3461, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3241694271564484
distance x is tensor(81.3254, device='cuda:1')
benign distance is  tensor(81.3254, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.008195698261261
distance x is tensor(105.2527, device='cuda:1')
benign distance is  tensor(105.2527, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.2472823411226273
distance x is tensor(148.9099, device='cuda:1')
benign distance is  tensor(148.9099, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.833784557878971
distance x is tensor(72.7289, device='cuda:1')
benign distance is  tensor(72.7289, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9954244270920753
distance x is tensor(144.8636, device='cuda:1')
benign distance is  tensor(144.8636, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.065959885716438
distance x is tensor(119.4504, device='cuda:1')
benign distance is  tensor(119.4504, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.448705270886421
distance x is tensor(133.6917, device='cuda:1')
benign distance is  tensor(133.6917, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.5118259340524673
distance x is tensor(106.1898, device='cuda:1')
benign distance is  tensor(106.1898, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.9230305328965187
distance x is tensor(114.3008, device='cuda:1')
benign distance is  tensor(114.3008, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3243365064263344
distance x is tensor(125.0524, device='cuda:1')
benign distance is  tensor(125.0524, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.1032527685165405
distance x is tensor(91.1818, device='cuda:1')
benign distance is  tensor(91.1818, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.6207574158906937
distance x is tensor(208.7935, device='cuda:1')
benign distance is  tensor(208.7935, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9130183979868889
distance x is tensor(147.6481, device='cuda:1')
benign distance is  tensor(147.6481, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6294170022010803
distance x is tensor(122.8944, device='cuda:1')
benign distance is  tensor(122.8944, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.480061113834381
distance x is tensor(101.4262, device='cuda:1')
benign distance is  tensor(101.4262, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.9968325048685074
distance x is tensor(124.8339, device='cuda:1')
benign distance is  tensor(124.8339, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  3.2522606775164604
distance x is tensor(142.5552, device='cuda:1')
benign distance is  tensor(142.5552, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.291711576282978
distance x is tensor(88.2234, device='cuda:1')
benign distance is  tensor(88.2234, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.7543166354298592
distance x is tensor(154.4892, device='cuda:1')
benign distance is  tensor(154.4892, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.428722470998764
distance x is tensor(137.0334, device='cuda:1')
benign distance is  tensor(137.0334, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.4576131403446198
distance x is tensor(100.2290, device='cuda:1')
benign distance is  tensor(100.2290, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7242085840553045
distance x is tensor(134.4781, device='cuda:1')
benign distance is  tensor(134.4781, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.6134444028139114
distance x is tensor(91.4656, device='cuda:1')
benign distance is  tensor(91.4656, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.115007661283016
distance x is tensor(139.2929, device='cuda:1')
benign distance is  tensor(139.2929, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.784143403172493
distance x is tensor(89.9622, device='cuda:1')
benign distance is  tensor(89.9622, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.856161817908287
distance x is tensor(100.1611, device='cuda:1')
benign distance is  tensor(100.1611, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.8087290972471237
distance x is tensor(83.1354, device='cuda:1')
benign distance is  tensor(83.1354, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  1.9273283407092094
distance x is tensor(108.2717, device='cuda:1')
benign distance is  tensor(108.2717, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  1.7915830463171005
distance x is tensor(120.5329, device='cuda:1')
benign distance is  tensor(120.5329, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  3.0078250616788864
distance x is tensor(90.8029, device='cuda:1')
benign distance is  tensor(90.8029, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.83081516623497
distance x is tensor(121.1379, device='cuda:1')
benign distance is  tensor(121.1379, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.6086671501398087
distance x is tensor(98.1451, device='cuda:1')
benign distance is  tensor(98.1451, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.1204943284392357
distance x is tensor(109.7884, device='cuda:1')
benign distance is  tensor(109.7884, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.334124594926834
distance x is tensor(144.3125, device='cuda:1')
benign distance is  tensor(144.3125, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0., 19., 19.,  0., 19.,  0.,  0., 19.,  0., 19.,  6.,  0., 19., 19.,
        19.,  0., 17.,  7., 19., 19.])
count_res tensor([5.5280e-10, 9.8665e-02, 9.8665e-02, 5.5280e-10, 9.8665e-02, 5.5280e-10,
        5.5280e-10, 9.8665e-02, 5.5280e-10, 9.8665e-02, 2.2301e-07, 5.5280e-10,
        9.8665e-02, 9.8665e-02, 9.8665e-02, 5.5280e-10, 1.3353e-02, 6.0622e-07,
        9.8665e-02, 9.8665e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 17.08% 

Test Accuracy: 67.53% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7222980130463839
distance x is tensor(140.8212, device='cuda:1')
benign distance is  tensor(140.8212, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.8788968920707703
distance x is tensor(108.6609, device='cuda:1')
benign distance is  tensor(108.6609, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3491557836532593
distance x is tensor(103.8404, device='cuda:1')
benign distance is  tensor(103.8404, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.255072481930256
distance x is tensor(139.3896, device='cuda:1')
benign distance is  tensor(139.3896, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.278820715844631
distance x is tensor(97.0756, device='cuda:1')
benign distance is  tensor(97.0756, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.857667736709118
distance x is tensor(107.6212, device='cuda:1')
benign distance is  tensor(107.6212, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.9649733752012253
distance x is tensor(101.4140, device='cuda:1')
benign distance is  tensor(101.4140, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.119362987577915
distance x is tensor(93.3988, device='cuda:1')
benign distance is  tensor(93.3988, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.7087284624576569
distance x is tensor(91.9760, device='cuda:1')
benign distance is  tensor(91.9760, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.4314032569527626
distance x is tensor(136.4291, device='cuda:1')
benign distance is  tensor(136.4291, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.226223148405552
distance x is tensor(90.8428, device='cuda:1')
benign distance is  tensor(90.8428, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.6895225942134857
distance x is tensor(103.8497, device='cuda:1')
benign distance is  tensor(103.8497, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.7109703570604324
distance x is tensor(84.7525, device='cuda:1')
benign distance is  tensor(84.7525, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.1391453593969345
distance x is tensor(108.4142, device='cuda:1')
benign distance is  tensor(108.4142, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.5096773207187653
distance x is tensor(110.4027, device='cuda:1')
benign distance is  tensor(110.4027, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.670871838927269
distance x is tensor(91.5167, device='cuda:1')
benign distance is  tensor(91.5167, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  3.1287976652383804
distance x is tensor(118.4311, device='cuda:1')
benign distance is  tensor(118.4311, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  3.1910896748304367
distance x is tensor(98.6408, device='cuda:1')
benign distance is  tensor(98.6408, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.506377510726452
distance x is tensor(102.9885, device='cuda:1')
benign distance is  tensor(102.9885, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.3311586380004883
distance x is tensor(144.4740, device='cuda:1')
benign distance is  tensor(144.4740, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0., 35., 35., 35.,  0.,  0.,  0., 28., 35., 35., 35.,  0., 35., 35.,
        29.,  1.,  0.,  0.,  0., 35., 35.,  0., 35., 35.,  0., 30.,  0., 35.,
         0., 35., 35., 35.,  0.,  0.,  1., 35.])
count_res tensor([3.7067e-17, 5.8789e-02, 5.8789e-02, 5.8789e-02, 3.7067e-17, 3.7067e-17,
        3.7067e-17, 5.3608e-05, 5.8789e-02, 5.8789e-02, 5.8789e-02, 3.7067e-17,
        5.8789e-02, 5.8789e-02, 1.4572e-04, 1.0076e-16, 3.7067e-17, 3.7067e-17,
        3.7067e-17, 5.8789e-02, 5.8789e-02, 3.7067e-17, 5.8789e-02, 5.8789e-02,
        3.7067e-17, 3.9611e-04, 3.7067e-17, 5.8789e-02, 3.7067e-17, 5.8789e-02,
        5.8789e-02, 5.8789e-02, 3.7067e-17, 3.7067e-17, 1.0076e-16, 5.8789e-02])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 18.78% 

Test Accuracy: 66.31% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8356270529329777
distance x is tensor(135.1087, device='cuda:1')
benign distance is  tensor(135.1087, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.0428005903959274
distance x is tensor(103.0807, device='cuda:1')
benign distance is  tensor(103.0807, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.5729898139834404
distance x is tensor(102.4439, device='cuda:1')
benign distance is  tensor(102.4439, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.360367603600025
distance x is tensor(137.3062, device='cuda:1')
benign distance is  tensor(137.3062, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2448464184999466
distance x is tensor(97.8144, device='cuda:1')
benign distance is  tensor(97.8144, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6923687160015106
distance x is tensor(102.1899, device='cuda:1')
benign distance is  tensor(102.1899, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.756721645593643
distance x is tensor(100.9021, device='cuda:1')
benign distance is  tensor(100.9021, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9011839479207993
distance x is tensor(95.3668, device='cuda:1')
benign distance is  tensor(95.3668, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.2953724339604378
distance x is tensor(99.9002, device='cuda:1')
benign distance is  tensor(99.9002, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.1123695746064186
distance x is tensor(123.7298, device='cuda:1')
benign distance is  tensor(123.7298, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.8118826597929
distance x is tensor(78.1579, device='cuda:1')
benign distance is  tensor(78.1579, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.0744794756174088
distance x is tensor(101.1066, device='cuda:1')
benign distance is  tensor(101.1066, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.546672008931637
distance x is tensor(150.8266, device='cuda:1')
benign distance is  tensor(150.8266, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.246751680970192
distance x is tensor(72.9106, device='cuda:1')
benign distance is  tensor(72.9106, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.87605170160532
distance x is tensor(141.7418, device='cuda:1')
benign distance is  tensor(141.7418, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.54678313434124
distance x is tensor(105.6314, device='cuda:1')
benign distance is  tensor(105.6314, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.911051630973816
distance x is tensor(110.2955, device='cuda:1')
benign distance is  tensor(110.2955, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.7894175052642822
distance x is tensor(76.7614, device='cuda:1')
benign distance is  tensor(76.7614, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.0721209719777107
distance x is tensor(120.7310, device='cuda:1')
benign distance is  tensor(120.7310, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.9607203155755997
distance x is tensor(96.1797, device='cuda:1')
benign distance is  tensor(96.1797, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.9822336956858635
distance x is tensor(117.5390, device='cuda:1')
benign distance is  tensor(117.5390, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.229367271065712
distance x is tensor(108.1498, device='cuda:1')
benign distance is  tensor(108.1498, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6016800319775939
distance x is tensor(116.7193, device='cuda:1')
benign distance is  tensor(116.7193, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.786513939499855
distance x is tensor(152.2864, device='cuda:1')
benign distance is  tensor(152.2864, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.4137381687760353
distance x is tensor(81.5960, device='cuda:1')
benign distance is  tensor(81.5960, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.7757666558027267
distance x is tensor(130.5856, device='cuda:1')
benign distance is  tensor(130.5856, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.762907937169075
distance x is tensor(92.6353, device='cuda:1')
benign distance is  tensor(92.6353, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  3.910104811191559
distance x is tensor(83.9564, device='cuda:1')
benign distance is  tensor(83.9564, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.9427145421504974
distance x is tensor(80.3533, device='cuda:1')
benign distance is  tensor(80.3533, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.4208803921937943
distance x is tensor(110.3096, device='cuda:1')
benign distance is  tensor(110.3096, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.275199234485626
distance x is tensor(113.5630, device='cuda:1')
benign distance is  tensor(113.5630, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.455866165459156
distance x is tensor(85.1457, device='cuda:1')
benign distance is  tensor(85.1457, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  3.6247835010290146
distance x is tensor(127.2167, device='cuda:1')
benign distance is  tensor(127.2167, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  3.2618802934885025
distance x is tensor(100.7195, device='cuda:1')
benign distance is  tensor(100.7195, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.145536854863167
distance x is tensor(122.0716, device='cuda:1')
benign distance is  tensor(122.0716, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.5410088300704956
distance x is tensor(149.6122, device='cuda:1')
benign distance is  tensor(149.6122, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  1., 27., 24.,  0.,  0.,  0.,  0.,  0.,  1., 27.,  0., 27.,  3.,
        26., 26., 27., 26., 27., 27., 27.,  1., 27., 27., 15., 27.,  0., 27.])
count_res tensor([1.5465e-13, 4.2038e-13, 8.2281e-02, 4.0965e-03, 1.5465e-13, 1.5465e-13,
        1.5465e-13, 1.5465e-13, 1.5465e-13, 4.2038e-13, 8.2281e-02, 1.5465e-13,
        8.2281e-02, 3.1062e-12, 3.0270e-02, 3.0270e-02, 8.2281e-02, 3.0270e-02,
        8.2281e-02, 8.2281e-02, 8.2281e-02, 4.2038e-13, 8.2281e-02, 8.2281e-02,
        5.0555e-07, 8.2281e-02, 1.5465e-13, 8.2281e-02])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 23.39% 

Test Accuracy: 69.42% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7201128471642733
distance x is tensor(131.9945, device='cuda:1')
benign distance is  tensor(131.9945, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.351299501955509
distance x is tensor(105.9332, device='cuda:1')
benign distance is  tensor(105.9332, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.610011115670204
distance x is tensor(102.0449, device='cuda:1')
benign distance is  tensor(102.0449, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.930270195007324
distance x is tensor(140.3634, device='cuda:1')
benign distance is  tensor(140.3634, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8955753147602081
distance x is tensor(104.8367, device='cuda:1')
benign distance is  tensor(104.8367, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.148495130240917
distance x is tensor(104.4874, device='cuda:1')
benign distance is  tensor(104.4874, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.599209241569042
distance x is tensor(91.8946, device='cuda:1')
benign distance is  tensor(91.8946, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.182613119482994
distance x is tensor(90.0815, device='cuda:1')
benign distance is  tensor(90.0815, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.358102336525917
distance x is tensor(86.1693, device='cuda:1')
benign distance is  tensor(86.1693, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.719769462943077
distance x is tensor(107.6908, device='cuda:1')
benign distance is  tensor(107.6908, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5525555163621902
distance x is tensor(114.1935, device='cuda:1')
benign distance is  tensor(114.1935, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.443037360906601
distance x is tensor(111.6014, device='cuda:1')
benign distance is  tensor(111.6014, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.1269059404730797
distance x is tensor(85.8423, device='cuda:1')
benign distance is  tensor(85.8423, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.747255139052868
distance x is tensor(199.9147, device='cuda:1')
benign distance is  tensor(199.9147, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9057181850075722
distance x is tensor(148.0065, device='cuda:1')
benign distance is  tensor(148.0065, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.9225116223096848
distance x is tensor(111.9641, device='cuda:1')
benign distance is  tensor(111.9641, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.465058743953705
distance x is tensor(80.4093, device='cuda:1')
benign distance is  tensor(80.4093, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.253786578774452
distance x is tensor(128.8254, device='cuda:1')
benign distance is  tensor(128.8254, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.558092452585697
distance x is tensor(92.2542, device='cuda:1')
benign distance is  tensor(92.2542, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  3.0733176916837692
distance x is tensor(96.6697, device='cuda:1')
benign distance is  tensor(96.6697, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.4479681476950645
distance x is tensor(79.2282, device='cuda:1')
benign distance is  tensor(79.2282, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.070090502500534
distance x is tensor(105.6236, device='cuda:1')
benign distance is  tensor(105.6236, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.3888271152973175
distance x is tensor(112.1517, device='cuda:1')
benign distance is  tensor(112.1517, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.7745736688375473
distance x is tensor(86.4578, device='cuda:1')
benign distance is  tensor(86.4578, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.716032028198242
distance x is tensor(113.4408, device='cuda:1')
benign distance is  tensor(113.4408, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.8418418020009995
distance x is tensor(98.4428, device='cuda:1')
benign distance is  tensor(98.4428, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.4213114604353905
distance x is tensor(109.6986, device='cuda:1')
benign distance is  tensor(109.6986, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.451460935175419
distance x is tensor(140.1837, device='cuda:1')
benign distance is  tensor(140.1837, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0., 35., 35.,  0., 34.,  0.,  0.,  0.,  0., 35., 34.,  0., 35., 35.,
        23.,  0.,  0.,  0., 29., 12., 35., 35., 35.,  0., 35., 35., 35., 35.,
         0.,  0.,  0., 35., 35.,  2., 35., 25.])
count_res tensor([4.0062e-17, 6.3539e-02, 6.3539e-02, 4.0062e-17, 2.3375e-02, 4.0062e-17,
        4.0062e-17, 4.0062e-17, 4.0062e-17, 6.3539e-02, 2.3375e-02, 4.0062e-17,
        6.3539e-02, 6.3539e-02, 3.9040e-07, 4.0062e-17, 4.0062e-17, 4.0062e-17,
        1.5750e-04, 6.5203e-12, 6.3539e-02, 6.3539e-02, 6.3539e-02, 4.0062e-17,
        6.3539e-02, 6.3539e-02, 6.3539e-02, 6.3539e-02, 4.0062e-17, 4.0062e-17,
        4.0062e-17, 6.3539e-02, 6.3539e-02, 2.9602e-16, 6.3539e-02, 2.8847e-06])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 41.13% 

Test Accuracy: 74.64% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7771743535995483
distance x is tensor(127.0732, device='cuda:1')
benign distance is  tensor(127.0732, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5803260505199432
distance x is tensor(103.3133, device='cuda:1')
benign distance is  tensor(103.3133, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9373721182346344
distance x is tensor(105.2305, device='cuda:1')
benign distance is  tensor(105.2305, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3145852088928223
distance x is tensor(143.2092, device='cuda:1')
benign distance is  tensor(143.2092, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6811640113592148
distance x is tensor(96.2162, device='cuda:1')
benign distance is  tensor(96.2162, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7163679376244545
distance x is tensor(105.2484, device='cuda:1')
benign distance is  tensor(105.2484, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0974059104919434
distance x is tensor(94.8120, device='cuda:1')
benign distance is  tensor(94.8120, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7377617806196213
distance x is tensor(88.7792, device='cuda:1')
benign distance is  tensor(88.7792, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.17251069098711
distance x is tensor(100.6321, device='cuda:1')
benign distance is  tensor(100.6321, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.5568621307611465
distance x is tensor(124.0196, device='cuda:1')
benign distance is  tensor(124.0196, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.120069295167923
distance x is tensor(73.1187, device='cuda:1')
benign distance is  tensor(73.1187, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.0045298486948013
distance x is tensor(97.1263, device='cuda:1')
benign distance is  tensor(97.1263, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.086179994046688
distance x is tensor(146.7586, device='cuda:1')
benign distance is  tensor(146.7586, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9980877786874771
distance x is tensor(66.7115, device='cuda:1')
benign distance is  tensor(66.7115, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.235745869576931
distance x is tensor(131.8468, device='cuda:1')
benign distance is  tensor(131.8468, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.6454426422715187
distance x is tensor(114.4728, device='cuda:1')
benign distance is  tensor(114.4728, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8399126157164574
distance x is tensor(118.4928, device='cuda:1')
benign distance is  tensor(118.4928, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.151095323264599
distance x is tensor(101.4619, device='cuda:1')
benign distance is  tensor(101.4619, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.7390268668532372
distance x is tensor(129.1892, device='cuda:1')
benign distance is  tensor(129.1892, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.969135269522667
distance x is tensor(110.0658, device='cuda:1')
benign distance is  tensor(110.0658, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9916783384978771
distance x is tensor(119.4785, device='cuda:1')
benign distance is  tensor(119.4785, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9062871038913727
distance x is tensor(84.9716, device='cuda:1')
benign distance is  tensor(84.9716, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.8670023009181023
distance x is tensor(84.6124, device='cuda:1')
benign distance is  tensor(84.6124, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0752396322786808
distance x is tensor(118.5543, device='cuda:1')
benign distance is  tensor(118.5543, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.9830877780914307
distance x is tensor(83.0486, device='cuda:1')
benign distance is  tensor(83.0486, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.184615470468998
distance x is tensor(134.2391, device='cuda:1')
benign distance is  tensor(134.2391, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.2122781425714493
distance x is tensor(90.0348, device='cuda:1')
benign distance is  tensor(90.0348, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.4996415078639984
distance x is tensor(94.4711, device='cuda:1')
benign distance is  tensor(94.4711, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.3776940181851387
distance x is tensor(81.1389, device='cuda:1')
benign distance is  tensor(81.1389, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  1.8446034863591194
distance x is tensor(104.5793, device='cuda:1')
benign distance is  tensor(104.5793, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  1.865826465189457
distance x is tensor(109.4518, device='cuda:1')
benign distance is  tensor(109.4518, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.467096984386444
distance x is tensor(90.9558, device='cuda:1')
benign distance is  tensor(90.9558, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.317574694752693
distance x is tensor(114.2460, device='cuda:1')
benign distance is  tensor(114.2460, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.500384271144867
distance x is tensor(99.9645, device='cuda:1')
benign distance is  tensor(99.9645, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  1.7901728749275208
distance x is tensor(107.2814, device='cuda:1')
benign distance is  tensor(107.2814, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.3929705694317818
distance x is tensor(145.0790, device='cuda:1')
benign distance is  tensor(145.0790, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0., 19., 19., 19.,  0.,  0.,  0., 19., 18.,  0., 19., 13., 19.,  0.,
        15.,  1., 19.,  2., 19., 19.])
count_res tensor([5.9676e-10, 1.0651e-01, 1.0651e-01, 1.0651e-01, 5.9676e-10, 5.9676e-10,
        5.9676e-10, 1.0651e-01, 3.9183e-02, 5.9676e-10, 1.0651e-01, 2.6402e-04,
        1.0651e-01, 5.9676e-10, 1.9508e-03, 1.6222e-09, 1.0651e-01, 4.4095e-09,
        1.0651e-01, 1.0651e-01])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 28.37% 

Test Accuracy: 71.43% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.850687688216567
distance x is tensor(140.9189, device='cuda:1')
benign distance is  tensor(140.9189, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.9904052391648293
distance x is tensor(103.3098, device='cuda:1')
benign distance is  tensor(103.3098, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.304280810058117
distance x is tensor(105.2601, device='cuda:1')
benign distance is  tensor(105.2601, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.147439479827881
distance x is tensor(140.5758, device='cuda:1')
benign distance is  tensor(140.5758, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.078764721751213
distance x is tensor(99.2289, device='cuda:1')
benign distance is  tensor(99.2289, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.595082864165306
distance x is tensor(109.2446, device='cuda:1')
benign distance is  tensor(109.2446, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.6021188348531723
distance x is tensor(96.0677, device='cuda:1')
benign distance is  tensor(96.0677, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.976993851363659
distance x is tensor(92.4805, device='cuda:1')
benign distance is  tensor(92.4805, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.3422564268112183
distance x is tensor(81.1105, device='cuda:1')
benign distance is  tensor(81.1105, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.0363185554742813
distance x is tensor(134.9845, device='cuda:1')
benign distance is  tensor(134.9845, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  3.113742455840111
distance x is tensor(97.1596, device='cuda:1')
benign distance is  tensor(97.1596, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.8228041231632233
distance x is tensor(96.3814, device='cuda:1')
benign distance is  tensor(96.3814, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.8548317700624466
distance x is tensor(80.0992, device='cuda:1')
benign distance is  tensor(80.0992, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.0363966897130013
distance x is tensor(107.7978, device='cuda:1')
benign distance is  tensor(107.7978, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  1.825975514948368
distance x is tensor(113.7368, device='cuda:1')
benign distance is  tensor(113.7368, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.6734979301691055
distance x is tensor(93.5200, device='cuda:1')
benign distance is  tensor(93.5200, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.917025737464428
distance x is tensor(115.6870, device='cuda:1')
benign distance is  tensor(115.6870, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.247382700443268
distance x is tensor(96.1505, device='cuda:1')
benign distance is  tensor(96.1505, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.4315384700894356
distance x is tensor(103.9472, device='cuda:1')
benign distance is  tensor(103.9472, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.2748159617185593
distance x is tensor(155.3520, device='cuda:1')
benign distance is  tensor(155.3520, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([ 0., 51., 51.,  0.,  0.,  0., 51.,  0.,  0., 51., 51., 51., 51., 51.,
        51.,  0.,  0., 51.,  0., 50., 51., 51.,  0., 51.,  0., 51., 51., 51.,
        51.,  0., 44.,  2., 51., 51., 11., 48.,  0., 51.,  7., 51.,  0.,  0.,
         0., 51.,  0., 51., 18.,  0.,  0.,  0.,  0., 51.])
count_res tensor([2.9058e-24, 4.0952e-02, 4.0952e-02, 2.9058e-24, 2.9058e-24, 2.9058e-24,
        4.0952e-02, 2.9058e-24, 2.9058e-24, 4.0952e-02, 4.0952e-02, 4.0952e-02,
        4.0952e-02, 4.0952e-02, 4.0952e-02, 2.9058e-24, 2.9058e-24, 4.0952e-02,
        2.9058e-24, 1.5066e-02, 4.0952e-02, 4.0952e-02, 2.9058e-24, 4.0952e-02,
        2.9058e-24, 4.0952e-02, 4.0952e-02, 4.0952e-02, 4.0952e-02, 2.9058e-24,
        3.7344e-05, 2.1471e-23, 4.0952e-02, 4.0952e-02, 1.7398e-19, 2.0389e-03,
        2.9058e-24, 4.0952e-02, 3.1866e-21, 4.0952e-02, 2.9058e-24, 2.9058e-24,
        2.9058e-24, 4.0952e-02, 2.9058e-24, 4.0952e-02, 1.9079e-16, 2.9058e-24,
        2.9058e-24, 2.9058e-24, 2.9058e-24, 4.0952e-02])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 39.34% 

Test Accuracy: 74.74% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.747261231765151
distance x is tensor(131.3468, device='cuda:1')
benign distance is  tensor(131.3468, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0202676355838776
distance x is tensor(104.8280, device='cuda:1')
benign distance is  tensor(104.8280, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.7464835196733475
distance x is tensor(107.1153, device='cuda:1')
benign distance is  tensor(107.1153, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3112587109208107
distance x is tensor(143.8142, device='cuda:1')
benign distance is  tensor(143.8142, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8409515395760536
distance x is tensor(97.7787, device='cuda:1')
benign distance is  tensor(97.7787, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8697888553142548
distance x is tensor(111.5125, device='cuda:1')
benign distance is  tensor(111.5125, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0671192705631256
distance x is tensor(96.8339, device='cuda:1')
benign distance is  tensor(96.8339, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0260658971965313
distance x is tensor(87.2407, device='cuda:1')
benign distance is  tensor(87.2407, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.0180640146136284
distance x is tensor(95.2144, device='cuda:1')
benign distance is  tensor(95.2144, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9049096405506134
distance x is tensor(118.1544, device='cuda:1')
benign distance is  tensor(118.1544, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.5720913037657738
distance x is tensor(78.9020, device='cuda:1')
benign distance is  tensor(78.9020, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.1424209475517273
distance x is tensor(106.2764, device='cuda:1')
benign distance is  tensor(106.2764, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.786872163414955
distance x is tensor(185.0391, device='cuda:1')
benign distance is  tensor(185.0391, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9076733887195587
distance x is tensor(61.5227, device='cuda:1')
benign distance is  tensor(61.5227, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.0866157934069633
distance x is tensor(133.5232, device='cuda:1')
benign distance is  tensor(133.5232, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.1871524155139923
distance x is tensor(106.8975, device='cuda:1')
benign distance is  tensor(106.8975, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.6627473905682564
distance x is tensor(99.2294, device='cuda:1')
benign distance is  tensor(99.2294, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.8472763523459435
distance x is tensor(100.0557, device='cuda:1')
benign distance is  tensor(100.0557, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.937386967241764
distance x is tensor(113.3212, device='cuda:1')
benign distance is  tensor(113.3212, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7409692108631134
distance x is tensor(117.3451, device='cuda:1')
benign distance is  tensor(117.3451, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.6856682524085045
distance x is tensor(76.7819, device='cuda:1')
benign distance is  tensor(76.7819, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3652901165187359
distance x is tensor(193.2574, device='cuda:1')
benign distance is  tensor(193.2574, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7284115627408028
distance x is tensor(141.9720, device='cuda:1')
benign distance is  tensor(141.9720, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7263304330408573
distance x is tensor(116.5893, device='cuda:1')
benign distance is  tensor(116.5893, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.2560759112238884
distance x is tensor(106.6874, device='cuda:1')
benign distance is  tensor(106.6874, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.0323138162493706
distance x is tensor(82.6647, device='cuda:1')
benign distance is  tensor(82.6647, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.1798091381788254
distance x is tensor(119.9070, device='cuda:1')
benign distance is  tensor(119.9070, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.921133928000927
distance x is tensor(101.4231, device='cuda:1')
benign distance is  tensor(101.4231, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.7103448286652565
distance x is tensor(115.7030, device='cuda:1')
benign distance is  tensor(115.7030, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.9892623648047447
distance x is tensor(99.4934, device='cuda:1')
benign distance is  tensor(99.4934, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6138268057256937
distance x is tensor(123.5340, device='cuda:1')
benign distance is  tensor(123.5340, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.3817588165402412
distance x is tensor(161.3560, device='cuda:1')
benign distance is  tensor(161.3560, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.770175486803055
distance x is tensor(97.5806, device='cuda:1')
benign distance is  tensor(97.5806, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.383124217391014
distance x is tensor(124.3831, device='cuda:1')
benign distance is  tensor(124.3831, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.3695571795105934
distance x is tensor(132.9235, device='cuda:1')
benign distance is  tensor(132.9235, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.2124168276786804
distance x is tensor(86.9766, device='cuda:1')
benign distance is  tensor(86.9766, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.6367475353181362
distance x is tensor(152.2765, device='cuda:1')
benign distance is  tensor(152.2765, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.9850712269544601
distance x is tensor(123.3799, device='cuda:1')
benign distance is  tensor(123.3799, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.333582431077957
distance x is tensor(93.0526, device='cuda:1')
benign distance is  tensor(93.0526, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6372419130057096
distance x is tensor(133.1441, device='cuda:1')
benign distance is  tensor(133.1441, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.01725947111845
distance x is tensor(84.0379, device='cuda:1')
benign distance is  tensor(84.0379, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.61941546946764
distance x is tensor(131.4413, device='cuda:1')
benign distance is  tensor(131.4413, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.4483360424637794
distance x is tensor(94.1904, device='cuda:1')
benign distance is  tensor(94.1904, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.6768642514944077
distance x is tensor(111.6988, device='cuda:1')
benign distance is  tensor(111.6988, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.366120971739292
distance x is tensor(78.5983, device='cuda:1')
benign distance is  tensor(78.5983, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.0749774128198624
distance x is tensor(110.1084, device='cuda:1')
benign distance is  tensor(110.1084, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  1.949719376862049
distance x is tensor(116.4311, device='cuda:1')
benign distance is  tensor(116.4311, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.2388712614774704
distance x is tensor(96.1659, device='cuda:1')
benign distance is  tensor(96.1659, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.3552965074777603
distance x is tensor(122.9093, device='cuda:1')
benign distance is  tensor(122.9093, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.189810872077942
distance x is tensor(95.8109, device='cuda:1')
benign distance is  tensor(95.8109, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  1.9459451660513878
distance x is tensor(107.3812, device='cuda:1')
benign distance is  tensor(107.3812, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  1.8810131922364235
distance x is tensor(146.0367, device='cuda:1')
benign distance is  tensor(146.0367, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0., 19., 19., 19.,  1.,  0.,  1.,  1.,  5.,  0.,  8.,  5., 19., 12.,
        19., 18., 19., 18., 19., 18.])
count_res tensor([6.9131e-10, 1.2339e-01, 1.2339e-01, 1.2339e-01, 1.8792e-09, 6.9131e-10,
        1.8792e-09, 1.8792e-09, 1.0260e-07, 6.9131e-10, 2.0608e-06, 1.0260e-07,
        1.2339e-01, 1.1251e-04, 1.2339e-01, 4.5392e-02, 1.2339e-01, 4.5392e-02,
        1.2339e-01, 4.5392e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 27.68% 

Test Accuracy: 71.06% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7349075637757778
distance x is tensor(132.0225, device='cuda:1')
benign distance is  tensor(132.0225, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2304591983556747
distance x is tensor(103.5923, device='cuda:1')
benign distance is  tensor(103.5923, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.1638612374663353
distance x is tensor(105.0936, device='cuda:1')
benign distance is  tensor(105.0936, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4881329983472824
distance x is tensor(143.5850, device='cuda:1')
benign distance is  tensor(143.5850, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9172800108790398
distance x is tensor(109.2745, device='cuda:1')
benign distance is  tensor(109.2745, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7604370787739754
distance x is tensor(106.4012, device='cuda:1')
benign distance is  tensor(106.4012, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9045237749814987
distance x is tensor(96.9049, device='cuda:1')
benign distance is  tensor(96.9049, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.238142117857933
distance x is tensor(94.3255, device='cuda:1')
benign distance is  tensor(94.3255, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.9904874339699745
distance x is tensor(82.2713, device='cuda:1')
benign distance is  tensor(82.2713, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.5660319551825523
distance x is tensor(135.7249, device='cuda:1')
benign distance is  tensor(135.7249, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.1284601762890816
distance x is tensor(91.5151, device='cuda:1')
benign distance is  tensor(91.5151, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.936675801873207
distance x is tensor(92.4563, device='cuda:1')
benign distance is  tensor(92.4563, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  3.0837606340646744
distance x is tensor(78.6964, device='cuda:1')
benign distance is  tensor(78.6964, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  2.3121904730796814
distance x is tensor(106.7599, device='cuda:1')
benign distance is  tensor(106.7599, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  1.9710714891552925
distance x is tensor(116.3678, device='cuda:1')
benign distance is  tensor(116.3678, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.438993737101555
distance x is tensor(92.4213, device='cuda:1')
benign distance is  tensor(92.4213, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  3.0737066566944122
distance x is tensor(112.4232, device='cuda:1')
benign distance is  tensor(112.4232, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.8146491199731827
distance x is tensor(93.1175, device='cuda:1')
benign distance is  tensor(93.1175, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.224722132086754
distance x is tensor(102.9814, device='cuda:1')
benign distance is  tensor(102.9814, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.657097242772579
distance x is tensor(146.6381, device='cuda:1')
benign distance is  tensor(146.6381, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0., 27., 27., 23., 26.,  0., 24., 27.,  0., 27., 27.,  0., 27.,  6.,
        20., 27., 27.,  4., 25.,  3.,  5.,  0., 14.,  0.,  0., 27.,  0., 27.])
count_res tensor([1.7778e-13, 9.4587e-02, 9.4587e-02, 1.7324e-03, 3.4797e-02, 1.7778e-13,
        4.7092e-03, 9.4587e-02, 1.7778e-13, 9.4587e-02, 9.4587e-02, 1.7778e-13,
        9.4587e-02, 7.1721e-11, 8.6253e-05, 9.4587e-02, 9.4587e-02, 9.7064e-12,
        1.2801e-02, 3.5708e-12, 2.6385e-11, 1.7778e-13, 2.1380e-07, 1.7778e-13,
        1.7778e-13, 9.4587e-02, 1.7778e-13, 9.4587e-02])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 30.27% 

Test Accuracy: 71.32% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9036907814443111
distance x is tensor(130.6414, device='cuda:1')
benign distance is  tensor(130.6414, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0644868314266205
distance x is tensor(107.8423, device='cuda:1')
benign distance is  tensor(107.8423, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.416849248111248
distance x is tensor(106.4366, device='cuda:1')
benign distance is  tensor(106.4366, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3602855280041695
distance x is tensor(144.4505, device='cuda:1')
benign distance is  tensor(144.4505, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.01777945458889
distance x is tensor(104.4212, device='cuda:1')
benign distance is  tensor(104.4212, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7404024749994278
distance x is tensor(109.9642, device='cuda:1')
benign distance is  tensor(109.9642, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.773210570216179
distance x is tensor(91.4145, device='cuda:1')
benign distance is  tensor(91.4145, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2359689250588417
distance x is tensor(91.6734, device='cuda:1')
benign distance is  tensor(91.6734, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9271951094269753
distance x is tensor(101.8412, device='cuda:1')
benign distance is  tensor(101.8412, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.661518257111311
distance x is tensor(115.0808, device='cuda:1')
benign distance is  tensor(115.0808, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.74564827978611
distance x is tensor(78.5909, device='cuda:1')
benign distance is  tensor(78.5909, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.978367269039154
distance x is tensor(101.1932, device='cuda:1')
benign distance is  tensor(101.1932, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.129879452288151
distance x is tensor(200.3563, device='cuda:1')
benign distance is  tensor(200.3563, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8228583820164204
distance x is tensor(64.8147, device='cuda:1')
benign distance is  tensor(64.8147, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6579570658504963
distance x is tensor(139.8746, device='cuda:1')
benign distance is  tensor(139.8746, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.7198869585990906
distance x is tensor(107.6301, device='cuda:1')
benign distance is  tensor(107.6301, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  2.336498700082302
distance x is tensor(84.9273, device='cuda:1')
benign distance is  tensor(84.9273, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.3762989789247513
distance x is tensor(132.4112, device='cuda:1')
benign distance is  tensor(132.4112, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  3.3515428751707077
distance x is tensor(87.0403, device='cuda:1')
benign distance is  tensor(87.0403, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.491467699408531
distance x is tensor(123.1190, device='cuda:1')
benign distance is  tensor(123.1190, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.6091184318065643
distance x is tensor(73.9724, device='cuda:1')
benign distance is  tensor(73.9724, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  1.8095049485564232
distance x is tensor(114.8001, device='cuda:1')
benign distance is  tensor(114.8001, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  1.8449697345495224
distance x is tensor(119.8989, device='cuda:1')
benign distance is  tensor(119.8989, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  2.1397414058446884
distance x is tensor(86.9477, device='cuda:1')
benign distance is  tensor(86.9477, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  3.541769117116928
distance x is tensor(115.3673, device='cuda:1')
benign distance is  tensor(115.3673, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.8515236377716064
distance x is tensor(99.7155, device='cuda:1')
benign distance is  tensor(99.7155, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.1456829980015755
distance x is tensor(104.0883, device='cuda:1')
benign distance is  tensor(104.0883, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.7855279371142387
distance x is tensor(145.0442, device='cuda:1')
benign distance is  tensor(145.0442, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0., 35., 35., 31., 20.,  0.,  0.,  0.,  0.,  0.,  0., 35., 30., 16.,
        35., 20.,  0.,  0., 35., 35., 35.,  0., 35., 35., 35.,  0., 35., 35.,
         6.,  1., 35., 35.,  0., 35.,  0., 35.])
count_res tensor([3.9345e-17, 6.2402e-02, 6.2402e-02, 1.1429e-03, 1.9089e-08, 3.9345e-17,
        3.9345e-17, 3.9345e-17, 3.9345e-17, 3.9345e-17, 3.9345e-17, 6.2402e-02,
        4.2046e-04, 3.4963e-10, 6.2402e-02, 1.9089e-08, 3.9345e-17, 3.9345e-17,
        6.2402e-02, 6.2402e-02, 6.2402e-02, 3.9345e-17, 6.2402e-02, 6.2402e-02,
        6.2402e-02, 3.9345e-17, 6.2402e-02, 6.2402e-02, 1.5873e-14, 1.0695e-16,
        6.2402e-02, 6.2402e-02, 3.9345e-17, 6.2402e-02, 3.9345e-17, 6.2402e-02])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 46.49% 

Test Accuracy: 76.77% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8527413606643677
distance x is tensor(131.2091, device='cuda:1')
benign distance is  tensor(131.2091, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.9035948738455772
distance x is tensor(98.7680, device='cuda:1')
benign distance is  tensor(98.7680, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4753499701619148
distance x is tensor(103.2559, device='cuda:1')
benign distance is  tensor(103.2559, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.004047803580761
distance x is tensor(139.4718, device='cuda:1')
benign distance is  tensor(139.4718, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5196154452860355
distance x is tensor(101.4852, device='cuda:1')
benign distance is  tensor(101.4852, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.329627525061369
distance x is tensor(108.1858, device='cuda:1')
benign distance is  tensor(108.1858, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.362656593322754
distance x is tensor(94.4990, device='cuda:1')
benign distance is  tensor(94.4990, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6700951531529427
distance x is tensor(90.6855, device='cuda:1')
benign distance is  tensor(90.6855, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.8369486778974533
distance x is tensor(112.4119, device='cuda:1')
benign distance is  tensor(112.4119, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.553754098713398
distance x is tensor(104.1618, device='cuda:1')
benign distance is  tensor(104.1618, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.010508619248867
distance x is tensor(110.0916, device='cuda:1')
benign distance is  tensor(110.0916, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5026094317436218
distance x is tensor(113.7985, device='cuda:1')
benign distance is  tensor(113.7985, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.0868228152394295
distance x is tensor(73.5249, device='cuda:1')
benign distance is  tensor(73.5249, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2882068380713463
distance x is tensor(197.2488, device='cuda:1')
benign distance is  tensor(197.2488, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3898627050220966
distance x is tensor(145.7659, device='cuda:1')
benign distance is  tensor(145.7659, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7403631918132305
distance x is tensor(111.5326, device='cuda:1')
benign distance is  tensor(111.5326, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9388466142117977
distance x is tensor(124.4877, device='cuda:1')
benign distance is  tensor(124.4877, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.8853126987814903
distance x is tensor(90.9731, device='cuda:1')
benign distance is  tensor(90.9731, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.6744714304804802
distance x is tensor(130.8943, device='cuda:1')
benign distance is  tensor(130.8943, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.723928563296795
distance x is tensor(113.1125, device='cuda:1')
benign distance is  tensor(113.1125, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7002406567335129
distance x is tensor(120.0867, device='cuda:1')
benign distance is  tensor(120.0867, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.6301219277083874
distance x is tensor(85.7790, device='cuda:1')
benign distance is  tensor(85.7790, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.939942054450512
distance x is tensor(85.2682, device='cuda:1')
benign distance is  tensor(85.2682, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8402665872126818
distance x is tensor(121.0061, device='cuda:1')
benign distance is  tensor(121.0061, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.8638904392719269
distance x is tensor(81.2406, device='cuda:1')
benign distance is  tensor(81.2406, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  1.5562353730201721
distance x is tensor(139.5885, device='cuda:1')
benign distance is  tensor(139.5885, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.015960305929184
distance x is tensor(98.1505, device='cuda:1')
benign distance is  tensor(98.1505, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.5479903295636177
distance x is tensor(90.8961, device='cuda:1')
benign distance is  tensor(90.8961, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  1.9927909448742867
distance x is tensor(83.5353, device='cuda:1')
benign distance is  tensor(83.5353, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  1.547031208872795
distance x is tensor(112.7069, device='cuda:1')
benign distance is  tensor(112.7069, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  2.1973880380392075
distance x is tensor(113.4081, device='cuda:1')
benign distance is  tensor(113.4081, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  1.9160038530826569
distance x is tensor(87.0740, device='cuda:1')
benign distance is  tensor(87.0740, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.044849783182144
distance x is tensor(120.2159, device='cuda:1')
benign distance is  tensor(120.2159, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.12457262724638
distance x is tensor(92.5375, device='cuda:1')
benign distance is  tensor(92.5375, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  1.9811959117650986
distance x is tensor(100.7918, device='cuda:1')
benign distance is  tensor(100.7918, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  2.102107174694538
distance x is tensor(137.7592, device='cuda:1')
benign distance is  tensor(137.7592, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0., 35., 10., 33.,  0., 30.,  0.,  0.,  0., 35., 35.,  0., 34., 35.,
         1., 12., 35.,  0.,  0., 34.,  0.,  0.,  4., 34.,  0., 35., 35., 35.,
        35., 35., 35.,  0., 35., 35.,  2., 35.])
count_res tensor([4.1357e-17, 6.5592e-02, 9.1094e-13, 8.8769e-03, 4.1357e-17, 4.4196e-04,
        4.1357e-17, 4.1357e-17, 4.1357e-17, 6.5592e-02, 6.5592e-02, 4.1357e-17,
        2.4130e-02, 6.5592e-02, 1.1242e-16, 6.7310e-12, 6.5592e-02, 4.1357e-17,
        4.1357e-17, 2.4130e-02, 4.1357e-17, 4.1357e-17, 2.2580e-15, 2.4130e-02,
        4.1357e-17, 6.5592e-02, 6.5592e-02, 6.5592e-02, 6.5592e-02, 6.5592e-02,
        6.5592e-02, 4.1357e-17, 6.5592e-02, 6.5592e-02, 3.0559e-16, 6.5592e-02])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 47.01% 

Test Accuracy: 77.08% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6253253221511841
distance x is tensor(129.8136, device='cuda:1')
benign distance is  tensor(129.8136, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.486203707754612
distance x is tensor(97.7055, device='cuda:1')
benign distance is  tensor(97.7055, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6656469777226448
distance x is tensor(108.3909, device='cuda:1')
benign distance is  tensor(108.3909, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.238212764263153
distance x is tensor(141.2641, device='cuda:1')
benign distance is  tensor(141.2641, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0589120239019394
distance x is tensor(99.2614, device='cuda:1')
benign distance is  tensor(99.2614, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9463661760091782
distance x is tensor(109.1887, device='cuda:1')
benign distance is  tensor(109.1887, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.256296433508396
distance x is tensor(92.4820, device='cuda:1')
benign distance is  tensor(92.4820, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.767044298350811
distance x is tensor(90.4112, device='cuda:1')
benign distance is  tensor(90.4112, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.2156981974840164
distance x is tensor(90.6758, device='cuda:1')
benign distance is  tensor(90.6758, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8115765526890755
distance x is tensor(114.8678, device='cuda:1')
benign distance is  tensor(114.8678, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.350906513631344
distance x is tensor(75.8538, device='cuda:1')
benign distance is  tensor(75.8538, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.853948697447777
distance x is tensor(96.3607, device='cuda:1')
benign distance is  tensor(96.3607, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.8964297473430634
distance x is tensor(152.2621, device='cuda:1')
benign distance is  tensor(152.2621, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9276470020413399
distance x is tensor(67.4655, device='cuda:1')
benign distance is  tensor(67.4655, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7873245775699615
distance x is tensor(138.4747, device='cuda:1')
benign distance is  tensor(138.4747, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.4508566334843636
distance x is tensor(104.8383, device='cuda:1')
benign distance is  tensor(104.8383, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9354376420378685
distance x is tensor(108.7086, device='cuda:1')
benign distance is  tensor(108.7086, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.8983671255409718
distance x is tensor(77.8603, device='cuda:1')
benign distance is  tensor(77.8603, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.8377729579806328
distance x is tensor(126.9018, device='cuda:1')
benign distance is  tensor(126.9018, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.738735057413578
distance x is tensor(99.2953, device='cuda:1')
benign distance is  tensor(99.2953, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.369842655956745
distance x is tensor(116.4703, device='cuda:1')
benign distance is  tensor(116.4703, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.766472451388836
distance x is tensor(103.5261, device='cuda:1')
benign distance is  tensor(103.5261, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6251086182892323
distance x is tensor(109.3107, device='cuda:1')
benign distance is  tensor(109.3107, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.239170879125595
distance x is tensor(157.0880, device='cuda:1')
benign distance is  tensor(157.0880, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  1.7257654964923859
distance x is tensor(83.6864, device='cuda:1')
benign distance is  tensor(83.6864, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  2.1960625872015953
distance x is tensor(129.1189, device='cuda:1')
benign distance is  tensor(129.1189, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  2.351783663034439
distance x is tensor(83.8802, device='cuda:1')
benign distance is  tensor(83.8802, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  2.298526957631111
distance x is tensor(95.7628, device='cuda:1')
benign distance is  tensor(95.7628, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  2.5853900238871574
distance x is tensor(83.3184, device='cuda:1')
benign distance is  tensor(83.3184, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  1.6843697503209114
distance x is tensor(108.8011, device='cuda:1')
benign distance is  tensor(108.8011, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  1.9193036556243896
distance x is tensor(115.5507, device='cuda:1')
benign distance is  tensor(115.5507, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  1.7374087050557137
distance x is tensor(85.0438, device='cuda:1')
benign distance is  tensor(85.0438, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  2.3113448098301888
distance x is tensor(120.6933, device='cuda:1')
benign distance is  tensor(120.6933, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  2.0078090205788612
distance x is tensor(111.7860, device='cuda:1')
benign distance is  tensor(111.7860, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  2.288835398852825
distance x is tensor(103.8894, device='cuda:1')
benign distance is  tensor(103.8894, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.701891241595149
distance x is tensor(121.3104, device='cuda:1')
benign distance is  tensor(121.3104, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8044262453913689
distance x is tensor(103.0378, device='cuda:1')
benign distance is  tensor(103.0378, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5917459949851036
distance x is tensor(108.3787, device='cuda:1')
benign distance is  tensor(108.3787, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0420049726963043
distance x is tensor(147.6002, device='cuda:1')
benign distance is  tensor(147.6002, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8928466103971004
distance x is tensor(99.6866, device='cuda:1')
benign distance is  tensor(99.6866, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6427482273429632
distance x is tensor(94.0615, device='cuda:1')
benign distance is  tensor(94.0615, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4998359382152557
distance x is tensor(120.2110, device='cuda:1')
benign distance is  tensor(120.2110, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6769187897443771
distance x is tensor(82.6900, device='cuda:1')
benign distance is  tensor(82.6900, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.875055268406868
distance x is tensor(113.9204, device='cuda:1')
benign distance is  tensor(113.9204, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6951191648840904
distance x is tensor(126.9472, device='cuda:1')
benign distance is  tensor(126.9472, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0801964718848467
distance x is tensor(95.7837, device='cuda:1')
benign distance is  tensor(95.7837, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2309418320655823
distance x is tensor(121.8079, device='cuda:1')
benign distance is  tensor(121.8079, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0786148346960545
distance x is tensor(167.5828, device='cuda:1')
benign distance is  tensor(167.5828, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6139222560450435
distance x is tensor(67.0883, device='cuda:1')
benign distance is  tensor(67.0883, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9831006955355406
distance x is tensor(147.7153, device='cuda:1')
benign distance is  tensor(147.7153, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2927434146404266
distance x is tensor(132.7275, device='cuda:1')
benign distance is  tensor(132.7275, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.5213709473609924
distance x is tensor(131.2911, device='cuda:1')
benign distance is  tensor(131.2911, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6930920332670212
distance x is tensor(115.7368, device='cuda:1')
benign distance is  tensor(115.7368, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0397060941904783
distance x is tensor(122.1859, device='cuda:1')
benign distance is  tensor(122.1859, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7292235661298037
distance x is tensor(118.8151, device='cuda:1')
benign distance is  tensor(118.8151, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9873943217098713
distance x is tensor(85.8188, device='cuda:1')
benign distance is  tensor(85.8188, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6689349887892604
distance x is tensor(209.3622, device='cuda:1')
benign distance is  tensor(209.3622, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0391377806663513
distance x is tensor(153.7771, device='cuda:1')
benign distance is  tensor(153.7771, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.722621001303196
distance x is tensor(115.1221, device='cuda:1')
benign distance is  tensor(115.1221, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9375743605196476
distance x is tensor(129.4194, device='cuda:1')
benign distance is  tensor(129.4194, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5705201951786876
distance x is tensor(77.6113, device='cuda:1')
benign distance is  tensor(77.6113, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9839150719344616
distance x is tensor(149.0401, device='cuda:1')
benign distance is  tensor(149.0401, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1691078059375286
distance x is tensor(118.2077, device='cuda:1')
benign distance is  tensor(118.2077, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6549661913886666
distance x is tensor(121.3153, device='cuda:1')
benign distance is  tensor(121.3153, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8418768774718046
distance x is tensor(122.0279, device='cuda:1')
benign distance is  tensor(122.0279, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4981274139136076
distance x is tensor(106.9137, device='cuda:1')
benign distance is  tensor(106.9137, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7594889104366302
distance x is tensor(175.2230, device='cuda:1')
benign distance is  tensor(175.2230, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8404015265405178
distance x is tensor(118.3233, device='cuda:1')
benign distance is  tensor(118.3233, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7717226501554251
distance x is tensor(102.4292, device='cuda:1')
benign distance is  tensor(102.4292, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6280124150216579
distance x is tensor(152.8504, device='cuda:1')
benign distance is  tensor(152.8504, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3682978637516499
distance x is tensor(129.6164, device='cuda:1')
benign distance is  tensor(129.6164, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9314675759524107
distance x is tensor(112.7769, device='cuda:1')
benign distance is  tensor(112.7769, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8140881154686213
distance x is tensor(81.9663, device='cuda:1')
benign distance is  tensor(81.9663, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7534857727587223
distance x is tensor(98.9847, device='cuda:1')
benign distance is  tensor(98.9847, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8804402444511652
distance x is tensor(115.4777, device='cuda:1')
benign distance is  tensor(115.4777, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3963211104273796
distance x is tensor(111.6877, device='cuda:1')
benign distance is  tensor(111.6877, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2576772086322308
distance x is tensor(138.7852, device='cuda:1')
benign distance is  tensor(138.7852, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2557238936424255
distance x is tensor(144.6785, device='cuda:1')
benign distance is  tensor(144.6785, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0469087213277817
distance x is tensor(101.5042, device='cuda:1')
benign distance is  tensor(101.5042, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.541772585362196
distance x is tensor(152.6697, device='cuda:1')
benign distance is  tensor(152.6697, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6516124289482832
distance x is tensor(143.9535, device='cuda:1')
benign distance is  tensor(143.9535, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.72915393486619
distance x is tensor(106.0750, device='cuda:1')
benign distance is  tensor(106.0750, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5408883839845657
distance x is tensor(134.6509, device='cuda:1')
benign distance is  tensor(134.6509, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(84.4082, device='cuda:1')
compute distance is  tensor(84.4082, device='cuda:1')
compute norm is  tensor(44.6474, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.6937, device='cuda:1')
compute distance is  tensor(136.6937, device='cuda:1')
compute norm is  tensor(46.1699, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.0496, device='cuda:1')
compute distance is  tensor(104.0496, device='cuda:1')
compute norm is  tensor(45.1585, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.2443, device='cuda:1')
compute distance is  tensor(102.2443, device='cuda:1')
compute norm is  tensor(45.0486, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.6927, device='cuda:1')
compute distance is  tensor(102.6927, device='cuda:1')
compute norm is  tensor(45.0663, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.2617, device='cuda:1')
compute distance is  tensor(102.2617, device='cuda:1')
compute norm is  tensor(45.2251, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.9281, device='cuda:1')
compute distance is  tensor(126.9281, device='cuda:1')
compute norm is  tensor(45.6194, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.1436, device='cuda:1')
compute distance is  tensor(99.1436, device='cuda:1')
compute norm is  tensor(45.0711, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.7858, device='cuda:1')
compute distance is  tensor(116.7858, device='cuda:1')
compute norm is  tensor(45.5552, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.2249, device='cuda:1')
compute distance is  tensor(97.2249, device='cuda:1')
compute norm is  tensor(45.0735, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.7798, device='cuda:1')
compute distance is  tensor(114.7798, device='cuda:1')
compute norm is  tensor(45.2660, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.7187, device='cuda:1')
compute distance is  tensor(150.7187, device='cuda:1')
compute norm is  tensor(46.7700, device='cuda:1', dtype=torch.float64)
batch acc is 0.10243333348966525
mal_rand_acc is 0.10900000016000001
mal_rand loss is 106489767264256.0
len of model dicts is  12
distance x is tensor(84.4082, device='cuda:1')
compute distance is  tensor(84.4082, device='cuda:1')
compute norm is  tensor(44.6474, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.6937, device='cuda:1')
compute distance is  tensor(136.6937, device='cuda:1')
compute norm is  tensor(46.1699, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.0496, device='cuda:1')
compute distance is  tensor(104.0496, device='cuda:1')
compute norm is  tensor(45.1585, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.2443, device='cuda:1')
compute distance is  tensor(102.2443, device='cuda:1')
compute norm is  tensor(45.0486, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.6927, device='cuda:1')
compute distance is  tensor(102.6927, device='cuda:1')
compute norm is  tensor(45.0663, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.2617, device='cuda:1')
compute distance is  tensor(102.2617, device='cuda:1')
compute norm is  tensor(45.2251, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.9281, device='cuda:1')
compute distance is  tensor(126.9281, device='cuda:1')
compute norm is  tensor(45.6194, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.1436, device='cuda:1')
compute distance is  tensor(99.1436, device='cuda:1')
compute norm is  tensor(45.0711, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.7858, device='cuda:1')
compute distance is  tensor(116.7858, device='cuda:1')
compute norm is  tensor(45.5552, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.2249, device='cuda:1')
compute distance is  tensor(97.2249, device='cuda:1')
compute norm is  tensor(45.0735, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.7798, device='cuda:1')
compute distance is  tensor(114.7798, device='cuda:1')
compute norm is  tensor(45.2660, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.7187, device='cuda:1')
compute distance is  tensor(150.7187, device='cuda:1')
compute norm is  tensor(46.7700, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(150.7187, device='cuda:1')
distance x is tensor(102085.9062, device='cuda:1')
distance x is tensor(102085.9062, device='cuda:1')
________________________________
test distance is  tensor(102085.9062, device='cuda:1')
test distance1 is  tensor(102085.9062, device='cuda:1')
test similarity is  tensor(-0.1082, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107539921207924.81
test entropy is  0.0
________________________________
cal ratio is  0.03765535095460327
distance x is tensor(3844.0854, device='cuda:1')
cal_distance is  tensor(3844.0854, device='cuda:1')
cal ratio is  0.19404973871163853
distance x is tensor(745.9476, device='cuda:1')
cal_distance is  tensor(745.9476, device='cuda:1')
cal ratio is  0.44050964672386334
distance x is tensor(328.5997, device='cuda:1')
cal_distance is  tensor(328.5997, device='cuda:1')
cal ratio is  0.6637063684239437
distance x is tensor(218.0953, device='cuda:1')
cal_distance is  tensor(218.0953, device='cuda:1')
cal ratio is  0.8146788944686858
distance x is tensor(177.6785, device='cuda:1')
cal_distance is  tensor(177.6785, device='cuda:1')
cal ratio is  0.9025933670187357
distance x is tensor(160.3719, device='cuda:1')
cal_distance is  tensor(160.3719, device='cuda:1')
cal ratio is  0.950047764669073
distance x is tensor(152.3612, device='cuda:1')
cal_distance is  tensor(152.3612, device='cuda:1')
cal ratio is  0.9747030875184782
distance x is tensor(148.5071, device='cuda:1')
cal_distance is  tensor(148.5071, device='cuda:1')
distance x is tensor(148.5071, device='cuda:1')
return_distance is  tensor(148.5071, device='cuda:1')
distance x is tensor(148.4978, device='cuda:1')
distance x is tensor(148.4978, device='cuda:1')
________________________________
test distance is  tensor(148.4978, device='cuda:1')
test distance1 is  tensor(148.4978, device='cuda:1')
test similarity is  tensor(0.9303, device='cuda:1')
test acc is  0.10040000015633196
test loss is 392.567369245517
test entropy is  0.00018472733352293516
________________________________
0
distance x is tensor(148.4978, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.00020516540642471495
avg test loss is  391.89587626833395
avg accuracy is  0.288016666823006
solo acc is  0.10041666682299864
compute similarity  is  tensor(0.9303, device='cuda:1')
compute_distance is  tensor(148.4978, device='cuda:1')
compute_norm is  tensor(44.5401, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.7690, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9269245948745752
avg test loss is  1.5295100974629936
avg accuracy is  0.8093333334896585
solo acc is  0.31773333348967314
compute similarity  is  tensor(0.9422, device='cuda:1')
compute_distance is  tensor(121.7690, device='cuda:1')
compute_norm is  tensor(43.5443, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.4588, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9026862201787261
avg test loss is  1.5460496388518734
avg accuracy is  0.8105333334896585
solo acc is  0.27336666682300553
compute similarity  is  tensor(0.9415, device='cuda:1')
compute_distance is  tensor(124.4588, device='cuda:1')
compute_norm is  tensor(43.2559, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.7195, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8744095188341161
avg test loss is  1.520622081721007
avg accuracy is  0.8161333334896582
solo acc is  0.26505000015633867
compute similarity  is  tensor(0.9411, device='cuda:1')
compute_distance is  tensor(126.7195, device='cuda:1')
compute_norm is  tensor(42.9942, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.7724, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.864312902950783
avg test loss is  1.4844146483996783
avg accuracy is  0.8201500001563247
solo acc is  0.2645166668230053
compute similarity  is  tensor(0.9406, device='cuda:1')
compute_distance is  tensor(128.7724, device='cuda:1')
compute_norm is  tensor(42.7497, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.6799, device='cuda:1')
distance x is tensor(130.6799, device='cuda:1')
________________________________
test distance is  tensor(130.6799, device='cuda:1')
test distance1 is  tensor(130.6799, device='cuda:1')
test similarity is  tensor(0.9402, device='cuda:1')
test acc is  0.26313333348967194
test loss is 1.4445727597167497
test entropy is  0.8749608577949914
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2740000001600001
mal loss is 1.4329186379909515
mal norm is  tensor(670.9471, device='cuda:1')
distance x is tensor(130.6871, device='cuda:1')
mal distance is  tensor(130.6871, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 9.49% 

Test Accuracy: 16.86% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8013271521776915
distance x is tensor(178.6317, device='cuda:1')
benign distance is  tensor(178.6317, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.116635125130415
distance x is tensor(160.1831, device='cuda:1')
benign distance is  tensor(160.1831, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8882938772439957
distance x is tensor(148.2758, device='cuda:1')
benign distance is  tensor(148.2758, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8730073310434818
distance x is tensor(171.1278, device='cuda:1')
benign distance is  tensor(171.1278, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2053482346236706
distance x is tensor(146.4750, device='cuda:1')
benign distance is  tensor(146.4750, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0501130651682615
distance x is tensor(147.7368, device='cuda:1')
benign distance is  tensor(147.7368, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6396721228957176
distance x is tensor(147.0401, device='cuda:1')
benign distance is  tensor(147.0401, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3299539275467396
distance x is tensor(147.0249, device='cuda:1')
benign distance is  tensor(147.0249, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(117.2237, device='cuda:1')
compute distance is  tensor(117.2237, device='cuda:1')
compute norm is  tensor(43.9581, device='cuda:1', dtype=torch.float64)
distance x is tensor(186.2727, device='cuda:1')
compute distance is  tensor(186.2727, device='cuda:1')
compute norm is  tensor(45.7361, device='cuda:1', dtype=torch.float64)
distance x is tensor(134.6953, device='cuda:1')
compute distance is  tensor(134.6953, device='cuda:1')
compute norm is  tensor(44.2159, device='cuda:1', dtype=torch.float64)
distance x is tensor(138.5667, device='cuda:1')
compute distance is  tensor(138.5667, device='cuda:1')
compute norm is  tensor(44.4607, device='cuda:1', dtype=torch.float64)
distance x is tensor(128.4274, device='cuda:1')
compute distance is  tensor(128.4274, device='cuda:1')
compute norm is  tensor(43.9651, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.8805, device='cuda:1')
compute distance is  tensor(150.8805, device='cuda:1')
compute norm is  tensor(44.7447, device='cuda:1', dtype=torch.float64)
distance x is tensor(162.2601, device='cuda:1')
compute distance is  tensor(162.2601, device='cuda:1')
compute norm is  tensor(44.8214, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.2130, device='cuda:1')
compute distance is  tensor(143.2130, device='cuda:1')
compute norm is  tensor(44.5656, device='cuda:1', dtype=torch.float64)
distance x is tensor(158.7262, device='cuda:1')
compute distance is  tensor(158.7262, device='cuda:1')
compute norm is  tensor(44.8377, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.7737, device='cuda:1')
compute distance is  tensor(127.7737, device='cuda:1')
compute norm is  tensor(44.3526, device='cuda:1', dtype=torch.float64)
distance x is tensor(158.7697, device='cuda:1')
compute distance is  tensor(158.7697, device='cuda:1')
compute norm is  tensor(44.9847, device='cuda:1', dtype=torch.float64)
distance x is tensor(177.9980, device='cuda:1')
compute distance is  tensor(177.9980, device='cuda:1')
compute norm is  tensor(45.9034, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(186.2727, device='cuda:1')
distance x is tensor(102015.9219, device='cuda:1')
distance x is tensor(102015.9219, device='cuda:1')
________________________________
test distance is  tensor(102015.9219, device='cuda:1')
test distance1 is  tensor(102015.9219, device='cuda:1')
test similarity is  tensor(0.1838, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107524783061537.84
test entropy is  0.0
________________________________
cal ratio is  0.041876146263920416
distance x is tensor(4272.0381, device='cuda:1')
cal_distance is  tensor(4272.0381, device='cuda:1')
cal ratio is  0.20463651258657872
distance x is tensor(874.2189, device='cuda:1')
cal_distance is  tensor(874.2189, device='cuda:1')
cal ratio is  0.45236667652699797
distance x is tensor(395.4700, device='cuda:1')
cal_distance is  tensor(395.4700, device='cuda:1')
cal ratio is  0.6725799683527766
distance x is tensor(265.9867, device='cuda:1')
cal_distance is  tensor(265.9867, device='cuda:1')
cal ratio is  0.8201074140401962
distance x is tensor(218.1385, device='cuda:1')
cal_distance is  tensor(218.1385, device='cuda:1')
cal ratio is  0.905596098507777
distance x is tensor(197.5458, device='cuda:1')
cal_distance is  tensor(197.5458, device='cuda:1')
cal ratio is  0.9516270985216286
distance x is tensor(187.9902, device='cuda:1')
cal_distance is  tensor(187.9902, device='cuda:1')
cal ratio is  0.9755131073153748
distance x is tensor(183.3870, device='cuda:1')
cal_distance is  tensor(183.3870, device='cuda:1')
distance x is tensor(183.3870, device='cuda:1')
return_distance is  tensor(183.3870, device='cuda:1')
distance x is tensor(183.3778, device='cuda:1')
distance x is tensor(183.3778, device='cuda:1')
________________________________
test distance is  tensor(183.3778, device='cuda:1')
test distance1 is  tensor(183.3778, device='cuda:1')
test similarity is  tensor(0.9171, device='cuda:1')
test acc is  0.10000000015633198
test loss is 1202.8181521287604
test entropy is  0.0
________________________________
0
distance x is tensor(183.3778, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1204.4912088552771
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9171, device='cuda:1')
compute_distance is  tensor(183.3778, device='cuda:1')
compute_norm is  tensor(47.2930, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1325.3224, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.603878933229426
avg test loss is  2.8425114691130386
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3607, device='cuda:1')
compute_distance is  tensor(1325.3224, device='cuda:1')
compute_norm is  tensor(132.3211, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1319.2279, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8742819735998792
avg test loss is  3.620397067781705
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3609, device='cuda:1')
compute_distance is  tensor(1319.2279, device='cuda:1')
compute_norm is  tensor(131.8362, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1313.1702, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5554540351763972
avg test loss is  2.862664104524706
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3607, device='cuda:1')
compute_distance is  tensor(1313.1702, device='cuda:1')
compute_norm is  tensor(131.1343, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1307.1521, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8587339665971077
avg test loss is  3.6075711529900523
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3608, device='cuda:1')
compute_distance is  tensor(1307.1521, device='cuda:1')
compute_norm is  tensor(130.6532, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1301.0868, device='cuda:1')
distance x is tensor(1301.0868, device='cuda:1')
________________________________
test distance is  tensor(1301.0868, device='cuda:1')
test distance1 is  tensor(1301.0868, device='cuda:1')
test similarity is  tensor(0.3606, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8630590283794444
test entropy is  1.5509795325397173
________________________________
cal ratio is  0.37080667554838675
distance x is tensor(482.4514, device='cuda:1')
cal_distance is  tensor(482.4514, device='cuda:1')
cal ratio is  0.6089391474246865
distance x is tensor(293.7834, device='cuda:1')
cal_distance is  tensor(293.7834, device='cuda:1')
cal ratio is  0.7803456550798844
distance x is tensor(229.2526, device='cuda:1')
cal_distance is  tensor(229.2526, device='cuda:1')
cal ratio is  0.8833717917371512
distance x is tensor(202.5153, device='cuda:1')
cal_distance is  tensor(202.5153, device='cuda:1')
cal ratio is  0.9398786608141066
distance x is tensor(190.3398, device='cuda:1')
cal_distance is  tensor(190.3398, device='cuda:1')
cal ratio is  0.96947342385867
distance x is tensor(184.5293, device='cuda:1')
cal_distance is  tensor(184.5293, device='cuda:1')
distance x is tensor(184.5293, device='cuda:1')
return_distance is  tensor(184.5293, device='cuda:1')
distance x is tensor(184.5297, device='cuda:1')
distance x is tensor(184.5297, device='cuda:1')
________________________________
test distance is  tensor(184.5297, device='cuda:1')
test distance1 is  tensor(184.5297, device='cuda:1')
test similarity is  tensor(0.9143, device='cuda:1')
test acc is  0.10808333348966528
test loss is 2.9675771104755686
test entropy is  1.445801883745295
________________________________
0
distance x is tensor(184.5297, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.4465184379488165
avg test loss is  2.9666037282455706
avg accuracy is  0.10070000015633197
solo acc is  0.10738333348966529
compute similarity  is  tensor(0.9143, device='cuda:1')
compute_distance is  tensor(184.5297, device='cuda:1')
compute_norm is  tensor(48.7360, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(185.9006, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6807744006739497
avg test loss is  3.1091081580119346
avg accuracy is  0.1052333334896653
solo acc is  0.10150000015633197
compute similarity  is  tensor(0.9142, device='cuda:1')
compute_distance is  tensor(185.9006, device='cuda:1')
compute_norm is  tensor(48.5787, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(190.1191, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.1607839130897766
avg test loss is  2.0142536247208684
avg accuracy is  0.1351000001563319
solo acc is  0.16290000015633418
compute similarity  is  tensor(0.9136, device='cuda:1')
compute_distance is  tensor(190.1191, device='cuda:1')
compute_norm is  tensor(48.4842, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(190.1892, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.697577640573099
avg test loss is  2.7632300589384555
avg accuracy is  0.11890000015633193
solo acc is  0.10170000015633197
compute similarity  is  tensor(0.9132, device='cuda:1')
compute_distance is  tensor(190.1892, device='cuda:1')
compute_norm is  tensor(48.4269, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.2675, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.1305219736943113
avg test loss is  1.8370358345350986
avg accuracy is  0.13978333348966557
solo acc is  0.1826166668230021
compute similarity  is  tensor(0.9128, device='cuda:1')
compute_distance is  tensor(192.2675, device='cuda:1')
compute_norm is  tensor(48.2038, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.0597, device='cuda:1')
distance x is tensor(192.0597, device='cuda:1')
________________________________
test distance is  tensor(192.0597, device='cuda:1')
test distance1 is  tensor(192.0597, device='cuda:1')
test similarity is  tensor(0.9124, device='cuda:1')
test acc is  0.10126666682299863
test loss is 2.6490106394550184
test entropy is  0.6616252611186713
________________________________
cal ratio is  0.9651227774365341
distance x is tensor(185.3596, device='cuda:1')
cal_distance is  tensor(185.3596, device='cuda:1')
distance x is tensor(185.3596, device='cuda:1')
return_distance is  tensor(185.3596, device='cuda:1')
distance x is tensor(185.3612, device='cuda:1')
distance x is tensor(185.3612, device='cuda:1')
________________________________
test distance is  tensor(185.3612, device='cuda:1')
test distance1 is  tensor(185.3612, device='cuda:1')
test similarity is  tensor(0.9176, device='cuda:1')
test acc is  0.1010333334896653
test loss is 2.5984744822292694
test entropy is  0.6980093940615908
________________________________
0
distance x is tensor(185.3612, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.6984067567503021
avg test loss is  2.597867246629841
avg accuracy is  0.11853333348966526
solo acc is  0.10111666682299864
compute similarity  is  tensor(0.9176, device='cuda:1')
compute_distance is  tensor(185.3612, device='cuda:1')
compute_norm is  tensor(47.8086, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(187.3410, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0484603913481048
avg test loss is  1.7663859707206042
avg accuracy is  0.13705000015633195
solo acc is  0.18730000015633572
compute similarity  is  tensor(0.9171, device='cuda:1')
compute_distance is  tensor(187.3410, device='cuda:1')
compute_norm is  tensor(47.6058, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(187.1071, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6412151422836124
avg test loss is  2.533980813870298
avg accuracy is  0.11620000015633193
solo acc is  0.10155000015633196
compute similarity  is  tensor(0.9167, device='cuda:1')
compute_distance is  tensor(187.1071, device='cuda:1')
compute_norm is  tensor(47.4966, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(188.7277, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9916038051851268
avg test loss is  1.691662790424534
avg accuracy is  0.14280000015633254
solo acc is  0.20548333348967002
compute similarity  is  tensor(0.9162, device='cuda:1')
compute_distance is  tensor(188.7277, device='cuda:1')
compute_norm is  tensor(47.2713, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(188.7259, device='cuda:1')
________________________________
test distance is  tensor(188.7259, device='cuda:1')
test similarity is  tensor(0.9162, device='cuda:1')
test acc is  0.1431166668229992
test loss is 1.6932893607662176
test entropy is  0.9918445454858767
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.19700000016000008
mal loss is 1.7033153623342514
mal norm is  tensor(833.4927, device='cuda:1')
distance x is tensor(188.7259, device='cuda:1')
mal distance is  tensor(188.7259, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 13., 27., 13., 25., 12.,  2., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 13., 12., 12., 12., 12., 12.])
count_res tensor([1.4324e-07, 3.8938e-07, 4.6827e-01, 3.8938e-07, 6.3373e-02, 1.4324e-07,
        6.5032e-12, 4.6827e-01, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 1.4324e-07, 1.4324e-07, 3.8938e-07, 1.4324e-07,
        1.4324e-07, 1.4324e-07, 1.4324e-07, 1.4324e-07])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 87.80% 

Test Accuracy: 83.50% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8160769920796156
distance x is tensor(132.3940, device='cuda:1')
benign distance is  tensor(132.3940, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9064324032515287
distance x is tensor(113.2154, device='cuda:1')
benign distance is  tensor(113.2154, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1304257325828075
distance x is tensor(108.2702, device='cuda:1')
benign distance is  tensor(108.2702, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2584586292505264
distance x is tensor(158.3750, device='cuda:1')
benign distance is  tensor(158.3750, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9821020253002644
distance x is tensor(118.5083, device='cuda:1')
benign distance is  tensor(118.5083, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8237997367978096
distance x is tensor(119.9693, device='cuda:1')
benign distance is  tensor(119.9693, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5496875271201134
distance x is tensor(110.7925, device='cuda:1')
benign distance is  tensor(110.7925, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7691565817221999
distance x is tensor(90.2519, device='cuda:1')
benign distance is  tensor(90.2519, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9519271180033684
distance x is tensor(119.8167, device='cuda:1')
benign distance is  tensor(119.8167, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7266071625053883
distance x is tensor(135.6588, device='cuda:1')
benign distance is  tensor(135.6588, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2410302236676216
distance x is tensor(84.5003, device='cuda:1')
benign distance is  tensor(84.5003, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.990652710199356
distance x is tensor(129.0296, device='cuda:1')
benign distance is  tensor(129.0296, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.6212214604020119
distance x is tensor(166.2517, device='cuda:1')
benign distance is  tensor(166.2517, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8378481883555651
distance x is tensor(79.5260, device='cuda:1')
benign distance is  tensor(79.5260, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9678993336856365
distance x is tensor(140.5848, device='cuda:1')
benign distance is  tensor(140.5848, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4878154918551445
distance x is tensor(118.6890, device='cuda:1')
benign distance is  tensor(118.6890, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(88.1078, device='cuda:1')
compute distance is  tensor(88.1078, device='cuda:1')
compute norm is  tensor(44.8730, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.2972, device='cuda:1')
compute distance is  tensor(146.2972, device='cuda:1')
compute norm is  tensor(45.9961, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.3226, device='cuda:1')
compute distance is  tensor(104.3226, device='cuda:1')
compute norm is  tensor(45.0390, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.5894, device='cuda:1')
compute distance is  tensor(123.5894, device='cuda:1')
compute norm is  tensor(45.5240, device='cuda:1', dtype=torch.float64)
distance x is tensor(93.5287, device='cuda:1')
compute distance is  tensor(93.5287, device='cuda:1')
compute norm is  tensor(44.8706, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.6014, device='cuda:1')
compute distance is  tensor(122.6014, device='cuda:1')
compute norm is  tensor(45.4822, device='cuda:1', dtype=torch.float64)
distance x is tensor(131.3263, device='cuda:1')
compute distance is  tensor(131.3263, device='cuda:1')
compute norm is  tensor(45.6110, device='cuda:1', dtype=torch.float64)
distance x is tensor(92.0942, device='cuda:1')
compute distance is  tensor(92.0942, device='cuda:1')
compute norm is  tensor(44.9509, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.9755, device='cuda:1')
compute distance is  tensor(136.9755, device='cuda:1')
compute norm is  tensor(45.8888, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.1083, device='cuda:1')
compute distance is  tensor(114.1083, device='cuda:1')
compute norm is  tensor(45.4258, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.0144, device='cuda:1')
compute distance is  tensor(119.0144, device='cuda:1')
compute norm is  tensor(45.2320, device='cuda:1', dtype=torch.float64)
distance x is tensor(151.1733, device='cuda:1')
compute distance is  tensor(151.1733, device='cuda:1')
compute norm is  tensor(46.6117, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(151.1733, device='cuda:1')
distance x is tensor(102040.9688, device='cuda:1')
distance x is tensor(102040.9688, device='cuda:1')
________________________________
test distance is  tensor(102040.9688, device='cuda:1')
test distance1 is  tensor(102040.9688, device='cuda:1')
test similarity is  tensor(0.1339, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107519949944469.56
test entropy is  0.0
________________________________
cal ratio is  0.03772040132147441
distance x is tensor(3849.0310, device='cuda:1')
cal_distance is  tensor(3849.0310, device='cuda:1')
cal ratio is  0.1942172898178574
distance x is tensor(747.5519, device='cuda:1')
cal_distance is  tensor(747.5519, device='cuda:1')
cal ratio is  0.4406998526998269
distance x is tensor(329.4486, device='cuda:1')
cal_distance is  tensor(329.4486, device='cuda:1')
cal ratio is  0.663849677954542
distance x is tensor(218.7059, device='cuda:1')
cal_distance is  tensor(218.7059, device='cuda:1')
cal ratio is  0.8147668277352289
distance x is tensor(178.1951, device='cuda:1')
cal_distance is  tensor(178.1951, device='cuda:1')
cal ratio is  0.9026422640770356
distance x is tensor(160.8469, device='cuda:1')
cal_distance is  tensor(160.8469, device='cuda:1')
cal ratio is  0.9500735229601562
distance x is tensor(152.8166, device='cuda:1')
cal_distance is  tensor(152.8166, device='cuda:1')
cal ratio is  0.9747164191346305
distance x is tensor(148.9530, device='cuda:1')
cal_distance is  tensor(148.9530, device='cuda:1')
distance x is tensor(148.9530, device='cuda:1')
return_distance is  tensor(148.9530, device='cuda:1')
distance x is tensor(148.9439, device='cuda:1')
distance x is tensor(148.9439, device='cuda:1')
________________________________
test distance is  tensor(148.9439, device='cuda:1')
test distance1 is  tensor(148.9439, device='cuda:1')
test similarity is  tensor(0.9416, device='cuda:1')
test acc is  0.10356666682299863
test loss is 203.03169452203616
test entropy is  0.002490092777341581
________________________________
0
distance x is tensor(148.9439, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0026332414227705856
avg test loss is  203.12041216364292
avg accuracy is  0.38045000015634095
solo acc is  0.10320000015633196
compute similarity  is  tensor(0.9416, device='cuda:1')
compute_distance is  tensor(148.9439, device='cuda:1')
compute_norm is  tensor(46.8729, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.7083, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.1794423463502164
avg test loss is  1.7746012515859055
avg accuracy is  0.7236666668229961
solo acc is  0.2145833334896703
compute similarity  is  tensor(0.9438, device='cuda:1')
compute_distance is  tensor(141.7083, device='cuda:1')
compute_norm is  tensor(46.8459, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(143.2985, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6665170625455852
avg test loss is  2.628300920732494
avg accuracy is  0.7122166668229967
solo acc is  0.11010000015633195
compute similarity  is  tensor(0.9432, device='cuda:1')
compute_distance is  tensor(143.2985, device='cuda:1')
compute_norm is  tensor(46.7234, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.5867, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0065599966532133
avg test loss is  1.5566656937731354
avg accuracy is  0.7484333334896612
solo acc is  0.2537333334896717
compute similarity  is  tensor(0.9432, device='cuda:1')
compute_distance is  tensor(144.5867, device='cuda:1')
compute_norm is  tensor(46.4516, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(145.7472, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6215645371914418
avg test loss is  2.4112415288302946
avg accuracy is  0.7251166668229958
solo acc is  0.11035000015633194
compute similarity  is  tensor(0.9425, device='cuda:1')
compute_distance is  tensor(145.7472, device='cuda:1')
compute_norm is  tensor(46.2970, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.0465, device='cuda:1')
distance x is tensor(147.0465, device='cuda:1')
________________________________
test distance is  tensor(147.0465, device='cuda:1')
test distance1 is  tensor(147.0465, device='cuda:1')
test similarity is  tensor(0.9423, device='cuda:1')
test acc is  0.28638333348967254
test loss is 1.421711549830081
test entropy is  0.9513883180836878
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.28300000016000004
mal loss is 1.4371742606163025
mal norm is  tensor(713.5782, device='cuda:1')
distance x is tensor(147.0549, device='cuda:1')
mal distance is  tensor(147.0549, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 24., 12.,  0., 12., 26., 23., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 12., 20., 12., 15.])
count_res tensor([6.9984e-07, 6.9984e-07, 1.1390e-01, 6.9984e-07, 4.3000e-12, 6.9984e-07,
        8.4163e-01, 4.1902e-02, 3.8210e-05, 3.8210e-05, 3.8210e-05, 3.8210e-05,
        3.8210e-05, 3.8210e-05, 3.8210e-05, 3.8210e-05, 3.8210e-05, 3.8210e-05,
        3.8210e-05, 3.8210e-05, 6.9984e-07, 6.9984e-07, 6.9984e-07, 6.9984e-07,
        6.9984e-07, 2.0862e-03, 6.9984e-07, 1.4057e-05])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 68.16% 

Test Accuracy: 77.58% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8753759656101465
distance x is tensor(147.1161, device='cuda:1')
benign distance is  tensor(147.1161, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6253331825137138
distance x is tensor(121.0425, device='cuda:1')
benign distance is  tensor(121.0425, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5030022151768208
distance x is tensor(113.1421, device='cuda:1')
benign distance is  tensor(113.1421, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3575564920902252
distance x is tensor(152.0078, device='cuda:1')
benign distance is  tensor(152.0078, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2108395732939243
distance x is tensor(114.5382, device='cuda:1')
benign distance is  tensor(114.5382, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9562309011816978
distance x is tensor(118.9312, device='cuda:1')
benign distance is  tensor(118.9312, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0389325693249702
distance x is tensor(67.0217, device='cuda:1')
benign distance is  tensor(67.0217, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3277344703674316
distance x is tensor(102.6107, device='cuda:1')
benign distance is  tensor(102.6107, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7799293473362923
distance x is tensor(118.5594, device='cuda:1')
benign distance is  tensor(118.5594, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0876731723546982
distance x is tensor(119.3671, device='cuda:1')
benign distance is  tensor(119.3671, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.378166377544403
distance x is tensor(127.2012, device='cuda:1')
benign distance is  tensor(127.2012, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.146501138806343
distance x is tensor(124.5619, device='cuda:1')
benign distance is  tensor(124.5619, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2816350050270557
distance x is tensor(93.5959, device='cuda:1')
benign distance is  tensor(93.5959, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0103097893297672
distance x is tensor(208.6979, device='cuda:1')
benign distance is  tensor(208.6979, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0886453837156296
distance x is tensor(160.1976, device='cuda:1')
benign distance is  tensor(160.1976, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8964365310966969
distance x is tensor(130.6626, device='cuda:1')
benign distance is  tensor(130.6626, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(97.7065, device='cuda:1')
compute distance is  tensor(97.7065, device='cuda:1')
compute norm is  tensor(45.8488, device='cuda:1', dtype=torch.float64)
distance x is tensor(148.1977, device='cuda:1')
compute distance is  tensor(148.1977, device='cuda:1')
compute norm is  tensor(46.9995, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.7372, device='cuda:1')
compute distance is  tensor(101.7372, device='cuda:1')
compute norm is  tensor(45.9727, device='cuda:1', dtype=torch.float64)
distance x is tensor(124.4932, device='cuda:1')
compute distance is  tensor(124.4932, device='cuda:1')
compute norm is  tensor(46.5133, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.7896, device='cuda:1')
compute distance is  tensor(102.7896, device='cuda:1')
compute norm is  tensor(45.8979, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.5033, device='cuda:1')
compute distance is  tensor(125.5033, device='cuda:1')
compute norm is  tensor(46.4119, device='cuda:1', dtype=torch.float64)
distance x is tensor(131.7947, device='cuda:1')
compute distance is  tensor(131.7947, device='cuda:1')
compute norm is  tensor(46.5450, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.0000, device='cuda:1')
compute distance is  tensor(105.0000, device='cuda:1')
compute norm is  tensor(45.9674, device='cuda:1', dtype=torch.float64)
distance x is tensor(131.4932, device='cuda:1')
compute distance is  tensor(131.4932, device='cuda:1')
compute norm is  tensor(46.5886, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.6403, device='cuda:1')
compute distance is  tensor(102.6403, device='cuda:1')
compute norm is  tensor(46.0430, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.4377, device='cuda:1')
compute distance is  tensor(129.4377, device='cuda:1')
compute norm is  tensor(46.2981, device='cuda:1', dtype=torch.float64)
distance x is tensor(154.2564, device='cuda:1')
compute distance is  tensor(154.2564, device='cuda:1')
compute norm is  tensor(47.5577, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(154.2564, device='cuda:1')
distance x is tensor(102048.6797, device='cuda:1')
distance x is tensor(102048.6797, device='cuda:1')
________________________________
test distance is  tensor(102048.6797, device='cuda:1')
test distance1 is  tensor(102048.6797, device='cuda:1')
test similarity is  tensor(0.1133, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107548564622128.58
test entropy is  0.0
________________________________
cal ratio is  0.03810166579000408
distance x is tensor(3888.2297, device='cuda:1')
cal_distance is  tensor(3888.2297, device='cuda:1')
cal ratio is  0.19519635503481733
distance x is tensor(758.9719, device='cuda:1')
cal_distance is  tensor(758.9719, device='cuda:1')
cal ratio is  0.4418092455426377
distance x is tensor(335.3233, device='cuda:1')
cal_distance is  tensor(335.3233, device='cuda:1')
cal ratio is  0.6646848370328788
distance x is tensor(222.8859, device='cuda:1')
cal_distance is  tensor(222.8859, device='cuda:1')
cal ratio is  0.8152792375446084
distance x is tensor(181.7151, device='cuda:1')
cal_distance is  tensor(181.7151, device='cuda:1')
cal ratio is  0.9029260176729074
distance x is tensor(164.0757, device='cuda:1')
cal_distance is  tensor(164.0757, device='cuda:1')
cal ratio is  0.9502229374005345
distance x is tensor(155.9088, device='cuda:1')
cal_distance is  tensor(155.9088, device='cuda:1')
cal ratio is  0.9747930283457787
distance x is tensor(151.9788, device='cuda:1')
cal_distance is  tensor(151.9788, device='cuda:1')
distance x is tensor(151.9788, device='cuda:1')
return_distance is  tensor(151.9788, device='cuda:1')
distance x is tensor(151.9698, device='cuda:1')
distance x is tensor(151.9698, device='cuda:1')
________________________________
test distance is  tensor(151.9698, device='cuda:1')
test distance1 is  tensor(151.9698, device='cuda:1')
test similarity is  tensor(0.9409, device='cuda:1')
test acc is  0.10778333348966529
test loss is 254.45695184898784
test entropy is  0.0023524366652813143
________________________________
0
distance x is tensor(151.9698, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.002895406531797186
avg test loss is  254.96278259342412
avg accuracy is  0.40050000015634113
solo acc is  0.10718333348966529
compute similarity  is  tensor(0.9409, device='cuda:1')
compute_distance is  tensor(151.9698, device='cuda:1')
compute_norm is  tensor(47.7897, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.9641, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.2392050369716148
avg test loss is  2.029405200786428
avg accuracy is  0.5814000001563391
solo acc is  0.1648000001563343
compute similarity  is  tensor(0.9398, device='cuda:1')
compute_distance is  tensor(151.9641, device='cuda:1')
compute_norm is  tensor(48.1670, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(153.6121, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7211024303044846
avg test loss is  2.8248467216613706
avg accuracy is  0.582150000156339
solo acc is  0.10596666682299861
compute similarity  is  tensor(0.9389, device='cuda:1')
compute_distance is  tensor(153.6121, device='cuda:1')
compute_norm is  tensor(48.1394, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.3232, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0983828837429281
avg test loss is  1.7569608886613013
avg accuracy is  0.6179333334896695
solo acc is  0.21663333348967043
compute similarity  is  tensor(0.9395, device='cuda:1')
compute_distance is  tensor(155.3232, device='cuda:1')
compute_norm is  tensor(47.7772, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.5182, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6672984198339458
avg test loss is  2.5781388669125813
avg accuracy is  0.6106000001563366
solo acc is  0.10843333348966529
compute similarity  is  tensor(0.9386, device='cuda:1')
compute_distance is  tensor(156.5182, device='cuda:1')
compute_norm is  tensor(47.6953, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.8719, device='cuda:1')
distance x is tensor(157.8719, device='cuda:1')
________________________________
test distance is  tensor(157.8719, device='cuda:1')
test distance1 is  tensor(157.8719, device='cuda:1')
test similarity is  tensor(0.9389, device='cuda:1')
test acc is  0.2391166668230046
test loss is 1.610291281742836
test entropy is  1.0322751613186876
________________________________
cal ratio is  0.9687134003278152
distance x is tensor(152.9402, device='cuda:1')
cal_distance is  tensor(152.9402, device='cuda:1')
distance x is tensor(152.9402, device='cuda:1')
return_distance is  tensor(152.9402, device='cuda:1')
distance x is tensor(152.9324, device='cuda:1')
distance x is tensor(152.9324, device='cuda:1')
________________________________
test distance is  tensor(152.9324, device='cuda:1')
test distance1 is  tensor(152.9324, device='cuda:1')
test similarity is  tensor(0.9423, device='cuda:1')
test acc is  0.24043333348967133
test loss is 1.5830181190199943
test entropy is  1.080780158800357
________________________________
0
distance x is tensor(152.9324, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0815487835071742
avg test loss is  1.58160893279098
avg accuracy is  0.6435833334896677
solo acc is  0.24115000015633797
compute similarity  is  tensor(0.9423, device='cuda:1')
compute_distance is  tensor(152.9324, device='cuda:1')
compute_norm is  tensor(47.1992, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(154.2149, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6326988676844884
avg test loss is  2.4566097592494125
avg accuracy is  0.6337666668230016
solo acc is  0.10816666682299862
compute similarity  is  tensor(0.9414, device='cuda:1')
compute_distance is  tensor(154.2149, device='cuda:1')
compute_norm is  tensor(47.1014, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.5213, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9963167152806386
avg test loss is  1.5349537814095584
avg accuracy is  0.6613333334896664
solo acc is  0.24636666682300484
compute similarity  is  tensor(0.9414, device='cuda:1')
compute_distance is  tensor(155.5213, device='cuda:1')
compute_norm is  tensor(46.7930, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(155.5213, device='cuda:1')
distance x is tensor(155.5213, device='cuda:1')
________________________________
test distance is  tensor(155.5213, device='cuda:1')
test distance1 is  tensor(155.5213, device='cuda:1')
test similarity is  tensor(0.9414, device='cuda:1')
test acc is  0.24431666682300474
test loss is 1.5377003337020305
test entropy is  0.9969903549024546
________________________________
cal ratio is  0.9760063743168186
distance x is tensor(151.7974, device='cuda:1')
cal_distance is  tensor(151.7974, device='cuda:1')
distance x is tensor(151.7974, device='cuda:1')
return_distance is  tensor(151.7974, device='cuda:1')
distance x is tensor(151.7897, device='cuda:1')
distance x is tensor(151.7897, device='cuda:1')
________________________________
test distance is  tensor(151.7897, device='cuda:1')
test distance1 is  tensor(151.7897, device='cuda:1')
test similarity is  tensor(0.9439, device='cuda:1')
test acc is  0.2493500001563382
test loss is 1.508986995418443
test entropy is  1.034797879487975
________________________________
0
distance x is tensor(151.7897, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0337016795998188
avg test loss is  1.5093953187531755
avg accuracy is  0.6617833334896663
solo acc is  0.25028333348967163
compute similarity  is  tensor(0.9439, device='cuda:1')
compute_distance is  tensor(151.7897, device='cuda:1')
compute_norm is  tensor(46.6929, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(152.9887, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6151599898648414
avg test loss is  2.3748482938514335
avg accuracy is  0.6460333334896675
solo acc is  0.10690000015633196
compute similarity  is  tensor(0.9431, device='cuda:1')
compute_distance is  tensor(152.9887, device='cuda:1')
compute_norm is  tensor(46.5812, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.2000, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9787197784065946
avg test loss is  1.475528342001982
avg accuracy is  0.6758166668229989
solo acc is  0.25140000015633834
compute similarity  is  tensor(0.9430, device='cuda:1')
compute_distance is  tensor(154.2000, device='cuda:1')
compute_norm is  tensor(46.2923, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(154.2075, device='cuda:1')
________________________________
test distance is  tensor(154.2075, device='cuda:1')
test similarity is  tensor(0.9430, device='cuda:1')
test acc is  0.6756166668229988
test loss is 1.4809173707768861
test entropy is  0.9769953155695502
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2620000001600001
mal loss is 1.482532024383545
mal norm is  tensor(705.1509, device='cuda:1')
distance x is tensor(154.2075, device='cuda:1')
mal distance is  tensor(154.2075, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([12., 12., 20., 17., 12., 17., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 15., 12., 14., 13., 24.,  7., 23.,
        15., 12., 31., 12.,  2., 33., 34., 23.])
count_res tensor([1.9668e-10, 1.9668e-10, 5.8629e-07, 2.9190e-08, 1.9668e-10, 2.9190e-08,
        1.9668e-10, 1.9668e-10, 3.2010e-05, 3.2010e-05, 3.2010e-05, 3.2010e-05,
        3.2010e-05, 3.2010e-05, 3.2010e-05, 3.2010e-05, 3.2010e-05, 3.2010e-05,
        3.2010e-05, 3.2010e-05, 1.9668e-10, 3.9504e-09, 1.9668e-10, 1.4533e-09,
        5.3463e-10, 3.2010e-05, 1.3252e-12, 1.1776e-05, 3.9504e-09, 1.9668e-10,
        3.5104e-02, 1.9668e-10, 8.9292e-15, 2.5938e-01, 7.0507e-01, 1.1776e-05])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 76.51% 

Test Accuracy: 83.41% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.714785423129797
distance x is tensor(131.2238, device='cuda:1')
benign distance is  tensor(131.2238, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1730303335934877
distance x is tensor(123.4426, device='cuda:1')
benign distance is  tensor(123.4426, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1053224839270115
distance x is tensor(116.2502, device='cuda:1')
benign distance is  tensor(116.2502, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1172710247337818
distance x is tensor(160.3888, device='cuda:1')
benign distance is  tensor(160.3888, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3097480796277523
distance x is tensor(118.2252, device='cuda:1')
benign distance is  tensor(118.2252, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9696244113147259
distance x is tensor(115.1023, device='cuda:1')
benign distance is  tensor(115.1023, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3423371315002441
distance x is tensor(107.7682, device='cuda:1')
benign distance is  tensor(107.7682, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0495343431830406
distance x is tensor(98.0632, device='cuda:1')
benign distance is  tensor(98.0632, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1225734949111938
distance x is tensor(117.9174, device='cuda:1')
benign distance is  tensor(117.9174, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.869838647544384
distance x is tensor(132.3983, device='cuda:1')
benign distance is  tensor(132.3983, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5061910673975945
distance x is tensor(91.4676, device='cuda:1')
benign distance is  tensor(91.4676, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.660884127020836
distance x is tensor(118.8439, device='cuda:1')
benign distance is  tensor(118.8439, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7689975313842297
distance x is tensor(164.6566, device='cuda:1')
benign distance is  tensor(164.6566, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0041060484945774
distance x is tensor(74.6301, device='cuda:1')
benign distance is  tensor(74.6301, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2035783361643553
distance x is tensor(107.6542, device='cuda:1')
benign distance is  tensor(107.6542, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.427682489156723
distance x is tensor(126.3445, device='cuda:1')
benign distance is  tensor(126.3445, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5935140866786242
distance x is tensor(120.5131, device='cuda:1')
benign distance is  tensor(120.5131, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1087765786796808
distance x is tensor(107.7821, device='cuda:1')
benign distance is  tensor(107.7821, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.6100178733468056
distance x is tensor(127.2166, device='cuda:1')
benign distance is  tensor(127.2166, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.70262361317873
distance x is tensor(124.7299, device='cuda:1')
benign distance is  tensor(124.7299, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1882602609694004
distance x is tensor(130.2761, device='cuda:1')
benign distance is  tensor(130.2761, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9349757917225361
distance x is tensor(126.8106, device='cuda:1')
benign distance is  tensor(126.8106, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6108945235610008
distance x is tensor(121.8037, device='cuda:1')
benign distance is  tensor(121.8037, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.4617889970541
distance x is tensor(172.0167, device='cuda:1')
benign distance is  tensor(172.0167, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(91.1451, device='cuda:1')
compute distance is  tensor(91.1451, device='cuda:1')
compute norm is  tensor(45.7620, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.3425, device='cuda:1')
compute distance is  tensor(145.3425, device='cuda:1')
compute norm is  tensor(46.8975, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.4770, device='cuda:1')
compute distance is  tensor(111.4770, device='cuda:1')
compute norm is  tensor(46.1635, device='cuda:1', dtype=torch.float64)
distance x is tensor(115.6536, device='cuda:1')
compute distance is  tensor(115.6536, device='cuda:1')
compute norm is  tensor(46.2460, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.9257, device='cuda:1')
compute distance is  tensor(101.9257, device='cuda:1')
compute norm is  tensor(45.8762, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.9151, device='cuda:1')
compute distance is  tensor(132.9151, device='cuda:1')
compute norm is  tensor(46.6181, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.7382, device='cuda:1')
compute distance is  tensor(129.7382, device='cuda:1')
compute norm is  tensor(46.5650, device='cuda:1', dtype=torch.float64)
distance x is tensor(100.0872, device='cuda:1')
compute distance is  tensor(100.0872, device='cuda:1')
compute norm is  tensor(46.0243, device='cuda:1', dtype=torch.float64)
distance x is tensor(124.0080, device='cuda:1')
compute distance is  tensor(124.0080, device='cuda:1')
compute norm is  tensor(46.5564, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.7818, device='cuda:1')
compute distance is  tensor(104.7818, device='cuda:1')
compute norm is  tensor(46.1896, device='cuda:1', dtype=torch.float64)
distance x is tensor(124.5096, device='cuda:1')
compute distance is  tensor(124.5096, device='cuda:1')
compute norm is  tensor(46.2220, device='cuda:1', dtype=torch.float64)
distance x is tensor(160.5417, device='cuda:1')
compute distance is  tensor(160.5417, device='cuda:1')
compute norm is  tensor(47.6183, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(160.5417, device='cuda:1')
distance x is tensor(102051.8281, device='cuda:1')
distance x is tensor(102051.8281, device='cuda:1')
________________________________
test distance is  tensor(102051.8281, device='cuda:1')
test distance1 is  tensor(102051.8281, device='cuda:1')
test similarity is  tensor(0.1068, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107658160166951.3
test entropy is  0.0
________________________________
cal ratio is  0.038869558410599775
distance x is tensor(3966.7148, device='cuda:1')
cal_distance is  tensor(3966.7148, device='cuda:1')
cal ratio is  0.19715350968585896
distance x is tensor(782.0553, device='cuda:1')
cal_distance is  tensor(782.0553, device='cuda:1')
cal ratio is  0.4440187166267914
distance x is tensor(347.2498, device='cuda:1')
cal_distance is  tensor(347.2498, device='cuda:1')
cal ratio is  0.6663447987799067
distance x is tensor(231.3896, device='cuda:1')
cal_distance is  tensor(231.3896, device='cuda:1')
cal ratio is  0.8162968509512625
distance x is tensor(188.8834, device='cuda:1')
cal_distance is  tensor(188.8834, device='cuda:1')
cal ratio is  0.9034894876554637
distance x is tensor(170.6546, device='cuda:1')
cal_distance is  tensor(170.6546, device='cuda:1')
cal ratio is  0.9505193169666196
distance x is tensor(162.2108, device='cuda:1')
cal_distance is  tensor(162.2108, device='cuda:1')
cal ratio is  0.9749451424742819
distance x is tensor(158.1467, device='cuda:1')
cal_distance is  tensor(158.1467, device='cuda:1')
distance x is tensor(158.1467, device='cuda:1')
return_distance is  tensor(158.1467, device='cuda:1')
distance x is tensor(158.1376, device='cuda:1')
distance x is tensor(158.1376, device='cuda:1')
________________________________
test distance is  tensor(158.1376, device='cuda:1')
test distance1 is  tensor(158.1376, device='cuda:1')
test similarity is  tensor(0.9364, device='cuda:1')
test acc is  0.10495000015633195
test loss is 218.36880689999188
test entropy is  0.0015740858213454136
________________________________
0
distance x is tensor(158.1376, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0016296842421092334
avg test loss is  218.16909171879163
avg accuracy is  0.5167666668230089
solo acc is  0.10471666682299864
compute similarity  is  tensor(0.9364, device='cuda:1')
compute_distance is  tensor(158.1376, device='cuda:1')
compute_norm is  tensor(47.8488, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.4643, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.2639277103359003
avg test loss is  2.0310762255176553
avg accuracy is  0.5611333334896741
solo acc is  0.1740500001563349
compute similarity  is  tensor(0.9330, device='cuda:1')
compute_distance is  tensor(165.4643, device='cuda:1')
compute_norm is  tensor(48.6556, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.8199, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7299306606814298
avg test loss is  2.818447706795959
avg accuracy is  0.5603666668230077
solo acc is  0.10641666682299862
compute similarity  is  tensor(0.9322, device='cuda:1')
compute_distance is  tensor(166.8199, device='cuda:1')
compute_norm is  tensor(48.6216, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.4848, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.1087150474601208
avg test loss is  1.778073192405294
avg accuracy is  0.591416666823005
solo acc is  0.21168333348967017
compute similarity  is  tensor(0.9325, device='cuda:1')
compute_distance is  tensor(168.4848, device='cuda:1')
compute_norm is  tensor(48.2783, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.3993, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6633476319470639
avg test loss is  2.597297343872249
avg accuracy is  0.5883000001563385
solo acc is  0.10743333348966529
compute similarity  is  tensor(0.9318, device='cuda:1')
compute_distance is  tensor(169.3993, device='cuda:1')
compute_norm is  tensor(48.1772, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.4808, device='cuda:1')
distance x is tensor(170.4808, device='cuda:1')
________________________________
test distance is  tensor(170.4808, device='cuda:1')
test distance1 is  tensor(170.4808, device='cuda:1')
test similarity is  tensor(0.9319, device='cuda:1')
test acc is  0.2235000001563373
test loss is 1.6647672045713804
test entropy is  1.05121237992732
________________________________
cal ratio is  0.9510037276328324
distance x is tensor(162.1348, device='cuda:1')
cal_distance is  tensor(162.1348, device='cuda:1')
cal ratio is  0.9751736360628062
distance x is tensor(158.1096, device='cuda:1')
cal_distance is  tensor(158.1096, device='cuda:1')
distance x is tensor(158.1096, device='cuda:1')
return_distance is  tensor(158.1096, device='cuda:1')
distance x is tensor(158.1026, device='cuda:1')
distance x is tensor(158.1026, device='cuda:1')
________________________________
test distance is  tensor(158.1026, device='cuda:1')
test distance1 is  tensor(158.1026, device='cuda:1')
test similarity is  tensor(0.9405, device='cuda:1')
test acc is  0.22930000015633759
test loss is 1.6022393750483548
test entropy is  1.1781470618014143
________________________________
0
distance x is tensor(158.1026, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1779187457647913
avg test loss is  1.6023200961318351
avg accuracy is  0.6183000001563361
solo acc is  0.22856666682300422
compute similarity  is  tensor(0.9405, device='cuda:1')
compute_distance is  tensor(158.1026, device='cuda:1')
compute_norm is  tensor(47.4476, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7367974249646068
distance x is tensor(122.5550, device='cuda:1')
benign distance is  tensor(122.5550, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6812127269804478
distance x is tensor(109.3574, device='cuda:1')
benign distance is  tensor(109.3574, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5982755180448294
distance x is tensor(109.1720, device='cuda:1')
benign distance is  tensor(109.1720, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9660952221602201
distance x is tensor(150.2193, device='cuda:1')
benign distance is  tensor(150.2193, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8759544361382723
distance x is tensor(101.4375, device='cuda:1')
benign distance is  tensor(101.4375, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7300969790667295
distance x is tensor(95.9046, device='cuda:1')
benign distance is  tensor(95.9046, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9878654293715954
distance x is tensor(113.3785, device='cuda:1')
benign distance is  tensor(113.3785, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6583704091608524
distance x is tensor(83.6746, device='cuda:1')
benign distance is  tensor(83.6746, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7761906832456589
distance x is tensor(116.7931, device='cuda:1')
benign distance is  tensor(116.7931, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6687531848438084
distance x is tensor(128.0556, device='cuda:1')
benign distance is  tensor(128.0556, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0330519154667854
distance x is tensor(95.9140, device='cuda:1')
benign distance is  tensor(95.9140, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.208203837275505
distance x is tensor(121.4113, device='cuda:1')
benign distance is  tensor(121.4113, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3605481907725334
distance x is tensor(184.3752, device='cuda:1')
benign distance is  tensor(184.3752, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6133308503776789
distance x is tensor(67.0560, device='cuda:1')
benign distance is  tensor(67.0560, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0243861991912127
distance x is tensor(146.2084, device='cuda:1')
benign distance is  tensor(146.2084, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1645121537148952
distance x is tensor(124.0860, device='cuda:1')
benign distance is  tensor(124.0860, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3485489711165428
distance x is tensor(131.7944, device='cuda:1')
benign distance is  tensor(131.7944, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6085301330313087
distance x is tensor(116.8769, device='cuda:1')
benign distance is  tensor(116.8769, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8197470791637897
distance x is tensor(124.7318, device='cuda:1')
benign distance is  tensor(124.7318, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.684678228572011
distance x is tensor(119.3847, device='cuda:1')
benign distance is  tensor(119.3847, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9964462639763951
distance x is tensor(87.8445, device='cuda:1')
benign distance is  tensor(87.8445, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7070093434303999
distance x is tensor(211.4102, device='cuda:1')
benign distance is  tensor(211.4102, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0758133381605148
distance x is tensor(146.7744, device='cuda:1')
benign distance is  tensor(146.7744, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7031278107315302
distance x is tensor(113.0130, device='cuda:1')
benign distance is  tensor(113.0130, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.86372902803123
distance x is tensor(121.5905, device='cuda:1')
benign distance is  tensor(121.5905, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5573588302358985
distance x is tensor(78.2734, device='cuda:1')
benign distance is  tensor(78.2734, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1216411925852299
distance x is tensor(142.7195, device='cuda:1')
benign distance is  tensor(142.7195, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3556011691689491
distance x is tensor(113.2402, device='cuda:1')
benign distance is  tensor(113.2402, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6953193340450525
distance x is tensor(124.5844, device='cuda:1')
benign distance is  tensor(124.5844, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7948471698909998
distance x is tensor(126.0630, device='cuda:1')
benign distance is  tensor(126.0630, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4722514497116208
distance x is tensor(105.5984, device='cuda:1')
benign distance is  tensor(105.5984, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7133491635322571
distance x is tensor(172.7234, device='cuda:1')
benign distance is  tensor(172.7234, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7747407555580139
distance x is tensor(112.9898, device='cuda:1')
benign distance is  tensor(112.9898, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7771390685811639
distance x is tensor(103.9685, device='cuda:1')
benign distance is  tensor(103.9685, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6030186610296369
distance x is tensor(142.7796, device='cuda:1')
benign distance is  tensor(142.7796, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1730650030076504
distance x is tensor(125.1074, device='cuda:1')
benign distance is  tensor(125.1074, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9274017997086048
distance x is tensor(113.5811, device='cuda:1')
benign distance is  tensor(113.5811, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0202742386609316
distance x is tensor(84.1353, device='cuda:1')
benign distance is  tensor(84.1353, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7789276856929064
distance x is tensor(99.7732, device='cuda:1')
benign distance is  tensor(99.7732, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8581427969038486
distance x is tensor(122.4648, device='cuda:1')
benign distance is  tensor(122.4648, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.5252343714237213
distance x is tensor(112.0539, device='cuda:1')
benign distance is  tensor(112.0539, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.4505581371486187
distance x is tensor(141.1594, device='cuda:1')
benign distance is  tensor(141.1594, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1919049210846424
distance x is tensor(148.3143, device='cuda:1')
benign distance is  tensor(148.3143, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0841219648718834
distance x is tensor(98.0639, device='cuda:1')
benign distance is  tensor(98.0639, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5443382412195206
distance x is tensor(158.4354, device='cuda:1')
benign distance is  tensor(158.4354, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6963273137807846
distance x is tensor(140.6894, device='cuda:1')
benign distance is  tensor(140.6894, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6003026915714145
distance x is tensor(104.1803, device='cuda:1')
benign distance is  tensor(104.1803, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6315596764907241
distance x is tensor(132.9844, device='cuda:1')
benign distance is  tensor(132.9844, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  6.736760050058365
distance x is tensor(260.2923, device='cuda:1')
benign distance is  tensor(260.2923, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.201886564493179
distance x is tensor(234.7801, device='cuda:1')
benign distance is  tensor(234.7801, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.76380279660225
distance x is tensor(253.0896, device='cuda:1')
benign distance is  tensor(253.0896, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  6.437201708555222
distance x is tensor(236.8533, device='cuda:1')
benign distance is  tensor(236.8533, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.581291615962982
distance x is tensor(187.0826, device='cuda:1')
benign distance is  tensor(187.0826, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.337292820215225
distance x is tensor(199.4168, device='cuda:1')
benign distance is  tensor(199.4168, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.156829416751862
distance x is tensor(238.5473, device='cuda:1')
benign distance is  tensor(238.5473, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.217999815940857
distance x is tensor(244.8433, device='cuda:1')
benign distance is  tensor(244.8433, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.753224939107895
distance x is tensor(218.2662, device='cuda:1')
benign distance is  tensor(218.2662, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.965237200260162
distance x is tensor(229.8232, device='cuda:1')
benign distance is  tensor(229.8232, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.612594902515411
distance x is tensor(235.3707, device='cuda:1')
benign distance is  tensor(235.3707, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.964508920907974
distance x is tensor(238.9448, device='cuda:1')
benign distance is  tensor(238.9448, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0.,  0.,  0.,  0.,  0.,  3.,  0.,  0., 19., 19., 19., 19., 19., 19.,
        19., 19., 19.,  8., 19., 19.])
count_res tensor([5.0934e-10, 5.0934e-10, 5.0934e-10, 5.0934e-10, 5.0934e-10, 1.0230e-08,
        5.0934e-10, 5.0934e-10, 9.0909e-02, 9.0909e-02, 9.0909e-02, 9.0909e-02,
        9.0909e-02, 9.0909e-02, 9.0909e-02, 9.0909e-02, 9.0909e-02, 1.5183e-06,
        9.0909e-02, 9.0909e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 17.65% 

Test Accuracy: 14.02% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9289555735886097
distance x is tensor(139.9282, device='cuda:1')
benign distance is  tensor(139.9282, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5182334929704666
distance x is tensor(109.4620, device='cuda:1')
benign distance is  tensor(109.4620, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8869767487049103
distance x is tensor(110.5852, device='cuda:1')
benign distance is  tensor(110.5852, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1859909035265446
distance x is tensor(156.1154, device='cuda:1')
benign distance is  tensor(156.1154, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5288119241595268
distance x is tensor(120.9910, device='cuda:1')
benign distance is  tensor(120.9910, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.095375206321478
distance x is tensor(116.4850, device='cuda:1')
benign distance is  tensor(116.4850, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.889057956635952
distance x is tensor(122.2337, device='cuda:1')
benign distance is  tensor(122.2337, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.592340126633644
distance x is tensor(100.3964, device='cuda:1')
benign distance is  tensor(100.3964, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.985014587640762
distance x is tensor(94.5230, device='cuda:1')
benign distance is  tensor(94.5230, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.349232077598572
distance x is tensor(121.3578, device='cuda:1')
benign distance is  tensor(121.3578, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.402297884225845
distance x is tensor(92.8828, device='cuda:1')
benign distance is  tensor(92.8828, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.562523424625397
distance x is tensor(108.9927, device='cuda:1')
benign distance is  tensor(108.9927, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.032347559928894
distance x is tensor(81.4568, device='cuda:1')
benign distance is  tensor(81.4568, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.789850294589996
distance x is tensor(100.0791, device='cuda:1')
benign distance is  tensor(100.0791, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  7.828047841787338
distance x is tensor(116.9423, device='cuda:1')
benign distance is  tensor(116.9423, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.601606845855713
distance x is tensor(84.6357, device='cuda:1')
benign distance is  tensor(84.6357, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.858714818954468
distance x is tensor(107.1835, device='cuda:1')
benign distance is  tensor(107.1835, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.868784666061401
distance x is tensor(97.1514, device='cuda:1')
benign distance is  tensor(97.1514, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  6.968357235193253
distance x is tensor(104.4880, device='cuda:1')
benign distance is  tensor(104.4880, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.064087480306625
distance x is tensor(134.3628, device='cuda:1')
benign distance is  tensor(134.3628, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 2., 26., 27., 25., 24., 27.,  1.,  5., 27., 27., 27.,  8., 27., 27.,
        24., 27., 26., 14., 27., 22.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.])
count_res tensor([1.3919e-12, 3.6871e-02, 1.0023e-01, 1.3564e-02, 4.9900e-03, 1.0023e-01,
        5.1207e-13, 2.7958e-11, 1.0023e-01, 1.0023e-01, 1.0023e-01, 5.6155e-10,
        1.0023e-01, 1.0023e-01, 4.9900e-03, 1.0023e-01, 3.6871e-02, 2.2654e-07,
        1.0023e-01, 6.7532e-04, 1.8838e-13, 1.8838e-13, 1.8838e-13, 1.8838e-13,
        1.8838e-13, 1.8838e-13, 1.8838e-13, 1.8838e-13])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 19.20% 

Test Accuracy: 6.70% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9657212551683187
distance x is tensor(140.9686, device='cuda:1')
benign distance is  tensor(140.9686, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4082433581352234
distance x is tensor(116.4466, device='cuda:1')
benign distance is  tensor(116.4466, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.9922920763492584
distance x is tensor(111.5052, device='cuda:1')
benign distance is  tensor(111.5052, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2527357749640942
distance x is tensor(152.8042, device='cuda:1')
benign distance is  tensor(152.8042, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3054251819849014
distance x is tensor(128.3964, device='cuda:1')
benign distance is  tensor(128.3964, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0252253897488117
distance x is tensor(120.1909, device='cuda:1')
benign distance is  tensor(120.1909, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6997491717338562
distance x is tensor(124.9145, device='cuda:1')
benign distance is  tensor(124.9145, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4345704168081284
distance x is tensor(110.7263, device='cuda:1')
benign distance is  tensor(110.7263, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.278169870376587
distance x is tensor(113.8113, device='cuda:1')
benign distance is  tensor(113.8113, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9960010796785355
distance x is tensor(147.2235, device='cuda:1')
benign distance is  tensor(147.2235, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.329788513481617
distance x is tensor(107.8899, device='cuda:1')
benign distance is  tensor(107.8899, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.0642879605293274
distance x is tensor(117.6734, device='cuda:1')
benign distance is  tensor(117.6734, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.8613998964428902
distance x is tensor(153.5020, device='cuda:1')
benign distance is  tensor(153.5020, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.211021602153778
distance x is tensor(91.8326, device='cuda:1')
benign distance is  tensor(91.8326, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.009505856782198
distance x is tensor(153.8664, device='cuda:1')
benign distance is  tensor(153.8664, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.167591378092766
distance x is tensor(130.3444, device='cuda:1')
benign distance is  tensor(130.3444, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.505455523729324
distance x is tensor(82.2117, device='cuda:1')
benign distance is  tensor(82.2117, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.962212175130844
distance x is tensor(118.1000, device='cuda:1')
benign distance is  tensor(118.1000, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.595190346240997
distance x is tensor(93.0514, device='cuda:1')
benign distance is  tensor(93.0514, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.802728295326233
distance x is tensor(104.0021, device='cuda:1')
benign distance is  tensor(104.0021, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.3204885721206665
distance x is tensor(72.1276, device='cuda:1')
benign distance is  tensor(72.1276, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.458096653223038
distance x is tensor(91.8912, device='cuda:1')
benign distance is  tensor(91.8912, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.438659459352493
distance x is tensor(108.0164, device='cuda:1')
benign distance is  tensor(108.0164, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.5691619515419
distance x is tensor(80.5325, device='cuda:1')
benign distance is  tensor(80.5325, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.914826333522797
distance x is tensor(100.1350, device='cuda:1')
benign distance is  tensor(100.1350, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.034157991409302
distance x is tensor(94.4629, device='cuda:1')
benign distance is  tensor(94.4629, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.995477974414825
distance x is tensor(100.4186, device='cuda:1')
benign distance is  tensor(100.4186, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.968348354101181
distance x is tensor(129.6867, device='cuda:1')
benign distance is  tensor(129.6867, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([10., 25., 27.,  3., 26., 26., 26.,  2., 24., 26., 25., 27., 27., 27.,
         9., 24., 26., 27.,  4., 26.,  0.,  0.,  0.,  1.,  0.,  1.,  1.,  0.])
count_res tensor([5.4634e-09, 1.7860e-02, 1.3197e-01, 4.9820e-12, 4.8549e-02, 4.8549e-02,
        4.8549e-02, 1.8328e-12, 6.5704e-03, 4.8549e-02, 1.7860e-02, 1.3197e-01,
        1.3197e-01, 1.3197e-01, 2.0099e-09, 6.5704e-03, 4.8549e-02, 1.3197e-01,
        1.3543e-11, 4.8549e-02, 2.4804e-13, 2.4804e-13, 2.4804e-13, 6.7424e-13,
        2.4804e-13, 6.7424e-13, 6.7424e-13, 2.4804e-13])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 35.78% 

Test Accuracy: 15.34% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8612235747277737
distance x is tensor(145.7502, device='cuda:1')
benign distance is  tensor(145.7502, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.483395017683506
distance x is tensor(116.3699, device='cuda:1')
benign distance is  tensor(116.3699, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.179785057902336
distance x is tensor(104.8225, device='cuda:1')
benign distance is  tensor(104.8225, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6420104503631592
distance x is tensor(153.0838, device='cuda:1')
benign distance is  tensor(153.0838, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3511803224682808
distance x is tensor(119.5040, device='cuda:1')
benign distance is  tensor(119.5040, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2186889722943306
distance x is tensor(115.0952, device='cuda:1')
benign distance is  tensor(115.0952, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1384261325001717
distance x is tensor(117.8616, device='cuda:1')
benign distance is  tensor(117.8616, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7801435589790344
distance x is tensor(105.6266, device='cuda:1')
benign distance is  tensor(105.6266, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.9877066537737846
distance x is tensor(117.7593, device='cuda:1')
benign distance is  tensor(117.7593, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1885511465370655
distance x is tensor(112.9341, device='cuda:1')
benign distance is  tensor(112.9341, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.739741288125515
distance x is tensor(116.0346, device='cuda:1')
benign distance is  tensor(116.0346, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.068562924861908
distance x is tensor(128.3454, device='cuda:1')
benign distance is  tensor(128.3454, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.5322131365537643
distance x is tensor(114.0832, device='cuda:1')
benign distance is  tensor(114.0832, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9082371406257153
distance x is tensor(189.8213, device='cuda:1')
benign distance is  tensor(189.8213, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4753341488540173
distance x is tensor(157.0148, device='cuda:1')
benign distance is  tensor(157.0148, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0682874508202076
distance x is tensor(126.2790, device='cuda:1')
benign distance is  tensor(126.2790, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.870822042226791
distance x is tensor(88.7994, device='cuda:1')
benign distance is  tensor(88.7994, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.139923810958862
distance x is tensor(119.3331, device='cuda:1')
benign distance is  tensor(119.3331, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.782990664243698
distance x is tensor(96.1015, device='cuda:1')
benign distance is  tensor(96.1015, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.519110232591629
distance x is tensor(95.7700, device='cuda:1')
benign distance is  tensor(95.7700, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.271574050188065
distance x is tensor(71.2064, device='cuda:1')
benign distance is  tensor(71.2064, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.918819278478622
distance x is tensor(92.7938, device='cuda:1')
benign distance is  tensor(92.7938, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.678679257631302
distance x is tensor(111.4919, device='cuda:1')
benign distance is  tensor(111.4919, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.720902442932129
distance x is tensor(83.1052, device='cuda:1')
benign distance is  tensor(83.1052, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.015242516994476
distance x is tensor(104.0031, device='cuda:1')
benign distance is  tensor(104.0031, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.597962617874146
distance x is tensor(92.5467, device='cuda:1')
benign distance is  tensor(92.5467, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.465253829956055
distance x is tensor(103.3675, device='cuda:1')
benign distance is  tensor(103.3675, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.39123684167862
distance x is tensor(128.2260, device='cuda:1')
benign distance is  tensor(128.2260, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0.,  4., 35.,  2., 35., 35., 15.,  2., 34., 32., 34., 25., 35., 30.,
        31., 32., 14.,  0.,  0., 34.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,
        34., 33., 35., 12., 35., 35., 35., 35.])
count_res tensor([5.8753e-17, 3.2078e-15, 9.3183e-02, 4.3413e-16, 9.3183e-02, 9.3183e-02,
        1.9207e-10, 4.3413e-16, 3.4280e-02, 4.6393e-03, 3.4280e-02, 4.2305e-06,
        9.3183e-02, 6.2786e-04, 1.7067e-03, 4.6393e-03, 7.0657e-11, 5.8753e-17,
        5.8753e-17, 3.4280e-02, 5.8753e-17, 5.8753e-17, 5.8753e-17, 5.8753e-17,
        5.8753e-17, 5.8753e-17, 5.8753e-17, 1.5971e-16, 3.4280e-02, 1.2611e-02,
        9.3183e-02, 9.5624e-12, 9.3183e-02, 9.3183e-02, 9.3183e-02, 9.3183e-02])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 80.03% 

Test Accuracy: 82.76% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8760080300271511
distance x is tensor(119.5174, device='cuda:1')
benign distance is  tensor(119.5174, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.147589635103941
distance x is tensor(98.2641, device='cuda:1')
benign distance is  tensor(98.2641, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1692273654043674
distance x is tensor(93.3562, device='cuda:1')
benign distance is  tensor(93.3562, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.660343311727047
distance x is tensor(134.3903, device='cuda:1')
benign distance is  tensor(134.3903, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.117172732949257
distance x is tensor(94.0972, device='cuda:1')
benign distance is  tensor(94.0972, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.924699179828167
distance x is tensor(100.6161, device='cuda:1')
benign distance is  tensor(100.6161, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5958627089858055
distance x is tensor(103.6320, device='cuda:1')
benign distance is  tensor(103.6320, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3063572905957699
distance x is tensor(88.6828, device='cuda:1')
benign distance is  tensor(88.6828, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3798778168857098
distance x is tensor(94.6470, device='cuda:1')
benign distance is  tensor(94.6470, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9111300986260176
distance x is tensor(122.0362, device='cuda:1')
benign distance is  tensor(122.0362, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3624107539653778
distance x is tensor(78.7650, device='cuda:1')
benign distance is  tensor(78.7650, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.5772977843880653
distance x is tensor(102.3386, device='cuda:1')
benign distance is  tensor(102.3386, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2782089933753014
distance x is tensor(143.8042, device='cuda:1')
benign distance is  tensor(143.8042, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.937733493745327
distance x is tensor(68.8854, device='cuda:1')
benign distance is  tensor(68.8854, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1458322331309319
distance x is tensor(123.0270, device='cuda:1')
benign distance is  tensor(123.0270, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2708796560764313
distance x is tensor(107.2852, device='cuda:1')
benign distance is  tensor(107.2852, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1993554718792439
distance x is tensor(118.1234, device='cuda:1')
benign distance is  tensor(118.1234, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9680728800594807
distance x is tensor(70.6739, device='cuda:1')
benign distance is  tensor(70.6739, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3852198496460915
distance x is tensor(111.7346, device='cuda:1')
benign distance is  tensor(111.7346, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.1097389683127403
distance x is tensor(101.2380, device='cuda:1')
benign distance is  tensor(101.2380, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0221648775041103
distance x is tensor(115.6028, device='cuda:1')
benign distance is  tensor(115.6028, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.2010444663465023
distance x is tensor(143.3129, device='cuda:1')
benign distance is  tensor(143.3129, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7283261027187109
distance x is tensor(125.0977, device='cuda:1')
benign distance is  tensor(125.0977, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0611436739563942
distance x is tensor(154.0757, device='cuda:1')
benign distance is  tensor(154.0757, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.579956471920013
distance x is tensor(115.3261, device='cuda:1')
benign distance is  tensor(115.3261, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.0351742804050446
distance x is tensor(136.6931, device='cuda:1')
benign distance is  tensor(136.6931, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.452396035194397
distance x is tensor(112.6708, device='cuda:1')
benign distance is  tensor(112.6708, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.857978343963623
distance x is tensor(116.3737, device='cuda:1')
benign distance is  tensor(116.3737, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.996823757886887
distance x is tensor(89.6336, device='cuda:1')
benign distance is  tensor(89.6336, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.108507722616196
distance x is tensor(105.7151, device='cuda:1')
benign distance is  tensor(105.7151, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.549449443817139
distance x is tensor(126.6143, device='cuda:1')
benign distance is  tensor(126.6143, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  6.980920642614365
distance x is tensor(114.6716, device='cuda:1')
benign distance is  tensor(114.6716, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.344078153371811
distance x is tensor(127.3917, device='cuda:1')
benign distance is  tensor(127.3917, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.73679119348526
distance x is tensor(114.4592, device='cuda:1')
benign distance is  tensor(114.4592, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.862488657236099
distance x is tensor(124.6058, device='cuda:1')
benign distance is  tensor(124.6058, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.533415913581848
distance x is tensor(146.0888, device='cuda:1')
benign distance is  tensor(146.0888, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0., 17., 24.,  0.,  3., 27.,  1., 27., 27., 27., 27., 27., 26., 26.,
        26., 27., 27., 27., 27., 27.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.])
count_res tensor([1.5465e-13, 3.7356e-06, 4.0965e-03, 1.5465e-13, 3.1062e-12, 8.2281e-02,
        4.2038e-13, 8.2281e-02, 8.2281e-02, 8.2281e-02, 8.2281e-02, 8.2281e-02,
        3.0269e-02, 3.0269e-02, 3.0269e-02, 8.2281e-02, 8.2281e-02, 8.2281e-02,
        8.2281e-02, 8.2281e-02, 1.5465e-13, 1.5465e-13, 1.5465e-13, 1.5465e-13,
        1.5465e-13, 1.5465e-13, 1.5465e-13, 1.5465e-13])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 40.70% 

Test Accuracy: 12.64% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9633488208055496
distance x is tensor(139.3938, device='cuda:1')
benign distance is  tensor(139.3938, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4083978869020939
distance x is tensor(122.8449, device='cuda:1')
benign distance is  tensor(122.8449, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3067337572574615
distance x is tensor(123.9676, device='cuda:1')
benign distance is  tensor(123.9676, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.257676262408495
distance x is tensor(159.6897, device='cuda:1')
benign distance is  tensor(159.6897, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.397507704794407
distance x is tensor(125.8971, device='cuda:1')
benign distance is  tensor(125.8971, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.00282833725214
distance x is tensor(122.4493, device='cuda:1')
benign distance is  tensor(122.4493, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8167164400219917
distance x is tensor(125.8770, device='cuda:1')
benign distance is  tensor(125.8770, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1585515066981316
distance x is tensor(107.6685, device='cuda:1')
benign distance is  tensor(107.6685, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0130243673920631
distance x is tensor(129.2277, device='cuda:1')
benign distance is  tensor(129.2277, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.41403628885746
distance x is tensor(124.3096, device='cuda:1')
benign distance is  tensor(124.3096, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.3328482024371624
distance x is tensor(151.2367, device='cuda:1')
benign distance is  tensor(151.2367, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.9017793089151382
distance x is tensor(140.6088, device='cuda:1')
benign distance is  tensor(140.6088, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9203962981700897
distance x is tensor(136.4047, device='cuda:1')
benign distance is  tensor(136.4047, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.242053333669901
distance x is tensor(121.5933, device='cuda:1')
benign distance is  tensor(121.5933, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.3005062453448772
distance x is tensor(111.9307, device='cuda:1')
benign distance is  tensor(111.9307, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8220613654702902
distance x is tensor(131.7277, device='cuda:1')
benign distance is  tensor(131.7277, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.289211690425873
distance x is tensor(84.4558, device='cuda:1')
benign distance is  tensor(84.4558, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.407397210597992
distance x is tensor(118.3335, device='cuda:1')
benign distance is  tensor(118.3335, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.168241441249847
distance x is tensor(84.4631, device='cuda:1')
benign distance is  tensor(84.4631, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.217530936002731
distance x is tensor(87.4236, device='cuda:1')
benign distance is  tensor(87.4236, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.444373428821564
distance x is tensor(73.5133, device='cuda:1')
benign distance is  tensor(73.5133, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.395391553640366
distance x is tensor(96.3643, device='cuda:1')
benign distance is  tensor(96.3643, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.716280907392502
distance x is tensor(108.3417, device='cuda:1')
benign distance is  tensor(108.3417, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.542709767818451
distance x is tensor(80.6052, device='cuda:1')
benign distance is  tensor(80.6052, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.517178118228912
distance x is tensor(104.7736, device='cuda:1')
benign distance is  tensor(104.7736, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.58527785539627
distance x is tensor(92.4053, device='cuda:1')
benign distance is  tensor(92.4053, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.870378613471985
distance x is tensor(100.0074, device='cuda:1')
benign distance is  tensor(100.0074, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  6.934269428253174
distance x is tensor(127.8557, device='cuda:1')
benign distance is  tensor(127.8557, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([ 0., 42., 43., 42.,  3., 40., 43.,  4.,  6., 39., 37., 17., 40., 39.,
         3., 36.,  0.,  0., 40., 43.,  0.,  0.,  0., 43.,  0.,  0.,  0.,  0.,
        42., 40., 43., 42., 43., 13., 13., 38., 43.,  7., 43.,  0., 43., 42.,
         0.,  0.])
count_res tensor([1.9080e-20, 3.3186e-02, 9.0210e-02, 3.3186e-02, 3.8324e-19, 4.4913e-03,
        9.0210e-02, 1.0418e-18, 7.6976e-18, 1.6522e-03, 2.2361e-04, 4.6089e-13,
        4.4913e-03, 1.6522e-03, 3.8324e-19, 8.2260e-05, 1.9080e-20, 1.9080e-20,
        4.4913e-03, 9.0210e-02, 1.9080e-20, 1.9080e-20, 1.9080e-20, 9.0210e-02,
        1.9080e-20, 1.9080e-20, 1.9080e-20, 1.9080e-20, 3.3186e-02, 4.4913e-03,
        9.0210e-02, 3.3186e-02, 9.0210e-02, 8.4415e-15, 8.4415e-15, 6.0783e-04,
        9.0210e-02, 2.0924e-17, 9.0210e-02, 1.9080e-20, 9.0210e-02, 3.3186e-02,
        1.9080e-20, 1.9080e-20])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 77.85% 

Test Accuracy: 82.82% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9675516076385975
distance x is tensor(122.1993, device='cuda:1')
benign distance is  tensor(122.1993, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0015315264463425
distance x is tensor(96.3159, device='cuda:1')
benign distance is  tensor(96.3159, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.446807760745287
distance x is tensor(92.5655, device='cuda:1')
benign distance is  tensor(92.5655, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3449626453220844
distance x is tensor(134.1358, device='cuda:1')
benign distance is  tensor(134.1358, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.398478627204895
distance x is tensor(95.8606, device='cuda:1')
benign distance is  tensor(95.8606, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7969487104564905
distance x is tensor(97.1818, device='cuda:1')
benign distance is  tensor(97.1818, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5516830869019032
distance x is tensor(86.6391, device='cuda:1')
benign distance is  tensor(86.6391, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9021729752421379
distance x is tensor(86.2503, device='cuda:1')
benign distance is  tensor(86.2503, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2513876520097256
distance x is tensor(86.5260, device='cuda:1')
benign distance is  tensor(86.5260, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7986237984150648
distance x is tensor(116.1327, device='cuda:1')
benign distance is  tensor(116.1327, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4254184402525425
distance x is tensor(69.6082, device='cuda:1')
benign distance is  tensor(69.6082, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.847965158522129
distance x is tensor(104.3128, device='cuda:1')
benign distance is  tensor(104.3128, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3843744695186615
distance x is tensor(134.0873, device='cuda:1')
benign distance is  tensor(134.0873, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9717052988708019
distance x is tensor(62.4693, device='cuda:1')
benign distance is  tensor(62.4693, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2132445871829987
distance x is tensor(129.3588, device='cuda:1')
benign distance is  tensor(129.3588, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2983029782772064
distance x is tensor(108.1404, device='cuda:1')
benign distance is  tensor(108.1404, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4871636480093002
distance x is tensor(83.9431, device='cuda:1')
benign distance is  tensor(83.9431, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1062407046556473
distance x is tensor(99.4281, device='cuda:1')
benign distance is  tensor(99.4281, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2694043572992086
distance x is tensor(100.8093, device='cuda:1')
benign distance is  tensor(100.8093, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0949489176273346
distance x is tensor(110.9493, device='cuda:1')
benign distance is  tensor(110.9493, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.277493067085743
distance x is tensor(72.4423, device='cuda:1')
benign distance is  tensor(72.4423, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8406435791403055
distance x is tensor(180.5951, device='cuda:1')
benign distance is  tensor(180.5951, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3485223650932312
distance x is tensor(136.7279, device='cuda:1')
benign distance is  tensor(136.7279, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.040159061551094
distance x is tensor(104.8979, device='cuda:1')
benign distance is  tensor(104.8979, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.427088089287281
distance x is tensor(104.0892, device='cuda:1')
benign distance is  tensor(104.0892, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.6299373805522919
distance x is tensor(113.6878, device='cuda:1')
benign distance is  tensor(113.6878, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.5599581226706505
distance x is tensor(134.4273, device='cuda:1')
benign distance is  tensor(134.4273, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.208048902451992
distance x is tensor(85.9394, device='cuda:1')
benign distance is  tensor(85.9394, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6724098082631826
distance x is tensor(147.2831, device='cuda:1')
benign distance is  tensor(147.2831, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9897869937121868
distance x is tensor(118.1281, device='cuda:1')
benign distance is  tensor(118.1281, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0845997743308544
distance x is tensor(92.9404, device='cuda:1')
benign distance is  tensor(92.9404, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6329006478190422
distance x is tensor(119.8692, device='cuda:1')
benign distance is  tensor(119.8692, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.09387195110321
distance x is tensor(128.6344, device='cuda:1')
benign distance is  tensor(128.6344, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.281702876091003
distance x is tensor(146.3253, device='cuda:1')
benign distance is  tensor(146.3253, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.574340581893921
distance x is tensor(126.6995, device='cuda:1')
benign distance is  tensor(126.6995, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.232507765293121
distance x is tensor(128.8463, device='cuda:1')
benign distance is  tensor(128.8463, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.120960175991058
distance x is tensor(99.5706, device='cuda:1')
benign distance is  tensor(99.5706, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  4.705660492181778
distance x is tensor(115.6527, device='cuda:1')
benign distance is  tensor(115.6527, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.240209519863129
distance x is tensor(135.9640, device='cuda:1')
benign distance is  tensor(135.9640, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.818279832601547
distance x is tensor(120.7901, device='cuda:1')
benign distance is  tensor(120.7901, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.3540865778923035
distance x is tensor(127.6321, device='cuda:1')
benign distance is  tensor(127.6321, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.604835987091064
distance x is tensor(119.2250, device='cuda:1')
benign distance is  tensor(119.2250, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.725692570209503
distance x is tensor(127.2499, device='cuda:1')
benign distance is  tensor(127.2499, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.004851818084717
distance x is tensor(148.2508, device='cuda:1')
benign distance is  tensor(148.2508, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0.,  0.,  4.,  0.,  0., 11.,  0.,  0., 18., 19., 18., 19., 19., 19.,
         0., 19., 19., 19., 17., 19.])
count_res tensor([6.3156e-10, 6.3156e-10, 3.4482e-08, 6.3156e-10, 6.3156e-10, 3.7814e-05,
        6.3156e-10, 6.3156e-10, 4.1468e-02, 1.1272e-01, 4.1468e-02, 1.1272e-01,
        1.1272e-01, 1.1272e-01, 6.3156e-10, 1.1272e-01, 1.1272e-01, 1.1272e-01,
        1.5255e-02, 1.1272e-01])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 34.92% 

Test Accuracy: 10.94% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.055132769048214
distance x is tensor(145.5381, device='cuda:1')
benign distance is  tensor(145.5381, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6220920644700527
distance x is tensor(135.8523, device='cuda:1')
benign distance is  tensor(135.8523, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8589463382959366
distance x is tensor(131.0871, device='cuda:1')
benign distance is  tensor(131.0871, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0584414899349213
distance x is tensor(165.1988, device='cuda:1')
benign distance is  tensor(165.1988, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7117889747023582
distance x is tensor(136.5492, device='cuda:1')
benign distance is  tensor(136.5492, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9341519195586443
distance x is tensor(134.3170, device='cuda:1')
benign distance is  tensor(134.3170, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6767246909439564
distance x is tensor(133.2599, device='cuda:1')
benign distance is  tensor(133.2599, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2482816390693188
distance x is tensor(115.6895, device='cuda:1')
benign distance is  tensor(115.6895, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.337113976478577
distance x is tensor(81.5725, device='cuda:1')
benign distance is  tensor(81.5725, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.955465912818909
distance x is tensor(118.1544, device='cuda:1')
benign distance is  tensor(118.1544, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.599251687526703
distance x is tensor(83.8584, device='cuda:1')
benign distance is  tensor(83.8584, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.637833833694458
distance x is tensor(88.5072, device='cuda:1')
benign distance is  tensor(88.5072, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.080996483564377
distance x is tensor(74.4710, device='cuda:1')
benign distance is  tensor(74.4710, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.248984009027481
distance x is tensor(97.4918, device='cuda:1')
benign distance is  tensor(97.4918, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.179924964904785
distance x is tensor(109.8055, device='cuda:1')
benign distance is  tensor(109.8055, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.27668571472168
distance x is tensor(80.2646, device='cuda:1')
benign distance is  tensor(80.2646, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.375403344631195
distance x is tensor(99.9220, device='cuda:1')
benign distance is  tensor(99.9220, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.911418169736862
distance x is tensor(85.7405, device='cuda:1')
benign distance is  tensor(85.7405, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.225204825401306
distance x is tensor(100.4976, device='cuda:1')
benign distance is  tensor(100.4976, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.21643215417862
distance x is tensor(125.5601, device='cuda:1')
benign distance is  tensor(125.5601, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0., 31., 35., 35., 35., 32.,  0., 19., 27.,  0., 30., 35., 28.,  7.,
         0., 18., 29., 35.,  0.,  0.,  0., 34., 17., 35., 35., 35.,  6., 35.,
        23.,  0.,  0.,  0., 29.,  5.,  0., 34.])
count_res tensor([6.4228e-17, 1.8657e-03, 1.0187e-01, 1.0187e-01, 1.0187e-01, 5.0716e-03,
        6.4228e-17, 1.1464e-08, 3.4172e-05, 6.4228e-17, 6.8637e-04, 1.0187e-01,
        9.2890e-05, 7.0434e-14, 6.4228e-17, 4.2172e-09, 2.5250e-04, 1.0187e-01,
        6.4228e-17, 6.4228e-17, 6.4228e-17, 3.7474e-02, 1.5514e-09, 1.0187e-01,
        1.0187e-01, 1.0187e-01, 2.5911e-14, 1.0187e-01, 6.2589e-07, 6.4228e-17,
        6.4228e-17, 6.4228e-17, 2.5250e-04, 9.5322e-15, 6.4228e-17, 3.7474e-02])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 76.70% 

Test Accuracy: 81.20% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7800232190638781
distance x is tensor(126.7558, device='cuda:1')
benign distance is  tensor(126.7558, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1384369991719723
distance x is tensor(100.7895, device='cuda:1')
benign distance is  tensor(100.7895, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3630969934165478
distance x is tensor(92.7345, device='cuda:1')
benign distance is  tensor(92.7345, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4008450582623482
distance x is tensor(142.1696, device='cuda:1')
benign distance is  tensor(142.1696, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3434135615825653
distance x is tensor(94.4571, device='cuda:1')
benign distance is  tensor(94.4571, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.998801676556468
distance x is tensor(97.5371, device='cuda:1')
benign distance is  tensor(97.5371, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1932315863668919
distance x is tensor(96.3967, device='cuda:1')
benign distance is  tensor(96.3967, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7976362351328135
distance x is tensor(90.2337, device='cuda:1')
benign distance is  tensor(90.2337, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.227146465331316
distance x is tensor(90.1949, device='cuda:1')
benign distance is  tensor(90.1949, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8961033262312412
distance x is tensor(114.6405, device='cuda:1')
benign distance is  tensor(114.6405, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.602481510490179
distance x is tensor(69.2205, device='cuda:1')
benign distance is  tensor(69.2205, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.84678116440773
distance x is tensor(103.6014, device='cuda:1')
benign distance is  tensor(103.6014, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1729333214461803
distance x is tensor(134.8678, device='cuda:1')
benign distance is  tensor(134.8678, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.847448393702507
distance x is tensor(68.3641, device='cuda:1')
benign distance is  tensor(68.3641, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9122591856867075
distance x is tensor(130.0116, device='cuda:1')
benign distance is  tensor(130.0116, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9199750572443008
distance x is tensor(108.0636, device='cuda:1')
benign distance is  tensor(108.0636, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0465142410248518
distance x is tensor(113.4138, device='cuda:1')
benign distance is  tensor(113.4138, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.945683591067791
distance x is tensor(76.8592, device='cuda:1')
benign distance is  tensor(76.8592, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.086659412831068
distance x is tensor(113.7447, device='cuda:1')
benign distance is  tensor(113.7447, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.7108313366770744
distance x is tensor(103.8710, device='cuda:1')
benign distance is  tensor(103.8710, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.015004113316536
distance x is tensor(105.9506, device='cuda:1')
benign distance is  tensor(105.9506, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0784900188446045
distance x is tensor(95.7016, device='cuda:1')
benign distance is  tensor(95.7016, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6104471022263169
distance x is tensor(102.2990, device='cuda:1')
benign distance is  tensor(102.2990, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.2575281336903572
distance x is tensor(145.1844, device='cuda:1')
benign distance is  tensor(145.1844, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.870668262243271
distance x is tensor(116.1362, device='cuda:1')
benign distance is  tensor(116.1362, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.124226421117783
distance x is tensor(136.5707, device='cuda:1')
benign distance is  tensor(136.5707, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.827554941177368
distance x is tensor(114.3130, device='cuda:1')
benign distance is  tensor(114.3130, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.929027140140533
distance x is tensor(115.0846, device='cuda:1')
benign distance is  tensor(115.0846, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.354293018579483
distance x is tensor(95.4241, device='cuda:1')
benign distance is  tensor(95.4241, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.555794209241867
distance x is tensor(109.1425, device='cuda:1')
benign distance is  tensor(109.1425, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.45221608877182
distance x is tensor(130.1395, device='cuda:1')
benign distance is  tensor(130.1395, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.229177504777908
distance x is tensor(109.8549, device='cuda:1')
benign distance is  tensor(109.8549, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.593992471694946
distance x is tensor(124.5303, device='cuda:1')
benign distance is  tensor(124.5303, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.032934129238129
distance x is tensor(110.0671, device='cuda:1')
benign distance is  tensor(110.0671, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.094267100095749
distance x is tensor(124.9939, device='cuda:1')
benign distance is  tensor(124.9939, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.19471424818039
distance x is tensor(146.9616, device='cuda:1')
benign distance is  tensor(146.9616, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  2., 26.,  0.,  7., 17.,  0.,  0., 27., 26., 26.,  1., 27., 27.,
        25., 27., 25., 27., 21., 27.,  1.,  2., 25., 27.,  0.,  0., 27.,  0.])
count_res tensor([1.9759e-13, 1.4600e-12, 3.8675e-02, 1.9759e-13, 2.1669e-10, 4.7728e-06,
        1.9759e-13, 1.9759e-13, 1.0513e-01, 3.8675e-02, 3.8675e-02, 5.3711e-13,
        1.0513e-01, 1.0513e-01, 1.4228e-02, 1.0513e-01, 1.4228e-02, 1.0513e-01,
        2.6059e-04, 1.0513e-01, 5.3711e-13, 1.4600e-12, 1.4228e-02, 1.0513e-01,
        1.9759e-13, 1.9759e-13, 1.0513e-01, 1.9759e-13])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 61.52% 

Test Accuracy: 21.43% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7030345015227795
distance x is tensor(132.4838, device='cuda:1')
benign distance is  tensor(132.4838, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2702250964939594
distance x is tensor(116.4901, device='cuda:1')
benign distance is  tensor(116.4901, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3111355863511562
distance x is tensor(116.4723, device='cuda:1')
benign distance is  tensor(116.4723, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1665460355579853
distance x is tensor(144.5240, device='cuda:1')
benign distance is  tensor(144.5240, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6197827085852623
distance x is tensor(122.7626, device='cuda:1')
benign distance is  tensor(122.7626, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9474782114848495
distance x is tensor(114.8331, device='cuda:1')
benign distance is  tensor(114.8331, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3837666437029839
distance x is tensor(109.1868, device='cuda:1')
benign distance is  tensor(109.1868, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9408143274486065
distance x is tensor(101.0227, device='cuda:1')
benign distance is  tensor(101.0227, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6015671640634537
distance x is tensor(107.7169, device='cuda:1')
benign distance is  tensor(107.7169, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0042397398501635
distance x is tensor(113.0265, device='cuda:1')
benign distance is  tensor(113.0265, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.490049373358488
distance x is tensor(119.5309, device='cuda:1')
benign distance is  tensor(119.5309, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4485715851187706
distance x is tensor(122.8668, device='cuda:1')
benign distance is  tensor(122.8668, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3250470161437988
distance x is tensor(103.8097, device='cuda:1')
benign distance is  tensor(103.8097, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8479015603661537
distance x is tensor(197.1937, device='cuda:1')
benign distance is  tensor(197.1937, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4817906208336353
distance x is tensor(155.6710, device='cuda:1')
benign distance is  tensor(155.6710, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9714637883007526
distance x is tensor(125.4790, device='cuda:1')
benign distance is  tensor(125.4790, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.296591997146606
distance x is tensor(84.2537, device='cuda:1')
benign distance is  tensor(84.2537, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.504392147064209
distance x is tensor(129.2047, device='cuda:1')
benign distance is  tensor(129.2047, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.812569826841354
distance x is tensor(87.6059, device='cuda:1')
benign distance is  tensor(87.6059, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.98955300450325
distance x is tensor(95.5449, device='cuda:1')
benign distance is  tensor(95.5449, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.699821203947067
distance x is tensor(79.8780, device='cuda:1')
benign distance is  tensor(79.8780, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.486104339361191
distance x is tensor(101.7326, device='cuda:1')
benign distance is  tensor(101.7326, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.466792345046997
distance x is tensor(111.9943, device='cuda:1')
benign distance is  tensor(111.9943, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  6.740920305252075
distance x is tensor(82.2136, device='cuda:1')
benign distance is  tensor(82.2136, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.418428152799606
distance x is tensor(105.4769, device='cuda:1')
benign distance is  tensor(105.4769, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.204071134328842
distance x is tensor(90.6906, device='cuda:1')
benign distance is  tensor(90.6906, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.1041179895401
distance x is tensor(103.1134, device='cuda:1')
benign distance is  tensor(103.1134, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.664494633674622
distance x is tensor(124.7901, device='cuda:1')
benign distance is  tensor(124.7901, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0.,  0.,  0.,  0.,  0.,  8., 35., 35.,  0., 35., 32.,  0., 35., 34.,
         0., 26., 31., 32.,  0., 12., 34., 35., 35., 35., 35.,  2., 35., 35.,
         5.,  0., 34.,  1.,  0., 35., 13., 35.])
count_res tensor([4.7688e-17, 4.7688e-17, 4.7688e-17, 4.7688e-17, 4.7688e-17, 1.4216e-13,
        7.5634e-02, 7.5634e-02, 4.7688e-17, 7.5634e-02, 3.7656e-03, 4.7688e-17,
        7.5634e-02, 2.7824e-02, 4.7688e-17, 9.3339e-06, 1.3853e-03, 3.7656e-03,
        4.7688e-17, 7.7614e-12, 2.7824e-02, 7.5634e-02, 7.5634e-02, 7.5634e-02,
        7.5634e-02, 3.5237e-16, 7.5634e-02, 7.5634e-02, 7.0775e-15, 4.7688e-17,
        2.7824e-02, 1.2963e-16, 4.7688e-17, 7.5634e-02, 2.1098e-11, 7.5634e-02])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 82.58% 

Test Accuracy: 84.56% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.738524166867137
distance x is tensor(116.7788, device='cuda:1')
benign distance is  tensor(116.7788, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0264737866818905
distance x is tensor(100.7369, device='cuda:1')
benign distance is  tensor(100.7369, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0732617899775505
distance x is tensor(94.1721, device='cuda:1')
benign distance is  tensor(94.1721, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2239373587071896
distance x is tensor(136.0887, device='cuda:1')
benign distance is  tensor(136.0887, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1407176163047552
distance x is tensor(84.7878, device='cuda:1')
benign distance is  tensor(84.7878, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8464441504329443
distance x is tensor(102.0691, device='cuda:1')
benign distance is  tensor(102.0691, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1753838136792183
distance x is tensor(95.8043, device='cuda:1')
benign distance is  tensor(95.8043, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8815422914922237
distance x is tensor(79.4595, device='cuda:1')
benign distance is  tensor(79.4595, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2600242346525192
distance x is tensor(90.1120, device='cuda:1')
benign distance is  tensor(90.1120, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8228749483823776
distance x is tensor(105.1952, device='cuda:1')
benign distance is  tensor(105.1952, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3250408731400967
distance x is tensor(72.4964, device='cuda:1')
benign distance is  tensor(72.4964, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5812721028923988
distance x is tensor(105.9497, device='cuda:1')
benign distance is  tensor(105.9497, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2686406411230564
distance x is tensor(138.9955, device='cuda:1')
benign distance is  tensor(138.9955, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.943648717366159
distance x is tensor(61.9866, device='cuda:1')
benign distance is  tensor(61.9866, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0901818852871656
distance x is tensor(125.3299, device='cuda:1')
benign distance is  tensor(125.3299, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7381914779543877
distance x is tensor(117.4539, device='cuda:1')
benign distance is  tensor(117.4539, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8981123697012663
distance x is tensor(110.1672, device='cuda:1')
benign distance is  tensor(110.1672, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.3548345752060413
distance x is tensor(93.1622, device='cuda:1')
benign distance is  tensor(93.1622, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8621532879769802
distance x is tensor(131.8925, device='cuda:1')
benign distance is  tensor(131.8925, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.1342604756355286
distance x is tensor(109.2576, device='cuda:1')
benign distance is  tensor(109.2576, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9508600682020187
distance x is tensor(108.7107, device='cuda:1')
benign distance is  tensor(108.7107, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9873163178563118
distance x is tensor(82.9153, device='cuda:1')
benign distance is  tensor(82.9153, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0998047441244125
distance x is tensor(82.5299, device='cuda:1')
benign distance is  tensor(82.5299, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9041085951030254
distance x is tensor(103.3220, device='cuda:1')
benign distance is  tensor(103.3220, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.871629863977432
distance x is tensor(122.8806, device='cuda:1')
benign distance is  tensor(122.8806, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.720489203929901
distance x is tensor(142.0609, device='cuda:1')
benign distance is  tensor(142.0609, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.386566817760468
distance x is tensor(122.3070, device='cuda:1')
benign distance is  tensor(122.3070, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.314498484134674
distance x is tensor(112.5505, device='cuda:1')
benign distance is  tensor(112.5505, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.402371674776077
distance x is tensor(94.7211, device='cuda:1')
benign distance is  tensor(94.7211, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.574736475944519
distance x is tensor(115.9340, device='cuda:1')
benign distance is  tensor(115.9340, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.415443778038025
distance x is tensor(136.9248, device='cuda:1')
benign distance is  tensor(136.9248, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.981507301330566
distance x is tensor(115.5785, device='cuda:1')
benign distance is  tensor(115.5785, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.52438622713089
distance x is tensor(141.9153, device='cuda:1')
benign distance is  tensor(141.9153, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.759983628988266
distance x is tensor(114.3959, device='cuda:1')
benign distance is  tensor(114.3959, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.2251406610012054
distance x is tensor(125.4897, device='cuda:1')
benign distance is  tensor(125.4897, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.707233041524887
distance x is tensor(147.1074, device='cuda:1')
benign distance is  tensor(147.1074, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0.,  0., 19.,  1.,  0.,  0.,  2.,  5., 19., 19., 19.,  0., 18., 19.,
        15., 18., 19., 10., 18., 19.])
count_res tensor([6.8982e-10, 6.8982e-10, 1.2312e-01, 1.8751e-09, 6.8982e-10, 6.8982e-10,
        5.0971e-09, 1.0238e-07, 1.2312e-01, 1.2312e-01, 1.2312e-01, 6.8982e-10,
        4.5294e-02, 1.2312e-01, 2.2550e-03, 4.5294e-02, 1.2312e-01, 1.5194e-05,
        4.5294e-02, 1.2312e-01])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 54.72% 

Test Accuracy: 19.71% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.026527177542448
distance x is tensor(149.3730, device='cuda:1')
benign distance is  tensor(149.3730, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.153259240090847
distance x is tensor(135.3304, device='cuda:1')
benign distance is  tensor(135.3304, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.31111728399992
distance x is tensor(126.7850, device='cuda:1')
benign distance is  tensor(126.7850, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2530985288321972
distance x is tensor(165.0507, device='cuda:1')
benign distance is  tensor(165.0507, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1280970554798841
distance x is tensor(126.3198, device='cuda:1')
benign distance is  tensor(126.3198, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9209838435053825
distance x is tensor(124.6408, device='cuda:1')
benign distance is  tensor(124.6408, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.526668019592762
distance x is tensor(125.3746, device='cuda:1')
benign distance is  tensor(125.3746, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1087107323110104
distance x is tensor(119.1811, device='cuda:1')
benign distance is  tensor(119.1811, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.983624875545502
distance x is tensor(83.0836, device='cuda:1')
benign distance is  tensor(83.0836, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.708056032657623
distance x is tensor(123.6131, device='cuda:1')
benign distance is  tensor(123.6131, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.517683148384094
distance x is tensor(105.0018, device='cuda:1')
benign distance is  tensor(105.0018, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.416514873504639
distance x is tensor(96.5184, device='cuda:1')
benign distance is  tensor(96.5184, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.16495469212532
distance x is tensor(71.4305, device='cuda:1')
benign distance is  tensor(71.4305, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.996293276548386
distance x is tensor(91.3570, device='cuda:1')
benign distance is  tensor(91.3570, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  7.303297936916351
distance x is tensor(111.5298, device='cuda:1')
benign distance is  tensor(111.5298, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.17952772974968
distance x is tensor(90.0812, device='cuda:1')
benign distance is  tensor(90.0812, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.717390090227127
distance x is tensor(108.9540, device='cuda:1')
benign distance is  tensor(108.9540, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.641124367713928
distance x is tensor(93.8253, device='cuda:1')
benign distance is  tensor(93.8253, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.987057685852051
distance x is tensor(99.8028, device='cuda:1')
benign distance is  tensor(99.8028, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.139151245355606
distance x is tensor(134.6502, device='cuda:1')
benign distance is  tensor(134.6502, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([ 0.,  2., 51., 51.,  4., 35.,  1., 51.,  8., 48., 35., 51., 43., 38.,
        45., 44.,  1.,  1., 41.,  0., 49., 19.,  0., 51., 34., 41.,  0., 24.,
        49., 22., 37., 50.,  0., 51.,  0.,  0.,  2., 41., 51., 42., 51., 23.,
         0., 48.,  0.,  0., 18., 50.,  0.,  0., 50., 51.])
count_res tensor([6.7719e-24, 5.0038e-23, 9.5439e-02, 9.5439e-02, 3.6973e-22, 1.0740e-08,
        1.8408e-23, 9.5439e-02, 2.0187e-20, 4.7516e-03, 1.0740e-08, 9.5439e-02,
        3.2016e-05, 2.1572e-07, 2.3657e-04, 8.7029e-05, 1.8408e-23, 1.8408e-23,
        4.3329e-06, 6.7719e-24, 1.2916e-02, 1.2087e-15, 6.7719e-24, 9.5439e-02,
        3.9511e-09, 4.3329e-06, 6.7719e-24, 1.7938e-13, 1.2916e-02, 2.4277e-14,
        7.9360e-08, 3.5110e-02, 6.7719e-24, 9.5439e-02, 6.7719e-24, 6.7719e-24,
        5.0038e-23, 4.3329e-06, 9.5439e-02, 1.1778e-05, 9.5439e-02, 6.5991e-14,
        6.7719e-24, 4.7516e-03, 6.7719e-24, 6.7719e-24, 4.4464e-16, 3.5110e-02,
        6.7719e-24, 6.7719e-24, 3.5110e-02, 9.5439e-02])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 75.98% 

Test Accuracy: 83.22% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9234821572899818
distance x is tensor(121.0145, device='cuda:1')
benign distance is  tensor(121.0145, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9186767321079969
distance x is tensor(99.5240, device='cuda:1')
benign distance is  tensor(99.5240, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4342400208115578
distance x is tensor(91.9837, device='cuda:1')
benign distance is  tensor(91.9837, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0825139172375202
distance x is tensor(137.3226, device='cuda:1')
benign distance is  tensor(137.3226, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0532102771103382
distance x is tensor(90.1416, device='cuda:1')
benign distance is  tensor(90.1416, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0524788247421384
distance x is tensor(96.3390, device='cuda:1')
benign distance is  tensor(96.3390, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6504930332303047
distance x is tensor(87.0008, device='cuda:1')
benign distance is  tensor(87.0008, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9324176497757435
distance x is tensor(75.7792, device='cuda:1')
benign distance is  tensor(75.7792, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1629761829972267
distance x is tensor(92.2840, device='cuda:1')
benign distance is  tensor(92.2840, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9071145495399833
distance x is tensor(114.2272, device='cuda:1')
benign distance is  tensor(114.2272, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3158950693905354
distance x is tensor(68.7466, device='cuda:1')
benign distance is  tensor(68.7466, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.952775202691555
distance x is tensor(106.3921, device='cuda:1')
benign distance is  tensor(106.3921, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.574593998491764
distance x is tensor(175.4138, device='cuda:1')
benign distance is  tensor(175.4138, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8767348192632198
distance x is tensor(53.3725, device='cuda:1')
benign distance is  tensor(53.3725, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2025078386068344
distance x is tensor(126.6357, device='cuda:1')
benign distance is  tensor(126.6357, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8626520708203316
distance x is tensor(104.5395, device='cuda:1')
benign distance is  tensor(104.5395, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2699169367551804
distance x is tensor(79.6958, device='cuda:1')
benign distance is  tensor(79.6958, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9892256557941437
distance x is tensor(91.7864, device='cuda:1')
benign distance is  tensor(91.7864, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1228615399450064
distance x is tensor(108.7546, device='cuda:1')
benign distance is  tensor(108.7546, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4909113869071007
distance x is tensor(105.1917, device='cuda:1')
benign distance is  tensor(105.1917, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3820586614310741
distance x is tensor(67.5447, device='cuda:1')
benign distance is  tensor(67.5447, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8275455795228481
distance x is tensor(195.1924, device='cuda:1')
benign distance is  tensor(195.1924, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3461270928382874
distance x is tensor(134.8067, device='cuda:1')
benign distance is  tensor(134.8067, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8737366814166307
distance x is tensor(103.0332, device='cuda:1')
benign distance is  tensor(103.0332, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.388189572840929
distance x is tensor(103.2007, device='cuda:1')
benign distance is  tensor(103.2007, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8316652737557888
distance x is tensor(70.3611, device='cuda:1')
benign distance is  tensor(70.3611, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2420403249561787
distance x is tensor(115.9873, device='cuda:1')
benign distance is  tensor(115.9873, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.5340158268809319
distance x is tensor(101.9041, device='cuda:1')
benign distance is  tensor(101.9041, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8278731908649206
distance x is tensor(110.2379, device='cuda:1')
benign distance is  tensor(110.2379, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.010731816291809
distance x is tensor(98.0072, device='cuda:1')
benign distance is  tensor(98.0072, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5878482889384031
distance x is tensor(112.4793, device='cuda:1')
benign distance is  tensor(112.4793, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.4369704015552998
distance x is tensor(148.6586, device='cuda:1')
benign distance is  tensor(148.6586, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.4795619510114193
distance x is tensor(89.1160, device='cuda:1')
benign distance is  tensor(89.1160, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.567571759223938
distance x is tensor(117.4149, device='cuda:1')
benign distance is  tensor(117.4149, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.3676332719624043
distance x is tensor(125.5182, device='cuda:1')
benign distance is  tensor(125.5182, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3864908069372177
distance x is tensor(80.1279, device='cuda:1')
benign distance is  tensor(80.1279, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8190493863075972
distance x is tensor(141.1461, device='cuda:1')
benign distance is  tensor(141.1461, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.084259070456028
distance x is tensor(128.0553, device='cuda:1')
benign distance is  tensor(128.0553, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1126826405525208
distance x is tensor(100.4669, device='cuda:1')
benign distance is  tensor(100.4669, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5717259794473648
distance x is tensor(119.9118, device='cuda:1')
benign distance is  tensor(119.9118, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  6.7540358901023865
distance x is tensor(134.6140, device='cuda:1')
benign distance is  tensor(134.6140, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.522247701883316
distance x is tensor(150.4356, device='cuda:1')
benign distance is  tensor(150.4356, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.254425317049026
distance x is tensor(128.5591, device='cuda:1')
benign distance is  tensor(128.5591, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.447216212749481
distance x is tensor(130.0656, device='cuda:1')
benign distance is  tensor(130.0656, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.113831907510757
distance x is tensor(105.0859, device='cuda:1')
benign distance is  tensor(105.0859, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.957851827144623
distance x is tensor(120.8490, device='cuda:1')
benign distance is  tensor(120.8490, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.828557759523392
distance x is tensor(146.6644, device='cuda:1')
benign distance is  tensor(146.6644, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.696361660957336
distance x is tensor(126.9611, device='cuda:1')
benign distance is  tensor(126.9611, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.354691058397293
distance x is tensor(142.9095, device='cuda:1')
benign distance is  tensor(142.9095, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.992559313774109
distance x is tensor(131.4066, device='cuda:1')
benign distance is  tensor(131.4066, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.392788290977478
distance x is tensor(142.3364, device='cuda:1')
benign distance is  tensor(142.3364, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.622988551855087
distance x is tensor(163.4668, device='cuda:1')
benign distance is  tensor(163.4668, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0.,  5., 19.,  0.,  0., 13.,  0.,  0., 19., 18., 19.,  0., 19.,  0.,
        17., 19., 19., 19., 15., 19.])
count_res tensor([6.5730e-10, 9.7551e-08, 1.1732e-01, 6.5730e-10, 6.5730e-10, 2.9080e-04,
        6.5730e-10, 6.5730e-10, 1.1732e-01, 4.3158e-02, 1.1732e-01, 6.5730e-10,
        1.1732e-01, 6.5730e-10, 1.5877e-02, 1.1732e-01, 1.1732e-01, 1.1732e-01,
        2.1487e-03, 1.1732e-01])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 45.45% 

Test Accuracy: 13.39% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7020676955580711
distance x is tensor(143.0892, device='cuda:1')
benign distance is  tensor(143.0892, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4270981326699257
distance x is tensor(132.3889, device='cuda:1')
benign distance is  tensor(132.3889, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5435122400522232
distance x is tensor(122.1466, device='cuda:1')
benign distance is  tensor(122.1466, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3126533851027489
distance x is tensor(159.5567, device='cuda:1')
benign distance is  tensor(159.5567, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4909000098705292
distance x is tensor(128.7741, device='cuda:1')
benign distance is  tensor(128.7741, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1627742182463408
distance x is tensor(126.5804, device='cuda:1')
benign distance is  tensor(126.5804, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3986695520579815
distance x is tensor(134.1801, device='cuda:1')
benign distance is  tensor(134.1801, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.225730061531067
distance x is tensor(113.3619, device='cuda:1')
benign distance is  tensor(113.3619, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.8700661063194275
distance x is tensor(81.8766, device='cuda:1')
benign distance is  tensor(81.8766, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.581253558397293
distance x is tensor(123.3861, device='cuda:1')
benign distance is  tensor(123.3861, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.687452495098114
distance x is tensor(81.4422, device='cuda:1')
benign distance is  tensor(81.4422, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.95657879114151
distance x is tensor(86.9590, device='cuda:1')
benign distance is  tensor(86.9590, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.475878834724426
distance x is tensor(78.5402, device='cuda:1')
benign distance is  tensor(78.5402, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.43179190158844
distance x is tensor(97.8892, device='cuda:1')
benign distance is  tensor(97.8892, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.466812938451767
distance x is tensor(111.5000, device='cuda:1')
benign distance is  tensor(111.5000, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.661154866218567
distance x is tensor(82.3878, device='cuda:1')
benign distance is  tensor(82.3878, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.867795556783676
distance x is tensor(105.8695, device='cuda:1')
benign distance is  tensor(105.8695, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.738056242465973
distance x is tensor(85.6645, device='cuda:1')
benign distance is  tensor(85.6645, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.947911620140076
distance x is tensor(104.2980, device='cuda:1')
benign distance is  tensor(104.2980, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.804574579000473
distance x is tensor(139.1425, device='cuda:1')
benign distance is  tensor(139.1425, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 7., 26., 27., 10.,  5., 27., 25., 26., 25., 13., 23., 26., 20., 20.,
         5., 16., 22.,  0.,  0., 22.,  6.,  4., 26.,  0., 12.,  0.,  0., 27.])
count_res tensor([4.3158e-10, 7.7030e-02, 2.0939e-01, 8.6685e-09, 5.8408e-11, 2.0939e-01,
        2.8338e-02, 7.7030e-02, 2.8338e-02, 1.7411e-07, 3.8351e-03, 7.7030e-02,
        1.9094e-04, 1.9094e-04, 5.8408e-11, 3.4971e-06, 1.4108e-03, 3.9355e-13,
        3.9355e-13, 1.4108e-03, 1.5877e-10, 2.1487e-11, 7.7030e-02, 3.9355e-13,
        6.4052e-08, 3.9355e-13, 3.9355e-13, 2.0939e-01])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 71.78% 

Test Accuracy: 82.21% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8060187175869942
distance x is tensor(125.9189, device='cuda:1')
benign distance is  tensor(125.9189, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3321579657495022
distance x is tensor(99.2084, device='cuda:1')
benign distance is  tensor(99.2084, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1686401851475239
distance x is tensor(95.9061, device='cuda:1')
benign distance is  tensor(95.9061, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.357311651110649
distance x is tensor(139.2362, device='cuda:1')
benign distance is  tensor(139.2362, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3620982635766268
distance x is tensor(101.1612, device='cuda:1')
benign distance is  tensor(101.1612, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9515404105186462
distance x is tensor(107.8223, device='cuda:1')
benign distance is  tensor(107.8223, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.477076455950737
distance x is tensor(94.0569, device='cuda:1')
benign distance is  tensor(94.0569, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1696601919829845
distance x is tensor(85.7030, device='cuda:1')
benign distance is  tensor(85.7030, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1391844935715199
distance x is tensor(111.7013, device='cuda:1')
benign distance is  tensor(111.7013, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8494081571698189
distance x is tensor(114.6089, device='cuda:1')
benign distance is  tensor(114.6089, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3288185745477676
distance x is tensor(67.9239, device='cuda:1')
benign distance is  tensor(67.9239, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7645921260118484
distance x is tensor(103.4583, device='cuda:1')
benign distance is  tensor(103.4583, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.371329016983509
distance x is tensor(152.9615, device='cuda:1')
benign distance is  tensor(152.9615, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8986171260476112
distance x is tensor(62.2074, device='cuda:1')
benign distance is  tensor(62.2074, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4959561713039875
distance x is tensor(132.2826, device='cuda:1')
benign distance is  tensor(132.2826, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9307797700166702
distance x is tensor(114.5750, device='cuda:1')
benign distance is  tensor(114.5750, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.26486274600029
distance x is tensor(122.0784, device='cuda:1')
benign distance is  tensor(122.0784, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  5.735593497753143
distance x is tensor(146.1236, device='cuda:1')
benign distance is  tensor(146.1236, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.299069195985794
distance x is tensor(121.5585, device='cuda:1')
benign distance is  tensor(121.5585, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  7.888982862234116
distance x is tensor(124.3170, device='cuda:1')
benign distance is  tensor(124.3170, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.619219958782196
distance x is tensor(108.4477, device='cuda:1')
benign distance is  tensor(108.4477, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.64753058552742
distance x is tensor(125.0722, device='cuda:1')
benign distance is  tensor(125.0722, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.105212926864624
distance x is tensor(140.6768, device='cuda:1')
benign distance is  tensor(140.6768, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  6.602174669504166
distance x is tensor(117.8869, device='cuda:1')
benign distance is  tensor(117.8869, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.3617063164711
distance x is tensor(136.6140, device='cuda:1')
benign distance is  tensor(136.6140, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.883869767189026
distance x is tensor(117.9101, device='cuda:1')
benign distance is  tensor(117.9101, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.235070586204529
distance x is tensor(132.3269, device='cuda:1')
benign distance is  tensor(132.3269, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.23435091972351
distance x is tensor(154.8643, device='cuda:1')
benign distance is  tensor(154.8643, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0.,  0., 35.,  0.,  0.,  0.,  0.,  0., 35., 35., 31.,  8., 35., 30.,
         5., 35., 35., 35., 35., 26.,  0., 35., 35., 19.,  2.,  0., 35.,  6.,
        33.,  0., 11., 28., 34., 34., 32.,  0.])
count_res tensor([5.2776e-17, 5.2776e-17, 8.3703e-02, 5.2776e-17, 5.2776e-17, 5.2776e-17,
        5.2776e-17, 5.2776e-17, 8.3703e-02, 8.3703e-02, 1.5331e-03, 1.5732e-13,
        8.3703e-02, 5.6399e-04, 7.8326e-15, 8.3703e-02, 8.3703e-02, 8.3703e-02,
        8.3703e-02, 1.0330e-05, 5.2776e-17, 8.3703e-02, 8.3703e-02, 9.4196e-09,
        3.8996e-16, 5.2776e-17, 8.3703e-02, 2.1291e-14, 1.1328e-02, 5.2776e-17,
        3.1599e-12, 7.6327e-05, 3.0793e-02, 3.0793e-02, 4.1673e-03, 5.2776e-17])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 68.38% 

Test Accuracy: 37.48% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9660974387079477
distance x is tensor(136.1420, device='cuda:1')
benign distance is  tensor(136.1420, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1176257133483887
distance x is tensor(112.5992, device='cuda:1')
benign distance is  tensor(112.5992, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1678103432059288
distance x is tensor(106.1301, device='cuda:1')
benign distance is  tensor(106.1301, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3403474874794483
distance x is tensor(143.0855, device='cuda:1')
benign distance is  tensor(143.0855, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2132108099758625
distance x is tensor(103.4066, device='cuda:1')
benign distance is  tensor(103.4066, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8747022189199924
distance x is tensor(106.0490, device='cuda:1')
benign distance is  tensor(106.0490, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.966880090534687
distance x is tensor(102.1497, device='cuda:1')
benign distance is  tensor(102.1497, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1909434795379639
distance x is tensor(92.2487, device='cuda:1')
benign distance is  tensor(92.2487, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.9305604472756386
distance x is tensor(97.4909, device='cuda:1')
benign distance is  tensor(97.4909, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.966193487867713
distance x is tensor(104.4020, device='cuda:1')
benign distance is  tensor(104.4020, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.446890439838171
distance x is tensor(111.9747, device='cuda:1')
benign distance is  tensor(111.9747, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2983878068625927
distance x is tensor(121.6913, device='cuda:1')
benign distance is  tensor(121.6913, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7329997010529041
distance x is tensor(96.6109, device='cuda:1')
benign distance is  tensor(96.6109, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8822078164666891
distance x is tensor(191.3957, device='cuda:1')
benign distance is  tensor(191.3957, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2025697827339172
distance x is tensor(144.7460, device='cuda:1')
benign distance is  tensor(144.7460, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0616866573691368
distance x is tensor(126.9685, device='cuda:1')
benign distance is  tensor(126.9685, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.097578290849924
distance x is tensor(123.2014, device='cuda:1')
benign distance is  tensor(123.2014, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.3703209422528744
distance x is tensor(100.7511, device='cuda:1')
benign distance is  tensor(100.7511, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.128087155520916
distance x is tensor(145.9964, device='cuda:1')
benign distance is  tensor(145.9964, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.98684673756361
distance x is tensor(119.4427, device='cuda:1')
benign distance is  tensor(119.4427, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6937222592532635
distance x is tensor(117.2802, device='cuda:1')
benign distance is  tensor(117.2802, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.174581240862608
distance x is tensor(103.0289, device='cuda:1')
benign distance is  tensor(103.0289, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.3871758468449116
distance x is tensor(97.9889, device='cuda:1')
benign distance is  tensor(97.9889, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7962059862911701
distance x is tensor(132.8242, device='cuda:1')
benign distance is  tensor(132.8242, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.54523628950119
distance x is tensor(87.7332, device='cuda:1')
benign distance is  tensor(87.7332, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.834712028503418
distance x is tensor(128.9437, device='cuda:1')
benign distance is  tensor(128.9437, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.4425725638866425
distance x is tensor(93.0980, device='cuda:1')
benign distance is  tensor(93.0980, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.518727421760559
distance x is tensor(90.3697, device='cuda:1')
benign distance is  tensor(90.3697, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.652134090662003
distance x is tensor(76.2938, device='cuda:1')
benign distance is  tensor(76.2938, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.0023645758628845
distance x is tensor(106.1199, device='cuda:1')
benign distance is  tensor(106.1199, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.531572163105011
distance x is tensor(118.9286, device='cuda:1')
benign distance is  tensor(118.9286, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.001932710409164
distance x is tensor(88.5029, device='cuda:1')
benign distance is  tensor(88.5029, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.175941437482834
distance x is tensor(112.2621, device='cuda:1')
benign distance is  tensor(112.2621, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.097860038280487
distance x is tensor(102.6377, device='cuda:1')
benign distance is  tensor(102.6377, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.224796295166016
distance x is tensor(106.2420, device='cuda:1')
benign distance is  tensor(106.2420, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.652754664421082
distance x is tensor(140.9790, device='cuda:1')
benign distance is  tensor(140.9790, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([34.,  0., 31.,  0.,  7., 35., 32., 35., 32., 35., 25., 35., 34.,  2.,
         4.,  1., 32.,  1., 27., 35.,  0., 32., 34.,  0., 34., 34., 20., 20.,
         0.,  0., 30., 35.,  0.,  0.,  0.,  8.])
count_res tensor([4.5620e-02, 7.8189e-17, 2.2713e-03, 7.8189e-17, 8.5744e-14, 1.2401e-01,
        6.1740e-03, 1.2401e-01, 6.1740e-03, 1.2401e-01, 5.6300e-06, 1.2401e-01,
        4.5620e-02, 5.7774e-16, 4.2690e-15, 2.1254e-16, 6.1740e-03, 2.1254e-16,
        4.1600e-05, 1.2401e-01, 7.8189e-17, 6.1740e-03, 4.5620e-02, 7.8189e-17,
        4.5620e-02, 4.5620e-02, 3.7934e-08, 3.7934e-08, 7.8189e-17, 7.8189e-17,
        8.3556e-04, 1.2401e-01, 7.8189e-17, 7.8189e-17, 7.8189e-17, 2.3308e-13])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 77.66% 

Test Accuracy: 77.92% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6417829487472773
distance x is tensor(136.7898, device='cuda:1')
benign distance is  tensor(136.7898, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1437252089381218
distance x is tensor(106.2448, device='cuda:1')
benign distance is  tensor(106.2448, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5239934660494328
distance x is tensor(107.3331, device='cuda:1')
benign distance is  tensor(107.3331, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3015220388770103
distance x is tensor(139.1924, device='cuda:1')
benign distance is  tensor(139.1924, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3696800097823143
distance x is tensor(98.2237, device='cuda:1')
benign distance is  tensor(98.2237, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8969511035829782
distance x is tensor(96.4160, device='cuda:1')
benign distance is  tensor(96.4160, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5343203097581863
distance x is tensor(103.2600, device='cuda:1')
benign distance is  tensor(103.2600, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9036104250699282
distance x is tensor(84.7465, device='cuda:1')
benign distance is  tensor(84.7465, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1015477813780308
distance x is tensor(112.2615, device='cuda:1')
benign distance is  tensor(112.2615, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8783734291791916
distance x is tensor(123.5120, device='cuda:1')
benign distance is  tensor(123.5120, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3539911918342113
distance x is tensor(73.9026, device='cuda:1')
benign distance is  tensor(73.9026, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.2589394748210907
distance x is tensor(104.2968, device='cuda:1')
benign distance is  tensor(104.2968, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2406021170318127
distance x is tensor(161.7433, device='cuda:1')
benign distance is  tensor(161.7433, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9416293799877167
distance x is tensor(68.9775, device='cuda:1')
benign distance is  tensor(68.9775, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1133449338376522
distance x is tensor(140.2785, device='cuda:1')
benign distance is  tensor(140.2785, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.166330598294735
distance x is tensor(109.9850, device='cuda:1')
benign distance is  tensor(109.9850, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6352735608816147
distance x is tensor(119.7436, device='cuda:1')
benign distance is  tensor(119.7436, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0970565415918827
distance x is tensor(81.4258, device='cuda:1')
benign distance is  tensor(81.4258, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.225721439346671
distance x is tensor(124.6660, device='cuda:1')
benign distance is  tensor(124.6660, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.6127839647233486
distance x is tensor(109.1822, device='cuda:1')
benign distance is  tensor(109.1822, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9412687011063099
distance x is tensor(121.7854, device='cuda:1')
benign distance is  tensor(121.7854, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0305236019194126
distance x is tensor(115.2968, device='cuda:1')
benign distance is  tensor(115.2968, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6473831720650196
distance x is tensor(118.8435, device='cuda:1')
benign distance is  tensor(118.8435, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9632848761975765
distance x is tensor(158.1804, device='cuda:1')
benign distance is  tensor(158.1804, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.642248749732971
distance x is tensor(110.4756, device='cuda:1')
benign distance is  tensor(110.4756, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.892477989196777
distance x is tensor(138.7678, device='cuda:1')
benign distance is  tensor(138.7678, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.526085406541824
distance x is tensor(112.6086, device='cuda:1')
benign distance is  tensor(112.6086, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.128686904907227
distance x is tensor(95.9183, device='cuda:1')
benign distance is  tensor(95.9183, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.724308162927628
distance x is tensor(100.3318, device='cuda:1')
benign distance is  tensor(100.3318, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.990508317947388
distance x is tensor(114.3849, device='cuda:1')
benign distance is  tensor(114.3849, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.1256143450737
distance x is tensor(134.0751, device='cuda:1')
benign distance is  tensor(134.0751, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.5238131284713745
distance x is tensor(104.6756, device='cuda:1')
benign distance is  tensor(104.6756, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.722290992736816
distance x is tensor(121.5339, device='cuda:1')
benign distance is  tensor(121.5339, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.203963935375214
distance x is tensor(105.2070, device='cuda:1')
benign distance is  tensor(105.2070, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.09679502248764
distance x is tensor(119.6376, device='cuda:1')
benign distance is  tensor(119.6376, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.353001475334167
distance x is tensor(147.1764, device='cuda:1')
benign distance is  tensor(147.1764, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0., 19., 19.,  3., 12., 18.,  0., 19., 19.,  0.,  8.,  0.,  0., 18.,
        15., 15., 19.,  0., 17., 19.])
count_res tensor([8.1098e-10, 1.4475e-01, 1.4475e-01, 1.6289e-08, 1.3199e-04, 5.3249e-02,
        8.1098e-10, 1.4475e-01, 1.4475e-01, 8.1098e-10, 2.4175e-06, 8.1098e-10,
        8.1098e-10, 5.3249e-02, 2.6511e-03, 2.6511e-03, 1.4475e-01, 8.1098e-10,
        1.9589e-02, 1.4475e-01])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 63.63% 

Test Accuracy: 34.55% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0443971082568169
distance x is tensor(136.0252, device='cuda:1')
benign distance is  tensor(136.0252, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1958620268851519
distance x is tensor(111.4671, device='cuda:1')
benign distance is  tensor(111.4671, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1771570853888988
distance x is tensor(104.2763, device='cuda:1')
benign distance is  tensor(104.2763, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2391859740018845
distance x is tensor(151.7426, device='cuda:1')
benign distance is  tensor(151.7426, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4431544244289398
distance x is tensor(122.4176, device='cuda:1')
benign distance is  tensor(122.4176, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9889781624078751
distance x is tensor(111.0326, device='cuda:1')
benign distance is  tensor(111.0326, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.637521144002676
distance x is tensor(114.3724, device='cuda:1')
benign distance is  tensor(114.3724, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9622215069830418
distance x is tensor(91.7722, device='cuda:1')
benign distance is  tensor(91.7722, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.579833000898361
distance x is tensor(85.7997, device='cuda:1')
benign distance is  tensor(85.7997, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.445768564939499
distance x is tensor(135.3514, device='cuda:1')
benign distance is  tensor(135.3514, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.855872452259064
distance x is tensor(98.6734, device='cuda:1')
benign distance is  tensor(98.6734, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.86124473810196
distance x is tensor(100.0210, device='cuda:1')
benign distance is  tensor(100.0210, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.381640136241913
distance x is tensor(98.1118, device='cuda:1')
benign distance is  tensor(98.1118, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.879881918430328
distance x is tensor(111.6186, device='cuda:1')
benign distance is  tensor(111.6186, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.601664125919342
distance x is tensor(127.0969, device='cuda:1')
benign distance is  tensor(127.0969, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.07370600104332
distance x is tensor(94.1989, device='cuda:1')
benign distance is  tensor(94.1989, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.630334705114365
distance x is tensor(114.6374, device='cuda:1')
benign distance is  tensor(114.6374, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.331700146198273
distance x is tensor(95.9513, device='cuda:1')
benign distance is  tensor(95.9513, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.977780312299728
distance x is tensor(111.7664, device='cuda:1')
benign distance is  tensor(111.7664, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.765023350715637
distance x is tensor(143.3620, device='cuda:1')
benign distance is  tensor(143.3620, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([ 1.,  0., 36.,  0.,  0., 41., 43.,  0., 40., 17.,  1.,  0., 18., 25.,
        39., 42., 43., 43., 43., 43.,  4., 35., 38., 42., 42., 28., 42.,  0.,
         0.,  0., 43., 43., 41., 43., 43.,  0.,  0.,  0., 43., 36.,  0.,  0.,
        14.,  0.])
count_res tensor([4.8646e-20, 1.7896e-20, 7.7153e-05, 1.7896e-20, 1.7896e-20, 1.1450e-02,
        8.4608e-02, 1.7896e-20, 4.2124e-03, 4.3227e-13, 4.8646e-20, 1.7896e-20,
        1.1750e-12, 1.2886e-09, 1.5497e-03, 3.1126e-02, 8.4608e-02, 8.4608e-02,
        8.4608e-02, 8.4608e-02, 9.7707e-19, 2.8383e-05, 5.7009e-04, 3.1126e-02,
        3.1126e-02, 2.5882e-08, 3.1126e-02, 1.7896e-20, 1.7896e-20, 1.7896e-20,
        8.4608e-02, 8.4608e-02, 1.1450e-02, 8.4608e-02, 8.4608e-02, 1.7896e-20,
        1.7896e-20, 1.7896e-20, 8.4608e-02, 7.7153e-05, 1.7896e-20, 1.7896e-20,
        2.1521e-14, 1.7896e-20])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 75.68% 

Test Accuracy: 82.37% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6796521414071321
distance x is tensor(120.0282, device='cuda:1')
benign distance is  tensor(120.0282, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.190360814332962
distance x is tensor(102.6890, device='cuda:1')
benign distance is  tensor(102.6890, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.374363161623478
distance x is tensor(101.5424, device='cuda:1')
benign distance is  tensor(101.5424, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2015943303704262
distance x is tensor(139.6340, device='cuda:1')
benign distance is  tensor(139.6340, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9703776817768812
distance x is tensor(96.0251, device='cuda:1')
benign distance is  tensor(96.0251, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9241152228787541
distance x is tensor(97.7857, device='cuda:1')
benign distance is  tensor(97.7857, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.410134468227625
distance x is tensor(88.7457, device='cuda:1')
benign distance is  tensor(88.7457, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8404212146997452
distance x is tensor(83.8702, device='cuda:1')
benign distance is  tensor(83.8702, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2107043638825417
distance x is tensor(99.2193, device='cuda:1')
benign distance is  tensor(99.2193, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9507419457659125
distance x is tensor(119.1841, device='cuda:1')
benign distance is  tensor(119.1841, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2245705798268318
distance x is tensor(67.3019, device='cuda:1')
benign distance is  tensor(67.3019, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7700349986553192
distance x is tensor(108.4044, device='cuda:1')
benign distance is  tensor(108.4044, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0272920168936253
distance x is tensor(152.4358, device='cuda:1')
benign distance is  tensor(152.4358, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8480676654726267
distance x is tensor(61.6903, device='cuda:1')
benign distance is  tensor(61.6903, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.193515645340085
distance x is tensor(131.2585, device='cuda:1')
benign distance is  tensor(131.2585, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7388853281736374
distance x is tensor(105.1718, device='cuda:1')
benign distance is  tensor(105.1718, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2756722941994667
distance x is tensor(86.0519, device='cuda:1')
benign distance is  tensor(86.0519, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.17919335141778
distance x is tensor(100.9214, device='cuda:1')
benign distance is  tensor(100.9214, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3487949073314667
distance x is tensor(109.5170, device='cuda:1')
benign distance is  tensor(109.5170, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5784473195672035
distance x is tensor(97.7709, device='cuda:1')
benign distance is  tensor(97.7709, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1876077093183994
distance x is tensor(77.2702, device='cuda:1')
benign distance is  tensor(77.2702, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.733116252347827
distance x is tensor(198.7678, device='cuda:1')
benign distance is  tensor(198.7678, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1894072778522968
distance x is tensor(138.0143, device='cuda:1')
benign distance is  tensor(138.0143, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1777927540242672
distance x is tensor(119.1881, device='cuda:1')
benign distance is  tensor(119.1881, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.8701485134661198
distance x is tensor(96.2274, device='cuda:1')
benign distance is  tensor(96.2274, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3889786079525948
distance x is tensor(121.7003, device='cuda:1')
benign distance is  tensor(121.7003, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.3696700781583786
distance x is tensor(134.8905, device='cuda:1')
benign distance is  tensor(134.8905, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.4255669079720974
distance x is tensor(85.5213, device='cuda:1')
benign distance is  tensor(85.5213, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8797301277518272
distance x is tensor(143.8223, device='cuda:1')
benign distance is  tensor(143.8223, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1012312397360802
distance x is tensor(120.1299, device='cuda:1')
benign distance is  tensor(120.1299, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0411726273596287
distance x is tensor(93.4163, device='cuda:1')
benign distance is  tensor(93.4163, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7728683017194271
distance x is tensor(123.5695, device='cuda:1')
benign distance is  tensor(123.5695, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.09385770559311
distance x is tensor(119.9491, device='cuda:1')
benign distance is  tensor(119.9491, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.475702166557312
distance x is tensor(144.0989, device='cuda:1')
benign distance is  tensor(144.0989, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.149716198444366
distance x is tensor(119.8109, device='cuda:1')
benign distance is  tensor(119.8109, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.262726247310638
distance x is tensor(108.8288, device='cuda:1')
benign distance is  tensor(108.8288, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.097131609916687
distance x is tensor(99.6893, device='cuda:1')
benign distance is  tensor(99.6893, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.170145153999329
distance x is tensor(119.8282, device='cuda:1')
benign distance is  tensor(119.8282, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.531592696905136
distance x is tensor(127.6860, device='cuda:1')
benign distance is  tensor(127.6860, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.587110221385956
distance x is tensor(110.7288, device='cuda:1')
benign distance is  tensor(110.7288, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.832538515329361
distance x is tensor(122.5425, device='cuda:1')
benign distance is  tensor(122.5425, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.870084881782532
distance x is tensor(116.4126, device='cuda:1')
benign distance is  tensor(116.4126, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.678889125585556
distance x is tensor(126.5373, device='cuda:1')
benign distance is  tensor(126.5373, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.690967679023743
distance x is tensor(151.8355, device='cuda:1')
benign distance is  tensor(151.8355, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0., 19.,  0.,  8.,  1.,  0.,  0., 19.,  0., 18., 19., 19., 19., 17.,
         9., 16., 19., 19., 18.,  0.])
count_res tensor([7.0734e-10, 1.2625e-01, 7.0734e-10, 2.1085e-06, 1.9227e-09, 7.0734e-10,
        7.0734e-10, 1.2625e-01, 7.0734e-10, 4.6444e-02, 1.2625e-01, 1.2625e-01,
        1.2625e-01, 1.7086e-02, 5.7316e-06, 6.2855e-03, 1.2625e-01, 1.2625e-01,
        4.6444e-02, 7.0734e-10])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 44.70% 

Test Accuracy: 13.49% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7441294770687819
distance x is tensor(166.0611, device='cuda:1')
benign distance is  tensor(166.0611, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.455947082489729
distance x is tensor(133.3930, device='cuda:1')
benign distance is  tensor(133.3930, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6035507395863533
distance x is tensor(127.1755, device='cuda:1')
benign distance is  tensor(127.1755, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2985498271882534
distance x is tensor(172.1979, device='cuda:1')
benign distance is  tensor(172.1979, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5166638866066933
distance x is tensor(143.9456, device='cuda:1')
benign distance is  tensor(143.9456, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0718967467546463
distance x is tensor(135.1159, device='cuda:1')
benign distance is  tensor(135.1159, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5423998646438122
distance x is tensor(137.1102, device='cuda:1')
benign distance is  tensor(137.1102, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.357383955270052
distance x is tensor(133.6836, device='cuda:1')
benign distance is  tensor(133.6836, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.346455335617065
distance x is tensor(86.8493, device='cuda:1')
benign distance is  tensor(86.8493, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.444406569004059
distance x is tensor(126.1543, device='cuda:1')
benign distance is  tensor(126.1543, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.319384515285492
distance x is tensor(82.6345, device='cuda:1')
benign distance is  tensor(82.6345, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.444306254386902
distance x is tensor(87.0730, device='cuda:1')
benign distance is  tensor(87.0730, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.726020783185959
distance x is tensor(75.2799, device='cuda:1')
benign distance is  tensor(75.2799, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.737002044916153
distance x is tensor(102.3891, device='cuda:1')
benign distance is  tensor(102.3891, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.202542185783386
distance x is tensor(118.4271, device='cuda:1')
benign distance is  tensor(118.4271, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.872064054012299
distance x is tensor(91.9675, device='cuda:1')
benign distance is  tensor(91.9675, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.44210022687912
distance x is tensor(108.2978, device='cuda:1')
benign distance is  tensor(108.2978, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.668182134628296
distance x is tensor(92.2669, device='cuda:1')
benign distance is  tensor(92.2669, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.288749814033508
distance x is tensor(104.5336, device='cuda:1')
benign distance is  tensor(104.5336, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.09991866350174
distance x is tensor(136.1773, device='cuda:1')
benign distance is  tensor(136.1773, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([ 0.,  6., 43., 43., 43.,  0., 43.,  0., 25., 43.,  0.,  0., 41.,  0.,
         3., 36., 35., 43., 42., 43., 43., 43., 43., 15., 42., 21., 42., 26.,
         0., 43., 43.,  0.,  1., 41.,  0.,  0.,  0.,  0., 42., 36.,  0.,  0.,
        42.,  0.])
count_res tensor([1.4988e-20, 6.0466e-18, 7.0861e-02, 7.0861e-02, 7.0861e-02, 1.4988e-20,
        7.0861e-02, 1.4988e-20, 1.0792e-09, 7.0861e-02, 1.4988e-20, 1.4988e-20,
        9.5899e-03, 1.4988e-20, 3.0104e-19, 6.4616e-05, 2.3771e-05, 7.0861e-02,
        2.6068e-02, 7.0861e-02, 7.0861e-02, 7.0861e-02, 7.0861e-02, 4.8996e-14,
        2.6068e-02, 1.9766e-11, 2.6068e-02, 2.9336e-09, 1.4988e-20, 7.0861e-02,
        7.0861e-02, 1.4988e-20, 4.0741e-20, 9.5899e-03, 1.4988e-20, 1.4988e-20,
        1.4988e-20, 1.4988e-20, 2.6068e-02, 6.4616e-05, 1.4988e-20, 1.4988e-20,
        2.6068e-02, 1.4988e-20])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 77.85% 

Test Accuracy: 83.79% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6533349081873894
distance x is tensor(119.6528, device='cuda:1')
benign distance is  tensor(119.6528, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9586772993206978
distance x is tensor(105.6061, device='cuda:1')
benign distance is  tensor(105.6061, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.135568032041192
distance x is tensor(95.4046, device='cuda:1')
benign distance is  tensor(95.4046, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2965093664824963
distance x is tensor(142.5457, device='cuda:1')
benign distance is  tensor(142.5457, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4536029323935509
distance x is tensor(95.5443, device='cuda:1')
benign distance is  tensor(95.5443, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9325508363544941
distance x is tensor(98.7871, device='cuda:1')
benign distance is  tensor(98.7871, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.540432408452034
distance x is tensor(82.9082, device='cuda:1')
benign distance is  tensor(82.9082, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.007798831909895
distance x is tensor(82.9975, device='cuda:1')
benign distance is  tensor(82.9975, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1986943781375885
distance x is tensor(95.2442, device='cuda:1')
benign distance is  tensor(95.2442, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9916839525103569
distance x is tensor(120.4310, device='cuda:1')
benign distance is  tensor(120.4310, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2218027971684933
distance x is tensor(65.9937, device='cuda:1')
benign distance is  tensor(65.9937, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.0742585211992264
distance x is tensor(102.5754, device='cuda:1')
benign distance is  tensor(102.5754, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4465652368962765
distance x is tensor(158.1029, device='cuda:1')
benign distance is  tensor(158.1029, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8930610306560993
distance x is tensor(59.4601, device='cuda:1')
benign distance is  tensor(59.4601, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1107913795858622
distance x is tensor(155.6440, device='cuda:1')
benign distance is  tensor(155.6440, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6658641137182713
distance x is tensor(103.2961, device='cuda:1')
benign distance is  tensor(103.2961, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.283023588359356
distance x is tensor(115.2305, device='cuda:1')
benign distance is  tensor(115.2305, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8800097052007914
distance x is tensor(66.8435, device='cuda:1')
benign distance is  tensor(66.8435, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.156955748796463
distance x is tensor(120.2436, device='cuda:1')
benign distance is  tensor(120.2436, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.715473212301731
distance x is tensor(110.9018, device='cuda:1')
benign distance is  tensor(110.9018, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.230985939502716
distance x is tensor(121.3871, device='cuda:1')
benign distance is  tensor(121.3871, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8987922351807356
distance x is tensor(95.6024, device='cuda:1')
benign distance is  tensor(95.6024, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5767642296850681
distance x is tensor(121.8342, device='cuda:1')
benign distance is  tensor(121.8342, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8525990974158049
distance x is tensor(161.2132, device='cuda:1')
benign distance is  tensor(161.2132, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9845476448535919
distance x is tensor(112.3607, device='cuda:1')
benign distance is  tensor(112.3607, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.102172028273344
distance x is tensor(86.9374, device='cuda:1')
benign distance is  tensor(86.9374, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8367649763822556
distance x is tensor(139.3203, device='cuda:1')
benign distance is  tensor(139.3203, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.73601845651865
distance x is tensor(123.6179, device='cuda:1')
benign distance is  tensor(123.6179, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6754899192601442
distance x is tensor(112.7470, device='cuda:1')
benign distance is  tensor(112.7470, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0495669022202492
distance x is tensor(82.6421, device='cuda:1')
benign distance is  tensor(82.6421, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0803642086684704
distance x is tensor(86.4897, device='cuda:1')
benign distance is  tensor(86.4897, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.842337304726243
distance x is tensor(118.9449, device='cuda:1')
benign distance is  tensor(118.9449, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.31995639204979
distance x is tensor(136.7953, device='cuda:1')
benign distance is  tensor(136.7953, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.456673473119736
distance x is tensor(148.3204, device='cuda:1')
benign distance is  tensor(148.3204, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.728053390979767
distance x is tensor(131.8190, device='cuda:1')
benign distance is  tensor(131.8190, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.347529947757721
distance x is tensor(123.9899, device='cuda:1')
benign distance is  tensor(123.9899, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.539507359266281
distance x is tensor(108.8930, device='cuda:1')
benign distance is  tensor(108.8930, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.537530481815338
distance x is tensor(124.2664, device='cuda:1')
benign distance is  tensor(124.2664, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.590618014335632
distance x is tensor(145.9425, device='cuda:1')
benign distance is  tensor(145.9425, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.344274014234543
distance x is tensor(128.5648, device='cuda:1')
benign distance is  tensor(128.5648, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.288068264722824
distance x is tensor(133.0984, device='cuda:1')
benign distance is  tensor(133.0984, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.588797271251678
distance x is tensor(119.2193, device='cuda:1')
benign distance is  tensor(119.2193, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.256402909755707
distance x is tensor(139.0364, device='cuda:1')
benign distance is  tensor(139.0364, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.581822007894516
distance x is tensor(158.5018, device='cuda:1')
benign distance is  tensor(158.5018, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0., 27.,  4.,  0., 27.,  0., 16.,  0., 27., 26., 27.,  0., 27., 25.,
        27., 27., 26.,  1., 26., 27.,  0.,  0.,  0., 27.,  0., 26., 27.,  0.])
count_res tensor([1.6193e-13, 8.6156e-02, 8.8412e-12, 1.6193e-13, 8.6156e-02, 1.6193e-13,
        1.4389e-06, 1.6193e-13, 8.6156e-02, 3.1695e-02, 8.6156e-02, 1.6193e-13,
        8.6156e-02, 1.1660e-02, 8.6156e-02, 8.6156e-02, 3.1695e-02, 4.4018e-13,
        3.1695e-02, 8.6156e-02, 1.6193e-13, 1.6193e-13, 1.6193e-13, 8.6156e-02,
        1.6193e-13, 3.1695e-02, 8.6156e-02, 1.6193e-13])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 56.25% 

Test Accuracy: 18.77% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7472486589103937
distance x is tensor(132.9380, device='cuda:1')
benign distance is  tensor(132.9380, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9740919359028339
distance x is tensor(120.5890, device='cuda:1')
benign distance is  tensor(120.5890, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1374435424804688
distance x is tensor(113.4831, device='cuda:1')
benign distance is  tensor(113.4831, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0419875103980303
distance x is tensor(160.2063, device='cuda:1')
benign distance is  tensor(160.2063, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.026245629414916
distance x is tensor(116.0001, device='cuda:1')
benign distance is  tensor(116.0001, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.721718879416585
distance x is tensor(125.2294, device='cuda:1')
benign distance is  tensor(125.2294, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4222050569951534
distance x is tensor(112.2601, device='cuda:1')
benign distance is  tensor(112.2601, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0982471331954002
distance x is tensor(107.6295, device='cuda:1')
benign distance is  tensor(107.6295, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4442624896764755
distance x is tensor(140.8961, device='cuda:1')
benign distance is  tensor(140.8961, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1102699507027864
distance x is tensor(124.3748, device='cuda:1')
benign distance is  tensor(124.3748, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4233158230781555
distance x is tensor(124.9958, device='cuda:1')
benign distance is  tensor(124.9958, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.324769414961338
distance x is tensor(131.6598, device='cuda:1')
benign distance is  tensor(131.6598, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.316960521042347
distance x is tensor(114.0536, device='cuda:1')
benign distance is  tensor(114.0536, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8308293577283621
distance x is tensor(201.4972, device='cuda:1')
benign distance is  tensor(201.4972, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.342641670256853
distance x is tensor(153.4454, device='cuda:1')
benign distance is  tensor(153.4454, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0255654864013195
distance x is tensor(132.1551, device='cuda:1')
benign distance is  tensor(132.1551, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.358608961105347
distance x is tensor(78.9873, device='cuda:1')
benign distance is  tensor(78.9873, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.183701425790787
distance x is tensor(135.5371, device='cuda:1')
benign distance is  tensor(135.5371, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.584543377161026
distance x is tensor(82.0957, device='cuda:1')
benign distance is  tensor(82.0957, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.597279787063599
distance x is tensor(93.5076, device='cuda:1')
benign distance is  tensor(93.5076, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.574792057275772
distance x is tensor(75.0392, device='cuda:1')
benign distance is  tensor(75.0392, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.960925370454788
distance x is tensor(104.3336, device='cuda:1')
benign distance is  tensor(104.3336, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.193938672542572
distance x is tensor(111.5684, device='cuda:1')
benign distance is  tensor(111.5684, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.409943222999573
distance x is tensor(87.8426, device='cuda:1')
benign distance is  tensor(87.8426, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.616589933633804
distance x is tensor(99.2934, device='cuda:1')
benign distance is  tensor(99.2934, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.485088109970093
distance x is tensor(85.1772, device='cuda:1')
benign distance is  tensor(85.1772, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.449780583381653
distance x is tensor(100.8808, device='cuda:1')
benign distance is  tensor(100.8808, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.891450107097626
distance x is tensor(142.4325, device='cuda:1')
benign distance is  tensor(142.4325, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0., 27., 23.,  3., 27.,  0., 10., 27., 27., 13., 18.,  0., 23., 24.,
        20.,  0., 20.,  2.,  0., 27.,  7.,  0., 27.,  0., 14., 27., 27., 27.])
count_res tensor([2.0681e-13, 1.1003e-01, 2.0153e-03, 4.1538e-12, 1.1003e-01, 2.0681e-13,
        4.5552e-09, 1.1003e-01, 1.1003e-01, 9.1494e-08, 1.3579e-05, 2.0681e-13,
        2.0153e-03, 5.4781e-03, 1.0034e-04, 2.0681e-13, 1.0034e-04, 1.5281e-12,
        2.0681e-13, 1.1003e-01, 2.2679e-10, 2.0681e-13, 1.1003e-01, 2.0681e-13,
        2.4871e-07, 1.1003e-01, 1.1003e-01, 1.1003e-01])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 78.77% 

Test Accuracy: 84.90% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.68528619594872
distance x is tensor(128.7052, device='cuda:1')
benign distance is  tensor(128.7052, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0261264778673649
distance x is tensor(106.9874, device='cuda:1')
benign distance is  tensor(106.9874, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9431033656001091
distance x is tensor(97.9734, device='cuda:1')
benign distance is  tensor(97.9734, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1601893715560436
distance x is tensor(147.2797, device='cuda:1')
benign distance is  tensor(147.2797, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3275257498025894
distance x is tensor(93.5298, device='cuda:1')
benign distance is  tensor(93.5298, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9264752296730876
distance x is tensor(103.6657, device='cuda:1')
benign distance is  tensor(103.6657, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4633050672709942
distance x is tensor(87.0555, device='cuda:1')
benign distance is  tensor(87.0555, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9312689360231161
distance x is tensor(80.2271, device='cuda:1')
benign distance is  tensor(80.2271, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4730401635169983
distance x is tensor(115.3495, device='cuda:1')
benign distance is  tensor(115.3495, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8234196985140443
distance x is tensor(127.0703, device='cuda:1')
benign distance is  tensor(127.0703, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2525716237723827
distance x is tensor(63.7345, device='cuda:1')
benign distance is  tensor(63.7345, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7792001813650131
distance x is tensor(108.7275, device='cuda:1')
benign distance is  tensor(108.7275, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4107889384031296
distance x is tensor(148.8219, device='cuda:1')
benign distance is  tensor(148.8219, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8524274919182062
distance x is tensor(56.2134, device='cuda:1')
benign distance is  tensor(56.2134, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0943418946117163
distance x is tensor(128.3115, device='cuda:1')
benign distance is  tensor(128.3115, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6977922469377518
distance x is tensor(110.6553, device='cuda:1')
benign distance is  tensor(110.6553, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.392697244882584
distance x is tensor(128.6442, device='cuda:1')
benign distance is  tensor(128.6442, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.634660929441452
distance x is tensor(157.2132, device='cuda:1')
benign distance is  tensor(157.2132, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.897388339042664
distance x is tensor(124.7517, device='cuda:1')
benign distance is  tensor(124.7517, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.722418665885925
distance x is tensor(135.0892, device='cuda:1')
benign distance is  tensor(135.0892, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.350886940956116
distance x is tensor(116.2014, device='cuda:1')
benign distance is  tensor(116.2014, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.206433266401291
distance x is tensor(134.5328, device='cuda:1')
benign distance is  tensor(134.5328, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.743408679962158
distance x is tensor(143.1715, device='cuda:1')
benign distance is  tensor(143.1715, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.141541540622711
distance x is tensor(113.4458, device='cuda:1')
benign distance is  tensor(113.4458, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.742228746414185
distance x is tensor(143.0032, device='cuda:1')
benign distance is  tensor(143.0032, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.877207070589066
distance x is tensor(121.7764, device='cuda:1')
benign distance is  tensor(121.7764, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.986278831958771
distance x is tensor(131.7002, device='cuda:1')
benign distance is  tensor(131.7002, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.228818833827972
distance x is tensor(154.1710, device='cuda:1')
benign distance is  tensor(154.1710, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 8., 14., 19.,  0.,  0., 19.,  0.,  1., 19., 19., 16.,  0., 19., 19.,
        19., 19., 10.,  0., 19.,  0.])
count_res tensor([1.8441e-06, 7.4398e-04, 1.1042e-01, 6.1864e-10, 6.1864e-10, 1.1042e-01,
        6.1864e-10, 1.6816e-09, 1.1042e-01, 1.1042e-01, 5.4973e-03, 6.1864e-10,
        1.1042e-01, 1.1042e-01, 1.1042e-01, 1.1042e-01, 1.3626e-05, 6.1864e-10,
        1.1042e-01, 6.1864e-10])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 42.60% 

Test Accuracy: 12.07% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7026263698935509
distance x is tensor(159.8234, device='cuda:1')
benign distance is  tensor(159.8234, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.364047210663557
distance x is tensor(131.3148, device='cuda:1')
benign distance is  tensor(131.3148, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3524676784873009
distance x is tensor(125.5310, device='cuda:1')
benign distance is  tensor(125.5310, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4603401012718678
distance x is tensor(173.2791, device='cuda:1')
benign distance is  tensor(173.2791, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3968306854367256
distance x is tensor(126.4979, device='cuda:1')
benign distance is  tensor(126.4979, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9345293715596199
distance x is tensor(135.3056, device='cuda:1')
benign distance is  tensor(135.3056, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.711625598371029
distance x is tensor(135.2297, device='cuda:1')
benign distance is  tensor(135.2297, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0561563670635223
distance x is tensor(123.0729, device='cuda:1')
benign distance is  tensor(123.0729, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.997506380081177
distance x is tensor(79.8563, device='cuda:1')
benign distance is  tensor(79.8563, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.625717788934708
distance x is tensor(130.2244, device='cuda:1')
benign distance is  tensor(130.2244, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.920098781585693
distance x is tensor(104.7413, device='cuda:1')
benign distance is  tensor(104.7413, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.558789789676666
distance x is tensor(87.7375, device='cuda:1')
benign distance is  tensor(87.7375, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.17883986234665
distance x is tensor(81.9192, device='cuda:1')
benign distance is  tensor(81.9192, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.567501276731491
distance x is tensor(98.5316, device='cuda:1')
benign distance is  tensor(98.5316, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.065303027629852
distance x is tensor(115.1927, device='cuda:1')
benign distance is  tensor(115.1927, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.494186908006668
distance x is tensor(81.1151, device='cuda:1')
benign distance is  tensor(81.1151, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.257363855838776
distance x is tensor(108.5253, device='cuda:1')
benign distance is  tensor(108.5253, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.378141015768051
distance x is tensor(93.7044, device='cuda:1')
benign distance is  tensor(93.7044, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.432433396577835
distance x is tensor(105.1967, device='cuda:1')
benign distance is  tensor(105.1967, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.707609385251999
distance x is tensor(134.9006, device='cuda:1')
benign distance is  tensor(134.9006, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([45.,  0., 51.,  0., 51., 51.,  0.,  1., 49., 46., 42.,  0.,  3., 28.,
        13.,  0., 43.,  0., 45., 51.,  0., 36.,  0., 51., 51.,  0.,  0.,  5.,
        51., 50.,  0.,  0.,  0., 51., 50.,  0., 14., 51., 51., 50., 36., 47.,
         0., 47.,  0.,  0., 51., 51., 50.,  2., 39., 51.])
count_res tensor([1.6913e-04, 4.8415e-24, 6.8233e-02, 4.8415e-24, 6.8233e-02, 6.8233e-02,
        4.8415e-24, 1.3160e-23, 9.2343e-03, 4.5975e-04, 8.4206e-06, 4.8415e-24,
        9.7243e-23, 7.0020e-12, 2.1419e-18, 4.8415e-24, 2.2890e-05, 4.8415e-24,
        1.6913e-04, 6.8233e-02, 4.8415e-24, 2.0873e-08, 4.8415e-24, 6.8233e-02,
        6.8233e-02, 4.8415e-24, 4.8415e-24, 7.1854e-22, 6.8233e-02, 2.5102e-02,
        4.8415e-24, 4.8415e-24, 4.8415e-24, 6.8233e-02, 2.5102e-02, 4.8415e-24,
        5.8224e-18, 6.8233e-02, 6.8233e-02, 2.5102e-02, 2.0873e-08, 1.2497e-03,
        4.8415e-24, 1.2497e-03, 4.8415e-24, 4.8415e-24, 6.8233e-02, 6.8233e-02,
        2.5102e-02, 3.5774e-23, 4.1924e-07, 6.8233e-02])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 77.84% 

Test Accuracy: 84.44% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9237948544323444
distance x is tensor(121.3147, device='cuda:1')
benign distance is  tensor(121.3147, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.963863629847765
distance x is tensor(112.3230, device='cuda:1')
benign distance is  tensor(112.3230, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.051986612379551
distance x is tensor(89.8292, device='cuda:1')
benign distance is  tensor(89.8292, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0419402942061424
distance x is tensor(135.5439, device='cuda:1')
benign distance is  tensor(135.5439, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0757484138011932
distance x is tensor(86.0531, device='cuda:1')
benign distance is  tensor(86.0531, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8594697322696447
distance x is tensor(88.4152, device='cuda:1')
benign distance is  tensor(88.4152, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2275973819196224
distance x is tensor(91.2411, device='cuda:1')
benign distance is  tensor(91.2411, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8408233169466257
distance x is tensor(82.7225, device='cuda:1')
benign distance is  tensor(82.7225, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2039422504603863
distance x is tensor(97.0038, device='cuda:1')
benign distance is  tensor(97.0038, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7726165298372507
distance x is tensor(119.0497, device='cuda:1')
benign distance is  tensor(119.0497, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2240437008440495
distance x is tensor(63.4971, device='cuda:1')
benign distance is  tensor(63.4971, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.8756442591547966
distance x is tensor(104.0706, device='cuda:1')
benign distance is  tensor(104.0706, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.506777249276638
distance x is tensor(153.7704, device='cuda:1')
benign distance is  tensor(153.7704, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0416952557861805
distance x is tensor(56.1374, device='cuda:1')
benign distance is  tensor(56.1374, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.177506536245346
distance x is tensor(131.3416, device='cuda:1')
benign distance is  tensor(131.3416, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5157703831791878
distance x is tensor(111.8027, device='cuda:1')
benign distance is  tensor(111.8027, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4756407961249352
distance x is tensor(95.7520, device='cuda:1')
benign distance is  tensor(95.7520, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0554944314062595
distance x is tensor(101.2430, device='cuda:1')
benign distance is  tensor(101.2430, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2632754519581795
distance x is tensor(107.9655, device='cuda:1')
benign distance is  tensor(107.9655, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.190626598894596
distance x is tensor(107.6150, device='cuda:1')
benign distance is  tensor(107.6150, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.326150193810463
distance x is tensor(71.4437, device='cuda:1')
benign distance is  tensor(71.4437, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0695918183773756
distance x is tensor(204.9393, device='cuda:1')
benign distance is  tensor(204.9393, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9864538572728634
distance x is tensor(142.5212, device='cuda:1')
benign distance is  tensor(142.5212, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7687039729207754
distance x is tensor(109.1717, device='cuda:1')
benign distance is  tensor(109.1717, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.3132784888148308
distance x is tensor(113.3028, device='cuda:1')
benign distance is  tensor(113.3028, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7844743933528662
distance x is tensor(73.0813, device='cuda:1')
benign distance is  tensor(73.0813, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0180052798241377
distance x is tensor(125.8308, device='cuda:1')
benign distance is  tensor(125.8308, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.361173428595066
distance x is tensor(105.3190, device='cuda:1')
benign distance is  tensor(105.3190, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8992124367505312
distance x is tensor(107.1774, device='cuda:1')
benign distance is  tensor(107.1774, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8921834956854582
distance x is tensor(97.6623, device='cuda:1')
benign distance is  tensor(97.6623, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5771566908806562
distance x is tensor(118.5054, device='cuda:1')
benign distance is  tensor(118.5054, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8306927736848593
distance x is tensor(158.6444, device='cuda:1')
benign distance is  tensor(158.6444, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3597059529274702
distance x is tensor(107.1186, device='cuda:1')
benign distance is  tensor(107.1186, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.7503125667572021
distance x is tensor(132.9245, device='cuda:1')
benign distance is  tensor(132.9245, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1962323319166899
distance x is tensor(140.9363, device='cuda:1')
benign distance is  tensor(140.9363, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9795567765831947
distance x is tensor(76.0606, device='cuda:1')
benign distance is  tensor(76.0606, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8648813664913177
distance x is tensor(142.9711, device='cuda:1')
benign distance is  tensor(142.9711, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0814105495810509
distance x is tensor(128.0058, device='cuda:1')
benign distance is  tensor(128.0058, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1388333030045033
distance x is tensor(88.3679, device='cuda:1')
benign distance is  tensor(88.3679, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5379985086619854
distance x is tensor(132.3304, device='cuda:1')
benign distance is  tensor(132.3304, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.988687753677368
distance x is tensor(146.7133, device='cuda:1')
benign distance is  tensor(146.7133, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.395068556070328
distance x is tensor(163.9123, device='cuda:1')
benign distance is  tensor(163.9123, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.538435161113739
distance x is tensor(148.9798, device='cuda:1')
benign distance is  tensor(148.9798, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.362674504518509
distance x is tensor(134.4026, device='cuda:1')
benign distance is  tensor(134.4026, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.4090622663497925
distance x is tensor(119.9887, device='cuda:1')
benign distance is  tensor(119.9887, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.27062201499939
distance x is tensor(136.9472, device='cuda:1')
benign distance is  tensor(136.9472, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.453310012817383
distance x is tensor(162.2054, device='cuda:1')
benign distance is  tensor(162.2054, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.297303229570389
distance x is tensor(134.6767, device='cuda:1')
benign distance is  tensor(134.6767, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.274335265159607
distance x is tensor(151.3767, device='cuda:1')
benign distance is  tensor(151.3767, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.763361066579819
distance x is tensor(138.1074, device='cuda:1')
benign distance is  tensor(138.1074, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.402708530426025
distance x is tensor(148.1246, device='cuda:1')
benign distance is  tensor(148.1246, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.693838775157928
distance x is tensor(173.3707, device='cuda:1')
benign distance is  tensor(173.3707, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  0., 22.,  0.,  0., 23.,  0.,  0., 27., 27., 26., 27., 27.,  0.,
        27., 12., 26., 27., 17., 27.,  0.,  0., 27., 22.,  2., 27., 27.,  0.])
count_res tensor([1.7455e-13, 1.7455e-13, 6.2576e-04, 1.7455e-13, 1.7455e-13, 1.7010e-03,
        1.7455e-13, 1.7455e-13, 9.2871e-02, 9.2871e-02, 3.4165e-02, 9.2871e-02,
        9.2871e-02, 1.7455e-13, 9.2871e-02, 2.8410e-08, 3.4165e-02, 9.2871e-02,
        4.2163e-06, 9.2871e-02, 1.7455e-13, 1.7455e-13, 9.2871e-02, 6.2576e-04,
        1.2898e-12, 9.2871e-02, 9.2871e-02, 1.7455e-13])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 43.76% 

Test Accuracy: 13.50% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9332243017852306
distance x is tensor(156.1624, device='cuda:1')
benign distance is  tensor(156.1624, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.159497931599617
distance x is tensor(123.9760, device='cuda:1')
benign distance is  tensor(123.9760, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.387074664235115
distance x is tensor(125.3319, device='cuda:1')
benign distance is  tensor(125.3319, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1647972986102104
distance x is tensor(160.4942, device='cuda:1')
benign distance is  tensor(160.4942, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2498666532337666
distance x is tensor(127.3151, device='cuda:1')
benign distance is  tensor(127.3151, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0514471679925919
distance x is tensor(118.4494, device='cuda:1')
benign distance is  tensor(118.4494, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5958421155810356
distance x is tensor(128.8219, device='cuda:1')
benign distance is  tensor(128.8219, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0751074440777302
distance x is tensor(115.7572, device='cuda:1')
benign distance is  tensor(115.7572, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7915467321872711
distance x is tensor(141.2902, device='cuda:1')
benign distance is  tensor(141.2902, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.4245104901492596
distance x is tensor(130.6776, device='cuda:1')
benign distance is  tensor(130.6776, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.2646559067070484
distance x is tensor(158.8148, device='cuda:1')
benign distance is  tensor(158.8148, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.4213178530335426
distance x is tensor(147.0965, device='cuda:1')
benign distance is  tensor(147.0965, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7886649649590254
distance x is tensor(133.3751, device='cuda:1')
benign distance is  tensor(133.3751, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0414808578789234
distance x is tensor(120.2924, device='cuda:1')
benign distance is  tensor(120.2924, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.1845069862902164
distance x is tensor(119.2818, device='cuda:1')
benign distance is  tensor(119.2818, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8500547856092453
distance x is tensor(140.3130, device='cuda:1')
benign distance is  tensor(140.3130, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.554099977016449
distance x is tensor(80.5832, device='cuda:1')
benign distance is  tensor(80.5832, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.767007023096085
distance x is tensor(128.3736, device='cuda:1')
benign distance is  tensor(128.3736, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.80942115187645
distance x is tensor(94.6344, device='cuda:1')
benign distance is  tensor(94.6344, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.76168042421341
distance x is tensor(91.2740, device='cuda:1')
benign distance is  tensor(91.2740, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.881583541631699
distance x is tensor(77.2172, device='cuda:1')
benign distance is  tensor(77.2172, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.342967212200165
distance x is tensor(107.0197, device='cuda:1')
benign distance is  tensor(107.0197, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.190403431653976
distance x is tensor(115.8320, device='cuda:1')
benign distance is  tensor(115.8320, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.439879685640335
distance x is tensor(87.4380, device='cuda:1')
benign distance is  tensor(87.4380, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.48728060722351
distance x is tensor(109.5975, device='cuda:1')
benign distance is  tensor(109.5975, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.606598556041718
distance x is tensor(90.0846, device='cuda:1')
benign distance is  tensor(90.0846, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.963483393192291
distance x is tensor(107.0011, device='cuda:1')
benign distance is  tensor(107.0011, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.777850449085236
distance x is tensor(136.5291, device='cuda:1')
benign distance is  tensor(136.5291, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  3., 26., 27., 27., 27.,  0., 27.,  0., 27.,  4., 27., 24., 23.,
         0., 20., 27., 24.,  0., 20.,  0., 27.,  5.,  0.,  0., 12., 18., 25.])
count_res tensor([2.1797e-13, 4.3780e-12, 4.2662e-02, 1.1597e-01, 1.1597e-01, 1.1597e-01,
        2.1797e-13, 1.1597e-01, 2.1797e-13, 1.1597e-01, 1.1901e-11, 1.1597e-01,
        5.7737e-03, 2.1240e-03, 2.1797e-13, 1.0575e-04, 1.1597e-01, 5.7737e-03,
        2.1797e-13, 1.0575e-04, 2.1797e-13, 1.1597e-01, 3.2349e-11, 2.1797e-13,
        2.1797e-13, 3.5475e-08, 1.4312e-05, 1.5695e-02])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 74.30% 

Test Accuracy: 81.53% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6560905668884516
distance x is tensor(122.7818, device='cuda:1')
benign distance is  tensor(122.7818, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9912334084510803
distance x is tensor(102.3181, device='cuda:1')
benign distance is  tensor(102.3181, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1905720122158527
distance x is tensor(98.7556, device='cuda:1')
benign distance is  tensor(98.7556, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4474721439182758
distance x is tensor(145.4571, device='cuda:1')
benign distance is  tensor(145.4571, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0205213613808155
distance x is tensor(87.8418, device='cuda:1')
benign distance is  tensor(87.8418, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9028226593509316
distance x is tensor(88.5223, device='cuda:1')
benign distance is  tensor(88.5223, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3177054226398468
distance x is tensor(87.9579, device='cuda:1')
benign distance is  tensor(87.9579, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9102081432938576
distance x is tensor(85.3714, device='cuda:1')
benign distance is  tensor(85.3714, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1716366149485111
distance x is tensor(97.4708, device='cuda:1')
benign distance is  tensor(97.4708, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.829693959094584
distance x is tensor(122.3716, device='cuda:1')
benign distance is  tensor(122.3716, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4734503850340843
distance x is tensor(78.0158, device='cuda:1')
benign distance is  tensor(78.0158, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3638990968465805
distance x is tensor(110.8633, device='cuda:1')
benign distance is  tensor(110.8633, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4116921350359917
distance x is tensor(153.6027, device='cuda:1')
benign distance is  tensor(153.6027, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9898140877485275
distance x is tensor(67.7739, device='cuda:1')
benign distance is  tensor(67.7739, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2984099797904491
distance x is tensor(131.6636, device='cuda:1')
benign distance is  tensor(131.6636, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.701429843902588
distance x is tensor(121.9879, device='cuda:1')
benign distance is  tensor(121.9879, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.888398110866547
distance x is tensor(121.5427, device='cuda:1')
benign distance is  tensor(121.5427, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.80236628651619
distance x is tensor(133.6171, device='cuda:1')
benign distance is  tensor(133.6171, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.212018251419067
distance x is tensor(121.4638, device='cuda:1')
benign distance is  tensor(121.4638, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.383865654468536
distance x is tensor(116.9562, device='cuda:1')
benign distance is  tensor(116.9562, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.056207150220871
distance x is tensor(106.7961, device='cuda:1')
benign distance is  tensor(106.7961, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.859379917383194
distance x is tensor(126.2026, device='cuda:1')
benign distance is  tensor(126.2026, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.393890112638474
distance x is tensor(136.9586, device='cuda:1')
benign distance is  tensor(136.9586, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.7001058757305145
distance x is tensor(106.4280, device='cuda:1')
benign distance is  tensor(106.4280, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.584904134273529
distance x is tensor(122.7026, device='cuda:1')
benign distance is  tensor(122.7026, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.116221636533737
distance x is tensor(113.8555, device='cuda:1')
benign distance is  tensor(113.8555, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.683702558279037
distance x is tensor(121.0122, device='cuda:1')
benign distance is  tensor(121.0122, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.328982472419739
distance x is tensor(156.9842, device='cuda:1')
benign distance is  tensor(156.9842, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  0., 27.,  0., 26., 25.,  0., 27., 27., 26., 27., 27.,  0., 23.,
        12., 27., 26.,  3., 23., 27.,  3.,  0., 17., 20.,  0.,  0., 27.,  0.])
count_res tensor([2.0261e-13, 2.0261e-13, 1.0780e-01, 2.0261e-13, 3.9657e-02, 1.4589e-02,
        2.0261e-13, 1.0780e-01, 1.0780e-01, 3.9657e-02, 1.0780e-01, 1.0780e-01,
        2.0261e-13, 1.9744e-03, 3.2976e-08, 1.0780e-01, 3.9657e-02, 4.0695e-12,
        1.9744e-03, 1.0780e-01, 4.0695e-12, 2.0261e-13, 4.8940e-06, 9.8300e-05,
        2.0261e-13, 2.0261e-13, 1.0780e-01, 2.0261e-13])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 64.30% 

Test Accuracy: 25.31% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7870994061231613
distance x is tensor(136.3860, device='cuda:1')
benign distance is  tensor(136.3860, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1200469825416803
distance x is tensor(120.7742, device='cuda:1')
benign distance is  tensor(120.7742, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1778694577515125
distance x is tensor(111.8108, device='cuda:1')
benign distance is  tensor(111.8108, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2709636576473713
distance x is tensor(157.4955, device='cuda:1')
benign distance is  tensor(157.4955, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.218344897031784
distance x is tensor(112.5533, device='cuda:1')
benign distance is  tensor(112.5533, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.972799745388329
distance x is tensor(124.0912, device='cuda:1')
benign distance is  tensor(124.0912, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7028446942567825
distance x is tensor(120.6625, device='cuda:1')
benign distance is  tensor(120.6625, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0395432449877262
distance x is tensor(95.8061, device='cuda:1')
benign distance is  tensor(95.8061, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4875359013676643
distance x is tensor(112.2570, device='cuda:1')
benign distance is  tensor(112.2570, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3001662120223045
distance x is tensor(123.8598, device='cuda:1')
benign distance is  tensor(123.8598, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.378768153488636
distance x is tensor(123.7861, device='cuda:1')
benign distance is  tensor(123.7861, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3159508407115936
distance x is tensor(136.3955, device='cuda:1')
benign distance is  tensor(136.3955, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9775208868086338
distance x is tensor(110.2030, device='cuda:1')
benign distance is  tensor(110.2030, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0010029468685389
distance x is tensor(214.7737, device='cuda:1')
benign distance is  tensor(214.7737, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4556876383721828
distance x is tensor(151.6929, device='cuda:1')
benign distance is  tensor(151.6929, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.205955507233739
distance x is tensor(132.0750, device='cuda:1')
benign distance is  tensor(132.0750, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.019374400377274
distance x is tensor(86.9044, device='cuda:1')
benign distance is  tensor(86.9044, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.731890559196472
distance x is tensor(129.1517, device='cuda:1')
benign distance is  tensor(129.1517, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.346788316965103
distance x is tensor(106.9033, device='cuda:1')
benign distance is  tensor(106.9033, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  7.731230586767197
distance x is tensor(85.5109, device='cuda:1')
benign distance is  tensor(85.5109, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.819742143154144
distance x is tensor(86.0024, device='cuda:1')
benign distance is  tensor(86.0024, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.270827621221542
distance x is tensor(108.0285, device='cuda:1')
benign distance is  tensor(108.0285, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.151339411735535
distance x is tensor(121.1920, device='cuda:1')
benign distance is  tensor(121.1920, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.154017150402069
distance x is tensor(87.1314, device='cuda:1')
benign distance is  tensor(87.1314, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.327695161104202
distance x is tensor(108.2513, device='cuda:1')
benign distance is  tensor(108.2513, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.253778368234634
distance x is tensor(92.7700, device='cuda:1')
benign distance is  tensor(92.7700, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.731184870004654
distance x is tensor(112.4074, device='cuda:1')
benign distance is  tensor(112.4074, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.988775253295898
distance x is tensor(131.8065, device='cuda:1')
benign distance is  tensor(131.8065, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 2., 34., 35., 35., 35.,  0.,  0., 35., 30., 24., 35., 34., 32.,  0.,
        28.,  0., 35.,  0., 28., 35., 18., 35., 35.,  8.,  0., 35.,  1., 33.,
         0.,  0.,  0.,  0., 10., 35., 17.,  0.])
count_res tensor([3.9054e-16, 3.0838e-02, 8.3826e-02, 8.3826e-02, 8.3826e-02, 5.2853e-17,
        5.2853e-17, 8.3826e-02, 5.6482e-04, 1.4000e-06, 8.3826e-02, 3.0838e-02,
        4.1735e-03, 5.2853e-17, 7.6440e-05, 5.2853e-17, 8.3826e-02, 5.2853e-17,
        7.6440e-05, 8.3826e-02, 3.4703e-09, 8.3826e-02, 8.3826e-02, 1.5755e-13,
        5.2853e-17, 8.3826e-02, 1.4367e-16, 1.1345e-02, 5.2853e-17, 5.2853e-17,
        5.2853e-17, 5.2853e-17, 1.1642e-12, 8.3826e-02, 1.2767e-09, 5.2853e-17])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 76.59% 

Test Accuracy: 83.94% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7132463902235031
distance x is tensor(132.7482, device='cuda:1')
benign distance is  tensor(132.7482, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0846718177199364
distance x is tensor(108.6534, device='cuda:1')
benign distance is  tensor(108.6534, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1205192245543003
distance x is tensor(88.1563, device='cuda:1')
benign distance is  tensor(88.1563, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.303761750459671
distance x is tensor(135.3412, device='cuda:1')
benign distance is  tensor(135.3412, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7673164159059525
distance x is tensor(90.4709, device='cuda:1')
benign distance is  tensor(90.4709, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9817570308223367
distance x is tensor(94.5720, device='cuda:1')
benign distance is  tensor(94.5720, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1233666688203812
distance x is tensor(92.2554, device='cuda:1')
benign distance is  tensor(92.2554, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0053172633051872
distance x is tensor(86.3815, device='cuda:1')
benign distance is  tensor(86.3815, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.169506672769785
distance x is tensor(95.7715, device='cuda:1')
benign distance is  tensor(95.7715, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0240058191120625
distance x is tensor(120.8221, device='cuda:1')
benign distance is  tensor(120.8221, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.157750528305769
distance x is tensor(66.5786, device='cuda:1')
benign distance is  tensor(66.5786, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4651584699749947
distance x is tensor(117.9760, device='cuda:1')
benign distance is  tensor(117.9760, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.101401336491108
distance x is tensor(156.8105, device='cuda:1')
benign distance is  tensor(156.8105, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8400623686611652
distance x is tensor(56.4060, device='cuda:1')
benign distance is  tensor(56.4060, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.483929816633463
distance x is tensor(137.2613, device='cuda:1')
benign distance is  tensor(137.2613, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.663631722331047
distance x is tensor(119.5323, device='cuda:1')
benign distance is  tensor(119.5323, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4371376633644104
distance x is tensor(111.3970, device='cuda:1')
benign distance is  tensor(111.3970, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8644070699810982
distance x is tensor(74.9606, device='cuda:1')
benign distance is  tensor(74.9606, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.202659908682108
distance x is tensor(116.3088, device='cuda:1')
benign distance is  tensor(116.3088, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2957932241261005
distance x is tensor(119.1820, device='cuda:1')
benign distance is  tensor(119.1820, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1376957036554813
distance x is tensor(112.9232, device='cuda:1')
benign distance is  tensor(112.9232, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.1179083492606878
distance x is tensor(99.6830, device='cuda:1')
benign distance is  tensor(99.6830, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6079374747350812
distance x is tensor(117.5143, device='cuda:1')
benign distance is  tensor(117.5143, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7645564638078213
distance x is tensor(169.9619, device='cuda:1')
benign distance is  tensor(169.9619, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.537376880645752
distance x is tensor(132.8896, device='cuda:1')
benign distance is  tensor(132.8896, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.5680796802043915
distance x is tensor(153.9263, device='cuda:1')
benign distance is  tensor(153.9263, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.159641802310944
distance x is tensor(125.1856, device='cuda:1')
benign distance is  tensor(125.1856, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.956346422433853
distance x is tensor(128.0083, device='cuda:1')
benign distance is  tensor(128.0083, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.030870854854584
distance x is tensor(112.1123, device='cuda:1')
benign distance is  tensor(112.1123, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.061655938625336
distance x is tensor(129.1308, device='cuda:1')
benign distance is  tensor(129.1308, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.607597529888153
distance x is tensor(143.5631, device='cuda:1')
benign distance is  tensor(143.5631, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.13980346918106
distance x is tensor(116.5124, device='cuda:1')
benign distance is  tensor(116.5124, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.474885821342468
distance x is tensor(122.2507, device='cuda:1')
benign distance is  tensor(122.2507, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.037243366241455
distance x is tensor(120.4950, device='cuda:1')
benign distance is  tensor(120.4950, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.538033455610275
distance x is tensor(138.5915, device='cuda:1')
benign distance is  tensor(138.5915, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.39940294623375
distance x is tensor(156.5805, device='cuda:1')
benign distance is  tensor(156.5805, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 1.,  0., 10.,  1.,  0.,  0., 17.,  0., 19., 19., 19., 19., 19.,  0.,
        19.,  4., 19., 19., 17., 18.])
count_res tensor([1.7630e-09, 6.4857e-10, 1.4286e-05, 1.7630e-09, 6.4857e-10, 6.4857e-10,
        1.5666e-02, 6.4857e-10, 1.1576e-01, 1.1576e-01, 1.1576e-01, 1.1576e-01,
        1.1576e-01, 6.4857e-10, 1.1576e-01, 3.5411e-08, 1.1576e-01, 1.1576e-01,
        1.5666e-02, 4.2585e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 31.61% 

Test Accuracy: 9.10% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8033034317195415
distance x is tensor(180.4609, device='cuda:1')
benign distance is  tensor(180.4609, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2956845462322235
distance x is tensor(154.4942, device='cuda:1')
benign distance is  tensor(154.4942, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6135488003492355
distance x is tensor(148.2841, device='cuda:1')
benign distance is  tensor(148.2841, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3667101375758648
distance x is tensor(187.9881, device='cuda:1')
benign distance is  tensor(187.9881, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.729399412870407
distance x is tensor(151.3537, device='cuda:1')
benign distance is  tensor(151.3537, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0063903275877237
distance x is tensor(156.6920, device='cuda:1')
benign distance is  tensor(156.6920, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.583042699843645
distance x is tensor(163.3595, device='cuda:1')
benign distance is  tensor(163.3595, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1735938973724842
distance x is tensor(141.6931, device='cuda:1')
benign distance is  tensor(141.6931, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.911186218261719
distance x is tensor(70.2010, device='cuda:1')
benign distance is  tensor(70.2010, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.023858547210693
distance x is tensor(123.4232, device='cuda:1')
benign distance is  tensor(123.4232, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.52205166220665
distance x is tensor(100.1441, device='cuda:1')
benign distance is  tensor(100.1441, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.479210436344147
distance x is tensor(76.1617, device='cuda:1')
benign distance is  tensor(76.1617, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.140269815921783
distance x is tensor(86.2583, device='cuda:1')
benign distance is  tensor(86.2583, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.315682023763657
distance x is tensor(102.0471, device='cuda:1')
benign distance is  tensor(102.0471, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.709576189517975
distance x is tensor(113.3609, device='cuda:1')
benign distance is  tensor(113.3609, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.935569286346436
distance x is tensor(84.5562, device='cuda:1')
benign distance is  tensor(84.5562, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.74861216545105
distance x is tensor(97.2755, device='cuda:1')
benign distance is  tensor(97.2755, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.609483450651169
distance x is tensor(94.2265, device='cuda:1')
benign distance is  tensor(94.2265, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.995887339115143
distance x is tensor(104.6873, device='cuda:1')
benign distance is  tensor(104.6873, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.050219416618347
distance x is tensor(132.9952, device='cuda:1')
benign distance is  tensor(132.9952, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([51., 50., 51., 51., 45.,  0.,  0.,  0.,  0., 49., 47., 51.,  0., 47.,
         0.,  2., 41., 13., 44., 51.,  0.,  0.,  3., 51.,  0., 51.,  0., 51.,
        45., 51., 21.,  0., 24., 51., 46., 51., 51.,  1., 51., 51.,  0.,  8.,
        51.,  0.,  0.,  0.,  0., 51., 51.,  0.,  0., 51.])
count_res tensor([5.3901e-02, 1.9829e-02, 5.3901e-02, 5.3901e-02, 1.3361e-04, 3.8245e-24,
        3.8245e-24, 3.8245e-24, 3.8245e-24, 7.2947e-03, 9.8723e-04, 5.3901e-02,
        3.8245e-24, 9.8723e-04, 3.8245e-24, 2.8260e-23, 2.4471e-06, 1.6920e-18,
        4.9151e-05, 5.3901e-02, 3.8245e-24, 3.8245e-24, 7.6818e-23, 5.3901e-02,
        3.8245e-24, 5.3901e-02, 3.8245e-24, 5.3901e-02, 1.3361e-04, 5.3901e-02,
        5.0439e-15, 3.8245e-24, 1.0131e-13, 5.3901e-02, 3.6318e-04, 5.3901e-02,
        5.3901e-02, 1.0396e-23, 5.3901e-02, 5.3901e-02, 3.8245e-24, 1.1401e-20,
        5.3901e-02, 3.8245e-24, 3.8245e-24, 3.8245e-24, 3.8245e-24, 5.3901e-02,
        5.3901e-02, 3.8245e-24, 3.8245e-24, 5.3901e-02])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 81.81% 

Test Accuracy: 85.72% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5979499164968729
distance x is tensor(110.5305, device='cuda:1')
benign distance is  tensor(110.5305, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9741080682724714
distance x is tensor(97.4729, device='cuda:1')
benign distance is  tensor(97.4729, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8038830161094666
distance x is tensor(94.5553, device='cuda:1')
benign distance is  tensor(94.5553, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.121959138661623
distance x is tensor(134.5888, device='cuda:1')
benign distance is  tensor(134.5888, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2141345627605915
distance x is tensor(78.6330, device='cuda:1')
benign distance is  tensor(78.6330, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8222881183028221
distance x is tensor(88.6467, device='cuda:1')
benign distance is  tensor(88.6467, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5689587481319904
distance x is tensor(90.2561, device='cuda:1')
benign distance is  tensor(90.2561, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8673446532338858
distance x is tensor(84.7122, device='cuda:1')
benign distance is  tensor(84.7122, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2169485315680504
distance x is tensor(99.2147, device='cuda:1')
benign distance is  tensor(99.2147, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7692110240459442
distance x is tensor(110.7561, device='cuda:1')
benign distance is  tensor(110.7561, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9403976574540138
distance x is tensor(68.1242, device='cuda:1')
benign distance is  tensor(68.1242, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4750577881932259
distance x is tensor(105.1907, device='cuda:1')
benign distance is  tensor(105.1907, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2185818627476692
distance x is tensor(160.4735, device='cuda:1')
benign distance is  tensor(160.4735, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9131482727825642
distance x is tensor(60.0287, device='cuda:1')
benign distance is  tensor(60.0287, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9833443704992533
distance x is tensor(127.2804, device='cuda:1')
benign distance is  tensor(127.2804, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5294501557946205
distance x is tensor(107.6259, device='cuda:1')
benign distance is  tensor(107.6259, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.302625872194767
distance x is tensor(85.0431, device='cuda:1')
benign distance is  tensor(85.0431, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9859564434736967
distance x is tensor(104.4884, device='cuda:1')
benign distance is  tensor(104.4884, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3977077156305313
distance x is tensor(106.5817, device='cuda:1')
benign distance is  tensor(106.5817, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0837251096963882
distance x is tensor(100.4235, device='cuda:1')
benign distance is  tensor(100.4235, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1381086148321629
distance x is tensor(68.4002, device='cuda:1')
benign distance is  tensor(68.4002, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8504257258027792
distance x is tensor(198.1874, device='cuda:1')
benign distance is  tensor(198.1874, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5683691278100014
distance x is tensor(121.9758, device='cuda:1')
benign distance is  tensor(121.9758, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9837015643715858
distance x is tensor(113.6675, device='cuda:1')
benign distance is  tensor(113.6675, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8476747162640095
distance x is tensor(130.1604, device='cuda:1')
benign distance is  tensor(130.1604, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.0614364296197891
distance x is tensor(86.4060, device='cuda:1')
benign distance is  tensor(86.4060, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9473615363240242
distance x is tensor(135.1493, device='cuda:1')
benign distance is  tensor(135.1493, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.4236645884811878
distance x is tensor(123.7930, device='cuda:1')
benign distance is  tensor(123.7930, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9055205583572388
distance x is tensor(111.7719, device='cuda:1')
benign distance is  tensor(111.7719, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0154551230370998
distance x is tensor(82.0813, device='cuda:1')
benign distance is  tensor(82.0813, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9541908837854862
distance x is tensor(87.2027, device='cuda:1')
benign distance is  tensor(87.2027, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8615605570375919
distance x is tensor(121.2038, device='cuda:1')
benign distance is  tensor(121.2038, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1986630838364363
distance x is tensor(96.1800, device='cuda:1')
benign distance is  tensor(96.1800, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.5157989636063576
distance x is tensor(138.1091, device='cuda:1')
benign distance is  tensor(138.1091, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2904695682227612
distance x is tensor(136.3853, device='cuda:1')
benign distance is  tensor(136.3853, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.2272780910134315
distance x is tensor(80.5916, device='cuda:1')
benign distance is  tensor(80.5916, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7652850560843945
distance x is tensor(145.8207, device='cuda:1')
benign distance is  tensor(145.8207, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9422564022243023
distance x is tensor(128.9556, device='cuda:1')
benign distance is  tensor(128.9556, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.083880752325058
distance x is tensor(96.9899, device='cuda:1')
benign distance is  tensor(96.9899, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5581997260451317
distance x is tensor(124.2035, device='cuda:1')
benign distance is  tensor(124.2035, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.593991249799728
distance x is tensor(123.6305, device='cuda:1')
benign distance is  tensor(123.6305, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.583936184644699
distance x is tensor(152.0304, device='cuda:1')
benign distance is  tensor(152.0304, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.951173186302185
distance x is tensor(165.4586, device='cuda:1')
benign distance is  tensor(165.4586, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  7.727471113204956
distance x is tensor(138.3324, device='cuda:1')
benign distance is  tensor(138.3324, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.750898391008377
distance x is tensor(121.1893, device='cuda:1')
benign distance is  tensor(121.1893, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.419657677412033
distance x is tensor(142.5811, device='cuda:1')
benign distance is  tensor(142.5811, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.179508209228516
distance x is tensor(150.8828, device='cuda:1')
benign distance is  tensor(150.8828, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.201061099767685
distance x is tensor(123.7633, device='cuda:1')
benign distance is  tensor(123.7633, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.092762053012848
distance x is tensor(146.9859, device='cuda:1')
benign distance is  tensor(146.9859, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.804067850112915
distance x is tensor(132.3888, device='cuda:1')
benign distance is  tensor(132.3888, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.9654026329517365
distance x is tensor(142.1864, device='cuda:1')
benign distance is  tensor(142.1864, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.26612076163292
distance x is tensor(157.7408, device='cuda:1')
benign distance is  tensor(157.7408, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0.,  0.,  0.,  1.,  0., 15.,  9.,  0., 19., 17., 19., 13., 19., 19.,
         0., 17., 19., 17., 19., 17.])
count_res tensor([8.5380e-10, 8.5380e-10, 8.5380e-10, 2.3209e-09, 8.5380e-10, 2.7911e-03,
        6.9184e-06, 8.5380e-10, 1.5239e-01, 2.0624e-02, 1.5239e-01, 3.7773e-04,
        1.5239e-01, 1.5239e-01, 8.5380e-10, 2.0624e-02, 1.5239e-01, 2.0624e-02,
        1.5239e-01, 2.0624e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 34.16% 

Test Accuracy: 9.61% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6529581900686026
distance x is tensor(168.0460, device='cuda:1')
benign distance is  tensor(168.0460, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3770917728543282
distance x is tensor(151.0754, device='cuda:1')
benign distance is  tensor(151.0754, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.786009967327118
distance x is tensor(141.9102, device='cuda:1')
benign distance is  tensor(141.9102, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3119681403040886
distance x is tensor(178.6971, device='cuda:1')
benign distance is  tensor(178.6971, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3335523791611195
distance x is tensor(144.0969, device='cuda:1')
benign distance is  tensor(144.0969, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9107779245823622
distance x is tensor(149.2259, device='cuda:1')
benign distance is  tensor(149.2259, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.435572788119316
distance x is tensor(147.0452, device='cuda:1')
benign distance is  tensor(147.0452, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9723907299339771
distance x is tensor(144.8465, device='cuda:1')
benign distance is  tensor(144.8465, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.100943505764008
distance x is tensor(72.6885, device='cuda:1')
benign distance is  tensor(72.6885, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.691594511270523
distance x is tensor(124.4842, device='cuda:1')
benign distance is  tensor(124.4842, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.965605020523071
distance x is tensor(86.8734, device='cuda:1')
benign distance is  tensor(86.8734, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.184373676776886
distance x is tensor(80.6055, device='cuda:1')
benign distance is  tensor(80.6055, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.50570347905159
distance x is tensor(70.8961, device='cuda:1')
benign distance is  tensor(70.8961, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.356953948736191
distance x is tensor(101.0713, device='cuda:1')
benign distance is  tensor(101.0713, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.467373192310333
distance x is tensor(117.7989, device='cuda:1')
benign distance is  tensor(117.7989, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.0423164665699005
distance x is tensor(87.1364, device='cuda:1')
benign distance is  tensor(87.1364, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.773131400346756
distance x is tensor(95.9202, device='cuda:1')
benign distance is  tensor(95.9202, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.309701770544052
distance x is tensor(95.8539, device='cuda:1')
benign distance is  tensor(95.8539, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.542882025241852
distance x is tensor(100.3106, device='cuda:1')
benign distance is  tensor(100.3106, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.00254374742508
distance x is tensor(135.7277, device='cuda:1')
benign distance is  tensor(135.7277, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([35.,  0., 12., 15.,  0., 35., 35.,  0., 32.,  0., 34., 30., 26.,  0.,
        35., 33., 28.,  0.,  7., 33.,  0., 34., 10.,  0., 35., 35.,  3.,  0.,
         1.,  0., 35., 34., 35.,  3., 35., 34.])
count_res tensor([9.2595e-02, 5.8382e-17, 9.5020e-12, 1.9085e-10, 5.8382e-17, 9.2595e-02,
        9.2595e-02, 5.8382e-17, 4.6100e-03, 5.8382e-17, 3.4064e-02, 6.2390e-04,
        1.1427e-05, 5.8382e-17, 9.2595e-02, 1.2531e-02, 8.4435e-05, 5.8382e-17,
        6.4024e-14, 1.2531e-02, 5.8382e-17, 3.4064e-02, 1.2860e-12, 5.8382e-17,
        9.2595e-02, 9.2595e-02, 1.1726e-15, 5.8382e-17, 1.5870e-16, 5.8382e-17,
        9.2595e-02, 3.4064e-02, 9.2595e-02, 1.1726e-15, 9.2595e-02, 3.4064e-02])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 81.07% 

Test Accuracy: 84.72% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8534329831600189
distance x is tensor(117.8065, device='cuda:1')
benign distance is  tensor(117.8065, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9925295896828175
distance x is tensor(96.3096, device='cuda:1')
benign distance is  tensor(96.3096, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8688613325357437
distance x is tensor(92.9702, device='cuda:1')
benign distance is  tensor(92.9702, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9721400253474712
distance x is tensor(133.4034, device='cuda:1')
benign distance is  tensor(133.4034, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.096812380477786
distance x is tensor(102.4996, device='cuda:1')
benign distance is  tensor(102.4996, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8426700970157981
distance x is tensor(94.6761, device='cuda:1')
benign distance is  tensor(94.6761, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5450062714517117
distance x is tensor(85.9215, device='cuda:1')
benign distance is  tensor(85.9215, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8815895654261112
distance x is tensor(79.3711, device='cuda:1')
benign distance is  tensor(79.3711, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1739709004759789
distance x is tensor(100.9558, device='cuda:1')
benign distance is  tensor(100.9558, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7252979748882353
distance x is tensor(109.3221, device='cuda:1')
benign distance is  tensor(109.3221, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.234174631536007
distance x is tensor(58.3314, device='cuda:1')
benign distance is  tensor(58.3314, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6739045903086662
distance x is tensor(105.2841, device='cuda:1')
benign distance is  tensor(105.2841, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.245976533740759
distance x is tensor(143.1295, device='cuda:1')
benign distance is  tensor(143.1295, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8189967013895512
distance x is tensor(52.9603, device='cuda:1')
benign distance is  tensor(52.9603, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3928597643971443
distance x is tensor(136.1410, device='cuda:1')
benign distance is  tensor(136.1410, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.280948281288147
distance x is tensor(111.9981, device='cuda:1')
benign distance is  tensor(111.9981, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1688699536025524
distance x is tensor(113.9640, device='cuda:1')
benign distance is  tensor(113.9640, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7561373002827168
distance x is tensor(71.7551, device='cuda:1')
benign distance is  tensor(71.7551, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.961965112015605
distance x is tensor(115.7982, device='cuda:1')
benign distance is  tensor(115.7982, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.6881123334169388
distance x is tensor(111.6313, device='cuda:1')
benign distance is  tensor(111.6313, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.107490487396717
distance x is tensor(115.7514, device='cuda:1')
benign distance is  tensor(115.7514, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0618262775242329
distance x is tensor(91.3633, device='cuda:1')
benign distance is  tensor(91.3633, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6245265882462263
distance x is tensor(133.6904, device='cuda:1')
benign distance is  tensor(133.6904, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8643459249287844
distance x is tensor(166.5204, device='cuda:1')
benign distance is  tensor(166.5204, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.324860632419586
distance x is tensor(124.1930, device='cuda:1')
benign distance is  tensor(124.1930, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.3348453640937805
distance x is tensor(147.2681, device='cuda:1')
benign distance is  tensor(147.2681, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.217660069465637
distance x is tensor(139.4040, device='cuda:1')
benign distance is  tensor(139.4040, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.013172537088394
distance x is tensor(122.4867, device='cuda:1')
benign distance is  tensor(122.4867, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.2680536806583405
distance x is tensor(112.2289, device='cuda:1')
benign distance is  tensor(112.2289, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.139591038227081
distance x is tensor(132.3392, device='cuda:1')
benign distance is  tensor(132.3392, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.451117187738419
distance x is tensor(141.4163, device='cuda:1')
benign distance is  tensor(141.4163, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.219336152076721
distance x is tensor(124.3920, device='cuda:1')
benign distance is  tensor(124.3920, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.179455608129501
distance x is tensor(127.8653, device='cuda:1')
benign distance is  tensor(127.8653, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.262052059173584
distance x is tensor(128.1816, device='cuda:1')
benign distance is  tensor(128.1816, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.875110596418381
distance x is tensor(137.6701, device='cuda:1')
benign distance is  tensor(137.6701, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.967402458190918
distance x is tensor(155.8621, device='cuda:1')
benign distance is  tensor(155.8621, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  0., 26.,  0.,  0., 15.,  1., 12., 27., 27., 27., 27., 25., 27.,
        26., 27., 18.,  8., 25., 27.,  0.,  0., 22.,  0.,  2., 25., 26.,  0.])
count_res tensor([2.2069e-13, 2.2069e-13, 4.3196e-02, 2.2069e-13, 2.2069e-13, 7.2145e-07,
        5.9990e-13, 3.5919e-08, 1.1742e-01, 1.1742e-01, 1.1742e-01, 1.1742e-01,
        1.5891e-02, 1.1742e-01, 4.3196e-02, 1.1742e-01, 1.4491e-05, 6.5787e-10,
        1.5891e-02, 1.1742e-01, 2.2069e-13, 2.2069e-13, 7.9116e-04, 2.2069e-13,
        1.6307e-12, 1.5891e-02, 4.3196e-02, 2.2069e-13])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 51.33% 

Test Accuracy: 15.18% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7624493259936571
distance x is tensor(160.2036, device='cuda:1')
benign distance is  tensor(160.2036, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0658525712788105
distance x is tensor(135.6650, device='cuda:1')
benign distance is  tensor(135.6650, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.072376076132059
distance x is tensor(141.2623, device='cuda:1')
benign distance is  tensor(141.2623, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3149823695421219
distance x is tensor(176.2990, device='cuda:1')
benign distance is  tensor(176.2990, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2072609141469002
distance x is tensor(140.6018, device='cuda:1')
benign distance is  tensor(140.6018, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.045774882659316
distance x is tensor(142.1365, device='cuda:1')
benign distance is  tensor(142.1365, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3246009796857834
distance x is tensor(142.6354, device='cuda:1')
benign distance is  tensor(142.6354, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0218353737145662
distance x is tensor(132.1213, device='cuda:1')
benign distance is  tensor(132.1213, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4181552305817604
distance x is tensor(139.4317, device='cuda:1')
benign distance is  tensor(139.4317, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1653229221701622
distance x is tensor(149.7998, device='cuda:1')
benign distance is  tensor(149.7998, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.6119607500731945
distance x is tensor(140.9345, device='cuda:1')
benign distance is  tensor(140.9345, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3276261612772942
distance x is tensor(158.9751, device='cuda:1')
benign distance is  tensor(158.9751, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.7283983528614044
distance x is tensor(134.4998, device='cuda:1')
benign distance is  tensor(134.4998, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7391326632350683
distance x is tensor(220.7353, device='cuda:1')
benign distance is  tensor(220.7353, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.384155087172985
distance x is tensor(169.9578, device='cuda:1')
benign distance is  tensor(169.9578, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4034316018223763
distance x is tensor(161.0957, device='cuda:1')
benign distance is  tensor(161.0957, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.58448338508606
distance x is tensor(72.3747, device='cuda:1')
benign distance is  tensor(72.3747, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.04003381729126
distance x is tensor(124.6301, device='cuda:1')
benign distance is  tensor(124.6301, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.948300272226334
distance x is tensor(76.6004, device='cuda:1')
benign distance is  tensor(76.6004, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.105325698852539
distance x is tensor(80.9425, device='cuda:1')
benign distance is  tensor(80.9425, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.090850472450256
distance x is tensor(86.1570, device='cuda:1')
benign distance is  tensor(86.1570, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.1886429488658905
distance x is tensor(118.2694, device='cuda:1')
benign distance is  tensor(118.2694, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.288892090320587
distance x is tensor(117.1190, device='cuda:1')
benign distance is  tensor(117.1190, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.701577931642532
distance x is tensor(82.8283, device='cuda:1')
benign distance is  tensor(82.8283, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.613291561603546
distance x is tensor(103.9984, device='cuda:1')
benign distance is  tensor(103.9984, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.603754878044128
distance x is tensor(95.3858, device='cuda:1')
benign distance is  tensor(95.3858, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.718248724937439
distance x is tensor(107.0030, device='cuda:1')
benign distance is  tensor(107.0030, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.470614194869995
distance x is tensor(135.6077, device='cuda:1')
benign distance is  tensor(135.6077, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  0., 27.,  8., 27., 23.,  0., 27., 26., 27.,  0., 27., 22., 25.,
         0., 22., 25.,  4.,  0., 16.,  1., 27., 27.,  0.,  0., 26.,  6., 27.])
count_res tensor([2.0795e-13, 2.0795e-13, 1.1064e-01, 6.1990e-10, 1.1064e-01, 2.0265e-03,
        2.0795e-13, 1.1064e-01, 4.0703e-02, 1.1064e-01, 2.0795e-13, 1.1064e-01,
        7.4549e-04, 1.4974e-02, 2.0795e-13, 7.4549e-04, 1.4974e-02, 1.1354e-11,
        2.0795e-13, 1.8479e-06, 5.6527e-13, 1.1064e-01, 1.1064e-01, 2.0795e-13,
        2.0795e-13, 4.0703e-02, 8.3894e-11, 1.1064e-01])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 82.36% 

Test Accuracy: 83.32% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7058166153728962
distance x is tensor(138.0801, device='cuda:1')
benign distance is  tensor(138.0801, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9951951391994953
distance x is tensor(108.4390, device='cuda:1')
benign distance is  tensor(108.4390, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0443567167967558
distance x is tensor(96.6104, device='cuda:1')
benign distance is  tensor(96.6104, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3340514078736305
distance x is tensor(144.2977, device='cuda:1')
benign distance is  tensor(144.2977, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0377192664891481
distance x is tensor(90.9700, device='cuda:1')
benign distance is  tensor(90.9700, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8689493639394641
distance x is tensor(100.2038, device='cuda:1')
benign distance is  tensor(100.2038, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5563309900462627
distance x is tensor(95.4982, device='cuda:1')
benign distance is  tensor(95.4982, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8778060600161552
distance x is tensor(83.0838, device='cuda:1')
benign distance is  tensor(83.0838, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1691242307424545
distance x is tensor(98.7263, device='cuda:1')
benign distance is  tensor(98.7263, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8918761154636741
distance x is tensor(117.3444, device='cuda:1')
benign distance is  tensor(117.3444, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2329353280365467
distance x is tensor(68.4296, device='cuda:1')
benign distance is  tensor(68.4296, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.66927620023489
distance x is tensor(112.0221, device='cuda:1')
benign distance is  tensor(112.0221, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0888518802821636
distance x is tensor(147.0416, device='cuda:1')
benign distance is  tensor(147.0416, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0059275012463331
distance x is tensor(65.3507, device='cuda:1')
benign distance is  tensor(65.3507, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9884742721915245
distance x is tensor(129.1505, device='cuda:1')
benign distance is  tensor(129.1505, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8370117098093033
distance x is tensor(113.3638, device='cuda:1')
benign distance is  tensor(113.3638, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.627291530370712
distance x is tensor(122.3794, device='cuda:1')
benign distance is  tensor(122.3794, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.228431612253189
distance x is tensor(150.7634, device='cuda:1')
benign distance is  tensor(150.7634, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.708712011575699
distance x is tensor(115.9024, device='cuda:1')
benign distance is  tensor(115.9024, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.85790303349495
distance x is tensor(108.1383, device='cuda:1')
benign distance is  tensor(108.1383, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.529046893119812
distance x is tensor(108.8604, device='cuda:1')
benign distance is  tensor(108.8604, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.268664240837097
distance x is tensor(133.0603, device='cuda:1')
benign distance is  tensor(133.0603, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.277127385139465
distance x is tensor(139.1805, device='cuda:1')
benign distance is  tensor(139.1805, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.123395800590515
distance x is tensor(115.6688, device='cuda:1')
benign distance is  tensor(115.6688, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.046659290790558
distance x is tensor(124.6194, device='cuda:1')
benign distance is  tensor(124.6194, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.863441199064255
distance x is tensor(121.4631, device='cuda:1')
benign distance is  tensor(121.4631, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.814767837524414
distance x is tensor(136.6750, device='cuda:1')
benign distance is  tensor(136.6750, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.719490200281143
distance x is tensor(156.1629, device='cuda:1')
benign distance is  tensor(156.1629, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0.,  0., 25.,  0., 12., 10., 27.,  4., 27., 27., 27.,  4., 17., 21.,
        25., 26.,  0., 18., 26., 27.,  0.,  0., 26., 18., 26.,  0., 27.,  0.])
count_res tensor([2.4268e-13, 2.4268e-13, 1.7474e-02, 2.4268e-13, 3.9497e-08, 5.3453e-09,
        1.2912e-01, 1.3250e-11, 1.2912e-01, 1.2912e-01, 1.2912e-01, 1.3250e-11,
        5.8619e-06, 3.2005e-04, 1.7474e-02, 4.7499e-02, 2.4268e-13, 1.5934e-05,
        4.7499e-02, 1.2912e-01, 2.4268e-13, 2.4268e-13, 4.7499e-02, 1.5934e-05,
        4.7499e-02, 2.4268e-13, 1.2912e-01, 2.4268e-13])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 68.22% 

Test Accuracy: 24.75% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.715753685683012
distance x is tensor(136.8225, device='cuda:1')
benign distance is  tensor(136.8225, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1225516609847546
distance x is tensor(124.8163, device='cuda:1')
benign distance is  tensor(124.8163, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9872984793037176
distance x is tensor(113.0037, device='cuda:1')
benign distance is  tensor(113.0037, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2174649015069008
distance x is tensor(154.2433, device='cuda:1')
benign distance is  tensor(154.2433, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1708810776472092
distance x is tensor(109.9959, device='cuda:1')
benign distance is  tensor(109.9959, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8210618868470192
distance x is tensor(122.7793, device='cuda:1')
benign distance is  tensor(122.7793, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6389404349029064
distance x is tensor(117.0662, device='cuda:1')
benign distance is  tensor(117.0662, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8870583437383175
distance x is tensor(104.3778, device='cuda:1')
benign distance is  tensor(104.3778, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.852116921916604
distance x is tensor(152.7459, device='cuda:1')
benign distance is  tensor(152.7459, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.2961152829229832
distance x is tensor(112.0140, device='cuda:1')
benign distance is  tensor(112.0140, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7170976791530848
distance x is tensor(159.9402, device='cuda:1')
benign distance is  tensor(159.9402, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.5724880322813988
distance x is tensor(141.8079, device='cuda:1')
benign distance is  tensor(141.8079, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7837754152715206
distance x is tensor(129.2551, device='cuda:1')
benign distance is  tensor(129.2551, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0439029019325972
distance x is tensor(106.6884, device='cuda:1')
benign distance is  tensor(106.6884, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0120433382689953
distance x is tensor(112.3684, device='cuda:1')
benign distance is  tensor(112.3684, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.901433939114213
distance x is tensor(166.0830, device='cuda:1')
benign distance is  tensor(166.0830, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.98208037018776
distance x is tensor(79.1761, device='cuda:1')
benign distance is  tensor(79.1761, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.041489332914352
distance x is tensor(123.6876, device='cuda:1')
benign distance is  tensor(123.6876, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.488519161939621
distance x is tensor(90.7992, device='cuda:1')
benign distance is  tensor(90.7992, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.329452872276306
distance x is tensor(89.2492, device='cuda:1')
benign distance is  tensor(89.2492, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.117508411407471
distance x is tensor(92.9156, device='cuda:1')
benign distance is  tensor(92.9156, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.5486922562122345
distance x is tensor(109.9900, device='cuda:1')
benign distance is  tensor(109.9900, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  7.80670103430748
distance x is tensor(128.3690, device='cuda:1')
benign distance is  tensor(128.3690, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  6.6094896495342255
distance x is tensor(95.9072, device='cuda:1')
benign distance is  tensor(95.9072, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.538454055786133
distance x is tensor(114.4432, device='cuda:1')
benign distance is  tensor(114.4432, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.77346158027649
distance x is tensor(108.4979, device='cuda:1')
benign distance is  tensor(108.4979, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.835265398025513
distance x is tensor(118.8070, device='cuda:1')
benign distance is  tensor(118.8070, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.6315803825855255
distance x is tensor(139.2234, device='cuda:1')
benign distance is  tensor(139.2234, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([51.,  0., 44.,  0., 48.,  0.,  0., 51., 50., 41., 50.,  0., 49., 48.,
         0., 47.,  0., 51., 50., 48., 50., 51.,  0., 51., 16., 51., 49.,  0.,
         0., 51., 22.,  0.,  0., 14.,  0., 44.,  2., 49., 50., 50.,  0., 51.,
        51., 38.,  0.,  0.,  0., 35.,  0.,  0., 51.,  0.])
count_res tensor([7.8230e-02, 5.5508e-24, 7.1336e-05, 5.5508e-24, 3.8948e-03, 5.5508e-24,
        5.5508e-24, 7.8230e-02, 2.8779e-02, 3.5516e-06, 2.8779e-02, 5.5508e-24,
        1.0587e-02, 3.8948e-03, 5.5508e-24, 1.4328e-03, 5.5508e-24, 7.8230e-02,
        2.8779e-02, 3.8948e-03, 2.8779e-02, 7.8230e-02, 5.5508e-24, 7.8230e-02,
        4.9325e-17, 7.8230e-02, 1.0587e-02, 5.5508e-24, 5.5508e-24, 7.8230e-02,
        1.9899e-14, 5.5508e-24, 5.5508e-24, 6.6754e-18, 5.5508e-24, 7.1336e-05,
        4.1015e-23, 1.0587e-02, 2.8779e-02, 2.8779e-02, 5.5508e-24, 7.8230e-02,
        7.8230e-02, 1.7683e-07, 5.5508e-24, 5.5508e-24, 5.5508e-24, 8.8036e-09,
        5.5508e-24, 5.5508e-24, 7.8230e-02, 5.5508e-24])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 83.57% 

Test Accuracy: 86.34% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.649677587673068
distance x is tensor(121.1843, device='cuda:1')
benign distance is  tensor(121.1843, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9840752705931664
distance x is tensor(103.4942, device='cuda:1')
benign distance is  tensor(103.4942, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.054616529494524
distance x is tensor(90.7179, device='cuda:1')
benign distance is  tensor(90.7179, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1841303706169128
distance x is tensor(138.0067, device='cuda:1')
benign distance is  tensor(138.0067, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.054756224155426
distance x is tensor(91.9098, device='cuda:1')
benign distance is  tensor(91.9098, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7073007803410292
distance x is tensor(98.9523, device='cuda:1')
benign distance is  tensor(98.9523, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.313468661159277
distance x is tensor(90.0649, device='cuda:1')
benign distance is  tensor(90.0649, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.844324086792767
distance x is tensor(73.4761, device='cuda:1')
benign distance is  tensor(73.4761, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3419335819780827
distance x is tensor(96.1316, device='cuda:1')
benign distance is  tensor(96.1316, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7242313316091895
distance x is tensor(108.9702, device='cuda:1')
benign distance is  tensor(108.9702, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1859852522611618
distance x is tensor(65.6077, device='cuda:1')
benign distance is  tensor(65.6077, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.8501486591994762
distance x is tensor(107.6665, device='cuda:1')
benign distance is  tensor(107.6665, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0904785990715027
distance x is tensor(148.8971, device='cuda:1')
benign distance is  tensor(148.8971, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8299484755843878
distance x is tensor(59.5790, device='cuda:1')
benign distance is  tensor(59.5790, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9408060107380152
distance x is tensor(140.3581, device='cuda:1')
benign distance is  tensor(140.3581, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7463857047259808
distance x is tensor(104.5360, device='cuda:1')
benign distance is  tensor(104.5360, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2015731669962406
distance x is tensor(90.5381, device='cuda:1')
benign distance is  tensor(90.5381, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8909671902656555
distance x is tensor(105.2592, device='cuda:1')
benign distance is  tensor(105.2592, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.195674754679203
distance x is tensor(109.9246, device='cuda:1')
benign distance is  tensor(109.9246, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9466236978769302
distance x is tensor(105.7993, device='cuda:1')
benign distance is  tensor(105.7993, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.224368143826723
distance x is tensor(75.0255, device='cuda:1')
benign distance is  tensor(75.0255, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7736190687865019
distance x is tensor(198.5708, device='cuda:1')
benign distance is  tensor(198.5708, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.445064902305603
distance x is tensor(126.6398, device='cuda:1')
benign distance is  tensor(126.6398, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.122808875516057
distance x is tensor(96.7628, device='cuda:1')
benign distance is  tensor(96.7628, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.217474153265357
distance x is tensor(115.4567, device='cuda:1')
benign distance is  tensor(115.4567, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0657163001596928
distance x is tensor(81.7573, device='cuda:1')
benign distance is  tensor(81.7573, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2278615962713957
distance x is tensor(117.6366, device='cuda:1')
benign distance is  tensor(117.6366, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.360739529132843
distance x is tensor(110.4576, device='cuda:1')
benign distance is  tensor(110.4576, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8035387936979532
distance x is tensor(103.2320, device='cuda:1')
benign distance is  tensor(103.2320, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9266201425343752
distance x is tensor(99.3528, device='cuda:1')
benign distance is  tensor(99.3528, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6206335425376892
distance x is tensor(116.4939, device='cuda:1')
benign distance is  tensor(116.4939, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.87116296030581
distance x is tensor(172.8356, device='cuda:1')
benign distance is  tensor(172.8356, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1487838104367256
distance x is tensor(98.7374, device='cuda:1')
benign distance is  tensor(98.7374, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.4638157710433006
distance x is tensor(138.8365, device='cuda:1')
benign distance is  tensor(138.8365, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.3385220356285572
distance x is tensor(146.8706, device='cuda:1')
benign distance is  tensor(146.8706, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.018263764679432
distance x is tensor(84.9830, device='cuda:1')
benign distance is  tensor(84.9830, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.716725206002593
distance x is tensor(146.9933, device='cuda:1')
benign distance is  tensor(146.9933, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1281926780939102
distance x is tensor(130.8026, device='cuda:1')
benign distance is  tensor(130.8026, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0904927738010883
distance x is tensor(97.9066, device='cuda:1')
benign distance is  tensor(97.9066, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5237939544022083
distance x is tensor(123.2949, device='cuda:1')
benign distance is  tensor(123.2949, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.766710251569748
distance x is tensor(133.8450, device='cuda:1')
benign distance is  tensor(133.8450, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.2928526699543
distance x is tensor(157.7477, device='cuda:1')
benign distance is  tensor(157.7477, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.100772678852081
distance x is tensor(134.4913, device='cuda:1')
benign distance is  tensor(134.4913, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.955059677362442
distance x is tensor(127.2353, device='cuda:1')
benign distance is  tensor(127.2353, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.454037666320801
distance x is tensor(117.5424, device='cuda:1')
benign distance is  tensor(117.5424, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.718792021274567
distance x is tensor(141.0021, device='cuda:1')
benign distance is  tensor(141.0021, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  7.787759184837341
distance x is tensor(143.0384, device='cuda:1')
benign distance is  tensor(143.0384, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.942085444927216
distance x is tensor(126.0494, device='cuda:1')
benign distance is  tensor(126.0494, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.242058426141739
distance x is tensor(147.3014, device='cuda:1')
benign distance is  tensor(147.3014, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.800696730613708
distance x is tensor(129.6096, device='cuda:1')
benign distance is  tensor(129.6096, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.667907744646072
distance x is tensor(140.6145, device='cuda:1')
benign distance is  tensor(140.6145, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.135727792978287
distance x is tensor(158.7084, device='cuda:1')
benign distance is  tensor(158.7084, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([11.,  0.,  2.,  0., 15.,  6.,  0., 15., 18., 19., 18., 18.,  8., 17.,
        19., 17., 15.,  1., 19.,  2.])
count_res tensor([7.5732e-05, 1.2649e-09, 9.3461e-09, 1.2649e-09, 4.1348e-03, 5.1028e-07,
        1.2649e-09, 4.1348e-03, 8.3050e-02, 2.2575e-01, 8.3050e-02, 8.3050e-02,
        3.7705e-06, 3.0552e-02, 2.2575e-01, 3.0552e-02, 4.1348e-03, 3.4382e-09,
        2.2575e-01, 9.3461e-09])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 45.43% 

Test Accuracy: 12.51% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9102730229496956
distance x is tensor(170.2871, device='cuda:1')
benign distance is  tensor(170.2871, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4616237692534924
distance x is tensor(151.0791, device='cuda:1')
benign distance is  tensor(151.0791, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6556697487831116
distance x is tensor(148.0690, device='cuda:1')
benign distance is  tensor(148.0690, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2315692603588104
distance x is tensor(186.9455, device='cuda:1')
benign distance is  tensor(186.9455, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2729088496416807
distance x is tensor(149.8631, device='cuda:1')
benign distance is  tensor(149.8631, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9521313682198524
distance x is tensor(166.5393, device='cuda:1')
benign distance is  tensor(166.5393, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3641929104924202
distance x is tensor(163.8962, device='cuda:1')
benign distance is  tensor(163.8962, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2292801775038242
distance x is tensor(141.1617, device='cuda:1')
benign distance is  tensor(141.1617, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.544488698244095
distance x is tensor(77.3191, device='cuda:1')
benign distance is  tensor(77.3191, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.246242433786392
distance x is tensor(122.6038, device='cuda:1')
benign distance is  tensor(122.6038, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.207551032304764
distance x is tensor(86.2353, device='cuda:1')
benign distance is  tensor(86.2353, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.662074446678162
distance x is tensor(81.0161, device='cuda:1')
benign distance is  tensor(81.0161, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.730314999818802
distance x is tensor(80.7886, device='cuda:1')
benign distance is  tensor(80.7886, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.04919981956482
distance x is tensor(101.6734, device='cuda:1')
benign distance is  tensor(101.6734, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  7.861317664384842
distance x is tensor(113.9224, device='cuda:1')
benign distance is  tensor(113.9224, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.939429968595505
distance x is tensor(92.0760, device='cuda:1')
benign distance is  tensor(92.0760, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.706918001174927
distance x is tensor(109.3892, device='cuda:1')
benign distance is  tensor(109.3892, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.215990424156189
distance x is tensor(102.9734, device='cuda:1')
benign distance is  tensor(102.9734, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.022004008293152
distance x is tensor(98.0616, device='cuda:1')
benign distance is  tensor(98.0616, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.38945722579956
distance x is tensor(142.0074, device='cuda:1')
benign distance is  tensor(142.0074, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 3.,  1., 23., 26., 27.,  0.,  7., 27., 27., 23.,  0., 26., 22.,  0.,
         6., 17.,  0., 27., 27., 17.,  0., 22., 26., 27.,  0., 24., 15.,  0.])
count_res tensor([5.2406e-12, 7.0924e-13, 2.5426e-03, 5.1069e-02, 1.3882e-01, 2.6091e-13,
        2.8613e-10, 1.3882e-01, 1.3882e-01, 2.5426e-03, 2.6091e-13, 5.1069e-02,
        9.3535e-04, 2.6091e-13, 1.0526e-10, 6.3024e-06, 2.6091e-13, 1.3882e-01,
        1.3882e-01, 6.3024e-06, 2.6091e-13, 9.3535e-04, 5.1069e-02, 1.3882e-01,
        2.6091e-13, 6.9114e-03, 8.5293e-07, 2.6091e-13])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 74.21% 

Test Accuracy: 51.00% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6279956270009279
distance x is tensor(138.0331, device='cuda:1')
benign distance is  tensor(138.0331, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2779973596334457
distance x is tensor(112.7819, device='cuda:1')
benign distance is  tensor(112.7819, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.164177168160677
distance x is tensor(106.5885, device='cuda:1')
benign distance is  tensor(106.5885, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1997637823224068
distance x is tensor(154.3180, device='cuda:1')
benign distance is  tensor(154.3180, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2848263271152973
distance x is tensor(94.6690, device='cuda:1')
benign distance is  tensor(94.6690, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8954797443002462
distance x is tensor(111.3780, device='cuda:1')
benign distance is  tensor(111.3780, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.274189107120037
distance x is tensor(106.0056, device='cuda:1')
benign distance is  tensor(106.0056, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.926332326605916
distance x is tensor(90.1122, device='cuda:1')
benign distance is  tensor(90.1122, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3201232179999352
distance x is tensor(106.6304, device='cuda:1')
benign distance is  tensor(106.6304, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8076282162219286
distance x is tensor(137.1995, device='cuda:1')
benign distance is  tensor(137.1995, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1853938475251198
distance x is tensor(81.8009, device='cuda:1')
benign distance is  tensor(81.8009, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5893321633338928
distance x is tensor(116.3252, device='cuda:1')
benign distance is  tensor(116.3252, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1584828309714794
distance x is tensor(154.5352, device='cuda:1')
benign distance is  tensor(154.5352, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9356625135987997
distance x is tensor(77.7357, device='cuda:1')
benign distance is  tensor(77.7357, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1275082752108574
distance x is tensor(157.4391, device='cuda:1')
benign distance is  tensor(157.4391, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5090172477066517
distance x is tensor(116.8638, device='cuda:1')
benign distance is  tensor(116.8638, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.428973257541656
distance x is tensor(86.6306, device='cuda:1')
benign distance is  tensor(86.6306, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.775300741195679
distance x is tensor(132.4214, device='cuda:1')
benign distance is  tensor(132.4214, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.641240417957306
distance x is tensor(103.2230, device='cuda:1')
benign distance is  tensor(103.2230, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.296104222536087
distance x is tensor(96.2990, device='cuda:1')
benign distance is  tensor(96.2990, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.924904942512512
distance x is tensor(98.2080, device='cuda:1')
benign distance is  tensor(98.2080, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.7187100648880005
distance x is tensor(111.7678, device='cuda:1')
benign distance is  tensor(111.7678, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.517585694789886
distance x is tensor(130.7400, device='cuda:1')
benign distance is  tensor(130.7400, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.955489367246628
distance x is tensor(105.3280, device='cuda:1')
benign distance is  tensor(105.3280, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.002537876367569
distance x is tensor(118.2290, device='cuda:1')
benign distance is  tensor(118.2290, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.98045328259468
distance x is tensor(95.4419, device='cuda:1')
benign distance is  tensor(95.4419, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.6311459839344025
distance x is tensor(105.2934, device='cuda:1')
benign distance is  tensor(105.2934, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.553782999515533
distance x is tensor(140.4040, device='cuda:1')
benign distance is  tensor(140.4040, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([26.,  2., 27.,  0.,  0., 27.,  0., 17., 27., 24.,  1., 27., 18., 26.,
         0.,  4., 26., 27., 27., 27.,  6., 27., 27., 27.,  0.,  0.,  0.,  0.])
count_res tensor([3.2983e-02, 1.2452e-12, 8.9657e-02, 1.6851e-13, 1.6851e-13, 8.9657e-02,
        1.6851e-13, 4.0704e-06, 8.9657e-02, 4.4638e-03, 4.5807e-13, 8.9657e-02,
        1.1065e-05, 3.2983e-02, 1.6851e-13, 9.2005e-12, 3.2983e-02, 8.9657e-02,
        8.9657e-02, 8.9657e-02, 6.7983e-11, 8.9657e-02, 8.9657e-02, 8.9657e-02,
        1.6851e-13, 1.6851e-13, 1.6851e-13, 1.6851e-13])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 67.48% 

Test Accuracy: 33.98% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.84508350584656
distance x is tensor(139.2825, device='cuda:1')
benign distance is  tensor(139.2825, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.324119072407484
distance x is tensor(111.5406, device='cuda:1')
benign distance is  tensor(111.5406, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3183914721012115
distance x is tensor(112.2039, device='cuda:1')
benign distance is  tensor(112.2039, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9941713679581881
distance x is tensor(158.6356, device='cuda:1')
benign distance is  tensor(158.6356, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0517327226698399
distance x is tensor(101.8706, device='cuda:1')
benign distance is  tensor(101.8706, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9182353736832738
distance x is tensor(113.7664, device='cuda:1')
benign distance is  tensor(113.7664, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6762745007872581
distance x is tensor(112.3339, device='cuda:1')
benign distance is  tensor(112.3339, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.098420575261116
distance x is tensor(96.9137, device='cuda:1')
benign distance is  tensor(96.9137, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3582417368888855
distance x is tensor(102.4501, device='cuda:1')
benign distance is  tensor(102.4501, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9250834248960018
distance x is tensor(112.7397, device='cuda:1')
benign distance is  tensor(112.7397, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2274583913385868
distance x is tensor(121.6024, device='cuda:1')
benign distance is  tensor(121.6024, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1726767923682928
distance x is tensor(124.3802, device='cuda:1')
benign distance is  tensor(124.3802, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.327129179611802
distance x is tensor(91.0993, device='cuda:1')
benign distance is  tensor(91.0993, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.857864098623395
distance x is tensor(212.1019, device='cuda:1')
benign distance is  tensor(212.1019, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2785636186599731
distance x is tensor(145.0820, device='cuda:1')
benign distance is  tensor(145.0820, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8444119151681662
distance x is tensor(133.6780, device='cuda:1')
benign distance is  tensor(133.6780, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.179901391267776
distance x is tensor(84.7759, device='cuda:1')
benign distance is  tensor(84.7759, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.330942869186401
distance x is tensor(135.7969, device='cuda:1')
benign distance is  tensor(135.7969, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.926037400960922
distance x is tensor(103.9772, device='cuda:1')
benign distance is  tensor(103.9772, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.59280014038086
distance x is tensor(90.0630, device='cuda:1')
benign distance is  tensor(90.0630, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.435582220554352
distance x is tensor(102.0959, device='cuda:1')
benign distance is  tensor(102.0959, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.677898198366165
distance x is tensor(119.9031, device='cuda:1')
benign distance is  tensor(119.9031, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.39871409535408
distance x is tensor(120.8974, device='cuda:1')
benign distance is  tensor(120.8974, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.125428080558777
distance x is tensor(98.7935, device='cuda:1')
benign distance is  tensor(98.7935, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.22031182050705
distance x is tensor(120.6660, device='cuda:1')
benign distance is  tensor(120.6660, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.879996657371521
distance x is tensor(89.1518, device='cuda:1')
benign distance is  tensor(89.1518, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.479184210300446
distance x is tensor(108.7812, device='cuda:1')
benign distance is  tensor(108.7812, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.729114770889282
distance x is tensor(148.3936, device='cuda:1')
benign distance is  tensor(148.3936, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([ 0., 43., 41., 43.,  0.,  0.,  0., 43., 41.,  1., 41.,  5.,  0., 14.,
        42.,  0., 43., 40.,  0., 43., 41.,  6., 42., 41., 42.,  0., 38., 43.,
         2.,  0., 39.,  0., 42., 43., 42., 25.,  0.,  0.,  0., 40.,  0., 43.,
         0., 43.])
count_res tensor([1.8170e-20, 8.5905e-02, 1.1626e-02, 8.5905e-02, 1.8170e-20, 1.8170e-20,
        1.8170e-20, 8.5905e-02, 1.1626e-02, 4.9392e-20, 1.1626e-02, 2.6967e-18,
        1.8170e-20, 2.1851e-14, 3.1603e-02, 1.8170e-20, 8.5905e-02, 4.2770e-03,
        1.8170e-20, 8.5905e-02, 1.1626e-02, 7.3304e-18, 3.1603e-02, 1.1626e-02,
        3.1603e-02, 1.8170e-20, 5.7883e-04, 8.5905e-02, 1.3426e-19, 1.8170e-20,
        1.5734e-03, 1.8170e-20, 3.1603e-02, 8.5905e-02, 3.1603e-02, 1.3083e-09,
        1.8170e-20, 1.8170e-20, 1.8170e-20, 4.2770e-03, 1.8170e-20, 8.5905e-02,
        1.8170e-20, 8.5905e-02])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 87.97% 

Test Accuracy: 87.25% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7475622203201056
distance x is tensor(115.2467, device='cuda:1')
benign distance is  tensor(115.2467, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0278076864778996
distance x is tensor(94.3497, device='cuda:1')
benign distance is  tensor(94.3497, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8068348672240973
distance x is tensor(102.8288, device='cuda:1')
benign distance is  tensor(102.8288, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0779534932225943
distance x is tensor(143.3867, device='cuda:1')
benign distance is  tensor(143.3867, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9226313820108771
distance x is tensor(77.4559, device='cuda:1')
benign distance is  tensor(77.4559, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6764995949342847
distance x is tensor(91.5124, device='cuda:1')
benign distance is  tensor(91.5124, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2789113894104958
distance x is tensor(97.5081, device='cuda:1')
benign distance is  tensor(97.5081, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8277796879410744
distance x is tensor(70.7567, device='cuda:1')
benign distance is  tensor(70.7567, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1148857027292252
distance x is tensor(104.9892, device='cuda:1')
benign distance is  tensor(104.9892, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7112979078665376
distance x is tensor(122.7979, device='cuda:1')
benign distance is  tensor(122.7979, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2252178266644478
distance x is tensor(69.2201, device='cuda:1')
benign distance is  tensor(69.2201, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.604368593543768
distance x is tensor(109.3388, device='cuda:1')
benign distance is  tensor(109.3388, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8325755745172501
distance x is tensor(154.6568, device='cuda:1')
benign distance is  tensor(154.6568, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7474966207519174
distance x is tensor(58.2539, device='cuda:1')
benign distance is  tensor(58.2539, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1273819310590625
distance x is tensor(126.1400, device='cuda:1')
benign distance is  tensor(126.1400, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6528984755277634
distance x is tensor(114.2869, device='cuda:1')
benign distance is  tensor(114.2869, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.3703975528478622
distance x is tensor(119.1056, device='cuda:1')
benign distance is  tensor(119.1056, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7605476304888725
distance x is tensor(99.3515, device='cuda:1')
benign distance is  tensor(99.3515, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1101596765220165
distance x is tensor(118.4781, device='cuda:1')
benign distance is  tensor(118.4781, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.36191913112998
distance x is tensor(121.5139, device='cuda:1')
benign distance is  tensor(121.5139, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9693947546184063
distance x is tensor(121.6223, device='cuda:1')
benign distance is  tensor(121.6223, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9042936097830534
distance x is tensor(94.5001, device='cuda:1')
benign distance is  tensor(94.5001, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6281935190781951
distance x is tensor(125.4857, device='cuda:1')
benign distance is  tensor(125.4857, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.725765623152256
distance x is tensor(163.2040, device='cuda:1')
benign distance is  tensor(163.2040, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7405565194785595
distance x is tensor(127.4481, device='cuda:1')
benign distance is  tensor(127.4481, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1916771903634071
distance x is tensor(91.4965, device='cuda:1')
benign distance is  tensor(91.4965, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7902040742337704
distance x is tensor(145.3981, device='cuda:1')
benign distance is  tensor(145.3981, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3868591785430908
distance x is tensor(127.3351, device='cuda:1')
benign distance is  tensor(127.3351, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6644302811473608
distance x is tensor(127.1019, device='cuda:1')
benign distance is  tensor(127.1019, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.987446578219533
distance x is tensor(91.6006, device='cuda:1')
benign distance is  tensor(91.6006, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8825662545859814
distance x is tensor(91.8860, device='cuda:1')
benign distance is  tensor(91.8860, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9178889989852905
distance x is tensor(112.8503, device='cuda:1')
benign distance is  tensor(112.8503, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.446656435728073
distance x is tensor(125.0505, device='cuda:1')
benign distance is  tensor(125.0505, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.189447313547134
distance x is tensor(149.7804, device='cuda:1')
benign distance is  tensor(149.7804, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.744892567396164
distance x is tensor(126.0843, device='cuda:1')
benign distance is  tensor(126.0843, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.568173825740814
distance x is tensor(132.8958, device='cuda:1')
benign distance is  tensor(132.8958, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.042283922433853
distance x is tensor(128.9914, device='cuda:1')
benign distance is  tensor(128.9914, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.4661771059036255
distance x is tensor(142.6287, device='cuda:1')
benign distance is  tensor(142.6287, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.14477989077568
distance x is tensor(149.3045, device='cuda:1')
benign distance is  tensor(149.3045, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.048645079135895
distance x is tensor(129.0686, device='cuda:1')
benign distance is  tensor(129.0686, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.817624032497406
distance x is tensor(143.2123, device='cuda:1')
benign distance is  tensor(143.2123, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.302033364772797
distance x is tensor(122.4865, device='cuda:1')
benign distance is  tensor(122.4865, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.019083738327026
distance x is tensor(136.1675, device='cuda:1')
benign distance is  tensor(136.1675, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.760006546974182
distance x is tensor(151.8235, device='cuda:1')
benign distance is  tensor(151.8235, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0., 16., 19.,  2., 18.,  0.,  0., 19., 19., 19.,  1.,  0., 19.,  0.,
        13., 19., 19., 18.,  2., 17.])
count_res tensor([7.0712e-10, 6.2836e-03, 1.2621e-01, 5.2250e-09, 4.6430e-02, 7.0712e-10,
        7.0712e-10, 1.2621e-01, 1.2621e-01, 1.2621e-01, 1.9222e-09, 7.0712e-10,
        1.2621e-01, 7.0712e-10, 3.1284e-04, 1.2621e-01, 1.2621e-01, 4.6430e-02,
        5.2250e-09, 1.7081e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 68.57% 

Test Accuracy: 22.25% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7094723898917437
distance x is tensor(149.2784, device='cuda:1')
benign distance is  tensor(149.2784, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9894276969134808
distance x is tensor(133.0101, device='cuda:1')
benign distance is  tensor(133.0101, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0093202106654644
distance x is tensor(133.3781, device='cuda:1')
benign distance is  tensor(133.3781, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2157310955226421
distance x is tensor(166.3611, device='cuda:1')
benign distance is  tensor(166.3611, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1622405555099249
distance x is tensor(121.1542, device='cuda:1')
benign distance is  tensor(121.1542, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9646015828475356
distance x is tensor(133.7095, device='cuda:1')
benign distance is  tensor(133.7095, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3084058836102486
distance x is tensor(129.7666, device='cuda:1')
benign distance is  tensor(129.7666, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8505028784275055
distance x is tensor(112.4261, device='cuda:1')
benign distance is  tensor(112.4261, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.216215252876282
distance x is tensor(74.6615, device='cuda:1')
benign distance is  tensor(74.6615, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.577028274536133
distance x is tensor(123.8960, device='cuda:1')
benign distance is  tensor(123.8960, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.68431705236435
distance x is tensor(82.3830, device='cuda:1')
benign distance is  tensor(82.3830, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.549757421016693
distance x is tensor(96.2112, device='cuda:1')
benign distance is  tensor(96.2112, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.101046025753021
distance x is tensor(86.9603, device='cuda:1')
benign distance is  tensor(86.9603, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.563846379518509
distance x is tensor(105.1020, device='cuda:1')
benign distance is  tensor(105.1020, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.425828844308853
distance x is tensor(122.5185, device='cuda:1')
benign distance is  tensor(122.5185, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.965565502643585
distance x is tensor(97.5833, device='cuda:1')
benign distance is  tensor(97.5833, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.750772774219513
distance x is tensor(106.0163, device='cuda:1')
benign distance is  tensor(106.0163, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.401064336299896
distance x is tensor(95.6333, device='cuda:1')
benign distance is  tensor(95.6333, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.820828437805176
distance x is tensor(113.1124, device='cuda:1')
benign distance is  tensor(113.1124, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.215670049190521
distance x is tensor(157.3266, device='cuda:1')
benign distance is  tensor(157.3266, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([43.,  4.,  0.,  0.,  0., 14., 42., 43., 42., 43., 43.,  0., 40., 40.,
         0.,  3., 42., 43.,  1., 43.,  3., 41.,  0., 43., 43., 41., 43.,  0.,
        42.,  0., 43., 43.,  0., 43.,  0.,  0.,  0.,  0., 42., 43., 14., 42.,
         0.,  0.])
count_res tensor([6.4195e-02, 7.4134e-19, 1.3578e-20, 1.3578e-20, 1.3578e-20, 1.6329e-14,
        2.3616e-02, 6.4195e-02, 2.3616e-02, 6.4195e-02, 6.4195e-02, 1.3578e-20,
        3.1961e-03, 3.1961e-03, 1.3578e-20, 2.7272e-19, 2.3616e-02, 6.4195e-02,
        3.6909e-20, 6.4195e-02, 2.7272e-19, 8.6879e-03, 1.3578e-20, 6.4195e-02,
        6.4195e-02, 8.6879e-03, 6.4195e-02, 1.3578e-20, 2.3616e-02, 1.3578e-20,
        6.4195e-02, 6.4195e-02, 1.3578e-20, 6.4195e-02, 1.3578e-20, 1.3578e-20,
        1.3578e-20, 1.3578e-20, 2.3616e-02, 6.4195e-02, 1.6329e-14, 2.3616e-02,
        1.3578e-20, 1.3578e-20])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 86.05% 

Test Accuracy: 85.94% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.689708711579442
distance x is tensor(130.3039, device='cuda:1')
benign distance is  tensor(130.3039, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8453162908554077
distance x is tensor(106.7368, device='cuda:1')
benign distance is  tensor(106.7368, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9987471252679825
distance x is tensor(89.1944, device='cuda:1')
benign distance is  tensor(89.1944, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1219449378550053
distance x is tensor(141.6979, device='cuda:1')
benign distance is  tensor(141.6979, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.987163383513689
distance x is tensor(76.2641, device='cuda:1')
benign distance is  tensor(76.2641, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8712883675470948
distance x is tensor(93.6547, device='cuda:1')
benign distance is  tensor(93.6547, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3942112028598785
distance x is tensor(96.7412, device='cuda:1')
benign distance is  tensor(96.7412, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.737496773712337
distance x is tensor(75.9752, device='cuda:1')
benign distance is  tensor(75.9752, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.098836187273264
distance x is tensor(106.5261, device='cuda:1')
benign distance is  tensor(106.5261, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7494861707091331
distance x is tensor(115.5175, device='cuda:1')
benign distance is  tensor(115.5175, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4417257606983185
distance x is tensor(76.4977, device='cuda:1')
benign distance is  tensor(76.4977, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5662643983960152
distance x is tensor(105.3615, device='cuda:1')
benign distance is  tensor(105.3615, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1786784119904041
distance x is tensor(156.7032, device='cuda:1')
benign distance is  tensor(156.7032, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7710642572492361
distance x is tensor(61.9712, device='cuda:1')
benign distance is  tensor(61.9712, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.185096139088273
distance x is tensor(130.6114, device='cuda:1')
benign distance is  tensor(130.6114, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6384918801486492
distance x is tensor(114.3235, device='cuda:1')
benign distance is  tensor(114.3235, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2375946156680584
distance x is tensor(96.1042, device='cuda:1')
benign distance is  tensor(96.1042, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9224558770656586
distance x is tensor(111.3755, device='cuda:1')
benign distance is  tensor(111.3755, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9730869419872761
distance x is tensor(115.3220, device='cuda:1')
benign distance is  tensor(115.3220, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.294628158211708
distance x is tensor(117.0127, device='cuda:1')
benign distance is  tensor(117.0127, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0808178503066301
distance x is tensor(71.1145, device='cuda:1')
benign distance is  tensor(71.1145, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7232831139117479
distance x is tensor(199.0302, device='cuda:1')
benign distance is  tensor(199.0302, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5688148327171803
distance x is tensor(147.6780, device='cuda:1')
benign distance is  tensor(147.6780, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8878935426473618
distance x is tensor(109.4664, device='cuda:1')
benign distance is  tensor(109.4664, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1016313433647156
distance x is tensor(107.8865, device='cuda:1')
benign distance is  tensor(107.8865, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2763841189444065
distance x is tensor(132.8271, device='cuda:1')
benign distance is  tensor(132.8271, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.7408857643604279
distance x is tensor(152.9443, device='cuda:1')
benign distance is  tensor(152.9443, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.2215890809893608
distance x is tensor(86.7508, device='cuda:1')
benign distance is  tensor(86.7508, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6261147893965244
distance x is tensor(151.9252, device='cuda:1')
benign distance is  tensor(151.9252, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1098353490233421
distance x is tensor(130.2633, device='cuda:1')
benign distance is  tensor(130.2633, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0576946958899498
distance x is tensor(98.6935, device='cuda:1')
benign distance is  tensor(98.6935, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6279120952822268
distance x is tensor(134.3299, device='cuda:1')
benign distance is  tensor(134.3299, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.545442759990692
distance x is tensor(106.8075, device='cuda:1')
benign distance is  tensor(106.8075, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.346759557723999
distance x is tensor(141.9648, device='cuda:1')
benign distance is  tensor(141.9648, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.324033200740814
distance x is tensor(120.1876, device='cuda:1')
benign distance is  tensor(120.1876, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.815972745418549
distance x is tensor(117.4672, device='cuda:1')
benign distance is  tensor(117.4672, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.481038451194763
distance x is tensor(115.3939, device='cuda:1')
benign distance is  tensor(115.3939, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.460014522075653
distance x is tensor(138.4385, device='cuda:1')
benign distance is  tensor(138.4385, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.210202127695084
distance x is tensor(149.8702, device='cuda:1')
benign distance is  tensor(149.8702, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.5017872750759125
distance x is tensor(120.1430, device='cuda:1')
benign distance is  tensor(120.1430, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.228800565004349
distance x is tensor(130.9013, device='cuda:1')
benign distance is  tensor(130.9013, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.493068099021912
distance x is tensor(109.7188, device='cuda:1')
benign distance is  tensor(109.7188, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.393918216228485
distance x is tensor(129.0983, device='cuda:1')
benign distance is  tensor(129.0983, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.0140680372715
distance x is tensor(150.1768, device='cuda:1')
benign distance is  tensor(150.1768, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0.,  0., 16.,  2.,  0.,  0.,  0., 19., 19.,  0., 12.,  0., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([5.5745e-10, 5.5745e-10, 4.9536e-03, 4.1191e-09, 5.5745e-10, 5.5745e-10,
        5.5745e-10, 9.9496e-02, 9.9496e-02, 5.5745e-10, 9.0728e-05, 5.5745e-10,
        9.9496e-02, 9.9496e-02, 9.9496e-02, 9.9496e-02, 9.9496e-02, 9.9496e-02,
        9.9496e-02, 9.9496e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 51.05% 

Test Accuracy: 13.80% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.673968467861414
distance x is tensor(157.2694, device='cuda:1')
benign distance is  tensor(157.2694, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9326955638825893
distance x is tensor(143.8009, device='cuda:1')
benign distance is  tensor(143.8009, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2333380617201328
distance x is tensor(143.6751, device='cuda:1')
benign distance is  tensor(143.6751, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4001251123845577
distance x is tensor(177.2439, device='cuda:1')
benign distance is  tensor(177.2439, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5483130067586899
distance x is tensor(155.2059, device='cuda:1')
benign distance is  tensor(155.2059, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8438360439613461
distance x is tensor(147.6351, device='cuda:1')
benign distance is  tensor(147.6351, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5779191106557846
distance x is tensor(152.0146, device='cuda:1')
benign distance is  tensor(152.0146, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0150022208690643
distance x is tensor(130.1360, device='cuda:1')
benign distance is  tensor(130.1360, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.550416976213455
distance x is tensor(76.2408, device='cuda:1')
benign distance is  tensor(76.2408, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.673267126083374
distance x is tensor(127.2642, device='cuda:1')
benign distance is  tensor(127.2642, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.394622802734375
distance x is tensor(95.2866, device='cuda:1')
benign distance is  tensor(95.2866, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.063901841640472
distance x is tensor(87.0158, device='cuda:1')
benign distance is  tensor(87.0158, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.789560765028
distance x is tensor(92.1836, device='cuda:1')
benign distance is  tensor(92.1836, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.672565758228302
distance x is tensor(108.9623, device='cuda:1')
benign distance is  tensor(108.9623, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.277932554483414
distance x is tensor(116.3604, device='cuda:1')
benign distance is  tensor(116.3604, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.368370056152344
distance x is tensor(85.1665, device='cuda:1')
benign distance is  tensor(85.1665, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.647185862064362
distance x is tensor(95.3617, device='cuda:1')
benign distance is  tensor(95.3617, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.903596580028534
distance x is tensor(81.2148, device='cuda:1')
benign distance is  tensor(81.2148, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.054402768611908
distance x is tensor(82.5846, device='cuda:1')
benign distance is  tensor(82.5846, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.176005959510803
distance x is tensor(140.6792, device='cuda:1')
benign distance is  tensor(140.6792, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([35., 22.,  0.,  0., 35.,  0., 12., 34.,  0., 34., 31., 35., 31., 35.,
         0.,  3., 33., 31., 30.,  0.,  5., 33.,  0., 35.,  0., 35., 35., 31.,
         0.,  0., 35., 35.,  0., 35.,  4.,  0.])
count_res tensor([9.0200e-02, 2.0388e-07, 5.6872e-17, 5.6872e-17, 9.0200e-02, 5.6872e-17,
        9.2562e-12, 3.3183e-02, 5.6872e-17, 3.3183e-02, 1.6521e-03, 9.0200e-02,
        1.6521e-03, 9.0200e-02, 5.6872e-17, 1.1423e-15, 1.2207e-02, 1.6521e-03,
        6.0777e-04, 5.6872e-17, 8.4406e-15, 1.2207e-02, 5.6872e-17, 9.0200e-02,
        5.6872e-17, 9.0200e-02, 9.0200e-02, 1.6521e-03, 5.6872e-17, 5.6872e-17,
        9.0200e-02, 9.0200e-02, 5.6872e-17, 9.0200e-02, 3.1051e-15, 5.6872e-17])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 87.93% 

Test Accuracy: 86.63% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9057785198092461
distance x is tensor(121.7765, device='cuda:1')
benign distance is  tensor(121.7765, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9928074348717928
distance x is tensor(101.6614, device='cuda:1')
benign distance is  tensor(101.6614, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8736932687461376
distance x is tensor(99.2624, device='cuda:1')
benign distance is  tensor(99.2624, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0327085927128792
distance x is tensor(144.6870, device='cuda:1')
benign distance is  tensor(144.6870, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2738204672932625
distance x is tensor(101.7855, device='cuda:1')
benign distance is  tensor(101.7855, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.820696925278753
distance x is tensor(107.4758, device='cuda:1')
benign distance is  tensor(107.4758, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.001653052866459
distance x is tensor(87.5950, device='cuda:1')
benign distance is  tensor(87.5950, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7678340040147305
distance x is tensor(73.6503, device='cuda:1')
benign distance is  tensor(73.6503, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1410587131977081
distance x is tensor(102.5087, device='cuda:1')
benign distance is  tensor(102.5087, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7758016549050808
distance x is tensor(121.2920, device='cuda:1')
benign distance is  tensor(121.2920, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9847262613475323
distance x is tensor(60.9721, device='cuda:1')
benign distance is  tensor(60.9721, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4812975376844406
distance x is tensor(106.2460, device='cuda:1')
benign distance is  tensor(106.2460, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1826989240944386
distance x is tensor(169.3365, device='cuda:1')
benign distance is  tensor(169.3365, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6436811294406652
distance x is tensor(52.2041, device='cuda:1')
benign distance is  tensor(52.2041, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9590493459254503
distance x is tensor(139.9566, device='cuda:1')
benign distance is  tensor(139.9566, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8370691314339638
distance x is tensor(109.7931, device='cuda:1')
benign distance is  tensor(109.7931, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2410403490066528
distance x is tensor(121.5740, device='cuda:1')
benign distance is  tensor(121.5740, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7394260037690401
distance x is tensor(82.1508, device='cuda:1')
benign distance is  tensor(82.1508, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0842042285948992
distance x is tensor(118.0127, device='cuda:1')
benign distance is  tensor(118.0127, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1049122363328934
distance x is tensor(103.4995, device='cuda:1')
benign distance is  tensor(103.4995, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8792835529893637
distance x is tensor(114.0819, device='cuda:1')
benign distance is  tensor(114.0819, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.932727430947125
distance x is tensor(90.9966, device='cuda:1')
benign distance is  tensor(90.9966, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5942562818527222
distance x is tensor(123.2271, device='cuda:1')
benign distance is  tensor(123.2271, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.635040083900094
distance x is tensor(165.7302, device='cuda:1')
benign distance is  tensor(165.7302, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.42566728591919
distance x is tensor(125.5350, device='cuda:1')
benign distance is  tensor(125.5350, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.450952768325806
distance x is tensor(153.2680, device='cuda:1')
benign distance is  tensor(153.2680, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.782281816005707
distance x is tensor(127.4643, device='cuda:1')
benign distance is  tensor(127.4643, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.110152393579483
distance x is tensor(122.9566, device='cuda:1')
benign distance is  tensor(122.9566, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.45486244559288
distance x is tensor(123.1263, device='cuda:1')
benign distance is  tensor(123.1263, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.611643612384796
distance x is tensor(133.4388, device='cuda:1')
benign distance is  tensor(133.4388, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.071210503578186
distance x is tensor(155.0626, device='cuda:1')
benign distance is  tensor(155.0626, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.58481189608574
distance x is tensor(131.3568, device='cuda:1')
benign distance is  tensor(131.3568, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.649924337863922
distance x is tensor(134.5045, device='cuda:1')
benign distance is  tensor(134.5045, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.199369847774506
distance x is tensor(132.7227, device='cuda:1')
benign distance is  tensor(132.7227, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.381884276866913
distance x is tensor(141.2247, device='cuda:1')
benign distance is  tensor(141.2247, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.879255533218384
distance x is tensor(164.0927, device='cuda:1')
benign distance is  tensor(164.0927, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0.,  0., 35.,  0.,  0., 35., 35., 15., 35., 35., 31., 35., 35.,  1.,
        35.,  0., 13., 35., 28., 35.,  0., 32., 35.,  0., 35.,  0., 35.,  1.,
         0.,  0., 34., 35., 30.,  0.,  9.,  0.])
count_res tensor([4.3653e-17, 4.3653e-17, 6.9235e-02, 4.3653e-17, 4.3653e-17, 6.9235e-02,
        6.9235e-02, 1.4270e-10, 6.9235e-02, 6.9235e-02, 1.2681e-03, 6.9235e-02,
        6.9235e-02, 1.1866e-16, 6.9235e-02, 4.3653e-17, 1.9313e-11, 6.9235e-02,
        6.3134e-05, 6.9235e-02, 4.3653e-17, 3.4470e-03, 6.9235e-02, 4.3653e-17,
        6.9235e-02, 4.3653e-17, 6.9235e-02, 1.1866e-16, 4.3653e-17, 4.3653e-17,
        2.5470e-02, 6.9235e-02, 4.6650e-04, 4.3653e-17, 3.5373e-13, 4.3653e-17])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 72.38% 

Test Accuracy: 29.90% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8290683049708605
distance x is tensor(130.5544, device='cuda:1')
benign distance is  tensor(130.5544, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1639268677681684
distance x is tensor(111.7082, device='cuda:1')
benign distance is  tensor(111.7082, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.142711739987135
distance x is tensor(110.7514, device='cuda:1')
benign distance is  tensor(110.7514, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.245242401957512
distance x is tensor(147.4787, device='cuda:1')
benign distance is  tensor(147.4787, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.077726824209094
distance x is tensor(94.1665, device='cuda:1')
benign distance is  tensor(94.1665, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7351866364479065
distance x is tensor(109.0768, device='cuda:1')
benign distance is  tensor(109.0768, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1898651272058487
distance x is tensor(99.1895, device='cuda:1')
benign distance is  tensor(99.1895, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7904117312282324
distance x is tensor(97.8729, device='cuda:1')
benign distance is  tensor(97.8729, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3092447742819786
distance x is tensor(109.7054, device='cuda:1')
benign distance is  tensor(109.7054, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8759650364518166
distance x is tensor(116.2060, device='cuda:1')
benign distance is  tensor(116.2060, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2967404518276453
distance x is tensor(129.6784, device='cuda:1')
benign distance is  tensor(129.6784, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2793200239539146
distance x is tensor(118.3395, device='cuda:1')
benign distance is  tensor(118.3395, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.034186515957117
distance x is tensor(99.4127, device='cuda:1')
benign distance is  tensor(99.4127, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8679577689617872
distance x is tensor(210.8337, device='cuda:1')
benign distance is  tensor(210.8337, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3869300112128258
distance x is tensor(147.0255, device='cuda:1')
benign distance is  tensor(147.0255, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.859507616609335
distance x is tensor(125.7555, device='cuda:1')
benign distance is  tensor(125.7555, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7993108443915844
distance x is tensor(135.7054, device='cuda:1')
benign distance is  tensor(135.7054, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.2919870615005493
distance x is tensor(106.7865, device='cuda:1')
benign distance is  tensor(106.7865, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8881160877645016
distance x is tensor(152.0276, device='cuda:1')
benign distance is  tensor(152.0276, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1811405643820763
distance x is tensor(126.3406, device='cuda:1')
benign distance is  tensor(126.3406, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9652004651725292
distance x is tensor(125.1050, device='cuda:1')
benign distance is  tensor(125.1050, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9631875306367874
distance x is tensor(101.5585, device='cuda:1')
benign distance is  tensor(101.5585, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.100723884999752
distance x is tensor(105.1009, device='cuda:1')
benign distance is  tensor(105.1009, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7397298719733953
distance x is tensor(133.5204, device='cuda:1')
benign distance is  tensor(133.5204, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.161277025938034
distance x is tensor(87.8490, device='cuda:1')
benign distance is  tensor(87.8490, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.173194915056229
distance x is tensor(130.5681, device='cuda:1')
benign distance is  tensor(130.5681, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.185885578393936
distance x is tensor(95.4590, device='cuda:1')
benign distance is  tensor(95.4590, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.942132294178009
distance x is tensor(87.2781, device='cuda:1')
benign distance is  tensor(87.2781, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.428362876176834
distance x is tensor(94.5217, device='cuda:1')
benign distance is  tensor(94.5217, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.788213402032852
distance x is tensor(121.3344, device='cuda:1')
benign distance is  tensor(121.3344, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.20572954416275
distance x is tensor(119.8426, device='cuda:1')
benign distance is  tensor(119.8426, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  6.9540985226631165
distance x is tensor(100.5277, device='cuda:1')
benign distance is  tensor(100.5277, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.654348850250244
distance x is tensor(110.7573, device='cuda:1')
benign distance is  tensor(110.7573, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.597730994224548
distance x is tensor(89.1590, device='cuda:1')
benign distance is  tensor(89.1590, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.532949298620224
distance x is tensor(107.2335, device='cuda:1')
benign distance is  tensor(107.2335, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.597912430763245
distance x is tensor(135.1160, device='cuda:1')
benign distance is  tensor(135.1160, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([ 0., 26., 27.,  0., 25.,  0.,  0., 27., 27., 23., 16.,  3., 27., 18.,
         5., 23.,  0.,  8., 21.,  0., 27.,  3., 27., 27., 27.,  6.,  0., 27.])
count_res tensor([1.9696e-13, 3.8552e-02, 1.0479e-01, 1.9696e-13, 1.4182e-02, 1.9696e-13,
        1.9696e-13, 1.0479e-01, 1.0479e-01, 1.9194e-03, 1.7503e-06, 3.9561e-12,
        1.0479e-01, 1.2933e-05, 2.9232e-11, 1.9194e-03, 1.9696e-13, 5.8714e-10,
        2.5976e-04, 1.9696e-13, 1.0479e-01, 3.9561e-12, 1.0479e-01, 1.0479e-01,
        1.0479e-01, 7.9461e-11, 1.9696e-13, 1.0479e-01])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 86.42% 

Test Accuracy: 87.07% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7289986480027437
distance x is tensor(120.1573, device='cuda:1')
benign distance is  tensor(120.1573, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8313572779297829
distance x is tensor(102.6079, device='cuda:1')
benign distance is  tensor(102.6079, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7798827197402716
distance x is tensor(95.0562, device='cuda:1')
benign distance is  tensor(95.0562, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0583708956837654
distance x is tensor(140.8011, device='cuda:1')
benign distance is  tensor(140.8011, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.767788253724575
distance x is tensor(80.7710, device='cuda:1')
benign distance is  tensor(80.7710, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8187395930290222
distance x is tensor(101.6368, device='cuda:1')
benign distance is  tensor(101.6368, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0043221041560173
distance x is tensor(98.2221, device='cuda:1')
benign distance is  tensor(98.2221, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9582683071494102
distance x is tensor(72.9187, device='cuda:1')
benign distance is  tensor(72.9187, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9058647882193327
distance x is tensor(107.0453, device='cuda:1')
benign distance is  tensor(107.0453, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9791816864162683
distance x is tensor(139.5621, device='cuda:1')
benign distance is  tensor(139.5621, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1867741979658604
distance x is tensor(49.9671, device='cuda:1')
benign distance is  tensor(49.9671, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3059787154197693
distance x is tensor(104.5652, device='cuda:1')
benign distance is  tensor(104.5652, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.157208364456892
distance x is tensor(158.5325, device='cuda:1')
benign distance is  tensor(158.5325, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8517690487205982
distance x is tensor(54.1367, device='cuda:1')
benign distance is  tensor(54.1367, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3142978511750698
distance x is tensor(142.3666, device='cuda:1')
benign distance is  tensor(142.3666, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5694707073271275
distance x is tensor(114.0405, device='cuda:1')
benign distance is  tensor(114.0405, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.218204349279404
distance x is tensor(134.7610, device='cuda:1')
benign distance is  tensor(134.7610, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.619947910308838
distance x is tensor(160.4358, device='cuda:1')
benign distance is  tensor(160.4358, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.450630486011505
distance x is tensor(138.3601, device='cuda:1')
benign distance is  tensor(138.3601, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.06401064991951
distance x is tensor(124.1692, device='cuda:1')
benign distance is  tensor(124.1692, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.6267081797122955
distance x is tensor(141.1405, device='cuda:1')
benign distance is  tensor(141.1405, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.946622550487518
distance x is tensor(143.0591, device='cuda:1')
benign distance is  tensor(143.0591, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.871306985616684
distance x is tensor(155.4589, device='cuda:1')
benign distance is  tensor(155.4589, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.53653109073639
distance x is tensor(135.2439, device='cuda:1')
benign distance is  tensor(135.2439, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.794089764356613
distance x is tensor(139.6415, device='cuda:1')
benign distance is  tensor(139.6415, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.61381533741951
distance x is tensor(131.8761, device='cuda:1')
benign distance is  tensor(131.8761, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  7.665247797966003
distance x is tensor(137.9310, device='cuda:1')
benign distance is  tensor(137.9310, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.969663679599762
distance x is tensor(162.0897, device='cuda:1')
benign distance is  tensor(162.0897, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 2., 19., 16.,  0.,  2., 18.,  0., 16., 19., 18., 19., 19.,  0., 19.,
         0., 11.,  6.,  0., 17., 19.])
count_res tensor([5.9388e-09, 1.4345e-01, 7.1420e-03, 8.0373e-10, 5.9388e-09, 5.2773e-02,
        8.0373e-10, 7.1420e-03, 1.4345e-01, 5.2773e-02, 1.4345e-01, 1.4345e-01,
        8.0373e-10, 1.4345e-01, 8.0373e-10, 4.8123e-05, 3.2425e-07, 8.0373e-10,
        1.9414e-02, 1.4345e-01])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 48.76% 

Test Accuracy: 13.45% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8426869548857212
distance x is tensor(162.5326, device='cuda:1')
benign distance is  tensor(162.5326, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.188508104532957
distance x is tensor(147.7157, device='cuda:1')
benign distance is  tensor(147.7157, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2411517389118671
distance x is tensor(141.2208, device='cuda:1')
benign distance is  tensor(141.2208, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.230768471956253
distance x is tensor(189.2408, device='cuda:1')
benign distance is  tensor(189.2408, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4173536784946918
distance x is tensor(151.3198, device='cuda:1')
benign distance is  tensor(151.3198, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9217224763706326
distance x is tensor(142.9358, device='cuda:1')
benign distance is  tensor(142.9358, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4991930276155472
distance x is tensor(150.1549, device='cuda:1')
benign distance is  tensor(150.1549, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9653836283832788
distance x is tensor(124.4807, device='cuda:1')
benign distance is  tensor(124.4807, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.218279391527176
distance x is tensor(65.5502, device='cuda:1')
benign distance is  tensor(65.5502, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.77021586894989
distance x is tensor(127.3304, device='cuda:1')
benign distance is  tensor(127.3304, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.843227922916412
distance x is tensor(93.6646, device='cuda:1')
benign distance is  tensor(93.6646, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.10303059220314
distance x is tensor(79.1539, device='cuda:1')
benign distance is  tensor(79.1539, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.20685163140297
distance x is tensor(82.6289, device='cuda:1')
benign distance is  tensor(82.6289, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.987610757350922
distance x is tensor(106.2475, device='cuda:1')
benign distance is  tensor(106.2475, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.114427506923676
distance x is tensor(124.2281, device='cuda:1')
benign distance is  tensor(124.2281, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.194506764411926
distance x is tensor(93.2814, device='cuda:1')
benign distance is  tensor(93.2814, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.669762402772903
distance x is tensor(113.8341, device='cuda:1')
benign distance is  tensor(113.8341, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  8.885963559150696
distance x is tensor(96.5551, device='cuda:1')
benign distance is  tensor(96.5551, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.138242244720459
distance x is tensor(101.3416, device='cuda:1')
benign distance is  tensor(101.3416, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.707876145839691
distance x is tensor(138.6923, device='cuda:1')
benign distance is  tensor(138.6923, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([ 2., 50., 45., 51., 50., 48.,  0., 51., 50., 17., 49., 51., 43.,  2.,
        50., 48., 51., 47., 50.,  0.,  0.,  0.,  5., 49.,  0.,  1., 49.,  9.,
        50.,  1.,  0.,  0., 50., 32.,  0.,  0.,  0.,  0., 51., 51., 51., 50.,
        51., 51.,  0.,  0., 49.,  0.,  0., 49.,  0.,  0.])
count_res tensor([4.1152e-23, 2.8875e-02, 1.9456e-04, 7.8490e-02, 2.8875e-02, 3.9078e-03,
        5.5693e-24, 7.8490e-02, 2.8875e-02, 1.3453e-16, 1.0623e-02, 7.8490e-02,
        2.6331e-05, 4.1152e-23, 2.8875e-02, 3.9078e-03, 7.8490e-02, 1.4376e-03,
        2.8875e-02, 5.5693e-24, 5.5693e-24, 5.5693e-24, 8.2655e-22, 1.0623e-02,
        5.5693e-24, 1.5139e-23, 1.0623e-02, 4.5128e-20, 2.8875e-02, 1.5139e-23,
        5.5693e-24, 5.5693e-24, 2.8875e-02, 4.3977e-10, 5.5693e-24, 5.5693e-24,
        5.5693e-24, 5.5693e-24, 7.8490e-02, 7.8490e-02, 7.8490e-02, 2.8875e-02,
        7.8490e-02, 7.8490e-02, 5.5693e-24, 5.5693e-24, 1.0623e-02, 5.5693e-24,
        5.5693e-24, 1.0623e-02, 5.5693e-24, 5.5693e-24])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 81.92% 

Test Accuracy: 85.78% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7011389676481485
distance x is tensor(120.6649, device='cuda:1')
benign distance is  tensor(120.6649, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0418939758092165
distance x is tensor(95.2584, device='cuda:1')
benign distance is  tensor(95.2584, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1091532800346613
distance x is tensor(91.0523, device='cuda:1')
benign distance is  tensor(91.0523, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1134310569614172
distance x is tensor(138.2287, device='cuda:1')
benign distance is  tensor(138.2287, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9430162161588669
distance x is tensor(77.9402, device='cuda:1')
benign distance is  tensor(77.9402, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8650565259158611
distance x is tensor(105.1461, device='cuda:1')
benign distance is  tensor(105.1461, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1903486177325249
distance x is tensor(89.2275, device='cuda:1')
benign distance is  tensor(89.2275, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8804994001984596
distance x is tensor(74.4341, device='cuda:1')
benign distance is  tensor(74.4341, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.277885852381587
distance x is tensor(98.4356, device='cuda:1')
benign distance is  tensor(98.4356, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7790727484971285
distance x is tensor(119.1102, device='cuda:1')
benign distance is  tensor(119.1102, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1474219039082527
distance x is tensor(63.8404, device='cuda:1')
benign distance is  tensor(63.8404, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2260638773441315
distance x is tensor(109.6154, device='cuda:1')
benign distance is  tensor(109.6154, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.156513437628746
distance x is tensor(167.4266, device='cuda:1')
benign distance is  tensor(167.4266, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7420422323048115
distance x is tensor(51.3073, device='cuda:1')
benign distance is  tensor(51.3073, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.232710376381874
distance x is tensor(140.0986, device='cuda:1')
benign distance is  tensor(140.0986, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4238021224737167
distance x is tensor(105.4278, device='cuda:1')
benign distance is  tensor(105.4278, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1846123561263084
distance x is tensor(88.6393, device='cuda:1')
benign distance is  tensor(88.6393, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8531527034938335
distance x is tensor(109.3336, device='cuda:1')
benign distance is  tensor(109.3336, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0728616043925285
distance x is tensor(110.9734, device='cuda:1')
benign distance is  tensor(110.9734, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9484551195055246
distance x is tensor(101.1191, device='cuda:1')
benign distance is  tensor(101.1191, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0202090330421925
distance x is tensor(68.2306, device='cuda:1')
benign distance is  tensor(68.2306, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7527050320059061
distance x is tensor(200.5682, device='cuda:1')
benign distance is  tensor(200.5682, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1213356852531433
distance x is tensor(127.1920, device='cuda:1')
benign distance is  tensor(127.1920, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2926615960896015
distance x is tensor(107.6436, device='cuda:1')
benign distance is  tensor(107.6436, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.3813739400357008
distance x is tensor(114.9521, device='cuda:1')
benign distance is  tensor(114.9521, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.244912225753069
distance x is tensor(135.8012, device='cuda:1')
benign distance is  tensor(135.8012, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.956838633865118
distance x is tensor(120.5217, device='cuda:1')
benign distance is  tensor(120.5217, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3753771036863327
distance x is tensor(110.6887, device='cuda:1')
benign distance is  tensor(110.6887, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8969616796821356
distance x is tensor(111.5518, device='cuda:1')
benign distance is  tensor(111.5518, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9389962404966354
distance x is tensor(99.7629, device='cuda:1')
benign distance is  tensor(99.7629, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6179590811952949
distance x is tensor(121.1070, device='cuda:1')
benign distance is  tensor(121.1070, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.726249435916543
distance x is tensor(157.5166, device='cuda:1')
benign distance is  tensor(157.5166, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.9786841664463282
distance x is tensor(93.7803, device='cuda:1')
benign distance is  tensor(93.7803, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3072533048689365
distance x is tensor(142.2290, device='cuda:1')
benign distance is  tensor(142.2290, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2299850210547447
distance x is tensor(146.1182, device='cuda:1')
benign distance is  tensor(146.1182, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3412994220852852
distance x is tensor(104.7870, device='cuda:1')
benign distance is  tensor(104.7870, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7250695843249559
distance x is tensor(152.8398, device='cuda:1')
benign distance is  tensor(152.8398, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8748342227190733
distance x is tensor(136.1520, device='cuda:1')
benign distance is  tensor(136.1520, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9739487133920193
distance x is tensor(99.0575, device='cuda:1')
benign distance is  tensor(99.0575, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5682451613247395
distance x is tensor(133.3434, device='cuda:1')
benign distance is  tensor(133.3434, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.145658910274506
distance x is tensor(121.5412, device='cuda:1')
benign distance is  tensor(121.5412, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.95114603638649
distance x is tensor(153.8486, device='cuda:1')
benign distance is  tensor(153.8486, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.866906374692917
distance x is tensor(121.9393, device='cuda:1')
benign distance is  tensor(121.9393, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.879910737276077
distance x is tensor(140.8972, device='cuda:1')
benign distance is  tensor(140.8972, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.450316280126572
distance x is tensor(121.7666, device='cuda:1')
benign distance is  tensor(121.7666, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.419369012117386
distance x is tensor(147.3289, device='cuda:1')
benign distance is  tensor(147.3289, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.478825449943542
distance x is tensor(149.4631, device='cuda:1')
benign distance is  tensor(149.4631, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.115259885787964
distance x is tensor(125.2003, device='cuda:1')
benign distance is  tensor(125.2003, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.700008273124695
distance x is tensor(127.6346, device='cuda:1')
benign distance is  tensor(127.6346, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.088042438030243
distance x is tensor(129.5266, device='cuda:1')
benign distance is  tensor(129.5266, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.643062680959702
distance x is tensor(143.0761, device='cuda:1')
benign distance is  tensor(143.0761, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.028256982564926
distance x is tensor(158.4507, device='cuda:1')
benign distance is  tensor(158.4507, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([ 0., 10., 19.,  0.,  0., 19., 12.,  0., 19., 11., 16., 19., 16., 18.,
         0.,  1., 17., 18., 19.,  6.])
count_res tensor([9.3817e-10, 2.0665e-05, 1.6745e-01, 9.3817e-10, 9.3817e-10, 1.6745e-01,
        1.5269e-04, 9.3817e-10, 1.6745e-01, 5.6172e-05, 8.3367e-03, 1.6745e-01,
        8.3367e-03, 6.1600e-02, 9.3817e-10, 2.5502e-09, 2.2661e-02, 6.1600e-02,
        1.6745e-01, 3.7849e-07])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 49.65% 

Test Accuracy: 14.75% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8541545178741217
distance x is tensor(149.7316, device='cuda:1')
benign distance is  tensor(149.7316, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9748061113059521
distance x is tensor(130.4473, device='cuda:1')
benign distance is  tensor(130.4473, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3020138293504715
distance x is tensor(117.0922, device='cuda:1')
benign distance is  tensor(117.0922, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1608050987124443
distance x is tensor(172.0523, device='cuda:1')
benign distance is  tensor(172.0523, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.205875476822257
distance x is tensor(120.4595, device='cuda:1')
benign distance is  tensor(120.4595, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9380940813571215
distance x is tensor(126.9756, device='cuda:1')
benign distance is  tensor(126.9756, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5412393175065517
distance x is tensor(131.8043, device='cuda:1')
benign distance is  tensor(131.8043, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0652008466422558
distance x is tensor(115.0721, device='cuda:1')
benign distance is  tensor(115.0721, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.239753097295761
distance x is tensor(65.1278, device='cuda:1')
benign distance is  tensor(65.1278, device='cuda:1')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.328557401895523
distance x is tensor(132.2693, device='cuda:1')
benign distance is  tensor(132.2693, device='cuda:1')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.464957892894745
distance x is tensor(92.9463, device='cuda:1')
benign distance is  tensor(92.9463, device='cuda:1')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.307441294193268
distance x is tensor(66.2906, device='cuda:1')
benign distance is  tensor(66.2906, device='cuda:1')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.882991999387741
distance x is tensor(87.0844, device='cuda:1')
benign distance is  tensor(87.0844, device='cuda:1')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.513031989336014
distance x is tensor(108.0384, device='cuda:1')
benign distance is  tensor(108.0384, device='cuda:1')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  7.916384816169739
distance x is tensor(127.5839, device='cuda:1')
benign distance is  tensor(127.5839, device='cuda:1')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.192661076784134
distance x is tensor(98.7673, device='cuda:1')
benign distance is  tensor(98.7673, device='cuda:1')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  7.859237343072891
distance x is tensor(114.8098, device='cuda:1')
benign distance is  tensor(114.8098, device='cuda:1')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.534351825714111
distance x is tensor(101.4573, device='cuda:1')
benign distance is  tensor(101.4573, device='cuda:1')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.405117511749268
distance x is tensor(91.8144, device='cuda:1')
benign distance is  tensor(91.8144, device='cuda:1')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.72678017616272
distance x is tensor(137.1598, device='cuda:1')
benign distance is  tensor(137.1598, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0.,  0.,  0.,  3.,  0., 33.,  0., 19., 33.,  0., 35., 35.,  0., 29.,
        24., 34., 32., 35.,  0., 31., 35., 35., 29., 21., 35., 34., 33.,  0.,
        16., 35., 33.,  0.,  0., 35.,  0.,  0.])
count_res tensor([6.7433e-17, 6.7433e-17, 6.7433e-17, 1.3544e-15, 6.7433e-17, 1.4474e-02,
        6.7433e-17, 1.2036e-08, 1.4474e-02, 6.7433e-17, 1.0695e-01, 1.0695e-01,
        6.7433e-17, 2.6510e-04, 1.7862e-06, 3.9345e-02, 5.3247e-03, 1.0695e-01,
        6.7433e-17, 1.9589e-03, 1.0695e-01, 1.0695e-01, 2.6510e-04, 8.8932e-08,
        1.0695e-01, 3.9345e-02, 1.4474e-02, 6.7433e-17, 5.9922e-10, 1.0695e-01,
        1.4474e-02, 6.7433e-17, 6.7433e-17, 1.0695e-01, 6.7433e-17, 6.7433e-17])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 88.28% 

Test Accuracy: 81.95% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 88.28%
|----0th round Training Accuracy : 17.65%
|----1th round Training Accuracy : 19.20%
|----2th round Training Accuracy : 35.78%
|----3th round Training Accuracy : 80.03%
|----4th round Training Accuracy : 40.70%
|----5th round Training Accuracy : 77.85%
|----6th round Training Accuracy : 34.92%
|----7th round Training Accuracy : 76.70%
|----8th round Training Accuracy : 61.52%
|----9th round Training Accuracy : 82.58%
|----10th round Training Accuracy : 54.72%
|----11th round Training Accuracy : 75.98%
|----12th round Training Accuracy : 45.45%
|----13th round Training Accuracy : 71.78%
|----14th round Training Accuracy : 68.38%
|----15th round Training Accuracy : 77.66%
|----16th round Training Accuracy : 63.63%
|----17th round Training Accuracy : 75.68%
|----18th round Training Accuracy : 44.70%
|----19th round Training Accuracy : 77.85%
|----20th round Training Accuracy : 56.25%
|----21th round Training Accuracy : 78.77%
|----22th round Training Accuracy : 42.60%
|----23th round Training Accuracy : 77.84%
|----24th round Training Accuracy : 43.76%
|----25th round Training Accuracy : 74.30%
|----26th round Training Accuracy : 64.30%
|----27th round Training Accuracy : 76.59%
|----28th round Training Accuracy : 31.61%
|----29th round Training Accuracy : 81.81%
|----30th round Training Accuracy : 34.16%
|----31th round Training Accuracy : 81.07%
|----32th round Training Accuracy : 51.33%
|----33th round Training Accuracy : 82.36%
|----34th round Training Accuracy : 68.22%
|----35th round Training Accuracy : 83.57%
|----36th round Training Accuracy : 45.43%
|----37th round Training Accuracy : 74.21%
|----38th round Training Accuracy : 67.48%
|----39th round Training Accuracy : 87.97%
|----40th round Training Accuracy : 68.57%
|----41th round Training Accuracy : 86.05%
|----42th round Training Accuracy : 51.05%
|----43th round Training Accuracy : 87.93%
|----44th round Training Accuracy : 72.38%
|----45th round Training Accuracy : 86.42%
|----46th round Training Accuracy : 48.76%
|----47th round Training Accuracy : 81.92%
|----48th round Training Accuracy : 49.65%
|----49th round Training Accuracy : 88.28%
|----Final Test Accuracy: 81.95%
|----0th round Final Test Accuracy : 14.02%
|----1th round Final Test Accuracy : 6.70%
|----2th round Final Test Accuracy : 15.34%
|----3th round Final Test Accuracy : 82.76%
|----4th round Final Test Accuracy : 12.64%
|----5th round Final Test Accuracy : 82.82%
|----6th round Final Test Accuracy : 10.94%
|----7th round Final Test Accuracy : 81.20%
|----8th round Final Test Accuracy : 21.43%
|----9th round Final Test Accuracy : 84.56%
|----10th round Final Test Accuracy : 19.71%
|----11th round Final Test Accuracy : 83.22%
|----12th round Final Test Accuracy : 13.39%
|----13th round Final Test Accuracy : 82.21%
|----14th round Final Test Accuracy : 37.48%
|----15th round Final Test Accuracy : 77.92%
|----16th round Final Test Accuracy : 34.55%
|----17th round Final Test Accuracy : 82.37%
|----18th round Final Test Accuracy : 13.49%
|----19th round Final Test Accuracy : 83.79%
|----20th round Final Test Accuracy : 18.77%
|----21th round Final Test Accuracy : 84.90%
|----22th round Final Test Accuracy : 12.07%
|----23th round Final Test Accuracy : 84.44%
|----24th round Final Test Accuracy : 13.50%
|----25th round Final Test Accuracy : 81.53%
|----26th round Final Test Accuracy : 25.31%
|----27th round Final Test Accuracy : 83.94%
|----28th round Final Test Accuracy : 9.10%
|----29th round Final Test Accuracy : 85.72%
|----30th round Final Test Accuracy : 9.61%
|----31th round Final Test Accuracy : 84.72%
|----32th round Final Test Accuracy : 15.18%
|----33th round Final Test Accuracy : 83.32%
|----34th round Final Test Accuracy : 24.75%
|----35th round Final Test Accuracy : 86.34%
|----36th round Final Test Accuracy : 12.51%
|----37th round Final Test Accuracy : 51.00%
|----38th round Final Test Accuracy : 33.98%
|----39th round Final Test Accuracy : 87.25%
|----40th round Final Test Accuracy : 22.25%
|----41th round Final Test Accuracy : 85.94%
|----42th round Final Test Accuracy : 13.80%
|----43th round Final Test Accuracy : 86.63%
|----44th round Final Test Accuracy : 29.90%
|----45th round Final Test Accuracy : 87.07%
|----46th round Final Test Accuracy : 13.45%
|----47th round Final Test Accuracy : 85.78%
|----48th round Final Test Accuracy : 14.75%
|----49th round Final Test Accuracy : 81.95%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!

 Total Run Time: 3445.0893
