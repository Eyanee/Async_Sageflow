
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45703619718551636
distance x is tensor(119.0102, device='cuda:3')
benign distance is  tensor(119.0102, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4225936830043793
distance x is tensor(120.3825, device='cuda:3')
benign distance is  tensor(120.3825, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5195208787918091
distance x is tensor(124.3052, device='cuda:3')
benign distance is  tensor(124.3052, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6171215176582336
distance x is tensor(113.7959, device='cuda:3')
benign distance is  tensor(113.7959, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8278640508651733
distance x is tensor(109.4092, device='cuda:3')
benign distance is  tensor(109.4092, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.32650890946388245
distance x is tensor(127.1732, device='cuda:3')
benign distance is  tensor(127.1732, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7033061981201172
distance x is tensor(108.9599, device='cuda:3')
benign distance is  tensor(108.9599, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6338214874267578
distance x is tensor(125.2275, device='cuda:3')
benign distance is  tensor(125.2275, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.26873117685317993
distance x is tensor(133.7231, device='cuda:3')
benign distance is  tensor(133.7231, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4663321077823639
distance x is tensor(141.7899, device='cuda:3')
benign distance is  tensor(141.7899, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6209503412246704
distance x is tensor(119.8651, device='cuda:3')
benign distance is  tensor(119.8651, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.37975525856018066
distance x is tensor(129.9958, device='cuda:3')
benign distance is  tensor(129.9958, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2923773229122162
distance x is tensor(134.1615, device='cuda:3')
benign distance is  tensor(134.1615, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.29352039098739624
distance x is tensor(145.4253, device='cuda:3')
benign distance is  tensor(145.4253, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6045280694961548
distance x is tensor(133.3772, device='cuda:3')
benign distance is  tensor(133.3772, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.1718362271785736
distance x is tensor(138.3134, device='cuda:3')
benign distance is  tensor(138.3134, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2403591126203537
distance x is tensor(128.4315, device='cuda:3')
benign distance is  tensor(128.4315, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6674806475639343
distance x is tensor(143.3887, device='cuda:3')
benign distance is  tensor(143.3887, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4258561134338379
distance x is tensor(128.2207, device='cuda:3')
benign distance is  tensor(128.2207, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.48318806290626526
distance x is tensor(124.3893, device='cuda:3')
benign distance is  tensor(124.3893, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.09252212196588516
distance x is tensor(129.9283, device='cuda:3')
benign distance is  tensor(129.9283, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.31175869703292847
distance x is tensor(122.1727, device='cuda:3')
benign distance is  tensor(122.1727, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.19161605834960938
distance x is tensor(139.9734, device='cuda:3')
benign distance is  tensor(139.9734, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0548102855682373
distance x is tensor(129.0878, device='cuda:3')
benign distance is  tensor(129.0878, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6270121932029724
distance x is tensor(145.0922, device='cuda:3')
benign distance is  tensor(145.0922, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6701585054397583
distance x is tensor(122.0308, device='cuda:3')
benign distance is  tensor(122.0308, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4529285430908203
distance x is tensor(138.6908, device='cuda:3')
benign distance is  tensor(138.6908, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.24368774890899658
distance x is tensor(135.6865, device='cuda:3')
benign distance is  tensor(135.6865, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9196308255195618
distance x is tensor(127.8359, device='cuda:3')
benign distance is  tensor(127.8359, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.794863224029541
distance x is tensor(137.6485, device='cuda:3')
benign distance is  tensor(137.6485, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4981943964958191
distance x is tensor(125.2507, device='cuda:3')
benign distance is  tensor(125.2507, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6352392435073853
distance x is tensor(139.2250, device='cuda:3')
benign distance is  tensor(139.2250, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.531523585319519
distance x is tensor(135.4758, device='cuda:3')
benign distance is  tensor(135.4758, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.07977749407291412
distance x is tensor(128.7859, device='cuda:3')
benign distance is  tensor(128.7859, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4249856472015381
distance x is tensor(140.9354, device='cuda:3')
benign distance is  tensor(140.9354, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.07850340753793716
distance x is tensor(126.5561, device='cuda:3')
benign distance is  tensor(126.5561, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4441322386264801
distance x is tensor(127.6674, device='cuda:3')
benign distance is  tensor(127.6674, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.42309731245040894
distance x is tensor(125.8630, device='cuda:3')
benign distance is  tensor(125.8630, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.1664273738861084
distance x is tensor(126.4678, device='cuda:3')
benign distance is  tensor(126.4678, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11812923103570938
distance x is tensor(127.6802, device='cuda:3')
benign distance is  tensor(127.6802, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1479721963405609
distance x is tensor(124.5736, device='cuda:3')
benign distance is  tensor(124.5736, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.665474534034729
distance x is tensor(125.4942, device='cuda:3')
benign distance is  tensor(125.4942, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.05863366276025772
distance x is tensor(129.2796, device='cuda:3')
benign distance is  tensor(129.2796, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5151972770690918
distance x is tensor(136.1728, device='cuda:3')
benign distance is  tensor(136.1728, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5465440154075623
distance x is tensor(138.8344, device='cuda:3')
benign distance is  tensor(138.8344, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1112239360809326
distance x is tensor(128.2590, device='cuda:3')
benign distance is  tensor(128.2590, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2039566040039062
distance x is tensor(141.5903, device='cuda:3')
benign distance is  tensor(141.5903, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.20764708518981934
distance x is tensor(135.6848, device='cuda:3')
benign distance is  tensor(135.6848, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3754712641239166
mal_entropy is 0.17427471280097961
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([541.1706, 559.9161, 556.2154, 519.0205, 495.5079, 573.0283, 485.2955,
        584.2422, 460.7231, 460.7231, 460.7231, 460.7231, 460.7231, 460.7231,
        460.7231, 460.7231, 460.7231, 460.7231, 460.7231, 460.7231],
       device='cuda:3')
sorted_norm is   tensor([460.7231, 460.7231, 460.7231, 460.7231, 460.7231, 460.7231, 460.7231,
        460.7231, 460.7231, 460.7231, 460.7231, 460.7231, 485.2955, 495.5079,
        519.0205, 541.1706, 556.2154, 559.9161, 573.0283, 584.2422],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  4,  3,  0],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 88.70% 

Test Accuracy: 87.82% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.837526798248291
distance x is tensor(103.6651, device='cuda:3')
benign distance is  tensor(103.6651, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8055486679077148
distance x is tensor(113.7381, device='cuda:3')
benign distance is  tensor(113.7381, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6760608553886414
distance x is tensor(114.0713, device='cuda:3')
benign distance is  tensor(114.0713, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.30402833223342896
distance x is tensor(107.2742, device='cuda:3')
benign distance is  tensor(107.2742, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.37819376587867737
distance x is tensor(104.1350, device='cuda:3')
benign distance is  tensor(104.1350, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5418816208839417
distance x is tensor(120.6486, device='cuda:3')
benign distance is  tensor(120.6486, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5534936785697937
distance x is tensor(117.1022, device='cuda:3')
benign distance is  tensor(117.1022, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30355697870254517
distance x is tensor(121.0665, device='cuda:3')
benign distance is  tensor(121.0665, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6230283379554749
mal_entropy is 0.2764069736003876
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([475.3092, 525.6766, 524.2391, 484.0535, 475.4929, 552.2528, 533.5322,
        560.3800, 460.3477, 460.3477, 460.3477, 460.3477, 460.3477, 460.3477,
        460.3477, 460.3477, 460.3477, 460.3477, 460.3477, 460.3477, 704.9474,
        723.3811, 652.8504, 688.9296, 699.0550, 754.1024, 707.3755, 722.8596],
       device='cuda:3')
sorted_norm is   tensor([460.3477, 460.3477, 460.3477, 460.3477, 460.3477, 460.3477, 460.3477,
        460.3477, 460.3477, 460.3477, 460.3477, 460.3477, 475.3092, 475.4929,
        484.0535, 524.2391, 525.6766, 533.5322, 552.2528, 560.3800, 652.8504,
        688.9296, 699.0550, 704.9474, 707.3755, 722.8596, 723.3811, 754.1024],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  0,  4,  3,  2,  1,  6,
         5,  7, 22, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.14% 

Test Accuracy: 87.17% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9611548185348511
distance x is tensor(121.2548, device='cuda:3')
benign distance is  tensor(121.2548, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6216173768043518
distance x is tensor(143.2811, device='cuda:3')
benign distance is  tensor(143.2811, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13273027539253235
distance x is tensor(127.9221, device='cuda:3')
benign distance is  tensor(127.9221, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5629035234451294
distance x is tensor(111.0105, device='cuda:3')
benign distance is  tensor(111.0105, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7670735120773315
distance x is tensor(115.4891, device='cuda:3')
benign distance is  tensor(115.4891, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6169738173484802
distance x is tensor(129.6473, device='cuda:3')
benign distance is  tensor(129.6473, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9520151019096375
distance x is tensor(113.9919, device='cuda:3')
benign distance is  tensor(113.9919, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49960699677467346
distance x is tensor(122.0316, device='cuda:3')
benign distance is  tensor(122.0316, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4310299754142761
distance x is tensor(150.3839, device='cuda:3')
benign distance is  tensor(150.3839, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5018588304519653
distance x is tensor(143.4065, device='cuda:3')
benign distance is  tensor(143.4065, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7348359823226929
distance x is tensor(127.4773, device='cuda:3')
benign distance is  tensor(127.4773, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7142376899719238
distance x is tensor(144.8430, device='cuda:3')
benign distance is  tensor(144.8430, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5167175531387329
distance x is tensor(134.8318, device='cuda:3')
benign distance is  tensor(134.8318, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4205518662929535
distance x is tensor(150.5803, device='cuda:3')
benign distance is  tensor(150.5803, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6728636622428894
distance x is tensor(138.8848, device='cuda:3')
benign distance is  tensor(138.8848, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5913898944854736
distance x is tensor(147.3092, device='cuda:3')
benign distance is  tensor(147.3092, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 0.7659899592399597
mal_entropy is 0.2631613314151764
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([555.3701, 659.0571, 566.4770, 488.4970, 526.9030, 608.6901, 512.5447,
        561.4684, 461.9102, 461.9102, 461.9102, 461.9102, 461.9102, 461.9102,
        461.9102, 461.9102, 461.9102, 461.9102, 461.9102, 461.9102, 733.0345,
        804.3265, 740.2645, 734.4544, 728.7172, 713.8106, 784.9636, 726.4388],
       device='cuda:3')
sorted_norm is   tensor([461.9102, 461.9102, 461.9102, 461.9102, 461.9102, 461.9102, 461.9102,
        461.9102, 461.9102, 461.9102, 461.9102, 461.9102, 488.4970, 512.5447,
        526.9030, 555.3701, 561.4684, 566.4770, 608.6901, 659.0571, 713.8106,
        726.4388, 728.7172, 733.0345, 734.4544, 740.2645, 784.9636, 804.3265],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  3,  6,  4,  0,  7,  2,
         5,  1, 25, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.43% 

Test Accuracy: 86.08% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.185188889503479
distance x is tensor(127.2275, device='cuda:3')
benign distance is  tensor(127.2275, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38159576058387756
distance x is tensor(128.8051, device='cuda:3')
benign distance is  tensor(128.8051, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7619802355766296
distance x is tensor(141.6853, device='cuda:3')
benign distance is  tensor(141.6853, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.721278965473175
distance x is tensor(120.6741, device='cuda:3')
benign distance is  tensor(120.6741, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3858548104763031
distance x is tensor(120.0920, device='cuda:3')
benign distance is  tensor(120.0920, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7995540499687195
distance x is tensor(138.3774, device='cuda:3')
benign distance is  tensor(138.3774, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6376072764396667
distance x is tensor(139.3316, device='cuda:3')
benign distance is  tensor(139.3316, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5228191614151001
distance x is tensor(138.1315, device='cuda:3')
benign distance is  tensor(138.1315, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4287562966346741
distance x is tensor(144.2532, device='cuda:3')
benign distance is  tensor(144.2532, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.501794695854187
distance x is tensor(154.8637, device='cuda:3')
benign distance is  tensor(154.8637, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4238552153110504
distance x is tensor(149.1161, device='cuda:3')
benign distance is  tensor(149.1161, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.14120617508888245
distance x is tensor(150.0502, device='cuda:3')
benign distance is  tensor(150.0502, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5267782211303711
distance x is tensor(145.7364, device='cuda:3')
benign distance is  tensor(145.7364, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9757334589958191
distance x is tensor(134.3995, device='cuda:3')
benign distance is  tensor(134.3995, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.26350924372673035
distance x is tensor(158.4118, device='cuda:3')
benign distance is  tensor(158.4118, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.44872838258743286
distance x is tensor(152.2003, device='cuda:3')
benign distance is  tensor(152.2003, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal_loss is 3.943009853363037
mal_entropy is 0.3526585102081299
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([588.5556, 579.9947, 640.9548, 548.0571, 526.6627, 629.4695, 615.9806,
        626.5167, 462.8207, 462.8207, 462.8207, 462.8207, 462.8207, 462.8207,
        462.8207, 462.8207, 462.8207, 462.8207, 462.8207, 462.8207, 846.5975,
        753.8165, 821.1365, 800.5056, 789.6796, 822.8022, 775.5756, 834.3271,
        734.1471, 708.8728, 647.3361, 699.2430, 679.4312, 725.7740, 686.2983,
        718.7827], device='cuda:3')
sorted_norm is   tensor([462.8207, 462.8207, 462.8207, 462.8207, 462.8207, 462.8207, 462.8207,
        462.8207, 462.8207, 462.8207, 462.8207, 462.8207, 526.6627, 548.0571,
        579.9947, 588.5556, 615.9806, 626.5167, 629.4695, 640.9548, 647.3361,
        679.4312, 686.2983, 699.2430, 708.8728, 718.7827, 725.7740, 734.1471,
        753.8165, 775.5756, 789.6796, 800.5056, 821.1365, 822.8022, 834.3271,
        846.5975], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  4,  3,  1,  0,  6,  7,
         5,  2, 30, 32, 34, 31, 29, 35, 33, 28], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.03% 

Test Accuracy: 85.51% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0749828815460205
distance x is tensor(130.7797, device='cuda:3')
benign distance is  tensor(130.7797, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9301637411117554
distance x is tensor(123.6940, device='cuda:3')
benign distance is  tensor(123.6940, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2121969759464264
distance x is tensor(127.8621, device='cuda:3')
benign distance is  tensor(127.8621, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1567682027816772
distance x is tensor(125.4164, device='cuda:3')
benign distance is  tensor(125.4164, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9109770655632019
distance x is tensor(133.6353, device='cuda:3')
benign distance is  tensor(133.6353, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3720148801803589
distance x is tensor(133.9778, device='cuda:3')
benign distance is  tensor(133.9778, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.30054759979248047
distance x is tensor(124.0898, device='cuda:3')
benign distance is  tensor(124.0898, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.11680374294519424
distance x is tensor(144.1539, device='cuda:3')
benign distance is  tensor(144.1539, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.35576537251472473
distance x is tensor(141.2709, device='cuda:3')
benign distance is  tensor(141.2709, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6774395108222961
distance x is tensor(151.0310, device='cuda:3')
benign distance is  tensor(151.0310, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0289747714996338
distance x is tensor(144.0002, device='cuda:3')
benign distance is  tensor(144.0002, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8450679779052734
distance x is tensor(136.9786, device='cuda:3')
benign distance is  tensor(136.9786, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5931971669197083
distance x is tensor(135.6048, device='cuda:3')
benign distance is  tensor(135.6048, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19707664847373962
distance x is tensor(157.2536, device='cuda:3')
benign distance is  tensor(157.2536, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4733542501926422
distance x is tensor(146.5230, device='cuda:3')
benign distance is  tensor(146.5230, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.45463818311691284
distance x is tensor(152.1236, device='cuda:3')
benign distance is  tensor(152.1236, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.40111222863197327
distance x is tensor(161.3292, device='cuda:3')
benign distance is  tensor(161.3292, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.44955435395240784
distance x is tensor(145.7402, device='cuda:3')
benign distance is  tensor(145.7402, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3609745502471924
distance x is tensor(153.8041, device='cuda:3')
benign distance is  tensor(153.8041, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.49935364723205566
distance x is tensor(155.1338, device='cuda:3')
benign distance is  tensor(155.1338, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1504924297332764
distance x is tensor(140.5583, device='cuda:3')
benign distance is  tensor(140.5583, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6676761507987976
distance x is tensor(145.0239, device='cuda:3')
benign distance is  tensor(145.0239, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.29698312282562256
distance x is tensor(154.4318, device='cuda:3')
benign distance is  tensor(154.4318, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.29701894521713257
distance x is tensor(146.9445, device='cuda:3')
benign distance is  tensor(146.9445, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 6.550201416015625
mal_entropy is 0.25478455424308777
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([603.0901, 564.2027, 576.8967, 574.4968, 610.2089, 593.7407, 555.1107,
        660.1031, 462.7874, 462.7874, 462.7874, 462.7874, 462.7874, 462.7874,
        462.7874, 462.7874, 462.7874, 462.7874, 462.7874, 462.7874, 841.7672,
        811.8256, 858.8468, 805.5347, 822.8221, 799.7816, 817.2712, 802.7836],
       device='cuda:3')
sorted_norm is   tensor([462.7874, 462.7874, 462.7874, 462.7874, 462.7874, 462.7874, 462.7874,
        462.7874, 462.7874, 462.7874, 462.7874, 462.7874, 555.1107, 564.2027,
        574.4968, 576.8967, 593.7407, 603.0901, 610.2089, 660.1031, 799.7816,
        802.7836, 805.5347, 811.8256, 817.2712, 822.8221, 841.7672, 858.8468],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  1,  3,  2,  5,  0,
         4,  7, 25, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 83.13% 

Test Accuracy: 81.91% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4174322485923767
distance x is tensor(153.9312, device='cuda:3')
benign distance is  tensor(153.9312, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2755473852157593
distance x is tensor(153.6912, device='cuda:3')
benign distance is  tensor(153.6912, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7013372778892517
distance x is tensor(150.9937, device='cuda:3')
benign distance is  tensor(150.9937, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7765811085700989
distance x is tensor(128.8293, device='cuda:3')
benign distance is  tensor(128.8293, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2816382944583893
distance x is tensor(129.2850, device='cuda:3')
benign distance is  tensor(129.2850, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8389801979064941
distance x is tensor(151.4438, device='cuda:3')
benign distance is  tensor(151.4438, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8305288553237915
distance x is tensor(140.2344, device='cuda:3')
benign distance is  tensor(140.2344, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.41290798783302307
distance x is tensor(159.8607, device='cuda:3')
benign distance is  tensor(159.8607, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2451142817735672
distance x is tensor(162.4485, device='cuda:3')
benign distance is  tensor(162.4485, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.07096380740404129
distance x is tensor(164.0368, device='cuda:3')
benign distance is  tensor(164.0368, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.449413537979126
distance x is tensor(158.6384, device='cuda:3')
benign distance is  tensor(158.6384, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1847478300333023
distance x is tensor(164.3837, device='cuda:3')
benign distance is  tensor(164.3837, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6114533543586731
distance x is tensor(153.1979, device='cuda:3')
benign distance is  tensor(153.1979, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.09213948994874954
distance x is tensor(157.6003, device='cuda:3')
benign distance is  tensor(157.6003, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3139938712120056
distance x is tensor(153.1626, device='cuda:3')
benign distance is  tensor(153.1626, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.34016895294189453
distance x is tensor(150.1018, device='cuda:3')
benign distance is  tensor(150.1018, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal_loss is 24.35328483581543
mal_entropy is 0.10823044925928116
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([702.5117, 675.2944, 673.5872, 563.4056, 570.2195, 678.2946, 625.9484,
        731.4314, 463.2292, 463.2292, 463.2292, 463.2292, 463.2292, 463.2292,
        463.2292, 463.2292, 463.2292, 463.2292, 463.2292, 463.2292, 859.4930,
        851.9497, 865.8450, 877.0984, 895.5165, 864.2243, 906.1897, 895.0859,
        740.0183, 781.2292, 746.3153, 757.1297, 737.8861, 701.9391, 788.0156,
        762.8870, 697.0567, 729.2662, 688.8297, 668.3608, 670.5865, 754.5737,
        707.9631, 715.8096], device='cuda:3')
sorted_norm is   tensor([463.2292, 463.2292, 463.2292, 463.2292, 463.2292, 463.2292, 463.2292,
        463.2292, 463.2292, 463.2292, 463.2292, 463.2292, 563.4056, 570.2195,
        625.9484, 668.3608, 670.5865, 673.5872, 675.2944, 678.2946, 688.8297,
        697.0567, 701.9391, 702.5117, 707.9631, 715.8096, 729.2662, 731.4314,
        737.8861, 740.0183, 746.3153, 754.5737, 757.1297, 762.8870, 781.2292,
        788.0156, 851.9497, 859.4930, 864.2243, 865.8450, 877.0984, 895.0859,
        895.5165, 906.1897], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  3,  4,  6, 39, 40,  2,
         1,  5, 38, 36, 33,  0, 42, 43, 37,  7, 32, 28, 30, 41, 31, 35, 29],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.57% 

Test Accuracy: 86.14% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.532555878162384
distance x is tensor(148.8088, device='cuda:3')
benign distance is  tensor(148.8088, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.28426846861839294
distance x is tensor(133.1734, device='cuda:3')
benign distance is  tensor(133.1734, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22593942284584045
distance x is tensor(151.7089, device='cuda:3')
benign distance is  tensor(151.7089, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1255548000335693
distance x is tensor(115.2567, device='cuda:3')
benign distance is  tensor(115.2567, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9533107876777649
distance x is tensor(124.5226, device='cuda:3')
benign distance is  tensor(124.5226, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5203267335891724
distance x is tensor(146.5077, device='cuda:3')
benign distance is  tensor(146.5077, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23913519084453583
distance x is tensor(143.0641, device='cuda:3')
benign distance is  tensor(143.0641, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3292388617992401
distance x is tensor(131.1344, device='cuda:3')
benign distance is  tensor(131.1344, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.32165202498435974
distance x is tensor(156.9715, device='cuda:3')
benign distance is  tensor(156.9715, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.19557559490203857
distance x is tensor(146.4596, device='cuda:3')
benign distance is  tensor(146.4596, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3201066851615906
distance x is tensor(140.5529, device='cuda:3')
benign distance is  tensor(140.5529, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.41100651025772095
distance x is tensor(141.8297, device='cuda:3')
benign distance is  tensor(141.8297, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5060713887214661
distance x is tensor(142.5903, device='cuda:3')
benign distance is  tensor(142.5903, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.14009782671928406
distance x is tensor(158.0430, device='cuda:3')
benign distance is  tensor(158.0430, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.22771534323692322
distance x is tensor(152.1952, device='cuda:3')
benign distance is  tensor(152.1952, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9677461385726929
distance x is tensor(143.0593, device='cuda:3')
benign distance is  tensor(143.0593, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.43661078810691833
distance x is tensor(149.4766, device='cuda:3')
benign distance is  tensor(149.4766, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9133914113044739
distance x is tensor(167.0566, device='cuda:3')
benign distance is  tensor(167.0566, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4234183728694916
distance x is tensor(151.6221, device='cuda:3')
benign distance is  tensor(151.6221, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1427399069070816
distance x is tensor(148.7662, device='cuda:3')
benign distance is  tensor(148.7662, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6098424196243286
distance x is tensor(150.8964, device='cuda:3')
benign distance is  tensor(150.8964, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6632343530654907
distance x is tensor(143.9123, device='cuda:3')
benign distance is  tensor(143.9123, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.22400882840156555
distance x is tensor(151.5532, device='cuda:3')
benign distance is  tensor(151.5532, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6605347394943237
distance x is tensor(152.8230, device='cuda:3')
benign distance is  tensor(152.8230, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4007372260093689
distance x is tensor(149.2858, device='cuda:3')
benign distance is  tensor(149.2858, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.25077706575393677
distance x is tensor(140.4285, device='cuda:3')
benign distance is  tensor(140.4285, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07621253281831741
distance x is tensor(146.0424, device='cuda:3')
benign distance is  tensor(146.0424, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.6806209087371826
distance x is tensor(143.8659, device='cuda:3')
benign distance is  tensor(143.8659, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3141632378101349
distance x is tensor(146.3010, device='cuda:3')
benign distance is  tensor(146.3010, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6097938418388367
distance x is tensor(149.4599, device='cuda:3')
benign distance is  tensor(149.4599, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6777773499488831
distance x is tensor(146.0629, device='cuda:3')
benign distance is  tensor(146.0629, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.9179717302322388
distance x is tensor(157.8110, device='cuda:3')
benign distance is  tensor(157.8110, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal_loss is 10.441316604614258
mal_entropy is 0.2389778196811676
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([680.9389, 609.9504, 672.7415, 512.4677, 555.6816, 663.3912, 632.8832,
        596.9671, 462.6110, 462.6110, 462.6110, 462.6110, 462.6110, 462.6110,
        462.6110, 462.6110, 462.6110, 462.6110, 462.6110, 462.6110],
       device='cuda:3')
sorted_norm is   tensor([462.6110, 462.6110, 462.6110, 462.6110, 462.6110, 462.6110, 462.6110,
        462.6110, 462.6110, 462.6110, 462.6110, 462.6110, 512.4677, 555.6816,
        596.9671, 609.9504, 632.8832, 663.3912, 672.7415, 680.9389],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  3,  4,  7,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 57.28% 

Test Accuracy: 56.83% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8127298355102539
distance x is tensor(185.0848, device='cuda:3')
benign distance is  tensor(185.0848, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7080200910568237
distance x is tensor(195.1867, device='cuda:3')
benign distance is  tensor(195.1867, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19643163681030273
distance x is tensor(190.9978, device='cuda:3')
benign distance is  tensor(190.9978, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2921798527240753
distance x is tensor(195.6381, device='cuda:3')
benign distance is  tensor(195.6381, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5845820307731628
distance x is tensor(161.0108, device='cuda:3')
benign distance is  tensor(161.0108, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.091037631034851
distance x is tensor(194.4272, device='cuda:3')
benign distance is  tensor(194.4272, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1417805254459381
distance x is tensor(214.4523, device='cuda:3')
benign distance is  tensor(214.4523, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6096776723861694
distance x is tensor(195.0983, device='cuda:3')
benign distance is  tensor(195.0983, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 66.51234436035156
mal_entropy is 0.027016891166567802
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([796.7291, 811.8297, 795.0330, 818.0540, 675.5975, 816.7599, 882.6900,
        828.3143, 463.3730, 463.3730, 463.3730, 463.3730, 463.3730, 463.3730,
        463.3730, 463.3730, 463.3730, 463.3730, 463.3730, 463.3730, 863.0922,
        798.4288, 838.6639, 833.0328, 783.5765, 805.0511, 848.3046, 825.9984,
        789.5408, 771.1774, 736.5702, 748.1662, 747.3049, 792.2262, 786.1778,
        745.5184], device='cuda:3')
sorted_norm is   tensor([463.3730, 463.3730, 463.3730, 463.3730, 463.3730, 463.3730, 463.3730,
        463.3730, 463.3730, 463.3730, 463.3730, 463.3730, 675.5975, 736.5702,
        745.5184, 747.3049, 748.1662, 771.1774, 783.5765, 786.1778, 789.5408,
        792.2262, 795.0330, 796.7291, 798.4288, 805.0511, 811.8297, 816.7599,
        818.0540, 825.9984, 828.3143, 833.0328, 838.6639, 848.3046, 863.0922,
        882.6900], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  4, 30, 35, 32, 31, 29,
        24, 34, 28, 33,  2,  0, 21, 25,  1,  5], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 84.32% 

Test Accuracy: 83.05% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4769170880317688
distance x is tensor(170.2620, device='cuda:3')
benign distance is  tensor(170.2620, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7410321831703186
distance x is tensor(160.8896, device='cuda:3')
benign distance is  tensor(160.8896, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.28029665350914
distance x is tensor(148.8492, device='cuda:3')
benign distance is  tensor(148.8492, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9740310907363892
distance x is tensor(160.4676, device='cuda:3')
benign distance is  tensor(160.4676, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9780181646347046
distance x is tensor(162.0953, device='cuda:3')
benign distance is  tensor(162.0953, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8150228261947632
distance x is tensor(164.3399, device='cuda:3')
benign distance is  tensor(164.3399, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3122004270553589
distance x is tensor(153.0097, device='cuda:3')
benign distance is  tensor(153.0097, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9608230590820312
distance x is tensor(164.0722, device='cuda:3')
benign distance is  tensor(164.0722, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.22574761509895325
distance x is tensor(170.4809, device='cuda:3')
benign distance is  tensor(170.4809, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4634591042995453
distance x is tensor(162.9425, device='cuda:3')
benign distance is  tensor(162.9425, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6814627647399902
distance x is tensor(165.2975, device='cuda:3')
benign distance is  tensor(165.2975, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.10299551486969
distance x is tensor(153.9732, device='cuda:3')
benign distance is  tensor(153.9732, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.41322261095046997
distance x is tensor(162.4710, device='cuda:3')
benign distance is  tensor(162.4710, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3441402316093445
distance x is tensor(165.8675, device='cuda:3')
benign distance is  tensor(165.8675, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.26762908697128296
distance x is tensor(159.3164, device='cuda:3')
benign distance is  tensor(159.3164, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.21839027106761932
distance x is tensor(173.3289, device='cuda:3')
benign distance is  tensor(173.3289, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3557875454425812
distance x is tensor(175.7146, device='cuda:3')
benign distance is  tensor(175.7146, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6949539184570312
distance x is tensor(160.7041, device='cuda:3')
benign distance is  tensor(160.7041, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5777766108512878
distance x is tensor(170.7444, device='cuda:3')
benign distance is  tensor(170.7444, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.500737190246582
distance x is tensor(177.4371, device='cuda:3')
benign distance is  tensor(177.4371, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.637161374092102
distance x is tensor(171.0691, device='cuda:3')
benign distance is  tensor(171.0691, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8291834592819214
distance x is tensor(152.7919, device='cuda:3')
benign distance is  tensor(152.7919, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1611545979976654
distance x is tensor(162.3708, device='cuda:3')
benign distance is  tensor(162.3708, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.38286224007606506
distance x is tensor(167.6003, device='cuda:3')
benign distance is  tensor(167.6003, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal_loss is 9.952962875366211
mal_entropy is 0.34074437618255615
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([757.6249, 716.2557, 682.0631, 741.4111, 724.3075, 744.8503, 678.9052,
        741.7389, 459.1337, 459.1338, 459.1337, 459.1338, 459.1337, 459.1338,
        459.1337, 459.1338, 459.1337, 459.1338, 459.1337, 459.1338, 748.3697,
        815.3915, 766.4193, 758.7414, 744.3654, 732.2867, 757.5767, 757.1775],
       device='cuda:3')
sorted_norm is   tensor([459.1337, 459.1337, 459.1337, 459.1337, 459.1337, 459.1337, 459.1338,
        459.1338, 459.1338, 459.1338, 459.1338, 459.1338, 678.9052, 682.0631,
        716.2557, 724.3075, 732.2867, 741.4111, 741.7389, 744.3654, 744.8503,
        748.3697, 757.1775, 757.5767, 757.6249, 758.7414, 766.4193, 815.3915],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  6,  2,  1,  4, 25,  3,
         7, 24,  5, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 80.81% 

Test Accuracy: 79.27% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5251514911651611
distance x is tensor(170.4828, device='cuda:3')
benign distance is  tensor(170.4828, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.619472324848175
distance x is tensor(166.1833, device='cuda:3')
benign distance is  tensor(166.1833, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08811461925506592
distance x is tensor(166.7758, device='cuda:3')
benign distance is  tensor(166.7758, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6670206785202026
distance x is tensor(170.4597, device='cuda:3')
benign distance is  tensor(170.4597, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6680405735969543
distance x is tensor(170.5842, device='cuda:3')
benign distance is  tensor(170.5842, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5745980143547058
distance x is tensor(158.0650, device='cuda:3')
benign distance is  tensor(158.0650, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5554766058921814
distance x is tensor(153.4905, device='cuda:3')
benign distance is  tensor(153.4905, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1546471118927002
distance x is tensor(170.2746, device='cuda:3')
benign distance is  tensor(170.2746, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.7812523245811462
distance x is tensor(165.7407, device='cuda:3')
benign distance is  tensor(165.7407, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7984185218811035
distance x is tensor(188.1003, device='cuda:3')
benign distance is  tensor(188.1003, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3496437072753906
distance x is tensor(165.7785, device='cuda:3')
benign distance is  tensor(165.7785, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2802639603614807
distance x is tensor(174.8258, device='cuda:3')
benign distance is  tensor(174.8258, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.0598708912730217
distance x is tensor(171.9120, device='cuda:3')
benign distance is  tensor(171.9120, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3968142867088318
distance x is tensor(170.5303, device='cuda:3')
benign distance is  tensor(170.5303, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4810825288295746
distance x is tensor(182.8523, device='cuda:3')
benign distance is  tensor(182.8523, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5696555376052856
distance x is tensor(169.3007, device='cuda:3')
benign distance is  tensor(169.3007, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal_loss is 23.67203140258789
mal_entropy is 0.09533286094665527
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([752.9902, 740.0400, 736.2121, 777.3540, 755.7747, 706.0510, 688.9404,
        767.7424, 461.2794, 461.2794, 461.2794, 461.2794, 461.2794, 461.2794,
        461.2794, 461.2794, 461.2794, 461.2794, 461.2794, 461.2794, 838.4908,
        860.7032, 835.9238, 851.7172, 837.9825, 833.2567, 815.5981, 810.2950,
        818.0500, 782.8406, 778.1469, 747.5029, 769.8905, 781.5690, 764.1931,
        812.2301], device='cuda:3')
sorted_norm is   tensor([461.2794, 461.2794, 461.2794, 461.2794, 461.2794, 461.2794, 461.2794,
        461.2794, 461.2794, 461.2794, 461.2794, 461.2794, 688.9404, 706.0510,
        736.2121, 740.0400, 747.5029, 752.9902, 755.7747, 764.1931, 767.7424,
        769.8905, 777.3540, 778.1469, 781.5690, 782.8406, 810.2950, 812.2301,
        815.5981, 818.0500, 833.2567, 835.9238, 837.9825, 838.4908, 851.7172,
        860.7032], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  6,  5,  2,  1, 31,  0,
         4, 34,  7, 32,  3, 30, 33, 29, 27, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 85.01% 

Test Accuracy: 83.39% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1629328727722168
distance x is tensor(182.3165, device='cuda:3')
benign distance is  tensor(182.3165, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0100104808807373
distance x is tensor(172.8276, device='cuda:3')
benign distance is  tensor(172.8276, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2606286108493805
distance x is tensor(167.5087, device='cuda:3')
benign distance is  tensor(167.5087, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.29861512780189514
distance x is tensor(151.0325, device='cuda:3')
benign distance is  tensor(151.0325, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.667948842048645
distance x is tensor(166.8347, device='cuda:3')
benign distance is  tensor(166.8347, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8209651708602905
distance x is tensor(160.4509, device='cuda:3')
benign distance is  tensor(160.4509, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.14636917412281036
distance x is tensor(163.1581, device='cuda:3')
benign distance is  tensor(163.1581, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6974200010299683
distance x is tensor(168.1804, device='cuda:3')
benign distance is  tensor(168.1804, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3130125403404236
distance x is tensor(169.0547, device='cuda:3')
benign distance is  tensor(169.0547, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5403302907943726
distance x is tensor(168.3151, device='cuda:3')
benign distance is  tensor(168.3151, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.790125846862793
distance x is tensor(170.1185, device='cuda:3')
benign distance is  tensor(170.1185, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7765684127807617
distance x is tensor(171.1157, device='cuda:3')
benign distance is  tensor(171.1157, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2291218489408493
distance x is tensor(164.8067, device='cuda:3')
benign distance is  tensor(164.8067, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7879185676574707
distance x is tensor(161.6366, device='cuda:3')
benign distance is  tensor(161.6366, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3228384852409363
distance x is tensor(189.2794, device='cuda:3')
benign distance is  tensor(189.2794, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4223777055740356
distance x is tensor(184.0665, device='cuda:3')
benign distance is  tensor(184.0665, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3907824456691742
distance x is tensor(182.4754, device='cuda:3')
benign distance is  tensor(182.4754, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.17312900722026825
distance x is tensor(169.3092, device='cuda:3')
benign distance is  tensor(169.3092, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4695516526699066
distance x is tensor(173.6839, device='cuda:3')
benign distance is  tensor(173.6839, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.18018856644630432
distance x is tensor(165.9226, device='cuda:3')
benign distance is  tensor(165.9226, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6218457221984863
distance x is tensor(169.4958, device='cuda:3')
benign distance is  tensor(169.4958, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6471099257469177
distance x is tensor(163.4787, device='cuda:3')
benign distance is  tensor(163.4787, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.28672128915786743
distance x is tensor(158.9590, device='cuda:3')
benign distance is  tensor(158.9590, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6155074238777161
distance x is tensor(169.8318, device='cuda:3')
benign distance is  tensor(169.8318, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal_loss is 18.241857528686523
mal_entropy is 0.19138675928115845
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([824.8301, 769.1664, 732.6363, 663.9903, 743.4007, 713.8331, 722.1626,
        758.6884, 461.8041, 461.8041, 461.8041, 461.8041, 461.8041, 461.8041,
        461.8041, 461.8041, 461.8041, 461.8041, 461.8041, 461.8041],
       device='cuda:3')
sorted_norm is   tensor([461.8041, 461.8041, 461.8041, 461.8041, 461.8041, 461.8041, 461.8041,
        461.8041, 461.8041, 461.8041, 461.8041, 461.8041, 663.9903, 713.8331,
        722.1626, 732.6363, 743.4007, 758.6884, 769.1664, 824.8301],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  3,  5,  6,  2],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 46.98% 

Test Accuracy: 46.86% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.439889132976532
distance x is tensor(240.8164, device='cuda:3')
benign distance is  tensor(240.8164, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7579408288002014
distance x is tensor(214.2876, device='cuda:3')
benign distance is  tensor(214.2876, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4402785897254944
distance x is tensor(245.9329, device='cuda:3')
benign distance is  tensor(245.9329, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45014452934265137
distance x is tensor(238.9862, device='cuda:3')
benign distance is  tensor(238.9862, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.689173698425293
distance x is tensor(229.8634, device='cuda:3')
benign distance is  tensor(229.8634, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5863814353942871
distance x is tensor(256.0092, device='cuda:3')
benign distance is  tensor(256.0092, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.359364777803421
distance x is tensor(229.4077, device='cuda:3')
benign distance is  tensor(229.4077, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9233829379081726
distance x is tensor(231.9321, device='cuda:3')
benign distance is  tensor(231.9321, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 64.42352294921875
mal_entropy is 0.0027000156696885824
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 972.1725,  877.6864,  979.9416,  966.4591,  933.0796, 1028.3888,
         932.7670,  945.5627,  463.2235,  463.2235,  463.2235,  463.2235,
         463.2235,  463.2235,  463.2235,  463.2235,  463.2235,  463.2235,
         463.2235,  463.2235,  936.9252,  915.1434,  933.2581,  938.2186,
         942.8079,  939.7141,  932.5655,  980.5582,  951.3533,  898.7903,
         934.3126,  940.7284,  932.2162,  864.1125,  905.2076,  932.9514,
         874.1990,  956.7966,  858.7866,  887.2029,  878.0284,  892.7001,
         919.2776,  870.3420,  858.8583,  848.0057,  847.3709,  867.1790,
         824.8673,  809.2012,  932.6736,  925.5454], device='cuda:3')
sorted_norm is   tensor([ 463.2235,  463.2235,  463.2235,  463.2235,  463.2235,  463.2235,
         463.2235,  463.2235,  463.2235,  463.2235,  463.2235,  463.2235,
         809.2012,  824.8673,  847.3709,  848.0057,  858.7866,  858.8583,
         864.1125,  867.1790,  870.3420,  874.1990,  877.6864,  878.0284,
         887.2029,  892.7001,  898.7903,  905.2076,  915.1434,  919.2776,
         925.5454,  932.2162,  932.5655,  932.6736,  932.7670,  932.9514,
         933.0796,  933.2581,  934.3126,  936.9252,  938.2186,  939.7141,
         940.7284,  942.8079,  945.5627,  951.3533,  956.7966,  966.4591,
         972.1725,  979.9416,  980.5582, 1028.3888], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 49, 48, 46, 45, 38, 44,
        33, 47, 43, 36,  1, 40, 39, 41, 29, 34, 21, 42, 51, 32, 26, 50,  6, 35,
         4, 22, 30, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 87.01% 

Test Accuracy: 85.90% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1989742517471313
distance x is tensor(139.2789, device='cuda:3')
benign distance is  tensor(139.2789, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0058536529541016
distance x is tensor(144.1292, device='cuda:3')
benign distance is  tensor(144.1292, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4357171058654785
distance x is tensor(153.8664, device='cuda:3')
benign distance is  tensor(153.8664, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4583512842655182
distance x is tensor(149.8608, device='cuda:3')
benign distance is  tensor(149.8608, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0608242750167847
distance x is tensor(145.1185, device='cuda:3')
benign distance is  tensor(145.1185, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.49960851669311523
distance x is tensor(148.7717, device='cuda:3')
benign distance is  tensor(148.7717, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3924197256565094
distance x is tensor(141.1645, device='cuda:3')
benign distance is  tensor(141.1645, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39890289306640625
distance x is tensor(156.0964, device='cuda:3')
benign distance is  tensor(156.0964, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2819007337093353
distance x is tensor(149.9790, device='cuda:3')
benign distance is  tensor(149.9790, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.803003191947937
distance x is tensor(149.6705, device='cuda:3')
benign distance is  tensor(149.6705, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8427101969718933
distance x is tensor(143.3375, device='cuda:3')
benign distance is  tensor(143.3375, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.100338339805603
distance x is tensor(149.9420, device='cuda:3')
benign distance is  tensor(149.9420, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4984818398952484
distance x is tensor(180.1756, device='cuda:3')
benign distance is  tensor(180.1756, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1687384694814682
distance x is tensor(166.8035, device='cuda:3')
benign distance is  tensor(166.8035, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.47107046842575073
distance x is tensor(141.9985, device='cuda:3')
benign distance is  tensor(141.9985, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5691760182380676
distance x is tensor(155.3545, device='cuda:3')
benign distance is  tensor(155.3545, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5416610240936279
distance x is tensor(147.0753, device='cuda:3')
benign distance is  tensor(147.0753, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.279433250427246
distance x is tensor(160.2709, device='cuda:3')
benign distance is  tensor(160.2709, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.22486825287342072
distance x is tensor(148.4123, device='cuda:3')
benign distance is  tensor(148.4123, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1692093014717102
distance x is tensor(163.2309, device='cuda:3')
benign distance is  tensor(163.2309, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.485076904296875
distance x is tensor(160.5511, device='cuda:3')
benign distance is  tensor(160.5511, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7868840098381042
distance x is tensor(146.1719, device='cuda:3')
benign distance is  tensor(146.1719, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.16661138832569122
distance x is tensor(166.1362, device='cuda:3')
benign distance is  tensor(166.1362, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6118641495704651
distance x is tensor(147.6602, device='cuda:3')
benign distance is  tensor(147.6602, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2611663341522217
distance x is tensor(155.9419, device='cuda:3')
benign distance is  tensor(155.9419, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8121351003646851
distance x is tensor(143.2876, device='cuda:3')
benign distance is  tensor(143.2876, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.12773630023002625
distance x is tensor(144.6309, device='cuda:3')
benign distance is  tensor(144.6309, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.207505464553833
distance x is tensor(160.4836, device='cuda:3')
benign distance is  tensor(160.4836, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.273543357849121
distance x is tensor(158.2234, device='cuda:3')
benign distance is  tensor(158.2234, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.35573792457580566
distance x is tensor(158.7698, device='cuda:3')
benign distance is  tensor(158.7698, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.39140158891677856
distance x is tensor(157.5957, device='cuda:3')
benign distance is  tensor(157.5957, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6866639256477356
distance x is tensor(154.6381, device='cuda:3')
benign distance is  tensor(154.6381, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2539665102958679
distance x is tensor(159.2905, device='cuda:3')
benign distance is  tensor(159.2905, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8605964779853821
distance x is tensor(156.4536, device='cuda:3')
benign distance is  tensor(156.4536, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.45084500312805176
distance x is tensor(152.4673, device='cuda:3')
benign distance is  tensor(152.4673, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6673871874809265
distance x is tensor(166.4547, device='cuda:3')
benign distance is  tensor(166.4547, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.42347949743270874
distance x is tensor(150.8985, device='cuda:3')
benign distance is  tensor(150.8985, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9599167704582214
distance x is tensor(166.8716, device='cuda:3')
benign distance is  tensor(166.8716, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8253825902938843
distance x is tensor(166.7469, device='cuda:3')
benign distance is  tensor(166.7469, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.44330209493637085
distance x is tensor(158.7718, device='cuda:3')
benign distance is  tensor(158.7718, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 5.119929313659668
mal_entropy is 0.3534385561943054
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([630.0426, 657.4600, 701.2361, 665.9893, 666.2814, 671.7897, 636.5634,
        705.9189, 460.5097, 460.5096, 460.5097, 460.5096, 460.5097, 460.5096,
        460.5097, 460.5096, 460.5097, 460.5096, 460.5097, 460.5096],
       device='cuda:3')
sorted_norm is   tensor([460.5096, 460.5096, 460.5096, 460.5096, 460.5096, 460.5096, 460.5097,
        460.5097, 460.5097, 460.5097, 460.5097, 460.5097, 630.0426, 636.5634,
        657.4600, 665.9893, 666.2814, 671.7897, 701.2361, 705.9189],
       device='cuda:3')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10,  0,  6,  1,  3],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 71.24% 

Test Accuracy: 70.07% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8791805505752563
distance x is tensor(184.2699, device='cuda:3')
benign distance is  tensor(184.2699, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0349314212799072
distance x is tensor(185.9317, device='cuda:3')
benign distance is  tensor(185.9317, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1551603525876999
distance x is tensor(176.4352, device='cuda:3')
benign distance is  tensor(176.4352, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7045184969902039
distance x is tensor(208.3824, device='cuda:3')
benign distance is  tensor(208.3824, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0803053379058838
distance x is tensor(188.0804, device='cuda:3')
benign distance is  tensor(188.0804, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9808074831962585
distance x is tensor(202.6629, device='cuda:3')
benign distance is  tensor(202.6629, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0572112798690796
distance x is tensor(196.7375, device='cuda:3')
benign distance is  tensor(196.7375, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4146301746368408
distance x is tensor(206.8095, device='cuda:3')
benign distance is  tensor(206.8095, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal_loss is 35.68964385986328
mal_entropy is 0.10053302347660065
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([807.7943, 804.0670, 780.5391, 906.1258, 827.1521, 878.2693, 856.8724,
        897.7815, 462.0283, 462.0283, 462.0283, 462.0283, 462.0283, 462.0283,
        462.0283, 462.0283, 462.0283, 462.0283, 462.0283, 462.0283, 780.4382,
        789.2141, 751.3805, 787.7452, 884.6650, 833.5205, 744.6757, 799.8454],
       device='cuda:3')
sorted_norm is   tensor([462.0283, 462.0283, 462.0283, 462.0283, 462.0283, 462.0283, 462.0283,
        462.0283, 462.0283, 462.0283, 462.0283, 462.0283, 744.6757, 751.3805,
        780.4382, 780.5391, 787.7452, 789.2141, 799.8454, 804.0670, 807.7943,
        827.1521, 833.5205, 856.8724, 878.2693, 884.6650, 897.7815, 906.1258],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 26, 22, 20,  2, 23, 21,
        27,  1,  0,  4], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 65.72% 

Test Accuracy: 64.09% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.261531949043274
distance x is tensor(244.2488, device='cuda:3')
benign distance is  tensor(244.2488, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.863511860370636
distance x is tensor(212.0634, device='cuda:3')
benign distance is  tensor(212.0634, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5389522314071655
distance x is tensor(202.0430, device='cuda:3')
benign distance is  tensor(202.0430, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7500743269920349
distance x is tensor(207.0610, device='cuda:3')
benign distance is  tensor(207.0610, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5706415772438049
distance x is tensor(208.0177, device='cuda:3')
benign distance is  tensor(208.0177, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8303189277648926
distance x is tensor(239.1809, device='cuda:3')
benign distance is  tensor(239.1809, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.560050368309021
distance x is tensor(209.9453, device='cuda:3')
benign distance is  tensor(209.9453, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6371970772743225
distance x is tensor(223.9751, device='cuda:3')
benign distance is  tensor(223.9751, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6278938055038452
distance x is tensor(215.6708, device='cuda:3')
benign distance is  tensor(215.6708, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.410329669713974
distance x is tensor(200.4679, device='cuda:3')
benign distance is  tensor(200.4679, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6432987451553345
distance x is tensor(203.7336, device='cuda:3')
benign distance is  tensor(203.7336, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9234635233879089
distance x is tensor(216.1290, device='cuda:3')
benign distance is  tensor(216.1290, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6087890863418579
distance x is tensor(201.5842, device='cuda:3')
benign distance is  tensor(201.5842, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.39240604639053345
distance x is tensor(186.1994, device='cuda:3')
benign distance is  tensor(186.1994, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7582430243492126
distance x is tensor(194.7081, device='cuda:3')
benign distance is  tensor(194.7081, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5914459228515625
distance x is tensor(208.3583, device='cuda:3')
benign distance is  tensor(208.3583, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal_loss is 53.93855667114258
mal_entropy is 0.030496833845973015
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([998.5737, 890.3805, 859.5494, 885.2184, 881.7531, 960.0627, 877.6364,
        924.4464, 463.0253, 463.0253, 463.0253, 463.0253, 463.0253, 463.0253,
        463.0253, 463.0253, 463.0253, 463.0253, 463.0253, 463.0253, 932.3221,
        893.0022, 907.8031, 869.2297, 887.9969, 859.1091, 852.4698, 886.6290,
        778.5186, 827.9643, 796.5356, 858.9683, 834.1044, 785.2811, 861.5105,
        786.2961], device='cuda:3')
sorted_norm is   tensor([463.0253, 463.0253, 463.0253, 463.0253, 463.0253, 463.0253, 463.0253,
        463.0253, 463.0253, 463.0253, 463.0253, 463.0253, 778.5186, 785.2811,
        786.2961, 796.5356, 827.9643, 834.1044, 852.4698, 858.9683, 859.1091,
        859.5494, 861.5105, 869.2297, 877.6364, 881.7531, 885.2184, 886.6290,
        887.9969, 890.3805, 893.0022, 907.8031, 924.4464, 932.3221, 960.0627,
        998.5737], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 28, 33, 35, 30, 29, 32,
        26, 31, 25,  2, 34, 23,  6,  4,  3, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 83.95% 

Test Accuracy: 82.75% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4555816650390625
distance x is tensor(188.1550, device='cuda:3')
benign distance is  tensor(188.1550, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.854714035987854
distance x is tensor(164.4199, device='cuda:3')
benign distance is  tensor(164.4199, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6751202344894409
distance x is tensor(164.0499, device='cuda:3')
benign distance is  tensor(164.0499, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.021140694618225
distance x is tensor(145.9344, device='cuda:3')
benign distance is  tensor(145.9344, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5314897894859314
distance x is tensor(167.1524, device='cuda:3')
benign distance is  tensor(167.1524, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5662280321121216
distance x is tensor(182.5228, device='cuda:3')
benign distance is  tensor(182.5228, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15486666560173035
distance x is tensor(174.8433, device='cuda:3')
benign distance is  tensor(174.8433, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.47406548261642456
distance x is tensor(178.3709, device='cuda:3')
benign distance is  tensor(178.3709, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.08529277890920639
distance x is tensor(167.3192, device='cuda:3')
benign distance is  tensor(167.3192, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.795539379119873
distance x is tensor(178.5180, device='cuda:3')
benign distance is  tensor(178.5180, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6122870445251465
distance x is tensor(176.7983, device='cuda:3')
benign distance is  tensor(176.7983, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3967273235321045
distance x is tensor(172.0962, device='cuda:3')
benign distance is  tensor(172.0962, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.764126181602478
distance x is tensor(166.3610, device='cuda:3')
benign distance is  tensor(166.3610, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5927292704582214
distance x is tensor(156.8302, device='cuda:3')
benign distance is  tensor(156.8302, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2556385397911072
distance x is tensor(179.4680, device='cuda:3')
benign distance is  tensor(179.4680, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7386490106582642
distance x is tensor(170.3379, device='cuda:3')
benign distance is  tensor(170.3379, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.18472939729690552
distance x is tensor(193.4858, device='cuda:3')
benign distance is  tensor(193.4858, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.11973585933446884
distance x is tensor(196.3694, device='cuda:3')
benign distance is  tensor(196.3694, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.32461562752723694
distance x is tensor(174.5535, device='cuda:3')
benign distance is  tensor(174.5535, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.33514827489852905
distance x is tensor(163.9861, device='cuda:3')
benign distance is  tensor(163.9861, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8892289400100708
distance x is tensor(175.8601, device='cuda:3')
benign distance is  tensor(175.8601, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.26051074266433716
distance x is tensor(164.1818, device='cuda:3')
benign distance is  tensor(164.1818, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9264623522758484
distance x is tensor(158.6245, device='cuda:3')
benign distance is  tensor(158.6245, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4193948209285736
distance x is tensor(165.0013, device='cuda:3')
benign distance is  tensor(165.0013, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 23.3195858001709
mal_entropy is 0.2113092988729477
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([823.4519, 738.2302, 725.2852, 657.2950, 741.9579, 805.5250, 769.1702,
        802.8409, 462.0829, 462.0829, 462.0829, 462.0829, 462.0829, 462.0829,
        462.0829, 462.0829, 462.0829, 462.0829, 462.0829, 462.0829, 780.1793,
        720.4256, 741.1923, 794.4990, 790.9051, 783.8121, 793.5609, 779.7982,
        904.9149, 852.5412, 848.1075, 926.1257, 858.1778, 790.0389, 808.7224,
        870.4495], device='cuda:3')
sorted_norm is   tensor([462.0829, 462.0829, 462.0829, 462.0829, 462.0829, 462.0829, 462.0829,
        462.0829, 462.0829, 462.0829, 462.0829, 462.0829, 657.2950, 720.4256,
        725.2852, 738.2302, 741.1923, 741.9579, 769.1702, 779.7982, 780.1793,
        783.8121, 790.0389, 790.9051, 793.5609, 794.4990, 802.8409, 805.5250,
        808.7224, 823.4519, 848.1075, 852.5412, 858.1778, 870.4495, 904.9149,
        926.1257], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  3, 21,  2,  1, 22,  4,
         6, 27, 20, 25, 33, 24, 26, 23,  7,  5], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 86.29% 

Test Accuracy: 84.94% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19157616794109344
distance x is tensor(169.5449, device='cuda:3')
benign distance is  tensor(169.5449, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7364208102226257
distance x is tensor(160.2001, device='cuda:3')
benign distance is  tensor(160.2001, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2015676200389862
distance x is tensor(174.5054, device='cuda:3')
benign distance is  tensor(174.5054, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5077625513076782
distance x is tensor(158.9281, device='cuda:3')
benign distance is  tensor(158.9281, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1032851934432983
distance x is tensor(155.8541, device='cuda:3')
benign distance is  tensor(155.8541, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8919353485107422
distance x is tensor(163.7545, device='cuda:3')
benign distance is  tensor(163.7545, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5284145474433899
distance x is tensor(152.7724, device='cuda:3')
benign distance is  tensor(152.7724, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5652067065238953
distance x is tensor(173.3493, device='cuda:3')
benign distance is  tensor(173.3493, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.12331628799438477
distance x is tensor(171.0905, device='cuda:3')
benign distance is  tensor(171.0905, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.34784698486328125
distance x is tensor(170.7262, device='cuda:3')
benign distance is  tensor(170.7262, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.091010332107544
distance x is tensor(176.9950, device='cuda:3')
benign distance is  tensor(176.9950, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5364396572113037
distance x is tensor(174.6114, device='cuda:3')
benign distance is  tensor(174.6114, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7754159569740295
distance x is tensor(163.5611, device='cuda:3')
benign distance is  tensor(163.5611, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.42507314682006836
distance x is tensor(173.4965, device='cuda:3')
benign distance is  tensor(173.4965, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6049606204032898
distance x is tensor(174.4858, device='cuda:3')
benign distance is  tensor(174.4858, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5388355851173401
distance x is tensor(174.0375, device='cuda:3')
benign distance is  tensor(174.0375, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.10842007398605347
distance x is tensor(166.3487, device='cuda:3')
benign distance is  tensor(166.3487, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.535773754119873
distance x is tensor(167.3696, device='cuda:3')
benign distance is  tensor(167.3696, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.22649319469928741
distance x is tensor(183.5635, device='cuda:3')
benign distance is  tensor(183.5635, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6492549777030945
distance x is tensor(194.1511, device='cuda:3')
benign distance is  tensor(194.1511, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1166795492172241
distance x is tensor(169.9183, device='cuda:3')
benign distance is  tensor(169.9183, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5564741492271423
distance x is tensor(176.6445, device='cuda:3')
benign distance is  tensor(176.6445, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5006260871887207
distance x is tensor(181.8352, device='cuda:3')
benign distance is  tensor(181.8352, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.64898282289505
distance x is tensor(168.6687, device='cuda:3')
benign distance is  tensor(168.6687, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal_loss is 17.18477439880371
mal_entropy is 0.16836780309677124
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([745.0202, 724.8600, 776.8798, 700.2894, 689.2769, 741.3339, 686.5212,
        777.0455, 463.1459, 463.1459, 463.1459, 463.1459, 463.1459, 463.1459,
        463.1459, 463.1459, 463.1459, 463.1459, 463.1459, 463.1459],
       device='cuda:3')
sorted_norm is   tensor([463.1459, 463.1459, 463.1459, 463.1459, 463.1459, 463.1459, 463.1459,
        463.1459, 463.1459, 463.1459, 463.1459, 463.1459, 686.5212, 689.2769,
        700.2894, 724.8600, 741.3339, 745.0202, 776.8798, 777.0455],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  4,  3,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 44.17% 

Test Accuracy: 44.27% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0853025913238525
distance x is tensor(270.0929, device='cuda:3')
benign distance is  tensor(270.0929, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3040813207626343
distance x is tensor(239.9604, device='cuda:3')
benign distance is  tensor(239.9604, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6960166692733765
distance x is tensor(270.7715, device='cuda:3')
benign distance is  tensor(270.7715, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.210012435913086
distance x is tensor(285.5614, device='cuda:3')
benign distance is  tensor(285.5614, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1980898678302765
distance x is tensor(259.7878, device='cuda:3')
benign distance is  tensor(259.7878, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8734613656997681
distance x is tensor(300.2829, device='cuda:3')
benign distance is  tensor(300.2829, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.47561559081077576
distance x is tensor(262.4671, device='cuda:3')
benign distance is  tensor(262.4671, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9330567121505737
distance x is tensor(258.7524, device='cuda:3')
benign distance is  tensor(258.7524, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 84.77641296386719
mal_entropy is 0.013011368922889233
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([1084.4783,  966.4821, 1067.2054, 1140.7561, 1016.5059, 1200.2817,
        1049.4397, 1022.7565,  463.4096,  463.4096,  463.4096,  463.4096,
         463.4096,  463.4096,  463.4096,  463.4096,  463.4096,  463.4096,
         463.4096,  463.4096,  913.0006,  914.3362,  902.9131,  956.9183,
         890.7442,  946.1050,  946.1923,  926.2246,  864.2835,  904.8329,
         893.3380,  876.4377,  864.9235,  826.8559,  901.0848,  873.5919,
         856.1778,  857.5477,  890.4291,  871.4827,  824.6369,  855.9294,
         870.7452,  858.3765], device='cuda:3')
sorted_norm is   tensor([ 463.4096,  463.4096,  463.4096,  463.4096,  463.4096,  463.4096,
         463.4096,  463.4096,  463.4096,  463.4096,  463.4096,  463.4096,
         824.6369,  826.8559,  855.9294,  856.1778,  857.5477,  858.3765,
         864.2835,  864.9235,  870.7452,  871.4827,  873.5919,  876.4377,
         890.4291,  890.7442,  893.3380,  901.0848,  902.9131,  904.8329,
         913.0006,  914.3362,  926.2246,  946.1050,  946.1923,  956.9183,
         966.4821, 1016.5059, 1022.7565, 1049.4397, 1067.2054, 1084.4783,
        1140.7561, 1200.2817], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 40, 33, 41, 36, 37, 43,
        28, 32, 42, 39, 35, 31, 38, 24, 30, 34, 22, 29, 20, 21, 27, 25, 26],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 85.46% 

Test Accuracy: 84.37% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2917623817920685
distance x is tensor(188.8696, device='cuda:3')
benign distance is  tensor(188.8696, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5053337812423706
distance x is tensor(167.5854, device='cuda:3')
benign distance is  tensor(167.5854, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.35380929708480835
distance x is tensor(174.5976, device='cuda:3')
benign distance is  tensor(174.5976, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.026475191116333
distance x is tensor(174.1290, device='cuda:3')
benign distance is  tensor(174.1290, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9890670776367188
distance x is tensor(150.5963, device='cuda:3')
benign distance is  tensor(150.5963, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.549889862537384
distance x is tensor(173.4228, device='cuda:3')
benign distance is  tensor(173.4228, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8275152444839478
distance x is tensor(152.2939, device='cuda:3')
benign distance is  tensor(152.2939, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6360074877738953
distance x is tensor(162.3881, device='cuda:3')
benign distance is  tensor(162.3881, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.483625590801239
distance x is tensor(181.7408, device='cuda:3')
benign distance is  tensor(181.7408, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7315765619277954
distance x is tensor(163.8820, device='cuda:3')
benign distance is  tensor(163.8820, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5194896459579468
distance x is tensor(167.5597, device='cuda:3')
benign distance is  tensor(167.5597, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.124005675315857
distance x is tensor(175.4440, device='cuda:3')
benign distance is  tensor(175.4440, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.37808266282081604
distance x is tensor(168.8904, device='cuda:3')
benign distance is  tensor(168.8904, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.42526713013648987
distance x is tensor(162.1276, device='cuda:3')
benign distance is  tensor(162.1276, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2477329969406128
distance x is tensor(167.0449, device='cuda:3')
benign distance is  tensor(167.0449, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3347935378551483
distance x is tensor(161.3605, device='cuda:3')
benign distance is  tensor(161.3605, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3863059878349304
distance x is tensor(172.8665, device='cuda:3')
benign distance is  tensor(172.8665, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4152985215187073
distance x is tensor(174.9108, device='cuda:3')
benign distance is  tensor(174.9108, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.24812380969524384
distance x is tensor(164.9864, device='cuda:3')
benign distance is  tensor(164.9864, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.30209410190582275
distance x is tensor(169.3134, device='cuda:3')
benign distance is  tensor(169.3134, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9537187814712524
distance x is tensor(187.0118, device='cuda:3')
benign distance is  tensor(187.0118, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.20863938331604
distance x is tensor(161.3798, device='cuda:3')
benign distance is  tensor(161.3798, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.27234578132629395
distance x is tensor(176.9030, device='cuda:3')
benign distance is  tensor(176.9030, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.328259140253067
distance x is tensor(165.1638, device='cuda:3')
benign distance is  tensor(165.1638, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.5394765734672546
distance x is tensor(160.2359, device='cuda:3')
benign distance is  tensor(160.2359, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7471365332603455
distance x is tensor(175.8812, device='cuda:3')
benign distance is  tensor(175.8812, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.15264037251472473
distance x is tensor(160.7109, device='cuda:3')
benign distance is  tensor(160.7109, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6303759813308716
distance x is tensor(188.9246, device='cuda:3')
benign distance is  tensor(188.9246, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.36726605892181396
distance x is tensor(154.5509, device='cuda:3')
benign distance is  tensor(154.5509, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4216586947441101
distance x is tensor(168.0746, device='cuda:3')
benign distance is  tensor(168.0746, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.35477131605148315
distance x is tensor(173.5560, device='cuda:3')
benign distance is  tensor(173.5560, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.17303523421287537
distance x is tensor(171.5401, device='cuda:3')
benign distance is  tensor(171.5401, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 30.49668312072754
mal_entropy is 0.14769333600997925
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([802.1619, 749.7535, 757.7888, 770.6332, 652.3714, 773.2878, 666.6679,
        715.3138, 463.1684, 463.1684, 463.1684, 463.1684, 463.1684, 463.1684,
        463.1684, 463.1684, 463.1684, 463.1684, 463.1684, 463.1684],
       device='cuda:3')
sorted_norm is   tensor([463.1684, 463.1684, 463.1684, 463.1684, 463.1684, 463.1684, 463.1684,
        463.1684, 463.1684, 463.1684, 463.1684, 463.1684, 652.3714, 666.6679,
        715.3138, 749.7535, 757.7888, 770.6332, 773.2878, 802.1619],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  6,  7,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 37.78% 

Test Accuracy: 38.06% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2105398178100586
distance x is tensor(292.9344, device='cuda:3')
benign distance is  tensor(292.9344, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7538522481918335
distance x is tensor(257.5997, device='cuda:3')
benign distance is  tensor(257.5997, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03928842768073082
distance x is tensor(271.7851, device='cuda:3')
benign distance is  tensor(271.7851, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39824455976486206
distance x is tensor(273.0802, device='cuda:3')
benign distance is  tensor(273.0802, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5451063513755798
distance x is tensor(383.1319, device='cuda:3')
benign distance is  tensor(383.1319, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.349878191947937
distance x is tensor(301.4962, device='cuda:3')
benign distance is  tensor(301.4962, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.02628888189792633
distance x is tensor(260.0488, device='cuda:3')
benign distance is  tensor(260.0488, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31206539273262024
distance x is tensor(288.9700, device='cuda:3')
benign distance is  tensor(288.9700, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 87.81947326660156
mal_entropy is 0.005439333617687225
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([1170.0060, 1034.9934, 1077.6642, 1061.2036, 1601.3331, 1188.7278,
        1032.3523, 1143.5293,  462.8822,  462.8822,  462.8822,  462.8822,
         462.8822,  462.8822,  462.8822,  462.8822,  462.8822,  462.8822,
         462.8822,  462.8822,  959.0371,  974.6282,  910.2614,  867.1094,
         910.0566,  854.4524,  840.5817,  860.3018,  878.3142,  856.8500,
         936.7990,  976.5450,  882.5279,  912.8491,  921.1686,  874.9429,
         895.9662,  827.2825,  815.3751,  856.8060,  832.5222,  790.2996,
         820.3300,  812.7928], device='cuda:3')
sorted_norm is   tensor([ 462.8822,  462.8822,  462.8822,  462.8822,  462.8822,  462.8822,
         462.8822,  462.8822,  462.8822,  462.8822,  462.8822,  462.8822,
         790.2996,  812.7928,  815.3751,  820.3300,  827.2825,  832.5222,
         840.5817,  854.4524,  856.8060,  856.8500,  860.3018,  867.1094,
         874.9429,  878.3142,  882.5279,  895.9662,  910.0566,  910.2614,
         912.8491,  921.1686,  936.7990,  959.0371,  974.6282,  976.5450,
        1032.3523, 1034.9934, 1061.2036, 1077.6642, 1143.5293, 1170.0060,
        1188.7278, 1601.3331], device='cuda:3')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 41, 43, 38, 42, 37, 40,
        26, 25, 39, 29, 27, 23, 35, 28, 32, 36, 24, 22, 33, 34, 30, 20, 21],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 86.45% 

Test Accuracy: 85.08% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6559575796127319
distance x is tensor(179.7587, device='cuda:3')
benign distance is  tensor(179.7587, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4342283308506012
distance x is tensor(153.9781, device='cuda:3')
benign distance is  tensor(153.9781, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6322365403175354
distance x is tensor(164.1442, device='cuda:3')
benign distance is  tensor(164.1442, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6063042879104614
distance x is tensor(172.9051, device='cuda:3')
benign distance is  tensor(172.9051, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5521290302276611
distance x is tensor(168.6582, device='cuda:3')
benign distance is  tensor(168.6582, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8265607953071594
distance x is tensor(162.5882, device='cuda:3')
benign distance is  tensor(162.5882, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5992063879966736
distance x is tensor(141.8130, device='cuda:3')
benign distance is  tensor(141.8130, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4085620045661926
distance x is tensor(165.5724, device='cuda:3')
benign distance is  tensor(165.5724, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1780799925327301
distance x is tensor(163.3113, device='cuda:3')
benign distance is  tensor(163.3113, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7873178720474243
distance x is tensor(169.2618, device='cuda:3')
benign distance is  tensor(169.2618, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.22087152302265167
distance x is tensor(159.5853, device='cuda:3')
benign distance is  tensor(159.5853, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6522542238235474
distance x is tensor(155.2762, device='cuda:3')
benign distance is  tensor(155.2762, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9109338521957397
distance x is tensor(167.5985, device='cuda:3')
benign distance is  tensor(167.5985, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.38002732396125793
distance x is tensor(161.9165, device='cuda:3')
benign distance is  tensor(161.9165, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2505120635032654
distance x is tensor(158.1372, device='cuda:3')
benign distance is  tensor(158.1372, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4341443181037903
distance x is tensor(173.4348, device='cuda:3')
benign distance is  tensor(173.4348, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4394879937171936
distance x is tensor(171.6376, device='cuda:3')
benign distance is  tensor(171.6376, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.066084384918213
distance x is tensor(160.2676, device='cuda:3')
benign distance is  tensor(160.2676, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.22669772803783417
distance x is tensor(165.0157, device='cuda:3')
benign distance is  tensor(165.0157, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6102958917617798
distance x is tensor(188.8917, device='cuda:3')
benign distance is  tensor(188.8917, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3497185707092285
distance x is tensor(168.2775, device='cuda:3')
benign distance is  tensor(168.2775, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.06936747580766678
distance x is tensor(169.9174, device='cuda:3')
benign distance is  tensor(169.9174, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7691020965576172
distance x is tensor(167.9297, device='cuda:3')
benign distance is  tensor(167.9297, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4647749066352844
distance x is tensor(166.7676, device='cuda:3')
benign distance is  tensor(166.7676, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5793925523757935
distance x is tensor(167.0811, device='cuda:3')
benign distance is  tensor(167.0811, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.05047095566987991
distance x is tensor(171.9966, device='cuda:3')
benign distance is  tensor(171.9966, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1779520511627197
distance x is tensor(169.8897, device='cuda:3')
benign distance is  tensor(169.8897, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.06782614439725876
distance x is tensor(175.7340, device='cuda:3')
benign distance is  tensor(175.7340, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6167154312133789
distance x is tensor(169.5304, device='cuda:3')
benign distance is  tensor(169.5304, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.46073585748672485
distance x is tensor(172.3752, device='cuda:3')
benign distance is  tensor(172.3752, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8774399757385254
distance x is tensor(152.5157, device='cuda:3')
benign distance is  tensor(152.5157, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.27750593423843384
distance x is tensor(157.7934, device='cuda:3')
benign distance is  tensor(157.7934, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 26.435888290405273
mal_entropy is 0.09720811247825623
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([794.1990, 668.7565, 732.3340, 769.3054, 746.5963, 713.4151, 626.1428,
        715.5395, 463.1986, 463.1986, 463.1986, 463.1986, 463.1986, 463.1986,
        463.1986, 463.1986, 463.1986, 463.1986, 463.1986, 463.1986, 763.1398,
        781.9215, 756.1288, 772.8171, 809.8973, 730.2844, 800.3105, 749.5126],
       device='cuda:3')
sorted_norm is   tensor([463.1986, 463.1986, 463.1986, 463.1986, 463.1986, 463.1986, 463.1986,
        463.1986, 463.1986, 463.1986, 463.1986, 463.1986, 626.1428, 668.7565,
        713.4151, 715.5395, 730.2844, 732.3340, 746.5963, 749.5126, 756.1288,
        763.1398, 769.3054, 772.8171, 781.9215, 794.1990, 800.3105, 809.8973],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  6,  1,  5,  7, 25,  2,
         4, 27, 22, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 82.65% 

Test Accuracy: 81.67% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.395250141620636
distance x is tensor(170.6152, device='cuda:3')
benign distance is  tensor(170.6152, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46174001693725586
distance x is tensor(166.2818, device='cuda:3')
benign distance is  tensor(166.2818, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.72706139087677
distance x is tensor(155.0870, device='cuda:3')
benign distance is  tensor(155.0870, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.38366708159446716
distance x is tensor(179.8160, device='cuda:3')
benign distance is  tensor(179.8160, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4211251139640808
distance x is tensor(171.2356, device='cuda:3')
benign distance is  tensor(171.2356, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7964046001434326
distance x is tensor(182.7540, device='cuda:3')
benign distance is  tensor(182.7540, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.588334083557129
distance x is tensor(180.3319, device='cuda:3')
benign distance is  tensor(180.3319, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8647804260253906
distance x is tensor(177.9788, device='cuda:3')
benign distance is  tensor(177.9788, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6110854744911194
distance x is tensor(185.6574, device='cuda:3')
benign distance is  tensor(185.6574, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7101998329162598
distance x is tensor(189.8548, device='cuda:3')
benign distance is  tensor(189.8548, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.20063582062721252
distance x is tensor(184.1334, device='cuda:3')
benign distance is  tensor(184.1334, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.09325364977121353
distance x is tensor(220.0449, device='cuda:3')
benign distance is  tensor(220.0449, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29814037680625916
distance x is tensor(184.5034, device='cuda:3')
benign distance is  tensor(184.5034, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4187893271446228
distance x is tensor(178.5953, device='cuda:3')
benign distance is  tensor(178.5953, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2556613087654114
distance x is tensor(188.2910, device='cuda:3')
benign distance is  tensor(188.2910, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5464045405387878
distance x is tensor(183.6560, device='cuda:3')
benign distance is  tensor(183.6560, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal_loss is 42.567466735839844
mal_entropy is 0.12714925408363342
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([754.0125, 716.2392, 663.6165, 794.9957, 738.7389, 784.0640, 779.2748,
        789.0405, 462.7430, 462.7430, 462.7430, 462.7430, 462.7430, 462.7430,
        462.7430, 462.7430, 462.7430, 462.7430, 462.7430, 462.7430, 771.6550,
        778.8886, 733.6931, 741.2762, 785.9612, 761.1439, 751.1048, 799.1923],
       device='cuda:3')
sorted_norm is   tensor([462.7430, 462.7430, 462.7430, 462.7430, 462.7430, 462.7430, 462.7430,
        462.7430, 462.7430, 462.7430, 462.7430, 462.7430, 663.6165, 716.2392,
        733.6931, 738.7389, 741.2762, 751.1048, 754.0125, 761.1439, 771.6550,
        778.8886, 779.2748, 784.0640, 785.9612, 789.0405, 794.9957, 799.1923],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  2,  1, 22,  4, 23, 26,
         0, 25, 20, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 76.04% 

Test Accuracy: 75.14% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.40627557039260864
distance x is tensor(215.5704, device='cuda:3')
benign distance is  tensor(215.5704, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38549306988716125
distance x is tensor(204.3474, device='cuda:3')
benign distance is  tensor(204.3474, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33772945404052734
distance x is tensor(184.8481, device='cuda:3')
benign distance is  tensor(184.8481, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7730594873428345
distance x is tensor(182.5042, device='cuda:3')
benign distance is  tensor(182.5042, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8633763194084167
distance x is tensor(181.4718, device='cuda:3')
benign distance is  tensor(181.4718, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5932842493057251
distance x is tensor(207.0304, device='cuda:3')
benign distance is  tensor(207.0304, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4098467230796814
distance x is tensor(198.9100, device='cuda:3')
benign distance is  tensor(198.9100, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6441594362258911
distance x is tensor(196.0488, device='cuda:3')
benign distance is  tensor(196.0488, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1425429731607437
distance x is tensor(205.7316, device='cuda:3')
benign distance is  tensor(205.7316, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4214600920677185
distance x is tensor(204.8533, device='cuda:3')
benign distance is  tensor(204.8533, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3749238848686218
distance x is tensor(224.4292, device='cuda:3')
benign distance is  tensor(224.4292, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6226290464401245
distance x is tensor(183.4310, device='cuda:3')
benign distance is  tensor(183.4310, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8852062225341797
distance x is tensor(209.2249, device='cuda:3')
benign distance is  tensor(209.2249, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.20349541306495667
distance x is tensor(194.0489, device='cuda:3')
benign distance is  tensor(194.0489, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8002325296401978
distance x is tensor(206.7948, device='cuda:3')
benign distance is  tensor(206.7948, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4977432191371918
distance x is tensor(213.4823, device='cuda:3')
benign distance is  tensor(213.4823, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 54.140228271484375
mal_entropy is 0.12416132539510727
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([902.5300, 839.4378, 774.2028, 763.8738, 748.1440, 855.1477, 814.7186,
        823.9931, 462.9283, 462.9283, 462.9283, 462.9283, 462.9283, 462.9283,
        462.9283, 462.9283, 462.9283, 462.9283, 462.9283, 462.9283],
       device='cuda:3')
sorted_norm is   tensor([462.9283, 462.9283, 462.9283, 462.9283, 462.9283, 462.9283, 462.9283,
        462.9283, 462.9283, 462.9283, 462.9283, 462.9283, 748.1440, 763.8738,
        774.2028, 814.7186, 823.9931, 839.4378, 855.1477, 902.5300],
       device='cuda:3')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10,  4,  3,  2,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 44.69% 

Test Accuracy: 44.11% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.262495219707489
distance x is tensor(254.5188, device='cuda:3')
benign distance is  tensor(254.5188, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.35031184554100037
distance x is tensor(287.3031, device='cuda:3')
benign distance is  tensor(287.3031, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4629974961280823
distance x is tensor(265.0276, device='cuda:3')
benign distance is  tensor(265.0276, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9214805364608765
distance x is tensor(272.6886, device='cuda:3')
benign distance is  tensor(272.6886, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.07153338193893433
distance x is tensor(265.2306, device='cuda:3')
benign distance is  tensor(265.2306, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.24829068779945374
distance x is tensor(287.5104, device='cuda:3')
benign distance is  tensor(287.5104, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4041057527065277
distance x is tensor(238.9353, device='cuda:3')
benign distance is  tensor(238.9353, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6128929257392883
distance x is tensor(312.1153, device='cuda:3')
benign distance is  tensor(312.1153, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 120.80229187011719
mal_entropy is 0.08794442564249039
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1015.6707, 1133.0868, 1036.8130, 1078.2356, 1031.8821, 1127.5272,
         943.9540, 1220.6829,  463.1481,  463.1481,  463.1481,  463.1481,
         463.1481,  463.1481,  463.1481,  463.1481,  463.1481,  463.1481,
         463.1481,  463.1481,  932.6916,  991.3215,  951.2100, 1076.4562,
         937.2139,  970.9555,  998.5256,  993.1149,  947.0380,  906.9683,
         919.3218, 1002.9630,  932.1950,  937.3633,  934.0950,  924.8313,
         921.3964,  960.4917,  923.7817, 1061.5730,  933.6047,  900.1959,
         957.2344,  928.9001,  932.6637,  931.9633,  985.1239,  872.9092,
         945.5930,  891.0222,  934.6056,  955.6765], device='cuda:3')
sorted_norm is   tensor([ 463.1481,  463.1481,  463.1481,  463.1481,  463.1481,  463.1481,
         463.1481,  463.1481,  463.1481,  463.1481,  463.1481,  463.1481,
         872.9092,  891.0222,  900.1959,  906.9683,  919.3218,  921.3964,
         923.7817,  924.8313,  928.9001,  931.9633,  932.1950,  932.6637,
         932.6916,  933.6047,  934.0950,  934.6056,  937.2139,  937.3633,
         943.9540,  945.5930,  947.0380,  951.2100,  955.6765,  957.2344,
         960.4917,  970.9555,  985.1239,  991.3215,  993.1149,  998.5256,
        1002.9630, 1015.6707, 1031.8821, 1036.8130, 1061.5730, 1076.4562,
        1078.2356, 1127.5272, 1133.0868, 1220.6829], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 47, 49, 41, 29, 30, 36,
        38, 35, 43, 45, 32, 44, 20, 40, 34, 50, 24, 33,  6, 48, 28, 22, 51, 42,
        37, 25, 46, 21, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 87.46% 

Test Accuracy: 86.10% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7842354774475098
distance x is tensor(163.0087, device='cuda:3')
benign distance is  tensor(163.0087, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8816410303115845
distance x is tensor(150.5339, device='cuda:3')
benign distance is  tensor(150.5339, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2514200806617737
distance x is tensor(154.5016, device='cuda:3')
benign distance is  tensor(154.5016, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5349818468093872
distance x is tensor(169.9839, device='cuda:3')
benign distance is  tensor(169.9839, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8966601490974426
distance x is tensor(152.1661, device='cuda:3')
benign distance is  tensor(152.1661, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.17312411963939667
distance x is tensor(160.2535, device='cuda:3')
benign distance is  tensor(160.2535, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19236186146736145
distance x is tensor(151.4446, device='cuda:3')
benign distance is  tensor(151.4446, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6551439762115479
distance x is tensor(166.5036, device='cuda:3')
benign distance is  tensor(166.5036, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.598955512046814
distance x is tensor(161.9611, device='cuda:3')
benign distance is  tensor(161.9611, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7322783470153809
distance x is tensor(151.8564, device='cuda:3')
benign distance is  tensor(151.8564, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.13448166847229
distance x is tensor(148.3606, device='cuda:3')
benign distance is  tensor(148.3606, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8821876645088196
distance x is tensor(148.0157, device='cuda:3')
benign distance is  tensor(148.0157, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29476025700569153
distance x is tensor(156.6693, device='cuda:3')
benign distance is  tensor(156.6693, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.12662240862846375
distance x is tensor(159.2703, device='cuda:3')
benign distance is  tensor(159.2703, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6651557683944702
distance x is tensor(161.7040, device='cuda:3')
benign distance is  tensor(161.7040, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0280215740203857
distance x is tensor(165.5750, device='cuda:3')
benign distance is  tensor(165.5750, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.37967318296432495
distance x is tensor(150.5120, device='cuda:3')
benign distance is  tensor(150.5120, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5268577337265015
distance x is tensor(166.3622, device='cuda:3')
benign distance is  tensor(166.3622, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.11558923870325089
distance x is tensor(153.5174, device='cuda:3')
benign distance is  tensor(153.5174, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2571238875389099
distance x is tensor(165.6342, device='cuda:3')
benign distance is  tensor(165.6342, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.42818060517311096
distance x is tensor(155.0765, device='cuda:3')
benign distance is  tensor(155.0765, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7324448227882385
distance x is tensor(142.6545, device='cuda:3')
benign distance is  tensor(142.6545, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.13465823233127594
distance x is tensor(182.5681, device='cuda:3')
benign distance is  tensor(182.5681, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.1290116012096405
distance x is tensor(152.3260, device='cuda:3')
benign distance is  tensor(152.3260, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2657976746559143
distance x is tensor(164.4318, device='cuda:3')
benign distance is  tensor(164.4318, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6045647263526917
distance x is tensor(155.2108, device='cuda:3')
benign distance is  tensor(155.2108, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.26212233304977417
distance x is tensor(160.2200, device='cuda:3')
benign distance is  tensor(160.2200, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3578186631202698
distance x is tensor(157.8988, device='cuda:3')
benign distance is  tensor(157.8988, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6873658299446106
distance x is tensor(163.2163, device='cuda:3')
benign distance is  tensor(163.2163, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.37719789147377014
distance x is tensor(154.0896, device='cuda:3')
benign distance is  tensor(154.0896, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5209968686103821
distance x is tensor(155.5036, device='cuda:3')
benign distance is  tensor(155.5036, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.13571853935718536
distance x is tensor(154.7372, device='cuda:3')
benign distance is  tensor(154.7372, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3248000741004944
distance x is tensor(149.6116, device='cuda:3')
benign distance is  tensor(149.6116, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.23215365409851074
distance x is tensor(148.1614, device='cuda:3')
benign distance is  tensor(148.1614, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.12833139300346375
distance x is tensor(161.9404, device='cuda:3')
benign distance is  tensor(161.9404, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9060860872268677
distance x is tensor(173.9975, device='cuda:3')
benign distance is  tensor(173.9975, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.15427787601947784
distance x is tensor(161.8859, device='cuda:3')
benign distance is  tensor(161.8859, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.382406622171402
distance x is tensor(166.3168, device='cuda:3')
benign distance is  tensor(166.3168, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.40823274850845337
distance x is tensor(167.0069, device='cuda:3')
benign distance is  tensor(167.0069, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.44609737396240234
distance x is tensor(152.9559, device='cuda:3')
benign distance is  tensor(152.9559, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal_loss is 4.274193286895752
mal_entropy is 0.24039478600025177
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([719.5724, 677.7852, 707.6448, 753.4058, 685.0272, 715.2032, 682.7354,
        740.7858, 444.4235, 444.4235, 444.4235, 444.4235, 444.4235, 444.4235,
        444.4235, 444.4235, 444.4235, 444.4235, 444.4235, 444.4235, 766.4451,
        796.8147, 800.2437, 812.8631, 793.0046, 809.5928, 729.8280, 750.1450],
       device='cuda:3')
sorted_norm is   tensor([444.4235, 444.4235, 444.4235, 444.4235, 444.4235, 444.4235, 444.4235,
        444.4235, 444.4235, 444.4235, 444.4235, 444.4235, 677.7852, 682.7354,
        685.0272, 707.6448, 715.2032, 719.5724, 729.8280, 740.7858, 750.1450,
        753.4058, 766.4451, 793.0046, 796.8147, 800.2437, 809.5928, 812.8631],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  1,  6,  4,  2,  5,  0,
        26,  7, 27,  3], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 86.48% 

Test Accuracy: 84.77% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3701000511646271
distance x is tensor(171.3172, device='cuda:3')
benign distance is  tensor(171.3172, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9503032565116882
distance x is tensor(171.0945, device='cuda:3')
benign distance is  tensor(171.0945, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3228853940963745
distance x is tensor(177.4505, device='cuda:3')
benign distance is  tensor(177.4505, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8296197056770325
distance x is tensor(172.6458, device='cuda:3')
benign distance is  tensor(172.6458, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5109248161315918
distance x is tensor(157.8898, device='cuda:3')
benign distance is  tensor(157.8898, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8862134218215942
distance x is tensor(172.9998, device='cuda:3')
benign distance is  tensor(172.9998, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4665248394012451
distance x is tensor(161.6240, device='cuda:3')
benign distance is  tensor(161.6240, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40257006883621216
distance x is tensor(179.4476, device='cuda:3')
benign distance is  tensor(179.4476, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4944930076599121
distance x is tensor(185.2243, device='cuda:3')
benign distance is  tensor(185.2243, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.32053571939468384
distance x is tensor(180.2939, device='cuda:3')
benign distance is  tensor(180.2939, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2929705083370209
distance x is tensor(171.8298, device='cuda:3')
benign distance is  tensor(171.8298, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.24874842166900635
distance x is tensor(168.1327, device='cuda:3')
benign distance is  tensor(168.1327, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2454870641231537
distance x is tensor(173.1982, device='cuda:3')
benign distance is  tensor(173.1982, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.25816506147384644
distance x is tensor(148.3417, device='cuda:3')
benign distance is  tensor(148.3417, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.49720850586891174
distance x is tensor(176.0285, device='cuda:3')
benign distance is  tensor(176.0285, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5865617394447327
distance x is tensor(171.8051, device='cuda:3')
benign distance is  tensor(171.8051, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal_loss is 7.773066520690918
mal_entropy is 0.23047171533107758
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([764.9525, 765.6008, 789.7916, 777.3411, 695.3088, 755.7127, 706.1494,
        795.1216, 451.5000, 451.5000, 451.5000, 451.5000, 451.5000, 451.5000,
        451.5000, 451.5000, 451.5000, 451.5000, 451.5000, 451.5000, 761.3297,
        734.7344, 699.4930, 720.3287, 736.4272, 757.4440, 735.8228, 775.2513],
       device='cuda:3')
sorted_norm is   tensor([451.5000, 451.5000, 451.5000, 451.5000, 451.5000, 451.5000, 451.5000,
        451.5000, 451.5000, 451.5000, 451.5000, 451.5000, 695.3088, 699.4930,
        706.1494, 720.3287, 734.7344, 735.8228, 736.4272, 755.7127, 757.4440,
        761.3297, 764.9525, 765.6008, 775.2513, 777.3411, 789.7916, 795.1216],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4, 22,  6, 23, 21, 26,
        24,  5, 25, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 84.98% 

Test Accuracy: 83.55% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7701432704925537
distance x is tensor(184.5421, device='cuda:3')
benign distance is  tensor(184.5421, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46243715286254883
distance x is tensor(186.0833, device='cuda:3')
benign distance is  tensor(186.0833, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13155904412269592
distance x is tensor(170.2122, device='cuda:3')
benign distance is  tensor(170.2122, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3158707916736603
distance x is tensor(183.4690, device='cuda:3')
benign distance is  tensor(183.4690, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.669758141040802
distance x is tensor(167.4807, device='cuda:3')
benign distance is  tensor(167.4807, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7426208853721619
distance x is tensor(183.3904, device='cuda:3')
benign distance is  tensor(183.3904, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2954484522342682
distance x is tensor(183.1336, device='cuda:3')
benign distance is  tensor(183.1336, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3076353669166565
distance x is tensor(186.8743, device='cuda:3')
benign distance is  tensor(186.8743, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.44429081678390503
distance x is tensor(182.9817, device='cuda:3')
benign distance is  tensor(182.9817, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9573451280593872
distance x is tensor(206.4288, device='cuda:3')
benign distance is  tensor(206.4288, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0771766901016235
distance x is tensor(188.0658, device='cuda:3')
benign distance is  tensor(188.0658, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.42119139432907104
distance x is tensor(191.9234, device='cuda:3')
benign distance is  tensor(191.9234, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.15813741087913513
distance x is tensor(169.1548, device='cuda:3')
benign distance is  tensor(169.1548, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.25624215602874756
distance x is tensor(170.9629, device='cuda:3')
benign distance is  tensor(170.9629, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.19142906367778778
distance x is tensor(175.8603, device='cuda:3')
benign distance is  tensor(175.8603, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7437246441841125
distance x is tensor(190.7705, device='cuda:3')
benign distance is  tensor(190.7705, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 22.114028930664062
mal_entropy is 0.23083172738552094
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([805.6923, 814.7989, 757.2343, 825.0281, 726.6087, 793.1977, 823.8532,
        819.9601, 454.4073, 454.4073, 454.4073, 454.4073, 454.4073, 454.4073,
        454.4073, 454.4073, 454.4073, 454.4073, 454.4073, 454.4073, 745.7625,
        806.8920, 771.2623, 818.2785, 751.7193, 727.0014, 855.9087, 765.2613],
       device='cuda:3')
sorted_norm is   tensor([454.4073, 454.4073, 454.4073, 454.4073, 454.4073, 454.4073, 454.4073,
        454.4073, 454.4073, 454.4073, 454.4073, 454.4073, 726.6087, 727.0014,
        745.7625, 751.7193, 757.2343, 765.2613, 771.2623, 793.1977, 805.6923,
        806.8920, 814.7989, 818.2785, 819.9601, 823.8532, 825.0281, 855.9087],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4, 25, 20, 24,  2, 27,
        22,  5,  0, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 82.71% 

Test Accuracy: 81.00% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4579429030418396
distance x is tensor(177.0650, device='cuda:3')
benign distance is  tensor(177.0650, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4977208077907562
distance x is tensor(188.1176, device='cuda:3')
benign distance is  tensor(188.1176, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2755255103111267
distance x is tensor(191.7775, device='cuda:3')
benign distance is  tensor(191.7775, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8021753430366516
distance x is tensor(185.5442, device='cuda:3')
benign distance is  tensor(185.5442, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.884974479675293
distance x is tensor(189.8204, device='cuda:3')
benign distance is  tensor(189.8204, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7772110104560852
distance x is tensor(207.2426, device='cuda:3')
benign distance is  tensor(207.2426, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6240349411964417
distance x is tensor(173.8888, device='cuda:3')
benign distance is  tensor(173.8888, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49481090903282166
distance x is tensor(210.5737, device='cuda:3')
benign distance is  tensor(210.5737, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.25536447763442993
distance x is tensor(180.3735, device='cuda:3')
benign distance is  tensor(180.3735, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8985193967819214
distance x is tensor(198.1475, device='cuda:3')
benign distance is  tensor(198.1475, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5018645524978638
distance x is tensor(183.1643, device='cuda:3')
benign distance is  tensor(183.1643, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2719796895980835
distance x is tensor(202.7364, device='cuda:3')
benign distance is  tensor(202.7364, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5811286568641663
distance x is tensor(187.3162, device='cuda:3')
benign distance is  tensor(187.3162, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5385245084762573
distance x is tensor(184.2872, device='cuda:3')
benign distance is  tensor(184.2872, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6123867034912109
distance x is tensor(197.0916, device='cuda:3')
benign distance is  tensor(197.0916, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.37390756607055664
distance x is tensor(187.8281, device='cuda:3')
benign distance is  tensor(187.8281, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 31.90364646911621
mal_entropy is 0.0948600023984909
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([782.9409, 820.0814, 846.2724, 809.4040, 808.6683, 902.9044, 766.2065,
        880.1590, 457.3459, 457.3459, 457.3459, 457.3459, 457.3459, 457.3459,
        457.3459, 457.3459, 457.3459, 457.3459, 457.3459, 457.3459, 833.6149,
        780.6362, 817.1776, 803.2524, 827.6155, 783.6342, 796.4184, 797.3274,
        830.9262, 897.1331, 831.7903, 881.2614, 771.0190, 768.5621, 790.9965,
        881.0573], device='cuda:3')
sorted_norm is   tensor([457.3459, 457.3459, 457.3459, 457.3459, 457.3459, 457.3459, 457.3459,
        457.3459, 457.3459, 457.3459, 457.3459, 457.3459, 766.2065, 768.5621,
        771.0190, 780.6362, 782.9409, 783.6342, 790.9965, 796.4184, 797.3274,
        803.2524, 808.6683, 809.4040, 817.1776, 820.0814, 827.6155, 830.9262,
        831.7903, 833.6149, 846.2724, 880.1590, 881.0573, 881.2614, 897.1331,
        902.9044], device='cuda:3')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10,  6, 33, 32, 21,  0, 25,
        34, 26, 27, 23,  4,  3, 22,  1, 24, 28], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 86.37% 

Test Accuracy: 84.99% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4760708808898926
distance x is tensor(175.1640, device='cuda:3')
benign distance is  tensor(175.1640, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45223814249038696
distance x is tensor(175.5582, device='cuda:3')
benign distance is  tensor(175.5582, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4957651197910309
distance x is tensor(179.3755, device='cuda:3')
benign distance is  tensor(179.3755, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.14416168630123138
distance x is tensor(163.5069, device='cuda:3')
benign distance is  tensor(163.5069, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7460752725601196
distance x is tensor(201.9053, device='cuda:3')
benign distance is  tensor(201.9053, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9269685745239258
distance x is tensor(182.9621, device='cuda:3')
benign distance is  tensor(182.9621, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6313124299049377
distance x is tensor(169.3699, device='cuda:3')
benign distance is  tensor(169.3699, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5500066876411438
distance x is tensor(181.3981, device='cuda:3')
benign distance is  tensor(181.3981, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.486154705286026
distance x is tensor(168.4666, device='cuda:3')
benign distance is  tensor(168.4666, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6285789012908936
distance x is tensor(182.7990, device='cuda:3')
benign distance is  tensor(182.7990, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8370248675346375
distance x is tensor(178.0393, device='cuda:3')
benign distance is  tensor(178.0393, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.47785815596580505
distance x is tensor(167.4984, device='cuda:3')
benign distance is  tensor(167.4984, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7530874013900757
distance x is tensor(184.2742, device='cuda:3')
benign distance is  tensor(184.2742, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.33157768845558167
distance x is tensor(184.5001, device='cuda:3')
benign distance is  tensor(184.5001, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.27411380410194397
distance x is tensor(170.5085, device='cuda:3')
benign distance is  tensor(170.5085, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3780917525291443
distance x is tensor(173.3810, device='cuda:3')
benign distance is  tensor(173.3810, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5096137523651123
distance x is tensor(184.0891, device='cuda:3')
benign distance is  tensor(184.0891, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.35674339532852173
distance x is tensor(175.5721, device='cuda:3')
benign distance is  tensor(175.5721, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3900449573993683
distance x is tensor(174.1839, device='cuda:3')
benign distance is  tensor(174.1839, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8850029706954956
distance x is tensor(190.0323, device='cuda:3')
benign distance is  tensor(190.0323, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8899058103561401
distance x is tensor(167.0182, device='cuda:3')
benign distance is  tensor(167.0182, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7366026043891907
distance x is tensor(167.5283, device='cuda:3')
benign distance is  tensor(167.5283, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3481697738170624
distance x is tensor(182.6994, device='cuda:3')
benign distance is  tensor(182.6994, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4701153635978699
distance x is tensor(180.0561, device='cuda:3')
benign distance is  tensor(180.0561, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal_loss is 17.130199432373047
mal_entropy is 0.17663078010082245
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([751.0302, 786.8187, 774.0678, 715.7548, 870.8932, 796.3117, 757.4449,
        790.4976, 456.1121, 456.1121, 456.1121, 456.1121, 456.1121, 456.1121,
        456.1121, 456.1121, 456.1121, 456.1121, 456.1121, 456.1121],
       device='cuda:3')
sorted_norm is   tensor([456.1121, 456.1121, 456.1121, 456.1121, 456.1121, 456.1121, 456.1121,
        456.1121, 456.1121, 456.1121, 456.1121, 456.1121, 715.7548, 751.0302,
        757.4449, 774.0678, 786.8187, 790.4976, 796.3117, 870.8932],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  3,  0,  6,  2],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 62.33% 

Test Accuracy: 61.65% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36291399598121643
distance x is tensor(234.2769, device='cuda:3')
benign distance is  tensor(234.2769, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5727425813674927
distance x is tensor(253.2726, device='cuda:3')
benign distance is  tensor(253.2726, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27563247084617615
distance x is tensor(242.0739, device='cuda:3')
benign distance is  tensor(242.0739, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7756806015968323
distance x is tensor(248.6516, device='cuda:3')
benign distance is  tensor(248.6516, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.24140200018882751
distance x is tensor(218.0191, device='cuda:3')
benign distance is  tensor(218.0191, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8230890035629272
distance x is tensor(225.2927, device='cuda:3')
benign distance is  tensor(225.2927, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.791049599647522
distance x is tensor(244.0085, device='cuda:3')
benign distance is  tensor(244.0085, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7197434306144714
distance x is tensor(239.8478, device='cuda:3')
benign distance is  tensor(239.8478, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 76.54608154296875
mal_entropy is 0.0009007807238958776
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 933.2592, 1025.5200,  963.7377, 1002.8040,  884.4844,  899.4117,
         990.5076,  989.2352,  461.3285,  461.3286,  461.3285,  461.3286,
         461.3285,  461.3286,  461.3285,  461.3286,  461.3285,  461.3286,
         461.3285,  461.3286,  888.3415,  877.6176,  931.0626,  980.6710,
         926.3821,  944.8425,  959.9194,  904.3958,  980.5370,  962.8283,
         938.9727,  918.4725,  943.8486,  847.0266,  933.3240,  932.2451,
         880.6361,  918.0674,  911.6453,  983.3578,  895.6543,  892.2812,
         961.3934,  895.3891,  843.4813,  893.1243,  857.3486,  830.7024,
         876.0079,  880.1419,  815.6658,  871.1130], device='cuda:3')
sorted_norm is   tensor([ 461.3285,  461.3285,  461.3285,  461.3285,  461.3285,  461.3285,
         461.3286,  461.3286,  461.3286,  461.3286,  461.3286,  461.3286,
         815.6658,  830.7024,  843.4813,  847.0266,  857.3486,  871.1130,
         876.0079,  877.6176,  880.1419,  880.6361,  884.4844,  888.3415,
         892.2812,  893.1243,  895.3891,  895.6543,  899.4117,  904.3958,
         911.6453,  918.0674,  918.4725,  926.3821,  931.0626,  932.2451,
         933.2592,  933.3240,  938.9727,  943.8486,  944.8425,  959.9194,
         961.3934,  962.8283,  963.7377,  980.5370,  980.6710,  983.3578,
         989.2352,  990.5076, 1002.8040, 1025.5200], device='cuda:3')
used idx is  tensor([10,  8, 18, 16, 12, 14, 17, 19, 15, 13,  9, 11, 50, 47, 44, 33, 46, 51,
        48, 21, 49, 36,  4, 20, 41, 45, 43, 40,  5, 27, 38, 37, 31, 24, 22, 35,
         0, 34, 30, 32, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 87.48% 

Test Accuracy: 86.31% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.938238799571991
distance x is tensor(165.4769, device='cuda:3')
benign distance is  tensor(165.4769, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5778709650039673
distance x is tensor(169.8821, device='cuda:3')
benign distance is  tensor(169.8821, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.42424994707107544
distance x is tensor(146.2396, device='cuda:3')
benign distance is  tensor(146.2396, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4639883041381836
distance x is tensor(172.4572, device='cuda:3')
benign distance is  tensor(172.4572, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7779218554496765
distance x is tensor(173.7984, device='cuda:3')
benign distance is  tensor(173.7984, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6995068788528442
distance x is tensor(146.2222, device='cuda:3')
benign distance is  tensor(146.2222, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8262728452682495
distance x is tensor(153.9366, device='cuda:3')
benign distance is  tensor(153.9366, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6765742301940918
distance x is tensor(162.8578, device='cuda:3')
benign distance is  tensor(162.8578, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16080757975578308
distance x is tensor(162.7183, device='cuda:3')
benign distance is  tensor(162.7183, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3353683352470398
distance x is tensor(155.7005, device='cuda:3')
benign distance is  tensor(155.7005, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8431928753852844
distance x is tensor(167.6550, device='cuda:3')
benign distance is  tensor(167.6550, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5123612284660339
distance x is tensor(156.3486, device='cuda:3')
benign distance is  tensor(156.3486, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49063634872436523
distance x is tensor(162.8787, device='cuda:3')
benign distance is  tensor(162.8787, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.32043755054473877
distance x is tensor(158.4327, device='cuda:3')
benign distance is  tensor(158.4327, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8911093473434448
distance x is tensor(152.3159, device='cuda:3')
benign distance is  tensor(152.3159, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4350402355194092
distance x is tensor(154.1780, device='cuda:3')
benign distance is  tensor(154.1780, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.40253591537475586
distance x is tensor(144.3797, device='cuda:3')
benign distance is  tensor(144.3797, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5385012626647949
distance x is tensor(175.1833, device='cuda:3')
benign distance is  tensor(175.1833, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.33024653792381287
distance x is tensor(151.0562, device='cuda:3')
benign distance is  tensor(151.0562, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.11501560360193253
distance x is tensor(164.8365, device='cuda:3')
benign distance is  tensor(164.8365, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5075744390487671
distance x is tensor(153.7826, device='cuda:3')
benign distance is  tensor(153.7826, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.473808616399765
distance x is tensor(159.1778, device='cuda:3')
benign distance is  tensor(159.1778, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.28994494676589966
distance x is tensor(159.4828, device='cuda:3')
benign distance is  tensor(159.4828, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3368721008300781
distance x is tensor(178.7319, device='cuda:3')
benign distance is  tensor(178.7319, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3232334852218628
distance x is tensor(167.2114, device='cuda:3')
benign distance is  tensor(167.2114, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.41663265228271484
distance x is tensor(163.9194, device='cuda:3')
benign distance is  tensor(163.9194, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.37981799244880676
distance x is tensor(172.3122, device='cuda:3')
benign distance is  tensor(172.3122, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2336784154176712
distance x is tensor(170.1156, device='cuda:3')
benign distance is  tensor(170.1156, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7120496034622192
distance x is tensor(157.4892, device='cuda:3')
benign distance is  tensor(157.4892, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2810811400413513
distance x is tensor(161.2510, device='cuda:3')
benign distance is  tensor(161.2510, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5465927720069885
distance x is tensor(156.3824, device='cuda:3')
benign distance is  tensor(156.3824, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4173959195613861
distance x is tensor(157.2573, device='cuda:3')
benign distance is  tensor(157.2573, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3552468717098236
distance x is tensor(160.3674, device='cuda:3')
benign distance is  tensor(160.3674, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.34822842478752136
distance x is tensor(169.3108, device='cuda:3')
benign distance is  tensor(169.3108, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.4678928852081299
distance x is tensor(149.9640, device='cuda:3')
benign distance is  tensor(149.9640, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0846164226531982
distance x is tensor(165.5620, device='cuda:3')
benign distance is  tensor(165.5620, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3728373646736145
distance x is tensor(167.1000, device='cuda:3')
benign distance is  tensor(167.1000, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3802657127380371
distance x is tensor(156.5294, device='cuda:3')
benign distance is  tensor(156.5294, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0063527822494507
distance x is tensor(160.0120, device='cuda:3')
benign distance is  tensor(160.0120, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5972707271575928
distance x is tensor(156.1421, device='cuda:3')
benign distance is  tensor(156.1421, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.6000000005
mal_loss is 2.361872673034668
mal_entropy is 0.39627760648727417
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([730.5185, 749.9322, 639.9656, 743.0903, 740.7426, 648.7449, 679.7864,
        723.6592, 451.3476, 451.3475, 451.3476, 451.3475, 451.3476, 451.3475,
        451.3476, 451.3475, 451.3476, 451.3475, 451.3476, 451.3475],
       device='cuda:3')
sorted_norm is   tensor([451.3475, 451.3475, 451.3475, 451.3475, 451.3475, 451.3475, 451.3476,
        451.3476, 451.3476, 451.3476, 451.3476, 451.3476, 639.9656, 648.7449,
        679.7864, 723.6592, 730.5185, 740.7426, 743.0903, 749.9322],
       device='cuda:3')
used idx is  tensor([19, 17, 13, 15, 11,  9, 16, 18, 14, 12,  8, 10,  2,  5,  6,  7],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 82.78% 

Test Accuracy: 81.36% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5537910461425781
distance x is tensor(198.5843, device='cuda:3')
benign distance is  tensor(198.5843, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.08908116072416306
distance x is tensor(203.1470, device='cuda:3')
benign distance is  tensor(203.1470, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6154143810272217
distance x is tensor(194.5828, device='cuda:3')
benign distance is  tensor(194.5828, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4621093273162842
distance x is tensor(199.4051, device='cuda:3')
benign distance is  tensor(199.4051, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8561557531356812
distance x is tensor(190.1564, device='cuda:3')
benign distance is  tensor(190.1564, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6833869814872742
distance x is tensor(215.6765, device='cuda:3')
benign distance is  tensor(215.6765, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.276856005191803
distance x is tensor(181.2913, device='cuda:3')
benign distance is  tensor(181.2913, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48541101813316345
distance x is tensor(198.3988, device='cuda:3')
benign distance is  tensor(198.3988, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 33.85669708251953
mal_entropy is 0.1590377390384674
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([850.9043, 873.8675, 831.2177, 864.6826, 834.3155, 905.0337, 776.1213,
        870.7159, 460.1489, 460.1489, 460.1489, 460.1489, 460.1489, 460.1489,
        460.1489, 460.1489, 460.1489, 460.1489, 460.1489, 460.1489, 890.7267,
        864.2464, 868.2888, 892.7820, 827.4292, 847.2137, 888.8704, 890.1117,
        811.7973, 789.7419, 832.3260, 799.7037, 817.0667, 789.6918, 766.8123,
        781.7964], device='cuda:3')
sorted_norm is   tensor([460.1489, 460.1489, 460.1489, 460.1489, 460.1489, 460.1489, 460.1489,
        460.1489, 460.1489, 460.1489, 460.1489, 460.1489, 766.8123, 776.1213,
        781.7964, 789.6918, 789.7419, 799.7037, 811.7973, 817.0667, 827.4292,
        831.2177, 832.3260, 834.3155, 847.2137, 850.9043, 864.2464, 864.6826,
        868.2888, 870.7159, 873.8675, 888.8704, 890.1117, 890.7267, 892.7820,
        905.0337], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 34,  6, 35, 33, 29, 31,
        28, 32, 24,  2, 30,  4, 25,  0, 21,  3], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 86.07% 

Test Accuracy: 84.63% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5019365549087524
distance x is tensor(178.7071, device='cuda:3')
benign distance is  tensor(178.7071, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8035259246826172
distance x is tensor(188.4002, device='cuda:3')
benign distance is  tensor(188.4002, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24470433592796326
distance x is tensor(172.4388, device='cuda:3')
benign distance is  tensor(172.4388, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1183589696884155
distance x is tensor(179.0224, device='cuda:3')
benign distance is  tensor(179.0224, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33084189891815186
distance x is tensor(190.2902, device='cuda:3')
benign distance is  tensor(190.2902, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7731974720954895
distance x is tensor(172.2829, device='cuda:3')
benign distance is  tensor(172.2829, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7024867534637451
distance x is tensor(171.2429, device='cuda:3')
benign distance is  tensor(171.2429, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24124126136302948
distance x is tensor(185.9012, device='cuda:3')
benign distance is  tensor(185.9012, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.47096914052963257
distance x is tensor(178.7505, device='cuda:3')
benign distance is  tensor(178.7505, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7664048075675964
distance x is tensor(168.5831, device='cuda:3')
benign distance is  tensor(168.5831, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5802842378616333
distance x is tensor(177.3700, device='cuda:3')
benign distance is  tensor(177.3700, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6113048791885376
distance x is tensor(190.4270, device='cuda:3')
benign distance is  tensor(190.4270, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6665996313095093
distance x is tensor(186.8686, device='cuda:3')
benign distance is  tensor(186.8686, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4606741964817047
distance x is tensor(172.5507, device='cuda:3')
benign distance is  tensor(172.5507, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.742422878742218
distance x is tensor(162.2125, device='cuda:3')
benign distance is  tensor(162.2125, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8725811243057251
distance x is tensor(207.1930, device='cuda:3')
benign distance is  tensor(207.1930, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17354941368103027
distance x is tensor(169.1224, device='cuda:3')
benign distance is  tensor(169.1224, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.43149542808532715
distance x is tensor(188.6503, device='cuda:3')
benign distance is  tensor(188.6503, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.784225583076477
distance x is tensor(182.9186, device='cuda:3')
benign distance is  tensor(182.9186, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.35875025391578674
distance x is tensor(177.0501, device='cuda:3')
benign distance is  tensor(177.0501, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.054870367050171
distance x is tensor(182.9099, device='cuda:3')
benign distance is  tensor(182.9099, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4816921651363373
distance x is tensor(184.4905, device='cuda:3')
benign distance is  tensor(184.4905, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3433261811733246
distance x is tensor(179.8773, device='cuda:3')
benign distance is  tensor(179.8773, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3119125962257385
distance x is tensor(180.5041, device='cuda:3')
benign distance is  tensor(180.5041, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 24.029722213745117
mal_entropy is 0.10518065840005875
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([758.7133, 816.2255, 745.2100, 784.4897, 808.0180, 741.7540, 744.7690,
        799.8334, 461.3159, 461.3159, 461.3159, 461.3159, 461.3159, 461.3159,
        461.3159, 461.3159, 461.3159, 461.3159, 461.3159, 461.3159, 712.6902,
        833.9384, 754.8333, 798.6644, 756.1670, 764.5133, 774.7831, 841.6531],
       device='cuda:3')
sorted_norm is   tensor([461.3159, 461.3159, 461.3159, 461.3159, 461.3159, 461.3159, 461.3159,
        461.3159, 461.3159, 461.3159, 461.3159, 461.3159, 712.6902, 741.7540,
        744.7690, 745.2100, 754.8333, 756.1670, 758.7133, 764.5133, 774.7831,
        784.4897, 798.6644, 799.8334, 808.0180, 816.2255, 833.9384, 841.6531],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 20,  5,  6,  2, 22, 24,
         0, 25, 26,  3], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 84.26% 

Test Accuracy: 82.76% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49167871475219727
distance x is tensor(189.0635, device='cuda:3')
benign distance is  tensor(189.0635, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9946976900100708
distance x is tensor(195.2370, device='cuda:3')
benign distance is  tensor(195.2370, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7900551557540894
distance x is tensor(177.6670, device='cuda:3')
benign distance is  tensor(177.6670, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8445981740951538
distance x is tensor(203.1930, device='cuda:3')
benign distance is  tensor(203.1930, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5277674794197083
distance x is tensor(189.5462, device='cuda:3')
benign distance is  tensor(189.5462, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8173313140869141
distance x is tensor(187.0521, device='cuda:3')
benign distance is  tensor(187.0521, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7218571901321411
distance x is tensor(165.1969, device='cuda:3')
benign distance is  tensor(165.1969, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.18670353293418884
distance x is tensor(200.0454, device='cuda:3')
benign distance is  tensor(200.0454, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4082454741001129
distance x is tensor(180.7209, device='cuda:3')
benign distance is  tensor(180.7209, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7781343460083008
distance x is tensor(199.4963, device='cuda:3')
benign distance is  tensor(199.4963, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.37144017219543457
distance x is tensor(207.2971, device='cuda:3')
benign distance is  tensor(207.2971, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2888238728046417
distance x is tensor(184.8798, device='cuda:3')
benign distance is  tensor(184.8798, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.34963324666023254
distance x is tensor(189.2493, device='cuda:3')
benign distance is  tensor(189.2493, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4704693853855133
distance x is tensor(194.9276, device='cuda:3')
benign distance is  tensor(194.9276, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2134933471679688
distance x is tensor(195.2522, device='cuda:3')
benign distance is  tensor(195.2522, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5856855511665344
distance x is tensor(187.0854, device='cuda:3')
benign distance is  tensor(187.0854, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal_loss is 42.18131637573242
mal_entropy is 0.2075817584991455
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([819.4698, 831.4729, 755.5178, 870.9718, 800.7126, 797.3372, 697.5301,
        856.0012, 460.9592, 460.9592, 460.9592, 460.9592, 460.9592, 460.9592,
        460.9592, 460.9592, 460.9592, 460.9592, 460.9592, 460.9592, 820.0351,
        766.0981, 778.9808, 845.1482, 834.9460, 770.8998, 743.0211, 897.9438],
       device='cuda:3')
sorted_norm is   tensor([460.9592, 460.9592, 460.9592, 460.9592, 460.9592, 460.9592, 460.9592,
        460.9592, 460.9592, 460.9592, 460.9592, 460.9592, 697.5301, 743.0211,
        755.5178, 766.0981, 770.8998, 778.9808, 797.3372, 800.7126, 819.4698,
        820.0351, 831.4729, 834.9460, 845.1482, 856.0012, 870.9718, 897.9438],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6, 26,  2, 21, 25, 22,
         5,  4,  0, 20], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 82.92% 

Test Accuracy: 81.43% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6619439125061035
distance x is tensor(190.4372, device='cuda:3')
benign distance is  tensor(190.4372, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6987305283546448
distance x is tensor(199.7130, device='cuda:3')
benign distance is  tensor(199.7130, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5320921540260315
distance x is tensor(203.3947, device='cuda:3')
benign distance is  tensor(203.3947, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4397784173488617
distance x is tensor(191.4813, device='cuda:3')
benign distance is  tensor(191.4813, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5473154783248901
distance x is tensor(214.2786, device='cuda:3')
benign distance is  tensor(214.2786, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0454193353652954
distance x is tensor(199.2156, device='cuda:3')
benign distance is  tensor(199.2156, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3140416145324707
distance x is tensor(189.9751, device='cuda:3')
benign distance is  tensor(189.9751, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.42029041051864624
distance x is tensor(210.7533, device='cuda:3')
benign distance is  tensor(210.7533, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4150018095970154
distance x is tensor(185.8480, device='cuda:3')
benign distance is  tensor(185.8480, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7517800331115723
distance x is tensor(186.4652, device='cuda:3')
benign distance is  tensor(186.4652, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4746955931186676
distance x is tensor(213.4195, device='cuda:3')
benign distance is  tensor(213.4195, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5607715845108032
distance x is tensor(208.5239, device='cuda:3')
benign distance is  tensor(208.5239, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5186378955841064
distance x is tensor(196.4519, device='cuda:3')
benign distance is  tensor(196.4519, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1512659341096878
distance x is tensor(219.7608, device='cuda:3')
benign distance is  tensor(219.7608, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4919946789741516
distance x is tensor(174.5563, device='cuda:3')
benign distance is  tensor(174.5563, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.19016575813293457
distance x is tensor(195.8134, device='cuda:3')
benign distance is  tensor(195.8134, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 46.429603576660156
mal_entropy is 0.08605778962373734
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([816.6751, 835.7827, 863.0534, 777.8745, 892.7346, 855.5945, 787.9253,
        886.5959, 461.2687, 461.2687, 461.2687, 461.2687, 461.2687, 461.2687,
        461.2687, 461.2687, 461.2687, 461.2687, 461.2687, 461.2687, 891.3643,
        889.5076, 906.7853, 894.3627, 845.6388, 849.5035, 839.2481, 854.0217],
       device='cuda:3')
sorted_norm is   tensor([461.2687, 461.2687, 461.2687, 461.2687, 461.2687, 461.2687, 461.2687,
        461.2687, 461.2687, 461.2687, 461.2687, 461.2687, 777.8745, 787.9253,
        816.6751, 835.7827, 839.2481, 845.6388, 849.5035, 854.0217, 855.5945,
        863.0534, 886.5959, 889.5076, 891.3643, 892.7346, 894.3627, 906.7853],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  3,  6,  0,  1, 26, 24,
        25, 27,  5,  2], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 83.89% 

Test Accuracy: 82.56% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5624896883964539
distance x is tensor(189.9532, device='cuda:3')
benign distance is  tensor(189.9532, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2963705360889435
distance x is tensor(182.8824, device='cuda:3')
benign distance is  tensor(182.8824, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4126731753349304
distance x is tensor(189.7731, device='cuda:3')
benign distance is  tensor(189.7731, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5648304224014282
distance x is tensor(189.4384, device='cuda:3')
benign distance is  tensor(189.4384, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.10517845302820206
distance x is tensor(187.9908, device='cuda:3')
benign distance is  tensor(187.9908, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3576323091983795
distance x is tensor(188.7652, device='cuda:3')
benign distance is  tensor(188.7652, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9488781094551086
distance x is tensor(208.6982, device='cuda:3')
benign distance is  tensor(208.6982, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6354341506958008
distance x is tensor(226.6983, device='cuda:3')
benign distance is  tensor(226.6983, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.49514150619506836
distance x is tensor(212.8012, device='cuda:3')
benign distance is  tensor(212.8012, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.0466216579079628
distance x is tensor(203.8679, device='cuda:3')
benign distance is  tensor(203.8679, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3874847888946533
distance x is tensor(175.1478, device='cuda:3')
benign distance is  tensor(175.1478, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3087373375892639
distance x is tensor(188.4510, device='cuda:3')
benign distance is  tensor(188.4510, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6960729956626892
distance x is tensor(182.9130, device='cuda:3')
benign distance is  tensor(182.9130, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.40272635221481323
distance x is tensor(169.1958, device='cuda:3')
benign distance is  tensor(169.1958, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4070776104927063
distance x is tensor(225.7121, device='cuda:3')
benign distance is  tensor(225.7121, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7923138737678528
distance x is tensor(180.2614, device='cuda:3')
benign distance is  tensor(180.2614, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 48.209877014160156
mal_entropy is 0.06135566160082817
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([794.1034, 775.6439, 808.8185, 822.8651, 773.8962, 784.2584, 830.9889,
        905.3773, 461.3765, 461.3765, 461.3765, 461.3765, 461.3765, 461.3765,
        461.3765, 461.3765, 461.3765, 461.3765, 461.3765, 461.3765, 867.1434,
        881.3981, 849.2027, 900.0327, 901.2176, 868.3428, 886.2271, 861.7278,
        832.7969, 901.9451, 871.7283, 854.7704, 867.4805, 870.0067, 860.8627,
        853.8623, 832.5862, 878.8706, 948.0682, 855.4816, 847.5702, 876.0180,
        880.6310, 859.5094, 806.0389, 816.3958, 903.1658, 921.1993, 864.1705,
        906.4717, 766.6228, 847.9595], device='cuda:3')
sorted_norm is   tensor([461.3765, 461.3765, 461.3765, 461.3765, 461.3765, 461.3765, 461.3765,
        461.3765, 461.3765, 461.3765, 461.3765, 461.3765, 766.6228, 773.8962,
        775.6439, 784.2584, 794.1034, 806.0389, 808.8185, 816.3958, 822.8651,
        830.9889, 832.5862, 832.7969, 847.5702, 847.9595, 849.2027, 853.8623,
        854.7704, 855.4816, 859.5094, 860.8627, 861.7278, 864.1705, 867.1434,
        867.4805, 868.3428, 870.0067, 871.7283, 876.0180, 878.8706, 880.6310,
        881.3981, 886.2271, 900.0327, 901.2176, 901.9451, 903.1658, 905.3773,
        906.4717, 921.1993, 948.0682], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 50,  4,  1,  5,  0, 44,
         2, 45,  3,  6, 36, 28, 40, 51, 22, 35, 31, 39, 43, 34, 27, 48, 20, 32,
        25, 33, 30, 41, 37], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 87.34% 

Test Accuracy: 86.22% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6192325353622437
distance x is tensor(163.9021, device='cuda:3')
benign distance is  tensor(163.9021, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5045653581619263
distance x is tensor(154.0067, device='cuda:3')
benign distance is  tensor(154.0067, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4380781054496765
distance x is tensor(158.9387, device='cuda:3')
benign distance is  tensor(158.9387, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5320526361465454
distance x is tensor(159.6415, device='cuda:3')
benign distance is  tensor(159.6415, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4705720841884613
distance x is tensor(162.7106, device='cuda:3')
benign distance is  tensor(162.7106, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.1732809692621231
distance x is tensor(161.0901, device='cuda:3')
benign distance is  tensor(161.0901, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39493727684020996
distance x is tensor(155.5214, device='cuda:3')
benign distance is  tensor(155.5214, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.18758663535118103
distance x is tensor(158.4639, device='cuda:3')
benign distance is  tensor(158.4639, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3721407949924469
distance x is tensor(158.2036, device='cuda:3')
benign distance is  tensor(158.2036, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.58536297082901
distance x is tensor(145.7891, device='cuda:3')
benign distance is  tensor(145.7891, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.44453686475753784
distance x is tensor(160.6136, device='cuda:3')
benign distance is  tensor(160.6136, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5830541849136353
distance x is tensor(163.6173, device='cuda:3')
benign distance is  tensor(163.6173, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8472784161567688
distance x is tensor(161.8395, device='cuda:3')
benign distance is  tensor(161.8395, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.08262238651514053
distance x is tensor(147.9358, device='cuda:3')
benign distance is  tensor(147.9358, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3467267155647278
distance x is tensor(164.1879, device='cuda:3')
benign distance is  tensor(164.1879, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5366414189338684
distance x is tensor(172.3713, device='cuda:3')
benign distance is  tensor(172.3713, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.712106466293335
distance x is tensor(155.2636, device='cuda:3')
benign distance is  tensor(155.2636, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4447290301322937
distance x is tensor(172.9757, device='cuda:3')
benign distance is  tensor(172.9757, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.33254474401474
distance x is tensor(154.0833, device='cuda:3')
benign distance is  tensor(154.0833, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.47652339935302734
distance x is tensor(161.5567, device='cuda:3')
benign distance is  tensor(161.5567, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2058730125427246
distance x is tensor(165.5723, device='cuda:3')
benign distance is  tensor(165.5723, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6006264686584473
distance x is tensor(149.6358, device='cuda:3')
benign distance is  tensor(149.6358, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5054095983505249
distance x is tensor(156.2612, device='cuda:3')
benign distance is  tensor(156.2612, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4484022557735443
distance x is tensor(155.9832, device='cuda:3')
benign distance is  tensor(155.9832, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17778243124485016
distance x is tensor(157.3137, device='cuda:3')
benign distance is  tensor(157.3137, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2778184711933136
distance x is tensor(152.5720, device='cuda:3')
benign distance is  tensor(152.5720, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3364996016025543
distance x is tensor(158.7043, device='cuda:3')
benign distance is  tensor(158.7043, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.583701491355896
distance x is tensor(169.0216, device='cuda:3')
benign distance is  tensor(169.0216, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3260396718978882
distance x is tensor(161.6057, device='cuda:3')
benign distance is  tensor(161.6057, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.21353860199451447
distance x is tensor(160.7095, device='cuda:3')
benign distance is  tensor(160.7095, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3469957709312439
distance x is tensor(165.4960, device='cuda:3')
benign distance is  tensor(165.4960, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3165804445743561
distance x is tensor(173.1972, device='cuda:3')
benign distance is  tensor(173.1972, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3633232116699219
distance x is tensor(153.4714, device='cuda:3')
benign distance is  tensor(153.4714, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2586138844490051
distance x is tensor(178.1767, device='cuda:3')
benign distance is  tensor(178.1767, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.13224413990974426
distance x is tensor(152.0946, device='cuda:3')
benign distance is  tensor(152.0946, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5801342725753784
distance x is tensor(160.2689, device='cuda:3')
benign distance is  tensor(160.2689, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.18880656361579895
distance x is tensor(156.5932, device='cuda:3')
benign distance is  tensor(156.5932, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5015479326248169
distance x is tensor(151.3938, device='cuda:3')
benign distance is  tensor(151.3938, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1217674016952515
distance x is tensor(163.3149, device='cuda:3')
benign distance is  tensor(163.3149, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.49940189719200134
distance x is tensor(145.9427, device='cuda:3')
benign distance is  tensor(145.9427, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 1.3625476360321045
mal_entropy is 0.12351372092962265
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([713.5391, 685.2294, 702.7487, 706.7457, 698.3890, 709.8412, 676.4280,
        708.1719, 445.7606, 445.7606, 445.7606, 445.7606, 445.7606, 445.7606,
        445.7606, 445.7606, 445.7606, 445.7606, 445.7606, 445.7606],
       device='cuda:3')
sorted_norm is   tensor([445.7606, 445.7606, 445.7606, 445.7606, 445.7606, 445.7606, 445.7606,
        445.7606, 445.7606, 445.7606, 445.7606, 445.7606, 676.4280, 685.2294,
        698.3890, 702.7487, 706.7457, 708.1719, 709.8412, 713.5391],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  1,  4,  2],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 84.77% 

Test Accuracy: 83.43% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6791858673095703
distance x is tensor(189.9382, device='cuda:3')
benign distance is  tensor(189.9382, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.30608701705932617
distance x is tensor(192.9440, device='cuda:3')
benign distance is  tensor(192.9440, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8164111971855164
distance x is tensor(189.4657, device='cuda:3')
benign distance is  tensor(189.4657, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7128761410713196
distance x is tensor(173.8516, device='cuda:3')
benign distance is  tensor(173.8516, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6156542897224426
distance x is tensor(188.8929, device='cuda:3')
benign distance is  tensor(188.8929, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6272764801979065
distance x is tensor(188.8883, device='cuda:3')
benign distance is  tensor(188.8883, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15978780388832092
distance x is tensor(201.5142, device='cuda:3')
benign distance is  tensor(201.5142, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21212545037269592
distance x is tensor(176.7100, device='cuda:3')
benign distance is  tensor(176.7100, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 18.078533172607422
mal_entropy is 0.13464777171611786
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([820.6590, 846.7938, 818.1010, 747.8830, 792.9695, 801.0972, 837.8314,
        765.9037, 450.7962, 450.7962, 450.7962, 450.7962, 450.7962, 450.7962,
        450.7962, 450.7962, 450.7962, 450.7962, 450.7962, 450.7962, 783.8371,
        738.2302, 795.7779, 784.6487, 798.4940, 750.2269, 808.0295, 824.7134],
       device='cuda:3')
sorted_norm is   tensor([450.7962, 450.7962, 450.7962, 450.7962, 450.7962, 450.7962, 450.7962,
        450.7962, 450.7962, 450.7962, 450.7962, 450.7962, 738.2302, 747.8830,
        750.2269, 765.9037, 783.8371, 784.6487, 792.9695, 795.7779, 798.4940,
        801.0972, 808.0295, 818.1010, 820.6590, 824.7134, 837.8314, 846.7938],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9, 21,  3, 25,  7, 20, 23,
         4, 22, 24,  5], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 84.41% 

Test Accuracy: 82.85% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6531827449798584
distance x is tensor(211.3844, device='cuda:3')
benign distance is  tensor(211.3844, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9040336608886719
distance x is tensor(197.5801, device='cuda:3')
benign distance is  tensor(197.5801, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.935690701007843
distance x is tensor(197.1487, device='cuda:3')
benign distance is  tensor(197.1487, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40839728713035583
distance x is tensor(192.1360, device='cuda:3')
benign distance is  tensor(192.1360, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3305661082267761
distance x is tensor(227.8468, device='cuda:3')
benign distance is  tensor(227.8468, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6365431547164917
distance x is tensor(183.6505, device='cuda:3')
benign distance is  tensor(183.6505, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5749660134315491
distance x is tensor(194.6417, device='cuda:3')
benign distance is  tensor(194.6417, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6685301065444946
distance x is tensor(195.1649, device='cuda:3')
benign distance is  tensor(195.1649, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.35960471630096436
distance x is tensor(203.5362, device='cuda:3')
benign distance is  tensor(203.5362, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4442064166069031
distance x is tensor(187.9970, device='cuda:3')
benign distance is  tensor(187.9970, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6836451292037964
distance x is tensor(205.9096, device='cuda:3')
benign distance is  tensor(205.9096, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5070545077323914
distance x is tensor(194.7047, device='cuda:3')
benign distance is  tensor(194.7047, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5891469120979309
distance x is tensor(180.9413, device='cuda:3')
benign distance is  tensor(180.9413, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2096286118030548
distance x is tensor(193.8013, device='cuda:3')
benign distance is  tensor(193.8013, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8374118804931641
distance x is tensor(185.1693, device='cuda:3')
benign distance is  tensor(185.1693, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8380983471870422
distance x is tensor(200.5242, device='cuda:3')
benign distance is  tensor(200.5242, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal_loss is 32.11647415161133
mal_entropy is 0.18973658978939056
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([883.7766, 851.4651, 838.3912, 820.7479, 933.0927, 783.5857, 812.9935,
        842.9478, 458.4567, 458.4568, 458.4567, 458.4568, 458.4567, 458.4568,
        458.4567, 458.4568, 458.4567, 458.4568, 458.4567, 458.4568, 800.9147,
        876.7633, 785.0502, 843.0866, 830.2893, 780.5878, 801.4610, 811.1181],
       device='cuda:3')
sorted_norm is   tensor([458.4567, 458.4567, 458.4567, 458.4567, 458.4567, 458.4567, 458.4568,
        458.4568, 458.4568, 458.4568, 458.4568, 458.4568, 780.5878, 783.5857,
        785.0502, 800.9147, 801.4610, 811.1181, 812.9935, 820.7479, 830.2893,
        838.3912, 842.9478, 843.0866, 851.4651, 876.7633, 883.7766, 933.0927],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11, 25,  5, 22, 20, 26, 27,
         6,  3, 24,  2], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 83.77% 

Test Accuracy: 82.52% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2198482751846313
distance x is tensor(180.4064, device='cuda:3')
benign distance is  tensor(180.4064, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5032550096511841
distance x is tensor(210.9448, device='cuda:3')
benign distance is  tensor(210.9448, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2764360010623932
distance x is tensor(196.4051, device='cuda:3')
benign distance is  tensor(196.4051, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6169870495796204
distance x is tensor(204.2701, device='cuda:3')
benign distance is  tensor(204.2701, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5175144672393799
distance x is tensor(186.4974, device='cuda:3')
benign distance is  tensor(186.4974, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4157683253288269
distance x is tensor(225.3366, device='cuda:3')
benign distance is  tensor(225.3366, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.43519097566604614
distance x is tensor(179.1691, device='cuda:3')
benign distance is  tensor(179.1691, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4258188307285309
distance x is tensor(211.8114, device='cuda:3')
benign distance is  tensor(211.8114, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3172871172428131
distance x is tensor(177.9932, device='cuda:3')
benign distance is  tensor(177.9932, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7175859212875366
distance x is tensor(195.3767, device='cuda:3')
benign distance is  tensor(195.3767, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.34387993812561035
distance x is tensor(195.1677, device='cuda:3')
benign distance is  tensor(195.1677, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.34553447365760803
distance x is tensor(198.5097, device='cuda:3')
benign distance is  tensor(198.5097, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4469960629940033
distance x is tensor(182.1899, device='cuda:3')
benign distance is  tensor(182.1899, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6650968790054321
distance x is tensor(183.9288, device='cuda:3')
benign distance is  tensor(183.9288, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.19138512015342712
distance x is tensor(179.0342, device='cuda:3')
benign distance is  tensor(179.0342, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6754740476608276
distance x is tensor(185.8185, device='cuda:3')
benign distance is  tensor(185.8185, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal_loss is 46.65088653564453
mal_entropy is 0.16477231681346893
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([772.6682, 880.4957, 797.0638, 854.5152, 803.2595, 918.9974, 764.6501,
        871.2693, 458.2249, 458.2249, 458.2249, 458.2249, 458.2249, 458.2249,
        458.2249, 458.2249, 458.2249, 458.2249, 458.2249, 458.2249, 960.6213,
        922.4118, 848.7889, 891.0490, 863.9333, 824.4287, 959.5325, 866.1647,
        813.0459, 801.7344, 822.7791, 859.0955, 827.7383, 834.6868, 849.0568,
        873.0710, 894.5884, 828.9019, 898.0729, 843.6023, 800.9366, 833.1536,
        811.6078, 837.6201], device='cuda:3')
sorted_norm is   tensor([458.2249, 458.2249, 458.2249, 458.2249, 458.2249, 458.2249, 458.2249,
        458.2249, 458.2249, 458.2249, 458.2249, 458.2249, 764.6501, 772.6682,
        797.0638, 800.9366, 801.7344, 803.2595, 811.6078, 813.0459, 822.7791,
        824.4287, 827.7383, 828.9019, 833.1536, 834.6868, 837.6201, 843.6023,
        848.7889, 849.0568, 854.5152, 859.0955, 863.9333, 866.1647, 871.2693,
        873.0710, 880.4957, 891.0490, 894.5884, 898.0729, 918.9974, 922.4118,
        959.5325, 960.6213], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15,  6,  0,  2, 40, 29,  4,
        42, 28, 30, 25, 32, 37, 41, 33, 43, 39, 22, 34,  3, 31, 24, 27,  7],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 87.22% 

Test Accuracy: 85.99% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2166944742202759
distance x is tensor(167.2708, device='cuda:3')
benign distance is  tensor(167.2708, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.26349806785583496
distance x is tensor(163.5205, device='cuda:3')
benign distance is  tensor(163.5205, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.29535526037216187
distance x is tensor(172.6747, device='cuda:3')
benign distance is  tensor(172.6747, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3873305916786194
distance x is tensor(164.2968, device='cuda:3')
benign distance is  tensor(164.2968, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.42994746565818787
distance x is tensor(167.4095, device='cuda:3')
benign distance is  tensor(167.4095, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.29551947116851807
distance x is tensor(188.3634, device='cuda:3')
benign distance is  tensor(188.3634, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2514967620372772
distance x is tensor(155.6480, device='cuda:3')
benign distance is  tensor(155.6480, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4372512400150299
distance x is tensor(182.4755, device='cuda:3')
benign distance is  tensor(182.4755, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.39571017026901245
distance x is tensor(174.4650, device='cuda:3')
benign distance is  tensor(174.4650, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.691812515258789
distance x is tensor(163.9887, device='cuda:3')
benign distance is  tensor(163.9887, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6020597219467163
distance x is tensor(170.2126, device='cuda:3')
benign distance is  tensor(170.2126, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6104795336723328
distance x is tensor(165.9240, device='cuda:3')
benign distance is  tensor(165.9240, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49755945801734924
distance x is tensor(155.7422, device='cuda:3')
benign distance is  tensor(155.7422, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5879406332969666
distance x is tensor(169.0770, device='cuda:3')
benign distance is  tensor(169.0770, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3258086144924164
distance x is tensor(150.1335, device='cuda:3')
benign distance is  tensor(150.1335, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5750447511672974
distance x is tensor(154.3604, device='cuda:3')
benign distance is  tensor(154.3604, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3521050810813904
distance x is tensor(162.4227, device='cuda:3')
benign distance is  tensor(162.4227, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7457773089408875
distance x is tensor(152.8190, device='cuda:3')
benign distance is  tensor(152.8190, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3184506595134735
distance x is tensor(158.8472, device='cuda:3')
benign distance is  tensor(158.8472, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.37954074144363403
distance x is tensor(159.1137, device='cuda:3')
benign distance is  tensor(159.1137, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.922886848449707
distance x is tensor(158.9352, device='cuda:3')
benign distance is  tensor(158.9352, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4834100306034088
distance x is tensor(163.3643, device='cuda:3')
benign distance is  tensor(163.3643, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3658543825149536
distance x is tensor(157.1875, device='cuda:3')
benign distance is  tensor(157.1875, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4175606369972229
distance x is tensor(174.7500, device='cuda:3')
benign distance is  tensor(174.7500, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5833365321159363
distance x is tensor(179.6474, device='cuda:3')
benign distance is  tensor(179.6474, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.056369028985500336
distance x is tensor(183.0194, device='cuda:3')
benign distance is  tensor(183.0194, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.23363876342773438
distance x is tensor(168.9046, device='cuda:3')
benign distance is  tensor(168.9046, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1689726710319519
distance x is tensor(147.0761, device='cuda:3')
benign distance is  tensor(147.0761, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9162665605545044
distance x is tensor(153.3328, device='cuda:3')
benign distance is  tensor(153.3328, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.25518888235092163
distance x is tensor(153.3072, device='cuda:3')
benign distance is  tensor(153.3072, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.41363388299942017
distance x is tensor(172.2999, device='cuda:3')
benign distance is  tensor(172.2999, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8044432401657104
distance x is tensor(173.0051, device='cuda:3')
benign distance is  tensor(173.0051, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.7000000005
mal_loss is 3.397390842437744
mal_entropy is 0.24670234322547913
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([712.5036, 710.8210, 744.7267, 723.2032, 724.6519, 803.6038, 668.6704,
        798.6475, 452.3063, 452.3063, 452.3063, 452.3063, 452.3063, 452.3063,
        452.3063, 452.3063, 452.3063, 452.3063, 452.3063, 452.3063],
       device='cuda:3')
sorted_norm is   tensor([452.3063, 452.3063, 452.3063, 452.3063, 452.3063, 452.3063, 452.3063,
        452.3063, 452.3063, 452.3063, 452.3063, 452.3063, 668.6704, 710.8210,
        712.5036, 723.2032, 724.6519, 744.7267, 798.6475, 803.6038],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  1,  0,  3],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 83.61% 

Test Accuracy: 82.18% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.5068341493606567
distance x is tensor(194.9651, device='cuda:3')
benign distance is  tensor(194.9651, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5071889758110046
distance x is tensor(193.2031, device='cuda:3')
benign distance is  tensor(193.2031, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11178340762853622
distance x is tensor(185.4021, device='cuda:3')
benign distance is  tensor(185.4021, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5831117033958435
distance x is tensor(214.0452, device='cuda:3')
benign distance is  tensor(214.0452, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8504739999771118
distance x is tensor(217.8481, device='cuda:3')
benign distance is  tensor(217.8481, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6149696707725525
distance x is tensor(204.6271, device='cuda:3')
benign distance is  tensor(204.6271, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33764755725860596
distance x is tensor(185.6042, device='cuda:3')
benign distance is  tensor(185.6042, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5402613878250122
distance x is tensor(277.8819, device='cuda:3')
benign distance is  tensor(277.8819, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 35.48495864868164
mal_entropy is 0.02905970811843872
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 818.6354,  818.8943,  779.8599,  906.4083,  900.2112,  849.2557,
         786.7018, 1135.1029,  459.2604,  459.2604,  459.2604,  459.2604,
         459.2604,  459.2604,  459.2604,  459.2604,  459.2604,  459.2604,
         459.2604,  459.2604,  858.3209,  960.9595,  883.0585,  900.8179,
         882.4670,  863.1863,  911.4802,  850.6477,  839.8668,  903.3221,
         880.8110,  900.0546,  854.8533,  859.1530,  847.2504,  861.7460,
         864.4907,  820.5621,  823.9879,  811.6807,  774.5366,  811.0665,
         752.5687,  759.6226], device='cuda:3')
sorted_norm is   tensor([ 459.2604,  459.2604,  459.2604,  459.2604,  459.2604,  459.2604,
         459.2604,  459.2604,  459.2604,  459.2604,  459.2604,  459.2604,
         752.5687,  759.6226,  774.5366,  779.8599,  786.7018,  811.0665,
         811.6807,  818.6354,  818.8943,  820.5621,  823.9879,  839.8668,
         847.2504,  849.2557,  850.6477,  854.8533,  858.3209,  859.1530,
         861.7460,  863.1863,  864.4907,  880.8110,  882.4670,  883.0585,
         900.0546,  900.2112,  900.8179,  903.3221,  906.4083,  911.4802,
         960.9595, 1135.1029], device='cuda:3')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10, 42, 43, 40,  2,  6, 41,
        39,  0,  1, 37, 38, 28, 34,  5, 27, 32, 20, 33, 35, 25, 36, 30, 24],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 86.95% 

Test Accuracy: 85.74% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49008598923683167
distance x is tensor(155.9503, device='cuda:3')
benign distance is  tensor(155.9503, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2904629111289978
distance x is tensor(163.3974, device='cuda:3')
benign distance is  tensor(163.3974, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3747738003730774
distance x is tensor(161.9805, device='cuda:3')
benign distance is  tensor(161.9805, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4068275690078735
distance x is tensor(156.4739, device='cuda:3')
benign distance is  tensor(156.4739, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.27840882539749146
distance x is tensor(159.5010, device='cuda:3')
benign distance is  tensor(159.5010, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9510831832885742
distance x is tensor(187.5002, device='cuda:3')
benign distance is  tensor(187.5002, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5344561338424683
distance x is tensor(158.3698, device='cuda:3')
benign distance is  tensor(158.3698, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9427810907363892
distance x is tensor(176.5707, device='cuda:3')
benign distance is  tensor(176.5707, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20756861567497253
distance x is tensor(166.8901, device='cuda:3')
benign distance is  tensor(166.8901, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3604225814342499
distance x is tensor(161.5022, device='cuda:3')
benign distance is  tensor(161.5022, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.724334716796875
distance x is tensor(169.1830, device='cuda:3')
benign distance is  tensor(169.1830, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.19232667982578278
distance x is tensor(186.5992, device='cuda:3')
benign distance is  tensor(186.5992, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9092016220092773
distance x is tensor(169.8651, device='cuda:3')
benign distance is  tensor(169.8651, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.12339062988758087
distance x is tensor(168.4689, device='cuda:3')
benign distance is  tensor(168.4689, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5024830102920532
distance x is tensor(170.4471, device='cuda:3')
benign distance is  tensor(170.4471, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5246478915214539
distance x is tensor(163.2990, device='cuda:3')
benign distance is  tensor(163.2990, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2507167458534241
distance x is tensor(159.8713, device='cuda:3')
benign distance is  tensor(159.8713, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9001413583755493
distance x is tensor(171.6149, device='cuda:3')
benign distance is  tensor(171.6149, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5582028031349182
distance x is tensor(166.2923, device='cuda:3')
benign distance is  tensor(166.2923, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.20985352993011475
distance x is tensor(171.6656, device='cuda:3')
benign distance is  tensor(171.6656, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4441160261631012
distance x is tensor(151.9973, device='cuda:3')
benign distance is  tensor(151.9973, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.49438515305519104
distance x is tensor(169.6623, device='cuda:3')
benign distance is  tensor(169.6623, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.32978421449661255
distance x is tensor(162.4065, device='cuda:3')
benign distance is  tensor(162.4065, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6041550636291504
distance x is tensor(165.6702, device='cuda:3')
benign distance is  tensor(165.6702, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.24771618843078613
distance x is tensor(165.4614, device='cuda:3')
benign distance is  tensor(165.4614, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.22198350727558136
distance x is tensor(165.1219, device='cuda:3')
benign distance is  tensor(165.1219, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.04944171383976936
distance x is tensor(168.3674, device='cuda:3')
benign distance is  tensor(168.3674, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5751808881759644
distance x is tensor(177.8409, device='cuda:3')
benign distance is  tensor(177.8409, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.29864588379859924
distance x is tensor(163.9290, device='cuda:3')
benign distance is  tensor(163.9290, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7149120569229126
distance x is tensor(166.7533, device='cuda:3')
benign distance is  tensor(166.7533, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.32949593663215637
distance x is tensor(182.7574, device='cuda:3')
benign distance is  tensor(182.7574, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2967110574245453
distance x is tensor(162.6858, device='cuda:3')
benign distance is  tensor(162.6858, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal_loss is 7.079536437988281
mal_entropy is 0.36413827538490295
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([680.9284, 705.7739, 708.1187, 668.7910, 684.9257, 800.7672, 668.3083,
        768.3398, 453.0188, 453.0188, 453.0188, 453.0188, 453.0188, 453.0188,
        453.0188, 453.0188, 453.0188, 453.0188, 453.0188, 453.0188],
       device='cuda:3')
sorted_norm is   tensor([453.0188, 453.0188, 453.0188, 453.0188, 453.0188, 453.0188, 453.0188,
        453.0188, 453.0188, 453.0188, 453.0188, 453.0188, 668.3083, 668.7910,
        680.9284, 684.9257, 705.7739, 708.1187, 768.3398, 800.7672],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  6,  3,  0,  4],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 79.17% 

Test Accuracy: 77.97% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8737431764602661
distance x is tensor(226.0410, device='cuda:3')
benign distance is  tensor(226.0410, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4343700408935547
distance x is tensor(219.0618, device='cuda:3')
benign distance is  tensor(219.0618, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8802303075790405
distance x is tensor(209.4415, device='cuda:3')
benign distance is  tensor(209.4415, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4229898452758789
distance x is tensor(230.6388, device='cuda:3')
benign distance is  tensor(230.6388, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5289326906204224
distance x is tensor(208.4505, device='cuda:3')
benign distance is  tensor(208.4505, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.32493120431900024
distance x is tensor(225.5616, device='cuda:3')
benign distance is  tensor(225.5616, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25771307945251465
distance x is tensor(195.0573, device='cuda:3')
benign distance is  tensor(195.0573, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6547530889511108
distance x is tensor(251.9103, device='cuda:3')
benign distance is  tensor(251.9103, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 45.383880615234375
mal_entropy is 0.05808136984705925
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 916.6605,  891.0718,  849.3118,  961.2184,  854.5641,  938.6227,
         793.1480, 1025.2057,  459.4028,  459.4028,  459.4028,  459.4028,
         459.4028,  459.4028,  459.4028,  459.4028,  459.4028,  459.4028,
         459.4028,  459.4028,  853.2695,  820.0754,  838.5526,  844.8276,
         833.9917,  861.6732,  830.4370,  897.9775,  812.9127,  806.9038,
         817.3083,  887.9790,  809.9420,  810.9545,  828.9614,  792.3959],
       device='cuda:3')
sorted_norm is   tensor([ 459.4028,  459.4028,  459.4028,  459.4028,  459.4028,  459.4028,
         459.4028,  459.4028,  459.4028,  459.4028,  459.4028,  459.4028,
         792.3959,  793.1480,  806.9038,  809.9420,  810.9545,  812.9127,
         817.3083,  820.0754,  828.9614,  830.4370,  833.9917,  838.5526,
         844.8276,  849.3118,  853.2695,  854.5641,  861.6732,  887.9790,
         891.0718,  897.9775,  916.6605,  938.6227,  961.2184, 1025.2057],
       device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 35,  6, 29, 32, 33, 28,
        30, 21, 34, 26, 24, 22, 23,  2, 20,  4], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 86.01% 

Test Accuracy: 84.79% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.23246002197265625
distance x is tensor(175.2620, device='cuda:3')
benign distance is  tensor(175.2620, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5124908685684204
distance x is tensor(198.7147, device='cuda:3')
benign distance is  tensor(198.7147, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.40847349166870117
distance x is tensor(171.3138, device='cuda:3')
benign distance is  tensor(171.3138, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9682317972183228
distance x is tensor(174.1611, device='cuda:3')
benign distance is  tensor(174.1611, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2940155267715454
distance x is tensor(170.3864, device='cuda:3')
benign distance is  tensor(170.3864, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5436185598373413
distance x is tensor(184.6764, device='cuda:3')
benign distance is  tensor(184.6764, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0870163440704346
distance x is tensor(181.5787, device='cuda:3')
benign distance is  tensor(181.5787, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4228687286376953
distance x is tensor(196.1065, device='cuda:3')
benign distance is  tensor(196.1065, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.18969999253749847
distance x is tensor(183.1452, device='cuda:3')
benign distance is  tensor(183.1452, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7399348020553589
distance x is tensor(173.7364, device='cuda:3')
benign distance is  tensor(173.7364, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9798754453659058
distance x is tensor(189.4242, device='cuda:3')
benign distance is  tensor(189.4242, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.126037359237671
distance x is tensor(183.8468, device='cuda:3')
benign distance is  tensor(183.8468, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.717382550239563
distance x is tensor(188.3983, device='cuda:3')
benign distance is  tensor(188.3983, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8691201210021973
distance x is tensor(181.9974, device='cuda:3')
benign distance is  tensor(181.9974, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8474733233451843
distance x is tensor(175.3533, device='cuda:3')
benign distance is  tensor(175.3533, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.43617162108421326
distance x is tensor(217.2594, device='cuda:3')
benign distance is  tensor(217.2594, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.41471248865127563
distance x is tensor(188.5917, device='cuda:3')
benign distance is  tensor(188.5917, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5000940561294556
distance x is tensor(176.9164, device='cuda:3')
benign distance is  tensor(176.9164, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3603132367134094
distance x is tensor(183.3920, device='cuda:3')
benign distance is  tensor(183.3920, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5820477604866028
distance x is tensor(178.7599, device='cuda:3')
benign distance is  tensor(178.7599, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7140450477600098
distance x is tensor(185.7120, device='cuda:3')
benign distance is  tensor(185.7120, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4974839687347412
distance x is tensor(185.7893, device='cuda:3')
benign distance is  tensor(185.7893, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.45900392532348633
distance x is tensor(186.0060, device='cuda:3')
benign distance is  tensor(186.0060, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.934008777141571
distance x is tensor(190.4762, device='cuda:3')
benign distance is  tensor(190.4762, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal_loss is 25.054393768310547
mal_entropy is 0.08678342401981354
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([737.9956, 821.9560, 727.4715, 754.6709, 697.9442, 784.2578, 757.5392,
        812.3329, 460.0237, 460.0236, 460.0237, 460.0236, 460.0237, 460.0236,
        460.0237, 460.0236, 460.0237, 460.0236, 460.0237, 460.0236, 864.8743,
        873.2822, 822.3156, 746.7383, 771.5616, 774.0260, 821.0909, 832.1973,
        765.8668, 800.5142, 782.9111, 797.8550, 722.2923, 787.2217, 769.8879,
        755.3895], device='cuda:3')
sorted_norm is   tensor([460.0236, 460.0236, 460.0236, 460.0236, 460.0236, 460.0236, 460.0237,
        460.0237, 460.0237, 460.0237, 460.0237, 460.0237, 697.9442, 722.2923,
        727.4715, 737.9956, 746.7383, 754.6709, 755.3895, 757.5392, 765.8668,
        769.8879, 771.5616, 774.0260, 782.9111, 784.2578, 787.2217, 797.8550,
        800.5142, 812.3329, 821.0909, 821.9560, 822.3156, 832.1973, 864.8743,
        873.2822], device='cuda:3')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10,  4, 32,  2,  0, 23,  3,
        35,  6, 28, 34, 24, 25, 30,  5, 33, 31], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 86.73% 

Test Accuracy: 85.46% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4291563630104065
distance x is tensor(176.5936, device='cuda:3')
benign distance is  tensor(176.5936, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3734096586704254
distance x is tensor(197.6283, device='cuda:3')
benign distance is  tensor(197.6283, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19824115931987762
distance x is tensor(174.0615, device='cuda:3')
benign distance is  tensor(174.0615, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9983334541320801
distance x is tensor(176.8354, device='cuda:3')
benign distance is  tensor(176.8354, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4029711484909058
distance x is tensor(164.7829, device='cuda:3')
benign distance is  tensor(164.7829, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6298786401748657
distance x is tensor(176.1755, device='cuda:3')
benign distance is  tensor(176.1755, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2947711646556854
distance x is tensor(182.2874, device='cuda:3')
benign distance is  tensor(182.2874, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6398724913597107
distance x is tensor(195.3926, device='cuda:3')
benign distance is  tensor(195.3926, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.30148157477378845
distance x is tensor(157.1837, device='cuda:3')
benign distance is  tensor(157.1837, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6185593008995056
distance x is tensor(185.7284, device='cuda:3')
benign distance is  tensor(185.7284, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5241996645927429
distance x is tensor(178.3149, device='cuda:3')
benign distance is  tensor(178.3149, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.36840149760246277
distance x is tensor(172.6749, device='cuda:3')
benign distance is  tensor(172.6749, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3497926592826843
distance x is tensor(187.3345, device='cuda:3')
benign distance is  tensor(187.3345, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7255235910415649
distance x is tensor(181.7020, device='cuda:3')
benign distance is  tensor(181.7020, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.38977593183517456
distance x is tensor(178.1588, device='cuda:3')
benign distance is  tensor(178.1588, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.45352163910865784
distance x is tensor(158.1065, device='cuda:3')
benign distance is  tensor(158.1065, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5707811117172241
distance x is tensor(173.8719, device='cuda:3')
benign distance is  tensor(173.8719, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.4250226616859436
distance x is tensor(184.3222, device='cuda:3')
benign distance is  tensor(184.3222, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.41281580924987793
distance x is tensor(174.8493, device='cuda:3')
benign distance is  tensor(174.8493, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2728831171989441
distance x is tensor(174.7330, device='cuda:3')
benign distance is  tensor(174.7330, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8932098150253296
distance x is tensor(173.0562, device='cuda:3')
benign distance is  tensor(173.0562, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.44077929854393005
distance x is tensor(172.2917, device='cuda:3')
benign distance is  tensor(172.2917, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.49868273735046387
distance x is tensor(179.2130, device='cuda:3')
benign distance is  tensor(179.2130, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.43656665086746216
distance x is tensor(177.3685, device='cuda:3')
benign distance is  tensor(177.3685, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 26.904186248779297
mal_entropy is 0.11922772973775864
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([738.0357, 833.2953, 731.1312, 746.4062, 683.5515, 750.6458, 753.8912,
        829.6972, 459.9154, 459.9154, 459.9154, 459.9154, 459.9154, 459.9154,
        459.9154, 459.9154, 459.9154, 459.9154, 459.9154, 459.9154, 807.8954,
        748.2386, 797.1578, 788.5287, 823.4340, 785.7773, 777.1255, 893.0597],
       device='cuda:3')
sorted_norm is   tensor([459.9154, 459.9154, 459.9154, 459.9154, 459.9154, 459.9154, 459.9154,
        459.9154, 459.9154, 459.9154, 459.9154, 459.9154, 683.5515, 731.1312,
        738.0357, 746.4062, 748.2386, 750.6458, 753.8912, 777.1255, 785.7773,
        788.5287, 797.1578, 807.8954, 823.4340, 829.6972, 833.2953, 893.0597],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  4,  2,  0,  3, 21,  5,
         6, 26, 25, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 85.65% 

Test Accuracy: 84.10% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.165725439786911
distance x is tensor(194.4453, device='cuda:3')
benign distance is  tensor(194.4453, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5717083811759949
distance x is tensor(189.6448, device='cuda:3')
benign distance is  tensor(189.6448, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23012542724609375
distance x is tensor(183.4928, device='cuda:3')
benign distance is  tensor(183.4928, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8177832365036011
distance x is tensor(182.5009, device='cuda:3')
benign distance is  tensor(182.5009, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6512467265129089
distance x is tensor(210.5580, device='cuda:3')
benign distance is  tensor(210.5580, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9554333686828613
distance x is tensor(187.9035, device='cuda:3')
benign distance is  tensor(187.9035, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7470877766609192
distance x is tensor(214.6889, device='cuda:3')
benign distance is  tensor(214.6889, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48618364334106445
distance x is tensor(203.2449, device='cuda:3')
benign distance is  tensor(203.2449, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6701394319534302
distance x is tensor(196.0608, device='cuda:3')
benign distance is  tensor(196.0608, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.14610400795936584
distance x is tensor(196.4734, device='cuda:3')
benign distance is  tensor(196.4734, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6497830152511597
distance x is tensor(176.0465, device='cuda:3')
benign distance is  tensor(176.0465, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3220924735069275
distance x is tensor(186.6292, device='cuda:3')
benign distance is  tensor(186.6292, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49180927872657776
distance x is tensor(179.1327, device='cuda:3')
benign distance is  tensor(179.1327, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.11008241027593613
distance x is tensor(173.8080, device='cuda:3')
benign distance is  tensor(173.8080, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5642013549804688
distance x is tensor(187.2414, device='cuda:3')
benign distance is  tensor(187.2414, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.234541416168213
distance x is tensor(178.5850, device='cuda:3')
benign distance is  tensor(178.5850, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal_loss is 37.8713264465332
mal_entropy is 0.13712641596794128
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([804.2074, 795.7770, 785.8206, 781.5180, 877.9466, 773.5332, 862.2133,
        853.1677, 459.0892, 459.0892, 459.0892, 459.0892, 459.0892, 459.0892,
        459.0892, 459.0892, 459.0892, 459.0892, 459.0892, 459.0892],
       device='cuda:3')
sorted_norm is   tensor([459.0892, 459.0892, 459.0892, 459.0892, 459.0892, 459.0892, 459.0892,
        459.0892, 459.0892, 459.0892, 459.0892, 459.0892, 773.5332, 781.5180,
        785.8206, 795.7770, 804.2074, 853.1677, 862.2133, 877.9466],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  5,  3,  2,  1],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 44.52% 

Test Accuracy: 44.28% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.674054741859436
distance x is tensor(370.6310, device='cuda:3')
benign distance is  tensor(370.6310, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3033846914768219
distance x is tensor(406.7263, device='cuda:3')
benign distance is  tensor(406.7263, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22116181254386902
distance x is tensor(385.0013, device='cuda:3')
benign distance is  tensor(385.0013, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5643455982208252
distance x is tensor(437.8677, device='cuda:3')
benign distance is  tensor(437.8677, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9001446962356567
distance x is tensor(442.4557, device='cuda:3')
benign distance is  tensor(442.4557, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4610695242881775
distance x is tensor(381.1408, device='cuda:3')
benign distance is  tensor(381.1408, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21222367882728577
distance x is tensor(351.7561, device='cuda:3')
benign distance is  tensor(351.7561, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6288381814956665
distance x is tensor(521.2766, device='cuda:3')
benign distance is  tensor(521.2766, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal_loss is 135.96238708496094
mal_entropy is 0.025332292541861534
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([1473.3330, 1578.6451, 1475.3384, 1694.4216, 1754.9896, 1503.5409,
        1337.6661, 2083.8318,  461.3753,  461.3753,  461.3753,  461.3753,
         461.3753,  461.3753,  461.3753,  461.3753,  461.3753,  461.3753,
         461.3753,  461.3753,  926.2553,  923.5457,  952.0455,  990.9586,
         933.3434,  920.1031,  986.8632,  929.5288,  948.6741,  894.8980,
         937.0158,  916.4669,  901.3571,  935.7070,  942.8877,  954.9383,
         837.3350,  943.1976,  904.1323,  895.3597,  938.0723,  906.2941,
         900.8893,  818.7905,  892.1590,  892.5531,  831.9565,  879.0885,
         843.5036,  828.0984,  888.7264,  840.5005], device='cuda:3')
sorted_norm is   tensor([ 461.3753,  461.3753,  461.3753,  461.3753,  461.3753,  461.3753,
         461.3753,  461.3753,  461.3753,  461.3753,  461.3753,  461.3753,
         818.7905,  828.0984,  831.9565,  837.3350,  840.5005,  843.5036,
         879.0885,  888.7264,  892.1590,  892.5531,  894.8980,  895.3597,
         900.8893,  901.3571,  904.1323,  906.2941,  916.4669,  920.1031,
         923.5457,  926.2553,  929.5288,  933.3434,  935.7070,  937.0158,
         938.0723,  942.8877,  943.1976,  948.6741,  952.0455,  954.9383,
         986.8632,  990.9586, 1337.6661, 1473.3330, 1475.3384, 1503.5409,
        1578.6451, 1694.4216, 1754.9896, 2083.8318], device='cuda:3')
used idx is  tensor([11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14, 15, 43, 49, 46, 36, 51, 48,
        47, 50, 44, 45, 29, 39, 42, 32, 38, 41, 31, 25, 21, 20, 27, 24, 33, 30,
        40, 34, 37, 28, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 87.39% 

Test Accuracy: 86.26% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4808616042137146
distance x is tensor(156.2749, device='cuda:3')
benign distance is  tensor(156.2749, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8545984029769897
distance x is tensor(178.7608, device='cuda:3')
benign distance is  tensor(178.7608, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3171096444129944
distance x is tensor(163.6474, device='cuda:3')
benign distance is  tensor(163.6474, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.33688944578170776
distance x is tensor(156.4364, device='cuda:3')
benign distance is  tensor(156.4364, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5250463485717773
distance x is tensor(167.6378, device='cuda:3')
benign distance is  tensor(167.6378, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6132289171218872
distance x is tensor(162.0107, device='cuda:3')
benign distance is  tensor(162.0107, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.355686753988266
distance x is tensor(162.6821, device='cuda:3')
benign distance is  tensor(162.6821, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.277693510055542
distance x is tensor(158.6680, device='cuda:3')
benign distance is  tensor(158.6680, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5847020149230957
distance x is tensor(163.1449, device='cuda:3')
benign distance is  tensor(163.1449, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.25272661447525024
distance x is tensor(166.3624, device='cuda:3')
benign distance is  tensor(166.3624, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3683314025402069
distance x is tensor(147.1460, device='cuda:3')
benign distance is  tensor(147.1460, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7295472025871277
distance x is tensor(183.2045, device='cuda:3')
benign distance is  tensor(183.2045, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9130222201347351
distance x is tensor(162.1968, device='cuda:3')
benign distance is  tensor(162.1968, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.41130703687667847
distance x is tensor(164.7563, device='cuda:3')
benign distance is  tensor(164.7563, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6023019552230835
distance x is tensor(168.9347, device='cuda:3')
benign distance is  tensor(168.9347, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4668886661529541
distance x is tensor(165.2049, device='cuda:3')
benign distance is  tensor(165.2049, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.22964303195476532
distance x is tensor(154.5545, device='cuda:3')
benign distance is  tensor(154.5545, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.3944016993045807
distance x is tensor(163.4257, device='cuda:3')
benign distance is  tensor(163.4257, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6649707555770874
distance x is tensor(165.4583, device='cuda:3')
benign distance is  tensor(165.4583, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1883973479270935
distance x is tensor(164.3226, device='cuda:3')
benign distance is  tensor(164.3226, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5350689888000488
distance x is tensor(150.4621, device='cuda:3')
benign distance is  tensor(150.4621, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.20260611176490784
distance x is tensor(151.2864, device='cuda:3')
benign distance is  tensor(151.2864, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.524644672870636
distance x is tensor(162.1237, device='cuda:3')
benign distance is  tensor(162.1237, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4734324514865875
distance x is tensor(157.3471, device='cuda:3')
benign distance is  tensor(157.3471, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.15960828959941864
distance x is tensor(155.8973, device='cuda:3')
benign distance is  tensor(155.8973, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7359520196914673
distance x is tensor(169.6359, device='cuda:3')
benign distance is  tensor(169.6359, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.15360026061534882
distance x is tensor(163.2782, device='cuda:3')
benign distance is  tensor(163.2782, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4994763433933258
distance x is tensor(156.9708, device='cuda:3')
benign distance is  tensor(156.9708, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9576282501220703
distance x is tensor(161.6850, device='cuda:3')
benign distance is  tensor(161.6850, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.27059412002563477
distance x is tensor(160.1868, device='cuda:3')
benign distance is  tensor(160.1868, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7976522445678711
distance x is tensor(158.3033, device='cuda:3')
benign distance is  tensor(158.3033, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6611175537109375
distance x is tensor(163.1620, device='cuda:3')
benign distance is  tensor(163.1620, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3933033347129822
distance x is tensor(161.4469, device='cuda:3')
benign distance is  tensor(161.4469, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.42421087622642517
distance x is tensor(146.2247, device='cuda:3')
benign distance is  tensor(146.2247, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1043747067451477
distance x is tensor(157.8571, device='cuda:3')
benign distance is  tensor(157.8571, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4521924555301666
distance x is tensor(167.1690, device='cuda:3')
benign distance is  tensor(167.1690, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.33329206705093384
distance x is tensor(158.4814, device='cuda:3')
benign distance is  tensor(158.4814, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.32304906845092773
distance x is tensor(166.4047, device='cuda:3')
benign distance is  tensor(166.4047, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8697317242622375
distance x is tensor(163.8505, device='cuda:3')
benign distance is  tensor(163.8505, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3634222447872162
distance x is tensor(157.2243, device='cuda:3')
benign distance is  tensor(157.2243, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.6000000005
mal_loss is 6.905177116394043
mal_entropy is 0.11115109920501709
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([656.5810, 734.3140, 694.4634, 677.2090, 708.5588, 681.5338, 685.4678,
        689.9993, 454.0205, 454.0205, 454.0205, 454.0205, 454.0205, 454.0205,
        454.0205, 454.0205, 454.0205, 454.0205, 454.0205, 454.0205],
       device='cuda:3')
sorted_norm is   tensor([454.0205, 454.0205, 454.0205, 454.0205, 454.0205, 454.0205, 454.0205,
        454.0205, 454.0205, 454.0205, 454.0205, 454.0205, 656.5810, 677.2090,
        681.5338, 685.4678, 689.9993, 694.4634, 708.5588, 734.3140],
       device='cuda:3')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14, 15, 11, 10,  8,  9,  0,  3,  5,  6],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 83.13% 

Test Accuracy: 81.79% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4889408051967621
distance x is tensor(176.4797, device='cuda:3')
benign distance is  tensor(176.4797, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0563104152679443
distance x is tensor(199.9142, device='cuda:3')
benign distance is  tensor(199.9142, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5593321919441223
distance x is tensor(203.4729, device='cuda:3')
benign distance is  tensor(203.4729, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0201997756958008
distance x is tensor(202.3958, device='cuda:3')
benign distance is  tensor(202.3958, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7619105577468872
distance x is tensor(189.6387, device='cuda:3')
benign distance is  tensor(189.6387, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0051958560943604
distance x is tensor(198.4394, device='cuda:3')
benign distance is  tensor(198.4394, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12024679034948349
distance x is tensor(187.8792, device='cuda:3')
benign distance is  tensor(187.8792, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6051231622695923
distance x is tensor(195.5661, device='cuda:3')
benign distance is  tensor(195.5661, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal_loss is 51.75273895263672
mal_entropy is 0.0571725033223629
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([711.0059, 822.8066, 849.6202, 798.3646, 795.4944, 827.2272, 752.1948,
        808.0024, 459.6991, 459.6991, 459.6991, 459.6991, 459.6991, 459.6991,
        459.6991, 459.6991, 459.6991, 459.6991, 459.6991, 459.6991, 870.0752,
        895.4838, 846.7324, 853.7183, 855.1940, 844.3388, 874.2589, 864.4186,
        801.7203, 799.9364, 739.6516, 864.3176, 795.3518, 789.6177, 813.9727,
        800.9379], device='cuda:3')
sorted_norm is   tensor([459.6991, 459.6991, 459.6991, 459.6991, 459.6991, 459.6991, 459.6991,
        459.6991, 459.6991, 459.6991, 459.6991, 459.6991, 711.0059, 739.6516,
        752.1948, 789.6177, 795.3518, 795.4944, 798.3646, 799.9364, 800.9379,
        801.7203, 808.0024, 813.9727, 822.8066, 827.2272, 844.3388, 846.7324,
        849.6202, 853.7183, 855.1940, 864.3176, 864.4186, 870.0752, 874.2589,
        895.4838], device='cuda:3')
used idx is  tensor([11,  9, 19, 17, 13, 15, 16, 18, 14, 12,  8, 10,  0, 30,  6, 33, 32,  4,
         3, 29, 35, 28,  7, 34,  1,  5, 25, 22], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 86.38% 

Test Accuracy: 85.37% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 86.38%
|----0th round Training Accuracy : 88.70%
|----1th round Training Accuracy : 88.14%
|----2th round Training Accuracy : 87.43%
|----3th round Training Accuracy : 87.03%
|----4th round Training Accuracy : 83.13%
|----5th round Training Accuracy : 87.57%
|----6th round Training Accuracy : 57.28%
|----7th round Training Accuracy : 84.32%
|----8th round Training Accuracy : 80.81%
|----9th round Training Accuracy : 85.01%
|----10th round Training Accuracy : 46.98%
|----11th round Training Accuracy : 87.01%
|----12th round Training Accuracy : 71.24%
|----13th round Training Accuracy : 65.72%
|----14th round Training Accuracy : 83.95%
|----15th round Training Accuracy : 86.29%
|----16th round Training Accuracy : 44.17%
|----17th round Training Accuracy : 85.46%
|----18th round Training Accuracy : 37.78%
|----19th round Training Accuracy : 86.45%
|----20th round Training Accuracy : 82.65%
|----21th round Training Accuracy : 76.04%
|----22th round Training Accuracy : 44.69%
|----23th round Training Accuracy : 87.46%
|----24th round Training Accuracy : 86.48%
|----25th round Training Accuracy : 84.98%
|----26th round Training Accuracy : 82.71%
|----27th round Training Accuracy : 86.37%
|----28th round Training Accuracy : 62.33%
|----29th round Training Accuracy : 87.48%
|----30th round Training Accuracy : 82.78%
|----31th round Training Accuracy : 86.07%
|----32th round Training Accuracy : 84.26%
|----33th round Training Accuracy : 82.92%
|----34th round Training Accuracy : 83.89%
|----35th round Training Accuracy : 87.34%
|----36th round Training Accuracy : 84.77%
|----37th round Training Accuracy : 84.41%
|----38th round Training Accuracy : 83.77%
|----39th round Training Accuracy : 87.22%
|----40th round Training Accuracy : 83.61%
|----41th round Training Accuracy : 86.95%
|----42th round Training Accuracy : 79.17%
|----43th round Training Accuracy : 86.01%
|----44th round Training Accuracy : 86.73%
|----45th round Training Accuracy : 85.65%
|----46th round Training Accuracy : 44.52%
|----47th round Training Accuracy : 87.39%
|----48th round Training Accuracy : 83.13%
|----49th round Training Accuracy : 86.38%
|----Final Test Accuracy: 85.37%
|----0th round Final Test Accuracy : 87.82%
|----1th round Final Test Accuracy : 87.17%
|----2th round Final Test Accuracy : 86.08%
|----3th round Final Test Accuracy : 85.51%
|----4th round Final Test Accuracy : 81.91%
|----5th round Final Test Accuracy : 86.14%
|----6th round Final Test Accuracy : 56.83%
|----7th round Final Test Accuracy : 83.05%
|----8th round Final Test Accuracy : 79.27%
|----9th round Final Test Accuracy : 83.39%
|----10th round Final Test Accuracy : 46.86%
|----11th round Final Test Accuracy : 85.90%
|----12th round Final Test Accuracy : 70.07%
|----13th round Final Test Accuracy : 64.09%
|----14th round Final Test Accuracy : 82.75%
|----15th round Final Test Accuracy : 84.94%
|----16th round Final Test Accuracy : 44.27%
|----17th round Final Test Accuracy : 84.37%
|----18th round Final Test Accuracy : 38.06%
|----19th round Final Test Accuracy : 85.08%
|----20th round Final Test Accuracy : 81.67%
|----21th round Final Test Accuracy : 75.14%
|----22th round Final Test Accuracy : 44.11%
|----23th round Final Test Accuracy : 86.10%
|----24th round Final Test Accuracy : 84.77%
|----25th round Final Test Accuracy : 83.55%
|----26th round Final Test Accuracy : 81.00%
|----27th round Final Test Accuracy : 84.99%
|----28th round Final Test Accuracy : 61.65%
|----29th round Final Test Accuracy : 86.31%
|----30th round Final Test Accuracy : 81.36%
|----31th round Final Test Accuracy : 84.63%
|----32th round Final Test Accuracy : 82.76%
|----33th round Final Test Accuracy : 81.43%
|----34th round Final Test Accuracy : 82.56%
|----35th round Final Test Accuracy : 86.22%
|----36th round Final Test Accuracy : 83.43%
|----37th round Final Test Accuracy : 82.85%
|----38th round Final Test Accuracy : 82.52%
|----39th round Final Test Accuracy : 85.99%
|----40th round Final Test Accuracy : 82.18%
|----41th round Final Test Accuracy : 85.74%
|----42th round Final Test Accuracy : 77.97%
|----43th round Final Test Accuracy : 84.79%
|----44th round Final Test Accuracy : 85.46%
|----45th round Final Test Accuracy : 84.10%
|----46th round Final Test Accuracy : 44.28%
|----47th round Final Test Accuracy : 86.26%
|----48th round Final Test Accuracy : 81.79%
|----49th round Final Test Accuracy : 85.37%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 4939.3944
