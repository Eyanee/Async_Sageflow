
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6752396821975708
distance x is tensor(110.6957, device='cuda:3')
benign distance is  tensor(110.6957, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0450795888900757
distance x is tensor(119.0824, device='cuda:3')
benign distance is  tensor(119.0824, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33841589093208313
distance x is tensor(124.6152, device='cuda:3')
benign distance is  tensor(124.6152, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7469547390937805
distance x is tensor(114.5918, device='cuda:3')
benign distance is  tensor(114.5918, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.804922878742218
distance x is tensor(108.0109, device='cuda:3')
benign distance is  tensor(108.0109, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5560291409492493
distance x is tensor(123.1809, device='cuda:3')
benign distance is  tensor(123.1809, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7144465446472168
distance x is tensor(100.1339, device='cuda:3')
benign distance is  tensor(100.1339, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2667815685272217
distance x is tensor(129.2464, device='cuda:3')
benign distance is  tensor(129.2464, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2207658588886261
distance x is tensor(140.1752, device='cuda:3')
benign distance is  tensor(140.1752, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4839070439338684
distance x is tensor(136.9098, device='cuda:3')
benign distance is  tensor(136.9098, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8820266723632812
distance x is tensor(128.4385, device='cuda:3')
benign distance is  tensor(128.4385, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.24130788445472717
distance x is tensor(128.8050, device='cuda:3')
benign distance is  tensor(128.8050, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.34994348883628845
distance x is tensor(134.3567, device='cuda:3')
benign distance is  tensor(134.3567, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35468772053718567
distance x is tensor(142.5381, device='cuda:3')
benign distance is  tensor(142.5381, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8023624420166016
distance x is tensor(137.0882, device='cuda:3')
benign distance is  tensor(137.0882, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2774084210395813
distance x is tensor(133.4586, device='cuda:3')
benign distance is  tensor(133.4586, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6050688624382019
distance x is tensor(123.6126, device='cuda:3')
benign distance is  tensor(123.6126, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5628372430801392
distance x is tensor(147.0190, device='cuda:3')
benign distance is  tensor(147.0190, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6163250803947449
distance x is tensor(123.6067, device='cuda:3')
benign distance is  tensor(123.6067, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4444142282009125
distance x is tensor(126.9871, device='cuda:3')
benign distance is  tensor(126.9871, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.11399950832128525
distance x is tensor(130.0728, device='cuda:3')
benign distance is  tensor(130.0728, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3311508297920227
distance x is tensor(124.8405, device='cuda:3')
benign distance is  tensor(124.8405, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3386508822441101
distance x is tensor(134.3702, device='cuda:3')
benign distance is  tensor(134.3702, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8300304412841797
distance x is tensor(130.2133, device='cuda:3')
benign distance is  tensor(130.2133, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5099412202835083
distance x is tensor(144.2941, device='cuda:3')
benign distance is  tensor(144.2941, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6592333912849426
distance x is tensor(121.9993, device='cuda:3')
benign distance is  tensor(121.9993, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5189375877380371
distance x is tensor(137.8791, device='cuda:3')
benign distance is  tensor(137.8791, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3127734363079071
distance x is tensor(135.4745, device='cuda:3')
benign distance is  tensor(135.4745, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0442748069763184
distance x is tensor(126.7350, device='cuda:3')
benign distance is  tensor(126.7350, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8241369128227234
distance x is tensor(140.4165, device='cuda:3')
benign distance is  tensor(140.4165, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5402449369430542
distance x is tensor(125.1586, device='cuda:3')
benign distance is  tensor(125.1586, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9493793249130249
distance x is tensor(134.0545, device='cuda:3')
benign distance is  tensor(134.0545, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.568857729434967
distance x is tensor(133.9552, device='cuda:3')
benign distance is  tensor(133.9552, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.16201338171958923
distance x is tensor(126.4000, device='cuda:3')
benign distance is  tensor(126.4000, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.11812938749790192
distance x is tensor(139.2360, device='cuda:3')
benign distance is  tensor(139.2360, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.10899683088064194
distance x is tensor(124.6365, device='cuda:3')
benign distance is  tensor(124.6365, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4924166798591614
distance x is tensor(129.1576, device='cuda:3')
benign distance is  tensor(129.1576, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3413699269294739
distance x is tensor(126.5835, device='cuda:3')
benign distance is  tensor(126.5835, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.539496123790741
distance x is tensor(122.6020, device='cuda:3')
benign distance is  tensor(122.6020, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3003115653991699
distance x is tensor(130.4422, device='cuda:3')
benign distance is  tensor(130.4422, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.14789074659347534
distance x is tensor(123.7257, device='cuda:3')
benign distance is  tensor(123.7257, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.40121299028396606
distance x is tensor(124.5855, device='cuda:3')
benign distance is  tensor(124.5855, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08693944662809372
distance x is tensor(129.2988, device='cuda:3')
benign distance is  tensor(129.2988, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.16101329028606415
distance x is tensor(130.2188, device='cuda:3')
benign distance is  tensor(130.2188, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5398246049880981
distance x is tensor(133.8019, device='cuda:3')
benign distance is  tensor(133.8019, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6120270490646362
distance x is tensor(128.0998, device='cuda:3')
benign distance is  tensor(128.0998, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9686585664749146
distance x is tensor(136.5641, device='cuda:3')
benign distance is  tensor(136.5641, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.307161420583725
distance x is tensor(131.7890, device='cuda:3')
benign distance is  tensor(131.7890, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(110.3864, device='cuda:3')
compute distance is  tensor(110.3864, device='cuda:3')
compute norm is  tensor(45.4857, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.1105, device='cuda:3')
compute distance is  tensor(117.1105, device='cuda:3')
compute norm is  tensor(45.5680, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7195, device='cuda:3')
compute distance is  tensor(130.7195, device='cuda:3')
compute norm is  tensor(46.0670, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.7167, device='cuda:3')
compute distance is  tensor(109.7167, device='cuda:3')
compute norm is  tensor(45.5685, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.5768, device='cuda:3')
compute distance is  tensor(120.5768, device='cuda:3')
compute norm is  tensor(45.7331, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5444, device='cuda:3')
compute distance is  tensor(128.5444, device='cuda:3')
compute norm is  tensor(46.0399, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0369, device='cuda:3')
compute distance is  tensor(124.0369, device='cuda:3')
compute norm is  tensor(45.8108, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5781, device='cuda:3')
compute distance is  tensor(124.5781, device='cuda:3')
compute norm is  tensor(45.8321, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.6297, device='cuda:3')
compute distance is  tensor(118.6297, device='cuda:3')
compute norm is  tensor(45.6735, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.6644, device='cuda:3')
compute distance is  tensor(122.6644, device='cuda:3')
compute norm is  tensor(46.0127, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9982, device='cuda:3')
compute distance is  tensor(123.9982, device='cuda:3')
compute norm is  tensor(46.0040, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6649, device='cuda:3')
compute distance is  tensor(125.6649, device='cuda:3')
compute norm is  tensor(45.8005, device='cuda:3', dtype=torch.float64)
batch acc is 0.1023166668229986
mal_rand_acc is 0.10000000049999999
mal_rand loss is 119521356546048.0
len of model dicts is  12
distance x is tensor(110.3864, device='cuda:3')
compute distance is  tensor(110.3864, device='cuda:3')
compute norm is  tensor(45.4857, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.1105, device='cuda:3')
compute distance is  tensor(117.1105, device='cuda:3')
compute norm is  tensor(45.5680, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7195, device='cuda:3')
compute distance is  tensor(130.7195, device='cuda:3')
compute norm is  tensor(46.0670, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.7167, device='cuda:3')
compute distance is  tensor(109.7167, device='cuda:3')
compute norm is  tensor(45.5685, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.5768, device='cuda:3')
compute distance is  tensor(120.5768, device='cuda:3')
compute norm is  tensor(45.7331, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5444, device='cuda:3')
compute distance is  tensor(128.5444, device='cuda:3')
compute norm is  tensor(46.0399, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0369, device='cuda:3')
compute distance is  tensor(124.0369, device='cuda:3')
compute norm is  tensor(45.8108, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5781, device='cuda:3')
compute distance is  tensor(124.5781, device='cuda:3')
compute norm is  tensor(45.8321, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.6297, device='cuda:3')
compute distance is  tensor(118.6297, device='cuda:3')
compute norm is  tensor(45.6735, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.6644, device='cuda:3')
compute distance is  tensor(122.6644, device='cuda:3')
compute norm is  tensor(46.0127, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9982, device='cuda:3')
compute distance is  tensor(123.9982, device='cuda:3')
compute norm is  tensor(46.0040, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6649, device='cuda:3')
compute distance is  tensor(125.6649, device='cuda:3')
compute norm is  tensor(45.8005, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(130.7195, device='cuda:3')
distance x is tensor(107710.0547, device='cuda:3')
distance x is tensor(107710.0547, device='cuda:3')
________________________________
test distance is  tensor(107710.0547, device='cuda:3')
test distance1 is  tensor(107710.0547, device='cuda:3')
test similarity is  tensor(-0.1075, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130124416186669.31
test entropy is  0.0
________________________________
cal ratio is  0.034140363244585255
distance x is tensor(3677.2659, device='cuda:3')
cal_distance is  tensor(3677.2659, device='cuda:3')
cal ratio is  0.18477097012407637
distance x is tensor(679.4562, device='cuda:3')
cal_distance is  tensor(679.4562, device='cuda:3')
cal ratio is  0.42984860099598315
distance x is tensor(292.0663, device='cuda:3')
cal_distance is  tensor(292.0663, device='cuda:3')
cal ratio is  0.6556250610842462
distance x is tensor(191.4878, device='cuda:3')
cal_distance is  tensor(191.4878, device='cuda:3')
cal ratio is  0.8097030181163287
distance x is tensor(155.0492, device='cuda:3')
cal_distance is  tensor(155.0492, device='cuda:3')
cal ratio is  0.8998320926362248
distance x is tensor(139.5188, device='cuda:3')
cal_distance is  tensor(139.5188, device='cuda:3')
cal ratio is  0.9485930501966388
distance x is tensor(132.3468, device='cuda:3')
cal_distance is  tensor(132.3468, device='cuda:3')
cal ratio is  0.9739564020936692
distance x is tensor(128.9001, device='cuda:3')
cal_distance is  tensor(128.9001, device='cuda:3')
distance x is tensor(128.9001, device='cuda:3')
return_distance is  tensor(128.9001, device='cuda:3')
distance x is tensor(128.8898, device='cuda:3')
distance x is tensor(128.8898, device='cuda:3')
________________________________
test distance is  tensor(128.8898, device='cuda:3')
test distance1 is  tensor(128.8898, device='cuda:3')
test similarity is  tensor(0.9445, device='cuda:3')
test acc is  0.10010000015633198
test loss is 297.110896063766
test entropy is  1.3683634055014829e-05
________________________________
0
distance x is tensor(128.8898, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.357546155520466e-05
avg test loss is  297.4020282119068
avg accuracy is  0.32390000015634
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(128.8898, device='cuda:3')
compute_norm is  tensor(44.2789, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.2678, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9553489793719513
avg test loss is  1.4154870877387935
avg accuracy is  0.8318000001563242
solo acc is  0.3580500001563406
compute similarity  is  tensor(0.9518, device='cuda:3')
compute_distance is  tensor(108.2678, device='cuda:3')
compute_norm is  tensor(43.1187, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.7874, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.867827129643609
avg test loss is  1.5603434005017474
avg accuracy is  0.8311333334896576
solo acc is  0.2775166668230056
compute similarity  is  tensor(0.9513, device='cuda:3')
compute_distance is  tensor(110.7874, device='cuda:3')
compute_norm is  tensor(42.8212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.8709, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8771111691938535
avg test loss is  1.4999529087721413
avg accuracy is  0.8371166668229906
solo acc is  0.2740333334896722
compute similarity  is  tensor(0.9509, device='cuda:3')
compute_distance is  tensor(112.8709, device='cuda:3')
compute_norm is  tensor(42.5537, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.8594, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.870569716066694
avg test loss is  1.4545921601974634
avg accuracy is  0.8413666668229903
solo acc is  0.2755500001563389
compute similarity  is  tensor(0.9505, device='cuda:3')
compute_distance is  tensor(114.8594, device='cuda:3')
compute_norm is  tensor(42.3035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.7338, device='cuda:3')
distance x is tensor(116.7338, device='cuda:3')
________________________________
test distance is  tensor(116.7338, device='cuda:3')
test distance1 is  tensor(116.7338, device='cuda:3')
test similarity is  tensor(0.9501, device='cuda:3')
test acc is  0.27720000015633905
test loss is 1.4229798911731126
test entropy is  0.8704257242079737
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2811559438705444
mal norm is  tensor(611.6172, device='cuda:3')
distance x is tensor(116.7415, device='cuda:3')
mal distance is  tensor(116.7415, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([503.8063, 556.8771, 554.4661, 517.8852, 499.6127, 564.0393, 450.0222,
        594.1790, 611.6172, 611.6172, 611.6172, 611.6172, 611.6172, 611.6172,
        611.6172, 611.6172, 611.6172, 611.6172, 611.6172, 611.6172],
       device='cuda:3')
sorted_norm is   tensor([450.0222, 499.6127, 503.8063, 517.8852, 554.4661, 556.8771, 564.0393,
        594.1790, 611.6172, 611.6172, 611.6172, 611.6172, 611.6172, 611.6172,
        611.6172, 611.6172, 611.6172, 611.6172, 611.6172, 611.6172],
       device='cuda:3')
used idx is  tensor([ 6,  4,  0,  3,  2,  1,  5,  7, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 87.02% 

Test Accuracy: 86.06% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6868473291397095
distance x is tensor(118.7708, device='cuda:3')
benign distance is  tensor(118.7708, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7919021248817444
distance x is tensor(142.3885, device='cuda:3')
benign distance is  tensor(142.3885, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0850466787815094
distance x is tensor(142.5141, device='cuda:3')
benign distance is  tensor(142.5141, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3223502039909363
distance x is tensor(136.2941, device='cuda:3')
benign distance is  tensor(136.2941, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9591882824897766
distance x is tensor(119.6484, device='cuda:3')
benign distance is  tensor(119.6484, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4140397906303406
distance x is tensor(143.8275, device='cuda:3')
benign distance is  tensor(143.8275, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9133206605911255
distance x is tensor(144.0227, device='cuda:3')
benign distance is  tensor(144.0227, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0813981294631958
distance x is tensor(138.8964, device='cuda:3')
benign distance is  tensor(138.8964, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(132.9638, device='cuda:3')
compute distance is  tensor(132.9638, device='cuda:3')
compute norm is  tensor(44.7149, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9945, device='cuda:3')
compute distance is  tensor(120.9945, device='cuda:3')
compute norm is  tensor(44.5002, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.0986, device='cuda:3')
compute distance is  tensor(162.0986, device='cuda:3')
compute norm is  tensor(45.7415, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5139, device='cuda:3')
compute distance is  tensor(130.5139, device='cuda:3')
compute norm is  tensor(44.7902, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.4697, device='cuda:3')
compute distance is  tensor(144.4697, device='cuda:3')
compute norm is  tensor(45.1977, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.7077, device='cuda:3')
compute distance is  tensor(149.7077, device='cuda:3')
compute norm is  tensor(45.3395, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8581, device='cuda:3')
compute distance is  tensor(139.8581, device='cuda:3')
compute norm is  tensor(45.0389, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3199, device='cuda:3')
compute distance is  tensor(138.3199, device='cuda:3')
compute norm is  tensor(45.0249, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1411, device='cuda:3')
compute distance is  tensor(141.1411, device='cuda:3')
compute norm is  tensor(45.0724, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.0158, device='cuda:3')
compute distance is  tensor(130.0158, device='cuda:3')
compute norm is  tensor(44.8192, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.8050, device='cuda:3')
compute distance is  tensor(153.8050, device='cuda:3')
compute norm is  tensor(45.4086, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2867, device='cuda:3')
compute distance is  tensor(141.2867, device='cuda:3')
compute norm is  tensor(45.0103, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.0986, device='cuda:3')
distance x is tensor(107674.3828, device='cuda:3')
distance x is tensor(107674.3828, device='cuda:3')
________________________________
test distance is  tensor(107674.3828, device='cuda:3')
test distance1 is  tensor(107674.3828, device='cuda:3')
test similarity is  tensor(0.0289, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129996666209583.48
test entropy is  0.0
________________________________
cal ratio is  0.0380241497651109
distance x is tensor(4094.2327, device='cuda:3')
cal_distance is  tensor(4094.2327, device='cuda:3')
cal ratio is  0.1949976858894269
distance x is tensor(798.3700, device='cuda:3')
cal_distance is  tensor(798.3700, device='cuda:3')
cal ratio is  0.4415842907719666
distance x is tensor(352.5505, device='cuda:3')
cal_distance is  tensor(352.5505, device='cuda:3')
cal ratio is  0.6645154125390255
distance x is tensor(234.2770, device='cuda:3')
cal_distance is  tensor(234.2770, device='cuda:3')
cal ratio is  0.8151750327913743
distance x is tensor(190.9777, device='cuda:3')
cal_distance is  tensor(190.9777, device='cuda:3')
cal ratio is  0.9028681645409912
distance x is tensor(172.4282, device='cuda:3')
cal_distance is  tensor(172.4282, device='cuda:3')
cal ratio is  0.9501923635752633
distance x is tensor(163.8402, device='cuda:3')
cal_distance is  tensor(163.8402, device='cuda:3')
cal ratio is  0.9747773487596458
distance x is tensor(159.7079, device='cuda:3')
cal_distance is  tensor(159.7079, device='cuda:3')
distance x is tensor(159.7079, device='cuda:3')
return_distance is  tensor(159.7079, device='cuda:3')
distance x is tensor(159.6976, device='cuda:3')
distance x is tensor(159.6976, device='cuda:3')
________________________________
test distance is  tensor(159.6976, device='cuda:3')
test distance1 is  tensor(159.6976, device='cuda:3')
test similarity is  tensor(0.9215, device='cuda:3')
test acc is  0.10000000015633198
test loss is 869.7522048787522
test entropy is  0.0
________________________________
0
distance x is tensor(159.6976, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  870.6505927307519
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9215, device='cuda:3')
compute_distance is  tensor(159.6976, device='cuda:3')
compute_norm is  tensor(45.4726, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.8705, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4004994545664107
avg test loss is  2.3303819235199805
avg accuracy is  0.6702333334896659
solo acc is  0.16310000015633422
compute similarity  is  tensor(0.9236, device='cuda:3')
compute_distance is  tensor(148.8705, device='cuda:3')
compute_norm is  tensor(45.7305, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(150.2175, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7530777247856929
avg test loss is  3.0877005349852635
avg accuracy is  0.6327833334896684
solo acc is  0.1053333334896653
compute similarity  is  tensor(0.9230, device='cuda:3')
compute_distance is  tensor(150.2175, device='cuda:3')
compute_norm is  tensor(45.7531, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.7454, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0643599577295755
avg test loss is  1.603614165457581
avg accuracy is  0.6865166668229983
solo acc is  0.29561666682300614
compute similarity  is  tensor(0.9245, device='cuda:3')
compute_distance is  tensor(151.7454, device='cuda:3')
compute_norm is  tensor(45.3530, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(152.4680, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6385008727055369
avg test loss is  2.5416779505418563
avg accuracy is  0.6186500001563361
solo acc is  0.11381666682299861
compute similarity  is  tensor(0.9242, device='cuda:3')
compute_distance is  tensor(152.4680, device='cuda:3')
compute_norm is  tensor(45.2374, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.3636, device='cuda:3')
distance x is tensor(153.3636, device='cuda:3')
________________________________
test distance is  tensor(153.3636, device='cuda:3')
test distance1 is  tensor(153.3636, device='cuda:3')
test similarity is  tensor(0.9247, device='cuda:3')
test acc is  0.2700333334896721
test loss is 1.531944040677695
test entropy is  0.9739321266918548
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2171624898910522
mal norm is  tensor(776.0216, device='cuda:3')
distance x is tensor(153.3708, device='cuda:3')
mal distance is  tensor(153.3708, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([528.2198, 632.7711, 603.3812, 589.0626, 512.2328, 623.7659, 613.3074,
        599.3871, 776.0216, 776.0216, 776.0216, 776.0216, 776.0216, 776.0216,
        776.0216, 776.0216, 776.0216, 776.0216, 776.0216, 776.0216, 705.6620,
        690.7649, 675.2217, 669.2916, 686.7520, 728.8364, 709.3148, 682.6910],
       device='cuda:3')
sorted_norm is   tensor([512.2328, 528.2198, 589.0626, 599.3871, 603.3812, 613.3074, 623.7659,
        632.7711, 669.2916, 675.2217, 682.6910, 686.7520, 690.7649, 705.6620,
        709.3148, 728.8364, 776.0216, 776.0216, 776.0216, 776.0216, 776.0216,
        776.0216, 776.0216, 776.0216, 776.0216, 776.0216, 776.0216, 776.0216],
       device='cuda:3')
used idx is  tensor([ 4,  0,  3,  7,  2,  6,  5,  1, 23, 22, 27, 24, 21, 20, 26, 25, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 87.87% 

Test Accuracy: 87.03% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1248818188905716
distance x is tensor(116.4595, device='cuda:3')
benign distance is  tensor(116.4595, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.703295111656189
distance x is tensor(133.1242, device='cuda:3')
benign distance is  tensor(133.1242, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25232216715812683
distance x is tensor(138.8264, device='cuda:3')
benign distance is  tensor(138.8264, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6062963008880615
distance x is tensor(112.1144, device='cuda:3')
benign distance is  tensor(112.1144, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7329956889152527
distance x is tensor(121.7175, device='cuda:3')
benign distance is  tensor(121.7175, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0357987880706787
distance x is tensor(141.9264, device='cuda:3')
benign distance is  tensor(141.9264, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5420899987220764
distance x is tensor(128.4183, device='cuda:3')
benign distance is  tensor(128.4183, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10590118169784546
distance x is tensor(147.3806, device='cuda:3')
benign distance is  tensor(147.3806, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1861177384853363
distance x is tensor(151.2410, device='cuda:3')
benign distance is  tensor(151.2410, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3607676923274994
distance x is tensor(142.0447, device='cuda:3')
benign distance is  tensor(142.0447, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6395820379257202
distance x is tensor(141.0756, device='cuda:3')
benign distance is  tensor(141.0756, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.24027934670448303
distance x is tensor(142.2370, device='cuda:3')
benign distance is  tensor(142.2370, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.26836514472961426
distance x is tensor(140.1194, device='cuda:3')
benign distance is  tensor(140.1194, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3094748258590698
distance x is tensor(153.7525, device='cuda:3')
benign distance is  tensor(153.7525, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5075173377990723
distance x is tensor(159.0296, device='cuda:3')
benign distance is  tensor(159.0296, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6927824020385742
distance x is tensor(158.7473, device='cuda:3')
benign distance is  tensor(158.7473, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.5195, device='cuda:3')
compute distance is  tensor(135.5195, device='cuda:3')
compute norm is  tensor(45.1219, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5816, device='cuda:3')
compute distance is  tensor(135.5816, device='cuda:3')
compute norm is  tensor(45.2090, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5130, device='cuda:3')
compute distance is  tensor(137.5130, device='cuda:3')
compute norm is  tensor(45.3143, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1191, device='cuda:3')
compute distance is  tensor(136.1191, device='cuda:3')
compute norm is  tensor(45.1824, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9317, device='cuda:3')
compute distance is  tensor(138.9317, device='cuda:3')
compute norm is  tensor(45.1673, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5286, device='cuda:3')
compute distance is  tensor(148.5286, device='cuda:3')
compute norm is  tensor(45.5605, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3546, device='cuda:3')
compute distance is  tensor(129.3546, device='cuda:3')
compute norm is  tensor(45.0159, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.7324, device='cuda:3')
compute distance is  tensor(139.7324, device='cuda:3')
compute norm is  tensor(45.3129, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9870, device='cuda:3')
compute distance is  tensor(142.9870, device='cuda:3')
compute norm is  tensor(45.3396, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5373, device='cuda:3')
compute distance is  tensor(132.5373, device='cuda:3')
compute norm is  tensor(45.2208, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.3649, device='cuda:3')
compute distance is  tensor(143.3649, device='cuda:3')
compute norm is  tensor(45.4531, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.9262, device='cuda:3')
compute distance is  tensor(137.9262, device='cuda:3')
compute norm is  tensor(45.2456, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(148.5286, device='cuda:3')
distance x is tensor(107675.3047, device='cuda:3')
distance x is tensor(107675.3047, device='cuda:3')
________________________________
test distance is  tensor(107675.3047, device='cuda:3')
test distance1 is  tensor(107675.3047, device='cuda:3')
test similarity is  tensor(0.0544, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130079705979198.77
test entropy is  0.0
________________________________
cal ratio is  0.036397624611425775
distance x is tensor(3919.1304, device='cuda:3')
cal_distance is  tensor(3919.1304, device='cuda:3')
cal ratio is  0.19078148711796675
distance x is tensor(747.7018, device='cuda:3')
cal_distance is  tensor(747.7018, device='cuda:3')
cal ratio is  0.43678415700580053
distance x is tensor(326.5872, device='cuda:3')
cal_distance is  tensor(326.5872, device='cuda:3')
cal ratio is  0.6608935494295416
distance x is tensor(215.8411, device='cuda:3')
cal_distance is  tensor(215.8411, device='cuda:3')
cal ratio is  0.8129503065689948
distance x is tensor(175.4690, device='cuda:3')
cal_distance is  tensor(175.4690, device='cuda:3')
cal ratio is  0.9016351540709138
distance x is tensor(158.2096, device='cuda:3')
cal_distance is  tensor(158.2096, device='cuda:3')
cal ratio is  0.9495430625317609
distance x is tensor(150.2271, device='cuda:3')
cal_distance is  tensor(150.2271, device='cuda:3')
cal ratio is  0.9744441419689113
distance x is tensor(146.3880, device='cuda:3')
cal_distance is  tensor(146.3880, device='cuda:3')
distance x is tensor(146.3880, device='cuda:3')
return_distance is  tensor(146.3880, device='cuda:3')
distance x is tensor(146.3778, device='cuda:3')
distance x is tensor(146.3778, device='cuda:3')
________________________________
test distance is  tensor(146.3778, device='cuda:3')
test distance1 is  tensor(146.3778, device='cuda:3')
test similarity is  tensor(0.9351, device='cuda:3')
test acc is  0.10015000015633198
test loss is 333.7263090544418
test entropy is  7.625282122469975e-05
________________________________
0
distance x is tensor(146.3778, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00010450929250960055
avg test loss is  333.75477245469085
avg accuracy is  0.1430333334896659
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9351, device='cuda:3')
compute_distance is  tensor(146.3778, device='cuda:3')
compute_norm is  tensor(45.6432, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.8479, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9681068414818249
avg test loss is  1.5783249302459423
avg accuracy is  0.6516000001563338
solo acc is  0.2826500001563391
compute similarity  is  tensor(0.9402, device='cuda:3')
compute_distance is  tensor(131.8479, device='cuda:3')
compute_norm is  tensor(45.3415, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(131.8479, device='cuda:3')
distance x is tensor(131.8479, device='cuda:3')
________________________________
test distance is  tensor(131.8479, device='cuda:3')
test distance1 is  tensor(131.8479, device='cuda:3')
test similarity is  tensor(0.9402, device='cuda:3')
test acc is  0.28083333348967243
test loss is 1.5862851543213004
test entropy is  0.9677376879939138
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.4568268060684204
mal norm is  tensor(708.1298, device='cuda:3')
distance x is tensor(131.8573, device='cuda:3')
mal distance is  tensor(131.8573, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([513.9710, 586.9412, 598.8710, 493.0160, 536.6468, 609.8295, 556.2381,
        635.5477, 708.1298, 708.1298, 708.1298, 708.1298, 708.1298, 708.1298,
        708.1298, 708.1298, 708.1298, 708.1298, 708.1298, 708.1298, 681.3431,
        773.4302, 683.8196, 707.2342, 704.2969, 680.4114, 734.7558, 699.3723],
       device='cuda:3')
sorted_norm is   tensor([493.0160, 513.9710, 536.6468, 556.2381, 586.9412, 598.8710, 609.8295,
        635.5477, 680.4114, 681.3431, 683.8196, 699.3723, 704.2969, 707.2342,
        708.1298, 708.1298, 708.1298, 708.1298, 708.1298, 708.1298, 708.1298,
        708.1298, 708.1298, 708.1298, 708.1298, 708.1298, 734.7558, 773.4302],
       device='cuda:3')
used idx is  tensor([ 3,  0,  4,  6,  1,  2,  5,  7, 25, 20, 22, 27, 24, 23, 19, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 86.49% 

Test Accuracy: 85.73% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2613199055194855
distance x is tensor(151.9793, device='cuda:3')
benign distance is  tensor(151.9793, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6188178658485413
distance x is tensor(153.6190, device='cuda:3')
benign distance is  tensor(153.6190, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08284251391887665
distance x is tensor(157.1365, device='cuda:3')
benign distance is  tensor(157.1365, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9202858805656433
distance x is tensor(150.8476, device='cuda:3')
benign distance is  tensor(150.8476, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7265409231185913
distance x is tensor(142.3774, device='cuda:3')
benign distance is  tensor(142.3774, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1057332754135132
distance x is tensor(143.8782, device='cuda:3')
benign distance is  tensor(143.8782, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39631980657577515
distance x is tensor(136.5936, device='cuda:3')
benign distance is  tensor(136.5936, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.07916177809238434
distance x is tensor(159.5229, device='cuda:3')
benign distance is  tensor(159.5229, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2624846398830414
distance x is tensor(156.8846, device='cuda:3')
benign distance is  tensor(156.8846, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6913368105888367
distance x is tensor(165.2711, device='cuda:3')
benign distance is  tensor(165.2711, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8827835321426392
distance x is tensor(168.9750, device='cuda:3')
benign distance is  tensor(168.9750, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.30578237771987915
distance x is tensor(154.8062, device='cuda:3')
benign distance is  tensor(154.8062, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6035052537918091
distance x is tensor(162.8622, device='cuda:3')
benign distance is  tensor(162.8622, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7015753984451294
distance x is tensor(155.5049, device='cuda:3')
benign distance is  tensor(155.5049, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.567416787147522
distance x is tensor(170.8227, device='cuda:3')
benign distance is  tensor(170.8227, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.14711788296699524
distance x is tensor(152.0714, device='cuda:3')
benign distance is  tensor(152.0714, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(146.7938, device='cuda:3')
compute distance is  tensor(146.7938, device='cuda:3')
compute norm is  tensor(45.6485, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.2866, device='cuda:3')
compute distance is  tensor(152.2866, device='cuda:3')
compute norm is  tensor(45.7731, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5444, device='cuda:3')
compute distance is  tensor(158.5444, device='cuda:3')
compute norm is  tensor(46.2363, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3276, device='cuda:3')
compute distance is  tensor(156.3276, device='cuda:3')
compute norm is  tensor(45.8827, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.6985, device='cuda:3')
compute distance is  tensor(151.6985, device='cuda:3')
compute norm is  tensor(45.9297, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5968, device='cuda:3')
compute distance is  tensor(158.5968, device='cuda:3')
compute norm is  tensor(46.0092, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.2607, device='cuda:3')
compute distance is  tensor(152.2607, device='cuda:3')
compute norm is  tensor(45.8207, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.2115, device='cuda:3')
compute distance is  tensor(146.2115, device='cuda:3')
compute norm is  tensor(45.6786, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.3455, device='cuda:3')
compute distance is  tensor(165.3455, device='cuda:3')
compute norm is  tensor(46.1500, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.3656, device='cuda:3')
compute distance is  tensor(154.3656, device='cuda:3')
compute norm is  tensor(45.9299, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.1565, device='cuda:3')
compute distance is  tensor(165.1565, device='cuda:3')
compute norm is  tensor(46.2151, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1533, device='cuda:3')
compute distance is  tensor(142.1533, device='cuda:3')
compute norm is  tensor(45.6572, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(165.3455, device='cuda:3')
distance x is tensor(107653.2969, device='cuda:3')
distance x is tensor(107653.2969, device='cuda:3')
________________________________
test distance is  tensor(107653.2969, device='cuda:3')
test distance1 is  tensor(107653.2969, device='cuda:3')
test similarity is  tensor(0.1193, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130096167763863.2
test entropy is  0.0
________________________________
cal ratio is  0.03840683688828578
distance x is tensor(4134.6284, device='cuda:3')
cal_distance is  tensor(4134.6284, device='cuda:3')
cal ratio is  0.1959764853468392
distance x is tensor(810.2941, device='cuda:3')
cal_distance is  tensor(810.2941, device='cuda:3')
cal ratio is  0.44269119241928423
distance x is tensor(358.7129, device='cuda:3')
cal_distance is  tensor(358.7129, device='cuda:3')
cal ratio is  0.6653477571354306
distance x is tensor(238.6706, device='cuda:3')
cal_distance is  tensor(238.6706, device='cuda:3')
cal ratio is  0.8156855720448715
distance x is tensor(194.6811, device='cuda:3')
cal_distance is  tensor(194.6811, device='cuda:3')
cal ratio is  0.9031509598033616
distance x is tensor(175.8269, device='cuda:3')
cal_distance is  tensor(175.8269, device='cuda:3')
cal ratio is  0.9503411870939863
distance x is tensor(167.0958, device='cuda:3')
cal_distance is  tensor(167.0958, device='cuda:3')
cal ratio is  0.9748537182989944
distance x is tensor(162.8941, device='cuda:3')
cal_distance is  tensor(162.8941, device='cuda:3')
distance x is tensor(162.8941, device='cuda:3')
return_distance is  tensor(162.8941, device='cuda:3')
distance x is tensor(162.8839, device='cuda:3')
distance x is tensor(162.8839, device='cuda:3')
________________________________
test distance is  tensor(162.8839, device='cuda:3')
test distance1 is  tensor(162.8839, device='cuda:3')
test similarity is  tensor(0.9275, device='cuda:3')
test acc is  0.10000000015633198
test loss is 559.9851090160769
test entropy is  3.2864421313206215e-05
________________________________
0
distance x is tensor(162.8839, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.303723633964034e-05
avg test loss is  560.3807809988318
avg accuracy is  0.11023333348966528
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9275, device='cuda:3')
compute_distance is  tensor(162.8839, device='cuda:3')
compute_norm is  tensor(47.2055, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.4046, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3381860159607584
avg test loss is  2.244545041879357
avg accuracy is  0.6342333334896684
solo acc is  0.16750000015633454
compute similarity  is  tensor(0.9287, device='cuda:3')
compute_distance is  tensor(154.4046, device='cuda:3')
compute_norm is  tensor(47.8896, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.8543, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7535524286949304
avg test loss is  2.9850368217618737
avg accuracy is  0.6194833334896694
solo acc is  0.10580000015633195
compute similarity  is  tensor(0.9283, device='cuda:3')
compute_distance is  tensor(155.8543, device='cuda:3')
compute_norm is  tensor(47.8811, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.6578, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1013316834913387
avg test loss is  1.7302340341529359
avg accuracy is  0.7090166668229968
solo acc is  0.23018333348967096
compute similarity  is  tensor(0.9293, device='cuda:3')
compute_distance is  tensor(156.6578, device='cuda:3')
compute_norm is  tensor(47.5200, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.4336, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6494497850632617
avg test loss is  2.5758522604065917
avg accuracy is  0.6690000001563325
solo acc is  0.10935000015633195
compute similarity  is  tensor(0.9289, device='cuda:3')
compute_distance is  tensor(157.4336, device='cuda:3')
compute_norm is  tensor(47.4136, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.2565, device='cuda:3')
distance x is tensor(158.2565, device='cuda:3')
________________________________
test distance is  tensor(158.2565, device='cuda:3')
test distance1 is  tensor(158.2565, device='cuda:3')
test similarity is  tensor(0.9293, device='cuda:3')
test acc is  0.2650000001563387
test loss is 1.5530438327840141
test entropy is  1.0125248517308916
________________________________
0
distance x is tensor(158.2565, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0130116776235576
avg test loss is  1.5510942358960476
avg accuracy is  0.7189500001563295
solo acc is  0.26390000015633863
compute similarity  is  tensor(0.9293, device='cuda:3')
compute_distance is  tensor(158.2565, device='cuda:3')
compute_norm is  tensor(47.0758, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(158.9678, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6084189825474835
avg test loss is  2.4357322993309003
avg accuracy is  0.6658666668229994
solo acc is  0.10930000015633196
compute similarity  is  tensor(0.9288, device='cuda:3')
compute_distance is  tensor(158.9678, device='cuda:3')
compute_norm is  tensor(46.9536, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.9650, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9680654000498847
avg test loss is  1.5239226759623872
avg accuracy is  0.7235333334896626
solo acc is  0.2434000001563381
compute similarity  is  tensor(0.9288, device='cuda:3')
compute_distance is  tensor(159.9650, device='cuda:3')
compute_norm is  tensor(46.6379, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(159.9650, device='cuda:3')
distance x is tensor(159.9650, device='cuda:3')
________________________________
test distance is  tensor(159.9650, device='cuda:3')
test distance1 is  tensor(159.9650, device='cuda:3')
test similarity is  tensor(0.9288, device='cuda:3')
test acc is  0.24345000015633803
test loss is 1.5234093283539387
test entropy is  0.9708473028531716
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.5607596635818481
mal norm is  tensor(791.3790, device='cuda:3')
distance x is tensor(159.9731, device='cuda:3')
mal distance is  tensor(159.9731, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([637.7861, 658.2704, 660.3111, 625.5664, 615.5447, 603.6368, 581.6763,
        679.0237, 791.3790, 791.3790, 791.3790, 791.3790, 791.3790, 791.3790,
        791.3790, 791.3790, 791.3790, 791.3790, 791.3790, 791.3790, 835.4896,
        743.2209, 804.5766, 791.5833, 762.4690, 824.5731, 766.0028, 807.4136,
        683.9905, 640.9326, 639.0793, 647.5065, 627.8791, 696.8789, 710.5363,
        724.3738], device='cuda:3')
sorted_norm is   tensor([581.6763, 603.6368, 615.5447, 625.5664, 627.8791, 637.7861, 639.0793,
        640.9326, 647.5065, 658.2704, 660.3111, 679.0237, 683.9905, 696.8789,
        710.5363, 724.3738, 743.2209, 762.4690, 766.0028, 791.3790, 791.3790,
        791.3790, 791.3790, 791.3790, 791.3790, 791.3790, 791.3790, 791.3790,
        791.3790, 791.3790, 791.3790, 791.5833, 804.5766, 807.4136, 824.5731,
        835.4896], device='cuda:3')
used idx is  tensor([ 6,  5,  4,  3, 32,  0, 30, 29, 31,  1,  2,  7, 28, 33, 34, 35, 21, 24,
        26, 19, 13, 11,  8, 10, 16, 18, 17,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 86.88% 

Test Accuracy: 85.88% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8394676446914673
distance x is tensor(130.9781, device='cuda:3')
benign distance is  tensor(130.9781, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6090307831764221
distance x is tensor(144.0403, device='cuda:3')
benign distance is  tensor(144.0403, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3286689221858978
distance x is tensor(137.1969, device='cuda:3')
benign distance is  tensor(137.1969, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3752758204936981
distance x is tensor(139.1064, device='cuda:3')
benign distance is  tensor(139.1064, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4008112847805023
distance x is tensor(145.4757, device='cuda:3')
benign distance is  tensor(145.4757, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0117077827453613
distance x is tensor(143.9261, device='cuda:3')
benign distance is  tensor(143.9261, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2913194000720978
distance x is tensor(143.8038, device='cuda:3')
benign distance is  tensor(143.8038, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.391488641500473
distance x is tensor(147.3117, device='cuda:3')
benign distance is  tensor(147.3117, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.30553531646728516
distance x is tensor(151.3748, device='cuda:3')
benign distance is  tensor(151.3748, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8974162936210632
distance x is tensor(146.6252, device='cuda:3')
benign distance is  tensor(146.6252, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5983167886734009
distance x is tensor(143.7749, device='cuda:3')
benign distance is  tensor(143.7749, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8778843879699707
distance x is tensor(145.5972, device='cuda:3')
benign distance is  tensor(145.5972, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5787614583969116
distance x is tensor(147.0825, device='cuda:3')
benign distance is  tensor(147.0825, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3105791211128235
distance x is tensor(152.1321, device='cuda:3')
benign distance is  tensor(152.1321, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.480203241109848
distance x is tensor(150.6497, device='cuda:3')
benign distance is  tensor(150.6497, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.42379888892173767
distance x is tensor(162.5268, device='cuda:3')
benign distance is  tensor(162.5268, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4113147258758545
distance x is tensor(143.0912, device='cuda:3')
benign distance is  tensor(143.0912, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.23858197033405304
distance x is tensor(139.6404, device='cuda:3')
benign distance is  tensor(139.6404, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6351527571678162
distance x is tensor(161.0241, device='cuda:3')
benign distance is  tensor(161.0241, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.9185674786567688
distance x is tensor(156.1419, device='cuda:3')
benign distance is  tensor(156.1419, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.507041335105896
distance x is tensor(144.4942, device='cuda:3')
benign distance is  tensor(144.4942, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.44992542266845703
distance x is tensor(143.2913, device='cuda:3')
benign distance is  tensor(143.2913, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7045570015907288
distance x is tensor(143.4254, device='cuda:3')
benign distance is  tensor(143.4254, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3937707841396332
distance x is tensor(147.0634, device='cuda:3')
benign distance is  tensor(147.0634, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(134.5687, device='cuda:3')
compute distance is  tensor(134.5687, device='cuda:3')
compute norm is  tensor(45.7842, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8770, device='cuda:3')
compute distance is  tensor(138.8770, device='cuda:3')
compute norm is  tensor(45.8116, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.2933, device='cuda:3')
compute distance is  tensor(154.2933, device='cuda:3')
compute norm is  tensor(46.4657, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2766, device='cuda:3')
compute distance is  tensor(147.2766, device='cuda:3')
compute norm is  tensor(46.0819, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6458, device='cuda:3')
compute distance is  tensor(133.6458, device='cuda:3')
compute norm is  tensor(45.8747, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.3835, device='cuda:3')
compute distance is  tensor(143.3835, device='cuda:3')
compute norm is  tensor(46.0340, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6446, device='cuda:3')
compute distance is  tensor(138.6446, device='cuda:3')
compute norm is  tensor(45.7521, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3371, device='cuda:3')
compute distance is  tensor(148.3371, device='cuda:3')
compute norm is  tensor(46.0816, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0467, device='cuda:3')
compute distance is  tensor(144.0467, device='cuda:3')
compute norm is  tensor(45.9327, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.8235, device='cuda:3')
compute distance is  tensor(151.8235, device='cuda:3')
compute norm is  tensor(46.1718, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.1341, device='cuda:3')
compute distance is  tensor(166.1341, device='cuda:3')
compute norm is  tensor(46.4947, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1422, device='cuda:3')
compute distance is  tensor(141.1422, device='cuda:3')
compute norm is  tensor(45.9595, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(166.1341, device='cuda:3')
distance x is tensor(107649.1562, device='cuda:3')
distance x is tensor(107649.1562, device='cuda:3')
________________________________
test distance is  tensor(107649.1562, device='cuda:3')
test distance1 is  tensor(107649.1562, device='cuda:3')
test similarity is  tensor(0.1578, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130035532901989.53
test entropy is  0.0
________________________________
cal ratio is  0.03849906117035587
distance x is tensor(4144.3970, device='cuda:3')
cal_distance is  tensor(4144.3970, device='cuda:3')
cal ratio is  0.1962116472921381
distance x is tensor(813.1830, device='cuda:3')
cal_distance is  tensor(813.1830, device='cuda:3')
cal ratio is  0.4429567312329084
distance x is tensor(360.2078, device='cuda:3')
cal_distance is  tensor(360.2078, device='cuda:3')
cal ratio is  0.6655472677538425
distance x is tensor(239.7370, device='cuda:3')
cal_distance is  tensor(239.7370, device='cuda:3')
cal ratio is  0.8158079556877997
distance x is tensor(195.5803, device='cuda:3')
cal_distance is  tensor(195.5803, device='cuda:3')
cal ratio is  0.9032186818620578
distance x is tensor(176.6523, device='cuda:3')
cal_distance is  tensor(176.6523, device='cuda:3')
cal ratio is  0.9503768157394746
distance x is tensor(167.8865, device='cuda:3')
cal_distance is  tensor(167.8865, device='cuda:3')
cal ratio is  0.9748719803320326
distance x is tensor(163.6680, device='cuda:3')
cal_distance is  tensor(163.6680, device='cuda:3')
distance x is tensor(163.6680, device='cuda:3')
return_distance is  tensor(163.6680, device='cuda:3')
distance x is tensor(163.6578, device='cuda:3')
distance x is tensor(163.6578, device='cuda:3')
________________________________
test distance is  tensor(163.6578, device='cuda:3')
test distance1 is  tensor(163.6578, device='cuda:3')
test similarity is  tensor(0.9302, device='cuda:3')
test acc is  0.10761666682299861
test loss is 205.11115160781438
test entropy is  0.0038428137577861126
________________________________
0
distance x is tensor(163.6578, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0037384318509742606
avg test loss is  204.6308234403891
avg accuracy is  0.3976666668230078
solo acc is  0.10815000015633196
compute similarity  is  tensor(0.9302, device='cuda:3')
compute_distance is  tensor(163.6578, device='cuda:3')
compute_norm is  tensor(47.7391, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.9186, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0544951814197019
avg test loss is  1.726714061521518
avg accuracy is  0.6858333334896649
solo acc is  0.24218333348967133
compute similarity  is  tensor(0.9334, device='cuda:3')
compute_distance is  tensor(155.9186, device='cuda:3')
compute_norm is  tensor(47.9038, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.0485, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6487044157631108
avg test loss is  2.5832348009670723
avg accuracy is  0.6353000001563348
solo acc is  0.10970000015633195
compute similarity  is  tensor(0.9331, device='cuda:3')
compute_distance is  tensor(157.0485, device='cuda:3')
compute_norm is  tensor(47.7705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.0477, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9970778460060356
avg test loss is  1.5875259655625074
avg accuracy is  0.7136333334896632
solo acc is  0.2541333334896718
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(158.0477, device='cuda:3')
compute_norm is  tensor(47.4744, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(158.0477, device='cuda:3')
distance x is tensor(158.0477, device='cuda:3')
________________________________
test distance is  tensor(158.0477, device='cuda:3')
test distance1 is  tensor(158.0477, device='cuda:3')
test similarity is  tensor(0.9332, device='cuda:3')
test acc is  0.2570666668230052
test loss is 1.590998344711149
test entropy is  0.9965617125476601
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.5562540292739868
mal norm is  tensor(800.7587, device='cuda:3')
distance x is tensor(158.0570, device='cuda:3')
mal distance is  tensor(158.0570, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([559.7441, 607.8873, 576.2765, 592.1053, 605.1650, 607.3611, 590.3470,
        627.8567, 800.7587, 800.7587, 800.7587, 800.7587, 800.7587, 800.7587,
        800.7587, 800.7587, 800.7587, 800.7587, 800.7587, 800.7587, 871.9388,
        855.1253, 902.5970, 850.4004, 865.3891, 848.8069, 842.0165, 853.4805],
       device='cuda:3')
sorted_norm is   tensor([559.7441, 576.2765, 590.3470, 592.1053, 605.1650, 607.3611, 607.8873,
        627.8567, 800.7587, 800.7587, 800.7587, 800.7587, 800.7587, 800.7587,
        800.7587, 800.7587, 800.7587, 800.7587, 800.7587, 800.7587, 842.0165,
        848.8069, 850.4004, 853.4805, 855.1253, 865.3891, 871.9388, 902.5970],
       device='cuda:3')
used idx is  tensor([ 0,  2,  6,  3,  4,  5,  1,  7, 18, 16, 12, 14, 10,  8, 17, 19, 15, 13,
         9, 11, 26, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 71.98% 

Test Accuracy: 71.17% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9184828996658325
distance x is tensor(158.3276, device='cuda:3')
benign distance is  tensor(158.3276, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8598141670227051
distance x is tensor(179.6489, device='cuda:3')
benign distance is  tensor(179.6489, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4813443124294281
distance x is tensor(190.3461, device='cuda:3')
benign distance is  tensor(190.3461, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6082397699356079
distance x is tensor(178.9862, device='cuda:3')
benign distance is  tensor(178.9862, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.40872612595558167
distance x is tensor(178.6180, device='cuda:3')
benign distance is  tensor(178.6180, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3412702083587646
distance x is tensor(181.1340, device='cuda:3')
benign distance is  tensor(181.1340, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4113996624946594
distance x is tensor(186.4813, device='cuda:3')
benign distance is  tensor(186.4813, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23899178206920624
distance x is tensor(180.0362, device='cuda:3')
benign distance is  tensor(180.0362, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.3820364475250244
distance x is tensor(173.0756, device='cuda:3')
benign distance is  tensor(173.0756, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.13656604290008545
distance x is tensor(178.3024, device='cuda:3')
benign distance is  tensor(178.3024, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5549664497375488
distance x is tensor(178.7579, device='cuda:3')
benign distance is  tensor(178.7579, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2048550546169281
distance x is tensor(176.4792, device='cuda:3')
benign distance is  tensor(176.4792, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.37607064843177795
distance x is tensor(182.8809, device='cuda:3')
benign distance is  tensor(182.8809, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.24505707621574402
distance x is tensor(183.5411, device='cuda:3')
benign distance is  tensor(183.5411, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.671183705329895
distance x is tensor(173.2522, device='cuda:3')
benign distance is  tensor(173.2522, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.06829864531755447
distance x is tensor(194.7397, device='cuda:3')
benign distance is  tensor(194.7397, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(168.5500, device='cuda:3')
compute distance is  tensor(168.5500, device='cuda:3')
compute norm is  tensor(47.5931, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.6710, device='cuda:3')
compute distance is  tensor(173.6710, device='cuda:3')
compute norm is  tensor(47.7127, device='cuda:3', dtype=torch.float64)
distance x is tensor(184.9539, device='cuda:3')
compute distance is  tensor(184.9539, device='cuda:3')
compute norm is  tensor(48.1020, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.7045, device='cuda:3')
compute distance is  tensor(178.7045, device='cuda:3')
compute norm is  tensor(47.9434, device='cuda:3', dtype=torch.float64)
distance x is tensor(190.8981, device='cuda:3')
compute distance is  tensor(190.8981, device='cuda:3')
compute norm is  tensor(48.2966, device='cuda:3', dtype=torch.float64)
distance x is tensor(194.0655, device='cuda:3')
compute distance is  tensor(194.0655, device='cuda:3')
compute norm is  tensor(48.5165, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.2277, device='cuda:3')
compute distance is  tensor(172.2277, device='cuda:3')
compute norm is  tensor(47.8341, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.9202, device='cuda:3')
compute distance is  tensor(168.9202, device='cuda:3')
compute norm is  tensor(47.8355, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.8016, device='cuda:3')
compute distance is  tensor(175.8016, device='cuda:3')
compute norm is  tensor(47.8575, device='cuda:3', dtype=torch.float64)
distance x is tensor(180.9748, device='cuda:3')
compute distance is  tensor(180.9748, device='cuda:3')
compute norm is  tensor(47.8755, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.6756, device='cuda:3')
compute distance is  tensor(174.6756, device='cuda:3')
compute norm is  tensor(47.7684, device='cuda:3', dtype=torch.float64)
distance x is tensor(193.0293, device='cuda:3')
compute distance is  tensor(193.0293, device='cuda:3')
compute norm is  tensor(48.3521, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(194.0655, device='cuda:3')
distance x is tensor(107596.2031, device='cuda:3')
distance x is tensor(107596.2031, device='cuda:3')
________________________________
test distance is  tensor(107596.2031, device='cuda:3')
test distance1 is  tensor(107596.2031, device='cuda:3')
test similarity is  tensor(0.3115, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130023146648294.34
test entropy is  0.0
________________________________
cal ratio is  0.04161997173156093
distance x is tensor(4478.1567, device='cuda:3')
cal_distance is  tensor(4478.1567, device='cuda:3')
cal ratio is  0.20400959817734987
distance x is tensor(913.5910, device='cuda:3')
cal_distance is  tensor(913.5910, device='cuda:3')
cal ratio is  0.4516732215566995
distance x is tensor(412.6474, device='cuda:3')
cal_distance is  tensor(412.6474, device='cuda:3')
cal ratio is  0.6720641224140119
distance x is tensor(277.3271, device='cuda:3')
cal_distance is  tensor(277.3271, device='cuda:3')
cal ratio is  0.81979276066327
distance x is tensor(227.3517, device='cuda:3')
cal_distance is  tensor(227.3517, device='cuda:3')
cal ratio is  0.9054221863248508
distance x is tensor(205.8498, device='cuda:3')
cal_distance is  tensor(205.8498, device='cuda:3')
cal ratio is  0.9515356297700219
distance x is tensor(195.8736, device='cuda:3')
cal_distance is  tensor(195.8736, device='cuda:3')
cal ratio is  0.975466249234515
distance x is tensor(191.0683, device='cuda:3')
cal_distance is  tensor(191.0683, device='cuda:3')
distance x is tensor(191.0683, device='cuda:3')
return_distance is  tensor(191.0683, device='cuda:3')
distance x is tensor(191.0581, device='cuda:3')
distance x is tensor(191.0581, device='cuda:3')
________________________________
test distance is  tensor(191.0581, device='cuda:3')
test distance1 is  tensor(191.0581, device='cuda:3')
test similarity is  tensor(0.9298, device='cuda:3')
test acc is  0.1017333334896653
test loss is 404.7831192504623
test entropy is  0.0012401938585291181
________________________________
0
distance x is tensor(191.0581, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0011869307811491583
avg test loss is  404.4644135107109
avg accuracy is  0.22098333348967056
solo acc is  0.1015333334896653
compute similarity  is  tensor(0.9298, device='cuda:3')
compute_distance is  tensor(191.0581, device='cuda:3')
compute_norm is  tensor(51.4710, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2464.5896, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5770134534408797
avg test loss is  2.865064151759849
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2858, device='cuda:3')
compute_distance is  tensor(2464.5896, device='cuda:3')
compute_norm is  tensor(171.4115, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2453.0708, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.844435124191394
avg test loss is  3.6520181767213575
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2859, device='cuda:3')
compute_distance is  tensor(2453.0708, device='cuda:3')
compute_norm is  tensor(170.7642, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2441.5586, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.561629927870053
avg test loss is  2.8601381494038143
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2857, device='cuda:3')
compute_distance is  tensor(2441.5586, device='cuda:3')
compute_norm is  tensor(169.8324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2430.2126, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8369947482527954
avg test loss is  3.6350315272935165
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2858, device='cuda:3')
compute_distance is  tensor(2430.2126, device='cuda:3')
compute_norm is  tensor(169.1967, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2418.8074, device='cuda:3')
distance x is tensor(2418.8074, device='cuda:3')
________________________________
test distance is  tensor(2418.8074, device='cuda:3')
test distance1 is  tensor(2418.8074, device='cuda:3')
test similarity is  tensor(0.2857, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8603604887085936
test entropy is  1.556009554659634
________________________________
cal ratio is  0.27758730949133015
distance x is tensor(671.4305, device='cuda:3')
cal_distance is  tensor(671.4305, device='cuda:3')
cal ratio is  0.5268654507600891
distance x is tensor(353.7536, device='cuda:3')
cal_distance is  tensor(353.7536, device='cuda:3')
cal ratio is  0.7258548925711168
distance x is tensor(256.7738, device='cuda:3')
cal_distance is  tensor(256.7738, device='cuda:3')
cal ratio is  0.8519711016088116
distance x is tensor(218.7639, device='cuda:3')
cal_distance is  tensor(218.7639, device='cuda:3')
cal ratio is  0.9230226862285065
distance x is tensor(201.9241, device='cuda:3')
cal_distance is  tensor(201.9241, device='cuda:3')
cal ratio is  0.9607406621906528
distance x is tensor(193.9967, device='cuda:3')
cal_distance is  tensor(193.9967, device='cuda:3')
distance x is tensor(193.9967, device='cuda:3')
return_distance is  tensor(193.9967, device='cuda:3')
distance x is tensor(193.9963, device='cuda:3')
distance x is tensor(193.9963, device='cuda:3')
________________________________
test distance is  tensor(193.9963, device='cuda:3')
test distance1 is  tensor(193.9963, device='cuda:3')
test similarity is  tensor(0.9465, device='cuda:3')
test acc is  0.11008333348966527
test loss is 2.5497594395680214
test entropy is  2.0205969838445377
________________________________
0
distance x is tensor(193.9963, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0211370676311096
avg test loss is  2.551010632819967
avg accuracy is  0.37276666682300746
solo acc is  0.11278333348966527
compute similarity  is  tensor(0.9465, device='cuda:3')
compute_distance is  tensor(193.9963, device='cuda:3')
compute_norm is  tensor(49.1020, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(195.4537, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7532386375007345
avg test loss is  2.915118374041657
avg accuracy is  0.37591666682300745
solo acc is  0.10595000015633195
compute similarity  is  tensor(0.9464, device='cuda:3')
compute_distance is  tensor(195.4537, device='cuda:3')
compute_norm is  tensor(49.0899, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(197.7671, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1104370975163953
avg test loss is  1.8041410392789698
avg accuracy is  0.4761500001563419
solo acc is  0.1998166668230031
compute similarity  is  tensor(0.9461, device='cuda:3')
compute_distance is  tensor(197.7671, device='cuda:3')
compute_norm is  tensor(48.8160, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(197.6292, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6689665777596838
avg test loss is  2.5946574775394855
avg accuracy is  0.4265500001563414
solo acc is  0.10520000015633195
compute similarity  is  tensor(0.9458, device='cuda:3')
compute_distance is  tensor(197.6292, device='cuda:3')
compute_norm is  tensor(48.7145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(198.8863, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9933422108703076
avg test loss is  1.5807444482469863
avg accuracy is  0.5300333334896756
solo acc is  0.24750000015633816
compute similarity  is  tensor(0.9455, device='cuda:3')
compute_distance is  tensor(198.8863, device='cuda:3')
compute_norm is  tensor(48.4407, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(198.8863, device='cuda:3')
distance x is tensor(198.8863, device='cuda:3')
________________________________
test distance is  tensor(198.8863, device='cuda:3')
test distance1 is  tensor(198.8863, device='cuda:3')
test similarity is  tensor(0.9455, device='cuda:3')
test acc is  0.2470333334896715
test loss is 1.5788935476274633
test entropy is  0.9932219342890579
________________________________
cal ratio is  0.9680501188572191
distance x is tensor(192.5295, device='cuda:3')
cal_distance is  tensor(192.5295, device='cuda:3')
distance x is tensor(192.5295, device='cuda:3')
return_distance is  tensor(192.5295, device='cuda:3')
distance x is tensor(192.5319, device='cuda:3')
distance x is tensor(192.5319, device='cuda:3')
________________________________
test distance is  tensor(192.5319, device='cuda:3')
test distance1 is  tensor(192.5319, device='cuda:3')
test similarity is  tensor(0.9486, device='cuda:3')
test acc is  0.23691666682300455
test loss is 1.5835977790198092
test entropy is  1.036164787341791
________________________________
0
distance x is tensor(192.5319, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0355122255236864
avg test loss is  1.5848537450914444
avg accuracy is  0.5355500001563424
solo acc is  0.2339666668230044
compute similarity  is  tensor(0.9486, device='cuda:3')
compute_distance is  tensor(192.5319, device='cuda:3')
compute_norm is  tensor(48.2629, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.3919, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.5981449407936413
avg test loss is  2.4482455925900797
avg accuracy is  0.45703333348967506
solo acc is  0.10635000015633195
compute similarity  is  tensor(0.9483, device='cuda:3')
compute_distance is  tensor(192.3919, device='cuda:3')
compute_norm is  tensor(48.1035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.9674, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9698706395082128
avg test loss is  1.5037896229005825
avg accuracy is  0.5728000001563399
solo acc is  0.24931666682300485
compute similarity  is  tensor(0.9479, device='cuda:3')
compute_distance is  tensor(193.9674, device='cuda:3')
compute_norm is  tensor(47.8217, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(193.9646, device='cuda:3')
________________________________
test distance is  tensor(193.9646, device='cuda:3')
test similarity is  tensor(0.9479, device='cuda:3')
test acc is  0.575033333489673
test loss is 1.5018652569510536
test entropy is  0.9707887233066153
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.6033239364624023
mal norm is  tensor(684.3594, device='cuda:3')
distance x is tensor(193.9646, device='cuda:3')
mal distance is  tensor(193.9646, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 649.8169,  730.0516,  754.9802,  720.7622,  711.7170,  722.9974,
         748.6141,  727.4097,  684.3594,  684.3593,  684.3594,  684.3593,
         684.3594,  684.3593,  684.3594,  684.3593,  684.3594,  684.3593,
         684.3594,  684.3593, 1119.2664, 1113.2612, 1132.6578, 1126.1624,
        1139.5391, 1115.3129, 1139.9302, 1140.9546,  850.0463,  877.9681,
         899.0927,  848.6022,  878.8334,  847.9965,  905.6031,  826.2016,
         768.6760,  749.8116,  732.5437,  747.5841,  752.6234,  763.4866,
         763.4832,  811.3012], device='cuda:3')
sorted_norm is   tensor([ 649.8169,  684.3593,  684.3593,  684.3593,  684.3593,  684.3593,
         684.3593,  684.3594,  684.3594,  684.3594,  684.3594,  684.3594,
         684.3594,  711.7170,  720.7622,  722.9974,  727.4097,  730.0516,
         732.5437,  747.5841,  748.6141,  749.8116,  752.6234,  754.9802,
         763.4832,  763.4866,  768.6760,  811.3012,  826.2016,  847.9965,
         848.6022,  850.0463,  877.9681,  878.8334,  899.0927,  905.6031,
        1113.2612, 1115.3129, 1119.2664, 1126.1624, 1132.6578, 1139.5391,
        1139.9302, 1140.9546], device='cuda:3')
used idx is  tensor([ 0, 11, 15, 13, 17,  9, 19, 16, 14, 12, 10,  8, 18,  4,  3,  5,  7,  1,
        38, 39,  6, 37, 40,  2, 42, 41, 36, 43, 35, 33, 31, 28, 29, 32, 30],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 59.68% 

Test Accuracy: 59.08% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6628315448760986
distance x is tensor(157.2111, device='cuda:3')
benign distance is  tensor(157.2111, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6822911500930786
distance x is tensor(172.2377, device='cuda:3')
benign distance is  tensor(172.2377, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2170792818069458
distance x is tensor(158.5625, device='cuda:3')
benign distance is  tensor(158.5625, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0697896480560303
distance x is tensor(153.8510, device='cuda:3')
benign distance is  tensor(153.8510, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6014148592948914
distance x is tensor(136.8217, device='cuda:3')
benign distance is  tensor(136.8217, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8366442918777466
distance x is tensor(163.8811, device='cuda:3')
benign distance is  tensor(163.8811, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7608696222305298
distance x is tensor(152.7319, device='cuda:3')
benign distance is  tensor(152.7319, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.12138489633798599
distance x is tensor(153.3315, device='cuda:3')
benign distance is  tensor(153.3315, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.30641865730285645
distance x is tensor(155.3316, device='cuda:3')
benign distance is  tensor(155.3316, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3881344199180603
distance x is tensor(164.8024, device='cuda:3')
benign distance is  tensor(164.8024, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8946514129638672
distance x is tensor(160.5831, device='cuda:3')
benign distance is  tensor(160.5831, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5831331610679626
distance x is tensor(166.1310, device='cuda:3')
benign distance is  tensor(166.1310, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.372447669506073
distance x is tensor(154.9670, device='cuda:3')
benign distance is  tensor(154.9670, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2578526735305786
distance x is tensor(159.8528, device='cuda:3')
benign distance is  tensor(159.8528, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.654133141040802
distance x is tensor(160.7723, device='cuda:3')
benign distance is  tensor(160.7723, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0871686935424805
distance x is tensor(153.5841, device='cuda:3')
benign distance is  tensor(153.5841, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4917027950286865
distance x is tensor(162.9188, device='cuda:3')
benign distance is  tensor(162.9188, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7930108308792114
distance x is tensor(164.8531, device='cuda:3')
benign distance is  tensor(164.8531, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.04073266312479973
distance x is tensor(152.0069, device='cuda:3')
benign distance is  tensor(152.0069, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2560500204563141
distance x is tensor(152.5406, device='cuda:3')
benign distance is  tensor(152.5406, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.11219346523284912
distance x is tensor(164.7897, device='cuda:3')
benign distance is  tensor(164.7897, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.45558419823646545
distance x is tensor(174.0067, device='cuda:3')
benign distance is  tensor(174.0067, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.28654175996780396
distance x is tensor(153.6493, device='cuda:3')
benign distance is  tensor(153.6493, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3949379622936249
distance x is tensor(159.6505, device='cuda:3')
benign distance is  tensor(159.6505, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4660610556602478
distance x is tensor(155.2368, device='cuda:3')
benign distance is  tensor(155.2368, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5655625462532043
distance x is tensor(150.8048, device='cuda:3')
benign distance is  tensor(150.8048, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5277224779129028
distance x is tensor(162.2095, device='cuda:3')
benign distance is  tensor(162.2095, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8171656727790833
distance x is tensor(169.0639, device='cuda:3')
benign distance is  tensor(169.0639, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3070027232170105
distance x is tensor(155.3135, device='cuda:3')
benign distance is  tensor(155.3135, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5151036977767944
distance x is tensor(165.2583, device='cuda:3')
benign distance is  tensor(165.2583, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0270819664001465
distance x is tensor(164.0899, device='cuda:3')
benign distance is  tensor(164.0899, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5058189034461975
distance x is tensor(152.2656, device='cuda:3')
benign distance is  tensor(152.2656, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(157.0415, device='cuda:3')
compute distance is  tensor(157.0415, device='cuda:3')
compute norm is  tensor(47.2915, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.5006, device='cuda:3')
compute distance is  tensor(145.5006, device='cuda:3')
compute norm is  tensor(47.1865, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5364, device='cuda:3')
compute distance is  tensor(158.5364, device='cuda:3')
compute norm is  tensor(47.4126, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.2934, device='cuda:3')
compute distance is  tensor(152.2934, device='cuda:3')
compute norm is  tensor(47.2401, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6447, device='cuda:3')
compute distance is  tensor(152.6447, device='cuda:3')
compute norm is  tensor(47.2417, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.2912, device='cuda:3')
compute distance is  tensor(162.2912, device='cuda:3')
compute norm is  tensor(47.6319, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.2164, device='cuda:3')
compute distance is  tensor(172.2164, device='cuda:3')
compute norm is  tensor(48.0228, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.4296, device='cuda:3')
compute distance is  tensor(155.4296, device='cuda:3')
compute norm is  tensor(47.4089, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.7173, device='cuda:3')
compute distance is  tensor(164.7173, device='cuda:3')
compute norm is  tensor(47.7213, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.3042, device='cuda:3')
compute distance is  tensor(152.3042, device='cuda:3')
compute norm is  tensor(47.3990, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.7676, device='cuda:3')
compute distance is  tensor(174.7676, device='cuda:3')
compute norm is  tensor(47.9736, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4663, device='cuda:3')
compute distance is  tensor(147.4663, device='cuda:3')
compute norm is  tensor(47.0999, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(174.7676, device='cuda:3')
distance x is tensor(107670.2109, device='cuda:3')
distance x is tensor(107670.2109, device='cuda:3')
________________________________
test distance is  tensor(107670.2109, device='cuda:3')
test distance1 is  tensor(107670.2109, device='cuda:3')
test similarity is  tensor(0.1804, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130076239516617.42
test entropy is  0.0
________________________________
cal ratio is  0.03948287583893807
distance x is tensor(4251.1348, device='cuda:3')
cal_distance is  tensor(4251.1348, device='cuda:3')
cal ratio is  0.1987028660493198
distance x is tensor(844.7168, device='cuda:3')
cal_distance is  tensor(844.7168, device='cuda:3')
cal ratio is  0.4457599071069242
distance x is tensor(376.5436, device='cuda:3')
cal_distance is  tensor(376.5436, device='cuda:3')
cal ratio is  0.6676500939894003
distance x is tensor(251.4012, device='cuda:3')
cal_distance is  tensor(251.4012, device='cuda:3')
cal ratio is  0.8170957304445101
distance x is tensor(205.4197, device='cuda:3')
cal_distance is  tensor(205.4197, device='cuda:3')
cal ratio is  0.9039314678238535
distance x is tensor(185.6858, device='cuda:3')
cal_distance is  tensor(185.6858, device='cuda:3')
cal ratio is  0.9507518444168773
distance x is tensor(176.5414, device='cuda:3')
cal_distance is  tensor(176.5414, device='cuda:3')
cal ratio is  0.9750643274654333
distance x is tensor(172.1394, device='cuda:3')
cal_distance is  tensor(172.1394, device='cuda:3')
distance x is tensor(172.1394, device='cuda:3')
return_distance is  tensor(172.1394, device='cuda:3')
distance x is tensor(172.1292, device='cuda:3')
distance x is tensor(172.1292, device='cuda:3')
________________________________
test distance is  tensor(172.1292, device='cuda:3')
test distance1 is  tensor(172.1292, device='cuda:3')
test similarity is  tensor(0.9291, device='cuda:3')
test acc is  0.1005833334896653
test loss is 98.81490390183829
test entropy is  0.0028547801939822815
________________________________
0
distance x is tensor(172.1292, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.002874243243860227
avg test loss is  99.00315533213015
avg accuracy is  0.35411666682300713
solo acc is  0.10085000015633197
compute similarity  is  tensor(0.9291, device='cuda:3')
compute_distance is  tensor(172.1292, device='cuda:3')
compute_norm is  tensor(49.2131, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.3674, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9874130995797196
avg test loss is  1.5244798215467539
avg accuracy is  0.6516333334896671
solo acc is  0.2783333334896723
compute similarity  is  tensor(0.9317, device='cuda:3')
compute_distance is  tensor(163.3674, device='cuda:3')
compute_norm is  tensor(49.0741, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(163.3674, device='cuda:3')
distance x is tensor(163.3674, device='cuda:3')
________________________________
test distance is  tensor(163.3674, device='cuda:3')
test distance1 is  tensor(163.3674, device='cuda:3')
test similarity is  tensor(0.9317, device='cuda:3')
test acc is  0.27360000015633895
test loss is 1.5275648060892182
test entropy is  0.9871573626105465
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.28596830368042
mal norm is  tensor(854.9280, device='cuda:3')
distance x is tensor(163.3770, device='cuda:3')
mal distance is  tensor(163.3770, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([673.9916, 726.1443, 679.5909, 655.1732, 566.8226, 688.7885, 638.7410,
        641.5410, 854.9280, 854.9280, 854.9280, 854.9280, 854.9280, 854.9280,
        854.9280, 854.9280, 854.9280, 854.9280, 854.9280, 854.9280],
       device='cuda:3')
sorted_norm is   tensor([566.8226, 638.7410, 641.5410, 655.1732, 673.9916, 679.5909, 688.7885,
        726.1443, 854.9280, 854.9280, 854.9280, 854.9280, 854.9280, 854.9280,
        854.9280, 854.9280, 854.9280, 854.9280, 854.9280, 854.9280],
       device='cuda:3')
used idx is  tensor([ 4,  6,  7,  3,  0,  2,  5,  1, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 80.47% 

Test Accuracy: 79.87% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.17125266790390015
distance x is tensor(177.3366, device='cuda:3')
benign distance is  tensor(177.3366, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5280188918113708
distance x is tensor(164.7952, device='cuda:3')
benign distance is  tensor(164.7952, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6879217028617859
distance x is tensor(163.4076, device='cuda:3')
benign distance is  tensor(163.4076, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44734200835227966
distance x is tensor(167.2008, device='cuda:3')
benign distance is  tensor(167.2008, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6545200943946838
distance x is tensor(174.1529, device='cuda:3')
benign distance is  tensor(174.1529, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6741725206375122
distance x is tensor(185.3216, device='cuda:3')
benign distance is  tensor(185.3216, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3355380594730377
distance x is tensor(170.0003, device='cuda:3')
benign distance is  tensor(170.0003, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.901046872138977
distance x is tensor(165.6221, device='cuda:3')
benign distance is  tensor(165.6221, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(168.4783, device='cuda:3')
compute distance is  tensor(168.4783, device='cuda:3')
compute norm is  tensor(49.4473, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.2913, device='cuda:3')
compute distance is  tensor(155.2913, device='cuda:3')
compute norm is  tensor(48.9991, device='cuda:3', dtype=torch.float64)
distance x is tensor(180.2026, device='cuda:3')
compute distance is  tensor(180.2026, device='cuda:3')
compute norm is  tensor(49.8128, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.6883, device='cuda:3')
compute distance is  tensor(176.6883, device='cuda:3')
compute norm is  tensor(49.5082, device='cuda:3', dtype=torch.float64)
distance x is tensor(184.4739, device='cuda:3')
compute distance is  tensor(184.4739, device='cuda:3')
compute norm is  tensor(50.0038, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.2191, device='cuda:3')
compute distance is  tensor(168.2191, device='cuda:3')
compute norm is  tensor(49.3268, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.5007, device='cuda:3')
compute distance is  tensor(179.5007, device='cuda:3')
compute norm is  tensor(49.8727, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.3953, device='cuda:3')
compute distance is  tensor(162.3953, device='cuda:3')
compute norm is  tensor(49.2776, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.1458, device='cuda:3')
compute distance is  tensor(177.1458, device='cuda:3')
compute norm is  tensor(49.5621, device='cuda:3', dtype=torch.float64)
distance x is tensor(193.6530, device='cuda:3')
compute distance is  tensor(193.6530, device='cuda:3')
compute norm is  tensor(50.0038, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.2873, device='cuda:3')
compute distance is  tensor(183.2873, device='cuda:3')
compute norm is  tensor(49.6440, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.5933, device='cuda:3')
compute distance is  tensor(170.5933, device='cuda:3')
compute norm is  tensor(49.5594, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(193.6530, device='cuda:3')
distance x is tensor(107600.9922, device='cuda:3')
distance x is tensor(107600.9922, device='cuda:3')
________________________________
test distance is  tensor(107600.9922, device='cuda:3')
test distance1 is  tensor(107600.9922, device='cuda:3')
test similarity is  tensor(0.3493, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130174524713794.05
test entropy is  0.0
________________________________
cal ratio is  0.04157478988025862
distance x is tensor(4473.4937, device='cuda:3')
cal_distance is  tensor(4473.4937, device='cuda:3')
cal ratio is  0.2038988554150846
distance x is tensor(912.1444, device='cuda:3')
cal_distance is  tensor(912.1444, device='cuda:3')
cal ratio is  0.45155058559288513
distance x is tensor(411.8821, device='cuda:3')
cal_distance is  tensor(411.8821, device='cuda:3')
cal ratio is  0.6719728918220673
distance x is tensor(276.7752, device='cuda:3')
cal_distance is  tensor(276.7752, device='cuda:3')
cal ratio is  0.8197371409571874
distance x is tensor(226.8839, device='cuda:3')
cal_distance is  tensor(226.8839, device='cuda:3')
cal ratio is  0.905391490612296
distance x is tensor(205.4192, device='cuda:3')
cal_distance is  tensor(205.4192, device='cuda:3')
cal ratio is  0.9515194766962366
distance x is tensor(195.4606, device='cuda:3')
cal_distance is  tensor(195.4606, device='cuda:3')
cal ratio is  0.9754580040919836
distance x is tensor(190.6638, device='cuda:3')
cal_distance is  tensor(190.6638, device='cuda:3')
distance x is tensor(190.6638, device='cuda:3')
return_distance is  tensor(190.6638, device='cuda:3')
distance x is tensor(190.6537, device='cuda:3')
distance x is tensor(190.6537, device='cuda:3')
________________________________
test distance is  tensor(190.6537, device='cuda:3')
test distance1 is  tensor(190.6537, device='cuda:3')
test similarity is  tensor(0.9382, device='cuda:3')
test acc is  0.10000000015633198
test loss is 371.2507343739589
test entropy is  3.818523332485777e-05
________________________________
0
distance x is tensor(190.6537, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.136816647910923e-05
avg test loss is  370.9139986343221
avg accuracy is  0.19446666682300273
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9382, device='cuda:3')
compute_distance is  tensor(190.6537, device='cuda:3')
compute_norm is  tensor(53.2721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(187.9800, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3982664453449534
avg test loss is  2.181854296976061
avg accuracy is  0.5035666668230088
solo acc is  0.1808666668230021
compute similarity  is  tensor(0.9381, device='cuda:3')
compute_distance is  tensor(187.9800, device='cuda:3')
compute_norm is  tensor(54.3898, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.0191, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.775805534457347
avg test loss is  3.0332180472579338
avg accuracy is  0.5001666668230087
solo acc is  0.10516666682299862
compute similarity  is  tensor(0.9378, device='cuda:3')
compute_distance is  tensor(189.0191, device='cuda:3')
compute_norm is  tensor(54.4394, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.5217, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.207920081706952
avg test loss is  1.9942320697088993
avg accuracy is  0.5295500001563422
solo acc is  0.17123333348966807
compute similarity  is  tensor(0.9385, device='cuda:3')
compute_distance is  tensor(189.5217, device='cuda:3')
compute_norm is  tensor(54.0424, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(190.1938, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7101084703067219
avg test loss is  2.7793351134765887
avg accuracy is  0.5329833334896756
solo acc is  0.10595000015633195
compute similarity  is  tensor(0.9382, device='cuda:3')
compute_distance is  tensor(190.1938, device='cuda:3')
compute_norm is  tensor(53.9901, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(190.5811, device='cuda:3')
distance x is tensor(190.5811, device='cuda:3')
________________________________
test distance is  tensor(190.5811, device='cuda:3')
test distance1 is  tensor(190.5811, device='cuda:3')
test similarity is  tensor(0.9385, device='cuda:3')
test acc is  0.17511666682300162
test loss is 1.8791111734376025
test entropy is  1.1431051890478967
________________________________
0
distance x is tensor(190.5811, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1426680532853994
avg test loss is  1.8801353159489662
avg accuracy is  0.5542166668230083
solo acc is  0.17555000015633498
compute similarity  is  tensor(0.9385, device='cuda:3')
compute_distance is  tensor(190.5811, device='cuda:3')
compute_norm is  tensor(53.6107, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.0279, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6857925809141415
avg test loss is  2.666922098029651
avg accuracy is  0.5580166668230079
solo acc is  0.10436666682299864
compute similarity  is  tensor(0.9382, device='cuda:3')
compute_distance is  tensor(191.0279, device='cuda:3')
compute_norm is  tensor(53.5194, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.1009, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0916852449684509
avg test loss is  1.7669805983490527
avg accuracy is  0.5873000001563387
solo acc is  0.19420000015633607
compute similarity  is  tensor(0.9383, device='cuda:3')
compute_distance is  tensor(191.1009, device='cuda:3')
compute_norm is  tensor(53.1736, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.3870, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6654371775543766
avg test loss is  2.5711857098252024
avg accuracy is  0.5866666668230054
solo acc is  0.10300000015633197
compute similarity  is  tensor(0.9381, device='cuda:3')
compute_distance is  tensor(191.3870, device='cuda:3')
compute_norm is  tensor(53.0656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.6173, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0700378512649902
avg test loss is  1.6942908963414907
avg accuracy is  0.6099000001563368
solo acc is  0.20256666682300312
compute similarity  is  tensor(0.9381, device='cuda:3')
compute_distance is  tensor(191.6173, device='cuda:3')
compute_norm is  tensor(52.7431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.8875, device='cuda:3')
distance x is tensor(191.8875, device='cuda:3')
________________________________
test distance is  tensor(191.8875, device='cuda:3')
test distance1 is  tensor(191.8875, device='cuda:3')
test similarity is  tensor(0.9378, device='cuda:3')
test acc is  0.10265000015633197
test loss is 2.510101419267878
test entropy is  0.6457978074611631
________________________________
0
distance x is tensor(191.8875, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6450921549344621
avg test loss is  2.510744104761559
avg accuracy is  0.6087333334896703
solo acc is  0.10311666682299864
compute similarity  is  tensor(0.9378, device='cuda:3')
compute_distance is  tensor(191.8875, device='cuda:3')
compute_norm is  tensor(52.6248, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.2735, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0554204104678717
avg test loss is  1.6631546713141745
avg accuracy is  0.6250666668230023
solo acc is  0.19166666682300254
compute similarity  is  tensor(0.9378, device='cuda:3')
compute_distance is  tensor(192.2735, device='cuda:3')
compute_norm is  tensor(52.3216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.5363, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6313409498378412
avg test loss is  2.4595958698532985
avg accuracy is  0.6280333334896687
solo acc is  0.10240000015633197
compute similarity  is  tensor(0.9375, device='cuda:3')
compute_distance is  tensor(192.5363, device='cuda:3')
compute_norm is  tensor(52.1959, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.9284, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0331286481067317
avg test loss is  1.607430602187541
avg accuracy is  0.6421166668230011
solo acc is  0.2027333334896699
compute similarity  is  tensor(0.9375, device='cuda:3')
compute_distance is  tensor(192.9284, device='cuda:3')
compute_norm is  tensor(51.9033, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.2246, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6221784164529365
avg test loss is  2.411684636368172
avg accuracy is  0.6363166668230014
solo acc is  0.10191666682299863
compute similarity  is  tensor(0.9372, device='cuda:3')
compute_distance is  tensor(193.2246, device='cuda:3')
compute_norm is  tensor(51.7726, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.6666, device='cuda:3')
________________________________
test distance is  tensor(193.6666, device='cuda:3')
test similarity is  tensor(0.9371, device='cuda:3')
test acc is  0.656416666823
test loss is 1.5713805053025676
test entropy is  1.0060962749950921
________________________________
final entropy
distance x is tensor(193.6579, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.006087608873717
avg test loss is  1.5701278171051285
avg accuracy is  0.6540000001563335
solo acc is  0.2099500001563368
compute similarity  is  tensor(0.9371, device='cuda:3')
compute_distance is  tensor(193.6579, device='cuda:3')
compute_norm is  tensor(51.4827, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.1208746433258057
mal norm is  tensor(880.3599, device='cuda:3')
distance x is tensor(193.9908, device='cuda:3')
mal distance is  tensor(193.9908, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([705.2960, 684.8390, 661.5764, 675.5443, 701.1953, 750.6212, 682.8012,
        678.8841, 880.3599, 880.3599, 880.3599, 880.3599, 880.3599, 880.3599,
        880.3599, 880.3599, 880.3599, 880.3599, 880.3599, 880.3599, 826.4266,
        819.8313, 895.5157, 878.8113, 839.4075, 844.1971, 842.3271, 849.2264,
        778.7335, 802.2117, 794.2632, 816.2372, 776.1431, 796.5569, 811.0694,
        780.5690], device='cuda:3')
sorted_norm is   tensor([661.5764, 675.5443, 678.8841, 682.8012, 684.8390, 701.1953, 705.2960,
        750.6212, 776.1431, 778.7335, 780.5690, 794.2632, 796.5569, 802.2117,
        811.0694, 816.2372, 819.8313, 826.4266, 839.4075, 842.3271, 844.1971,
        849.2264, 878.8113, 880.3599, 880.3599, 880.3599, 880.3599, 880.3599,
        880.3599, 880.3599, 880.3599, 880.3599, 880.3599, 880.3599, 880.3599,
        895.5157], device='cuda:3')
used idx is  tensor([ 2,  3,  7,  6,  1,  4,  0,  5, 32, 28, 35, 30, 33, 29, 34, 31, 21, 20,
        24, 26, 25, 27, 23, 11, 19, 10,  8,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 87.50% 

Test Accuracy: 86.54% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1289682686328888
distance x is tensor(125.0129, device='cuda:3')
benign distance is  tensor(125.0129, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36815211176872253
distance x is tensor(136.2388, device='cuda:3')
benign distance is  tensor(136.2388, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2616657614707947
distance x is tensor(128.8222, device='cuda:3')
benign distance is  tensor(128.8222, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7136357426643372
distance x is tensor(129.9345, device='cuda:3')
benign distance is  tensor(129.9345, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.30748939514160156
distance x is tensor(112.9370, device='cuda:3')
benign distance is  tensor(112.9370, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4616585671901703
distance x is tensor(137.5399, device='cuda:3')
benign distance is  tensor(137.5399, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07098065316677094
distance x is tensor(123.5109, device='cuda:3')
benign distance is  tensor(123.5109, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7911860942840576
distance x is tensor(137.8536, device='cuda:3')
benign distance is  tensor(137.8536, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3682780861854553
distance x is tensor(138.2828, device='cuda:3')
benign distance is  tensor(138.2828, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1186612844467163
distance x is tensor(132.2986, device='cuda:3')
benign distance is  tensor(132.2986, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2762050926685333
distance x is tensor(126.6856, device='cuda:3')
benign distance is  tensor(126.6856, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0699799060821533
distance x is tensor(131.2522, device='cuda:3')
benign distance is  tensor(131.2522, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49369850754737854
distance x is tensor(136.6409, device='cuda:3')
benign distance is  tensor(136.6409, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3565940260887146
distance x is tensor(132.1099, device='cuda:3')
benign distance is  tensor(132.1099, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.38329455256462097
distance x is tensor(141.5607, device='cuda:3')
benign distance is  tensor(141.5607, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.48947492241859436
distance x is tensor(141.9441, device='cuda:3')
benign distance is  tensor(141.9441, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.39407873153686523
distance x is tensor(137.0134, device='cuda:3')
benign distance is  tensor(137.0134, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5892650485038757
distance x is tensor(130.5100, device='cuda:3')
benign distance is  tensor(130.5100, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.46098652482032776
distance x is tensor(142.4852, device='cuda:3')
benign distance is  tensor(142.4852, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4960964322090149
distance x is tensor(138.6681, device='cuda:3')
benign distance is  tensor(138.6681, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9103586077690125
distance x is tensor(138.7532, device='cuda:3')
benign distance is  tensor(138.7532, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5230746269226074
distance x is tensor(144.5828, device='cuda:3')
benign distance is  tensor(144.5828, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5108022689819336
distance x is tensor(141.9197, device='cuda:3')
benign distance is  tensor(141.9197, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.08072482794523239
distance x is tensor(135.6637, device='cuda:3')
benign distance is  tensor(135.6637, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.6060, device='cuda:3')
compute distance is  tensor(135.6060, device='cuda:3')
compute norm is  tensor(48.0154, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3836, device='cuda:3')
compute distance is  tensor(128.3836, device='cuda:3')
compute norm is  tensor(47.8629, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4212, device='cuda:3')
compute distance is  tensor(139.4212, device='cuda:3')
compute norm is  tensor(48.2550, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3237, device='cuda:3')
compute distance is  tensor(142.3237, device='cuda:3')
compute norm is  tensor(48.3755, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4810, device='cuda:3')
compute distance is  tensor(136.4810, device='cuda:3')
compute norm is  tensor(48.2461, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8722, device='cuda:3')
compute distance is  tensor(132.8722, device='cuda:3')
compute norm is  tensor(48.2045, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.7649, device='cuda:3')
compute distance is  tensor(119.7649, device='cuda:3')
compute norm is  tensor(47.7469, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5745, device='cuda:3')
compute distance is  tensor(126.5745, device='cuda:3')
compute norm is  tensor(47.8572, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0361, device='cuda:3')
compute distance is  tensor(132.0361, device='cuda:3')
compute norm is  tensor(48.0822, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5515, device='cuda:3')
compute distance is  tensor(130.5515, device='cuda:3')
compute norm is  tensor(48.2406, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5328, device='cuda:3')
compute distance is  tensor(148.5328, device='cuda:3')
compute norm is  tensor(48.5225, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3922, device='cuda:3')
compute distance is  tensor(134.3922, device='cuda:3')
compute norm is  tensor(48.2572, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(148.5328, device='cuda:3')
distance x is tensor(107629.6172, device='cuda:3')
distance x is tensor(107629.6172, device='cuda:3')
________________________________
test distance is  tensor(107629.6172, device='cuda:3')
test distance1 is  tensor(107629.6172, device='cuda:3')
test similarity is  tensor(0.2802, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130145821732174.06
test entropy is  0.0
________________________________
cal ratio is  0.03640586064144804
distance x is tensor(3918.3550, device='cuda:3')
cal_distance is  tensor(3918.3550, device='cuda:3')
cal ratio is  0.19080305211182813
distance x is tensor(747.6381, device='cuda:3')
cal_distance is  tensor(747.6381, device='cuda:3')
cal ratio is  0.4368089099891519
distance x is tensor(326.5779, device='cuda:3')
cal_distance is  tensor(326.5779, device='cuda:3')
cal ratio is  0.6609123016405751
distance x is tensor(215.8411, device='cuda:3')
cal_distance is  tensor(215.8411, device='cuda:3')
cal ratio is  0.8129618546286774
distance x is tensor(175.4715, device='cuda:3')
cal_distance is  tensor(175.4715, device='cuda:3')
cal ratio is  0.9016415664804116
distance x is tensor(158.2129, device='cuda:3')
cal_distance is  tensor(158.2129, device='cuda:3')
cal ratio is  0.9495465289793821
distance x is tensor(150.2308, device='cuda:3')
cal_distance is  tensor(150.2308, device='cuda:3')
cal ratio is  0.9744459924533945
distance x is tensor(146.3919, device='cuda:3')
cal_distance is  tensor(146.3919, device='cuda:3')
distance x is tensor(146.3919, device='cuda:3')
return_distance is  tensor(146.3919, device='cuda:3')
distance x is tensor(146.3818, device='cuda:3')
distance x is tensor(146.3818, device='cuda:3')
________________________________
test distance is  tensor(146.3818, device='cuda:3')
test distance1 is  tensor(146.3818, device='cuda:3')
test similarity is  tensor(0.9541, device='cuda:3')
test acc is  0.2995666668230062
test loss is 30.069118202876435
test entropy is  0.0742610749373558
________________________________
0
distance x is tensor(146.3818, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07345742884991584
avg test loss is  30.1223846407079
avg accuracy is  0.8248333334896576
solo acc is  0.29746666682300615
compute similarity  is  tensor(0.9541, device='cuda:3')
compute_distance is  tensor(146.3818, device='cuda:3')
compute_norm is  tensor(50.1925, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.3090, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9843044773474939
avg test loss is  1.4493136700790827
avg accuracy is  0.8090833334896583
solo acc is  0.2832166668230058
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(140.3090, device='cuda:3')
compute_norm is  tensor(49.9243, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(141.2764, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9183061227742543
avg test loss is  1.514440653166537
avg accuracy is  0.8133166668229916
solo acc is  0.24438333348967145
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(141.2764, device='cuda:3')
compute_norm is  tensor(49.6910, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.0508, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9135676884829108
avg test loss is  1.4826329269134668
avg accuracy is  0.8157000001563247
solo acc is  0.23980000015633793
compute similarity  is  tensor(0.9545, device='cuda:3')
compute_distance is  tensor(142.0508, device='cuda:3')
compute_norm is  tensor(49.4589, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.8492, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8931455445060852
avg test loss is  1.4666389243434996
avg accuracy is  0.8201500001563246
solo acc is  0.24423333348967136
compute similarity  is  tensor(0.9543, device='cuda:3')
compute_distance is  tensor(142.8492, device='cuda:3')
compute_norm is  tensor(49.2280, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.6384, device='cuda:3')
distance x is tensor(143.6384, device='cuda:3')
________________________________
test distance is  tensor(143.6384, device='cuda:3')
test distance1 is  tensor(143.6384, device='cuda:3')
test similarity is  tensor(0.9540, device='cuda:3')
test acc is  0.2347000001563378
test loss is 1.4595506437805925
test entropy is  0.8829110553905145
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3613083362579346
mal norm is  tensor(712.6376, device='cuda:3')
distance x is tensor(143.6477, device='cuda:3')
mal distance is  tensor(143.6477, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([521.8506, 572.6665, 537.4562, 538.6916, 465.3165, 574.1179, 510.3111,
        573.8945, 712.6376, 712.6376, 712.6376, 712.6376, 712.6376, 712.6376,
        712.6376, 712.6376, 712.6376, 712.6376, 712.6376, 712.6376, 716.6885,
        750.4248, 700.2002, 683.9816, 731.1566, 773.9031, 704.7278, 701.7795],
       device='cuda:3')
sorted_norm is   tensor([465.3165, 510.3111, 521.8506, 537.4562, 538.6916, 572.6665, 573.8945,
        574.1179, 683.9816, 700.2002, 701.7795, 704.7278, 712.6376, 712.6376,
        712.6376, 712.6376, 712.6376, 712.6376, 712.6376, 712.6376, 712.6376,
        712.6376, 712.6376, 712.6376, 716.6885, 731.1566, 750.4248, 773.9031],
       device='cuda:3')
used idx is  tensor([ 4,  6,  0,  2,  3,  1,  7,  5, 23, 22, 27, 26, 19, 18, 16, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 87.02% 

Test Accuracy: 85.79% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19875849783420563
distance x is tensor(137.2438, device='cuda:3')
benign distance is  tensor(137.2438, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8754808306694031
distance x is tensor(152.2292, device='cuda:3')
benign distance is  tensor(152.2292, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6798326969146729
distance x is tensor(143.9947, device='cuda:3')
benign distance is  tensor(143.9947, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7175602316856384
distance x is tensor(146.0875, device='cuda:3')
benign distance is  tensor(146.0875, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.649287223815918
distance x is tensor(145.5297, device='cuda:3')
benign distance is  tensor(145.5297, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4955487847328186
distance x is tensor(142.9046, device='cuda:3')
benign distance is  tensor(142.9046, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.48893818259239197
distance x is tensor(145.0200, device='cuda:3')
benign distance is  tensor(145.0200, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5654321908950806
distance x is tensor(169.2262, device='cuda:3')
benign distance is  tensor(169.2262, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2696745991706848
distance x is tensor(145.2917, device='cuda:3')
benign distance is  tensor(145.2917, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.20839262008667
distance x is tensor(158.7506, device='cuda:3')
benign distance is  tensor(158.7506, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4676848351955414
distance x is tensor(149.0979, device='cuda:3')
benign distance is  tensor(149.0979, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2563336491584778
distance x is tensor(149.8173, device='cuda:3')
benign distance is  tensor(149.8173, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6165379285812378
distance x is tensor(170.9643, device='cuda:3')
benign distance is  tensor(170.9643, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.24963673949241638
distance x is tensor(142.7117, device='cuda:3')
benign distance is  tensor(142.7117, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.04465603828430176
distance x is tensor(150.4902, device='cuda:3')
benign distance is  tensor(150.4902, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4756558835506439
distance x is tensor(146.9503, device='cuda:3')
benign distance is  tensor(146.9503, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(167.3045, device='cuda:3')
compute distance is  tensor(167.3045, device='cuda:3')
compute norm is  tensor(49.9521, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3482, device='cuda:3')
compute distance is  tensor(142.3482, device='cuda:3')
compute norm is  tensor(49.2505, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.8663, device='cuda:3')
compute distance is  tensor(149.8663, device='cuda:3')
compute norm is  tensor(49.5052, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0739, device='cuda:3')
compute distance is  tensor(151.0739, device='cuda:3')
compute norm is  tensor(49.4165, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3684, device='cuda:3')
compute distance is  tensor(148.3684, device='cuda:3')
compute norm is  tensor(49.4056, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.3611, device='cuda:3')
compute distance is  tensor(150.3611, device='cuda:3')
compute norm is  tensor(49.5642, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.3126, device='cuda:3')
compute distance is  tensor(145.3126, device='cuda:3')
compute norm is  tensor(49.3448, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.0120, device='cuda:3')
compute distance is  tensor(153.0120, device='cuda:3')
compute norm is  tensor(49.5311, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.4345, device='cuda:3')
compute distance is  tensor(161.4345, device='cuda:3')
compute norm is  tensor(49.7265, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.3836, device='cuda:3')
compute distance is  tensor(147.3836, device='cuda:3')
compute norm is  tensor(49.6464, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.9534, device='cuda:3')
compute distance is  tensor(163.9534, device='cuda:3')
compute norm is  tensor(49.8339, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.2455, device='cuda:3')
compute distance is  tensor(146.2455, device='cuda:3')
compute norm is  tensor(49.3779, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(167.3045, device='cuda:3')
distance x is tensor(107588.4062, device='cuda:3')
distance x is tensor(107588.4062, device='cuda:3')
________________________________
test distance is  tensor(107588.4062, device='cuda:3')
test distance1 is  tensor(107588.4062, device='cuda:3')
test similarity is  tensor(0.3778, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130052936741641.28
test entropy is  0.0
________________________________
cal ratio is  0.038645338883400784
distance x is tensor(4157.7964, device='cuda:3')
cal_distance is  tensor(4157.7964, device='cuda:3')
cal ratio is  0.19658403809267336
distance x is tensor(817.3604, device='cuda:3')
cal_distance is  tensor(817.3604, device='cuda:3')
cal ratio is  0.44337690834632754
distance x is tensor(362.4015, device='cuda:3')
cal_distance is  tensor(362.4015, device='cuda:3')
cal ratio is  0.6658629817880626
distance x is tensor(241.3115, device='cuda:3')
cal_distance is  tensor(241.3115, device='cuda:3')
cal ratio is  0.816001353181507
distance x is tensor(196.9114, device='cuda:3')
cal_distance is  tensor(196.9114, device='cuda:3')
cal ratio is  0.9033257211620171
distance x is tensor(177.8757, device='cuda:3')
cal_distance is  tensor(177.8757, device='cuda:3')
cal ratio is  0.9504331924055894
distance x is tensor(169.0592, device='cuda:3')
cal_distance is  tensor(169.0592, device='cuda:3')
cal ratio is  0.9749009287702671
distance x is tensor(164.8161, device='cuda:3')
cal_distance is  tensor(164.8161, device='cuda:3')
distance x is tensor(164.8161, device='cuda:3')
return_distance is  tensor(164.8161, device='cuda:3')
distance x is tensor(164.8060, device='cuda:3')
distance x is tensor(164.8060, device='cuda:3')
________________________________
test distance is  tensor(164.8060, device='cuda:3')
test distance1 is  tensor(164.8060, device='cuda:3')
test similarity is  tensor(0.9536, device='cuda:3')
test acc is  0.10035000015633198
test loss is 261.7339614184935
test entropy is  0.00023093847437697336
________________________________
0
distance x is tensor(164.8060, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0002320404547342402
avg test loss is  261.9144060179623
avg accuracy is  0.3067666668230063
solo acc is  0.1003333334896653
compute similarity  is  tensor(0.9536, device='cuda:3')
compute_distance is  tensor(164.8060, device='cuda:3')
compute_norm is  tensor(52.6501, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.5542, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2871868780681066
avg test loss is  2.114058681642577
avg accuracy is  0.5225500001563422
solo acc is  0.15686666682300043
compute similarity  is  tensor(0.9527, device='cuda:3')
compute_distance is  tensor(165.5542, device='cuda:3')
compute_norm is  tensor(53.6344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.5040, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7526714204470994
avg test loss is  2.858786896601923
avg accuracy is  0.5213833334896756
solo acc is  0.10585000015633195
compute similarity  is  tensor(0.9525, device='cuda:3')
compute_distance is  tensor(166.5040, device='cuda:3')
compute_norm is  tensor(53.6293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.3681, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.17654917895921
avg test loss is  1.8871907636300842
avg accuracy is  0.5740500001563399
solo acc is  0.18006666682300196
compute similarity  is  tensor(0.9529, device='cuda:3')
compute_distance is  tensor(167.3681, device='cuda:3')
compute_norm is  tensor(53.2813, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.0423, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7070480709009842
avg test loss is  2.665537144329502
avg accuracy is  0.5612666668230076
solo acc is  0.10415000015633197
compute similarity  is  tensor(0.9526, device='cuda:3')
compute_distance is  tensor(168.0423, device='cuda:3')
compute_norm is  tensor(53.2272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.8997, device='cuda:3')
distance x is tensor(168.8997, device='cuda:3')
________________________________
test distance is  tensor(168.8997, device='cuda:3')
test distance1 is  tensor(168.8997, device='cuda:3')
test similarity is  tensor(0.9528, device='cuda:3')
test acc is  0.18571666682300225
test loss is 1.7729623546478337
test entropy is  1.1098595230437036
________________________________
cal ratio is  0.975361169800365
distance x is tensor(164.7473, device='cuda:3')
cal_distance is  tensor(164.7473, device='cuda:3')
distance x is tensor(164.7473, device='cuda:3')
return_distance is  tensor(164.7473, device='cuda:3')
distance x is tensor(164.7381, device='cuda:3')
distance x is tensor(164.7381, device='cuda:3')
________________________________
test distance is  tensor(164.7381, device='cuda:3')
test distance1 is  tensor(164.7381, device='cuda:3')
test similarity is  tensor(0.9547, device='cuda:3')
test acc is  0.17991666682300195
test loss is 1.7634880141154536
test entropy is  1.134832733920388
________________________________
0
distance x is tensor(164.7381, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1355096566270408
avg test loss is  1.7706878203064649
avg accuracy is  0.6094000001563368
solo acc is  0.1763166668230017
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(164.7381, device='cuda:3')
compute_norm is  tensor(52.7121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.3156, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6637776929940751
avg test loss is  2.5631039084147798
avg accuracy is  0.5873500001563386
solo acc is  0.10405000015633196
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(165.3156, device='cuda:3')
compute_norm is  tensor(52.6075, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.2549, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0589392190930178
avg test loss is  1.6759526406778202
avg accuracy is  0.6381500001563346
solo acc is  0.19670000015633618
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(166.2549, device='cuda:3')
compute_norm is  tensor(52.3055, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.6663, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6356594511059556
avg test loss is  2.4559440272194997
avg accuracy is  0.6164166668230029
solo acc is  0.10400000015633197
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(166.6663, device='cuda:3')
compute_norm is  tensor(52.1607, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.2722, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0063552727450187
avg test loss is  1.5785643551141215
avg accuracy is  0.6594166668229998
solo acc is  0.21410000015633693
compute similarity  is  tensor(0.9541, device='cuda:3')
compute_distance is  tensor(167.2722, device='cuda:3')
compute_norm is  tensor(51.8473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(167.5048, device='cuda:3')
distance x is tensor(167.5048, device='cuda:3')
________________________________
test distance is  tensor(167.5048, device='cuda:3')
test distance1 is  tensor(167.5048, device='cuda:3')
test similarity is  tensor(0.9539, device='cuda:3')
test acc is  0.10281666682299863
test loss is 2.3912250904132053
test entropy is  0.6115321458529815
________________________________
cal ratio is  0.979413742304547
distance x is tensor(164.0654, device='cuda:3')
cal_distance is  tensor(164.0654, device='cuda:3')
distance x is tensor(164.0654, device='cuda:3')
return_distance is  tensor(164.0654, device='cuda:3')
distance x is tensor(164.0565, device='cuda:3')
distance x is tensor(164.0565, device='cuda:3')
________________________________
test distance is  tensor(164.0565, device='cuda:3')
test distance1 is  tensor(164.0565, device='cuda:3')
test similarity is  tensor(0.9555, device='cuda:3')
test acc is  0.10290000015633197
test loss is 2.302325000132579
test entropy is  0.6654706848963999
________________________________
0
distance x is tensor(164.0565, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6652859572027283
avg test loss is  2.301248388249737
avg accuracy is  0.6331500001563352
solo acc is  0.10320000015633196
compute similarity  is  tensor(0.9555, device='cuda:3')
compute_distance is  tensor(164.0565, device='cuda:3')
compute_norm is  tensor(51.5510, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.7789, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9717642396752005
avg test loss is  1.5461286837612387
avg accuracy is  0.6712500001563324
solo acc is  0.22086666682300396
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(164.7789, device='cuda:3')
compute_norm is  tensor(51.2610, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.7878, device='cuda:3')
________________________________
test distance is  tensor(164.7878, device='cuda:3')
test similarity is  tensor(0.9553, device='cuda:3')
test acc is  0.6709833334896658
test loss is 1.540366233793149
test entropy is  0.9718170677548024
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.291146993637085
mal norm is  tensor(750.4673, device='cuda:3')
distance x is tensor(164.7878, device='cuda:3')
mal distance is  tensor(164.7878, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([556.5491, 622.9493, 571.4146, 593.4258, 581.5775, 585.2474, 583.4613,
        677.2271, 750.4673, 750.4673, 750.4673, 750.4673, 750.4673, 750.4673,
        750.4673, 750.4673, 750.4673, 750.4673, 750.4673, 750.4673, 750.8899,
        789.0852, 765.0032, 767.8728, 796.7344, 779.1136, 769.7795, 812.3898,
        661.0552, 626.3947, 607.1637, 626.0963, 650.0775, 634.2726, 667.4199,
        662.3691], device='cuda:3')
sorted_norm is   tensor([556.5491, 571.4146, 581.5775, 583.4613, 585.2474, 593.4258, 607.1637,
        622.9493, 626.0963, 626.3947, 634.2726, 650.0775, 661.0552, 662.3691,
        667.4199, 677.2271, 750.4673, 750.4673, 750.4673, 750.4673, 750.4673,
        750.4673, 750.4673, 750.4673, 750.4673, 750.4673, 750.4673, 750.4673,
        750.8899, 765.0032, 767.8728, 769.7795, 779.1136, 789.0852, 796.7344,
        812.3898], device='cuda:3')
used idx is  tensor([ 0,  2,  4,  6,  5,  3, 30,  1, 31, 29, 33, 32, 28, 35, 34,  7, 11, 10,
         8,  9, 13, 12, 14, 15, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 68.73% 

Test Accuracy: 67.67% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.4018385410308838
distance x is tensor(146.8521, device='cuda:3')
benign distance is  tensor(146.8521, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8787083625793457
distance x is tensor(147.9558, device='cuda:3')
benign distance is  tensor(147.9558, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22001691162586212
distance x is tensor(161.5780, device='cuda:3')
benign distance is  tensor(161.5780, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7372100949287415
distance x is tensor(178.0473, device='cuda:3')
benign distance is  tensor(178.0473, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4138701558113098
distance x is tensor(168.0819, device='cuda:3')
benign distance is  tensor(168.0819, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1066911220550537
distance x is tensor(167.6285, device='cuda:3')
benign distance is  tensor(167.6285, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7009401321411133
distance x is tensor(150.7006, device='cuda:3')
benign distance is  tensor(150.7006, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5617951154708862
distance x is tensor(160.7618, device='cuda:3')
benign distance is  tensor(160.7618, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20427004992961884
distance x is tensor(157.9234, device='cuda:3')
benign distance is  tensor(157.9234, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.38061803579330444
distance x is tensor(168.3484, device='cuda:3')
benign distance is  tensor(168.3484, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5932666063308716
distance x is tensor(163.2811, device='cuda:3')
benign distance is  tensor(163.2811, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1786391735076904
distance x is tensor(151.9643, device='cuda:3')
benign distance is  tensor(151.9643, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7393161058425903
distance x is tensor(165.4076, device='cuda:3')
benign distance is  tensor(165.4076, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5989058613777161
distance x is tensor(151.3360, device='cuda:3')
benign distance is  tensor(151.3360, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.47327327728271484
distance x is tensor(152.2554, device='cuda:3')
benign distance is  tensor(152.2554, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.279039591550827
distance x is tensor(159.9009, device='cuda:3')
benign distance is  tensor(159.9009, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3217167556285858
distance x is tensor(152.6607, device='cuda:3')
benign distance is  tensor(152.6607, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1583523154258728
distance x is tensor(154.9682, device='cuda:3')
benign distance is  tensor(154.9682, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.29247838258743286
distance x is tensor(175.0476, device='cuda:3')
benign distance is  tensor(175.0476, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.780021071434021
distance x is tensor(167.2987, device='cuda:3')
benign distance is  tensor(167.2987, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7030839920043945
distance x is tensor(150.7560, device='cuda:3')
benign distance is  tensor(150.7560, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0299289226531982
distance x is tensor(156.5491, device='cuda:3')
benign distance is  tensor(156.5491, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7728515863418579
distance x is tensor(154.9551, device='cuda:3')
benign distance is  tensor(154.9551, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5497239232063293
distance x is tensor(163.7997, device='cuda:3')
benign distance is  tensor(163.7997, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(167.4522, device='cuda:3')
compute distance is  tensor(167.4522, device='cuda:3')
compute norm is  tensor(51.0720, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.7790, device='cuda:3')
compute distance is  tensor(147.7790, device='cuda:3')
compute norm is  tensor(50.6117, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.6218, device='cuda:3')
compute distance is  tensor(153.6218, device='cuda:3')
compute norm is  tensor(50.7414, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.9029, device='cuda:3')
compute distance is  tensor(171.9029, device='cuda:3')
compute norm is  tensor(51.2466, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.1394, device='cuda:3')
compute distance is  tensor(171.1394, device='cuda:3')
compute norm is  tensor(51.2456, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.5231, device='cuda:3')
compute distance is  tensor(155.5231, device='cuda:3')
compute norm is  tensor(51.0254, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.8269, device='cuda:3')
compute distance is  tensor(172.8269, device='cuda:3')
compute norm is  tensor(51.1086, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.4079, device='cuda:3')
compute distance is  tensor(162.4079, device='cuda:3')
compute norm is  tensor(50.9841, device='cuda:3', dtype=torch.float64)
distance x is tensor(181.9361, device='cuda:3')
compute distance is  tensor(181.9361, device='cuda:3')
compute norm is  tensor(51.4642, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.4194, device='cuda:3')
compute distance is  tensor(170.4194, device='cuda:3')
compute norm is  tensor(51.3878, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.1680, device='cuda:3')
compute distance is  tensor(165.1680, device='cuda:3')
compute norm is  tensor(51.1114, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.5639, device='cuda:3')
compute distance is  tensor(169.5639, device='cuda:3')
compute norm is  tensor(51.0363, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(181.9361, device='cuda:3')
distance x is tensor(107568.9844, device='cuda:3')
distance x is tensor(107568.9844, device='cuda:3')
________________________________
test distance is  tensor(107568.9844, device='cuda:3')
test distance1 is  tensor(107568.9844, device='cuda:3')
test similarity is  tensor(0.4368, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130041120358819.2
test entropy is  0.0
________________________________
cal ratio is  0.04030342919654493
distance x is tensor(4335.4038, device='cuda:3')
cal_distance is  tensor(4335.4038, device='cuda:3')
cal ratio is  0.20075702502169746
distance x is tensor(870.3668, device='cuda:3')
cal_distance is  tensor(870.3668, device='cuda:3')
cal ratio is  0.44805813485375295
distance x is tensor(389.9777, device='cuda:3')
cal_distance is  tensor(389.9777, device='cuda:3')
cal ratio is  0.6693691109416933
distance x is tensor(261.0407, device='cuda:3')
cal_distance is  tensor(261.0407, device='cuda:3')
cal ratio is  0.8181471887935241
distance x is tensor(213.5706, device='cuda:3')
cal_distance is  tensor(213.5706, device='cuda:3')
cal ratio is  0.9045129497849431
distance x is tensor(193.1779, device='cuda:3')
cal_distance is  tensor(193.1779, device='cuda:3')
cal ratio is  0.9510576595341903
distance x is tensor(183.7236, device='cuda:3')
cal_distance is  tensor(183.7236, device='cuda:3')
cal ratio is  0.9752211538902436
distance x is tensor(179.1712, device='cuda:3')
cal_distance is  tensor(179.1712, device='cuda:3')
distance x is tensor(179.1712, device='cuda:3')
return_distance is  tensor(179.1712, device='cuda:3')
distance x is tensor(179.1612, device='cuda:3')
distance x is tensor(179.1612, device='cuda:3')
________________________________
test distance is  tensor(179.1612, device='cuda:3')
test distance1 is  tensor(179.1612, device='cuda:3')
test similarity is  tensor(0.9542, device='cuda:3')
test acc is  0.2872000001563393
test loss is 28.55205805926943
test entropy is  0.0993259218531345
________________________________
0
distance x is tensor(179.1612, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.10050280045058682
avg test loss is  28.391355599930037
avg accuracy is  0.7457833334896613
solo acc is  0.286916666823006
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(179.1612, device='cuda:3')
compute_norm is  tensor(54.9649, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(175.1729, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0982079817287957
avg test loss is  1.7360264447960518
avg accuracy is  0.5947000001563381
solo acc is  0.18801666682300244
compute similarity  is  tensor(0.9546, device='cuda:3')
compute_distance is  tensor(175.1729, device='cuda:3')
compute_norm is  tensor(55.1061, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(175.3183, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6418809105973762
avg test loss is  2.529538368111226
avg accuracy is  0.5535666668230084
solo acc is  0.10325000015633197
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(175.3183, device='cuda:3')
compute_norm is  tensor(54.9321, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.3528, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.020563555805922
avg test loss is  1.5983055770270098
avg accuracy is  0.646700000156334
solo acc is  0.21666666682300378
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(176.3528, device='cuda:3')
compute_norm is  tensor(54.6445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(176.3746, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.625133330062
avg test loss is  2.3987539542763474
avg accuracy is  0.6044666668230039
solo acc is  0.10425000015633197
compute similarity  is  tensor(0.9545, device='cuda:3')
compute_distance is  tensor(176.3746, device='cuda:3')
compute_norm is  tensor(54.4517, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.9829, device='cuda:3')
distance x is tensor(176.9829, device='cuda:3')
________________________________
test distance is  tensor(176.9829, device='cuda:3')
test distance1 is  tensor(176.9829, device='cuda:3')
test similarity is  tensor(0.9547, device='cuda:3')
test acc is  0.22426666682300395
test loss is 1.5326275446775879
test entropy is  1.0005674531846158
________________________________
0
distance x is tensor(176.9829, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.998939338396353
avg test loss is  1.5314850162849751
avg accuracy is  0.6630833334896663
solo acc is  0.2245000001563373
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(176.9829, device='cuda:3')
compute_norm is  tensor(54.1579, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(176.9829, device='cuda:3')
distance x is tensor(176.9829, device='cuda:3')
________________________________
test distance is  tensor(176.9829, device='cuda:3')
test distance1 is  tensor(176.9829, device='cuda:3')
test similarity is  tensor(0.9547, device='cuda:3')
test acc is  0.22736666682300422
test loss is 1.5259788096078168
test entropy is  0.9985685259548586
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4304916858673096
mal norm is  tensor(870.2305, device='cuda:3')
distance x is tensor(176.9920, device='cuda:3')
mal distance is  tensor(176.9920, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([602.6054, 601.7333, 650.0197, 698.6565, 672.6018, 662.8648, 598.6121,
        650.1638, 870.2305, 870.2305, 870.2305, 870.2305, 870.2305, 870.2305,
        870.2305, 870.2305, 870.2305, 870.2305, 870.2305, 870.2305],
       device='cuda:3')
sorted_norm is   tensor([598.6121, 601.7333, 602.6054, 650.0197, 650.1638, 662.8648, 672.6018,
        698.6565, 870.2305, 870.2305, 870.2305, 870.2305, 870.2305, 870.2305,
        870.2305, 870.2305, 870.2305, 870.2305, 870.2305, 870.2305],
       device='cuda:3')
used idx is  tensor([ 6,  1,  0,  2,  7,  5,  4,  3, 18, 16, 12, 14, 10,  8, 17, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 73.10% 

Test Accuracy: 72.15% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9146203994750977
distance x is tensor(194.5118, device='cuda:3')
benign distance is  tensor(194.5118, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6292058229446411
distance x is tensor(188.4986, device='cuda:3')
benign distance is  tensor(188.4986, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.42854347825050354
distance x is tensor(162.6793, device='cuda:3')
benign distance is  tensor(162.6793, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7652419209480286
distance x is tensor(171.0267, device='cuda:3')
benign distance is  tensor(171.0267, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6727100610733032
distance x is tensor(175.7122, device='cuda:3')
benign distance is  tensor(175.7122, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5040884613990784
distance x is tensor(174.5066, device='cuda:3')
benign distance is  tensor(174.5066, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7530137896537781
distance x is tensor(152.6270, device='cuda:3')
benign distance is  tensor(152.6270, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6281031370162964
distance x is tensor(173.6643, device='cuda:3')
benign distance is  tensor(173.6643, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(165.1952, device='cuda:3')
compute distance is  tensor(165.1952, device='cuda:3')
compute norm is  tensor(53.8605, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.1023, device='cuda:3')
compute distance is  tensor(165.1023, device='cuda:3')
compute norm is  tensor(53.9471, device='cuda:3', dtype=torch.float64)
distance x is tensor(180.2367, device='cuda:3')
compute distance is  tensor(180.2367, device='cuda:3')
compute norm is  tensor(54.5007, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.3901, device='cuda:3')
compute distance is  tensor(158.3901, device='cuda:3')
compute norm is  tensor(53.8728, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.0261, device='cuda:3')
compute distance is  tensor(175.0261, device='cuda:3')
compute norm is  tensor(54.2509, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.7871, device='cuda:3')
compute distance is  tensor(155.7871, device='cuda:3')
compute norm is  tensor(53.8424, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.6839, device='cuda:3')
compute distance is  tensor(172.6839, device='cuda:3')
compute norm is  tensor(53.9822, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5575, device='cuda:3')
compute distance is  tensor(158.5575, device='cuda:3')
compute norm is  tensor(53.7737, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.8025, device='cuda:3')
compute distance is  tensor(179.8025, device='cuda:3')
compute norm is  tensor(53.9502, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3980, device='cuda:3')
compute distance is  tensor(156.3980, device='cuda:3')
compute norm is  tensor(53.9839, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.6870, device='cuda:3')
compute distance is  tensor(179.6870, device='cuda:3')
compute norm is  tensor(54.2749, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.1061, device='cuda:3')
compute distance is  tensor(158.1061, device='cuda:3')
compute norm is  tensor(53.4603, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(180.2367, device='cuda:3')
distance x is tensor(107511.5938, device='cuda:3')
distance x is tensor(107511.5938, device='cuda:3')
________________________________
test distance is  tensor(107511.5938, device='cuda:3')
test distance1 is  tensor(107511.5938, device='cuda:3')
test similarity is  tensor(0.5469, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130062105990997.7
test entropy is  0.0
________________________________
cal ratio is  0.04012546132399897
distance x is tensor(4313.9570, device='cuda:3')
cal_distance is  tensor(4313.9570, device='cuda:3')
cal ratio is  0.20031329890893765
distance x is tensor(864.1470, device='cuda:3')
cal_distance is  tensor(864.1470, device='cuda:3')
cal ratio is  0.4475626757221492
distance x is tensor(386.7627, device='cuda:3')
cal_distance is  tensor(386.7627, device='cuda:3')
cal ratio is  0.6689988575420974
distance x is tensor(258.7455, device='cuda:3')
cal_distance is  tensor(258.7455, device='cuda:3')
cal ratio is  0.8179208452830858
distance x is tensor(211.6342, device='cuda:3')
cal_distance is  tensor(211.6342, device='cuda:3')
cal ratio is  0.9043878218790481
distance x is tensor(191.3999, device='cuda:3')
cal_distance is  tensor(191.3999, device='cuda:3')
cal ratio is  0.9509918393302381
distance x is tensor(182.0200, device='cuda:3')
cal_distance is  tensor(182.0200, device='cuda:3')
cal ratio is  0.9751874602032427
distance x is tensor(177.5038, device='cuda:3')
cal_distance is  tensor(177.5038, device='cuda:3')
distance x is tensor(177.5038, device='cuda:3')
return_distance is  tensor(177.5038, device='cuda:3')
distance x is tensor(177.4938, device='cuda:3')
distance x is tensor(177.4938, device='cuda:3')
________________________________
test distance is  tensor(177.4938, device='cuda:3')
test distance1 is  tensor(177.4938, device='cuda:3')
test similarity is  tensor(0.9680, device='cuda:3')
test acc is  0.10006666682299865
test loss is 228.57724361785694
test entropy is  8.685678215348171e-05
________________________________
0
distance x is tensor(177.4938, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  8.599523223708913e-05
avg test loss is  228.62783156274986
avg accuracy is  0.34181666682300693
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9680, device='cuda:3')
compute_distance is  tensor(177.4938, device='cuda:3')
compute_norm is  tensor(58.6650, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1955.3481, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.556259117909332
avg test loss is  2.8683213908026723
avg accuracy is  0.1024333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2752, device='cuda:3')
compute_distance is  tensor(1955.3481, device='cuda:3')
compute_norm is  tensor(182.5564, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1946.6527, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8531601600555468
avg test loss is  3.6054635319882617
avg accuracy is  0.1024333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2755, device='cuda:3')
compute_distance is  tensor(1946.6527, device='cuda:3')
compute_norm is  tensor(182.0034, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1937.4366, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5570296495199711
avg test loss is  2.8648899905463017
avg accuracy is  0.10241666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2752, device='cuda:3')
compute_distance is  tensor(1937.4366, device='cuda:3')
compute_norm is  tensor(180.8227, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1928.8734, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8546136197632056
avg test loss is  3.598350753916352
avg accuracy is  0.1024833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2754, device='cuda:3')
compute_distance is  tensor(1928.8734, device='cuda:3')
compute_norm is  tensor(180.3013, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1919.8146, device='cuda:3')
distance x is tensor(1919.8146, device='cuda:3')
________________________________
test distance is  tensor(1919.8146, device='cuda:3')
test distance1 is  tensor(1919.8146, device='cuda:3')
test similarity is  tensor(0.2751, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.862512728807006
test entropy is  1.557784634993783
________________________________
cal ratio is  0.30027421436827156
distance x is tensor(576.4698, device='cuda:3')
cal_distance is  tensor(576.4698, device='cuda:3')
cal ratio is  0.5479732862730199
distance x is tensor(315.8897, device='cuda:3')
cal_distance is  tensor(315.8897, device='cuda:3')
cal ratio is  0.7402526136582138
distance x is tensor(233.8380, device='cuda:3')
cal_distance is  tensor(233.8380, device='cuda:3')
cal ratio is  0.8603796433818549
distance x is tensor(201.1894, device='cuda:3')
cal_distance is  tensor(201.1894, device='cuda:3')
cal ratio is  0.9275667144965472
distance x is tensor(186.6165, device='cuda:3')
cal_distance is  tensor(186.6165, device='cuda:3')
cal ratio is  0.9631029254604115
distance x is tensor(179.7309, device='cuda:3')
cal_distance is  tensor(179.7309, device='cuda:3')
distance x is tensor(179.7309, device='cuda:3')
return_distance is  tensor(179.7309, device='cuda:3')
distance x is tensor(179.7324, device='cuda:3')
distance x is tensor(179.7324, device='cuda:3')
________________________________
test distance is  tensor(179.7324, device='cuda:3')
test distance1 is  tensor(179.7324, device='cuda:3')
test similarity is  tensor(0.9507, device='cuda:3')
test acc is  0.12580000015633191
test loss is 151.8808802622976
test entropy is  0.41394409048023506
________________________________
0
distance x is tensor(179.7324, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.4144420908617058
avg test loss is  151.6650951076418
avg accuracy is  0.20686666682300334
solo acc is  0.12615000015633193
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(179.7324, device='cuda:3')
compute_norm is  tensor(54.9747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(315.7649, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2870195154696384
avg test loss is  2.2392140405772847
avg accuracy is  0.3048500001563396
solo acc is  0.13101666682299856
compute similarity  is  tensor(0.9043, device='cuda:3')
compute_distance is  tensor(315.7649, device='cuda:3')
compute_norm is  tensor(58.9856, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(315.6569, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7711290310440796
avg test loss is  2.9603340806229026
avg accuracy is  0.30605000015633965
solo acc is  0.10085000015633197
compute similarity  is  tensor(0.9041, device='cuda:3')
compute_distance is  tensor(315.6569, device='cuda:3')
compute_norm is  tensor(58.9346, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(314.8724, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2051528078406604
avg test loss is  2.0772795555179817
avg accuracy is  0.37533333348967407
solo acc is  0.1276000001563319
compute similarity  is  tensor(0.9043, device='cuda:3')
compute_distance is  tensor(314.8724, device='cuda:3')
compute_norm is  tensor(58.4941, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(314.8241, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7255532501984253
avg test loss is  2.807806868288817
avg accuracy is  0.37650000015634083
solo acc is  0.10045000015633199
compute similarity  is  tensor(0.9041, device='cuda:3')
compute_distance is  tensor(314.8241, device='cuda:3')
compute_norm is  tensor(58.3535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(314.4691, device='cuda:3')
distance x is tensor(314.4691, device='cuda:3')
________________________________
test distance is  tensor(314.4691, device='cuda:3')
test distance1 is  tensor(314.4691, device='cuda:3')
test similarity is  tensor(0.9042, device='cuda:3')
test acc is  0.13633333348966523
test loss is 2.0111106102908853
test entropy is  1.1853541586953185
________________________________
cal ratio is  0.7419227753435262
distance x is tensor(233.3082, device='cuda:3')
cal_distance is  tensor(233.3082, device='cuda:3')
cal ratio is  0.8613559050424625
distance x is tensor(200.9612, device='cuda:3')
cal_distance is  tensor(200.9612, device='cuda:3')
cal ratio is  0.9280932673029129
distance x is tensor(186.5106, device='cuda:3')
cal_distance is  tensor(186.5106, device='cuda:3')
cal ratio is  0.9633763282551907
distance x is tensor(179.6798, device='cuda:3')
cal_distance is  tensor(179.6798, device='cuda:3')
distance x is tensor(179.6798, device='cuda:3')
return_distance is  tensor(179.6798, device='cuda:3')
distance x is tensor(179.6838, device='cuda:3')
distance x is tensor(179.6838, device='cuda:3')
________________________________
test distance is  tensor(179.6838, device='cuda:3')
test distance1 is  tensor(179.6838, device='cuda:3')
test similarity is  tensor(0.9664, device='cuda:3')
test acc is  0.23166666682300435
test loss is 1.8113039476530892
test entropy is  1.4743538135404526
________________________________
0
distance x is tensor(179.6838, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4717050919146426
avg test loss is  1.8046507897661692
avg accuracy is  0.47196666682300853
solo acc is  0.2353833334896711
compute similarity  is  tensor(0.9664, device='cuda:3')
compute_distance is  tensor(179.6838, device='cuda:3')
compute_norm is  tensor(53.5721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(181.4767, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7206284467345362
avg test loss is  2.7741742942378975
avg accuracy is  0.5054500001563421
solo acc is  0.10095000015633197
compute similarity  is  tensor(0.9661, device='cuda:3')
compute_distance is  tensor(181.4767, device='cuda:3')
compute_norm is  tensor(53.4850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.1146, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1004024192468445
avg test loss is  1.7437139773673849
avg accuracy is  0.6000333334896709
solo acc is  0.193250000156336
compute similarity  is  tensor(0.9662, device='cuda:3')
compute_distance is  tensor(182.1146, device='cuda:3')
compute_norm is  tensor(53.1856, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(183.2843, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6504480066711206
avg test loss is  2.5526077516043366
avg accuracy is  0.5915000001563384
solo acc is  0.10501666682299862
compute similarity  is  tensor(0.9659, device='cuda:3')
compute_distance is  tensor(183.2843, device='cuda:3')
compute_norm is  tensor(53.0312, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(184.2882, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.014680251510921
avg test loss is  1.6147158755930757
avg accuracy is  0.6349833334896683
solo acc is  0.2052000001563366
compute similarity  is  tensor(0.9659, device='cuda:3')
compute_distance is  tensor(184.2882, device='cuda:3')
compute_norm is  tensor(52.7236, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(185.3245, device='cuda:3')
________________________________
test distance is  tensor(185.3245, device='cuda:3')
test similarity is  tensor(0.9656, device='cuda:3')
test acc is  0.6259166668230023
test loss is 2.408691278779939
test entropy is  0.6194724225794582
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.202826976776123
mal norm is  tensor(638.5712, device='cuda:3')
distance x is tensor(185.3245, device='cuda:3')
mal distance is  tensor(185.3245, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 750.9677,  744.7434,  632.0122,  664.1781,  691.0734,  688.5278,
         603.8472,  680.3084,  638.5712,  638.5712,  638.5712,  638.5712,
         638.5712,  638.5712,  638.5712,  638.5712,  638.5712,  638.5712,
         638.5712,  638.5712, 1280.2285, 1259.4077, 1296.6483, 1315.4977,
        1276.2892, 1305.7728, 1305.6351, 1275.8347, 1031.7111, 1021.8079,
        1056.4172, 1038.0961, 1043.5895, 1064.3815, 1056.1979, 1049.9608,
         873.6655,  905.2883,  888.4907,  890.8726,  933.2130,  853.2838,
         880.5339,  872.4673,  790.0749,  805.6490,  785.6232,  765.6019,
         807.4844,  761.1886,  764.6944,  793.0804], device='cuda:3')
sorted_norm is   tensor([ 603.8472,  632.0122,  638.5712,  638.5712,  638.5712,  638.5712,
         638.5712,  638.5712,  638.5712,  638.5712,  638.5712,  638.5712,
         638.5712,  638.5712,  664.1781,  680.3084,  688.5278,  691.0734,
         744.7434,  750.9677,  761.1886,  764.6944,  765.6019,  785.6232,
         790.0749,  793.0804,  805.6490,  807.4844,  853.2838,  872.4673,
         873.6655,  880.5339,  888.4907,  890.8726,  905.2883,  933.2130,
        1021.8079, 1031.7111, 1038.0961, 1043.5895, 1049.9608, 1056.1979,
        1056.4172, 1064.3815, 1259.4077, 1275.8347, 1276.2892, 1280.2285,
        1296.6483, 1305.6351, 1305.7728, 1315.4977], device='cuda:3')
used idx is  tensor([ 6,  2, 11, 10, 14, 15, 13, 12, 16, 17,  8,  9, 19, 18,  3,  7,  5,  4,
         1,  0, 49, 50, 47, 46, 44, 51, 45, 48, 41, 43, 36, 42, 38, 39, 37, 40,
        29, 28, 31, 32, 35], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 76.04% 

Test Accuracy: 75.38% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8575085401535034
distance x is tensor(132.7721, device='cuda:3')
benign distance is  tensor(132.7721, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.614239513874054
distance x is tensor(135.2179, device='cuda:3')
benign distance is  tensor(135.2179, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08800341188907623
distance x is tensor(132.9800, device='cuda:3')
benign distance is  tensor(132.9800, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.517890989780426
distance x is tensor(136.4213, device='cuda:3')
benign distance is  tensor(136.4213, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8648595809936523
distance x is tensor(163.2596, device='cuda:3')
benign distance is  tensor(163.2596, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9254220128059387
distance x is tensor(147.4023, device='cuda:3')
benign distance is  tensor(147.4023, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.47092095017433167
distance x is tensor(135.1323, device='cuda:3')
benign distance is  tensor(135.1323, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.17063480615615845
distance x is tensor(150.6978, device='cuda:3')
benign distance is  tensor(150.6978, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4860767722129822
distance x is tensor(147.0058, device='cuda:3')
benign distance is  tensor(147.0058, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8342986106872559
distance x is tensor(141.6503, device='cuda:3')
benign distance is  tensor(141.6503, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5665823221206665
distance x is tensor(129.1820, device='cuda:3')
benign distance is  tensor(129.1820, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7285965085029602
distance x is tensor(142.4168, device='cuda:3')
benign distance is  tensor(142.4168, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.631531298160553
distance x is tensor(141.0503, device='cuda:3')
benign distance is  tensor(141.0503, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3338931202888489
distance x is tensor(135.2569, device='cuda:3')
benign distance is  tensor(135.2569, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4926021099090576
distance x is tensor(136.2342, device='cuda:3')
benign distance is  tensor(136.2342, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5421066880226135
distance x is tensor(138.1630, device='cuda:3')
benign distance is  tensor(138.1630, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5150095224380493
distance x is tensor(132.7802, device='cuda:3')
benign distance is  tensor(132.7802, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7613586187362671
distance x is tensor(146.8819, device='cuda:3')
benign distance is  tensor(146.8819, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.41449278593063354
distance x is tensor(151.2168, device='cuda:3')
benign distance is  tensor(151.2168, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.584980845451355
distance x is tensor(130.9078, device='cuda:3')
benign distance is  tensor(130.9078, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.30301615595817566
distance x is tensor(145.8914, device='cuda:3')
benign distance is  tensor(145.8914, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8019254803657532
distance x is tensor(126.9582, device='cuda:3')
benign distance is  tensor(126.9582, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5703266859054565
distance x is tensor(138.4013, device='cuda:3')
benign distance is  tensor(138.4013, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8726112246513367
distance x is tensor(132.3900, device='cuda:3')
benign distance is  tensor(132.3900, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.23322908580303192
distance x is tensor(148.7760, device='cuda:3')
benign distance is  tensor(148.7760, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.077921748161316
distance x is tensor(149.3709, device='cuda:3')
benign distance is  tensor(149.3709, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9694226980209351
distance x is tensor(136.5189, device='cuda:3')
benign distance is  tensor(136.5189, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7426677942276001
distance x is tensor(144.5991, device='cuda:3')
benign distance is  tensor(144.5991, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5481032729148865
distance x is tensor(140.0449, device='cuda:3')
benign distance is  tensor(140.0449, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4740888178348541
distance x is tensor(145.5362, device='cuda:3')
benign distance is  tensor(145.5362, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.20192226767539978
distance x is tensor(142.1723, device='cuda:3')
benign distance is  tensor(142.1723, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.48774999380111694
distance x is tensor(129.0835, device='cuda:3')
benign distance is  tensor(129.0835, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.13187384605407715
distance x is tensor(136.0580, device='cuda:3')
benign distance is  tensor(136.0580, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3714762330055237
distance x is tensor(144.8690, device='cuda:3')
benign distance is  tensor(144.8690, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.19183728098869324
distance x is tensor(130.8809, device='cuda:3')
benign distance is  tensor(130.8809, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4213554263114929
distance x is tensor(147.3704, device='cuda:3')
benign distance is  tensor(147.3704, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2486559897661209
distance x is tensor(131.3506, device='cuda:3')
benign distance is  tensor(131.3506, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6606463193893433
distance x is tensor(154.8003, device='cuda:3')
benign distance is  tensor(154.8003, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2831273078918457
distance x is tensor(151.5959, device='cuda:3')
benign distance is  tensor(151.5959, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7470378279685974
distance x is tensor(135.2873, device='cuda:3')
benign distance is  tensor(135.2873, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(136.0640, device='cuda:3')
compute distance is  tensor(136.0640, device='cuda:3')
compute norm is  tensor(51.5194, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6045, device='cuda:3')
compute distance is  tensor(137.6045, device='cuda:3')
compute norm is  tensor(51.4823, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0793, device='cuda:3')
compute distance is  tensor(142.0793, device='cuda:3')
compute norm is  tensor(51.7386, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0448, device='cuda:3')
compute distance is  tensor(147.0448, device='cuda:3')
compute norm is  tensor(51.8067, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1609, device='cuda:3')
compute distance is  tensor(139.1609, device='cuda:3')
compute norm is  tensor(51.4668, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1843, device='cuda:3')
compute distance is  tensor(139.1843, device='cuda:3')
compute norm is  tensor(51.6548, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7324, device='cuda:3')
compute distance is  tensor(140.7324, device='cuda:3')
compute norm is  tensor(51.6357, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2478, device='cuda:3')
compute distance is  tensor(137.2478, device='cuda:3')
compute norm is  tensor(51.5380, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.1057, device='cuda:3')
compute distance is  tensor(158.1057, device='cuda:3')
compute norm is  tensor(51.9005, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.2293, device='cuda:3')
compute distance is  tensor(148.2293, device='cuda:3')
compute norm is  tensor(51.8738, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2029, device='cuda:3')
compute distance is  tensor(143.2029, device='cuda:3')
compute norm is  tensor(51.6641, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0548, device='cuda:3')
compute distance is  tensor(141.0548, device='cuda:3')
compute norm is  tensor(51.6820, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.1057, device='cuda:3')
distance x is tensor(107595.6484, device='cuda:3')
distance x is tensor(107595.6484, device='cuda:3')
________________________________
test distance is  tensor(107595.6484, device='cuda:3')
test distance1 is  tensor(107595.6484, device='cuda:3')
test similarity is  tensor(0.4193, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130130079167800.22
test entropy is  0.0
________________________________
cal ratio is  0.03756665079712641
distance x is tensor(4042.0132, device='cuda:3')
cal_distance is  tensor(4042.0132, device='cuda:3')
cal ratio is  0.193821063426215
distance x is tensor(783.4314, device='cuda:3')
cal_distance is  tensor(783.4314, device='cuda:3')
cal ratio is  0.4402499784938584
distance x is tensor(344.9084, device='cuda:3')
cal_distance is  tensor(344.9084, device='cuda:3')
cal ratio is  0.6635107042962675
distance x is tensor(228.8521, device='cuda:3')
cal_distance is  tensor(228.8521, device='cuda:3')
cal ratio is  0.814558625177425
distance x is tensor(186.4144, device='cuda:3')
cal_distance is  tensor(186.4144, device='cuda:3')
cal ratio is  0.9025267080069419
distance x is tensor(168.2445, device='cuda:3')
cal_distance is  tensor(168.2445, device='cuda:3')
cal ratio is  0.950012696118595
distance x is tensor(159.8347, device='cuda:3')
cal_distance is  tensor(159.8347, device='cuda:3')
cal ratio is  0.9746851159764054
distance x is tensor(155.7886, device='cuda:3')
cal_distance is  tensor(155.7886, device='cuda:3')
distance x is tensor(155.7886, device='cuda:3')
return_distance is  tensor(155.7886, device='cuda:3')
distance x is tensor(155.7786, device='cuda:3')
distance x is tensor(155.7786, device='cuda:3')
________________________________
test distance is  tensor(155.7786, device='cuda:3')
test distance1 is  tensor(155.7786, device='cuda:3')
test similarity is  tensor(0.9637, device='cuda:3')
test acc is  0.6993000001563308
test loss is 2.8552683922908964
test entropy is  0.1683957041946174
________________________________
0
distance x is tensor(155.7786, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.1675210333010281
avg test loss is  2.7974019824886627
avg accuracy is  0.8323166668229907
solo acc is  0.701333333489664
compute similarity  is  tensor(0.9637, device='cuda:3')
compute_distance is  tensor(155.7786, device='cuda:3')
compute_norm is  tensor(54.8115, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.7587, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.925718134781445
avg test loss is  1.3951766687923912
avg accuracy is  0.7699833334896602
solo acc is  0.2907000001563393
compute similarity  is  tensor(0.9640, device='cuda:3')
compute_distance is  tensor(151.7587, device='cuda:3')
compute_norm is  tensor(54.4843, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.7587, device='cuda:3')
distance x is tensor(151.7587, device='cuda:3')
________________________________
test distance is  tensor(151.7587, device='cuda:3')
test distance1 is  tensor(151.7587, device='cuda:3')
test similarity is  tensor(0.9640, device='cuda:3')
test acc is  0.29043333348967254
test loss is 1.4017843572315631
test entropy is  0.925039863344957
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4398815631866455
mal norm is  tensor(781.7672, device='cuda:3')
distance x is tensor(151.7676, device='cuda:3')
mal distance is  tensor(151.7676, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([561.9641, 562.4968, 541.7784, 567.6523, 657.7635, 597.5479, 539.7564,
        602.1032, 781.7672, 781.7672, 781.7672, 781.7672, 781.7672, 781.7672,
        781.7672, 781.7672, 781.7672, 781.7672, 781.7672, 781.7672],
       device='cuda:3')
sorted_norm is   tensor([539.7564, 541.7784, 561.9641, 562.4968, 567.6523, 597.5479, 602.1032,
        657.7635, 781.7672, 781.7672, 781.7672, 781.7672, 781.7672, 781.7672,
        781.7672, 781.7672, 781.7672, 781.7672, 781.7672, 781.7672],
       device='cuda:3')
used idx is  tensor([ 6,  2,  0,  1,  3,  5,  7,  4, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 85.93% 

Test Accuracy: 84.57% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7995561957359314
distance x is tensor(146.9406, device='cuda:3')
benign distance is  tensor(146.9406, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3244694173336029
distance x is tensor(149.4314, device='cuda:3')
benign distance is  tensor(149.4314, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2138441503047943
distance x is tensor(143.5158, device='cuda:3')
benign distance is  tensor(143.5158, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5999205708503723
distance x is tensor(145.2060, device='cuda:3')
benign distance is  tensor(145.2060, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7155848741531372
distance x is tensor(153.2499, device='cuda:3')
benign distance is  tensor(153.2499, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.46747511625289917
distance x is tensor(153.5673, device='cuda:3')
benign distance is  tensor(153.5673, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3137396275997162
distance x is tensor(165.9709, device='cuda:3')
benign distance is  tensor(165.9709, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6623111963272095
distance x is tensor(139.1139, device='cuda:3')
benign distance is  tensor(139.1139, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.2950, device='cuda:3')
compute distance is  tensor(144.2950, device='cuda:3')
compute norm is  tensor(54.2778, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2331, device='cuda:3')
compute distance is  tensor(134.2331, device='cuda:3')
compute norm is  tensor(54.0737, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.8144, device='cuda:3')
compute distance is  tensor(148.8144, device='cuda:3')
compute norm is  tensor(54.5537, device='cuda:3', dtype=torch.float64)
distance x is tensor(198.2156, device='cuda:3')
compute distance is  tensor(198.2156, device='cuda:3')
compute norm is  tensor(55.6110, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.9290, device='cuda:3')
compute distance is  tensor(156.9290, device='cuda:3')
compute norm is  tensor(54.7007, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.7462, device='cuda:3')
compute distance is  tensor(155.7462, device='cuda:3')
compute norm is  tensor(54.5745, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.2319, device='cuda:3')
compute distance is  tensor(145.2319, device='cuda:3')
compute norm is  tensor(54.1901, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0489, device='cuda:3')
compute distance is  tensor(138.0489, device='cuda:3')
compute norm is  tensor(54.0893, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.5510, device='cuda:3')
compute distance is  tensor(153.5510, device='cuda:3')
compute norm is  tensor(54.2218, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.7211, device='cuda:3')
compute distance is  tensor(148.7211, device='cuda:3')
compute norm is  tensor(54.3664, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6218, device='cuda:3')
compute distance is  tensor(152.6218, device='cuda:3')
compute norm is  tensor(54.4093, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.4651, device='cuda:3')
compute distance is  tensor(145.4651, device='cuda:3')
compute norm is  tensor(54.3473, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(198.2156, device='cuda:3')
distance x is tensor(107531.8125, device='cuda:3')
distance x is tensor(107531.8125, device='cuda:3')
________________________________
test distance is  tensor(107531.8125, device='cuda:3')
test distance1 is  tensor(107531.8125, device='cuda:3')
test similarity is  tensor(0.5302, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130081626272870.62
test entropy is  0.0
________________________________
cal ratio is  0.042075234954654164
distance x is tensor(4524.4321, device='cuda:3')
cal_distance is  tensor(4524.4321, device='cuda:3')
cal ratio is  0.2051223539087889
distance x is tensor(928.0660, device='cuda:3')
cal_distance is  tensor(928.0660, device='cuda:3')
cal ratio is  0.4529034109582648
distance x is tensor(420.3271, device='cuda:3')
cal_distance is  tensor(420.3271, device='cuda:3')
cal ratio is  0.6729787677969622
distance x is tensor(282.8728, device='cuda:3')
cal_distance is  tensor(282.8728, device='cuda:3')
cal ratio is  0.8203504948272813
distance x is tensor(232.0558, device='cuda:3')
cal_distance is  tensor(232.0558, device='cuda:3')
cal ratio is  0.9057301606751761
distance x is tensor(210.1804, device='cuda:3')
cal_distance is  tensor(210.1804, device='cuda:3')
cal ratio is  0.9516975965514822
distance x is tensor(200.0284, device='cuda:3')
cal_distance is  tensor(200.0284, device='cuda:3')
cal ratio is  0.9755492249386675
distance x is tensor(195.1377, device='cuda:3')
cal_distance is  tensor(195.1377, device='cuda:3')
distance x is tensor(195.1377, device='cuda:3')
return_distance is  tensor(195.1377, device='cuda:3')
distance x is tensor(195.1277, device='cuda:3')
distance x is tensor(195.1277, device='cuda:3')
________________________________
test distance is  tensor(195.1277, device='cuda:3')
test distance1 is  tensor(195.1277, device='cuda:3')
test similarity is  tensor(0.9623, device='cuda:3')
test acc is  0.1008833334896653
test loss is 367.505219644575
test entropy is  0.000451496959648555
________________________________
0
distance x is tensor(195.1277, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00048658193891117866
avg test loss is  366.95887561139267
avg accuracy is  0.42035000015634133
solo acc is  0.10100000015633197
compute similarity  is  tensor(0.9623, device='cuda:3')
compute_distance is  tensor(195.1277, device='cuda:3')
compute_norm is  tensor(60.0661, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(837.7512, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5552955886194193
avg test loss is  2.869378582500954
avg accuracy is  0.18236666682300204
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6437, device='cuda:3')
compute_distance is  tensor(837.7512, device='cuda:3')
compute_norm is  tensor(105.8498, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(833.9022, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8466694855105394
avg test loss is  3.6139671230621175
avg accuracy is  0.18343333348966884
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6440, device='cuda:3')
compute_distance is  tensor(833.9022, device='cuda:3')
compute_norm is  tensor(105.6640, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(829.3013, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5561248072937353
avg test loss is  2.862273690288763
avg accuracy is  0.19261666682300263
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.6436, device='cuda:3')
compute_distance is  tensor(829.3013, device='cuda:3')
compute_norm is  tensor(104.8273, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(825.5595, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8482816931662529
avg test loss is  3.603588690127391
avg accuracy is  0.19270000015633595
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6439, device='cuda:3')
compute_distance is  tensor(825.5595, device='cuda:3')
compute_norm is  tensor(104.6652, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(821.4659, device='cuda:3')
distance x is tensor(821.4659, device='cuda:3')
________________________________
test distance is  tensor(821.4659, device='cuda:3')
test distance1 is  tensor(821.4659, device='cuda:3')
test similarity is  tensor(0.6435, device='cuda:3')
test acc is  0.1013833334896653
test loss is 2.787696965721879
test entropy is  1.5346043374238492
________________________________
cal ratio is  0.4813935563377313
distance x is tensor(395.4493, device='cuda:3')
cal_distance is  tensor(395.4493, device='cuda:3')
cal ratio is  0.6938244726056763
distance x is tensor(274.3726, device='cuda:3')
cal_distance is  tensor(274.3726, device='cuda:3')
cal ratio is  0.8329610495997619
distance x is tensor(228.5418, device='cuda:3')
cal_distance is  tensor(228.5418, device='cuda:3')
cal ratio is  0.9126667938903411
distance x is tensor(208.5826, device='cuda:3')
cal_distance is  tensor(208.5826, device='cuda:3')
cal ratio is  0.9553357729262286
distance x is tensor(199.2664, device='cuda:3')
cal_distance is  tensor(199.2664, device='cuda:3')
cal ratio is  0.9774127346974684
distance x is tensor(194.7655, device='cuda:3')
cal_distance is  tensor(194.7655, device='cuda:3')
distance x is tensor(194.7655, device='cuda:3')
return_distance is  tensor(194.7655, device='cuda:3')
distance x is tensor(194.7643, device='cuda:3')
distance x is tensor(194.7643, device='cuda:3')
________________________________
test distance is  tensor(194.7643, device='cuda:3')
test distance1 is  tensor(194.7643, device='cuda:3')
test similarity is  tensor(0.9511, device='cuda:3')
test acc is  0.2765333334896723
test loss is 3.780287569901074
test entropy is  0.9189428798298338
________________________________
0
distance x is tensor(194.7643, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9197801420810634
avg test loss is  3.761997066072818
avg accuracy is  0.6291500001563355
solo acc is  0.2834333334896725
compute similarity  is  tensor(0.9511, device='cuda:3')
compute_distance is  tensor(194.7643, device='cuda:3')
compute_norm is  tensor(59.1074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(197.1354, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8802719420588601
avg test loss is  1.6584233546307854
avg accuracy is  0.690216666822998
solo acc is  0.2695666668230055
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(197.1354, device='cuda:3')
compute_norm is  tensor(58.7754, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(197.1354, device='cuda:3')
distance x is tensor(197.1354, device='cuda:3')
________________________________
test distance is  tensor(197.1354, device='cuda:3')
test distance1 is  tensor(197.1354, device='cuda:3')
test similarity is  tensor(0.9510, device='cuda:3')
test acc is  0.26853333348967207
test loss is 1.6588551032263588
test entropy is  0.8810983442548496
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.822205901145935
mal norm is  tensor(846.5509, device='cuda:3')
distance x is tensor(197.1354, device='cuda:3')
mal distance is  tensor(197.1354, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([580.0794, 604.7439, 570.4765, 568.3568, 596.8193, 621.0820, 642.6743,
        559.1077, 846.5509, 846.5509, 846.5509, 846.5509, 846.5509, 846.5509,
        846.5509, 846.5509, 846.5509, 846.5509, 846.5509, 846.5509, 728.7194,
        708.6298, 670.8673, 707.5707, 714.0327, 685.6029, 688.7220, 701.4442],
       device='cuda:3')
sorted_norm is   tensor([559.1077, 568.3568, 570.4765, 580.0794, 596.8193, 604.7439, 621.0820,
        642.6743, 670.8673, 685.6029, 688.7220, 701.4442, 707.5707, 708.6298,
        714.0327, 728.7194, 846.5509, 846.5509, 846.5509, 846.5509, 846.5509,
        846.5509, 846.5509, 846.5509, 846.5509, 846.5509, 846.5509, 846.5509],
       device='cuda:3')
used idx is  tensor([ 7,  3,  2,  0,  4,  1,  5,  6, 22, 25, 26, 27, 23, 21, 24, 20, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 85.88% 

Test Accuracy: 84.60% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.739134669303894
distance x is tensor(152.7797, device='cuda:3')
benign distance is  tensor(152.7797, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5402805805206299
distance x is tensor(161.5648, device='cuda:3')
benign distance is  tensor(161.5648, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18374410271644592
distance x is tensor(164.1388, device='cuda:3')
benign distance is  tensor(164.1388, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3383800685405731
distance x is tensor(162.3476, device='cuda:3')
benign distance is  tensor(162.3476, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1251558065414429
distance x is tensor(162.2923, device='cuda:3')
benign distance is  tensor(162.2923, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1418851613998413
distance x is tensor(152.2372, device='cuda:3')
benign distance is  tensor(152.2372, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6687803268432617
distance x is tensor(236.7092, device='cuda:3')
benign distance is  tensor(236.7092, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9289597272872925
distance x is tensor(208.7961, device='cuda:3')
benign distance is  tensor(208.7961, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6461896300315857
distance x is tensor(150.8670, device='cuda:3')
benign distance is  tensor(150.8670, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7876302599906921
distance x is tensor(158.7158, device='cuda:3')
benign distance is  tensor(158.7158, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3877292573451996
distance x is tensor(153.2961, device='cuda:3')
benign distance is  tensor(153.2961, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.1688908040523529
distance x is tensor(158.5479, device='cuda:3')
benign distance is  tensor(158.5479, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8317473530769348
distance x is tensor(142.0881, device='cuda:3')
benign distance is  tensor(142.0881, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.44292277097702026
distance x is tensor(155.5220, device='cuda:3')
benign distance is  tensor(155.5220, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3818308711051941
distance x is tensor(149.9041, device='cuda:3')
benign distance is  tensor(149.9041, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9077773094177246
distance x is tensor(164.3796, device='cuda:3')
benign distance is  tensor(164.3796, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(241.2710, device='cuda:3')
compute distance is  tensor(241.2710, device='cuda:3')
compute norm is  tensor(57.3829, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.8544, device='cuda:3')
compute distance is  tensor(150.8544, device='cuda:3')
compute norm is  tensor(54.7659, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.6003, device='cuda:3')
compute distance is  tensor(151.6003, device='cuda:3')
compute norm is  tensor(54.8053, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.2304, device='cuda:3')
compute distance is  tensor(164.2304, device='cuda:3')
compute norm is  tensor(54.9387, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.7755, device='cuda:3')
compute distance is  tensor(163.7755, device='cuda:3')
compute norm is  tensor(55.1753, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.6743, device='cuda:3')
compute distance is  tensor(164.6743, device='cuda:3')
compute norm is  tensor(54.9505, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5402, device='cuda:3')
compute distance is  tensor(158.5402, device='cuda:3')
compute norm is  tensor(54.6768, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.1563, device='cuda:3')
compute distance is  tensor(150.1563, device='cuda:3')
compute norm is  tensor(54.8912, device='cuda:3', dtype=torch.float64)
distance x is tensor(190.2783, device='cuda:3')
compute distance is  tensor(190.2783, device='cuda:3')
compute norm is  tensor(55.7666, device='cuda:3', dtype=torch.float64)
distance x is tensor(292.9638, device='cuda:3')
compute distance is  tensor(292.9638, device='cuda:3')
compute norm is  tensor(60.6762, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.2904, device='cuda:3')
compute distance is  tensor(179.2904, device='cuda:3')
compute norm is  tensor(55.2549, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.4400, device='cuda:3')
compute distance is  tensor(159.4400, device='cuda:3')
compute norm is  tensor(55.0058, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(292.9638, device='cuda:3')
distance x is tensor(107565.4531, device='cuda:3')
distance x is tensor(107565.4531, device='cuda:3')
________________________________
test distance is  tensor(107565.4531, device='cuda:3')
test distance1 is  tensor(107565.4531, device='cuda:3')
test similarity is  tensor(0.4695, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130122430349172.27
test entropy is  0.0
________________________________
cal ratio is  0.05114422782293556
distance x is tensor(5501.3579, device='cuda:3')
cal_distance is  tensor(5501.3579, device='cuda:3')
cal ratio is  0.2261507824696362
distance x is tensor(1244.1401, device='cuda:3')
cal_distance is  tensor(1244.1401, device='cuda:3')
cal ratio is  0.4755524086728169
distance x is tensor(591.6565, device='cuda:3')
cal_distance is  tensor(591.6565, device='cuda:3')
cal ratio is  0.6896015330752858
distance x is tensor(408.0088, device='cuda:3')
cal_distance is  tensor(408.0088, device='cuda:3')
cal ratio is  0.830420922367186
distance x is tensor(338.8199, device='cuda:3')
cal_distance is  tensor(338.8199, device='cuda:3')
cal ratio is  0.9112731756918304
distance x is tensor(308.7579, device='cuda:3')
cal_distance is  tensor(308.7579, device='cuda:3')
cal ratio is  0.9546056009554076
distance x is tensor(294.7423, device='cuda:3')
cal_distance is  tensor(294.7423, device='cuda:3')
cal ratio is  0.9770388289132788
distance x is tensor(287.9747, device='cuda:3')
cal_distance is  tensor(287.9747, device='cuda:3')
distance x is tensor(287.9747, device='cuda:3')
return_distance is  tensor(287.9747, device='cuda:3')
distance x is tensor(287.9647, device='cuda:3')
distance x is tensor(287.9647, device='cuda:3')
________________________________
test distance is  tensor(287.9647, device='cuda:3')
test distance1 is  tensor(287.9647, device='cuda:3')
test similarity is  tensor(0.9239, device='cuda:3')
test acc is  0.10003333348966531
test loss is 8668.674668301906
test entropy is  1.1369359998383367e-05
________________________________
0
distance x is tensor(287.9647, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.2350950097951955e-06
avg test loss is  8661.96499523171
avg accuracy is  0.12781666682299858
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9239, device='cuda:3')
compute_distance is  tensor(287.9647, device='cuda:3')
compute_norm is  tensor(64.4571, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(885.8600, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.553418696689199
avg test loss is  2.8732042798101265
avg accuracy is  0.10055000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4007, device='cuda:3')
compute_distance is  tensor(885.8600, device='cuda:3')
compute_norm is  tensor(149.8613, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(881.8569, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8439929594617408
avg test loss is  3.623289589180367
avg accuracy is  0.1005333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4009, device='cuda:3')
compute_distance is  tensor(881.8569, device='cuda:3')
compute_norm is  tensor(149.4178, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(877.3190, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5539455486258973
avg test loss is  2.8671421567514255
avg accuracy is  0.10063333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4006, device='cuda:3')
compute_distance is  tensor(877.3190, device='cuda:3')
compute_norm is  tensor(148.4184, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(873.4017, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8465311088795855
avg test loss is  3.61084063780079
avg accuracy is  0.1006333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4008, device='cuda:3')
compute_distance is  tensor(873.4017, device='cuda:3')
compute_norm is  tensor(148.0086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(868.9637, device='cuda:3')
distance x is tensor(868.9637, device='cuda:3')
________________________________
test distance is  tensor(868.9637, device='cuda:3')
test distance1 is  tensor(868.9637, device='cuda:3')
test similarity is  tensor(0.4005, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8642074751701436
test entropy is  1.5561398594364175
________________________________
cal ratio is  0.5690261567988901
distance x is tensor(494.4642, device='cuda:3')
cal_distance is  tensor(494.4642, device='cuda:3')
cal ratio is  0.7543373114772038
distance x is tensor(372.9929, device='cuda:3')
cal_distance is  tensor(372.9929, device='cuda:3')
cal ratio is  0.8685258302520528
distance x is tensor(323.9541, device='cuda:3')
cal_distance is  tensor(323.9541, device='cuda:3')
cal ratio is  0.9319471714566073
distance x is tensor(301.9081, device='cuda:3')
cal_distance is  tensor(301.9081, device='cuda:3')
cal ratio is  0.9653740537906265
distance x is tensor(291.4543, device='cuda:3')
cal_distance is  tensor(291.4543, device='cuda:3')
distance x is tensor(291.4543, device='cuda:3')
return_distance is  tensor(291.4543, device='cuda:3')
distance x is tensor(291.4529, device='cuda:3')
distance x is tensor(291.4529, device='cuda:3')
________________________________
test distance is  tensor(291.4529, device='cuda:3')
test distance1 is  tensor(291.4529, device='cuda:3')
test similarity is  tensor(0.7498, device='cuda:3')
test acc is  0.10226666682299863
test loss is 2.610847836364307
test entropy is  1.9380917437295162
________________________________
0
distance x is tensor(291.4529, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9378353044676628
avg test loss is  2.611156055922193
avg accuracy is  0.41606666682300797
solo acc is  0.10235000015633197
compute similarity  is  tensor(0.7498, device='cuda:3')
compute_distance is  tensor(291.4529, device='cuda:3')
compute_norm is  tensor(76.7455, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(291.6139, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8473654682956525
avg test loss is  3.498866762433733
avg accuracy is  0.39556666682300773
solo acc is  0.10025000015633198
compute similarity  is  tensor(0.7499, device='cuda:3')
compute_distance is  tensor(291.6139, device='cuda:3')
compute_norm is  tensor(76.7492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(292.5492, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2572918882502166
avg test loss is  2.1693090736738907
avg accuracy is  0.48693333348967527
solo acc is  0.1292000001563319
compute similarity  is  tensor(0.7496, device='cuda:3')
compute_distance is  tensor(292.5492, device='cuda:3')
compute_norm is  tensor(76.2199, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(292.1386, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7471914441982058
avg test loss is  2.889147804744208
avg accuracy is  0.4853666668230086
solo acc is  0.1009833334896653
compute similarity  is  tensor(0.7496, device='cuda:3')
compute_distance is  tensor(292.1386, device='cuda:3')
compute_norm is  tensor(76.0333, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(292.1073, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.1729189161298625
avg test loss is  1.9178775528600729
avg accuracy is  0.521966666823009
solo acc is  0.16915000015633463
compute similarity  is  tensor(0.7493, device='cuda:3')
compute_distance is  tensor(292.1073, device='cuda:3')
compute_norm is  tensor(75.5960, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(291.6656, device='cuda:3')
distance x is tensor(291.6656, device='cuda:3')
________________________________
test distance is  tensor(291.6656, device='cuda:3')
test distance1 is  tensor(291.6656, device='cuda:3')
test similarity is  tensor(0.7493, device='cuda:3')
test acc is  0.10111666682299864
test loss is 2.7254594892326955
test entropy is  0.7113285672181705
________________________________
0
distance x is tensor(291.6656, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7109743395466794
avg test loss is  2.7237624654383548
avg accuracy is  0.5205833334896756
solo acc is  0.10095000015633197
compute similarity  is  tensor(0.7493, device='cuda:3')
compute_distance is  tensor(291.6656, device='cuda:3')
compute_norm is  tensor(75.3886, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(291.4932, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.131499654575706
avg test loss is  1.9798922359562123
avg accuracy is  0.5296000001563422
solo acc is  0.13096666682299857
compute similarity  is  tensor(0.7490, device='cuda:3')
compute_distance is  tensor(291.4932, device='cuda:3')
compute_norm is  tensor(74.9739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(290.9131, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.695661078765194
avg test loss is  2.5874054785222134
avg accuracy is  0.5385833334896757
solo acc is  0.1009333334896653
compute similarity  is  tensor(0.7489, device='cuda:3')
compute_distance is  tensor(290.9131, device='cuda:3')
compute_norm is  tensor(74.7428, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(290.4124, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1082168962401369
avg test loss is  1.7923689764191602
avg accuracy is  0.5476333334896756
solo acc is  0.15360000015633346
compute similarity  is  tensor(0.7488, device='cuda:3')
compute_distance is  tensor(290.4124, device='cuda:3')
compute_norm is  tensor(74.3374, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(289.9329, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6461391869003076
avg test loss is  2.5306965821841634
avg accuracy is  0.5514333334896753
solo acc is  0.10185000015633197
compute similarity  is  tensor(0.7486, device='cuda:3')
compute_distance is  tensor(289.9329, device='cuda:3')
compute_norm is  tensor(74.0929, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(289.6926, device='cuda:3')
________________________________
test distance is  tensor(289.6926, device='cuda:3')
test similarity is  tensor(0.7485, device='cuda:3')
test acc is  0.5611166668230076
test loss is 1.7146133691517276
test entropy is  1.0648022515178999
________________________________
final entropy
distance x is tensor(289.6916, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0655587370843014
avg test loss is  1.71445230837824
avg accuracy is  0.5600500001563411
solo acc is  0.1632000001563342
compute similarity  is  tensor(0.7485, device='cuda:3')
compute_distance is  tensor(289.6916, device='cuda:3')
compute_norm is  tensor(73.7057, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.2394824028015137
mal norm is  tensor(2236.9966, device='cuda:3')
distance x is tensor(289.1844, device='cuda:3')
mal distance is  tensor(289.1844, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 608.5681,  625.5786,  638.0888,  626.2042,  658.7850,  608.7853,
         920.3465,  814.5429, 2236.9966, 2236.9968, 2236.9966, 2236.9968,
        2236.9966, 2236.9968, 2236.9966, 2236.9968, 2236.9966, 2236.9968,
        2236.9966, 2236.9968,  734.5358,  734.3813,  788.1356,  763.6605,
         705.2794,  741.3394,  728.5595,  753.9453,  653.2310,  699.4943,
         702.5817,  639.8676,  691.4093,  611.3629,  662.7567,  646.2854],
       device='cuda:3')
sorted_norm is   tensor([ 608.5681,  608.7853,  611.3629,  625.5786,  626.2042,  638.0888,
         639.8676,  646.2854,  653.2310,  658.7850,  662.7567,  691.4093,
         699.4943,  702.5817,  705.2794,  728.5595,  734.3813,  734.5358,
         741.3394,  753.9453,  763.6605,  788.1356,  814.5429,  920.3465,
        2236.9966, 2236.9966, 2236.9966, 2236.9966, 2236.9966, 2236.9966,
        2236.9968, 2236.9968, 2236.9968, 2236.9968, 2236.9968, 2236.9968],
       device='cuda:3')
used idx is  tensor([ 0,  5, 33,  1,  3,  2, 31, 35, 28,  4, 34, 32, 29, 30, 24, 26, 21, 20,
        25, 27, 23, 22,  7,  6, 10,  8, 18, 16], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 78.81% 

Test Accuracy: 77.21% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.25180163979530334
distance x is tensor(141.8459, device='cuda:3')
benign distance is  tensor(141.8459, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7988320589065552
distance x is tensor(147.4237, device='cuda:3')
benign distance is  tensor(147.4237, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3158434331417084
distance x is tensor(137.5397, device='cuda:3')
benign distance is  tensor(137.5397, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4520844519138336
distance x is tensor(147.1514, device='cuda:3')
benign distance is  tensor(147.1514, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3602396249771118
distance x is tensor(322.9507, device='cuda:3')
benign distance is  tensor(322.9507, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9494568109512329
distance x is tensor(154.6410, device='cuda:3')
benign distance is  tensor(154.6410, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6662988662719727
distance x is tensor(167.9031, device='cuda:3')
benign distance is  tensor(167.9031, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.143782138824463
distance x is tensor(157.0842, device='cuda:3')
benign distance is  tensor(157.0842, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4224732518196106
distance x is tensor(147.9907, device='cuda:3')
benign distance is  tensor(147.9907, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.34491413831710815
distance x is tensor(150.8773, device='cuda:3')
benign distance is  tensor(150.8773, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3055369257926941
distance x is tensor(160.5204, device='cuda:3')
benign distance is  tensor(160.5204, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.43255311250686646
distance x is tensor(155.0922, device='cuda:3')
benign distance is  tensor(155.0922, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5061527490615845
distance x is tensor(158.2771, device='cuda:3')
benign distance is  tensor(158.2771, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.36450356245040894
distance x is tensor(150.3296, device='cuda:3')
benign distance is  tensor(150.3296, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2943277657032013
distance x is tensor(149.9196, device='cuda:3')
benign distance is  tensor(149.9196, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5306026935577393
distance x is tensor(137.6093, device='cuda:3')
benign distance is  tensor(137.6093, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4224700331687927
distance x is tensor(149.8109, device='cuda:3')
benign distance is  tensor(149.8109, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09531514346599579
distance x is tensor(142.2576, device='cuda:3')
benign distance is  tensor(142.2576, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6404073238372803
distance x is tensor(175.0040, device='cuda:3')
benign distance is  tensor(175.0040, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.4081653654575348
distance x is tensor(160.0764, device='cuda:3')
benign distance is  tensor(160.0764, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4282451570034027
distance x is tensor(166.1411, device='cuda:3')
benign distance is  tensor(166.1411, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4731685221195221
distance x is tensor(140.3684, device='cuda:3')
benign distance is  tensor(140.3684, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5706936120986938
distance x is tensor(145.2655, device='cuda:3')
benign distance is  tensor(145.2655, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2194146364927292
distance x is tensor(137.1578, device='cuda:3')
benign distance is  tensor(137.1578, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(143.3721, device='cuda:3')
compute distance is  tensor(143.3721, device='cuda:3')
compute norm is  tensor(54.2410, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7978, device='cuda:3')
compute distance is  tensor(137.7978, device='cuda:3')
compute norm is  tensor(54.2134, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.2032, device='cuda:3')
compute distance is  tensor(150.2032, device='cuda:3')
compute norm is  tensor(54.5880, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.8153, device='cuda:3')
compute distance is  tensor(151.8153, device='cuda:3')
compute norm is  tensor(54.6534, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0760, device='cuda:3')
compute distance is  tensor(141.0760, device='cuda:3')
compute norm is  tensor(54.4661, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.1525, device='cuda:3')
compute distance is  tensor(160.1525, device='cuda:3')
compute norm is  tensor(54.8812, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9730, device='cuda:3')
compute distance is  tensor(139.9730, device='cuda:3')
compute norm is  tensor(54.4021, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.6956, device='cuda:3')
compute distance is  tensor(165.6956, device='cuda:3')
compute norm is  tensor(54.9858, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.0171, device='cuda:3')
compute distance is  tensor(153.0171, device='cuda:3')
compute norm is  tensor(54.4733, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.7328, device='cuda:3')
compute distance is  tensor(160.7328, device='cuda:3')
compute norm is  tensor(54.8909, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.6548, device='cuda:3')
compute distance is  tensor(141.6548, device='cuda:3')
compute norm is  tensor(54.3347, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.1905, device='cuda:3')
compute distance is  tensor(155.1905, device='cuda:3')
compute norm is  tensor(54.6998, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(165.6956, device='cuda:3')
distance x is tensor(107622.8125, device='cuda:3')
distance x is tensor(107622.8125, device='cuda:3')
________________________________
test distance is  tensor(107622.8125, device='cuda:3')
test distance1 is  tensor(107622.8125, device='cuda:3')
test similarity is  tensor(0.4145, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130104723401747.66
test entropy is  0.0
________________________________
cal ratio is  0.03845292652190605
distance x is tensor(4138.4170, device='cuda:3')
cal_distance is  tensor(4138.4170, device='cuda:3')
cal ratio is  0.19609406508082272
distance x is tensor(811.5231, device='cuda:3')
cal_distance is  tensor(811.5231, device='cuda:3')
cal ratio is  0.44282397365040865
distance x is tensor(359.3647, device='cuda:3')
cal_distance is  tensor(359.3647, device='cuda:3')
cal ratio is  0.665447573686502
distance x is tensor(239.1401, device='cuda:3')
cal_distance is  tensor(239.1401, device='cuda:3')
cal ratio is  0.8157468012484873
distance x is tensor(195.0787, device='cuda:3')
cal_distance is  tensor(195.0787, device='cuda:3')
cal ratio is  0.9031849323833054
distance x is tensor(176.1926, device='cuda:3')
cal_distance is  tensor(176.1926, device='cuda:3')
cal ratio is  0.9503590768766863
distance x is tensor(167.4465, device='cuda:3')
cal_distance is  tensor(167.4465, device='cuda:3')
cal ratio is  0.9748628493582762
distance x is tensor(163.2375, device='cuda:3')
cal_distance is  tensor(163.2375, device='cuda:3')
distance x is tensor(163.2375, device='cuda:3')
return_distance is  tensor(163.2375, device='cuda:3')
distance x is tensor(163.2275, device='cuda:3')
distance x is tensor(163.2275, device='cuda:3')
________________________________
test distance is  tensor(163.2275, device='cuda:3')
test distance1 is  tensor(163.2275, device='cuda:3')
test similarity is  tensor(0.9636, device='cuda:3')
test acc is  0.40396666682300786
test loss is 111.64198839639042
test entropy is  0.16135108049537963
________________________________
0
distance x is tensor(163.2275, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.1604903208326175
avg test loss is  111.79788046554208
avg accuracy is  0.5640000001563407
solo acc is  0.4060500001563412
compute similarity  is  tensor(0.9636, device='cuda:3')
compute_distance is  tensor(163.2275, device='cuda:3')
compute_norm is  tensor(57.5560, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2172.6472, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5540243495247765
avg test loss is  2.8699767495523383
avg accuracy is  0.08213333348966538
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2676, device='cuda:3')
compute_distance is  tensor(2172.6472, device='cuda:3')
compute_norm is  tensor(183.5234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2162.7119, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8422928723826337
avg test loss is  3.621503580099484
avg accuracy is  0.08633333348966536
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2678, device='cuda:3')
compute_distance is  tensor(2162.7119, device='cuda:3')
compute_norm is  tensor(182.9142, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2152.2759, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.555535762548955
avg test loss is  2.866016293893745
avg accuracy is  0.08090000015633204
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2675, device='cuda:3')
compute_distance is  tensor(2152.2759, device='cuda:3')
compute_norm is  tensor(181.7781, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2142.4575, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8445519442751463
avg test loss is  3.585357278140623
avg accuracy is  0.08938333348966535
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2677, device='cuda:3')
compute_distance is  tensor(2142.4575, device='cuda:3')
compute_norm is  tensor(181.1985, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2136.3186, device='cuda:3')
distance x is tensor(2136.3186, device='cuda:3')
________________________________
test distance is  tensor(2136.3186, device='cuda:3')
test distance1 is  tensor(2136.3186, device='cuda:3')
test similarity is  tensor(0.2674, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.861062931099426
test entropy is  1.5571621221774168
________________________________
cal ratio is  0.27292829620478426
distance x is tensor(583.0617, device='cuda:3')
cal_distance is  tensor(583.0617, device='cuda:3')
cal ratio is  0.5224254191138498
distance x is tensor(304.6062, device='cuda:3')
cal_distance is  tensor(304.6062, device='cuda:3')
cal ratio is  0.7227900504960619
distance x is tensor(220.1663, device='cuda:3')
cal_distance is  tensor(220.1663, device='cuda:3')
cal ratio is  0.8501706795290815
distance x is tensor(187.1790, device='cuda:3')
cal_distance is  tensor(187.1790, device='cuda:3')
cal ratio is  0.9220469947457124
distance x is tensor(172.5878, device='cuda:3')
cal_distance is  tensor(172.5878, device='cuda:3')
cal ratio is  0.9602327274565668
distance x is tensor(165.7244, device='cuda:3')
cal_distance is  tensor(165.7244, device='cuda:3')
cal ratio is  0.9799147139631799
distance x is tensor(162.3958, device='cuda:3')
cal_distance is  tensor(162.3958, device='cuda:3')
distance x is tensor(162.3958, device='cuda:3')
return_distance is  tensor(162.3958, device='cuda:3')
distance x is tensor(162.3960, device='cuda:3')
distance x is tensor(162.3960, device='cuda:3')
________________________________
test distance is  tensor(162.3960, device='cuda:3')
test distance1 is  tensor(162.3960, device='cuda:3')
test similarity is  tensor(0.9564, device='cuda:3')
test acc is  0.19513333348966938
test loss is 2.106610812358002
test entropy is  2.015129207548048
________________________________
0
distance x is tensor(162.3960, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.015022496678936
avg test loss is  2.1033407447180514
avg accuracy is  0.5063666668230088
solo acc is  0.19706666682300283
compute similarity  is  tensor(0.9564, device='cuda:3')
compute_distance is  tensor(162.3960, device='cuda:3')
compute_norm is  tensor(55.4477, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.7624, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7500688467325687
avg test loss is  2.7973447402657223
avg accuracy is  0.5460500001563424
solo acc is  0.10880000015633196
compute similarity  is  tensor(0.9558, device='cuda:3')
compute_distance is  tensor(164.7624, device='cuda:3')
compute_norm is  tensor(55.5838, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.5188, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.017344715498658
avg test loss is  1.5572376265200472
avg accuracy is  0.6341333334896683
solo acc is  0.25420000015633837
compute similarity  is  tensor(0.9557, device='cuda:3')
compute_distance is  tensor(167.5188, device='cuda:3')
compute_norm is  tensor(55.1990, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.5903, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6327238329438004
avg test loss is  2.3973531379882713
avg accuracy is  0.6357166668230015
solo acc is  0.10895000015633195
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(168.5903, device='cuda:3')
compute_norm is  tensor(55.0272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.4016, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9591058127915681
avg test loss is  1.4821012200577173
avg accuracy is  0.6547333334896668
solo acc is  0.242900000156338
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(170.4016, device='cuda:3')
compute_norm is  tensor(54.6983, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(170.4016, device='cuda:3')
distance x is tensor(170.4016, device='cuda:3')
________________________________
test distance is  tensor(170.4016, device='cuda:3')
test distance1 is  tensor(170.4016, device='cuda:3')
test similarity is  tensor(0.9551, device='cuda:3')
test acc is  0.2427333334896714
test loss is 1.4795502336548845
test entropy is  0.959110176131161
________________________________
cal ratio is  0.9663729376513701
distance x is tensor(164.6702, device='cuda:3')
cal_distance is  tensor(164.6702, device='cuda:3')
distance x is tensor(164.6702, device='cuda:3')
return_distance is  tensor(164.6702, device='cuda:3')
distance x is tensor(164.6715, device='cuda:3')
distance x is tensor(164.6715, device='cuda:3')
________________________________
test distance is  tensor(164.6715, device='cuda:3')
test distance1 is  tensor(164.6715, device='cuda:3')
test similarity is  tensor(0.9579, device='cuda:3')
test acc is  0.2552000001563385
test loss is 1.4551690111536462
test entropy is  1.002060021355208
________________________________
0
distance x is tensor(164.6715, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0016376487354735
avg test loss is  1.4537123277751622
avg accuracy is  0.6532500001563335
solo acc is  0.25531666682300513
compute similarity  is  tensor(0.9579, device='cuda:3')
compute_distance is  tensor(164.6715, device='cuda:3')
compute_norm is  tensor(54.5437, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.9615, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.5981851019330625
avg test loss is  2.282644633418207
avg accuracy is  0.6640166668229995
solo acc is  0.10850000015633195
compute similarity  is  tensor(0.9574, device='cuda:3')
compute_distance is  tensor(165.9615, device='cuda:3')
compute_norm is  tensor(54.3672, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.3935, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.935004324674098
avg test loss is  1.3771109206717151
avg accuracy is  0.6685000001563326
solo acc is  0.2752166668230056
compute similarity  is  tensor(0.9572, device='cuda:3')
compute_distance is  tensor(167.3935, device='cuda:3')
compute_norm is  tensor(54.0498, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(167.3913, device='cuda:3')
________________________________
test distance is  tensor(167.3913, device='cuda:3')
test similarity is  tensor(0.9572, device='cuda:3')
test acc is  0.6686333334896659
test loss is 1.3768306432375268
test entropy is  0.9354932151877804
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3156044483184814
mal norm is  tensor(711.9762, device='cuda:3')
distance x is tensor(167.3913, device='cuda:3')
mal distance is  tensor(167.3913, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 587.3228,  598.1425,  560.7959,  606.7774, 1449.4419,  617.9701,
         675.3406,  625.7916,  711.9762,  711.9762,  711.9762,  711.9762,
         711.9762,  711.9762,  711.9762,  711.9762,  711.9762,  711.9762,
         711.9762,  711.9762,  698.1319,  680.2750,  656.5583,  671.0781,
         664.3610,  676.2429,  667.8504,  620.2916,  693.6890,  706.9484,
         691.4692,  702.4996,  655.9303,  701.5572,  670.3679,  719.7430],
       device='cuda:3')
sorted_norm is   tensor([ 560.7959,  587.3228,  598.1425,  606.7774,  617.9701,  620.2916,
         625.7916,  655.9303,  656.5583,  664.3610,  667.8504,  670.3679,
         671.0781,  675.3406,  676.2429,  680.2750,  691.4692,  693.6890,
         698.1319,  701.5572,  702.4996,  706.9484,  711.9762,  711.9762,
         711.9762,  711.9762,  711.9762,  711.9762,  711.9762,  711.9762,
         711.9762,  711.9762,  711.9762,  711.9762,  719.7430, 1449.4419],
       device='cuda:3')
used idx is  tensor([ 2,  0,  1,  3,  5, 27,  7, 32, 22, 24, 26, 34, 23,  6, 25, 21, 30, 28,
        20, 33, 31, 29, 19, 11, 16, 10,  8, 15], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 83.81% 

Test Accuracy: 82.70% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3468140959739685
distance x is tensor(113.3461, device='cuda:3')
benign distance is  tensor(113.3461, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5397014617919922
distance x is tensor(123.7390, device='cuda:3')
benign distance is  tensor(123.7390, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3839765191078186
distance x is tensor(133.4323, device='cuda:3')
benign distance is  tensor(133.4323, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6172977685928345
distance x is tensor(113.5703, device='cuda:3')
benign distance is  tensor(113.5703, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6651015877723694
distance x is tensor(123.1114, device='cuda:3')
benign distance is  tensor(123.1114, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.36712008714675903
distance x is tensor(125.1721, device='cuda:3')
benign distance is  tensor(125.1721, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7277796268463135
distance x is tensor(119.9197, device='cuda:3')
benign distance is  tensor(119.9197, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7374445796012878
distance x is tensor(113.7108, device='cuda:3')
benign distance is  tensor(113.7108, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.38351231813430786
distance x is tensor(131.9445, device='cuda:3')
benign distance is  tensor(131.9445, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3889370858669281
distance x is tensor(126.9262, device='cuda:3')
benign distance is  tensor(126.9262, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6246575117111206
distance x is tensor(111.6791, device='cuda:3')
benign distance is  tensor(111.6791, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5445724725723267
distance x is tensor(131.0787, device='cuda:3')
benign distance is  tensor(131.0787, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8350318670272827
distance x is tensor(120.5741, device='cuda:3')
benign distance is  tensor(120.5741, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17198126018047333
distance x is tensor(120.9215, device='cuda:3')
benign distance is  tensor(120.9215, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31250688433647156
distance x is tensor(114.4482, device='cuda:3')
benign distance is  tensor(114.4482, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.709747850894928
distance x is tensor(130.4722, device='cuda:3')
benign distance is  tensor(130.4722, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3922610282897949
distance x is tensor(132.1746, device='cuda:3')
benign distance is  tensor(132.1746, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3796623647212982
distance x is tensor(121.0516, device='cuda:3')
benign distance is  tensor(121.0516, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5296781063079834
distance x is tensor(132.5848, device='cuda:3')
benign distance is  tensor(132.5848, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4024800658226013
distance x is tensor(127.6581, device='cuda:3')
benign distance is  tensor(127.6581, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.46846017241477966
distance x is tensor(119.3032, device='cuda:3')
benign distance is  tensor(119.3032, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5330518484115601
distance x is tensor(128.9851, device='cuda:3')
benign distance is  tensor(128.9851, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5120886564254761
distance x is tensor(129.6502, device='cuda:3')
benign distance is  tensor(129.6502, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.34564825892448425
distance x is tensor(112.4888, device='cuda:3')
benign distance is  tensor(112.4888, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(116.7992, device='cuda:3')
compute distance is  tensor(116.7992, device='cuda:3')
compute norm is  tensor(53.5954, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7874, device='cuda:3')
compute distance is  tensor(122.7874, device='cuda:3')
compute norm is  tensor(53.5850, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8103, device='cuda:3')
compute distance is  tensor(121.8103, device='cuda:3')
compute norm is  tensor(53.8428, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.3691, device='cuda:3')
compute distance is  tensor(118.3691, device='cuda:3')
compute norm is  tensor(53.5976, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.7554, device='cuda:3')
compute distance is  tensor(117.7554, device='cuda:3')
compute norm is  tensor(53.8796, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2008, device='cuda:3')
compute distance is  tensor(132.2008, device='cuda:3')
compute norm is  tensor(54.0338, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0220, device='cuda:3')
compute distance is  tensor(123.0220, device='cuda:3')
compute norm is  tensor(53.8097, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2179, device='cuda:3')
compute distance is  tensor(118.2179, device='cuda:3')
compute norm is  tensor(53.7640, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5682, device='cuda:3')
compute distance is  tensor(135.5682, device='cuda:3')
compute norm is  tensor(53.9720, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1914, device='cuda:3')
compute distance is  tensor(128.1914, device='cuda:3')
compute norm is  tensor(54.0946, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3596, device='cuda:3')
compute distance is  tensor(125.3596, device='cuda:3')
compute norm is  tensor(53.9473, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.3900, device='cuda:3')
compute distance is  tensor(119.3900, device='cuda:3')
compute norm is  tensor(53.7747, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.5682, device='cuda:3')
distance x is tensor(107626.5078, device='cuda:3')
distance x is tensor(107626.5078, device='cuda:3')
________________________________
test distance is  tensor(107626.5078, device='cuda:3')
test distance1 is  tensor(107626.5078, device='cuda:3')
test similarity is  tensor(0.3992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130013783960141.52
test entropy is  0.0
________________________________
cal ratio is  0.0347812671183373
distance x is tensor(3743.3921, device='cuda:3')
cal_distance is  tensor(3743.3921, device='cuda:3')
cal ratio is  0.18649722522078915
distance x is tensor(698.1362, device='cuda:3')
cal_distance is  tensor(698.1362, device='cuda:3')
cal ratio is  0.43185200065506235
distance x is tensor(301.4944, device='cuda:3')
cal_distance is  tensor(301.4944, device='cuda:3')
cal ratio is  0.6571513198021084
distance x is tensor(198.1292, device='cuda:3')
cal_distance is  tensor(198.1292, device='cuda:3')
cal ratio is  0.8106451557627135
distance x is tensor(160.6135, device='cuda:3')
cal_distance is  tensor(160.6135, device='cuda:3')
cal ratio is  0.9003555689940242
distance x is tensor(144.6097, device='cuda:3')
cal_distance is  tensor(144.6097, device='cuda:3')
cal ratio is  0.9488690954152051
distance x is tensor(137.2160, device='cuda:3')
cal_distance is  tensor(137.2160, device='cuda:3')
cal ratio is  0.9740981571107237
distance x is tensor(133.6619, device='cuda:3')
cal_distance is  tensor(133.6619, device='cuda:3')
distance x is tensor(133.6619, device='cuda:3')
return_distance is  tensor(133.6619, device='cuda:3')
distance x is tensor(133.6519, device='cuda:3')
distance x is tensor(133.6519, device='cuda:3')
________________________________
test distance is  tensor(133.6519, device='cuda:3')
test distance1 is  tensor(133.6519, device='cuda:3')
test similarity is  tensor(0.9733, device='cuda:3')
test acc is  0.7091000001563301
test loss is 2.357906647900274
test entropy is  0.24441022429067188
________________________________
0
distance x is tensor(133.6519, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.24501457971645824
avg test loss is  2.3635914866476933
avg accuracy is  0.8375000001563238
solo acc is  0.7093000001563301
compute similarity  is  tensor(0.9733, device='cuda:3')
compute_distance is  tensor(133.6519, device='cuda:3')
compute_norm is  tensor(56.1950, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(132.3902, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9511395694096205
avg test loss is  1.4184369997683364
avg accuracy is  0.7895666668229926
solo acc is  0.27483333348967226
compute similarity  is  tensor(0.9732, device='cuda:3')
compute_distance is  tensor(132.3902, device='cuda:3')
compute_norm is  tensor(55.9309, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(132.3902, device='cuda:3')
distance x is tensor(132.3902, device='cuda:3')
________________________________
test distance is  tensor(132.3902, device='cuda:3')
test distance1 is  tensor(132.3902, device='cuda:3')
test similarity is  tensor(0.9732, device='cuda:3')
test acc is  0.27505000015633885
test loss is 1.420791007435398
test entropy is  0.9508481180108687
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4361895322799683
mal norm is  tensor(672.6366, device='cuda:3')
distance x is tensor(132.3995, device='cuda:3')
mal distance is  tensor(132.3995, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([478.6377, 524.7883, 548.2848, 474.9180, 522.1050, 512.4390, 496.0348,
        490.8297, 672.6366, 672.6366, 672.6366, 672.6366, 672.6366, 672.6366,
        672.6366, 672.6366, 672.6366, 672.6366, 672.6366, 672.6366],
       device='cuda:3')
sorted_norm is   tensor([474.9180, 478.6377, 490.8297, 496.0348, 512.4390, 522.1050, 524.7883,
        548.2848, 672.6366, 672.6366, 672.6366, 672.6366, 672.6366, 672.6366,
        672.6366, 672.6366, 672.6366, 672.6366, 672.6366, 672.6366],
       device='cuda:3')
used idx is  tensor([ 3,  0,  7,  6,  5,  4,  1,  2, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 85.72% 

Test Accuracy: 84.71% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39374327659606934
distance x is tensor(129.8898, device='cuda:3')
benign distance is  tensor(129.8898, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8355037569999695
distance x is tensor(129.7710, device='cuda:3')
benign distance is  tensor(129.7710, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17869918048381805
distance x is tensor(132.8657, device='cuda:3')
benign distance is  tensor(132.8657, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8693793416023254
distance x is tensor(120.7310, device='cuda:3')
benign distance is  tensor(120.7310, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4213319718837738
distance x is tensor(135.5031, device='cuda:3')
benign distance is  tensor(135.5031, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3524681627750397
distance x is tensor(146.9262, device='cuda:3')
benign distance is  tensor(146.9262, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2998617887496948
distance x is tensor(136.7522, device='cuda:3')
benign distance is  tensor(136.7522, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5069221258163452
distance x is tensor(135.1252, device='cuda:3')
benign distance is  tensor(135.1252, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(128.8596, device='cuda:3')
compute distance is  tensor(128.8596, device='cuda:3')
compute norm is  tensor(55.9279, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9583, device='cuda:3')
compute distance is  tensor(132.9583, device='cuda:3')
compute norm is  tensor(55.8078, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1115, device='cuda:3')
compute distance is  tensor(132.1115, device='cuda:3')
compute norm is  tensor(55.9848, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8857, device='cuda:3')
compute distance is  tensor(139.8857, device='cuda:3')
compute norm is  tensor(56.0905, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1267, device='cuda:3')
compute distance is  tensor(131.1267, device='cuda:3')
compute norm is  tensor(55.9693, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3162, device='cuda:3')
compute distance is  tensor(133.3162, device='cuda:3')
compute norm is  tensor(55.9776, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.4109, device='cuda:3')
compute distance is  tensor(130.4109, device='cuda:3')
compute norm is  tensor(55.9225, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3890, device='cuda:3')
compute distance is  tensor(130.3890, device='cuda:3')
compute norm is  tensor(56.0006, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1155, device='cuda:3')
compute distance is  tensor(149.1155, device='cuda:3')
compute norm is  tensor(56.2492, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9521, device='cuda:3')
compute distance is  tensor(130.9521, device='cuda:3')
compute norm is  tensor(56.0167, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.0663, device='cuda:3')
compute distance is  tensor(136.0663, device='cuda:3')
compute norm is  tensor(56.0262, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5576, device='cuda:3')
compute distance is  tensor(136.5576, device='cuda:3')
compute norm is  tensor(56.0556, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.1155, device='cuda:3')
distance x is tensor(107566.6016, device='cuda:3')
distance x is tensor(107566.6016, device='cuda:3')
________________________________
test distance is  tensor(107566.6016, device='cuda:3')
test distance1 is  tensor(107566.6016, device='cuda:3')
test similarity is  tensor(0.4990, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130100189537985.23
test entropy is  0.0
________________________________
cal ratio is  0.03648788888324388
distance x is tensor(3924.8835, device='cuda:3')
cal_distance is  tensor(3924.8835, device='cuda:3')
cal ratio is  0.19101790323439527
distance x is tensor(749.7270, device='cuda:3')
cal_distance is  tensor(749.7270, device='cuda:3')
cal ratio is  0.4370547909920706
distance x is tensor(327.6746, device='cuda:3')
cal_distance is  tensor(327.6746, device='cuda:3')
cal ratio is  0.6610983224727326
distance x is tensor(216.6268, device='cuda:3')
cal_distance is  tensor(216.6268, device='cuda:3')
cal ratio is  0.8130763405410576
distance x is tensor(176.1351, device='cuda:3')
cal_distance is  tensor(176.1351, device='cuda:3')
cal ratio is  0.9017050532224686
distance x is tensor(158.8224, device='cuda:3')
cal_distance is  tensor(158.8224, device='cuda:3')
cal ratio is  0.9495800473679558
distance x is tensor(150.8148, device='cuda:3')
cal_distance is  tensor(150.8148, device='cuda:3')
cal ratio is  0.9744631166113328
distance x is tensor(146.9637, device='cuda:3')
cal_distance is  tensor(146.9637, device='cuda:3')
distance x is tensor(146.9637, device='cuda:3')
return_distance is  tensor(146.9637, device='cuda:3')
distance x is tensor(146.9536, device='cuda:3')
distance x is tensor(146.9536, device='cuda:3')
________________________________
test distance is  tensor(146.9536, device='cuda:3')
test distance1 is  tensor(146.9536, device='cuda:3')
test similarity is  tensor(0.9759, device='cuda:3')
test acc is  0.5226666668230089
test loss is 11.046413159827942
test entropy is  0.1588778826100295
________________________________
0
distance x is tensor(146.9536, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.15891666962171414
avg test loss is  11.049853819519726
avg accuracy is  0.8289500001563241
solo acc is  0.5228000001563423
compute similarity  is  tensor(0.9759, device='cuda:3')
compute_distance is  tensor(146.9536, device='cuda:3')
compute_norm is  tensor(59.4566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.5961, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9448138989492266
avg test loss is  1.413753174134155
avg accuracy is  0.7776166668229931
solo acc is  0.2814333334896725
compute similarity  is  tensor(0.9764, device='cuda:3')
compute_distance is  tensor(141.5961, device='cuda:3')
compute_norm is  tensor(59.1934, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(141.5961, device='cuda:3')
distance x is tensor(141.5961, device='cuda:3')
________________________________
test distance is  tensor(141.5961, device='cuda:3')
test distance1 is  tensor(141.5961, device='cuda:3')
test similarity is  tensor(0.9764, device='cuda:3')
test acc is  0.2813833334896724
test loss is 1.4107531793336117
test entropy is  0.9441279132228925
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1426702737808228
mal norm is  tensor(732.0513, device='cuda:3')
distance x is tensor(141.6056, device='cuda:3')
mal distance is  tensor(141.6056, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([534.6887, 535.5596, 533.6211, 499.1379, 552.9213, 601.1241, 550.4803,
        553.2334, 732.0513, 732.0513, 732.0513, 732.0513, 732.0513, 732.0513,
        732.0513, 732.0513, 732.0513, 732.0513, 732.0513, 732.0513, 708.9603,
        720.7750, 686.6243, 737.6681, 699.4707, 750.0184, 757.0525, 713.8270,
        725.5894, 723.8526, 748.1421, 727.9506, 742.3727, 727.3284, 728.5232,
        673.2092, 661.1324, 644.7618, 586.8423, 650.0254, 620.2549, 612.3683,
        600.2881, 664.6625], device='cuda:3')
sorted_norm is   tensor([499.1379, 533.6211, 534.6887, 535.5596, 550.4803, 552.9213, 553.2334,
        586.8423, 600.2881, 601.1241, 612.3683, 620.2549, 644.7618, 650.0254,
        661.1324, 664.6625, 673.2092, 686.6243, 699.4707, 708.9603, 713.8270,
        720.7750, 723.8526, 725.5894, 727.3284, 727.9506, 728.5232, 732.0513,
        732.0513, 732.0513, 732.0513, 732.0513, 732.0513, 732.0513, 732.0513,
        732.0513, 732.0513, 732.0513, 732.0513, 737.6681, 742.3727, 748.1421,
        750.0184, 757.0525], device='cuda:3')
used idx is  tensor([ 3,  2,  0,  1,  6,  4,  7, 38, 42,  5, 41, 40, 37, 39, 36, 43, 35, 22,
        24, 20, 27, 21, 29, 28, 33, 31, 34, 11, 13, 10,  8,  9, 19, 18, 16],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.37% 

Test Accuracy: 87.32% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7815181016921997
distance x is tensor(122.4593, device='cuda:3')
benign distance is  tensor(122.4593, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3125382959842682
distance x is tensor(124.0320, device='cuda:3')
benign distance is  tensor(124.0320, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4630354940891266
distance x is tensor(117.4004, device='cuda:3')
benign distance is  tensor(117.4004, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9024633169174194
distance x is tensor(119.8394, device='cuda:3')
benign distance is  tensor(119.8394, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8837724924087524
distance x is tensor(114.2815, device='cuda:3')
benign distance is  tensor(114.2815, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.650572657585144
distance x is tensor(132.6646, device='cuda:3')
benign distance is  tensor(132.6646, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13312235474586487
distance x is tensor(117.0615, device='cuda:3')
benign distance is  tensor(117.0615, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6633480191230774
distance x is tensor(118.9064, device='cuda:3')
benign distance is  tensor(118.9064, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6686651110649109
distance x is tensor(130.9048, device='cuda:3')
benign distance is  tensor(130.9048, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.562432587146759
distance x is tensor(129.5025, device='cuda:3')
benign distance is  tensor(129.5025, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8763837814331055
distance x is tensor(115.7656, device='cuda:3')
benign distance is  tensor(115.7656, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8168319463729858
distance x is tensor(130.0507, device='cuda:3')
benign distance is  tensor(130.0507, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6334052085876465
distance x is tensor(117.8082, device='cuda:3')
benign distance is  tensor(117.8082, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2919002175331116
distance x is tensor(123.2803, device='cuda:3')
benign distance is  tensor(123.2803, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7795278429985046
distance x is tensor(117.2391, device='cuda:3')
benign distance is  tensor(117.2391, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44384288787841797
distance x is tensor(131.3751, device='cuda:3')
benign distance is  tensor(131.3751, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6568864583969116
distance x is tensor(128.9608, device='cuda:3')
benign distance is  tensor(128.9608, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.40416866540908813
distance x is tensor(129.2066, device='cuda:3')
benign distance is  tensor(129.2066, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.49026575684547424
distance x is tensor(120.5063, device='cuda:3')
benign distance is  tensor(120.5063, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.550610363483429
distance x is tensor(122.5398, device='cuda:3')
benign distance is  tensor(122.5398, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12793119251728058
distance x is tensor(122.7837, device='cuda:3')
benign distance is  tensor(122.7837, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7356191873550415
distance x is tensor(110.8440, device='cuda:3')
benign distance is  tensor(110.8440, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.12349526584148407
distance x is tensor(127.6483, device='cuda:3')
benign distance is  tensor(127.6483, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2926313281059265
distance x is tensor(128.4534, device='cuda:3')
benign distance is  tensor(128.4534, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.5373464822769165
distance x is tensor(122.3391, device='cuda:3')
benign distance is  tensor(122.3391, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4486922323703766
distance x is tensor(125.2695, device='cuda:3')
benign distance is  tensor(125.2695, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.21234333515167236
distance x is tensor(133.2131, device='cuda:3')
benign distance is  tensor(133.2131, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.15518417954444885
distance x is tensor(129.5380, device='cuda:3')
benign distance is  tensor(129.5380, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4427556097507477
distance x is tensor(114.2626, device='cuda:3')
benign distance is  tensor(114.2626, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5918102264404297
distance x is tensor(129.6517, device='cuda:3')
benign distance is  tensor(129.6517, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6000968217849731
distance x is tensor(141.8537, device='cuda:3')
benign distance is  tensor(141.8537, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2740895748138428
distance x is tensor(127.9888, device='cuda:3')
benign distance is  tensor(127.9888, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(114.7637, device='cuda:3')
compute distance is  tensor(114.7637, device='cuda:3')
compute norm is  tensor(55.5525, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.3832, device='cuda:3')
compute distance is  tensor(117.3832, device='cuda:3')
compute norm is  tensor(55.4486, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9091, device='cuda:3')
compute distance is  tensor(144.9091, device='cuda:3')
compute norm is  tensor(56.1901, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7625, device='cuda:3')
compute distance is  tensor(131.7625, device='cuda:3')
compute norm is  tensor(55.9114, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.5932, device='cuda:3')
compute distance is  tensor(123.5932, device='cuda:3')
compute norm is  tensor(55.6804, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.8817, device='cuda:3')
compute distance is  tensor(126.8817, device='cuda:3')
compute norm is  tensor(55.9042, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8771, device='cuda:3')
compute distance is  tensor(127.8771, device='cuda:3')
compute norm is  tensor(55.7571, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.8200, device='cuda:3')
compute distance is  tensor(119.8200, device='cuda:3')
compute norm is  tensor(55.5934, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9893, device='cuda:3')
compute distance is  tensor(126.9893, device='cuda:3')
compute norm is  tensor(55.5859, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7622, device='cuda:3')
compute distance is  tensor(130.7622, device='cuda:3')
compute norm is  tensor(55.9707, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7349, device='cuda:3')
compute distance is  tensor(128.7349, device='cuda:3')
compute norm is  tensor(55.9409, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.1157, device='cuda:3')
compute distance is  tensor(117.1157, device='cuda:3')
compute norm is  tensor(55.6875, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.9091, device='cuda:3')
distance x is tensor(107572.9219, device='cuda:3')
distance x is tensor(107572.9219, device='cuda:3')
________________________________
test distance is  tensor(107572.9219, device='cuda:3')
test distance1 is  tensor(107572.9219, device='cuda:3')
test similarity is  tensor(0.4872, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130053541955562.17
test entropy is  0.0
________________________________
cal ratio is  0.03596850857932782
distance x is tensor(3869.2429, device='cuda:3')
cal_distance is  tensor(3869.2429, device='cuda:3')
cal ratio is  0.18965352155115373
distance x is tensor(733.8196, device='cuda:3')
cal_distance is  tensor(733.8196, device='cuda:3')
cal ratio is  0.43549107042343205
distance x is tensor(319.5747, device='cuda:3')
cal_distance is  tensor(319.5747, device='cuda:3')
cal ratio is  0.6599145339859182
distance x is tensor(210.8937, device='cuda:3')
cal_distance is  tensor(210.8937, device='cuda:3')
cal ratio is  0.8123479252594401
distance x is tensor(171.3201, device='cuda:3')
cal_distance is  tensor(171.3201, device='cuda:3')
cal ratio is  0.9013008837548162
distance x is tensor(154.4114, device='cuda:3')
cal_distance is  tensor(154.4114, device='cuda:3')
cal ratio is  0.9493671312313694
distance x is tensor(146.5934, device='cuda:3')
cal_distance is  tensor(146.5934, device='cuda:3')
cal ratio is  0.9743538458058955
distance x is tensor(142.8340, device='cuda:3')
cal_distance is  tensor(142.8340, device='cuda:3')
distance x is tensor(142.8340, device='cuda:3')
return_distance is  tensor(142.8340, device='cuda:3')
distance x is tensor(142.8239, device='cuda:3')
distance x is tensor(142.8239, device='cuda:3')
________________________________
test distance is  tensor(142.8239, device='cuda:3')
test distance1 is  tensor(142.8239, device='cuda:3')
test similarity is  tensor(0.9764, device='cuda:3')
test acc is  0.6399166668230012
test loss is 6.637514874625054
test entropy is  0.1352095984970964
________________________________
0
distance x is tensor(142.8239, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.13669944505320428
avg test loss is  6.696672654609436
avg accuracy is  0.8528333334896565
solo acc is  0.6374166668230014
compute similarity  is  tensor(0.9764, device='cuda:3')
compute_distance is  tensor(142.8239, device='cuda:3')
compute_norm is  tensor(59.1004, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.5118, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.941998442225873
avg test loss is  1.4317545085065146
avg accuracy is  0.8011333334896588
solo acc is  0.2775500001563389
compute similarity  is  tensor(0.9760, device='cuda:3')
compute_distance is  tensor(142.5118, device='cuda:3')
compute_norm is  tensor(58.9824, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(142.8943, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9124747580175461
avg test loss is  1.5092332861316737
avg accuracy is  0.801666666822992
solo acc is  0.2264333334896708
compute similarity  is  tensor(0.9758, device='cuda:3')
compute_distance is  tensor(142.8943, device='cuda:3')
compute_norm is  tensor(58.6969, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.1236, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8931296355942927
avg test loss is  1.4908742508146047
avg accuracy is  0.8057000001563251
solo acc is  0.22420000015633731
compute similarity  is  tensor(0.9758, device='cuda:3')
compute_distance is  tensor(143.1236, device='cuda:3')
compute_norm is  tensor(58.4144, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.3271, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8959046253390404
avg test loss is  1.4712888932685608
avg accuracy is  0.8097000001563249
solo acc is  0.2211166668230039
compute similarity  is  tensor(0.9757, device='cuda:3')
compute_distance is  tensor(143.3271, device='cuda:3')
compute_norm is  tensor(58.1336, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(143.5654, device='cuda:3')
distance x is tensor(143.5654, device='cuda:3')
________________________________
test distance is  tensor(143.5654, device='cuda:3')
test distance1 is  tensor(143.5654, device='cuda:3')
test similarity is  tensor(0.9756, device='cuda:3')
test acc is  0.22445000015633745
test loss is 1.4518827062680015
test entropy is  0.884100692739873
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3760418891906738
mal norm is  tensor(691.0031, device='cuda:3')
distance x is tensor(143.5745, device='cuda:3')
mal distance is  tensor(143.5745, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([515.2156, 507.4192, 487.7842, 487.5407, 481.0720, 551.2554, 480.5679,
        501.4254, 691.0031, 691.0031, 691.0031, 691.0031, 691.0031, 691.0031,
        691.0031, 691.0031, 691.0031, 691.0031, 691.0031, 691.0031],
       device='cuda:3')
sorted_norm is   tensor([480.5679, 481.0720, 487.5407, 487.7842, 501.4254, 507.4192, 515.2156,
        551.2554, 691.0031, 691.0031, 691.0031, 691.0031, 691.0031, 691.0031,
        691.0031, 691.0031, 691.0031, 691.0031, 691.0031, 691.0031],
       device='cuda:3')
used idx is  tensor([ 6,  4,  3,  2,  7,  1,  0,  5, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 83.65% 

Test Accuracy: 82.73% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.23417644202709198
distance x is tensor(139.9200, device='cuda:3')
benign distance is  tensor(139.9200, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46193185448646545
distance x is tensor(145.8447, device='cuda:3')
benign distance is  tensor(145.8447, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19260305166244507
distance x is tensor(136.9250, device='cuda:3')
benign distance is  tensor(136.9250, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9535387754440308
distance x is tensor(154.8510, device='cuda:3')
benign distance is  tensor(154.8510, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7023456692695618
distance x is tensor(144.4289, device='cuda:3')
benign distance is  tensor(144.4289, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8834579586982727
distance x is tensor(154.7445, device='cuda:3')
benign distance is  tensor(154.7445, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4244825839996338
distance x is tensor(136.0683, device='cuda:3')
benign distance is  tensor(136.0683, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.32939592003822327
distance x is tensor(148.2556, device='cuda:3')
benign distance is  tensor(148.2556, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(134.6218, device='cuda:3')
compute distance is  tensor(134.6218, device='cuda:3')
compute norm is  tensor(57.8757, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2863, device='cuda:3')
compute distance is  tensor(138.2863, device='cuda:3')
compute norm is  tensor(57.7909, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.7171, device='cuda:3')
compute distance is  tensor(134.7171, device='cuda:3')
compute norm is  tensor(57.7988, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.6976, device='cuda:3')
compute distance is  tensor(143.6976, device='cuda:3')
compute norm is  tensor(58.0122, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5391, device='cuda:3')
compute distance is  tensor(137.5391, device='cuda:3')
compute norm is  tensor(57.9755, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.2709, device='cuda:3')
compute distance is  tensor(154.2709, device='cuda:3')
compute norm is  tensor(58.2784, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1120, device='cuda:3')
compute distance is  tensor(137.1120, device='cuda:3')
compute norm is  tensor(57.9310, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1614, device='cuda:3')
compute distance is  tensor(134.1614, device='cuda:3')
compute norm is  tensor(57.8128, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.1125, device='cuda:3')
compute distance is  tensor(154.1125, device='cuda:3')
compute norm is  tensor(58.1688, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7561, device='cuda:3')
compute distance is  tensor(142.7561, device='cuda:3')
compute norm is  tensor(58.2179, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5079, device='cuda:3')
compute distance is  tensor(149.5079, device='cuda:3')
compute norm is  tensor(58.1519, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0091, device='cuda:3')
compute distance is  tensor(137.0091, device='cuda:3')
compute norm is  tensor(57.9814, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.2709, device='cuda:3')
distance x is tensor(107519.6016, device='cuda:3')
distance x is tensor(107519.6016, device='cuda:3')
________________________________
test distance is  tensor(107519.6016, device='cuda:3')
test distance1 is  tensor(107519.6016, device='cuda:3')
test similarity is  tensor(0.5697, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130181309264334.88
test entropy is  0.0
________________________________
cal ratio is  0.03712138795723528
distance x is tensor(3991.2830, device='cuda:3')
cal_distance is  tensor(3991.2830, device='cuda:3')
cal ratio is  0.19266896437560238
distance x is tensor(769.0003, device='cuda:3')
cal_distance is  tensor(769.0003, device='cuda:3')
cal ratio is  0.4389396010697159
distance x is tensor(337.5475, device='cuda:3')
cal_distance is  tensor(337.5475, device='cuda:3')
cal ratio is  0.662522422968873
distance x is tensor(223.6345, device='cuda:3')
cal_distance is  tensor(223.6345, device='cuda:3')
cal ratio is  0.8139517023463948
distance x is tensor(182.0286, device='cuda:3')
cal_distance is  tensor(182.0286, device='cuda:3')
cal ratio is  0.9021903251838912
distance x is tensor(164.2250, device='cuda:3')
cal_distance is  tensor(164.2250, device='cuda:3')
cal ratio is  0.9498354957850693
distance x is tensor(155.9870, device='cuda:3')
cal_distance is  tensor(155.9870, device='cuda:3')
cal ratio is  0.9745943428791464
distance x is tensor(152.0241, device='cuda:3')
cal_distance is  tensor(152.0241, device='cuda:3')
distance x is tensor(152.0241, device='cuda:3')
return_distance is  tensor(152.0241, device='cuda:3')
distance x is tensor(152.0141, device='cuda:3')
distance x is tensor(152.0141, device='cuda:3')
________________________________
test distance is  tensor(152.0141, device='cuda:3')
test distance1 is  tensor(152.0141, device='cuda:3')
test similarity is  tensor(0.9798, device='cuda:3')
test acc is  0.17678333348966846
test loss is 30.23142767664212
test entropy is  0.049140127495364117
________________________________
0
distance x is tensor(152.0141, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.04974739050675334
avg test loss is  30.35253974369594
avg accuracy is  0.721316666822996
solo acc is  0.17758333348966843
compute similarity  is  tensor(0.9798, device='cuda:3')
compute_distance is  tensor(152.0141, device='cuda:3')
compute_norm is  tensor(62.1127, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.3224, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9428651226100637
avg test loss is  1.3820458536209075
avg accuracy is  0.7721166668229933
solo acc is  0.27335000015633887
compute similarity  is  tensor(0.9805, device='cuda:3')
compute_distance is  tensor(145.3224, device='cuda:3')
compute_norm is  tensor(61.8060, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(145.3224, device='cuda:3')
distance x is tensor(145.3224, device='cuda:3')
________________________________
test distance is  tensor(145.3224, device='cuda:3')
test distance1 is  tensor(145.3224, device='cuda:3')
test similarity is  tensor(0.9805, device='cuda:3')
test acc is  0.2695500001563388
test loss is 1.3805805551471995
test entropy is  0.943845198352708
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.300743818283081
mal norm is  tensor(753.6635, device='cuda:3')
distance x is tensor(145.3316, device='cuda:3')
mal distance is  tensor(145.3316, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([556.8862, 585.7465, 559.5952, 610.0644, 575.2638, 607.4950, 546.7018,
        592.4761, 753.6635, 753.6635, 753.6635, 753.6635, 753.6635, 753.6635,
        753.6635, 753.6635, 753.6635, 753.6635, 753.6635, 753.6635, 878.1808,
        869.9776, 934.4599, 919.9906, 926.2717, 866.7545, 867.4037, 855.5475,
        845.6006, 814.8031, 857.0411, 833.3695, 809.8832, 845.4201, 834.2262,
        798.5826, 658.2484, 650.2943, 599.8955, 646.9191, 620.1954, 628.4074,
        617.7657, 664.4895], device='cuda:3')
sorted_norm is   tensor([546.7018, 556.8862, 559.5952, 575.2638, 585.7465, 592.4761, 599.8955,
        607.4950, 610.0644, 617.7657, 620.1954, 628.4074, 646.9191, 650.2943,
        658.2484, 664.4895, 753.6635, 753.6635, 753.6635, 753.6635, 753.6635,
        753.6635, 753.6635, 753.6635, 753.6635, 753.6635, 753.6635, 753.6635,
        798.5826, 809.8832, 814.8031, 833.3695, 834.2262, 845.4201, 845.6006,
        855.5475, 857.0411, 866.7545, 867.4037, 869.9776, 878.1808, 919.9906,
        926.2717, 934.4599], device='cuda:3')
used idx is  tensor([ 6,  0,  2,  4,  1,  7, 38,  5,  3, 42, 40, 41, 39, 37, 36, 43, 19, 18,
        16, 17, 11, 10,  8,  9, 13, 12, 14, 15, 35, 32, 29, 31, 34, 33, 28],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 87.63% 

Test Accuracy: 86.73% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8458256721496582
distance x is tensor(133.4001, device='cuda:3')
benign distance is  tensor(133.4001, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2092675268650055
distance x is tensor(141.0368, device='cuda:3')
benign distance is  tensor(141.0368, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31454700231552124
distance x is tensor(126.3625, device='cuda:3')
benign distance is  tensor(126.3625, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.18587219715118408
distance x is tensor(134.3459, device='cuda:3')
benign distance is  tensor(134.3459, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4176817536354065
distance x is tensor(125.1067, device='cuda:3')
benign distance is  tensor(125.1067, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6865388751029968
distance x is tensor(138.0912, device='cuda:3')
benign distance is  tensor(138.0912, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.48968786001205444
distance x is tensor(130.3973, device='cuda:3')
benign distance is  tensor(130.3973, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4463828504085541
distance x is tensor(149.9829, device='cuda:3')
benign distance is  tensor(149.9829, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5275091528892517
distance x is tensor(134.4821, device='cuda:3')
benign distance is  tensor(134.4821, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5929054021835327
distance x is tensor(129.6000, device='cuda:3')
benign distance is  tensor(129.6000, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.37527310848236084
distance x is tensor(128.6239, device='cuda:3')
benign distance is  tensor(128.6239, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7772954106330872
distance x is tensor(152.0516, device='cuda:3')
benign distance is  tensor(152.0516, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.1885758340358734
distance x is tensor(137.9110, device='cuda:3')
benign distance is  tensor(137.9110, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.40205344557762146
distance x is tensor(143.0450, device='cuda:3')
benign distance is  tensor(143.0450, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5389465689659119
distance x is tensor(129.3230, device='cuda:3')
benign distance is  tensor(129.3230, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1735506057739258
distance x is tensor(140.9558, device='cuda:3')
benign distance is  tensor(140.9558, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.648530125617981
distance x is tensor(151.6200, device='cuda:3')
benign distance is  tensor(151.6200, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7392979860305786
distance x is tensor(125.2682, device='cuda:3')
benign distance is  tensor(125.2682, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8488202095031738
distance x is tensor(142.5154, device='cuda:3')
benign distance is  tensor(142.5154, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5503936409950256
distance x is tensor(146.2167, device='cuda:3')
benign distance is  tensor(146.2167, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5370877385139465
distance x is tensor(137.8575, device='cuda:3')
benign distance is  tensor(137.8575, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.33586105704307556
distance x is tensor(141.3471, device='cuda:3')
benign distance is  tensor(141.3471, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.18555083870887756
distance x is tensor(129.0776, device='cuda:3')
benign distance is  tensor(129.0776, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3280488848686218
distance x is tensor(133.7763, device='cuda:3')
benign distance is  tensor(133.7763, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.27831995487213135
distance x is tensor(141.9599, device='cuda:3')
benign distance is  tensor(141.9599, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.18739299476146698
distance x is tensor(145.8429, device='cuda:3')
benign distance is  tensor(145.8429, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5388315916061401
distance x is tensor(141.1699, device='cuda:3')
benign distance is  tensor(141.1699, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1068500503897667
distance x is tensor(134.1662, device='cuda:3')
benign distance is  tensor(134.1662, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.4558112621307373
distance x is tensor(136.9753, device='cuda:3')
benign distance is  tensor(136.9753, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.39661073684692383
distance x is tensor(132.6296, device='cuda:3')
benign distance is  tensor(132.6296, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.31456810235977173
distance x is tensor(138.1539, device='cuda:3')
benign distance is  tensor(138.1539, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6743980050086975
distance x is tensor(142.1764, device='cuda:3')
benign distance is  tensor(142.1764, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.9660, device='cuda:3')
compute distance is  tensor(137.9660, device='cuda:3')
compute norm is  tensor(58.6776, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9213, device='cuda:3')
compute distance is  tensor(132.9213, device='cuda:3')
compute norm is  tensor(58.4296, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8444, device='cuda:3')
compute distance is  tensor(131.8444, device='cuda:3')
compute norm is  tensor(58.5035, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9113, device='cuda:3')
compute distance is  tensor(141.9113, device='cuda:3')
compute norm is  tensor(58.6999, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.4448, device='cuda:3')
compute distance is  tensor(149.4448, device='cuda:3')
compute norm is  tensor(58.8937, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4290, device='cuda:3')
compute distance is  tensor(150.4290, device='cuda:3')
compute norm is  tensor(59.0000, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6214, device='cuda:3')
compute distance is  tensor(132.6214, device='cuda:3')
compute norm is  tensor(58.6397, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7689, device='cuda:3')
compute distance is  tensor(133.7689, device='cuda:3')
compute norm is  tensor(58.6205, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.6276, device='cuda:3')
compute distance is  tensor(157.6276, device='cuda:3')
compute norm is  tensor(59.0636, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7652, device='cuda:3')
compute distance is  tensor(137.7652, device='cuda:3')
compute norm is  tensor(58.7758, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3300, device='cuda:3')
compute distance is  tensor(139.3300, device='cuda:3')
compute norm is  tensor(58.8268, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9190, device='cuda:3')
compute distance is  tensor(127.9190, device='cuda:3')
compute norm is  tensor(58.5438, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.6276, device='cuda:3')
distance x is tensor(107517.5625, device='cuda:3')
distance x is tensor(107517.5625, device='cuda:3')
________________________________
test distance is  tensor(107517.5625, device='cuda:3')
test distance1 is  tensor(107517.5625, device='cuda:3')
test similarity is  tensor(0.5738, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130116436286317.72
test entropy is  0.0
________________________________
cal ratio is  0.03752342512581061
distance x is tensor(4034.4331, device='cuda:3')
cal_distance is  tensor(4034.4331, device='cuda:3')
cal ratio is  0.19370950123692363
distance x is tensor(781.5120, device='cuda:3')
cal_distance is  tensor(781.5120, device='cuda:3')
cal ratio is  0.440123281642373
distance x is tensor(343.9645, device='cuda:3')
cal_distance is  tensor(343.9645, device='cuda:3')
cal ratio is  0.663415147995102
distance x is tensor(228.1930, device='cuda:3')
cal_distance is  tensor(228.1930, device='cuda:3')
cal ratio is  0.8144999422151793
distance x is tensor(185.8641, device='cuda:3')
cal_distance is  tensor(185.8641, device='cuda:3')
cal ratio is  0.9024942646610482
distance x is tensor(167.7418, device='cuda:3')
cal_distance is  tensor(167.7418, device='cuda:3')
cal ratio is  0.949995583160071
distance x is tensor(159.3542, device='cuda:3')
cal_distance is  tensor(159.3542, device='cuda:3')
cal ratio is  0.9746763650075279
distance x is tensor(155.3189, device='cuda:3')
cal_distance is  tensor(155.3189, device='cuda:3')
distance x is tensor(155.3189, device='cuda:3')
return_distance is  tensor(155.3189, device='cuda:3')
distance x is tensor(155.3088, device='cuda:3')
distance x is tensor(155.3088, device='cuda:3')
________________________________
test distance is  tensor(155.3088, device='cuda:3')
test distance1 is  tensor(155.3088, device='cuda:3')
test similarity is  tensor(0.9798, device='cuda:3')
test acc is  0.36926666682300735
test loss is 23.911227409265187
test entropy is  0.0900558668103363
________________________________
0
distance x is tensor(155.3088, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.09073176244889368
avg test loss is  23.81673223275874
avg accuracy is  0.8122500001563249
solo acc is  0.3664166668230073
compute similarity  is  tensor(0.9798, device='cuda:3')
compute_distance is  tensor(155.3088, device='cuda:3')
compute_norm is  tensor(63.0018, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.5285, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9333043538176937
avg test loss is  1.3971587389008577
avg accuracy is  0.8086333334896584
solo acc is  0.28121666682300583
compute similarity  is  tensor(0.9802, device='cuda:3')
compute_distance is  tensor(150.5285, device='cuda:3')
compute_norm is  tensor(62.7508, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(150.5509, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8994099903843804
avg test loss is  1.4676143276666018
avg accuracy is  0.8101333334896582
solo acc is  0.23013333348967094
compute similarity  is  tensor(0.9801, device='cuda:3')
compute_distance is  tensor(150.5509, device='cuda:3')
compute_norm is  tensor(62.4511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(150.4753, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.881255916123197
avg test loss is  1.459599628758583
avg accuracy is  0.8125666668229915
solo acc is  0.2251333334896708
compute similarity  is  tensor(0.9800, device='cuda:3')
compute_distance is  tensor(150.4753, device='cuda:3')
compute_norm is  tensor(62.1537, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(150.3784, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8761330076626369
avg test loss is  1.437984111847908
avg accuracy is  0.8164833334896578
solo acc is  0.22781666682300414
compute similarity  is  tensor(0.9799, device='cuda:3')
compute_distance is  tensor(150.3784, device='cuda:3')
compute_norm is  tensor(61.8573, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(150.2772, device='cuda:3')
distance x is tensor(150.2772, device='cuda:3')
________________________________
test distance is  tensor(150.2772, device='cuda:3')
test distance1 is  tensor(150.2772, device='cuda:3')
test similarity is  tensor(0.9798, device='cuda:3')
test acc is  0.22935000015633758
test loss is 1.416436042485715
test entropy is  0.8753406903001545
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2302882671356201
mal norm is  tensor(735.0217, device='cuda:3')
distance x is tensor(150.2867, device='cuda:3')
mal distance is  tensor(150.2867, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([544.6537, 560.5288, 518.2828, 532.6569, 505.9890, 565.1146, 527.6239,
        614.2622, 735.0217, 735.0217, 735.0217, 735.0217, 735.0217, 735.0217,
        735.0217, 735.0217, 735.0217, 735.0217, 735.0217, 735.0217, 657.3110,
        669.5817, 633.0512, 649.5571, 645.4130, 606.8916, 648.9469, 655.9934],
       device='cuda:3')
sorted_norm is   tensor([505.9890, 518.2828, 527.6239, 532.6569, 544.6537, 560.5288, 565.1146,
        606.8916, 614.2622, 633.0512, 645.4130, 648.9469, 649.5571, 655.9934,
        657.3110, 669.5817, 735.0217, 735.0217, 735.0217, 735.0217, 735.0217,
        735.0217, 735.0217, 735.0217, 735.0217, 735.0217, 735.0217, 735.0217],
       device='cuda:3')
used idx is  tensor([ 4,  2,  6,  3,  0,  1,  5, 25,  7, 22, 24, 26, 23, 27, 20, 21, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.55% 

Test Accuracy: 87.48% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2742316722869873
distance x is tensor(135.2725, device='cuda:3')
benign distance is  tensor(135.2725, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.29423409700393677
distance x is tensor(136.4391, device='cuda:3')
benign distance is  tensor(136.4391, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.39647719264030457
distance x is tensor(114.4932, device='cuda:3')
benign distance is  tensor(114.4932, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5624539256095886
distance x is tensor(115.1236, device='cuda:3')
benign distance is  tensor(115.1236, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.840434193611145
distance x is tensor(133.3967, device='cuda:3')
benign distance is  tensor(133.3967, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0339598655700684
distance x is tensor(135.2526, device='cuda:3')
benign distance is  tensor(135.2526, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26669055223464966
distance x is tensor(126.3896, device='cuda:3')
benign distance is  tensor(126.3896, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3135998845100403
distance x is tensor(131.9381, device='cuda:3')
benign distance is  tensor(131.9381, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4451148509979248
distance x is tensor(125.5532, device='cuda:3')
benign distance is  tensor(125.5532, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.3928651809692383
distance x is tensor(140.8559, device='cuda:3')
benign distance is  tensor(140.8559, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3092678189277649
distance x is tensor(137.5006, device='cuda:3')
benign distance is  tensor(137.5006, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.041813850402832
distance x is tensor(129.8301, device='cuda:3')
benign distance is  tensor(129.8301, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2134580910205841
distance x is tensor(127.5304, device='cuda:3')
benign distance is  tensor(127.5304, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.84318608045578
distance x is tensor(123.3940, device='cuda:3')
benign distance is  tensor(123.3940, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5549238324165344
distance x is tensor(134.6318, device='cuda:3')
benign distance is  tensor(134.6318, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7898754477500916
distance x is tensor(119.0938, device='cuda:3')
benign distance is  tensor(119.0938, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.5116, device='cuda:3')
compute distance is  tensor(118.5116, device='cuda:3')
compute norm is  tensor(58.9375, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8079, device='cuda:3')
compute distance is  tensor(122.8079, device='cuda:3')
compute norm is  tensor(58.8273, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1793, device='cuda:3')
compute distance is  tensor(132.1793, device='cuda:3')
compute norm is  tensor(59.0136, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1354, device='cuda:3')
compute distance is  tensor(129.1354, device='cuda:3')
compute norm is  tensor(59.0257, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3535, device='cuda:3')
compute distance is  tensor(131.3535, device='cuda:3')
compute norm is  tensor(59.2586, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1981, device='cuda:3')
compute distance is  tensor(126.1981, device='cuda:3')
compute norm is  tensor(59.1569, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9565, device='cuda:3')
compute distance is  tensor(133.9565, device='cuda:3')
compute norm is  tensor(59.0238, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0813, device='cuda:3')
compute distance is  tensor(135.0813, device='cuda:3')
compute norm is  tensor(59.2892, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6277, device='cuda:3')
compute distance is  tensor(131.6277, device='cuda:3')
compute norm is  tensor(59.1133, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7499, device='cuda:3')
compute distance is  tensor(138.7499, device='cuda:3')
compute norm is  tensor(59.2410, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6682, device='cuda:3')
compute distance is  tensor(138.6682, device='cuda:3')
compute norm is  tensor(59.3181, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6156, device='cuda:3')
compute distance is  tensor(123.6156, device='cuda:3')
compute norm is  tensor(59.0489, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.7499, device='cuda:3')
distance x is tensor(107517.0078, device='cuda:3')
distance x is tensor(107517.0078, device='cuda:3')
________________________________
test distance is  tensor(107517.0078, device='cuda:3')
test distance1 is  tensor(107517.0078, device='cuda:3')
test similarity is  tensor(0.5776, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130071799564126.44
test entropy is  0.0
________________________________
cal ratio is  0.035204958318302775
distance x is tensor(3785.1372, device='cuda:3')
cal_distance is  tensor(3785.1372, device='cuda:3')
cal ratio is  0.1876297116869765
distance x is tensor(710.2081, device='cuda:3')
cal_distance is  tensor(710.2081, device='cuda:3')
cal ratio is  0.43316125371233716
distance x is tensor(307.6375, device='cuda:3')
cal_distance is  tensor(307.6375, device='cuda:3')
cal ratio is  0.6581468184478058
distance x is tensor(202.4724, device='cuda:3')
cal_distance is  tensor(202.4724, device='cuda:3')
cal ratio is  0.8112589624759174
distance x is tensor(164.2585, device='cuda:3')
cal_distance is  tensor(164.2585, device='cuda:3')
cal ratio is  0.900696545723358
distance x is tensor(147.9476, device='cuda:3')
cal_distance is  tensor(147.9476, device='cuda:3')
cal ratio is  0.9490487682591381
distance x is tensor(140.4097, device='cuda:3')
cal_distance is  tensor(140.4097, device='cuda:3')
cal ratio is  0.9741903573237374
distance x is tensor(136.7859, device='cuda:3')
cal_distance is  tensor(136.7859, device='cuda:3')
distance x is tensor(136.7859, device='cuda:3')
return_distance is  tensor(136.7859, device='cuda:3')
distance x is tensor(136.7759, device='cuda:3')
distance x is tensor(136.7759, device='cuda:3')
________________________________
test distance is  tensor(136.7759, device='cuda:3')
test distance1 is  tensor(136.7759, device='cuda:3')
test similarity is  tensor(0.9841, device='cuda:3')
test acc is  0.47813333348967524
test loss is 12.099073727756167
test entropy is  0.11160338866208662
________________________________
0
distance x is tensor(136.7759, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.10959581499780292
avg test loss is  12.200113702176223
avg accuracy is  0.8394666668229904
solo acc is  0.4772333334896752
compute similarity  is  tensor(0.9841, device='cuda:3')
compute_distance is  tensor(136.7759, device='cuda:3')
compute_norm is  tensor(62.7345, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(134.2294, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9341672913097878
avg test loss is  1.3531201541550886
avg accuracy is  0.8291500001563241
solo acc is  0.2923000001563394
compute similarity  is  tensor(0.9841, device='cuda:3')
compute_distance is  tensor(134.2294, device='cuda:3')
compute_norm is  tensor(62.4074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.4340, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8794994102612234
avg test loss is  1.4299604663970882
avg accuracy is  0.8299666668229907
solo acc is  0.24045000015633797
compute similarity  is  tensor(0.9840, device='cuda:3')
compute_distance is  tensor(134.4340, device='cuda:3')
compute_norm is  tensor(62.1061, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.4289, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8704638904981268
avg test loss is  1.420098625139387
avg accuracy is  0.8337166668229906
solo acc is  0.23533333348967111
compute similarity  is  tensor(0.9839, device='cuda:3')
compute_distance is  tensor(134.4289, device='cuda:3')
compute_norm is  tensor(61.8066, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.4474, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8660007302186636
avg test loss is  1.3960185542797992
avg accuracy is  0.8344333334896572
solo acc is  0.23836666682300453
compute similarity  is  tensor(0.9838, device='cuda:3')
compute_distance is  tensor(134.4474, device='cuda:3')
compute_norm is  tensor(61.5081, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.5513, device='cuda:3')
distance x is tensor(134.5513, device='cuda:3')
________________________________
test distance is  tensor(134.5513, device='cuda:3')
test distance1 is  tensor(134.5513, device='cuda:3')
test similarity is  tensor(0.9837, device='cuda:3')
test acc is  0.2396166668230046
test loss is 1.3874859302791196
test entropy is  0.8513886957153328
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2270894050598145
mal norm is  tensor(648.3451, device='cuda:3')
distance x is tensor(134.5605, device='cuda:3')
mal distance is  tensor(134.5605, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([546.4481, 555.9612, 471.9706, 473.6955, 529.8613, 543.9316, 514.2128,
        535.8564, 648.3451, 648.3451, 648.3451, 648.3451, 648.3451, 648.3451,
        648.3451, 648.3451, 648.3451, 648.3451, 648.3451, 648.3451, 556.1379,
        536.3010, 526.2520, 615.4175, 551.9966, 593.2616, 531.4063, 585.1012],
       device='cuda:3')
sorted_norm is   tensor([471.9706, 473.6955, 514.2128, 526.2520, 529.8613, 531.4063, 535.8564,
        536.3010, 543.9316, 546.4481, 551.9966, 555.9612, 556.1379, 585.1012,
        593.2616, 615.4175, 648.3451, 648.3451, 648.3451, 648.3451, 648.3451,
        648.3451, 648.3451, 648.3451, 648.3451, 648.3451, 648.3451, 648.3451],
       device='cuda:3')
used idx is  tensor([ 2,  3,  6, 22,  4, 26,  7, 21,  5,  0, 24,  1, 20, 27, 25, 23, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.64% 

Test Accuracy: 87.60% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45721474289894104
distance x is tensor(119.6916, device='cuda:3')
benign distance is  tensor(119.6916, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4375119209289551
distance x is tensor(128.5181, device='cuda:3')
benign distance is  tensor(128.5181, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4552193284034729
distance x is tensor(138.0966, device='cuda:3')
benign distance is  tensor(138.0966, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.012992262840271
distance x is tensor(125.9110, device='cuda:3')
benign distance is  tensor(125.9110, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7198269963264465
distance x is tensor(112.7320, device='cuda:3')
benign distance is  tensor(112.7320, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0339736938476562
distance x is tensor(128.8642, device='cuda:3')
benign distance is  tensor(128.8642, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7209964990615845
distance x is tensor(129.2536, device='cuda:3')
benign distance is  tensor(129.2536, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2581944167613983
distance x is tensor(139.1015, device='cuda:3')
benign distance is  tensor(139.1015, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3963696360588074
distance x is tensor(130.9407, device='cuda:3')
benign distance is  tensor(130.9407, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0448271036148071
distance x is tensor(131.5233, device='cuda:3')
benign distance is  tensor(131.5233, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.24774225056171417
distance x is tensor(119.4833, device='cuda:3')
benign distance is  tensor(119.4833, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3643113970756531
distance x is tensor(145.1463, device='cuda:3')
benign distance is  tensor(145.1463, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5122071504592896
distance x is tensor(141.9169, device='cuda:3')
benign distance is  tensor(141.9169, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6105369329452515
distance x is tensor(134.6062, device='cuda:3')
benign distance is  tensor(134.6062, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.44606152176856995
distance x is tensor(127.3900, device='cuda:3')
benign distance is  tensor(127.3900, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9138873219490051
distance x is tensor(133.6007, device='cuda:3')
benign distance is  tensor(133.6007, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(136.1509, device='cuda:3')
compute distance is  tensor(136.1509, device='cuda:3')
compute norm is  tensor(60.5175, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9919, device='cuda:3')
compute distance is  tensor(126.9919, device='cuda:3')
compute norm is  tensor(60.2665, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2019, device='cuda:3')
compute distance is  tensor(138.2019, device='cuda:3')
compute norm is  tensor(60.4853, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1371, device='cuda:3')
compute distance is  tensor(126.1371, device='cuda:3')
compute norm is  tensor(60.3677, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.6560, device='cuda:3')
compute distance is  tensor(154.6560, device='cuda:3')
compute norm is  tensor(61.2018, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5082, device='cuda:3')
compute distance is  tensor(135.5082, device='cuda:3')
compute norm is  tensor(60.6169, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9721, device='cuda:3')
compute distance is  tensor(127.9721, device='cuda:3')
compute norm is  tensor(60.4092, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0611, device='cuda:3')
compute distance is  tensor(133.0611, device='cuda:3')
compute norm is  tensor(60.3756, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8520, device='cuda:3')
compute distance is  tensor(139.8520, device='cuda:3')
compute norm is  tensor(60.6044, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3518, device='cuda:3')
compute distance is  tensor(134.3518, device='cuda:3')
compute norm is  tensor(60.7016, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.7870, device='cuda:3')
compute distance is  tensor(141.7870, device='cuda:3')
compute norm is  tensor(60.7060, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5413, device='cuda:3')
compute distance is  tensor(133.5413, device='cuda:3')
compute norm is  tensor(60.5182, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.6560, device='cuda:3')
distance x is tensor(107501.5391, device='cuda:3')
distance x is tensor(107501.5391, device='cuda:3')
________________________________
test distance is  tensor(107501.5391, device='cuda:3')
test distance1 is  tensor(107501.5391, device='cuda:3')
test similarity is  tensor(0.5989, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130062113091802.34
test entropy is  0.0
________________________________
cal ratio is  0.03717081318340823
distance x is tensor(3995.9253, device='cuda:3')
cal_distance is  tensor(3995.9253, device='cuda:3')
cal ratio is  0.1927971998949789
distance x is tensor(770.4072, device='cuda:3')
cal_distance is  tensor(770.4072, device='cuda:3')
cal ratio is  0.4390856415565511
distance x is tensor(338.2776, device='cuda:3')
cal_distance is  tensor(338.2776, device='cuda:3')
cal ratio is  0.6626325999570535
distance x is tensor(224.1555, device='cuda:3')
cal_distance is  tensor(224.1555, device='cuda:3')
cal ratio is  0.814019391066156
distance x is tensor(182.4678, device='cuda:3')
cal_distance is  tensor(182.4678, device='cuda:3')
cal ratio is  0.9022279187388924
distance x is tensor(164.6281, device='cuda:3')
cal_distance is  tensor(164.6281, device='cuda:3')
cal ratio is  0.9498553236168246
distance x is tensor(156.3731, device='cuda:3')
cal_distance is  tensor(156.3731, device='cuda:3')
cal ratio is  0.9746044455118831
distance x is tensor(152.4021, device='cuda:3')
cal_distance is  tensor(152.4021, device='cuda:3')
distance x is tensor(152.4021, device='cuda:3')
return_distance is  tensor(152.4021, device='cuda:3')
distance x is tensor(152.3920, device='cuda:3')
distance x is tensor(152.3920, device='cuda:3')
________________________________
test distance is  tensor(152.3920, device='cuda:3')
test distance1 is  tensor(152.3920, device='cuda:3')
test similarity is  tensor(0.9828, device='cuda:3')
test acc is  0.2030833334896699
test loss is 51.33188954497705
test entropy is  0.03893343981842933
________________________________
0
distance x is tensor(152.3920, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.039484537861643555
avg test loss is  51.53035953660001
avg accuracy is  0.8000000001563254
solo acc is  0.20243333348966977
compute similarity  is  tensor(0.9828, device='cuda:3')
compute_distance is  tensor(152.3920, device='cuda:3')
compute_norm is  tensor(64.9326, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.3809, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.934814414426462
avg test loss is  1.4130231503611688
avg accuracy is  0.8154166668229913
solo acc is  0.2832666668230058
compute similarity  is  tensor(0.9833, device='cuda:3')
compute_distance is  tensor(149.3809, device='cuda:3')
compute_norm is  tensor(64.7821, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(149.1044, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8807468353939463
avg test loss is  1.4822472077188715
avg accuracy is  0.816483333489658
solo acc is  0.22311666682300396
compute similarity  is  tensor(0.9832, device='cuda:3')
compute_distance is  tensor(149.1044, device='cuda:3')
compute_norm is  tensor(64.4685, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.7009, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8719598934975769
avg test loss is  1.4581884652820987
avg accuracy is  0.8188500001563246
solo acc is  0.22483333348967074
compute similarity  is  tensor(0.9831, device='cuda:3')
compute_distance is  tensor(148.7009, device='cuda:3')
compute_norm is  tensor(64.1558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.3643, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8797650327687578
avg test loss is  1.4361825515466458
avg accuracy is  0.8218833334896578
solo acc is  0.2175666668230037
compute similarity  is  tensor(0.9831, device='cuda:3')
compute_distance is  tensor(148.3643, device='cuda:3')
compute_norm is  tensor(63.8457, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(148.0923, device='cuda:3')
distance x is tensor(148.0923, device='cuda:3')
________________________________
test distance is  tensor(148.0923, device='cuda:3')
test distance1 is  tensor(148.0923, device='cuda:3')
test similarity is  tensor(0.9830, device='cuda:3')
test acc is  0.21821666682300375
test loss is 1.4280651467187064
test entropy is  0.8639770461552179
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.1180989742279053
mal norm is  tensor(716.6824, device='cuda:3')
distance x is tensor(148.1018, device='cuda:3')
mal distance is  tensor(148.1018, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([491.2265, 516.9748, 549.4379, 504.5647, 466.0458, 522.4240, 517.7226,
        564.9713, 716.6823, 716.6824, 716.6823, 716.6824, 716.6823, 716.6824,
        716.6823, 716.6824, 716.6823, 716.6824, 716.6823, 716.6824],
       device='cuda:3')
sorted_norm is   tensor([466.0458, 491.2265, 504.5647, 516.9748, 517.7226, 522.4240, 549.4379,
        564.9713, 716.6823, 716.6823, 716.6823, 716.6823, 716.6823, 716.6823,
        716.6824, 716.6824, 716.6824, 716.6824, 716.6824, 716.6824],
       device='cuda:3')
used idx is  tensor([ 4,  0,  3,  1,  6,  5,  2,  7, 18, 16, 12, 14, 10,  8, 17, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 85.32% 

Test Accuracy: 84.15% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36286625266075134
distance x is tensor(154.2240, device='cuda:3')
benign distance is  tensor(154.2240, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.631588339805603
distance x is tensor(143.2221, device='cuda:3')
benign distance is  tensor(143.2221, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7694622278213501
distance x is tensor(134.6316, device='cuda:3')
benign distance is  tensor(134.6316, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4203574061393738
distance x is tensor(151.3581, device='cuda:3')
benign distance is  tensor(151.3581, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.99781334400177
distance x is tensor(122.7374, device='cuda:3')
benign distance is  tensor(122.7374, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8928826451301575
distance x is tensor(170.7102, device='cuda:3')
benign distance is  tensor(170.7102, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.876563549041748
distance x is tensor(144.7448, device='cuda:3')
benign distance is  tensor(144.7448, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4772319793701172
distance x is tensor(149.8108, device='cuda:3')
benign distance is  tensor(149.8108, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(133.9193, device='cuda:3')
compute distance is  tensor(133.9193, device='cuda:3')
compute norm is  tensor(63.0814, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8335, device='cuda:3')
compute distance is  tensor(134.8335, device='cuda:3')
compute norm is  tensor(63.0996, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1575, device='cuda:3')
compute distance is  tensor(149.1575, device='cuda:3')
compute norm is  tensor(63.3350, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.3850, device='cuda:3')
compute distance is  tensor(143.3850, device='cuda:3')
compute norm is  tensor(63.2202, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.4462, device='cuda:3')
compute distance is  tensor(152.4462, device='cuda:3')
compute norm is  tensor(63.6066, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.1180, device='cuda:3')
compute distance is  tensor(144.1180, device='cuda:3')
compute norm is  tensor(63.3659, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.9095, device='cuda:3')
compute distance is  tensor(146.9095, device='cuda:3')
compute norm is  tensor(63.2720, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9396, device='cuda:3')
compute distance is  tensor(144.9396, device='cuda:3')
compute norm is  tensor(63.3278, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.5968, device='cuda:3')
compute distance is  tensor(167.5968, device='cuda:3')
compute norm is  tensor(63.7373, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.9475, device='cuda:3')
compute distance is  tensor(146.9475, device='cuda:3')
compute norm is  tensor(63.4792, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.2034, device='cuda:3')
compute distance is  tensor(165.2034, device='cuda:3')
compute norm is  tensor(63.7621, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.1750, device='cuda:3')
compute distance is  tensor(170.1750, device='cuda:3')
compute norm is  tensor(64.1767, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.1750, device='cuda:3')
distance x is tensor(107447.8281, device='cuda:3')
distance x is tensor(107447.8281, device='cuda:3')
________________________________
test distance is  tensor(107447.8281, device='cuda:3')
test distance1 is  tensor(107447.8281, device='cuda:3')
test similarity is  tensor(0.6604, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130032289765974.25
test entropy is  0.0
________________________________
cal ratio is  0.0390009398954879
distance x is tensor(4190.5718, device='cuda:3')
cal_distance is  tensor(4190.5718, device='cuda:3')
cal ratio is  0.19748642790688864
distance x is tensor(827.5850, device='cuda:3')
cal_distance is  tensor(827.5850, device='cuda:3')
cal ratio is  0.4443933865543293
distance x is tensor(367.7761, device='cuda:3')
cal_distance is  tensor(367.7761, device='cuda:3')
cal ratio is  0.6666258302569338
distance x is tensor(245.1707, device='cuda:3')
cal_distance is  tensor(245.1707, device='cuda:3')
cal ratio is  0.816468783802711
distance x is tensor(200.1752, device='cuda:3')
cal_distance is  tensor(200.1752, device='cuda:3')
cal ratio is  0.9035845213406762
distance x is tensor(180.8757, device='cuda:3')
cal_distance is  tensor(180.8757, device='cuda:3')
cal ratio is  0.9505693921008554
distance x is tensor(171.9352, device='cuda:3')
cal_distance is  tensor(171.9352, device='cuda:3')
cal ratio is  0.9749707126987105
distance x is tensor(167.6319, device='cuda:3')
cal_distance is  tensor(167.6319, device='cuda:3')
distance x is tensor(167.6319, device='cuda:3')
return_distance is  tensor(167.6319, device='cuda:3')
distance x is tensor(167.6219, device='cuda:3')
distance x is tensor(167.6219, device='cuda:3')
________________________________
test distance is  tensor(167.6219, device='cuda:3')
test distance1 is  tensor(167.6219, device='cuda:3')
test similarity is  tensor(0.9847, device='cuda:3')
test acc is  0.10868333348966529
test loss is 108.49816066522334
test entropy is  0.006000169803148245
________________________________
0
distance x is tensor(167.6219, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.005965840243548537
avg test loss is  108.38253200994626
avg accuracy is  0.6358666668230015
solo acc is  0.10815000015633196
compute similarity  is  tensor(0.9847, device='cuda:3')
compute_distance is  tensor(167.6219, device='cuda:3')
compute_norm is  tensor(68.8620, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.5657, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.035478099704043
avg test loss is  1.5060686611417513
avg accuracy is  0.7598500001563273
solo acc is  0.2532333334896717
compute similarity  is  tensor(0.9852, device='cuda:3')
compute_distance is  tensor(164.5657, device='cuda:3')
compute_norm is  tensor(69.0477, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.5027, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6255851363195285
avg test loss is  2.411848416206425
avg accuracy is  0.7188500001563295
solo acc is  0.1056833334896653
compute similarity  is  tensor(0.9851, device='cuda:3')
compute_distance is  tensor(164.5027, device='cuda:3')
compute_norm is  tensor(68.8084, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.9663, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9669024333008317
avg test loss is  1.4353073353706391
avg accuracy is  0.7606000001563273
solo acc is  0.24595000015633806
compute similarity  is  tensor(0.9853, device='cuda:3')
compute_distance is  tensor(162.9663, device='cuda:3')
compute_norm is  tensor(68.4676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(162.9663, device='cuda:3')
distance x is tensor(162.9663, device='cuda:3')
________________________________
test distance is  tensor(162.9663, device='cuda:3')
test distance1 is  tensor(162.9663, device='cuda:3')
test similarity is  tensor(0.9853, device='cuda:3')
test acc is  0.2472166668230048
test loss is 1.4330499742839382
test entropy is  0.967031285897501
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1982873678207397
mal norm is  tensor(808.9269, device='cuda:3')
distance x is tensor(162.9759, device='cuda:3')
mal distance is  tensor(162.9759, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 626.0089,  572.9114,  532.6085,  593.1647,  498.3154,  648.9297,
         567.4378,  597.3682,  808.9270,  808.9269,  808.9270,  808.9269,
         808.9270,  808.9269,  808.9270,  808.9269,  808.9270,  808.9269,
         808.9270,  808.9269, 1017.3420, 1022.7555, 1045.6405, 1035.0842,
        1007.1424, 1036.7721, 1069.7957, 1040.7854,  810.4160,  748.1671,
         787.7774,  797.2875,  778.8083,  787.8214,  757.3470,  763.3896,
         720.5233,  770.2236,  753.7280,  735.2142,  726.6907,  711.5422,
         749.4070,  703.6614,  655.3809,  667.1065,  616.9660,  710.2714,
         680.7104,  667.8636,  645.0260,  667.0452], device='cuda:3')
sorted_norm is   tensor([ 498.3154,  532.6085,  567.4378,  572.9114,  593.1647,  597.3682,
         616.9660,  626.0089,  645.0260,  648.9297,  655.3809,  667.0452,
         667.1065,  667.8636,  680.7104,  703.6614,  710.2714,  711.5422,
         720.5233,  726.6907,  735.2142,  748.1671,  749.4070,  753.7280,
         757.3470,  763.3896,  770.2236,  778.8083,  787.7774,  787.8214,
         797.2875,  808.9269,  808.9269,  808.9269,  808.9269,  808.9269,
         808.9269,  808.9270,  808.9270,  808.9270,  808.9270,  808.9270,
         808.9270,  810.4160, 1007.1424, 1017.3420, 1022.7555, 1035.0842,
        1036.7721, 1040.7854, 1045.6405, 1069.7957], device='cuda:3')
used idx is  tensor([ 4,  2,  6,  1,  3,  7, 46,  0, 50,  5, 44, 51, 45, 49, 48, 43, 47, 41,
        36, 40, 39, 29, 42, 38, 34, 35, 37, 32, 30, 33, 31, 17, 19,  9, 13, 11,
        15,  8, 10, 12, 16], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 87.31% 

Test Accuracy: 86.21% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5234432220458984
distance x is tensor(136.1155, device='cuda:3')
benign distance is  tensor(136.1155, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7672486305236816
distance x is tensor(119.3992, device='cuda:3')
benign distance is  tensor(119.3992, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1662806123495102
distance x is tensor(137.2545, device='cuda:3')
benign distance is  tensor(137.2545, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9123819470405579
distance x is tensor(124.7436, device='cuda:3')
benign distance is  tensor(124.7436, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.635142982006073
distance x is tensor(137.3643, device='cuda:3')
benign distance is  tensor(137.3643, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5674772262573242
distance x is tensor(138.6472, device='cuda:3')
benign distance is  tensor(138.6472, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4087871015071869
distance x is tensor(136.6283, device='cuda:3')
benign distance is  tensor(136.6283, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5166336297988892
distance x is tensor(126.3372, device='cuda:3')
benign distance is  tensor(126.3372, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6079269647598267
distance x is tensor(128.8358, device='cuda:3')
benign distance is  tensor(128.8358, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.40894851088523865
distance x is tensor(130.8154, device='cuda:3')
benign distance is  tensor(130.8154, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6892936825752258
distance x is tensor(115.4645, device='cuda:3')
benign distance is  tensor(115.4645, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2617078125476837
distance x is tensor(148.7187, device='cuda:3')
benign distance is  tensor(148.7187, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6143174171447754
distance x is tensor(125.0964, device='cuda:3')
benign distance is  tensor(125.0964, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3955272436141968
distance x is tensor(130.3276, device='cuda:3')
benign distance is  tensor(130.3276, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.13972976803779602
distance x is tensor(134.5078, device='cuda:3')
benign distance is  tensor(134.5078, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.23993773758411407
distance x is tensor(131.3616, device='cuda:3')
benign distance is  tensor(131.3616, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5200310945510864
distance x is tensor(122.0477, device='cuda:3')
benign distance is  tensor(122.0477, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6856107711791992
distance x is tensor(143.6681, device='cuda:3')
benign distance is  tensor(143.6681, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.22838611900806427
distance x is tensor(135.6402, device='cuda:3')
benign distance is  tensor(135.6402, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.20653286576271057
distance x is tensor(135.4253, device='cuda:3')
benign distance is  tensor(135.4253, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4898017346858978
distance x is tensor(130.3244, device='cuda:3')
benign distance is  tensor(130.3244, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8837779760360718
distance x is tensor(129.3397, device='cuda:3')
benign distance is  tensor(129.3397, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.29158371686935425
distance x is tensor(145.7764, device='cuda:3')
benign distance is  tensor(145.7764, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.23198457062244415
distance x is tensor(125.8594, device='cuda:3')
benign distance is  tensor(125.8594, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.7069304585456848
distance x is tensor(146.3137, device='cuda:3')
benign distance is  tensor(146.3137, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7763558030128479
distance x is tensor(126.8325, device='cuda:3')
benign distance is  tensor(126.8325, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5112882852554321
distance x is tensor(146.4862, device='cuda:3')
benign distance is  tensor(146.4862, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5602344870567322
distance x is tensor(136.4784, device='cuda:3')
benign distance is  tensor(136.4784, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6294510960578918
distance x is tensor(131.4680, device='cuda:3')
benign distance is  tensor(131.4680, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.49502816796302795
distance x is tensor(147.7236, device='cuda:3')
benign distance is  tensor(147.7236, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6466242671012878
distance x is tensor(144.3434, device='cuda:3')
benign distance is  tensor(144.3434, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3044334053993225
distance x is tensor(131.5281, device='cuda:3')
benign distance is  tensor(131.5281, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4234452247619629
distance x is tensor(133.0275, device='cuda:3')
benign distance is  tensor(133.0275, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6368564963340759
distance x is tensor(137.0694, device='cuda:3')
benign distance is  tensor(137.0694, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5228828191757202
distance x is tensor(123.7263, device='cuda:3')
benign distance is  tensor(123.7263, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.20798878371715546
distance x is tensor(133.1037, device='cuda:3')
benign distance is  tensor(133.1037, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.1617801189422607
distance x is tensor(130.5882, device='cuda:3')
benign distance is  tensor(130.5882, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7179989218711853
distance x is tensor(130.5833, device='cuda:3')
benign distance is  tensor(130.5833, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0429794788360596
distance x is tensor(145.5912, device='cuda:3')
benign distance is  tensor(145.5912, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2264775037765503
distance x is tensor(124.4908, device='cuda:3')
benign distance is  tensor(124.4908, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(128.1922, device='cuda:3')
compute distance is  tensor(128.1922, device='cuda:3')
compute norm is  tensor(62.9909, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8486, device='cuda:3')
compute distance is  tensor(134.8486, device='cuda:3')
compute norm is  tensor(62.8913, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.8860, device='cuda:3')
compute distance is  tensor(144.8860, device='cuda:3')
compute norm is  tensor(63.3372, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7465, device='cuda:3')
compute distance is  tensor(133.7465, device='cuda:3')
compute norm is  tensor(62.9722, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0261, device='cuda:3')
compute distance is  tensor(144.0261, device='cuda:3')
compute norm is  tensor(63.3875, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.1954, device='cuda:3')
compute distance is  tensor(144.1954, device='cuda:3')
compute norm is  tensor(63.4562, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9228, device='cuda:3')
compute distance is  tensor(128.9228, device='cuda:3')
compute norm is  tensor(62.9341, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9309, device='cuda:3')
compute distance is  tensor(126.9309, device='cuda:3')
compute norm is  tensor(63.0474, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6736, device='cuda:3')
compute distance is  tensor(152.6736, device='cuda:3')
compute norm is  tensor(63.3960, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.0814, device='cuda:3')
compute distance is  tensor(143.0814, device='cuda:3')
compute norm is  tensor(63.2805, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1947, device='cuda:3')
compute distance is  tensor(142.1947, device='cuda:3')
compute norm is  tensor(63.3782, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2417, device='cuda:3')
compute distance is  tensor(121.2417, device='cuda:3')
compute norm is  tensor(62.8609, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.6736, device='cuda:3')
distance x is tensor(107469.7109, device='cuda:3')
distance x is tensor(107469.7109, device='cuda:3')
________________________________
test distance is  tensor(107469.7109, device='cuda:3')
test distance1 is  tensor(107469.7109, device='cuda:3')
test similarity is  tensor(0.6395, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130152992936730.75
test entropy is  0.0
________________________________
cal ratio is  0.03693728941871109
distance x is tensor(3969.6450, device='cuda:3')
cal_distance is  tensor(3969.6450, device='cuda:3')
cal ratio is  0.19219064205981717
distance x is tensor(762.9327, device='cuda:3')
cal_distance is  tensor(762.9327, device='cuda:3')
cal ratio is  0.43839433969450103
distance x is tensor(334.4682, device='cuda:3')
cal_distance is  tensor(334.4682, device='cuda:3')
cal ratio is  0.6621107981078571
distance x is tensor(221.4567, device='cuda:3')
cal_distance is  tensor(221.4567, device='cuda:3')
cal ratio is  0.8136987604395968
distance x is tensor(180.2000, device='cuda:3')
cal_distance is  tensor(180.2000, device='cuda:3')
cal ratio is  0.9020501841796802
distance x is tensor(162.5499, device='cuda:3')
cal_distance is  tensor(162.5499, device='cuda:3')
cal ratio is  0.9497617253842179
distance x is tensor(154.3840, device='cuda:3')
cal_distance is  tensor(154.3840, device='cuda:3')
cal ratio is  0.9745563102265792
distance x is tensor(150.4560, device='cuda:3')
cal_distance is  tensor(150.4560, device='cuda:3')
distance x is tensor(150.4560, device='cuda:3')
return_distance is  tensor(150.4560, device='cuda:3')
distance x is tensor(150.4460, device='cuda:3')
distance x is tensor(150.4460, device='cuda:3')
________________________________
test distance is  tensor(150.4460, device='cuda:3')
test distance1 is  tensor(150.4460, device='cuda:3')
test similarity is  tensor(0.9863, device='cuda:3')
test acc is  0.6695333334896659
test loss is 4.01362139672867
test entropy is  0.1575692281929224
________________________________
0
distance x is tensor(150.4460, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.1563797070861244
avg test loss is  4.0219726248590675
avg accuracy is  0.8528000001563231
solo acc is  0.6691333334896659
compute similarity  is  tensor(0.9863, device='cuda:3')
compute_distance is  tensor(150.4460, device='cuda:3')
compute_norm is  tensor(67.7645, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.2019, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9206753451305666
avg test loss is  1.3643084970364439
avg accuracy is  0.8161500001563247
solo acc is  0.2964833334896728
compute similarity  is  tensor(0.9864, device='cuda:3')
compute_distance is  tensor(147.2019, device='cuda:3')
compute_norm is  tensor(67.4853, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.8811, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8847652255599179
avg test loss is  1.4478017198505686
avg accuracy is  0.8175333334896581
solo acc is  0.23848333348967116
compute similarity  is  tensor(0.9863, device='cuda:3')
compute_distance is  tensor(146.8811, device='cuda:3')
compute_norm is  tensor(67.1585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.4811, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8754453200267068
avg test loss is  1.4356777129142777
avg accuracy is  0.8216833334896577
solo acc is  0.23360000015633772
compute similarity  is  tensor(0.9863, device='cuda:3')
compute_distance is  tensor(146.4811, device='cuda:3')
compute_norm is  tensor(66.8341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.0562, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8693226474815848
avg test loss is  1.4124415318594812
avg accuracy is  0.8238500001563245
solo acc is  0.2358833334896712
compute similarity  is  tensor(0.9862, device='cuda:3')
compute_distance is  tensor(146.0562, device='cuda:3')
compute_norm is  tensor(66.5133, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.7335, device='cuda:3')
distance x is tensor(145.7335, device='cuda:3')
________________________________
test distance is  tensor(145.7335, device='cuda:3')
test distance1 is  tensor(145.7335, device='cuda:3')
test similarity is  tensor(0.9861, device='cuda:3')
test acc is  0.2326833334896711
test loss is 1.4006847548586474
test entropy is  0.8667958359093045
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.184402585029602
mal norm is  tensor(705.4680, device='cuda:3')
distance x is tensor(145.7428, device='cuda:3')
mal distance is  tensor(145.7428, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([559.7006, 488.0192, 554.9550, 512.4351, 555.5709, 571.0200, 544.0948,
        514.3746, 705.4680, 705.4680, 705.4680, 705.4680, 705.4680, 705.4680,
        705.4680, 705.4680, 705.4680, 705.4680, 705.4680, 705.4680, 725.6645,
        740.9874, 731.2328, 719.4572, 718.3651, 706.1326, 718.5716, 726.4227],
       device='cuda:3')
sorted_norm is   tensor([488.0192, 512.4351, 514.3746, 544.0948, 554.9550, 555.5709, 559.7006,
        571.0200, 705.4680, 705.4680, 705.4680, 705.4680, 705.4680, 705.4680,
        705.4680, 705.4680, 705.4680, 705.4680, 705.4680, 705.4680, 706.1326,
        718.3651, 718.5716, 719.4572, 725.6645, 726.4227, 731.2328, 740.9874],
       device='cuda:3')
used idx is  tensor([ 1,  3,  7,  6,  2,  4,  0,  5, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 25, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 83.73% 

Test Accuracy: 82.73% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8692668080329895
distance x is tensor(144.6868, device='cuda:3')
benign distance is  tensor(144.6868, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.40003061294555664
distance x is tensor(147.1477, device='cuda:3')
benign distance is  tensor(147.1477, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3051752746105194
distance x is tensor(153.1047, device='cuda:3')
benign distance is  tensor(153.1047, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6286714673042297
distance x is tensor(141.0301, device='cuda:3')
benign distance is  tensor(141.0301, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4557570517063141
distance x is tensor(144.9951, device='cuda:3')
benign distance is  tensor(144.9951, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.40933769941329956
distance x is tensor(156.1013, device='cuda:3')
benign distance is  tensor(156.1013, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9275539517402649
distance x is tensor(133.8955, device='cuda:3')
benign distance is  tensor(133.8955, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4284629225730896
distance x is tensor(144.9398, device='cuda:3')
benign distance is  tensor(144.9398, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7521096467971802
distance x is tensor(148.4337, device='cuda:3')
benign distance is  tensor(148.4337, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.6605368852615356
distance x is tensor(156.3305, device='cuda:3')
benign distance is  tensor(156.3305, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2649950683116913
distance x is tensor(141.9586, device='cuda:3')
benign distance is  tensor(141.9586, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3718140125274658
distance x is tensor(139.4293, device='cuda:3')
benign distance is  tensor(139.4293, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.42430272698402405
distance x is tensor(133.8081, device='cuda:3')
benign distance is  tensor(133.8081, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7800858616828918
distance x is tensor(136.1254, device='cuda:3')
benign distance is  tensor(136.1254, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2692411243915558
distance x is tensor(142.6370, device='cuda:3')
benign distance is  tensor(142.6370, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.21691200137138367
distance x is tensor(150.7885, device='cuda:3')
benign distance is  tensor(150.7885, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(138.1458, device='cuda:3')
compute distance is  tensor(138.1458, device='cuda:3')
compute norm is  tensor(65.6177, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4816, device='cuda:3')
compute distance is  tensor(150.4816, device='cuda:3')
compute norm is  tensor(65.7041, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.4642, device='cuda:3')
compute distance is  tensor(165.4642, device='cuda:3')
compute norm is  tensor(66.3666, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.6162, device='cuda:3')
compute distance is  tensor(147.6162, device='cuda:3')
compute norm is  tensor(65.8148, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.3467, device='cuda:3')
compute distance is  tensor(175.3467, device='cuda:3')
compute norm is  tensor(66.4932, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9830, device='cuda:3')
compute distance is  tensor(142.9830, device='cuda:3')
compute norm is  tensor(65.8041, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.2194, device='cuda:3')
compute distance is  tensor(158.2194, device='cuda:3')
compute norm is  tensor(66.1849, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5379, device='cuda:3')
compute distance is  tensor(140.5379, device='cuda:3')
compute norm is  tensor(65.7618, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6500, device='cuda:3')
compute distance is  tensor(152.6500, device='cuda:3')
compute norm is  tensor(66.1623, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.8609, device='cuda:3')
compute distance is  tensor(139.8609, device='cuda:3')
compute norm is  tensor(65.8448, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.9707, device='cuda:3')
compute distance is  tensor(147.9707, device='cuda:3')
compute norm is  tensor(65.9640, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.1802, device='cuda:3')
compute distance is  tensor(140.1802, device='cuda:3')
compute norm is  tensor(65.8526, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(175.3467, device='cuda:3')
distance x is tensor(107412.8750, device='cuda:3')
distance x is tensor(107412.8750, device='cuda:3')
________________________________
test distance is  tensor(107412.8750, device='cuda:3')
test distance1 is  tensor(107412.8750, device='cuda:3')
test similarity is  tensor(0.6945, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130164117241506.66
test entropy is  0.0
________________________________
cal ratio is  0.03959558109203864
distance x is tensor(4253.0806, device='cuda:3')
cal_distance is  tensor(4253.0806, device='cuda:3')
cal ratio is  0.1989862525238796
distance x is tensor(846.3085, device='cuda:3')
cal_distance is  tensor(846.3085, device='cuda:3')
cal ratio is  0.4460777125440354
distance x is tensor(377.5221, device='cuda:3')
cal_distance is  tensor(377.5221, device='cuda:3')
cal ratio is  0.6678880657433035
distance x is tensor(252.1442, device='cuda:3')
cal_distance is  tensor(252.1442, device='cuda:3')
cal ratio is  0.8172415086684921
distance x is tensor(206.0636, device='cuda:3')
cal_distance is  tensor(206.0636, device='cuda:3')
cal ratio is  0.9040120492934981
distance x is tensor(186.2845, device='cuda:3')
cal_distance is  tensor(186.2845, device='cuda:3')
cal ratio is  0.9507942911725342
distance x is tensor(177.1185, device='cuda:3')
cal_distance is  tensor(177.1185, device='cuda:3')
cal ratio is  0.9750860786220578
distance x is tensor(172.7059, device='cuda:3')
cal_distance is  tensor(172.7059, device='cuda:3')
distance x is tensor(172.7059, device='cuda:3')
return_distance is  tensor(172.7059, device='cuda:3')
distance x is tensor(172.6959, device='cuda:3')
distance x is tensor(172.6959, device='cuda:3')
________________________________
test distance is  tensor(172.6959, device='cuda:3')
test distance1 is  tensor(172.6959, device='cuda:3')
test similarity is  tensor(0.9867, device='cuda:3')
test acc is  0.10265000015633197
test loss is 175.2822107994226
test entropy is  0.0016972252159096611
________________________________
0
distance x is tensor(172.6959, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0015331522484146858
avg test loss is  175.46365977045315
avg accuracy is  0.49023333348967535
solo acc is  0.1022833334896653
compute similarity  is  tensor(0.9867, device='cuda:3')
compute_distance is  tensor(172.6959, device='cuda:3')
compute_norm is  tensor(71.8383, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5388.2295, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5435036269586477
avg test loss is  2.886290232255769
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1478, device='cuda:3')
compute_distance is  tensor(5388.2295, device='cuda:3')
compute_norm is  tensor(504.3681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5362.8003, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8255089574149931
avg test loss is  3.648133933671248
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1478, device='cuda:3')
compute_distance is  tensor(5362.8003, device='cuda:3')
compute_norm is  tensor(502.1832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5337.3535, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5543415981060915
avg test loss is  2.8682481436841267
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1477, device='cuda:3')
compute_distance is  tensor(5337.3535, device='cuda:3')
compute_norm is  tensor(499.6152, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5312.2134, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8384547703810084
avg test loss is  3.6216011878524
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1478, device='cuda:3')
compute_distance is  tensor(5312.2134, device='cuda:3')
compute_norm is  tensor(497.4987, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(5287.0063, device='cuda:3')
distance x is tensor(5287.0063, device='cuda:3')
________________________________
test distance is  tensor(5287.0063, device='cuda:3')
test distance1 is  tensor(5287.0063, device='cuda:3')
test similarity is  tensor(0.1477, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.863721604032049
test entropy is  1.5574480325682585
________________________________
cal ratio is  0.17847195523970194
distance x is tensor(943.5828, device='cuda:3')
cal_distance is  tensor(943.5828, device='cuda:3')
cal ratio is  0.4224593156209386
distance x is tensor(398.6256, device='cuda:3')
cal_distance is  tensor(398.6256, device='cuda:3')
cal ratio is  0.649968475375119
distance x is tensor(259.0942, device='cuda:3')
cal_distance is  tensor(259.0942, device='cuda:3')
cal ratio is  0.806206030511647
distance x is tensor(208.8834, device='cuda:3')
cal_distance is  tensor(208.8834, device='cuda:3')
cal ratio is  0.8978894652887972
distance x is tensor(187.5543, device='cuda:3')
cal_distance is  tensor(187.5543, device='cuda:3')
cal ratio is  0.9475701681037793
distance x is tensor(177.7209, device='cuda:3')
cal_distance is  tensor(177.7209, device='cuda:3')
cal ratio is  0.9734321054030537
distance x is tensor(172.9992, device='cuda:3')
cal_distance is  tensor(172.9992, device='cuda:3')
distance x is tensor(172.9992, device='cuda:3')
return_distance is  tensor(172.9992, device='cuda:3')
distance x is tensor(172.9984, device='cuda:3')
distance x is tensor(172.9984, device='cuda:3')
________________________________
test distance is  tensor(172.9984, device='cuda:3')
test distance1 is  tensor(172.9984, device='cuda:3')
test similarity is  tensor(0.9578, device='cuda:3')
test acc is  0.1003833334896653
test loss is 3941.225313686867
test entropy is  0.02890470219330245
________________________________
0
distance x is tensor(172.9984, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.029119640181061144
avg test loss is  3933.0850774118385
avg accuracy is  0.10240000015633197
solo acc is  0.10051666682299865
compute similarity  is  tensor(0.9578, device='cuda:3')
compute_distance is  tensor(172.9984, device='cuda:3')
compute_norm is  tensor(70.7785, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(474.7543, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.547238295901813
avg test loss is  2.8810074878399816
avg accuracy is  0.1637000001563343
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8231, device='cuda:3')
compute_distance is  tensor(474.7543, device='cuda:3')
compute_norm is  tensor(82.4719, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(473.8902, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8326190028871808
avg test loss is  3.638869179845619
avg accuracy is  0.16835000015633464
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8232, device='cuda:3')
compute_distance is  tensor(473.8902, device='cuda:3')
compute_norm is  tensor(82.2912, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(472.6406, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5542412871745095
avg test loss is  2.8696538339545734
avg accuracy is  0.16615000015633444
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8231, device='cuda:3')
compute_distance is  tensor(472.6406, device='cuda:3')
compute_norm is  tensor(81.6577, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(471.9768, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.835445856488844
avg test loss is  3.6264921907168715
avg accuracy is  0.16576666682300106
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8232, device='cuda:3')
compute_distance is  tensor(471.9768, device='cuda:3')
compute_norm is  tensor(81.5005, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(470.8952, device='cuda:3')
distance x is tensor(470.8952, device='cuda:3')
________________________________
test distance is  tensor(470.8952, device='cuda:3')
test distance1 is  tensor(470.8952, device='cuda:3')
test similarity is  tensor(0.8230, device='cuda:3')
test acc is  0.10016666682299866
test loss is 2.8606688099375157
test entropy is  1.5506270207575898
________________________________
cal ratio is  0.5980159163481927
distance x is tensor(281.5978, device='cuda:3')
cal_distance is  tensor(281.5978, device='cuda:3')
cal ratio is  0.7733218531760152
distance x is tensor(217.7650, device='cuda:3')
cal_distance is  tensor(217.7650, device='cuda:3')
cal ratio is  0.8793886641963805
distance x is tensor(191.4997, device='cuda:3')
cal_distance is  tensor(191.4997, device='cuda:3')
cal ratio is  0.9377582304015448
distance x is tensor(179.5802, device='cuda:3')
cal_distance is  tensor(179.5802, device='cuda:3')
cal ratio is  0.9683797030760025
distance x is tensor(173.9017, device='cuda:3')
cal_distance is  tensor(173.9017, device='cuda:3')
distance x is tensor(173.9017, device='cuda:3')
return_distance is  tensor(173.9017, device='cuda:3')
distance x is tensor(173.9081, device='cuda:3')
distance x is tensor(173.9081, device='cuda:3')
________________________________
test distance is  tensor(173.9081, device='cuda:3')
test distance1 is  tensor(173.9081, device='cuda:3')
test similarity is  tensor(0.9710, device='cuda:3')
test acc is  0.17318333348966822
test loss is 2.2125140120988207
test entropy is  1.5838156542035817
________________________________
0
distance x is tensor(173.9081, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5840341070059265
avg test loss is  2.1994358379957775
avg accuracy is  0.5386833334896757
solo acc is  0.17476666682300165
compute similarity  is  tensor(0.9710, device='cuda:3')
compute_distance is  tensor(173.9081, device='cuda:3')
compute_norm is  tensor(66.1772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(176.0673, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6919203867663198
avg test loss is  2.5812231797907654
avg accuracy is  0.5700500001563401
solo acc is  0.10913333348966528
compute similarity  is  tensor(0.9710, device='cuda:3')
compute_distance is  tensor(176.0673, device='cuda:3')
compute_norm is  tensor(66.0408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.7051, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0002149112188994
avg test loss is  1.4811577166575614
avg accuracy is  0.6595666668229998
solo acc is  0.26725000015633876
compute similarity  is  tensor(0.9711, device='cuda:3')
compute_distance is  tensor(177.7051, device='cuda:3')
compute_norm is  tensor(65.7138, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(179.4733, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6256983386301028
avg test loss is  2.3463451842001
avg accuracy is  0.6363500001563347
solo acc is  0.10698333348966528
compute similarity  is  tensor(0.9709, device='cuda:3')
compute_distance is  tensor(179.4733, device='cuda:3')
compute_norm is  tensor(65.4766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.7956, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9793465746237017
avg test loss is  1.4888047072678996
avg accuracy is  0.6631166668229996
solo acc is  0.24473333348967144
compute similarity  is  tensor(0.9710, device='cuda:3')
compute_distance is  tensor(180.7956, device='cuda:3')
compute_norm is  tensor(65.1533, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(180.7894, device='cuda:3')
________________________________
test distance is  tensor(180.7894, device='cuda:3')
test similarity is  tensor(0.9710, device='cuda:3')
test acc is  0.6615333334896664
test loss is 1.484373257612623
test entropy is  0.9814282693207137
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.5000000005
mal loss is 1.2706772089004517
mal norm is  tensor(782.8486, device='cuda:3')
distance x is tensor(180.7894, device='cuda:3')
mal distance is  tensor(180.7894, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([578.8233, 586.7449, 598.0309, 553.4515, 572.3036, 606.1191, 526.7382,
        583.1439, 782.8486, 782.8486, 782.8486, 782.8486, 782.8486, 782.8486,
        782.8486, 782.8486, 782.8486, 782.8486, 782.8486, 782.8486, 653.3694,
        653.8469, 604.1342, 692.8869, 638.6804, 641.5129, 664.6187, 657.5579],
       device='cuda:3')
sorted_norm is   tensor([526.7382, 553.4515, 572.3036, 578.8233, 583.1439, 586.7449, 598.0309,
        604.1342, 606.1191, 638.6804, 641.5129, 653.3694, 653.8469, 657.5579,
        664.6187, 692.8869, 782.8486, 782.8486, 782.8486, 782.8486, 782.8486,
        782.8486, 782.8486, 782.8486, 782.8486, 782.8486, 782.8486, 782.8486],
       device='cuda:3')
used idx is  tensor([ 6,  3,  4,  0,  7,  1,  2, 22,  5, 24, 25, 20, 21, 27, 26, 23, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 83.91% 

Test Accuracy: 82.93% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3145291209220886
distance x is tensor(142.4130, device='cuda:3')
benign distance is  tensor(142.4130, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46469825506210327
distance x is tensor(139.0105, device='cuda:3')
benign distance is  tensor(139.0105, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17650751769542694
distance x is tensor(152.7566, device='cuda:3')
benign distance is  tensor(152.7566, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42258286476135254
distance x is tensor(150.5353, device='cuda:3')
benign distance is  tensor(150.5353, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9841703176498413
distance x is tensor(138.0630, device='cuda:3')
benign distance is  tensor(138.0630, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.503640353679657
distance x is tensor(159.1497, device='cuda:3')
benign distance is  tensor(159.1497, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2979089915752411
distance x is tensor(157.8447, device='cuda:3')
benign distance is  tensor(157.8447, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5523749589920044
distance x is tensor(156.8023, device='cuda:3')
benign distance is  tensor(156.8023, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.08847907930612564
distance x is tensor(214.6632, device='cuda:3')
benign distance is  tensor(214.6632, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6697341799736023
distance x is tensor(138.3934, device='cuda:3')
benign distance is  tensor(138.3934, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8369463086128235
distance x is tensor(137.8171, device='cuda:3')
benign distance is  tensor(137.8171, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.40022173523902893
distance x is tensor(150.7831, device='cuda:3')
benign distance is  tensor(150.7831, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.16729521751403809
distance x is tensor(154.1284, device='cuda:3')
benign distance is  tensor(154.1284, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.34728866815567017
distance x is tensor(140.1597, device='cuda:3')
benign distance is  tensor(140.1597, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4022064805030823
distance x is tensor(139.7576, device='cuda:3')
benign distance is  tensor(139.7576, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4239041805267334
distance x is tensor(153.3153, device='cuda:3')
benign distance is  tensor(153.3153, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.3631, device='cuda:3')
compute distance is  tensor(144.3631, device='cuda:3')
compute norm is  tensor(65.2663, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.2693, device='cuda:3')
compute distance is  tensor(138.2693, device='cuda:3')
compute norm is  tensor(65.0780, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.9111, device='cuda:3')
compute distance is  tensor(150.9111, device='cuda:3')
compute norm is  tensor(65.3391, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.5855, device='cuda:3')
compute distance is  tensor(145.5855, device='cuda:3')
compute norm is  tensor(65.3033, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.4280, device='cuda:3')
compute distance is  tensor(160.4280, device='cuda:3')
compute norm is  tensor(65.7234, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.2603, device='cuda:3')
compute distance is  tensor(169.2603, device='cuda:3')
compute norm is  tensor(66.0557, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9752, device='cuda:3')
compute distance is  tensor(142.9752, device='cuda:3')
compute norm is  tensor(65.2936, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7762, device='cuda:3')
compute distance is  tensor(144.7762, device='cuda:3')
compute norm is  tensor(65.3105, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.1200, device='cuda:3')
compute distance is  tensor(169.1200, device='cuda:3')
compute norm is  tensor(65.9316, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1460, device='cuda:3')
compute distance is  tensor(143.1460, device='cuda:3')
compute norm is  tensor(65.3769, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.9097, device='cuda:3')
compute distance is  tensor(177.9097, device='cuda:3')
compute norm is  tensor(65.9794, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8751, device='cuda:3')
compute distance is  tensor(137.8751, device='cuda:3')
compute norm is  tensor(65.1773, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(177.9097, device='cuda:3')
distance x is tensor(107466.2500, device='cuda:3')
distance x is tensor(107466.2500, device='cuda:3')
________________________________
test distance is  tensor(107466.2500, device='cuda:3')
test distance1 is  tensor(107466.2500, device='cuda:3')
test similarity is  tensor(0.6462, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130021354526829.17
test entropy is  0.0
________________________________
cal ratio is  0.039874006793402736
distance x is tensor(4285.1157, device='cuda:3')
cal_distance is  tensor(4285.1157, device='cuda:3')
cal ratio is  0.1996846369641081
distance x is tensor(855.6757, device='cuda:3')
cal_distance is  tensor(855.6757, device='cuda:3')
cal ratio is  0.44685984425753694
distance x is tensor(382.3699, device='cuda:3')
cal_distance is  tensor(382.3699, device='cuda:3')
cal ratio is  0.668473290416632
distance x is tensor(255.6057, device='cuda:3')
cal_distance is  tensor(255.6057, device='cuda:3')
cal ratio is  0.8175995041721617
distance x is tensor(208.9840, device='cuda:3')
cal_distance is  tensor(208.9840, device='cuda:3')
cal ratio is  0.9042101320258472
distance x is tensor(188.9660, device='cuda:3')
cal_distance is  tensor(188.9660, device='cuda:3')
cal ratio is  0.9508984432667855
distance x is tensor(179.6877, device='cuda:3')
cal_distance is  tensor(179.6877, device='cuda:3')
cal ratio is  0.9751395004562551
distance x is tensor(175.2207, device='cuda:3')
cal_distance is  tensor(175.2207, device='cuda:3')
distance x is tensor(175.2207, device='cuda:3')
return_distance is  tensor(175.2207, device='cuda:3')
distance x is tensor(175.2107, device='cuda:3')
distance x is tensor(175.2107, device='cuda:3')
________________________________
test distance is  tensor(175.2107, device='cuda:3')
test distance1 is  tensor(175.2107, device='cuda:3')
test similarity is  tensor(0.9837, device='cuda:3')
test acc is  0.26193333348967196
test loss is 126.7777608615249
test entropy is  0.11974511569989388
________________________________
0
distance x is tensor(175.2107, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.11884192977029123
avg test loss is  127.0055424948491
avg accuracy is  0.681583333489665
solo acc is  0.2604000001563387
compute similarity  is  tensor(0.9837, device='cuda:3')
compute_distance is  tensor(175.2107, device='cuda:3')
compute_norm is  tensor(70.9653, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6702.2520, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5468526220779175
avg test loss is  2.8862184507252056
avg accuracy is  0.03706666682299913
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1336, device='cuda:3')
compute_distance is  tensor(6702.2520, device='cuda:3')
compute_norm is  tensor(440.8816, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6671.0996, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8366519281986171
avg test loss is  3.6418453564267677
avg accuracy is  0.03846666682299911
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1336, device='cuda:3')
compute_distance is  tensor(6671.0996, device='cuda:3')
compute_norm is  tensor(439.0038, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6639.5527, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5527234745940675
avg test loss is  2.8768767870819647
avg accuracy is  0.036683333489665806
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1335, device='cuda:3')
compute_distance is  tensor(6639.5527, device='cuda:3')
compute_norm is  tensor(436.7129, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6608.7314, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8412210237878218
avg test loss is  3.6234453779293783
avg accuracy is  0.03783333348966581
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1336, device='cuda:3')
compute_distance is  tensor(6608.7314, device='cuda:3')
compute_norm is  tensor(434.8803, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6577.5474, device='cuda:3')
distance x is tensor(6577.5474, device='cuda:3')
________________________________
test distance is  tensor(6577.5474, device='cuda:3')
test distance1 is  tensor(6577.5474, device='cuda:3')
test similarity is  tensor(0.1335, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8712753761551784
test entropy is  1.551911335764155
________________________________
cal ratio is  0.16117360957539484
distance x is tensor(1060.1263, device='cuda:3')
cal_distance is  tensor(1060.1263, device='cuda:3')
cal ratio is  0.4014644678810492
distance x is tensor(425.6026, device='cuda:3')
cal_distance is  tensor(425.6026, device='cuda:3')
cal ratio is  0.6336125566958104
distance x is tensor(269.6670, device='cuda:3')
cal_distance is  tensor(269.6670, device='cuda:3')
cal ratio is  0.7959981571414595
distance x is tensor(214.6543, device='cuda:3')
cal_distance is  tensor(214.6543, device='cuda:3')
cal ratio is  0.8921874744528852
distance x is tensor(191.5118, device='cuda:3')
cal_distance is  tensor(191.5118, device='cuda:3')
cal ratio is  0.9445569058350237
distance x is tensor(180.8938, device='cuda:3')
cal_distance is  tensor(180.8938, device='cuda:3')
cal ratio is  0.9718833169611931
distance x is tensor(175.8076, device='cuda:3')
cal_distance is  tensor(175.8076, device='cuda:3')
distance x is tensor(175.8076, device='cuda:3')
return_distance is  tensor(175.8076, device='cuda:3')
distance x is tensor(175.8089, device='cuda:3')
distance x is tensor(175.8089, device='cuda:3')
________________________________
test distance is  tensor(175.8089, device='cuda:3')
test distance1 is  tensor(175.8089, device='cuda:3')
test similarity is  tensor(0.9783, device='cuda:3')
test acc is  0.10141666682299863
test loss is 2.6683483268660524
test entropy is  1.8504779014760242
________________________________
0
distance x is tensor(175.8089, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8501383279686543
avg test loss is  2.670328599303516
avg accuracy is  0.5098000001563422
solo acc is  0.10108333348966532
compute similarity  is  tensor(0.9783, device='cuda:3')
compute_distance is  tensor(175.8089, device='cuda:3')
compute_norm is  tensor(65.9799, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.0770, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8076140886303712
avg test loss is  3.448668144405015
avg accuracy is  0.540716666823009
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9782, device='cuda:3')
compute_distance is  tensor(177.0770, device='cuda:3')
compute_norm is  tensor(65.8694, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.2695, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0618701535882726
avg test loss is  1.7198923297528266
avg accuracy is  0.6630000001563331
solo acc is  0.21190000015633687
compute similarity  is  tensor(0.9785, device='cuda:3')
compute_distance is  tensor(177.2695, device='cuda:3')
compute_norm is  tensor(65.4678, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.2759, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6449369768471097
avg test loss is  2.5284983852524747
avg accuracy is  0.6461333334896674
solo acc is  0.10600000015633196
compute similarity  is  tensor(0.9784, device='cuda:3')
compute_distance is  tensor(178.2759, device='cuda:3')
compute_norm is  tensor(65.2327, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(178.4582, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0202510941511533
avg test loss is  1.5830520602431633
avg accuracy is  0.6857666668229981
solo acc is  0.22610000015633747
compute similarity  is  tensor(0.9786, device='cuda:3')
compute_distance is  tensor(178.4582, device='cuda:3')
compute_norm is  tensor(64.8637, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(179.5470, device='cuda:3')
distance x is tensor(179.5470, device='cuda:3')
________________________________
test distance is  tensor(179.5470, device='cuda:3')
test distance1 is  tensor(179.5470, device='cuda:3')
test similarity is  tensor(0.9785, device='cuda:3')
test acc is  0.10638333348966529
test loss is 2.3882558807127
test entropy is  0.625994296851697
________________________________
cal ratio is  0.9755214693536159
distance x is tensor(175.1466, device='cuda:3')
cal_distance is  tensor(175.1466, device='cuda:3')
distance x is tensor(175.1466, device='cuda:3')
return_distance is  tensor(175.1466, device='cuda:3')
distance x is tensor(175.1520, device='cuda:3')
distance x is tensor(175.1520, device='cuda:3')
________________________________
test distance is  tensor(175.1520, device='cuda:3')
test distance1 is  tensor(175.1520, device='cuda:3')
test similarity is  tensor(0.9795, device='cuda:3')
test acc is  0.10715000015633196
test loss is 2.3237086440454413
test entropy is  0.6570695427053773
________________________________
0
distance x is tensor(175.1520, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.657429176988378
avg test loss is  2.3173557522454495
avg accuracy is  0.6743666668229988
solo acc is  0.10755000015633195
compute similarity  is  tensor(0.9795, device='cuda:3')
compute_distance is  tensor(175.1520, device='cuda:3')
compute_norm is  tensor(64.5467, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(175.4491, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.966826369259149
avg test loss is  1.5265352249399686
avg accuracy is  0.7218833334896626
solo acc is  0.21790000015633712
compute similarity  is  tensor(0.9796, device='cuda:3')
compute_distance is  tensor(175.4491, device='cuda:3')
compute_norm is  tensor(64.2047, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(175.4435, device='cuda:3')
________________________________
test distance is  tensor(175.4435, device='cuda:3')
test similarity is  tensor(0.9796, device='cuda:3')
test acc is  0.7206500001563294
test loss is 1.5271567206647096
test entropy is  0.966695579257347
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2261704206466675
mal norm is  tensor(640.0256, device='cuda:3')
distance x is tensor(175.4435, device='cuda:3')
mal distance is  tensor(175.4435, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([572.7162, 572.0972, 623.4857, 606.7834, 565.1662, 639.0017, 609.8112,
        609.3220, 640.0256, 640.0256, 640.0256, 640.0256, 640.0256, 640.0256,
        640.0256, 640.0256, 640.0256, 640.0256, 640.0256, 640.0256, 565.7084,
        636.3602, 604.5284, 605.6069, 582.9908, 580.6185, 636.0566, 571.3181],
       device='cuda:3')
sorted_norm is   tensor([565.1662, 565.7084, 571.3181, 572.0972, 572.7162, 580.6185, 582.9908,
        604.5284, 605.6069, 606.7834, 609.3220, 609.8112, 623.4857, 636.0566,
        636.3602, 639.0017, 640.0256, 640.0256, 640.0256, 640.0256, 640.0256,
        640.0256, 640.0256, 640.0256, 640.0256, 640.0256, 640.0256, 640.0256],
       device='cuda:3')
used idx is  tensor([ 4, 20, 27,  1,  0, 25, 24, 22, 23,  3,  7,  6,  2, 26, 21,  5, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 80.79% 

Test Accuracy: 80.06% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2928762435913086
distance x is tensor(126.4568, device='cuda:3')
benign distance is  tensor(126.4568, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6615217328071594
distance x is tensor(126.3601, device='cuda:3')
benign distance is  tensor(126.3601, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33884429931640625
distance x is tensor(131.2549, device='cuda:3')
benign distance is  tensor(131.2549, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8570705652236938
distance x is tensor(113.3288, device='cuda:3')
benign distance is  tensor(113.3288, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4751337170600891
distance x is tensor(141.2988, device='cuda:3')
benign distance is  tensor(141.2988, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6563614010810852
distance x is tensor(138.5808, device='cuda:3')
benign distance is  tensor(138.5808, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37909191846847534
distance x is tensor(134.3920, device='cuda:3')
benign distance is  tensor(134.3920, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23231306672096252
distance x is tensor(126.2871, device='cuda:3')
benign distance is  tensor(126.2871, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.49900326132774353
distance x is tensor(125.0682, device='cuda:3')
benign distance is  tensor(125.0682, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6879450082778931
distance x is tensor(132.1372, device='cuda:3')
benign distance is  tensor(132.1372, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.27202802896499634
distance x is tensor(140.2986, device='cuda:3')
benign distance is  tensor(140.2986, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.408529132604599
distance x is tensor(126.5056, device='cuda:3')
benign distance is  tensor(126.5056, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.328029990196228
distance x is tensor(136.2086, device='cuda:3')
benign distance is  tensor(136.2086, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5355671644210815
distance x is tensor(117.8715, device='cuda:3')
benign distance is  tensor(117.8715, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.46198445558547974
distance x is tensor(149.2108, device='cuda:3')
benign distance is  tensor(149.2108, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6392537951469421
distance x is tensor(133.2012, device='cuda:3')
benign distance is  tensor(133.2012, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.7811, device='cuda:3')
compute distance is  tensor(121.7811, device='cuda:3')
compute norm is  tensor(64.4683, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2782, device='cuda:3')
compute distance is  tensor(132.2782, device='cuda:3')
compute norm is  tensor(64.5623, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5660, device='cuda:3')
compute distance is  tensor(133.5660, device='cuda:3')
compute norm is  tensor(64.6245, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4371, device='cuda:3')
compute distance is  tensor(136.4371, device='cuda:3')
compute norm is  tensor(64.8013, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4534, device='cuda:3')
compute distance is  tensor(132.4534, device='cuda:3')
compute norm is  tensor(64.8157, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3114, device='cuda:3')
compute distance is  tensor(138.3114, device='cuda:3')
compute norm is  tensor(64.8437, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.8286, device='cuda:3')
compute distance is  tensor(117.8286, device='cuda:3')
compute norm is  tensor(64.3254, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2795, device='cuda:3')
compute distance is  tensor(123.2795, device='cuda:3')
compute norm is  tensor(64.4806, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7195, device='cuda:3')
compute distance is  tensor(142.7195, device='cuda:3')
compute norm is  tensor(64.7288, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.8121, device='cuda:3')
compute distance is  tensor(130.8121, device='cuda:3')
compute norm is  tensor(64.6309, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.5856, device='cuda:3')
compute distance is  tensor(151.5856, device='cuda:3')
compute norm is  tensor(64.8494, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8671, device='cuda:3')
compute distance is  tensor(127.8671, device='cuda:3')
compute norm is  tensor(64.6743, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.5856, device='cuda:3')
distance x is tensor(107499.6562, device='cuda:3')
distance x is tensor(107499.6562, device='cuda:3')
________________________________
test distance is  tensor(107499.6562, device='cuda:3')
test distance1 is  tensor(107499.6562, device='cuda:3')
test similarity is  tensor(0.6182, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130103764390682.75
test entropy is  0.0
________________________________
cal ratio is  0.036800310610790574
distance x is tensor(3956.0261, device='cuda:3')
cal_distance is  tensor(3956.0261, device='cuda:3')
cal ratio is  0.19183394084785407
distance x is tensor(758.9041, device='cuda:3')
cal_distance is  tensor(758.9041, device='cuda:3')
cal ratio is  0.4379873538684702
distance x is tensor(332.3932, device='cuda:3')
cal_distance is  tensor(332.3932, device='cuda:3')
cal ratio is  0.6618033710944927
distance x is tensor(219.9807, device='cuda:3')
cal_distance is  tensor(219.9807, device='cuda:3')
cal ratio is  0.8135097764359145
distance x is tensor(178.9573, device='cuda:3')
cal_distance is  tensor(178.9573, device='cuda:3')
cal ratio is  0.9019454687428811
distance x is tensor(161.4103, device='cuda:3')
cal_distance is  tensor(161.4103, device='cuda:3')
cal ratio is  0.9497065143746586
distance x is tensor(153.2926, device='cuda:3')
cal_distance is  tensor(153.2926, device='cuda:3')
cal ratio is  0.9745280858083748
distance x is tensor(149.3881, device='cuda:3')
cal_distance is  tensor(149.3881, device='cuda:3')
distance x is tensor(149.3881, device='cuda:3')
return_distance is  tensor(149.3881, device='cuda:3')
distance x is tensor(149.3781, device='cuda:3')
distance x is tensor(149.3781, device='cuda:3')
________________________________
test distance is  tensor(149.3781, device='cuda:3')
test distance1 is  tensor(149.3781, device='cuda:3')
test similarity is  tensor(0.9863, device='cuda:3')
test acc is  0.6447833334896675
test loss is 5.328616132105846
test entropy is  0.28577421422896865
________________________________
0
distance x is tensor(149.3781, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.284554048403621
avg test loss is  5.343322034202405
avg accuracy is  0.8085666668229916
solo acc is  0.6443833334896676
compute similarity  is  tensor(0.9863, device='cuda:3')
compute_distance is  tensor(149.3781, device='cuda:3')
compute_norm is  tensor(69.0562, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.0825, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.964018938828633
avg test loss is  1.4041777535288065
avg accuracy is  0.7563166668229941
solo acc is  0.2905333334896727
compute similarity  is  tensor(0.9857, device='cuda:3')
compute_distance is  tensor(156.0825, device='cuda:3')
compute_norm is  tensor(69.1267, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(156.0825, device='cuda:3')
distance x is tensor(156.0825, device='cuda:3')
________________________________
test distance is  tensor(156.0825, device='cuda:3')
test distance1 is  tensor(156.0825, device='cuda:3')
test similarity is  tensor(0.9857, device='cuda:3')
test acc is  0.28945000015633937
test loss is 1.4062265865584171
test entropy is  0.9636616218827172
________________________________
cal ratio is  0.965779504482813
distance x is tensor(150.7502, device='cuda:3')
cal_distance is  tensor(150.7502, device='cuda:3')
distance x is tensor(150.7502, device='cuda:3')
return_distance is  tensor(150.7502, device='cuda:3')
distance x is tensor(150.7411, device='cuda:3')
distance x is tensor(150.7411, device='cuda:3')
________________________________
test distance is  tensor(150.7411, device='cuda:3')
test distance1 is  tensor(150.7411, device='cuda:3')
test similarity is  tensor(0.9865, device='cuda:3')
test acc is  0.31103333348967305
test loss is 1.361270096319825
test entropy is  0.9921581636486786
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1921659708023071
mal norm is  tensor(733.4872, device='cuda:3')
distance x is tensor(150.7502, device='cuda:3')
mal distance is  tensor(150.7502, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([535.3294, 531.4778, 549.0448, 480.6693, 588.3249, 569.9478, 544.6464,
        534.0872, 733.4872, 733.4872, 733.4872, 733.4872, 733.4872, 733.4872,
        733.4872, 733.4872, 733.4872, 733.4872, 733.4872, 733.4872, 641.4368,
        574.7638, 636.3599, 607.2762, 591.1188, 634.4462, 626.7851, 608.4752,
        912.4523, 580.9765, 585.9696, 600.2817, 601.1080, 591.6553, 588.5882,
        635.3798], device='cuda:3')
sorted_norm is   tensor([480.6693, 531.4778, 534.0872, 535.3294, 544.6464, 549.0448, 569.9478,
        574.7638, 580.9765, 585.9696, 588.3249, 588.5882, 591.1188, 591.6553,
        600.2817, 601.1080, 607.2762, 608.4752, 626.7851, 634.4462, 635.3798,
        636.3599, 641.4368, 733.4872, 733.4872, 733.4872, 733.4872, 733.4872,
        733.4872, 733.4872, 733.4872, 733.4872, 733.4872, 733.4872, 733.4872,
        912.4523], device='cuda:3')
used idx is  tensor([ 3,  1,  7,  0,  6,  2,  5, 21, 29, 30,  4, 34, 24, 33, 31, 32, 23, 27,
        26, 25, 35, 22, 20, 11, 17, 10,  8,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 88.17% 

Test Accuracy: 86.88% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36430126428604126
distance x is tensor(113.8953, device='cuda:3')
benign distance is  tensor(113.8953, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6697140336036682
distance x is tensor(124.4362, device='cuda:3')
benign distance is  tensor(124.4362, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7217057943344116
distance x is tensor(133.2561, device='cuda:3')
benign distance is  tensor(133.2561, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8094736933708191
distance x is tensor(124.9876, device='cuda:3')
benign distance is  tensor(124.9876, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5748040080070496
distance x is tensor(115.8129, device='cuda:3')
benign distance is  tensor(115.8129, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7516478300094604
distance x is tensor(132.6559, device='cuda:3')
benign distance is  tensor(132.6559, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5992265939712524
distance x is tensor(122.7993, device='cuda:3')
benign distance is  tensor(122.7993, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6243842840194702
distance x is tensor(125.2384, device='cuda:3')
benign distance is  tensor(125.2384, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8428180813789368
distance x is tensor(127.1659, device='cuda:3')
benign distance is  tensor(127.1659, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6410552263259888
distance x is tensor(128.9113, device='cuda:3')
benign distance is  tensor(128.9113, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5549072027206421
distance x is tensor(118.5639, device='cuda:3')
benign distance is  tensor(118.5639, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0404675006866455
distance x is tensor(133.2341, device='cuda:3')
benign distance is  tensor(133.2341, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8535333871841431
distance x is tensor(120.5630, device='cuda:3')
benign distance is  tensor(120.5630, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7749508619308472
distance x is tensor(129.0531, device='cuda:3')
benign distance is  tensor(129.0531, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5491169095039368
distance x is tensor(116.6448, device='cuda:3')
benign distance is  tensor(116.6448, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.26054662466049194
distance x is tensor(135.3564, device='cuda:3')
benign distance is  tensor(135.3564, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.14559917151927948
distance x is tensor(127.7177, device='cuda:3')
benign distance is  tensor(127.7177, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.40072137117385864
distance x is tensor(114.1357, device='cuda:3')
benign distance is  tensor(114.1357, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.1748027354478836
distance x is tensor(137.4295, device='cuda:3')
benign distance is  tensor(137.4295, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.30016300082206726
distance x is tensor(135.1373, device='cuda:3')
benign distance is  tensor(135.1373, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9201096296310425
distance x is tensor(122.5250, device='cuda:3')
benign distance is  tensor(122.5250, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4350000321865082
distance x is tensor(129.2191, device='cuda:3')
benign distance is  tensor(129.2191, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.12187393009662628
distance x is tensor(123.8974, device='cuda:3')
benign distance is  tensor(123.8974, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1992136687040329
distance x is tensor(120.4740, device='cuda:3')
benign distance is  tensor(120.4740, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(114.4162, device='cuda:3')
compute distance is  tensor(114.4162, device='cuda:3')
compute norm is  tensor(65.5274, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2563, device='cuda:3')
compute distance is  tensor(122.2563, device='cuda:3')
compute norm is  tensor(65.5978, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8764, device='cuda:3')
compute distance is  tensor(131.8764, device='cuda:3')
compute norm is  tensor(65.9240, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1529, device='cuda:3')
compute distance is  tensor(122.1529, device='cuda:3')
compute norm is  tensor(65.5937, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8724, device='cuda:3')
compute distance is  tensor(137.8724, device='cuda:3')
compute norm is  tensor(65.9521, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.3484, device='cuda:3')
compute distance is  tensor(134.3484, device='cuda:3')
compute norm is  tensor(65.9099, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6624, device='cuda:3')
compute distance is  tensor(123.6624, device='cuda:3')
compute norm is  tensor(65.7041, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4359, device='cuda:3')
compute distance is  tensor(125.4359, device='cuda:3')
compute norm is  tensor(65.5935, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.9680, device='cuda:3')
compute distance is  tensor(140.9680, device='cuda:3')
compute norm is  tensor(66.0584, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.7861, device='cuda:3')
compute distance is  tensor(124.7861, device='cuda:3')
compute norm is  tensor(65.6621, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4197, device='cuda:3')
compute distance is  tensor(147.4197, device='cuda:3')
compute norm is  tensor(66.2257, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.6357, device='cuda:3')
compute distance is  tensor(136.6357, device='cuda:3')
compute norm is  tensor(65.8349, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.4197, device='cuda:3')
distance x is tensor(107477.0703, device='cuda:3')
distance x is tensor(107477.0703, device='cuda:3')
________________________________
test distance is  tensor(107477.0703, device='cuda:3')
test distance1 is  tensor(107477.0703, device='cuda:3')
test similarity is  tensor(0.6392, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130032076178421.08
test entropy is  0.0
________________________________
cal ratio is  0.036294931639934976
distance x is tensor(3900.8779, device='cuda:3')
cal_distance is  tensor(3900.8779, device='cuda:3')
cal ratio is  0.19051216944533875
distance x is tensor(743.1688, device='cuda:3')
cal_distance is  tensor(743.1688, device='cuda:3')
cal ratio is  0.43647579843572737
distance x is tensor(324.3780, device='cuda:3')
cal_distance is  tensor(324.3780, device='cuda:3')
cal ratio is  0.6606603149423255
distance x is tensor(214.3054, device='cuda:3')
cal_distance is  tensor(214.3054, device='cuda:3')
cal ratio is  0.8128068575430396
distance x is tensor(174.1898, device='cuda:3')
cal_distance is  tensor(174.1898, device='cuda:3')
cal ratio is  0.9015555348118982
distance x is tensor(157.0423, device='cuda:3')
cal_distance is  tensor(157.0423, device='cuda:3')
cal ratio is  0.9495013134511869
distance x is tensor(149.1122, device='cuda:3')
cal_distance is  tensor(149.1122, device='cuda:3')
cal ratio is  0.9744226702174021
distance x is tensor(145.2984, device='cuda:3')
cal_distance is  tensor(145.2984, device='cuda:3')
distance x is tensor(145.2984, device='cuda:3')
return_distance is  tensor(145.2984, device='cuda:3')
distance x is tensor(145.2884, device='cuda:3')
distance x is tensor(145.2884, device='cuda:3')
________________________________
test distance is  tensor(145.2884, device='cuda:3')
test distance1 is  tensor(145.2884, device='cuda:3')
test similarity is  tensor(0.9881, device='cuda:3')
test acc is  0.8106333334896583
test loss is 1.4641843261495073
test entropy is  0.13052892798124982
________________________________
2
distance x is tensor(145.2884, device='cuda:3')
test distance 2 is  tensor(145.2884, device='cuda:3')
distance x is tensor(145.2884, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.1302088957343465
avg test loss is  1.463049345147381
avg accuracy is  0.8660000001563226
solo acc is  0.8109666668229917
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(145.2884, device='cuda:3')
compute_norm is  tensor(70.3311, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.2474, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9237828360183407
avg test loss is  1.493817931680537
avg accuracy is  0.8169000001563247
solo acc is  0.251916666823005
compute similarity  is  tensor(0.9878, device='cuda:3')
compute_distance is  tensor(145.2474, device='cuda:3')
compute_norm is  tensor(69.8975, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.1804, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9057221925461979
avg test loss is  1.46595314431038
avg accuracy is  0.8208500001563245
solo acc is  0.2381500001563379
compute similarity  is  tensor(0.9877, device='cuda:3')
compute_distance is  tensor(145.1804, device='cuda:3')
compute_norm is  tensor(69.5722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.0248, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8867192282986793
avg test loss is  1.4520594902130077
avg accuracy is  0.8225000001563244
solo acc is  0.2364666668230045
compute similarity  is  tensor(0.9876, device='cuda:3')
compute_distance is  tensor(145.0248, device='cuda:3')
compute_norm is  tensor(69.2432, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.8565, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8694093848215237
avg test loss is  1.436220839842042
avg accuracy is  0.825566666822991
solo acc is  0.23415000015633775
compute similarity  is  tensor(0.9875, device='cuda:3')
compute_distance is  tensor(144.8565, device='cuda:3')
compute_norm is  tensor(68.9153, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.6282, device='cuda:3')
distance x is tensor(144.6282, device='cuda:3')
________________________________
test distance is  tensor(144.6282, device='cuda:3')
test distance1 is  tensor(144.6282, device='cuda:3')
test similarity is  tensor(0.9874, device='cuda:3')
test acc is  0.23215000015633772
test loss is 1.4162463402188916
test entropy is  0.8696693066340774
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.0356848239898682
mal norm is  tensor(686.3173, device='cuda:3')
distance x is tensor(144.6375, device='cuda:3')
mal distance is  tensor(144.6375, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([487.9480, 517.1406, 549.7291, 526.7915, 483.0539, 550.8411, 496.9306,
        518.3872, 686.3173, 686.3173, 686.3173, 686.3173, 686.3173, 686.3173,
        686.3173, 686.3173, 686.3173, 686.3173, 686.3173, 686.3173],
       device='cuda:3')
sorted_norm is   tensor([483.0539, 487.9480, 496.9306, 517.1406, 518.3872, 526.7915, 549.7291,
        550.8411, 686.3173, 686.3173, 686.3173, 686.3173, 686.3173, 686.3173,
        686.3173, 686.3173, 686.3173, 686.3173, 686.3173, 686.3173],
       device='cuda:3')
used idx is  tensor([ 4,  0,  6,  1,  7,  3,  2,  5, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 85.82% 

Test Accuracy: 84.97% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6635223627090454
distance x is tensor(147.5328, device='cuda:3')
benign distance is  tensor(147.5328, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.35007280111312866
distance x is tensor(127.1318, device='cuda:3')
benign distance is  tensor(127.1318, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.26771509647369385
distance x is tensor(137.8717, device='cuda:3')
benign distance is  tensor(137.8717, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6079241037368774
distance x is tensor(140.3095, device='cuda:3')
benign distance is  tensor(140.3095, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5990217328071594
distance x is tensor(155.9806, device='cuda:3')
benign distance is  tensor(155.9806, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.842359721660614
distance x is tensor(139.8246, device='cuda:3')
benign distance is  tensor(139.8246, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.08846496790647507
distance x is tensor(148.0761, device='cuda:3')
benign distance is  tensor(148.0761, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8464506268501282
distance x is tensor(138.1192, device='cuda:3')
benign distance is  tensor(138.1192, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.9235, device='cuda:3')
compute distance is  tensor(129.9235, device='cuda:3')
compute norm is  tensor(68.2334, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1613, device='cuda:3')
compute distance is  tensor(146.1613, device='cuda:3')
compute norm is  tensor(68.3914, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0988, device='cuda:3')
compute distance is  tensor(149.0988, device='cuda:3')
compute norm is  tensor(68.5359, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1246, device='cuda:3')
compute distance is  tensor(141.1246, device='cuda:3')
compute norm is  tensor(68.5814, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.7509, device='cuda:3')
compute distance is  tensor(151.7509, device='cuda:3')
compute norm is  tensor(68.7490, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.1297, device='cuda:3')
compute distance is  tensor(147.1297, device='cuda:3')
compute norm is  tensor(68.6519, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6777, device='cuda:3')
compute distance is  tensor(127.6777, device='cuda:3')
compute norm is  tensor(68.1616, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6814, device='cuda:3')
compute distance is  tensor(138.6814, device='cuda:3')
compute norm is  tensor(68.4263, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.1138, device='cuda:3')
compute distance is  tensor(144.1138, device='cuda:3')
compute norm is  tensor(68.4536, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.5967, device='cuda:3')
compute distance is  tensor(145.5967, device='cuda:3')
compute norm is  tensor(68.6202, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.8041, device='cuda:3')
compute distance is  tensor(154.8041, device='cuda:3')
compute norm is  tensor(68.7276, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3362, device='cuda:3')
compute distance is  tensor(133.3362, device='cuda:3')
compute norm is  tensor(68.3006, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.8041, device='cuda:3')
distance x is tensor(107418.7969, device='cuda:3')
distance x is tensor(107418.7969, device='cuda:3')
________________________________
test distance is  tensor(107418.7969, device='cuda:3')
test distance1 is  tensor(107418.7969, device='cuda:3')
test similarity is  tensor(0.6914, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130118265244324.84
test entropy is  0.0
________________________________
cal ratio is  0.03720293096542226
distance x is tensor(3996.2998, device='cuda:3')
cal_distance is  tensor(3996.2998, device='cuda:3')
cal ratio is  0.1928804757301417
distance x is tensor(770.8123, device='cuda:3')
cal_distance is  tensor(770.8123, device='cuda:3')
cal ratio is  0.4391804440736213
distance x is tensor(338.5285, device='cuda:3')
cal_distance is  tensor(338.5285, device='cuda:3')
cal ratio is  0.662704147950041
distance x is tensor(224.3459, device='cuda:3')
cal_distance is  tensor(224.3459, device='cuda:3')
cal ratio is  0.8140633769259424
distance x is tensor(182.6327, device='cuda:3')
cal_distance is  tensor(182.6327, device='cuda:3')
cal ratio is  0.9022522506099164
distance x is tensor(164.7813, device='cuda:3')
cal_distance is  tensor(164.7813, device='cuda:3')
cal ratio is  0.9498681301270616
distance x is tensor(156.5208, device='cuda:3')
cal_distance is  tensor(156.5208, device='cuda:3')
cal ratio is  0.9746109945463435
distance x is tensor(152.5470, device='cuda:3')
cal_distance is  tensor(152.5470, device='cuda:3')
distance x is tensor(152.5470, device='cuda:3')
return_distance is  tensor(152.5470, device='cuda:3')
distance x is tensor(152.5370, device='cuda:3')
distance x is tensor(152.5370, device='cuda:3')
________________________________
test distance is  tensor(152.5370, device='cuda:3')
test distance1 is  tensor(152.5370, device='cuda:3')
test similarity is  tensor(0.9899, device='cuda:3')
test acc is  0.22373333348967067
test loss is 30.355338444333594
test entropy is  0.06953819381988553
________________________________
0
distance x is tensor(152.5370, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07069634323292323
avg test loss is  30.04693201305007
avg accuracy is  0.77578333348966
solo acc is  0.22393333348967073
compute similarity  is  tensor(0.9899, device='cuda:3')
compute_distance is  tensor(152.5370, device='cuda:3')
compute_norm is  tensor(73.5663, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.0687, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9152982393180383
avg test loss is  1.3686789075957178
avg accuracy is  0.7662833334896603
solo acc is  0.2767833334896723
compute similarity  is  tensor(0.9903, device='cuda:3')
compute_distance is  tensor(147.0687, device='cuda:3')
compute_norm is  tensor(73.2619, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(147.0687, device='cuda:3')
distance x is tensor(147.0687, device='cuda:3')
________________________________
test distance is  tensor(147.0687, device='cuda:3')
test distance1 is  tensor(147.0687, device='cuda:3')
test similarity is  tensor(0.9903, device='cuda:3')
test acc is  0.27678333348967227
test loss is 1.3658460633459883
test entropy is  0.9165959177749243
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.1594420671463013
mal norm is  tensor(754.5079, device='cuda:3')
distance x is tensor(147.0781, device='cuda:3')
mal distance is  tensor(147.0781, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([583.3264, 526.9741, 550.9409, 548.9825, 588.7883, 566.1942, 579.3018,
        552.2826, 754.5079, 754.5079, 754.5079, 754.5079, 754.5079, 754.5079,
        754.5079, 754.5079, 754.5079, 754.5079, 754.5079, 754.5079, 734.7819,
        744.9118, 719.7997, 740.8734, 731.0478, 731.0918, 773.0556, 726.5106,
        616.8302, 649.8936, 607.9843, 599.0720, 586.1422, 593.9234, 604.9634,
        626.1089, 723.0576, 756.1157, 767.8732, 721.2717, 747.2598, 700.4081,
        784.1179, 740.9573, 649.2058, 639.8270, 607.5419, 661.0175, 626.1613,
        638.0079, 611.4895, 677.2343], device='cuda:3')
sorted_norm is   tensor([526.9741, 548.9825, 550.9409, 552.2826, 566.1942, 579.3018, 583.3264,
        586.1422, 588.7883, 593.9234, 599.0720, 604.9634, 607.5419, 607.9843,
        611.4895, 616.8302, 626.1089, 626.1613, 638.0079, 639.8270, 649.2058,
        649.8936, 661.0175, 677.2343, 700.4081, 719.7997, 721.2717, 723.0576,
        726.5106, 731.0478, 731.0918, 734.7819, 740.8734, 740.9573, 744.9118,
        747.2598, 754.5079, 754.5079, 754.5079, 754.5079, 754.5079, 754.5079,
        754.5079, 754.5079, 754.5079, 754.5079, 754.5079, 754.5079, 756.1157,
        767.8732, 773.0556, 784.1179], device='cuda:3')
used idx is  tensor([ 1,  3,  2,  7,  5,  6,  0, 32,  4, 33, 31, 34, 46, 30, 50, 28, 35, 48,
        49, 45, 44, 29, 47, 51, 41, 22, 39, 36, 27, 24, 25, 20, 23, 43, 21, 40,
        11, 10,  8,  9, 19], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 88.76% 

Test Accuracy: 87.66% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8820921182632446
distance x is tensor(112.9423, device='cuda:3')
benign distance is  tensor(112.9423, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5395622253417969
distance x is tensor(133.5683, device='cuda:3')
benign distance is  tensor(133.5683, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2703353762626648
distance x is tensor(120.1627, device='cuda:3')
benign distance is  tensor(120.1627, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6527997851371765
distance x is tensor(117.9323, device='cuda:3')
benign distance is  tensor(117.9323, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46817073225975037
distance x is tensor(130.4691, device='cuda:3')
benign distance is  tensor(130.4691, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0144191980361938
distance x is tensor(159.7174, device='cuda:3')
benign distance is  tensor(159.7174, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18155646324157715
distance x is tensor(129.3971, device='cuda:3')
benign distance is  tensor(129.3971, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5172315835952759
distance x is tensor(121.5840, device='cuda:3')
benign distance is  tensor(121.5840, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6418063640594482
distance x is tensor(126.4288, device='cuda:3')
benign distance is  tensor(126.4288, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4214683473110199
distance x is tensor(133.6855, device='cuda:3')
benign distance is  tensor(133.6855, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.48233193159103394
distance x is tensor(123.7925, device='cuda:3')
benign distance is  tensor(123.7925, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.23791155219078064
distance x is tensor(124.9861, device='cuda:3')
benign distance is  tensor(124.9861, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5630061030387878
distance x is tensor(129.1531, device='cuda:3')
benign distance is  tensor(129.1531, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.33524274826049805
distance x is tensor(123.1346, device='cuda:3')
benign distance is  tensor(123.1346, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5091296434402466
distance x is tensor(130.5681, device='cuda:3')
benign distance is  tensor(130.5681, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2481985092163086
distance x is tensor(123.0196, device='cuda:3')
benign distance is  tensor(123.0196, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6104567050933838
distance x is tensor(125.2075, device='cuda:3')
benign distance is  tensor(125.2075, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.709905743598938
distance x is tensor(133.6485, device='cuda:3')
benign distance is  tensor(133.6485, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2814754843711853
distance x is tensor(127.9291, device='cuda:3')
benign distance is  tensor(127.9291, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7237655520439148
distance x is tensor(122.4893, device='cuda:3')
benign distance is  tensor(122.4893, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.7103081941604614
distance x is tensor(119.1547, device='cuda:3')
benign distance is  tensor(119.1547, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6485953330993652
distance x is tensor(119.8524, device='cuda:3')
benign distance is  tensor(119.8524, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.15245835483074188
distance x is tensor(132.3686, device='cuda:3')
benign distance is  tensor(132.3686, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.33042797446250916
distance x is tensor(120.2305, device='cuda:3')
benign distance is  tensor(120.2305, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6161078214645386
distance x is tensor(124.8885, device='cuda:3')
benign distance is  tensor(124.8885, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.25718486309051514
distance x is tensor(132.3785, device='cuda:3')
benign distance is  tensor(132.3785, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.44426751136779785
distance x is tensor(123.7643, device='cuda:3')
benign distance is  tensor(123.7643, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11331798881292343
distance x is tensor(125.3212, device='cuda:3')
benign distance is  tensor(125.3212, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.42243361473083496
distance x is tensor(119.3339, device='cuda:3')
benign distance is  tensor(119.3339, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.33292993903160095
distance x is tensor(116.3180, device='cuda:3')
benign distance is  tensor(116.3180, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.35026732087135315
distance x is tensor(135.4078, device='cuda:3')
benign distance is  tensor(135.4078, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.31441760063171387
distance x is tensor(119.7233, device='cuda:3')
benign distance is  tensor(119.7233, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.5299256443977356
distance x is tensor(124.1943, device='cuda:3')
benign distance is  tensor(124.1943, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5620111227035522
distance x is tensor(136.8497, device='cuda:3')
benign distance is  tensor(136.8497, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1379675567150116
distance x is tensor(113.4063, device='cuda:3')
benign distance is  tensor(113.4063, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.48811012506484985
distance x is tensor(129.9235, device='cuda:3')
benign distance is  tensor(129.9235, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.32951968908309937
distance x is tensor(122.2215, device='cuda:3')
benign distance is  tensor(122.2215, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3891875743865967
distance x is tensor(117.1423, device='cuda:3')
benign distance is  tensor(117.1423, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7535876631736755
distance x is tensor(129.3900, device='cuda:3')
benign distance is  tensor(129.3900, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6861913800239563
distance x is tensor(127.1803, device='cuda:3')
benign distance is  tensor(127.1803, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(119.4945, device='cuda:3')
compute distance is  tensor(119.4945, device='cuda:3')
compute norm is  tensor(66.9912, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4235, device='cuda:3')
compute distance is  tensor(132.4235, device='cuda:3')
compute norm is  tensor(67.0893, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1794, device='cuda:3')
compute distance is  tensor(139.1794, device='cuda:3')
compute norm is  tensor(67.4385, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3279, device='cuda:3')
compute distance is  tensor(135.3279, device='cuda:3')
compute norm is  tensor(67.2218, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9334, device='cuda:3')
compute distance is  tensor(141.9334, device='cuda:3')
compute norm is  tensor(67.6179, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7529, device='cuda:3')
compute distance is  tensor(133.7529, device='cuda:3')
compute norm is  tensor(67.3711, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.6143, device='cuda:3')
compute distance is  tensor(118.6143, device='cuda:3')
compute norm is  tensor(66.9566, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.2612, device='cuda:3')
compute distance is  tensor(136.2612, device='cuda:3')
compute norm is  tensor(67.2589, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0900, device='cuda:3')
compute distance is  tensor(139.0900, device='cuda:3')
compute norm is  tensor(67.3263, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8440, device='cuda:3')
compute distance is  tensor(134.8440, device='cuda:3')
compute norm is  tensor(67.4111, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3024, device='cuda:3')
compute distance is  tensor(123.3024, device='cuda:3')
compute norm is  tensor(67.2829, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7910, device='cuda:3')
compute distance is  tensor(121.7910, device='cuda:3')
compute norm is  tensor(67.2423, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.9334, device='cuda:3')
distance x is tensor(107448.8594, device='cuda:3')
distance x is tensor(107448.8594, device='cuda:3')
________________________________
test distance is  tensor(107448.8594, device='cuda:3')
test distance1 is  tensor(107448.8594, device='cuda:3')
test similarity is  tensor(0.6644, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130138390865321.75
test entropy is  0.0
________________________________
cal ratio is  0.03561783534435291
distance x is tensor(3827.1011, device='cuda:3')
cal_distance is  tensor(3827.1011, device='cuda:3')
cal ratio is  0.18872674221626065
distance x is tensor(722.2804, device='cuda:3')
cal_distance is  tensor(722.2804, device='cuda:3')
cal ratio is  0.43442569812099063
distance x is tensor(313.7800, device='cuda:3')
cal_distance is  tensor(313.7800, device='cuda:3')
cal ratio is  0.6591067904661391
distance x is tensor(206.8162, device='cuda:3')
cal_distance is  tensor(206.8162, device='cuda:3')
cal ratio is  0.811850588066629
distance x is tensor(167.9048, device='cuda:3')
cal_distance is  tensor(167.9048, device='cuda:3')
cal ratio is  0.9010250046808338
distance x is tensor(151.2870, device='cuda:3')
cal_distance is  tensor(151.2870, device='cuda:3')
cal ratio is  0.9492216829356654
distance x is tensor(143.6051, device='cuda:3')
cal_distance is  tensor(143.6051, device='cuda:3')
cal ratio is  0.9742792585069745
distance x is tensor(139.9116, device='cuda:3')
cal_distance is  tensor(139.9116, device='cuda:3')
distance x is tensor(139.9116, device='cuda:3')
return_distance is  tensor(139.9116, device='cuda:3')
distance x is tensor(139.9016, device='cuda:3')
distance x is tensor(139.9016, device='cuda:3')
________________________________
test distance is  tensor(139.9016, device='cuda:3')
test distance1 is  tensor(139.9016, device='cuda:3')
test similarity is  tensor(0.9902, device='cuda:3')
test acc is  0.6570333334896666
test loss is 5.321516941859524
test entropy is  0.12169022769180697
________________________________
0
distance x is tensor(139.9016, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.12347918345348667
avg test loss is  5.298970730447057
avg accuracy is  0.8593333334896562
solo acc is  0.6581166668229999
compute similarity  is  tensor(0.9902, device='cuda:3')
compute_distance is  tensor(139.9016, device='cuda:3')
compute_norm is  tensor(71.7285, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.9590, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9380403689738276
avg test loss is  1.3298574447758924
avg accuracy is  0.8355500001563239
solo acc is  0.3153166668230065
compute similarity  is  tensor(0.9899, device='cuda:3')
compute_distance is  tensor(139.9590, device='cuda:3')
compute_norm is  tensor(71.3385, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.7768, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8791533937332219
avg test loss is  1.4309873137392723
avg accuracy is  0.8347833334896572
solo acc is  0.24858333348967146
compute similarity  is  tensor(0.9898, device='cuda:3')
compute_distance is  tensor(139.7768, device='cuda:3')
compute_norm is  tensor(70.9973, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.3494, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8709324705702409
avg test loss is  1.4141403342615058
avg accuracy is  0.8389166668229904
solo acc is  0.24355000015633807
compute similarity  is  tensor(0.9897, device='cuda:3')
compute_distance is  tensor(139.3494, device='cuda:3')
compute_norm is  tensor(70.6572, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(139.0055, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8639008416804169
avg test loss is  1.4035231591796062
avg accuracy is  0.841583333489657
solo acc is  0.23795000015633788
compute similarity  is  tensor(0.9896, device='cuda:3')
compute_distance is  tensor(139.0055, device='cuda:3')
compute_norm is  tensor(70.3193, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.6583, device='cuda:3')
distance x is tensor(138.6583, device='cuda:3')
________________________________
test distance is  tensor(138.6583, device='cuda:3')
test distance1 is  tensor(138.6583, device='cuda:3')
test similarity is  tensor(0.9896, device='cuda:3')
test acc is  0.23386666682300442
test loss is 1.3981371308440593
test entropy is  0.8539726052329992
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.115140676498413
mal norm is  tensor(655.7151, device='cuda:3')
distance x is tensor(138.6676, device='cuda:3')
mal distance is  tensor(138.6676, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([475.5939, 530.2503, 500.4178, 496.7736, 531.0522, 665.7040, 525.2426,
        508.0981, 655.7151, 655.7151, 655.7151, 655.7151, 655.7151, 655.7151,
        655.7151, 655.7151, 655.7151, 655.7151, 655.7151, 655.7151],
       device='cuda:3')
sorted_norm is   tensor([475.5939, 496.7736, 500.4178, 508.0981, 525.2426, 530.2503, 531.0522,
        655.7151, 655.7151, 655.7151, 655.7151, 655.7151, 655.7151, 655.7151,
        655.7151, 655.7151, 655.7151, 655.7151, 655.7151, 665.7040],
       device='cuda:3')
used idx is  tensor([ 0,  3,  2,  7,  6,  1,  4, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 85.55% 

Test Accuracy: 84.48% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3846173882484436
distance x is tensor(127.5760, device='cuda:3')
benign distance is  tensor(127.5760, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7288249731063843
distance x is tensor(137.2311, device='cuda:3')
benign distance is  tensor(137.2311, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14988207817077637
distance x is tensor(120.9806, device='cuda:3')
benign distance is  tensor(120.9806, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4276324212551117
distance x is tensor(142.8296, device='cuda:3')
benign distance is  tensor(142.8296, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6895410418510437
distance x is tensor(136.9605, device='cuda:3')
benign distance is  tensor(136.9605, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6543232202529907
distance x is tensor(136.2758, device='cuda:3')
benign distance is  tensor(136.2758, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39573121070861816
distance x is tensor(131.9304, device='cuda:3')
benign distance is  tensor(131.9304, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3806799352169037
distance x is tensor(127.8645, device='cuda:3')
benign distance is  tensor(127.8645, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(142.6853, device='cuda:3')
compute distance is  tensor(142.6853, device='cuda:3')
compute norm is  tensor(70.1318, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.1923, device='cuda:3')
compute distance is  tensor(153.1923, device='cuda:3')
compute norm is  tensor(70.5166, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5010, device='cuda:3')
compute distance is  tensor(148.5010, device='cuda:3')
compute norm is  tensor(70.1733, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.6684, device='cuda:3')
compute distance is  tensor(144.6684, device='cuda:3')
compute norm is  tensor(70.2713, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1984, device='cuda:3')
compute distance is  tensor(149.1984, device='cuda:3')
compute norm is  tensor(70.4763, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1365, device='cuda:3')
compute distance is  tensor(134.1365, device='cuda:3')
compute norm is  tensor(70.2095, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6458, device='cuda:3')
compute distance is  tensor(127.6458, device='cuda:3')
compute norm is  tensor(69.8541, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4658, device='cuda:3')
compute distance is  tensor(139.4658, device='cuda:3')
compute norm is  tensor(70.2208, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0372, device='cuda:3')
compute distance is  tensor(144.0372, device='cuda:3')
compute norm is  tensor(70.0615, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2893, device='cuda:3')
compute distance is  tensor(147.2893, device='cuda:3')
compute norm is  tensor(70.2651, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.1002, device='cuda:3')
compute distance is  tensor(163.1002, device='cuda:3')
compute norm is  tensor(70.5382, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4828, device='cuda:3')
compute distance is  tensor(126.4828, device='cuda:3')
compute norm is  tensor(69.7739, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(163.1002, device='cuda:3')
distance x is tensor(107387.2734, device='cuda:3')
distance x is tensor(107387.2734, device='cuda:3')
________________________________
test distance is  tensor(107387.2734, device='cuda:3')
test distance1 is  tensor(107387.2734, device='cuda:3')
test similarity is  tensor(0.7158, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129954586546167.27
test entropy is  0.0
________________________________
cal ratio is  0.03819239191977285
distance x is tensor(4101.3818, device='cuda:3')
cal_distance is  tensor(4101.3818, device='cuda:3')
cal ratio is  0.19542862036545386
distance x is tensor(801.5314, device='cuda:3')
cal_distance is  tensor(801.5314, device='cuda:3')
cal ratio is  0.4420719797322566
distance x is tensor(354.3374, device='cuda:3')
cal_distance is  tensor(354.3374, device='cuda:3')
cal ratio is  0.6648823295812487
distance x is tensor(235.5943, device='cuda:3')
cal_distance is  tensor(235.5943, device='cuda:3')
cal ratio is  0.81540024299501
distance x is tensor(192.1046, device='cuda:3')
cal_distance is  tensor(192.1046, device='cuda:3')
cal ratio is  0.9029929958744615
distance x is tensor(173.4696, device='cuda:3')
cal_distance is  tensor(173.4696, device='cuda:3')
cal ratio is  0.9502580283126165
distance x is tensor(164.8411, device='cuda:3')
cal_distance is  tensor(164.8411, device='cuda:3')
cal ratio is  0.9748110859836135
distance x is tensor(160.6891, device='cuda:3')
cal_distance is  tensor(160.6891, device='cuda:3')
distance x is tensor(160.6891, device='cuda:3')
return_distance is  tensor(160.6891, device='cuda:3')
distance x is tensor(160.6791, device='cuda:3')
distance x is tensor(160.6791, device='cuda:3')
________________________________
test distance is  tensor(160.6791, device='cuda:3')
test distance1 is  tensor(160.6791, device='cuda:3')
test similarity is  tensor(0.9905, device='cuda:3')
test acc is  0.1031333334896653
test loss is 117.71984263828823
test entropy is  0.003022767027442707
________________________________
0
distance x is tensor(160.6791, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.003210280832449735
avg test loss is  117.54272505672756
avg accuracy is  0.5179000001563422
solo acc is  0.10336666682299864
compute similarity  is  tensor(0.9905, device='cuda:3')
compute_distance is  tensor(160.6791, device='cuda:3')
compute_norm is  tensor(75.9104, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1248.2905, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4637558826251325
avg test loss is  2.725672567068641
avg accuracy is  0.1036333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3266, device='cuda:3')
compute_distance is  tensor(1248.2905, device='cuda:3')
compute_norm is  tensor(205.5616, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1242.4545, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8118472450069273
avg test loss is  3.462044686396747
avg accuracy is  0.10266666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3267, device='cuda:3')
compute_distance is  tensor(1242.4545, device='cuda:3')
compute_norm is  tensor(204.6954, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1236.8938, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4645669598823416
avg test loss is  2.6880174031389803
avg accuracy is  0.10531666682299862
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3265, device='cuda:3')
compute_distance is  tensor(1236.8938, device='cuda:3')
compute_norm is  tensor(203.6117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1231.1576, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.807653389632829
avg test loss is  3.430299133125907
avg accuracy is  0.1037833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3266, device='cuda:3')
compute_distance is  tensor(1231.1576, device='cuda:3')
compute_norm is  tensor(202.8154, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1225.5702, device='cuda:3')
distance x is tensor(1225.5702, device='cuda:3')
________________________________
test distance is  tensor(1225.5702, device='cuda:3')
test distance1 is  tensor(1225.5702, device='cuda:3')
test similarity is  tensor(0.3265, device='cuda:3')
test acc is  0.09996666682299865
test loss is 2.6806634252767827
test entropy is  1.444332392485157
________________________________
cal ratio is  0.35750669811549673
distance x is tensor(438.1508, device='cuda:3')
cal_distance is  tensor(438.1508, device='cuda:3')
cal ratio is  0.5979177914973277
distance x is tensor(261.9785, device='cuda:3')
cal_distance is  tensor(261.9785, device='cuda:3')
cal ratio is  0.7732508609956869
distance x is tensor(202.5753, device='cuda:3')
cal_distance is  tensor(202.5753, device='cuda:3')
cal ratio is  0.8793463510619689
distance x is tensor(178.1340, device='cuda:3')
cal_distance is  tensor(178.1340, device='cuda:3')
cal ratio is  0.937734361982421
distance x is tensor(167.0424, device='cuda:3')
cal_distance is  tensor(167.0424, device='cuda:3')
cal ratio is  0.9683666980215689
distance x is tensor(161.7584, device='cuda:3')
cal_distance is  tensor(161.7584, device='cuda:3')
distance x is tensor(161.7584, device='cuda:3')
return_distance is  tensor(161.7584, device='cuda:3')
distance x is tensor(161.7565, device='cuda:3')
distance x is tensor(161.7565, device='cuda:3')
________________________________
test distance is  tensor(161.7565, device='cuda:3')
test distance1 is  tensor(161.7565, device='cuda:3')
test similarity is  tensor(0.9281, device='cuda:3')
test acc is  0.18570000015633564
test loss is 2.01532574223557
test entropy is  1.3952633239058798
________________________________
0
distance x is tensor(161.7565, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3951293282163169
avg test loss is  2.017111129725157
avg accuracy is  0.47243333348967526
solo acc is  0.18620000015633562
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(161.7565, device='cuda:3')
compute_norm is  tensor(77.1371, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.4323, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6607675206686642
avg test loss is  2.5590861596024115
avg accuracy is  0.444733333489675
solo acc is  0.10520000015633195
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(162.4323, device='cuda:3')
compute_norm is  tensor(76.8642, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.3941, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.029452853937393
avg test loss is  1.5649534930298323
avg accuracy is  0.5776833334896727
solo acc is  0.2274500001563375
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(163.3941, device='cuda:3')
compute_norm is  tensor(76.4891, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.8735, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6207691602615405
avg test loss is  2.371439526457268
avg accuracy is  0.5002833334896755
solo acc is  0.10510000015633195
compute similarity  is  tensor(0.9280, device='cuda:3')
compute_distance is  tensor(163.8735, device='cuda:3')
compute_norm is  tensor(76.1808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.8633, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9929947406371266
avg test loss is  1.5212230167663428
avg accuracy is  0.5929000001563381
solo acc is  0.22993333348967093
compute similarity  is  tensor(0.9280, device='cuda:3')
compute_distance is  tensor(164.8633, device='cuda:3')
compute_norm is  tensor(75.8135, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.8633, device='cuda:3')
distance x is tensor(164.8633, device='cuda:3')
________________________________
test distance is  tensor(164.8633, device='cuda:3')
test distance1 is  tensor(164.8633, device='cuda:3')
test similarity is  tensor(0.9280, device='cuda:3')
test acc is  0.2300500001563376
test loss is 1.5188708072786392
test entropy is  0.9919198142058814
________________________________
cal ratio is  0.97474546028395
distance x is tensor(160.6987, device='cuda:3')
cal_distance is  tensor(160.6987, device='cuda:3')
distance x is tensor(160.6987, device='cuda:3')
return_distance is  tensor(160.6987, device='cuda:3')
distance x is tensor(160.6998, device='cuda:3')
distance x is tensor(160.6998, device='cuda:3')
________________________________
test distance is  tensor(160.6998, device='cuda:3')
test distance1 is  tensor(160.6998, device='cuda:3')
test similarity is  tensor(0.9312, device='cuda:3')
test acc is  0.2353000001563378
test loss is 1.5091145318200085
test entropy is  1.0051061524384057
________________________________
0
distance x is tensor(160.6998, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0043297821143542
avg test loss is  1.5161401525235125
avg accuracy is  0.5893500001563384
solo acc is  0.23608333348967114
compute similarity  is  tensor(0.9312, device='cuda:3')
compute_distance is  tensor(160.6998, device='cuda:3')
compute_norm is  tensor(75.4964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.5947, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6113943486833877
avg test loss is  2.3317769992071935
avg accuracy is  0.5202166668230089
solo acc is  0.10403333348966529
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(161.5947, device='cuda:3')
compute_norm is  tensor(75.1905, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.0388, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.964346787123792
avg test loss is  1.4636138277267343
avg accuracy is  0.5890000001563384
solo acc is  0.24428333348967138
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(163.0388, device='cuda:3')
compute_norm is  tensor(74.8275, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(163.0365, device='cuda:3')
________________________________
test distance is  tensor(163.0365, device='cuda:3')
test similarity is  tensor(0.9311, device='cuda:3')
test acc is  0.589966666823005
test loss is 1.4636117463935412
test entropy is  0.9647700350040566
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.397721529006958
mal norm is  tensor(1365.7747, device='cuda:3')
distance x is tensor(163.0365, device='cuda:3')
mal distance is  tensor(163.0365, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 516.8979,  558.7071,  497.5285,  569.8256,  538.5433,  547.4387,
         525.4514,  513.1043, 1365.7747, 1365.7747, 1365.7747, 1365.7747,
        1365.7747, 1365.7747, 1365.7747, 1365.7747, 1365.7747, 1365.7747,
        1365.7747, 1365.7747,  762.7064,  726.6421,  802.3810,  775.0175,
         755.2645,  776.0034,  753.2454,  743.0599,  659.4819,  682.0743,
         638.7309,  643.5933,  667.6338,  642.0009,  666.1350,  653.8696],
       device='cuda:3')
sorted_norm is   tensor([ 497.5285,  513.1043,  516.8979,  525.4514,  538.5433,  547.4387,
         558.7071,  569.8256,  638.7309,  642.0009,  643.5933,  653.8696,
         659.4819,  666.1350,  667.6338,  682.0743,  726.6421,  743.0599,
         753.2454,  755.2645,  762.7064,  775.0175,  776.0034,  802.3810,
        1365.7747, 1365.7747, 1365.7747, 1365.7747, 1365.7747, 1365.7747,
        1365.7747, 1365.7747, 1365.7747, 1365.7747, 1365.7747, 1365.7747],
       device='cuda:3')
used idx is  tensor([ 2,  7,  0,  6,  4,  5,  1,  3, 30, 33, 31, 35, 28, 34, 32, 29, 21, 27,
        26, 24, 20, 23, 25, 22, 11, 10,  8,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 76.96% 

Test Accuracy: 76.09% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3334600031375885
distance x is tensor(145.5643, device='cuda:3')
benign distance is  tensor(145.5643, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38179653882980347
distance x is tensor(149.8766, device='cuda:3')
benign distance is  tensor(149.8766, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5751644372940063
distance x is tensor(186.6912, device='cuda:3')
benign distance is  tensor(186.6912, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45532530546188354
distance x is tensor(139.3854, device='cuda:3')
benign distance is  tensor(139.3854, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6207188963890076
distance x is tensor(128.8585, device='cuda:3')
benign distance is  tensor(128.8585, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5636008381843567
distance x is tensor(185.7439, device='cuda:3')
benign distance is  tensor(185.7439, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6330130100250244
distance x is tensor(143.0461, device='cuda:3')
benign distance is  tensor(143.0461, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3885141611099243
distance x is tensor(371.5914, device='cuda:3')
benign distance is  tensor(371.5914, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1147096157073975
distance x is tensor(156.1992, device='cuda:3')
benign distance is  tensor(156.1992, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.29063454270362854
distance x is tensor(141.9791, device='cuda:3')
benign distance is  tensor(141.9791, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9007027745246887
distance x is tensor(176.9694, device='cuda:3')
benign distance is  tensor(176.9694, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2527087926864624
distance x is tensor(163.6749, device='cuda:3')
benign distance is  tensor(163.6749, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48313865065574646
distance x is tensor(143.9495, device='cuda:3')
benign distance is  tensor(143.9495, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.24809391796588898
distance x is tensor(148.2445, device='cuda:3')
benign distance is  tensor(148.2445, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.0949796512722969
distance x is tensor(361.8399, device='cuda:3')
benign distance is  tensor(361.8399, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8622838854789734
distance x is tensor(145.4745, device='cuda:3')
benign distance is  tensor(145.4745, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8299943804740906
distance x is tensor(154.0811, device='cuda:3')
benign distance is  tensor(154.0811, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.19852055609226227
distance x is tensor(168.9601, device='cuda:3')
benign distance is  tensor(168.9601, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3215039372444153
distance x is tensor(142.8644, device='cuda:3')
benign distance is  tensor(142.8644, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.38207951188087463
distance x is tensor(152.8560, device='cuda:3')
benign distance is  tensor(152.8560, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9195095896720886
distance x is tensor(149.4321, device='cuda:3')
benign distance is  tensor(149.4321, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1711069792509079
distance x is tensor(147.4307, device='cuda:3')
benign distance is  tensor(147.4307, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7295788526535034
distance x is tensor(159.0690, device='cuda:3')
benign distance is  tensor(159.0690, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1759035438299179
distance x is tensor(140.3398, device='cuda:3')
benign distance is  tensor(140.3398, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(148.2998, device='cuda:3')
compute distance is  tensor(148.2998, device='cuda:3')
compute norm is  tensor(68.8659, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.4309, device='cuda:3')
compute distance is  tensor(151.4309, device='cuda:3')
compute norm is  tensor(68.9606, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8011, device='cuda:3')
compute distance is  tensor(146.8011, device='cuda:3')
compute norm is  tensor(68.8006, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2359, device='cuda:3')
compute distance is  tensor(147.2359, device='cuda:3')
compute norm is  tensor(68.9369, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6054, device='cuda:3')
compute distance is  tensor(146.6054, device='cuda:3')
compute norm is  tensor(68.9244, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.3902, device='cuda:3')
compute distance is  tensor(149.3902, device='cuda:3')
compute norm is  tensor(68.9120, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.4989, device='cuda:3')
compute distance is  tensor(158.4989, device='cuda:3')
compute norm is  tensor(69.0855, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.2270, device='cuda:3')
compute distance is  tensor(185.2270, device='cuda:3')
compute norm is  tensor(70.3475, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.5258, device='cuda:3')
compute distance is  tensor(157.5258, device='cuda:3')
compute norm is  tensor(68.8508, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.2822, device='cuda:3')
compute distance is  tensor(150.2822, device='cuda:3')
compute norm is  tensor(68.7995, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.5392, device='cuda:3')
compute distance is  tensor(142.5392, device='cuda:3')
compute norm is  tensor(68.6819, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6672, device='cuda:3')
compute distance is  tensor(146.6672, device='cuda:3')
compute norm is  tensor(68.8544, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(185.2270, device='cuda:3')
distance x is tensor(107447.9531, device='cuda:3')
distance x is tensor(107447.9531, device='cuda:3')
________________________________
test distance is  tensor(107447.9531, device='cuda:3')
test distance1 is  tensor(107447.9531, device='cuda:3')
test similarity is  tensor(0.6663, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130141068432084.88
test entropy is  0.0
________________________________
cal ratio is  0.04068920352581185
distance x is tensor(4371.9771, device='cuda:3')
cal_distance is  tensor(4371.9771, device='cuda:3')
cal ratio is  0.20171552354476494
distance x is tensor(881.8997, device='cuda:3')
cal_distance is  tensor(881.8997, device='cuda:3')
cal ratio is  0.44912647526273386
distance x is tensor(396.0872, device='cuda:3')
cal_distance is  tensor(396.0872, device='cuda:3')
cal ratio is  0.6701667063602855
distance x is tensor(265.4462, device='cuda:3')
cal_distance is  tensor(265.4462, device='cuda:3')
cal ratio is  0.8186344772695454
distance x is tensor(217.3043, device='cuda:3')
cal_distance is  tensor(217.3043, device='cuda:3')
cal ratio is  0.9047823559013135
distance x is tensor(196.6136, device='cuda:3')
cal_distance is  tensor(196.6136, device='cuda:3')
cal ratio is  0.951199336588823
distance x is tensor(187.0189, device='cuda:3')
cal_distance is  tensor(187.0189, device='cuda:3')
cal ratio is  0.9752938496310762
distance x is tensor(182.3986, device='cuda:3')
cal_distance is  tensor(182.3986, device='cuda:3')
distance x is tensor(182.3986, device='cuda:3')
return_distance is  tensor(182.3986, device='cuda:3')
distance x is tensor(182.3886, device='cuda:3')
distance x is tensor(182.3886, device='cuda:3')
________________________________
test distance is  tensor(182.3886, device='cuda:3')
test distance1 is  tensor(182.3886, device='cuda:3')
test similarity is  tensor(0.9852, device='cuda:3')
test acc is  0.10000000015633198
test loss is 429.0682435513559
test entropy is  2.361167029243182e-13
________________________________
0
distance x is tensor(182.3886, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.8718301481296275e-12
avg test loss is  428.91690138306444
avg accuracy is  0.15146666682299995
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9852, device='cuda:3')
compute_distance is  tensor(182.3886, device='cuda:3')
compute_norm is  tensor(75.1559, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(259.8430, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0970245297275372
avg test loss is  2.050508308385227
avg accuracy is  0.3626666668230073
solo acc is  0.1583166668230005
compute similarity  is  tensor(0.9668, device='cuda:3')
compute_distance is  tensor(259.8430, device='cuda:3')
compute_norm is  tensor(80.6610, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(258.6194, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6866223943640174
avg test loss is  2.703198719888862
avg accuracy is  0.35375000015634045
solo acc is  0.10383333348966531
compute similarity  is  tensor(0.9668, device='cuda:3')
compute_distance is  tensor(258.6194, device='cuda:3')
compute_norm is  tensor(80.3446, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(257.3669, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.125731013222798
avg test loss is  1.872750319778792
avg accuracy is  0.38665000015634093
solo acc is  0.17688333348966842
compute similarity  is  tensor(0.9668, device='cuda:3')
compute_distance is  tensor(257.3669, device='cuda:3')
compute_norm is  tensor(79.8991, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(256.2672, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6442586895245225
avg test loss is  2.642136104579673
avg accuracy is  0.3791000001563408
solo acc is  0.10215000015633197
compute similarity  is  tensor(0.9668, device='cuda:3')
compute_distance is  tensor(256.2672, device='cuda:3')
compute_norm is  tensor(79.5809, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(255.0527, device='cuda:3')
distance x is tensor(255.0527, device='cuda:3')
________________________________
test distance is  tensor(255.0527, device='cuda:3')
test distance1 is  tensor(255.0527, device='cuda:3')
test similarity is  tensor(0.9668, device='cuda:3')
test acc is  0.17513333348966834
test loss is 1.7704424120978253
test entropy is  1.1207585597851637
________________________________
cal ratio is  0.8351477902075832
distance x is tensor(213.0123, device='cuda:3')
cal_distance is  tensor(213.0123, device='cuda:3')
cal ratio is  0.913852066192132
distance x is tensor(194.6620, device='cuda:3')
cal_distance is  tensor(194.6620, device='cuda:3')
cal ratio is  0.9559554207036438
distance x is tensor(186.0883, device='cuda:3')
cal_distance is  tensor(186.0883, device='cuda:3')
cal ratio is  0.977729385393726
distance x is tensor(181.9441, device='cuda:3')
cal_distance is  tensor(181.9441, device='cuda:3')
distance x is tensor(181.9441, device='cuda:3')
return_distance is  tensor(181.9441, device='cuda:3')
distance x is tensor(181.9380, device='cuda:3')
distance x is tensor(181.9380, device='cuda:3')
________________________________
test distance is  tensor(181.9380, device='cuda:3')
test distance1 is  tensor(181.9380, device='cuda:3')
test similarity is  tensor(0.9813, device='cuda:3')
test acc is  0.17218333348966808
test loss is 1.939075019695103
test entropy is  1.521666632532311
________________________________
0
distance x is tensor(181.9380, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.520182451332556
avg test loss is  1.931718691452734
avg accuracy is  0.45921666682300843
solo acc is  0.17301666682300154
compute similarity  is  tensor(0.9813, device='cuda:3')
compute_distance is  tensor(181.9380, device='cuda:3')
compute_norm is  tensor(74.7709, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.4453, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6680806619780404
avg test loss is  2.551541941506522
avg accuracy is  0.4932166668230087
solo acc is  0.10291666682299863
compute similarity  is  tensor(0.9811, device='cuda:3')
compute_distance is  tensor(182.4453, device='cuda:3')
compute_norm is  tensor(74.4950, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.1101, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.017764432661569
avg test loss is  1.6293910384686516
avg accuracy is  0.5588000001563411
solo acc is  0.20955000015633676
compute similarity  is  tensor(0.9811, device='cuda:3')
compute_distance is  tensor(182.1101, device='cuda:3')
compute_norm is  tensor(74.1078, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(181.6479, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.623960517362745
avg test loss is  2.409732360702588
avg accuracy is  0.5392333334896757
solo acc is  0.10351666682299863
compute similarity  is  tensor(0.9810, device='cuda:3')
compute_distance is  tensor(181.6479, device='cuda:3')
compute_norm is  tensor(73.8059, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.9948, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9653742986320178
avg test loss is  1.596488268009381
avg accuracy is  0.5784500001563394
solo acc is  0.215400000156337
compute similarity  is  tensor(0.9810, device='cuda:3')
compute_distance is  tensor(180.9948, device='cuda:3')
compute_norm is  tensor(73.4301, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(180.9948, device='cuda:3')
distance x is tensor(180.9948, device='cuda:3')
________________________________
test distance is  tensor(180.9948, device='cuda:3')
test distance1 is  tensor(180.9948, device='cuda:3')
test similarity is  tensor(0.9810, device='cuda:3')
test acc is  0.21646666682300375
test loss is 1.596279465440494
test entropy is  0.9651686796374412
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.467388391494751
mal norm is  tensor(795.5873, device='cuda:3')
distance x is tensor(181.0009, device='cuda:3')
mal distance is  tensor(181.0009, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 633.2331,  638.3386,  763.2164,  597.3704,  556.3904,  739.2001,
         589.0067, 1692.7081,  795.5873,  795.5873,  795.5873,  795.5873,
         795.5873,  795.5873,  795.5873,  795.5873,  795.5873,  795.5873,
         795.5873,  795.5873,  560.3700,  606.6442,  580.2147,  572.3948,
         541.3110,  555.7675,  587.7074,  540.4144], device='cuda:3')
sorted_norm is   tensor([ 540.4144,  541.3110,  555.7675,  556.3904,  560.3700,  572.3948,
         580.2147,  587.7074,  589.0067,  597.3704,  606.6442,  633.2331,
         638.3386,  739.2001,  763.2164,  795.5873,  795.5873,  795.5873,
         795.5873,  795.5873,  795.5873,  795.5873,  795.5873,  795.5873,
         795.5873,  795.5873,  795.5873, 1692.7081], device='cuda:3')
used idx is  tensor([27, 24, 25,  4, 20, 23, 22, 26,  6,  3, 21,  0,  1,  5,  2, 18, 14, 16,
        12,  8, 10, 11], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 60.56% 

Test Accuracy: 59.24% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.9624462127685547
distance x is tensor(133.3710, device='cuda:3')
benign distance is  tensor(133.3710, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3329921364784241
distance x is tensor(149.2213, device='cuda:3')
benign distance is  tensor(149.2213, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3066848814487457
distance x is tensor(140.8598, device='cuda:3')
benign distance is  tensor(140.8598, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4896142482757568
distance x is tensor(147.7280, device='cuda:3')
benign distance is  tensor(147.7280, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5768893957138062
distance x is tensor(156.8283, device='cuda:3')
benign distance is  tensor(156.8283, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5882878303527832
distance x is tensor(152.0322, device='cuda:3')
benign distance is  tensor(152.0322, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3422408699989319
distance x is tensor(157.0166, device='cuda:3')
benign distance is  tensor(157.0166, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5640950202941895
distance x is tensor(178.0394, device='cuda:3')
benign distance is  tensor(178.0394, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6480164527893066
distance x is tensor(148.8281, device='cuda:3')
benign distance is  tensor(148.8281, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.866674542427063
distance x is tensor(141.0229, device='cuda:3')
benign distance is  tensor(141.0229, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2639150023460388
distance x is tensor(153.9481, device='cuda:3')
benign distance is  tensor(153.9481, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.44381362199783325
distance x is tensor(282.9493, device='cuda:3')
benign distance is  tensor(282.9493, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.7436391115188599
distance x is tensor(177.7770, device='cuda:3')
benign distance is  tensor(177.7770, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.36995500326156616
distance x is tensor(161.9614, device='cuda:3')
benign distance is  tensor(161.9614, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6542343497276306
distance x is tensor(148.4524, device='cuda:3')
benign distance is  tensor(148.4524, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.41242605447769165
distance x is tensor(137.5850, device='cuda:3')
benign distance is  tensor(137.5850, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.6818, device='cuda:3')
compute distance is  tensor(137.6818, device='cuda:3')
compute norm is  tensor(69.8874, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3533, device='cuda:3')
compute distance is  tensor(139.3533, device='cuda:3')
compute norm is  tensor(69.8243, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5355, device='cuda:3')
compute distance is  tensor(144.5355, device='cuda:3')
compute norm is  tensor(70.1891, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2557, device='cuda:3')
compute distance is  tensor(147.2557, device='cuda:3')
compute norm is  tensor(70.3498, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1263, device='cuda:3')
compute distance is  tensor(142.1263, device='cuda:3')
compute norm is  tensor(70.1421, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7938, device='cuda:3')
compute distance is  tensor(158.7938, device='cuda:3')
compute norm is  tensor(70.2520, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6331, device='cuda:3')
compute distance is  tensor(152.6331, device='cuda:3')
compute norm is  tensor(70.3157, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2276, device='cuda:3')
compute distance is  tensor(143.2276, device='cuda:3')
compute norm is  tensor(70.1329, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5673, device='cuda:3')
compute distance is  tensor(149.5673, device='cuda:3')
compute norm is  tensor(70.0800, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.3404, device='cuda:3')
compute distance is  tensor(179.3404, device='cuda:3')
compute norm is  tensor(71.8916, device='cuda:3', dtype=torch.float64)
distance x is tensor(182.9975, device='cuda:3')
compute distance is  tensor(182.9975, device='cuda:3')
compute norm is  tensor(71.5600, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7041, device='cuda:3')
compute distance is  tensor(140.7041, device='cuda:3')
compute norm is  tensor(69.8811, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(182.9975, device='cuda:3')
distance x is tensor(107440.3203, device='cuda:3')
distance x is tensor(107440.3203, device='cuda:3')
________________________________
test distance is  tensor(107440.3203, device='cuda:3')
test distance1 is  tensor(107440.3203, device='cuda:3')
test similarity is  tensor(0.6760, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130215028320531.11
test entropy is  0.0
________________________________
cal ratio is  0.04044501547799222
distance x is tensor(4345.4307, device='cuda:3')
cal_distance is  tensor(4345.4307, device='cuda:3')
cal ratio is  0.20110933876970866
distance x is tensor(873.9106, device='cuda:3')
cal_distance is  tensor(873.9106, device='cuda:3')
cal ratio is  0.4484511625488146
distance x is tensor(391.9090, device='cuda:3')
cal_distance is  tensor(391.9090, device='cuda:3')
cal ratio is  0.6696625505161942
distance x is tensor(262.4485, device='cuda:3')
cal_distance is  tensor(262.4485, device='cuda:3')
cal ratio is  0.8183265326635603
distance x is tensor(214.7694, device='cuda:3')
cal_distance is  tensor(214.7694, device='cuda:3')
cal ratio is  0.9046121473934559
distance x is tensor(194.2835, device='cuda:3')
cal_distance is  tensor(194.2835, device='cuda:3')
cal ratio is  0.9511098128670586
distance x is tensor(184.7852, device='cuda:3')
cal_distance is  tensor(184.7852, device='cuda:3')
cal ratio is  0.975247890822167
distance x is tensor(180.2115, device='cuda:3')
cal_distance is  tensor(180.2115, device='cuda:3')
distance x is tensor(180.2115, device='cuda:3')
return_distance is  tensor(180.2115, device='cuda:3')
distance x is tensor(180.2015, device='cuda:3')
distance x is tensor(180.2015, device='cuda:3')
________________________________
test distance is  tensor(180.2015, device='cuda:3')
test distance1 is  tensor(180.2015, device='cuda:3')
test similarity is  tensor(0.9865, device='cuda:3')
test acc is  0.34781666682300705
test loss is 17.576200687046498
test entropy is  0.2965596482507201
________________________________
0
distance x is tensor(180.2015, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.29671745262801774
avg test loss is  17.519930074972386
avg accuracy is  0.6027166668230041
solo acc is  0.34755000015634036
compute similarity  is  tensor(0.9865, device='cuda:3')
compute_distance is  tensor(180.2015, device='cuda:3')
compute_norm is  tensor(76.5022, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.5519, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9919109313981112
avg test loss is  1.473733594676833
avg accuracy is  0.6627000001563329
solo acc is  0.26676666682300537
compute similarity  is  tensor(0.9868, device='cuda:3')
compute_distance is  tensor(176.5519, device='cuda:3')
compute_norm is  tensor(76.1574, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(176.5519, device='cuda:3')
distance x is tensor(176.5519, device='cuda:3')
________________________________
test distance is  tensor(176.5519, device='cuda:3')
test distance1 is  tensor(176.5519, device='cuda:3')
test similarity is  tensor(0.9868, device='cuda:3')
test acc is  0.2664500001563387
test loss is 1.4790607065534287
test entropy is  0.9910010054929933
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2021127939224243
mal norm is  tensor(898.7383, device='cuda:3')
distance x is tensor(176.5617, device='cuda:3')
mal distance is  tensor(176.5617, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 586.3424,  651.3087,  598.3229,  609.7699,  654.0427,  653.1214,
         649.5834,  905.6248,  898.7383,  898.7383,  898.7383,  898.7383,
         898.7383,  898.7383,  898.7383,  898.7383,  898.7383,  898.7383,
         898.7383,  898.7383,  677.4340,  629.7360,  719.9417,  698.2814,
         608.3066,  669.1050, 2054.6628,  662.6196], device='cuda:3')
sorted_norm is   tensor([ 586.3424,  598.3229,  608.3066,  609.7699,  629.7360,  649.5834,
         651.3087,  653.1214,  654.0427,  662.6196,  669.1050,  677.4340,
         698.2814,  719.9417,  898.7383,  898.7383,  898.7383,  898.7383,
         898.7383,  898.7383,  898.7383,  898.7383,  898.7383,  898.7383,
         898.7383,  898.7383,  905.6248, 2054.6628], device='cuda:3')
used idx is  tensor([ 0,  2, 24,  3, 21,  6,  1,  5,  4, 27, 25, 20, 23, 22, 19, 17, 15, 11,
         8, 10, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 82.49% 

Test Accuracy: 81.24% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45350003242492676
distance x is tensor(131.0963, device='cuda:3')
benign distance is  tensor(131.0963, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6757416129112244
distance x is tensor(116.6899, device='cuda:3')
benign distance is  tensor(116.6899, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4204721450805664
distance x is tensor(125.3803, device='cuda:3')
benign distance is  tensor(125.3803, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.37550899386405945
distance x is tensor(118.5026, device='cuda:3')
benign distance is  tensor(118.5026, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31805792450904846
distance x is tensor(137.0273, device='cuda:3')
benign distance is  tensor(137.0273, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1720774173736572
distance x is tensor(137.0853, device='cuda:3')
benign distance is  tensor(137.0853, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8020545244216919
distance x is tensor(136.3275, device='cuda:3')
benign distance is  tensor(136.3275, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2382293939590454
distance x is tensor(119.7215, device='cuda:3')
benign distance is  tensor(119.7215, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2150547206401825
distance x is tensor(128.5278, device='cuda:3')
benign distance is  tensor(128.5278, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.33243149518966675
distance x is tensor(120.0262, device='cuda:3')
benign distance is  tensor(120.0262, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2901800572872162
distance x is tensor(127.3644, device='cuda:3')
benign distance is  tensor(127.3644, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3422456979751587
distance x is tensor(129.7156, device='cuda:3')
benign distance is  tensor(129.7156, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6942359805107117
distance x is tensor(137.2816, device='cuda:3')
benign distance is  tensor(137.2816, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5548655986785889
distance x is tensor(129.3200, device='cuda:3')
benign distance is  tensor(129.3200, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9366697072982788
distance x is tensor(144.9755, device='cuda:3')
benign distance is  tensor(144.9755, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4968896806240082
distance x is tensor(122.8827, device='cuda:3')
benign distance is  tensor(122.8827, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.9830, device='cuda:3')
compute distance is  tensor(123.9830, device='cuda:3')
compute norm is  tensor(72.3960, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7703, device='cuda:3')
compute distance is  tensor(123.7703, device='cuda:3')
compute norm is  tensor(72.2832, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3017, device='cuda:3')
compute distance is  tensor(129.3017, device='cuda:3')
compute norm is  tensor(72.5770, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.8658, device='cuda:3')
compute distance is  tensor(134.8658, device='cuda:3')
compute norm is  tensor(72.4325, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4240, device='cuda:3')
compute distance is  tensor(132.4240, device='cuda:3')
compute norm is  tensor(72.6829, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8276, device='cuda:3')
compute distance is  tensor(138.8276, device='cuda:3')
compute norm is  tensor(72.7530, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0557, device='cuda:3')
compute distance is  tensor(132.0557, device='cuda:3')
compute norm is  tensor(72.6028, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7651, device='cuda:3')
compute distance is  tensor(123.7651, device='cuda:3')
compute norm is  tensor(72.5481, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4438, device='cuda:3')
compute distance is  tensor(137.4438, device='cuda:3')
compute norm is  tensor(72.6450, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2341, device='cuda:3')
compute distance is  tensor(125.2341, device='cuda:3')
compute norm is  tensor(72.3015, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3384, device='cuda:3')
compute distance is  tensor(131.3384, device='cuda:3')
compute norm is  tensor(72.5440, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7876, device='cuda:3')
compute distance is  tensor(138.7876, device='cuda:3')
compute norm is  tensor(72.9033, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.8276, device='cuda:3')
distance x is tensor(107392.2734, device='cuda:3')
distance x is tensor(107392.2734, device='cuda:3')
________________________________
test distance is  tensor(107392.2734, device='cuda:3')
test distance1 is  tensor(107392.2734, device='cuda:3')
test similarity is  tensor(0.7090, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130116016685999.22
test entropy is  0.0
________________________________
cal ratio is  0.03523526342047959
distance x is tensor(3784.0005, device='cuda:3')
cal_distance is  tensor(3784.0005, device='cuda:3')
cal ratio is  0.18771044832266612
distance x is tensor(710.3005, device='cuda:3')
cal_distance is  tensor(710.3005, device='cuda:3')
cal ratio is  0.43325441276671534
distance x is tensor(307.7437, device='cuda:3')
cal_distance is  tensor(307.7437, device='cuda:3')
cal ratio is  0.6582175712562217
distance x is tensor(202.5640, device='cuda:3')
cal_distance is  tensor(202.5640, device='cuda:3')
cal ratio is  0.8113026393658195
distance x is tensor(164.3417, device='cuda:3')
cal_distance is  tensor(164.3417, device='cuda:3')
cal ratio is  0.9007207918547966
distance x is tensor(148.0265, device='cuda:3')
cal_distance is  tensor(148.0265, device='cuda:3')
cal ratio is  0.949061465019438
distance x is tensor(140.4865, device='cuda:3')
cal_distance is  tensor(140.4865, device='cuda:3')
cal ratio is  0.9741969679024056
distance x is tensor(136.8616, device='cuda:3')
cal_distance is  tensor(136.8616, device='cuda:3')
distance x is tensor(136.8616, device='cuda:3')
return_distance is  tensor(136.8616, device='cuda:3')
distance x is tensor(136.8516, device='cuda:3')
distance x is tensor(136.8516, device='cuda:3')
________________________________
test distance is  tensor(136.8516, device='cuda:3')
test distance1 is  tensor(136.8516, device='cuda:3')
test similarity is  tensor(0.9931, device='cuda:3')
test acc is  0.5411000001563424
test loss is 10.379789696065094
test entropy is  0.2554737369674864
________________________________
0
distance x is tensor(136.8516, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.2578644810168982
avg test loss is  10.35294241818792
avg accuracy is  0.8096666668229917
solo acc is  0.5423333334896758
compute similarity  is  tensor(0.9931, device='cuda:3')
compute_distance is  tensor(136.8516, device='cuda:3')
compute_norm is  tensor(77.3404, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.5597, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9529990434392429
avg test loss is  1.4033531519904066
avg accuracy is  0.7642000001563273
solo acc is  0.2933833334896728
compute similarity  is  tensor(0.9929, device='cuda:3')
compute_distance is  tensor(136.5597, device='cuda:3')
compute_norm is  tensor(76.9273, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(136.5597, device='cuda:3')
distance x is tensor(136.5597, device='cuda:3')
________________________________
test distance is  tensor(136.5597, device='cuda:3')
test distance1 is  tensor(136.5597, device='cuda:3')
test similarity is  tensor(0.9929, device='cuda:3')
test acc is  0.29125000015633934
test loss is 1.4068585313967805
test entropy is  0.9538238605837832
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2065731287002563
mal norm is  tensor(683.3808, device='cuda:3')
distance x is tensor(136.5691, device='cuda:3')
mal distance is  tensor(136.5691, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([546.4866, 488.4214, 509.0497, 489.7288, 554.0394, 557.1472, 541.0936,
        499.0547, 683.3808, 683.3808, 683.3808, 683.3808, 683.3808, 683.3808,
        683.3808, 683.3808, 683.3808, 683.3808, 683.3808, 683.3808, 716.4557,
        739.4064, 712.8106, 712.5703, 700.5590, 692.0903, 727.9341, 700.3539],
       device='cuda:3')
sorted_norm is   tensor([488.4214, 489.7288, 499.0547, 509.0497, 541.0936, 546.4866, 554.0394,
        557.1472, 683.3808, 683.3808, 683.3808, 683.3808, 683.3808, 683.3808,
        683.3808, 683.3808, 683.3808, 683.3808, 683.3808, 683.3808, 692.0903,
        700.3539, 700.5590, 712.5703, 712.8106, 716.4557, 727.9341, 739.4064],
       device='cuda:3')
used idx is  tensor([ 1,  3,  7,  2,  6,  0,  4,  5, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 25, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 85.28% 

Test Accuracy: 84.23% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3786124289035797
distance x is tensor(132.1600, device='cuda:3')
benign distance is  tensor(132.1600, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5577959418296814
distance x is tensor(151.7703, device='cuda:3')
benign distance is  tensor(151.7703, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.930374264717102
distance x is tensor(223.7694, device='cuda:3')
benign distance is  tensor(223.7694, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4066004157066345
distance x is tensor(140.8375, device='cuda:3')
benign distance is  tensor(140.8375, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7662538290023804
distance x is tensor(145.4889, device='cuda:3')
benign distance is  tensor(145.4889, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5942157506942749
distance x is tensor(138.5364, device='cuda:3')
benign distance is  tensor(138.5364, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3343217372894287
distance x is tensor(147.0610, device='cuda:3')
benign distance is  tensor(147.0610, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2268436700105667
distance x is tensor(141.4284, device='cuda:3')
benign distance is  tensor(141.4284, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.16573108732700348
distance x is tensor(141.1645, device='cuda:3')
benign distance is  tensor(141.1645, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.24891726672649384
distance x is tensor(158.4581, device='cuda:3')
benign distance is  tensor(158.4581, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.38974839448928833
distance x is tensor(161.4648, device='cuda:3')
benign distance is  tensor(161.4648, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.23494505882263184
distance x is tensor(130.3458, device='cuda:3')
benign distance is  tensor(130.3458, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6144798994064331
distance x is tensor(143.2886, device='cuda:3')
benign distance is  tensor(143.2886, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7179746031761169
distance x is tensor(148.5842, device='cuda:3')
benign distance is  tensor(148.5842, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7616007924079895
distance x is tensor(141.3573, device='cuda:3')
benign distance is  tensor(141.3573, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4853835105895996
distance x is tensor(131.5148, device='cuda:3')
benign distance is  tensor(131.5148, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.6439, device='cuda:3')
compute distance is  tensor(144.6439, device='cuda:3')
compute norm is  tensor(75.7986, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2271, device='cuda:3')
compute distance is  tensor(144.2271, device='cuda:3')
compute norm is  tensor(75.5933, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.7226, device='cuda:3')
compute distance is  tensor(152.7226, device='cuda:3')
compute norm is  tensor(75.8094, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.8562, device='cuda:3')
compute distance is  tensor(136.8562, device='cuda:3')
compute norm is  tensor(75.5464, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.0971, device='cuda:3')
compute distance is  tensor(185.0971, device='cuda:3')
compute norm is  tensor(76.7692, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.3372, device='cuda:3')
compute distance is  tensor(170.3372, device='cuda:3')
compute norm is  tensor(76.6593, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5112, device='cuda:3')
compute distance is  tensor(132.5112, device='cuda:3')
compute norm is  tensor(75.5357, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4460, device='cuda:3')
compute distance is  tensor(134.4460, device='cuda:3')
compute norm is  tensor(75.5794, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.6237, device='cuda:3')
compute distance is  tensor(166.6237, device='cuda:3')
compute norm is  tensor(76.0976, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1269, device='cuda:3')
compute distance is  tensor(137.1269, device='cuda:3')
compute norm is  tensor(75.6357, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.6815, device='cuda:3')
compute distance is  tensor(155.6815, device='cuda:3')
compute norm is  tensor(75.8932, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5131, device='cuda:3')
compute distance is  tensor(137.5131, device='cuda:3')
compute norm is  tensor(75.7495, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(185.0971, device='cuda:3')
distance x is tensor(107337.0625, device='cuda:3')
distance x is tensor(107337.0625, device='cuda:3')
________________________________
test distance is  tensor(107337.0625, device='cuda:3')
test distance1 is  tensor(107337.0625, device='cuda:3')
test similarity is  tensor(0.7455, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130089828820114.28
test entropy is  0.0
________________________________
cal ratio is  0.040695935047776514
distance x is tensor(4368.1875, device='cuda:3')
cal_distance is  tensor(4368.1875, device='cuda:3')
cal ratio is  0.20173221309405492
distance x is tensor(881.2083, device='cuda:3')
cal_distance is  tensor(881.2083, device='cuda:3')
cal ratio is  0.44914503580085063
distance x is tensor(395.7931, device='cuda:3')
cal_distance is  tensor(395.7931, device='cuda:3')
cal ratio is  0.6701805012255767
distance x is tensor(265.2545, device='cuda:3')
cal_distance is  tensor(265.2545, device='cuda:3')
cal ratio is  0.8186429733036781
distance x is tensor(217.1496, device='cuda:3')
cal_distance is  tensor(217.1496, device='cuda:3')
cal ratio is  0.9047869744963475
distance x is tensor(196.4746, device='cuda:3')
cal_distance is  tensor(196.4746, device='cuda:3')
cal ratio is  0.9512017739235905
distance x is tensor(186.8873, device='cuda:3')
cal_distance is  tensor(186.8873, device='cuda:3')
cal ratio is  0.9752950528658181
distance x is tensor(182.2704, device='cuda:3')
cal_distance is  tensor(182.2704, device='cuda:3')
distance x is tensor(182.2704, device='cuda:3')
return_distance is  tensor(182.2704, device='cuda:3')
distance x is tensor(182.2603, device='cuda:3')
distance x is tensor(182.2603, device='cuda:3')
________________________________
test distance is  tensor(182.2603, device='cuda:3')
test distance1 is  tensor(182.2603, device='cuda:3')
test similarity is  tensor(0.9910, device='cuda:3')
test acc is  0.10018333348966532
test loss is 334.8248758214369
test entropy is  0.0001482203626168594
________________________________
0
distance x is tensor(182.2603, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0001993678278134551
avg test loss is  334.9814442063191
avg accuracy is  0.40416666682300784
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9910, device='cuda:3')
compute_distance is  tensor(182.2603, device='cuda:3')
compute_norm is  tensor(82.9610, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18762.1328, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5456480212303112
avg test loss is  2.944723059373624
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0456, device='cuda:3')
compute_distance is  tensor(18762.1328, device='cuda:3')
compute_norm is  tensor(1621.3414, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18675.4668, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8243175432371941
avg test loss is  3.704457548381423
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0456, device='cuda:3')
compute_distance is  tensor(18675.4668, device='cuda:3')
compute_norm is  tensor(1613.8355, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18589.4258, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5542586632628939
avg test loss is  2.8723374485715367
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0456, device='cuda:3')
compute_distance is  tensor(18589.4258, device='cuda:3')
compute_norm is  tensor(1606.1139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18503.5801, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8237836825440942
avg test loss is  3.649826881219583
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0456, device='cuda:3')
compute_distance is  tensor(18503.5801, device='cuda:3')
compute_norm is  tensor(1598.7316, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18418.1758, device='cuda:3')
distance x is tensor(18418.1758, device='cuda:3')
________________________________
test distance is  tensor(18418.1758, device='cuda:3')
test distance1 is  tensor(18418.1758, device='cuda:3')
test similarity is  tensor(0.0456, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8606137543090626
test entropy is  1.559017336571903
________________________________
cal ratio is  0.09824321810938264
distance x is tensor(1809.4585, device='cuda:3')
cal_distance is  tensor(1809.4585, device='cuda:3')
cal ratio is  0.31343795060841356
distance x is tensor(567.1513, device='cuda:3')
cal_distance is  tensor(567.1513, device='cuda:3')
cal ratio is  0.5598560983572013
distance x is tensor(317.5221, device='cuda:3')
cal_distance is  tensor(317.5221, device='cuda:3')
cal ratio is  0.7482365691218766
distance x is tensor(237.5810, device='cuda:3')
cal_distance is  tensor(237.5810, device='cuda:3')
cal ratio is  0.8650078259648776
distance x is tensor(205.5091, device='cuda:3')
cal_distance is  tensor(205.5091, device='cuda:3')
cal ratio is  0.9300586380597355
distance x is tensor(191.1354, device='cuda:3')
cal_distance is  tensor(191.1354, device='cuda:3')
cal ratio is  0.9643958901363449
distance x is tensor(184.3301, device='cuda:3')
cal_distance is  tensor(184.3301, device='cuda:3')
distance x is tensor(184.3301, device='cuda:3')
return_distance is  tensor(184.3301, device='cuda:3')
distance x is tensor(184.3351, device='cuda:3')
distance x is tensor(184.3351, device='cuda:3')
________________________________
test distance is  tensor(184.3351, device='cuda:3')
test distance1 is  tensor(184.3351, device='cuda:3')
test similarity is  tensor(0.9765, device='cuda:3')
test acc is  0.10880000015633196
test loss is 2173.6684801959786
test entropy is  0.1190824058509545
________________________________
0
distance x is tensor(184.3351, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.11909825107884972
avg test loss is  2175.5677966542844
avg accuracy is  0.11065000015633196
solo acc is  0.10861666682299861
compute similarity  is  tensor(0.9765, device='cuda:3')
compute_distance is  tensor(184.3351, device='cuda:3')
compute_norm is  tensor(79.1123, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(625.2490, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3132548160644482
avg test loss is  2.3604862207034505
avg accuracy is  0.3221833334896732
solo acc is  0.10843333348966529
compute similarity  is  tensor(0.8696, device='cuda:3')
compute_distance is  tensor(625.2490, device='cuda:3')
compute_norm is  tensor(88.6746, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(624.5289, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7762609045388602
avg test loss is  3.065480888016951
avg accuracy is  0.27628333348967227
solo acc is  0.10021666682299865
compute similarity  is  tensor(0.8696, device='cuda:3')
compute_distance is  tensor(624.5289, device='cuda:3')
compute_norm is  tensor(88.3585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(623.8602, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2883575038869244
avg test loss is  2.2528952182228887
avg accuracy is  0.3891833334896743
solo acc is  0.1112166668229986
compute similarity  is  tensor(0.8696, device='cuda:3')
compute_distance is  tensor(623.8602, device='cuda:3')
compute_norm is  tensor(87.8142, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(622.9816, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7524779001787019
avg test loss is  2.9870161016358496
avg accuracy is  0.36603333348967404
solo acc is  0.10046666682299865
compute similarity  is  tensor(0.8695, device='cuda:3')
compute_distance is  tensor(622.9816, device='cuda:3')
compute_norm is  tensor(87.5118, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(622.2574, device='cuda:3')
distance x is tensor(622.2574, device='cuda:3')
________________________________
test distance is  tensor(622.2574, device='cuda:3')
test distance1 is  tensor(622.2574, device='cuda:3')
test similarity is  tensor(0.8695, device='cuda:3')
test acc is  0.16665000015633444
test loss is 1.976497670226514
test entropy is  1.1277673473871592
________________________________
cal ratio is  0.5344915644798113
distance x is tensor(332.5863, device='cuda:3')
cal_distance is  tensor(332.5863, device='cuda:3')
cal ratio is  0.7310948324307579
distance x is tensor(243.1512, device='cuda:3')
cal_distance is  tensor(243.1512, device='cuda:3')
cal ratio is  0.8550423833174426
distance x is tensor(207.9042, device='cuda:3')
cal_distance is  tensor(207.9042, device='cuda:3')
cal ratio is  0.9246860068780692
distance x is tensor(192.2458, device='cuda:3')
cal_distance is  tensor(192.2458, device='cuda:3')
cal ratio is  0.9616066161664175
distance x is tensor(184.8647, device='cuda:3')
cal_distance is  tensor(184.8647, device='cuda:3')
distance x is tensor(184.8647, device='cuda:3')
return_distance is  tensor(184.8647, device='cuda:3')
distance x is tensor(184.8712, device='cuda:3')
distance x is tensor(184.8712, device='cuda:3')
________________________________
test distance is  tensor(184.8712, device='cuda:3')
test distance1 is  tensor(184.8712, device='cuda:3')
test similarity is  tensor(0.9872, device='cuda:3')
test acc is  0.4405833334896749
test loss is 1.4067034888496277
test entropy is  1.2277309972085932
________________________________
0
distance x is tensor(184.8712, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2250025531630526
avg test loss is  1.407502113057098
avg accuracy is  0.6957000001563309
solo acc is  0.4437833334896749
compute similarity  is  tensor(0.9872, device='cuda:3')
compute_distance is  tensor(184.8712, device='cuda:3')
compute_norm is  tensor(74.5518, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(188.0415, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6373858721271507
avg test loss is  2.5132813654474613
avg accuracy is  0.6389500001563346
solo acc is  0.11231666682299861
compute similarity  is  tensor(0.9871, device='cuda:3')
compute_distance is  tensor(188.0415, device='cuda:3')
compute_norm is  tensor(74.2546, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(190.2417, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9458567191288669
avg test loss is  1.4403633368549063
avg accuracy is  0.7276500001563291
solo acc is  0.2655166668230054
compute similarity  is  tensor(0.9871, device='cuda:3')
compute_distance is  tensor(190.2417, device='cuda:3')
compute_norm is  tensor(73.8477, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(190.2357, device='cuda:3')
________________________________
test distance is  tensor(190.2357, device='cuda:3')
test similarity is  tensor(0.9871, device='cuda:3')
test acc is  0.7277833334896624
test loss is 1.4392632972965362
test entropy is  0.9464149130687022
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.244872808456421
mal norm is  tensor(627.3790, device='cuda:3')
distance x is tensor(190.2357, device='cuda:3')
mal distance is  tensor(190.2357, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 538.6434,  611.6354,  917.4393,  572.6896,  576.6913,  571.3331,
         583.2310,  570.5259,  627.3790,  627.3790,  627.3790,  627.3790,
         627.3790,  627.3790,  627.3790,  627.3790,  627.3790,  627.3790,
         627.3790,  627.3790,  940.6371,  967.4093,  926.9114,  949.7090,
         942.4064,  923.8781,  942.9283,  951.9379,  963.6021, 1023.9655,
         936.7969,  965.8742,  949.3566,  954.1192, 1009.6772,  934.9145,
         867.6339,  854.8085,  881.7012, 1293.6804,  945.8286,  983.3011,
         864.3586,  820.9317,  637.5097,  621.0427,  628.6387,  652.2794,
         655.3010,  655.6800,  689.7354,  629.0456], device='cuda:3')
sorted_norm is   tensor([ 538.6434,  570.5259,  571.3331,  572.6896,  576.6913,  583.2310,
         611.6354,  621.0427,  627.3790,  627.3790,  627.3790,  627.3790,
         627.3790,  627.3790,  627.3790,  627.3790,  627.3790,  627.3790,
         627.3790,  627.3790,  628.6387,  629.0456,  637.5097,  652.2794,
         655.3010,  655.6800,  689.7354,  820.9317,  854.8085,  864.3586,
         867.6339,  881.7012,  917.4393,  923.8781,  926.9114,  934.9145,
         936.7969,  940.6371,  942.4064,  942.9283,  945.8286,  949.3566,
         949.7090,  951.9379,  954.1192,  963.6021,  965.8742,  967.4093,
         983.3011, 1009.6772, 1023.9655, 1293.6804], device='cuda:3')
used idx is  tensor([ 0,  7,  5,  3,  4,  6,  1, 45, 15, 18, 16, 17, 13, 12, 14, 19,  8, 11,
        10,  9, 46, 51, 44, 47, 48, 49, 50, 43, 37, 42, 36, 38,  2, 25, 22, 35,
        30, 20, 24, 26, 40], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 82.25% 

Test Accuracy: 81.46% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7465949058532715
distance x is tensor(144.3040, device='cuda:3')
benign distance is  tensor(144.3040, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.702775776386261
distance x is tensor(146.1365, device='cuda:3')
benign distance is  tensor(146.1365, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.660624086856842
distance x is tensor(118.2675, device='cuda:3')
benign distance is  tensor(118.2675, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6374114751815796
distance x is tensor(114.4530, device='cuda:3')
benign distance is  tensor(114.4530, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6983506083488464
distance x is tensor(116.9683, device='cuda:3')
benign distance is  tensor(116.9683, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5897552967071533
distance x is tensor(127.6666, device='cuda:3')
benign distance is  tensor(127.6666, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4462268352508545
distance x is tensor(135.1014, device='cuda:3')
benign distance is  tensor(135.1014, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46685487031936646
distance x is tensor(143.0179, device='cuda:3')
benign distance is  tensor(143.0179, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3755801320075989
distance x is tensor(124.0767, device='cuda:3')
benign distance is  tensor(124.0767, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.36562129855155945
distance x is tensor(121.4596, device='cuda:3')
benign distance is  tensor(121.4596, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.12588463723659515
distance x is tensor(117.1973, device='cuda:3')
benign distance is  tensor(117.1973, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5352764129638672
distance x is tensor(133.6811, device='cuda:3')
benign distance is  tensor(133.6811, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.47439131140708923
distance x is tensor(121.1708, device='cuda:3')
benign distance is  tensor(121.1708, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3245701193809509
distance x is tensor(121.2640, device='cuda:3')
benign distance is  tensor(121.2640, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4096802771091461
distance x is tensor(131.9553, device='cuda:3')
benign distance is  tensor(131.9553, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5163124799728394
distance x is tensor(124.0021, device='cuda:3')
benign distance is  tensor(124.0021, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.15902580320835114
distance x is tensor(125.1956, device='cuda:3')
benign distance is  tensor(125.1956, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5549615621566772
distance x is tensor(134.6450, device='cuda:3')
benign distance is  tensor(134.6450, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5197722315788269
distance x is tensor(126.7740, device='cuda:3')
benign distance is  tensor(126.7740, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4722929894924164
distance x is tensor(128.1037, device='cuda:3')
benign distance is  tensor(128.1037, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.371561199426651
distance x is tensor(127.0025, device='cuda:3')
benign distance is  tensor(127.0025, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6227470636367798
distance x is tensor(123.3378, device='cuda:3')
benign distance is  tensor(123.3378, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4455074667930603
distance x is tensor(131.3501, device='cuda:3')
benign distance is  tensor(131.3501, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4786209166049957
distance x is tensor(137.1662, device='cuda:3')
benign distance is  tensor(137.1662, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6517778038978577
distance x is tensor(138.5298, device='cuda:3')
benign distance is  tensor(138.5298, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5680152177810669
distance x is tensor(124.2696, device='cuda:3')
benign distance is  tensor(124.2696, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.46670204401016235
distance x is tensor(125.9362, device='cuda:3')
benign distance is  tensor(125.9362, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.943825364112854
distance x is tensor(127.5568, device='cuda:3')
benign distance is  tensor(127.5568, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6600497364997864
distance x is tensor(127.6064, device='cuda:3')
benign distance is  tensor(127.6064, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8122988939285278
distance x is tensor(136.7813, device='cuda:3')
benign distance is  tensor(136.7813, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6315915584564209
distance x is tensor(138.6263, device='cuda:3')
benign distance is  tensor(138.6263, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.08420190960168839
distance x is tensor(116.5485, device='cuda:3')
benign distance is  tensor(116.5485, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3367727994918823
distance x is tensor(129.3212, device='cuda:3')
benign distance is  tensor(129.3212, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4775698781013489
distance x is tensor(131.6733, device='cuda:3')
benign distance is  tensor(131.6733, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.26279696822166443
distance x is tensor(125.5406, device='cuda:3')
benign distance is  tensor(125.5406, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.15082789957523346
distance x is tensor(130.5705, device='cuda:3')
benign distance is  tensor(130.5705, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4291231036186218
distance x is tensor(115.2329, device='cuda:3')
benign distance is  tensor(115.2329, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.44009479880332947
distance x is tensor(132.3932, device='cuda:3')
benign distance is  tensor(132.3932, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.47873663902282715
distance x is tensor(121.0743, device='cuda:3')
benign distance is  tensor(121.0743, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.623204231262207
distance x is tensor(129.8736, device='cuda:3')
benign distance is  tensor(129.8736, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(120.2177, device='cuda:3')
compute distance is  tensor(120.2177, device='cuda:3')
compute norm is  tensor(72.5435, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7505, device='cuda:3')
compute distance is  tensor(121.7505, device='cuda:3')
compute norm is  tensor(72.3871, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5421, device='cuda:3')
compute distance is  tensor(136.5421, device='cuda:3')
compute norm is  tensor(72.7577, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5569, device='cuda:3')
compute distance is  tensor(127.5569, device='cuda:3')
compute norm is  tensor(72.7128, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3554, device='cuda:3')
compute distance is  tensor(128.3554, device='cuda:3')
compute norm is  tensor(72.7770, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6249, device='cuda:3')
compute distance is  tensor(131.6249, device='cuda:3')
compute norm is  tensor(72.8328, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.1307, device='cuda:3')
compute distance is  tensor(119.1307, device='cuda:3')
compute norm is  tensor(72.5295, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.2739, device='cuda:3')
compute distance is  tensor(127.2739, device='cuda:3')
compute norm is  tensor(72.7277, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.8508, device='cuda:3')
compute distance is  tensor(156.8508, device='cuda:3')
compute norm is  tensor(73.2835, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5378, device='cuda:3')
compute distance is  tensor(129.5378, device='cuda:3')
compute norm is  tensor(72.7644, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2596, device='cuda:3')
compute distance is  tensor(129.2596, device='cuda:3')
compute norm is  tensor(73.0070, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1414, device='cuda:3')
compute distance is  tensor(118.1414, device='cuda:3')
compute norm is  tensor(72.5339, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(156.8508, device='cuda:3')
distance x is tensor(107414.7344, device='cuda:3')
distance x is tensor(107414.7344, device='cuda:3')
________________________________
test distance is  tensor(107414.7344, device='cuda:3')
test distance1 is  tensor(107414.7344, device='cuda:3')
test similarity is  tensor(0.6972, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130060531731877.39
test entropy is  0.0
________________________________
cal ratio is  0.03744876219943766
distance x is tensor(4022.5552, device='cuda:3')
cal_distance is  tensor(4022.5552, device='cuda:3')
cal ratio is  0.19351667327273525
distance x is tensor(778.4354, device='cuda:3')
cal_distance is  tensor(778.4354, device='cuda:3')
cal ratio is  0.4399041989324662
distance x is tensor(342.4398, device='cuda:3')
cal_distance is  tensor(342.4398, device='cuda:3')
cal ratio is  0.6632500166981073
distance x is tensor(227.1249, device='cuda:3')
cal_distance is  tensor(227.1249, device='cuda:3')
cal ratio is  0.8143985899453051
distance x is tensor(184.9712, device='cuda:3')
cal_distance is  tensor(184.9712, device='cuda:3')
cal ratio is  0.902437969675529
distance x is tensor(166.9255, device='cuda:3')
cal_distance is  tensor(166.9255, device='cuda:3')
cal ratio is  0.9499659661671651
distance x is tensor(158.5738, device='cuda:3')
cal_distance is  tensor(158.5738, device='cuda:3')
cal ratio is  0.9746612415036078
distance x is tensor(154.5559, device='cuda:3')
cal_distance is  tensor(154.5559, device='cuda:3')
distance x is tensor(154.5559, device='cuda:3')
return_distance is  tensor(154.5559, device='cuda:3')
distance x is tensor(154.5459, device='cuda:3')
distance x is tensor(154.5459, device='cuda:3')
________________________________
test distance is  tensor(154.5459, device='cuda:3')
test distance1 is  tensor(154.5459, device='cuda:3')
test similarity is  tensor(0.9911, device='cuda:3')
test acc is  0.6621500001563331
test loss is 5.984936457580086
test entropy is  0.22585122088697165
________________________________
0
distance x is tensor(154.5459, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.2262285383446003
avg test loss is  5.868683418104135
avg accuracy is  0.8341500001563239
solo acc is  0.6640666668229996
compute similarity  is  tensor(0.9911, device='cuda:3')
compute_distance is  tensor(154.5459, device='cuda:3')
compute_norm is  tensor(78.2657, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.9100, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9363768020672585
avg test loss is  1.3546912332714747
avg accuracy is  0.7697166668229936
solo acc is  0.29475000015633934
compute similarity  is  tensor(0.9910, device='cuda:3')
compute_distance is  tensor(152.9100, device='cuda:3')
compute_norm is  tensor(77.7928, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.9100, device='cuda:3')
distance x is tensor(152.9100, device='cuda:3')
________________________________
test distance is  tensor(152.9100, device='cuda:3')
test distance1 is  tensor(152.9100, device='cuda:3')
test similarity is  tensor(0.9910, device='cuda:3')
test acc is  0.29763333348967275
test loss is 1.3544516956119903
test entropy is  0.9364425400172723
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.2085479497909546
mal norm is  tensor(772.3906, device='cuda:3')
distance x is tensor(152.9193, device='cuda:3')
mal distance is  tensor(152.9193, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([601.7703, 592.5663, 495.3300, 488.2756, 489.7018, 533.3779, 553.6703,
        584.1937, 772.3906, 772.3906, 772.3906, 772.3906, 772.3906, 772.3906,
        772.3906, 772.3906, 772.3906, 772.3906, 772.3906, 772.3906],
       device='cuda:3')
sorted_norm is   tensor([488.2756, 489.7018, 495.3300, 533.3779, 553.6703, 584.1937, 592.5663,
        601.7703, 772.3906, 772.3906, 772.3906, 772.3906, 772.3906, 772.3906,
        772.3906, 772.3906, 772.3906, 772.3906, 772.3906, 772.3906],
       device='cuda:3')
used idx is  tensor([ 3,  4,  2,  5,  6,  7,  1,  0, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 84.98% 

Test Accuracy: 84.18% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8388721346855164
distance x is tensor(135.6257, device='cuda:3')
benign distance is  tensor(135.6257, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3851722776889801
distance x is tensor(127.6546, device='cuda:3')
benign distance is  tensor(127.6546, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2440141886472702
distance x is tensor(126.7451, device='cuda:3')
benign distance is  tensor(126.7451, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8464949727058411
distance x is tensor(119.1710, device='cuda:3')
benign distance is  tensor(119.1710, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0863189697265625
distance x is tensor(122.1891, device='cuda:3')
benign distance is  tensor(122.1891, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6218782663345337
distance x is tensor(138.4585, device='cuda:3')
benign distance is  tensor(138.4585, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16991014778614044
distance x is tensor(142.3924, device='cuda:3')
benign distance is  tensor(142.3924, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3762405514717102
distance x is tensor(137.5945, device='cuda:3')
benign distance is  tensor(137.5945, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.3013, device='cuda:3')
compute distance is  tensor(135.3013, device='cuda:3')
compute norm is  tensor(76.3490, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7843, device='cuda:3')
compute distance is  tensor(136.7843, device='cuda:3')
compute norm is  tensor(76.3188, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.1737, device='cuda:3')
compute distance is  tensor(155.1737, device='cuda:3')
compute norm is  tensor(76.7516, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2876, device='cuda:3')
compute distance is  tensor(143.2876, device='cuda:3')
compute norm is  tensor(76.5127, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.4213, device='cuda:3')
compute distance is  tensor(150.4213, device='cuda:3')
compute norm is  tensor(76.5725, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9645, device='cuda:3')
compute distance is  tensor(128.9645, device='cuda:3')
compute norm is  tensor(76.2761, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.8570, device='cuda:3')
compute distance is  tensor(129.8570, device='cuda:3')
compute norm is  tensor(76.4069, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.1111, device='cuda:3')
compute distance is  tensor(153.1111, device='cuda:3')
compute norm is  tensor(76.7168, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0587, device='cuda:3')
compute distance is  tensor(149.0587, device='cuda:3')
compute norm is  tensor(76.5362, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0429, device='cuda:3')
compute distance is  tensor(145.0429, device='cuda:3')
compute norm is  tensor(76.6089, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6472, device='cuda:3')
compute distance is  tensor(139.6472, device='cuda:3')
compute norm is  tensor(76.4107, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5077, device='cuda:3')
compute distance is  tensor(130.5077, device='cuda:3')
compute norm is  tensor(76.2761, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(155.1737, device='cuda:3')
distance x is tensor(107351.7969, device='cuda:3')
distance x is tensor(107351.7969, device='cuda:3')
________________________________
test distance is  tensor(107351.7969, device='cuda:3')
test distance1 is  tensor(107351.7969, device='cuda:3')
test similarity is  tensor(0.7395, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130112013003725.78
test entropy is  0.0
________________________________
cal ratio is  0.03725893730608208
distance x is tensor(3999.8191, device='cuda:3')
cal_distance is  tensor(3999.8191, device='cuda:3')
cal ratio is  0.193025614591668
distance x is tensor(772.0717, device='cuda:3')
cal_distance is  tensor(772.0717, device='cuda:3')
cal ratio is  0.439345639639696
distance x is tensor(339.2091, device='cuda:3')
cal_distance is  tensor(339.2091, device='cuda:3')
cal ratio is  0.662828803979256
distance x is tensor(224.8392, device='cuda:3')
cal_distance is  tensor(224.8392, device='cuda:3')
cal ratio is  0.8141399509539521
distance x is tensor(183.0516, device='cuda:3')
cal_distance is  tensor(183.0516, device='cuda:3')
cal ratio is  0.9022946632674304
distance x is tensor(165.1670, device='cuda:3')
cal_distance is  tensor(165.1670, device='cuda:3')
cal ratio is  0.9498904582413726
distance x is tensor(156.8908, device='cuda:3')
cal_distance is  tensor(156.8908, device='cuda:3')
cal ratio is  0.9746224479089025
distance x is tensor(152.9094, device='cuda:3')
cal_distance is  tensor(152.9094, device='cuda:3')
distance x is tensor(152.9094, device='cuda:3')
return_distance is  tensor(152.9094, device='cuda:3')
distance x is tensor(152.8994, device='cuda:3')
distance x is tensor(152.8994, device='cuda:3')
________________________________
test distance is  tensor(152.8994, device='cuda:3')
test distance1 is  tensor(152.8994, device='cuda:3')
test similarity is  tensor(0.9933, device='cuda:3')
test acc is  0.11915000015633193
test loss is 74.23682909072843
test entropy is  0.02304262290539582
________________________________
0
distance x is tensor(152.8994, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.022261762488231956
avg test loss is  74.57782294348613
avg accuracy is  0.6652833334896661
solo acc is  0.11896666682299858
compute similarity  is  tensor(0.9933, device='cuda:3')
compute_distance is  tensor(152.8994, device='cuda:3')
compute_norm is  tensor(82.0944, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.6991, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9599320006523051
avg test loss is  1.455582365806677
avg accuracy is  0.7367500001563285
solo acc is  0.24943333348967153
compute similarity  is  tensor(0.9935, device='cuda:3')
compute_distance is  tensor(152.6991, device='cuda:3')
compute_norm is  tensor(81.9988, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.6991, device='cuda:3')
distance x is tensor(152.6991, device='cuda:3')
________________________________
test distance is  tensor(152.6991, device='cuda:3')
test distance1 is  tensor(152.6991, device='cuda:3')
test similarity is  tensor(0.9935, device='cuda:3')
test acc is  0.252166666823005
test loss is 1.455806897774434
test entropy is  0.9592055467400216
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2393798828125
mal norm is  tensor(759.1819, device='cuda:3')
distance x is tensor(152.7088, device='cuda:3')
mal distance is  tensor(152.7088, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([559.1759, 518.3968, 514.8693, 488.6895, 499.2808, 566.2739, 554.5004,
        558.7751, 759.1819, 759.1819, 759.1819, 759.1819, 759.1819, 759.1819,
        759.1819, 759.1819, 759.1819, 759.1819, 759.1819, 759.1819, 669.4320,
        660.1054, 637.5379, 687.4199, 653.9688, 654.3374, 683.5880, 666.7159],
       device='cuda:3')
sorted_norm is   tensor([488.6895, 499.2808, 514.8693, 518.3968, 554.5004, 558.7751, 559.1759,
        566.2739, 637.5379, 653.9688, 654.3374, 660.1054, 666.7159, 669.4320,
        683.5880, 687.4199, 759.1819, 759.1819, 759.1819, 759.1819, 759.1819,
        759.1819, 759.1819, 759.1819, 759.1819, 759.1819, 759.1819, 759.1819],
       device='cuda:3')
used idx is  tensor([ 3,  4,  2,  1,  6,  7,  0,  5, 22, 24, 25, 21, 27, 20, 26, 23, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 87.28% 

Test Accuracy: 86.26% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6459840536117554
distance x is tensor(124.8662, device='cuda:3')
benign distance is  tensor(124.8662, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7124981880187988
distance x is tensor(128.9434, device='cuda:3')
benign distance is  tensor(128.9434, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1434989869594574
distance x is tensor(113.2371, device='cuda:3')
benign distance is  tensor(113.2371, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.38035285472869873
distance x is tensor(135.7213, device='cuda:3')
benign distance is  tensor(135.7213, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7143461108207703
distance x is tensor(126.3394, device='cuda:3')
benign distance is  tensor(126.3394, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0981147289276123
distance x is tensor(139.6156, device='cuda:3')
benign distance is  tensor(139.6156, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3623439371585846
distance x is tensor(115.7742, device='cuda:3')
benign distance is  tensor(115.7742, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46255654096603394
distance x is tensor(129.1985, device='cuda:3')
benign distance is  tensor(129.1985, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.40086299180984497
distance x is tensor(122.1404, device='cuda:3')
benign distance is  tensor(122.1404, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.17926137149333954
distance x is tensor(143.4689, device='cuda:3')
benign distance is  tensor(143.4689, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5819246768951416
distance x is tensor(124.8561, device='cuda:3')
benign distance is  tensor(124.8561, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4744270443916321
distance x is tensor(122.6492, device='cuda:3')
benign distance is  tensor(122.6492, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6419124603271484
distance x is tensor(125.2986, device='cuda:3')
benign distance is  tensor(125.2986, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2714398503303528
distance x is tensor(122.7626, device='cuda:3')
benign distance is  tensor(122.7626, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.18868514895439148
distance x is tensor(122.9068, device='cuda:3')
benign distance is  tensor(122.9068, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.25774410367012024
distance x is tensor(137.2345, device='cuda:3')
benign distance is  tensor(137.2345, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(120.0330, device='cuda:3')
compute distance is  tensor(120.0330, device='cuda:3')
compute norm is  tensor(77.0650, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7075, device='cuda:3')
compute distance is  tensor(127.7075, device='cuda:3')
compute norm is  tensor(77.0515, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6585, device='cuda:3')
compute distance is  tensor(130.6585, device='cuda:3')
compute norm is  tensor(77.3013, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1646, device='cuda:3')
compute distance is  tensor(134.1646, device='cuda:3')
compute norm is  tensor(77.3072, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6166, device='cuda:3')
compute distance is  tensor(129.6166, device='cuda:3')
compute norm is  tensor(77.2671, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9610, device='cuda:3')
compute distance is  tensor(134.9610, device='cuda:3')
compute norm is  tensor(77.3933, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9311, device='cuda:3')
compute distance is  tensor(142.9311, device='cuda:3')
compute norm is  tensor(77.5247, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3697, device='cuda:3')
compute distance is  tensor(129.3697, device='cuda:3')
compute norm is  tensor(77.5269, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.3581, device='cuda:3')
compute distance is  tensor(144.3581, device='cuda:3')
compute norm is  tensor(77.5370, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1386, device='cuda:3')
compute distance is  tensor(115.1386, device='cuda:3')
compute norm is  tensor(77.0902, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9231, device='cuda:3')
compute distance is  tensor(124.9231, device='cuda:3')
compute norm is  tensor(77.1957, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.8513, device='cuda:3')
compute distance is  tensor(123.8513, device='cuda:3')
compute norm is  tensor(77.0731, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.3581, device='cuda:3')
distance x is tensor(107356.0078, device='cuda:3')
distance x is tensor(107356.0078, device='cuda:3')
________________________________
test distance is  tensor(107356.0078, device='cuda:3')
test distance1 is  tensor(107356.0078, device='cuda:3')
test similarity is  tensor(0.7381, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130166067333517.38
test entropy is  0.0
________________________________
cal ratio is  0.035936314240620076
distance x is tensor(3857.9846, device='cuda:3')
cal_distance is  tensor(3857.9846, device='cuda:3')
cal ratio is  0.18956862998151291
distance x is tensor(731.3569, device='cuda:3')
cal_distance is  tensor(731.3569, device='cuda:3')
cal ratio is  0.4353935746072998
distance x is tensor(318.4309, device='cuda:3')
cal_distance is  tensor(318.4309, device='cuda:3')
cal ratio is  0.6598407098427757
distance x is tensor(210.1154, device='cuda:3')
cal_distance is  tensor(210.1154, device='cuda:3')
cal ratio is  0.8123024723126419
distance x is tensor(170.6782, device='cuda:3')
cal_distance is  tensor(170.6782, device='cuda:3')
cal ratio is  0.901275732265629
distance x is tensor(153.8286, device='cuda:3')
cal_distance is  tensor(153.8286, device='cuda:3')
cal ratio is  0.949353865726637
distance x is tensor(146.0381, device='cuda:3')
cal_distance is  tensor(146.0381, device='cuda:3')
cal ratio is  0.9743470306615314
distance x is tensor(142.2919, device='cuda:3')
cal_distance is  tensor(142.2919, device='cuda:3')
distance x is tensor(142.2919, device='cuda:3')
return_distance is  tensor(142.2919, device='cuda:3')
distance x is tensor(142.2819, device='cuda:3')
distance x is tensor(142.2819, device='cuda:3')
________________________________
test distance is  tensor(142.2819, device='cuda:3')
test distance1 is  tensor(142.2819, device='cuda:3')
test similarity is  tensor(0.9942, device='cuda:3')
test acc is  0.7389500001563284
test loss is 2.5585401722871417
test entropy is  0.1816510627550611
________________________________
0
distance x is tensor(142.2819, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.18187887996816432
avg test loss is  2.5463467194263867
avg accuracy is  0.8594833334896562
solo acc is  0.7387500001563283
compute similarity  is  tensor(0.9942, device='cuda:3')
compute_distance is  tensor(142.2819, device='cuda:3')
compute_norm is  tensor(82.5517, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.0816, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9246945272503632
avg test loss is  1.3696113313311962
avg accuracy is  0.8003000001563254
solo acc is  0.29240000015633943
compute similarity  is  tensor(0.9941, device='cuda:3')
compute_distance is  tensor(142.0816, device='cuda:3')
compute_norm is  tensor(82.0712, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(141.4272, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8827887071348203
avg test loss is  1.4527371074599245
avg accuracy is  0.7994333334896587
solo acc is  0.23743333348967113
compute similarity  is  tensor(0.9940, device='cuda:3')
compute_distance is  tensor(141.4272, device='cuda:3')
compute_norm is  tensor(81.6824, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(141.4272, device='cuda:3')
distance x is tensor(141.4272, device='cuda:3')
________________________________
test distance is  tensor(141.4272, device='cuda:3')
test distance1 is  tensor(141.4272, device='cuda:3')
test similarity is  tensor(0.9940, device='cuda:3')
test acc is  0.23978333348967135
test loss is 1.4515616314243407
test entropy is  0.8821426912157266
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 0.9983389973640442
mal norm is  tensor(693.6219, device='cuda:3')
distance x is tensor(141.4364, device='cuda:3')
mal distance is  tensor(141.4364, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([521.2715, 532.8392, 471.4032, 546.3618, 515.3503, 565.0358, 473.9648,
        529.3046, 693.6219, 693.6219, 693.6219, 693.6219, 693.6219, 693.6219,
        693.6219, 693.6219, 693.6219, 693.6219, 693.6219, 693.6219, 678.7923,
        719.6407, 689.9125, 697.7164, 686.4706, 664.9127, 714.8125, 717.8026],
       device='cuda:3')
sorted_norm is   tensor([471.4032, 473.9648, 515.3503, 521.2715, 529.3046, 532.8392, 546.3618,
        565.0358, 664.9127, 678.7923, 686.4706, 689.9125, 693.6219, 693.6219,
        693.6219, 693.6219, 693.6219, 693.6219, 693.6219, 693.6219, 693.6219,
        693.6219, 693.6219, 693.6219, 697.7164, 714.8125, 717.8026, 719.6407],
       device='cuda:3')
used idx is  tensor([ 2,  6,  4,  0,  7,  1,  3,  5, 25, 20, 24, 22, 19, 18, 16, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 87.12% 

Test Accuracy: 85.88% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5836407542228699
distance x is tensor(127.4825, device='cuda:3')
benign distance is  tensor(127.4825, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0726757049560547
distance x is tensor(154.0777, device='cuda:3')
benign distance is  tensor(154.0777, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38180312514305115
distance x is tensor(135.0416, device='cuda:3')
benign distance is  tensor(135.0416, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49850624799728394
distance x is tensor(126.7358, device='cuda:3')
benign distance is  tensor(126.7358, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5038639307022095
distance x is tensor(129.3833, device='cuda:3')
benign distance is  tensor(129.3833, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2397620677947998
distance x is tensor(139.6562, device='cuda:3')
benign distance is  tensor(139.6562, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0045329332351685
distance x is tensor(131.0703, device='cuda:3')
benign distance is  tensor(131.0703, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7521404027938843
distance x is tensor(141.3632, device='cuda:3')
benign distance is  tensor(141.3632, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6140539646148682
distance x is tensor(143.1264, device='cuda:3')
benign distance is  tensor(143.1264, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.17492862045764923
distance x is tensor(144.5425, device='cuda:3')
benign distance is  tensor(144.5425, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2322179079055786
distance x is tensor(133.9116, device='cuda:3')
benign distance is  tensor(133.9116, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.668073296546936
distance x is tensor(132.6220, device='cuda:3')
benign distance is  tensor(132.6220, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5646507740020752
distance x is tensor(123.9427, device='cuda:3')
benign distance is  tensor(123.9427, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.18387290835380554
distance x is tensor(112.4990, device='cuda:3')
benign distance is  tensor(112.4990, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.487754762172699
distance x is tensor(142.4823, device='cuda:3')
benign distance is  tensor(142.4823, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5710747838020325
distance x is tensor(120.7342, device='cuda:3')
benign distance is  tensor(120.7342, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(146.5981, device='cuda:3')
compute distance is  tensor(146.5981, device='cuda:3')
compute norm is  tensor(79.6885, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1608, device='cuda:3')
compute distance is  tensor(125.1608, device='cuda:3')
compute norm is  tensor(79.1880, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.3574, device='cuda:3')
compute distance is  tensor(154.3574, device='cuda:3')
compute norm is  tensor(79.7140, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.0805, device='cuda:3')
compute distance is  tensor(140.0805, device='cuda:3')
compute norm is  tensor(79.4036, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5919, device='cuda:3')
compute distance is  tensor(136.5919, device='cuda:3')
compute norm is  tensor(79.5939, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5919, device='cuda:3')
compute distance is  tensor(139.5919, device='cuda:3')
compute norm is  tensor(79.6975, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3697, device='cuda:3')
compute distance is  tensor(148.3697, device='cuda:3')
compute norm is  tensor(79.6591, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.1760, device='cuda:3')
compute distance is  tensor(153.1760, device='cuda:3')
compute norm is  tensor(79.9395, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.8439, device='cuda:3')
compute distance is  tensor(135.8439, device='cuda:3')
compute norm is  tensor(79.4737, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3710, device='cuda:3')
compute distance is  tensor(132.3710, device='cuda:3')
compute norm is  tensor(79.4951, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2219, device='cuda:3')
compute distance is  tensor(139.2219, device='cuda:3')
compute norm is  tensor(79.6543, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8530, device='cuda:3')
compute distance is  tensor(122.8530, device='cuda:3')
compute norm is  tensor(79.2820, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.3574, device='cuda:3')
distance x is tensor(107317.7266, device='cuda:3')
distance x is tensor(107317.7266, device='cuda:3')
________________________________
test distance is  tensor(107317.7266, device='cuda:3')
test distance1 is  tensor(107317.7266, device='cuda:3')
test similarity is  tensor(0.7595, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130082084668265.34
test entropy is  0.0
________________________________
cal ratio is  0.037166708707123026
distance x is tensor(3988.6516, device='cuda:3')
cal_distance is  tensor(3988.6516, device='cuda:3')
cal ratio is  0.19278657562720863
distance x is tensor(768.9625, device='cuda:3')
cal_distance is  tensor(768.9625, device='cuda:3')
cal ratio is  0.4390735168296665
distance x is tensor(337.6339, device='cuda:3')
cal_distance is  tensor(337.6339, device='cuda:3')
cal ratio is  0.6626234210408772
distance x is tensor(223.7258, device='cuda:3')
cal_distance is  tensor(223.7258, device='cuda:3')
cal ratio is  0.8140138003669726
distance x is tensor(182.1169, device='cuda:3')
cal_distance is  tensor(182.1169, device='cuda:3')
cal ratio is  0.9022248097954472
distance x is tensor(164.3109, device='cuda:3')
cal_distance is  tensor(164.3109, device='cuda:3')
cal ratio is  0.9498536662911168
distance x is tensor(156.0715, device='cuda:3')
cal_distance is  tensor(156.0715, device='cuda:3')
cal ratio is  0.9746036232084823
distance x is tensor(152.1080, device='cuda:3')
cal_distance is  tensor(152.1080, device='cuda:3')
distance x is tensor(152.1080, device='cuda:3')
return_distance is  tensor(152.1080, device='cuda:3')
distance x is tensor(152.0980, device='cuda:3')
distance x is tensor(152.0980, device='cuda:3')
________________________________
test distance is  tensor(152.0980, device='cuda:3')
test distance1 is  tensor(152.0980, device='cuda:3')
test similarity is  tensor(0.9944, device='cuda:3')
test acc is  0.12906666682299858
test loss is 61.140968526095975
test entropy is  0.027575600715929335
________________________________
0
distance x is tensor(152.0980, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.027992534014943355
avg test loss is  60.99549339473375
avg accuracy is  0.697833333489664
solo acc is  0.12908333348966525
compute similarity  is  tensor(0.9944, device='cuda:3')
compute_distance is  tensor(152.0980, device='cuda:3')
compute_norm is  tensor(85.3611, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.2181, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9691954914059466
avg test loss is  1.4046036993770965
avg accuracy is  0.7621000001563274
solo acc is  0.2726833334896723
compute similarity  is  tensor(0.9945, device='cuda:3')
compute_distance is  tensor(151.2181, device='cuda:3')
compute_norm is  tensor(85.2161, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.2181, device='cuda:3')
distance x is tensor(151.2181, device='cuda:3')
________________________________
test distance is  tensor(151.2181, device='cuda:3')
test distance1 is  tensor(151.2181, device='cuda:3')
test similarity is  tensor(0.9945, device='cuda:3')
test acc is  0.2717000001563389
test loss is 1.406928693434831
test entropy is  0.9695536170178639
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3715227842330933
mal norm is  tensor(753.8398, device='cuda:3')
distance x is tensor(151.2277, device='cuda:3')
mal distance is  tensor(151.2277, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([514.6049, 596.4636, 544.0770, 516.2703, 508.7677, 565.0683, 521.2931,
        559.8718, 753.8398, 753.8398, 753.8398, 753.8398, 753.8398, 753.8398,
        753.8398, 753.8398, 753.8398, 753.8398, 753.8398, 753.8398, 671.1796,
        743.6652, 718.7383, 642.5887, 669.0695, 689.2497, 658.9182, 639.7298,
        874.0667, 841.6813, 855.6265, 856.0867, 845.1952, 866.9650, 873.1006,
        818.8072, 573.4050, 648.2501, 571.8660, 570.9929, 584.0016, 577.1209,
        576.8763, 607.6899], device='cuda:3')
sorted_norm is   tensor([508.7677, 514.6049, 516.2703, 521.2931, 544.0770, 559.8718, 565.0683,
        570.9929, 571.8660, 573.4050, 576.8763, 577.1209, 584.0016, 596.4636,
        607.6899, 639.7298, 642.5887, 648.2501, 658.9182, 669.0695, 671.1796,
        689.2497, 718.7383, 743.6652, 753.8398, 753.8398, 753.8398, 753.8398,
        753.8398, 753.8398, 753.8398, 753.8398, 753.8398, 753.8398, 753.8398,
        753.8398, 818.8072, 841.6813, 845.1952, 855.6265, 856.0867, 866.9650,
        873.1006, 874.0667], device='cuda:3')
used idx is  tensor([ 4,  0,  3,  6,  2,  7,  5, 39, 38, 36, 42, 41, 40,  1, 43, 27, 23, 37,
        26, 24, 20, 25, 22, 21, 11, 10,  8,  9, 13, 12, 14, 15, 19, 18, 16],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 86.22% 

Test Accuracy: 84.87% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9263900518417358
distance x is tensor(131.9963, device='cuda:3')
benign distance is  tensor(131.9963, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.23472878336906433
distance x is tensor(136.3163, device='cuda:3')
benign distance is  tensor(136.3163, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5332768559455872
distance x is tensor(122.1895, device='cuda:3')
benign distance is  tensor(122.1895, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9402259588241577
distance x is tensor(130.4384, device='cuda:3')
benign distance is  tensor(130.4384, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0296560525894165
distance x is tensor(113.7631, device='cuda:3')
benign distance is  tensor(113.7631, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6008239984512329
distance x is tensor(137.3792, device='cuda:3')
benign distance is  tensor(137.3792, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4728088974952698
distance x is tensor(144.2934, device='cuda:3')
benign distance is  tensor(144.2934, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6221866607666016
distance x is tensor(155.5281, device='cuda:3')
benign distance is  tensor(155.5281, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.14826492965221405
distance x is tensor(132.2775, device='cuda:3')
benign distance is  tensor(132.2775, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.20785996317863464
distance x is tensor(126.4260, device='cuda:3')
benign distance is  tensor(126.4260, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7652589082717896
distance x is tensor(169.6035, device='cuda:3')
benign distance is  tensor(169.6035, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5327175855636597
distance x is tensor(154.9315, device='cuda:3')
benign distance is  tensor(154.9315, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4695439338684082
distance x is tensor(120.0637, device='cuda:3')
benign distance is  tensor(120.0637, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6147114038467407
distance x is tensor(122.1736, device='cuda:3')
benign distance is  tensor(122.1736, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.45923909544944763
distance x is tensor(119.5455, device='cuda:3')
benign distance is  tensor(119.5455, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.37671995162963867
distance x is tensor(127.4520, device='cuda:3')
benign distance is  tensor(127.4520, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2676437199115753
distance x is tensor(141.3687, device='cuda:3')
benign distance is  tensor(141.3687, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.32026514410972595
distance x is tensor(115.8036, device='cuda:3')
benign distance is  tensor(115.8036, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.621888279914856
distance x is tensor(138.0607, device='cuda:3')
benign distance is  tensor(138.0607, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5434240698814392
distance x is tensor(123.3710, device='cuda:3')
benign distance is  tensor(123.3710, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8371020555496216
distance x is tensor(124.1444, device='cuda:3')
benign distance is  tensor(124.1444, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.47607970237731934
distance x is tensor(127.3836, device='cuda:3')
benign distance is  tensor(127.3836, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.19981810450553894
distance x is tensor(148.3169, device='cuda:3')
benign distance is  tensor(148.3169, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3169333040714264
distance x is tensor(118.7594, device='cuda:3')
benign distance is  tensor(118.7594, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.37245693802833557
distance x is tensor(135.4473, device='cuda:3')
benign distance is  tensor(135.4473, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1314639300107956
distance x is tensor(132.1005, device='cuda:3')
benign distance is  tensor(132.1005, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.19348694384098053
distance x is tensor(127.7238, device='cuda:3')
benign distance is  tensor(127.7238, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.26616814732551575
distance x is tensor(133.7902, device='cuda:3')
benign distance is  tensor(133.7902, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4789563715457916
distance x is tensor(123.5626, device='cuda:3')
benign distance is  tensor(123.5626, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4844103753566742
distance x is tensor(134.4936, device='cuda:3')
benign distance is  tensor(134.4936, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4270264208316803
distance x is tensor(136.0854, device='cuda:3')
benign distance is  tensor(136.0854, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.25582563877105713
distance x is tensor(120.6726, device='cuda:3')
benign distance is  tensor(120.6726, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(114.5138, device='cuda:3')
compute distance is  tensor(114.5138, device='cuda:3')
compute norm is  tensor(80.4103, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1883, device='cuda:3')
compute distance is  tensor(122.1883, device='cuda:3')
compute norm is  tensor(80.3834, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1912, device='cuda:3')
compute distance is  tensor(141.1912, device='cuda:3')
compute norm is  tensor(80.9376, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6616, device='cuda:3')
compute distance is  tensor(139.6616, device='cuda:3')
compute norm is  tensor(80.8802, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.3769, device='cuda:3')
compute distance is  tensor(171.3769, device='cuda:3')
compute norm is  tensor(81.7971, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7800, device='cuda:3')
compute distance is  tensor(123.7800, device='cuda:3')
compute norm is  tensor(80.7416, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2136, device='cuda:3')
compute distance is  tensor(129.2136, device='cuda:3')
compute norm is  tensor(80.6945, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3591, device='cuda:3')
compute distance is  tensor(131.3591, device='cuda:3')
compute norm is  tensor(80.5925, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0565, device='cuda:3')
compute distance is  tensor(129.0565, device='cuda:3')
compute norm is  tensor(80.6098, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0259, device='cuda:3')
compute distance is  tensor(126.0259, device='cuda:3')
compute norm is  tensor(80.6800, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2276, device='cuda:3')
compute distance is  tensor(151.2276, device='cuda:3')
compute norm is  tensor(81.0455, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5175, device='cuda:3')
compute distance is  tensor(125.5175, device='cuda:3')
compute norm is  tensor(80.5975, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(171.3769, device='cuda:3')
distance x is tensor(107308.8359, device='cuda:3')
distance x is tensor(107308.8359, device='cuda:3')
________________________________
test distance is  tensor(107308.8359, device='cuda:3')
test distance1 is  tensor(107308.8359, device='cuda:3')
test similarity is  tensor(0.7639, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130167896407784.53
test entropy is  0.0
________________________________
cal ratio is  0.03916376583546596
distance x is tensor(4202.6235, device='cuda:3')
cal_distance is  tensor(4202.6235, device='cuda:3')
cal ratio is  0.19789824921762147
distance x is tensor(831.6959, device='cuda:3')
cal_distance is  tensor(831.6959, device='cuda:3')
cal ratio is  0.44485645874971236
distance x is tensor(369.9881, device='cuda:3')
cal_distance is  tensor(369.9881, device='cuda:3')
cal ratio is  0.6669731123379044
distance x is tensor(246.7738, device='cuda:3')
cal_distance is  tensor(246.7738, device='cuda:3')
cal ratio is  0.8166814059675827
distance x is tensor(201.5365, device='cuda:3')
cal_distance is  tensor(201.5365, device='cuda:3')
cal ratio is  0.9037022225425746
distance x is tensor(182.1294, device='cuda:3')
cal_distance is  tensor(182.1294, device='cuda:3')
cal ratio is  0.9506312973395741
distance x is tensor(173.1382, device='cuda:3')
cal_distance is  tensor(173.1382, device='cuda:3')
cal ratio is  0.97500247638339
distance x is tensor(168.8103, device='cuda:3')
cal_distance is  tensor(168.8103, device='cuda:3')
distance x is tensor(168.8103, device='cuda:3')
return_distance is  tensor(168.8103, device='cuda:3')
distance x is tensor(168.8003, device='cuda:3')
distance x is tensor(168.8003, device='cuda:3')
________________________________
test distance is  tensor(168.8003, device='cuda:3')
test distance1 is  tensor(168.8003, device='cuda:3')
test similarity is  tensor(0.9936, device='cuda:3')
test acc is  0.47231666682300855
test loss is 11.175225419022127
test entropy is  0.16133051574516144
________________________________
0
distance x is tensor(168.8003, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.16226733811120234
avg test loss is  11.061541857749923
avg accuracy is  0.8434500001563235
solo acc is  0.4709166668230085
compute similarity  is  tensor(0.9936, device='cuda:3')
compute_distance is  tensor(168.8003, device='cuda:3')
compute_norm is  tensor(87.6249, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.8461, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9277640297722969
avg test loss is  1.3681448051797303
avg accuracy is  0.7811166668229931
solo acc is  0.2887000001563392
compute similarity  is  tensor(0.9937, device='cuda:3')
compute_distance is  tensor(165.8461, device='cuda:3')
compute_norm is  tensor(87.1377, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(165.8461, device='cuda:3')
distance x is tensor(165.8461, device='cuda:3')
________________________________
test distance is  tensor(165.8461, device='cuda:3')
test distance1 is  tensor(165.8461, device='cuda:3')
test similarity is  tensor(0.9937, device='cuda:3')
test acc is  0.29166666682300596
test loss is 1.3676127190274725
test entropy is  0.9283835505371663
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.0384190082550049
mal norm is  tensor(838.0776, device='cuda:3')
distance x is tensor(165.8553, device='cuda:3')
mal distance is  tensor(165.8553, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([550.8010, 544.1088, 509.7462, 520.2120, 462.1161, 544.0040, 579.4955,
        608.7810, 838.0776, 838.0776, 838.0776, 838.0776, 838.0776, 838.0776,
        838.0776, 838.0776, 838.0776, 838.0776, 838.0776, 838.0776],
       device='cuda:3')
sorted_norm is   tensor([462.1161, 509.7462, 520.2120, 544.0040, 544.1088, 550.8010, 579.4955,
        608.7810, 838.0776, 838.0776, 838.0776, 838.0776, 838.0776, 838.0776,
        838.0776, 838.0776, 838.0776, 838.0776, 838.0776, 838.0776],
       device='cuda:3')
used idx is  tensor([ 4,  2,  3,  5,  1,  0,  6,  7, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 85.23% 

Test Accuracy: 83.89% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2502114474773407
distance x is tensor(156.8947, device='cuda:3')
benign distance is  tensor(156.8947, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.63761967420578
distance x is tensor(147.2083, device='cuda:3')
benign distance is  tensor(147.2083, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27791744470596313
distance x is tensor(133.7736, device='cuda:3')
benign distance is  tensor(133.7736, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1750751733779907
distance x is tensor(126.1172, device='cuda:3')
benign distance is  tensor(126.1172, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6767998337745667
distance x is tensor(198.8137, device='cuda:3')
benign distance is  tensor(198.8137, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3279501795768738
distance x is tensor(147.5174, device='cuda:3')
benign distance is  tensor(147.5174, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4517124593257904
distance x is tensor(155.5514, device='cuda:3')
benign distance is  tensor(155.5514, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5113610029220581
distance x is tensor(150.0382, device='cuda:3')
benign distance is  tensor(150.0382, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(128.5937, device='cuda:3')
compute distance is  tensor(128.5937, device='cuda:3')
compute norm is  tensor(85.0291, device='cuda:3', dtype=torch.float64)
distance x is tensor(51364.1602, device='cuda:3')
compute distance is  tensor(51364.1602, device='cuda:3')
compute norm is  tensor(5225.7959, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.8873, device='cuda:3')
compute distance is  tensor(152.8873, device='cuda:3')
compute norm is  tensor(85.3798, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.5911, device='cuda:3')
compute distance is  tensor(179.5911, device='cuda:3')
compute norm is  tensor(85.6451, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.4640, device='cuda:3')
compute distance is  tensor(167.4640, device='cuda:3')
compute norm is  tensor(85.7834, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5825, device='cuda:3')
compute distance is  tensor(135.5825, device='cuda:3')
compute norm is  tensor(85.1546, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.4280, device='cuda:3')
compute distance is  tensor(142.4280, device='cuda:3')
compute norm is  tensor(85.2355, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5454, device='cuda:3')
compute distance is  tensor(132.5454, device='cuda:3')
compute norm is  tensor(84.9685, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9206, device='cuda:3')
compute distance is  tensor(141.9206, device='cuda:3')
compute norm is  tensor(85.0497, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8794, device='cuda:3')
compute distance is  tensor(140.8794, device='cuda:3')
compute norm is  tensor(85.1308, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5945, device='cuda:3')
compute distance is  tensor(158.5945, device='cuda:3')
compute norm is  tensor(85.4048, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7607, device='cuda:3')
compute distance is  tensor(144.7607, device='cuda:3')
compute norm is  tensor(85.3589, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(51364.1602, device='cuda:3')
distance x is tensor(107241.6953, device='cuda:3')
distance x is tensor(107241.6953, device='cuda:3')
________________________________
test distance is  tensor(107241.6953, device='cuda:3')
test distance1 is  tensor(107241.6953, device='cuda:3')
test similarity is  tensor(0.7937, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130071864329903.77
test entropy is  0.0
________________________________
cal ratio is  0.678225847559452
distance x is tensor(72734.0938, device='cuda:3')
cal_distance is  tensor(72734.0938, device='cuda:3')
cal ratio is  0.8235446450234045
distance x is tensor(59899.7734, device='cuda:3')
cal_distance is  tensor(59899.7734, device='cuda:3')
cal ratio is  0.9074936231804214
distance x is tensor(54358.6719, device='cuda:3')
cal_distance is  tensor(54358.6719, device='cuda:3')
cal ratio is  0.952624502780786
distance x is tensor(51783.3984, device='cuda:3')
cal_distance is  tensor(51783.3984, device='cuda:3')
cal ratio is  0.9760249080352377
distance x is tensor(50541.8945, device='cuda:3')
cal_distance is  tensor(50541.8945, device='cuda:3')
distance x is tensor(50541.8945, device='cuda:3')
return_distance is  tensor(50541.8945, device='cuda:3')
distance x is tensor(50541.8828, device='cuda:3')
distance x is tensor(50541.8828, device='cuda:3')
________________________________
test distance is  tensor(50541.8828, device='cuda:3')
test distance1 is  tensor(50541.8828, device='cuda:3')
test similarity is  tensor(0.7972, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6465508518756.98
test entropy is  0.0
________________________________
0
distance x is tensor(50541.8828, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  6473265270286.192
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7972, device='cuda:3')
compute_distance is  tensor(50541.8828, device='cuda:3')
compute_norm is  tensor(3980.5175, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.7157e+09, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.190598181824186
avg test loss is  596419498048.5697
avg accuracy is  0.10093333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0290, device='cuda:3')
compute_distance is  tensor(3.7157e+09, device='cuda:3')
compute_norm is  tensor(4.3045e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.6983e+09, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6424517717951143
avg test loss is  443360175848.22504
avg accuracy is  0.09883333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0290, device='cuda:3')
compute_distance is  tensor(3.6983e+09, device='cuda:3')
compute_norm is  tensor(4.2844e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.6810e+09, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2739818683311122
avg test loss is  525035199833.9997
avg accuracy is  0.10195000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0290, device='cuda:3')
compute_distance is  tensor(3.6810e+09, device='cuda:3')
compute_norm is  tensor(4.2643e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.6638e+09, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.68959860799155
avg test loss is  562064590201.2579
avg accuracy is  0.09908333348966533
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0290, device='cuda:3')
compute_distance is  tensor(3.6638e+09, device='cuda:3')
compute_norm is  tensor(4.2444e+08, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.6466e+09, device='cuda:3')
distance x is tensor(3.6466e+09, device='cuda:3')
________________________________
test distance is  tensor(3.6466e+09, device='cuda:3')
test distance1 is  tensor(3.6466e+09, device='cuda:3')
test similarity is  tensor(-0.0290, device='cuda:3')
test acc is  0.10000000015633198
test loss is 506980303479.8886
test entropy is  1.3495290237449125
________________________________
cal ratio is  0.003677985933754831
distance x is tensor(13412270., device='cuda:3')
cal_distance is  tensor(13412270., device='cuda:3')
cal ratio is  0.060646400620186856
distance x is tensor(813405.8750, device='cuda:3')
cal_distance is  tensor(813405.8750, device='cuda:3')
cal ratio is  0.24626490045623275
distance x is tensor(200313.3125, device='cuda:3')
cal_distance is  tensor(200313.3125, device='cuda:3')
cal ratio is  0.4962508401575352
distance x is tensor(99405.6562, device='cuda:3')
cal_distance is  tensor(99405.6562, device='cuda:3')
cal ratio is  0.7044507392300544
distance x is tensor(70026.3750, device='cuda:3')
cal_distance is  tensor(70026.3750, device='cuda:3')
cal ratio is  0.8393156901131404
distance x is tensor(58774.2383, device='cuda:3')
cal_distance is  tensor(58774.2383, device='cuda:3')
cal ratio is  0.9161417208751498
distance x is tensor(53845.5312, device='cuda:3')
cal_distance is  tensor(53845.5312, device='cuda:3')
cal ratio is  0.9571529347688852
distance x is tensor(51538.4141, device='cuda:3')
cal_distance is  tensor(51538.4141, device='cuda:3')
cal ratio is  0.9783418712468158
distance x is tensor(50422.1914, device='cuda:3')
cal_distance is  tensor(50422.1914, device='cuda:3')
distance x is tensor(50422.1914, device='cuda:3')
return_distance is  tensor(50422.1914, device='cuda:3')
distance x is tensor(50422.1992, device='cuda:3')
distance x is tensor(50422.1992, device='cuda:3')
________________________________
test distance is  tensor(50422.1992, device='cuda:3')
test distance1 is  tensor(50422.1992, device='cuda:3')
test similarity is  tensor(-0.0165, device='cuda:3')
test acc is  0.10140000015633197
test loss is 2.756092835845215
test entropy is  1.8972774798681995
________________________________
0
distance x is tensor(50422.1992, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8972170144510168
avg test loss is  2.7549628136254576
avg accuracy is  0.09990000015633196
solo acc is  0.10040000015633196
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(50422.1992, device='cuda:3')
compute_norm is  tensor(5815.6039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(50188.5586, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8072114241148617
avg test loss is  3.7191885160738978
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(50188.5586, device='cuda:3')
compute_norm is  tensor(5788.3969, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(49955.7969, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5389749012522098
avg test loss is  2.8974884003718526
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(49955.7969, device='cuda:3')
compute_norm is  tensor(5761.2353, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(49724.3008, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.819569246728283
avg test loss is  3.6694978503530216
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(49724.3008, device='cuda:3')
compute_norm is  tensor(5734.3336, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(49493.7031, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5474821499415807
avg test loss is  2.883721611901387
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(49493.7031, device='cuda:3')
compute_norm is  tensor(5707.4414, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(49264.4062, device='cuda:3')
distance x is tensor(49264.4062, device='cuda:3')
________________________________
test distance is  tensor(49264.4062, device='cuda:3')
test distance1 is  tensor(49264.4062, device='cuda:3')
test similarity is  tensor(-0.0165, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.6519977688026835
test entropy is  0.8256331986582863
________________________________
0
distance x is tensor(49264.4062, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8264169380354729
avg test loss is  3.65055808863406
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(49264.4062, device='cuda:3')
compute_norm is  tensor(5680.8015, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(49036., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.551290687340409
avg test loss is  2.8765809312303947
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(49036., device='cuda:3')
compute_norm is  tensor(5654.1644, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(48808.8516, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8285912559357788
avg test loss is  3.641113726569137
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(48808.8516, device='cuda:3')
compute_norm is  tensor(5627.7752, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(48582.6016, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5523022009111416
avg test loss is  2.8726776235901723
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(48582.6016, device='cuda:3')
compute_norm is  tensor(5601.3788, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(48357.6172, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8316732932255466
avg test loss is  3.631288362972772
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(48357.6172, device='cuda:3')
compute_norm is  tensor(5575.2513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(48133.4570, device='cuda:3')
________________________________
test distance is  tensor(48133.4570, device='cuda:3')
test similarity is  tensor(-0.0165, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8675168495950922
test entropy is  1.5549337239916137
________________________________
final entropy
distance x is tensor(48133.4688, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.554713636319012
avg test loss is  2.8669862597227604
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0165, device='cuda:3')
compute_distance is  tensor(48133.4688, device='cuda:3')
compute_norm is  tensor(5549.0919, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.647714614868164
mal norm is  tensor(351665.5000, device='cuda:3')
distance x is tensor(47910.5898, device='cuda:3')
mal distance is  tensor(47910.5898, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([   602.7811,    580.4767,    528.2298,    506.6374,    753.8563,
           581.7823,    594.7313,    583.9547, 351665.5000, 351665.5000,
        351665.5000, 351665.5000, 351665.5000, 351665.5000, 351665.5000,
        351665.5000, 351665.5000, 351665.5000, 351665.5000, 351665.5000,
          1264.1837,   1267.4130,   1267.0759,   1275.5125,   1245.5214,
          1264.7937,   1255.9098,   1275.3796,    771.7268,    801.5304,
           762.8184,    759.2157,    728.7394,    701.0320,    782.4144,
           725.7949,    698.7922,    673.3834,    806.2774,    738.2753,
           668.4135,    658.3120,    666.5396,    691.9905], device='cuda:3')
sorted_norm is   tensor([   506.6374,    528.2298,    580.4767,    581.7823,    583.9547,
           594.7313,    602.7811,    658.3120,    666.5396,    668.4135,
           673.3834,    691.9905,    698.7922,    701.0320,    725.7949,
           728.7394,    738.2753,    753.8563,    759.2157,    762.8184,
           771.7268,    782.4144,    801.5304,    806.2774,   1245.5214,
          1255.9098,   1264.1837,   1264.7937,   1267.0759,   1267.4130,
          1275.3796,   1275.5125, 351665.5000, 351665.5000, 351665.5000,
        351665.5000, 351665.5000, 351665.5000, 351665.5000, 351665.5000,
        351665.5000, 351665.5000, 351665.5000, 351665.5000], device='cuda:3')
used idx is  tensor([ 3,  2,  1,  5,  7,  6,  0, 41, 42, 40, 37, 43, 36, 33, 35, 32, 39,  4,
        31, 30, 28, 34, 29, 38, 24, 26, 20, 25, 22, 21, 27, 23, 11, 10,  8],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 10.08% 

Test Accuracy: 10.24% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.292827844619751
distance x is tensor(614275.4375, device='cuda:3')
benign distance is  tensor(614275.4375, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:3')
benign distance is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.343834638595581
distance x is tensor(448936.5000, device='cuda:3')
benign distance is  tensor(448936.5000, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.298476457595825
distance x is tensor(1.1509e+09, device='cuda:3')
benign distance is  tensor(1.1509e+09, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.312777042388916
distance x is tensor(825781., device='cuda:3')
benign distance is  tensor(825781., device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3175601959228516
distance x is tensor(815495.1250, device='cuda:3')
benign distance is  tensor(815495.1250, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.308107852935791
distance x is tensor(215217.4531, device='cuda:3')
benign distance is  tensor(215217.4531, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:3')
benign distance is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3145434856414795
distance x is tensor(558979.8125, device='cuda:3')
benign distance is  tensor(558979.8125, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.323915958404541
distance x is tensor(160104.6094, device='cuda:3')
benign distance is  tensor(160104.6094, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.31659197807312
distance x is tensor(1194618., device='cuda:3')
benign distance is  tensor(1194618., device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.2864978313446045
distance x is tensor(857922.3750, device='cuda:3')
benign distance is  tensor(857922.3750, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.330594062805176
distance x is tensor(1187174.6250, device='cuda:3')
benign distance is  tensor(1187174.6250, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.288942813873291
distance x is tensor(8963067., device='cuda:3')
benign distance is  tensor(8963067., device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2841508388519287
distance x is tensor(5987248., device='cuda:3')
benign distance is  tensor(5987248., device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2951271533966064
distance x is tensor(581276.8750, device='cuda:3')
benign distance is  tensor(581276.8750, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.3330235481262207
distance x is tensor(141662.1094, device='cuda:3')
benign distance is  tensor(141662.1094, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2926297187805176
distance x is tensor(69304488., device='cuda:3')
benign distance is  tensor(69304488., device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2993435859680176
distance x is tensor(320769.2188, device='cuda:3')
benign distance is  tensor(320769.2188, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.312971591949463
distance x is tensor(942761.4375, device='cuda:3')
benign distance is  tensor(942761.4375, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.307997226715088
distance x is tensor(826957.1875, device='cuda:3')
benign distance is  tensor(826957.1875, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.2900989055633545
distance x is tensor(545906.4375, device='cuda:3')
benign distance is  tensor(545906.4375, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:3')
benign distance is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3708574771881104
distance x is tensor(842924.2500, device='cuda:3')
benign distance is  tensor(842924.2500, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.3354651927948
distance x is tensor(471663.7812, device='cuda:3')
benign distance is  tensor(471663.7812, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.2834832668304443
distance x is tensor(212747.4531, device='cuda:3')
benign distance is  tensor(212747.4531, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.322204113006592
distance x is tensor(23441610., device='cuda:3')
benign distance is  tensor(23441610., device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:3')
benign distance is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.2769882678985596
distance x is tensor(1099010.8750, device='cuda:3')
benign distance is  tensor(1099010.8750, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.329989433288574
distance x is tensor(713126.3125, device='cuda:3')
benign distance is  tensor(713126.3125, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.2693960666656494
distance x is tensor(4021597.2500, device='cuda:3')
benign distance is  tensor(4021597.2500, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.3894553184509277
distance x is tensor(396651.1875, device='cuda:3')
benign distance is  tensor(396651.1875, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(476504.5938, device='cuda:3')
compute distance is  tensor(476504.5938, device='cuda:3')
compute norm is  tensor(24659.7665, device='cuda:3', dtype=torch.float64)
distance x is tensor(65968.9141, device='cuda:3')
compute distance is  tensor(65968.9141, device='cuda:3')
compute norm is  tensor(3714.8319, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.6046e+14, device='cuda:3')
compute distance is  tensor(4.6046e+14, device='cuda:3')
compute norm is  tensor(2.2014e+14, device='cuda:3', dtype=torch.float64)
distance x is tensor(152023.2344, device='cuda:3')
compute distance is  tensor(152023.2344, device='cuda:3')
compute norm is  tensor(7956.5132, device='cuda:3', dtype=torch.float64)
distance x is tensor(223738.5938, device='cuda:3')
compute distance is  tensor(223738.5938, device='cuda:3')
compute norm is  tensor(11514.8361, device='cuda:3', dtype=torch.float64)
distance x is tensor(773265.9375, device='cuda:3')
compute distance is  tensor(773265.9375, device='cuda:3')
compute norm is  tensor(38943.2859, device='cuda:3', dtype=torch.float64)
distance x is tensor(323338.5000, device='cuda:3')
compute distance is  tensor(323338.5000, device='cuda:3')
compute norm is  tensor(16506.5325, device='cuda:3', dtype=torch.float64)
distance x is tensor(452298.2500, device='cuda:3')
compute distance is  tensor(452298.2500, device='cuda:3')
compute norm is  tensor(23123.6053, device='cuda:3', dtype=torch.float64)
distance x is tensor(161805.3594, device='cuda:3')
compute distance is  tensor(161805.3594, device='cuda:3')
compute norm is  tensor(8375.1449, device='cuda:3', dtype=torch.float64)
distance x is tensor(363609.3125, device='cuda:3')
compute distance is  tensor(363609.3125, device='cuda:3')
compute norm is  tensor(18444.5115, device='cuda:3', dtype=torch.float64)
distance x is tensor(356460.0312, device='cuda:3')
compute distance is  tensor(356460.0312, device='cuda:3')
compute norm is  tensor(18595.2022, device='cuda:3', dtype=torch.float64)
distance x is tensor(nan, device='cuda:3')
compute distance is  tensor(nan, device='cuda:3')
compute norm is  tensor(nan, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(nan, device='cuda:3')
distance x is tensor(111355.8672, device='cuda:3')
distance x is tensor(111355.8672, device='cuda:3')
________________________________
test distance is  tensor(111355.8672, device='cuda:3')
test distance1 is  tensor(111355.8672, device='cuda:3')
test similarity is  tensor(-0.0361, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129995807307343.69
test entropy is  0.0
________________________________
0
distance x is tensor(111355.8672, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  130087913534566.62
avg accuracy is  0.09985000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0361, device='cuda:3')
compute_distance is  tensor(111355.8672, device='cuda:3')
compute_norm is  tensor(8403.6656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.4676e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.00016060716926871336
avg test loss is  43218.979072295275
avg accuracy is  0.09993333348966532
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.4676e+10, device='cuda:3')
compute_norm is  tensor(4.0213e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.4514e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.204789301606892
avg test loss is  23113.139758938156
avg accuracy is  0.09855000015633199
solo acc is  0.10060000015633198
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.4514e+10, device='cuda:3')
compute_norm is  tensor(4.0025e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.4352e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6345133848790167
avg test loss is  32880.924493129576
avg accuracy is  0.09955000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.4352e+10, device='cuda:3')
compute_norm is  tensor(3.9838e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.4192e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2923256052074148
avg test loss is  48585.70802644321
avg accuracy is  0.09790000015633199
solo acc is  0.10061666682299865
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.4192e+10, device='cuda:3')
compute_norm is  tensor(3.9652e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.4032e+10, device='cuda:3')
distance x is tensor(3.4032e+10, device='cuda:3')
________________________________
test distance is  tensor(3.4032e+10, device='cuda:3')
test distance1 is  tensor(3.4032e+10, device='cuda:3')
test similarity is  tensor(0.9856, device='cuda:3')
test acc is  0.10003333348966531
test loss is 34064.760590816106
test entropy is  0.6593308387471161
________________________________
0
distance x is tensor(3.4032e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6636705347724052
avg test loss is  38642.240594007315
avg accuracy is  0.09810000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.4032e+10, device='cuda:3')
compute_norm is  tensor(3.9466e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.3872e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.310873430547938
avg test loss is  64424.80328332743
avg accuracy is  0.09923333348966532
solo acc is  0.09975000015633198
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.3872e+10, device='cuda:3')
compute_norm is  tensor(3.9281e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.3714e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6794200820772887
avg test loss is  10058.13178744372
avg accuracy is  0.1014333334896653
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.3714e+10, device='cuda:3')
compute_norm is  tensor(3.9098e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.3556e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.356949259223206
avg test loss is  16919.20600285332
avg accuracy is  0.09941666682299866
solo acc is  0.10025000015633197
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.3556e+10, device='cuda:3')
compute_norm is  tensor(3.8915e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.3399e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6900926448388903
avg test loss is  11633.922487786584
avg accuracy is  0.09991666682299866
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.3399e+10, device='cuda:3')
compute_norm is  tensor(3.8733e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.3243e+10, device='cuda:3')
distance x is tensor(3.3243e+10, device='cuda:3')
________________________________
test distance is  tensor(3.3243e+10, device='cuda:3')
test distance1 is  tensor(3.3243e+10, device='cuda:3')
test similarity is  tensor(0.9856, device='cuda:3')
test acc is  0.10010000015633198
test loss is 39086.53767861435
test entropy is  1.3561337154303024
________________________________
0
distance x is tensor(3.3243e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3478051778604228
avg test loss is  30494.302247570267
avg accuracy is  0.09931666682299865
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.3243e+10, device='cuda:3')
compute_norm is  tensor(3.8551e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.3087e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6932771660879985
avg test loss is  22789.888251499327
avg accuracy is  0.09815000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.3087e+10, device='cuda:3')
compute_norm is  tensor(3.8371e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.2933e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.382793420286321
avg test loss is  22290.470338088107
avg accuracy is  0.10075000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.2933e+10, device='cuda:3')
compute_norm is  tensor(3.8191e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.2778e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7045174418990292
avg test loss is  52023.68369652671
avg accuracy is  0.10026666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.2778e+10, device='cuda:3')
compute_norm is  tensor(3.8013e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3.2625e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3753685488629697
avg test loss is  20758.7585252226
avg accuracy is  0.10196666682299865
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9856, device='cuda:3')
compute_distance is  tensor(3.2625e+10, device='cuda:3')
compute_norm is  tensor(3.7835e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(3.2472e+10, device='cuda:3')
________________________________
test distance is  tensor(3.2472e+10, device='cuda:3')
test similarity is  tensor(0.9856, device='cuda:3')
test acc is  0.09946666682299864
test loss is 23189.888467676097
test entropy is  0.7162182228143281
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.927428722381592
mal norm is  tensor(2.3869e+11, device='cuda:3')
distance x is tensor(3.2472e+10, device='cuda:3')
mal distance is  tensor(3.2472e+10, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([2.3690e+06,        nan, 1.6292e+06, 1.8043e+10, 3.0569e+06, 3.0125e+06,
        8.2275e+05,        nan, 2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11,
        2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11,
        2.3869e+11, 2.3869e+11], device='cuda:3')
sorted_norm is   tensor([8.2275e+05, 1.6292e+06, 2.3690e+06, 3.0125e+06, 3.0569e+06, 1.8043e+10,
        2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11,
        2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11, 2.3869e+11,
               nan,        nan], device='cuda:3')
used idx is  tensor([ 6,  2,  0,  5,  4,  3, 19, 17, 13, 15, 11,  9,  8, 10, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 9.73% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.542772054672241
distance x is tensor(33.4904, device='cuda:3')
benign distance is  tensor(33.4904, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3755898475646973
distance x is tensor(33.0025, device='cuda:3')
benign distance is  tensor(33.0025, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.359865188598633
distance x is tensor(32.5709, device='cuda:3')
benign distance is  tensor(32.5709, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.414728879928589
distance x is tensor(35.9240, device='cuda:3')
benign distance is  tensor(35.9240, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3392233848571777
distance x is tensor(39.8693, device='cuda:3')
benign distance is  tensor(39.8693, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.4175422191619873
distance x is tensor(34.7802, device='cuda:3')
benign distance is  tensor(34.7802, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.406135082244873
distance x is tensor(36.0317, device='cuda:3')
benign distance is  tensor(36.0317, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.335638999938965
distance x is tensor(21.2754, device='cuda:3')
benign distance is  tensor(21.2754, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(20.4844, device='cuda:3')
compute distance is  tensor(20.4844, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.2977e+14, device='cuda:3')
compute distance is  tensor(3.2977e+14, device='cuda:3')
compute norm is  tensor(1.8089e+14, device='cuda:3', dtype=torch.float64)
distance x is tensor(51.6294, device='cuda:3')
compute distance is  tensor(51.6294, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(44.0686, device='cuda:3')
compute distance is  tensor(44.0686, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(46.0763, device='cuda:3')
compute distance is  tensor(46.0763, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(42.5024, device='cuda:3')
compute distance is  tensor(42.5024, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(28.8681, device='cuda:3')
compute distance is  tensor(28.8681, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(37.4451, device='cuda:3')
compute distance is  tensor(37.4451, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(40.3168, device='cuda:3')
compute distance is  tensor(40.3168, device='cuda:3')
compute norm is  tensor(2.3546e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.1020e+14, device='cuda:3')
compute distance is  tensor(5.1020e+14, device='cuda:3')
compute norm is  tensor(2.7820e+14, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.3425e+14, device='cuda:3')
compute distance is  tensor(8.3425e+14, device='cuda:3')
compute norm is  tensor(4.6224e+14, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.8022e+15, device='cuda:3')
compute distance is  tensor(1.8022e+15, device='cuda:3')
compute norm is  tensor(8.7432e+14, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(1.8022e+15, device='cuda:3')
distance x is tensor(2.0334e+10, device='cuda:3')
distance x is tensor(2.0334e+10, device='cuda:3')
________________________________
test distance is  tensor(2.0334e+10, device='cuda:3')
test distance1 is  tensor(2.0334e+10, device='cuda:3')
test similarity is  tensor(-0.1417, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130126989960058.81
test entropy is  0.0
________________________________
0
distance x is tensor(2.0334e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  130217770483153.06
avg accuracy is  0.10070000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1417, device='cuda:3')
compute_distance is  tensor(2.0334e+10, device='cuda:3')
compute_norm is  tensor(8403.6656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4269e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.0001595316999518662
avg test loss is  24539.764017656158
avg accuracy is  0.10201666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.4269e+10, device='cuda:3')
compute_norm is  tensor(3.9986e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4109e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1971241694523582
avg test loss is  32110.273081322975
avg accuracy is  0.10063333348966531
solo acc is  0.09918333348966532
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.4109e+10, device='cuda:3')
compute_norm is  tensor(3.9799e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3949e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6358654880638062
avg test loss is  19706.406782333022
avg accuracy is  0.10121666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.3949e+10, device='cuda:3')
compute_norm is  tensor(3.9613e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3791e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.289675305138773
avg test loss is  25609.55630960851
avg accuracy is  0.10005000015633199
solo acc is  0.10025000015633197
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.3791e+10, device='cuda:3')
compute_norm is  tensor(3.9428e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3632e+10, device='cuda:3')
distance x is tensor(1.3632e+10, device='cuda:3')
________________________________
test distance is  tensor(1.3632e+10, device='cuda:3')
test distance1 is  tensor(1.3632e+10, device='cuda:3')
test similarity is  tensor(0.9948, device='cuda:3')
test acc is  0.10003333348966531
test loss is 28589.554176250756
test entropy is  0.6679633372246838
________________________________
0
distance x is tensor(1.3632e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6706602358932434
avg test loss is  19689.448114433522
avg accuracy is  0.10056666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.3632e+10, device='cuda:3')
compute_norm is  tensor(3.9243e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3475e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3142299978717813
avg test loss is  19571.069002776767
avg accuracy is  0.09963333348966531
solo acc is  0.10046666682299864
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.3475e+10, device='cuda:3')
compute_norm is  tensor(3.9059e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3318e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6774033425268589
avg test loss is  32456.824415700776
avg accuracy is  0.10071666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.3318e+10, device='cuda:3')
compute_norm is  tensor(3.8877e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3162e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3546236003639855
avg test loss is  30659.40358874183
avg accuracy is  0.10018333348966531
solo acc is  0.09991666682299866
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.3162e+10, device='cuda:3')
compute_norm is  tensor(3.8695e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3007e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6911024920213451
avg test loss is  29013.17006715986
avg accuracy is  0.10041666682299864
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.3007e+10, device='cuda:3')
compute_norm is  tensor(3.8514e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2853e+10, device='cuda:3')
distance x is tensor(1.2853e+10, device='cuda:3')
________________________________
test distance is  tensor(1.2853e+10, device='cuda:3')
test distance1 is  tensor(1.2853e+10, device='cuda:3')
test similarity is  tensor(0.9948, device='cuda:3')
test acc is  0.09993333348966532
test loss is 38432.17305144089
test entropy is  1.3559006495770616
________________________________
0
distance x is tensor(1.2853e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3511287026059653
avg test loss is  38868.483047284804
avg accuracy is  0.10033333348966532
solo acc is  0.09988333348966531
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.2853e+10, device='cuda:3')
compute_norm is  tensor(3.8334e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2699e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6985552797058244
avg test loss is  16277.476188931383
avg accuracy is  0.09955000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.2699e+10, device='cuda:3')
compute_norm is  tensor(3.8154e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2546e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3686920596338283
avg test loss is  16256.391414141859
avg accuracy is  0.1018333334896653
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.2546e+10, device='cuda:3')
compute_norm is  tensor(3.7976e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2394e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7033052483855534
avg test loss is  21117.425097587013
avg accuracy is  0.09928333348966534
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.2394e+10, device='cuda:3')
compute_norm is  tensor(3.7798e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.2243e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3771753255238157
avg test loss is  24463.995183328574
avg accuracy is  0.10150000015633198
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9948, device='cuda:3')
compute_distance is  tensor(1.2243e+10, device='cuda:3')
compute_norm is  tensor(3.7621e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.2092e+10, device='cuda:3')
________________________________
test distance is  tensor(1.2092e+10, device='cuda:3')
test similarity is  tensor(0.9948, device='cuda:3')
test acc is  0.1018333334896653
test loss is 25084.52990611123
test entropy is  0.7097715575939049
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.9246559143066406
mal norm is  tensor(9.0216e+10, device='cuda:3')
distance x is tensor(1.2092e+10, device='cuda:3')
mal distance is  tensor(1.2092e+10, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([2.4859e+03, 2.3951e+03, 2.3645e+03, 2.6803e+03, 3.0487e+03, 2.5973e+03,
        2.7299e+03, 1.2620e+03, 9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10,
        9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10,
        9.0216e+10, 9.0216e+10, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11,
        1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11,
        1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11],
       device='cuda:3')
sorted_norm is   tensor([1.2620e+03, 2.3645e+03, 2.3951e+03, 2.4859e+03, 2.5973e+03, 2.6803e+03,
        2.7299e+03, 3.0487e+03, 9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10,
        9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10, 9.0216e+10,
        9.0216e+10, 9.0216e+10, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11,
        1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11,
        1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11, 1.4920e+11],
       device='cuda:3')
used idx is  tensor([ 7,  2,  1,  0,  5,  3,  6,  4, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 33, 30, 32, 31, 28, 35, 29, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.38163685798645
distance x is tensor(13.5943, device='cuda:3')
benign distance is  tensor(13.5943, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3312478065490723
distance x is tensor(11.3557, device='cuda:3')
benign distance is  tensor(11.3557, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3157875537872314
distance x is tensor(13.0531, device='cuda:3')
benign distance is  tensor(13.0531, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2335591316223145
distance x is tensor(12.8734, device='cuda:3')
benign distance is  tensor(12.8734, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3516101837158203
distance x is tensor(15.4802, device='cuda:3')
benign distance is  tensor(15.4802, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.394941806793213
distance x is tensor(20.5338, device='cuda:3')
benign distance is  tensor(20.5338, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3666346073150635
distance x is tensor(17.3564, device='cuda:3')
benign distance is  tensor(17.3564, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2286429405212402
distance x is tensor(11.7152, device='cuda:3')
benign distance is  tensor(11.7152, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.501990556716919
distance x is tensor(12.1626, device='cuda:3')
benign distance is  tensor(12.1626, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3203365802764893
distance x is tensor(16.3346, device='cuda:3')
benign distance is  tensor(16.3346, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2772464752197266
distance x is tensor(1.4218e+14, device='cuda:3')
benign distance is  tensor(1.4218e+14, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3417603969573975
distance x is tensor(16.5003, device='cuda:3')
benign distance is  tensor(16.5003, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.4620137214660645
distance x is tensor(13.8556, device='cuda:3')
benign distance is  tensor(13.8556, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.3520350456237793
distance x is tensor(1.3641e+15, device='cuda:3')
benign distance is  tensor(1.3641e+15, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.390746593475342
distance x is tensor(2.8976e+14, device='cuda:3')
benign distance is  tensor(2.8976e+14, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2453153133392334
distance x is tensor(14.2761, device='cuda:3')
benign distance is  tensor(14.2761, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.5623669624328613
distance x is tensor(1.5865e+14, device='cuda:3')
benign distance is  tensor(1.5865e+14, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.441046953201294
distance x is tensor(17.9945, device='cuda:3')
benign distance is  tensor(17.9945, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.3552098274230957
distance x is tensor(16.3818, device='cuda:3')
benign distance is  tensor(16.3818, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.4030604362487793
distance x is tensor(15.0136, device='cuda:3')
benign distance is  tensor(15.0136, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.4492902755737305
distance x is tensor(13.8490, device='cuda:3')
benign distance is  tensor(13.8490, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.3383567333221436
distance x is tensor(15.2408, device='cuda:3')
benign distance is  tensor(15.2408, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.2809038162231445
distance x is tensor(14.8248, device='cuda:3')
benign distance is  tensor(14.8248, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.3373162746429443
distance x is tensor(18.5972, device='cuda:3')
benign distance is  tensor(18.5972, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(11.1394, device='cuda:3')
compute distance is  tensor(11.1394, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.8735e+14, device='cuda:3')
compute distance is  tensor(3.8735e+14, device='cuda:3')
compute norm is  tensor(1.8639e+14, device='cuda:3', dtype=torch.float64)
distance x is tensor(16.5622, device='cuda:3')
compute distance is  tensor(16.5622, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.0273, device='cuda:3')
compute distance is  tensor(13.0273, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.0671, device='cuda:3')
compute distance is  tensor(13.0671, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.9766, device='cuda:3')
compute distance is  tensor(11.9766, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(14.9063, device='cuda:3')
compute distance is  tensor(14.9063, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(14.6404, device='cuda:3')
compute distance is  tensor(14.6404, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.6273, device='cuda:3')
compute distance is  tensor(13.6273, device='cuda:3')
compute norm is  tensor(2.2756e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.5323e+13, device='cuda:3')
compute distance is  tensor(5.5323e+13, device='cuda:3')
compute norm is  tensor(2.8669e+13, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.6797e+14, device='cuda:3')
compute distance is  tensor(2.6797e+14, device='cuda:3')
compute norm is  tensor(1.3523e+14, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.0346e+14, device='cuda:3')
compute distance is  tensor(7.0346e+14, device='cuda:3')
compute norm is  tensor(3.2922e+14, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(7.0346e+14, device='cuda:3')
distance x is tensor(1.9628e+10, device='cuda:3')
distance x is tensor(1.9628e+10, device='cuda:3')
________________________________
test distance is  tensor(1.9628e+10, device='cuda:3')
test distance1 is  tensor(1.9628e+10, device='cuda:3')
test similarity is  tensor(-0.1416, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129959735532781.98
test entropy is  0.0
________________________________
0
distance x is tensor(1.9628e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  130200554993685.83
avg accuracy is  0.0993833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1416, device='cuda:3')
compute_distance is  tensor(1.9628e+10, device='cuda:3')
compute_norm is  tensor(8403.6656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.5626e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.0001589504280264106
avg test loss is  32391.968575658575
avg accuracy is  0.09900000015633198
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.5626e+10, device='cuda:3')
compute_norm is  tensor(4.0804e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.5461e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2010045834441683
avg test loss is  21559.706253999586
avg accuracy is  0.10015000015633198
solo acc is  0.10031666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.5461e+10, device='cuda:3')
compute_norm is  tensor(4.0613e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.5298e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6347342128756204
avg test loss is  32213.233132049474
avg accuracy is  0.09876666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.5298e+10, device='cuda:3')
compute_norm is  tensor(4.0423e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.5135e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2821621275913995
avg test loss is  44294.52108539981
avg accuracy is  0.09985000015633198
solo acc is  0.09963333348966531
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.5135e+10, device='cuda:3')
compute_norm is  tensor(4.0234e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.4973e+10, device='cuda:3')
distance x is tensor(1.4973e+10, device='cuda:3')
________________________________
test distance is  tensor(1.4973e+10, device='cuda:3')
test distance1 is  tensor(1.4973e+10, device='cuda:3')
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.10003333348966531
test loss is 28640.060176869447
test entropy is  0.6633754303968792
________________________________
0
distance x is tensor(1.4973e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6647986034785253
avg test loss is  27601.02026286664
avg accuracy is  0.10026666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.4973e+10, device='cuda:3')
compute_norm is  tensor(4.0046e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4812e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3143522452189724
avg test loss is  18926.278492515783
avg accuracy is  0.09936666682299865
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.4812e+10, device='cuda:3')
compute_norm is  tensor(3.9859e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.4652e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6774646767865874
avg test loss is  13815.19040311425
avg accuracy is  0.09986666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.4652e+10, device='cuda:3')
compute_norm is  tensor(3.9672e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4492e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3508898153233884
avg test loss is  13997.443443849652
avg accuracy is  0.09985000015633198
solo acc is  0.1002333334896653
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.4492e+10, device='cuda:3')
compute_norm is  tensor(3.9487e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.4334e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6935935410609377
avg test loss is  18877.44192208817
avg accuracy is  0.10015000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.4334e+10, device='cuda:3')
compute_norm is  tensor(3.9302e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.4175e+10, device='cuda:3')
distance x is tensor(1.4175e+10, device='cuda:3')
________________________________
test distance is  tensor(1.4175e+10, device='cuda:3')
test distance1 is  tensor(1.4175e+10, device='cuda:3')
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.10015000015633198
test loss is 26792.698121497626
test entropy is  1.34940738184874
________________________________
0
distance x is tensor(1.4175e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3508791678241576
avg test loss is  21370.79596778655
avg accuracy is  0.10045000015633199
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.4175e+10, device='cuda:3')
compute_norm is  tensor(3.9118e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.4018e+10, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7054692025759073
avg test loss is  19956.711235054012
avg accuracy is  0.09900000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.4018e+10, device='cuda:3')
compute_norm is  tensor(3.8935e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3861e+10, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3707434682449553
avg test loss is  31249.93351875973
avg accuracy is  0.10001666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.3861e+10, device='cuda:3')
compute_norm is  tensor(3.8753e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3706e+10, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7060734301106508
avg test loss is  11110.401647302642
avg accuracy is  0.09895000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.3706e+10, device='cuda:3')
compute_norm is  tensor(3.8571e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1.3551e+10, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.380907841836974
avg test loss is  20710.885129907492
avg accuracy is  0.10098333348966532
solo acc is  0.10018333348966531
compute similarity  is  tensor(0.9963, device='cuda:3')
compute_distance is  tensor(1.3551e+10, device='cuda:3')
compute_norm is  tensor(3.8391e+09, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1.3396e+10, device='cuda:3')
________________________________
test distance is  tensor(1.3396e+10, device='cuda:3')
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.10118333348966532
test loss is 19097.396822259878
test entropy is  0.711600359568972
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.9620888233184814
mal norm is  tensor(9.9334e+10, device='cuda:3')
distance x is tensor(1.3396e+10, device='cuda:3')
mal distance is  tensor(1.3396e+10, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([7.9143e+02, 5.8648e+02, 7.6622e+02, 7.2969e+02, 9.5288e+02, 1.4011e+03,
        1.1377e+03, 6.1145e+02, 9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10,
        9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10,
        9.9334e+10, 9.9334e+10, 1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11,
        1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4420e+11,
        1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11,        nan, 1.4421e+11],
       device='cuda:3')
sorted_norm is   tensor([5.8648e+02, 6.1145e+02, 7.2969e+02, 7.6622e+02, 7.9143e+02, 9.5288e+02,
        1.1377e+03, 1.4011e+03, 9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10,
        9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10, 9.9334e+10,
        9.9334e+10, 9.9334e+10, 1.4420e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11,
        1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11,
        1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11, 1.4421e+11,        nan],
       device='cuda:3')
used idx is  tensor([ 1,  7,  3,  2,  0,  4,  6,  5, 11,  9, 19, 17, 13, 15, 16, 18, 14, 12,
         8, 10, 29, 31, 33, 35, 28, 32, 30, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.4444832801818848
distance x is tensor(8.4384, device='cuda:3')
benign distance is  tensor(8.4384, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3525469303131104
distance x is tensor(8.2978, device='cuda:3')
benign distance is  tensor(8.2978, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.465668201446533
distance x is tensor(8.7549, device='cuda:3')
benign distance is  tensor(8.7549, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3155980110168457
distance x is tensor(9.1859, device='cuda:3')
benign distance is  tensor(9.1859, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4602210521698
distance x is tensor(8.5818, device='cuda:3')
benign distance is  tensor(8.5818, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.404789447784424
distance x is tensor(9.1374, device='cuda:3')
benign distance is  tensor(9.1374, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3823370933532715
distance x is tensor(9.0111, device='cuda:3')
benign distance is  tensor(9.0111, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3520827293395996
distance x is tensor(8.9402, device='cuda:3')
benign distance is  tensor(8.9402, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.2923083305358887
distance x is tensor(8.8332, device='cuda:3')
benign distance is  tensor(8.8332, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.471189022064209
distance x is tensor(9.6028, device='cuda:3')
benign distance is  tensor(9.6028, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.318248987197876
distance x is tensor(2.3404e+14, device='cuda:3')
benign distance is  tensor(2.3404e+14, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.516899824142456
distance x is tensor(8.9288, device='cuda:3')
benign distance is  tensor(8.9288, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.416686773300171
distance x is tensor(6.2069e+13, device='cuda:3')
benign distance is  tensor(6.2069e+13, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.42399263381958
distance x is tensor(8.9316, device='cuda:3')
benign distance is  tensor(8.9316, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.1707301139831543
distance x is tensor(9.1757, device='cuda:3')
benign distance is  tensor(9.1757, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.5055739879608154
distance x is tensor(9.4595, device='cuda:3')
benign distance is  tensor(9.4595, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.396340847015381
distance x is tensor(9.3765, device='cuda:3')
benign distance is  tensor(9.3765, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.389003276824951
distance x is tensor(8.6470, device='cuda:3')
benign distance is  tensor(8.6470, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.423783779144287
distance x is tensor(9.1577, device='cuda:3')
benign distance is  tensor(9.1577, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.302013397216797
distance x is tensor(1.1638e+13, device='cuda:3')
benign distance is  tensor(1.1638e+13, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.5657360553741455
distance x is tensor(9.2942, device='cuda:3')
benign distance is  tensor(9.2942, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.296323537826538
distance x is tensor(2.3073e+13, device='cuda:3')
benign distance is  tensor(2.3073e+13, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.3965022563934326
distance x is tensor(8.9615, device='cuda:3')
benign distance is  tensor(8.9615, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.531418800354004
distance x is tensor(8.7844e+13, device='cuda:3')
benign distance is  tensor(8.7844e+13, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(8.7366, device='cuda:3')
compute distance is  tensor(8.7366, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.6822e+12, device='cuda:3')
compute distance is  tensor(7.6822e+12, device='cuda:3')
compute norm is  tensor(2.5370e+12, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.8842, device='cuda:3')
compute distance is  tensor(8.8842, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.6619, device='cuda:3')
compute distance is  tensor(9.6619, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.5635, device='cuda:3')
compute distance is  tensor(8.5635, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.6819, device='cuda:3')
compute distance is  tensor(9.6819, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.3127, device='cuda:3')
compute distance is  tensor(9.3127, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.0314, device='cuda:3')
compute distance is  tensor(9.0314, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.1421, device='cuda:3')
compute distance is  tensor(9.1421, device='cuda:3')
compute norm is  tensor(2.2864e+09, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.0696e+13, device='cuda:3')
compute distance is  tensor(7.0696e+13, device='cuda:3')
compute norm is  tensor(2.3025e+13, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.0513e+14, device='cuda:3')
compute distance is  tensor(1.0513e+14, device='cuda:3')
compute norm is  tensor(5.1421e+13, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4974e+14, device='cuda:3')
compute distance is  tensor(2.4974e+14, device='cuda:3')
compute norm is  tensor(8.7574e+13, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(2.4974e+14, device='cuda:3')
distance x is tensor(1.9721e+10, device='cuda:3')
distance x is tensor(1.9721e+10, device='cuda:3')
________________________________
test distance is  tensor(1.9721e+10, device='cuda:3')
test distance1 is  tensor(1.9721e+10, device='cuda:3')
test similarity is  tensor(-0.1416, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130101095310901.5
test entropy is  0.0
________________________________
0
distance x is tensor(1.9721e+10, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  130154614227502.94
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1416, device='cuda:3')
compute_distance is  tensor(1.9721e+10, device='cuda:3')
compute_norm is  tensor(8403.6656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
