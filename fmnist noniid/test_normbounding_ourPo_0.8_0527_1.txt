
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6742269992828369
distance x is tensor(121.1769, device='cuda:3')
benign distance is  tensor(121.1769, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8265829086303711
distance x is tensor(120.5505, device='cuda:3')
benign distance is  tensor(120.5505, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5763016939163208
distance x is tensor(121.4377, device='cuda:3')
benign distance is  tensor(121.4377, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.35636305809020996
distance x is tensor(111.4790, device='cuda:3')
benign distance is  tensor(111.4790, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9596107602119446
distance x is tensor(104.4380, device='cuda:3')
benign distance is  tensor(104.4380, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42050305008888245
distance x is tensor(126.0516, device='cuda:3')
benign distance is  tensor(126.0516, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9322006106376648
distance x is tensor(114.1095, device='cuda:3')
benign distance is  tensor(114.1095, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40069371461868286
distance x is tensor(123.6817, device='cuda:3')
benign distance is  tensor(123.6817, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1631319522857666
distance x is tensor(137.1248, device='cuda:3')
benign distance is  tensor(137.1248, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5543781518936157
distance x is tensor(134.5680, device='cuda:3')
benign distance is  tensor(134.5680, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6279360055923462
distance x is tensor(122.5989, device='cuda:3')
benign distance is  tensor(122.5989, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.28195783495903015
distance x is tensor(129.6927, device='cuda:3')
benign distance is  tensor(129.6927, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.37779566645622253
distance x is tensor(123.3467, device='cuda:3')
benign distance is  tensor(123.3467, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2463618814945221
distance x is tensor(141.9298, device='cuda:3')
benign distance is  tensor(141.9298, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6552296876907349
distance x is tensor(137.8250, device='cuda:3')
benign distance is  tensor(137.8250, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.39976638555526733
distance x is tensor(135.0319, device='cuda:3')
benign distance is  tensor(135.0319, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.24379225075244904
distance x is tensor(126.4940, device='cuda:3')
benign distance is  tensor(126.4940, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6618297100067139
distance x is tensor(142.9852, device='cuda:3')
benign distance is  tensor(142.9852, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4319881498813629
distance x is tensor(127.6376, device='cuda:3')
benign distance is  tensor(127.6376, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.261164128780365
distance x is tensor(127.3672, device='cuda:3')
benign distance is  tensor(127.3672, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.22668664157390594
distance x is tensor(128.0496, device='cuda:3')
benign distance is  tensor(128.0496, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.137197807431221
distance x is tensor(124.1865, device='cuda:3')
benign distance is  tensor(124.1865, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.37786486744880676
distance x is tensor(134.5914, device='cuda:3')
benign distance is  tensor(134.5914, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2688435316085815
distance x is tensor(135.3396, device='cuda:3')
benign distance is  tensor(135.3396, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.39225295186042786
distance x is tensor(148.6073, device='cuda:3')
benign distance is  tensor(148.6073, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8524934649467468
distance x is tensor(123.6640, device='cuda:3')
benign distance is  tensor(123.6640, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7014784216880798
distance x is tensor(138.2758, device='cuda:3')
benign distance is  tensor(138.2758, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.32378828525543213
distance x is tensor(133.7241, device='cuda:3')
benign distance is  tensor(133.7241, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6743609309196472
distance x is tensor(125.5493, device='cuda:3')
benign distance is  tensor(125.5493, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8590054512023926
distance x is tensor(135.8287, device='cuda:3')
benign distance is  tensor(135.8287, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2674487829208374
distance x is tensor(124.4148, device='cuda:3')
benign distance is  tensor(124.4148, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7154069542884827
distance x is tensor(129.5666, device='cuda:3')
benign distance is  tensor(129.5666, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6309938430786133
distance x is tensor(135.9418, device='cuda:3')
benign distance is  tensor(135.9418, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.18974170088768005
distance x is tensor(128.3020, device='cuda:3')
benign distance is  tensor(128.3020, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4835459589958191
distance x is tensor(139.1397, device='cuda:3')
benign distance is  tensor(139.1397, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.03984186425805092
distance x is tensor(122.7007, device='cuda:3')
benign distance is  tensor(122.7007, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2688080370426178
distance x is tensor(127.9458, device='cuda:3')
benign distance is  tensor(127.9458, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.295185387134552
distance x is tensor(124.9955, device='cuda:3')
benign distance is  tensor(124.9955, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.44129520654678345
distance x is tensor(128.7533, device='cuda:3')
benign distance is  tensor(128.7533, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.19716408848762512
distance x is tensor(124.4784, device='cuda:3')
benign distance is  tensor(124.4784, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.18038655817508698
distance x is tensor(122.3313, device='cuda:3')
benign distance is  tensor(122.3313, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4477296769618988
distance x is tensor(125.6728, device='cuda:3')
benign distance is  tensor(125.6728, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.17917674779891968
distance x is tensor(130.3584, device='cuda:3')
benign distance is  tensor(130.3584, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2512860894203186
distance x is tensor(144.4790, device='cuda:3')
benign distance is  tensor(144.4790, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4249088764190674
distance x is tensor(132.9388, device='cuda:3')
benign distance is  tensor(132.9388, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6190294027328491
distance x is tensor(132.6629, device='cuda:3')
benign distance is  tensor(132.6629, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0662143230438232
distance x is tensor(137.6837, device='cuda:3')
benign distance is  tensor(137.6837, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2042653113603592
distance x is tensor(135.0477, device='cuda:3')
benign distance is  tensor(135.0477, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(109.7771, device='cuda:3')
compute distance is  tensor(109.7771, device='cuda:3')
compute norm is  tensor(45.4616, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.2395, device='cuda:3')
compute distance is  tensor(110.2395, device='cuda:3')
compute norm is  tensor(45.4785, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4723, device='cuda:3')
compute distance is  tensor(122.4723, device='cuda:3')
compute norm is  tensor(45.9895, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.1013, device='cuda:3')
compute distance is  tensor(112.1013, device='cuda:3')
compute norm is  tensor(45.6914, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.0204, device='cuda:3')
compute distance is  tensor(121.0204, device='cuda:3')
compute norm is  tensor(45.8247, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9892, device='cuda:3')
compute distance is  tensor(125.9892, device='cuda:3')
compute norm is  tensor(45.9053, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.6690, device='cuda:3')
compute distance is  tensor(121.6690, device='cuda:3')
compute norm is  tensor(45.7897, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7164, device='cuda:3')
compute distance is  tensor(125.7164, device='cuda:3')
compute norm is  tensor(45.8043, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0189, device='cuda:3')
compute distance is  tensor(124.0189, device='cuda:3')
compute norm is  tensor(45.8174, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5597, device='cuda:3')
compute distance is  tensor(124.5597, device='cuda:3')
compute norm is  tensor(45.9491, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3858, device='cuda:3')
compute distance is  tensor(127.3858, device='cuda:3')
compute norm is  tensor(46.1468, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8022, device='cuda:3')
compute distance is  tensor(133.8022, device='cuda:3')
compute norm is  tensor(45.9695, device='cuda:3', dtype=torch.float64)
batch acc is 0.1023166668229986
mal_rand_acc is 0.10000000049999999
mal_rand loss is 119521490763776.0
len of model dicts is  12
distance x is tensor(109.7771, device='cuda:3')
compute distance is  tensor(109.7771, device='cuda:3')
compute norm is  tensor(45.4616, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.2395, device='cuda:3')
compute distance is  tensor(110.2395, device='cuda:3')
compute norm is  tensor(45.4785, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4723, device='cuda:3')
compute distance is  tensor(122.4723, device='cuda:3')
compute norm is  tensor(45.9895, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.1013, device='cuda:3')
compute distance is  tensor(112.1013, device='cuda:3')
compute norm is  tensor(45.6914, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.0204, device='cuda:3')
compute distance is  tensor(121.0204, device='cuda:3')
compute norm is  tensor(45.8247, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9892, device='cuda:3')
compute distance is  tensor(125.9892, device='cuda:3')
compute norm is  tensor(45.9053, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.6690, device='cuda:3')
compute distance is  tensor(121.6690, device='cuda:3')
compute norm is  tensor(45.7897, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7164, device='cuda:3')
compute distance is  tensor(125.7164, device='cuda:3')
compute norm is  tensor(45.8043, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0189, device='cuda:3')
compute distance is  tensor(124.0189, device='cuda:3')
compute norm is  tensor(45.8174, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5597, device='cuda:3')
compute distance is  tensor(124.5597, device='cuda:3')
compute norm is  tensor(45.9491, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3858, device='cuda:3')
compute distance is  tensor(127.3858, device='cuda:3')
compute norm is  tensor(46.1468, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8022, device='cuda:3')
compute distance is  tensor(133.8022, device='cuda:3')
compute norm is  tensor(45.9695, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(133.8022, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
________________________________
test distance is  tensor(107710.2031, device='cuda:3')
test distance1 is  tensor(107710.2031, device='cuda:3')
test similarity is  tensor(-0.1075, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130124727611505.53
test entropy is  0.0
________________________________
cal ratio is  0.034540550155593285
distance x is tensor(3720.3755, device='cuda:3')
cal_distance is  tensor(3720.3755, device='cuda:3')
cal ratio is  0.18585073466218618
distance x is tensor(691.4387, device='cuda:3')
cal_distance is  tensor(691.4387, device='cuda:3')
cal ratio is  0.43110279403524165
distance x is tensor(298.0841, device='cuda:3')
cal_distance is  tensor(298.0841, device='cuda:3')
cal ratio is  0.6565809388183816
distance x is tensor(195.7181, device='cuda:3')
cal_distance is  tensor(195.7181, device='cuda:3')
cal ratio is  0.8102930951985566
distance x is tensor(158.5901, device='cuda:3')
cal_distance is  tensor(158.5901, device='cuda:3')
cal ratio is  0.9001599767151233
distance x is tensor(142.7570, device='cuda:3')
cal_distance is  tensor(142.7570, device='cuda:3')
cal ratio is  0.9487658367544052
distance x is tensor(135.4432, device='cuda:3')
cal_distance is  tensor(135.4432, device='cuda:3')
cal ratio is  0.9740452070907132
distance x is tensor(131.9279, device='cuda:3')
cal_distance is  tensor(131.9279, device='cuda:3')
distance x is tensor(131.9279, device='cuda:3')
return_distance is  tensor(131.9279, device='cuda:3')
distance x is tensor(131.9175, device='cuda:3')
distance x is tensor(131.9175, device='cuda:3')
________________________________
test distance is  tensor(131.9175, device='cuda:3')
test distance1 is  tensor(131.9175, device='cuda:3')
test similarity is  tensor(0.9420, device='cuda:3')
test acc is  0.10010000015633198
test loss is 323.0852424930662
test entropy is  1.723790567299547e-05
________________________________
0
distance x is tensor(131.9175, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0285747639594297e-05
avg test loss is  323.39433200730446
avg accuracy is  0.2896000001563393
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9420, device='cuda:3')
compute_distance is  tensor(131.9175, device='cuda:3')
compute_norm is  tensor(44.3305, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(110.0948, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9575632729255823
avg test loss is  1.4141938090324402
avg accuracy is  0.829116666822991
solo acc is  0.3596500001563406
compute similarity  is  tensor(0.9498, device='cuda:3')
compute_distance is  tensor(110.0948, device='cuda:3')
compute_norm is  tensor(43.1693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.6071, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8692002257685671
avg test loss is  1.5610309225409778
avg accuracy is  0.8286833334896575
solo acc is  0.27826666682300566
compute similarity  is  tensor(0.9493, device='cuda:3')
compute_distance is  tensor(112.6071, device='cuda:3')
compute_norm is  tensor(42.8716, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.6950, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8803025684249934
avg test loss is  1.5010438918559028
avg accuracy is  0.8341666668229908
solo acc is  0.2728500001563388
compute similarity  is  tensor(0.9489, device='cuda:3')
compute_distance is  tensor(114.6950, device='cuda:3')
compute_norm is  tensor(42.6041, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.6482, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8684480671308188
avg test loss is  1.4594420103121921
avg accuracy is  0.8387000001563238
solo acc is  0.2750500001563389
compute similarity  is  tensor(0.9485, device='cuda:3')
compute_distance is  tensor(116.6482, device='cuda:3')
compute_norm is  tensor(42.3545, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.5105, device='cuda:3')
distance x is tensor(118.5105, device='cuda:3')
________________________________
test distance is  tensor(118.5105, device='cuda:3')
test distance1 is  tensor(118.5105, device='cuda:3')
test similarity is  tensor(0.9481, device='cuda:3')
test acc is  0.275050000156339
test loss is 1.4260775167296436
test entropy is  0.8712469850267682
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.276055097579956
mal norm is  tensor(623.7903, device='cuda:3')
distance x is tensor(118.5182, device='cuda:3')
mal distance is  tensor(118.5182, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([545.2065, 565.7949, 554.5384, 500.6490, 471.7445, 576.2311, 510.2745,
        571.6968, 623.7903, 623.7903, 623.7903, 623.7903, 623.7903, 623.7903,
        623.7903, 623.7903, 623.7903, 623.7903, 623.7903, 623.7903],
       device='cuda:3')
sorted_norm is   tensor([471.7445, 500.6490, 510.2745, 545.2065, 554.5384, 565.7949, 571.6968,
        576.2311, 623.7903, 623.7903, 623.7903, 623.7903, 623.7903, 623.7903,
        623.7903, 623.7903, 623.7903, 623.7903, 623.7903, 623.7903],
       device='cuda:3')
used idx is  tensor([ 4,  3,  6,  0,  2,  1,  7,  5, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 86.72% 

Test Accuracy: 85.73% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0312397480010986
distance x is tensor(119.2322, device='cuda:3')
benign distance is  tensor(119.2322, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7064331769943237
distance x is tensor(135.3118, device='cuda:3')
benign distance is  tensor(135.3118, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06212366744875908
distance x is tensor(144.9528, device='cuda:3')
benign distance is  tensor(144.9528, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6714721918106079
distance x is tensor(139.1691, device='cuda:3')
benign distance is  tensor(139.1691, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.994925320148468
distance x is tensor(122.3592, device='cuda:3')
benign distance is  tensor(122.3592, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.690546452999115
distance x is tensor(138.8872, device='cuda:3')
benign distance is  tensor(138.8872, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3090099096298218
distance x is tensor(137.3996, device='cuda:3')
benign distance is  tensor(137.3996, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3721849322319031
distance x is tensor(130.2317, device='cuda:3')
benign distance is  tensor(130.2317, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(130.3608, device='cuda:3')
compute distance is  tensor(130.3608, device='cuda:3')
compute norm is  tensor(44.6718, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6764, device='cuda:3')
compute distance is  tensor(134.6764, device='cuda:3')
compute norm is  tensor(44.8166, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1398, device='cuda:3')
compute distance is  tensor(145.1398, device='cuda:3')
compute norm is  tensor(45.2537, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8829, device='cuda:3')
compute distance is  tensor(137.8829, device='cuda:3')
compute norm is  tensor(45.0879, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.0646, device='cuda:3')
compute distance is  tensor(147.0646, device='cuda:3')
compute norm is  tensor(45.1208, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4150, device='cuda:3')
compute distance is  tensor(139.4150, device='cuda:3')
compute norm is  tensor(45.1070, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9855, device='cuda:3')
compute distance is  tensor(142.9855, device='cuda:3')
compute norm is  tensor(45.0777, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5949, device='cuda:3')
compute distance is  tensor(135.5949, device='cuda:3')
compute norm is  tensor(44.9527, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.5029, device='cuda:3')
compute distance is  tensor(142.5029, device='cuda:3')
compute norm is  tensor(44.9901, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9572, device='cuda:3')
compute distance is  tensor(139.9572, device='cuda:3')
compute norm is  tensor(45.0241, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.6803, device='cuda:3')
compute distance is  tensor(154.6803, device='cuda:3')
compute norm is  tensor(45.4352, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.6071, device='cuda:3')
compute distance is  tensor(143.6071, device='cuda:3')
compute norm is  tensor(45.0657, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(154.6803, device='cuda:3')
distance x is tensor(107674.1562, device='cuda:3')
distance x is tensor(107674.1562, device='cuda:3')
________________________________
test distance is  tensor(107674.1562, device='cuda:3')
test distance1 is  tensor(107674.1562, device='cuda:3')
test similarity is  tensor(0.0322, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129996973994586.61
test entropy is  0.0
________________________________
cal ratio is  0.03714393258482379
distance x is tensor(3999.4470, device='cuda:3')
cal_distance is  tensor(3999.4470, device='cuda:3')
cal ratio is  0.19272747731013914
distance x is tensor(770.8076, device='cuda:3')
cal_distance is  tensor(770.8076, device='cuda:3')
cal ratio is  0.4390061891698983
distance x is tensor(338.3922, device='cuda:3')
cal_distance is  tensor(338.3922, device='cuda:3')
cal ratio is  0.6625725783412895
distance x is tensor(224.2111, device='cuda:3')
cal_distance is  tensor(224.2111, device='cuda:3')
cal ratio is  0.8139824706440741
distance x is tensor(182.5049, device='cuda:3')
cal_distance is  tensor(182.5049, device='cuda:3')
cal ratio is  0.9022073931692582
distance x is tensor(164.6578, device='cuda:3')
cal_distance is  tensor(164.6578, device='cuda:3')
cal ratio is  0.9498444756142551
distance x is tensor(156.3995, device='cuda:3')
cal_distance is  tensor(156.3995, device='cuda:3')
cal ratio is  0.9745988362141954
distance x is tensor(152.4269, device='cuda:3')
cal_distance is  tensor(152.4269, device='cuda:3')
distance x is tensor(152.4269, device='cuda:3')
return_distance is  tensor(152.4269, device='cuda:3')
distance x is tensor(152.4166, device='cuda:3')
distance x is tensor(152.4166, device='cuda:3')
________________________________
test distance is  tensor(152.4166, device='cuda:3')
test distance1 is  tensor(152.4166, device='cuda:3')
test similarity is  tensor(0.9279, device='cuda:3')
test acc is  0.10000000015633198
test loss is 736.8516998616363
test entropy is  1.3878531698909969e-45
________________________________
0
distance x is tensor(152.4166, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.469608018789003e-48
avg test loss is  737.6409801491288
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9279, device='cuda:3')
compute_distance is  tensor(152.4166, device='cuda:3')
compute_norm is  tensor(45.3184, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.6042, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0747344957104623
avg test loss is  1.6659750399559037
avg accuracy is  0.6502833334896674
solo acc is  0.2695000001563388
compute similarity  is  tensor(0.9333, device='cuda:3')
compute_distance is  tensor(138.6042, device='cuda:3')
compute_norm is  tensor(45.2356, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(139.2138, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6323306881415565
avg test loss is  2.549468106552482
avg accuracy is  0.5507666668230086
solo acc is  0.11625000015633194
compute similarity  is  tensor(0.9331, device='cuda:3')
compute_distance is  tensor(139.2138, device='cuda:3')
compute_norm is  tensor(45.1042, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.3527, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9669138548343674
avg test loss is  1.4738641796844092
avg accuracy is  0.6243166668230025
solo acc is  0.28538333348967254
compute similarity  is  tensor(0.9335, device='cuda:3')
compute_distance is  tensor(139.3527, device='cuda:3')
compute_norm is  tensor(44.7880, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(139.3527, device='cuda:3')
distance x is tensor(139.3527, device='cuda:3')
________________________________
test distance is  tensor(139.3527, device='cuda:3')
test distance1 is  tensor(139.3527, device='cuda:3')
test similarity is  tensor(0.9335, device='cuda:3')
test acc is  0.2890166668230059
test loss is 1.470906060387585
test entropy is  0.9675427400099952
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.316098690032959
mal norm is  tensor(730.9825, device='cuda:3')
distance x is tensor(139.3605, device='cuda:3')
mal distance is  tensor(139.3605, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([534.8245, 600.9080, 627.1688, 599.4685, 526.0278, 606.8580, 597.6818,
        563.1248, 730.9826, 730.9826, 730.9826, 730.9826, 730.9826, 730.9826,
        730.9826, 730.9826, 730.9826, 730.9826, 730.9826, 730.9826, 698.7355,
        689.2089, 651.1932, 673.0269, 652.0270, 731.1675, 714.1187, 687.6759],
       device='cuda:3')
sorted_norm is   tensor([526.0278, 534.8245, 563.1248, 597.6818, 599.4685, 600.9080, 606.8580,
        627.1688, 651.1932, 652.0270, 673.0269, 687.6759, 689.2089, 698.7355,
        714.1187, 730.9826, 730.9826, 730.9826, 730.9826, 730.9826, 730.9826,
        730.9826, 730.9826, 730.9826, 730.9826, 730.9826, 730.9826, 731.1675],
       device='cuda:3')
used idx is  tensor([ 4,  0,  7,  6,  3,  1,  5,  2, 22, 24, 23, 27, 21, 20, 26, 17, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 87.38% 

Test Accuracy: 86.67% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.44444066286087036
distance x is tensor(140.5856, device='cuda:3')
benign distance is  tensor(140.5856, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3581460416316986
distance x is tensor(145.6674, device='cuda:3')
benign distance is  tensor(145.6674, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.022674744948744774
distance x is tensor(129.9586, device='cuda:3')
benign distance is  tensor(129.9586, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.26011377573013306
distance x is tensor(126.0408, device='cuda:3')
benign distance is  tensor(126.0408, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7420120239257812
distance x is tensor(139.1144, device='cuda:3')
benign distance is  tensor(139.1144, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1559171676635742
distance x is tensor(143.5162, device='cuda:3')
benign distance is  tensor(143.5162, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7592130899429321
distance x is tensor(127.8465, device='cuda:3')
benign distance is  tensor(127.8465, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.11622527986764908
distance x is tensor(131.6862, device='cuda:3')
benign distance is  tensor(131.6862, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6521415114402771
distance x is tensor(162.5342, device='cuda:3')
benign distance is  tensor(162.5342, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7212902307510376
distance x is tensor(146.2992, device='cuda:3')
benign distance is  tensor(146.2992, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7287935018539429
distance x is tensor(144.4549, device='cuda:3')
benign distance is  tensor(144.4549, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.36488673090934753
distance x is tensor(147.3898, device='cuda:3')
benign distance is  tensor(147.3898, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8594264984130859
distance x is tensor(142.0334, device='cuda:3')
benign distance is  tensor(142.0334, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.42457255721092224
distance x is tensor(154.0404, device='cuda:3')
benign distance is  tensor(154.0404, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4382971227169037
distance x is tensor(148.3037, device='cuda:3')
benign distance is  tensor(148.3037, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8230382204055786
distance x is tensor(148.2512, device='cuda:3')
benign distance is  tensor(148.2512, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(134.8592, device='cuda:3')
compute distance is  tensor(134.8592, device='cuda:3')
compute norm is  tensor(45.1754, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1863, device='cuda:3')
compute distance is  tensor(132.1863, device='cuda:3')
compute norm is  tensor(45.0829, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.8942, device='cuda:3')
compute distance is  tensor(147.8942, device='cuda:3')
compute norm is  tensor(45.5837, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3371, device='cuda:3')
compute distance is  tensor(137.3371, device='cuda:3')
compute norm is  tensor(45.2653, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.2646, device='cuda:3')
compute distance is  tensor(157.2646, device='cuda:3')
compute norm is  tensor(45.7089, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7392, device='cuda:3')
compute distance is  tensor(136.7392, device='cuda:3')
compute norm is  tensor(45.2727, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.0349, device='cuda:3')
compute distance is  tensor(130.0349, device='cuda:3')
compute norm is  tensor(45.1604, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5901, device='cuda:3')
compute distance is  tensor(143.5901, device='cuda:3')
compute norm is  tensor(45.5490, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.3291, device='cuda:3')
compute distance is  tensor(151.3291, device='cuda:3')
compute norm is  tensor(45.5169, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.2223, device='cuda:3')
compute distance is  tensor(153.2223, device='cuda:3')
compute norm is  tensor(45.7038, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5032, device='cuda:3')
compute distance is  tensor(143.5032, device='cuda:3')
compute norm is  tensor(45.4400, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.8092, device='cuda:3')
compute distance is  tensor(144.8092, device='cuda:3')
compute norm is  tensor(45.4692, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.2646, device='cuda:3')
distance x is tensor(107668.9375, device='cuda:3')
distance x is tensor(107668.9375, device='cuda:3')
________________________________
test distance is  tensor(107668.9375, device='cuda:3')
test distance1 is  tensor(107668.9375, device='cuda:3')
test similarity is  tensor(0.0760, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130033405781732.16
test entropy is  0.0
________________________________
cal ratio is  0.03745383729613444
distance x is tensor(4032.6206, device='cuda:3')
cal_distance is  tensor(4032.6206, device='cuda:3')
cal ratio is  0.19352979942697796
distance x is tensor(780.4363, device='cuda:3')
cal_distance is  tensor(780.4363, device='cuda:3')
cal ratio is  0.4399190659214002
distance x is tensor(343.3317, device='cuda:3')
cal_distance is  tensor(343.3317, device='cuda:3')
cal ratio is  0.6632611720143184
distance x is tensor(227.7203, device='cuda:3')
cal_distance is  tensor(227.7203, device='cuda:3')
cal ratio is  0.8144054080734389
distance x is tensor(185.4576, device='cuda:3')
cal_distance is  tensor(185.4576, device='cuda:3')
cal ratio is  0.9024417122117031
distance x is tensor(167.3652, device='cuda:3')
cal_distance is  tensor(167.3652, device='cuda:3')
cal ratio is  0.9499678643337724
distance x is tensor(158.9918, device='cuda:3')
cal_distance is  tensor(158.9918, device='cuda:3')
cal ratio is  0.9746621812233103
distance x is tensor(154.9635, device='cuda:3')
cal_distance is  tensor(154.9635, device='cuda:3')
distance x is tensor(154.9635, device='cuda:3')
return_distance is  tensor(154.9635, device='cuda:3')
distance x is tensor(154.9532, device='cuda:3')
distance x is tensor(154.9532, device='cuda:3')
________________________________
test distance is  tensor(154.9532, device='cuda:3')
test distance1 is  tensor(154.9532, device='cuda:3')
test similarity is  tensor(0.9297, device='cuda:3')
test acc is  0.10000000015633198
test loss is 458.06451067894
test entropy is  3.0096690488348066e-06
________________________________
0
distance x is tensor(154.9532, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  9.199154935199945e-06
avg test loss is  457.69706953817337
avg accuracy is  0.1105166668229986
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(154.9532, device='cuda:3')
compute_norm is  tensor(46.1790, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.7060, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0494336893182319
avg test loss is  1.6874916801320465
avg accuracy is  0.6944833334896644
solo acc is  0.25388333348967174
compute similarity  is  tensor(0.9343, device='cuda:3')
compute_distance is  tensor(141.7060, device='cuda:3')
compute_norm is  tensor(46.2094, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(142.7388, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6336040473314745
avg test loss is  2.5677387963480025
avg accuracy is  0.6169666668230029
solo acc is  0.11246666682299862
compute similarity  is  tensor(0.9340, device='cuda:3')
compute_distance is  tensor(142.7388, device='cuda:3')
compute_norm is  tensor(46.0687, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.6751, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9866705849480781
avg test loss is  1.5375536544236548
avg accuracy is  0.6977833334896641
solo acc is  0.2653500001563387
compute similarity  is  tensor(0.9341, device='cuda:3')
compute_distance is  tensor(143.6751, device='cuda:3')
compute_norm is  tensor(45.7505, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(143.6751, device='cuda:3')
distance x is tensor(143.6751, device='cuda:3')
________________________________
test distance is  tensor(143.6751, device='cuda:3')
test distance1 is  tensor(143.6751, device='cuda:3')
test similarity is  tensor(0.9341, device='cuda:3')
test acc is  0.2643666668230053
test loss is 1.5352124172741417
test entropy is  0.9866237545699708
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.6335546970367432
mal norm is  tensor(748.6846, device='cuda:3')
distance x is tensor(143.6841, device='cuda:3')
mal distance is  tensor(143.6841, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([612.2815, 634.6545, 561.8523, 540.7648, 588.4866, 617.5904, 545.4492,
        564.7753, 748.6847, 748.6846, 748.6847, 748.6846, 748.6847, 748.6846,
        748.6847, 748.6846, 748.6847, 748.6846, 748.6847, 748.6846, 712.3599,
        781.5469, 722.0370, 724.0397, 719.4512, 704.1591, 747.1515, 732.9712],
       device='cuda:3')
sorted_norm is   tensor([540.7648, 545.4492, 561.8523, 564.7753, 588.4866, 612.2815, 617.5904,
        634.6545, 704.1591, 712.3599, 719.4512, 722.0370, 724.0397, 732.9712,
        747.1515, 748.6846, 748.6846, 748.6846, 748.6846, 748.6846, 748.6846,
        748.6847, 748.6847, 748.6847, 748.6847, 748.6847, 748.6847, 781.5469],
       device='cuda:3')
used idx is  tensor([ 3,  6,  2,  7,  4,  0,  5,  1, 25, 20, 24, 22, 23, 27, 26, 19, 17,  9,
        13, 15, 11, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.08% 

Test Accuracy: 86.29% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8658938407897949
distance x is tensor(134.9912, device='cuda:3')
benign distance is  tensor(134.9912, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9049805402755737
distance x is tensor(145.8901, device='cuda:3')
benign distance is  tensor(145.8901, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20941033959388733
distance x is tensor(146.6284, device='cuda:3')
benign distance is  tensor(146.6284, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.557426929473877
distance x is tensor(141.2300, device='cuda:3')
benign distance is  tensor(141.2300, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.29737403988838196
distance x is tensor(145.8652, device='cuda:3')
benign distance is  tensor(145.8652, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8701854944229126
distance x is tensor(154.0301, device='cuda:3')
benign distance is  tensor(154.0301, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4732394218444824
distance x is tensor(140.9384, device='cuda:3')
benign distance is  tensor(140.9384, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5568903684616089
distance x is tensor(152.3947, device='cuda:3')
benign distance is  tensor(152.3947, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4105744957923889
distance x is tensor(141.2782, device='cuda:3')
benign distance is  tensor(141.2782, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.8181511163711548
distance x is tensor(161.2101, device='cuda:3')
benign distance is  tensor(161.2101, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2567063868045807
distance x is tensor(151.6114, device='cuda:3')
benign distance is  tensor(151.6114, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.12021695077419281
distance x is tensor(160.0548, device='cuda:3')
benign distance is  tensor(160.0548, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20054177939891815
distance x is tensor(147.8171, device='cuda:3')
benign distance is  tensor(147.8171, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6554356217384338
distance x is tensor(140.5195, device='cuda:3')
benign distance is  tensor(140.5195, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.15528200566768646
distance x is tensor(147.7083, device='cuda:3')
benign distance is  tensor(147.7083, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.16884708404541016
distance x is tensor(152.9005, device='cuda:3')
benign distance is  tensor(152.9005, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(146.0060, device='cuda:3')
compute distance is  tensor(146.0060, device='cuda:3')
compute norm is  tensor(45.4715, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3632, device='cuda:3')
compute distance is  tensor(142.3632, device='cuda:3')
compute norm is  tensor(45.4721, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3010, device='cuda:3')
compute distance is  tensor(146.3010, device='cuda:3')
compute norm is  tensor(45.7497, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0156, device='cuda:3')
compute distance is  tensor(151.0156, device='cuda:3')
compute norm is  tensor(45.7481, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.8685, device='cuda:3')
compute distance is  tensor(148.8685, device='cuda:3')
compute norm is  tensor(45.7961, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8885, device='cuda:3')
compute distance is  tensor(145.8885, device='cuda:3')
compute norm is  tensor(45.8197, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.1890, device='cuda:3')
compute distance is  tensor(144.1890, device='cuda:3')
compute norm is  tensor(45.5922, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.4114, device='cuda:3')
compute distance is  tensor(148.4114, device='cuda:3')
compute norm is  tensor(45.8448, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.7296, device='cuda:3')
compute distance is  tensor(162.7296, device='cuda:3')
compute norm is  tensor(45.9729, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.8994, device='cuda:3')
compute distance is  tensor(149.8994, device='cuda:3')
compute norm is  tensor(45.9111, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.0768, device='cuda:3')
compute distance is  tensor(158.0768, device='cuda:3')
compute norm is  tensor(46.0152, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.1014, device='cuda:3')
compute distance is  tensor(152.1014, device='cuda:3')
compute norm is  tensor(45.7044, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(162.7296, device='cuda:3')
distance x is tensor(107657.1328, device='cuda:3')
distance x is tensor(107657.1328, device='cuda:3')
________________________________
test distance is  tensor(107657.1328, device='cuda:3')
test distance1 is  tensor(107657.1328, device='cuda:3')
test similarity is  tensor(0.1120, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130138507053802.72
test entropy is  0.0
________________________________
cal ratio is  0.038101143464405865
distance x is tensor(4101.8652, device='cuda:3')
cal_distance is  tensor(4101.8652, device='cuda:3')
cal ratio is  0.19519501700769226
distance x is tensor(800.6677, device='cuda:3')
cal_distance is  tensor(800.6677, device='cuda:3')
cal ratio is  0.4418076745289281
distance x is tensor(353.7440, device='cuda:3')
cal_distance is  tensor(353.7440, device='cuda:3')
cal ratio is  0.6646834160105825
distance x is tensor(235.1295, device='cuda:3')
cal_distance is  tensor(235.1295, device='cuda:3')
cal ratio is  0.8152781843286945
distance x is tensor(191.6969, device='cuda:3')
cal_distance is  tensor(191.6969, device='cuda:3')
cal ratio is  0.9029253519867175
distance x is tensor(173.0885, device='cuda:3')
cal_distance is  tensor(173.0885, device='cuda:3')
cal ratio is  0.9502223952131864
distance x is tensor(164.4728, device='cuda:3')
cal_distance is  tensor(164.4728, device='cuda:3')
cal ratio is  0.9747928228097642
distance x is tensor(160.3271, device='cuda:3')
cal_distance is  tensor(160.3271, device='cuda:3')
distance x is tensor(160.3271, device='cuda:3')
return_distance is  tensor(160.3271, device='cuda:3')
distance x is tensor(160.3168, device='cuda:3')
distance x is tensor(160.3168, device='cuda:3')
________________________________
test distance is  tensor(160.3168, device='cuda:3')
test distance1 is  tensor(160.3168, device='cuda:3')
test similarity is  tensor(0.9287, device='cuda:3')
test acc is  0.10011666682299865
test loss is 457.9511665067693
test entropy is  7.962429334274207e-05
________________________________
0
distance x is tensor(160.3168, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  9.847164874677417e-05
avg test loss is  457.772542241794
avg accuracy is  0.12896666682299857
solo acc is  0.10023333348966532
compute similarity  is  tensor(0.9287, device='cuda:3')
compute_distance is  tensor(160.3168, device='cuda:3')
compute_norm is  tensor(46.9845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.9263, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1758296039821243
avg test loss is  1.8575148179587015
avg accuracy is  0.6883000001563316
solo acc is  0.21310000015633693
compute similarity  is  tensor(0.9317, device='cuda:3')
compute_distance is  tensor(150.9263, device='cuda:3')
compute_norm is  tensor(47.4296, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(152.0422, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.68953355244482
avg test loss is  2.680106139894742
avg accuracy is  0.6401500001563346
solo acc is  0.11026666682299861
compute similarity  is  tensor(0.9314, device='cuda:3')
compute_distance is  tensor(152.0422, device='cuda:3')
compute_norm is  tensor(47.3363, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.0662, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.040971348852491
avg test loss is  1.6754618146017926
avg accuracy is  0.7050833334896637
solo acc is  0.23800000015633788
compute similarity  is  tensor(0.9318, device='cuda:3')
compute_distance is  tensor(153.0662, device='cuda:3')
compute_norm is  tensor(47.0027, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(154.0010, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6337837870441266
avg test loss is  2.5371171070822776
avg accuracy is  0.6511333334896671
solo acc is  0.10983333348966529
compute similarity  is  tensor(0.9314, device='cuda:3')
compute_distance is  tensor(154.0010, device='cuda:3')
compute_norm is  tensor(46.8722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.7255, device='cuda:3')
distance x is tensor(154.7255, device='cuda:3')
________________________________
test distance is  tensor(154.7255, device='cuda:3')
test distance1 is  tensor(154.7255, device='cuda:3')
test similarity is  tensor(0.9315, device='cuda:3')
test acc is  0.25975000015633853
test loss is 1.52915483611479
test entropy is  0.9859125609082708
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.6734237670898438
mal norm is  tensor(778.3074, device='cuda:3')
distance x is tensor(154.7341, device='cuda:3')
mal distance is  tensor(154.7341, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([578.5615, 625.6903, 619.0659, 586.2764, 621.6432, 645.6881, 605.8018,
        646.5106, 778.3074, 778.3074, 778.3074, 778.3074, 778.3074, 778.3074,
        778.3074, 778.3074, 778.3074, 778.3074, 778.3074, 778.3074, 838.9584,
        741.3459, 797.3634, 776.9110, 753.0824, 800.1216, 760.2621, 787.5325,
        730.8595, 644.9614, 624.5915, 650.7591, 624.8957, 679.1156, 657.5668,
        648.8154], device='cuda:3')
sorted_norm is   tensor([578.5615, 586.2764, 605.8018, 619.0659, 621.6432, 624.5915, 624.8957,
        625.6903, 644.9614, 645.6881, 646.5106, 648.8154, 650.7591, 657.5668,
        679.1156, 730.8595, 741.3459, 753.0824, 760.2621, 776.9110, 778.3074,
        778.3074, 778.3074, 778.3074, 778.3074, 778.3074, 778.3074, 778.3074,
        778.3074, 778.3074, 778.3074, 778.3074, 787.5325, 797.3634, 800.1216,
        838.9584], device='cuda:3')
used idx is  tensor([ 0,  3,  6,  2,  4, 30, 32,  1, 29,  5,  7, 35, 31, 34, 33, 28, 21, 24,
        26, 23, 11, 10,  8,  9, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.85% 

Test Accuracy: 86.69% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.548657238483429
distance x is tensor(151.8337, device='cuda:3')
benign distance is  tensor(151.8337, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3088025450706482
distance x is tensor(136.8821, device='cuda:3')
benign distance is  tensor(136.8821, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2508091330528259
distance x is tensor(148.1789, device='cuda:3')
benign distance is  tensor(148.1789, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6696022152900696
distance x is tensor(140.9585, device='cuda:3')
benign distance is  tensor(140.9585, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8505487442016602
distance x is tensor(135.3073, device='cuda:3')
benign distance is  tensor(135.3073, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4385322630405426
distance x is tensor(139.3974, device='cuda:3')
benign distance is  tensor(139.3974, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26383575797080994
distance x is tensor(133.5660, device='cuda:3')
benign distance is  tensor(133.5660, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2569483816623688
distance x is tensor(144.9517, device='cuda:3')
benign distance is  tensor(144.9517, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5114824175834656
distance x is tensor(146.9314, device='cuda:3')
benign distance is  tensor(146.9314, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3541111946105957
distance x is tensor(146.7534, device='cuda:3')
benign distance is  tensor(146.7534, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8220952749252319
distance x is tensor(137.9373, device='cuda:3')
benign distance is  tensor(137.9373, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9141292572021484
distance x is tensor(149.5974, device='cuda:3')
benign distance is  tensor(149.5974, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.713176965713501
distance x is tensor(146.8414, device='cuda:3')
benign distance is  tensor(146.8414, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4362693727016449
distance x is tensor(152.8476, device='cuda:3')
benign distance is  tensor(152.8476, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.32313910126686096
distance x is tensor(135.6055, device='cuda:3')
benign distance is  tensor(135.6055, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8197969198226929
distance x is tensor(158.4547, device='cuda:3')
benign distance is  tensor(158.4547, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5836746096611023
distance x is tensor(149.8884, device='cuda:3')
benign distance is  tensor(149.8884, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4766102433204651
distance x is tensor(131.2893, device='cuda:3')
benign distance is  tensor(131.2893, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8138205409049988
distance x is tensor(152.4229, device='cuda:3')
benign distance is  tensor(152.4229, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8399462699890137
distance x is tensor(147.6512, device='cuda:3')
benign distance is  tensor(147.6512, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.903677761554718
distance x is tensor(147.9806, device='cuda:3')
benign distance is  tensor(147.9806, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5962969064712524
distance x is tensor(150.3540, device='cuda:3')
benign distance is  tensor(150.3540, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.41240987181663513
distance x is tensor(148.8785, device='cuda:3')
benign distance is  tensor(148.8785, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.34471219778060913
distance x is tensor(150.8006, device='cuda:3')
benign distance is  tensor(150.8006, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(131.3628, device='cuda:3')
compute distance is  tensor(131.3628, device='cuda:3')
compute norm is  tensor(45.5259, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3160, device='cuda:3')
compute distance is  tensor(141.3160, device='cuda:3')
compute norm is  tensor(45.9250, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2446, device='cuda:3')
compute distance is  tensor(147.2446, device='cuda:3')
compute norm is  tensor(46.0889, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.5327, device='cuda:3')
compute distance is  tensor(146.5327, device='cuda:3')
compute norm is  tensor(46.0179, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7017, device='cuda:3')
compute distance is  tensor(142.7017, device='cuda:3')
compute norm is  tensor(45.9379, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.7288, device='cuda:3')
compute distance is  tensor(150.7288, device='cuda:3')
compute norm is  tensor(46.2677, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8351, device='cuda:3')
compute distance is  tensor(137.8351, device='cuda:3')
compute norm is  tensor(45.9373, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3247, device='cuda:3')
compute distance is  tensor(132.3247, device='cuda:3')
compute norm is  tensor(45.7474, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.9999, device='cuda:3')
compute distance is  tensor(147.9999, device='cuda:3')
compute norm is  tensor(45.9049, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7628, device='cuda:3')
compute distance is  tensor(137.7628, device='cuda:3')
compute norm is  tensor(45.8058, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.3165, device='cuda:3')
compute distance is  tensor(149.3165, device='cuda:3')
compute norm is  tensor(46.1002, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9228, device='cuda:3')
compute distance is  tensor(144.9228, device='cuda:3')
compute norm is  tensor(45.8640, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(150.7288, device='cuda:3')
distance x is tensor(107650.8594, device='cuda:3')
distance x is tensor(107650.8594, device='cuda:3')
________________________________
test distance is  tensor(107650.8594, device='cuda:3')
test distance1 is  tensor(107650.8594, device='cuda:3')
test similarity is  tensor(0.1430, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130057714393734.28
test entropy is  0.0
________________________________
cal ratio is  0.03667038366951441
distance x is tensor(3947.6038, device='cuda:3')
cal_distance is  tensor(3947.6038, device='cuda:3')
cal ratio is  0.19149499781234497
distance x is tensor(755.9506, device='cuda:3')
cal_distance is  tensor(755.9506, device='cuda:3')
cal ratio is  0.4376002007657123
distance x is tensor(330.8070, device='cuda:3')
cal_distance is  tensor(330.8070, device='cuda:3')
cal ratio is  0.6615107071504486
distance x is tensor(218.8341, device='cuda:3')
cal_distance is  tensor(218.8341, device='cuda:3')
cal ratio is  0.8133298983136582
distance x is tensor(177.9852, device='cuda:3')
cal_distance is  tensor(177.9852, device='cuda:3')
cal ratio is  0.9018456287055815
distance x is tensor(160.5158, device='cuda:3')
cal_distance is  tensor(160.5158, device='cuda:3')
cal ratio is  0.9496539223004841
distance x is tensor(152.4347, device='cuda:3')
cal_distance is  tensor(152.4347, device='cuda:3')
cal ratio is  0.9745010060456368
distance x is tensor(148.5479, device='cuda:3')
cal_distance is  tensor(148.5479, device='cuda:3')
distance x is tensor(148.5479, device='cuda:3')
return_distance is  tensor(148.5479, device='cuda:3')
distance x is tensor(148.5377, device='cuda:3')
distance x is tensor(148.5377, device='cuda:3')
________________________________
test distance is  tensor(148.5377, device='cuda:3')
test distance1 is  tensor(148.5377, device='cuda:3')
test similarity is  tensor(0.9399, device='cuda:3')
test acc is  0.10683333348966528
test loss is 195.1353255477287
test entropy is  0.0036318806958365664
________________________________
0
distance x is tensor(148.5377, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0033032822815465875
avg test loss is  194.81015431093002
avg accuracy is  0.37453333348967416
solo acc is  0.10646666682299862
compute similarity  is  tensor(0.9399, device='cuda:3')
compute_distance is  tensor(148.5377, device='cuda:3')
compute_norm is  tensor(47.0806, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.7765, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0310457765039351
avg test loss is  1.6614578971222265
avg accuracy is  0.7179000001563296
solo acc is  0.24740000015633817
compute similarity  is  tensor(0.9429, device='cuda:3')
compute_distance is  tensor(140.7765, device='cuda:3')
compute_norm is  tensor(47.0774, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(142.0776, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6479318134947372
avg test loss is  2.5106687492399073
avg accuracy is  0.6675000001563328
solo acc is  0.11113333348966528
compute similarity  is  tensor(0.9425, device='cuda:3')
compute_distance is  tensor(142.0776, device='cuda:3')
compute_norm is  tensor(46.9162, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.1700, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9579731751479574
avg test loss is  1.5354465712616439
avg accuracy is  0.7471333334896614
solo acc is  0.2728666668230056
compute similarity  is  tensor(0.9424, device='cuda:3')
compute_distance is  tensor(143.1700, device='cuda:3')
compute_norm is  tensor(46.6495, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(143.1700, device='cuda:3')
distance x is tensor(143.1700, device='cuda:3')
________________________________
test distance is  tensor(143.1700, device='cuda:3')
test distance1 is  tensor(143.1700, device='cuda:3')
test similarity is  tensor(0.9424, device='cuda:3')
test acc is  0.27193333348967225
test loss is 1.5382328363878133
test entropy is  0.9595827355440746
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.510187029838562
mal norm is  tensor(725.3989, device='cuda:3')
distance x is tensor(143.1791, device='cuda:3')
mal distance is  tensor(143.1791, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([644.4274, 586.8780, 627.2004, 597.0740, 563.0170, 598.8019, 552.9123,
        611.1815, 725.3989, 725.3989, 725.3989, 725.3989, 725.3989, 725.3989,
        725.3989, 725.3989, 725.3989, 725.3989, 725.3989, 725.3989, 851.9534,
        829.7391, 875.3303, 814.8474, 838.7473, 815.7956, 832.4114, 808.1814],
       device='cuda:3')
sorted_norm is   tensor([552.9123, 563.0170, 586.8780, 597.0740, 598.8019, 611.1815, 627.2004,
        644.4274, 725.3989, 725.3989, 725.3989, 725.3989, 725.3989, 725.3989,
        725.3989, 725.3989, 725.3989, 725.3989, 725.3989, 725.3989, 808.1814,
        814.8474, 815.7956, 829.7391, 832.4114, 838.7473, 851.9534, 875.3303],
       device='cuda:3')
used idx is  tensor([ 6,  4,  1,  3,  5,  7,  2,  0, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 27, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 80.33% 

Test Accuracy: 79.77% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.648271918296814
distance x is tensor(159.1691, device='cuda:3')
benign distance is  tensor(159.1691, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8391293287277222
distance x is tensor(166.4850, device='cuda:3')
benign distance is  tensor(166.4850, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24393296241760254
distance x is tensor(172.7587, device='cuda:3')
benign distance is  tensor(172.7587, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4947547912597656
distance x is tensor(166.4270, device='cuda:3')
benign distance is  tensor(166.4270, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9020740389823914
distance x is tensor(209.7475, device='cuda:3')
benign distance is  tensor(209.7475, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9863182306289673
distance x is tensor(174.2293, device='cuda:3')
benign distance is  tensor(174.2293, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.550416111946106
distance x is tensor(190.9894, device='cuda:3')
benign distance is  tensor(190.9894, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4216178357601166
distance x is tensor(178.8092, device='cuda:3')
benign distance is  tensor(178.8092, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7382787466049194
distance x is tensor(166.9968, device='cuda:3')
benign distance is  tensor(166.9968, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.03509824350476265
distance x is tensor(177.6040, device='cuda:3')
benign distance is  tensor(177.6040, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.47860121726989746
distance x is tensor(167.7188, device='cuda:3')
benign distance is  tensor(167.7188, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.14779165387153625
distance x is tensor(167.0703, device='cuda:3')
benign distance is  tensor(167.0703, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.35168594121932983
distance x is tensor(167.0751, device='cuda:3')
benign distance is  tensor(167.0751, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7327226996421814
distance x is tensor(162.7950, device='cuda:3')
benign distance is  tensor(162.7950, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7764798998832703
distance x is tensor(166.0297, device='cuda:3')
benign distance is  tensor(166.0297, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2706751227378845
distance x is tensor(161.3972, device='cuda:3')
benign distance is  tensor(161.3972, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(169.6369, device='cuda:3')
compute distance is  tensor(169.6369, device='cuda:3')
compute norm is  tensor(47.3306, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.4678, device='cuda:3')
compute distance is  tensor(161.4678, device='cuda:3')
compute norm is  tensor(46.9658, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.2141, device='cuda:3')
compute distance is  tensor(179.2141, device='cuda:3')
compute norm is  tensor(47.8707, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.5728, device='cuda:3')
compute distance is  tensor(172.5728, device='cuda:3')
compute norm is  tensor(47.3405, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.8812, device='cuda:3')
compute distance is  tensor(183.8812, device='cuda:3')
compute norm is  tensor(47.8277, device='cuda:3', dtype=torch.float64)
distance x is tensor(186.5716, device='cuda:3')
compute distance is  tensor(186.5716, device='cuda:3')
compute norm is  tensor(47.6798, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.5569, device='cuda:3')
compute distance is  tensor(175.5569, device='cuda:3')
compute norm is  tensor(47.5463, device='cuda:3', dtype=torch.float64)
distance x is tensor(192.8413, device='cuda:3')
compute distance is  tensor(192.8413, device='cuda:3')
compute norm is  tensor(47.8208, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.2921, device='cuda:3')
compute distance is  tensor(173.2921, device='cuda:3')
compute norm is  tensor(47.4900, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.6215, device='cuda:3')
compute distance is  tensor(176.6215, device='cuda:3')
compute norm is  tensor(47.5101, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.8124, device='cuda:3')
compute distance is  tensor(179.8124, device='cuda:3')
compute norm is  tensor(47.7624, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.6997, device='cuda:3')
compute distance is  tensor(163.6997, device='cuda:3')
compute norm is  tensor(47.2466, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(192.8413, device='cuda:3')
distance x is tensor(107605.7266, device='cuda:3')
distance x is tensor(107605.7266, device='cuda:3')
________________________________
test distance is  tensor(107605.7266, device='cuda:3')
test distance1 is  tensor(107605.7266, device='cuda:3')
test similarity is  tensor(0.2815, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130024247720167.44
test entropy is  0.0
________________________________
cal ratio is  0.04148665692968791
distance x is tensor(4464.2070, device='cuda:3')
cal_distance is  tensor(4464.2070, device='cuda:3')
cal ratio is  0.2036826170366467
distance x is tensor(909.2855, device='cuda:3')
cal_distance is  tensor(909.2855, device='cuda:3')
cal ratio is  0.4513110959348562
distance x is tensor(410.3734, device='cuda:3')
cal_distance is  tensor(410.3734, device='cuda:3')
cal ratio is  0.6717946327314899
distance x is tensor(275.6884, device='cuda:3')
cal_distance is  tensor(275.6884, device='cuda:3')
cal ratio is  0.8196282299252122
distance x is tensor(225.9629, device='cuda:3')
cal_distance is  tensor(225.9629, device='cuda:3')
cal ratio is  0.9053313606701986
distance x is tensor(204.5718, device='cuda:3')
cal_distance is  tensor(204.5718, device='cuda:3')
cal ratio is  0.9514879217629073
distance x is tensor(194.6478, device='cuda:3')
cal_distance is  tensor(194.6478, device='cuda:3')
cal ratio is  0.9754418363681927
distance x is tensor(189.8677, device='cuda:3')
cal_distance is  tensor(189.8677, device='cuda:3')
distance x is tensor(189.8677, device='cuda:3')
return_distance is  tensor(189.8677, device='cuda:3')
distance x is tensor(189.8576, device='cuda:3')
distance x is tensor(189.8576, device='cuda:3')
________________________________
test distance is  tensor(189.8576, device='cuda:3')
test distance1 is  tensor(189.8576, device='cuda:3')
test similarity is  tensor(0.9266, device='cuda:3')
test acc is  0.10018333348966531
test loss is 530.0023054761419
test entropy is  0.00014566177793494465
________________________________
0
distance x is tensor(189.8576, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00016728384575724934
avg test loss is  529.6700668172288
avg accuracy is  0.1389833334896655
solo acc is  0.10020000015633199
compute similarity  is  tensor(0.9266, device='cuda:3')
compute_distance is  tensor(189.8576, device='cuda:3')
compute_norm is  tensor(50.8510, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(329.8984, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5624936008250028
avg test loss is  2.8539439925252754
avg accuracy is  0.1851666668230023
solo acc is  0.10120000015633197
compute similarity  is  tensor(0.8359, device='cuda:3')
compute_distance is  tensor(329.8984, device='cuda:3')
compute_norm is  tensor(61.0704, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(329.0968, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8588148120369739
avg test loss is  3.6027970260648585
avg accuracy is  0.1890166668230025
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.8358, device='cuda:3')
compute_distance is  tensor(329.0968, device='cuda:3')
compute_norm is  tensor(61.1685, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(327.4717, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5461640938766983
avg test loss is  2.8371917098315795
avg accuracy is  0.1923166668230027
solo acc is  0.10436666682299864
compute similarity  is  tensor(0.8358, device='cuda:3')
compute_distance is  tensor(327.4717, device='cuda:3')
compute_norm is  tensor(60.4685, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(326.8191, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8522150961320791
avg test loss is  3.5790831503837603
avg accuracy is  0.1930833334896694
solo acc is  0.10026666682299865
compute similarity  is  tensor(0.8357, device='cuda:3')
compute_distance is  tensor(326.8191, device='cuda:3')
compute_norm is  tensor(60.5887, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(325.5170, device='cuda:3')
distance x is tensor(325.5170, device='cuda:3')
________________________________
test distance is  tensor(325.5170, device='cuda:3')
test distance1 is  tensor(325.5170, device='cuda:3')
test similarity is  tensor(0.8357, device='cuda:3')
test acc is  0.10658333348966528
test loss is 2.8132983341908404
test entropy is  1.5372887308409473
________________________________
cal ratio is  0.7542915882496246
distance x is tensor(245.5394, device='cuda:3')
cal_distance is  tensor(245.5394, device='cuda:3')
cal ratio is  0.8684914576489737
distance x is tensor(213.2492, device='cuda:3')
cal_distance is  tensor(213.2492, device='cuda:3')
cal ratio is  0.93192812969641
distance x is tensor(198.7331, device='cuda:3')
cal_distance is  tensor(198.7331, device='cuda:3')
cal ratio is  0.9653637359645606
distance x is tensor(191.8498, device='cuda:3')
cal_distance is  tensor(191.8498, device='cuda:3')
distance x is tensor(191.8498, device='cuda:3')
return_distance is  tensor(191.8498, device='cuda:3')
distance x is tensor(191.8446, device='cuda:3')
distance x is tensor(191.8446, device='cuda:3')
________________________________
test distance is  tensor(191.8446, device='cuda:3')
test distance1 is  tensor(191.8446, device='cuda:3')
test similarity is  tensor(0.9264, device='cuda:3')
test acc is  0.10805000015633195
test loss is 2.519337636575516
test entropy is  1.9080702720928802
________________________________
0
distance x is tensor(191.8446, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9087839157088224
avg test loss is  2.51712453568668
avg accuracy is  0.35365000015634057
solo acc is  0.10780000015633195
compute similarity  is  tensor(0.9264, device='cuda:3')
compute_distance is  tensor(191.8446, device='cuda:3')
compute_norm is  tensor(51.7653, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.4214, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8159436786861054
avg test loss is  3.2402866542466415
avg accuracy is  0.3538666668230072
solo acc is  0.10075000015633197
compute similarity  is  tensor(0.9260, device='cuda:3')
compute_distance is  tensor(192.4214, device='cuda:3')
compute_norm is  tensor(52.0289, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.6298, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3470919563063681
avg test loss is  2.3665650859316276
avg accuracy is  0.3838833334896743
solo acc is  0.12646666682299856
compute similarity  is  tensor(0.9262, device='cuda:3')
compute_distance is  tensor(192.6298, device='cuda:3')
compute_norm is  tensor(51.4841, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.8922, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8062040804545763
avg test loss is  3.071796619307512
avg accuracy is  0.37835000015634085
solo acc is  0.10105000015633196
compute similarity  is  tensor(0.9258, device='cuda:3')
compute_distance is  tensor(192.8922, device='cuda:3')
compute_norm is  tensor(51.5431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.9717, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2010044282687498
avg test loss is  1.9908773092064522
avg accuracy is  0.4032333334896745
solo acc is  0.1849166668230022
compute similarity  is  tensor(0.9258, device='cuda:3')
compute_distance is  tensor(193.9717, device='cuda:3')
compute_norm is  tensor(51.0894, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(194.3725, device='cuda:3')
distance x is tensor(194.3725, device='cuda:3')
________________________________
test distance is  tensor(194.3725, device='cuda:3')
test distance1 is  tensor(194.3725, device='cuda:3')
test similarity is  tensor(0.9255, device='cuda:3')
test acc is  0.10656666682299862
test loss is 2.74642222878267
test entropy is  0.7080284472086282
________________________________
cal ratio is  0.976132496357428
distance x is tensor(189.7374, device='cuda:3')
cal_distance is  tensor(189.7374, device='cuda:3')
distance x is tensor(189.7374, device='cuda:3')
return_distance is  tensor(189.7374, device='cuda:3')
distance x is tensor(189.7332, device='cuda:3')
distance x is tensor(189.7332, device='cuda:3')
________________________________
test distance is  tensor(189.7332, device='cuda:3')
test distance1 is  tensor(189.7332, device='cuda:3')
test similarity is  tensor(0.9285, device='cuda:3')
test acc is  0.10533333348966528
test loss is 2.698594397573329
test entropy is  0.7541739739843015
________________________________
0
distance x is tensor(189.7332, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7554448714642636
avg test loss is  2.694152371715635
avg accuracy is  0.40381666682300776
solo acc is  0.10526666682299862
compute similarity  is  tensor(0.9285, device='cuda:3')
compute_distance is  tensor(189.7332, device='cuda:3')
compute_norm is  tensor(50.8284, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.3120, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0913532952001608
avg test loss is  1.804866301606713
avg accuracy is  0.43861666682300826
solo acc is  0.19598333348966948
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(191.3120, device='cuda:3')
compute_norm is  tensor(50.4513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.5552, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6660131200163095
avg test loss is  2.56172058195956
avg accuracy is  0.42330000015634134
solo acc is  0.10510000015633195
compute similarity  is  tensor(0.9277, device='cuda:3')
compute_distance is  tensor(191.5552, device='cuda:3')
compute_norm is  tensor(50.3374, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.9048, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0585789215335968
avg test loss is  1.7001704613028814
avg accuracy is  0.4583500001563417
solo acc is  0.20051666682300304
compute similarity  is  tensor(0.9272, device='cuda:3')
compute_distance is  tensor(192.9048, device='cuda:3')
compute_norm is  tensor(50.0064, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.0824, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6640580658719484
avg test loss is  2.4590220021794855
avg accuracy is  0.4413000001563416
solo acc is  0.10235000015633197
compute similarity  is  tensor(0.9268, device='cuda:3')
compute_distance is  tensor(193.0824, device='cuda:3')
compute_norm is  tensor(49.8812, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(194.3023, device='cuda:3')
________________________________
test distance is  tensor(194.3023, device='cuda:3')
test similarity is  tensor(0.9262, device='cuda:3')
test acc is  0.4832000001563419
test loss is 1.6315690442951503
test entropy is  1.0307215436943558
________________________________
final entropy
distance x is tensor(194.2985, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.029068980898176
avg test loss is  1.6341010856984266
avg accuracy is  0.4826833334896753
solo acc is  0.20328333348966987
compute similarity  is  tensor(0.9262, device='cuda:3')
compute_distance is  tensor(194.2985, device='cuda:3')
compute_norm is  tensor(49.5736, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.3248677253723145
mal norm is  tensor(844.6671, device='cuda:3')
distance x is tensor(194.4635, device='cuda:3')
mal distance is  tensor(194.4635, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 644.6046,  685.3745,  691.4214,  676.4623,  830.8207,  710.4022,
         767.7165,  733.8730,  844.6671,  844.6671,  844.6671,  844.6671,
         844.6671,  844.6671,  844.6671,  844.6671,  844.6671,  844.6671,
         844.6671,  844.6671, 1055.3782, 1049.6464, 1065.2487, 1095.5958,
        1072.8090, 1065.7139, 1088.4823, 1087.0651,  759.9769,  826.4846,
         791.3730,  823.4064,  788.6343,  757.1599,  797.4440,  785.9230,
         735.2476,  728.1322,  694.7573,  734.2335,  736.3655,  752.6122,
         696.5560,  770.2996], device='cuda:3')
sorted_norm is   tensor([ 644.6046,  676.4623,  685.3745,  691.4214,  694.7573,  696.5560,
         710.4022,  728.1322,  733.8730,  734.2335,  735.2476,  736.3655,
         752.6122,  757.1599,  759.9769,  767.7165,  770.2996,  785.9230,
         788.6343,  791.3730,  797.4440,  823.4064,  826.4846,  830.8207,
         844.6671,  844.6671,  844.6671,  844.6671,  844.6671,  844.6671,
         844.6671,  844.6671,  844.6671,  844.6671,  844.6671,  844.6671,
        1049.6464, 1055.3782, 1065.2487, 1065.7139, 1072.8090, 1087.0651,
        1088.4823, 1095.5958], device='cuda:3')
used idx is  tensor([ 0,  3,  1,  2, 38, 42,  5, 37,  7, 39, 36, 40, 41, 33, 28,  6, 43, 35,
        32, 30, 34, 31, 29,  4, 11, 10,  8,  9, 19, 18, 16, 17, 13, 12, 14],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 61.52% 

Test Accuracy: 60.28% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8376472592353821
distance x is tensor(155.1074, device='cuda:3')
benign distance is  tensor(155.1074, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7852298617362976
distance x is tensor(174.7268, device='cuda:3')
benign distance is  tensor(174.7268, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03943014144897461
distance x is tensor(158.8232, device='cuda:3')
benign distance is  tensor(158.8232, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8873693346977234
distance x is tensor(147.6432, device='cuda:3')
benign distance is  tensor(147.6432, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9573370814323425
distance x is tensor(152.0063, device='cuda:3')
benign distance is  tensor(152.0063, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.358091950416565
distance x is tensor(167.5666, device='cuda:3')
benign distance is  tensor(167.5666, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3577510714530945
distance x is tensor(149.8901, device='cuda:3')
benign distance is  tensor(149.8901, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5823413133621216
distance x is tensor(145.6506, device='cuda:3')
benign distance is  tensor(145.6506, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.28766804933547974
distance x is tensor(146.1803, device='cuda:3')
benign distance is  tensor(146.1803, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2532958686351776
distance x is tensor(161.5799, device='cuda:3')
benign distance is  tensor(161.5799, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2237393856048584
distance x is tensor(153.9796, device='cuda:3')
benign distance is  tensor(153.9796, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.679102897644043
distance x is tensor(157.7327, device='cuda:3')
benign distance is  tensor(157.7327, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.19748258590698242
distance x is tensor(158.1007, device='cuda:3')
benign distance is  tensor(158.1007, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23813386261463165
distance x is tensor(169.7158, device='cuda:3')
benign distance is  tensor(169.7158, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7282620668411255
distance x is tensor(151.5037, device='cuda:3')
benign distance is  tensor(151.5037, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7406447529792786
distance x is tensor(161.2576, device='cuda:3')
benign distance is  tensor(161.2576, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5015074014663696
distance x is tensor(153.7723, device='cuda:3')
benign distance is  tensor(153.7723, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6882310509681702
distance x is tensor(172.1360, device='cuda:3')
benign distance is  tensor(172.1360, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3233758807182312
distance x is tensor(158.4618, device='cuda:3')
benign distance is  tensor(158.4618, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3397628366947174
distance x is tensor(164.6741, device='cuda:3')
benign distance is  tensor(164.6741, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.30761411786079407
distance x is tensor(153.3819, device='cuda:3')
benign distance is  tensor(153.3819, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5992634892463684
distance x is tensor(156.3839, device='cuda:3')
benign distance is  tensor(156.3839, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6059218645095825
distance x is tensor(167.0689, device='cuda:3')
benign distance is  tensor(167.0689, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.41369014978408813
distance x is tensor(166.6941, device='cuda:3')
benign distance is  tensor(166.6941, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.43427497148513794
distance x is tensor(155.2317, device='cuda:3')
benign distance is  tensor(155.2317, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.533092737197876
distance x is tensor(149.5915, device='cuda:3')
benign distance is  tensor(149.5915, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.27415281534194946
distance x is tensor(152.7625, device='cuda:3')
benign distance is  tensor(152.7625, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.19977614283561707
distance x is tensor(171.5119, device='cuda:3')
benign distance is  tensor(171.5119, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.21606965363025665
distance x is tensor(157.7097, device='cuda:3')
benign distance is  tensor(157.7097, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8915007710456848
distance x is tensor(145.0208, device='cuda:3')
benign distance is  tensor(145.0208, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.3912347555160522
distance x is tensor(160.4197, device='cuda:3')
benign distance is  tensor(160.4197, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4612157940864563
distance x is tensor(158.1174, device='cuda:3')
benign distance is  tensor(158.1174, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(148.5224, device='cuda:3')
compute distance is  tensor(148.5224, device='cuda:3')
compute norm is  tensor(47.0706, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3229, device='cuda:3')
compute distance is  tensor(146.3229, device='cuda:3')
compute norm is  tensor(46.9940, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.6284, device='cuda:3')
compute distance is  tensor(153.6284, device='cuda:3')
compute norm is  tensor(47.2470, device='cuda:3', dtype=torch.float64)
distance x is tensor(184.0763, device='cuda:3')
compute distance is  tensor(184.0763, device='cuda:3')
compute norm is  tensor(47.9799, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.0876, device='cuda:3')
compute distance is  tensor(163.0876, device='cuda:3')
compute norm is  tensor(47.4504, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.9767, device='cuda:3')
compute distance is  tensor(178.9767, device='cuda:3')
compute norm is  tensor(47.9838, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.4716, device='cuda:3')
compute distance is  tensor(159.4716, device='cuda:3')
compute norm is  tensor(47.3814, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5533, device='cuda:3')
compute distance is  tensor(158.5533, device='cuda:3')
compute norm is  tensor(47.4438, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.2949, device='cuda:3')
compute distance is  tensor(163.2949, device='cuda:3')
compute norm is  tensor(47.5370, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.8945, device='cuda:3')
compute distance is  tensor(164.8945, device='cuda:3')
compute norm is  tensor(47.7616, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.8979, device='cuda:3')
compute distance is  tensor(157.8979, device='cuda:3')
compute norm is  tensor(47.4740, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.8009, device='cuda:3')
compute distance is  tensor(158.8009, device='cuda:3')
compute norm is  tensor(47.3413, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(184.0763, device='cuda:3')
distance x is tensor(107635.6406, device='cuda:3')
distance x is tensor(107635.6406, device='cuda:3')
________________________________
test distance is  tensor(107635.6406, device='cuda:3')
test distance1 is  tensor(107635.6406, device='cuda:3')
test similarity is  tensor(0.2227, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130146237701602.53
test entropy is  0.0
________________________________
cal ratio is  0.04052723294668103
distance x is tensor(4362.1797, device='cuda:3')
cal_distance is  tensor(4362.1797, device='cuda:3')
cal ratio is  0.201313652903232
distance x is tensor(878.1704, device='cuda:3')
cal_distance is  tensor(878.1704, device='cuda:3')
cal ratio is  0.4486788623045876
distance x is tensor(394.0193, device='cuda:3')
cal_distance is  tensor(394.0193, device='cuda:3')
cal ratio is  0.6698325318842422
distance x is tensor(263.9287, device='cuda:3')
cal_distance is  tensor(263.9287, device='cuda:3')
cal ratio is  0.8184303361594466
distance x is tensor(216.0081, device='cuda:3')
cal_distance is  tensor(216.0081, device='cuda:3')
cal ratio is  0.9046694777016221
distance x is tensor(195.4165, device='cuda:3')
cal_distance is  tensor(195.4165, device='cuda:3')
cal ratio is  0.9511399960919298
distance x is tensor(185.8687, device='cuda:3')
cal_distance is  tensor(185.8687, device='cuda:3')
cal ratio is  0.9752633280582882
distance x is tensor(181.2710, device='cuda:3')
cal_distance is  tensor(181.2710, device='cuda:3')
distance x is tensor(181.2710, device='cuda:3')
return_distance is  tensor(181.2710, device='cuda:3')
distance x is tensor(181.2609, device='cuda:3')
distance x is tensor(181.2609, device='cuda:3')
________________________________
test distance is  tensor(181.2609, device='cuda:3')
test distance1 is  tensor(181.2609, device='cuda:3')
test similarity is  tensor(0.9260, device='cuda:3')
test acc is  0.10276666682299863
test loss is 255.7036389186184
test entropy is  0.0019216539295155712
________________________________
0
distance x is tensor(181.2609, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0018208243717827374
avg test loss is  256.413210919671
avg accuracy is  0.616466666823003
solo acc is  0.10300000015633197
compute similarity  is  tensor(0.9260, device='cuda:3')
compute_distance is  tensor(181.2609, device='cuda:3')
compute_norm is  tensor(49.9789, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.3061, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3895423271254437
avg test loss is  2.3863116890382665
avg accuracy is  0.4040500001563412
solo acc is  0.12456666682299859
compute similarity  is  tensor(0.9274, device='cuda:3')
compute_distance is  tensor(182.3061, device='cuda:3')
compute_norm is  tensor(51.1060, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.9949, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8065863662818348
avg test loss is  3.1049248267338476
avg accuracy is  0.3971166668230077
solo acc is  0.1018833334896653
compute similarity  is  tensor(0.9271, device='cuda:3')
compute_distance is  tensor(182.9949, device='cuda:3')
compute_norm is  tensor(51.1693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183.4127, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2086756117562496
avg test loss is  1.963062724452029
avg accuracy is  0.4532666668230083
solo acc is  0.17973333348966852
compute similarity  is  tensor(0.9278, device='cuda:3')
compute_distance is  tensor(183.4127, device='cuda:3')
compute_norm is  tensor(50.8295, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(184.0202, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7142225940471519
avg test loss is  2.749229766158407
avg accuracy is  0.4447000001563416
solo acc is  0.10536666682299863
compute similarity  is  tensor(0.9276, device='cuda:3')
compute_distance is  tensor(184.0202, device='cuda:3')
compute_norm is  tensor(50.7973, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(184.3411, device='cuda:3')
distance x is tensor(184.3411, device='cuda:3')
________________________________
test distance is  tensor(184.3411, device='cuda:3')
test distance1 is  tensor(184.3411, device='cuda:3')
test similarity is  tensor(0.9281, device='cuda:3')
test acc is  0.21696666682300375
test loss is 1.7419086038939227
test entropy is  1.1063356878660888
________________________________
cal ratio is  0.9792958465680328
distance x is tensor(180.5331, device='cuda:3')
cal_distance is  tensor(180.5331, device='cuda:3')
distance x is tensor(180.5331, device='cuda:3')
return_distance is  tensor(180.5331, device='cuda:3')
distance x is tensor(180.5244, device='cuda:3')
distance x is tensor(180.5244, device='cuda:3')
________________________________
test distance is  tensor(180.5244, device='cuda:3')
test distance1 is  tensor(180.5244, device='cuda:3')
test similarity is  tensor(0.9305, device='cuda:3')
test acc is  0.19818333348966954
test loss is 1.7680817076138087
test entropy is  1.131858642675729
________________________________
0
distance x is tensor(180.5244, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1322435635620598
avg test loss is  1.7635636377944621
avg accuracy is  0.4896166668230087
solo acc is  0.200016666823003
compute similarity  is  tensor(0.9305, device='cuda:3')
compute_distance is  tensor(180.5244, device='cuda:3')
compute_norm is  tensor(50.2529, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(181.1983, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6665007964507349
avg test loss is  2.5877695886819345
avg accuracy is  0.47650000015634186
solo acc is  0.10400000015633197
compute similarity  is  tensor(0.9302, device='cuda:3')
compute_distance is  tensor(181.1983, device='cuda:3')
compute_norm is  tensor(50.1705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.4822, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0194084109909245
avg test loss is  1.6131446944879317
avg accuracy is  0.5222833334896756
solo acc is  0.22510000015633738
compute similarity  is  tensor(0.9305, device='cuda:3')
compute_distance is  tensor(181.4822, device='cuda:3')
compute_norm is  tensor(49.8134, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(181.9674, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6281741426062228
avg test loss is  2.4392843581974377
avg accuracy is  0.5032666668230087
solo acc is  0.1038833334896653
compute similarity  is  tensor(0.9302, device='cuda:3')
compute_distance is  tensor(181.9674, device='cuda:3')
compute_norm is  tensor(49.6738, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.2408, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9907033177835347
avg test loss is  1.5865807819213948
avg accuracy is  0.5372166668230091
solo acc is  0.20686666682300328
compute similarity  is  tensor(0.9303, device='cuda:3')
compute_distance is  tensor(182.2408, device='cuda:3')
compute_norm is  tensor(49.3759, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(182.2408, device='cuda:3')
distance x is tensor(182.2408, device='cuda:3')
________________________________
test distance is  tensor(182.2408, device='cuda:3')
test distance1 is  tensor(182.2408, device='cuda:3')
test similarity is  tensor(0.9303, device='cuda:3')
test acc is  0.20906666682300343
test loss is 1.5815940660708494
test entropy is  0.991542025415628
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4829776287078857
mal norm is  tensor(856.0276, device='cuda:3')
distance x is tensor(182.2493, device='cuda:3')
mal distance is  tensor(182.2493, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([642.0459, 703.7313, 636.1653, 598.8309, 618.4010, 676.3546, 610.3225,
        609.8923, 856.0276, 856.0276, 856.0276, 856.0276, 856.0276, 856.0276,
        856.0276, 856.0276, 856.0276, 856.0276, 856.0276, 856.0276],
       device='cuda:3')
sorted_norm is   tensor([598.8309, 609.8923, 610.3225, 618.4010, 636.1653, 642.0459, 676.3546,
        703.7313, 856.0276, 856.0276, 856.0276, 856.0276, 856.0276, 856.0276,
        856.0276, 856.0276, 856.0276, 856.0276, 856.0276, 856.0276],
       device='cuda:3')
used idx is  tensor([ 3,  7,  6,  4,  2,  0,  5,  1, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 72.66% 

Test Accuracy: 71.42% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5785801410675049
distance x is tensor(169.6391, device='cuda:3')
benign distance is  tensor(169.6391, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5185680389404297
distance x is tensor(173.3280, device='cuda:3')
benign distance is  tensor(173.3280, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0964665338397026
distance x is tensor(164.2772, device='cuda:3')
benign distance is  tensor(164.2772, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1879992485046387
distance x is tensor(176.8681, device='cuda:3')
benign distance is  tensor(176.8681, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.47969430685043335
distance x is tensor(156.2651, device='cuda:3')
benign distance is  tensor(156.2651, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42573079466819763
distance x is tensor(160.8835, device='cuda:3')
benign distance is  tensor(160.8835, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39044466614723206
distance x is tensor(171.1611, device='cuda:3')
benign distance is  tensor(171.1611, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8003959655761719
distance x is tensor(163.7299, device='cuda:3')
benign distance is  tensor(163.7299, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(148.3777, device='cuda:3')
compute distance is  tensor(148.3777, device='cuda:3')
compute norm is  tensor(48.9363, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.0159, device='cuda:3')
compute distance is  tensor(166.0159, device='cuda:3')
compute norm is  tensor(49.4277, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.2032, device='cuda:3')
compute distance is  tensor(177.2032, device='cuda:3')
compute norm is  tensor(49.8304, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.7547, device='cuda:3')
compute distance is  tensor(170.7547, device='cuda:3')
compute norm is  tensor(49.6123, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.4845, device='cuda:3')
compute distance is  tensor(175.4845, device='cuda:3')
compute norm is  tensor(49.7324, device='cuda:3', dtype=torch.float64)
distance x is tensor(196.6899, device='cuda:3')
compute distance is  tensor(196.6899, device='cuda:3')
compute norm is  tensor(50.1593, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.1197, device='cuda:3')
compute distance is  tensor(177.1197, device='cuda:3')
compute norm is  tensor(49.7087, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.1962, device='cuda:3')
compute distance is  tensor(168.1962, device='cuda:3')
compute norm is  tensor(49.4783, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.0668, device='cuda:3')
compute distance is  tensor(171.0668, device='cuda:3')
compute norm is  tensor(49.5488, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.6337, device='cuda:3')
compute distance is  tensor(153.6337, device='cuda:3')
compute norm is  tensor(49.2582, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.6656, device='cuda:3')
compute distance is  tensor(175.6656, device='cuda:3')
compute norm is  tensor(49.5192, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.9142, device='cuda:3')
compute distance is  tensor(161.9142, device='cuda:3')
compute norm is  tensor(49.2503, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(196.6899, device='cuda:3')
distance x is tensor(107596.8984, device='cuda:3')
distance x is tensor(107596.8984, device='cuda:3')
________________________________
test distance is  tensor(107596.8984, device='cuda:3')
test distance1 is  tensor(107596.8984, device='cuda:3')
test similarity is  tensor(0.3659, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130121399632500.81
test entropy is  0.0
________________________________
cal ratio is  0.04190031259833811
distance x is tensor(4508.3491, device='cuda:3')
cal_distance is  tensor(4508.3491, device='cuda:3')
cal ratio is  0.20469552847718103
distance x is tensor(922.8430, device='cuda:3')
cal_distance is  tensor(922.8430, device='cuda:3')
cal ratio is  0.4524319210857311
distance x is tensor(417.5264, device='cuda:3')
cal_distance is  tensor(417.5264, device='cuda:3')
cal ratio is  0.6726283737857258
distance x is tensor(280.8417, device='cuda:3')
cal_distance is  tensor(280.8417, device='cuda:3')
cal ratio is  0.8201368346253617
distance x is tensor(230.3296, device='cuda:3')
cal_distance is  tensor(230.3296, device='cuda:3')
cal ratio is  0.9056122489621249
distance x is tensor(208.5898, device='cuda:3')
cal_distance is  tensor(208.5898, device='cuda:3')
cal ratio is  0.9516354298322584
distance x is tensor(198.5017, device='cuda:3')
cal_distance is  tensor(198.5017, device='cuda:3')
cal ratio is  0.9755174790565895
distance x is tensor(193.6420, device='cuda:3')
cal_distance is  tensor(193.6420, device='cuda:3')
distance x is tensor(193.6420, device='cuda:3')
return_distance is  tensor(193.6420, device='cuda:3')
distance x is tensor(193.6319, device='cuda:3')
distance x is tensor(193.6319, device='cuda:3')
________________________________
test distance is  tensor(193.6319, device='cuda:3')
test distance1 is  tensor(193.6319, device='cuda:3')
test similarity is  tensor(0.9376, device='cuda:3')
test acc is  0.230883333489671
test loss is 45.22587585449219
test entropy is  0.06725762846759523
________________________________
0
distance x is tensor(193.6319, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.06514046855294692
avg test loss is  45.50879452426805
avg accuracy is  0.6707666668229991
solo acc is  0.22843333348967096
compute similarity  is  tensor(0.9376, device='cuda:3')
compute_distance is  tensor(193.6319, device='cuda:3')
compute_norm is  tensor(53.4975, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(186.2065, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1014519521930832
avg test loss is  1.770473028296855
avg accuracy is  0.6229166668230025
solo acc is  0.19770000015633626
compute similarity  is  tensor(0.9391, device='cuda:3')
compute_distance is  tensor(186.2065, device='cuda:3')
compute_norm is  tensor(53.5609, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(186.3499, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.669778221197474
avg test loss is  2.5596769722794166
avg accuracy is  0.602866666823004
solo acc is  0.10531666682299862
compute similarity  is  tensor(0.9390, device='cuda:3')
compute_distance is  tensor(186.3499, device='cuda:3')
compute_norm is  tensor(53.4234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(186.8454, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.015501587693371
avg test loss is  1.652631387146297
avg accuracy is  0.6741833334896655
solo acc is  0.2152166668230037
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(186.8454, device='cuda:3')
compute_norm is  tensor(53.0982, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(186.9180, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6180685846917411
avg test loss is  2.4649401699810394
avg accuracy is  0.6495833334896672
solo acc is  0.10566666682299863
compute similarity  is  tensor(0.9390, device='cuda:3')
compute_distance is  tensor(186.9180, device='cuda:3')
compute_norm is  tensor(52.9347, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(187.0612, device='cuda:3')
distance x is tensor(187.0612, device='cuda:3')
________________________________
test distance is  tensor(187.0612, device='cuda:3')
test distance1 is  tensor(187.0612, device='cuda:3')
test similarity is  tensor(0.9391, device='cuda:3')
test acc is  0.23968333348967133
test loss is 1.5282372201937857
test entropy is  0.9866377867615299
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.4606821537017822
mal norm is  tensor(938.8240, device='cuda:3')
distance x is tensor(187.0709, device='cuda:3')
mal distance is  tensor(187.0709, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([694.3392, 709.6639, 675.6887, 687.1545, 641.6364, 675.5296, 695.0870,
        672.7943, 938.8240, 938.8240, 938.8240, 938.8240, 938.8240, 938.8240,
        938.8240, 938.8240, 938.8240, 938.8240, 938.8240, 938.8240, 945.9309,
        874.6041, 944.2656, 933.5693, 932.9449, 941.5805, 934.6739, 942.3614,
        750.8079, 796.2751, 762.7181, 790.8085, 781.4499, 825.4638, 772.4122,
        807.9581], device='cuda:3')
sorted_norm is   tensor([641.6364, 672.7943, 675.5296, 675.6887, 687.1545, 694.3392, 695.0870,
        709.6639, 750.8079, 762.7181, 772.4122, 781.4499, 790.8085, 796.2751,
        807.9581, 825.4638, 874.6041, 932.9449, 933.5693, 934.6739, 938.8240,
        938.8240, 938.8240, 938.8240, 938.8240, 938.8240, 938.8240, 938.8240,
        938.8240, 938.8240, 938.8240, 938.8240, 941.5805, 942.3614, 944.2656,
        945.9309], device='cuda:3')
used idx is  tensor([ 4,  7,  5,  2,  3,  0,  6,  1, 28, 30, 34, 32, 31, 29, 35, 33, 21, 24,
        23, 26, 11, 10,  8,  9, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 86.42% 

Test Accuracy: 85.26% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2696900963783264
distance x is tensor(157.5752, device='cuda:3')
benign distance is  tensor(157.5752, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4231359362602234
distance x is tensor(141.6417, device='cuda:3')
benign distance is  tensor(141.6417, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20665939152240753
distance x is tensor(143.6698, device='cuda:3')
benign distance is  tensor(143.6698, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5367087125778198
distance x is tensor(146.3729, device='cuda:3')
benign distance is  tensor(146.3729, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.524222731590271
distance x is tensor(128.1819, device='cuda:3')
benign distance is  tensor(128.1819, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9428392648696899
distance x is tensor(163.2533, device='cuda:3')
benign distance is  tensor(163.2533, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3370720446109772
distance x is tensor(142.6672, device='cuda:3')
benign distance is  tensor(142.6672, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.15844713151454926
distance x is tensor(159.1230, device='cuda:3')
benign distance is  tensor(159.1230, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5491331219673157
distance x is tensor(160.7347, device='cuda:3')
benign distance is  tensor(160.7347, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7519367337226868
distance x is tensor(148.1707, device='cuda:3')
benign distance is  tensor(148.1707, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9459911584854126
distance x is tensor(140.1885, device='cuda:3')
benign distance is  tensor(140.1885, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2816442847251892
distance x is tensor(151.5371, device='cuda:3')
benign distance is  tensor(151.5371, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6857926249504089
distance x is tensor(143.5640, device='cuda:3')
benign distance is  tensor(143.5640, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.38656702637672424
distance x is tensor(149.5823, device='cuda:3')
benign distance is  tensor(149.5823, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5402372479438782
distance x is tensor(148.0098, device='cuda:3')
benign distance is  tensor(148.0098, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44586387276649475
distance x is tensor(154.3968, device='cuda:3')
benign distance is  tensor(154.3968, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.10616059601306915
distance x is tensor(152.9973, device='cuda:3')
benign distance is  tensor(152.9973, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8937464952468872
distance x is tensor(136.0538, device='cuda:3')
benign distance is  tensor(136.0538, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.39909064769744873
distance x is tensor(160.9279, device='cuda:3')
benign distance is  tensor(160.9279, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.25954681634902954
distance x is tensor(153.9701, device='cuda:3')
benign distance is  tensor(153.9701, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6429015398025513
distance x is tensor(145.6425, device='cuda:3')
benign distance is  tensor(145.6425, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4200902581214905
distance x is tensor(142.5300, device='cuda:3')
benign distance is  tensor(142.5300, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.30586785078048706
distance x is tensor(145.0281, device='cuda:3')
benign distance is  tensor(145.0281, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.16479898989200592
distance x is tensor(136.3615, device='cuda:3')
benign distance is  tensor(136.3615, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(153.5761, device='cuda:3')
compute distance is  tensor(153.5761, device='cuda:3')
compute norm is  tensor(49.4212, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.9433, device='cuda:3')
compute distance is  tensor(146.9433, device='cuda:3')
compute norm is  tensor(49.2802, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.4691, device='cuda:3')
compute distance is  tensor(155.4691, device='cuda:3')
compute norm is  tensor(49.6009, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.2372, device='cuda:3')
compute distance is  tensor(185.2372, device='cuda:3')
compute norm is  tensor(50.2131, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.7928, device='cuda:3')
compute distance is  tensor(152.7928, device='cuda:3')
compute norm is  tensor(49.5857, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7540, device='cuda:3')
compute distance is  tensor(142.7540, device='cuda:3')
compute norm is  tensor(49.2798, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7326, device='cuda:3')
compute distance is  tensor(146.7326, device='cuda:3')
compute norm is  tensor(49.3594, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.9110, device='cuda:3')
compute distance is  tensor(159.9110, device='cuda:3')
compute norm is  tensor(49.6443, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.5479, device='cuda:3')
compute distance is  tensor(157.5479, device='cuda:3')
compute norm is  tensor(49.4096, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7806, device='cuda:3')
compute distance is  tensor(144.7806, device='cuda:3')
compute norm is  tensor(49.3411, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5266, device='cuda:3')
compute distance is  tensor(144.5266, device='cuda:3')
compute norm is  tensor(49.3260, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8683, device='cuda:3')
compute distance is  tensor(146.8683, device='cuda:3')
compute norm is  tensor(49.3325, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(185.2372, device='cuda:3')
distance x is tensor(107588.6797, device='cuda:3')
distance x is tensor(107588.6797, device='cuda:3')
________________________________
test distance is  tensor(107588.6797, device='cuda:3')
test distance1 is  tensor(107588.6797, device='cuda:3')
test similarity is  tensor(0.3722, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130039890345634.66
test entropy is  0.0
________________________________
cal ratio is  0.0406636946901549
distance x is tensor(4374.9590, device='cuda:3')
cal_distance is  tensor(4374.9590, device='cuda:3')
cal ratio is  0.20165227340550113
distance x is tensor(882.2245, device='cuda:3')
cal_distance is  tensor(882.2245, device='cuda:3')
cal ratio is  0.4490560656984511
distance x is tensor(396.1710, device='cuda:3')
cal_distance is  tensor(396.1710, device='cuda:3')
cal ratio is  0.6701141295178429
distance x is tensor(265.4814, device='cuda:3')
cal_distance is  tensor(265.4814, device='cuda:3')
cal ratio is  0.8186024502741307
distance x is tensor(217.3247, device='cuda:3')
cal_distance is  tensor(217.3247, device='cuda:3')
cal ratio is  0.9047645772538057
distance x is tensor(196.6282, device='cuda:3')
cal_distance is  tensor(196.6282, device='cuda:3')
cal ratio is  0.9511899482780263
distance x is tensor(187.0310, device='cuda:3')
cal_distance is  tensor(187.0310, device='cuda:3')
cal ratio is  0.9752890366772643
distance x is tensor(182.4094, device='cuda:3')
cal_distance is  tensor(182.4094, device='cuda:3')
distance x is tensor(182.4094, device='cuda:3')
return_distance is  tensor(182.4094, device='cuda:3')
distance x is tensor(182.3993, device='cuda:3')
distance x is tensor(182.3993, device='cuda:3')
________________________________
test distance is  tensor(182.3993, device='cuda:3')
test distance1 is  tensor(182.3993, device='cuda:3')
test similarity is  tensor(0.9446, device='cuda:3')
test acc is  0.10116666682299863
test loss is 280.4015413459176
test entropy is  0.0005267276705122442
________________________________
0
distance x is tensor(182.3993, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0004994103542522263
avg test loss is  279.9561129572041
avg accuracy is  0.46818333348967517
solo acc is  0.10136666682299864
compute similarity  is  tensor(0.9446, device='cuda:3')
compute_distance is  tensor(182.3993, device='cuda:3')
compute_norm is  tensor(53.3729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(184.7066, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3107234722515668
avg test loss is  2.0874395184933756
avg accuracy is  0.4785500001563419
solo acc is  0.1734000001563349
compute similarity  is  tensor(0.9433, device='cuda:3')
compute_distance is  tensor(184.7066, device='cuda:3')
compute_norm is  tensor(54.5514, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(185.2750, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7630609425781633
avg test loss is  2.902016881178183
avg accuracy is  0.4733500001563418
solo acc is  0.1042833334896653
compute similarity  is  tensor(0.9431, device='cuda:3')
compute_distance is  tensor(185.2750, device='cuda:3')
compute_norm is  tensor(54.5611, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(185.2722, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1733572006479764
avg test loss is  1.8990760096100603
avg accuracy is  0.5154000001563422
solo acc is  0.20671666682300333
compute similarity  is  tensor(0.9437, device='cuda:3')
compute_distance is  tensor(185.2722, device='cuda:3')
compute_norm is  tensor(54.1808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(185.7392, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7078381772361585
avg test loss is  2.7325710680947375
avg accuracy is  0.5116500001563421
solo acc is  0.10465000015633195
compute similarity  is  tensor(0.9435, device='cuda:3')
compute_distance is  tensor(185.7392, device='cuda:3')
compute_norm is  tensor(54.1201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(185.5317, device='cuda:3')
distance x is tensor(185.5317, device='cuda:3')
________________________________
test distance is  tensor(185.5317, device='cuda:3')
test distance1 is  tensor(185.5317, device='cuda:3')
test similarity is  tensor(0.9439, device='cuda:3')
test acc is  0.2268333334896708
test loss is 1.7672633097878396
test entropy is  1.0823926423022996
________________________________
cal ratio is  0.9792217818487626
distance x is tensor(181.6859, device='cuda:3')
cal_distance is  tensor(181.6859, device='cuda:3')
distance x is tensor(181.6859, device='cuda:3')
return_distance is  tensor(181.6859, device='cuda:3')
distance x is tensor(181.6766, device='cuda:3')
distance x is tensor(181.6766, device='cuda:3')
________________________________
test distance is  tensor(181.6766, device='cuda:3')
test distance1 is  tensor(181.6766, device='cuda:3')
test similarity is  tensor(0.9458, device='cuda:3')
test acc is  0.2170500001563371
test loss is 1.7598426822406144
test entropy is  1.106688952967048
________________________________
0
distance x is tensor(181.6766, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1060676825071958
avg test loss is  1.7689842585561626
avg accuracy is  0.5877666668230052
solo acc is  0.21670000015633706
compute similarity  is  tensor(0.9458, device='cuda:3')
compute_distance is  tensor(181.6766, device='cuda:3')
compute_norm is  tensor(53.5518, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.1238, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6620833385727807
avg test loss is  2.616600699770425
avg accuracy is  0.5796333334896727
solo acc is  0.10341666682299863
compute similarity  is  tensor(0.9455, device='cuda:3')
compute_distance is  tensor(182.1238, device='cuda:3')
compute_norm is  tensor(53.4456, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.1112, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.047025874797215
avg test loss is  1.6903625589443931
avg accuracy is  0.620900000156336
solo acc is  0.20948333348967013
compute similarity  is  tensor(0.9458, device='cuda:3')
compute_distance is  tensor(182.1112, device='cuda:3')
compute_norm is  tensor(53.1080, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.4204, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6492982530898885
avg test loss is  2.4782509918151887
avg accuracy is  0.616216666823003
solo acc is  0.1035333334896653
compute similarity  is  tensor(0.9455, device='cuda:3')
compute_distance is  tensor(182.4204, device='cuda:3')
compute_norm is  tensor(52.9745, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.5648, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9807071549170561
avg test loss is  1.6460394090426755
avg accuracy is  0.6453333334896675
solo acc is  0.23188333348967102
compute similarity  is  tensor(0.9457, device='cuda:3')
compute_distance is  tensor(182.5648, device='cuda:3')
compute_norm is  tensor(52.6512, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(182.5648, device='cuda:3')
distance x is tensor(182.5648, device='cuda:3')
________________________________
test distance is  tensor(182.5648, device='cuda:3')
test distance1 is  tensor(182.5648, device='cuda:3')
test similarity is  tensor(0.9457, device='cuda:3')
test acc is  0.2343000001563377
test loss is 1.6456562126877465
test entropy is  0.979140765504288
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.7267796993255615
mal norm is  tensor(861.3862, device='cuda:3')
distance x is tensor(182.5739, device='cuda:3')
mal distance is  tensor(182.5739, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([639.2446, 581.0297, 583.4395, 593.4755, 520.2573, 663.9312, 579.3149,
        640.5376, 861.3862, 861.3863, 861.3862, 861.3863, 861.3862, 861.3863,
        861.3862, 861.3863, 861.3862, 861.3863, 861.3862, 861.3863, 766.1396,
        828.7698, 773.2719, 794.1003, 761.8866, 756.9111, 788.3788, 806.1189],
       device='cuda:3')
sorted_norm is   tensor([520.2573, 579.3149, 581.0297, 583.4395, 593.4755, 639.2446, 640.5376,
        663.9312, 756.9111, 761.8866, 766.1396, 773.2719, 788.3788, 794.1003,
        806.1189, 828.7698, 861.3862, 861.3862, 861.3862, 861.3862, 861.3862,
        861.3862, 861.3863, 861.3863, 861.3863, 861.3863, 861.3863, 861.3863],
       device='cuda:3')
used idx is  tensor([ 4,  6,  1,  2,  3,  0,  7,  5, 25, 24, 20, 22, 26, 23, 27, 21, 18, 16,
        12, 14, 10,  8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 85.04% 

Test Accuracy: 84.05% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5305403470993042
distance x is tensor(132.2301, device='cuda:3')
benign distance is  tensor(132.2301, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4838668406009674
distance x is tensor(130.9339, device='cuda:3')
benign distance is  tensor(130.9339, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.48002004623413086
distance x is tensor(135.4013, device='cuda:3')
benign distance is  tensor(135.4013, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.28712794184684753
distance x is tensor(127.7098, device='cuda:3')
benign distance is  tensor(127.7098, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3061142563819885
distance x is tensor(148.1260, device='cuda:3')
benign distance is  tensor(148.1260, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5524201393127441
distance x is tensor(138.2753, device='cuda:3')
benign distance is  tensor(138.2753, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3792893588542938
distance x is tensor(138.6924, device='cuda:3')
benign distance is  tensor(138.6924, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7538191080093384
distance x is tensor(142.8813, device='cuda:3')
benign distance is  tensor(142.8813, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6464847922325134
distance x is tensor(136.6749, device='cuda:3')
benign distance is  tensor(136.6749, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.41250577569007874
distance x is tensor(149.0474, device='cuda:3')
benign distance is  tensor(149.0474, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6123528480529785
distance x is tensor(152.1664, device='cuda:3')
benign distance is  tensor(152.1664, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5282018184661865
distance x is tensor(142.8938, device='cuda:3')
benign distance is  tensor(142.8938, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1349576860666275
distance x is tensor(141.7181, device='cuda:3')
benign distance is  tensor(141.7181, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8163871765136719
distance x is tensor(124.1036, device='cuda:3')
benign distance is  tensor(124.1036, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.43652644753456116
distance x is tensor(149.8120, device='cuda:3')
benign distance is  tensor(149.8120, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7144643068313599
distance x is tensor(130.0703, device='cuda:3')
benign distance is  tensor(130.0703, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(134.7119, device='cuda:3')
compute distance is  tensor(134.7119, device='cuda:3')
compute norm is  tensor(49.4038, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.7150, device='cuda:3')
compute distance is  tensor(122.7150, device='cuda:3')
compute norm is  tensor(49.1943, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.6596, device='cuda:3')
compute distance is  tensor(136.6596, device='cuda:3')
compute norm is  tensor(49.6529, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8482, device='cuda:3')
compute distance is  tensor(145.8482, device='cuda:3')
compute norm is  tensor(49.7682, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.3671, device='cuda:3')
compute distance is  tensor(145.3671, device='cuda:3')
compute norm is  tensor(49.8732, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1947, device='cuda:3')
compute distance is  tensor(145.1947, device='cuda:3')
compute norm is  tensor(49.7389, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.4836, device='cuda:3')
compute distance is  tensor(132.4836, device='cuda:3')
compute norm is  tensor(49.5016, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5023, device='cuda:3')
compute distance is  tensor(133.5023, device='cuda:3')
compute norm is  tensor(49.6347, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3559, device='cuda:3')
compute distance is  tensor(141.3559, device='cuda:3')
compute norm is  tensor(49.7237, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4482, device='cuda:3')
compute distance is  tensor(137.4482, device='cuda:3')
compute norm is  tensor(49.6730, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9673, device='cuda:3')
compute distance is  tensor(144.9673, device='cuda:3')
compute norm is  tensor(49.8979, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4060, device='cuda:3')
compute distance is  tensor(128.4060, device='cuda:3')
compute norm is  tensor(49.4578, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.8482, device='cuda:3')
distance x is tensor(107592.7266, device='cuda:3')
distance x is tensor(107592.7266, device='cuda:3')
________________________________
test distance is  tensor(107592.7266, device='cuda:3')
test distance1 is  tensor(107592.7266, device='cuda:3')
test similarity is  tensor(0.3738, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130034825155669.16
test entropy is  0.0
________________________________
cal ratio is  0.0360815458770726
distance x is tensor(3882.1177, device='cuda:3')
cal_distance is  tensor(3882.1177, device='cuda:3')
cal ratio is  0.18995129445282713
distance x is tensor(737.4173, device='cuda:3')
cal_distance is  tensor(737.4173, device='cuda:3')
cal ratio is  0.43583283179623844
distance x is tensor(321.3936, device='cuda:3')
cal_distance is  tensor(321.3936, device='cuda:3')
cal ratio is  0.6601733954195137
distance x is tensor(212.1772, device='cuda:3')
cal_distance is  tensor(212.1772, device='cuda:3')
cal ratio is  0.8125072723650087
distance x is tensor(172.3965, device='cuda:3')
cal_distance is  tensor(172.3965, device='cuda:3')
cal ratio is  0.9013893847409454
distance x is tensor(155.3969, device='cuda:3')
cal_distance is  tensor(155.3969, device='cuda:3')
cal ratio is  0.9494136796270531
distance x is tensor(147.5361, device='cuda:3')
cal_distance is  tensor(147.5361, device='cuda:3')
cal ratio is  0.9743778453097786
distance x is tensor(143.7561, device='cuda:3')
cal_distance is  tensor(143.7561, device='cuda:3')
distance x is tensor(143.7561, device='cuda:3')
return_distance is  tensor(143.7561, device='cuda:3')
distance x is tensor(143.7460, device='cuda:3')
distance x is tensor(143.7460, device='cuda:3')
________________________________
test distance is  tensor(143.7460, device='cuda:3')
test distance1 is  tensor(143.7460, device='cuda:3')
test similarity is  tensor(0.9631, device='cuda:3')
test acc is  0.5082500001563421
test loss is 8.948109941696053
test entropy is  0.14731508539095997
________________________________
0
distance x is tensor(143.7460, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.14724369931703946
avg test loss is  8.968812965635044
avg accuracy is  0.8186166668229914
solo acc is  0.5105166668230088
compute similarity  is  tensor(0.9631, device='cuda:3')
compute_distance is  tensor(143.7460, device='cuda:3')
compute_norm is  tensor(52.2326, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.0491, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9595263179685516
avg test loss is  1.4862964073223854
avg accuracy is  0.7837500001563261
solo acc is  0.2752166668230056
compute similarity  is  tensor(0.9639, device='cuda:3')
compute_distance is  tensor(139.0491, device='cuda:3')
compute_norm is  tensor(52.0747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(139.0491, device='cuda:3')
distance x is tensor(139.0491, device='cuda:3')
________________________________
test distance is  tensor(139.0491, device='cuda:3')
test distance1 is  tensor(139.0491, device='cuda:3')
test similarity is  tensor(0.9639, device='cuda:3')
test acc is  0.27615000015633895
test loss is 1.4935255842422372
test entropy is  0.9584106930029164
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.3423280715942383
mal norm is  tensor(717.8807, device='cuda:3')
distance x is tensor(139.0584, device='cuda:3')
mal distance is  tensor(139.0584, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([541.3662, 548.0461, 556.7549, 521.9445, 600.1802, 562.1506, 552.9991,
        594.1533, 717.8807, 717.8807, 717.8807, 717.8807, 717.8807, 717.8807,
        717.8807, 717.8807, 717.8807, 717.8807, 717.8807, 717.8807, 784.8182,
        826.9923, 785.5598, 787.7851, 797.9715, 781.7816, 795.1626, 765.0190,
        645.4669, 607.0899, 581.4536, 603.2478, 586.5622, 609.1730, 596.7602,
        633.3247], device='cuda:3')
sorted_norm is   tensor([521.9445, 541.3662, 548.0461, 552.9991, 556.7549, 562.1506, 581.4536,
        586.5622, 594.1533, 596.7602, 600.1802, 603.2478, 607.0899, 609.1730,
        633.3247, 645.4669, 717.8807, 717.8807, 717.8807, 717.8807, 717.8807,
        717.8807, 717.8807, 717.8807, 717.8807, 717.8807, 717.8807, 717.8807,
        765.0190, 781.7816, 784.8182, 785.5598, 787.7851, 795.1626, 797.9715,
        826.9923], device='cuda:3')
used idx is  tensor([ 3,  0,  1,  6,  2,  5, 30, 32,  7, 34,  4, 31, 29, 33, 35, 28, 11, 10,
         8,  9, 13, 12, 14, 15, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 85.37% 

Test Accuracy: 84.59% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5624839663505554
distance x is tensor(153.3694, device='cuda:3')
benign distance is  tensor(153.3694, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.30062952637672424
distance x is tensor(154.8537, device='cuda:3')
benign distance is  tensor(154.8537, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2763567864894867
distance x is tensor(152.6331, device='cuda:3')
benign distance is  tensor(152.6331, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4039131999015808
distance x is tensor(150.8428, device='cuda:3')
benign distance is  tensor(150.8428, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.41390085220336914
distance x is tensor(157.1187, device='cuda:3')
benign distance is  tensor(157.1187, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1390469074249268
distance x is tensor(164.4350, device='cuda:3')
benign distance is  tensor(164.4350, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2214839458465576
distance x is tensor(147.9601, device='cuda:3')
benign distance is  tensor(147.9601, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5034404397010803
distance x is tensor(156.0024, device='cuda:3')
benign distance is  tensor(156.0024, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4462258815765381
distance x is tensor(162.1227, device='cuda:3')
benign distance is  tensor(162.1227, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.37183257937431335
distance x is tensor(147.1090, device='cuda:3')
benign distance is  tensor(147.1090, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.826473593711853
distance x is tensor(140.9222, device='cuda:3')
benign distance is  tensor(140.9222, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6800011396408081
distance x is tensor(169.1240, device='cuda:3')
benign distance is  tensor(169.1240, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7042234539985657
distance x is tensor(141.2962, device='cuda:3')
benign distance is  tensor(141.2962, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35055994987487793
distance x is tensor(145.7885, device='cuda:3')
benign distance is  tensor(145.7885, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0507301092147827
distance x is tensor(143.1745, device='cuda:3')
benign distance is  tensor(143.1745, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4462583065032959
distance x is tensor(154.8703, device='cuda:3')
benign distance is  tensor(154.8703, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.0535801649093628
distance x is tensor(146.6113, device='cuda:3')
benign distance is  tensor(146.6113, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3857880234718323
distance x is tensor(151.8269, device='cuda:3')
benign distance is  tensor(151.8269, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6019121408462524
distance x is tensor(157.1530, device='cuda:3')
benign distance is  tensor(157.1530, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.27111560106277466
distance x is tensor(149.5118, device='cuda:3')
benign distance is  tensor(149.5118, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5673424601554871
distance x is tensor(141.4672, device='cuda:3')
benign distance is  tensor(141.4672, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9936392903327942
distance x is tensor(145.2673, device='cuda:3')
benign distance is  tensor(145.2673, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8330844044685364
distance x is tensor(146.5682, device='cuda:3')
benign distance is  tensor(146.5682, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4403635561466217
distance x is tensor(138.1209, device='cuda:3')
benign distance is  tensor(138.1209, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.7400, device='cuda:3')
compute distance is  tensor(137.7400, device='cuda:3')
compute norm is  tensor(51.4687, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.0139, device='cuda:3')
compute distance is  tensor(159.0139, device='cuda:3')
compute norm is  tensor(51.9654, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.6484, device='cuda:3')
compute distance is  tensor(161.6484, device='cuda:3')
compute norm is  tensor(52.0509, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6634, device='cuda:3')
compute distance is  tensor(146.6634, device='cuda:3')
compute norm is  tensor(51.7037, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.8557, device='cuda:3')
compute distance is  tensor(149.8557, device='cuda:3')
compute norm is  tensor(51.8633, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.9561, device='cuda:3')
compute distance is  tensor(152.9561, device='cuda:3')
compute norm is  tensor(52.0189, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.5361, device='cuda:3')
compute distance is  tensor(152.5361, device='cuda:3')
compute norm is  tensor(51.8748, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.9229, device='cuda:3')
compute distance is  tensor(148.9229, device='cuda:3')
compute norm is  tensor(51.7850, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.6972, device='cuda:3')
compute distance is  tensor(156.6972, device='cuda:3')
compute norm is  tensor(51.7962, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1207, device='cuda:3')
compute distance is  tensor(142.1207, device='cuda:3')
compute norm is  tensor(51.5779, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.3383, device='cuda:3')
compute distance is  tensor(154.3383, device='cuda:3')
compute norm is  tensor(52.0190, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5635, device='cuda:3')
compute distance is  tensor(149.5635, device='cuda:3')
compute norm is  tensor(51.8513, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(161.6484, device='cuda:3')
distance x is tensor(107552.5312, device='cuda:3')
distance x is tensor(107552.5312, device='cuda:3')
________________________________
test distance is  tensor(107552.5312, device='cuda:3')
test distance1 is  tensor(107552.5312, device='cuda:3')
test similarity is  tensor(0.4602, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130140011342273.78
test entropy is  0.0
________________________________
cal ratio is  0.03799281744730837
distance x is tensor(4086.2292, device='cuda:3')
cal_distance is  tensor(4086.2292, device='cuda:3')
cal ratio is  0.19491732453288507
distance x is tensor(796.4808, device='cuda:3')
cal_distance is  tensor(796.4808, device='cuda:3')
cal ratio is  0.4414933432142539
distance x is tensor(351.6438, device='cuda:3')
cal_distance is  tensor(351.6438, device='cuda:3')
cal ratio is  0.664446945726837
distance x is tensor(233.6504, device='cuda:3')
cal_distance is  tensor(233.6504, device='cuda:3')
cal ratio is  0.8151331786155034
distance x is tensor(190.4571, device='cuda:3')
cal_distance is  tensor(190.4571, device='cuda:3')
cal ratio is  0.9028450856545686
distance x is tensor(171.9538, device='cuda:3')
cal_distance is  tensor(171.9538, device='cuda:3')
cal ratio is  0.9501802241382977
distance x is tensor(163.3873, device='cuda:3')
cal_distance is  tensor(163.3873, device='cuda:3')
cal ratio is  0.9747711825611728
distance x is tensor(159.2654, device='cuda:3')
cal_distance is  tensor(159.2654, device='cuda:3')
distance x is tensor(159.2654, device='cuda:3')
return_distance is  tensor(159.2654, device='cuda:3')
distance x is tensor(159.2553, device='cuda:3')
distance x is tensor(159.2553, device='cuda:3')
________________________________
test distance is  tensor(159.2553, device='cuda:3')
test distance1 is  tensor(159.2553, device='cuda:3')
test similarity is  tensor(0.9652, device='cuda:3')
test acc is  0.10543333348966528
test loss is 156.99869798444735
test entropy is  0.0027729323938490502
________________________________
0
distance x is tensor(159.2553, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0032730495412708303
avg test loss is  156.73233666653826
avg accuracy is  0.5629333334896741
solo acc is  0.10605000015633195
compute similarity  is  tensor(0.9652, device='cuda:3')
compute_distance is  tensor(159.2553, device='cuda:3')
compute_norm is  tensor(55.3859, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.1281, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.091692211086562
avg test loss is  1.7280430539584617
avg accuracy is  0.6988500001563307
solo acc is  0.20853333348967007
compute similarity  is  tensor(0.9661, device='cuda:3')
compute_distance is  tensor(157.1281, device='cuda:3')
compute_norm is  tensor(56.0113, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.6043, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6408803868395433
avg test loss is  2.547065151271535
avg accuracy is  0.679250000156332
solo acc is  0.10825000015633195
compute similarity  is  tensor(0.9660, device='cuda:3')
compute_distance is  tensor(157.6043, device='cuda:3')
compute_norm is  tensor(55.8722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.3723, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9963171067141267
avg test loss is  1.580749264658133
avg accuracy is  0.7211000001563296
solo acc is  0.23853333348967123
compute similarity  is  tensor(0.9663, device='cuda:3')
compute_distance is  tensor(157.3723, device='cuda:3')
compute_norm is  tensor(55.5196, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(157.3723, device='cuda:3')
distance x is tensor(157.3723, device='cuda:3')
________________________________
test distance is  tensor(157.3723, device='cuda:3')
test distance1 is  tensor(157.3723, device='cuda:3')
test similarity is  tensor(0.9663, device='cuda:3')
test acc is  0.23650000015633774
test loss is 1.5809848462340674
test entropy is  0.99782321651353
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.6325868368148804
mal norm is  tensor(782.4875, device='cuda:3')
distance x is tensor(157.3816, device='cuda:3')
mal distance is  tensor(157.3816, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([616.3282, 623.0074, 599.9690, 609.1965, 613.6588, 659.5234, 581.0089,
        620.3722, 782.4875, 782.4875, 782.4875, 782.4875, 782.4875, 782.4875,
        782.4875, 782.4875, 782.4875, 782.4875, 782.4875, 782.4875],
       device='cuda:3')
sorted_norm is   tensor([581.0089, 599.9690, 609.1965, 613.6588, 616.3282, 620.3722, 623.0074,
        659.5234, 782.4875, 782.4875, 782.4875, 782.4875, 782.4875, 782.4875,
        782.4875, 782.4875, 782.4875, 782.4875, 782.4875, 782.4875],
       device='cuda:3')
used idx is  tensor([ 6,  2,  3,  4,  0,  7,  1,  5, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 70.98% 

Test Accuracy: 69.94% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.5322235822677612
distance x is tensor(165.2581, device='cuda:3')
benign distance is  tensor(165.2581, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7836516499519348
distance x is tensor(155.7914, device='cuda:3')
benign distance is  tensor(155.7914, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3807793855667114
distance x is tensor(160.8700, device='cuda:3')
benign distance is  tensor(160.8700, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1560959815979004
distance x is tensor(169.6934, device='cuda:3')
benign distance is  tensor(169.6934, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4306585192680359
distance x is tensor(151.0517, device='cuda:3')
benign distance is  tensor(151.0517, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9093714952468872
distance x is tensor(168.9763, device='cuda:3')
benign distance is  tensor(168.9763, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6211600303649902
distance x is tensor(165.7607, device='cuda:3')
benign distance is  tensor(165.7607, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4070409834384918
distance x is tensor(157.8187, device='cuda:3')
benign distance is  tensor(157.8187, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.2545, device='cuda:3')
compute distance is  tensor(144.2545, device='cuda:3')
compute norm is  tensor(54.7929, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.4831, device='cuda:3')
compute distance is  tensor(153.4831, device='cuda:3')
compute norm is  tensor(54.8959, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.7347, device='cuda:3')
compute distance is  tensor(175.7347, device='cuda:3')
compute norm is  tensor(55.3747, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.9849, device='cuda:3')
compute distance is  tensor(176.9849, device='cuda:3')
compute norm is  tensor(55.2790, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.3473, device='cuda:3')
compute distance is  tensor(153.3473, device='cuda:3')
compute norm is  tensor(54.7592, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.0907, device='cuda:3')
compute distance is  tensor(161.0907, device='cuda:3')
compute norm is  tensor(55.1102, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.7071, device='cuda:3')
compute distance is  tensor(157.7071, device='cuda:3')
compute norm is  tensor(55.1407, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.9853, device='cuda:3')
compute distance is  tensor(144.9853, device='cuda:3')
compute norm is  tensor(54.7724, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.4612, device='cuda:3')
compute distance is  tensor(159.4612, device='cuda:3')
compute norm is  tensor(54.9905, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.8826, device='cuda:3')
compute distance is  tensor(154.8826, device='cuda:3')
compute norm is  tensor(55.0629, device='cuda:3', dtype=torch.float64)
distance x is tensor(197.0883, device='cuda:3')
compute distance is  tensor(197.0883, device='cuda:3')
compute norm is  tensor(56.0703, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5147, device='cuda:3')
compute distance is  tensor(144.5147, device='cuda:3')
compute norm is  tensor(54.7797, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(197.0883, device='cuda:3')
distance x is tensor(107510.1562, device='cuda:3')
distance x is tensor(107510.1562, device='cuda:3')
________________________________
test distance is  tensor(107510.1562, device='cuda:3')
test distance1 is  tensor(107510.1562, device='cuda:3')
test similarity is  tensor(0.5492, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130206138184666.88
test entropy is  0.0
________________________________
cal ratio is  0.0419596363587499
distance x is tensor(4511.0923, device='cuda:3')
cal_distance is  tensor(4511.0923, device='cuda:3')
cal ratio is  0.20484040011337282
distance x is tensor(924.0579, device='cuda:3')
cal_distance is  tensor(924.0579, device='cuda:3')
cal ratio is  0.4525919953243559
distance x is tensor(418.2240, device='cuda:3')
cal_distance is  tensor(418.2240, device='cuda:3')
cal ratio is  0.6727473618743782
distance x is tensor(281.3607, device='cuda:3')
cal_distance is  tensor(281.3607, device='cuda:3')
cal ratio is  0.8202093869316291
distance x is tensor(230.7756, device='cuda:3')
cal_distance is  tensor(230.7756, device='cuda:3')
cal ratio is  0.9056523868087067
distance x is tensor(209.0030, device='cuda:3')
cal_distance is  tensor(209.0030, device='cuda:3')
cal ratio is  0.9516565735891909
distance x is tensor(198.8993, device='cuda:3')
cal_distance is  tensor(198.8993, device='cuda:3')
cal ratio is  0.9755282762932262
distance x is tensor(194.0320, device='cuda:3')
cal_distance is  tensor(194.0320, device='cuda:3')
distance x is tensor(194.0320, device='cuda:3')
return_distance is  tensor(194.0320, device='cuda:3')
distance x is tensor(194.0220, device='cuda:3')
distance x is tensor(194.0220, device='cuda:3')
________________________________
test distance is  tensor(194.0220, device='cuda:3')
test distance1 is  tensor(194.0220, device='cuda:3')
test similarity is  tensor(0.9647, device='cuda:3')
test acc is  0.25911666682300527
test loss is 41.065745032418256
test entropy is  0.07530889416367674
________________________________
0
distance x is tensor(194.0220, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.07516455488291376
avg test loss is  41.34357454629341
avg accuracy is  0.7575666668229941
solo acc is  0.26101666682300523
compute similarity  is  tensor(0.9647, device='cuda:3')
compute_distance is  tensor(194.0220, device='cuda:3')
compute_norm is  tensor(60.7953, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.7701, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1106020358325577
avg test loss is  1.8143502176443398
avg accuracy is  0.5827833334896725
solo acc is  0.17861666682300184
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(189.7701, device='cuda:3')
compute_norm is  tensor(60.9670, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.3582, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6773311879589106
avg test loss is  2.5707357882945012
avg accuracy is  0.5444166668230092
solo acc is  0.1027833334896653
compute similarity  is  tensor(0.9648, device='cuda:3')
compute_distance is  tensor(189.3582, device='cuda:3')
compute_norm is  tensor(60.7628, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.8984, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.07450179962207
avg test loss is  1.674293288416954
avg accuracy is  0.6345166668230017
solo acc is  0.1979000001563363
compute similarity  is  tensor(0.9650, device='cuda:3')
compute_distance is  tensor(189.8984, device='cuda:3')
compute_norm is  tensor(60.4452, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.4327, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6384455609296177
avg test loss is  2.499858108664881
avg accuracy is  0.5897166668230052
solo acc is  0.10270000015633197
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(189.4327, device='cuda:3')
compute_norm is  tensor(60.2431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.7253, device='cuda:3')
distance x is tensor(189.7253, device='cuda:3')
________________________________
test distance is  tensor(189.7253, device='cuda:3')
test distance1 is  tensor(189.7253, device='cuda:3')
test similarity is  tensor(0.9651, device='cuda:3')
test acc is  0.20730000015633668
test loss is 1.6153966413377954
test entropy is  1.0514717439471533
________________________________
0
distance x is tensor(189.7253, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.051427986766738
avg test loss is  1.6148189109271522
avg accuracy is  0.6581000001563334
solo acc is  0.20861666682300348
compute similarity  is  tensor(0.9651, device='cuda:3')
compute_distance is  tensor(189.7253, device='cuda:3')
compute_norm is  tensor(59.9236, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.2857, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6373604968158421
avg test loss is  2.4183056744685305
avg accuracy is  0.6140500001563365
solo acc is  0.10321666682299864
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(189.2857, device='cuda:3')
compute_norm is  tensor(59.7235, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.4925, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0199330411613114
avg test loss is  1.565017408780706
avg accuracy is  0.6742666668229989
solo acc is  0.21806666682300374
compute similarity  is  tensor(0.9650, device='cuda:3')
compute_distance is  tensor(189.4925, device='cuda:3')
compute_norm is  tensor(59.4058, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.1629, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6148336885898098
avg test loss is  2.38845889362445
avg accuracy is  0.6356166668230016
solo acc is  0.10361666682299864
compute similarity  is  tensor(0.9648, device='cuda:3')
compute_distance is  tensor(189.1629, device='cuda:3')
compute_norm is  tensor(59.2067, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.4111, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9996475455349189
avg test loss is  1.5265816643293986
avg accuracy is  0.6906000001563313
solo acc is  0.22505000015633742
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(189.4111, device='cuda:3')
compute_norm is  tensor(58.8902, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(189.4111, device='cuda:3')
distance x is tensor(189.4111, device='cuda:3')
________________________________
test distance is  tensor(189.4111, device='cuda:3')
test distance1 is  tensor(189.4111, device='cuda:3')
test similarity is  tensor(0.9649, device='cuda:3')
test acc is  0.2248833334896708
test loss is 1.5276479316926967
test entropy is  0.9995189888645083
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4318482875823975
mal norm is  tensor(899.7414, device='cuda:3')
distance x is tensor(189.4204, device='cuda:3')
mal distance is  tensor(189.4204, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 645.2388,  629.4432,  644.6773,  677.9420,  595.7330,  658.2496,
         651.4140,  631.0054,  899.7414,  899.7414,  899.7414,  899.7414,
         899.7414,  899.7414,  899.7414,  899.7414,  899.7414,  899.7414,
         899.7414,  899.7414, 1250.5328, 1237.7690, 1249.0100, 1289.2271,
        1256.8159, 1223.8086, 1263.3108, 1264.6437,  928.9601,  881.9055,
         951.8233,  937.5080,  903.3837,  895.8697,  913.9886,  880.1752,
         874.0171,  906.8226,  912.7556,  887.4009,  877.3060,  837.8459,
         897.7479,  844.2034,  771.0059,  707.8414,  694.0885,  781.9104,
         695.5068,  707.1950,  705.3019,  751.7563], device='cuda:3')
sorted_norm is   tensor([ 595.7330,  629.4432,  631.0054,  644.6773,  645.2388,  651.4140,
         658.2496,  677.9420,  694.0885,  695.5068,  705.3019,  707.1950,
         707.8414,  751.7563,  771.0059,  781.9104,  837.8459,  844.2034,
         874.0171,  877.3060,  880.1752,  881.9055,  887.4009,  895.8697,
         897.7479,  899.7414,  899.7414,  899.7414,  899.7414,  899.7414,
         899.7414,  899.7414,  899.7414,  899.7414,  899.7414,  899.7414,
         899.7414,  903.3837,  906.8226,  912.7556,  913.9886,  928.9601,
         937.5080,  951.8233, 1223.8086, 1237.7690, 1249.0100, 1250.5328,
        1256.8159, 1263.3108, 1264.6437, 1289.2271], device='cuda:3')
used idx is  tensor([ 4,  1,  7,  2,  0,  6,  5,  3, 46, 48, 50, 49, 45, 51, 44, 47, 41, 43,
        36, 40, 35, 29, 39, 33, 42, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8, 11,
         9, 32, 37, 38, 34], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 83.96% 

Test Accuracy: 82.58% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7855744957923889
distance x is tensor(142.2013, device='cuda:3')
benign distance is  tensor(142.2013, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7689730525016785
distance x is tensor(143.8175, device='cuda:3')
benign distance is  tensor(143.8175, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6276503801345825
distance x is tensor(141.6290, device='cuda:3')
benign distance is  tensor(141.6290, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44354313611984253
distance x is tensor(141.4998, device='cuda:3')
benign distance is  tensor(141.4998, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5341454148292542
distance x is tensor(169.1338, device='cuda:3')
benign distance is  tensor(169.1338, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2231273651123047
distance x is tensor(142.8185, device='cuda:3')
benign distance is  tensor(142.8185, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5841238498687744
distance x is tensor(152.5923, device='cuda:3')
benign distance is  tensor(152.5923, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31386470794677734
distance x is tensor(139.7716, device='cuda:3')
benign distance is  tensor(139.7716, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4571022093296051
distance x is tensor(145.9719, device='cuda:3')
benign distance is  tensor(145.9719, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.32393139600753784
distance x is tensor(137.9641, device='cuda:3')
benign distance is  tensor(137.9641, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9917019605636597
distance x is tensor(136.5582, device='cuda:3')
benign distance is  tensor(136.5582, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6540431976318359
distance x is tensor(163.9483, device='cuda:3')
benign distance is  tensor(163.9483, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.20425386726856232
distance x is tensor(135.9749, device='cuda:3')
benign distance is  tensor(135.9749, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.24064750969409943
distance x is tensor(142.1780, device='cuda:3')
benign distance is  tensor(142.1780, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.43851161003112793
distance x is tensor(135.9189, device='cuda:3')
benign distance is  tensor(135.9189, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7097659111022949
distance x is tensor(151.2962, device='cuda:3')
benign distance is  tensor(151.2962, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.49868160486221313
distance x is tensor(146.3813, device='cuda:3')
benign distance is  tensor(146.3813, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.37211164832115173
distance x is tensor(146.3187, device='cuda:3')
benign distance is  tensor(146.3187, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9160416722297668
distance x is tensor(145.3355, device='cuda:3')
benign distance is  tensor(145.3355, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3223227858543396
distance x is tensor(127.5947, device='cuda:3')
benign distance is  tensor(127.5947, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4818020761013031
distance x is tensor(143.5701, device='cuda:3')
benign distance is  tensor(143.5701, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8182520866394043
distance x is tensor(145.9543, device='cuda:3')
benign distance is  tensor(145.9543, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3790368437767029
distance x is tensor(147.9498, device='cuda:3')
benign distance is  tensor(147.9498, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6002580523490906
distance x is tensor(138.6275, device='cuda:3')
benign distance is  tensor(138.6275, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.28562670946121216
distance x is tensor(145.1664, device='cuda:3')
benign distance is  tensor(145.1664, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.17816811800003052
distance x is tensor(139.6282, device='cuda:3')
benign distance is  tensor(139.6282, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5615569353103638
distance x is tensor(142.7419, device='cuda:3')
benign distance is  tensor(142.7419, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5560311675071716
distance x is tensor(141.7483, device='cuda:3')
benign distance is  tensor(141.7483, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5066739916801453
distance x is tensor(153.4820, device='cuda:3')
benign distance is  tensor(153.4820, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7903071641921997
distance x is tensor(146.9177, device='cuda:3')
benign distance is  tensor(146.9177, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.29385361075401306
distance x is tensor(153.9493, device='cuda:3')
benign distance is  tensor(153.9493, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.42153501510620117
distance x is tensor(124.8816, device='cuda:3')
benign distance is  tensor(124.8816, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3186115026474
distance x is tensor(148.2640, device='cuda:3')
benign distance is  tensor(148.2640, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.41288572549819946
distance x is tensor(140.4763, device='cuda:3')
benign distance is  tensor(140.4763, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3331124186515808
distance x is tensor(135.3167, device='cuda:3')
benign distance is  tensor(135.3167, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4814097285270691
distance x is tensor(145.8363, device='cuda:3')
benign distance is  tensor(145.8363, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5165661573410034
distance x is tensor(136.2055, device='cuda:3')
benign distance is  tensor(136.2055, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3990916609764099
distance x is tensor(145.8808, device='cuda:3')
benign distance is  tensor(145.8808, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.47169438004493713
distance x is tensor(148.4632, device='cuda:3')
benign distance is  tensor(148.4632, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3412279188632965
distance x is tensor(152.1019, device='cuda:3')
benign distance is  tensor(152.1019, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(139.0517, device='cuda:3')
compute distance is  tensor(139.0517, device='cuda:3')
compute norm is  tensor(53.9561, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.8257, device='cuda:3')
compute distance is  tensor(137.8257, device='cuda:3')
compute norm is  tensor(54.0281, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.0871, device='cuda:3')
compute distance is  tensor(140.0871, device='cuda:3')
compute norm is  tensor(54.2866, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.2072, device='cuda:3')
compute distance is  tensor(132.2072, device='cuda:3')
compute norm is  tensor(53.9050, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.3696, device='cuda:3')
compute distance is  tensor(142.3696, device='cuda:3')
compute norm is  tensor(54.2918, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.1822, device='cuda:3')
compute distance is  tensor(145.1822, device='cuda:3')
compute norm is  tensor(54.3325, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7232, device='cuda:3')
compute distance is  tensor(144.7232, device='cuda:3')
compute norm is  tensor(54.3043, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4164, device='cuda:3')
compute distance is  tensor(136.4164, device='cuda:3')
compute norm is  tensor(54.1582, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3470, device='cuda:3')
compute distance is  tensor(140.3470, device='cuda:3')
compute norm is  tensor(53.9587, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.5818, device='cuda:3')
compute distance is  tensor(147.5818, device='cuda:3')
compute norm is  tensor(54.3123, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1314, device='cuda:3')
compute distance is  tensor(142.1314, device='cuda:3')
compute norm is  tensor(54.0919, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.8252, device='cuda:3')
compute distance is  tensor(147.8252, device='cuda:3')
compute norm is  tensor(54.3293, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.8252, device='cuda:3')
distance x is tensor(107519., device='cuda:3')
distance x is tensor(107519., device='cuda:3')
________________________________
test distance is  tensor(107519., device='cuda:3')
test distance1 is  tensor(107519., device='cuda:3')
test similarity is  tensor(0.5346, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130219746849929.55
test entropy is  0.0
________________________________
cal ratio is  0.03633772795601562
distance x is tensor(3907.0022, device='cuda:3')
cal_distance is  tensor(3907.0022, device='cuda:3')
cal ratio is  0.19062442043482117
distance x is tensor(744.7740, device='cuda:3')
cal_distance is  tensor(744.7740, device='cuda:3')
cal ratio is  0.43660442236340563
distance x is tensor(325.1745, device='cuda:3')
cal_distance is  tensor(325.1745, device='cuda:3')
cal ratio is  0.6607575691545906
distance x is tensor(214.8632, device='cuda:3')
cal_distance is  tensor(214.8632, device='cuda:3')
cal ratio is  0.8128667190754109
distance x is tensor(174.6561, device='cuda:3')
cal_distance is  tensor(174.6561, device='cuda:3')
cal ratio is  0.9015888055966814
distance x is tensor(157.4685, device='cuda:3')
cal_distance is  tensor(157.4685, device='cuda:3')
cal ratio is  0.9495187970440699
distance x is tensor(149.5195, device='cuda:3')
cal_distance is  tensor(149.5195, device='cuda:3')
cal ratio is  0.9744317171963726
distance x is tensor(145.6967, device='cuda:3')
cal_distance is  tensor(145.6967, device='cuda:3')
distance x is tensor(145.6967, device='cuda:3')
return_distance is  tensor(145.6967, device='cuda:3')
distance x is tensor(145.6867, device='cuda:3')
distance x is tensor(145.6867, device='cuda:3')
________________________________
test distance is  tensor(145.6867, device='cuda:3')
test distance1 is  tensor(145.6867, device='cuda:3')
test similarity is  tensor(0.9766, device='cuda:3')
test acc is  0.16583333348966778
test loss is 53.981121097800575
test entropy is  0.03774908229113936
________________________________
0
distance x is tensor(145.6867, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.03699987992355878
avg test loss is  53.97732811746821
avg accuracy is  0.718733333489663
solo acc is  0.16583333348966778
compute similarity  is  tensor(0.9766, device='cuda:3')
compute_distance is  tensor(145.6867, device='cuda:3')
compute_norm is  tensor(57.8028, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.8263, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9340017113223005
avg test loss is  1.4500475454686292
avg accuracy is  0.7765833334896598
solo acc is  0.28161666682300585
compute similarity  is  tensor(0.9771, device='cuda:3')
compute_distance is  tensor(141.8263, device='cuda:3')
compute_norm is  tensor(57.6392, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(141.8263, device='cuda:3')
distance x is tensor(141.8263, device='cuda:3')
________________________________
test distance is  tensor(141.8263, device='cuda:3')
test distance1 is  tensor(141.8263, device='cuda:3')
test similarity is  tensor(0.9771, device='cuda:3')
test acc is  0.2825000001563391
test loss is 1.4494591012184046
test entropy is  0.9353497202462479
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.2119286060333252
mal norm is  tensor(726.3648, device='cuda:3')
distance x is tensor(141.8357, device='cuda:3')
mal distance is  tensor(141.8357, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([581.3124, 579.7251, 568.7779, 562.9885, 672.0676, 579.9705, 604.5010,
        571.4448, 726.3648, 726.3647, 726.3648, 726.3647, 726.3648, 726.3647,
        726.3648, 726.3647, 726.3648, 726.3647, 726.3648, 726.3647],
       device='cuda:3')
sorted_norm is   tensor([562.9885, 568.7779, 571.4448, 579.7251, 579.9705, 581.3124, 604.5010,
        672.0676, 726.3647, 726.3647, 726.3647, 726.3647, 726.3647, 726.3647,
        726.3648, 726.3648, 726.3648, 726.3648, 726.3648, 726.3648],
       device='cuda:3')
used idx is  tensor([ 3,  2,  7,  1,  5,  0,  6,  4, 19, 17, 13, 15, 11,  9, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 84.12% 

Test Accuracy: 83.45% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7694598436355591
distance x is tensor(130.4226, device='cuda:3')
benign distance is  tensor(130.4226, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3694175183773041
distance x is tensor(158.1340, device='cuda:3')
benign distance is  tensor(158.1340, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6709884405136108
distance x is tensor(145.5402, device='cuda:3')
benign distance is  tensor(145.5402, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6161190867424011
distance x is tensor(136.3142, device='cuda:3')
benign distance is  tensor(136.3142, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8594511151313782
distance x is tensor(172.3966, device='cuda:3')
benign distance is  tensor(172.3966, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2345225811004639
distance x is tensor(161.8332, device='cuda:3')
benign distance is  tensor(161.8332, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6218711137771606
distance x is tensor(150.8798, device='cuda:3')
benign distance is  tensor(150.8798, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.901624321937561
distance x is tensor(159.4048, device='cuda:3')
benign distance is  tensor(159.4048, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(146.0087, device='cuda:3')
compute distance is  tensor(146.0087, device='cuda:3')
compute norm is  tensor(57.1567, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0806, device='cuda:3')
compute distance is  tensor(144.0806, device='cuda:3')
compute norm is  tensor(57.2324, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0008, device='cuda:3')
compute distance is  tensor(145.0008, device='cuda:3')
compute norm is  tensor(57.3318, device='cuda:3', dtype=torch.float64)
distance x is tensor(181.2036, device='cuda:3')
compute distance is  tensor(181.2036, device='cuda:3')
compute norm is  tensor(58.0298, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9338, device='cuda:3')
compute distance is  tensor(145.9338, device='cuda:3')
compute norm is  tensor(57.4554, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.0717, device='cuda:3')
compute distance is  tensor(166.0717, device='cuda:3')
compute norm is  tensor(57.9531, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.0286, device='cuda:3')
compute distance is  tensor(164.0286, device='cuda:3')
compute norm is  tensor(57.6350, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.3357, device='cuda:3')
compute distance is  tensor(144.3357, device='cuda:3')
compute norm is  tensor(57.4801, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.2867, device='cuda:3')
compute distance is  tensor(152.2867, device='cuda:3')
compute norm is  tensor(57.4061, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.5683, device='cuda:3')
compute distance is  tensor(153.5683, device='cuda:3')
compute norm is  tensor(57.4574, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4686, device='cuda:3')
compute distance is  tensor(146.4686, device='cuda:3')
compute norm is  tensor(57.2208, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9203, device='cuda:3')
compute distance is  tensor(139.9203, device='cuda:3')
compute norm is  tensor(57.3482, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(181.2036, device='cuda:3')
distance x is tensor(107471.1953, device='cuda:3')
distance x is tensor(107471.1953, device='cuda:3')
________________________________
test distance is  tensor(107471.1953, device='cuda:3')
test distance1 is  tensor(107471.1953, device='cuda:3')
test similarity is  tensor(0.6077, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130025800328093.75
test entropy is  0.0
________________________________
cal ratio is  0.04024051091999847
distance x is tensor(4324.7012, device='cuda:3')
cal_distance is  tensor(4324.7012, device='cuda:3')
cal ratio is  0.20060025143461405
distance x is tensor(867.5402, device='cuda:3')
cal_distance is  tensor(867.5402, device='cuda:3')
cal ratio is  0.44788314813095176
distance x is tensor(388.5594, device='cuda:3')
cal_distance is  tensor(388.5594, device='cuda:3')
cal ratio is  0.6692383384198016
distance x is tensor(260.0405, device='cuda:3')
cal_distance is  tensor(260.0405, device='cuda:3')
cal ratio is  0.818067351161397
distance x is tensor(212.7316, device='cuda:3')
cal_distance is  tensor(212.7316, device='cuda:3')
cal ratio is  0.9044687107888705
distance x is tensor(192.4095, device='cuda:3')
cal_distance is  tensor(192.4095, device='cuda:3')
cal ratio is  0.9510344559492586
distance x is tensor(182.9883, device='cuda:3')
cal_distance is  tensor(182.9883, device='cuda:3')
cal ratio is  0.9752092966627613
distance x is tensor(178.4520, device='cuda:3')
cal_distance is  tensor(178.4520, device='cuda:3')
distance x is tensor(178.4520, device='cuda:3')
return_distance is  tensor(178.4520, device='cuda:3')
distance x is tensor(178.4421, device='cuda:3')
distance x is tensor(178.4421, device='cuda:3')
________________________________
test distance is  tensor(178.4421, device='cuda:3')
test distance1 is  tensor(178.4421, device='cuda:3')
test similarity is  tensor(0.9757, device='cuda:3')
test acc is  0.1020833334896653
test loss is 187.5462293157191
test entropy is  0.0008591777658698394
________________________________
0
distance x is tensor(178.4421, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0009150170380962396
avg test loss is  187.66545454728833
avg accuracy is  0.5118333334896755
solo acc is  0.10216666682299863
compute similarity  is  tensor(0.9757, device='cuda:3')
compute_distance is  tensor(178.4421, device='cuda:3')
compute_norm is  tensor(63.0502, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(178.5262, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1706095778865855
avg test loss is  1.78678834539995
avg accuracy is  0.7068500001563303
solo acc is  0.21200000015633688
compute similarity  is  tensor(0.9762, device='cuda:3')
compute_distance is  tensor(178.5262, device='cuda:3')
compute_norm is  tensor(63.7395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.3760, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6890085795794977
avg test loss is  2.602129433200812
avg accuracy is  0.7008666668229973
solo acc is  0.10965000015633196
compute similarity  is  tensor(0.9761, device='cuda:3')
compute_distance is  tensor(178.3760, device='cuda:3')
compute_norm is  tensor(63.6048, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.1902, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0338281407030916
avg test loss is  1.548958969649984
avg accuracy is  0.7327000001563286
solo acc is  0.2559000001563384
compute similarity  is  tensor(0.9765, device='cuda:3')
compute_distance is  tensor(177.1902, device='cuda:3')
compute_norm is  tensor(63.2452, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(176.8773, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6344686301151065
avg test loss is  2.4253105220001645
avg accuracy is  0.71110000015633
solo acc is  0.10606666682299862
compute similarity  is  tensor(0.9764, device='cuda:3')
compute_distance is  tensor(176.8773, device='cuda:3')
compute_norm is  tensor(63.0594, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(175.6423, device='cuda:3')
distance x is tensor(175.6423, device='cuda:3')
________________________________
test distance is  tensor(175.6423, device='cuda:3')
test distance1 is  tensor(175.6423, device='cuda:3')
test similarity is  tensor(0.9766, device='cuda:3')
test acc is  0.23130000015633762
test loss is 1.520946157004025
test entropy is  0.9821592962691016
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4962794780731201
mal norm is  tensor(851.0880, device='cuda:3')
distance x is tensor(175.6517, device='cuda:3')
mal distance is  tensor(175.6517, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([526.4540, 625.9547, 583.2413, 539.7217, 664.8011, 645.1826, 600.7233,
        636.9870, 851.0880, 851.0880, 851.0880, 851.0880, 851.0880, 851.0880,
        851.0880, 851.0880, 851.0880, 851.0880, 851.0880, 851.0880, 704.2854,
        665.6779, 665.4519, 744.8798, 666.7809, 670.7946, 667.6441, 719.9939],
       device='cuda:3')
sorted_norm is   tensor([526.4540, 539.7217, 583.2413, 600.7233, 625.9547, 636.9870, 645.1826,
        664.8011, 665.4519, 665.6779, 666.7809, 667.6441, 670.7946, 704.2854,
        719.9939, 744.8798, 851.0880, 851.0880, 851.0880, 851.0880, 851.0880,
        851.0880, 851.0880, 851.0880, 851.0880, 851.0880, 851.0880, 851.0880],
       device='cuda:3')
used idx is  tensor([ 0,  3,  2,  6,  1,  7,  5,  4, 22, 21, 24, 26, 25, 20, 27, 23, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 84.38% 

Test Accuracy: 83.02% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5835553407669067
distance x is tensor(123.9107, device='cuda:3')
benign distance is  tensor(123.9107, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4493788778781891
distance x is tensor(134.4527, device='cuda:3')
benign distance is  tensor(134.4527, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21950414776802063
distance x is tensor(134.5584, device='cuda:3')
benign distance is  tensor(134.5584, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5236303210258484
distance x is tensor(132.6669, device='cuda:3')
benign distance is  tensor(132.6669, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6091915965080261
distance x is tensor(126.2423, device='cuda:3')
benign distance is  tensor(126.2423, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6304222345352173
distance x is tensor(143.7291, device='cuda:3')
benign distance is  tensor(143.7291, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8026100397109985
distance x is tensor(137.2747, device='cuda:3')
benign distance is  tensor(137.2747, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7377460598945618
distance x is tensor(132.6423, device='cuda:3')
benign distance is  tensor(132.6423, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8415565490722656
distance x is tensor(147.8926, device='cuda:3')
benign distance is  tensor(147.8926, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.38550570607185364
distance x is tensor(136.0840, device='cuda:3')
benign distance is  tensor(136.0840, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.06155878305435181
distance x is tensor(130.3012, device='cuda:3')
benign distance is  tensor(130.3012, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.686616063117981
distance x is tensor(141.1990, device='cuda:3')
benign distance is  tensor(141.1990, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6335867643356323
distance x is tensor(130.3933, device='cuda:3')
benign distance is  tensor(130.3933, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4319249987602234
distance x is tensor(135.0772, device='cuda:3')
benign distance is  tensor(135.0772, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5324678421020508
distance x is tensor(141.4958, device='cuda:3')
benign distance is  tensor(141.4958, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6517055630683899
distance x is tensor(156.8211, device='cuda:3')
benign distance is  tensor(156.8211, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(132.5135, device='cuda:3')
compute distance is  tensor(132.5135, device='cuda:3')
compute norm is  tensor(58.2148, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.1749, device='cuda:3')
compute distance is  tensor(127.1749, device='cuda:3')
compute norm is  tensor(58.3044, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6991, device='cuda:3')
compute distance is  tensor(146.6991, device='cuda:3')
compute norm is  tensor(58.6617, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.6874, device='cuda:3')
compute distance is  tensor(140.6874, device='cuda:3')
compute norm is  tensor(58.5336, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.9341, device='cuda:3')
compute distance is  tensor(141.9341, device='cuda:3')
compute norm is  tensor(58.7649, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6912, device='cuda:3')
compute distance is  tensor(134.6912, device='cuda:3')
compute norm is  tensor(58.3755, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.9235, device='cuda:3')
compute distance is  tensor(160.9235, device='cuda:3')
compute norm is  tensor(59.1507, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0447, device='cuda:3')
compute distance is  tensor(126.0447, device='cuda:3')
compute norm is  tensor(58.2630, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0091, device='cuda:3')
compute distance is  tensor(138.0091, device='cuda:3')
compute norm is  tensor(58.3346, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8524, device='cuda:3')
compute distance is  tensor(132.8524, device='cuda:3')
compute norm is  tensor(58.4070, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1742, device='cuda:3')
compute distance is  tensor(137.1742, device='cuda:3')
compute norm is  tensor(58.6356, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8892, device='cuda:3')
compute distance is  tensor(145.8892, device='cuda:3')
compute norm is  tensor(58.6120, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(160.9235, device='cuda:3')
distance x is tensor(107475.8594, device='cuda:3')
distance x is tensor(107475.8594, device='cuda:3')
________________________________
test distance is  tensor(107475.8594, device='cuda:3')
test distance1 is  tensor(107475.8594, device='cuda:3')
test similarity is  tensor(0.6084, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130074814785776.17
test entropy is  0.0
________________________________
cal ratio is  0.037921046856916406
distance x is tensor(4075.6028, device='cuda:3')
cal_distance is  tensor(4075.6028, device='cuda:3')
cal ratio is  0.19473313370065465
distance x is tensor(793.6589, device='cuda:3')
cal_distance is  tensor(793.6589, device='cuda:3')
cal ratio is  0.4412846699607732
distance x is tensor(350.2323, device='cuda:3')
cal_distance is  tensor(350.2323, device='cuda:3')
cal ratio is  0.6642899774011373
distance x is tensor(232.6575, device='cuda:3')
cal_distance is  tensor(232.6575, device='cuda:3')
cal ratio is  0.8150369269249127
distance x is tensor(189.6254, device='cuda:3')
cal_distance is  tensor(189.6254, device='cuda:3')
cal ratio is  0.9027916659139503
distance x is tensor(171.1927, device='cuda:3')
cal_distance is  tensor(171.1927, device='cuda:3')
cal ratio is  0.9501521793373006
distance x is tensor(162.6593, device='cuda:3')
cal_distance is  tensor(162.6593, device='cuda:3')
cal ratio is  0.9747567946130433
distance x is tensor(158.5535, device='cuda:3')
cal_distance is  tensor(158.5535, device='cuda:3')
distance x is tensor(158.5535, device='cuda:3')
return_distance is  tensor(158.5535, device='cuda:3')
distance x is tensor(158.5435, device='cuda:3')
distance x is tensor(158.5435, device='cuda:3')
________________________________
test distance is  tensor(158.5435, device='cuda:3')
test distance1 is  tensor(158.5435, device='cuda:3')
test similarity is  tensor(0.9808, device='cuda:3')
test acc is  0.6630666668229996
test loss is 3.9740939502522887
test entropy is  0.15976033351425803
________________________________
0
distance x is tensor(158.5435, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.15989755859364196
avg test loss is  4.03353443258861
avg accuracy is  0.8451166668229902
solo acc is  0.6592333334896664
compute similarity  is  tensor(0.9808, device='cuda:3')
compute_distance is  tensor(158.5435, device='cuda:3')
compute_norm is  tensor(63.3426, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.6814, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.948049115346693
avg test loss is  1.417953165609445
avg accuracy is  0.8060166668229918
solo acc is  0.28858333348967263
compute similarity  is  tensor(0.9809, device='cuda:3')
compute_distance is  tensor(154.6814, device='cuda:3')
compute_norm is  tensor(62.9797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(154.4383, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8999195238674628
avg test loss is  1.4777050142857566
avg accuracy is  0.8084000001563251
solo acc is  0.24605000015633813
compute similarity  is  tensor(0.9807, device='cuda:3')
compute_distance is  tensor(154.4383, device='cuda:3')
compute_norm is  tensor(62.6790, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(154.1480, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8856588082272869
avg test loss is  1.4726196782929557
avg accuracy is  0.8145000001563248
solo acc is  0.2392833334896712
compute similarity  is  tensor(0.9806, device='cuda:3')
compute_distance is  tensor(154.1480, device='cuda:3')
compute_norm is  tensor(62.3766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(153.8563, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8816699883831081
avg test loss is  1.455487742734108
avg accuracy is  0.8161666668229913
solo acc is  0.2362166668230045
compute similarity  is  tensor(0.9805, device='cuda:3')
compute_distance is  tensor(153.8563, device='cuda:3')
compute_norm is  tensor(62.0785, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(153.6185, device='cuda:3')
distance x is tensor(153.6185, device='cuda:3')
________________________________
test distance is  tensor(153.6185, device='cuda:3')
test distance1 is  tensor(153.6185, device='cuda:3')
test similarity is  tensor(0.9804, device='cuda:3')
test acc is  0.23843333348967122
test loss is 1.4352052021128283
test entropy is  0.8770355680095616
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2255010604858398
mal norm is  tensor(753.1236, device='cuda:3')
distance x is tensor(153.6277, device='cuda:3')
mal distance is  tensor(153.6277, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([514.2735, 549.6061, 552.9581, 543.6092, 506.3567, 580.7086, 552.0153,
        540.6708, 753.1236, 753.1236, 753.1236, 753.1236, 753.1236, 753.1236,
        753.1236, 753.1236, 753.1236, 753.1236, 753.1236, 753.1236, 943.0959,
        969.3680, 975.4185, 949.6865, 928.7812, 942.5880, 943.0168, 913.9825,
        723.5922, 728.2786, 727.4974, 682.3583, 714.1185, 736.5850, 736.1593,
        706.4568], device='cuda:3')
sorted_norm is   tensor([506.3567, 514.2735, 540.6708, 543.6092, 549.6061, 552.0153, 552.9581,
        580.7086, 682.3583, 706.4568, 714.1185, 723.5922, 727.4974, 728.2786,
        736.1593, 736.5850, 753.1236, 753.1236, 753.1236, 753.1236, 753.1236,
        753.1236, 753.1236, 753.1236, 753.1236, 753.1236, 753.1236, 753.1236,
        913.9825, 928.7812, 942.5880, 943.0168, 943.0959, 949.6865, 969.3680,
        975.4185], device='cuda:3')
used idx is  tensor([ 4,  0,  7,  3,  1,  6,  2,  5, 31, 35, 32, 28, 30, 29, 34, 33, 11, 10,
         8,  9, 13, 12, 14, 15, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 86.35% 

Test Accuracy: 85.22% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5335935354232788
distance x is tensor(135.1060, device='cuda:3')
benign distance is  tensor(135.1060, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6113666296005249
distance x is tensor(132.2738, device='cuda:3')
benign distance is  tensor(132.2738, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16903936862945557
distance x is tensor(136.7931, device='cuda:3')
benign distance is  tensor(136.7931, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.22401146590709686
distance x is tensor(141.0463, device='cuda:3')
benign distance is  tensor(141.0463, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7753170728683472
distance x is tensor(130.9697, device='cuda:3')
benign distance is  tensor(130.9697, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7884968519210815
distance x is tensor(143.3106, device='cuda:3')
benign distance is  tensor(143.3106, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4061926007270813
distance x is tensor(142.0668, device='cuda:3')
benign distance is  tensor(142.0668, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3201347887516022
distance x is tensor(141.6617, device='cuda:3')
benign distance is  tensor(141.6617, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.7052086591720581
distance x is tensor(140.7084, device='cuda:3')
benign distance is  tensor(140.7084, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6772223711013794
distance x is tensor(142.9254, device='cuda:3')
benign distance is  tensor(142.9254, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.45474833250045776
distance x is tensor(150.7506, device='cuda:3')
benign distance is  tensor(150.7506, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6093279123306274
distance x is tensor(142.5981, device='cuda:3')
benign distance is  tensor(142.5981, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29704827070236206
distance x is tensor(132.2773, device='cuda:3')
benign distance is  tensor(132.2773, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6675919890403748
distance x is tensor(137.9095, device='cuda:3')
benign distance is  tensor(137.9095, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.19065527617931366
distance x is tensor(142.9559, device='cuda:3')
benign distance is  tensor(142.9559, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6072894334793091
distance x is tensor(141.0939, device='cuda:3')
benign distance is  tensor(141.0939, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.44315657019615173
distance x is tensor(131.5117, device='cuda:3')
benign distance is  tensor(131.5117, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.5512322783470154
distance x is tensor(145.0247, device='cuda:3')
benign distance is  tensor(145.0247, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3185690939426422
distance x is tensor(136.4375, device='cuda:3')
benign distance is  tensor(136.4375, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.21795813739299774
distance x is tensor(151.3485, device='cuda:3')
benign distance is  tensor(151.3485, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2856343984603882
distance x is tensor(140.1236, device='cuda:3')
benign distance is  tensor(140.1236, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4046037197113037
distance x is tensor(134.7166, device='cuda:3')
benign distance is  tensor(134.7166, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.1441409587860107
distance x is tensor(148.5836, device='cuda:3')
benign distance is  tensor(148.5836, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.735669732093811
distance x is tensor(131.4482, device='cuda:3')
benign distance is  tensor(131.4482, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.2041, device='cuda:3')
compute distance is  tensor(140.2041, device='cuda:3')
compute norm is  tensor(59.7360, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2202, device='cuda:3')
compute distance is  tensor(135.2202, device='cuda:3')
compute norm is  tensor(59.5139, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8544, device='cuda:3')
compute distance is  tensor(146.8544, device='cuda:3')
compute norm is  tensor(59.9005, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7142, device='cuda:3')
compute distance is  tensor(133.7142, device='cuda:3')
compute norm is  tensor(59.5840, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5723, device='cuda:3')
compute distance is  tensor(149.5723, device='cuda:3')
compute norm is  tensor(60.0829, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8871, device='cuda:3')
compute distance is  tensor(146.8871, device='cuda:3')
compute norm is  tensor(59.9942, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6903, device='cuda:3')
compute distance is  tensor(132.6903, device='cuda:3')
compute norm is  tensor(59.4826, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.5077, device='cuda:3')
compute distance is  tensor(130.5077, device='cuda:3')
compute norm is  tensor(59.6083, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3208, device='cuda:3')
compute distance is  tensor(146.3208, device='cuda:3')
compute norm is  tensor(59.8715, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9135, device='cuda:3')
compute distance is  tensor(135.9135, device='cuda:3')
compute norm is  tensor(59.8793, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0880, device='cuda:3')
compute distance is  tensor(142.0880, device='cuda:3')
compute norm is  tensor(59.7816, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.6535, device='cuda:3')
compute distance is  tensor(135.6535, device='cuda:3')
compute norm is  tensor(59.7855, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.5723, device='cuda:3')
distance x is tensor(107441.9688, device='cuda:3')
distance x is tensor(107441.9688, device='cuda:3')
________________________________
test distance is  tensor(107441.9688, device='cuda:3')
test distance1 is  tensor(107441.9688, device='cuda:3')
test similarity is  tensor(0.6466, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130061350783757.64
test entropy is  0.0
________________________________
cal ratio is  0.036564923654671545
distance x is tensor(3928.6130, device='cuda:3')
cal_distance is  tensor(3928.6130, device='cuda:3')
cal ratio is  0.19121943493315344
distance x is tensor(751.2312, device='cuda:3')
cal_distance is  tensor(751.2312, device='cuda:3')
cal ratio is  0.43728526682151386
distance x is tensor(328.5052, device='cuda:3')
cal_distance is  tensor(328.5052, device='cuda:3')
cal ratio is  0.6612726261940702
distance x is tensor(217.2332, device='cuda:3')
cal_distance is  tensor(217.2332, device='cuda:3')
cal ratio is  0.8131834892565157
distance x is tensor(176.6514, device='cuda:3')
cal_distance is  tensor(176.6514, device='cuda:3')
cal ratio is  0.9017645362436436
distance x is tensor(159.2984, device='cuda:3')
cal_distance is  tensor(159.2984, device='cuda:3')
cal ratio is  0.9496113341486628
distance x is tensor(151.2719, device='cuda:3')
cal_distance is  tensor(151.2719, device='cuda:3')
cal ratio is  0.9744792418297243
distance x is tensor(147.4114, device='cuda:3')
cal_distance is  tensor(147.4114, device='cuda:3')
distance x is tensor(147.4114, device='cuda:3')
return_distance is  tensor(147.4114, device='cuda:3')
distance x is tensor(147.4015, device='cuda:3')
distance x is tensor(147.4015, device='cuda:3')
________________________________
test distance is  tensor(147.4015, device='cuda:3')
test distance1 is  tensor(147.4015, device='cuda:3')
test similarity is  tensor(0.9854, device='cuda:3')
test acc is  0.11640000015633194
test loss is 76.67384394501318
test entropy is  0.010893751468657153
________________________________
0
distance x is tensor(147.4015, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.011096321184519514
avg test loss is  76.83980515567478
avg accuracy is  0.6672666668229994
solo acc is  0.11661666682299861
compute similarity  is  tensor(0.9854, device='cuda:3')
compute_distance is  tensor(147.4015, device='cuda:3')
compute_norm is  tensor(64.3093, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.7436, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0283079036136171
avg test loss is  1.5704947699870129
avg accuracy is  0.7535000001563277
solo acc is  0.24061666682300462
compute similarity  is  tensor(0.9858, device='cuda:3')
compute_distance is  tensor(145.7436, device='cuda:3')
compute_norm is  tensor(64.6461, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(145.8448, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6206906550982868
avg test loss is  2.4282080795464993
avg accuracy is  0.7340666668229954
solo acc is  0.10661666682299864
compute similarity  is  tensor(0.9857, device='cuda:3')
compute_distance is  tensor(145.8448, device='cuda:3')
compute_norm is  tensor(64.4210, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.2972, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9319722032241984
avg test loss is  1.4434828668006703
avg accuracy is  0.7768000001563264
solo acc is  0.25876666682300514
compute similarity  is  tensor(0.9858, device='cuda:3')
compute_distance is  tensor(144.2972, device='cuda:3')
compute_norm is  tensor(64.0444, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(144.2972, device='cuda:3')
distance x is tensor(144.2972, device='cuda:3')
________________________________
test distance is  tensor(144.2972, device='cuda:3')
test distance1 is  tensor(144.2972, device='cuda:3')
test similarity is  tensor(0.9858, device='cuda:3')
test acc is  0.26083333348967186
test loss is 1.4416838477669494
test entropy is  0.9320891988811209
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5071661472320557
mal norm is  tensor(714.7750, device='cuda:3')
distance x is tensor(144.3066, device='cuda:3')
mal distance is  tensor(144.3066, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([543.3768, 530.6353, 554.4351, 556.5290, 532.9688, 560.1501, 559.3015,
        554.0765, 714.7751, 714.7751, 714.7751, 714.7751, 714.7751, 714.7751,
        714.7751, 714.7751, 714.7751, 714.7751, 714.7751, 714.7751, 838.6113,
        822.8080, 828.0210, 826.1245, 862.2793, 841.8142, 871.9391, 791.5493,
        659.8965, 599.8781, 579.6225, 605.9716, 594.2939, 592.0668, 625.6859,
        652.8628], device='cuda:3')
sorted_norm is   tensor([530.6353, 532.9688, 543.3768, 554.0765, 554.4351, 556.5290, 559.3015,
        560.1501, 579.6225, 592.0668, 594.2939, 599.8781, 605.9716, 625.6859,
        652.8628, 659.8965, 714.7751, 714.7751, 714.7751, 714.7751, 714.7751,
        714.7751, 714.7751, 714.7751, 714.7751, 714.7751, 714.7751, 714.7751,
        791.5493, 822.8080, 826.1245, 828.0210, 838.6113, 841.8142, 862.2793,
        871.9391], device='cuda:3')
used idx is  tensor([ 1,  4,  0,  7,  2,  3,  6,  5, 30, 33, 32, 29, 31, 34, 35, 28, 11, 10,
         8,  9, 13, 12, 14, 15, 19, 18, 16, 17], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 82.83% 

Test Accuracy: 81.47% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.060373306274414
distance x is tensor(152.5015, device='cuda:3')
benign distance is  tensor(152.5015, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5447252988815308
distance x is tensor(136.5970, device='cuda:3')
benign distance is  tensor(136.5970, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.40630650520324707
distance x is tensor(143.4847, device='cuda:3')
benign distance is  tensor(143.4847, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0497643947601318
distance x is tensor(137.3452, device='cuda:3')
benign distance is  tensor(137.3452, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8789151906967163
distance x is tensor(131.4806, device='cuda:3')
benign distance is  tensor(131.4806, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6783044934272766
distance x is tensor(150.3232, device='cuda:3')
benign distance is  tensor(150.3232, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3900618851184845
distance x is tensor(141.5023, device='cuda:3')
benign distance is  tensor(141.5023, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5958799123764038
distance x is tensor(149.8708, device='cuda:3')
benign distance is  tensor(149.8708, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7456046342849731
distance x is tensor(138.4636, device='cuda:3')
benign distance is  tensor(138.4636, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5960596799850464
distance x is tensor(142.2326, device='cuda:3')
benign distance is  tensor(142.2326, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.41623082756996155
distance x is tensor(128.3482, device='cuda:3')
benign distance is  tensor(128.3482, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8337012529373169
distance x is tensor(151.5298, device='cuda:3')
benign distance is  tensor(151.5298, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7178088426589966
distance x is tensor(127.1101, device='cuda:3')
benign distance is  tensor(127.1101, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4993841052055359
distance x is tensor(157.1226, device='cuda:3')
benign distance is  tensor(157.1226, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.21863992512226105
distance x is tensor(140.6574, device='cuda:3')
benign distance is  tensor(140.6574, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7449610233306885
distance x is tensor(147.2005, device='cuda:3')
benign distance is  tensor(147.2005, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.24762168526649475
distance x is tensor(147.2038, device='cuda:3')
benign distance is  tensor(147.2038, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3660821318626404
distance x is tensor(144.0991, device='cuda:3')
benign distance is  tensor(144.0991, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5253778100013733
distance x is tensor(137.4598, device='cuda:3')
benign distance is  tensor(137.4598, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6921385526657104
distance x is tensor(143.7881, device='cuda:3')
benign distance is  tensor(143.7881, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9234405755996704
distance x is tensor(153.9600, device='cuda:3')
benign distance is  tensor(153.9600, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4417082667350769
distance x is tensor(143.3365, device='cuda:3')
benign distance is  tensor(143.3365, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3108040690422058
distance x is tensor(134.6184, device='cuda:3')
benign distance is  tensor(134.6184, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.40490835905075073
distance x is tensor(130.3884, device='cuda:3')
benign distance is  tensor(130.3884, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(142.8047, device='cuda:3')
compute distance is  tensor(142.8047, device='cuda:3')
compute norm is  tensor(62.4478, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.8958, device='cuda:3')
compute distance is  tensor(145.8958, device='cuda:3')
compute norm is  tensor(62.5128, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5756, device='cuda:3')
compute distance is  tensor(137.5756, device='cuda:3')
compute norm is  tensor(62.4179, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3273, device='cuda:3')
compute distance is  tensor(141.3273, device='cuda:3')
compute norm is  tensor(62.4353, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0377, device='cuda:3')
compute distance is  tensor(144.0377, device='cuda:3')
compute norm is  tensor(62.6108, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4936, device='cuda:3')
compute distance is  tensor(139.4936, device='cuda:3')
compute norm is  tensor(62.4251, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6344, device='cuda:3')
compute distance is  tensor(132.6344, device='cuda:3')
compute norm is  tensor(62.2424, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5169, device='cuda:3')
compute distance is  tensor(137.5169, device='cuda:3')
compute norm is  tensor(62.4956, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.9613, device='cuda:3')
compute distance is  tensor(140.9613, device='cuda:3')
compute norm is  tensor(62.3828, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.6917, device='cuda:3')
compute distance is  tensor(142.6917, device='cuda:3')
compute norm is  tensor(62.5170, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5914, device='cuda:3')
compute distance is  tensor(139.5914, device='cuda:3')
compute norm is  tensor(62.3945, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9176, device='cuda:3')
compute distance is  tensor(138.9176, device='cuda:3')
compute norm is  tensor(62.3448, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.8958, device='cuda:3')
distance x is tensor(107412.5469, device='cuda:3')
distance x is tensor(107412.5469, device='cuda:3')
________________________________
test distance is  tensor(107412.5469, device='cuda:3')
test distance1 is  tensor(107412.5469, device='cuda:3')
test similarity is  tensor(0.6771, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130073977713591.95
test entropy is  0.0
________________________________
cal ratio is  0.03611769095339564
distance x is tensor(3879.4985, device='cuda:3')
cal_distance is  tensor(3879.4985, device='cuda:3')
cal ratio is  0.19004641660004468
distance x is tensor(737.2889, device='cuda:3')
cal_distance is  tensor(737.2889, device='cuda:3')
cal ratio is  0.4359419326898683
distance x is tensor(321.4179, device='cuda:3')
cal_distance is  tensor(321.4179, device='cuda:3')
cal ratio is  0.6602561125394726
distance x is tensor(212.2198, device='cuda:3')
cal_distance is  tensor(212.2198, device='cuda:3')
cal ratio is  0.8125582441581314
distance x is tensor(172.4419, device='cuda:3')
cal_distance is  tensor(172.4419, device='cuda:3')
cal ratio is  0.9014176447970218
distance x is tensor(155.4427, device='cuda:3')
cal_distance is  tensor(155.4427, device='cuda:3')
cal ratio is  0.9494286325133651
distance x is tensor(147.5820, device='cuda:3')
cal_distance is  tensor(147.5820, device='cuda:3')
cal ratio is  0.9743853946031023
distance x is tensor(143.8019, device='cuda:3')
cal_distance is  tensor(143.8019, device='cuda:3')
distance x is tensor(143.8019, device='cuda:3')
return_distance is  tensor(143.8019, device='cuda:3')
distance x is tensor(143.7919, device='cuda:3')
distance x is tensor(143.7919, device='cuda:3')
________________________________
test distance is  tensor(143.7919, device='cuda:3')
test distance1 is  tensor(143.7919, device='cuda:3')
test similarity is  tensor(0.9883, device='cuda:3')
test acc is  0.3524166668230071
test loss is 11.857316629210516
test entropy is  0.13808907204663068
________________________________
0
distance x is tensor(143.7919, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.13917654148662395
avg test loss is  11.914641808853474
avg accuracy is  0.8020833334896588
solo acc is  0.35428333348967384
compute similarity  is  tensor(0.9883, device='cuda:3')
compute_distance is  tensor(143.7919, device='cuda:3')
compute_norm is  tensor(67.0458, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.7947, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.941365487031591
avg test loss is  1.3728032085432935
avg accuracy is  0.7830500001563262
solo acc is  0.29693333348967277
compute similarity  is  tensor(0.9885, device='cuda:3')
compute_distance is  tensor(138.7947, device='cuda:3')
compute_norm is  tensor(66.6806, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(138.7947, device='cuda:3')
distance x is tensor(138.7947, device='cuda:3')
________________________________
test distance is  tensor(138.7947, device='cuda:3')
test distance1 is  tensor(138.7947, device='cuda:3')
test similarity is  tensor(0.9885, device='cuda:3')
test acc is  0.29995000015633955
test loss is 1.3701320638153345
test entropy is  0.9401312558762809
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal loss is 0.8420619964599609
mal norm is  tensor(714.9177, device='cuda:3')
distance x is tensor(138.8038, device='cuda:3')
mal distance is  tensor(138.8038, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([619.8760, 565.3334, 572.0762, 542.6873, 527.3428, 602.9122, 557.4969,
        594.2782, 714.9177, 714.9177, 714.9177, 714.9177, 714.9177, 714.9177,
        714.9177, 714.9177, 714.9177, 714.9177, 714.9177, 714.9177],
       device='cuda:3')
sorted_norm is   tensor([527.3428, 542.6873, 557.4969, 565.3334, 572.0762, 594.2782, 602.9122,
        619.8760, 714.9177, 714.9177, 714.9177, 714.9177, 714.9177, 714.9177,
        714.9177, 714.9177, 714.9177, 714.9177, 714.9177, 714.9177],
       device='cuda:3')
used idx is  tensor([ 4,  3,  6,  1,  2,  7,  5,  0, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 84.59% 

Test Accuracy: 82.95% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.32486629486083984
distance x is tensor(138.2860, device='cuda:3')
benign distance is  tensor(138.2860, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8180133700370789
distance x is tensor(141.2329, device='cuda:3')
benign distance is  tensor(141.2329, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.41035494208335876
distance x is tensor(133.0668, device='cuda:3')
benign distance is  tensor(133.0668, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4805939793586731
distance x is tensor(140.6443, device='cuda:3')
benign distance is  tensor(140.6443, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6055055856704712
distance x is tensor(167.3738, device='cuda:3')
benign distance is  tensor(167.3738, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4603908956050873
distance x is tensor(150.6837, device='cuda:3')
benign distance is  tensor(150.6837, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4087294042110443
distance x is tensor(141.8993, device='cuda:3')
benign distance is  tensor(141.8993, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.609694242477417
distance x is tensor(155.8488, device='cuda:3')
benign distance is  tensor(155.8488, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.0792, device='cuda:3')
compute distance is  tensor(144.0792, device='cuda:3')
compute norm is  tensor(66.0257, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2493, device='cuda:3')
compute distance is  tensor(139.2493, device='cuda:3')
compute norm is  tensor(65.7977, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.4886, device='cuda:3')
compute distance is  tensor(148.4886, device='cuda:3')
compute norm is  tensor(66.2575, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0891, device='cuda:3')
compute distance is  tensor(145.0891, device='cuda:3')
compute norm is  tensor(66.1981, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.1771, device='cuda:3')
compute distance is  tensor(160.1771, device='cuda:3')
compute norm is  tensor(66.4528, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.1353, device='cuda:3')
compute distance is  tensor(156.1353, device='cuda:3')
compute norm is  tensor(66.5247, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.6740, device='cuda:3')
compute distance is  tensor(149.6740, device='cuda:3')
compute norm is  tensor(66.2961, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.8749, device='cuda:3')
compute distance is  tensor(143.8749, device='cuda:3')
compute norm is  tensor(66.1812, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4663, device='cuda:3')
compute distance is  tensor(146.4663, device='cuda:3')
compute norm is  tensor(65.9917, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3837, device='cuda:3')
compute distance is  tensor(132.3837, device='cuda:3')
compute norm is  tensor(65.9835, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.9241, device='cuda:3')
compute distance is  tensor(151.9241, device='cuda:3')
compute norm is  tensor(66.2339, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.6167, device='cuda:3')
compute distance is  tensor(142.6167, device='cuda:3')
compute norm is  tensor(66.1165, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(160.1771, device='cuda:3')
distance x is tensor(107362.0781, device='cuda:3')
distance x is tensor(107362.0781, device='cuda:3')
________________________________
test distance is  tensor(107362.0781, device='cuda:3')
test distance1 is  tensor(107362.0781, device='cuda:3')
test similarity is  tensor(0.7206, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130098214834621.4
test entropy is  0.0
________________________________
cal ratio is  0.03785304216838018
distance x is tensor(4063.9863, device='cuda:3')
cal_distance is  tensor(4063.9863, device='cuda:3')
cal ratio is  0.1945584598186725
distance x is tensor(790.6870, device='cuda:3')
cal_distance is  tensor(790.6870, device='cuda:3')
cal ratio is  0.44108668609162655
distance x is tensor(348.7643, device='cuda:3')
cal_distance is  tensor(348.7643, device='cuda:3')
cal ratio is  0.6641408802315133
distance x is tensor(231.6303, device='cuda:3')
cal_distance is  tensor(231.6303, device='cuda:3')
cal ratio is  0.8149454755330642
distance x is tensor(188.7670, device='cuda:3')
cal_distance is  tensor(188.7670, device='cuda:3')
cal ratio is  0.9027410331292363
distance x is tensor(170.4082, device='cuda:3')
cal_distance is  tensor(170.4082, device='cuda:3')
cal ratio is  0.9501255495656755
distance x is tensor(161.9094, device='cuda:3')
cal_distance is  tensor(161.9094, device='cuda:3')
cal ratio is  0.9747430524561335
distance x is tensor(157.8202, device='cuda:3')
cal_distance is  tensor(157.8202, device='cuda:3')
distance x is tensor(157.8202, device='cuda:3')
return_distance is  tensor(157.8202, device='cuda:3')
distance x is tensor(157.8103, device='cuda:3')
distance x is tensor(157.8103, device='cuda:3')
________________________________
test distance is  tensor(157.8103, device='cuda:3')
test distance1 is  tensor(157.8103, device='cuda:3')
test similarity is  tensor(0.9896, device='cuda:3')
test acc is  0.1036333334896653
test loss is 120.18672651116019
test entropy is  0.0026287453749514354
________________________________
0
distance x is tensor(157.8103, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0032307325111794716
avg test loss is  120.99752853165812
avg accuracy is  0.5761166668230062
solo acc is  0.10390000015633197
compute similarity  is  tensor(0.9896, device='cuda:3')
compute_distance is  tensor(157.8103, device='cuda:3')
compute_norm is  tensor(71.7201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4450.0854, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5377254207759523
avg test loss is  2.897346443458915
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1389, device='cuda:3')
compute_distance is  tensor(4450.0854, device='cuda:3')
compute_norm is  tensor(530.3043, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4429.4473, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.833724014858193
avg test loss is  3.636447505656082
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1390, device='cuda:3')
compute_distance is  tensor(4429.4473, device='cuda:3')
compute_norm is  tensor(528.0274, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4408.7388, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5558367835433244
avg test loss is  2.8658326739695537
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1389, device='cuda:3')
compute_distance is  tensor(4408.7388, device='cuda:3')
compute_norm is  tensor(525.2952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4388.2993, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8406560316777179
avg test loss is  3.6158256736645566
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1389, device='cuda:3')
compute_distance is  tensor(4388.2993, device='cuda:3')
compute_norm is  tensor(523.0747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4367.7930, device='cuda:3')
distance x is tensor(4367.7930, device='cuda:3')
________________________________
test distance is  tensor(4367.7930, device='cuda:3')
test distance1 is  tensor(4367.7930, device='cuda:3')
test similarity is  tensor(0.1389, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8620446523877856
test entropy is  1.5589507639026845
________________________________
cal ratio is  0.18767016060303124
distance x is tensor(819.7039, device='cuda:3')
cal_distance is  tensor(819.7039, device='cuda:3')
cal ratio is  0.43320927276927124
distance x is tensor(355.1031, device='cuda:3')
cal_distance is  tensor(355.1031, device='cuda:3')
cal ratio is  0.6581865444551326
distance x is tensor(233.7240, device='cuda:3')
cal_distance is  tensor(233.7240, device='cuda:3')
cal ratio is  0.8112871869062003
distance x is tensor(189.6172, device='cuda:3')
cal_distance is  tensor(189.6172, device='cuda:3')
cal ratio is  0.9007150084331772
distance x is tensor(170.7910, device='cuda:3')
cal_distance is  tensor(170.7910, device='cuda:3')
cal ratio is  0.949060198366893
distance x is tensor(162.0909, device='cuda:3')
cal_distance is  tensor(162.0909, device='cuda:3')
cal ratio is  0.9741971735641336
distance x is tensor(157.9085, device='cuda:3')
cal_distance is  tensor(157.9085, device='cuda:3')
distance x is tensor(157.9085, device='cuda:3')
return_distance is  tensor(157.9085, device='cuda:3')
distance x is tensor(157.9093, device='cuda:3')
distance x is tensor(157.9093, device='cuda:3')
________________________________
test distance is  tensor(157.9093, device='cuda:3')
test distance1 is  tensor(157.9093, device='cuda:3')
test similarity is  tensor(0.9514, device='cuda:3')
test acc is  0.10003333348966531
test loss is 30451.789316531183
test entropy is  0.006785966922046309
________________________________
0
distance x is tensor(157.9093, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00683128464090897
avg test loss is  30477.635604760795
avg accuracy is  0.10053333348966531
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9514, device='cuda:3')
compute_distance is  tensor(157.9093, device='cuda:3')
compute_norm is  tensor(71.9634, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1674.3533, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5516775317791938
avg test loss is  2.8765747188759256
avg accuracy is  0.08695000015633203
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3432, device='cuda:3')
compute_distance is  tensor(1674.3533, device='cuda:3')
compute_norm is  tensor(150.5083, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1668.3757, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.842051949201108
avg test loss is  3.6283842899651924
avg accuracy is  0.08560000015633203
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3434, device='cuda:3')
compute_distance is  tensor(1668.3757, device='cuda:3')
compute_norm is  tensor(150.0294, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1661.8657, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.551591603359434
avg test loss is  2.873379480355838
avg accuracy is  0.08765000015633202
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3431, device='cuda:3')
compute_distance is  tensor(1661.8657, device='cuda:3')
compute_norm is  tensor(149.0641, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1655.9971, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8463086166234413
avg test loss is  3.6154541313521134
avg accuracy is  0.0849666668229987
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3433, device='cuda:3')
compute_distance is  tensor(1655.9971, device='cuda:3')
compute_norm is  tensor(148.6131, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1649.6270, device='cuda:3')
distance x is tensor(1649.6270, device='cuda:3')
________________________________
test distance is  tensor(1649.6270, device='cuda:3')
test distance1 is  tensor(1649.6270, device='cuda:3')
test similarity is  tensor(0.3430, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8658641787734367
test entropy is  1.5582145815973343
________________________________
cal ratio is  0.3053749213642139
distance x is tensor(503.7502, device='cuda:3')
cal_distance is  tensor(503.7502, device='cuda:3')
cal ratio is  0.5526098543989573
distance x is tensor(278.3757, device='cuda:3')
cal_distance is  tensor(278.3757, device='cuda:3')
cal ratio is  0.7433794523445449
distance x is tensor(206.9379, device='cuda:3')
cal_distance is  tensor(206.9379, device='cuda:3')
cal ratio is  0.8621963594125955
distance x is tensor(178.4206, device='cuda:3')
cal_distance is  tensor(178.4206, device='cuda:3')
cal ratio is  0.9285465623887577
distance x is tensor(165.6716, device='cuda:3')
cal_distance is  tensor(165.6716, device='cuda:3')
cal ratio is  0.9636118720230835
distance x is tensor(159.6430, device='cuda:3')
cal_distance is  tensor(159.6430, device='cuda:3')
distance x is tensor(159.6430, device='cuda:3')
return_distance is  tensor(159.6430, device='cuda:3')
distance x is tensor(159.6500, device='cuda:3')
distance x is tensor(159.6500, device='cuda:3')
________________________________
test distance is  tensor(159.6500, device='cuda:3')
test distance1 is  tensor(159.6500, device='cuda:3')
test similarity is  tensor(0.9816, device='cuda:3')
test acc is  0.24451666682300474
test loss is 1.8097639360915878
test entropy is  1.7422871419361659
________________________________
0
distance x is tensor(159.6500, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7424340620478078
avg test loss is  1.8127693645735539
avg accuracy is  0.6112000001563367
solo acc is  0.24723333348967158
compute similarity  is  tensor(0.9816, device='cuda:3')
compute_distance is  tensor(159.6500, device='cuda:3')
compute_norm is  tensor(64.5008, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.2871, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7484448416782087
avg test loss is  2.746669901205278
avg accuracy is  0.6208666668230026
solo acc is  0.10708333348966528
compute similarity  is  tensor(0.9814, device='cuda:3')
compute_distance is  tensor(163.2871, device='cuda:3')
compute_norm is  tensor(64.4684, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.8367, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.066729231938116
avg test loss is  1.637664683465002
avg accuracy is  0.690600000156331
solo acc is  0.24328333348967135
compute similarity  is  tensor(0.9815, device='cuda:3')
compute_distance is  tensor(165.8367, device='cuda:3')
compute_norm is  tensor(64.1196, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.0983, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6470019880896692
avg test loss is  2.562519976579304
avg accuracy is  0.6914166668229978
solo acc is  0.10578333348966529
compute similarity  is  tensor(0.9813, device='cuda:3')
compute_distance is  tensor(168.0983, device='cuda:3')
compute_norm is  tensor(63.9177, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.1962, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0342370438804505
avg test loss is  1.5268263630012968
avg accuracy is  0.7050833334896636
solo acc is  0.2608000001563386
compute similarity  is  tensor(0.9813, device='cuda:3')
compute_distance is  tensor(170.1962, device='cuda:3')
compute_norm is  tensor(63.5786, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(172.2418, device='cuda:3')
________________________________
test distance is  tensor(172.2418, device='cuda:3')
test similarity is  tensor(0.9810, device='cuda:3')
test acc is  0.7047333334896638
test loss is 2.397334822840782
test entropy is  0.6351406952338432
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.297375202178955
mal norm is  tensor(638.4036, device='cuda:3')
distance x is tensor(172.2418, device='cuda:3')
mal distance is  tensor(172.2418, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 555.2222,  550.7090,  538.6390,  557.4955,  625.3690,  590.7661,
         552.8048,  609.0582,  638.4037,  638.4036,  638.4037,  638.4036,
         638.4037,  638.4036,  638.4037,  638.4036,  638.4037,  638.4036,
         638.4037,  638.4036, 1298.0321, 1291.4923, 1280.9135, 1303.6388,
        1287.5918, 1307.0697, 1311.8729, 1312.9895,  818.6821,  830.9918,
         841.7025,  823.6398,  795.1334,  805.9032,  817.1912,  811.9531,
         666.3166,  682.8674,  639.6975,  702.0181,  636.5601,  718.7019,
         676.7833,  694.4671], device='cuda:3')
sorted_norm is   tensor([ 538.6390,  550.7090,  552.8048,  555.2222,  557.4955,  590.7661,
         609.0582,  625.3690,  636.5601,  638.4036,  638.4036,  638.4036,
         638.4036,  638.4036,  638.4036,  638.4037,  638.4037,  638.4037,
         638.4037,  638.4037,  638.4037,  639.6975,  666.3166,  676.7833,
         682.8674,  694.4671,  702.0181,  718.7019,  795.1334,  805.9032,
         811.9531,  817.1912,  818.6821,  823.6398,  830.9918,  841.7025,
        1280.9135, 1287.5918, 1291.4923, 1298.0321, 1303.6388, 1307.0697,
        1311.8729, 1312.9895], device='cuda:3')
used idx is  tensor([ 2,  1,  6,  0,  3,  5,  7,  4, 40, 11, 19, 17, 13,  9, 15, 16, 14, 12,
         8, 10, 18, 38, 36, 42, 37, 43, 39, 41, 32, 33, 35, 34, 28, 31, 29],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 75.47% 

Test Accuracy: 74.15% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5472933053970337
distance x is tensor(131.8171, device='cuda:3')
benign distance is  tensor(131.8171, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.642250657081604
distance x is tensor(143.4438, device='cuda:3')
benign distance is  tensor(143.4438, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.37183135747909546
distance x is tensor(150.9380, device='cuda:3')
benign distance is  tensor(150.9380, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9309519529342651
distance x is tensor(139.5146, device='cuda:3')
benign distance is  tensor(139.5146, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5397440791130066
distance x is tensor(145.2755, device='cuda:3')
benign distance is  tensor(145.2755, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5499175786972046
distance x is tensor(141.0927, device='cuda:3')
benign distance is  tensor(141.0927, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2701154947280884
distance x is tensor(159.4444, device='cuda:3')
benign distance is  tensor(159.4444, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5059750080108643
distance x is tensor(141.3505, device='cuda:3')
benign distance is  tensor(141.3505, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.34900787472724915
distance x is tensor(144.2904, device='cuda:3')
benign distance is  tensor(144.2904, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.46756187081336975
distance x is tensor(137.1032, device='cuda:3')
benign distance is  tensor(137.1032, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.16195452213287354
distance x is tensor(127.0893, device='cuda:3')
benign distance is  tensor(127.0893, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5988457202911377
distance x is tensor(158.4720, device='cuda:3')
benign distance is  tensor(158.4720, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.36501625180244446
distance x is tensor(130.2228, device='cuda:3')
benign distance is  tensor(130.2228, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3042360544204712
distance x is tensor(133.3592, device='cuda:3')
benign distance is  tensor(133.3592, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5500901937484741
distance x is tensor(128.7622, device='cuda:3')
benign distance is  tensor(128.7622, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4626537263393402
distance x is tensor(149.9725, device='cuda:3')
benign distance is  tensor(149.9725, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.39077916741371155
distance x is tensor(160.1381, device='cuda:3')
benign distance is  tensor(160.1381, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6141932606697083
distance x is tensor(147.6008, device='cuda:3')
benign distance is  tensor(147.6008, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.525042712688446
distance x is tensor(138.3255, device='cuda:3')
benign distance is  tensor(138.3255, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4939475953578949
distance x is tensor(139.1985, device='cuda:3')
benign distance is  tensor(139.1985, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3894383907318115
distance x is tensor(132.8637, device='cuda:3')
benign distance is  tensor(132.8637, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5788955688476562
distance x is tensor(131.8959, device='cuda:3')
benign distance is  tensor(131.8959, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.38675397634506226
distance x is tensor(137.6318, device='cuda:3')
benign distance is  tensor(137.6318, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7004339694976807
distance x is tensor(142.9490, device='cuda:3')
benign distance is  tensor(142.9490, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2204645574092865
distance x is tensor(140.7986, device='cuda:3')
benign distance is  tensor(140.7986, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.46036815643310547
distance x is tensor(142.3053, device='cuda:3')
benign distance is  tensor(142.3053, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.42449602484703064
distance x is tensor(133.2774, device='cuda:3')
benign distance is  tensor(133.2774, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.28995317220687866
distance x is tensor(127.3053, device='cuda:3')
benign distance is  tensor(127.3053, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3588336110115051
distance x is tensor(140.9649, device='cuda:3')
benign distance is  tensor(140.9649, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6718911528587341
distance x is tensor(133.4966, device='cuda:3')
benign distance is  tensor(133.4966, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6919162273406982
distance x is tensor(145.6205, device='cuda:3')
benign distance is  tensor(145.6205, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.38785678148269653
distance x is tensor(141.3637, device='cuda:3')
benign distance is  tensor(141.3637, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(128.4629, device='cuda:3')
compute distance is  tensor(128.4629, device='cuda:3')
compute norm is  tensor(63.7308, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1487, device='cuda:3')
compute distance is  tensor(136.1487, device='cuda:3')
compute norm is  tensor(63.7369, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5168, device='cuda:3')
compute distance is  tensor(140.5168, device='cuda:3')
compute norm is  tensor(63.9791, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.3098, device='cuda:3')
compute distance is  tensor(149.3098, device='cuda:3')
compute norm is  tensor(63.9590, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0119, device='cuda:3')
compute distance is  tensor(142.0119, device='cuda:3')
compute norm is  tensor(64.0482, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3620, device='cuda:3')
compute distance is  tensor(141.3620, device='cuda:3')
compute norm is  tensor(63.9824, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1667, device='cuda:3')
compute distance is  tensor(132.1667, device='cuda:3')
compute norm is  tensor(63.7667, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7676, device='cuda:3')
compute distance is  tensor(131.7676, device='cuda:3')
compute norm is  tensor(63.8150, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5244, device='cuda:3')
compute distance is  tensor(137.5244, device='cuda:3')
compute norm is  tensor(63.8573, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2701, device='cuda:3')
compute distance is  tensor(141.2701, device='cuda:3')
compute norm is  tensor(64.0328, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7995, device='cuda:3')
compute distance is  tensor(138.7995, device='cuda:3')
compute norm is  tensor(63.9134, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.0199, device='cuda:3')
compute distance is  tensor(143.0199, device='cuda:3')
compute norm is  tensor(64.0599, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.3098, device='cuda:3')
distance x is tensor(107436.1875, device='cuda:3')
distance x is tensor(107436.1875, device='cuda:3')
________________________________
test distance is  tensor(107436.1875, device='cuda:3')
test distance1 is  tensor(107436.1875, device='cuda:3')
test similarity is  tensor(0.6662, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130133642940023.0
test entropy is  0.0
________________________________
cal ratio is  0.03653381188394531
distance x is tensor(3925.0588, device='cuda:3')
cal_distance is  tensor(3925.0588, device='cuda:3')
cal ratio is  0.19113806533144234
distance x is tensor(750.2321, device='cuda:3')
cal_distance is  tensor(750.2321, device='cuda:3')
cal ratio is  0.4371922628989915
distance x is tensor(327.9985, device='cuda:3')
cal_distance is  tensor(327.9985, device='cuda:3')
cal ratio is  0.6612022868719782
distance x is tensor(216.8751, device='cuda:3')
cal_distance is  tensor(216.8751, device='cuda:3')
cal ratio is  0.8131402653896606
distance x is tensor(176.3508, device='cuda:3')
cal_distance is  tensor(176.3508, device='cuda:3')
cal ratio is  0.901740508622617
distance x is tensor(159.0231, device='cuda:3')
cal_distance is  tensor(159.0231, device='cuda:3')
cal ratio is  0.9495986748817891
distance x is tensor(151.0084, device='cuda:3')
cal_distance is  tensor(151.0084, device='cuda:3')
cal ratio is  0.9744727800256141
distance x is tensor(147.1537, device='cuda:3')
cal_distance is  tensor(147.1537, device='cuda:3')
distance x is tensor(147.1537, device='cuda:3')
return_distance is  tensor(147.1537, device='cuda:3')
distance x is tensor(147.1438, device='cuda:3')
distance x is tensor(147.1438, device='cuda:3')
________________________________
test distance is  tensor(147.1438, device='cuda:3')
test distance1 is  tensor(147.1438, device='cuda:3')
test similarity is  tensor(0.9880, device='cuda:3')
test acc is  0.7305833334896621
test loss is 2.690295921459889
test entropy is  0.2220812021637522
________________________________
0
distance x is tensor(147.1438, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.22253372007881655
avg test loss is  2.6738280749270147
avg accuracy is  0.7599000001563273
solo acc is  0.729600000156329
compute similarity  is  tensor(0.9880, device='cuda:3')
compute_distance is  tensor(147.1438, device='cuda:3')
compute_norm is  tensor(68.5686, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.7325, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9951494313887695
avg test loss is  1.5153906997332949
avg accuracy is  0.7380500001563285
solo acc is  0.25268333348967165
compute similarity  is  tensor(0.9881, device='cuda:3')
compute_distance is  tensor(144.7325, device='cuda:3')
compute_norm is  tensor(68.3204, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(144.7325, device='cuda:3')
distance x is tensor(144.7325, device='cuda:3')
________________________________
test distance is  tensor(144.7325, device='cuda:3')
test distance1 is  tensor(144.7325, device='cuda:3')
test similarity is  tensor(0.9881, device='cuda:3')
test acc is  0.252016666823005
test loss is 1.5153715933309688
test entropy is  0.9960021072867583
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.5570276975631714
mal norm is  tensor(735.9981, device='cuda:3')
distance x is tensor(144.7417, device='cuda:3')
mal distance is  tensor(144.7417, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([566.6441, 583.6151, 626.0129, 572.5742, 598.9463, 578.9547, 626.9744,
        575.9365, 735.9981, 735.9981, 735.9981, 735.9981, 735.9981, 735.9981,
        735.9981, 735.9981, 735.9981, 735.9981, 735.9981, 735.9981],
       device='cuda:3')
sorted_norm is   tensor([566.6441, 572.5742, 575.9365, 578.9547, 583.6151, 598.9463, 626.0129,
        626.9744, 735.9981, 735.9981, 735.9981, 735.9981, 735.9981, 735.9981,
        735.9981, 735.9981, 735.9981, 735.9981, 735.9981, 735.9981],
       device='cuda:3')
used idx is  tensor([ 0,  3,  7,  5,  1,  4,  2,  6, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 80.82% 

Test Accuracy: 80.04% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1624667644500732
distance x is tensor(141.2451, device='cuda:3')
benign distance is  tensor(141.2451, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7705399990081787
distance x is tensor(142.6420, device='cuda:3')
benign distance is  tensor(142.6420, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25230851769447327
distance x is tensor(138.4083, device='cuda:3')
benign distance is  tensor(138.4083, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.917050838470459
distance x is tensor(137.5797, device='cuda:3')
benign distance is  tensor(137.5797, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7334521412849426
distance x is tensor(135.3222, device='cuda:3')
benign distance is  tensor(135.3222, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7310066819190979
distance x is tensor(132.9964, device='cuda:3')
benign distance is  tensor(132.9964, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5388439893722534
distance x is tensor(141.7187, device='cuda:3')
benign distance is  tensor(141.7187, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24272795021533966
distance x is tensor(141.4352, device='cuda:3')
benign distance is  tensor(141.4352, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(136.8635, device='cuda:3')
compute distance is  tensor(136.8635, device='cuda:3')
compute norm is  tensor(67.3571, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.2999, device='cuda:3')
compute distance is  tensor(159.2999, device='cuda:3')
compute norm is  tensor(67.8333, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0430, device='cuda:3')
compute distance is  tensor(149.0430, device='cuda:3')
compute norm is  tensor(67.6962, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2543, device='cuda:3')
compute distance is  tensor(147.2543, device='cuda:3')
compute norm is  tensor(67.7330, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.7389, device='cuda:3')
compute distance is  tensor(148.7389, device='cuda:3')
compute norm is  tensor(67.6480, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.7457, device='cuda:3')
compute distance is  tensor(154.7457, device='cuda:3')
compute norm is  tensor(67.7777, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2969, device='cuda:3')
compute distance is  tensor(129.2969, device='cuda:3')
compute norm is  tensor(67.2829, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0238, device='cuda:3')
compute distance is  tensor(123.0238, device='cuda:3')
compute norm is  tensor(66.8899, device='cuda:3', dtype=torch.float64)
distance x is tensor(634.6092, device='cuda:3')
compute distance is  tensor(634.6092, device='cuda:3')
compute norm is  tensor(106.2354, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3996, device='cuda:3')
compute distance is  tensor(133.3996, device='cuda:3')
compute norm is  tensor(67.2823, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5420, device='cuda:3')
compute distance is  tensor(135.5420, device='cuda:3')
compute norm is  tensor(67.3219, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2242, device='cuda:3')
compute distance is  tensor(123.2242, device='cuda:3')
compute norm is  tensor(67.0242, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(634.6092, device='cuda:3')
distance x is tensor(107378.7188, device='cuda:3')
distance x is tensor(107378.7188, device='cuda:3')
________________________________
test distance is  tensor(107378.7188, device='cuda:3')
test distance1 is  tensor(107378.7188, device='cuda:3')
test similarity is  tensor(0.7137, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130034135930465.16
test entropy is  0.0
________________________________
cal ratio is  0.07533905218122618
distance x is tensor(8089.8159, device='cuda:3')
cal_distance is  tensor(8089.8159, device='cuda:3')
cal ratio is  0.27447951201659065
distance x is tensor(2220.4924, device='cuda:3')
cal_distance is  tensor(2220.4924, device='cuda:3')
cal ratio is  0.5239074981770151
distance x is tensor(1163.3350, device='cuda:3')
cal_distance is  tensor(1163.3350, device='cuda:3')
cal ratio is  0.723813805065357
distance x is tensor(842.0392, device='cuda:3')
cal_distance is  tensor(842.0392, device='cuda:3')
cal ratio is  0.8507718154902554
distance x is tensor(716.3841, device='cuda:3')
cal_distance is  tensor(716.3841, device='cuda:3')
cal ratio is  0.9223723812916508
distance x is tensor(660.7733, device='cuda:3')
cal_distance is  tensor(660.7733, device='cuda:3')
cal ratio is  0.9604019298057241
distance x is tensor(634.6082, device='cuda:3')
cal_distance is  tensor(634.6082, device='cuda:3')
distance x is tensor(634.6082, device='cuda:3')
return_distance is  tensor(634.6082, device='cuda:3')
distance x is tensor(634.5982, device='cuda:3')
distance x is tensor(634.5982, device='cuda:3')
________________________________
test distance is  tensor(634.5982, device='cuda:3')
test distance1 is  tensor(634.5982, device='cuda:3')
test similarity is  tensor(0.9277, device='cuda:3')
test acc is  0.10000000015633198
test loss is 128837.35690964818
test entropy is  0.0
________________________________
0
distance x is tensor(634.5982, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  128940.93545942164
avg accuracy is  0.1011333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9277, device='cuda:3')
compute_distance is  tensor(634.5982, device='cuda:3')
compute_norm is  tensor(101.1883, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(12026792., device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5810799179300825
avg test loss is  2.859332054662806
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1948, device='cuda:3')
compute_distance is  tensor(12026792., device='cuda:3')
compute_norm is  tensor(572873.2468, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11970523., device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8437335777130208
avg test loss is  3.6448051349948973
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1948, device='cuda:3')
compute_distance is  tensor(11970523., device='cuda:3')
compute_norm is  tensor(570193.0362, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11914512., device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5559357830456324
avg test loss is  2.867600977293718
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1948, device='cuda:3')
compute_distance is  tensor(11914512., device='cuda:3')
compute_norm is  tensor(567524.8991, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11858767., device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8387376657808259
avg test loss is  3.632631356019709
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1948, device='cuda:3')
compute_distance is  tensor(11858767., device='cuda:3')
compute_norm is  tensor(564869.6274, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11803281., device='cuda:3')
distance x is tensor(11803281., device='cuda:3')
________________________________
test distance is  tensor(11803281., device='cuda:3')
test distance1 is  tensor(11803281., device='cuda:3')
test similarity is  tensor(-0.1948, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8626964199009226
test entropy is  1.5562758408883997
________________________________
cal ratio is  0.007185845485995893
distance x is tensor(84816.5547, device='cuda:3')
cal_distance is  tensor(84816.5547, device='cuda:3')
cal ratio is  0.08476936816595387
distance x is tensor(7189.8433, device='cuda:3')
cal_distance is  tensor(7189.8433, device='cuda:3')
cal ratio is  0.29115183815311174
distance x is tensor(2093.3342, device='cuda:3')
cal_distance is  tensor(2093.3342, device='cuda:3')
cal ratio is  0.5395851174316467
distance x is tensor(1129.5310, device='cuda:3')
cal_distance is  tensor(1129.5310, device='cuda:3')
cal ratio is  0.734564892408827
distance x is tensor(829.7134, device='cuda:3')
cal_distance is  tensor(829.7134, device='cuda:3')
cal ratio is  0.8570678718830839
distance x is tensor(711.1204, device='cuda:3')
cal_distance is  tensor(711.1204, device='cuda:3')
cal ratio is  0.9257797474651779
distance x is tensor(658.3408, device='cuda:3')
cal_distance is  tensor(658.3408, device='cuda:3')
cal ratio is  0.9621746013429711
distance x is tensor(633.4387, device='cuda:3')
cal_distance is  tensor(633.4387, device='cuda:3')
distance x is tensor(633.4387, device='cuda:3')
return_distance is  tensor(633.4387, device='cuda:3')
distance x is tensor(633.4455, device='cuda:3')
distance x is tensor(633.4455, device='cuda:3')
________________________________
test distance is  tensor(633.4455, device='cuda:3')
test distance1 is  tensor(633.4455, device='cuda:3')
test similarity is  tensor(0.8240, device='cuda:3')
test acc is  0.10010000015633198
test loss is 2.7971683877871745
test entropy is  1.7952415971105287
________________________________
0
distance x is tensor(633.4455, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7943582014996868
avg test loss is  2.7988701016663997
avg accuracy is  0.21151666682300352
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.8240, device='cuda:3')
compute_distance is  tensor(633.4455, device='cuda:3')
compute_norm is  tensor(74.0666, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(633.0652, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8234079234254386
avg test loss is  3.669563001406981
avg accuracy is  0.20183333348966978
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8240, device='cuda:3')
compute_distance is  tensor(633.0652, device='cuda:3')
compute_norm is  tensor(73.9228, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(631.5663, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.549372813594875
avg test loss is  2.877651328216992
avg accuracy is  0.20970000015633677
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8239, device='cuda:3')
compute_distance is  tensor(631.5663, device='cuda:3')
compute_norm is  tensor(73.2879, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(630.8135, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8354509603113
avg test loss is  3.6334074763601016
avg accuracy is  0.2043833334896699
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8239, device='cuda:3')
compute_distance is  tensor(630.8135, device='cuda:3')
compute_norm is  tensor(73.1723, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(629.4185, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5548796352547114
avg test loss is  2.8691025753773607
avg accuracy is  0.21231666682300354
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8238, device='cuda:3')
compute_distance is  tensor(629.4185, device='cuda:3')
compute_norm is  tensor(72.5587, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(628.7695, device='cuda:3')
distance x is tensor(628.7695, device='cuda:3')
________________________________
test distance is  tensor(628.7695, device='cuda:3')
test distance1 is  tensor(628.7695, device='cuda:3')
test similarity is  tensor(0.8238, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.6232263365788246
test entropy is  0.8378192116456754
________________________________
0
distance x is tensor(628.7695, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8379225735344104
avg test loss is  3.6240779169078574
avg accuracy is  0.20570000015633663
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8238, device='cuda:3')
compute_distance is  tensor(628.7695, device='cuda:3')
compute_norm is  tensor(72.4657, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(627.4934, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.553691234034516
avg test loss is  2.867553997141466
avg accuracy is  0.21541666682300364
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8237, device='cuda:3')
compute_distance is  tensor(627.4934, device='cuda:3')
compute_norm is  tensor(71.8522, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(626.8944, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8390628334555799
avg test loss is  3.619899943185005
avg accuracy is  0.20740000015633664
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8237, device='cuda:3')
compute_distance is  tensor(626.8944, device='cuda:3')
compute_norm is  tensor(71.7776, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(625.7128, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.555331344797667
avg test loss is  2.864522239038431
avg accuracy is  0.21713333348967043
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8236, device='cuda:3')
compute_distance is  tensor(625.7128, device='cuda:3')
compute_norm is  tensor(71.1618, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(625.1392, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8436002304304892
avg test loss is  3.610101431417567
avg accuracy is  0.21233333348967023
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8237, device='cuda:3')
compute_distance is  tensor(625.1392, device='cuda:3')
compute_norm is  tensor(71.1017, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(624.0247, device='cuda:3')
________________________________
test distance is  tensor(624.0247, device='cuda:3')
test similarity is  tensor(0.8236, device='cuda:3')
test acc is  0.22171666682300392
test loss is 2.860568547299676
test entropy is  1.5580447720312107
________________________________
final entropy
distance x is tensor(624.0304, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.557225348852845
avg test loss is  2.859958210479476
avg accuracy is  0.22296666682300398
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8236, device='cuda:3')
compute_distance is  tensor(624.0304, device='cuda:3')
compute_norm is  tensor(70.4850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.7383155822753906
mal norm is  tensor(2013.7528, device='cuda:3')
distance x is tensor(623.4675, device='cuda:3')
mal distance is  tensor(623.4675, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 577.1455,  582.5963,  551.4785,  543.1086,  539.4503,  542.5917,
         561.7465,  568.7230, 2013.7529, 2013.7528, 2013.7529, 2013.7528,
        2013.7529, 2013.7528, 2013.7529, 2013.7528, 2013.7529, 2013.7528,
        2013.7529, 2013.7528,  846.6755,  881.6166,  861.1979,  889.9134,
         873.3518,  847.7341,  886.9570,  850.4531,  746.3896,  728.2361,
         714.0820,  725.2468,  737.2456,  720.9513,  707.6396,  689.5137,
         680.0729,  675.6660,  649.3456,  709.8598,  648.0786,  665.6700,
         645.1568,  711.6435], device='cuda:3')
sorted_norm is   tensor([ 539.4503,  542.5917,  543.1086,  551.4785,  561.7465,  568.7230,
         577.1455,  582.5963,  645.1568,  648.0786,  649.3456,  665.6700,
         675.6660,  680.0729,  689.5137,  707.6396,  709.8598,  711.6435,
         714.0820,  720.9513,  725.2468,  728.2361,  737.2456,  746.3896,
         846.6755,  847.7341,  850.4531,  861.1979,  873.3518,  881.6166,
         886.9570,  889.9134, 2013.7528, 2013.7528, 2013.7528, 2013.7528,
        2013.7528, 2013.7528, 2013.7529, 2013.7529, 2013.7529, 2013.7529,
        2013.7529, 2013.7529], device='cuda:3')
used idx is  tensor([ 4,  5,  3,  2,  6,  7,  0,  1, 42, 40, 38, 41, 37, 36, 35, 34, 39, 43,
        30, 33, 31, 29, 32, 28, 20, 25, 27, 22, 24, 21, 26, 23, 11,  9, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 87.43% 

Test Accuracy: 86.03% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19967229664325714
distance x is tensor(123.2433, device='cuda:3')
benign distance is  tensor(123.2433, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.24167954921722412
distance x is tensor(119.0749, device='cuda:3')
benign distance is  tensor(119.0749, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.391115665435791
distance x is tensor(119.7748, device='cuda:3')
benign distance is  tensor(119.7748, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.637437105178833
distance x is tensor(109.2548, device='cuda:3')
benign distance is  tensor(109.2548, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5984926223754883
distance x is tensor(129.2487, device='cuda:3')
benign distance is  tensor(129.2487, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.36478957533836365
distance x is tensor(127.6638, device='cuda:3')
benign distance is  tensor(127.6638, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8852798342704773
distance x is tensor(119.0166, device='cuda:3')
benign distance is  tensor(119.0166, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9887162446975708
distance x is tensor(124.0013, device='cuda:3')
benign distance is  tensor(124.0013, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.38181692361831665
distance x is tensor(118.1452, device='cuda:3')
benign distance is  tensor(118.1452, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4390617311000824
distance x is tensor(118.7482, device='cuda:3')
benign distance is  tensor(118.7482, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9225796461105347
distance x is tensor(120.4495, device='cuda:3')
benign distance is  tensor(120.4495, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4408271312713623
distance x is tensor(124.9305, device='cuda:3')
benign distance is  tensor(124.9305, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6845251321792603
distance x is tensor(137.5740, device='cuda:3')
benign distance is  tensor(137.5740, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4806268811225891
distance x is tensor(118.6494, device='cuda:3')
benign distance is  tensor(118.6494, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4820738732814789
distance x is tensor(113.5563, device='cuda:3')
benign distance is  tensor(113.5563, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.31948330998420715
distance x is tensor(124.2966, device='cuda:3')
benign distance is  tensor(124.2966, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4467122554779053
distance x is tensor(122.7028, device='cuda:3')
benign distance is  tensor(122.7028, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5658280253410339
distance x is tensor(111.8052, device='cuda:3')
benign distance is  tensor(111.8052, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7354679107666016
distance x is tensor(129.7869, device='cuda:3')
benign distance is  tensor(129.7869, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7496824860572815
distance x is tensor(124.1558, device='cuda:3')
benign distance is  tensor(124.1558, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4783892035484314
distance x is tensor(121.6930, device='cuda:3')
benign distance is  tensor(121.6930, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.33081355690956116
distance x is tensor(112.2356, device='cuda:3')
benign distance is  tensor(112.2356, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3575495779514313
distance x is tensor(125.9193, device='cuda:3')
benign distance is  tensor(125.9193, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.20123720169067383
distance x is tensor(112.3425, device='cuda:3')
benign distance is  tensor(112.3425, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6092087030410767
distance x is tensor(120.3042, device='cuda:3')
benign distance is  tensor(120.3042, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3043115437030792
distance x is tensor(118.8004, device='cuda:3')
benign distance is  tensor(118.8004, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9965626001358032
distance x is tensor(125.7156, device='cuda:3')
benign distance is  tensor(125.7156, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6978839635848999
distance x is tensor(115.9103, device='cuda:3')
benign distance is  tensor(115.9103, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.10461108386516571
distance x is tensor(129.4182, device='cuda:3')
benign distance is  tensor(129.4182, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.23956239223480225
distance x is tensor(110.9937, device='cuda:3')
benign distance is  tensor(110.9937, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.314368963241577
distance x is tensor(2057.5183, device='cuda:3')
benign distance is  tensor(2057.5183, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4163277745246887
distance x is tensor(114.3492, device='cuda:3')
benign distance is  tensor(114.3492, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.2412, device='cuda:3')
compute distance is  tensor(118.2412, device='cuda:3')
compute norm is  tensor(63.4225, device='cuda:3', dtype=torch.float64)
distance x is tensor(3894.1382, device='cuda:3')
compute distance is  tensor(3894.1382, device='cuda:3')
compute norm is  tensor(528.1624, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4991, device='cuda:3')
compute distance is  tensor(124.4991, device='cuda:3')
compute norm is  tensor(63.4209, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5938, device='cuda:3')
compute distance is  tensor(124.5938, device='cuda:3')
compute norm is  tensor(63.5107, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7491, device='cuda:3')
compute distance is  tensor(120.7491, device='cuda:3')
compute norm is  tensor(63.5187, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.4906, device='cuda:3')
compute distance is  tensor(135.4906, device='cuda:3')
compute norm is  tensor(63.8606, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.9966, device='cuda:3')
compute distance is  tensor(117.9966, device='cuda:3')
compute norm is  tensor(63.2738, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.9082, device='cuda:3')
compute distance is  tensor(112.9082, device='cuda:3')
compute norm is  tensor(63.3690, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.8939, device='cuda:3')
compute distance is  tensor(115.8939, device='cuda:3')
compute norm is  tensor(63.1896, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.7186, device='cuda:3')
compute distance is  tensor(118.7186, device='cuda:3')
compute norm is  tensor(63.4809, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7716, device='cuda:3')
compute distance is  tensor(127.7716, device='cuda:3')
compute norm is  tensor(63.6649, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.9400, device='cuda:3')
compute distance is  tensor(111.9400, device='cuda:3')
compute norm is  tensor(63.3982, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(3894.1382, device='cuda:3')
distance x is tensor(107457.9375, device='cuda:3')
distance x is tensor(107457.9375, device='cuda:3')
________________________________
test distance is  tensor(107457.9375, device='cuda:3')
test distance1 is  tensor(107457.9375, device='cuda:3')
test similarity is  tensor(0.6477, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130114652267282.02
test entropy is  0.0
________________________________
cal ratio is  0.18655741500154618
distance x is tensor(20047.0820, device='cuda:3')
cal_distance is  tensor(20047.0820, device='cuda:3')
cal ratio is  0.43192284568818584
distance x is tensor(8658.7969, device='cuda:3')
cal_distance is  tensor(8658.7969, device='cuda:3')
cal ratio is  0.6572082000207794
distance x is tensor(5690.6333, device='cuda:3')
cal_distance is  tensor(5690.6333, device='cuda:3')
cal ratio is  0.8106837110353666
distance x is tensor(4613.3047, device='cuda:3')
cal_distance is  tensor(4613.3047, device='cuda:3')
cal ratio is  0.9003796653626689
distance x is tensor(4153.7266, device='cuda:3')
cal_distance is  tensor(4153.7266, device='cuda:3')
cal ratio is  0.9488833027826796
distance x is tensor(3941.4019, device='cuda:3')
cal_distance is  tensor(3941.4019, device='cuda:3')
cal ratio is  0.974106413763427
distance x is tensor(3839.3455, device='cuda:3')
cal_distance is  tensor(3839.3455, device='cuda:3')
distance x is tensor(3839.3455, device='cuda:3')
return_distance is  tensor(3839.3455, device='cuda:3')
distance x is tensor(3839.3352, device='cuda:3')
distance x is tensor(3839.3352, device='cuda:3')
________________________________
test distance is  tensor(3839.3352, device='cuda:3')
test distance1 is  tensor(3839.3352, device='cuda:3')
test similarity is  tensor(0.7236, device='cuda:3')
test acc is  0.10000000015633198
test loss is 211784470.65245202
test entropy is  0.0
________________________________
0
distance x is tensor(3839.3352, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  211674564.96375266
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7236, device='cuda:3')
compute_distance is  tensor(3839.3352, device='cuda:3')
compute_norm is  tensor(324.5320, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1710818.2500, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.560329625220187
avg test loss is  8.184638984930286
avg accuracy is  0.09936666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0042, device='cuda:3')
compute_distance is  tensor(1710818.2500, device='cuda:3')
compute_norm is  tensor(194732.7281, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1702814.5000, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8987609696413662
avg test loss is  8.872486652341733
avg accuracy is  0.10051666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0042, device='cuda:3')
compute_distance is  tensor(1702814.5000, device='cuda:3')
compute_norm is  tensor(193821.8263, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1694848.1250, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5596044491857355
avg test loss is  7.707291446260806
avg accuracy is  0.10038333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0042, device='cuda:3')
compute_distance is  tensor(1694848.1250, device='cuda:3')
compute_norm is  tensor(192914.8158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1686918.8750, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9033312280930436
avg test loss is  7.849821048504762
avg accuracy is  0.10038333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0042, device='cuda:3')
compute_distance is  tensor(1686918.8750, device='cuda:3')
compute_norm is  tensor(192012.3444, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1679026.7500, device='cuda:3')
distance x is tensor(1679026.7500, device='cuda:3')
________________________________
test distance is  tensor(1679026.7500, device='cuda:3')
test distance1 is  tensor(1679026.7500, device='cuda:3')
test similarity is  tensor(0.0042, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.233562620718088
test entropy is  1.5571655082041775
________________________________
cal ratio is  0.04719575695738031
distance x is tensor(79242.9297, device='cuda:3')
cal_distance is  tensor(79242.9297, device='cuda:3')
cal ratio is  0.21724585495318088
distance x is tensor(17215.1953, device='cuda:3')
cal_distance is  tensor(17215.1953, device='cuda:3')
cal ratio is  0.46609643370149545
distance x is tensor(8023.9385, device='cuda:3')
cal_distance is  tensor(8023.9385, device='cuda:3')
cal ratio is  0.6827126617331293
distance x is tensor(5478.0435, device='cuda:3')
cal_distance is  tensor(5478.0435, device='cuda:3')
cal ratio is  0.8262643417089027
distance x is tensor(4526.3105, device='cuda:3')
cal_distance is  tensor(4526.3105, device='cuda:3')
cal ratio is  0.9089910005427171
distance x is tensor(4114.3755, device='cuda:3')
cal_distance is  tensor(4114.3755, device='cuda:3')
cal ratio is  0.9534102010429062
distance x is tensor(3922.6870, device='cuda:3')
cal_distance is  tensor(3922.6870, device='cuda:3')
cal ratio is  0.9764273431129197
distance x is tensor(3830.2188, device='cuda:3')
cal_distance is  tensor(3830.2188, device='cuda:3')
distance x is tensor(3830.2188, device='cuda:3')
return_distance is  tensor(3830.2188, device='cuda:3')
distance x is tensor(3830.2283, device='cuda:3')
distance x is tensor(3830.2283, device='cuda:3')
________________________________
test distance is  tensor(3830.2283, device='cuda:3')
test distance1 is  tensor(3830.2283, device='cuda:3')
test similarity is  tensor(0.1151, device='cuda:3')
test acc is  0.1027833334896653
test loss is 6986.418808666628
test entropy is  0.15924320888103252
________________________________
0
distance x is tensor(3830.2283, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.15909649960908312
avg test loss is  6983.005234447878
avg accuracy is  0.10140000015633198
solo acc is  0.10248333348966532
compute similarity  is  tensor(0.1151, device='cuda:3')
compute_distance is  tensor(3830.2283, device='cuda:3')
compute_norm is  tensor(458.5622, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(inf, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  nan
avg test loss is  nan
avg accuracy is  0.09818333348966535
solo acc is  0.10200000015633198
compute similarity  is  tensor(-0., device='cuda:3')
compute_distance is  tensor(inf, device='cuda:3')
compute_norm is  tensor(1.5054e+21, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(inf, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  nan
avg test loss is  nan
avg accuracy is  0.09633333348966534
solo acc is  0.09920000015633201
compute similarity  is  tensor(-0., device='cuda:3')
compute_distance is  tensor(inf, device='cuda:3')
compute_norm is  tensor(1.4983e+21, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(inf, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  nan
avg test loss is  nan
avg accuracy is  0.09600000015633202
solo acc is  0.10398333348966533
compute similarity  is  tensor(-0., device='cuda:3')
compute_distance is  tensor(inf, device='cuda:3')
compute_norm is  tensor(1.4913e+21, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(inf, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  nan
avg test loss is  nan
avg accuracy is  0.10153333348966533
solo acc is  0.10526666682299865
compute similarity  is  tensor(-0., device='cuda:3')
compute_distance is  tensor(inf, device='cuda:3')
compute_norm is  tensor(1.4844e+21, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(inf, device='cuda:3')
distance x is tensor(inf, device='cuda:3')
________________________________
test distance is  tensor(inf, device='cuda:3')
test distance1 is  tensor(inf, device='cuda:3')
test similarity is  tensor(-0., device='cuda:3')
test acc is  0.10126666682299866
test loss is nan
test entropy is  nan
________________________________
cal ratio is  0.0
distance x is tensor(0.0088, device='cuda:3')
cal_distance is  tensor(0.0088, device='cuda:3')
distance x is tensor(0.0088, device='cuda:3')
return_distance is  tensor(0.0088, device='cuda:3')
distance x is tensor(0.0088, device='cuda:3')
distance x is tensor(0.0088, device='cuda:3')
________________________________
test distance is  tensor(0.0088, device='cuda:3')
test distance1 is  tensor(0.0088, device='cuda:3')
test similarity is  tensor(1., device='cuda:3')
test acc is  0.8578833334896563
test loss is 0.42192401817993824
test entropy is  0.51285918492244
________________________________
2
distance x is tensor(0.0088, device='cuda:3')
test distance 2 is  tensor(0.0088, device='cuda:3')
distance x is tensor(0.0088, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.513075363724979
avg test loss is  0.42196625990590564
avg accuracy is  0.8674000001563225
solo acc is  0.856800000156323
compute similarity  is  tensor(1., device='cuda:3')
compute_distance is  tensor(0.0088, device='cuda:3')
compute_norm is  tensor(61.9212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(18.4304, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9438140984537251
avg test loss is  1.594965314178833
avg accuracy is  0.8530666668229898
solo acc is  0.262483333489672
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(18.4304, device='cuda:3')
compute_norm is  tensor(61.7286, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(22.6004, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8961541293653598
avg test loss is  1.5117674816900224
avg accuracy is  0.8548333334896563
solo acc is  0.2731166668230056
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(22.6004, device='cuda:3')
compute_norm is  tensor(61.4039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(26.4998, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8769170595511698
avg test loss is  1.4740353700702886
avg accuracy is  0.8553333334896563
solo acc is  0.2662166668230054
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(26.4998, device='cuda:3')
compute_norm is  tensor(61.0791, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(30.1892, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8723718004186016
avg test loss is  1.4522483150587915
avg accuracy is  0.855650000156323
solo acc is  0.2607166668230052
compute similarity  is  tensor(0.9990, device='cuda:3')
compute_distance is  tensor(30.1892, device='cuda:3')
compute_norm is  tensor(60.7614, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(33.7637, device='cuda:3')
________________________________
test distance is  tensor(33.7637, device='cuda:3')
test similarity is  tensor(0.9988, device='cuda:3')
test acc is  0.857300000156323
test loss is 1.4301290336702424
test entropy is  0.8614590298265282
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2785577774047852
mal norm is  tensor(166.6395, device='cuda:3')
distance x is tensor(33.7637, device='cuda:3')
mal distance is  tensor(33.7637, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([511.4806, 494.8971, 496.9599, 453.2769, 535.6896, 527.6931, 495.6635,
        512.3297, 166.6395, 166.6395, 166.6395, 166.6395, 166.6395, 166.6395,
        166.6395, 166.6395, 166.6395, 166.6395, 166.6395, 166.6395, 621.1089,
        618.5527, 560.3903, 552.8184, 551.1509, 543.0685, 556.6190, 582.0680],
       device='cuda:3')
sorted_norm is   tensor([166.6395, 166.6395, 166.6395, 166.6395, 166.6395, 166.6395, 166.6395,
        166.6395, 166.6395, 166.6395, 166.6395, 166.6395, 453.2769, 494.8971,
        495.6635, 496.9599, 511.4806, 512.3297, 527.6931, 535.6896, 543.0685,
        551.1509, 552.8184, 556.6190, 560.3903, 582.0680, 618.5527, 621.1089],
       device='cuda:3')
used idx is  tensor([18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11,  3,  1,  6,  2,  0,  7,
         5,  4, 25, 24], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 85.63% 

Test Accuracy: 84.37% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36171481013298035
distance x is tensor(109.1930, device='cuda:3')
benign distance is  tensor(109.1930, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9527303576469421
distance x is tensor(119.5713, device='cuda:3')
benign distance is  tensor(119.5713, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19725914299488068
distance x is tensor(124.2307, device='cuda:3')
benign distance is  tensor(124.2307, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5294531583786011
distance x is tensor(110.3917, device='cuda:3')
benign distance is  tensor(110.3917, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4709067940711975
distance x is tensor(106.2455, device='cuda:3')
benign distance is  tensor(106.2455, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2618628442287445
distance x is tensor(132.4044, device='cuda:3')
benign distance is  tensor(132.4044, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1306430846452713
distance x is tensor(113.1242, device='cuda:3')
benign distance is  tensor(113.1242, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3159139156341553
distance x is tensor(127.6038, device='cuda:3')
benign distance is  tensor(127.6038, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1880786269903183
distance x is tensor(122.9977, device='cuda:3')
benign distance is  tensor(122.9977, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4252508282661438
distance x is tensor(127.4785, device='cuda:3')
benign distance is  tensor(127.4785, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8856350183486938
distance x is tensor(137.0487, device='cuda:3')
benign distance is  tensor(137.0487, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3703129291534424
distance x is tensor(114.4144, device='cuda:3')
benign distance is  tensor(114.4144, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.23671531677246094
distance x is tensor(122.3539, device='cuda:3')
benign distance is  tensor(122.3539, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0986143350601196
distance x is tensor(110.6954, device='cuda:3')
benign distance is  tensor(110.6954, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.14037880301475525
distance x is tensor(126.3043, device='cuda:3')
benign distance is  tensor(126.3043, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3024776875972748
distance x is tensor(128.2926, device='cuda:3')
benign distance is  tensor(128.2926, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(113.1565, device='cuda:3')
compute distance is  tensor(113.1565, device='cuda:3')
compute norm is  tensor(62.8791, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5258, device='cuda:3')
compute distance is  tensor(119.5258, device='cuda:3')
compute norm is  tensor(62.8647, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5877, device='cuda:3')
compute distance is  tensor(137.5877, device='cuda:3')
compute norm is  tensor(63.3283, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2386, device='cuda:3')
compute distance is  tensor(120.2386, device='cuda:3')
compute norm is  tensor(62.9949, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.1420, device='cuda:3')
compute distance is  tensor(127.1420, device='cuda:3')
compute norm is  tensor(63.1379, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9493, device='cuda:3')
compute distance is  tensor(126.9493, device='cuda:3')
compute norm is  tensor(63.1219, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.9969, device='cuda:3')
compute distance is  tensor(110.9969, device='cuda:3')
compute norm is  tensor(62.8561, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.9075, device='cuda:3')
compute distance is  tensor(115.9075, device='cuda:3')
compute norm is  tensor(62.9294, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6706, device='cuda:3')
compute distance is  tensor(134.6706, device='cuda:3')
compute norm is  tensor(63.1913, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2699, device='cuda:3')
compute distance is  tensor(126.2699, device='cuda:3')
compute norm is  tensor(63.2728, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3163, device='cuda:3')
compute distance is  tensor(122.3163, device='cuda:3')
compute norm is  tensor(63.2285, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4330, device='cuda:3')
compute distance is  tensor(121.4330, device='cuda:3')
compute norm is  tensor(62.9894, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.5877, device='cuda:3')
distance x is tensor(107461.2188, device='cuda:3')
distance x is tensor(107461.2188, device='cuda:3')
________________________________
test distance is  tensor(107461.2188, device='cuda:3')
test distance1 is  tensor(107461.2188, device='cuda:3')
test similarity is  tensor(0.6426, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130098859845243.36
test entropy is  0.0
________________________________
cal ratio is  0.03506630604292906
distance x is tensor(3768.2734, device='cuda:3')
cal_distance is  tensor(3768.2734, device='cuda:3')
cal ratio is  0.18725986183792911
distance x is tensor(705.6504, device='cuda:3')
cal_distance is  tensor(705.6504, device='cuda:3')
cal ratio is  0.43273408424545357
distance x is tensor(305.3618, device='cuda:3')
cal_distance is  tensor(305.3618, device='cuda:3')
cal ratio is  0.6578221799360241
distance x is tensor(200.8755, device='cuda:3')
cal_distance is  tensor(200.8755, device='cuda:3')
cal ratio is  0.8110589642561926
distance x is tensor(162.9228, device='cuda:3')
cal_distance is  tensor(162.9228, device='cuda:3')
cal ratio is  0.9005854119171283
distance x is tensor(146.7264, device='cuda:3')
cal_distance is  tensor(146.7264, device='cuda:3')
cal ratio is  0.9489902282669999
distance x is tensor(139.2422, device='cuda:3')
cal_distance is  tensor(139.2422, device='cuda:3')
cal ratio is  0.9741603006604147
distance x is tensor(135.6444, device='cuda:3')
cal_distance is  tensor(135.6444, device='cuda:3')
distance x is tensor(135.6444, device='cuda:3')
return_distance is  tensor(135.6444, device='cuda:3')
distance x is tensor(135.6344, device='cuda:3')
distance x is tensor(135.6344, device='cuda:3')
________________________________
test distance is  tensor(135.6344, device='cuda:3')
test distance1 is  tensor(135.6344, device='cuda:3')
test similarity is  tensor(0.9886, device='cuda:3')
test acc is  0.4137500001563413
test loss is 10.47723696480936
test entropy is  0.15780868735918993
________________________________
0
distance x is tensor(135.6344, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.15773064191979386
avg test loss is  10.314487842100261
avg accuracy is  0.8193666668229912
solo acc is  0.41471666682300795
compute similarity  is  tensor(0.9886, device='cuda:3')
compute_distance is  tensor(135.6344, device='cuda:3')
compute_norm is  tensor(67.2989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.8582, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9040672775906032
avg test loss is  1.3221778898859329
avg accuracy is  0.8095666668229916
solo acc is  0.31473333348967303
compute similarity  is  tensor(0.9886, device='cuda:3')
compute_distance is  tensor(131.8582, device='cuda:3')
compute_norm is  tensor(66.8952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.8674, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.866623706782042
avg test loss is  1.411408106782543
avg accuracy is  0.8090666668229917
solo acc is  0.2572500001563385
compute similarity  is  tensor(0.9885, device='cuda:3')
compute_distance is  tensor(131.8674, device='cuda:3')
compute_norm is  tensor(66.5676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.7495, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8541839824937808
avg test loss is  1.405809803430968
avg accuracy is  0.8161666668229913
solo acc is  0.2508000001563383
compute similarity  is  tensor(0.9884, device='cuda:3')
compute_distance is  tensor(131.7495, device='cuda:3')
compute_norm is  tensor(66.2380, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.6695, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8420665154833276
avg test loss is  1.3892236986139943
avg accuracy is  0.817983333489658
solo acc is  0.24980000015633824
compute similarity  is  tensor(0.9883, device='cuda:3')
compute_distance is  tensor(131.6695, device='cuda:3')
compute_norm is  tensor(65.9116, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.6556, device='cuda:3')
distance x is tensor(131.6556, device='cuda:3')
________________________________
test distance is  tensor(131.6556, device='cuda:3')
test distance1 is  tensor(131.6556, device='cuda:3')
test similarity is  tensor(0.9882, device='cuda:3')
test acc is  0.24080000015633796
test loss is 1.385007312557082
test entropy is  0.839811102477218
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2943880558013916
mal norm is  tensor(634.4697, device='cuda:3')
distance x is tensor(131.6650, device='cuda:3')
mal distance is  tensor(131.6650, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([468.3550, 499.5224, 520.9573, 455.7282, 443.7711, 549.4216, 467.6645,
        527.4802, 634.4697, 634.4697, 634.4697, 634.4697, 634.4697, 634.4697,
        634.4697, 634.4697, 634.4697, 634.4697, 634.4697, 634.4697, 503.9142,
        512.3828, 506.4119, 519.5398, 568.9122, 514.7606, 488.9659, 533.1929],
       device='cuda:3')
sorted_norm is   tensor([443.7711, 455.7282, 467.6645, 468.3550, 488.9659, 499.5224, 503.9142,
        506.4119, 512.3828, 514.7606, 519.5398, 520.9573, 527.4802, 533.1929,
        549.4216, 568.9122, 634.4697, 634.4697, 634.4697, 634.4697, 634.4697,
        634.4697, 634.4697, 634.4697, 634.4697, 634.4697, 634.4697, 634.4697],
       device='cuda:3')
used idx is  tensor([ 4,  3,  6,  0, 26,  1, 20, 22, 21, 25, 23,  2,  7, 27,  5, 24, 19, 17,
        13, 15, 11,  9], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.35% 

Test Accuracy: 87.19% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49911341071128845
distance x is tensor(125.0075, device='cuda:3')
benign distance is  tensor(125.0075, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6691639423370361
distance x is tensor(115.7361, device='cuda:3')
benign distance is  tensor(115.7361, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3112414479255676
distance x is tensor(120.2799, device='cuda:3')
benign distance is  tensor(120.2799, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40830427408218384
distance x is tensor(128.0932, device='cuda:3')
benign distance is  tensor(128.0932, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4501643776893616
distance x is tensor(114.1496, device='cuda:3')
benign distance is  tensor(114.1496, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7510432600975037
distance x is tensor(130.5973, device='cuda:3')
benign distance is  tensor(130.5973, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.439400851726532
distance x is tensor(140.3354, device='cuda:3')
benign distance is  tensor(140.3354, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8592885732650757
distance x is tensor(129.3441, device='cuda:3')
benign distance is  tensor(129.3441, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.27679938077926636
distance x is tensor(131.2503, device='cuda:3')
benign distance is  tensor(131.2503, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7710713744163513
distance x is tensor(120.5521, device='cuda:3')
benign distance is  tensor(120.5521, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6879454255104065
distance x is tensor(111.8170, device='cuda:3')
benign distance is  tensor(111.8170, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7325973510742188
distance x is tensor(124.0967, device='cuda:3')
benign distance is  tensor(124.0967, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48116645216941833
distance x is tensor(116.1492, device='cuda:3')
benign distance is  tensor(116.1492, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.14661887288093567
distance x is tensor(113.6792, device='cuda:3')
benign distance is  tensor(113.6792, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1669249534606934
distance x is tensor(110.1500, device='cuda:3')
benign distance is  tensor(110.1500, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8433898091316223
distance x is tensor(128.8123, device='cuda:3')
benign distance is  tensor(128.8123, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.8640, device='cuda:3')
compute distance is  tensor(121.8640, device='cuda:3')
compute norm is  tensor(64.7726, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0163, device='cuda:3')
compute distance is  tensor(118.0163, device='cuda:3')
compute norm is  tensor(64.4436, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.8149, device='cuda:3')
compute distance is  tensor(121.8149, device='cuda:3')
compute norm is  tensor(64.7502, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4492, device='cuda:3')
compute distance is  tensor(129.4492, device='cuda:3')
compute norm is  tensor(64.9661, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.2775, device='cuda:3')
compute distance is  tensor(139.2775, device='cuda:3')
compute norm is  tensor(65.1308, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4234, device='cuda:3')
compute distance is  tensor(125.4234, device='cuda:3')
compute norm is  tensor(65.0141, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2830, device='cuda:3')
compute distance is  tensor(120.2830, device='cuda:3')
compute norm is  tensor(64.6603, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1678, device='cuda:3')
compute distance is  tensor(115.1678, device='cuda:3')
compute norm is  tensor(64.6089, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4435, device='cuda:3')
compute distance is  tensor(121.4435, device='cuda:3')
compute norm is  tensor(64.5164, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.4347, device='cuda:3')
compute distance is  tensor(117.4347, device='cuda:3')
compute norm is  tensor(64.8033, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3509, device='cuda:3')
compute distance is  tensor(131.3509, device='cuda:3')
compute norm is  tensor(64.9587, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4303, device='cuda:3')
compute distance is  tensor(122.4303, device='cuda:3')
compute norm is  tensor(64.7774, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.2775, device='cuda:3')
distance x is tensor(107434.4688, device='cuda:3')
distance x is tensor(107434.4688, device='cuda:3')
________________________________
test distance is  tensor(107434.4688, device='cuda:3')
test distance1 is  tensor(107434.4688, device='cuda:3')
test similarity is  tensor(0.6666, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130071738295092.95
test entropy is  0.0
________________________________
cal ratio is  0.035285369237465794
distance x is tensor(3790.8701, device='cuda:3')
cal_distance is  tensor(3790.8701, device='cuda:3')
cal ratio is  0.18784386884212464
distance x is tensor(712.0959, device='cuda:3')
cal_distance is  tensor(712.0959, device='cuda:3')
cal ratio is  0.4334083125677147
distance x is tensor(308.6311, device='cuda:3')
cal_distance is  tensor(308.6311, device='cuda:3')
cal ratio is  0.6583345337134496
distance x is tensor(203.1842, device='cuda:3')
cal_distance is  tensor(203.1842, device='cuda:3')
cal ratio is  0.8113747116767724
distance x is tensor(164.8595, device='cuda:3')
cal_distance is  tensor(164.8595, device='cuda:3')
cal ratio is  0.9007608299091348
distance x is tensor(148.4995, device='cuda:3')
cal_distance is  tensor(148.4995, device='cuda:3')
cal ratio is  0.9490826058040113
distance x is tensor(140.9386, device='cuda:3')
cal_distance is  tensor(140.9386, device='cuda:3')
cal ratio is  0.9742077503944679
distance x is tensor(137.3036, device='cuda:3')
cal_distance is  tensor(137.3036, device='cuda:3')
distance x is tensor(137.3036, device='cuda:3')
return_distance is  tensor(137.3036, device='cuda:3')
distance x is tensor(137.2936, device='cuda:3')
distance x is tensor(137.2936, device='cuda:3')
________________________________
test distance is  tensor(137.2936, device='cuda:3')
test distance1 is  tensor(137.2936, device='cuda:3')
test similarity is  tensor(0.9898, device='cuda:3')
test acc is  0.35573333348967384
test loss is 19.80375340244155
test entropy is  0.08283618613799561
________________________________
0
distance x is tensor(137.2936, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.08302105689492784
avg test loss is  19.947969960251342
avg accuracy is  0.8302333334896574
solo acc is  0.35141666682300704
compute similarity  is  tensor(0.9898, device='cuda:3')
compute_distance is  tensor(137.2936, device='cuda:3')
compute_norm is  tensor(69.3212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.5721, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9098691068478485
avg test loss is  1.3427035882274734
avg accuracy is  0.834700000156324
solo acc is  0.3198833334896733
compute similarity  is  tensor(0.9898, device='cuda:3')
compute_distance is  tensor(135.5721, device='cuda:3')
compute_norm is  tensor(68.9837, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.4263, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8640606512011749
avg test loss is  1.4434071020530994
avg accuracy is  0.8338666668229906
solo acc is  0.24980000015633827
compute similarity  is  tensor(0.9896, device='cuda:3')
compute_distance is  tensor(135.4263, device='cuda:3')
compute_norm is  tensor(68.6436, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.0360, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8553149802471275
avg test loss is  1.411516226939301
avg accuracy is  0.8381666668229903
solo acc is  0.25186666682300496
compute similarity  is  tensor(0.9895, device='cuda:3')
compute_distance is  tensor(135.0360, device='cuda:3')
compute_norm is  tensor(68.3040, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.7419, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8475746901304737
avg test loss is  1.4019483100376657
avg accuracy is  0.8428166668229903
solo acc is  0.24831666682300488
compute similarity  is  tensor(0.9894, device='cuda:3')
compute_distance is  tensor(134.7419, device='cuda:3')
compute_norm is  tensor(67.9689, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.4634, device='cuda:3')
distance x is tensor(134.4634, device='cuda:3')
________________________________
test distance is  tensor(134.4634, device='cuda:3')
test distance1 is  tensor(134.4634, device='cuda:3')
test similarity is  tensor(0.9893, device='cuda:3')
test acc is  0.24921666682300486
test loss is 1.3848288458293434
test entropy is  0.8402135977739973
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.207294225692749
mal norm is  tensor(640.9965, device='cuda:3')
distance x is tensor(134.4728, device='cuda:3')
mal distance is  tensor(134.4728, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([518.8665, 489.1001, 503.6928, 526.3396, 479.6447, 533.9424, 564.7712,
        537.6843, 640.9965, 640.9965, 640.9965, 640.9965, 640.9965, 640.9965,
        640.9965, 640.9965, 640.9965, 640.9965, 640.9965, 640.9965],
       device='cuda:3')
sorted_norm is   tensor([479.6447, 489.1001, 503.6928, 518.8665, 526.3396, 533.9424, 537.6843,
        564.7712, 640.9965, 640.9965, 640.9965, 640.9965, 640.9965, 640.9965,
        640.9965, 640.9965, 640.9965, 640.9965, 640.9965, 640.9965],
       device='cuda:3')
used idx is  tensor([ 4,  1,  2,  0,  3,  5,  7,  6, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 86.59% 

Test Accuracy: 85.40% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.27029937505722046
distance x is tensor(151.2836, device='cuda:3')
benign distance is  tensor(151.2836, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7750422358512878
distance x is tensor(138.5951, device='cuda:3')
benign distance is  tensor(138.5951, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20310774445533752
distance x is tensor(133.5070, device='cuda:3')
benign distance is  tensor(133.5070, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3290800452232361
distance x is tensor(128.3010, device='cuda:3')
benign distance is  tensor(128.3010, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31647366285324097
distance x is tensor(112.6739, device='cuda:3')
benign distance is  tensor(112.6739, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8740461468696594
distance x is tensor(122.1222, device='cuda:3')
benign distance is  tensor(122.1222, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5909614562988281
distance x is tensor(126.5220, device='cuda:3')
benign distance is  tensor(126.5220, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5664333701133728
distance x is tensor(136.7963, device='cuda:3')
benign distance is  tensor(136.7963, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(130.2393, device='cuda:3')
compute distance is  tensor(130.2393, device='cuda:3')
compute norm is  tensor(67.3534, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5468, device='cuda:3')
compute distance is  tensor(128.5468, device='cuda:3')
compute norm is  tensor(67.2072, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.6174, device='cuda:3')
compute distance is  tensor(145.6174, device='cuda:3')
compute norm is  tensor(67.7085, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.7831, device='cuda:3')
compute distance is  tensor(123.7831, device='cuda:3')
compute norm is  tensor(67.4206, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9700, device='cuda:3')
compute distance is  tensor(138.9700, device='cuda:3')
compute norm is  tensor(67.7756, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0770, device='cuda:3')
compute distance is  tensor(137.0770, device='cuda:3')
compute norm is  tensor(67.6542, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1413, device='cuda:3')
compute distance is  tensor(131.1413, device='cuda:3')
compute norm is  tensor(67.5139, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0316, device='cuda:3')
compute distance is  tensor(133.0316, device='cuda:3')
compute norm is  tensor(67.5495, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2691, device='cuda:3')
compute distance is  tensor(135.2691, device='cuda:3')
compute norm is  tensor(67.5050, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7179, device='cuda:3')
compute distance is  tensor(136.7179, device='cuda:3')
compute norm is  tensor(67.7145, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1244, device='cuda:3')
compute distance is  tensor(138.1244, device='cuda:3')
compute norm is  tensor(67.6359, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4706, device='cuda:3')
compute distance is  tensor(131.4706, device='cuda:3')
compute norm is  tensor(67.4660, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.6174, device='cuda:3')
distance x is tensor(107384.8281, device='cuda:3')
distance x is tensor(107384.8281, device='cuda:3')
________________________________
test distance is  tensor(107384.8281, device='cuda:3')
test distance1 is  tensor(107384.8281, device='cuda:3')
test similarity is  tensor(0.7107, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130162831781232.98
test entropy is  0.0
________________________________
cal ratio is  0.03608786663688548
distance x is tensor(3875.2947, device='cuda:3')
cal_distance is  tensor(3875.2947, device='cuda:3')
cal ratio is  0.18996793461471045
distance x is tensor(736.1857, device='cuda:3')
cal_distance is  tensor(736.1857, device='cuda:3')
cal ratio is  0.43585192560317787
distance x is tensor(320.8708, device='cuda:3')
cal_distance is  tensor(320.8708, device='cuda:3')
cal ratio is  0.6601878976763823
distance x is tensor(211.8367, device='cuda:3')
cal_distance is  tensor(211.8367, device='cuda:3')
cal ratio is  0.8125162551867755
distance x is tensor(172.1217, device='cuda:3')
cal_distance is  tensor(172.1217, device='cuda:3')
cal ratio is  0.9013943382530155
distance x is tensor(155.1501, device='cuda:3')
cal_distance is  tensor(155.1501, device='cuda:3')
cal ratio is  0.9494163024285784
distance x is tensor(147.3023, device='cuda:3')
cal_distance is  tensor(147.3023, device='cuda:3')
cal ratio is  0.9743791084251873
distance x is tensor(143.5284, device='cuda:3')
cal_distance is  tensor(143.5284, device='cuda:3')
distance x is tensor(143.5284, device='cuda:3')
return_distance is  tensor(143.5284, device='cuda:3')
distance x is tensor(143.5184, device='cuda:3')
distance x is tensor(143.5184, device='cuda:3')
________________________________
test distance is  tensor(143.5184, device='cuda:3')
test distance1 is  tensor(143.5184, device='cuda:3')
test similarity is  tensor(0.9913, device='cuda:3')
test acc is  0.12218333348966526
test loss is 46.17932611233644
test entropy is  0.019813872142231338
________________________________
0
distance x is tensor(143.5184, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.019545925271918597
avg test loss is  46.19600488178766
avg accuracy is  0.7036166668229972
solo acc is  0.12163333348966525
compute similarity  is  tensor(0.9913, device='cuda:3')
compute_distance is  tensor(143.5184, device='cuda:3')
compute_norm is  tensor(72.5463, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.7134, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9018305212831192
avg test loss is  1.3506969443516437
avg accuracy is  0.7925166668229925
solo acc is  0.29905000015633953
compute similarity  is  tensor(0.9916, device='cuda:3')
compute_distance is  tensor(139.7134, device='cuda:3')
compute_norm is  tensor(72.3482, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(139.7134, device='cuda:3')
distance x is tensor(139.7134, device='cuda:3')
________________________________
test distance is  tensor(139.7134, device='cuda:3')
test distance1 is  tensor(139.7134, device='cuda:3')
test similarity is  tensor(0.9916, device='cuda:3')
test acc is  0.29860000015633953
test loss is 1.347214169212496
test entropy is  0.9021735195157878
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.116871953010559
mal norm is  tensor(710.7215, device='cuda:3')
distance x is tensor(139.7231, device='cuda:3')
mal distance is  tensor(139.7231, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([615.1178, 559.1590, 524.7322, 529.8140, 458.6469, 494.7704, 508.9158,
        554.5350, 710.7216, 710.7216, 710.7216, 710.7216, 710.7216, 710.7216,
        710.7216, 710.7216, 710.7216, 710.7216, 710.7216, 710.7216, 703.1010,
        706.0177, 690.3410, 665.9144, 705.7090, 684.7464, 730.3815, 722.4059,
        696.8605, 659.9862, 713.1111, 697.7805, 699.2827, 667.6575, 704.8281,
        665.2005, 719.0078, 734.4113, 759.3261, 693.7851, 713.6459, 678.6405,
        725.3554, 718.7975, 640.0469, 608.9512, 573.1859, 605.5848, 600.5800,
        594.1628, 582.1702, 646.4900], device='cuda:3')
sorted_norm is   tensor([458.6469, 494.7704, 508.9158, 524.7322, 529.8140, 554.5350, 559.1590,
        573.1859, 582.1702, 594.1628, 600.5800, 605.5848, 608.9512, 615.1178,
        640.0469, 646.4900, 659.9862, 665.2005, 665.9144, 667.6575, 678.6405,
        684.7464, 690.3410, 693.7851, 696.8605, 697.7805, 699.2827, 703.1010,
        704.8281, 705.7090, 706.0177, 710.7216, 710.7216, 710.7216, 710.7216,
        710.7216, 710.7216, 710.7216, 710.7216, 710.7216, 710.7216, 710.7216,
        710.7216, 713.1111, 713.6459, 718.7975, 719.0078, 722.4059, 725.3554,
        730.3815, 734.4113, 759.3261], device='cuda:3')
used idx is  tensor([ 4,  5,  6,  2,  3,  7,  1, 46, 50, 49, 48, 47, 45,  0, 44, 51, 29, 35,
        23, 33, 41, 25, 22, 39, 28, 31, 32, 20, 34, 24, 21, 10, 11, 18, 16, 17,
        19, 13,  8,  9, 14], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.05% 

Test Accuracy: 86.82% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5142068266868591
distance x is tensor(121.6479, device='cuda:3')
benign distance is  tensor(121.6479, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.28278157114982605
distance x is tensor(122.9710, device='cuda:3')
benign distance is  tensor(122.9710, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2018882781267166
distance x is tensor(119.5033, device='cuda:3')
benign distance is  tensor(119.5033, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0843960046768188
distance x is tensor(112.8433, device='cuda:3')
benign distance is  tensor(112.8433, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6278725266456604
distance x is tensor(114.0778, device='cuda:3')
benign distance is  tensor(114.0778, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6639286279678345
distance x is tensor(132.3046, device='cuda:3')
benign distance is  tensor(132.3046, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27828696370124817
distance x is tensor(131.8910, device='cuda:3')
benign distance is  tensor(131.8910, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.818818211555481
distance x is tensor(143.1562, device='cuda:3')
benign distance is  tensor(143.1562, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.37192586064338684
distance x is tensor(118.7936, device='cuda:3')
benign distance is  tensor(118.7936, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5755569338798523
distance x is tensor(123.3452, device='cuda:3')
benign distance is  tensor(123.3452, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.475506454706192
distance x is tensor(129.8307, device='cuda:3')
benign distance is  tensor(129.8307, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0185447931289673
distance x is tensor(128.0699, device='cuda:3')
benign distance is  tensor(128.0699, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.404898077249527
distance x is tensor(125.1572, device='cuda:3')
benign distance is  tensor(125.1572, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7805765867233276
distance x is tensor(119.5919, device='cuda:3')
benign distance is  tensor(119.5919, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4665793478488922
distance x is tensor(118.8919, device='cuda:3')
benign distance is  tensor(118.8919, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.26786357164382935
distance x is tensor(131.5148, device='cuda:3')
benign distance is  tensor(131.5148, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5206180810928345
distance x is tensor(119.0782, device='cuda:3')
benign distance is  tensor(119.0782, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8115313649177551
distance x is tensor(130.3341, device='cuda:3')
benign distance is  tensor(130.3341, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.320095956325531
distance x is tensor(134.5855, device='cuda:3')
benign distance is  tensor(134.5855, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5764310956001282
distance x is tensor(139.5493, device='cuda:3')
benign distance is  tensor(139.5493, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2521568536758423
distance x is tensor(129.6056, device='cuda:3')
benign distance is  tensor(129.6056, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2823283672332764
distance x is tensor(120.8420, device='cuda:3')
benign distance is  tensor(120.8420, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2648314833641052
distance x is tensor(121.8797, device='cuda:3')
benign distance is  tensor(121.8797, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.29534709453582764
distance x is tensor(123.2007, device='cuda:3')
benign distance is  tensor(123.2007, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6358590722084045
distance x is tensor(128.7976, device='cuda:3')
benign distance is  tensor(128.7976, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5351186990737915
distance x is tensor(114.1752, device='cuda:3')
benign distance is  tensor(114.1752, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2159196138381958
distance x is tensor(128.3233, device='cuda:3')
benign distance is  tensor(128.3233, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.9361078143119812
distance x is tensor(131.4385, device='cuda:3')
benign distance is  tensor(131.4385, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.908618152141571
distance x is tensor(128.1632, device='cuda:3')
benign distance is  tensor(128.1632, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.13847649097442627
distance x is tensor(129.5022, device='cuda:3')
benign distance is  tensor(129.5022, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3143795430660248
distance x is tensor(122.3075, device='cuda:3')
benign distance is  tensor(122.3075, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.20367446541786194
distance x is tensor(116.6886, device='cuda:3')
benign distance is  tensor(116.6886, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.291605144739151
distance x is tensor(123.4704, device='cuda:3')
benign distance is  tensor(123.4704, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4394921660423279
distance x is tensor(133.5705, device='cuda:3')
benign distance is  tensor(133.5705, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.36980098485946655
distance x is tensor(120.2124, device='cuda:3')
benign distance is  tensor(120.2124, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2346850335597992
distance x is tensor(120.0967, device='cuda:3')
benign distance is  tensor(120.0967, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.49482980370521545
distance x is tensor(123.2569, device='cuda:3')
benign distance is  tensor(123.2569, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8547735214233398
distance x is tensor(149.6119, device='cuda:3')
benign distance is  tensor(149.6119, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.28658461570739746
distance x is tensor(138.6871, device='cuda:3')
benign distance is  tensor(138.6871, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5042418241500854
distance x is tensor(129.9400, device='cuda:3')
benign distance is  tensor(129.9400, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(114.4341, device='cuda:3')
compute distance is  tensor(114.4341, device='cuda:3')
compute norm is  tensor(67.1904, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.3520, device='cuda:3')
compute distance is  tensor(120.3520, device='cuda:3')
compute norm is  tensor(67.2506, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9367, device='cuda:3')
compute distance is  tensor(125.9367, device='cuda:3')
compute norm is  tensor(67.3527, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.4456, device='cuda:3')
compute distance is  tensor(116.4456, device='cuda:3')
compute norm is  tensor(67.1412, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8485, device='cuda:3')
compute distance is  tensor(128.8485, device='cuda:3')
compute norm is  tensor(67.6583, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4335, device='cuda:3')
compute distance is  tensor(125.4335, device='cuda:3')
compute norm is  tensor(67.4943, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9075, device='cuda:3')
compute distance is  tensor(124.9075, device='cuda:3')
compute norm is  tensor(67.3503, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2782, device='cuda:3')
compute distance is  tensor(125.2782, device='cuda:3')
compute norm is  tensor(67.5161, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5327, device='cuda:3')
compute distance is  tensor(129.5327, device='cuda:3')
compute norm is  tensor(67.2989, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2346, device='cuda:3')
compute distance is  tensor(125.2346, device='cuda:3')
compute norm is  tensor(67.4698, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3895, device='cuda:3')
compute distance is  tensor(131.3895, device='cuda:3')
compute norm is  tensor(67.4723, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9342, device='cuda:3')
compute distance is  tensor(120.9342, device='cuda:3')
compute norm is  tensor(67.3872, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(131.3895, device='cuda:3')
distance x is tensor(107399.5312, device='cuda:3')
distance x is tensor(107399.5312, device='cuda:3')
________________________________
test distance is  tensor(107399.5312, device='cuda:3')
test distance1 is  tensor(107399.5312, device='cuda:3')
test similarity is  tensor(0.6978, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130139421090123.88
test entropy is  0.0
________________________________
cal ratio is  0.034277184991387384
distance x is tensor(3681.3594, device='cuda:3')
cal_distance is  tensor(3681.3594, device='cuda:3')
cal ratio is  0.18514084485910448
distance x is tensor(681.5740, device='cuda:3')
cal_distance is  tensor(681.5740, device='cuda:3')
cal ratio is  0.43027870162535026
distance x is tensor(293.2696, device='cuda:3')
cal_distance is  tensor(293.2696, device='cuda:3')
cal ratio is  0.6559531214263735
distance x is tensor(192.3729, device='cuda:3')
cal_distance is  tensor(192.3729, device='cuda:3')
cal ratio is  0.8099056836247797
distance x is tensor(155.8049, device='cuda:3')
cal_distance is  tensor(155.8049, device='cuda:3')
cal ratio is  0.8999447188618699
distance x is tensor(140.2163, device='cuda:3')
cal_distance is  tensor(140.2163, device='cuda:3')
cal ratio is  0.9486524896683833
distance x is tensor(133.0167, device='cuda:3')
cal_distance is  tensor(133.0167, device='cuda:3')
cal ratio is  0.9739870821675841
distance x is tensor(129.5567, device='cuda:3')
cal_distance is  tensor(129.5567, device='cuda:3')
distance x is tensor(129.5567, device='cuda:3')
return_distance is  tensor(129.5567, device='cuda:3')
distance x is tensor(129.5468, device='cuda:3')
distance x is tensor(129.5468, device='cuda:3')
________________________________
test distance is  tensor(129.5468, device='cuda:3')
test distance1 is  tensor(129.5468, device='cuda:3')
test similarity is  tensor(0.9923, device='cuda:3')
test acc is  0.6787833334896652
test loss is 3.7411728605532697
test entropy is  0.17465508757814416
________________________________
0
distance x is tensor(129.5468, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.17496931445655792
avg test loss is  3.646475673675029
avg accuracy is  0.8610500001563228
solo acc is  0.6807666668229985
compute similarity  is  tensor(0.9923, device='cuda:3')
compute_distance is  tensor(129.5468, device='cuda:3')
compute_norm is  tensor(71.8065, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(129.2825, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9041445185380704
avg test loss is  1.322616365545594
avg accuracy is  0.832050000156324
solo acc is  0.3236333334896733
compute similarity  is  tensor(0.9921, device='cuda:3')
compute_distance is  tensor(129.2825, device='cuda:3')
compute_norm is  tensor(71.3389, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.0001, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8571769264079868
avg test loss is  1.4096603368136928
avg accuracy is  0.8365666668229905
solo acc is  0.26405000015633867
compute similarity  is  tensor(0.9920, device='cuda:3')
compute_distance is  tensor(129.0001, device='cuda:3')
compute_norm is  tensor(70.9888, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.5087, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.851936503704677
avg test loss is  1.3946341821379753
avg accuracy is  0.8384000001563237
solo acc is  0.2592333334896718
compute similarity  is  tensor(0.9919, device='cuda:3')
compute_distance is  tensor(128.5087, device='cuda:3')
compute_norm is  tensor(70.6393, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.0705, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.848259004512067
avg test loss is  1.3814068197695686
avg accuracy is  0.841733333489657
solo acc is  0.2574333334896718
compute similarity  is  tensor(0.9918, device='cuda:3')
compute_distance is  tensor(128.0705, device='cuda:3')
compute_norm is  tensor(70.2931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.7110, device='cuda:3')
distance x is tensor(127.7110, device='cuda:3')
________________________________
test distance is  tensor(127.7110, device='cuda:3')
test distance1 is  tensor(127.7110, device='cuda:3')
test similarity is  tensor(0.9917, device='cuda:3')
test acc is  0.2512333334896716
test loss is 1.3724745613679703
test entropy is  0.842890394077118
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2809197902679443
mal norm is  tensor(602.9785, device='cuda:3')
distance x is tensor(127.7201, device='cuda:3')
mal distance is  tensor(127.7201, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 511.0566,  502.7653,  495.6539,  467.6681,  469.2177,  550.5712,
         535.4394,  565.1796,  602.9785,  602.9785,  602.9785,  602.9785,
         602.9785,  602.9785,  602.9785,  602.9785,  602.9785,  602.9785,
         602.9785,  602.9785,  641.7028,  642.3307,  662.1109,  628.4722,
         670.8107,  610.3293, 9225.9248,  618.5048], device='cuda:3')
sorted_norm is   tensor([ 467.6681,  469.2177,  495.6539,  502.7653,  511.0566,  535.4394,
         550.5712,  565.1796,  602.9785,  602.9785,  602.9785,  602.9785,
         602.9785,  602.9785,  602.9785,  602.9785,  602.9785,  602.9785,
         602.9785,  602.9785,  610.3293,  618.5048,  628.4722,  641.7028,
         642.3307,  662.1109,  670.8107, 9225.9248], device='cuda:3')
used idx is  tensor([ 3,  4,  2,  1,  0,  6,  5,  7, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 25, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 86.57% 

Test Accuracy: 85.12% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5369415283203125
distance x is tensor(122.3663, device='cuda:3')
benign distance is  tensor(122.3663, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3460085988044739
distance x is tensor(138.8706, device='cuda:3')
benign distance is  tensor(138.8706, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.34108081459999084
distance x is tensor(142.1911, device='cuda:3')
benign distance is  tensor(142.1911, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5973888635635376
distance x is tensor(134.7510, device='cuda:3')
benign distance is  tensor(134.7510, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4097880423069
distance x is tensor(128.9445, device='cuda:3')
benign distance is  tensor(128.9445, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2987017035484314
distance x is tensor(149.3672, device='cuda:3')
benign distance is  tensor(149.3672, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3480313718318939
distance x is tensor(128.6523, device='cuda:3')
benign distance is  tensor(128.6523, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8999055624008179
distance x is tensor(151.0675, device='cuda:3')
benign distance is  tensor(151.0675, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7751034498214722
distance x is tensor(131.7999, device='cuda:3')
benign distance is  tensor(131.7999, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.260920912027359
distance x is tensor(148.6084, device='cuda:3')
benign distance is  tensor(148.6084, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6988280415534973
distance x is tensor(129.7409, device='cuda:3')
benign distance is  tensor(129.7409, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.15621647238731384
distance x is tensor(123.2636, device='cuda:3')
benign distance is  tensor(123.2636, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7646293640136719
distance x is tensor(129.8297, device='cuda:3')
benign distance is  tensor(129.8297, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.16003549098968506
distance x is tensor(123.8679, device='cuda:3')
benign distance is  tensor(123.8679, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9519592523574829
distance x is tensor(130.9769, device='cuda:3')
benign distance is  tensor(130.9769, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5933540463447571
distance x is tensor(128.8841, device='cuda:3')
benign distance is  tensor(128.8841, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.6626, device='cuda:3')
compute distance is  tensor(121.6626, device='cuda:3')
compute norm is  tensor(69.6027, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.2782, device='cuda:3')
compute distance is  tensor(145.2782, device='cuda:3')
compute norm is  tensor(70.0122, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.6125, device='cuda:3')
compute distance is  tensor(147.6125, device='cuda:3')
compute norm is  tensor(69.9413, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.2889, device='cuda:3')
compute distance is  tensor(154.2889, device='cuda:3')
compute norm is  tensor(70.0780, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7976, device='cuda:3')
compute distance is  tensor(140.7976, device='cuda:3')
compute norm is  tensor(70.0841, device='cuda:3', dtype=torch.float64)
distance x is tensor(2023.0182, device='cuda:3')
compute distance is  tensor(2023.0182, device='cuda:3')
compute norm is  tensor(325.4011, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5127, device='cuda:3')
compute distance is  tensor(127.5127, device='cuda:3')
compute norm is  tensor(69.7499, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0252, device='cuda:3')
compute distance is  tensor(135.0252, device='cuda:3')
compute norm is  tensor(69.7682, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2765, device='cuda:3')
compute distance is  tensor(144.2765, device='cuda:3')
compute norm is  tensor(69.8026, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4082, device='cuda:3')
compute distance is  tensor(128.4082, device='cuda:3')
compute norm is  tensor(69.6816, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.4397, device='cuda:3')
compute distance is  tensor(134.4397, device='cuda:3')
compute norm is  tensor(69.7769, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6008, device='cuda:3')
compute distance is  tensor(129.6008, device='cuda:3')
compute norm is  tensor(69.8733, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(2023.0182, device='cuda:3')
distance x is tensor(107350.2578, device='cuda:3')
distance x is tensor(107350.2578, device='cuda:3')
________________________________
test distance is  tensor(107350.2578, device='cuda:3')
test distance1 is  tensor(107350.2578, device='cuda:3')
test similarity is  tensor(0.7360, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129989423675029.56
test entropy is  0.0
________________________________
cal ratio is  0.1345316343961047
distance x is tensor(14442.0117, device='cuda:3')
cal_distance is  tensor(14442.0117, device='cuda:3')
cal ratio is  0.3667854650345758
distance x is tensor(5297.1230, device='cuda:3')
cal_distance is  tensor(5297.1230, device='cuda:3')
cal ratio is  0.6056279986733445
distance x is tensor(3208.0884, device='cuda:3')
cal_distance is  tensor(3208.0884, device='cuda:3')
cal ratio is  0.7782207460747396
distance x is tensor(2496.6021, device='cuda:3')
cal_distance is  tensor(2496.6021, device='cuda:3')
cal ratio is  0.8821680187353956
distance x is tensor(2202.4229, device='cuda:3')
cal_distance is  tensor(2202.4229, device='cuda:3')
cal ratio is  0.9392379238904819
distance x is tensor(2068.5996, device='cuda:3')
cal_distance is  tensor(2068.5996, device='cuda:3')
cal ratio is  0.9691427349173701
distance x is tensor(2004.7684, device='cuda:3')
cal_distance is  tensor(2004.7684, device='cuda:3')
distance x is tensor(2004.7684, device='cuda:3')
return_distance is  tensor(2004.7684, device='cuda:3')
distance x is tensor(2004.7584, device='cuda:3')
distance x is tensor(2004.7584, device='cuda:3')
________________________________
test distance is  tensor(2004.7584, device='cuda:3')
test distance1 is  tensor(2004.7584, device='cuda:3')
test similarity is  tensor(0.8460, device='cuda:3')
test acc is  0.10000000015633198
test loss is 18680585.885927506
test entropy is  0.0
________________________________
0
distance x is tensor(2004.7584, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  18661853.291044775
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8460, device='cuda:3')
compute_distance is  tensor(2004.7584, device='cuda:3')
compute_norm is  tensor(197.9540, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(297963.3438, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5442629757720525
avg test loss is  2.904937670429124
avg accuracy is  0.09806666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0069, device='cuda:3')
compute_distance is  tensor(297963.3438, device='cuda:3')
compute_norm is  tensor(32904.4698, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(296570.6875, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8721596101707996
avg test loss is  3.604202658128637
avg accuracy is  0.09993333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0069, device='cuda:3')
compute_distance is  tensor(296570.6875, device='cuda:3')
compute_norm is  tensor(32750.6190, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(295184.3125, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5611011739224514
avg test loss is  2.8630744938148873
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0069, device='cuda:3')
compute_distance is  tensor(295184.3125, device='cuda:3')
compute_norm is  tensor(32597.2646, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(293804.7188, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8824902915242893
avg test loss is  3.565488150887398
avg accuracy is  0.10103333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0069, device='cuda:3')
compute_distance is  tensor(293804.7188, device='cuda:3')
compute_norm is  tensor(32444.8984, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(292431.1875, device='cuda:3')
distance x is tensor(292431.1875, device='cuda:3')
________________________________
test distance is  tensor(292431.1875, device='cuda:3')
test distance1 is  tensor(292431.1875, device='cuda:3')
test similarity is  tensor(-0.0069, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8576718057904924
test entropy is  1.5609397870391162
________________________________
cal ratio is  0.08151060563043724
distance x is tensor(23836.2383, device='cuda:3')
cal_distance is  tensor(23836.2383, device='cuda:3')
cal ratio is  0.28550065688063514
distance x is tensor(6805.2578, device='cuda:3')
cal_distance is  tensor(6805.2578, device='cuda:3')
cal ratio is  0.5343227742535142
distance x is tensor(3636.2024, device='cuda:3')
cal_distance is  tensor(3636.2024, device='cuda:3')
cal ratio is  0.7309740455986515
distance x is tensor(2657.9678, device='cuda:3')
cal_distance is  tensor(2657.9678, device='cuda:3')
cal ratio is  0.8549704769820788
distance x is tensor(2272.4834, device='cuda:3')
cal_distance is  tensor(2272.4834, device='cuda:3')
cal ratio is  0.9246462309389069
distance x is tensor(2101.2427, device='cuda:3')
cal_distance is  tensor(2101.2427, device='cuda:3')
cal ratio is  0.9615853935395062
distance x is tensor(2020.5244, device='cuda:3')
cal_distance is  tensor(2020.5244, device='cuda:3')
distance x is tensor(2020.5244, device='cuda:3')
return_distance is  tensor(2020.5244, device='cuda:3')
distance x is tensor(2020.5343, device='cuda:3')
distance x is tensor(2020.5343, device='cuda:3')
________________________________
test distance is  tensor(2020.5343, device='cuda:3')
test distance1 is  tensor(2020.5343, device='cuda:3')
test similarity is  tensor(0.2366, device='cuda:3')
test acc is  0.10043333348966532
test loss is 174651.42744702825
test entropy is  0.060495562995479604
________________________________
0
distance x is tensor(2020.5343, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.060207564466781154
avg test loss is  175001.85862123535
avg accuracy is  0.10053333348966531
solo acc is  0.10041666682299864
compute similarity  is  tensor(0.2366, device='cuda:3')
compute_distance is  tensor(2020.5343, device='cuda:3')
compute_norm is  tensor(261.2449, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(187314.8125, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.55098079770867
avg test loss is  2.886392193308263
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1160, device='cuda:3')
compute_distance is  tensor(187314.8125, device='cuda:3')
compute_norm is  tensor(10323.0853, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(186439.4688, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8346284570089028
avg test loss is  3.640505648116821
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1160, device='cuda:3')
compute_distance is  tensor(186439.4688, device='cuda:3')
compute_norm is  tensor(10274.9272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(185568.2500, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5558517253729327
avg test loss is  2.866109933680309
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1160, device='cuda:3')
compute_distance is  tensor(185568.2500, device='cuda:3')
compute_norm is  tensor(10226.6794, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(184701.0625, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8346813490141684
avg test loss is  3.626032597474706
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.1160, device='cuda:3')
compute_distance is  tensor(184701.0625, device='cuda:3')
compute_norm is  tensor(10178.9838, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183837.9375, device='cuda:3')
distance x is tensor(183837.9375, device='cuda:3')
________________________________
test distance is  tensor(183837.9375, device='cuda:3')
test distance1 is  tensor(183837.9375, device='cuda:3')
test similarity is  tensor(-0.1160, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8633024262975275
test entropy is  1.5576057836953512
________________________________
cal ratio is  0.10280361931065651
distance x is tensor(18899.2051, device='cuda:3')
cal_distance is  tensor(18899.2051, device='cuda:3')
cal ratio is  0.320630029677004
distance x is tensor(6059.6509, device='cuda:3')
cal_distance is  tensor(6059.6509, device='cuda:3')
cal ratio is  0.5662421191848147
distance x is tensor(3431.2288, device='cuda:3')
cal_distance is  tensor(3431.2288, device='cuda:3')
cal ratio is  0.7524906966277486
distance x is tensor(2581.9666, device='cuda:3')
cal_distance is  tensor(2581.9666, device='cuda:3')
cal ratio is  0.8674624178355825
distance x is tensor(2239.7588, device='cuda:3')
cal_distance is  tensor(2239.7588, device='cuda:3')
cal ratio is  0.931376640503201
distance x is tensor(2086.0588, device='cuda:3')
cal_distance is  tensor(2086.0588, device='cuda:3')
cal ratio is  0.9650786179181753
distance x is tensor(2013.2107, device='cuda:3')
cal_distance is  tensor(2013.2107, device='cuda:3')
distance x is tensor(2013.2107, device='cuda:3')
return_distance is  tensor(2013.2107, device='cuda:3')
distance x is tensor(2013.2158, device='cuda:3')
distance x is tensor(2013.2158, device='cuda:3')
________________________________
test distance is  tensor(2013.2158, device='cuda:3')
test distance1 is  tensor(2013.2158, device='cuda:3')
test similarity is  tensor(0.3630, device='cuda:3')
test acc is  0.09991666682299866
test loss is 2.8431554369326593
test entropy is  1.741693897287983
________________________________
0
distance x is tensor(2013.2158, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7418454839730821
avg test loss is  2.8429354960476156
avg accuracy is  0.10023333348966532
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.3630, device='cuda:3')
compute_distance is  tensor(2013.2158, device='cuda:3')
compute_norm is  tensor(146.2838, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2005.8905, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8167292717169089
avg test loss is  3.6783311687298674
avg accuracy is  0.10015000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3632, device='cuda:3')
compute_distance is  tensor(2005.8905, device='cuda:3')
compute_norm is  tensor(145.7797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1997.7256, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5520010285540176
avg test loss is  2.8769274256122648
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3629, device='cuda:3')
compute_distance is  tensor(1997.7256, device='cuda:3')
compute_norm is  tensor(144.8112, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1990.1927, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8359689142531169
avg test loss is  3.630267679310048
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3630, device='cuda:3')
compute_distance is  tensor(1990.1927, device='cuda:3')
compute_norm is  tensor(144.3525, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1982.1290, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5517645539251217
avg test loss is  2.872337683685807
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3628, device='cuda:3')
compute_distance is  tensor(1982.1290, device='cuda:3')
compute_norm is  tensor(143.4151, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1974.7000, device='cuda:3')
________________________________
test distance is  tensor(1974.7000, device='cuda:3')
test similarity is  tensor(0.3630, device='cuda:3')
test acc is  0.10013333348966531
test loss is 3.625659193565596
test entropy is  0.8363987808542719
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5358033180236816
mal norm is  tensor(6834.5542, device='cuda:3')
distance x is tensor(1974.7000, device='cuda:3')
mal distance is  tensor(1974.7000, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 499.9378,  555.9020,  559.5253,  523.7395,  521.8271,  580.7600,
         508.0827,  590.7859, 6834.5542, 6834.5547, 6834.5542, 6834.5547,
        6834.5542, 6834.5547, 6834.5542, 6834.5547, 6834.5542, 6834.5547,
        6834.5542, 6834.5547,  590.7611,  605.8174,  626.5591,  614.6445,
         612.8926,  584.4594,  592.5047,  626.7632], device='cuda:3')
sorted_norm is   tensor([ 499.9378,  508.0827,  521.8271,  523.7395,  555.9020,  559.5253,
         580.7600,  584.4594,  590.7611,  590.7859,  592.5047,  605.8174,
         612.8926,  614.6445,  626.5591,  626.7632, 6834.5542, 6834.5542,
        6834.5542, 6834.5542, 6834.5542, 6834.5542, 6834.5547, 6834.5547,
        6834.5547, 6834.5547, 6834.5547, 6834.5547], device='cuda:3')
used idx is  tensor([ 0,  6,  4,  3,  1,  2,  5, 25, 20,  7, 26, 21, 24, 23, 22, 27, 18, 16,
        12, 14, 10,  8], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 8.88% 

Test Accuracy: 8.93% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.352693796157837
distance x is tensor(36.4877, device='cuda:3')
benign distance is  tensor(36.4877, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3160040378570557
distance x is tensor(47.0172, device='cuda:3')
benign distance is  tensor(47.0172, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.343217134475708
distance x is tensor(32.5922, device='cuda:3')
benign distance is  tensor(32.5922, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3490500450134277
distance x is tensor(26.3936, device='cuda:3')
benign distance is  tensor(26.3936, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3289027214050293
distance x is tensor(23.2838, device='cuda:3')
benign distance is  tensor(23.2838, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3288838863372803
distance x is tensor(29.8921, device='cuda:3')
benign distance is  tensor(29.8921, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.351320743560791
distance x is tensor(29.0966, device='cuda:3')
benign distance is  tensor(29.0966, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3043084144592285
distance x is tensor(37.8314, device='cuda:3')
benign distance is  tensor(37.8314, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3050646781921387
distance x is tensor(31.2153, device='cuda:3')
benign distance is  tensor(31.2153, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.2964119911193848
distance x is tensor(29.9378, device='cuda:3')
benign distance is  tensor(29.9378, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.259136915206909
distance x is tensor(37.6620, device='cuda:3')
benign distance is  tensor(37.6620, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3072803020477295
distance x is tensor(38.8511, device='cuda:3')
benign distance is  tensor(38.8511, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.3491692543029785
distance x is tensor(41.8906, device='cuda:3')
benign distance is  tensor(41.8906, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.38851261138916
distance x is tensor(53.1715, device='cuda:3')
benign distance is  tensor(53.1715, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2777323722839355
distance x is tensor(37.3289, device='cuda:3')
benign distance is  tensor(37.3289, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.257793426513672
distance x is tensor(30.1710, device='cuda:3')
benign distance is  tensor(30.1710, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(26.8742, device='cuda:3')
compute distance is  tensor(26.8742, device='cuda:3')
compute norm is  tensor(77.8282, device='cuda:3', dtype=torch.float64)
distance x is tensor(28.0051, device='cuda:3')
compute distance is  tensor(28.0051, device='cuda:3')
compute norm is  tensor(77.8493, device='cuda:3', dtype=torch.float64)
distance x is tensor(44.3367, device='cuda:3')
compute distance is  tensor(44.3367, device='cuda:3')
compute norm is  tensor(78.8113, device='cuda:3', dtype=torch.float64)
distance x is tensor(37.2422, device='cuda:3')
compute distance is  tensor(37.2422, device='cuda:3')
compute norm is  tensor(78.2305, device='cuda:3', dtype=torch.float64)
distance x is tensor(39.9551, device='cuda:3')
compute distance is  tensor(39.9551, device='cuda:3')
compute norm is  tensor(78.3377, device='cuda:3', dtype=torch.float64)
distance x is tensor(38.0051, device='cuda:3')
compute distance is  tensor(38.0051, device='cuda:3')
compute norm is  tensor(78.1605, device='cuda:3', dtype=torch.float64)
distance x is tensor(43.2859, device='cuda:3')
compute distance is  tensor(43.2859, device='cuda:3')
compute norm is  tensor(78.6884, device='cuda:3', dtype=torch.float64)
distance x is tensor(40.3982, device='cuda:3')
compute distance is  tensor(40.3982, device='cuda:3')
compute norm is  tensor(78.1248, device='cuda:3', dtype=torch.float64)
distance x is tensor(43.2004, device='cuda:3')
compute distance is  tensor(43.2004, device='cuda:3')
compute norm is  tensor(78.5110, device='cuda:3', dtype=torch.float64)
distance x is tensor(69.3976, device='cuda:3')
compute distance is  tensor(69.3976, device='cuda:3')
compute norm is  tensor(78.9881, device='cuda:3', dtype=torch.float64)
distance x is tensor(68.3556, device='cuda:3')
compute distance is  tensor(68.3556, device='cuda:3')
compute norm is  tensor(79.3901, device='cuda:3', dtype=torch.float64)
distance x is tensor(35.5789, device='cuda:3')
compute distance is  tensor(35.5789, device='cuda:3')
compute norm is  tensor(77.9698, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(69.3976, device='cuda:3')
distance x is tensor(107542.1328, device='cuda:3')
distance x is tensor(107542.1328, device='cuda:3')
________________________________
test distance is  tensor(107542.1328, device='cuda:3')
test distance1 is  tensor(107542.1328, device='cuda:3')
test similarity is  tensor(0.5490, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130195678636831.11
test entropy is  0.0
________________________________
cal ratio is  0.02489482012208057
distance x is tensor(2677.2476, device='cuda:3')
cal_distance is  tensor(2677.2476, device='cuda:3')
cal ratio is  0.15778076581281902
distance x is tensor(422.4223, device='cuda:3')
cal_distance is  tensor(422.4223, device='cuda:3')
cal ratio is  0.3972143042319128
distance x is tensor(167.7952, device='cuda:3')
cal_distance is  tensor(167.7952, device='cuda:3')
cal ratio is  0.6302437269775512
distance x is tensor(105.7538, device='cuda:3')
cal_distance is  tensor(105.7538, device='cuda:3')
cal ratio is  0.7938718796069423
distance x is tensor(83.9560, device='cuda:3')
cal_distance is  tensor(83.9560, device='cuda:3')
cal ratio is  0.8909892834854862
distance x is tensor(74.8044, device='cuda:3')
cal_distance is  tensor(74.8044, device='cuda:3')
cal ratio is  0.94391876840081
distance x is tensor(70.6096, device='cuda:3')
cal_distance is  tensor(70.6096, device='cuda:3')
cal ratio is  0.9715529179951768
distance x is tensor(68.6011, device='cuda:3')
cal_distance is  tensor(68.6011, device='cuda:3')
distance x is tensor(68.6011, device='cuda:3')
return_distance is  tensor(68.6011, device='cuda:3')
distance x is tensor(68.5912, device='cuda:3')
distance x is tensor(68.5912, device='cuda:3')
________________________________
test distance is  tensor(68.5912, device='cuda:3')
test distance1 is  tensor(68.5912, device='cuda:3')
test similarity is  tensor(0.9972, device='cuda:3')
test acc is  0.07133333348966543
test loss is 7.462072229080363
test entropy is  1.2572301520721745
________________________________
0
distance x is tensor(68.5912, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2565894348026594
avg test loss is  7.465296629395312
avg accuracy is  0.054800000156332206
solo acc is  0.07131666682299875
compute similarity  is  tensor(0.9972, device='cuda:3')
compute_distance is  tensor(68.5912, device='cuda:3')
compute_norm is  tensor(80.9278, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(70.4123, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8238686718412046
avg test loss is  3.6714528966814215
avg accuracy is  0.1023833334896653
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9971, device='cuda:3')
compute_distance is  tensor(70.4123, device='cuda:3')
compute_norm is  tensor(80.7444, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(70.1857, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.548885045783606
avg test loss is  2.882011876685787
avg accuracy is  0.10215000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9971, device='cuda:3')
compute_distance is  tensor(70.1857, device='cuda:3')
compute_norm is  tensor(80.0964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(71.3582, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8327066452899722
avg test loss is  3.6395484137890945
avg accuracy is  0.1017333334896653
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9970, device='cuda:3')
compute_distance is  tensor(71.3582, device='cuda:3')
compute_norm is  tensor(79.9262, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(72.0659, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5525341680817513
avg test loss is  2.8748606379860755
avg accuracy is  0.10190000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9971, device='cuda:3')
compute_distance is  tensor(72.0659, device='cuda:3')
compute_norm is  tensor(79.2967, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(73.7026, device='cuda:3')
distance x is tensor(73.7026, device='cuda:3')
________________________________
test distance is  tensor(73.7026, device='cuda:3')
test distance1 is  tensor(73.7026, device='cuda:3')
test similarity is  tensor(0.9970, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.6284803978161517
test entropy is  0.8363708578574378
________________________________
cal ratio is  0.9509481372545437
distance x is tensor(70.0974, device='cuda:3')
cal_distance is  tensor(70.0974, device='cuda:3')
cal ratio is  0.9750958826284845
distance x is tensor(68.3518, device='cuda:3')
cal_distance is  tensor(68.3518, device='cuda:3')
distance x is tensor(68.3518, device='cuda:3')
return_distance is  tensor(68.3518, device='cuda:3')
distance x is tensor(68.3415, device='cuda:3')
distance x is tensor(68.3415, device='cuda:3')
________________________________
test distance is  tensor(68.3415, device='cuda:3')
test distance1 is  tensor(68.3415, device='cuda:3')
test similarity is  tensor(0.9974, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.538612198219625
test entropy is  0.9034126678636587
________________________________
0
distance x is tensor(68.3415, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9047358564095203
avg test loss is  3.5381434268788743
avg accuracy is  0.10211666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9974, device='cuda:3')
compute_distance is  tensor(68.3415, device='cuda:3')
compute_norm is  tensor(79.0955, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(69.4790, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5518883180770793
avg test loss is  2.87190510240445
avg accuracy is  0.10205000015633196
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9974, device='cuda:3')
compute_distance is  tensor(69.4790, device='cuda:3')
compute_norm is  tensor(78.4932, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(71.3617, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8381240196319532
avg test loss is  3.6243461812737148
avg accuracy is  0.10170000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9973, device='cuda:3')
compute_distance is  tensor(71.3617, device='cuda:3')
compute_norm is  tensor(78.3590, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(72.6635, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5545115639914329
avg test loss is  2.8676761266773445
avg accuracy is  0.10220000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9974, device='cuda:3')
compute_distance is  tensor(72.6635, device='cuda:3')
compute_norm is  tensor(77.7321, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(74.7018, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8414066057723723
avg test loss is  3.614381305444469
avg accuracy is  0.10176666682299863
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9973, device='cuda:3')
compute_distance is  tensor(74.7018, device='cuda:3')
compute_norm is  tensor(77.6164, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(76.2222, device='cuda:3')
distance x is tensor(76.2222, device='cuda:3')
________________________________
test distance is  tensor(76.2222, device='cuda:3')
test distance1 is  tensor(76.2222, device='cuda:3')
test similarity is  tensor(0.9973, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.862891115867761
test entropy is  1.5576745187804135
________________________________
cal ratio is  0.9350991784242789
distance x is tensor(71.2847, device='cuda:3')
cal_distance is  tensor(71.2847, device='cuda:3')
cal ratio is  0.9669412607471592
distance x is tensor(68.9283, device='cuda:3')
cal_distance is  tensor(68.9283, device='cuda:3')
distance x is tensor(68.9283, device='cuda:3')
return_distance is  tensor(68.9283, device='cuda:3')
distance x is tensor(68.9185, device='cuda:3')
distance x is tensor(68.9185, device='cuda:3')
________________________________
test distance is  tensor(68.9185, device='cuda:3')
test distance1 is  tensor(68.9185, device='cuda:3')
test similarity is  tensor(0.9978, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.844149873963297
test entropy is  1.5832595808673768
________________________________
0
distance x is tensor(68.9185, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5831832265548869
avg test loss is  2.845197851215598
avg accuracy is  0.10196666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9978, device='cuda:3')
compute_distance is  tensor(68.9185, device='cuda:3')
compute_norm is  tensor(77.1279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(71.2014, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8401499601569511
avg test loss is  3.6141350208315006
avg accuracy is  0.10206666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(71.2014, device='cuda:3')
compute_norm is  tensor(77.0262, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(72.9610, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.556320737674038
avg test loss is  2.8648941229655542
avg accuracy is  0.1022333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9978, device='cuda:3')
compute_distance is  tensor(72.9610, device='cuda:3')
compute_norm is  tensor(76.3973, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(75.3507, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8426337172863072
avg test loss is  3.606997709284459
avg accuracy is  0.10191666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9976, device='cuda:3')
compute_distance is  tensor(75.3507, device='cuda:3')
compute_norm is  tensor(76.3044, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(77.2735, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5578832073506517
avg test loss is  2.8601620431139527
avg accuracy is  0.10225000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(77.2735, device='cuda:3')
compute_norm is  tensor(75.6771, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(79.8108, device='cuda:3')
________________________________
test distance is  tensor(79.8108, device='cuda:3')
test similarity is  tensor(0.9976, device='cuda:3')
test acc is  0.1018333334896653
test loss is 3.604625031129638
test entropy is  0.8436170060878624
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5614380836486816
mal norm is  tensor(269.0298, device='cuda:3')
distance x is tensor(79.8108, device='cuda:3')
mal distance is  tensor(79.8108, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 400.2412,  709.5643,  448.8455,  296.6561,  255.3335,  325.0463,
         348.1598,  411.7656,  269.0298,  269.0298,  269.0298,  269.0298,
         269.0298,  269.0298,  269.0298,  269.0298,  269.0298,  269.0298,
         269.0298,  269.0298, 1896.0594, 1914.3208, 1912.7120, 1917.3159,
        1912.4392, 1899.5934, 1900.8802, 1905.7489], device='cuda:3')
sorted_norm is   tensor([ 255.3335,  269.0298,  269.0298,  269.0298,  269.0298,  269.0298,
         269.0298,  269.0298,  269.0298,  269.0298,  269.0298,  269.0298,
         269.0298,  296.6561,  325.0463,  348.1598,  400.2412,  411.7656,
         448.8455,  709.5643, 1896.0594, 1899.5934, 1900.8802, 1905.7489,
        1912.4392, 1912.7120, 1914.3208, 1917.3159], device='cuda:3')
used idx is  tensor([ 4, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  3,  5,  6,  0,  7,
         2,  1, 20, 25], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3131155967712402
distance x is tensor(4.8341, device='cuda:3')
benign distance is  tensor(4.8341, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3381645679473877
distance x is tensor(4.7712, device='cuda:3')
benign distance is  tensor(4.7712, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3937997817993164
distance x is tensor(3.6295, device='cuda:3')
benign distance is  tensor(3.6295, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3298633098602295
distance x is tensor(8.6117, device='cuda:3')
benign distance is  tensor(8.6117, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.406126022338867
distance x is tensor(5.9599, device='cuda:3')
benign distance is  tensor(5.9599, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.271209239959717
distance x is tensor(6.6636, device='cuda:3')
benign distance is  tensor(6.6636, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3104944229125977
distance x is tensor(4.2480, device='cuda:3')
benign distance is  tensor(4.2480, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2803659439086914
distance x is tensor(7.4155, device='cuda:3')
benign distance is  tensor(7.4155, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.360358715057373
distance x is tensor(30.4386, device='cuda:3')
benign distance is  tensor(30.4386, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2879574298858643
distance x is tensor(5.8953, device='cuda:3')
benign distance is  tensor(5.8953, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2955124378204346
distance x is tensor(13.6159, device='cuda:3')
benign distance is  tensor(13.6159, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.270843505859375
distance x is tensor(12.9459, device='cuda:3')
benign distance is  tensor(12.9459, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.331169605255127
distance x is tensor(3.8936, device='cuda:3')
benign distance is  tensor(3.8936, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.297839641571045
distance x is tensor(4.3521, device='cuda:3')
benign distance is  tensor(4.3521, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.2758851051330566
distance x is tensor(4.3307, device='cuda:3')
benign distance is  tensor(4.3307, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.349287986755371
distance x is tensor(8.9231, device='cuda:3')
benign distance is  tensor(8.9231, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(6.5586, device='cuda:3')
compute distance is  tensor(6.5586, device='cuda:3')
compute norm is  tensor(74.0874, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.3103, device='cuda:3')
compute distance is  tensor(4.3103, device='cuda:3')
compute norm is  tensor(74.0498, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.4677, device='cuda:3')
compute distance is  tensor(4.4677, device='cuda:3')
compute norm is  tensor(74.0949, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.3362, device='cuda:3')
compute distance is  tensor(3.3362, device='cuda:3')
compute norm is  tensor(74.0364, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.5317, device='cuda:3')
compute distance is  tensor(4.5317, device='cuda:3')
compute norm is  tensor(74.0706, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.1561, device='cuda:3')
compute distance is  tensor(5.1561, device='cuda:3')
compute norm is  tensor(74.1241, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.4254, device='cuda:3')
compute distance is  tensor(8.4254, device='cuda:3')
compute norm is  tensor(74.0789, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.4970, device='cuda:3')
compute distance is  tensor(3.4970, device='cuda:3')
compute norm is  tensor(74.1268, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.7821, device='cuda:3')
compute distance is  tensor(5.7821, device='cuda:3')
compute norm is  tensor(74.0349, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.3963, device='cuda:3')
compute distance is  tensor(5.3963, device='cuda:3')
compute norm is  tensor(74.0623, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.3702, device='cuda:3')
compute distance is  tensor(5.3702, device='cuda:3')
compute norm is  tensor(74.0973, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.7188, device='cuda:3')
compute distance is  tensor(8.7188, device='cuda:3')
compute norm is  tensor(74.1178, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(8.7188, device='cuda:3')
distance x is tensor(107501.9219, device='cuda:3')
distance x is tensor(107501.9219, device='cuda:3')
________________________________
test distance is  tensor(107501.9219, device='cuda:3')
test distance1 is  tensor(107501.9219, device='cuda:3')
test similarity is  tensor(0.5936, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130097719531140.1
test entropy is  0.0
________________________________
cal ratio is  0.008825656889509688
distance x is tensor(948.7801, device='cuda:3')
cal_distance is  tensor(948.7801, device='cuda:3')
cal ratio is  0.0939447207977473
distance x is tensor(89.1375, device='cuda:3')
cal_distance is  tensor(89.1375, device='cuda:3')
cal ratio is  0.3064961567086638
distance x is tensor(27.3239, device='cuda:3')
cal_distance is  tensor(27.3239, device='cuda:3')
cal ratio is  0.5535840788773586
distance x is tensor(15.1286, device='cuda:3')
cal_distance is  tensor(15.1286, device='cuda:3')
cal ratio is  0.7439711580761884
distance x is tensor(11.2567, device='cuda:3')
cal_distance is  tensor(11.2567, device='cuda:3')
cal ratio is  0.8624801784393866
distance x is tensor(9.7095, device='cuda:3')
cal_distance is  tensor(9.7095, device='cuda:3')
cal ratio is  0.9286584492352593
distance x is tensor(9.0173, device='cuda:3')
cal_distance is  tensor(9.0173, device='cuda:3')
cal ratio is  0.9636458219385866
distance x is tensor(8.6897, device='cuda:3')
cal_distance is  tensor(8.6897, device='cuda:3')
distance x is tensor(8.6897, device='cuda:3')
return_distance is  tensor(8.6897, device='cuda:3')
distance x is tensor(8.6798, device='cuda:3')
distance x is tensor(8.6798, device='cuda:3')
________________________________
test distance is  tensor(8.6798, device='cuda:3')
test distance1 is  tensor(8.6798, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.5893842683417967
test entropy is  1.9187304223778405
________________________________
0
distance x is tensor(8.6798, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9185181262650723
avg test loss is  2.586689714683907
avg accuracy is  0.10026666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(8.6798, device='cuda:3')
compute_norm is  tensor(74.9246, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10.7624, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8584796675105593
avg test loss is  3.5896196929630695
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(10.7624, device='cuda:3')
compute_norm is  tensor(74.9586, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11.7908, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5615205594471522
avg test loss is  2.855656088796506
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(11.7908, device='cuda:3')
compute_norm is  tensor(74.3474, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.0423, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.848327489295748
avg test loss is  3.599554710550857
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(15.0423, device='cuda:3')
compute_norm is  tensor(74.2775, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.6068, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.559023636744729
avg test loss is  2.85878486165614
avg accuracy is  0.10021666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(17.6068, device='cuda:3')
compute_norm is  tensor(73.6594, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.9395, device='cuda:3')
distance x is tensor(21.9395, device='cuda:3')
________________________________
test distance is  tensor(21.9395, device='cuda:3')
test distance1 is  tensor(21.9395, device='cuda:3')
test similarity is  tensor(0.9997, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5957667443798043
test entropy is  0.850197938078248
________________________________
cal ratio is  0.6177918410139411
distance x is tensor(13.5562, device='cuda:3')
cal_distance is  tensor(13.5562, device='cuda:3')
cal ratio is  0.7859333628399601
distance x is tensor(10.6546, device='cuda:3')
cal_distance is  tensor(10.6546, device='cuda:3')
cal ratio is  0.8865165779905647
distance x is tensor(9.4456, device='cuda:3')
cal_distance is  tensor(9.4456, device='cuda:3')
cal ratio is  0.9415422686692682
distance x is tensor(8.8935, device='cuda:3')
cal_distance is  tensor(8.8935, device='cuda:3')
cal ratio is  0.9703265994240825
distance x is tensor(8.6297, device='cuda:3')
cal_distance is  tensor(8.6297, device='cuda:3')
distance x is tensor(8.6297, device='cuda:3')
return_distance is  tensor(8.6297, device='cuda:3')
distance x is tensor(8.6269, device='cuda:3')
distance x is tensor(8.6269, device='cuda:3')
________________________________
test distance is  tensor(8.6269, device='cuda:3')
test distance1 is  tensor(8.6269, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.883520298675179
test entropy is  1.5309046956776047
________________________________
0
distance x is tensor(8.6269, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5322774201313825
avg test loss is  2.882028275461339
avg accuracy is  0.10016666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(8.6269, device='cuda:3')
compute_norm is  tensor(74.2005, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.2482, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8455169587247153
avg test loss is  3.6057623624801636
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(13.2482, device='cuda:3')
compute_norm is  tensor(74.1179, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16.5063, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5593572609714355
avg test loss is  2.8578326178512086
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16.5063, device='cuda:3')
compute_norm is  tensor(73.5012, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.2017, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8469199723780536
avg test loss is  3.5985536826953197
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(21.2017, device='cuda:3')
compute_norm is  tensor(73.4402, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(24.5473, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5592648583942894
avg test loss is  2.8569927629885643
avg accuracy is  0.10020000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(24.5473, device='cuda:3')
compute_norm is  tensor(72.8234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.1867, device='cuda:3')
distance x is tensor(29.1867, device='cuda:3')
________________________________
test distance is  tensor(29.1867, device='cuda:3')
test distance1 is  tensor(29.1867, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5983607817306194
test entropy is  0.8469610220587838
________________________________
cal ratio is  0.5356271760867414
distance x is tensor(15.6332, device='cuda:3')
cal_distance is  tensor(15.6332, device='cuda:3')
cal ratio is  0.7318644629712696
distance x is tensor(11.4414, device='cuda:3')
cal_distance is  tensor(11.4414, device='cuda:3')
cal ratio is  0.8554904230725492
distance x is tensor(9.7880, device='cuda:3')
cal_distance is  tensor(9.7880, device='cuda:3')
cal ratio is  0.9249269474927011
distance x is tensor(9.0532, device='cuda:3')
cal_distance is  tensor(9.0532, device='cuda:3')
cal ratio is  0.9617310850342471
distance x is tensor(8.7068, device='cuda:3')
cal_distance is  tensor(8.7068, device='cuda:3')
distance x is tensor(8.7068, device='cuda:3')
return_distance is  tensor(8.7068, device='cuda:3')
distance x is tensor(8.7067, device='cuda:3')
distance x is tensor(8.7067, device='cuda:3')
________________________________
test distance is  tensor(8.7067, device='cuda:3')
test distance1 is  tensor(8.7067, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.79916228134749
test entropy is  1.634311544488488
________________________________
0
distance x is tensor(8.7067, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6342803091128497
avg test loss is  2.7993017099559436
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(8.7067, device='cuda:3')
compute_norm is  tensor(74.0528, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.6116, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8494047378299079
avg test loss is  3.5991466256347038
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(13.6116, device='cuda:3')
compute_norm is  tensor(74.0036, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16.9652, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5593161862542126
avg test loss is  2.858131247288637
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(16.9652, device='cuda:3')
compute_norm is  tensor(73.3898, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.7115, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8479137052732236
avg test loss is  3.5998117006155472
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(21.7115, device='cuda:3')
compute_norm is  tensor(73.3284, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(25.0920, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5575588424322702
avg test loss is  2.8582091153557623
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(25.0920, device='cuda:3')
compute_norm is  tensor(72.7123, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.7528, device='cuda:3')
________________________________
test distance is  tensor(29.7528, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10023333348966532
test loss is 3.5956312148555765
test entropy is  0.8489479862931949
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.554966449737549
mal norm is  tensor(136.2075, device='cuda:3')
distance x is tensor(29.7528, device='cuda:3')
mal distance is  tensor(29.7528, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 136.2187,  129.2582,  129.6355,  135.9815,  135.4330,  145.0774,
         134.2575,  136.9560,  136.2075,  136.2074,  136.2075,  136.2074,
         136.2075,  136.2074,  136.2075,  136.2074,  136.2075,  136.2074,
         136.2075,  136.2074, 1690.7576, 1678.3619, 1688.1351, 1687.5151,
        1683.3018, 1687.9131, 1679.5745, 1679.6086,  388.8019,  350.3027,
         408.1738,  391.8976,  513.0418,  567.9216,  424.4261,  371.7401],
       device='cuda:3')
sorted_norm is   tensor([ 129.2582,  129.6355,  134.2575,  135.4330,  135.9815,  136.2074,
         136.2074,  136.2074,  136.2074,  136.2074,  136.2074,  136.2075,
         136.2075,  136.2075,  136.2075,  136.2075,  136.2075,  136.2187,
         136.9560,  145.0774,  350.3027,  371.7401,  388.8019,  391.8976,
         408.1738,  424.4261,  513.0418,  567.9216, 1678.3619, 1679.5745,
        1679.6086, 1683.3018, 1687.5151, 1687.9131, 1688.1351, 1690.7576],
       device='cuda:3')
used idx is  tensor([ 1,  2,  6,  4,  3, 15, 17, 19, 11, 13,  9,  8, 18, 12, 10, 16, 14,  0,
         7,  5, 29, 35, 28, 31, 30, 34, 32, 33], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3361077308654785
distance x is tensor(2.2910, device='cuda:3')
benign distance is  tensor(2.2910, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.295905590057373
distance x is tensor(3.1702, device='cuda:3')
benign distance is  tensor(3.1702, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.325939893722534
distance x is tensor(7.1534, device='cuda:3')
benign distance is  tensor(7.1534, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2866711616516113
distance x is tensor(7.4447, device='cuda:3')
benign distance is  tensor(7.4447, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.343196392059326
distance x is tensor(3.9295, device='cuda:3')
benign distance is  tensor(3.9295, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2608718872070312
distance x is tensor(5.0617, device='cuda:3')
benign distance is  tensor(5.0617, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.268578290939331
distance x is tensor(2.2926, device='cuda:3')
benign distance is  tensor(2.2926, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3332817554473877
distance x is tensor(5.9316, device='cuda:3')
benign distance is  tensor(5.9316, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3460428714752197
distance x is tensor(2.6020, device='cuda:3')
benign distance is  tensor(2.6020, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3109359741210938
distance x is tensor(3.2974, device='cuda:3')
benign distance is  tensor(3.2974, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.258716583251953
distance x is tensor(10.3111, device='cuda:3')
benign distance is  tensor(10.3111, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.296365976333618
distance x is tensor(2.4035, device='cuda:3')
benign distance is  tensor(2.4035, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.353147029876709
distance x is tensor(2.1765, device='cuda:3')
benign distance is  tensor(2.1765, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.3047311305999756
distance x is tensor(3.3357, device='cuda:3')
benign distance is  tensor(3.3357, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.323883295059204
distance x is tensor(7.9521, device='cuda:3')
benign distance is  tensor(7.9521, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2909090518951416
distance x is tensor(2.9853, device='cuda:3')
benign distance is  tensor(2.9853, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.362905502319336
distance x is tensor(11.9704, device='cuda:3')
benign distance is  tensor(11.9704, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.277538537979126
distance x is tensor(3.1564, device='cuda:3')
benign distance is  tensor(3.1564, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.313826322555542
distance x is tensor(12.1140, device='cuda:3')
benign distance is  tensor(12.1140, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.326075553894043
distance x is tensor(3.0573, device='cuda:3')
benign distance is  tensor(3.0573, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.3006532192230225
distance x is tensor(16.0823, device='cuda:3')
benign distance is  tensor(16.0823, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.275850772857666
distance x is tensor(6.3583, device='cuda:3')
benign distance is  tensor(6.3583, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.3183035850524902
distance x is tensor(10.2201, device='cuda:3')
benign distance is  tensor(10.2201, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.3228325843811035
distance x is tensor(2.1280, device='cuda:3')
benign distance is  tensor(2.1280, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(3.1984, device='cuda:3')
compute distance is  tensor(3.1984, device='cuda:3')
compute norm is  tensor(73.9605, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.1806, device='cuda:3')
compute distance is  tensor(3.1806, device='cuda:3')
compute norm is  tensor(74.0253, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2135, device='cuda:3')
compute distance is  tensor(2.2135, device='cuda:3')
compute norm is  tensor(73.9597, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4663, device='cuda:3')
compute distance is  tensor(2.4663, device='cuda:3')
compute norm is  tensor(73.9714, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.5950, device='cuda:3')
compute distance is  tensor(3.5950, device='cuda:3')
compute norm is  tensor(73.9682, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.6977, device='cuda:3')
compute distance is  tensor(3.6977, device='cuda:3')
compute norm is  tensor(74.0227, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5818, device='cuda:3')
compute distance is  tensor(2.5818, device='cuda:3')
compute norm is  tensor(73.9894, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3249, device='cuda:3')
compute distance is  tensor(2.3249, device='cuda:3')
compute norm is  tensor(74.0300, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.3086, device='cuda:3')
compute distance is  tensor(3.3086, device='cuda:3')
compute norm is  tensor(74.0033, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.4592, device='cuda:3')
compute distance is  tensor(6.4592, device='cuda:3')
compute norm is  tensor(74.0561, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.1930, device='cuda:3')
compute distance is  tensor(5.1930, device='cuda:3')
compute norm is  tensor(73.9918, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4471, device='cuda:3')
compute distance is  tensor(2.4471, device='cuda:3')
compute norm is  tensor(73.9042, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(6.4592, device='cuda:3')
distance x is tensor(107514.5781, device='cuda:3')
distance x is tensor(107514.5781, device='cuda:3')
________________________________
test distance is  tensor(107514.5781, device='cuda:3')
test distance1 is  tensor(107514.5781, device='cuda:3')
test similarity is  tensor(0.5806, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130086432238751.39
test entropy is  0.0
________________________________
cal ratio is  0.007595953053072306
distance x is tensor(816.6805, device='cuda:3')
cal_distance is  tensor(816.6805, device='cuda:3')
cal ratio is  0.08715450747265534
distance x is tensor(71.1820, device='cuda:3')
cal_distance is  tensor(71.1820, device='cuda:3')
cal ratio is  0.29520980833190313
distance x is tensor(21.0174, device='cuda:3')
cal_distance is  tensor(21.0174, device='cuda:3')
cal ratio is  0.5432835583093343
distance x is tensor(11.4210, device='cuda:3')
cal_distance is  tensor(11.4210, device='cuda:3')
cal ratio is  0.7369929046069329
distance x is tensor(8.4188, device='cuda:3')
cal_distance is  tensor(8.4188, device='cuda:3')
cal ratio is  0.8584009492006325
distance x is tensor(7.2276, device='cuda:3')
cal_distance is  tensor(7.2276, device='cuda:3')
cal ratio is  0.926441717808751
distance x is tensor(6.6965, device='cuda:3')
cal_distance is  tensor(6.6965, device='cuda:3')
cal ratio is  0.9624842215025
distance x is tensor(6.4455, device='cuda:3')
cal_distance is  tensor(6.4455, device='cuda:3')
distance x is tensor(6.4455, device='cuda:3')
return_distance is  tensor(6.4455, device='cuda:3')
distance x is tensor(6.4355, device='cuda:3')
distance x is tensor(6.4355, device='cuda:3')
________________________________
test distance is  tensor(6.4355, device='cuda:3')
test distance1 is  tensor(6.4355, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.4104849156031984
test entropy is  2.165391881328656
________________________________
0
distance x is tensor(6.4355, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.16505260584451
avg test loss is  2.410535316477452
avg accuracy is  0.10013333348966531
solo acc is  0.10003333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.4355, device='cuda:3')
compute_norm is  tensor(74.5614, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9.3211, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8801392479491895
avg test loss is  3.5602909984873303
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(9.3211, device='cuda:3')
compute_norm is  tensor(74.7440, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10.7370, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.562006698869693
avg test loss is  2.8540096654058265
avg accuracy is  0.10015000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(10.7370, device='cuda:3')
compute_norm is  tensor(74.1369, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(14.7153, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8514843274281223
avg test loss is  3.595853528996775
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(14.7153, device='cuda:3')
compute_norm is  tensor(74.0918, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.6733, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5621499152325873
avg test loss is  2.852757455189345
avg accuracy is  0.10013333348966531
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(17.6733, device='cuda:3')
compute_norm is  tensor(73.4659, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.2856, device='cuda:3')
distance x is tensor(22.2856, device='cuda:3')
________________________________
test distance is  tensor(22.2856, device='cuda:3')
test distance1 is  tensor(22.2856, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5909503888982193
test entropy is  0.8524695706011644
________________________________
cal ratio is  0.5275992826390757
distance x is tensor(11.7593, device='cuda:3')
cal_distance is  tensor(11.7593, device='cuda:3')
cal ratio is  0.7263166954254837
distance x is tensor(8.5412, device='cuda:3')
cal_distance is  tensor(8.5412, device='cuda:3')
cal ratio is  0.8522294096368707
distance x is tensor(7.2792, device='cuda:3')
cal_distance is  tensor(7.2792, device='cuda:3')
cal ratio is  0.9231539076306033
distance x is tensor(6.7199, device='cuda:3')
cal_distance is  tensor(6.7199, device='cuda:3')
cal ratio is  0.9608038186353757
distance x is tensor(6.4565, device='cuda:3')
cal_distance is  tensor(6.4565, device='cuda:3')
distance x is tensor(6.4565, device='cuda:3')
return_distance is  tensor(6.4565, device='cuda:3')
distance x is tensor(6.4547, device='cuda:3')
distance x is tensor(6.4547, device='cuda:3')
________________________________
test distance is  tensor(6.4547, device='cuda:3')
test distance1 is  tensor(6.4547, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.5866031364591393
test entropy is  1.9164804061338592
________________________________
0
distance x is tensor(6.4547, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9168343824872585
avg test loss is  2.5859301247830584
avg accuracy is  0.10008333348966532
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.4547, device='cuda:3')
compute_norm is  tensor(74.0406, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.7089, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8670405392199437
avg test loss is  3.574986519081506
avg accuracy is  0.10008333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(11.7089, device='cuda:3')
compute_norm is  tensor(74.1156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.0072, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5618882122070297
avg test loss is  2.8541744581417743
avg accuracy is  0.10020000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(15.0072, device='cuda:3')
compute_norm is  tensor(73.5044, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.8229, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8526832324736662
avg test loss is  3.5913071017275486
avg accuracy is  0.10008333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(19.8229, device='cuda:3')
compute_norm is  tensor(73.4613, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(23.1390, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5627296264491863
avg test loss is  2.8531971076912463
avg accuracy is  0.10015000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(23.1390, device='cuda:3')
compute_norm is  tensor(72.8393, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(27.9025, device='cuda:3')
distance x is tensor(27.9025, device='cuda:3')
________________________________
test distance is  tensor(27.9025, device='cuda:3')
test distance1 is  tensor(27.9025, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5889398230672644
test entropy is  0.8538342054718847
________________________________
cal ratio is  0.4715138094483713
distance x is tensor(13.1563, device='cuda:3')
cal_distance is  tensor(13.1563, device='cuda:3')
cal ratio is  0.6866728188058175
distance x is tensor(9.0340, device='cuda:3')
cal_distance is  tensor(9.0340, device='cuda:3')
cal ratio is  0.8286586484431623
distance x is tensor(7.4861, device='cuda:3')
cal_distance is  tensor(7.4861, device='cuda:3')
cal ratio is  0.9103078751425262
distance x is tensor(6.8146, device='cuda:3')
cal_distance is  tensor(6.8146, device='cuda:3')
cal ratio is  0.9541012098954017
distance x is tensor(6.5019, device='cuda:3')
cal_distance is  tensor(6.5019, device='cuda:3')
cal ratio is  0.9767813230422295
distance x is tensor(6.3509, device='cuda:3')
cal_distance is  tensor(6.3509, device='cuda:3')
distance x is tensor(6.3509, device='cuda:3')
return_distance is  tensor(6.3509, device='cuda:3')
distance x is tensor(6.3511, device='cuda:3')
distance x is tensor(6.3511, device='cuda:3')
________________________________
test distance is  tensor(6.3511, device='cuda:3')
test distance1 is  tensor(6.3511, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.53747134778037
test entropy is  1.984750915056607
________________________________
0
distance x is tensor(6.3511, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9848127592601248
avg test loss is  2.537611200102865
avg accuracy is  0.10021666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.3511, device='cuda:3')
compute_norm is  tensor(73.9601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.7963, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.870803290402203
avg test loss is  3.5720523773734247
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(11.7963, device='cuda:3')
compute_norm is  tensor(74.0622, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.1359, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5638602364546201
avg test loss is  2.852400824459377
avg accuracy is  0.10010000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(15.1359, device='cuda:3')
compute_norm is  tensor(73.4533, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.9735, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8535601086835108
avg test loss is  3.592333291639397
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(19.9735, device='cuda:3')
compute_norm is  tensor(73.4102, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(23.3099, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5600991498178511
avg test loss is  2.8543250959819315
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(23.3099, device='cuda:3')
compute_norm is  tensor(72.7905, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(28.0777, device='cuda:3')
________________________________
test distance is  tensor(28.0777, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10008333348966532
test loss is 3.587243189181346
test entropy is  0.8534960254296057
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.6109442710876465
mal norm is  tensor(145.2273, device='cuda:3')
distance x is tensor(28.0777, device='cuda:3')
mal distance is  tensor(28.0777, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 99.9604,  95.5823, 121.8732, 111.2160,  99.3647, 111.7460,  99.8064,
        107.1404, 145.2273, 145.2273, 145.2273, 145.2273, 145.2273, 145.2273,
        145.2273, 145.2273, 145.2273, 145.2273, 145.2273, 145.2273],
       device='cuda:3')
sorted_norm is   tensor([ 95.5823,  99.3647,  99.8064,  99.9604, 107.1404, 111.2160, 111.7460,
        121.8732, 145.2273, 145.2273, 145.2273, 145.2273, 145.2273, 145.2273,
        145.2273, 145.2273, 145.2273, 145.2273, 145.2273, 145.2273],
       device='cuda:3')
used idx is  tensor([ 1,  4,  6,  0,  7,  3,  5,  2, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3394112586975098
distance x is tensor(2.3000, device='cuda:3')
benign distance is  tensor(2.3000, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.229464292526245
distance x is tensor(2.4872, device='cuda:3')
benign distance is  tensor(2.4872, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3173928260803223
distance x is tensor(2.1963, device='cuda:3')
benign distance is  tensor(2.1963, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2627174854278564
distance x is tensor(6.8170, device='cuda:3')
benign distance is  tensor(6.8170, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3353209495544434
distance x is tensor(3.5752, device='cuda:3')
benign distance is  tensor(3.5752, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.337533950805664
distance x is tensor(6.1663, device='cuda:3')
benign distance is  tensor(6.1663, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.310699939727783
distance x is tensor(2.2704, device='cuda:3')
benign distance is  tensor(2.2704, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.291118621826172
distance x is tensor(6.9276, device='cuda:3')
benign distance is  tensor(6.9276, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(8.9954, device='cuda:3')
compute distance is  tensor(8.9954, device='cuda:3')
compute norm is  tensor(72.8079, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.2338, device='cuda:3')
compute distance is  tensor(3.2338, device='cuda:3')
compute norm is  tensor(72.7851, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1395, device='cuda:3')
compute distance is  tensor(2.1395, device='cuda:3')
compute norm is  tensor(72.7955, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5414, device='cuda:3')
compute distance is  tensor(2.5414, device='cuda:3')
compute norm is  tensor(72.7749, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.0549, device='cuda:3')
compute distance is  tensor(3.0549, device='cuda:3')
compute norm is  tensor(72.8529, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.8903, device='cuda:3')
compute distance is  tensor(4.8903, device='cuda:3')
compute norm is  tensor(72.8267, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5935, device='cuda:3')
compute distance is  tensor(2.5935, device='cuda:3')
compute norm is  tensor(72.7845, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3047, device='cuda:3')
compute distance is  tensor(2.3047, device='cuda:3')
compute norm is  tensor(72.8115, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.2639, device='cuda:3')
compute distance is  tensor(3.2639, device='cuda:3')
compute norm is  tensor(72.7774, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.2011, device='cuda:3')
compute distance is  tensor(3.2011, device='cuda:3')
compute norm is  tensor(72.8149, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.0360, device='cuda:3')
compute distance is  tensor(4.0360, device='cuda:3')
compute norm is  tensor(72.8515, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4327, device='cuda:3')
compute distance is  tensor(2.4327, device='cuda:3')
compute norm is  tensor(72.7333, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(8.9954, device='cuda:3')
distance x is tensor(107514.4219, device='cuda:3')
distance x is tensor(107514.4219, device='cuda:3')
________________________________
test distance is  tensor(107514.4219, device='cuda:3')
test distance1 is  tensor(107514.4219, device='cuda:3')
test similarity is  tensor(0.5808, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130115701987996.11
test entropy is  0.0
________________________________
cal ratio is  0.008964023899319327
distance x is tensor(963.7668, device='cuda:3')
cal_distance is  tensor(963.7668, device='cuda:3')
cal ratio is  0.09467828260187285
distance x is tensor(91.2523, device='cuda:3')
cal_distance is  tensor(91.2523, device='cuda:3')
cal ratio is  0.30769068640989017
distance x is tensor(28.0811, device='cuda:3')
cal_distance is  tensor(28.0811, device='cuda:3')
cal ratio is  0.5546628521990496
distance x is tensor(15.5780, device='cuda:3')
cal_distance is  tensor(15.5780, device='cuda:3')
cal ratio is  0.7446976187559199
distance x is tensor(11.6024, device='cuda:3')
cal_distance is  tensor(11.6024, device='cuda:3')
cal ratio is  0.8629031944758203
distance x is tensor(10.0126, device='cuda:3')
cal_distance is  tensor(10.0126, device='cuda:3')
cal ratio is  0.9288874824110273
distance x is tensor(9.3010, device='cuda:3')
cal_distance is  tensor(9.3010, device='cuda:3')
cal ratio is  0.9637655133236968
distance x is tensor(8.9642, device='cuda:3')
cal_distance is  tensor(8.9642, device='cuda:3')
distance x is tensor(8.9642, device='cuda:3')
return_distance is  tensor(8.9642, device='cuda:3')
distance x is tensor(8.9543, device='cuda:3')
distance x is tensor(8.9543, device='cuda:3')
________________________________
test distance is  tensor(8.9543, device='cuda:3')
test distance1 is  tensor(8.9543, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.472065000645896
test entropy is  2.076878820401011
________________________________
0
distance x is tensor(8.9543, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0769527573575344
avg test loss is  2.471205703231063
avg accuracy is  0.10018333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(8.9543, device='cuda:3')
compute_norm is  tensor(73.4701, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.3021, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8754842200640168
avg test loss is  3.566765949670186
avg accuracy is  0.10008333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(11.3021, device='cuda:3')
compute_norm is  tensor(73.6341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(12.3335, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5629492418598265
avg test loss is  2.8524037068332437
avg accuracy is  0.10018333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(12.3335, device='cuda:3')
compute_norm is  tensor(73.0239, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.5124, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8527445694658039
avg test loss is  3.5916473374946287
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(15.5124, device='cuda:3')
compute_norm is  tensor(72.9956, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.9132, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5628003864400168
avg test loss is  2.8520780794147744
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(17.9132, device='cuda:3')
compute_norm is  tensor(72.3730, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.1909, device='cuda:3')
distance x is tensor(22.1909, device='cuda:3')
________________________________
test distance is  tensor(22.1909, device='cuda:3')
test distance1 is  tensor(22.1909, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.588359560539473
test entropy is  0.8535021954635059
________________________________
cal ratio is  0.6239488476895668
distance x is tensor(13.8485, device='cuda:3')
cal_distance is  tensor(13.8485, device='cuda:3')
cal ratio is  0.7898326926282785
distance x is tensor(10.9383, device='cuda:3')
cal_distance is  tensor(10.9383, device='cuda:3')
cal ratio is  0.8887120253662867
distance x is tensor(9.7212, device='cuda:3')
cal_distance is  tensor(9.7212, device='cuda:3')
cal ratio is  0.9427068113845145
distance x is tensor(9.1643, device='cuda:3')
cal_distance is  tensor(9.1643, device='cuda:3')
cal ratio is  0.970926126659659
distance x is tensor(8.8979, device='cuda:3')
cal_distance is  tensor(8.8979, device='cuda:3')
distance x is tensor(8.8979, device='cuda:3')
return_distance is  tensor(8.8979, device='cuda:3')
distance x is tensor(8.8948, device='cuda:3')
distance x is tensor(8.8948, device='cuda:3')
________________________________
test distance is  tensor(8.8948, device='cuda:3')
test distance1 is  tensor(8.8948, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.766196399863595
test entropy is  1.6720271860358558
________________________________
0
distance x is tensor(8.8948, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6727559433054568
avg test loss is  2.765267669773305
avg accuracy is  0.10008333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(8.8948, device='cuda:3')
compute_norm is  tensor(72.8053, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.6048, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8568840507886557
avg test loss is  3.5869574930622123
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(13.6048, device='cuda:3')
compute_norm is  tensor(72.8117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16.7999, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5642415432533476
avg test loss is  2.8506932136600716
avg accuracy is  0.10018333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(16.7999, device='cuda:3')
compute_norm is  tensor(72.1959, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.4753, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8520752230941105
avg test loss is  3.591511427466549
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(21.4753, device='cuda:3')
compute_norm is  tensor(72.1722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(24.7342, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.563832427138713
avg test loss is  2.8501646307739876
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(24.7342, device='cuda:3')
compute_norm is  tensor(71.5509, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.3744, device='cuda:3')
distance x is tensor(29.3744, device='cuda:3')
________________________________
test distance is  tensor(29.3744, device='cuda:3')
test distance1 is  tensor(29.3744, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5848266102357713
test entropy is  0.8545745038655775
________________________________
cal ratio is  0.5423149756269232
distance x is tensor(15.9304, device='cuda:3')
cal_distance is  tensor(15.9304, device='cuda:3')
cal ratio is  0.7364152197855093
distance x is tensor(11.7314, device='cuda:3')
cal_distance is  tensor(11.7314, device='cuda:3')
cal ratio is  0.8581449658043105
distance x is tensor(10.0673, device='cuda:3')
cal_distance is  tensor(10.0673, device='cuda:3')
cal ratio is  0.9263602448697312
distance x is tensor(9.3260, device='cuda:3')
cal_distance is  tensor(9.3260, device='cuda:3')
cal ratio is  0.9624753893393448
distance x is tensor(8.9760, device='cuda:3')
cal_distance is  tensor(8.9760, device='cuda:3')
distance x is tensor(8.9760, device='cuda:3')
return_distance is  tensor(8.9760, device='cuda:3')
distance x is tensor(8.9757, device='cuda:3')
distance x is tensor(8.9757, device='cuda:3')
________________________________
test distance is  tensor(8.9757, device='cuda:3')
test distance1 is  tensor(8.9757, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.676372166889817
test entropy is  1.7901080767991446
________________________________
0
distance x is tensor(8.9757, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7905605385806769
avg test loss is  2.676278637416327
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(8.9757, device='cuda:3')
compute_norm is  tensor(72.6361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(14.0091, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8609847598619806
avg test loss is  3.5813445772951855
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(14.0091, device='cuda:3')
compute_norm is  tensor(72.6870, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.3066, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5647707408679319
avg test loss is  2.8502370042841574
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(17.3066, device='cuda:3')
compute_norm is  tensor(72.0744, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.0366, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8527938132601252
avg test loss is  3.5900791494576914
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(22.0366, device='cuda:3')
compute_norm is  tensor(72.0504, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(25.3333, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5642917012609143
avg test loss is  2.849877553453832
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(25.3333, device='cuda:3')
compute_norm is  tensor(71.4303, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.9994, device='cuda:3')
________________________________
test distance is  tensor(29.9994, device='cuda:3')
test similarity is  tensor(0.9997, device='cuda:3')
test acc is  0.10020000015633199
test loss is 3.587554465733103
test entropy is  0.8533207612124079
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.547727108001709
mal norm is  tensor(143.2628, device='cuda:3')
distance x is tensor(29.9994, device='cuda:3')
mal distance is  tensor(29.9994, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 102.8204,   97.1276,  100.4955,  108.8226,  103.9271,  126.3512,
         104.8058,  118.7354,  143.2628,  143.2628,  143.2628,  143.2628,
         143.2628,  143.2628,  143.2628,  143.2628,  143.2628,  143.2628,
         143.2628,  143.2628, 1721.8983, 1740.8003, 1711.7870, 1724.5387,
        1715.8055, 1746.3047, 1743.1042, 1732.4139, 1782.7296, 1791.9855,
        1781.0397, 1784.0934, 1774.5459, 1775.5616, 1790.7930, 1773.9663,
         469.2355,  172.2272,  194.9019,  180.9729,  159.6119,  168.8878,
         164.2952,  175.5482,  127.5458,  124.9356,  153.2924,  117.1163,
         114.4943,  110.4212,  137.5773,  119.9208], device='cuda:3')
sorted_norm is   tensor([  97.1276,  100.4955,  102.8204,  103.9271,  104.8058,  108.8226,
         110.4212,  114.4943,  117.1163,  118.7354,  119.9208,  124.9356,
         126.3512,  127.5458,  137.5773,  143.2628,  143.2628,  143.2628,
         143.2628,  143.2628,  143.2628,  143.2628,  143.2628,  143.2628,
         143.2628,  143.2628,  143.2628,  153.2924,  159.6119,  164.2952,
         168.8878,  172.2272,  175.5482,  180.9729,  194.9019,  469.2355,
        1711.7870, 1715.8055, 1721.8983, 1724.5387, 1732.4139, 1740.8003,
        1743.1042, 1746.3047, 1773.9663, 1774.5459, 1775.5616, 1781.0397,
        1782.7296, 1784.0934, 1790.7930, 1791.9855], device='cuda:3')
used idx is  tensor([ 1,  2,  0,  4,  6,  3, 49, 48, 47,  7, 51, 45,  5, 44, 50, 19, 11,  9,
        13, 17, 15, 14, 16, 18,  8, 12, 10, 46, 40, 42, 41, 37, 43, 39, 38, 36,
        22, 24, 20, 23, 27], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.344658851623535
distance x is tensor(1.9873, device='cuda:3')
benign distance is  tensor(1.9873, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.224008321762085
distance x is tensor(6.4072, device='cuda:3')
benign distance is  tensor(6.4072, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.1279993057250977
distance x is tensor(7.3698, device='cuda:3')
benign distance is  tensor(7.3698, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.296527147293091
distance x is tensor(6.6755, device='cuda:3')
benign distance is  tensor(6.6755, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3438642024993896
distance x is tensor(10.2182, device='cuda:3')
benign distance is  tensor(10.2182, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.305929660797119
distance x is tensor(7.2107, device='cuda:3')
benign distance is  tensor(7.2107, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3307769298553467
distance x is tensor(1.8142, device='cuda:3')
benign distance is  tensor(1.8142, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3024404048919678
distance x is tensor(3.2102, device='cuda:3')
benign distance is  tensor(3.2102, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3317573070526123
distance x is tensor(2.5458, device='cuda:3')
benign distance is  tensor(2.5458, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.311567783355713
distance x is tensor(2.8995, device='cuda:3')
benign distance is  tensor(2.8995, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2835564613342285
distance x is tensor(3.6729, device='cuda:3')
benign distance is  tensor(3.6729, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.279369831085205
distance x is tensor(2.5791, device='cuda:3')
benign distance is  tensor(2.5791, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.3266968727111816
distance x is tensor(1.8909, device='cuda:3')
benign distance is  tensor(1.8909, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.274843454360962
distance x is tensor(5.6341, device='cuda:3')
benign distance is  tensor(5.6341, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2958638668060303
distance x is tensor(3.3680, device='cuda:3')
benign distance is  tensor(3.3680, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.289238691329956
distance x is tensor(18.7248, device='cuda:3')
benign distance is  tensor(18.7248, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.2746310234069824
distance x is tensor(5.8662, device='cuda:3')
benign distance is  tensor(5.8662, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.329080581665039
distance x is tensor(4.8024, device='cuda:3')
benign distance is  tensor(4.8024, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.3032174110412598
distance x is tensor(9.7500, device='cuda:3')
benign distance is  tensor(9.7500, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3061418533325195
distance x is tensor(8.8091, device='cuda:3')
benign distance is  tensor(8.8091, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.354036808013916
distance x is tensor(9.4746, device='cuda:3')
benign distance is  tensor(9.4746, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.3081483840942383
distance x is tensor(2.6626, device='cuda:3')
benign distance is  tensor(2.6626, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.324880361557007
distance x is tensor(2.0796, device='cuda:3')
benign distance is  tensor(2.0796, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3627054691314697
distance x is tensor(1.8725, device='cuda:3')
benign distance is  tensor(1.8725, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.2510085105895996
distance x is tensor(2.7477, device='cuda:3')
benign distance is  tensor(2.7477, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2500414848327637
distance x is tensor(8.4143, device='cuda:3')
benign distance is  tensor(8.4143, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.3570756912231445
distance x is tensor(10.5735, device='cuda:3')
benign distance is  tensor(10.5735, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.3641741275787354
distance x is tensor(4.7793, device='cuda:3')
benign distance is  tensor(4.7793, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.2922825813293457
distance x is tensor(2.0767, device='cuda:3')
benign distance is  tensor(2.0767, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.3259706497192383
distance x is tensor(2.2064, device='cuda:3')
benign distance is  tensor(2.2064, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.4071288108825684
distance x is tensor(10.2288, device='cuda:3')
benign distance is  tensor(10.2288, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.3294970989227295
distance x is tensor(3.7497, device='cuda:3')
benign distance is  tensor(3.7497, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.3164896965026855
distance x is tensor(3.4787, device='cuda:3')
benign distance is  tensor(3.4787, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.264915943145752
distance x is tensor(14.2519, device='cuda:3')
benign distance is  tensor(14.2519, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.3974688053131104
distance x is tensor(2.2056, device='cuda:3')
benign distance is  tensor(2.2056, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.359459161758423
distance x is tensor(3.9522, device='cuda:3')
benign distance is  tensor(3.9522, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.271221876144409
distance x is tensor(1.9194, device='cuda:3')
benign distance is  tensor(1.9194, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.3061773777008057
distance x is tensor(20.5648, device='cuda:3')
benign distance is  tensor(20.5648, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.299769639968872
distance x is tensor(1.9975, device='cuda:3')
benign distance is  tensor(1.9975, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.3660738468170166
distance x is tensor(7.1287, device='cuda:3')
benign distance is  tensor(7.1287, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(6.0114, device='cuda:3')
compute distance is  tensor(6.0114, device='cuda:3')
compute norm is  tensor(70.6269, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2268, device='cuda:3')
compute distance is  tensor(2.2268, device='cuda:3')
compute norm is  tensor(70.6919, device='cuda:3', dtype=torch.float64)
distance x is tensor(17.2398, device='cuda:3')
compute distance is  tensor(17.2398, device='cuda:3')
compute norm is  tensor(70.7914, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1668, device='cuda:3')
compute distance is  tensor(2.1668, device='cuda:3')
compute norm is  tensor(70.6921, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4152, device='cuda:3')
compute distance is  tensor(2.4152, device='cuda:3')
compute norm is  tensor(70.7137, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.9292, device='cuda:3')
compute distance is  tensor(4.9292, device='cuda:3')
compute norm is  tensor(70.6993, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2893, device='cuda:3')
compute distance is  tensor(2.2893, device='cuda:3')
compute norm is  tensor(70.6905, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8292, device='cuda:3')
compute distance is  tensor(2.8292, device='cuda:3')
compute norm is  tensor(70.6801, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.8856, device='cuda:3')
compute distance is  tensor(7.8856, device='cuda:3')
compute norm is  tensor(70.7717, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.6314, device='cuda:3')
compute distance is  tensor(5.6314, device='cuda:3')
compute norm is  tensor(70.6970, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.1808, device='cuda:3')
compute distance is  tensor(4.1808, device='cuda:3')
compute norm is  tensor(70.6522, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3570, device='cuda:3')
compute distance is  tensor(2.3570, device='cuda:3')
compute norm is  tensor(70.6709, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(17.2398, device='cuda:3')
distance x is tensor(107499.3906, device='cuda:3')
distance x is tensor(107499.3906, device='cuda:3')
________________________________
test distance is  tensor(107499.3906, device='cuda:3')
test distance1 is  tensor(107499.3906, device='cuda:3')
test similarity is  tensor(0.6028, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130149710683688.39
test entropy is  0.0
________________________________
cal ratio is  0.01241048781170724
distance x is tensor(1334.1250, device='cuda:3')
cal_distance is  tensor(1334.1250, device='cuda:3')
cal ratio is  0.11140215079027573
distance x is tensor(148.6289, device='cuda:3')
cal_distance is  tensor(148.6289, device='cuda:3')
cal ratio is  0.33376459484031545
distance x is tensor(49.6105, device='cuda:3')
cal_distance is  tensor(49.6105, device='cuda:3')
cal ratio is  0.5777037560923252
distance x is tensor(28.6624, device='cuda:3')
cal_distance is  tensor(28.6624, device='cuda:3')
cal ratio is  0.7600385853107682
distance x is tensor(21.7858, device='cuda:3')
cal_distance is  tensor(21.7858, device='cuda:3')
cal ratio is  0.8717756906098239
distance x is tensor(18.9931, device='cuda:3')
cal_distance is  tensor(18.9931, device='cuda:3')
cal ratio is  0.9336717244677118
distance x is tensor(17.7337, device='cuda:3')
cal_distance is  tensor(17.7337, device='cuda:3')
cal ratio is  0.9662568572641221
distance x is tensor(17.1355, device='cuda:3')
cal_distance is  tensor(17.1355, device='cuda:3')
distance x is tensor(17.1355, device='cuda:3')
return_distance is  tensor(17.1355, device='cuda:3')
distance x is tensor(17.1255, device='cuda:3')
distance x is tensor(17.1255, device='cuda:3')
________________________________
test distance is  tensor(17.1255, device='cuda:3')
test distance1 is  tensor(17.1255, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.3577205346845616
test entropy is  2.2354646689856232
________________________________
0
distance x is tensor(17.1255, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.235463925770351
avg test loss is  2.3577685826368677
avg accuracy is  0.10040000015633196
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(17.1255, device='cuda:3')
compute_norm is  tensor(71.5298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.2356, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.885511607821308
avg test loss is  3.5545815191289254
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(19.2356, device='cuda:3')
compute_norm is  tensor(71.7768, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(19.5597, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5656042744610101
avg test loss is  2.8510289731056195
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(19.5597, device='cuda:3')
compute_norm is  tensor(71.1831, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.7759, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8534536308952486
avg test loss is  3.59394517458324
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(21.7759, device='cuda:3')
compute_norm is  tensor(71.1600, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22.7619, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5641284709546104
avg test loss is  2.850520017558832
avg accuracy is  0.10028333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(22.7619, device='cuda:3')
compute_norm is  tensor(70.5480, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.5416, device='cuda:3')
distance x is tensor(25.5416, device='cuda:3')
________________________________
test distance is  tensor(25.5416, device='cuda:3')
test distance1 is  tensor(25.5416, device='cuda:3')
test similarity is  tensor(0.9993, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5891423532957716
test entropy is  0.8547979388028574
________________________________
cal ratio is  0.805133361135728
distance x is tensor(20.5718, device='cuda:3')
cal_distance is  tensor(20.5718, device='cuda:3')
cal ratio is  0.8971314894340644
distance x is tensor(18.4560, device='cuda:3')
cal_distance is  tensor(18.4560, device='cuda:3')
cal ratio is  0.9471594609433908
distance x is tensor(17.4810, device='cuda:3')
cal_distance is  tensor(17.4810, device='cuda:3')
cal ratio is  0.9732152022376188
distance x is tensor(17.0129, device='cuda:3')
cal_distance is  tensor(17.0129, device='cuda:3')
distance x is tensor(17.0129, device='cuda:3')
return_distance is  tensor(17.0129, device='cuda:3')
distance x is tensor(17.0047, device='cuda:3')
distance x is tensor(17.0047, device='cuda:3')
________________________________
test distance is  tensor(17.0047, device='cuda:3')
test distance1 is  tensor(17.0047, device='cuda:3')
test similarity is  tensor(0.9997, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.9433406677835787
test entropy is  1.4554413269831936
________________________________
0
distance x is tensor(17.0047, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4553015201584871
avg test loss is  2.9434479355557897
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(17.0047, device='cuda:3')
compute_norm is  tensor(70.6093, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(20.2076, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8475216147360771
avg test loss is  3.6013502454452677
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(20.2076, device='cuda:3')
compute_norm is  tensor(70.5448, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22.5620, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5616609199977378
avg test loss is  2.8538151692225733
avg accuracy is  0.10028333348966531
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(22.5620, device='cuda:3')
compute_norm is  tensor(69.9359, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(26.6351, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8526778099760572
avg test loss is  3.5903120953391103
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(26.6351, device='cuda:3')
compute_norm is  tensor(69.9187, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(29.4254, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5642611210280135
avg test loss is  2.8501303717017428
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(29.4254, device='cuda:3')
compute_norm is  tensor(69.3120, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(33.6600, device='cuda:3')
distance x is tensor(33.6600, device='cuda:3')
________________________________
test distance is  tensor(33.6600, device='cuda:3')
test distance1 is  tensor(33.6600, device='cuda:3')
test similarity is  tensor(0.9993, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.58904398580604
test entropy is  0.8518058898479446
________________________________
cal ratio is  0.7013500691308395
distance x is tensor(23.6091, device='cuda:3')
cal_distance is  tensor(23.6091, device='cuda:3')
cal ratio is  0.8374362493135993
distance x is tensor(19.7713, device='cuda:3')
cal_distance is  tensor(19.7713, device='cuda:3')
cal ratio is  0.9151116223075876
distance x is tensor(18.0930, device='cuda:3')
cal_distance is  tensor(18.0930, device='cuda:3')
cal ratio is  0.9566124272768307
distance x is tensor(17.3081, device='cuda:3')
cal_distance is  tensor(17.3081, device='cuda:3')
cal ratio is  0.978064428641659
distance x is tensor(16.9284, device='cuda:3')
cal_distance is  tensor(16.9284, device='cuda:3')
distance x is tensor(16.9284, device='cuda:3')
return_distance is  tensor(16.9284, device='cuda:3')
distance x is tensor(16.9264, device='cuda:3')
distance x is tensor(16.9264, device='cuda:3')
________________________________
test distance is  tensor(16.9264, device='cuda:3')
test distance1 is  tensor(16.9264, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7147740809393843
test entropy is  1.7396904397875006
________________________________
0
distance x is tensor(16.9264, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7394205190733807
avg test loss is  2.714643203881758
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(16.9264, device='cuda:3')
compute_norm is  tensor(70.0443, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.5084, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8565839864551894
avg test loss is  3.587675144931655
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(21.5084, device='cuda:3')
compute_norm is  tensor(70.0830, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(24.4922, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.562495578453739
avg test loss is  2.853524394889376
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(24.4922, device='cuda:3')
compute_norm is  tensor(69.4815, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(28.9126, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8508742160634446
avg test loss is  3.5926657500805885
avg accuracy is  0.10026666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(28.9126, device='cuda:3')
compute_norm is  tensor(69.4676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(31.9340, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5620144543363088
avg test loss is  2.851784723653976
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(31.9340, device='cuda:3')
compute_norm is  tensor(68.8612, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(36.3290, device='cuda:3')
________________________________
test distance is  tensor(36.3290, device='cuda:3')
test similarity is  tensor(0.9994, device='cuda:3')
test acc is  0.10023333348966532
test loss is 3.58945782987802
test entropy is  0.8508216022555508
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.4982361793518066
mal norm is  tensor(173.6451, device='cuda:3')
distance x is tensor(36.3290, device='cuda:3')
mal distance is  tensor(36.3290, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 85.6664,  90.9224,  97.9091,  96.2463, 120.1367, 113.5739,  77.6390,
         83.9943, 173.6451, 173.6451, 173.6451, 173.6451, 173.6451, 173.6451,
        173.6451, 173.6451, 173.6451, 173.6451, 173.6451, 173.6451],
       device='cuda:3')
sorted_norm is   tensor([ 77.6390,  83.9943,  85.6664,  90.9224,  96.2463,  97.9091, 113.5739,
        120.1367, 173.6451, 173.6451, 173.6451, 173.6451, 173.6451, 173.6451,
        173.6451, 173.6451, 173.6451, 173.6451, 173.6451, 173.6451],
       device='cuda:3')
used idx is  tensor([ 6,  7,  0,  1,  3,  2,  5,  4, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3068323135375977
distance x is tensor(2.2553, device='cuda:3')
benign distance is  tensor(2.2553, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2979297637939453
distance x is tensor(13.1609, device='cuda:3')
benign distance is  tensor(13.1609, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.303121566772461
distance x is tensor(11.8079, device='cuda:3')
benign distance is  tensor(11.8079, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3191845417022705
distance x is tensor(13.4118, device='cuda:3')
benign distance is  tensor(13.4118, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.330855131149292
distance x is tensor(403.9884, device='cuda:3')
benign distance is  tensor(403.9884, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3192248344421387
distance x is tensor(12.6258, device='cuda:3')
benign distance is  tensor(12.6258, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.311241626739502
distance x is tensor(2.1876, device='cuda:3')
benign distance is  tensor(2.1876, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3175835609436035
distance x is tensor(29.2074, device='cuda:3')
benign distance is  tensor(29.2074, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(3.1508, device='cuda:3')
compute distance is  tensor(3.1508, device='cuda:3')
compute norm is  tensor(69.2125, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.7589, device='cuda:3')
compute distance is  tensor(7.7589, device='cuda:3')
compute norm is  tensor(69.2134, device='cuda:3', dtype=torch.float64)
distance x is tensor(15.8510, device='cuda:3')
compute distance is  tensor(15.8510, device='cuda:3')
compute norm is  tensor(69.2432, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5019, device='cuda:3')
compute distance is  tensor(2.5019, device='cuda:3')
compute norm is  tensor(69.2179, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.3224, device='cuda:3')
compute distance is  tensor(3.3224, device='cuda:3')
compute norm is  tensor(69.2432, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.3435, device='cuda:3')
compute distance is  tensor(9.3435, device='cuda:3')
compute norm is  tensor(69.1568, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5226, device='cuda:3')
compute distance is  tensor(2.5226, device='cuda:3')
compute norm is  tensor(69.1487, device='cuda:3', dtype=torch.float64)
distance x is tensor(18.5886, device='cuda:3')
compute distance is  tensor(18.5886, device='cuda:3')
compute norm is  tensor(69.3300, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.9311, device='cuda:3')
compute distance is  tensor(2.9311, device='cuda:3')
compute norm is  tensor(69.2647, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.3902, device='cuda:3')
compute distance is  tensor(10.3902, device='cuda:3')
compute norm is  tensor(69.2746, device='cuda:3', dtype=torch.float64)
distance x is tensor(15.2055, device='cuda:3')
compute distance is  tensor(15.2055, device='cuda:3')
compute norm is  tensor(69.2974, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.7501, device='cuda:3')
compute distance is  tensor(2.7501, device='cuda:3')
compute norm is  tensor(69.1267, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(18.5886, device='cuda:3')
distance x is tensor(107497.0391, device='cuda:3')
distance x is tensor(107497.0391, device='cuda:3')
________________________________
test distance is  tensor(107497.0391, device='cuda:3')
test distance1 is  tensor(107497.0391, device='cuda:3')
test similarity is  tensor(0.6052, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130101061246714.0
test entropy is  0.0
________________________________
cal ratio is  0.012886979006735244
distance x is tensor(1385.3171, device='cuda:3')
cal_distance is  tensor(1385.3171, device='cuda:3')
cal ratio is  0.11352062286865987
distance x is tensor(157.2665, device='cuda:3')
cal_distance is  tensor(157.2665, device='cuda:3')
cal ratio is  0.336923478929813
distance x is tensor(52.9902, device='cuda:3')
cal_distance is  tensor(52.9902, device='cuda:3')
cal ratio is  0.5804324262402808
distance x is tensor(30.7594, device='cuda:3')
cal_distance is  tensor(30.7594, device='cuda:3')
cal ratio is  0.7618337321350978
distance x is tensor(23.4349, device='cuda:3')
cal_distance is  tensor(23.4349, device='cuda:3')
cal ratio is  0.8728068595837827
distance x is tensor(20.4548, device='cuda:3')
cal_distance is  tensor(20.4548, device='cuda:3')
cal ratio is  0.9342252902146383
distance x is tensor(19.1098, device='cuda:3')
cal_distance is  tensor(19.1098, device='cuda:3')
cal ratio is  0.9665439967774897
distance x is tensor(18.4706, device='cuda:3')
cal_distance is  tensor(18.4706, device='cuda:3')
distance x is tensor(18.4706, device='cuda:3')
return_distance is  tensor(18.4706, device='cuda:3')
distance x is tensor(18.4607, device='cuda:3')
distance x is tensor(18.4607, device='cuda:3')
________________________________
test distance is  tensor(18.4607, device='cuda:3')
test distance1 is  tensor(18.4607, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.48119912396616
test entropy is  2.062246069216779
________________________________
0
distance x is tensor(18.4607, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0617472317173027
avg test loss is  2.481828820985009
avg accuracy is  0.10033333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(18.4607, device='cuda:3')
compute_norm is  tensor(70.2117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.9703, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8729921161238827
avg test loss is  3.56821862263466
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(19.9703, device='cuda:3')
compute_norm is  tensor(70.3962, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(20.2312, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5656570189797294
avg test loss is  2.850117187510167
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(20.2312, device='cuda:3')
compute_norm is  tensor(69.7987, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.3007, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.852741583768747
avg test loss is  3.5920343175371574
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(22.3007, device='cuda:3')
compute_norm is  tensor(69.7921, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(23.2482, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5623301462069759
avg test loss is  2.850534818828233
avg accuracy is  0.10041666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(23.2482, device='cuda:3')
compute_norm is  tensor(69.1822, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.8425, device='cuda:3')
distance x is tensor(25.8425, device='cuda:3')
________________________________
test distance is  tensor(25.8425, device='cuda:3')
test distance1 is  tensor(25.8425, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5864098242350986
test entropy is  0.8530660612242562
________________________________
cal ratio is  0.8311546771958317
distance x is tensor(21.4871, device='cuda:3')
cal_distance is  tensor(21.4871, device='cuda:3')
cal ratio is  0.9115083671061289
distance x is tensor(19.5860, device='cuda:3')
cal_distance is  tensor(19.5860, device='cuda:3')
cal ratio is  0.9547201599678061
distance x is tensor(18.6994, device='cuda:3')
cal_distance is  tensor(18.6994, device='cuda:3')
cal ratio is  0.9770926712595788
distance x is tensor(18.2711, device='cuda:3')
cal_distance is  tensor(18.2711, device='cuda:3')
distance x is tensor(18.2711, device='cuda:3')
return_distance is  tensor(18.2711, device='cuda:3')
distance x is tensor(18.2625, device='cuda:3')
distance x is tensor(18.2625, device='cuda:3')
________________________________
test distance is  tensor(18.2625, device='cuda:3')
test distance1 is  tensor(18.2625, device='cuda:3')
test similarity is  tensor(0.9997, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.1378083895010227
test entropy is  1.241569217842525
________________________________
0
distance x is tensor(18.2625, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.242358400750516
avg test loss is  3.1370125731933856
avg accuracy is  0.10023333348966532
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(18.2625, device='cuda:3')
compute_norm is  tensor(69.2644, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(20.9847, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.838946714266531
avg test loss is  3.6072964421721663
avg accuracy is  0.10033333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(20.9847, device='cuda:3')
compute_norm is  tensor(69.1383, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(23.6109, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5545153858056708
avg test loss is  2.825668133398109
avg accuracy is  0.10461666682299864
solo acc is  0.10131666682299864
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(23.6109, device='cuda:3')
compute_norm is  tensor(68.5307, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(27.6489, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8459686685218486
avg test loss is  3.546737710295964
avg accuracy is  0.10423333348966529
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(27.6489, device='cuda:3')
compute_norm is  tensor(68.5289, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(31.2887, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5237551057008283
avg test loss is  2.7653471450053297
avg accuracy is  0.10921666682299862
solo acc is  0.1012333334896653
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(31.2887, device='cuda:3')
compute_norm is  tensor(67.9273, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(35.3977, device='cuda:3')
distance x is tensor(35.3977, device='cuda:3')
________________________________
test distance is  tensor(35.3977, device='cuda:3')
test distance1 is  tensor(35.3977, device='cuda:3')
test similarity is  tensor(0.9994, device='cuda:3')
test acc is  0.09998333348966532
test loss is 3.4883277833080495
test entropy is  0.8424950257293197
________________________________
cal ratio is  0.7101691403367903
distance x is tensor(25.1404, device='cuda:3')
cal_distance is  tensor(25.1404, device='cuda:3')
cal ratio is  0.8426807568206826
distance x is tensor(21.1855, device='cuda:3')
cal_distance is  tensor(21.1855, device='cuda:3')
cal ratio is  0.9179723010315085
distance x is tensor(19.4478, device='cuda:3')
cal_distance is  tensor(19.4478, device='cuda:3')
cal ratio is  0.9581062297637222
distance x is tensor(18.6331, device='cuda:3')
cal_distance is  tensor(18.6331, device='cuda:3')
cal ratio is  0.9788277475431075
distance x is tensor(18.2387, device='cuda:3')
cal_distance is  tensor(18.2387, device='cuda:3')
distance x is tensor(18.2387, device='cuda:3')
return_distance is  tensor(18.2387, device='cuda:3')
distance x is tensor(18.2363, device='cuda:3')
distance x is tensor(18.2363, device='cuda:3')
________________________________
test distance is  tensor(18.2363, device='cuda:3')
test distance1 is  tensor(18.2363, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8896126909805004
test entropy is  1.4996637511355029
________________________________
0
distance x is tensor(18.2363, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5002377291223896
avg test loss is  2.888856941448854
avg accuracy is  0.10121666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(18.2363, device='cuda:3')
compute_norm is  tensor(68.6780, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.9551, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8454877032018674
avg test loss is  3.5172389959221455
avg accuracy is  0.1049333334896653
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(22.9551, device='cuda:3')
compute_norm is  tensor(68.6561, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(27.0253, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.515612429901481
avg test loss is  2.7342931886217485
avg accuracy is  0.11243333348966529
solo acc is  0.10101666682299863
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(27.0253, device='cuda:3')
compute_norm is  tensor(68.0635, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(31.3469, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8378350092276835
avg test loss is  3.4595660123743737
avg accuracy is  0.10840000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(31.3469, device='cuda:3')
compute_norm is  tensor(68.0544, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(36.0161, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.4552770642075203
avg test loss is  2.655253431181918
avg accuracy is  0.11685000015633194
solo acc is  0.10225000015633197
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(36.0161, device='cuda:3')
compute_norm is  tensor(67.4716, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(40.4448, device='cuda:3')
________________________________
test distance is  tensor(40.4448, device='cuda:3')
test similarity is  tensor(0.9991, device='cuda:3')
test acc is  0.11040000015633196
test loss is 3.3251541248008385
test entropy is  0.8208870503312743
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.380145311355591
mal norm is  tensor(189.5538, device='cuda:3')
distance x is tensor(40.4448, device='cuda:3')
mal distance is  tensor(40.4448, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 103.4694,  170.3424,  137.8441,  154.6436, 6787.5508,  157.0307,
         101.9560,  445.4986,  189.5538,  189.5538,  189.5538,  189.5538,
         189.5538,  189.5538,  189.5538,  189.5538,  189.5538,  189.5538,
         189.5538,  189.5538,  317.1813,  307.7681,  324.2277,  304.4134,
         371.2111,  307.3246,  316.4960,  300.6257,  129.6289,  128.2371,
         129.6447,  119.8684,  113.0425,  124.3209,  122.6905,  205.6647],
       device='cuda:3')
sorted_norm is   tensor([ 101.9560,  103.4694,  113.0425,  119.8684,  122.6905,  124.3209,
         128.2371,  129.6289,  129.6447,  137.8441,  154.6436,  157.0307,
         170.3424,  189.5538,  189.5538,  189.5538,  189.5538,  189.5538,
         189.5538,  189.5538,  189.5538,  189.5538,  189.5538,  189.5538,
         189.5538,  205.6647,  300.6257,  304.4134,  307.3246,  307.7681,
         316.4960,  317.1813,  324.2277,  371.2111,  445.4986, 6787.5508],
       device='cuda:3')
used idx is  tensor([ 6,  0, 32, 31, 34, 33, 29, 28, 30,  2,  3,  5,  1, 19, 14, 15, 13, 12,
        11, 10,  8, 18, 16,  9, 17, 35, 27, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3131279945373535
distance x is tensor(9.5326, device='cuda:3')
benign distance is  tensor(9.5326, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8524341583251953
distance x is tensor(36.9958, device='cuda:3')
benign distance is  tensor(36.9958, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.107191801071167
distance x is tensor(34.6471, device='cuda:3')
benign distance is  tensor(34.6471, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2866787910461426
distance x is tensor(17.9643, device='cuda:3')
benign distance is  tensor(17.9643, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3312299251556396
distance x is tensor(12.7538, device='cuda:3')
benign distance is  tensor(12.7538, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3076906204223633
distance x is tensor(11.2271, device='cuda:3')
benign distance is  tensor(11.2271, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3071236610412598
distance x is tensor(13.7981, device='cuda:3')
benign distance is  tensor(13.7981, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.309786319732666
distance x is tensor(12.7752, device='cuda:3')
benign distance is  tensor(12.7752, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.350396156311035
distance x is tensor(16.4781, device='cuda:3')
benign distance is  tensor(16.4781, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3259053230285645
distance x is tensor(14.4095, device='cuda:3')
benign distance is  tensor(14.4095, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2644476890563965
distance x is tensor(13.9060, device='cuda:3')
benign distance is  tensor(13.9060, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3318560123443604
distance x is tensor(14.7694, device='cuda:3')
benign distance is  tensor(14.7694, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.3130390644073486
distance x is tensor(13.3397, device='cuda:3')
benign distance is  tensor(13.3397, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.319443941116333
distance x is tensor(7.5058, device='cuda:3')
benign distance is  tensor(7.5058, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.300070285797119
distance x is tensor(15.0929, device='cuda:3')
benign distance is  tensor(15.0929, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8747371435165405
distance x is tensor(39.6113, device='cuda:3')
benign distance is  tensor(39.6113, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.3452727794647217
distance x is tensor(22.6898, device='cuda:3')
benign distance is  tensor(22.6898, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.3420705795288086
distance x is tensor(19.6672, device='cuda:3')
benign distance is  tensor(19.6672, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.2537243366241455
distance x is tensor(19.0842, device='cuda:3')
benign distance is  tensor(19.0842, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.3574883937835693
distance x is tensor(14.3721, device='cuda:3')
benign distance is  tensor(14.3721, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.313775062561035
distance x is tensor(19.5608, device='cuda:3')
benign distance is  tensor(19.5608, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.2732608318328857
distance x is tensor(16.4908, device='cuda:3')
benign distance is  tensor(16.4908, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.2991156578063965
distance x is tensor(20.5926, device='cuda:3')
benign distance is  tensor(20.5926, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.3478870391845703
distance x is tensor(11.2805, device='cuda:3')
benign distance is  tensor(11.2805, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(11.5588, device='cuda:3')
compute distance is  tensor(11.5588, device='cuda:3')
compute norm is  tensor(68.7259, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.2936, device='cuda:3')
compute distance is  tensor(13.2936, device='cuda:3')
compute norm is  tensor(68.6130, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.6812, device='cuda:3')
compute distance is  tensor(11.6812, device='cuda:3')
compute norm is  tensor(68.6800, device='cuda:3', dtype=torch.float64)
distance x is tensor(15.6918, device='cuda:3')
compute distance is  tensor(15.6918, device='cuda:3')
compute norm is  tensor(68.7402, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.9483, device='cuda:3')
compute distance is  tensor(8.9483, device='cuda:3')
compute norm is  tensor(68.6728, device='cuda:3', dtype=torch.float64)
distance x is tensor(12.0256, device='cuda:3')
compute distance is  tensor(12.0256, device='cuda:3')
compute norm is  tensor(68.6416, device='cuda:3', dtype=torch.float64)
distance x is tensor(12.0743, device='cuda:3')
compute distance is  tensor(12.0743, device='cuda:3')
compute norm is  tensor(68.6179, device='cuda:3', dtype=torch.float64)
distance x is tensor(12.7023, device='cuda:3')
compute distance is  tensor(12.7023, device='cuda:3')
compute norm is  tensor(68.6516, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.0152, device='cuda:3')
compute distance is  tensor(10.0152, device='cuda:3')
compute norm is  tensor(68.7102, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.5263, device='cuda:3')
compute distance is  tensor(13.5263, device='cuda:3')
compute norm is  tensor(68.6820, device='cuda:3', dtype=torch.float64)
distance x is tensor(15.6354, device='cuda:3')
compute distance is  tensor(15.6354, device='cuda:3')
compute norm is  tensor(68.6033, device='cuda:3', dtype=torch.float64)
distance x is tensor(30.5112, device='cuda:3')
compute distance is  tensor(30.5112, device='cuda:3')
compute norm is  tensor(68.7821, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(30.5112, device='cuda:3')
distance x is tensor(107496.3672, device='cuda:3')
distance x is tensor(107496.3672, device='cuda:3')
________________________________
test distance is  tensor(107496.3672, device='cuda:3')
test distance1 is  tensor(107496.3672, device='cuda:3')
test similarity is  tensor(0.6057, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129993115691003.64
test entropy is  0.0
________________________________
cal ratio is  0.016510459238375356
distance x is tensor(1774.8196, device='cuda:3')
cal_distance is  tensor(1774.8196, device='cuda:3')
cal ratio is  0.12849284101985564
distance x is tensor(228.0560, device='cuda:3')
cal_distance is  tensor(228.0560, device='cuda:3')
cal ratio is  0.3584555564329987
distance x is tensor(81.7512, device='cuda:3')
cal_distance is  tensor(81.7512, device='cuda:3')
cal ratio is  0.5986996389007244
distance x is tensor(48.9465, device='cuda:3')
cal_distance is  tensor(48.9465, device='cuda:3')
cal ratio is  0.7737404560800832
distance x is tensor(37.8731, device='cuda:3')
cal_distance is  tensor(37.8731, device='cuda:3')
cal ratio is  0.8796113604699283
distance x is tensor(33.3142, device='cuda:3')
cal_distance is  tensor(33.3142, device='cuda:3')
cal ratio is  0.9378670346154296
distance x is tensor(31.2446, device='cuda:3')
cal_distance is  tensor(31.2446, device='cuda:3')
cal ratio is  0.9684301551227661
distance x is tensor(30.2584, device='cuda:3')
cal_distance is  tensor(30.2584, device='cuda:3')
distance x is tensor(30.2584, device='cuda:3')
return_distance is  tensor(30.2584, device='cuda:3')
distance x is tensor(30.2485, device='cuda:3')
distance x is tensor(30.2485, device='cuda:3')
________________________________
test distance is  tensor(30.2485, device='cuda:3')
test distance1 is  tensor(30.2485, device='cuda:3')
test similarity is  tensor(0.9994, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.398047299781588
test entropy is  2.1683345344275047
________________________________
0
distance x is tensor(30.2485, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.168133933406903
avg test loss is  2.3971615114700056
avg accuracy is  0.11050000015633195
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(30.2485, device='cuda:3')
compute_norm is  tensor(70.0192, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(32.3874, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.869272529125722
avg test loss is  3.448543092335211
avg accuracy is  0.12523333348966526
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9990, device='cuda:3')
compute_distance is  tensor(32.3874, device='cuda:3')
compute_norm is  tensor(70.2858, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(34.3257, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4421372182333647
avg test loss is  2.6265717681282874
avg accuracy is  0.13535000015633192
solo acc is  0.1016833334896653
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(34.3257, device='cuda:3')
compute_norm is  tensor(69.6963, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(36.4321, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8240174055734931
avg test loss is  3.276309882654056
avg accuracy is  0.13028333348966525
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(36.4321, device='cuda:3')
compute_norm is  tensor(69.6450, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(39.1728, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3838137317059644
avg test loss is  2.440901197604279
avg accuracy is  0.14211666682299912
solo acc is  0.10515000015633197
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(39.1728, device='cuda:3')
compute_norm is  tensor(69.0796, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(41.1750, device='cuda:3')
distance x is tensor(41.1750, device='cuda:3')
________________________________
test distance is  tensor(41.1750, device='cuda:3')
test distance1 is  tensor(41.1750, device='cuda:3')
test similarity is  tensor(0.9985, device='cuda:3')
test acc is  0.10006666682299865
test loss is 3.125345347278408
test entropy is  0.8082402560121215
________________________________
cal ratio is  0.8436052685972374
distance x is tensor(34.7441, device='cuda:3')
cal_distance is  tensor(34.7441, device='cuda:3')
cal ratio is  0.9183650507327652
distance x is tensor(31.9082, device='cuda:3')
cal_distance is  tensor(31.9082, device='cuda:3')
cal ratio is  0.958307855828564
distance x is tensor(30.5781, device='cuda:3')
cal_distance is  tensor(30.5781, device='cuda:3')
cal ratio is  0.9789288585758549
distance x is tensor(29.9338, device='cuda:3')
cal_distance is  tensor(29.9338, device='cuda:3')
distance x is tensor(29.9338, device='cuda:3')
return_distance is  tensor(29.9338, device='cuda:3')
distance x is tensor(29.9244, device='cuda:3')
distance x is tensor(29.9244, device='cuda:3')
________________________________
test distance is  tensor(29.9244, device='cuda:3')
test distance1 is  tensor(29.9244, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8407969403622757
test entropy is  1.2848038506914559
________________________________
0
distance x is tensor(29.9244, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2859378563823984
avg test loss is  2.84082117619545
avg accuracy is  0.1282000001563319
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(29.9244, device='cuda:3')
compute_norm is  tensor(68.9490, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(33.1443, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7959798942369692
avg test loss is  3.1698340955319435
avg accuracy is  0.13223333348966523
solo acc is  0.10015000015633198
compute similarity  is  tensor(0.9989, device='cuda:3')
compute_distance is  tensor(33.1443, device='cuda:3')
compute_norm is  tensor(68.8352, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(36.6114, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3747121278665213
avg test loss is  2.3312158100386418
avg accuracy is  0.14850000015633302
solo acc is  0.10963333348966528
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(36.6114, device='cuda:3')
compute_norm is  tensor(68.3166, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(39.2464, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7979028264978039
avg test loss is  3.0428530384482606
avg accuracy is  0.13461666682299855
solo acc is  0.1003833334896653
compute similarity  is  tensor(0.9986, device='cuda:3')
compute_distance is  tensor(39.2464, device='cuda:3')
compute_norm is  tensor(68.2374, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(43.0821, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3231410121104357
avg test loss is  2.273928108500011
avg accuracy is  0.14565000015633278
solo acc is  0.11161666682299862
compute similarity  is  tensor(0.9985, device='cuda:3')
compute_distance is  tensor(43.0821, device='cuda:3')
compute_norm is  tensor(67.7966, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(45.9950, device='cuda:3')
distance x is tensor(45.9950, device='cuda:3')
________________________________
test distance is  tensor(45.9950, device='cuda:3')
test distance1 is  tensor(45.9950, device='cuda:3')
test similarity is  tensor(0.9982, device='cuda:3')
test acc is  0.10033333348966532
test loss is 2.964330138428125
test entropy is  0.7790806400242136
________________________________
cal ratio is  0.7981794104255411
distance x is tensor(36.7171, device='cuda:3')
cal_distance is  tensor(36.7171, device='cuda:3')
cal ratio is  0.8933502898427734
distance x is tensor(32.8015, device='cuda:3')
cal_distance is  tensor(32.8015, device='cuda:3')
cal ratio is  0.9451679944018022
distance x is tensor(31.0031, device='cuda:3')
cal_distance is  tensor(31.0031, device='cuda:3')
cal ratio is  0.9721952622341944
distance x is tensor(30.1411, device='cuda:3')
cal_distance is  tensor(30.1411, device='cuda:3')
distance x is tensor(30.1411, device='cuda:3')
return_distance is  tensor(30.1411, device='cuda:3')
distance x is tensor(30.1358, device='cuda:3')
distance x is tensor(30.1358, device='cuda:3')
________________________________
test distance is  tensor(30.1358, device='cuda:3')
test distance1 is  tensor(30.1358, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7841082348752377
test entropy is  1.3885470619842188
________________________________
0
distance x is tensor(30.1358, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3878895295962597
avg test loss is  2.782960257296369
avg accuracy is  0.12388333348966525
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(30.1358, device='cuda:3')
compute_norm is  tensor(68.0519, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(35.0518, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.788410276619356
avg test loss is  3.0439061399207694
avg accuracy is  0.13476666682299857
solo acc is  0.10040000015633196
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(35.0518, device='cuda:3')
compute_norm is  tensor(67.9690, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(40.1273, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.314267467461161
avg test loss is  2.253828971370705
avg accuracy is  0.1501000001563331
solo acc is  0.10895000015633195
compute similarity  is  tensor(0.9986, device='cuda:3')
compute_distance is  tensor(40.1273, device='cuda:3')
compute_norm is  tensor(67.5149, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(43.5977, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7828801094468977
avg test loss is  2.9272269740033505
avg accuracy is  0.13898333348966546
solo acc is  0.10055000015633196
compute similarity  is  tensor(0.9984, device='cuda:3')
compute_distance is  tensor(43.5977, device='cuda:3')
compute_norm is  tensor(67.4258, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(48.0200, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2786750625699823
avg test loss is  2.2002572839194015
avg accuracy is  0.15593333348966698
solo acc is  0.11056666682299862
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(48.0200, device='cuda:3')
compute_norm is  tensor(67.0054, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(51.4048, device='cuda:3')
________________________________
test distance is  tensor(51.4048, device='cuda:3')
test similarity is  tensor(0.9979, device='cuda:3')
test acc is  0.14613333348966615
test loss is 2.8896401820660653
test entropy is  0.7619978074453024
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.594468593597412
mal norm is  tensor(243.6655, device='cuda:3')
distance x is tensor(51.4048, device='cuda:3')
mal distance is  tensor(51.4048, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([122.7768, 299.5728, 276.5945, 186.1832, 161.7239, 147.0756, 155.8552,
        150.6499, 243.6655, 243.6655, 243.6655, 243.6655, 243.6655, 243.6655,
        243.6655, 243.6655, 243.6655, 243.6655, 243.6655, 243.6655, 142.9127,
        144.8614, 160.0091, 158.5399, 163.5784, 144.3912, 134.8023, 136.4574],
       device='cuda:3')
sorted_norm is   tensor([122.7768, 134.8023, 136.4574, 142.9127, 144.3912, 144.8614, 147.0756,
        150.6499, 155.8552, 158.5399, 160.0091, 161.7239, 163.5784, 186.1832,
        243.6655, 243.6655, 243.6655, 243.6655, 243.6655, 243.6655, 243.6655,
        243.6655, 243.6655, 243.6655, 243.6655, 243.6655, 276.5945, 299.5728],
       device='cuda:3')
used idx is  tensor([ 0, 26, 27, 20, 25, 21,  5,  7,  6, 23, 22,  4, 24,  3, 19, 18, 14, 15,
        11, 10, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.322244167327881
distance x is tensor(18.5595, device='cuda:3')
benign distance is  tensor(18.5595, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.709826111793518
distance x is tensor(45.3353, device='cuda:3')
benign distance is  tensor(45.3353, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.610369086265564
distance x is tensor(48.0020, device='cuda:3')
benign distance is  tensor(48.0020, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8223272562026978
distance x is tensor(38.0167, device='cuda:3')
benign distance is  tensor(38.0167, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3209846019744873
distance x is tensor(23.1978, device='cuda:3')
benign distance is  tensor(23.1978, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3361949920654297
distance x is tensor(20.6680, device='cuda:3')
benign distance is  tensor(20.6680, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3288521766662598
distance x is tensor(31.1183, device='cuda:3')
benign distance is  tensor(31.1183, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1802306175231934
distance x is tensor(46.7378, device='cuda:3')
benign distance is  tensor(46.7378, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.331455707550049
distance x is tensor(29.5054, device='cuda:3')
benign distance is  tensor(29.5054, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2844860553741455
distance x is tensor(25.6121, device='cuda:3')
benign distance is  tensor(25.6121, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.062405586242676
distance x is tensor(40.7553, device='cuda:3')
benign distance is  tensor(40.7553, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.9785255193710327
distance x is tensor(43.5895, device='cuda:3')
benign distance is  tensor(43.5895, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.8039085865020752
distance x is tensor(46.9694, device='cuda:3')
benign distance is  tensor(46.9694, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.0976057052612305
distance x is tensor(32.3301, device='cuda:3')
benign distance is  tensor(32.3301, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.2722606658935547
distance x is tensor(14.9301, device='cuda:3')
benign distance is  tensor(14.9301, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3193917274475098
distance x is tensor(17.9086, device='cuda:3')
benign distance is  tensor(17.9086, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(25.9748, device='cuda:3')
compute distance is  tensor(25.9748, device='cuda:3')
compute norm is  tensor(68.3160, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.8204, device='cuda:3')
compute distance is  tensor(13.8204, device='cuda:3')
compute norm is  tensor(68.2449, device='cuda:3', dtype=torch.float64)
distance x is tensor(21.9095, device='cuda:3')
compute distance is  tensor(21.9095, device='cuda:3')
compute norm is  tensor(68.3441, device='cuda:3', dtype=torch.float64)
distance x is tensor(12.5696, device='cuda:3')
compute distance is  tensor(12.5696, device='cuda:3')
compute norm is  tensor(68.2751, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.9920, device='cuda:3')
compute distance is  tensor(13.9920, device='cuda:3')
compute norm is  tensor(68.2576, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8256, device='cuda:3')
compute distance is  tensor(2.8256, device='cuda:3')
compute norm is  tensor(68.2199, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.9810, device='cuda:3')
compute distance is  tensor(13.9810, device='cuda:3')
compute norm is  tensor(68.3149, device='cuda:3', dtype=torch.float64)
distance x is tensor(26.2729, device='cuda:3')
compute distance is  tensor(26.2729, device='cuda:3')
compute norm is  tensor(68.3630, device='cuda:3', dtype=torch.float64)
distance x is tensor(14.1547, device='cuda:3')
compute distance is  tensor(14.1547, device='cuda:3')
compute norm is  tensor(68.2422, device='cuda:3', dtype=torch.float64)
distance x is tensor(21.1675, device='cuda:3')
compute distance is  tensor(21.1675, device='cuda:3')
compute norm is  tensor(68.1774, device='cuda:3', dtype=torch.float64)
distance x is tensor(45.4026, device='cuda:3')
compute distance is  tensor(45.4026, device='cuda:3')
compute norm is  tensor(68.7263, device='cuda:3', dtype=torch.float64)
distance x is tensor(18.2872, device='cuda:3')
compute distance is  tensor(18.2872, device='cuda:3')
compute norm is  tensor(68.3026, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(45.4026, device='cuda:3')
distance x is tensor(107492.7578, device='cuda:3')
distance x is tensor(107492.7578, device='cuda:3')
________________________________
test distance is  tensor(107492.7578, device='cuda:3')
test distance1 is  tensor(107492.7578, device='cuda:3')
test similarity is  tensor(0.6095, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130116160776886.31
test entropy is  0.0
________________________________
cal ratio is  0.020140812949723422
distance x is tensor(2164.9966, device='cuda:3')
cal_distance is  tensor(2164.9966, device='cuda:3')
cal ratio is  0.1419181631851891
distance x is tensor(307.2566, device='cuda:3')
cal_distance is  tensor(307.2566, device='cuda:3')
cal ratio is  0.3767176560062075
distance x is tensor(115.7521, device='cuda:3')
cal_distance is  tensor(115.7521, device='cuda:3')
cal ratio is  0.6137649610739228
distance x is tensor(71.0466, device='cuda:3')
cal_distance is  tensor(71.0466, device='cuda:3')
cal ratio is  0.7834206532362461
distance x is tensor(55.6605, device='cuda:3')
cal_distance is  tensor(55.6605, device='cuda:3')
cal ratio is  0.8851015441096659
distance x is tensor(49.2658, device='cuda:3')
cal_distance is  tensor(49.2658, device='cuda:3')
cal ratio is  0.9407926294753323
distance x is tensor(46.3492, device='cuda:3')
cal_distance is  tensor(46.3492, device='cuda:3')
cal ratio is  0.9699415519399152
distance x is tensor(44.9562, device='cuda:3')
cal_distance is  tensor(44.9562, device='cuda:3')
distance x is tensor(44.9562, device='cuda:3')
return_distance is  tensor(44.9562, device='cuda:3')
distance x is tensor(44.9462, device='cuda:3')
distance x is tensor(44.9462, device='cuda:3')
________________________________
test distance is  tensor(44.9462, device='cuda:3')
test distance1 is  tensor(44.9462, device='cuda:3')
test similarity is  tensor(0.9987, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.3968748929403993
test entropy is  2.1970150778288526
________________________________
0
distance x is tensor(44.9462, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.197060971371909
avg test loss is  2.3968922418317815
avg accuracy is  0.10350000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9987, device='cuda:3')
compute_distance is  tensor(44.9462, device='cuda:3')
compute_norm is  tensor(70.0604, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(46.4381, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8881400869345106
avg test loss is  3.566190003586222
avg accuracy is  0.1004833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(46.4381, device='cuda:3')
compute_norm is  tensor(70.3910, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(48.5359, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.385463345660838
avg test loss is  2.5267250438743054
avg accuracy is  0.14628333348966624
solo acc is  0.10360000015633197
compute similarity  is  tensor(0.9984, device='cuda:3')
compute_distance is  tensor(48.5359, device='cuda:3')
compute_norm is  tensor(69.7832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(50.1872, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8121869684790751
avg test loss is  3.1085373076802885
avg accuracy is  0.1432500001563326
solo acc is  0.10051666682299865
compute similarity  is  tensor(0.9981, device='cuda:3')
compute_distance is  tensor(50.1872, device='cuda:3')
compute_norm is  tensor(69.7256, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(52.0218, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.30406009667972
avg test loss is  2.281601048354655
avg accuracy is  0.14895000015633306
solo acc is  0.11233333348966527
compute similarity  is  tensor(0.9981, device='cuda:3')
compute_distance is  tensor(52.0218, device='cuda:3')
compute_norm is  tensor(69.2348, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(53.4599, device='cuda:3')
distance x is tensor(53.4599, device='cuda:3')
________________________________
test distance is  tensor(53.4599, device='cuda:3')
test distance1 is  tensor(53.4599, device='cuda:3')
test similarity is  tensor(0.9979, device='cuda:3')
test acc is  0.10060000015633198
test loss is 2.974287259553287
test entropy is  0.7679750540617433
________________________________
cal ratio is  0.9031347970266143
distance x is tensor(48.2910, device='cuda:3')
cal_distance is  tensor(48.2910, device='cuda:3')
cal ratio is  0.9502405884418923
distance x is tensor(45.8883, device='cuda:3')
cal_distance is  tensor(45.8883, device='cuda:3')
cal ratio is  0.974800222078986
distance x is tensor(44.7321, device='cuda:3')
cal_distance is  tensor(44.7321, device='cuda:3')
distance x is tensor(44.7321, device='cuda:3')
return_distance is  tensor(44.7321, device='cuda:3')
distance x is tensor(44.7221, device='cuda:3')
distance x is tensor(44.7221, device='cuda:3')
________________________________
test distance is  tensor(44.7221, device='cuda:3')
test distance1 is  tensor(44.7221, device='cuda:3')
test similarity is  tensor(0.9985, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7427794818939177
test entropy is  1.1427809405428515
________________________________
0
distance x is tensor(44.7221, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1419887097913828
avg test loss is  2.7455589532343816
avg accuracy is  0.13365000015633188
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9985, device='cuda:3')
compute_distance is  tensor(44.7221, device='cuda:3')
compute_norm is  tensor(68.9979, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(46.8732, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7618497845841877
avg test loss is  2.983032064397198
avg accuracy is  0.14266666682299917
solo acc is  0.1006333334896653
compute similarity  is  tensor(0.9983, device='cuda:3')
compute_distance is  tensor(46.8732, device='cuda:3')
compute_norm is  tensor(68.8412, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(49.3583, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2820840861751581
avg test loss is  2.1891769441460243
avg accuracy is  0.1640333334896676
solo acc is  0.11421666682299861
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(49.3583, device='cuda:3')
compute_norm is  tensor(68.3872, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(51.1530, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7659151419393544
avg test loss is  2.8863972143323693
avg accuracy is  0.15478333348966686
solo acc is  0.10065000015633196
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(51.1530, device='cuda:3')
compute_norm is  tensor(68.3000, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(53.8508, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2415270052993221
avg test loss is  2.154743030381355
avg accuracy is  0.16730000015633442
solo acc is  0.11573333348966527
compute similarity  is  tensor(0.9979, device='cuda:3')
compute_distance is  tensor(53.8508, device='cuda:3')
compute_norm is  tensor(67.8747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(55.9365, device='cuda:3')
distance x is tensor(55.9365, device='cuda:3')
________________________________
test distance is  tensor(55.9365, device='cuda:3')
test distance1 is  tensor(55.9365, device='cuda:3')
test similarity is  tensor(0.9977, device='cuda:3')
test acc is  0.1007833334896653
test loss is 2.827430411188333
test entropy is  0.7557309883108525
________________________________
cal ratio is  0.8829148191048946
distance x is tensor(49.3951, device='cuda:3')
cal_distance is  tensor(49.3951, device='cuda:3')
cal ratio is  0.9395605555661231
distance x is tensor(46.4099, device='cuda:3')
cal_distance is  tensor(46.4099, device='cuda:3')
cal ratio is  0.9693067204170706
distance x is tensor(44.9856, device='cuda:3')
cal_distance is  tensor(44.9856, device='cuda:3')
distance x is tensor(44.9856, device='cuda:3')
return_distance is  tensor(44.9856, device='cuda:3')
distance x is tensor(44.9772, device='cuda:3')
distance x is tensor(44.9772, device='cuda:3')
________________________________
test distance is  tensor(44.9772, device='cuda:3')
test distance1 is  tensor(44.9772, device='cuda:3')
test similarity is  tensor(0.9985, device='cuda:3')
test acc is  0.10003333348966531
test loss is 2.636813192987747
test entropy is  1.2015001754770909
________________________________
0
distance x is tensor(44.9772, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2023635640073178
avg test loss is  2.6371004116306427
avg accuracy is  0.1419666668229991
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9985, device='cuda:3')
compute_distance is  tensor(44.9772, device='cuda:3')
compute_norm is  tensor(67.8302, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(48.1293, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7462341974793213
avg test loss is  2.866634869117981
avg accuracy is  0.15401666682300016
solo acc is  0.10050000015633198
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(48.1293, device='cuda:3')
compute_norm is  tensor(67.6723, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(52.4661, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2068875527331062
avg test loss is  1.9996066503941632
avg accuracy is  0.16510000015633428
solo acc is  0.1431333334896659
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(52.4661, device='cuda:3')
compute_norm is  tensor(67.2646, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(55.0874, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7158881764549182
avg test loss is  2.7366862215721275
avg accuracy is  0.15601666682300028
solo acc is  0.1017333334896653
compute similarity  is  tensor(0.9978, device='cuda:3')
compute_distance is  tensor(55.0874, device='cuda:3')
compute_norm is  tensor(67.0898, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(59.5197, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.1552262463803484
avg test loss is  1.9012998164589725
avg accuracy is  0.16755000015633442
solo acc is  0.15765000015633374
compute similarity  is  tensor(0.9976, device='cuda:3')
compute_distance is  tensor(59.5197, device='cuda:3')
compute_norm is  tensor(66.6965, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(62.4488, device='cuda:3')
________________________________
test distance is  tensor(62.4488, device='cuda:3')
test similarity is  tensor(0.9974, device='cuda:3')
test acc is  0.14995000015633314
test loss is 2.6435596414212226
test entropy is  0.6926437516583562
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.292919635772705
mal norm is  tensor(260.0836, device='cuda:3')
distance x is tensor(62.4488, device='cuda:3')
mal distance is  tensor(62.4488, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([190.6439, 358.8495, 371.9318, 303.9261, 214.0781, 239.5944, 260.3064,
        357.0435, 260.0836, 260.0836, 260.0836, 260.0836, 260.0836, 260.0836,
        260.0836, 260.0836, 260.0836, 260.0836, 260.0836, 260.0836, 190.9636,
        176.2790, 183.2783, 178.2294, 158.7839, 119.0912, 158.1688, 308.6976],
       device='cuda:3')
sorted_norm is   tensor([119.0912, 158.1688, 158.7839, 176.2790, 178.2294, 183.2783, 190.6439,
        190.9636, 214.0781, 239.5944, 260.0836, 260.0836, 260.0836, 260.0836,
        260.0836, 260.0836, 260.0836, 260.0836, 260.0836, 260.0836, 260.0836,
        260.0836, 260.3064, 303.9261, 308.6976, 357.0435, 358.8495, 371.9318],
       device='cuda:3')
used idx is  tensor([25, 26, 24, 21, 23, 22,  0, 20,  4,  5, 19,  9, 15, 11, 13, 17, 10, 18,
        16, 12,  8, 14], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.765883445739746
distance x is tensor(60.2184, device='cuda:3')
benign distance is  tensor(60.2184, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3109257221221924
distance x is tensor(28.2491, device='cuda:3')
benign distance is  tensor(28.2491, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3137929439544678
distance x is tensor(2.3393, device='cuda:3')
benign distance is  tensor(2.3393, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9637531042099
distance x is tensor(55.4934, device='cuda:3')
benign distance is  tensor(55.4934, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3358685970306396
distance x is tensor(30.4167, device='cuda:3')
benign distance is  tensor(30.4167, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.331096649169922
distance x is tensor(2.6891, device='cuda:3')
benign distance is  tensor(2.6891, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3127501010894775
distance x is tensor(2.3203, device='cuda:3')
benign distance is  tensor(2.3203, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6221259832382202
distance x is tensor(54.1832, device='cuda:3')
benign distance is  tensor(54.1832, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.0955471992492676
distance x is tensor(38.0878, device='cuda:3')
benign distance is  tensor(38.0878, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9596176147460938
distance x is tensor(61.7514, device='cuda:3')
benign distance is  tensor(61.7514, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2643611431121826
distance x is tensor(27.1684, device='cuda:3')
benign distance is  tensor(27.1684, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.276526927947998
distance x is tensor(28.4087, device='cuda:3')
benign distance is  tensor(28.4087, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.31143856048584
distance x is tensor(38.8910, device='cuda:3')
benign distance is  tensor(38.8910, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.468681812286377
distance x is tensor(15.6741, device='cuda:3')
benign distance is  tensor(15.6741, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.1519522666931152
distance x is tensor(50.1560, device='cuda:3')
benign distance is  tensor(50.1560, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.4539732933044434
distance x is tensor(42.7276, device='cuda:3')
benign distance is  tensor(42.7276, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(2.6006, device='cuda:3')
compute distance is  tensor(2.6006, device='cuda:3')
compute norm is  tensor(66.7577, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2411, device='cuda:3')
compute distance is  tensor(2.2411, device='cuda:3')
compute norm is  tensor(66.7248, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1155, device='cuda:3')
compute distance is  tensor(2.1155, device='cuda:3')
compute norm is  tensor(66.7468, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5802, device='cuda:3')
compute distance is  tensor(2.5802, device='cuda:3')
compute norm is  tensor(66.7591, device='cuda:3', dtype=torch.float64)
distance x is tensor(29.0519, device='cuda:3')
compute distance is  tensor(29.0519, device='cuda:3')
compute norm is  tensor(66.9394, device='cuda:3', dtype=torch.float64)
distance x is tensor(23.9017, device='cuda:3')
compute distance is  tensor(23.9017, device='cuda:3')
compute norm is  tensor(66.8364, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4197, device='cuda:3')
compute distance is  tensor(2.4197, device='cuda:3')
compute norm is  tensor(66.7190, device='cuda:3', dtype=torch.float64)
distance x is tensor(61.7061, device='cuda:3')
compute distance is  tensor(61.7061, device='cuda:3')
compute norm is  tensor(67.1383, device='cuda:3', dtype=torch.float64)
distance x is tensor(84.9156, device='cuda:3')
compute distance is  tensor(84.9156, device='cuda:3')
compute norm is  tensor(67.7994, device='cuda:3', dtype=torch.float64)
distance x is tensor(39.6196, device='cuda:3')
compute distance is  tensor(39.6196, device='cuda:3')
compute norm is  tensor(67.2197, device='cuda:3', dtype=torch.float64)
distance x is tensor(57.2306, device='cuda:3')
compute distance is  tensor(57.2306, device='cuda:3')
compute norm is  tensor(67.5689, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4698, device='cuda:3')
compute distance is  tensor(2.4698, device='cuda:3')
compute norm is  tensor(66.7223, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(84.9156, device='cuda:3')
distance x is tensor(107478.9297, device='cuda:3')
distance x is tensor(107478.9297, device='cuda:3')
________________________________
test distance is  tensor(107478.9297, device='cuda:3')
test distance1 is  tensor(107478.9297, device='cuda:3')
test similarity is  tensor(0.6231, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130144350309517.92
test entropy is  0.0
________________________________
cal ratio is  0.02754596818414802
distance x is tensor(2960.6165, device='cuda:3')
cal_distance is  tensor(2960.6165, device='cuda:3')
cal ratio is  0.16596963577334015
distance x is tensor(491.3766, device='cuda:3')
cal_distance is  tensor(491.3766, device='cuda:3')
cal ratio is  0.4073919677510341
distance x is tensor(200.1858, device='cuda:3')
cal_distance is  tensor(200.1858, device='cuda:3')
cal ratio is  0.638267941292976
distance x is tensor(127.7740, device='cuda:3')
cal_distance is  tensor(127.7740, device='cuda:3')
cal ratio is  0.7989109992056413
distance x is tensor(102.0811, device='cuda:3')
cal_distance is  tensor(102.0811, device='cuda:3')
cal ratio is  0.8938138075906279
distance x is tensor(91.2420, device='cuda:3')
cal_distance is  tensor(91.2420, device='cuda:3')
cal ratio is  0.945414402133678
distance x is tensor(86.2618, device='cuda:3')
cal_distance is  tensor(86.2618, device='cuda:3')
cal ratio is  0.9723226145452227
distance x is tensor(83.8745, device='cuda:3')
cal_distance is  tensor(83.8745, device='cuda:3')
distance x is tensor(83.8745, device='cuda:3')
return_distance is  tensor(83.8745, device='cuda:3')
distance x is tensor(83.8645, device='cuda:3')
distance x is tensor(83.8645, device='cuda:3')
________________________________
test distance is  tensor(83.8645, device='cuda:3')
test distance1 is  tensor(83.8645, device='cuda:3')
test similarity is  tensor(0.9957, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.50716034054502
test entropy is  2.0231208280205473
________________________________
0
distance x is tensor(83.8645, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.023169297018031
avg test loss is  2.5064869765788
avg accuracy is  0.10675000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9957, device='cuda:3')
compute_distance is  tensor(83.8645, device='cuda:3')
compute_norm is  tensor(70.2910, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(86.9126, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7512265878445559
avg test loss is  2.915568259733318
avg accuracy is  0.16930000015633453
solo acc is  0.1019333334896653
compute similarity  is  tensor(0.9954, device='cuda:3')
compute_distance is  tensor(86.9126, device='cuda:3')
compute_norm is  tensor(70.3773, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(88.8724, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1552084127723028
avg test loss is  1.9190100031112558
avg accuracy is  0.20193333348966974
solo acc is  0.16666666682300113
compute similarity  is  tensor(0.9953, device='cuda:3')
compute_distance is  tensor(88.8724, device='cuda:3')
compute_norm is  tensor(69.9837, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(89.1492, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6959375688262077
avg test loss is  2.662559397439204
avg accuracy is  0.18900000015633567
solo acc is  0.10170000015633197
compute similarity  is  tensor(0.9952, device='cuda:3')
compute_distance is  tensor(89.1492, device='cuda:3')
compute_norm is  tensor(69.7852, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(91.2032, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0750544859148037
avg test loss is  1.828281454948474
avg accuracy is  0.2147833334896703
solo acc is  0.1800000001563353
compute similarity  is  tensor(0.9950, device='cuda:3')
compute_distance is  tensor(91.2032, device='cuda:3')
compute_norm is  tensor(69.3959, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(91.8835, device='cuda:3')
distance x is tensor(91.8835, device='cuda:3')
________________________________
test distance is  tensor(91.8835, device='cuda:3')
test distance1 is  tensor(91.8835, device='cuda:3')
test similarity is  tensor(0.9949, device='cuda:3')
test acc is  0.1019833334896653
test loss is 2.556909497867007
test entropy is  0.674368955814508
________________________________
cal ratio is  0.942108557435271
distance x is tensor(86.5741, device='cuda:3')
cal_distance is  tensor(86.5741, device='cuda:3')
cal ratio is  0.9705675930774148
distance x is tensor(84.0261, device='cuda:3')
cal_distance is  tensor(84.0261, device='cuda:3')
distance x is tensor(84.0261, device='cuda:3')
return_distance is  tensor(84.0261, device='cuda:3')
distance x is tensor(84.0160, device='cuda:3')
distance x is tensor(84.0160, device='cuda:3')
________________________________
test distance is  tensor(84.0160, device='cuda:3')
test distance1 is  tensor(84.0160, device='cuda:3')
test similarity is  tensor(0.9957, device='cuda:3')
test acc is  0.10065000015633196
test loss is 2.340423789486956
test entropy is  0.9401351927058783
________________________________
0
distance x is tensor(84.0160, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9417631120951191
avg test loss is  2.336997028098686
avg accuracy is  0.17973333348966852
solo acc is  0.10068333348966531
compute similarity  is  tensor(0.9957, device='cuda:3')
compute_distance is  tensor(84.0160, device='cuda:3')
compute_norm is  tensor(68.9797, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(86.6735, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0363049774663027
avg test loss is  1.7870410389737534
avg accuracy is  0.22623333348967076
solo acc is  0.1777833334896685
compute similarity  is  tensor(0.9954, device='cuda:3')
compute_distance is  tensor(86.6735, device='cuda:3')
compute_norm is  tensor(68.6134, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(87.5983, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6478577124030351
avg test loss is  2.5168254746557044
avg accuracy is  0.19466666682300268
solo acc is  0.10236666682299864
compute similarity  is  tensor(0.9953, device='cuda:3')
compute_distance is  tensor(87.5983, device='cuda:3')
compute_norm is  tensor(68.3989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(89.9187, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9954786293669295
avg test loss is  1.7332208565811613
avg accuracy is  0.23278333348967098
solo acc is  0.18800000015633575
compute similarity  is  tensor(0.9950, device='cuda:3')
compute_distance is  tensor(89.9187, device='cuda:3')
compute_norm is  tensor(68.0216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(89.9187, device='cuda:3')
distance x is tensor(89.9187, device='cuda:3')
________________________________
test distance is  tensor(89.9187, device='cuda:3')
test distance1 is  tensor(89.9187, device='cuda:3')
test similarity is  tensor(0.9950, device='cuda:3')
test acc is  0.18521666682300222
test loss is 1.7373393846473206
test entropy is  0.9955935653592987
________________________________
cal ratio is  0.9523459095230214
distance x is tensor(85.6433, device='cuda:3')
cal_distance is  tensor(85.6433, device='cuda:3')
cal ratio is  0.9758273826548531
distance x is tensor(83.5732, device='cuda:3')
cal_distance is  tensor(83.5732, device='cuda:3')
distance x is tensor(83.5732, device='cuda:3')
return_distance is  tensor(83.5732, device='cuda:3')
distance x is tensor(83.5634, device='cuda:3')
distance x is tensor(83.5634, device='cuda:3')
________________________________
test distance is  tensor(83.5634, device='cuda:3')
test distance1 is  tensor(83.5634, device='cuda:3')
test similarity is  tensor(0.9957, device='cuda:3')
test acc is  0.15085000015633324
test loss is 1.7555283196191036
test entropy is  1.1838120570314972
________________________________
0
distance x is tensor(83.5634, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1841972434698647
avg test loss is  1.7639568455692038
avg accuracy is  0.20793333348966994
solo acc is  0.14966666682299984
compute similarity  is  tensor(0.9957, device='cuda:3')
compute_distance is  tensor(83.5634, device='cuda:3')
compute_norm is  tensor(67.9346, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(84.9109, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6415082785620618
avg test loss is  2.478761276202415
avg accuracy is  0.19608333348966936
solo acc is  0.10160000015633197
compute similarity  is  tensor(0.9955, device='cuda:3')
compute_distance is  tensor(84.9109, device='cuda:3')
compute_norm is  tensor(67.7222, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(87.5615, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9446113715166731
avg test loss is  1.7281415262964488
avg accuracy is  0.2388166668230045
solo acc is  0.19170000015633593
compute similarity  is  tensor(0.9952, device='cuda:3')
compute_distance is  tensor(87.5615, device='cuda:3')
compute_norm is  tensor(67.3588, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(87.5711, device='cuda:3')
________________________________
test distance is  tensor(87.5711, device='cuda:3')
test similarity is  tensor(0.9952, device='cuda:3')
test acc is  0.23850000015633782
test loss is 1.7231463503990092
test entropy is  0.9449304218993766
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3809906244277954
mal norm is  tensor(343.2194, device='cuda:3')
distance x is tensor(87.5711, device='cuda:3')
mal distance is  tensor(87.5711, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([499.2977, 261.4917, 107.1779, 422.9697, 274.1942, 117.2871, 111.4606,
        406.5670, 343.2194, 343.2194, 343.2194, 343.2194, 343.2194, 343.2194,
        343.2194, 343.2194, 343.2194, 343.2194, 343.2194, 343.2194, 263.2024,
        267.7892, 270.0351, 269.7362, 262.6902, 264.3787, 282.7897, 259.2415],
       device='cuda:3')
sorted_norm is   tensor([107.1779, 111.4606, 117.2871, 259.2415, 261.4917, 262.6902, 263.2024,
        264.3787, 267.7892, 269.7362, 270.0351, 274.1942, 282.7897, 343.2194,
        343.2194, 343.2194, 343.2194, 343.2194, 343.2194, 343.2194, 343.2194,
        343.2194, 343.2194, 343.2194, 343.2194, 406.5670, 422.9697, 499.2977],
       device='cuda:3')
used idx is  tensor([ 2,  6,  5, 27,  1, 24, 20, 25, 21, 23, 22,  4, 26, 19, 16, 18, 14, 12,
        15, 11, 13, 10], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3272156715393066
distance x is tensor(1.6414, device='cuda:3')
benign distance is  tensor(1.6414, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2909061908721924
distance x is tensor(27.0041, device='cuda:3')
benign distance is  tensor(27.0041, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3012218475341797
distance x is tensor(7.1302, device='cuda:3')
benign distance is  tensor(7.1302, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.284520387649536
distance x is tensor(5.2201, device='cuda:3')
benign distance is  tensor(5.2201, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.294018268585205
distance x is tensor(36.5712, device='cuda:3')
benign distance is  tensor(36.5712, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3270487785339355
distance x is tensor(2.0977, device='cuda:3')
benign distance is  tensor(2.0977, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.277945041656494
distance x is tensor(1.6503, device='cuda:3')
benign distance is  tensor(1.6503, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.299133062362671
distance x is tensor(10.0477, device='cuda:3')
benign distance is  tensor(10.0477, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.3163747787475586
distance x is tensor(2.3561, device='cuda:3')
benign distance is  tensor(2.3561, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2972829341888428
distance x is tensor(1.5669, device='cuda:3')
benign distance is  tensor(1.5669, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.3746652603149414
distance x is tensor(6.9106, device='cuda:3')
benign distance is  tensor(6.9106, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.3061118125915527
distance x is tensor(29.6049, device='cuda:3')
benign distance is  tensor(29.6049, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.2762839794158936
distance x is tensor(2.4529, device='cuda:3')
benign distance is  tensor(2.4529, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.293710708618164
distance x is tensor(1.7392, device='cuda:3')
benign distance is  tensor(1.7392, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.3166134357452393
distance x is tensor(1.7941, device='cuda:3')
benign distance is  tensor(1.7941, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.291788339614868
distance x is tensor(5.1101, device='cuda:3')
benign distance is  tensor(5.1101, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(2.5751, device='cuda:3')
compute distance is  tensor(2.5751, device='cuda:3')
compute norm is  tensor(67.8662, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7753, device='cuda:3')
compute distance is  tensor(1.7753, device='cuda:3')
compute norm is  tensor(67.8648, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3233, device='cuda:3')
compute distance is  tensor(2.3233, device='cuda:3')
compute norm is  tensor(67.9283, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.9533, device='cuda:3')
compute distance is  tensor(1.9533, device='cuda:3')
compute norm is  tensor(67.9214, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.6274, device='cuda:3')
compute distance is  tensor(2.6274, device='cuda:3')
compute norm is  tensor(67.8862, device='cuda:3', dtype=torch.float64)
distance x is tensor(27.7357, device='cuda:3')
compute distance is  tensor(27.7357, device='cuda:3')
compute norm is  tensor(67.9736, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.8446, device='cuda:3')
compute distance is  tensor(1.8446, device='cuda:3')
compute norm is  tensor(67.8517, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.6566, device='cuda:3')
compute distance is  tensor(3.6566, device='cuda:3')
compute norm is  tensor(67.9288, device='cuda:3', dtype=torch.float64)
distance x is tensor(19.4966, device='cuda:3')
compute distance is  tensor(19.4966, device='cuda:3')
compute norm is  tensor(68.0192, device='cuda:3', dtype=torch.float64)
distance x is tensor(5.9511, device='cuda:3')
compute distance is  tensor(5.9511, device='cuda:3')
compute norm is  tensor(67.8940, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4286, device='cuda:3')
compute distance is  tensor(2.4286, device='cuda:3')
compute norm is  tensor(67.8687, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7733, device='cuda:3')
compute distance is  tensor(1.7733, device='cuda:3')
compute norm is  tensor(67.7968, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(27.7357, device='cuda:3')
distance x is tensor(107458.8125, device='cuda:3')
distance x is tensor(107458.8125, device='cuda:3')
________________________________
test distance is  tensor(107458.8125, device='cuda:3')
test distance1 is  tensor(107458.8125, device='cuda:3')
test similarity is  tensor(0.6415, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130113255966488.56
test entropy is  0.0
________________________________
cal ratio is  0.015744345833677707
distance x is tensor(1691.8740, device='cuda:3')
cal_distance is  tensor(1691.8740, device='cuda:3')
cal ratio is  0.12547628139609007
distance x is tensor(212.2944, device='cuda:3')
cal_distance is  tensor(212.2944, device='cuda:3')
cal ratio is  0.3542226862594049
distance x is tensor(75.2028, device='cuda:3')
cal_distance is  tensor(75.2028, device='cuda:3')
cal ratio is  0.5951530511439118
distance x is tensor(44.7593, device='cuda:3')
cal_distance is  tensor(44.7593, device='cuda:3')
cal ratio is  0.7714435102316259
distance x is tensor(34.5305, device='cuda:3')
cal_distance is  tensor(34.5305, device='cuda:3')
cal ratio is  0.8783032744462038
distance x is tensor(30.3289, device='cuda:3')
cal_distance is  tensor(30.3289, device='cuda:3')
cal ratio is  0.9371682093264045
distance x is tensor(28.4236, device='cuda:3')
cal_distance is  tensor(28.4236, device='cuda:3')
cal ratio is  0.9680687457660261
distance x is tensor(27.5162, device='cuda:3')
cal_distance is  tensor(27.5162, device='cuda:3')
distance x is tensor(27.5162, device='cuda:3')
return_distance is  tensor(27.5162, device='cuda:3')
distance x is tensor(27.5062, device='cuda:3')
distance x is tensor(27.5062, device='cuda:3')
________________________________
test distance is  tensor(27.5062, device='cuda:3')
test distance1 is  tensor(27.5062, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.3845559165421832
test entropy is  2.2084331453990327
________________________________
0
distance x is tensor(27.5062, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2084648626953807
avg test loss is  2.3846698407171125
avg accuracy is  0.1008333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(27.5062, device='cuda:3')
compute_norm is  tensor(69.0934, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.0559, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8928434283875707
avg test loss is  3.558474746594297
avg accuracy is  0.10030000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(29.0559, device='cuda:3')
compute_norm is  tensor(69.4707, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(28.9014, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.569895710009756
avg test loss is  2.845982447616073
avg accuracy is  0.10046666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(28.9014, device='cuda:3')
compute_norm is  tensor(68.8805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(30.4156, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8567881561926941
avg test loss is  3.588296946177859
avg accuracy is  0.10043333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9990, device='cuda:3')
compute_distance is  tensor(30.4156, device='cuda:3')
compute_norm is  tensor(68.9150, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(30.7906, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5665370651653834
avg test loss is  2.8480645547797687
avg accuracy is  0.1004833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(30.7906, device='cuda:3')
compute_norm is  tensor(68.2937, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(32.6639, device='cuda:3')
distance x is tensor(32.6639, device='cuda:3')
________________________________
test distance is  tensor(32.6639, device='cuda:3')
test distance1 is  tensor(32.6639, device='cuda:3')
test similarity is  tensor(0.9990, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5856896275396286
test entropy is  0.8558975562993397
________________________________
cal ratio is  0.9030499852451411
distance x is tensor(29.5065, device='cuda:3')
cal_distance is  tensor(29.5065, device='cuda:3')
cal ratio is  0.9501389549173068
distance x is tensor(28.0355, device='cuda:3')
cal_distance is  tensor(28.0355, device='cuda:3')
cal ratio is  0.974746488013524
distance x is tensor(27.3276, device='cuda:3')
cal_distance is  tensor(27.3276, device='cuda:3')
distance x is tensor(27.3276, device='cuda:3')
return_distance is  tensor(27.3276, device='cuda:3')
distance x is tensor(27.3178, device='cuda:3')
distance x is tensor(27.3178, device='cuda:3')
________________________________
test distance is  tensor(27.3178, device='cuda:3')
test distance1 is  tensor(27.3178, device='cuda:3')
test similarity is  tensor(0.9993, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.250991696487866
test entropy is  1.1339462789645327
________________________________
0
distance x is tensor(27.3178, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1338288448512681
avg test loss is  3.2506483666169874
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(27.3178, device='cuda:3')
compute_norm is  tensor(68.2485, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.0652, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8396046234727669
avg test loss is  3.6109056734581237
avg accuracy is  0.10040000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(29.0652, device='cuda:3')
compute_norm is  tensor(68.1018, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(30.0736, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5639929700253614
avg test loss is  2.8494975693952806
avg accuracy is  0.10040000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(30.0736, device='cuda:3')
compute_norm is  tensor(67.4746, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(32.6534, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8554637859116739
avg test loss is  3.5859799842590463
avg accuracy is  0.1003833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(32.6534, device='cuda:3')
compute_norm is  tensor(67.5098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(34.2764, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5638023724179786
avg test loss is  2.8483181299685416
avg accuracy is  0.10043333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(34.2764, device='cuda:3')
compute_norm is  tensor(66.8876, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(37.4816, device='cuda:3')
distance x is tensor(37.4816, device='cuda:3')
________________________________
test distance is  tensor(37.4816, device='cuda:3')
test distance1 is  tensor(37.4816, device='cuda:3')
test similarity is  tensor(0.9990, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5821230187853264
test entropy is  0.8559444345263784
________________________________
cal ratio is  0.8430177300111406
distance x is tensor(31.6024, device='cuda:3')
cal_distance is  tensor(31.6024, device='cuda:3')
cal ratio is  0.918090152936119
distance x is tensor(29.0141, device='cuda:3')
cal_distance is  tensor(29.0141, device='cuda:3')
cal ratio is  0.9581666324227522
distance x is tensor(27.8005, device='cuda:3')
cal_distance is  tensor(27.8005, device='cuda:3')
cal ratio is  0.978857953292041
distance x is tensor(27.2128, device='cuda:3')
cal_distance is  tensor(27.2128, device='cuda:3')
distance x is tensor(27.2128, device='cuda:3')
return_distance is  tensor(27.2128, device='cuda:3')
distance x is tensor(27.2075, device='cuda:3')
distance x is tensor(27.2075, device='cuda:3')
________________________________
test distance is  tensor(27.2075, device='cuda:3')
test distance1 is  tensor(27.2075, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.052557140525216
test entropy is  1.3331900423269536
________________________________
0
distance x is tensor(27.2075, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3314707421544771
avg test loss is  3.0552602833522156
avg accuracy is  0.10045000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(27.2075, device='cuda:3')
compute_norm is  tensor(67.1852, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(30.6059, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8471242986254092
avg test loss is  3.5979979045863852
avg accuracy is  0.10040000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(30.6059, device='cuda:3')
compute_norm is  tensor(67.1291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(33.0720, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5611722523978016
avg test loss is  2.850908467764539
avg accuracy is  0.10051666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(33.0720, device='cuda:3')
compute_norm is  tensor(66.5121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(36.9053, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8534719132538289
avg test loss is  3.5865212084133744
avg accuracy is  0.1003833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(36.9053, device='cuda:3')
compute_norm is  tensor(66.5519, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(39.5363, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.561985770141138
avg test loss is  2.849358057416578
avg accuracy is  0.10045000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(39.5363, device='cuda:3')
compute_norm is  tensor(65.9340, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(43.4494, device='cuda:3')
________________________________
test distance is  tensor(43.4494, device='cuda:3')
test similarity is  tensor(0.9991, device='cuda:3')
test acc is  0.1004833334896653
test loss is 3.5822195208657273
test entropy is  0.8539837483149856
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5763096809387207
mal norm is  tensor(187.7509, device='cuda:3')
distance x is tensor(43.4494, device='cuda:3')
mal distance is  tensor(43.4494, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 77.5572, 233.5448, 102.8019,  82.9216, 336.9396,  84.0171,  78.1538,
        120.0232, 187.7509, 187.7509, 187.7509, 187.7509, 187.7509, 187.7509,
        187.7509, 187.7509, 187.7509, 187.7509, 187.7509, 187.7509, 254.1989,
        300.5533, 250.7191, 252.9012, 250.9887, 296.0555, 249.5799, 260.4578,
        277.0088, 273.9671, 262.3666, 259.5105, 272.9329, 251.3414, 280.5505,
        240.6983, 317.9166, 282.3348, 368.5381, 373.0284, 381.1458, 321.0892,
        227.6499, 244.7472, 343.1966, 488.4466, 277.2603, 291.8704, 344.6802,
        192.7465, 421.3736, 375.8187], device='cuda:3')
sorted_norm is   tensor([ 77.5572,  78.1538,  82.9216,  84.0171, 102.8019, 120.0232, 187.7509,
        187.7509, 187.7509, 187.7509, 187.7509, 187.7509, 187.7509, 187.7509,
        187.7509, 187.7509, 187.7509, 187.7509, 192.7465, 227.6499, 233.5448,
        240.6983, 244.7472, 249.5799, 250.7191, 250.9887, 251.3414, 252.9012,
        254.1989, 259.5105, 260.4578, 262.3666, 272.9329, 273.9671, 277.0088,
        277.2603, 280.5505, 282.3348, 291.8704, 296.0555, 300.5533, 317.9166,
        321.0892, 336.9396, 343.1966, 344.6802, 368.5381, 373.0284, 375.8187,
        381.1458, 421.3736, 488.4466], device='cuda:3')
used idx is  tensor([ 0,  6,  3,  5,  2,  7, 14, 15,  8,  9, 16, 17, 13, 12, 19, 18, 11, 10,
        49, 42,  1, 35, 43, 26, 22, 24, 33, 23, 20, 31, 27, 30, 32, 29, 28, 46,
        34, 37, 47, 25, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3073508739471436
distance x is tensor(1.3123, device='cuda:3')
benign distance is  tensor(1.3123, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3077173233032227
distance x is tensor(8.1447, device='cuda:3')
benign distance is  tensor(8.1447, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2870049476623535
distance x is tensor(1.4666, device='cuda:3')
benign distance is  tensor(1.4666, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3170506954193115
distance x is tensor(3.5918, device='cuda:3')
benign distance is  tensor(3.5918, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.287569522857666
distance x is tensor(1.8041, device='cuda:3')
benign distance is  tensor(1.8041, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2958688735961914
distance x is tensor(3.7138, device='cuda:3')
benign distance is  tensor(3.7138, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2979378700256348
distance x is tensor(1.4437, device='cuda:3')
benign distance is  tensor(1.4437, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2414424419403076
distance x is tensor(4.1791, device='cuda:3')
benign distance is  tensor(4.1791, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3403964042663574
distance x is tensor(1.9384, device='cuda:3')
benign distance is  tensor(1.9384, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.306030511856079
distance x is tensor(1.4606, device='cuda:3')
benign distance is  tensor(1.4606, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2774150371551514
distance x is tensor(1.8135, device='cuda:3')
benign distance is  tensor(1.8135, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3343207836151123
distance x is tensor(1.4330, device='cuda:3')
benign distance is  tensor(1.4330, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.331944704055786
distance x is tensor(1.2281, device='cuda:3')
benign distance is  tensor(1.2281, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2946035861968994
distance x is tensor(4.1820, device='cuda:3')
benign distance is  tensor(4.1820, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.287280797958374
distance x is tensor(2.0738, device='cuda:3')
benign distance is  tensor(2.0738, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.3364384174346924
distance x is tensor(27.1371, device='cuda:3')
benign distance is  tensor(27.1371, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.246407985687256
distance x is tensor(8.2977, device='cuda:3')
benign distance is  tensor(8.2977, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2770254611968994
distance x is tensor(6.2773, device='cuda:3')
benign distance is  tensor(6.2773, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2908358573913574
distance x is tensor(2.9883, device='cuda:3')
benign distance is  tensor(2.9883, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3354461193084717
distance x is tensor(12.5588, device='cuda:3')
benign distance is  tensor(12.5588, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.3173716068267822
distance x is tensor(6.4734, device='cuda:3')
benign distance is  tensor(6.4734, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.305046319961548
distance x is tensor(1.8314, device='cuda:3')
benign distance is  tensor(1.8314, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.285398006439209
distance x is tensor(1.4250, device='cuda:3')
benign distance is  tensor(1.4250, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3336424827575684
distance x is tensor(2.1517, device='cuda:3')
benign distance is  tensor(2.1517, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.3042893409729004
distance x is tensor(3.7906, device='cuda:3')
benign distance is  tensor(3.7906, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.293527126312256
distance x is tensor(1.8779, device='cuda:3')
benign distance is  tensor(1.8779, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.2605676651000977
distance x is tensor(4.1240, device='cuda:3')
benign distance is  tensor(4.1240, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.3547918796539307
distance x is tensor(1.4645, device='cuda:3')
benign distance is  tensor(1.4645, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.291663885116577
distance x is tensor(10.4002, device='cuda:3')
benign distance is  tensor(10.4002, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.27768874168396
distance x is tensor(2.8366, device='cuda:3')
benign distance is  tensor(2.8366, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.312345266342163
distance x is tensor(1.5129, device='cuda:3')
benign distance is  tensor(1.5129, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.3657164573669434
distance x is tensor(1.5397, device='cuda:3')
benign distance is  tensor(1.5397, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.3058276176452637
distance x is tensor(1.9944, device='cuda:3')
benign distance is  tensor(1.9944, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.2993900775909424
distance x is tensor(1.5977, device='cuda:3')
benign distance is  tensor(1.5977, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.319888114929199
distance x is tensor(1.5402, device='cuda:3')
benign distance is  tensor(1.5402, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.3444395065307617
distance x is tensor(4.5904, device='cuda:3')
benign distance is  tensor(4.5904, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.273624897003174
distance x is tensor(1.5332, device='cuda:3')
benign distance is  tensor(1.5332, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.221829891204834
distance x is tensor(16.7704, device='cuda:3')
benign distance is  tensor(16.7704, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.3174948692321777
distance x is tensor(1.4664, device='cuda:3')
benign distance is  tensor(1.4664, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.3532357215881348
distance x is tensor(1.6254, device='cuda:3')
benign distance is  tensor(1.6254, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(1.9823, device='cuda:3')
compute distance is  tensor(1.9823, device='cuda:3')
compute norm is  tensor(67.5353, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3244, device='cuda:3')
compute distance is  tensor(1.3244, device='cuda:3')
compute norm is  tensor(67.5686, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3358, device='cuda:3')
compute distance is  tensor(1.3358, device='cuda:3')
compute norm is  tensor(67.5233, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.5549, device='cuda:3')
compute distance is  tensor(1.5549, device='cuda:3')
compute norm is  tensor(67.5382, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1903, device='cuda:3')
compute distance is  tensor(2.1903, device='cuda:3')
compute norm is  tensor(67.5428, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.7630, device='cuda:3')
compute distance is  tensor(2.7630, device='cuda:3')
compute norm is  tensor(67.5121, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.5259, device='cuda:3')
compute distance is  tensor(1.5259, device='cuda:3')
compute norm is  tensor(67.5417, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.4928, device='cuda:3')
compute distance is  tensor(1.4928, device='cuda:3')
compute norm is  tensor(67.5273, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.0629, device='cuda:3')
compute distance is  tensor(2.0629, device='cuda:3')
compute norm is  tensor(67.4704, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.6737, device='cuda:3')
compute distance is  tensor(1.6737, device='cuda:3')
compute norm is  tensor(67.5023, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7252, device='cuda:3')
compute distance is  tensor(1.7252, device='cuda:3')
compute norm is  tensor(67.5172, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.4791, device='cuda:3')
compute distance is  tensor(1.4791, device='cuda:3')
compute norm is  tensor(67.5440, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(2.7630, device='cuda:3')
distance x is tensor(107474.8125, device='cuda:3')
distance x is tensor(107474.8125, device='cuda:3')
________________________________
test distance is  tensor(107474.8125, device='cuda:3')
test distance1 is  tensor(107474.8125, device='cuda:3')
test similarity is  tensor(0.6274, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129992956289565.47
test entropy is  0.0
________________________________
cal ratio is  0.004968968072326268
distance x is tensor(534.0439, device='cuda:3')
cal_distance is  tensor(534.0439, device='cuda:3')
cal ratio is  0.07049057485490764
distance x is tensor(37.6499, device='cuda:3')
cal_distance is  tensor(37.6499, device='cuda:3')
cal ratio is  0.2654837262889567
distance x is tensor(9.9996, device='cuda:3')
cal_distance is  tensor(9.9996, device='cuda:3')
cal ratio is  0.5151424896119478
distance x is tensor(5.1544, device='cuda:3')
cal_distance is  tensor(5.1544, device='cuda:3')
cal ratio is  0.7175127586532948
distance x is tensor(3.7004, device='cuda:3')
cal_distance is  tensor(3.7004, device='cuda:3')
cal ratio is  0.846830407562775
distance x is tensor(3.1347, device='cuda:3')
cal_distance is  tensor(3.1347, device='cuda:3')
cal ratio is  0.9200669989990581
distance x is tensor(2.8848, device='cuda:3')
cal_distance is  tensor(2.8848, device='cuda:3')
cal ratio is  0.959100984588649
distance x is tensor(2.7671, device='cuda:3')
cal_distance is  tensor(2.7671, device='cuda:3')
cal ratio is  0.9792819635133182
distance x is tensor(2.7099, device='cuda:3')
cal_distance is  tensor(2.7099, device='cuda:3')
distance x is tensor(2.7099, device='cuda:3')
return_distance is  tensor(2.7099, device='cuda:3')
distance x is tensor(2.7001, device='cuda:3')
distance x is tensor(2.7001, device='cuda:3')
________________________________
test distance is  tensor(2.7001, device='cuda:3')
test distance1 is  tensor(2.7001, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.3342965526113124
test entropy is  2.2647555786917715
________________________________
0
distance x is tensor(2.7001, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2647365829837858
avg test loss is  2.3345617869261233
avg accuracy is  0.10015000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2.7001, device='cuda:3')
compute_norm is  tensor(67.7885, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6.1155, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.892923321360464
avg test loss is  3.5460567131225487
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(6.1155, device='cuda:3')
compute_norm is  tensor(68.1805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(8.5634, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.566785109703983
avg test loss is  2.8484414007617973
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(8.5634, device='cuda:3')
compute_norm is  tensor(67.5914, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.8412, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8560430153346519
avg test loss is  3.5908995592263717
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(12.8412, device='cuda:3')
compute_norm is  tensor(67.6253, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.6866, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5660756367610207
avg test loss is  2.8478767813395844
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(15.6866, device='cuda:3')
compute_norm is  tensor(67.0110, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.9964, device='cuda:3')
distance x is tensor(19.9964, device='cuda:3')
________________________________
test distance is  tensor(19.9964, device='cuda:3')
test distance1 is  tensor(19.9964, device='cuda:3')
test similarity is  tensor(0.9993, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5860028205904118
test entropy is  0.8569170124749385
________________________________
cal ratio is  0.36428734468497936
distance x is tensor(7.2844, device='cuda:3')
cal_distance is  tensor(7.2844, device='cuda:3')
cal ratio is  0.6035625103759606
distance x is tensor(4.3966, device='cuda:3')
cal_distance is  tensor(4.3966, device='cuda:3')
cal ratio is  0.7768923699822445
distance x is tensor(3.4157, device='cuda:3')
cal_distance is  tensor(3.4157, device='cuda:3')
cal ratio is  0.8814143508352223
distance x is tensor(3.0106, device='cuda:3')
cal_distance is  tensor(3.0106, device='cuda:3')
cal ratio is  0.938836162780653
distance x is tensor(2.8265, device='cuda:3')
cal_distance is  tensor(2.8265, device='cuda:3')
cal ratio is  0.9689352400597796
distance x is tensor(2.7387, device='cuda:3')
cal_distance is  tensor(2.7387, device='cuda:3')
distance x is tensor(2.7387, device='cuda:3')
return_distance is  tensor(2.7387, device='cuda:3')
distance x is tensor(2.7387, device='cuda:3')
distance x is tensor(2.7387, device='cuda:3')
________________________________
test distance is  tensor(2.7387, device='cuda:3')
test distance1 is  tensor(2.7387, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.3809151514760973
test entropy is  2.203453490474839
________________________________
0
distance x is tensor(2.7387, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2032628397443403
avg test loss is  2.3806566579509645
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2.7387, device='cuda:3')
compute_norm is  tensor(67.5652, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.1379, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.882287608407962
avg test loss is  3.5582590136192502
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(8.1379, device='cuda:3')
compute_norm is  tensor(67.9008, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11.0581, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5668664628000402
avg test loss is  2.8483597169806965
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(11.0581, device='cuda:3')
compute_norm is  tensor(67.3085, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.4498, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8587644327678152
avg test loss is  3.5862301298296018
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(15.4498, device='cuda:3')
compute_norm is  tensor(67.3398, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18.3690, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5648104218023418
avg test loss is  2.8481728906062114
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(18.3690, device='cuda:3')
compute_norm is  tensor(66.7297, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.7017, device='cuda:3')
distance x is tensor(22.7017, device='cuda:3')
________________________________
test distance is  tensor(22.7017, device='cuda:3')
test distance1 is  tensor(22.7017, device='cuda:3')
test similarity is  tensor(0.9993, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5877228596571413
test entropy is  0.8548947747455222
________________________________
cal ratio is  0.34189294700833
distance x is tensor(7.7607, device='cuda:3')
cal_distance is  tensor(7.7607, device='cuda:3')
cal ratio is  0.5847467300736232
distance x is tensor(4.5378, device='cuda:3')
cal_distance is  tensor(4.5378, device='cuda:3')
cal ratio is  0.7647079063938398
distance x is tensor(3.4700, device='cuda:3')
cal_distance is  tensor(3.4700, device='cuda:3')
cal ratio is  0.8744928033449731
distance x is tensor(3.0344, device='cuda:3')
cal_distance is  tensor(3.0344, device='cuda:3')
cal ratio is  0.9351543336369025
distance x is tensor(2.8376, device='cuda:3')
cal_distance is  tensor(2.8376, device='cuda:3')
cal ratio is  0.9670400036828444
distance x is tensor(2.7440, device='cuda:3')
cal_distance is  tensor(2.7440, device='cuda:3')
distance x is tensor(2.7440, device='cuda:3')
return_distance is  tensor(2.7440, device='cuda:3')
distance x is tensor(2.7453, device='cuda:3')
distance x is tensor(2.7453, device='cuda:3')
________________________________
test distance is  tensor(2.7453, device='cuda:3')
test distance1 is  tensor(2.7453, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.3734194088592204
test entropy is  2.2129973282437843
________________________________
0
distance x is tensor(2.7453, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2130513885127963
avg test loss is  2.3735050880578537
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2.7453, device='cuda:3')
compute_norm is  tensor(67.5451, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.1859, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.883895800566114
avg test loss is  3.5578598462696522
avg accuracy is  0.10008333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(8.1859, device='cuda:3')
compute_norm is  tensor(67.8876, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11.1103, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5656776612501409
avg test loss is  2.849168228696404
avg accuracy is  0.10015000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(11.1103, device='cuda:3')
compute_norm is  tensor(67.2957, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.5073, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8549412804753033
avg test loss is  3.5893562122194496
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(15.5073, device='cuda:3')
compute_norm is  tensor(67.3287, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18.4228, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5645589447224826
avg test loss is  2.84944629923367
avg accuracy is  0.10011666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(18.4228, device='cuda:3')
compute_norm is  tensor(66.7164, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.7570, device='cuda:3')
________________________________
test distance is  tensor(22.7570, device='cuda:3')
test similarity is  tensor(0.9993, device='cuda:3')
test acc is  0.10006666682299865
test loss is 3.588814420486564
test entropy is  0.8539392345749748
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.634974718093872
mal norm is  tensor(148.2890, device='cuda:3')
distance x is tensor(22.7570, device='cuda:3')
mal distance is  tensor(22.7570, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 60.5047,  97.4426,  67.0506,  66.9199,  60.2919,  76.7256,  64.9505,
         72.6836, 148.2890, 148.2890, 148.2890, 148.2890, 148.2890, 148.2890,
        148.2890, 148.2890, 148.2890, 148.2890, 148.2890, 148.2890],
       device='cuda:3')
sorted_norm is   tensor([ 60.2919,  60.5047,  64.9505,  66.9199,  67.0506,  72.6836,  76.7256,
         97.4426, 148.2890, 148.2890, 148.2890, 148.2890, 148.2890, 148.2890,
        148.2890, 148.2890, 148.2890, 148.2890, 148.2890, 148.2890],
       device='cuda:3')
used idx is  tensor([ 4,  0,  6,  3,  2,  7,  5,  1, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.288684368133545
distance x is tensor(1.8088, device='cuda:3')
benign distance is  tensor(1.8088, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.325544834136963
distance x is tensor(1.9771, device='cuda:3')
benign distance is  tensor(1.9771, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.295443058013916
distance x is tensor(1.7951, device='cuda:3')
benign distance is  tensor(1.7951, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.295121669769287
distance x is tensor(13.2019, device='cuda:3')
benign distance is  tensor(13.2019, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2822210788726807
distance x is tensor(2.5413, device='cuda:3')
benign distance is  tensor(2.5413, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3092212677001953
distance x is tensor(2.1921, device='cuda:3')
benign distance is  tensor(2.1921, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3137991428375244
distance x is tensor(1.9201, device='cuda:3')
benign distance is  tensor(1.9201, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2855029106140137
distance x is tensor(5.4242, device='cuda:3')
benign distance is  tensor(5.4242, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(1.9038, device='cuda:3')
compute distance is  tensor(1.9038, device='cuda:3')
compute norm is  tensor(66.6015, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.8211, device='cuda:3')
compute distance is  tensor(1.8211, device='cuda:3')
compute norm is  tensor(66.6216, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7353, device='cuda:3')
compute distance is  tensor(1.7353, device='cuda:3')
compute norm is  tensor(66.6034, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1414, device='cuda:3')
compute distance is  tensor(2.1414, device='cuda:3')
compute norm is  tensor(66.6468, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4791, device='cuda:3')
compute distance is  tensor(2.4791, device='cuda:3')
compute norm is  tensor(66.6665, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.1092, device='cuda:3')
compute distance is  tensor(3.1092, device='cuda:3')
compute norm is  tensor(66.5987, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.0953, device='cuda:3')
compute distance is  tensor(2.0953, device='cuda:3')
compute norm is  tensor(66.6235, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.7132, device='cuda:3')
compute distance is  tensor(6.7132, device='cuda:3')
compute norm is  tensor(66.6310, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.6740, device='cuda:3')
compute distance is  tensor(2.6740, device='cuda:3')
compute norm is  tensor(66.6277, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2172, device='cuda:3')
compute distance is  tensor(2.2172, device='cuda:3')
compute norm is  tensor(66.6391, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5405, device='cuda:3')
compute distance is  tensor(2.5405, device='cuda:3')
compute norm is  tensor(66.6533, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1225, device='cuda:3')
compute distance is  tensor(2.1225, device='cuda:3')
compute norm is  tensor(66.5495, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(6.7132, device='cuda:3')
distance x is tensor(107475.2656, device='cuda:3')
distance x is tensor(107475.2656, device='cuda:3')
________________________________
test distance is  tensor(107475.2656, device='cuda:3')
test distance1 is  tensor(107475.2656, device='cuda:3')
test similarity is  tensor(0.6272, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130153812256903.38
test entropy is  0.0
________________________________
cal ratio is  0.007745296410175073
distance x is tensor(832.4329, device='cuda:3')
cal_distance is  tensor(832.4329, device='cuda:3')
cal ratio is  0.08800709976630665
distance x is tensor(73.2646, device='cuda:3')
cal_distance is  tensor(73.2646, device='cuda:3')
cal ratio is  0.2966505506420699
distance x is tensor(21.7378, device='cuda:3')
cal_distance is  tensor(21.7378, device='cuda:3')
cal ratio is  0.5446092259799883
distance x is tensor(11.8412, device='cuda:3')
cal_distance is  tensor(11.8412, device='cuda:3')
cal ratio is  0.7378944838560789
distance x is tensor(8.7392, device='cuda:3')
cal_distance is  tensor(8.7392, device='cuda:3')
cal ratio is  0.8589285490553207
distance x is tensor(7.5072, device='cuda:3')
cal_distance is  tensor(7.5072, device='cuda:3')
cal ratio is  0.9267284072761267
distance x is tensor(6.9576, device='cuda:3')
cal_distance is  tensor(6.9576, device='cuda:3')
cal ratio is  0.9626343558777788
distance x is tensor(6.6979, device='cuda:3')
cal_distance is  tensor(6.6979, device='cuda:3')
distance x is tensor(6.6979, device='cuda:3')
return_distance is  tensor(6.6979, device='cuda:3')
distance x is tensor(6.6880, device='cuda:3')
distance x is tensor(6.6880, device='cuda:3')
________________________________
test distance is  tensor(6.6880, device='cuda:3')
test distance1 is  tensor(6.6880, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.484087214795257
test entropy is  2.0572720356841585
________________________________
0
distance x is tensor(6.6880, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.057434868202535
avg test loss is  2.4833539676056233
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.6880, device='cuda:3')
compute_norm is  tensor(67.1808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.7040, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8708939332443514
avg test loss is  3.5731746553103805
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(8.7040, device='cuda:3')
compute_norm is  tensor(67.4279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9.5938, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5670558411175255
avg test loss is  2.8473364231683043
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(9.5938, device='cuda:3')
compute_norm is  tensor(66.8315, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.8218, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8552892049873816
avg test loss is  3.5884887895096087
avg accuracy is  0.10018333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(12.8218, device='cuda:3')
compute_norm is  tensor(66.8656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.2807, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5624234025666455
avg test loss is  2.8505971843499873
avg accuracy is  0.10026666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(15.2807, device='cuda:3')
compute_norm is  tensor(66.2575, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.2870, device='cuda:3')
distance x is tensor(19.2870, device='cuda:3')
________________________________
test distance is  tensor(19.2870, device='cuda:3')
test distance1 is  tensor(19.2870, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5894783605644696
test entropy is  0.8525142095236382
________________________________
cal ratio is  0.5781753776148737
distance x is tensor(11.1528, device='cuda:3')
cal_distance is  tensor(11.1528, device='cuda:3')
cal ratio is  0.7603265077121373
distance x is tensor(8.4800, device='cuda:3')
cal_distance is  tensor(8.4800, device='cuda:3')
cal ratio is  0.8719550006218417
distance x is tensor(7.3943, device='cuda:3')
cal_distance is  tensor(7.3943, device='cuda:3')
cal ratio is  0.9337773572598628
distance x is tensor(6.9047, device='cuda:3')
cal_distance is  tensor(6.9047, device='cuda:3')
cal ratio is  0.9663170762609706
distance x is tensor(6.6722, device='cuda:3')
cal_distance is  tensor(6.6722, device='cuda:3')
distance x is tensor(6.6722, device='cuda:3')
return_distance is  tensor(6.6722, device='cuda:3')
distance x is tensor(6.6702, device='cuda:3')
distance x is tensor(6.6702, device='cuda:3')
________________________________
test distance is  tensor(6.6702, device='cuda:3')
test distance1 is  tensor(6.6702, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7309175658581863
test entropy is  1.7155285687334756
________________________________
0
distance x is tensor(6.6702, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.716087757524397
avg test loss is  2.7305400470680774
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.6702, device='cuda:3')
compute_norm is  tensor(66.6871, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.0387, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8592901462430893
avg test loss is  3.5843511710543114
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(11.0387, device='cuda:3')
compute_norm is  tensor(66.7794, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(13.8944, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.566227395651437
avg test loss is  2.848233349796043
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(13.8944, device='cuda:3')
compute_norm is  tensor(66.1770, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.1380, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8529081309655073
avg test loss is  3.590891830956758
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(18.1380, device='cuda:3')
compute_norm is  tensor(66.2132, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.0382, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5629863550922256
avg test loss is  2.849330547521872
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(21.0382, device='cuda:3')
compute_norm is  tensor(65.6066, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.2377, device='cuda:3')
distance x is tensor(25.2377, device='cuda:3')
________________________________
test distance is  tensor(25.2377, device='cuda:3')
test distance1 is  tensor(25.2377, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.58774825606519
test entropy is  0.8539921788772794
________________________________
cal ratio is  0.5054370697682874
distance x is tensor(12.7557, device='cuda:3')
cal_distance is  tensor(12.7557, device='cuda:3')
cal ratio is  0.7109508357044397
distance x is tensor(9.0686, device='cuda:3')
cal_distance is  tensor(9.0686, device='cuda:3')
cal ratio is  0.8431820417497119
distance x is tensor(7.6465, device='cuda:3')
cal_distance is  tensor(7.6465, device='cuda:3')
cal ratio is  0.9182515979579499
distance x is tensor(7.0214, device='cuda:3')
cal_distance is  tensor(7.0214, device='cuda:3')
cal ratio is  0.9582557059540366
distance x is tensor(6.7283, device='cuda:3')
cal_distance is  tensor(6.7283, device='cuda:3')
cal ratio is  0.9789059355325034
distance x is tensor(6.5863, device='cuda:3')
cal_distance is  tensor(6.5863, device='cuda:3')
distance x is tensor(6.5863, device='cuda:3')
return_distance is  tensor(6.5863, device='cuda:3')
distance x is tensor(6.5868, device='cuda:3')
distance x is tensor(6.5868, device='cuda:3')
________________________________
test distance is  tensor(6.5868, device='cuda:3')
test distance1 is  tensor(6.5868, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.656413642328177
test entropy is  1.8153780067144936
________________________________
0
distance x is tensor(6.5868, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8161247544197132
avg test loss is  2.6564774747088014
avg accuracy is  0.1002833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.5868, device='cuda:3')
compute_norm is  tensor(66.5758, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.1815, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8604796031263592
avg test loss is  3.5844051891298436
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(11.1815, device='cuda:3')
compute_norm is  tensor(66.7101, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(14.1002, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5633810702671629
avg test loss is  2.850521421127482
avg accuracy is  0.10015000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(14.1002, device='cuda:3')
compute_norm is  tensor(66.1112, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.3766, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8537788182052214
avg test loss is  3.5890599700179435
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(18.3766, device='cuda:3')
compute_norm is  tensor(66.1473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.2964, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5621731760405273
avg test loss is  2.8508528895469616
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(21.2964, device='cuda:3')
compute_norm is  tensor(65.5408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.5100, device='cuda:3')
________________________________
test distance is  tensor(25.5100, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10020000015633199
test loss is 3.5861252711525857
test entropy is  0.8541368987641609
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5647425651550293
mal norm is  tensor(131.4701, device='cuda:3')
distance x is tensor(25.5100, device='cuda:3')
mal distance is  tensor(25.5100, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 89.6589,  88.0705,  91.0722, 160.0677,  95.8449, 105.8961,  96.2750,
        106.8545, 131.4701, 131.4701, 131.4701, 131.4701, 131.4701, 131.4701,
        131.4701, 131.4701, 131.4701, 131.4701, 131.4701, 131.4701, 114.6663,
        107.2483, 108.3617, 101.7018,  95.6268, 104.1448, 102.1221, 251.2036],
       device='cuda:3')
sorted_norm is   tensor([ 88.0705,  89.6589,  91.0722,  95.6268,  95.8449,  96.2750, 101.7018,
        102.1221, 104.1448, 105.8961, 106.8545, 107.2483, 108.3617, 114.6663,
        131.4701, 131.4701, 131.4701, 131.4701, 131.4701, 131.4701, 131.4701,
        131.4701, 131.4701, 131.4701, 131.4701, 131.4701, 160.0677, 251.2036],
       device='cuda:3')
used idx is  tensor([ 1,  0,  2, 24,  4,  6, 23, 26, 25,  5,  7, 21, 22, 20, 19, 17, 15, 11,
         8, 10, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.298896551132202
distance x is tensor(1.4401, device='cuda:3')
benign distance is  tensor(1.4401, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.31933856010437
distance x is tensor(5.0314, device='cuda:3')
benign distance is  tensor(5.0314, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2901878356933594
distance x is tensor(1.5521, device='cuda:3')
benign distance is  tensor(1.5521, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3013012409210205
distance x is tensor(3.2228, device='cuda:3')
benign distance is  tensor(3.2228, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.331665515899658
distance x is tensor(2.1390, device='cuda:3')
benign distance is  tensor(2.1390, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3175578117370605
distance x is tensor(5.1548, device='cuda:3')
benign distance is  tensor(5.1548, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3109970092773438
distance x is tensor(1.4069, device='cuda:3')
benign distance is  tensor(1.4069, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3143270015716553
distance x is tensor(7.6534, device='cuda:3')
benign distance is  tensor(7.6534, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.34501576423645
distance x is tensor(1.8904, device='cuda:3')
benign distance is  tensor(1.8904, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3272860050201416
distance x is tensor(1.7393, device='cuda:3')
benign distance is  tensor(1.7393, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.294703245162964
distance x is tensor(10.1667, device='cuda:3')
benign distance is  tensor(10.1667, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.279479742050171
distance x is tensor(1.5592, device='cuda:3')
benign distance is  tensor(1.5592, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.322162389755249
distance x is tensor(1.2322, device='cuda:3')
benign distance is  tensor(1.2322, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.295698642730713
distance x is tensor(2.4596, device='cuda:3')
benign distance is  tensor(2.4596, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.310377597808838
distance x is tensor(3.3298, device='cuda:3')
benign distance is  tensor(3.3298, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.287086009979248
distance x is tensor(13.4597, device='cuda:3')
benign distance is  tensor(13.4597, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(1.5624, device='cuda:3')
compute distance is  tensor(1.5624, device='cuda:3')
compute norm is  tensor(66.1832, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3382, device='cuda:3')
compute distance is  tensor(1.3382, device='cuda:3')
compute norm is  tensor(66.1750, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.2145, device='cuda:3')
compute distance is  tensor(1.2145, device='cuda:3')
compute norm is  tensor(66.1722, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.6114, device='cuda:3')
compute distance is  tensor(1.6114, device='cuda:3')
compute norm is  tensor(66.1531, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.9517, device='cuda:3')
compute distance is  tensor(1.9517, device='cuda:3')
compute norm is  tensor(66.1718, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2138, device='cuda:3')
compute distance is  tensor(2.2138, device='cuda:3')
compute norm is  tensor(66.1568, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7500, device='cuda:3')
compute distance is  tensor(1.7500, device='cuda:3')
compute norm is  tensor(66.0793, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.0355, device='cuda:3')
compute distance is  tensor(7.0355, device='cuda:3')
compute norm is  tensor(66.1494, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.2611, device='cuda:3')
compute distance is  tensor(3.2611, device='cuda:3')
compute norm is  tensor(66.1339, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7681, device='cuda:3')
compute distance is  tensor(1.7681, device='cuda:3')
compute norm is  tensor(66.0788, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8639, device='cuda:3')
compute distance is  tensor(2.8639, device='cuda:3')
compute norm is  tensor(66.1128, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.5646, device='cuda:3')
compute distance is  tensor(1.5646, device='cuda:3')
compute norm is  tensor(66.0896, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(7.0355, device='cuda:3')
distance x is tensor(107475.4531, device='cuda:3')
distance x is tensor(107475.4531, device='cuda:3')
________________________________
test distance is  tensor(107475.4531, device='cuda:3')
test distance1 is  tensor(107475.4531, device='cuda:3')
test similarity is  tensor(0.6275, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130111834213692.6
test entropy is  0.0
________________________________
cal ratio is  0.007928987318760012
distance x is tensor(852.1765, device='cuda:3')
cal_distance is  tensor(852.1765, device='cuda:3')
cal ratio is  0.08904460232954237
distance x is tensor(75.8863, device='cuda:3')
cal_distance is  tensor(75.8863, device='cuda:3')
cal ratio is  0.29839434983836566
distance x is tensor(22.6478, device='cuda:3')
cal_distance is  tensor(22.6478, device='cuda:3')
cal ratio is  0.5462097085457288
distance x is tensor(12.3731, device='cuda:3')
cal_distance is  tensor(12.3731, device='cuda:3')
cal ratio is  0.7389821001802842
distance x is tensor(9.1451, device='cuda:3')
cal_distance is  tensor(9.1451, device='cuda:3')
cal ratio is  0.8595656834265132
distance x is tensor(7.8617, device='cuda:3')
cal_distance is  tensor(7.8617, device='cuda:3')
cal ratio is  0.9270752135589142
distance x is tensor(7.2888, device='cuda:3')
cal_distance is  tensor(7.2888, device='cuda:3')
cal ratio is  0.9628162460972391
distance x is tensor(7.0180, device='cuda:3')
cal_distance is  tensor(7.0180, device='cuda:3')
distance x is tensor(7.0180, device='cuda:3')
return_distance is  tensor(7.0180, device='cuda:3')
distance x is tensor(7.0081, device='cuda:3')
distance x is tensor(7.0081, device='cuda:3')
________________________________
test distance is  tensor(7.0081, device='cuda:3')
test distance1 is  tensor(7.0081, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.363362088386438
test entropy is  2.2267263469411365
________________________________
0
distance x is tensor(7.0081, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2267839265530553
avg test loss is  2.363178639777942
avg accuracy is  0.10025000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(7.0081, device='cuda:3')
compute_norm is  tensor(66.5572, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9.3528, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8820346302823472
avg test loss is  3.559595730258966
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(9.3528, device='cuda:3')
compute_norm is  tensor(66.9183, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(10.1668, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.566435056708769
avg test loss is  2.8491486209287826
avg accuracy is  0.10025000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(10.1668, device='cuda:3')
compute_norm is  tensor(66.3297, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.2584, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8531468061368856
avg test loss is  3.5930682679991732
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(13.2584, device='cuda:3')
compute_norm is  tensor(66.3692, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.6073, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5649853913006244
avg test loss is  2.84832735305656
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(15.6073, device='cuda:3')
compute_norm is  tensor(65.7621, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.5706, device='cuda:3')
distance x is tensor(19.5706, device='cuda:3')
________________________________
test distance is  tensor(19.5706, device='cuda:3')
test distance1 is  tensor(19.5706, device='cuda:3')
test similarity is  tensor(0.9994, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5917542867823196
test entropy is  0.85164209120055
________________________________
cal ratio is  0.5875851849219453
distance x is tensor(11.5010, device='cuda:3')
cal_distance is  tensor(11.5010, device='cuda:3')
cal ratio is  0.7664855080937268
distance x is tensor(8.8156, device='cuda:3')
cal_distance is  tensor(8.8156, device='cuda:3')
cal ratio is  0.8754792528885821
distance x is tensor(7.7180, device='cuda:3')
cal_distance is  tensor(7.7180, device='cuda:3')
cal ratio is  0.935662453334356
distance x is tensor(7.2215, device='cuda:3')
cal_distance is  tensor(7.2215, device='cuda:3')
cal ratio is  0.9672918176428367
distance x is tensor(6.9854, device='cuda:3')
cal_distance is  tensor(6.9854, device='cuda:3')
distance x is tensor(6.9854, device='cuda:3')
return_distance is  tensor(6.9854, device='cuda:3')
distance x is tensor(6.9833, device='cuda:3')
distance x is tensor(6.9833, device='cuda:3')
________________________________
test distance is  tensor(6.9833, device='cuda:3')
test distance1 is  tensor(6.9833, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.579340821390213
test entropy is  1.9220567900997234
________________________________
0
distance x is tensor(6.9833, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.921251269291713
avg test loss is  2.579545546696384
avg accuracy is  0.10026666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(6.9833, device='cuda:3')
compute_norm is  tensor(66.0723, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.5436, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8598263951888216
avg test loss is  3.586613065906679
avg accuracy is  0.10028333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(11.5436, device='cuda:3')
compute_norm is  tensor(66.2570, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(14.3547, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5665926853222634
avg test loss is  2.8466954493065124
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(14.3547, device='cuda:3')
compute_norm is  tensor(65.6616, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.5751, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8517194780459536
avg test loss is  3.5931143643759462
avg accuracy is  0.10020000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(18.5751, device='cuda:3')
compute_norm is  tensor(65.7008, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.4243, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5646853377061611
avg test loss is  2.847524365382408
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(21.4243, device='cuda:3')
compute_norm is  tensor(65.0964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.6117, device='cuda:3')
distance x is tensor(25.6117, device='cuda:3')
________________________________
test distance is  tensor(25.6117, device='cuda:3')
test distance1 is  tensor(25.6117, device='cuda:3')
test similarity is  tensor(0.9994, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5903518441389366
test entropy is  0.8516660709498025
________________________________
cal ratio is  0.5136336990152678
distance x is tensor(13.1547, device='cuda:3')
cal_distance is  tensor(13.1547, device='cuda:3')
cal ratio is  0.7166909366497658
distance x is tensor(9.4278, device='cuda:3')
cal_distance is  tensor(9.4278, device='cuda:3')
cal ratio is  0.8465785326166495
distance x is tensor(7.9813, device='cuda:3')
cal_distance is  tensor(7.9813, device='cuda:3')
cal ratio is  0.9200986360717471
distance x is tensor(7.3436, device='cuda:3')
cal_distance is  tensor(7.3436, device='cuda:3')
cal ratio is  0.9592186769248386
distance x is tensor(7.0441, device='cuda:3')
cal_distance is  tensor(7.0441, device='cuda:3')
cal ratio is  0.9793976106571493
distance x is tensor(6.8990, device='cuda:3')
cal_distance is  tensor(6.8990, device='cuda:3')
distance x is tensor(6.8990, device='cuda:3')
return_distance is  tensor(6.8990, device='cuda:3')
distance x is tensor(6.8994, device='cuda:3')
distance x is tensor(6.8994, device='cuda:3')
________________________________
test distance is  tensor(6.8994, device='cuda:3')
test distance1 is  tensor(6.8994, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.505377752186139
test entropy is  2.026456089162115
________________________________
0
distance x is tensor(6.8994, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0266122723947455
avg test loss is  2.505511595242059
avg accuracy is  0.10033333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.8994, device='cuda:3')
compute_norm is  tensor(65.9431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.7316, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8662592144663146
avg test loss is  3.5777408133691817
avg accuracy is  0.10026666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(11.7316, device='cuda:3')
compute_norm is  tensor(66.1779, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(14.6115, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.567273447381408
avg test loss is  2.8472828448200023
avg accuracy is  0.10028333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(14.6115, device='cuda:3')
compute_norm is  tensor(65.5850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.8694, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8517339727136372
avg test loss is  3.592360899900831
avg accuracy is  0.10015000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(18.8694, device='cuda:3')
compute_norm is  tensor(65.6254, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.7422, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5648931102203663
avg test loss is  2.8481019592996852
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(21.7422, device='cuda:3')
compute_norm is  tensor(65.0225, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.9443, device='cuda:3')
________________________________
test distance is  tensor(25.9443, device='cuda:3')
test similarity is  tensor(0.9994, device='cuda:3')
test acc is  0.10025000015633198
test loss is 3.5919955407124338
test entropy is  0.8505371701615706
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5752837657928467
mal norm is  tensor(147.0743, device='cuda:3')
distance x is tensor(25.9443, device='cuda:3')
mal distance is  tensor(25.9443, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 71.5801,  80.5982,  74.6174,  68.3467,  65.9546,  97.4036,  66.1330,
         96.7799, 147.0743, 147.0743, 147.0743, 147.0743, 147.0743, 147.0743,
        147.0743, 147.0743, 147.0743, 147.0743, 147.0743, 147.0743, 119.8341,
        120.5187, 103.1923, 139.7004, 116.6166, 107.6085,  98.5374, 100.1071],
       device='cuda:3')
sorted_norm is   tensor([ 65.9546,  66.1330,  68.3467,  71.5801,  74.6174,  80.5982,  96.7799,
         97.4036,  98.5374, 100.1071, 103.1923, 107.6085, 116.6166, 119.8341,
        120.5187, 139.7004, 147.0743, 147.0743, 147.0743, 147.0743, 147.0743,
        147.0743, 147.0743, 147.0743, 147.0743, 147.0743, 147.0743, 147.0743],
       device='cuda:3')
used idx is  tensor([ 4,  6,  3,  0,  2,  1,  7,  5, 26, 27, 22, 25, 24, 20, 21, 23, 11, 10,
         8,  9, 13, 12], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.307738780975342
distance x is tensor(1.1366, device='cuda:3')
benign distance is  tensor(1.1366, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.307830810546875
distance x is tensor(1.2862, device='cuda:3')
benign distance is  tensor(1.2862, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.29202938079834
distance x is tensor(2.0428, device='cuda:3')
benign distance is  tensor(2.0428, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5178747177124023
distance x is tensor(8.9865, device='cuda:3')
benign distance is  tensor(8.9865, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.315892219543457
distance x is tensor(2.0020, device='cuda:3')
benign distance is  tensor(2.0020, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3216657638549805
distance x is tensor(1.3437, device='cuda:3')
benign distance is  tensor(1.3437, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2994656562805176
distance x is tensor(1.1810, device='cuda:3')
benign distance is  tensor(1.1810, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2903103828430176
distance x is tensor(6.8391, device='cuda:3')
benign distance is  tensor(6.8391, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.314474105834961
distance x is tensor(11.0554, device='cuda:3')
benign distance is  tensor(11.0554, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.3059964179992676
distance x is tensor(12.9409, device='cuda:3')
benign distance is  tensor(12.9409, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.269536256790161
distance x is tensor(9.1577, device='cuda:3')
benign distance is  tensor(9.1577, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3068366050720215
distance x is tensor(8.0545, device='cuda:3')
benign distance is  tensor(8.0545, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.3172786235809326
distance x is tensor(1.1900, device='cuda:3')
benign distance is  tensor(1.1900, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.3142764568328857
distance x is tensor(2.6445, device='cuda:3')
benign distance is  tensor(2.6445, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.2671966552734375
distance x is tensor(1.3267, device='cuda:3')
benign distance is  tensor(1.3267, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3262381553649902
distance x is tensor(1.4472, device='cuda:3')
benign distance is  tensor(1.4472, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(2.1275, device='cuda:3')
compute distance is  tensor(2.1275, device='cuda:3')
compute norm is  tensor(66.0365, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.2289, device='cuda:3')
compute distance is  tensor(1.2289, device='cuda:3')
compute norm is  tensor(66.0251, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3338, device='cuda:3')
compute distance is  tensor(2.3338, device='cuda:3')
compute norm is  tensor(66.0004, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2493, device='cuda:3')
compute distance is  tensor(2.2493, device='cuda:3')
compute norm is  tensor(66.0937, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.9986, device='cuda:3')
compute distance is  tensor(1.9986, device='cuda:3')
compute norm is  tensor(66.0784, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3177, device='cuda:3')
compute distance is  tensor(2.3177, device='cuda:3')
compute norm is  tensor(66.0162, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.5156, device='cuda:3')
compute distance is  tensor(1.5156, device='cuda:3')
compute norm is  tensor(66.0022, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.7642, device='cuda:3')
compute distance is  tensor(11.7642, device='cuda:3')
compute norm is  tensor(66.0742, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.6859, device='cuda:3')
compute distance is  tensor(2.6859, device='cuda:3')
compute norm is  tensor(66.0423, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8209, device='cuda:3')
compute distance is  tensor(2.8209, device='cuda:3')
compute norm is  tensor(66.0000, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3097, device='cuda:3')
compute distance is  tensor(2.3097, device='cuda:3')
compute norm is  tensor(66.1068, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3777, device='cuda:3')
compute distance is  tensor(1.3777, device='cuda:3')
compute norm is  tensor(66.0027, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(11.7642, device='cuda:3')
distance x is tensor(107475.5000, device='cuda:3')
distance x is tensor(107475.5000, device='cuda:3')
________________________________
test distance is  tensor(107475.5000, device='cuda:3')
test distance1 is  tensor(107475.5000, device='cuda:3')
test similarity is  tensor(0.6276, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130005982062832.17
test entropy is  0.0
________________________________
cal ratio is  0.010253056882409843
distance x is tensor(1101.9575, device='cuda:3')
cal_distance is  tensor(1101.9575, device='cuda:3')
cal ratio is  0.10125714655993363
distance x is tensor(111.5856, device='cuda:3')
cal_distance is  tensor(111.5856, device='cuda:3')
cal ratio is  0.3182028276960491
distance x is tensor(35.5104, device='cuda:3')
cal_distance is  tensor(35.5104, device='cuda:3')
cal ratio is  0.5640664927481304
distance x is tensor(20.0326, device='cuda:3')
cal_distance is  tensor(20.0326, device='cuda:3')
cal ratio is  0.7509989840529843
distance x is tensor(15.0459, device='cuda:3')
cal_distance is  tensor(15.0459, device='cuda:3')
cal ratio is  0.8665610799079647
distance x is tensor(13.0390, device='cuda:3')
cal_distance is  tensor(13.0390, device='cuda:3')
cal ratio is  0.9308647977132362
distance x is tensor(12.1379, device='cuda:3')
cal_distance is  tensor(12.1379, device='cuda:3')
cal ratio is  0.9647969755997154
distance x is tensor(11.7108, device='cuda:3')
cal_distance is  tensor(11.7108, device='cuda:3')
distance x is tensor(11.7108, device='cuda:3')
return_distance is  tensor(11.7108, device='cuda:3')
distance x is tensor(11.7009, device='cuda:3')
distance x is tensor(11.7009, device='cuda:3')
________________________________
test distance is  tensor(11.7009, device='cuda:3')
test distance1 is  tensor(11.7009, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10003333348966531
test loss is 2.3276938858316907
test entropy is  2.2731074648879486
________________________________
0
distance x is tensor(11.7009, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2731338469966897
avg test loss is  2.3276815635563213
avg accuracy is  0.10036666682299865
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(11.7009, device='cuda:3')
compute_norm is  tensor(66.5609, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.8985, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8863768582023791
avg test loss is  3.5565031954982897
avg accuracy is  0.10033333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(13.8985, device='cuda:3')
compute_norm is  tensor(66.9712, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(14.2881, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5642016538933141
avg test loss is  2.84997338094691
avg accuracy is  0.10036666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(14.2881, device='cuda:3')
compute_norm is  tensor(66.3842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16.5351, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8537674418517521
avg test loss is  3.594936867766797
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(16.5351, device='cuda:3')
compute_norm is  tensor(66.4264, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.8125, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5643090905665336
avg test loss is  2.849619044423866
avg accuracy is  0.10035000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(17.8125, device='cuda:3')
compute_norm is  tensor(65.8183, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.0322, device='cuda:3')
distance x is tensor(21.0322, device='cuda:3')
________________________________
test distance is  tensor(21.0322, device='cuda:3')
test distance1 is  tensor(21.0322, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.593564210415903
test entropy is  0.8512862559193487
________________________________
cal ratio is  0.7329349802630502
distance x is tensor(15.4197, device='cuda:3')
cal_distance is  tensor(15.4197, device='cuda:3')
cal ratio is  0.8559932010822927
distance x is tensor(13.1995, device='cuda:3')
cal_distance is  tensor(13.1995, device='cuda:3')
cal ratio is  0.9251859544116072
distance x is tensor(12.2122, device='cuda:3')
cal_distance is  tensor(12.2122, device='cuda:3')
cal ratio is  0.9618583349701513
distance x is tensor(11.7465, device='cuda:3')
cal_distance is  tensor(11.7465, device='cuda:3')
distance x is tensor(11.7465, device='cuda:3')
return_distance is  tensor(11.7465, device='cuda:3')
distance x is tensor(11.7414, device='cuda:3')
distance x is tensor(11.7414, device='cuda:3')
________________________________
test distance is  tensor(11.7414, device='cuda:3')
test distance1 is  tensor(11.7414, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7330587156800066
test entropy is  1.713328869103877
________________________________
0
distance x is tensor(11.7414, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7127882756912378
avg test loss is  2.732683080345837
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(11.7414, device='cuda:3')
compute_norm is  tensor(65.9097, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.6612, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.85428460638152
avg test loss is  3.5924821687913906
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(15.6612, device='cuda:3')
compute_norm is  tensor(66.0074, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18.2630, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5641484486777137
avg test loss is  2.849706138883318
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(18.2630, device='cuda:3')
compute_norm is  tensor(65.4071, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.3187, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8507428462825605
avg test loss is  3.593601392022074
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(22.3187, device='cuda:3')
compute_norm is  tensor(65.4502, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(25.0591, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5639214366992145
avg test loss is  2.8488781414052315
avg accuracy is  0.10028333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(25.0591, device='cuda:3')
compute_norm is  tensor(64.8462, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.1471, device='cuda:3')
distance x is tensor(29.1471, device='cuda:3')
________________________________
test distance is  tensor(29.1471, device='cuda:3')
test distance1 is  tensor(29.1471, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5934199811553142
test entropy is  0.8508269328044168
________________________________
cal ratio is  0.6226015370931286
distance x is tensor(18.1476, device='cuda:3')
cal_distance is  tensor(18.1476, device='cuda:3')
cal ratio is  0.7890381681108835
distance x is tensor(14.3193, device='cuda:3')
cal_distance is  tensor(14.3193, device='cuda:3')
cal ratio is  0.8882757157662474
distance x is tensor(12.7195, device='cuda:3')
cal_distance is  tensor(12.7195, device='cuda:3')
cal ratio is  0.942482229743208
distance x is tensor(11.9879, device='cuda:3')
cal_distance is  tensor(11.9879, device='cuda:3')
cal ratio is  0.9708143350000217
distance x is tensor(11.6381, device='cuda:3')
cal_distance is  tensor(11.6381, device='cuda:3')
distance x is tensor(11.6381, device='cuda:3')
return_distance is  tensor(11.6381, device='cuda:3')
distance x is tensor(11.6373, device='cuda:3')
distance x is tensor(11.6373, device='cuda:3')
________________________________
test distance is  tensor(11.6373, device='cuda:3')
test distance1 is  tensor(11.6373, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.5446776065236723
test entropy is  1.9701564858463019
________________________________
0
distance x is tensor(11.6373, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9699739163109997
avg test loss is  2.5448331893888363
avg accuracy is  0.10036666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(11.6373, device='cuda:3')
compute_norm is  tensor(65.5628, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16.2902, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8594625951257596
avg test loss is  3.584932734717184
avg accuracy is  0.10028333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(16.2902, device='cuda:3')
compute_norm is  tensor(65.7742, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(19.1284, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5670497961389993
avg test loss is  2.846777868169203
avg accuracy is  0.10036666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(19.1284, device='cuda:3')
compute_norm is  tensor(65.1788, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(23.3302, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8493849985253836
avg test loss is  3.594414496981005
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(23.3302, device='cuda:3')
compute_norm is  tensor(65.2231, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(26.1749, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5642373095443254
avg test loss is  2.849030611611633
avg accuracy is  0.1003833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(26.1749, device='cuda:3')
compute_norm is  tensor(64.6207, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(30.3347, device='cuda:3')
________________________________
test distance is  tensor(30.3347, device='cuda:3')
test similarity is  tensor(0.9993, device='cuda:3')
test acc is  0.10043333348966531
test loss is 3.593297868395157
test entropy is  0.848600439679648
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5624382495880127
mal norm is  tensor(166.4274, device='cuda:3')
distance x is tensor(30.3347, device='cuda:3')
mal distance is  tensor(30.3347, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 53.7090,  54.6405,  56.6567,  94.0425,  58.0407,  60.2823,  54.9776,
         78.9610, 166.4274, 166.4274, 166.4274, 166.4274, 166.4274, 166.4274,
        166.4274, 166.4274, 166.4274, 166.4274, 166.4274, 166.4274, 156.7043,
        155.5160, 166.8159, 308.7214, 156.8547, 156.7059, 155.6786, 160.8082,
         94.7115, 105.6715, 100.3279,  94.8308, 128.4292,  98.4003,  93.6597,
         95.0725,  70.5897,  64.4158, 121.9837,  64.0447,  52.8897,  61.6668,
         59.8845, 132.9857], device='cuda:3')
sorted_norm is   tensor([ 52.8897,  53.7090,  54.6405,  54.9776,  56.6567,  58.0407,  59.8845,
         60.2823,  61.6668,  64.0447,  64.4158,  70.5897,  78.9610,  93.6597,
         94.0425,  94.7115,  94.8308,  95.0725,  98.4003, 100.3279, 105.6715,
        121.9837, 128.4292, 132.9857, 155.5160, 155.6786, 156.7043, 156.7059,
        156.8547, 160.8082, 166.4274, 166.4274, 166.4274, 166.4274, 166.4274,
        166.4274, 166.4274, 166.4274, 166.4274, 166.4274, 166.4274, 166.4274,
        166.8159, 308.7214], device='cuda:3')
used idx is  tensor([40,  0,  1,  6,  2,  4, 42,  5, 41, 39, 37, 36,  7, 34,  3, 28, 31, 35,
        33, 30, 29, 38, 32, 43, 21, 26, 20, 25, 24, 27,  8,  9, 11, 10, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.01% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3027431964874268
distance x is tensor(0.7889, device='cuda:3')
benign distance is  tensor(0.7889, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.307526111602783
distance x is tensor(3.1357, device='cuda:3')
benign distance is  tensor(3.1357, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.317584276199341
distance x is tensor(0.9166, device='cuda:3')
benign distance is  tensor(0.9166, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.309108257293701
distance x is tensor(4.3979, device='cuda:3')
benign distance is  tensor(4.3979, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.282473087310791
distance x is tensor(1.6151, device='cuda:3')
benign distance is  tensor(1.6151, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.305253505706787
distance x is tensor(10.2979, device='cuda:3')
benign distance is  tensor(10.2979, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2941784858703613
distance x is tensor(0.9130, device='cuda:3')
benign distance is  tensor(0.9130, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3107969760894775
distance x is tensor(3.8644, device='cuda:3')
benign distance is  tensor(3.8644, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3348278999328613
distance x is tensor(1.5799, device='cuda:3')
benign distance is  tensor(1.5799, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.312678098678589
distance x is tensor(2.4369, device='cuda:3')
benign distance is  tensor(2.4369, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2917187213897705
distance x is tensor(1.4070, device='cuda:3')
benign distance is  tensor(1.4070, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.2935233116149902
distance x is tensor(0.9438, device='cuda:3')
benign distance is  tensor(0.9438, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.315944194793701
distance x is tensor(0.7521, device='cuda:3')
benign distance is  tensor(0.7521, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.319140911102295
distance x is tensor(1.5532, device='cuda:3')
benign distance is  tensor(1.5532, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.3057265281677246
distance x is tensor(2.5101, device='cuda:3')
benign distance is  tensor(2.5101, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2821223735809326
distance x is tensor(9.1108, device='cuda:3')
benign distance is  tensor(9.1108, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.327889919281006
distance x is tensor(2.7183, device='cuda:3')
benign distance is  tensor(2.7183, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.3266477584838867
distance x is tensor(1.4972, device='cuda:3')
benign distance is  tensor(1.4972, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.2761330604553223
distance x is tensor(8.1895, device='cuda:3')
benign distance is  tensor(8.1895, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.3436033725738525
distance x is tensor(1.0202, device='cuda:3')
benign distance is  tensor(1.0202, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.2959468364715576
distance x is tensor(12.4142, device='cuda:3')
benign distance is  tensor(12.4142, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.2898313999176025
distance x is tensor(40.7523, device='cuda:3')
benign distance is  tensor(40.7523, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.282208204269409
distance x is tensor(2.4927, device='cuda:3')
benign distance is  tensor(2.4927, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.3497745990753174
distance x is tensor(0.9820, device='cuda:3')
benign distance is  tensor(0.9820, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.2988178730010986
distance x is tensor(1.1632, device='cuda:3')
benign distance is  tensor(1.1632, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2948098182678223
distance x is tensor(1.0824, device='cuda:3')
benign distance is  tensor(1.0824, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.3572020530700684
distance x is tensor(1.2083, device='cuda:3')
benign distance is  tensor(1.2083, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.345104932785034
distance x is tensor(1.1618, device='cuda:3')
benign distance is  tensor(1.1618, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.27903413772583
distance x is tensor(0.9964, device='cuda:3')
benign distance is  tensor(0.9964, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.2991480827331543
distance x is tensor(1.8536, device='cuda:3')
benign distance is  tensor(1.8536, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.3257412910461426
distance x is tensor(1.3215, device='cuda:3')
benign distance is  tensor(1.3215, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.2606923580169678
distance x is tensor(2.7077, device='cuda:3')
benign distance is  tensor(2.7077, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(1.1936, device='cuda:3')
compute distance is  tensor(1.1936, device='cuda:3')
compute norm is  tensor(66.3682, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.0141, device='cuda:3')
compute distance is  tensor(1.0141, device='cuda:3')
compute norm is  tensor(66.2736, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.8857, device='cuda:3')
compute distance is  tensor(0.8857, device='cuda:3')
compute norm is  tensor(66.2936, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.0767, device='cuda:3')
compute distance is  tensor(1.0767, device='cuda:3')
compute norm is  tensor(66.3554, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1682, device='cuda:3')
compute distance is  tensor(2.1682, device='cuda:3')
compute norm is  tensor(66.3734, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.2436, device='cuda:3')
compute distance is  tensor(2.2436, device='cuda:3')
compute norm is  tensor(66.3282, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.8932, device='cuda:3')
compute distance is  tensor(0.8932, device='cuda:3')
compute norm is  tensor(66.2769, device='cuda:3', dtype=torch.float64)
distance x is tensor(6.8098, device='cuda:3')
compute distance is  tensor(6.8098, device='cuda:3')
compute norm is  tensor(66.3603, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.0019, device='cuda:3')
compute distance is  tensor(2.0019, device='cuda:3')
compute norm is  tensor(66.3150, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.4492, device='cuda:3')
compute distance is  tensor(1.4492, device='cuda:3')
compute norm is  tensor(66.3282, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.3368, device='cuda:3')
compute distance is  tensor(3.3368, device='cuda:3')
compute norm is  tensor(66.3435, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.0923, device='cuda:3')
compute distance is  tensor(1.0923, device='cuda:3')
compute norm is  tensor(66.2731, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(6.8098, device='cuda:3')
distance x is tensor(107472.4766, device='cuda:3')
distance x is tensor(107472.4766, device='cuda:3')
________________________________
test distance is  tensor(107472.4766, device='cuda:3')
test distance1 is  tensor(107472.4766, device='cuda:3')
test similarity is  tensor(0.6305, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130076749692438.92
test entropy is  0.0
________________________________
cal ratio is  0.007800920932413523
distance x is tensor(838.3893, device='cuda:3')
cal_distance is  tensor(838.3893, device='cuda:3')
cal ratio is  0.08832255700155844
distance x is tensor(74.0533, device='cuda:3')
cal_distance is  tensor(74.0533, device='cuda:3')
cal ratio is  0.2971818365997457
distance x is tensor(22.0111, device='cuda:3')
cal_distance is  tensor(22.0111, device='cuda:3')
cal ratio is  0.5450973519161036
distance x is tensor(12.0008, device='cuda:3')
cal_distance is  tensor(12.0008, device='cuda:3')
cal ratio is  0.7382263650343555
distance x is tensor(8.8609, device='cuda:3')
cal_distance is  tensor(8.8609, device='cuda:3')
cal ratio is  0.8591230338934551
distance x is tensor(7.6135, device='cuda:3')
cal_distance is  tensor(7.6135, device='cuda:3')
cal ratio is  0.9268342755400417
distance x is tensor(7.0569, device='cuda:3')
cal_distance is  tensor(7.0569, device='cuda:3')
cal ratio is  0.9626897471401133
distance x is tensor(6.7939, device='cuda:3')
cal_distance is  tensor(6.7939, device='cuda:3')
distance x is tensor(6.7939, device='cuda:3')
return_distance is  tensor(6.7939, device='cuda:3')
distance x is tensor(6.7840, device='cuda:3')
distance x is tensor(6.7840, device='cuda:3')
________________________________
test distance is  tensor(6.7840, device='cuda:3')
test distance1 is  tensor(6.7840, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10011666682299865
test loss is 2.3053566522435593
test entropy is  2.2993360920501416
________________________________
0
distance x is tensor(6.7840, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2993387680318054
avg test loss is  2.3055941778967886
avg accuracy is  0.09916666682299866
solo acc is  0.10010000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(6.7840, device='cuda:3')
compute_norm is  tensor(66.5863, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10.2200, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9912813972435526
avg test loss is  3.424334006268841
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9989, device='cuda:3')
compute_distance is  tensor(10.2200, device='cuda:3')
compute_norm is  tensor(67.2934, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11.0287, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5681580438542722
avg test loss is  2.84936965706506
avg accuracy is  0.10030000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(11.0287, device='cuda:3')
compute_norm is  tensor(66.6931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(14.3539, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8781647938273863
avg test loss is  3.561653857800498
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(14.3539, device='cuda:3')
compute_norm is  tensor(66.7986, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16.6089, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5640626764500827
avg test loss is  2.8505501360781413
avg accuracy is  0.10028333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(16.6089, device='cuda:3')
compute_norm is  tensor(66.1282, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(20.7325, device='cuda:3')
distance x is tensor(20.7325, device='cuda:3')
________________________________
test distance is  tensor(20.7325, device='cuda:3')
test distance1 is  tensor(20.7325, device='cuda:3')
test similarity is  tensor(0.9987, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5611284788229316
test entropy is  0.8752808093007948
________________________________
cal ratio is  0.5616531411534191
distance x is tensor(11.6460, device='cuda:3')
cal_distance is  tensor(11.6460, device='cuda:3')
cal ratio is  0.7493863302333534
distance x is tensor(8.7276, device='cuda:3')
cal_distance is  tensor(8.7276, device='cuda:3')
cal ratio is  0.8656589026852687
distance x is tensor(7.5553, device='cuda:3')
cal_distance is  tensor(7.5553, device='cuda:3')
cal ratio is  0.9303997423412519
distance x is tensor(7.0295, device='cuda:3')
cal_distance is  tensor(7.0295, device='cuda:3')
cal ratio is  0.9645675966133976
distance x is tensor(6.7805, device='cuda:3')
cal_distance is  tensor(6.7805, device='cuda:3')
distance x is tensor(6.7805, device='cuda:3')
return_distance is  tensor(6.7805, device='cuda:3')
distance x is tensor(6.7785, device='cuda:3')
distance x is tensor(6.7785, device='cuda:3')
________________________________
test distance is  tensor(6.7785, device='cuda:3')
test distance1 is  tensor(6.7785, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.397789930483934
test entropy is  2.1793039922775237
________________________________
0
distance x is tensor(6.7785, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1793829027269442
avg test loss is  2.3979702860053416
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(6.7785, device='cuda:3')
compute_norm is  tensor(66.1725, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.1753, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9226140730670774
avg test loss is  3.506563648486188
avg accuracy is  0.10026666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9989, device='cuda:3')
compute_distance is  tensor(12.1753, device='cuda:3')
compute_norm is  tensor(66.6689, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(14.8977, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5661930294433382
avg test loss is  2.849391139138228
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(14.8977, device='cuda:3')
compute_norm is  tensor(66.0366, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.2765, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8732786296781446
avg test loss is  3.565385584638063
avg accuracy is  0.10021666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(19.2765, device='cuda:3')
compute_norm is  tensor(66.1387, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.9893, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5630760762228895
avg test loss is  2.849923117074377
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(21.9893, device='cuda:3')
compute_norm is  tensor(65.4750, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(26.3203, device='cuda:3')
distance x is tensor(26.3203, device='cuda:3')
________________________________
test distance is  tensor(26.3203, device='cuda:3')
test distance1 is  tensor(26.3203, device='cuda:3')
test similarity is  tensor(0.9987, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5639516931098663
test entropy is  0.8716902268339576
________________________________
cal ratio is  0.4984814940860976
distance x is tensor(13.1198, device='cuda:3')
cal_distance is  tensor(13.1198, device='cuda:3')
cal ratio is  0.706043359047745
distance x is tensor(9.2631, device='cuda:3')
cal_distance is  tensor(9.2631, device='cuda:3')
cal ratio is  0.840267374281851
distance x is tensor(7.7834, device='cuda:3')
cal_distance is  tensor(7.7834, device='cuda:3')
cal ratio is  0.9166635332892068
distance x is tensor(7.1347, device='cuda:3')
cal_distance is  tensor(7.1347, device='cuda:3')
cal ratio is  0.9574269604277442
distance x is tensor(6.8310, device='cuda:3')
cal_distance is  tensor(6.8310, device='cuda:3')
cal ratio is  0.978482756918883
distance x is tensor(6.6840, device='cuda:3')
cal_distance is  tensor(6.6840, device='cuda:3')
distance x is tensor(6.6840, device='cuda:3')
return_distance is  tensor(6.6840, device='cuda:3')
distance x is tensor(6.6845, device='cuda:3')
distance x is tensor(6.6845, device='cuda:3')
________________________________
test distance is  tensor(6.6845, device='cuda:3')
test distance1 is  tensor(6.6845, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.360319928319724
test entropy is  2.231108784675598
________________________________
0
distance x is tensor(6.6845, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2312876413117593
avg test loss is  2.359952748457252
avg accuracy is  0.10036666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(6.6845, device='cuda:3')
compute_norm is  tensor(66.0292, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.3952, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9317941431806032
avg test loss is  3.494884894092454
avg accuracy is  0.10026666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9989, device='cuda:3')
compute_distance is  tensor(12.3952, device='cuda:3')
compute_norm is  tensor(66.5852, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.1865, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.56467670863117
avg test loss is  2.8508115351073013
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:3')
compute_distance is  tensor(15.1865, device='cuda:3')
compute_norm is  tensor(65.9608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.5953, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8722859947666176
avg test loss is  3.568744606300712
avg accuracy is  0.10030000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(19.5953, device='cuda:3')
compute_norm is  tensor(66.0613, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22.3265, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5648469711417583
avg test loss is  2.8498105191981105
avg accuracy is  0.10036666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(22.3265, device='cuda:3')
compute_norm is  tensor(65.3981, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(26.6715, device='cuda:3')
________________________________
test distance is  tensor(26.6715, device='cuda:3')
test similarity is  tensor(0.9987, device='cuda:3')
test acc is  0.10036666682299865
test loss is 3.564687013880276
test entropy is  0.8724175894946686
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5151138305664062
mal norm is  tensor(191.0758, device='cuda:3')
distance x is tensor(26.6715, device='cuda:3')
mal distance is  tensor(26.6715, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 33.5287,  51.2996,  41.1741,  50.9958,  43.0310, 110.2045,  40.8918,
         50.6612, 191.0758, 191.0758, 191.0758, 191.0758, 191.0758, 191.0758,
        191.0758, 191.0758, 191.0758, 191.0758, 191.0758, 191.0758],
       device='cuda:3')
sorted_norm is   tensor([ 33.5287,  40.8918,  41.1741,  43.0310,  50.6612,  50.9958,  51.2996,
        110.2045, 191.0758, 191.0758, 191.0758, 191.0758, 191.0758, 191.0758,
        191.0758, 191.0758, 191.0758, 191.0758, 191.0758, 191.0758],
       device='cuda:3')
used idx is  tensor([ 0,  6,  2,  4,  7,  3,  1,  5, 18, 16, 12, 14, 10,  8, 17, 19],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.296712636947632
distance x is tensor(1.8047, device='cuda:3')
benign distance is  tensor(1.8047, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.283663749694824
distance x is tensor(1.7830, device='cuda:3')
benign distance is  tensor(1.7830, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2978596687316895
distance x is tensor(2.0195, device='cuda:3')
benign distance is  tensor(2.0195, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2967867851257324
distance x is tensor(14.5155, device='cuda:3')
benign distance is  tensor(14.5155, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.306884765625
distance x is tensor(3.1795, device='cuda:3')
benign distance is  tensor(3.1795, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.303035259246826
distance x is tensor(2.2249, device='cuda:3')
benign distance is  tensor(2.2249, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.291194438934326
distance x is tensor(1.9114, device='cuda:3')
benign distance is  tensor(1.9114, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2787110805511475
distance x is tensor(18.0831, device='cuda:3')
benign distance is  tensor(18.0831, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(4.3101, device='cuda:3')
compute distance is  tensor(4.3101, device='cuda:3')
compute norm is  tensor(65.3619, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7762, device='cuda:3')
compute distance is  tensor(1.7762, device='cuda:3')
compute norm is  tensor(65.3367, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.9224, device='cuda:3')
compute distance is  tensor(11.9224, device='cuda:3')
compute norm is  tensor(65.4149, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3824, device='cuda:3')
compute distance is  tensor(2.3824, device='cuda:3')
compute norm is  tensor(65.3821, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.5289, device='cuda:3')
compute distance is  tensor(3.5289, device='cuda:3')
compute norm is  tensor(65.3633, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.9892, device='cuda:3')
compute distance is  tensor(2.9892, device='cuda:3')
compute norm is  tensor(65.3388, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8995, device='cuda:3')
compute distance is  tensor(2.8995, device='cuda:3')
compute norm is  tensor(65.2847, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.8884, device='cuda:3')
compute distance is  tensor(11.8884, device='cuda:3')
compute norm is  tensor(65.3653, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.0342, device='cuda:3')
compute distance is  tensor(3.0342, device='cuda:3')
compute norm is  tensor(65.3028, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.3070, device='cuda:3')
compute distance is  tensor(3.3070, device='cuda:3')
compute norm is  tensor(65.3349, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.8517, device='cuda:3')
compute distance is  tensor(3.8517, device='cuda:3')
compute norm is  tensor(65.4006, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3431, device='cuda:3')
compute distance is  tensor(2.3431, device='cuda:3')
compute norm is  tensor(65.3243, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(11.9224, device='cuda:3')
distance x is tensor(107472.6953, device='cuda:3')
distance x is tensor(107472.6953, device='cuda:3')
________________________________
test distance is  tensor(107472.6953, device='cuda:3')
test distance1 is  tensor(107472.6953, device='cuda:3')
test similarity is  tensor(0.6303, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130000376245861.53
test entropy is  0.0
________________________________
cal ratio is  0.010321860196902012
distance x is tensor(1109.3232, device='cuda:3')
cal_distance is  tensor(1109.3232, device='cuda:3')
cal ratio is  0.1015963232940115
distance x is tensor(112.7077, device='cuda:3')
cal_distance is  tensor(112.7077, device='cuda:3')
cal ratio is  0.3187353659430733
distance x is tensor(35.9275, device='cuda:3')
cal_distance is  tensor(35.9275, device='cuda:3')
cal ratio is  0.5645387078686618
distance x is tensor(20.2848, device='cuda:3')
cal_distance is  tensor(20.2848, device='cuda:3')
cal ratio is  0.7513138002606989
distance x is tensor(15.2417, device='cuda:3')
cal_distance is  tensor(15.2417, device='cuda:3')
cal ratio is  0.86674328495755
distance x is tensor(13.2114, device='cuda:3')
cal_distance is  tensor(13.2114, device='cuda:3')
cal ratio is  0.9309630321140014
distance x is tensor(12.2997, device='cuda:3')
cal_distance is  tensor(12.2997, device='cuda:3')
cal ratio is  0.9648481489567728
distance x is tensor(11.8676, device='cuda:3')
cal_distance is  tensor(11.8676, device='cuda:3')
distance x is tensor(11.8676, device='cuda:3')
return_distance is  tensor(11.8676, device='cuda:3')
distance x is tensor(11.8577, device='cuda:3')
distance x is tensor(11.8577, device='cuda:3')
________________________________
test distance is  tensor(11.8577, device='cuda:3')
test distance1 is  tensor(11.8577, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.4870894616092447
test entropy is  2.0539115931687832
________________________________
0
distance x is tensor(11.8577, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.053668732327947
avg test loss is  2.4861239301624583
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(11.8577, device='cuda:3')
compute_norm is  tensor(66.1210, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.6746, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.901798426151784
avg test loss is  3.531022448021212
avg accuracy is  0.10040000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(13.6746, device='cuda:3')
compute_norm is  tensor(66.5066, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(13.9320, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5649950585639807
avg test loss is  2.8499698143269714
avg accuracy is  0.10041666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(13.9320, device='cuda:3')
compute_norm is  tensor(65.8661, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16.2202, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8695702733896943
avg test loss is  3.5689115229445987
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(16.2202, device='cuda:3')
compute_norm is  tensor(65.9666, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.3410, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5635030185744199
avg test loss is  2.850070449080803
avg accuracy is  0.10030000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(17.3410, device='cuda:3')
compute_norm is  tensor(65.3042, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(20.5509, device='cuda:3')
distance x is tensor(20.5509, device='cuda:3')
________________________________
test distance is  tensor(20.5509, device='cuda:3')
test distance1 is  tensor(20.5509, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5659751129557073
test entropy is  0.869521312749208
________________________________
cal ratio is  0.7464337227093427
distance x is tensor(15.3446, device='cuda:3')
cal_distance is  tensor(15.3446, device='cuda:3')
cal ratio is  0.8638332993934689
distance x is tensor(13.2555, device='cuda:3')
cal_distance is  tensor(13.2555, device='cuda:3')
cal ratio is  0.9294135949048636
distance x is tensor(12.3200, device='cuda:3')
cal_distance is  tensor(12.3200, device='cuda:3')
cal ratio is  0.9640535730106287
distance x is tensor(11.8773, device='cuda:3')
cal_distance is  tensor(11.8773, device='cuda:3')
distance x is tensor(11.8773, device='cuda:3')
return_distance is  tensor(11.8773, device='cuda:3')
distance x is tensor(11.8720, device='cuda:3')
distance x is tensor(11.8720, device='cuda:3')
________________________________
test distance is  tensor(11.8720, device='cuda:3')
test distance1 is  tensor(11.8720, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.959185763462774
test entropy is  1.4353225881865284
________________________________
0
distance x is tensor(11.8720, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4334906249412342
avg test loss is  2.9601897184274346
avg accuracy is  0.10043333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(11.8720, device='cuda:3')
compute_norm is  tensor(65.4957, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.5236, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8612697187390155
avg test loss is  3.5802404227287274
avg accuracy is  0.10041666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(15.5236, device='cuda:3')
compute_norm is  tensor(65.5292, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.9793, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5632376562811927
avg test loss is  2.8491733796052587
avg accuracy is  0.10036666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(17.9793, device='cuda:3')
compute_norm is  tensor(64.8671, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.0538, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.867591559505666
avg test loss is  3.5683865720020935
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(22.0538, device='cuda:3')
compute_norm is  tensor(64.9691, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(24.6726, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.560375159101954
avg test loss is  2.8514475001455115
avg accuracy is  0.10041666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(24.6726, device='cuda:3')
compute_norm is  tensor(64.3093, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(28.7761, device='cuda:3')
distance x is tensor(28.7761, device='cuda:3')
________________________________
test distance is  tensor(28.7761, device='cuda:3')
test distance1 is  tensor(28.7761, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.563785666087543
test entropy is  0.8691320781514589
________________________________
cal ratio is  0.6307994906226274
distance x is tensor(18.1526, device='cuda:3')
cal_distance is  tensor(18.1526, device='cuda:3')
cal ratio is  0.7942146418238389
distance x is tensor(14.4171, device='cuda:3')
cal_distance is  tensor(14.4171, device='cuda:3')
cal ratio is  0.891184640309573
distance x is tensor(12.8484, device='cuda:3')
cal_distance is  tensor(12.8484, device='cuda:3')
cal ratio is  0.94402413384655
distance x is tensor(12.1292, device='cuda:3')
cal_distance is  tensor(12.1292, device='cuda:3')
cal ratio is  0.971608124855243
distance x is tensor(11.7848, device='cuda:3')
cal_distance is  tensor(11.7848, device='cuda:3')
distance x is tensor(11.7848, device='cuda:3')
return_distance is  tensor(11.7848, device='cuda:3')
distance x is tensor(11.7840, device='cuda:3')
distance x is tensor(11.7840, device='cuda:3')
________________________________
test distance is  tensor(11.7840, device='cuda:3')
test distance1 is  tensor(11.7840, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7813557368605886
test entropy is  1.650413059603685
________________________________
0
distance x is tensor(11.7840, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6521526137903046
avg test loss is  2.779876285270333
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(11.7840, device='cuda:3')
compute_norm is  tensor(65.1366, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16.1466, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8720161699409932
avg test loss is  3.5658308694611733
avg accuracy is  0.10030000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(16.1466, device='cuda:3')
compute_norm is  tensor(65.2821, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18.8645, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5629588257529334
avg test loss is  2.8500247344787697
avg accuracy is  0.10041666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(18.8645, device='cuda:3')
compute_norm is  tensor(64.6281, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(23.0938, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8702896447705307
avg test loss is  3.565606199093719
avg accuracy is  0.10035000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(23.0938, device='cuda:3')
compute_norm is  tensor(64.7311, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(25.8286, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.561881732711914
avg test loss is  2.8498463447668403
avg accuracy is  0.10040000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(25.8286, device='cuda:3')
compute_norm is  tensor(64.0734, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(30.0102, device='cuda:3')
________________________________
test distance is  tensor(30.0102, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10038333348966531
test loss is 3.564449214731961
test entropy is  0.8684790534124192
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.65837025642395
mal norm is  tensor(147.7325, device='cuda:3')
distance x is tensor(30.0102, device='cuda:3')
mal distance is  tensor(30.0102, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 95.3263,  89.3473,  99.4886, 161.8628,  98.1027, 107.6024,  99.8844,
        176.8469, 147.7326, 147.7326, 147.7326, 147.7326, 147.7326, 147.7326,
        147.7326, 147.7326, 147.7326, 147.7326, 147.7326, 147.7326, 151.2038,
        153.2184, 139.2794, 151.6539, 145.0873, 203.3866, 147.6237, 150.1747,
        173.4551, 166.5773, 137.8214, 118.6265, 105.0540, 116.5886, 105.5031,
        107.4654, 123.4858, 116.7944, 119.4578, 108.5312, 102.3506, 107.6777,
        110.5921, 158.3587], device='cuda:3')
sorted_norm is   tensor([ 89.3473,  95.3263,  98.1027,  99.4886,  99.8844, 102.3506, 105.0540,
        105.5031, 107.4654, 107.6024, 107.6777, 108.5312, 110.5921, 116.5886,
        116.7944, 118.6265, 119.4578, 123.4858, 137.8214, 139.2794, 145.0873,
        147.6237, 147.7326, 147.7326, 147.7326, 147.7326, 147.7326, 147.7326,
        147.7326, 147.7326, 147.7326, 147.7326, 147.7326, 147.7326, 150.1747,
        151.2038, 151.6539, 153.2184, 158.3587, 161.8628, 166.5773, 173.4551,
        176.8469, 203.3866], device='cuda:3')
used idx is  tensor([ 1,  0,  4,  2,  6, 40, 32, 34, 35,  5, 41, 39, 42, 33, 37, 31, 38, 36,
        30, 22, 24, 26, 14, 12, 17, 15, 11, 10, 13, 19, 16, 18,  8,  9, 27],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2916483879089355
distance x is tensor(1.3574, device='cuda:3')
benign distance is  tensor(1.3574, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2942168712615967
distance x is tensor(1.7226, device='cuda:3')
benign distance is  tensor(1.7226, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3090157508850098
distance x is tensor(2.3376, device='cuda:3')
benign distance is  tensor(2.3376, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3039145469665527
distance x is tensor(7.6817, device='cuda:3')
benign distance is  tensor(7.6817, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3199574947357178
distance x is tensor(2.5604, device='cuda:3')
benign distance is  tensor(2.5604, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3009135723114014
distance x is tensor(2.5506, device='cuda:3')
benign distance is  tensor(2.5506, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2893996238708496
distance x is tensor(1.3343, device='cuda:3')
benign distance is  tensor(1.3343, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2921464443206787
distance x is tensor(5.7787, device='cuda:3')
benign distance is  tensor(5.7787, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3311142921447754
distance x is tensor(1.9763, device='cuda:3')
benign distance is  tensor(1.9763, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3188881874084473
distance x is tensor(2.1978, device='cuda:3')
benign distance is  tensor(2.1978, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2744455337524414
distance x is tensor(17.3241, device='cuda:3')
benign distance is  tensor(17.3241, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.180314779281616
distance x is tensor(6.0441, device='cuda:3')
benign distance is  tensor(6.0441, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.30771803855896
distance x is tensor(1.1894, device='cuda:3')
benign distance is  tensor(1.1894, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.291670322418213
distance x is tensor(1.9089, device='cuda:3')
benign distance is  tensor(1.9089, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2928833961486816
distance x is tensor(9.1517, device='cuda:3')
benign distance is  tensor(9.1517, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2842705249786377
distance x is tensor(12.2557, device='cuda:3')
benign distance is  tensor(12.2557, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.3366506099700928
distance x is tensor(8.2593, device='cuda:3')
benign distance is  tensor(8.2593, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2840421199798584
distance x is tensor(11.7893, device='cuda:3')
benign distance is  tensor(11.7893, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2749557495117188
distance x is tensor(18.2140, device='cuda:3')
benign distance is  tensor(18.2140, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.3085358142852783
distance x is tensor(15.1323, device='cuda:3')
benign distance is  tensor(15.1323, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.307577610015869
distance x is tensor(1.3231, device='cuda:3')
benign distance is  tensor(1.3231, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.305850028991699
distance x is tensor(2.3320, device='cuda:3')
benign distance is  tensor(2.3320, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.273238182067871
distance x is tensor(1.6216, device='cuda:3')
benign distance is  tensor(1.6216, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.32309627532959
distance x is tensor(1.9110, device='cuda:3')
benign distance is  tensor(1.9110, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.3089022636413574
distance x is tensor(2.8766, device='cuda:3')
benign distance is  tensor(2.8766, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.3026843070983887
distance x is tensor(14.5880, device='cuda:3')
benign distance is  tensor(14.5880, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.3089439868927
distance x is tensor(1.2140, device='cuda:3')
benign distance is  tensor(1.2140, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.3627116680145264
distance x is tensor(20.5841, device='cuda:3')
benign distance is  tensor(20.5841, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.2569448947906494
distance x is tensor(1.5502, device='cuda:3')
benign distance is  tensor(1.5502, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.3503055572509766
distance x is tensor(12.1664, device='cuda:3')
benign distance is  tensor(12.1664, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.3228020668029785
distance x is tensor(16.3141, device='cuda:3')
benign distance is  tensor(16.3141, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.3392271995544434
distance x is tensor(6.7471, device='cuda:3')
benign distance is  tensor(6.7471, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(13.9579, device='cuda:3')
compute distance is  tensor(13.9579, device='cuda:3')
compute norm is  tensor(65.1647, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3848, device='cuda:3')
compute distance is  tensor(1.3848, device='cuda:3')
compute norm is  tensor(65.0645, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.0747, device='cuda:3')
compute distance is  tensor(10.0747, device='cuda:3')
compute norm is  tensor(65.0838, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.8580, device='cuda:3')
compute distance is  tensor(1.8580, device='cuda:3')
compute norm is  tensor(65.1299, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.5046, device='cuda:3')
compute distance is  tensor(4.5046, device='cuda:3')
compute norm is  tensor(65.1056, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.1712, device='cuda:3')
compute distance is  tensor(2.1712, device='cuda:3')
compute norm is  tensor(65.0414, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.3762, device='cuda:3')
compute distance is  tensor(3.3762, device='cuda:3')
compute norm is  tensor(65.0413, device='cuda:3', dtype=torch.float64)
distance x is tensor(16.2204, device='cuda:3')
compute distance is  tensor(16.2204, device='cuda:3')
compute norm is  tensor(65.1691, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.4767, device='cuda:3')
compute distance is  tensor(3.4767, device='cuda:3')
compute norm is  tensor(65.0669, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8337, device='cuda:3')
compute distance is  tensor(2.8337, device='cuda:3')
compute norm is  tensor(65.0567, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.3749, device='cuda:3')
compute distance is  tensor(2.3749, device='cuda:3')
compute norm is  tensor(65.1503, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.6736, device='cuda:3')
compute distance is  tensor(1.6736, device='cuda:3')
compute norm is  tensor(65.0319, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(16.2204, device='cuda:3')
distance x is tensor(107473.0859, device='cuda:3')
distance x is tensor(107473.0859, device='cuda:3')
________________________________
test distance is  tensor(107473.0859, device='cuda:3')
test distance1 is  tensor(107473.0859, device='cuda:3')
test similarity is  tensor(0.6304, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130045860038599.23
test entropy is  0.0
________________________________
cal ratio is  0.01203947667201458
distance x is tensor(1293.9249, device='cuda:3')
cal_distance is  tensor(1293.9249, device='cuda:3')
cal ratio is  0.10972432799354057
distance x is tensor(141.9795, device='cuda:3')
cal_distance is  tensor(141.9795, device='cuda:3')
cal ratio is  0.33124141367544324
distance x is tensor(47.0329, device='cuda:3')
cal_distance is  tensor(47.0329, device='cuda:3')
cal ratio is  0.5755147128946282
distance x is tensor(27.0704, device='cuda:3')
cal_distance is  tensor(27.0704, device='cuda:3')
cal ratio is  0.7585951457457661
distance x is tensor(20.5368, device='cuda:3')
cal_distance is  tensor(20.5368, device='cuda:3')
cal ratio is  0.8709453347123707
distance x is tensor(17.8872, device='cuda:3')
cal_distance is  tensor(17.8872, device='cuda:3')
cal ratio is  0.9332254887005353
distance x is tensor(16.6931, device='cuda:3')
cal_distance is  tensor(16.6931, device='cuda:3')
cal ratio is  0.9660249213030913
distance x is tensor(16.1262, device='cuda:3')
cal_distance is  tensor(16.1262, device='cuda:3')
distance x is tensor(16.1262, device='cuda:3')
return_distance is  tensor(16.1262, device='cuda:3')
distance x is tensor(16.1163, device='cuda:3')
distance x is tensor(16.1163, device='cuda:3')
________________________________
test distance is  tensor(16.1163, device='cuda:3')
test distance1 is  tensor(16.1163, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.362170159181298
test entropy is  2.2284455098577145
________________________________
0
distance x is tensor(16.1163, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2285069166216007
avg test loss is  2.361815841213218
avg accuracy is  0.10038333348966531
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(16.1163, device='cuda:3')
compute_norm is  tensor(65.8363, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.2033, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9212586434919443
avg test loss is  3.5059984825821573
avg accuracy is  0.10033333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(18.2033, device='cuda:3')
compute_norm is  tensor(66.3889, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18.2591, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5661478204005308
avg test loss is  2.848498091514685
avg accuracy is  0.10040000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(18.2591, device='cuda:3')
compute_norm is  tensor(65.7605, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(20.2848, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8689123825477892
avg test loss is  3.570476779043039
avg accuracy is  0.1003333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(20.2848, device='cuda:3')
compute_norm is  tensor(65.8630, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(20.9473, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5630288816718405
avg test loss is  2.8503283030951203
avg accuracy is  0.10038333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(20.9473, device='cuda:3')
compute_norm is  tensor(65.2013, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(23.5106, device='cuda:3')
distance x is tensor(23.5106, device='cuda:3')
________________________________
test distance is  tensor(23.5106, device='cuda:3')
test distance1 is  tensor(23.5106, device='cuda:3')
test similarity is  tensor(0.9991, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.568059275399393
test entropy is  0.8682365404771589
________________________________
cal ratio is  0.8140025836911777
distance x is tensor(19.1451, device='cuda:3')
cal_distance is  tensor(19.1451, device='cuda:3')
cal ratio is  0.9020466621307356
distance x is tensor(17.2701, device='cuda:3')
cal_distance is  tensor(17.2701, device='cuda:3')
cal ratio is  0.9497503639922382
distance x is tensor(16.4025, device='cuda:3')
cal_distance is  tensor(16.4025, device='cuda:3')
cal ratio is  0.9745452672633159
distance x is tensor(15.9851, device='cuda:3')
cal_distance is  tensor(15.9851, device='cuda:3')
distance x is tensor(15.9851, device='cuda:3')
return_distance is  tensor(15.9851, device='cuda:3')
distance x is tensor(15.9770, device='cuda:3')
distance x is tensor(15.9770, device='cuda:3')
________________________________
test distance is  tensor(15.9770, device='cuda:3')
test distance1 is  tensor(15.9770, device='cuda:3')
test similarity is  tensor(0.9996, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.9536465103946514
test entropy is  1.4402733745097098
________________________________
0
distance x is tensor(15.9770, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4409042765845115
avg test loss is  2.953887649436495
avg accuracy is  0.10041666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(15.9770, device='cuda:3')
compute_norm is  tensor(65.2354, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.9308, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8618091506871588
avg test loss is  3.5803429661020796
avg accuracy is  0.1003333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(18.9308, device='cuda:3')
compute_norm is  tensor(65.2720, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(20.9329, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5624262742650534
avg test loss is  2.84914661445089
avg accuracy is  0.10040000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(20.9329, device='cuda:3')
compute_norm is  tensor(64.6113, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(24.7590, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8685193399249364
avg test loss is  3.5673662942609807
avg accuracy is  0.10043333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(24.7590, device='cuda:3')
compute_norm is  tensor(64.7136, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(27.1664, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5627035599019228
avg test loss is  2.8500202002047477
avg accuracy is  0.10045000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(27.1664, device='cuda:3')
compute_norm is  tensor(64.0553, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(31.1485, device='cuda:3')
distance x is tensor(31.1485, device='cuda:3')
________________________________
test distance is  tensor(31.1485, device='cuda:3')
test distance1 is  tensor(31.1485, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.566822869182904
test entropy is  0.8672635361456922
________________________________
cal ratio is  0.7071942904319545
distance x is tensor(22.0296, device='cuda:3')
cal_distance is  tensor(22.0296, device='cuda:3')
cal ratio is  0.8409183413542717
distance x is tensor(18.5253, device='cuda:3')
cal_distance is  tensor(18.5253, device='cuda:3')
cal ratio is  0.9170123044928365
distance x is tensor(16.9880, device='cuda:3')
cal_distance is  tensor(16.9880, device='cuda:3')
cal ratio is  0.9576054161448428
distance x is tensor(16.2678, device='cuda:3')
cal_distance is  tensor(16.2678, device='cuda:3')
cal ratio is  0.9785719408714139
distance x is tensor(15.9193, device='cuda:3')
cal_distance is  tensor(15.9193, device='cuda:3')
distance x is tensor(15.9193, device='cuda:3')
return_distance is  tensor(15.9193, device='cuda:3')
distance x is tensor(15.9174, device='cuda:3')
distance x is tensor(15.9174, device='cuda:3')
________________________________
test distance is  tensor(15.9174, device='cuda:3')
test distance1 is  tensor(15.9174, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7213315841739876
test entropy is  1.7290175010654718
________________________________
0
distance x is tensor(15.9174, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7297709070797413
avg test loss is  2.7197933911260512
avg accuracy is  0.1003833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(15.9174, device='cuda:3')
compute_norm is  tensor(64.6315, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(20.2431, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8763685579111835
avg test loss is  3.5588033321315544
avg accuracy is  0.10045000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(20.2431, device='cuda:3')
compute_norm is  tensor(64.8155, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22.8592, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5631321015388473
avg test loss is  2.8499453883689605
avg accuracy is  0.10046666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(22.8592, device='cuda:3')
compute_norm is  tensor(64.1683, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(27.0177, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8661648395981616
avg test loss is  3.568412914967486
avg accuracy is  0.10033333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(27.0177, device='cuda:3')
compute_norm is  tensor(64.2722, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(29.6566, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5622797997267261
avg test loss is  2.8496265119072723
avg accuracy is  0.10031666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(29.6566, device='cuda:3')
compute_norm is  tensor(63.6166, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(33.7944, device='cuda:3')
________________________________
test distance is  tensor(33.7944, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10043333348966532
test loss is 3.5656785881087214
test entropy is  0.867503224977298
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.6167995929718018
mal norm is  tensor(172.6148, device='cuda:3')
distance x is tensor(33.7944, device='cuda:3')
mal distance is  tensor(33.7944, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 66.0992,  63.8339,  70.5256,  87.0857,  66.9092,  78.3892,  67.5352,
         82.0451, 172.6148, 172.6148, 172.6148, 172.6148, 172.6148, 172.6148,
        172.6148, 172.6148, 172.6148, 172.6148, 172.6148, 172.6148],
       device='cuda:3')
sorted_norm is   tensor([ 63.8339,  66.0992,  66.9092,  67.5352,  70.5256,  78.3892,  82.0451,
         87.0857, 172.6148, 172.6148, 172.6148, 172.6148, 172.6148, 172.6148,
        172.6148, 172.6148, 172.6148, 172.6148, 172.6148, 172.6148],
       device='cuda:3')
used idx is  tensor([ 1,  0,  4,  6,  2,  5,  7,  3, 19, 17, 13, 15, 11,  9, 16, 18],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.289515972137451
distance x is tensor(1.8733, device='cuda:3')
benign distance is  tensor(1.8733, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.30102276802063
distance x is tensor(2.2261, device='cuda:3')
benign distance is  tensor(2.2261, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3176779747009277
distance x is tensor(6.0294, device='cuda:3')
benign distance is  tensor(6.0294, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2886288166046143
distance x is tensor(18.0564, device='cuda:3')
benign distance is  tensor(18.0564, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3075881004333496
distance x is tensor(2.4965, device='cuda:3')
benign distance is  tensor(2.4965, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2183306217193604
distance x is tensor(3.7932, device='cuda:3')
benign distance is  tensor(3.7932, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3066439628601074
distance x is tensor(1.9415, device='cuda:3')
benign distance is  tensor(1.9415, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.305414915084839
distance x is tensor(4.9996, device='cuda:3')
benign distance is  tensor(4.9996, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(11.6568, device='cuda:3')
compute distance is  tensor(11.6568, device='cuda:3')
compute norm is  tensor(63.9298, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.7629, device='cuda:3')
compute distance is  tensor(1.7629, device='cuda:3')
compute norm is  tensor(63.8383, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.4917, device='cuda:3')
compute distance is  tensor(13.4917, device='cuda:3')
compute norm is  tensor(63.8632, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.3552, device='cuda:3')
compute distance is  tensor(3.3552, device='cuda:3')
compute norm is  tensor(63.8495, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.5775, device='cuda:3')
compute distance is  tensor(4.5775, device='cuda:3')
compute norm is  tensor(63.8701, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.1260, device='cuda:3')
compute distance is  tensor(3.1260, device='cuda:3')
compute norm is  tensor(63.8382, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.6061, device='cuda:3')
compute distance is  tensor(4.6061, device='cuda:3')
compute norm is  tensor(63.7808, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.6734, device='cuda:3')
compute distance is  tensor(9.6734, device='cuda:3')
compute norm is  tensor(63.8875, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.0311, device='cuda:3')
compute distance is  tensor(4.0311, device='cuda:3')
compute norm is  tensor(63.7841, device='cuda:3', dtype=torch.float64)
distance x is tensor(15.2712, device='cuda:3')
compute distance is  tensor(15.2712, device='cuda:3')
compute norm is  tensor(63.8695, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.9448, device='cuda:3')
compute distance is  tensor(4.9448, device='cuda:3')
compute norm is  tensor(63.9049, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.0898, device='cuda:3')
compute distance is  tensor(10.0898, device='cuda:3')
compute norm is  tensor(63.8303, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(15.2712, device='cuda:3')
distance x is tensor(107471.3359, device='cuda:3')
distance x is tensor(107471.3359, device='cuda:3')
________________________________
test distance is  tensor(107471.3359, device='cuda:3')
test distance1 is  tensor(107471.3359, device='cuda:3')
test similarity is  tensor(0.6327, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130042404173566.36
test entropy is  0.0
________________________________
cal ratio is  0.01168198818413016
distance x is tensor(1255.4839, device='cuda:3')
cal_distance is  tensor(1255.4839, device='cuda:3')
cal ratio is  0.10808303274374291
distance x is tensor(135.7010, device='cuda:3')
cal_distance is  tensor(135.7010, device='cuda:3')
cal ratio is  0.328754425853048
distance x is tensor(44.6158, device='cuda:3')
cal_distance is  tensor(44.6158, device='cuda:3')
cal ratio is  0.5733488375231731
distance x is tensor(25.5827, device='cuda:3')
cal_distance is  tensor(25.5827, device='cuda:3')
cal ratio is  0.7571641130570864
distance x is tensor(19.3716, device='cuda:3')
cal_distance is  tensor(19.3716, device='cuda:3')
cal ratio is  0.8701214232062308
distance x is tensor(16.8564, device='cuda:3')
cal_distance is  tensor(16.8564, device='cuda:3')
cal ratio is  0.9327825682037546
distance x is tensor(15.7238, device='cuda:3')
cal_distance is  tensor(15.7238, device='cuda:3')
cal ratio is  0.965794826338702
distance x is tensor(15.1861, device='cuda:3')
cal_distance is  tensor(15.1861, device='cuda:3')
distance x is tensor(15.1861, device='cuda:3')
return_distance is  tensor(15.1861, device='cuda:3')
distance x is tensor(15.1762, device='cuda:3')
distance x is tensor(15.1762, device='cuda:3')
________________________________
test distance is  tensor(15.1762, device='cuda:3')
test distance1 is  tensor(15.1762, device='cuda:3')
test similarity is  tensor(0.9998, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.4827853832671893
test entropy is  2.0578473112476408
________________________________
0
distance x is tensor(15.1762, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0579050939474532
avg test loss is  2.4831970864013315
avg accuracy is  0.1004833334896653
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(15.1762, device='cuda:3')
compute_norm is  tensor(64.7344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(16.7220, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8931134390805576
avg test loss is  3.5379804700676565
avg accuracy is  0.10043333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(16.7220, device='cuda:3')
compute_norm is  tensor(65.1098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16.7856, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.566394149367489
avg test loss is  2.8475976745202853
avg accuracy is  0.10045000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(16.7856, device='cuda:3')
compute_norm is  tensor(64.4749, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.7646, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8635328729142512
avg test loss is  3.5754233847803145
avg accuracy is  0.10043333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(18.7646, device='cuda:3')
compute_norm is  tensor(64.5767, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(19.4844, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5624507243699357
avg test loss is  2.8499929571965104
avg accuracy is  0.10051666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(19.4844, device='cuda:3')
compute_norm is  tensor(63.9245, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.0283, device='cuda:3')
distance x is tensor(22.0283, device='cuda:3')
________________________________
test distance is  tensor(22.0283, device='cuda:3')
test distance1 is  tensor(22.0283, device='cuda:3')
test similarity is  tensor(0.9994, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.570363830147522
test entropy is  0.8651918137251441
________________________________
cal ratio is  0.8159663464762563
distance x is tensor(17.9815, device='cuda:3')
cal_distance is  tensor(17.9815, device='cuda:3')
cal ratio is  0.9031291241403152
distance x is tensor(16.2400, device='cuda:3')
cal_distance is  tensor(16.2400, device='cuda:3')
cal ratio is  0.9503199237155939
distance x is tensor(15.4334, device='cuda:3')
cal_distance is  tensor(15.4334, device='cuda:3')
cal ratio is  0.9748373643874172
distance x is tensor(15.0452, device='cuda:3')
cal_distance is  tensor(15.0452, device='cuda:3')
distance x is tensor(15.0452, device='cuda:3')
return_distance is  tensor(15.0452, device='cuda:3')
distance x is tensor(15.0373, device='cuda:3')
distance x is tensor(15.0373, device='cuda:3')
________________________________
test distance is  tensor(15.0373, device='cuda:3')
test distance1 is  tensor(15.0373, device='cuda:3')
test similarity is  tensor(0.9997, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.093454079333145
test entropy is  1.2856428780789568
________________________________
0
distance x is tensor(15.0373, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2858873891677938
avg test loss is  3.093703885830796
avg accuracy is  0.10050000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(15.0373, device='cuda:3')
compute_norm is  tensor(64.0492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17.8500, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8503572639625973
avg test loss is  3.592475670995489
avg accuracy is  0.10051666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(17.8500, device='cuda:3')
compute_norm is  tensor(64.0126, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(19.9116, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5627283864438153
avg test loss is  2.848441022545544
avg accuracy is  0.10051666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(19.9116, device='cuda:3')
compute_norm is  tensor(63.3551, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(23.6719, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8648165229922419
avg test loss is  3.569905256665846
avg accuracy is  0.10043333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(23.6719, device='cuda:3')
compute_norm is  tensor(63.4596, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(26.0929, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5622296126158253
avg test loss is  2.8487530074902434
avg accuracy is  0.10051666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(26.0929, device='cuda:3')
compute_norm is  tensor(62.8087, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(29.9777, device='cuda:3')
distance x is tensor(29.9777, device='cuda:3')
________________________________
test distance is  tensor(29.9777, device='cuda:3')
test distance1 is  tensor(29.9777, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.567961416264841
test entropy is  0.8653198479970635
________________________________
cal ratio is  0.6994614477311143
distance x is tensor(20.9697, device='cuda:3')
cal_distance is  tensor(20.9697, device='cuda:3')
cal ratio is  0.8363089394861005
distance x is tensor(17.5373, device='cuda:3')
cal_distance is  tensor(17.5373, device='cuda:3')
cal ratio is  0.914495535120068
distance x is tensor(16.0379, device='cuda:3')
cal_distance is  tensor(16.0379, device='cuda:3')
cal ratio is  0.9562904005055711
distance x is tensor(15.3369, device='cuda:3')
cal_distance is  tensor(15.3369, device='cuda:3')
cal ratio is  0.9778998043674499
distance x is tensor(14.9980, device='cuda:3')
cal_distance is  tensor(14.9980, device='cuda:3')
distance x is tensor(14.9980, device='cuda:3')
return_distance is  tensor(14.9980, device='cuda:3')
distance x is tensor(14.9962, device='cuda:3')
distance x is tensor(14.9962, device='cuda:3')
________________________________
test distance is  tensor(14.9962, device='cuda:3')
test distance1 is  tensor(14.9962, device='cuda:3')
test similarity is  tensor(0.9999, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8726341604932286
test entropy is  1.534640853720179
________________________________
0
distance x is tensor(14.9962, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5345545342481974
avg test loss is  2.8734039068222046
avg accuracy is  0.10046666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(14.9962, device='cuda:3')
compute_norm is  tensor(63.5159, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.0102, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8604006628110719
avg test loss is  3.5775876413784555
avg accuracy is  0.10043333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9996, device='cuda:3')
compute_distance is  tensor(19.0102, device='cuda:3')
compute_norm is  tensor(63.6027, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.6053, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5633791502096506
avg test loss is  2.848585744402302
avg accuracy is  0.10050000015633197
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9999, device='cuda:3')
compute_distance is  tensor(21.6053, device='cuda:3')
compute_norm is  tensor(62.9545, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.6594, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8640520099892037
avg test loss is  3.5719839062517895
avg accuracy is  0.1005333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(25.6594, device='cuda:3')
compute_norm is  tensor(63.0606, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(28.2937, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5610547715158605
avg test loss is  2.850814366899828
avg accuracy is  0.1006333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9998, device='cuda:3')
compute_distance is  tensor(28.2937, device='cuda:3')
compute_norm is  tensor(62.4122, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(32.3216, device='cuda:3')
________________________________
test distance is  tensor(32.3216, device='cuda:3')
test similarity is  tensor(0.9995, device='cuda:3')
test acc is  0.10053333348966531
test loss is 3.56826298882458
test entropy is  0.8641973109260551
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.6020522117614746
mal norm is  tensor(150.4191, device='cuda:3')
distance x is tensor(32.3216, device='cuda:3')
mal distance is  tensor(32.3216, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 94.4952,  92.0484, 101.1643, 175.3718,  94.3083, 109.3536,  96.1112,
        103.7491, 150.4191, 150.4191, 150.4191, 150.4191, 150.4191, 150.4191,
        150.4191, 150.4191, 150.4191, 150.4191, 150.4191, 150.4191, 158.8019,
        169.3405, 179.7192, 160.5669, 196.7226, 436.2108, 161.4886, 156.6490,
        127.9766, 122.3171, 223.4132, 124.5136, 107.2867, 111.8062, 140.3535,
        165.7356], device='cuda:3')
sorted_norm is   tensor([ 92.0484,  94.3083,  94.4952,  96.1112, 101.1643, 103.7491, 107.2867,
        109.3536, 111.8062, 122.3171, 124.5136, 127.9766, 140.3535, 150.4191,
        150.4191, 150.4191, 150.4191, 150.4191, 150.4191, 150.4191, 150.4191,
        150.4191, 150.4191, 150.4191, 150.4191, 156.6490, 158.8019, 160.5669,
        161.4886, 165.7356, 169.3405, 175.3718, 179.7192, 196.7226, 223.4132,
        436.2108], device='cuda:3')
used idx is  tensor([ 1,  4,  0,  6,  2,  7, 32,  5, 33, 29, 31, 28, 34, 19, 15, 17, 13, 11,
         9, 10, 16, 14,  8, 12, 18, 27, 20, 23], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.309170961380005
distance x is tensor(1.6119, device='cuda:3')
benign distance is  tensor(1.6119, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3111443519592285
distance x is tensor(1.9177, device='cuda:3')
benign distance is  tensor(1.9177, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3055837154388428
distance x is tensor(34.5275, device='cuda:3')
benign distance is  tensor(34.5275, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2464439868927
distance x is tensor(21.4102, device='cuda:3')
benign distance is  tensor(21.4102, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3033437728881836
distance x is tensor(2.7621, device='cuda:3')
benign distance is  tensor(2.7621, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3150689601898193
distance x is tensor(20.4355, device='cuda:3')
benign distance is  tensor(20.4355, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2920238971710205
distance x is tensor(1.7974, device='cuda:3')
benign distance is  tensor(1.7974, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2940828800201416
distance x is tensor(13.2586, device='cuda:3')
benign distance is  tensor(13.2586, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3400774002075195
distance x is tensor(9.3886, device='cuda:3')
benign distance is  tensor(9.3886, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3226318359375
distance x is tensor(2.9879, device='cuda:3')
benign distance is  tensor(2.9879, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3045096397399902
distance x is tensor(9.3101, device='cuda:3')
benign distance is  tensor(9.3101, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.304090976715088
distance x is tensor(2.5586, device='cuda:3')
benign distance is  tensor(2.5586, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.3193745613098145
distance x is tensor(10.4780, device='cuda:3')
benign distance is  tensor(10.4780, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2930593490600586
distance x is tensor(13.2298, device='cuda:3')
benign distance is  tensor(13.2298, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2969212532043457
distance x is tensor(24.7469, device='cuda:3')
benign distance is  tensor(24.7469, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2868762016296387
distance x is tensor(18.7729, device='cuda:3')
benign distance is  tensor(18.7729, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.3388473987579346
distance x is tensor(9.1323, device='cuda:3')
benign distance is  tensor(9.1323, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.2981951236724854
distance x is tensor(16.0452, device='cuda:3')
benign distance is  tensor(16.0452, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.278573751449585
distance x is tensor(11.5697, device='cuda:3')
benign distance is  tensor(11.5697, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.353625535964966
distance x is tensor(22.5646, device='cuda:3')
benign distance is  tensor(22.5646, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.29376482963562
distance x is tensor(10.1436, device='cuda:3')
benign distance is  tensor(10.1436, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.2946906089782715
distance x is tensor(7.1657, device='cuda:3')
benign distance is  tensor(7.1657, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.3004822731018066
distance x is tensor(11.2476, device='cuda:3')
benign distance is  tensor(11.2476, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.345317840576172
distance x is tensor(1.6084, device='cuda:3')
benign distance is  tensor(1.6084, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(18.8659, device='cuda:3')
compute distance is  tensor(18.8659, device='cuda:3')
compute norm is  tensor(63.3046, device='cuda:3', dtype=torch.float64)
distance x is tensor(10.2664, device='cuda:3')
compute distance is  tensor(10.2664, device='cuda:3')
compute norm is  tensor(63.3428, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.8407, device='cuda:3')
compute distance is  tensor(11.8407, device='cuda:3')
compute norm is  tensor(63.3495, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.5143, device='cuda:3')
compute distance is  tensor(13.5143, device='cuda:3')
compute norm is  tensor(63.4010, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.1335, device='cuda:3')
compute distance is  tensor(7.1335, device='cuda:3')
compute norm is  tensor(63.4162, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.6111, device='cuda:3')
compute distance is  tensor(2.6111, device='cuda:3')
compute norm is  tensor(63.3512, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.0700, device='cuda:3')
compute distance is  tensor(8.0700, device='cuda:3')
compute norm is  tensor(63.2937, device='cuda:3', dtype=torch.float64)
distance x is tensor(9.9669, device='cuda:3')
compute distance is  tensor(9.9669, device='cuda:3')
compute norm is  tensor(63.3418, device='cuda:3', dtype=torch.float64)
distance x is tensor(4.0216, device='cuda:3')
compute distance is  tensor(4.0216, device='cuda:3')
compute norm is  tensor(63.2794, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.6939, device='cuda:3')
compute distance is  tensor(11.6939, device='cuda:3')
compute norm is  tensor(63.3364, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.8929, device='cuda:3')
compute distance is  tensor(3.8929, device='cuda:3')
compute norm is  tensor(63.3697, device='cuda:3', dtype=torch.float64)
distance x is tensor(33.4244, device='cuda:3')
compute distance is  tensor(33.4244, device='cuda:3')
compute norm is  tensor(63.8373, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(33.4244, device='cuda:3')
distance x is tensor(107470.5781, device='cuda:3')
distance x is tensor(107470.5781, device='cuda:3')
________________________________
test distance is  tensor(107470.5781, device='cuda:3')
test distance1 is  tensor(107470.5781, device='cuda:3')
test similarity is  tensor(0.6339, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130061136060433.47
test entropy is  0.0
________________________________
cal ratio is  0.017282752973840743
distance x is tensor(1857.3927, device='cuda:3')
cal_distance is  tensor(1857.3927, device='cuda:3')
cal ratio is  0.13146369761011428
distance x is tensor(244.1840, device='cuda:3')
cal_distance is  tensor(244.1840, device='cuda:3')
cal ratio is  0.36257603266415794
distance x is tensor(88.5385, device='cuda:3')
cal_distance is  tensor(88.5385, device='cuda:3')
cal ratio is  0.6021318709686454
distance x is tensor(53.3139, device='cuda:3')
cal_distance is  tensor(53.3139, device='cuda:3')
cal ratio is  0.7759566498512329
distance x is tensor(41.3705, device='cuda:3')
cal_distance is  tensor(41.3705, device='cuda:3')
cal ratio is  0.8808714627335247
distance x is tensor(36.4427, device='cuda:3')
cal_distance is  tensor(36.4427, device='cuda:3')
cal ratio is  0.9385394484267586
distance x is tensor(34.2032, device='cuda:3')
cal_distance is  tensor(34.2032, device='cuda:3')
cal ratio is  0.9687777801468267
distance x is tensor(33.1355, device='cuda:3')
cal_distance is  tensor(33.1355, device='cuda:3')
distance x is tensor(33.1355, device='cuda:3')
return_distance is  tensor(33.1355, device='cuda:3')
distance x is tensor(33.1256, device='cuda:3')
distance x is tensor(33.1256, device='cuda:3')
________________________________
test distance is  tensor(33.1256, device='cuda:3')
test distance1 is  tensor(33.1256, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10003333348966531
test loss is 2.411781058382632
test entropy is  2.15877292252807
________________________________
0
distance x is tensor(33.1256, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1589329776479236
avg test loss is  2.41138522380959
avg accuracy is  0.1007833334896653
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(33.1256, device='cuda:3')
compute_norm is  tensor(64.7921, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(34.4331, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8985121649846848
avg test loss is  3.5311126007454225
avg accuracy is  0.10060000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(34.4331, device='cuda:3')
compute_norm is  tensor(65.2499, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(33.8522, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5644998489412418
avg test loss is  2.8491393792858
avg accuracy is  0.10055000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(33.8522, device='cuda:3')
compute_norm is  tensor(64.6174, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(35.2414, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.861780294604393
avg test loss is  3.575981115227315
avg accuracy is  0.1006333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(35.2414, device='cuda:3')
compute_norm is  tensor(64.7203, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(35.2930, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.562578824537395
avg test loss is  2.8495384111587425
avg accuracy is  0.10065000015633196
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(35.2930, device='cuda:3')
compute_norm is  tensor(64.0655, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(36.9952, device='cuda:3')
distance x is tensor(36.9952, device='cuda:3')
________________________________
test distance is  tensor(36.9952, device='cuda:3')
test distance1 is  tensor(36.9952, device='cuda:3')
test similarity is  tensor(0.9987, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.573959475895489
test entropy is  0.8624733980657704
________________________________
cal ratio is  0.9315041040354695
distance x is tensor(34.4710, device='cuda:3')
cal_distance is  tensor(34.4710, device='cuda:3')
cal ratio is  0.965007317829057
distance x is tensor(33.2650, device='cuda:3')
cal_distance is  tensor(33.2650, device='cuda:3')
distance x is tensor(33.2650, device='cuda:3')
return_distance is  tensor(33.2650, device='cuda:3')
distance x is tensor(33.2548, device='cuda:3')
distance x is tensor(33.2548, device='cuda:3')
________________________________
test distance is  tensor(33.2548, device='cuda:3')
test distance1 is  tensor(33.2548, device='cuda:3')
test similarity is  tensor(0.9990, device='cuda:3')
test acc is  0.10001666682299865
test loss is 3.383224794859571
test entropy is  1.0126043870759163
________________________________
0
distance x is tensor(33.2548, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0130062000965006
avg test loss is  3.3821122277774283
avg accuracy is  0.10080000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9990, device='cuda:3')
compute_distance is  tensor(33.2548, device='cuda:3')
compute_norm is  tensor(64.0908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(34.5691, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8363747678077551
avg test loss is  3.6085889049684567
avg accuracy is  0.10071666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(34.5691, device='cuda:3')
compute_norm is  tensor(63.9165, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(35.0959, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5606400819221284
avg test loss is  2.849773172884862
avg accuracy is  0.1007333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(35.0959, device='cuda:3')
compute_norm is  tensor(63.2501, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(37.2341, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8636816453450779
avg test loss is  3.5682153889873645
avg accuracy is  0.10071666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9988, device='cuda:3')
compute_distance is  tensor(37.2341, device='cuda:3')
compute_norm is  tensor(63.3558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(38.8197, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5402506933029272
avg test loss is  2.7861045128755224
avg accuracy is  0.11475000015633194
solo acc is  0.1025333334896653
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(38.8197, device='cuda:3')
compute_norm is  tensor(62.7150, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(41.4453, device='cuda:3')
distance x is tensor(41.4453, device='cuda:3')
________________________________
test distance is  tensor(41.4453, device='cuda:3')
test distance1 is  tensor(41.4453, device='cuda:3')
test similarity is  tensor(0.9987, device='cuda:3')
test acc is  0.10038333348966531
test loss is 3.4924961519139663
test entropy is  0.8599357824844084
________________________________
cal ratio is  0.8800756747994346
distance x is tensor(36.4826, device='cuda:3')
cal_distance is  tensor(36.4826, device='cuda:3')
cal ratio is  0.9380263573658456
distance x is tensor(34.2219, device='cuda:3')
cal_distance is  tensor(34.2219, device='cuda:3')
cal ratio is  0.9685140291585327
distance x is tensor(33.1445, device='cuda:3')
cal_distance is  tensor(33.1445, device='cuda:3')
distance x is tensor(33.1445, device='cuda:3')
return_distance is  tensor(33.1445, device='cuda:3')
distance x is tensor(33.1364, device='cuda:3')
distance x is tensor(33.1364, device='cuda:3')
________________________________
test distance is  tensor(33.1364, device='cuda:3')
test distance1 is  tensor(33.1364, device='cuda:3')
test similarity is  tensor(0.9992, device='cuda:3')
test acc is  0.10010000015633198
test loss is 3.1539551365350103
test entropy is  1.173871465456257
________________________________
0
distance x is tensor(33.1364, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1729921391015368
avg test loss is  3.155085519686945
avg accuracy is  0.10835000015633195
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(33.1364, device='cuda:3')
compute_norm is  tensor(62.9289, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(35.8456, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8368609958111859
avg test loss is  3.5177867742998004
avg accuracy is  0.1133666668229986
solo acc is  0.10050000015633197
compute similarity  is  tensor(0.9989, device='cuda:3')
compute_distance is  tensor(35.8456, device='cuda:3')
compute_norm is  tensor(62.8441, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(39.3130, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4889009418263872
avg test loss is  2.6755363638721295
avg accuracy is  0.12713333348966524
solo acc is  0.11321666682299861
compute similarity  is  tensor(0.9991, device='cuda:3')
compute_distance is  tensor(39.3130, device='cuda:3')
compute_norm is  tensor(62.2251, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(42.7317, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8380396007093539
avg test loss is  3.382841177332376
avg accuracy is  0.12413333348966525
solo acc is  0.10071666682299864
compute similarity  is  tensor(0.9987, device='cuda:3')
compute_distance is  tensor(42.7317, device='cuda:3')
compute_norm is  tensor(62.3035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(48.0726, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.385655520821431
avg test loss is  2.396615979132622
avg accuracy is  0.1446000001563327
solo acc is  0.1239166668229986
compute similarity  is  tensor(0.9985, device='cuda:3')
compute_distance is  tensor(48.0726, device='cuda:3')
compute_norm is  tensor(61.7626, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(51.6298, device='cuda:3')
________________________________
test distance is  tensor(51.6298, device='cuda:3')
test similarity is  tensor(0.9981, device='cuda:3')
test acc is  0.13451666682299857
test loss is 3.0569873489042334
test entropy is  0.8026459104597949
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.9750962257385254
mal norm is  tensor(219.2073, device='cuda:3')
distance x is tensor(51.6298, device='cuda:3')
mal distance is  tensor(51.6298, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 80.5215,  75.1672, 280.4803, 202.9053,  77.2642, 195.2381,  82.2096,
        137.2663, 219.2073, 219.2073, 219.2073, 219.2073, 219.2073, 219.2073,
        219.2073, 219.2073, 219.2073, 219.2073, 219.2073, 219.2073, 178.4529,
        173.2120, 173.1423, 180.2187, 176.8222, 176.9053, 172.7238, 173.3137,
        136.5618, 155.2213, 219.3935, 173.5834, 117.9701, 132.8927, 121.5080,
        122.9748], device='cuda:3')
sorted_norm is   tensor([ 75.1672,  77.2642,  80.5215,  82.2096, 117.9701, 121.5080, 122.9748,
        132.8927, 136.5618, 137.2663, 155.2213, 172.7238, 173.1423, 173.2120,
        173.3137, 173.5834, 176.8222, 176.9053, 178.4529, 180.2187, 195.2381,
        202.9053, 219.2073, 219.2073, 219.2073, 219.2073, 219.2073, 219.2073,
        219.2073, 219.2073, 219.2073, 219.2073, 219.2073, 219.2073, 219.3935,
        280.4803], device='cuda:3')
used idx is  tensor([ 1,  4,  0,  6, 32, 34, 35, 33, 28,  7, 29, 26, 22, 21, 27, 31, 24, 25,
        20, 23,  5,  3, 19, 11,  8, 17, 15, 10], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 9.91% 

Test Accuracy: 10.01% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.300344705581665
distance x is tensor(1.0271, device='cuda:3')
benign distance is  tensor(1.0271, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.30442214012146
distance x is tensor(5.7283, device='cuda:3')
benign distance is  tensor(5.7283, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.312328577041626
distance x is tensor(19.4346, device='cuda:3')
benign distance is  tensor(19.4346, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.298036575317383
distance x is tensor(15.7257, device='cuda:3')
benign distance is  tensor(15.7257, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3246188163757324
distance x is tensor(14.6117, device='cuda:3')
benign distance is  tensor(14.6117, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7656309604644775
distance x is tensor(38.3720, device='cuda:3')
benign distance is  tensor(38.3720, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3000736236572266
distance x is tensor(1.5170, device='cuda:3')
benign distance is  tensor(1.5170, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.289097785949707
distance x is tensor(9.9615, device='cuda:3')
benign distance is  tensor(9.9615, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.3232500553131104
distance x is tensor(19.7080, device='cuda:3')
benign distance is  tensor(19.7080, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2134299278259277
distance x is tensor(31.1151, device='cuda:3')
benign distance is  tensor(31.1151, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.279085636138916
distance x is tensor(18.4046, device='cuda:3')
benign distance is  tensor(18.4046, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.302743673324585
distance x is tensor(25.5956, device='cuda:3')
benign distance is  tensor(25.5956, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.3142945766448975
distance x is tensor(0.9603, device='cuda:3')
benign distance is  tensor(0.9603, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.297015905380249
distance x is tensor(18.9746, device='cuda:3')
benign distance is  tensor(18.9746, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.278578996658325
distance x is tensor(1.2548, device='cuda:3')
benign distance is  tensor(1.2548, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.335024118423462
distance x is tensor(1.2220, device='cuda:3')
benign distance is  tensor(1.2220, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.3014681339263916
distance x is tensor(9.5294, device='cuda:3')
benign distance is  tensor(9.5294, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.28480863571167
distance x is tensor(1.7664, device='cuda:3')
benign distance is  tensor(1.7664, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.362637996673584
distance x is tensor(12.1742, device='cuda:3')
benign distance is  tensor(12.1742, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.323913097381592
distance x is tensor(29.8691, device='cuda:3')
benign distance is  tensor(29.8691, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.2885806560516357
distance x is tensor(1.1570, device='cuda:3')
benign distance is  tensor(1.1570, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.2627453804016113
distance x is tensor(15.0284, device='cuda:3')
benign distance is  tensor(15.0284, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.3120486736297607
distance x is tensor(20.2136, device='cuda:3')
benign distance is  tensor(20.2136, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.280151844024658
distance x is tensor(32.2048, device='cuda:3')
benign distance is  tensor(32.2048, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(12.5336, device='cuda:3')
compute distance is  tensor(12.5336, device='cuda:3')
compute norm is  tensor(64.0408, device='cuda:3', dtype=torch.float64)
distance x is tensor(14.4830, device='cuda:3')
compute distance is  tensor(14.4830, device='cuda:3')
compute norm is  tensor(63.9420, device='cuda:3', dtype=torch.float64)
distance x is tensor(30.7143, device='cuda:3')
compute distance is  tensor(30.7143, device='cuda:3')
compute norm is  tensor(64.3201, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.3332, device='cuda:3')
compute distance is  tensor(13.3332, device='cuda:3')
compute norm is  tensor(64.0959, device='cuda:3', dtype=torch.float64)
distance x is tensor(7.7326, device='cuda:3')
compute distance is  tensor(7.7326, device='cuda:3')
compute norm is  tensor(64.0232, device='cuda:3', dtype=torch.float64)
distance x is tensor(14.3978, device='cuda:3')
compute distance is  tensor(14.3978, device='cuda:3')
compute norm is  tensor(63.9895, device='cuda:3', dtype=torch.float64)
distance x is tensor(19.6043, device='cuda:3')
compute distance is  tensor(19.6043, device='cuda:3')
compute norm is  tensor(64.2099, device='cuda:3', dtype=torch.float64)
distance x is tensor(38.9678, device='cuda:3')
compute distance is  tensor(38.9678, device='cuda:3')
compute norm is  tensor(64.4859, device='cuda:3', dtype=torch.float64)
distance x is tensor(23.0683, device='cuda:3')
compute distance is  tensor(23.0683, device='cuda:3')
compute norm is  tensor(64.0047, device='cuda:3', dtype=torch.float64)
distance x is tensor(34.8490, device='cuda:3')
compute distance is  tensor(34.8490, device='cuda:3')
compute norm is  tensor(64.5172, device='cuda:3', dtype=torch.float64)
distance x is tensor(20.6931, device='cuda:3')
compute distance is  tensor(20.6931, device='cuda:3')
compute norm is  tensor(64.0936, device='cuda:3', dtype=torch.float64)
distance x is tensor(8.0622, device='cuda:3')
compute distance is  tensor(8.0622, device='cuda:3')
compute norm is  tensor(63.9623, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(38.9678, device='cuda:3')
distance x is tensor(107467.3594, device='cuda:3')
distance x is tensor(107467.3594, device='cuda:3')
________________________________
test distance is  tensor(107467.3594, device='cuda:3')
test distance1 is  tensor(107467.3594, device='cuda:3')
test similarity is  tensor(0.6369, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130092130929596.31
test entropy is  0.0
________________________________
cal ratio is  0.018661243650945777
distance x is tensor(2005.4800, device='cuda:3')
cal_distance is  tensor(2005.4800, device='cuda:3')
cal ratio is  0.13660597741167926
distance x is tensor(273.9648, device='cuda:3')
cal_distance is  tensor(273.9648, device='cuda:3')
cal ratio is  0.36959958018546396
distance x is tensor(101.2605, device='cuda:3')
cal_distance is  tensor(101.2605, device='cuda:3')
cal ratio is  0.6079374352054399
distance x is tensor(61.5621, device='cuda:3')
cal_distance is  tensor(61.5621, device='cuda:3')
cal ratio is  0.7796906267153134
distance x is tensor(48.0005, device='cuda:3')
cal_distance is  tensor(48.0005, device='cuda:3')
cal ratio is  0.8829904141634793
distance x is tensor(42.3846, device='cuda:3')
cal_distance is  tensor(42.3846, device='cuda:3')
cal ratio is  0.939668816030901
distance x is tensor(39.8278, device='cuda:3')
cal_distance is  tensor(39.8278, device='cuda:3')
cal ratio is  0.9693613760855938
distance x is tensor(38.6077, device='cuda:3')
cal_distance is  tensor(38.6077, device='cuda:3')
distance x is tensor(38.6077, device='cuda:3')
return_distance is  tensor(38.6077, device='cuda:3')
distance x is tensor(38.5978, device='cuda:3')
distance x is tensor(38.5978, device='cuda:3')
________________________________
test distance is  tensor(38.5978, device='cuda:3')
test distance1 is  tensor(38.5978, device='cuda:3')
test similarity is  tensor(0.9990, device='cuda:3')
test acc is  0.10020000015633199
test loss is 2.3183810233053115
test entropy is  2.284103548857195
________________________________
0
distance x is tensor(38.5978, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.284073063305446
avg test loss is  2.31805341355582
avg accuracy is  0.1013833334896653
solo acc is  0.10025000015633198
compute similarity  is  tensor(0.9990, device='cuda:3')
compute_distance is  tensor(38.5978, device='cuda:3')
compute_norm is  tensor(65.4732, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(40.4413, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9359520877093903
avg test loss is  3.485606903714666
avg accuracy is  0.10101666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(40.4413, device='cuda:3')
compute_norm is  tensor(66.1155, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(40.8949, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5187104720550815
avg test loss is  2.7348715082160444
avg accuracy is  0.13253333348966523
solo acc is  0.10396666682299864
compute similarity  is  tensor(0.9985, device='cuda:3')
compute_distance is  tensor(40.8949, device='cuda:3')
compute_norm is  tensor(65.5100, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(42.6798, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8534422169870405
avg test loss is  3.404827157571626
avg accuracy is  0.13433333348966522
solo acc is  0.10051666682299863
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(42.6798, device='cuda:3')
compute_norm is  tensor(65.5937, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(46.4276, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3594680456464479
avg test loss is  2.3479722717931786
avg accuracy is  0.1571833334896671
solo acc is  0.12455000015633191
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(46.4276, device='cuda:3')
compute_norm is  tensor(65.0538, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(48.0317, device='cuda:3')
distance x is tensor(48.0317, device='cuda:3')
________________________________
test distance is  tensor(48.0317, device='cuda:3')
test distance1 is  tensor(48.0317, device='cuda:3')
test similarity is  tensor(0.9976, device='cuda:3')
test acc is  0.10046666682299864
test loss is 3.031846427459961
test entropy is  0.8033044759525674
________________________________
cal ratio is  0.8827033000823853
distance x is tensor(42.4070, device='cuda:3')
cal_distance is  tensor(42.4070, device='cuda:3')
cal ratio is  0.9394206575045355
distance x is tensor(39.8383, device='cuda:3')
cal_distance is  tensor(39.8383, device='cuda:3')
cal ratio is  0.9692334574989182
distance x is tensor(38.6128, device='cuda:3')
cal_distance is  tensor(38.6128, device='cuda:3')
distance x is tensor(38.6128, device='cuda:3')
return_distance is  tensor(38.6128, device='cuda:3')
distance x is tensor(38.6030, device='cuda:3')
distance x is tensor(38.6030, device='cuda:3')
________________________________
test distance is  tensor(38.6030, device='cuda:3')
test distance1 is  tensor(38.6030, device='cuda:3')
test similarity is  tensor(0.9984, device='cuda:3')
test acc is  0.10015000015633198
test loss is 2.8621305951685794
test entropy is  1.2624959405551333
________________________________
0
distance x is tensor(38.6030, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2628552519690508
avg test loss is  2.862534333393772
avg accuracy is  0.13316666682299858
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9984, device='cuda:3')
compute_distance is  tensor(38.6030, device='cuda:3')
compute_norm is  tensor(64.7764, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(41.1504, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7861070495043228
avg test loss is  3.0303823376006918
avg accuracy is  0.1487333334896664
solo acc is  0.10056666682299864
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(41.1504, device='cuda:3')
compute_norm is  tensor(64.7101, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(44.3675, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.274521133792934
avg test loss is  2.170619376305578
avg accuracy is  0.15950000015633392
solo acc is  0.1339333334896652
compute similarity  is  tensor(0.9978, device='cuda:3')
compute_distance is  tensor(44.3675, device='cuda:3')
compute_norm is  tensor(64.2819, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(46.0519, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7694615168230874
avg test loss is  2.8617036983148374
avg accuracy is  0.1525500001563334
solo acc is  0.10051666682299863
compute similarity  is  tensor(0.9974, device='cuda:3')
compute_distance is  tensor(46.0519, device='cuda:3')
compute_norm is  tensor(64.2160, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(49.3717, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2553385013202105
avg test loss is  2.05209019303576
avg accuracy is  0.16680000015633448
solo acc is  0.14121666682299908
compute similarity  is  tensor(0.9973, device='cuda:3')
compute_distance is  tensor(49.3717, device='cuda:3')
compute_norm is  tensor(63.8422, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(51.2857, device='cuda:3')
distance x is tensor(51.2857, device='cuda:3')
________________________________
test distance is  tensor(51.2857, device='cuda:3')
test distance1 is  tensor(51.2857, device='cuda:3')
test similarity is  tensor(0.9969, device='cuda:3')
test acc is  0.10060000015633197
test loss is 2.7976690477399684
test entropy is  0.7430581062206073
________________________________
cal ratio is  0.8542418331490438
distance x is tensor(43.8174, device='cuda:3')
cal_distance is  tensor(43.8174, device='cuda:3')
cal ratio is  0.9241775508026998
distance x is tensor(40.4954, device='cuda:3')
cal_distance is  tensor(40.4954, device='cuda:3')
cal ratio is  0.9613380990377061
distance x is tensor(38.9299, device='cuda:3')
cal_distance is  tensor(38.9299, device='cuda:3')
distance x is tensor(38.9299, device='cuda:3')
return_distance is  tensor(38.9299, device='cuda:3')
distance x is tensor(38.9223, device='cuda:3')
distance x is tensor(38.9223, device='cuda:3')
________________________________
test distance is  tensor(38.9223, device='cuda:3')
test distance1 is  tensor(38.9223, device='cuda:3')
test similarity is  tensor(0.9982, device='cuda:3')
test acc is  0.10020000015633199
test loss is 2.68319794160725
test entropy is  1.3120343160273424
________________________________
0
distance x is tensor(38.9223, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3137600719293296
avg test loss is  2.680581843420895
avg accuracy is  0.13551666682299857
solo acc is  0.10030000015633196
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(38.9223, device='cuda:3')
compute_norm is  tensor(63.7115, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(42.2960, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7605738797421648
avg test loss is  2.8414032939654676
avg accuracy is  0.15663333348966704
solo acc is  0.10046666682299864
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(42.2960, device='cuda:3')
compute_norm is  tensor(63.6553, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(47.3644, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2300651858864562
avg test loss is  1.9362716255411665
avg accuracy is  0.16985000015633464
solo acc is  0.15021666682299986
compute similarity  is  tensor(0.9973, device='cuda:3')
compute_distance is  tensor(47.3644, device='cuda:3')
compute_norm is  tensor(63.3431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(50.0669, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7219511872923958
avg test loss is  2.699578477375543
avg accuracy is  0.16135000015633408
solo acc is  0.10160000015633197
compute similarity  is  tensor(0.9969, device='cuda:3')
compute_distance is  tensor(50.0669, device='cuda:3')
compute_norm is  tensor(63.2275, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(54.7021, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.158717922945775
avg test loss is  1.856510509051748
avg accuracy is  0.1654833334896677
solo acc is  0.1656833334896677
compute similarity  is  tensor(0.9966, device='cuda:3')
compute_distance is  tensor(54.7021, device='cuda:3')
compute_norm is  tensor(62.9120, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(57.5086, device='cuda:3')
________________________________
test distance is  tensor(57.5086, device='cuda:3')
test similarity is  tensor(0.9963, device='cuda:3')
test acc is  0.1581666668230005
test loss is 2.6382509604700086
test entropy is  0.6758404859601815
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.175750970840454
mal norm is  tensor(286.7660, device='cuda:3')
distance x is tensor(57.5086, device='cuda:3')
mal distance is  tensor(57.5086, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 48.1726,  73.3826, 182.3026, 153.6793, 139.5375, 303.7189,  49.1351,
        108.2870, 286.7659, 286.7660, 286.7659, 286.7660, 286.7659, 286.7660,
        286.7659, 286.7660, 286.7659, 286.7660, 286.7659, 286.7660, 105.0295,
         77.5683, 123.5566,  75.7064, 109.5861, 128.8555, 237.0052, 195.7676],
       device='cuda:3')
sorted_norm is   tensor([ 48.1726,  49.1351,  73.3826,  75.7064,  77.5683, 105.0295, 108.2870,
        109.5861, 123.5566, 128.8555, 139.5375, 153.6793, 182.3026, 195.7676,
        237.0052, 286.7659, 286.7659, 286.7659, 286.7659, 286.7659, 286.7659,
        286.7660, 286.7660, 286.7660, 286.7660, 286.7660, 286.7660, 303.7189],
       device='cuda:3')
used idx is  tensor([ 0,  6,  1, 23, 21, 20,  7, 24, 22, 25,  4,  3,  2, 27, 26, 18, 14, 16,
        12,  8, 10, 11], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3041083812713623
distance x is tensor(1.3471, device='cuda:3')
benign distance is  tensor(1.3471, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2975833415985107
distance x is tensor(1.3203, device='cuda:3')
benign distance is  tensor(1.3203, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3093416690826416
distance x is tensor(1.4758, device='cuda:3')
benign distance is  tensor(1.4758, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2959952354431152
distance x is tensor(9.4247, device='cuda:3')
benign distance is  tensor(9.4247, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2248616218566895
distance x is tensor(29.3462, device='cuda:3')
benign distance is  tensor(29.3462, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3073601722717285
distance x is tensor(1.7606, device='cuda:3')
benign distance is  tensor(1.7606, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2773900032043457
distance x is tensor(1.3706, device='cuda:3')
benign distance is  tensor(1.3706, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3031678199768066
distance x is tensor(30.9464, device='cuda:3')
benign distance is  tensor(30.9464, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.342374801635742
distance x is tensor(22.8271, device='cuda:3')
benign distance is  tensor(22.8271, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.313589096069336
distance x is tensor(19.3535, device='cuda:3')
benign distance is  tensor(19.3535, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2701098918914795
distance x is tensor(1.9189, device='cuda:3')
benign distance is  tensor(1.9189, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.0116240978240967
distance x is tensor(42.5492, device='cuda:3')
benign distance is  tensor(42.5492, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.3171448707580566
distance x is tensor(1.1975, device='cuda:3')
benign distance is  tensor(1.1975, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.0766172409057617
distance x is tensor(21.4633, device='cuda:3')
benign distance is  tensor(21.4633, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.3100547790527344
distance x is tensor(17.5149, device='cuda:3')
benign distance is  tensor(17.5149, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2844600677490234
distance x is tensor(12.0196, device='cuda:3')
benign distance is  tensor(12.0196, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(22.1754, device='cuda:3')
compute distance is  tensor(22.1754, device='cuda:3')
compute norm is  tensor(63.0126, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.3691, device='cuda:3')
compute distance is  tensor(1.3691, device='cuda:3')
compute norm is  tensor(62.8819, device='cuda:3', dtype=torch.float64)
distance x is tensor(20.2903, device='cuda:3')
compute distance is  tensor(20.2903, device='cuda:3')
compute norm is  tensor(63.0334, device='cuda:3', dtype=torch.float64)
distance x is tensor(34.2817, device='cuda:3')
compute distance is  tensor(34.2817, device='cuda:3')
compute norm is  tensor(63.2060, device='cuda:3', dtype=torch.float64)
distance x is tensor(45.8854, device='cuda:3')
compute distance is  tensor(45.8854, device='cuda:3')
compute norm is  tensor(63.4626, device='cuda:3', dtype=torch.float64)
distance x is tensor(21.8236, device='cuda:3')
compute distance is  tensor(21.8236, device='cuda:3')
compute norm is  tensor(62.9444, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.4764, device='cuda:3')
compute distance is  tensor(1.4764, device='cuda:3')
compute norm is  tensor(62.8240, device='cuda:3', dtype=torch.float64)
distance x is tensor(26.5447, device='cuda:3')
compute distance is  tensor(26.5447, device='cuda:3')
compute norm is  tensor(62.9143, device='cuda:3', dtype=torch.float64)
distance x is tensor(11.6096, device='cuda:3')
compute distance is  tensor(11.6096, device='cuda:3')
compute norm is  tensor(62.8498, device='cuda:3', dtype=torch.float64)
distance x is tensor(28.6910, device='cuda:3')
compute distance is  tensor(28.6910, device='cuda:3')
compute norm is  tensor(63.1850, device='cuda:3', dtype=torch.float64)
distance x is tensor(24.5264, device='cuda:3')
compute distance is  tensor(24.5264, device='cuda:3')
compute norm is  tensor(62.9601, device='cuda:3', dtype=torch.float64)
distance x is tensor(13.1957, device='cuda:3')
compute distance is  tensor(13.1957, device='cuda:3')
compute norm is  tensor(62.8741, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(45.8854, device='cuda:3')
distance x is tensor(107462.1641, device='cuda:3')
distance x is tensor(107462.1641, device='cuda:3')
________________________________
test distance is  tensor(107462.1641, device='cuda:3')
test distance1 is  tensor(107462.1641, device='cuda:3')
test similarity is  tensor(0.6425, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130066635892976.17
test entropy is  0.0
________________________________
cal ratio is  0.02025049841864471
distance x is tensor(2176.1677, device='cuda:3')
cal_distance is  tensor(2176.1677, device='cuda:3')
cal ratio is  0.142304071270082
distance x is tensor(309.6818, device='cuda:3')
cal_distance is  tensor(309.6818, device='cuda:3')
cal ratio is  0.37722953107095786
distance x is tensor(116.8243, device='cuda:3')
cal_distance is  tensor(116.8243, device='cuda:3')
cal ratio is  0.6141818649427109
distance x is tensor(71.7533, device='cuda:3')
cal_distance is  tensor(71.7533, device='cuda:3')
cal ratio is  0.7836867278475768
distance x is tensor(56.2333, device='cuda:3')
cal_distance is  tensor(56.2333, device='cuda:3')
cal ratio is  0.8852519339874567
distance x is tensor(49.7812, device='cuda:3')
cal_distance is  tensor(49.7812, device='cuda:3')
cal ratio is  0.9408726397267193
distance x is tensor(46.8381, device='cuda:3')
cal_distance is  tensor(46.8381, device='cuda:3')
cal ratio is  0.9699827163301861
distance x is tensor(45.4323, device='cuda:3')
cal_distance is  tensor(45.4323, device='cuda:3')
distance x is tensor(45.4323, device='cuda:3')
return_distance is  tensor(45.4323, device='cuda:3')
distance x is tensor(45.4224, device='cuda:3')
distance x is tensor(45.4224, device='cuda:3')
________________________________
test distance is  tensor(45.4224, device='cuda:3')
test distance1 is  tensor(45.4224, device='cuda:3')
test similarity is  tensor(0.9986, device='cuda:3')
test acc is  0.10001666682299865
test loss is 2.3747361278228922
test entropy is  2.2138403600721217
________________________________
0
distance x is tensor(45.4224, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2138868405112326
avg test loss is  2.375203946251859
avg accuracy is  0.10051666682299863
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9986, device='cuda:3')
compute_distance is  tensor(45.4224, device='cuda:3')
compute_norm is  tensor(64.7504, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(46.5425, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8756265790859011
avg test loss is  3.5687199340446165
avg accuracy is  0.1004833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9981, device='cuda:3')
compute_distance is  tensor(46.5425, device='cuda:3')
compute_norm is  tensor(65.1585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(46.6872, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.530431860545551
avg test loss is  2.7319684257385317
avg accuracy is  0.12686666682299858
solo acc is  0.10210000015633197
compute similarity  is  tensor(0.9983, device='cuda:3')
compute_distance is  tensor(46.6872, device='cuda:3')
compute_norm is  tensor(64.5647, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(48.3346, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.827175762798232
avg test loss is  3.3938252168423584
avg accuracy is  0.13941666682299883
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(48.3346, device='cuda:3')
compute_norm is  tensor(64.6255, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(52.2682, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2518243535495261
avg test loss is  2.0694897032495754
avg accuracy is  0.18536666682300226
solo acc is  0.1514000001563333
compute similarity  is  tensor(0.9978, device='cuda:3')
compute_distance is  tensor(52.2682, device='cuda:3')
compute_norm is  tensor(64.1764, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(53.8947, device='cuda:3')
distance x is tensor(53.8947, device='cuda:3')
________________________________
test distance is  tensor(53.8947, device='cuda:3')
test distance1 is  tensor(53.8947, device='cuda:3')
test similarity is  tensor(0.9976, device='cuda:3')
test acc is  0.10200000015633197
test loss is 2.774936477004338
test entropy is  0.7139887619120225
________________________________
cal ratio is  0.9042540038391688
distance x is tensor(48.7440, device='cuda:3')
cal_distance is  tensor(48.7440, device='cuda:3')
cal ratio is  0.9508300232488357
distance x is tensor(46.3475, device='cuda:3')
cal_distance is  tensor(46.3475, device='cuda:3')
cal ratio is  0.9751025751271581
distance x is tensor(45.1937, device='cuda:3')
cal_distance is  tensor(45.1937, device='cuda:3')
distance x is tensor(45.1937, device='cuda:3')
return_distance is  tensor(45.1937, device='cuda:3')
distance x is tensor(45.1837, device='cuda:3')
distance x is tensor(45.1837, device='cuda:3')
________________________________
test distance is  tensor(45.1837, device='cuda:3')
test distance1 is  tensor(45.1837, device='cuda:3')
test similarity is  tensor(0.9983, device='cuda:3')
test acc is  0.10200000015633197
test loss is 2.498388557800098
test entropy is  1.223642400078682
________________________________
0
distance x is tensor(45.1837, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2235684169889258
avg test loss is  2.501809212953043
avg accuracy is  0.15275000015633342
solo acc is  0.1017333334896653
compute similarity  is  tensor(0.9983, device='cuda:3')
compute_distance is  tensor(45.1837, device='cuda:3')
compute_norm is  tensor(63.8354, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(47.5309, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7123614497530435
avg test loss is  2.7381447393502762
avg accuracy is  0.18036666682300198
solo acc is  0.1019333334896653
compute similarity  is  tensor(0.9980, device='cuda:3')
compute_distance is  tensor(47.5309, device='cuda:3')
compute_norm is  tensor(63.6682, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(50.9878, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.2001175211945068
avg test loss is  1.6966897063672162
avg accuracy is  0.17291666682300152
solo acc is  0.23305000015633767
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(50.9878, device='cuda:3')
compute_norm is  tensor(63.3370, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(52.4773, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6572745906899987
avg test loss is  2.6341427778130146
avg accuracy is  0.16276666682300087
solo acc is  0.10186666682299864
compute similarity  is  tensor(0.9976, device='cuda:3')
compute_distance is  tensor(52.4773, device='cuda:3')
compute_norm is  tensor(63.1539, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(55.7958, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0593689054187172
avg test loss is  1.7190046185877785
avg accuracy is  0.1466000001563329
solo acc is  0.1985333334896696
compute similarity  is  tensor(0.9972, device='cuda:3')
compute_distance is  tensor(55.7958, device='cuda:3')
compute_norm is  tensor(62.8312, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(57.3381, device='cuda:3')
distance x is tensor(57.3381, device='cuda:3')
________________________________
test distance is  tensor(57.3381, device='cuda:3')
test distance1 is  tensor(57.3381, device='cuda:3')
test similarity is  tensor(0.9971, device='cuda:3')
test acc is  0.10258333348966531
test loss is 2.4864454495627233
test entropy is  0.6502792764065871
________________________________
cal ratio is  0.8766811751269881
distance x is tensor(50.2752, device='cuda:3')
cal_distance is  tensor(50.2752, device='cuda:3')
cal ratio is  0.9362388714458733
distance x is tensor(47.0699, device='cuda:3')
cal_distance is  tensor(47.0699, device='cuda:3')
cal ratio is  0.9675915769243325
distance x is tensor(45.5445, device='cuda:3')
cal_distance is  tensor(45.5445, device='cuda:3')
distance x is tensor(45.5445, device='cuda:3')
return_distance is  tensor(45.5445, device='cuda:3')
distance x is tensor(45.5361, device='cuda:3')
distance x is tensor(45.5361, device='cuda:3')
________________________________
test distance is  tensor(45.5361, device='cuda:3')
test distance1 is  tensor(45.5361, device='cuda:3')
test similarity is  tensor(0.9982, device='cuda:3')
test acc is  0.10005000015633199
test loss is 2.5757758500479433
test entropy is  1.3532153831870317
________________________________
0
distance x is tensor(45.5361, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3528748074574257
avg test loss is  2.577889299087687
avg accuracy is  0.12318333348966526
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9982, device='cuda:3')
compute_distance is  tensor(45.5361, device='cuda:3')
compute_norm is  tensor(62.6513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(48.5769, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6510698079173245
avg test loss is  2.5280691827538173
avg accuracy is  0.14113333348966572
solo acc is  0.1024333334896653
compute similarity  is  tensor(0.9978, device='cuda:3')
compute_distance is  tensor(48.5769, device='cuda:3')
compute_norm is  tensor(62.4651, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(52.5573, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.062095291007048
avg test loss is  1.6363463456442615
avg accuracy is  0.1325000001563319
solo acc is  0.20050000015633643
compute similarity  is  tensor(0.9974, device='cuda:3')
compute_distance is  tensor(52.5573, device='cuda:3')
compute_norm is  tensor(62.1664, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(54.6776, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6371701300017106
avg test loss is  2.433873214320079
avg accuracy is  0.12846666682299857
solo acc is  0.1017833334896653
compute similarity  is  tensor(0.9972, device='cuda:3')
compute_distance is  tensor(54.6776, device='cuda:3')
compute_norm is  tensor(61.9602, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(58.3888, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.042004989281392
avg test loss is  1.608169577777513
avg accuracy is  0.12236666682299858
solo acc is  0.19198333348966923
compute similarity  is  tensor(0.9969, device='cuda:3')
compute_distance is  tensor(58.3888, device='cuda:3')
compute_norm is  tensor(61.6663, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(60.7722, device='cuda:3')
________________________________
test distance is  tensor(60.7722, device='cuda:3')
test similarity is  tensor(0.9967, device='cuda:3')
test acc is  0.12073333348966525
test loss is 2.4137319777565978
test entropy is  0.6124683529583376
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.1097378730773926
mal norm is  tensor(265.8834, device='cuda:3')
distance x is tensor(60.7722, device='cuda:3')
mal distance is  tensor(60.7722, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 70.5880,  65.0236,  67.5532, 111.9979, 258.0862,  78.9476,  68.5153,
        254.2855, 265.8834, 265.8834, 265.8834, 265.8834, 265.8834, 265.8834,
        265.8834, 265.8834, 265.8834, 265.8834, 265.8834, 265.8834],
       device='cuda:3')
sorted_norm is   tensor([ 65.0236,  67.5532,  68.5153,  70.5880,  78.9476, 111.9979, 254.2855,
        258.0862, 265.8834, 265.8834, 265.8834, 265.8834, 265.8834, 265.8834,
        265.8834, 265.8834, 265.8834, 265.8834, 265.8834, 265.8834],
       device='cuda:3')
used idx is  tensor([ 1,  2,  6,  0,  5,  3,  7,  4, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3056938648223877
distance x is tensor(34.7151, device='cuda:3')
benign distance is  tensor(34.7151, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3266608715057373
distance x is tensor(29.2457, device='cuda:3')
benign distance is  tensor(29.2457, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3039207458496094
distance x is tensor(48.7847, device='cuda:3')
benign distance is  tensor(48.7847, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.298092842102051
distance x is tensor(46.3547, device='cuda:3')
benign distance is  tensor(46.3547, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3026700019836426
distance x is tensor(31.0696, device='cuda:3')
benign distance is  tensor(31.0696, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3150928020477295
distance x is tensor(35.1356, device='cuda:3')
benign distance is  tensor(35.1356, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2914788722991943
distance x is tensor(36.8456, device='cuda:3')
benign distance is  tensor(36.8456, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2898201942443848
distance x is tensor(33.2244, device='cuda:3')
benign distance is  tensor(33.2244, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(46.3424, device='cuda:3')
compute distance is  tensor(46.3424, device='cuda:3')
compute norm is  tensor(62.7217, device='cuda:3', dtype=torch.float64)
distance x is tensor(34.0433, device='cuda:3')
compute distance is  tensor(34.0433, device='cuda:3')
compute norm is  tensor(61.9942, device='cuda:3', dtype=torch.float64)
distance x is tensor(38.8055, device='cuda:3')
compute distance is  tensor(38.8055, device='cuda:3')
compute norm is  tensor(62.4730, device='cuda:3', dtype=torch.float64)
distance x is tensor(59.6198, device='cuda:3')
compute distance is  tensor(59.6198, device='cuda:3')
compute norm is  tensor(65.1609, device='cuda:3', dtype=torch.float64)
distance x is tensor(28.6994, device='cuda:3')
compute distance is  tensor(28.6994, device='cuda:3')
compute norm is  tensor(61.7934, device='cuda:3', dtype=torch.float64)
distance x is tensor(35.4156, device='cuda:3')
compute distance is  tensor(35.4156, device='cuda:3')
compute norm is  tensor(62.1587, device='cuda:3', dtype=torch.float64)
distance x is tensor(25.7227, device='cuda:3')
compute distance is  tensor(25.7227, device='cuda:3')
compute norm is  tensor(61.7381, device='cuda:3', dtype=torch.float64)
distance x is tensor(32.1477, device='cuda:3')
compute distance is  tensor(32.1477, device='cuda:3')
compute norm is  tensor(62.1962, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.4956, device='cuda:3')
compute distance is  tensor(158.4956, device='cuda:3')
compute norm is  tensor(71.7010, device='cuda:3', dtype=torch.float64)
distance x is tensor(30.3611, device='cuda:3')
compute distance is  tensor(30.3611, device='cuda:3')
compute norm is  tensor(61.7874, device='cuda:3', dtype=torch.float64)
distance x is tensor(51.5957, device='cuda:3')
compute distance is  tensor(51.5957, device='cuda:3')
compute norm is  tensor(62.3155, device='cuda:3', dtype=torch.float64)
distance x is tensor(35.0669, device='cuda:3')
compute distance is  tensor(35.0669, device='cuda:3')
compute norm is  tensor(61.8863, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.4956, device='cuda:3')
distance x is tensor(107449.0703, device='cuda:3')
distance x is tensor(107449.0703, device='cuda:3')
________________________________
test distance is  tensor(107449.0703, device='cuda:3')
test distance1 is  tensor(107449.0703, device='cuda:3')
test similarity is  tensor(0.6561, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130134400642382.06
test entropy is  0.0
________________________________
cal ratio is  0.03763859069325636
distance x is tensor(4044.2371, device='cuda:3')
cal_distance is  tensor(4044.2371, device='cuda:3')
cal ratio is  0.19400654434120204
distance x is tensor(784.6124, device='cuda:3')
cal_distance is  tensor(784.6124, device='cuda:3')
cal ratio is  0.44046063654187373
distance x is tensor(345.5937, device='cuda:3')
cal_distance is  tensor(345.5937, device='cuda:3')
cal ratio is  0.6636693879474385
distance x is tensor(229.3616, device='cuda:3')
cal_distance is  tensor(229.3616, device='cuda:3')
cal ratio is  0.8146560928032598
distance x is tensor(186.8518, device='cuda:3')
cal_distance is  tensor(186.8518, device='cuda:3')
cal ratio is  0.9025808093700445
distance x is tensor(168.6493, device='cuda:3')
cal_distance is  tensor(168.6493, device='cuda:3')
cal ratio is  0.9500410463099026
distance x is tensor(160.2240, device='cuda:3')
cal_distance is  tensor(160.2240, device='cuda:3')
cal ratio is  0.9746997692684958
distance x is tensor(156.1705, device='cuda:3')
cal_distance is  tensor(156.1705, device='cuda:3')
distance x is tensor(156.1705, device='cuda:3')
return_distance is  tensor(156.1705, device='cuda:3')
distance x is tensor(156.1605, device='cuda:3')
distance x is tensor(156.1605, device='cuda:3')
________________________________
test distance is  tensor(156.1605, device='cuda:3')
test distance1 is  tensor(156.1605, device='cuda:3')
test similarity is  tensor(0.9865, device='cuda:3')
test acc is  0.10003333348966531
test loss is 2.9190708518282436
test entropy is  1.3359732226268062
________________________________
0
distance x is tensor(156.1605, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3377059371486655
avg test loss is  2.916803432171787
avg accuracy is  0.16608333348966772
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9865, device='cuda:3')
compute_distance is  tensor(156.1605, device='cuda:3')
compute_norm is  tensor(68.5162, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.6975, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6743419725757672
avg test loss is  2.6233965201672715
avg accuracy is  0.2402333334896713
solo acc is  0.10271666682299864
compute similarity  is  tensor(0.9865, device='cuda:3')
compute_distance is  tensor(156.6975, device='cuda:3')
compute_norm is  tensor(68.3125, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.9534, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0286984854796801
avg test loss is  1.5522132678580944
avg accuracy is  0.21388333348967026
solo acc is  0.24478333348967143
compute similarity  is  tensor(0.9864, device='cuda:3')
compute_distance is  tensor(157.9534, device='cuda:3')
compute_norm is  tensor(68.0566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.4017, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6046199127555147
avg test loss is  2.427620025204697
avg accuracy is  0.20538333348966997
solo acc is  0.1026833334896653
compute similarity  is  tensor(0.9863, device='cuda:3')
compute_distance is  tensor(157.4017, device='cuda:3')
compute_norm is  tensor(67.8027, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.2285, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9852906600879962
avg test loss is  1.4590811848259175
avg accuracy is  0.20613333348966995
solo acc is  0.27315000015633895
compute similarity  is  tensor(0.9861, device='cuda:3')
compute_distance is  tensor(158.2285, device='cuda:3')
compute_norm is  tensor(67.5035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(158.2285, device='cuda:3')
distance x is tensor(158.2285, device='cuda:3')
________________________________
test distance is  tensor(158.2285, device='cuda:3')
test distance1 is  tensor(158.2285, device='cuda:3')
test similarity is  tensor(0.9861, device='cuda:3')
test acc is  0.2739666668230055
test loss is 1.4610540967251955
test entropy is  0.9862133718884067
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.0314531326293945
mal norm is  tensor(753.6122, device='cuda:3')
distance x is tensor(158.2384, device='cuda:3')
mal distance is  tensor(158.2384, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([303.8014, 273.9014, 595.7810, 445.6399, 289.7375, 303.4961, 344.8159,
        344.7546, 753.6122, 753.6122, 753.6122, 753.6122, 753.6122, 753.6122,
        753.6122, 753.6122, 753.6122, 753.6122, 753.6122, 753.6122, 260.9149,
        276.2141, 255.4314, 314.6548, 256.9332, 286.6696, 301.1377, 267.0040,
        219.2305, 251.5321, 235.5616, 305.9017, 223.4911, 220.4466, 226.1439,
        210.3395, 280.6681, 328.7453, 256.0799, 310.7158, 207.3784, 270.3336,
        209.8266, 209.4242, 257.3136, 223.7966, 157.5135, 340.7199, 147.1596,
        216.6942, 211.7798, 190.1806], device='cuda:3')
sorted_norm is   tensor([147.1596, 157.5135, 190.1806, 207.3784, 209.4242, 209.8266, 210.3395,
        211.7798, 216.6942, 219.2305, 220.4466, 223.4911, 223.7966, 226.1439,
        235.5616, 251.5321, 255.4314, 256.0799, 256.9332, 257.3136, 260.9149,
        267.0040, 270.3336, 273.9014, 276.2141, 280.6681, 286.6696, 289.7375,
        301.1377, 303.4961, 303.8014, 305.9017, 310.7158, 314.6548, 328.7453,
        340.7199, 344.7546, 344.8159, 445.6399, 595.7810, 753.6122, 753.6122,
        753.6122, 753.6122, 753.6122, 753.6122, 753.6122, 753.6122, 753.6122,
        753.6122, 753.6122, 753.6122], device='cuda:3')
used idx is  tensor([48, 46, 51, 40, 43, 42, 35, 50, 49, 28, 33, 32, 45, 34, 30, 29, 22, 38,
        24, 44, 20, 27, 41,  1, 21, 36, 25,  4, 26,  5,  0, 31, 39, 23, 37, 47,
         7,  6,  3,  2, 11], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3049912452697754
distance x is tensor(0.6468, device='cuda:3')
benign distance is  tensor(0.6468, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2990882396698
distance x is tensor(0.6745, device='cuda:3')
benign distance is  tensor(0.6745, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3129353523254395
distance x is tensor(0.7179, device='cuda:3')
benign distance is  tensor(0.7179, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.294198513031006
distance x is tensor(0.6740, device='cuda:3')
benign distance is  tensor(0.6740, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.30041241645813
distance x is tensor(0.6934, device='cuda:3')
benign distance is  tensor(0.6934, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.318016529083252
distance x is tensor(0.5231, device='cuda:3')
benign distance is  tensor(0.5231, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2986905574798584
distance x is tensor(0.6216, device='cuda:3')
benign distance is  tensor(0.6216, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.298027515411377
distance x is tensor(0.6305, device='cuda:3')
benign distance is  tensor(0.6305, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.328324794769287
distance x is tensor(0.7446, device='cuda:3')
benign distance is  tensor(0.7446, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3140029907226562
distance x is tensor(0.4701, device='cuda:3')
benign distance is  tensor(0.4701, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2908220291137695
distance x is tensor(0.7112, device='cuda:3')
benign distance is  tensor(0.7112, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.296239137649536
distance x is tensor(0.7166, device='cuda:3')
benign distance is  tensor(0.7166, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.3175909519195557
distance x is tensor(0.5946, device='cuda:3')
benign distance is  tensor(0.5946, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2971084117889404
distance x is tensor(0.7321, device='cuda:3')
benign distance is  tensor(0.7321, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2922348976135254
distance x is tensor(19.9741, device='cuda:3')
benign distance is  tensor(19.9741, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2886147499084473
distance x is tensor(0.7533, device='cuda:3')
benign distance is  tensor(0.7533, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.3176162242889404
distance x is tensor(0.7538, device='cuda:3')
benign distance is  tensor(0.7538, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.298928737640381
distance x is tensor(1.5069, device='cuda:3')
benign distance is  tensor(1.5069, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2758002281188965
distance x is tensor(0.7072, device='cuda:3')
benign distance is  tensor(0.7072, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.2969021797180176
distance x is tensor(1.4382, device='cuda:3')
benign distance is  tensor(1.4382, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.3067290782928467
distance x is tensor(0.6312, device='cuda:3')
benign distance is  tensor(0.6312, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.2952566146850586
distance x is tensor(0.7683, device='cuda:3')
benign distance is  tensor(0.7683, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.2668216228485107
distance x is tensor(0.6990, device='cuda:3')
benign distance is  tensor(0.6990, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3287689685821533
distance x is tensor(0.6952, device='cuda:3')
benign distance is  tensor(0.6952, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.3438220024108887
distance x is tensor(0.7069, device='cuda:3')
benign distance is  tensor(0.7069, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.3177547454833984
distance x is tensor(1.1509, device='cuda:3')
benign distance is  tensor(1.1509, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.2802317142486572
distance x is tensor(0.6186, device='cuda:3')
benign distance is  tensor(0.6186, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.353322982788086
distance x is tensor(0.7520, device='cuda:3')
benign distance is  tensor(0.7520, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.300586223602295
distance x is tensor(1.3137, device='cuda:3')
benign distance is  tensor(1.3137, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.2805676460266113
distance x is tensor(0.7590, device='cuda:3')
benign distance is  tensor(0.7590, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.2747700214385986
distance x is tensor(0.6201, device='cuda:3')
benign distance is  tensor(0.6201, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.3439910411834717
distance x is tensor(0.8237, device='cuda:3')
benign distance is  tensor(0.8237, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.3183321952819824
distance x is tensor(1.1800, device='cuda:3')
benign distance is  tensor(1.1800, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.2910192012786865
distance x is tensor(0.6247, device='cuda:3')
benign distance is  tensor(0.6247, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.3156399726867676
distance x is tensor(0.6662, device='cuda:3')
benign distance is  tensor(0.6662, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.326874256134033
distance x is tensor(0.6439, device='cuda:3')
benign distance is  tensor(0.6439, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.265331506729126
distance x is tensor(0.8388, device='cuda:3')
benign distance is  tensor(0.8388, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.3392271995544434
distance x is tensor(0.7845, device='cuda:3')
benign distance is  tensor(0.7845, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.288461923599243
distance x is tensor(0.5729, device='cuda:3')
benign distance is  tensor(0.5729, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.357666254043579
distance x is tensor(0.6825, device='cuda:3')
benign distance is  tensor(0.6825, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(0.8625, device='cuda:3')
compute distance is  tensor(0.8625, device='cuda:3')
compute norm is  tensor(63.4707, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.6759, device='cuda:3')
compute distance is  tensor(0.6759, device='cuda:3')
compute norm is  tensor(63.4275, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.7145, device='cuda:3')
compute distance is  tensor(0.7145, device='cuda:3')
compute norm is  tensor(63.3767, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.7368, device='cuda:3')
compute distance is  tensor(0.7368, device='cuda:3')
compute norm is  tensor(63.4698, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.6568, device='cuda:3')
compute distance is  tensor(0.6568, device='cuda:3')
compute norm is  tensor(63.4317, device='cuda:3', dtype=torch.float64)
distance x is tensor(1.1115, device='cuda:3')
compute distance is  tensor(1.1115, device='cuda:3')
compute norm is  tensor(63.4126, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.5213, device='cuda:3')
compute distance is  tensor(0.5213, device='cuda:3')
compute norm is  tensor(63.3290, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.7723, device='cuda:3')
compute distance is  tensor(0.7723, device='cuda:3')
compute norm is  tensor(63.4297, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.6875, device='cuda:3')
compute distance is  tensor(0.6875, device='cuda:3')
compute norm is  tensor(63.3774, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.8257, device='cuda:3')
compute distance is  tensor(0.8257, device='cuda:3')
compute norm is  tensor(63.4362, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.9329, device='cuda:3')
compute distance is  tensor(0.9329, device='cuda:3')
compute norm is  tensor(63.4496, device='cuda:3', dtype=torch.float64)
distance x is tensor(0.9076, device='cuda:3')
compute distance is  tensor(0.9076, device='cuda:3')
compute norm is  tensor(63.4255, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(1.1115, device='cuda:3')
distance x is tensor(107461.8516, device='cuda:3')
distance x is tensor(107461.8516, device='cuda:3')
________________________________
test distance is  tensor(107461.8516, device='cuda:3')
test distance1 is  tensor(107461.8516, device='cuda:3')
test similarity is  tensor(0.6433, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130071533149806.27
test entropy is  0.0
________________________________
cal ratio is  0.0031517117977362483
distance x is tensor(338.6938, device='cuda:3')
cal_distance is  tensor(338.6938, device='cuda:3')
cal ratio is  0.056139698131363505
distance x is tensor(19.0192, device='cuda:3')
cal_distance is  tensor(19.0192, device='cuda:3')
cal ratio is  0.23690679120119082
distance x is tensor(4.5108, device='cuda:3')
cal_distance is  tensor(4.5108, device='cuda:3')
cal ratio is  0.4864622945753575
distance x is tensor(2.1982, device='cuda:3')
cal_distance is  tensor(2.1982, device='cuda:3')
cal ratio is  0.6968492121693456
distance x is tensor(1.5342, device='cuda:3')
cal_distance is  tensor(1.5342, device='cuda:3')
cal ratio is  0.8341155320391509
distance x is tensor(1.2811, device='cuda:3')
cal_distance is  tensor(1.2811, device='cuda:3')
cal ratio is  0.9128191643079516
distance x is tensor(1.1701, device='cuda:3')
cal_distance is  tensor(1.1701, device='cuda:3')
cal ratio is  0.9551250987977086
distance x is tensor(1.1180, device='cuda:3')
cal_distance is  tensor(1.1180, device='cuda:3')
cal ratio is  0.9771443137692427
distance x is tensor(1.0926, device='cuda:3')
cal_distance is  tensor(1.0926, device='cuda:3')
distance x is tensor(1.0926, device='cuda:3')
return_distance is  tensor(1.0926, device='cuda:3')
distance x is tensor(1.0828, device='cuda:3')
distance x is tensor(1.0828, device='cuda:3')
________________________________
test distance is  tensor(1.0828, device='cuda:3')
test distance1 is  tensor(1.0828, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.09978333348966531
test loss is 2.3031018156486787
test entropy is  2.3021108341623724
________________________________
0
distance x is tensor(1.0828, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.30211154204696
avg test loss is  2.3030459001374397
avg accuracy is  0.10006666682299865
solo acc is  0.10068333348966531
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(1.0828, device='cuda:3')
compute_norm is  tensor(63.3558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6.0388, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.8812888432413275
avg test loss is  2.6080435489032316
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9986, device='cuda:3')
compute_distance is  tensor(6.0388, device='cuda:3')
compute_norm is  tensor(64.4491, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(10.9446, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.181430580392321
avg test loss is  3.2034657276007157
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9971, device='cuda:3')
compute_distance is  tensor(10.9446, device='cuda:3')
compute_norm is  tensor(64.8935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(14.7319, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9586606278602503
avg test loss is  3.4613224837317396
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9965, device='cuda:3')
compute_distance is  tensor(14.7319, device='cuda:3')
compute_norm is  tensor(64.8372, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16.8495, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5189177177862319
avg test loss is  2.8835041251009716
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9976, device='cuda:3')
compute_distance is  tensor(16.8495, device='cuda:3')
compute_norm is  tensor(64.0608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.1294, device='cuda:3')
distance x is tensor(21.1294, device='cuda:3')
________________________________
test distance is  tensor(21.1294, device='cuda:3')
test distance1 is  tensor(21.1294, device='cuda:3')
test similarity is  tensor(0.9965, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.324737620252028
test entropy is  1.0630738925832166
________________________________
cal ratio is  0.22476562776124678
distance x is tensor(4.7486, device='cuda:3')
cal_distance is  tensor(4.7486, device='cuda:3')
cal ratio is  0.4741236007608433
distance x is tensor(2.2512, device='cuda:3')
cal_distance is  tensor(2.2512, device='cuda:3')
cal ratio is  0.6886015252907196
distance x is tensor(1.5500, device='cuda:3')
cal_distance is  tensor(1.5500, device='cuda:3')
cal ratio is  0.8298539528267113
distance x is tensor(1.2862, device='cuda:3')
cal_distance is  tensor(1.2862, device='cuda:3')
cal ratio is  0.910986021068092
distance x is tensor(1.1717, device='cuda:3')
cal_distance is  tensor(1.1717, device='cuda:3')
cal ratio is  0.954468837688949
distance x is tensor(1.1184, device='cuda:3')
cal_distance is  tensor(1.1184, device='cuda:3')
cal ratio is  0.9769761946378379
distance x is tensor(1.0926, device='cuda:3')
cal_distance is  tensor(1.0926, device='cuda:3')
distance x is tensor(1.0926, device='cuda:3')
return_distance is  tensor(1.0926, device='cuda:3')
distance x is tensor(1.0936, device='cuda:3')
distance x is tensor(1.0936, device='cuda:3')
________________________________
test distance is  tensor(1.0936, device='cuda:3')
test distance1 is  tensor(1.0936, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.304423093541599
test entropy is  2.3007172559624287
________________________________
0
distance x is tensor(1.0936, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.3007162097674696
avg test loss is  2.304369861637351
avg accuracy is  0.09813333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(1.0936, device='cuda:3')
compute_norm is  tensor(63.2895, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.3289, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.7810232687606486
avg test loss is  2.681865755174714
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9984, device='cuda:3')
compute_distance is  tensor(7.3289, device='cuda:3')
compute_norm is  tensor(64.4168, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.1242, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1169266680410421
avg test loss is  3.2777213732570982
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9971, device='cuda:3')
compute_distance is  tensor(12.1242, device='cuda:3')
compute_norm is  tensor(64.7739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.8235, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9438331861104539
avg test loss is  3.4870504611082422
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9966, device='cuda:3')
compute_distance is  tensor(15.8235, device='cuda:3')
compute_norm is  tensor(64.6768, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.9242, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5274213218231445
avg test loss is  2.877365713434687
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(17.9242, device='cuda:3')
compute_norm is  tensor(63.8992, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.2215, device='cuda:3')
distance x is tensor(22.2215, device='cuda:3')
________________________________
test distance is  tensor(22.2215, device='cuda:3')
test distance1 is  tensor(22.2215, device='cuda:3')
test similarity is  tensor(0.9966, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3350277374039834
test entropy is  1.057387541161417
________________________________
cal ratio is  0.21917303622182857
distance x is tensor(4.8694, device='cuda:3')
cal_distance is  tensor(4.8694, device='cuda:3')
cal ratio is  0.468203988630624
distance x is tensor(2.2795, device='cuda:3')
cal_distance is  tensor(2.2795, device='cuda:3')
cal ratio is  0.6843124367845161
distance x is tensor(1.5597, device='cuda:3')
cal_distance is  tensor(1.5597, device='cuda:3')
cal ratio is  0.8272898240998715
distance x is tensor(1.2902, device='cuda:3')
cal_distance is  tensor(1.2902, device='cuda:3')
cal ratio is  0.9095952714866756
distance x is tensor(1.1735, device='cuda:3')
cal_distance is  tensor(1.1735, device='cuda:3')
cal ratio is  0.9537512065284867
distance x is tensor(1.1192, device='cuda:3')
cal_distance is  tensor(1.1192, device='cuda:3')
cal ratio is  0.9766147533383575
distance x is tensor(1.0930, device='cuda:3')
cal_distance is  tensor(1.0930, device='cuda:3')
distance x is tensor(1.0930, device='cuda:3')
return_distance is  tensor(1.0930, device='cuda:3')
distance x is tensor(1.0945, device='cuda:3')
distance x is tensor(1.0945, device='cuda:3')
________________________________
test distance is  tensor(1.0945, device='cuda:3')
test distance1 is  tensor(1.0945, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.304182481155721
test entropy is  2.3008891412698382
________________________________
0
distance x is tensor(1.0945, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.3008908490890634
avg test loss is  2.3042448421022783
avg accuracy is  0.10028333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(1.0945, device='cuda:3')
compute_norm is  tensor(63.2832, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.3392, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.782957716410094
avg test loss is  2.6801596798622276
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9984, device='cuda:3')
compute_distance is  tensor(7.3392, device='cuda:3')
compute_norm is  tensor(64.4098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.1384, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.114241007802837
avg test loss is  3.2804638589623134
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9971, device='cuda:3')
compute_distance is  tensor(12.1384, device='cuda:3')
compute_norm is  tensor(64.7686, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.8388, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9403882706597415
avg test loss is  3.4916407668005935
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9966, device='cuda:3')
compute_distance is  tensor(15.8388, device='cuda:3')
compute_norm is  tensor(64.6729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.9385, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5270523103569615
avg test loss is  2.877400840777578
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9977, device='cuda:3')
compute_distance is  tensor(17.9385, device='cuda:3')
compute_norm is  tensor(63.8941, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.2355, device='cuda:3')
________________________________
test distance is  tensor(22.2355, device='cuda:3')
test similarity is  tensor(0.9966, device='cuda:3')
test acc is  0.10003333348966531
test loss is 3.3386934205158942
test entropy is  1.0542393296258028
________________________________
final entropy
distance x is tensor(22.2371, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0563602346474175
avg test loss is  3.3364229941927293
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9966, device='cuda:3')
compute_distance is  tensor(22.2371, device='cuda:3')
compute_norm is  tensor(64.0677, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.571488857269287
mal norm is  tensor(287.3356, device='cuda:3')
distance x is tensor(25.8309, device='cuda:3')
mal distance is  tensor(25.8309, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 27.6389,  34.1221,  32.3547,  27.9465,  32.1670,  25.3046,  27.2573,
         31.3460, 287.3356, 287.3356, 287.3356, 287.3356, 287.3356, 287.3356,
        287.3356, 287.3356, 287.3356, 287.3356, 287.3356, 287.3356],
       device='cuda:3')
sorted_norm is   tensor([ 25.3046,  27.2573,  27.6389,  27.9465,  31.3460,  32.1670,  32.3547,
         34.1221, 287.3356, 287.3356, 287.3356, 287.3356, 287.3356, 287.3356,
        287.3356, 287.3356, 287.3356, 287.3356, 287.3356, 287.3356],
       device='cuda:3')
used idx is  tensor([ 5,  6,  0,  3,  7,  4,  2,  1, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2918829917907715
distance x is tensor(2.5070, device='cuda:3')
benign distance is  tensor(2.5070, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3133578300476074
distance x is tensor(2.3627, device='cuda:3')
benign distance is  tensor(2.3627, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3135414123535156
distance x is tensor(2.5509, device='cuda:3')
benign distance is  tensor(2.5509, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.300929069519043
distance x is tensor(2.4570, device='cuda:3')
benign distance is  tensor(2.4570, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3087878227233887
distance x is tensor(2.4753, device='cuda:3')
benign distance is  tensor(2.4753, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3036980628967285
distance x is tensor(2.7318, device='cuda:3')
benign distance is  tensor(2.7318, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2938907146453857
distance x is tensor(2.5225, device='cuda:3')
benign distance is  tensor(2.5225, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.289654493331909
distance x is tensor(2.6716, device='cuda:3')
benign distance is  tensor(2.6716, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(2.6238, device='cuda:3')
compute distance is  tensor(2.6238, device='cuda:3')
compute norm is  tensor(62.6435, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5283, device='cuda:3')
compute distance is  tensor(2.5283, device='cuda:3')
compute norm is  tensor(62.6107, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4755, device='cuda:3')
compute distance is  tensor(2.4755, device='cuda:3')
compute norm is  tensor(62.5690, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8193, device='cuda:3')
compute distance is  tensor(2.8193, device='cuda:3')
compute norm is  tensor(62.5810, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.4797, device='cuda:3')
compute distance is  tensor(2.4797, device='cuda:3')
compute norm is  tensor(62.6163, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.8489, device='cuda:3')
compute distance is  tensor(2.8489, device='cuda:3')
compute norm is  tensor(62.5926, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.7052, device='cuda:3')
compute distance is  tensor(2.7052, device='cuda:3')
compute norm is  tensor(62.5091, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.6330, device='cuda:3')
compute distance is  tensor(2.6330, device='cuda:3')
compute norm is  tensor(62.6238, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.7735, device='cuda:3')
compute distance is  tensor(2.7735, device='cuda:3')
compute norm is  tensor(62.5055, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.5852, device='cuda:3')
compute distance is  tensor(2.5852, device='cuda:3')
compute norm is  tensor(62.6182, device='cuda:3', dtype=torch.float64)
distance x is tensor(3.0216, device='cuda:3')
compute distance is  tensor(3.0216, device='cuda:3')
compute norm is  tensor(62.5295, device='cuda:3', dtype=torch.float64)
distance x is tensor(2.6275, device='cuda:3')
compute distance is  tensor(2.6275, device='cuda:3')
compute norm is  tensor(62.5616, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(3.0216, device='cuda:3')
distance x is tensor(107461.9531, device='cuda:3')
distance x is tensor(107461.9531, device='cuda:3')
________________________________
test distance is  tensor(107461.9531, device='cuda:3')
test distance1 is  tensor(107461.9531, device='cuda:3')
test similarity is  tensor(0.6427, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130153227361657.72
test entropy is  0.0
________________________________
cal ratio is  0.0051965554297153105
distance x is tensor(558.4371, device='cuda:3')
cal_distance is  tensor(558.4371, device='cuda:3')
cal ratio is  0.07208681143985111
distance x is tensor(40.2607, device='cuda:3')
cal_distance is  tensor(40.2607, device='cuda:3')
cal ratio is  0.2684739462365484
distance x is tensor(10.8132, device='cuda:3')
cal_distance is  tensor(10.8132, device='cuda:3')
cal ratio is  0.5180441626976965
distance x is tensor(5.6048, device='cuda:3')
cal_distance is  tensor(5.6048, device='cuda:3')
cal ratio is  0.7195499613396817
distance x is tensor(4.0350, device='cuda:3')
cal_distance is  tensor(4.0350, device='cuda:3')
cal ratio is  0.8480527505201069
distance x is tensor(3.4230, device='cuda:3')
cal_distance is  tensor(3.4230, device='cuda:3')
cal ratio is  0.9207463192427284
distance x is tensor(3.1523, device='cuda:3')
cal_distance is  tensor(3.1523, device='cuda:3')
cal ratio is  0.9594642803387585
distance x is tensor(3.0248, device='cuda:3')
cal_distance is  tensor(3.0248, device='cuda:3')
cal ratio is  0.9794725971852883
distance x is tensor(2.9629, device='cuda:3')
cal_distance is  tensor(2.9629, device='cuda:3')
distance x is tensor(2.9629, device='cuda:3')
return_distance is  tensor(2.9629, device='cuda:3')
distance x is tensor(2.9530, device='cuda:3')
distance x is tensor(2.9530, device='cuda:3')
________________________________
test distance is  tensor(2.9530, device='cuda:3')
test distance1 is  tensor(2.9530, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.493493274839194
test entropy is  2.0429006698034975
________________________________
0
distance x is tensor(2.9530, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0428981783547635
avg test loss is  2.493994548630867
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2.9530, device='cuda:3')
compute_norm is  tensor(63.5681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(5.9409, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.194573354111043
avg test loss is  3.19688066871944
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(5.9409, device='cuda:3')
compute_norm is  tensor(64.1736, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9.0898, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9559929521480349
avg test loss is  3.480038045565965
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(9.0898, device='cuda:3')
compute_norm is  tensor(64.1347, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11.0690, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5418986948822606
avg test loss is  2.8664669380513335
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(11.0690, device='cuda:3')
compute_norm is  tensor(63.3862, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(15.2421, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0458662103234069
avg test loss is  3.353972740773199
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:3')
compute_distance is  tensor(15.2421, device='cuda:3')
compute_norm is  tensor(63.5731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.7449, device='cuda:3')
distance x is tensor(18.7449, device='cuda:3')
________________________________
test distance is  tensor(18.7449, device='cuda:3')
test distance1 is  tensor(18.7449, device='cuda:3')
test similarity is  tensor(0.9991, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5127886482901665
test entropy is  0.9192405357670936
________________________________
cal ratio is  0.39346041833816686
distance x is tensor(7.3754, device='cuda:3')
cal_distance is  tensor(7.3754, device='cuda:3')
cal ratio is  0.6272620751597257
distance x is tensor(4.6264, device='cuda:3')
cal_distance is  tensor(4.6264, device='cuda:3')
cal ratio is  0.7919970279268168
distance x is tensor(3.6641, device='cuda:3')
cal_distance is  tensor(3.6641, device='cuda:3')
cal ratio is  0.8899405561510269
distance x is tensor(3.2608, device='cuda:3')
cal_distance is  tensor(3.2608, device='cuda:3')
cal ratio is  0.9433655205125628
distance x is tensor(3.0761, device='cuda:3')
cal_distance is  tensor(3.0761, device='cuda:3')
cal ratio is  0.9712693221086188
distance x is tensor(2.9878, device='cuda:3')
cal_distance is  tensor(2.9878, device='cuda:3')
distance x is tensor(2.9878, device='cuda:3')
return_distance is  tensor(2.9878, device='cuda:3')
distance x is tensor(2.9877, device='cuda:3')
distance x is tensor(2.9877, device='cuda:3')
________________________________
test distance is  tensor(2.9877, device='cuda:3')
test distance1 is  tensor(2.9877, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.5805541703950112
test entropy is  1.9192391411582035
________________________________
0
distance x is tensor(2.9877, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9190777587229764
avg test loss is  2.5812341856803975
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2.9877, device='cuda:3')
compute_norm is  tensor(63.4441, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(7.9786, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1413623330943874
avg test loss is  3.252819710957216
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(7.9786, device='cuda:3')
compute_norm is  tensor(63.9203, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.6765, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.944448641368321
avg test loss is  3.4932344051312283
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(11.6765, device='cuda:3')
compute_norm is  tensor(63.8462, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(13.8491, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5391548383973046
avg test loss is  2.868617770768432
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(13.8491, device='cuda:3')
compute_norm is  tensor(63.0850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.0808, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0464248645153127
avg test loss is  3.351426947091434
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(18.0808, device='cuda:3')
compute_norm is  tensor(63.2704, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.6303, device='cuda:3')
distance x is tensor(21.6303, device='cuda:3')
________________________________
test distance is  tensor(21.6303, device='cuda:3')
test distance1 is  tensor(21.6303, device='cuda:3')
test similarity is  tensor(0.9990, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.509731855982148
test entropy is  0.9205428035909942
________________________________
cal ratio is  0.3662789208951852
distance x is tensor(7.9218, device='cuda:3')
cal_distance is  tensor(7.9218, device='cuda:3')
cal ratio is  0.6052444545506774
distance x is tensor(4.7944, device='cuda:3')
cal_distance is  tensor(4.7944, device='cuda:3')
cal ratio is  0.7779952583769139
distance x is tensor(3.7299, device='cuda:3')
cal_distance is  tensor(3.7299, device='cuda:3')
cal ratio is  0.8820571139440203
distance x is tensor(3.2899, device='cuda:3')
cal_distance is  tensor(3.2899, device='cuda:3')
cal ratio is  0.9391894997709804
distance x is tensor(3.0898, device='cuda:3')
cal_distance is  tensor(3.0898, device='cuda:3')
cal ratio is  0.9691237742424748
distance x is tensor(2.9944, device='cuda:3')
cal_distance is  tensor(2.9944, device='cuda:3')
distance x is tensor(2.9944, device='cuda:3')
return_distance is  tensor(2.9944, device='cuda:3')
distance x is tensor(2.9957, device='cuda:3')
distance x is tensor(2.9957, device='cuda:3')
________________________________
test distance is  tensor(2.9957, device='cuda:3')
test distance1 is  tensor(2.9957, device='cuda:3')
test similarity is  tensor(1.0000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.5683862974902967
test entropy is  1.9364485191638028
________________________________
0
distance x is tensor(2.9957, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9363600202460787
avg test loss is  2.568692960464624
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:3')
compute_distance is  tensor(2.9957, device='cuda:3')
compute_norm is  tensor(63.4041, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(8.0400, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.1489328783966586
avg test loss is  3.246329574950977
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9995, device='cuda:3')
compute_distance is  tensor(8.0400, device='cuda:3')
compute_norm is  tensor(63.8971, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.7563, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.944216399431737
avg test loss is  3.4926819999589087
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(11.7563, device='cuda:3')
compute_norm is  tensor(63.8287, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(13.9322, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5400566323987965
avg test loss is  2.8671340464528945
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9997, device='cuda:3')
compute_distance is  tensor(13.9322, device='cuda:3')
compute_norm is  tensor(63.0679, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(18.1695, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0453918249622336
avg test loss is  3.351698563297166
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:3')
compute_distance is  tensor(18.1695, device='cuda:3')
compute_norm is  tensor(63.2565, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(21.7185, device='cuda:3')
________________________________
test distance is  tensor(21.7185, device='cuda:3')
test similarity is  tensor(0.9990, device='cuda:3')
test acc is  0.10003333348966531
test loss is 3.5120475383709744
test entropy is  0.9187902473310418
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 3.5712578296661377
mal norm is  tensor(156.3989, device='cuda:3')
distance x is tensor(21.7185, device='cuda:3')
mal distance is  tensor(21.7185, device='cuda:3')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([128.7598, 122.5040, 129.5730, 122.5104, 124.7130, 144.2869, 126.6208,
        134.7984, 156.3989, 156.3989, 156.3989, 156.3989, 156.3989, 156.3989,
        156.3989, 156.3989, 156.3989, 156.3989, 156.3989, 156.3989, 195.4537,
        174.5224, 189.5992, 290.2254, 184.6279, 223.3470, 217.8672, 326.9919,
        168.0569, 156.8513, 160.4853, 147.3313, 137.3305, 139.8737, 254.5395,
        151.5819], device='cuda:3')
sorted_norm is   tensor([122.5040, 122.5104, 124.7130, 126.6208, 128.7598, 129.5730, 134.7984,
        137.3305, 139.8737, 144.2869, 147.3313, 151.5819, 156.3989, 156.3989,
        156.3989, 156.3989, 156.3989, 156.3989, 156.3989, 156.3989, 156.3989,
        156.3989, 156.3989, 156.3989, 156.8513, 160.4853, 168.0569, 174.5224,
        184.6279, 189.5992, 195.4537, 217.8672, 223.3470, 254.5395, 290.2254,
        326.9919], device='cuda:3')
used idx is  tensor([ 1,  3,  4,  6,  0,  2,  7, 32, 33,  5, 31, 35, 19, 18, 16, 17, 11, 10,
         8,  9, 13, 12, 14, 15, 29, 30, 28, 21], device='cuda:3')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 9.90% 

Test Accuracy: 10.00% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 9.90%
|----0th round Training Accuracy : 86.72%
|----1th round Training Accuracy : 87.38%
|----2th round Training Accuracy : 87.08%
|----3th round Training Accuracy : 87.85%
|----4th round Training Accuracy : 80.33%
|----5th round Training Accuracy : 61.52%
|----6th round Training Accuracy : 72.66%
|----7th round Training Accuracy : 86.42%
|----8th round Training Accuracy : 85.04%
|----9th round Training Accuracy : 85.37%
|----10th round Training Accuracy : 70.98%
|----11th round Training Accuracy : 83.96%
|----12th round Training Accuracy : 84.12%
|----13th round Training Accuracy : 84.38%
|----14th round Training Accuracy : 86.35%
|----15th round Training Accuracy : 82.83%
|----16th round Training Accuracy : 84.59%
|----17th round Training Accuracy : 75.47%
|----18th round Training Accuracy : 80.82%
|----19th round Training Accuracy : 87.43%
|----20th round Training Accuracy : 85.63%
|----21th round Training Accuracy : 88.35%
|----22th round Training Accuracy : 86.59%
|----23th round Training Accuracy : 88.05%
|----24th round Training Accuracy : 86.57%
|----25th round Training Accuracy : 8.88%
|----26th round Training Accuracy : 9.90%
|----27th round Training Accuracy : 9.90%
|----28th round Training Accuracy : 9.90%
|----29th round Training Accuracy : 9.90%
|----30th round Training Accuracy : 9.90%
|----31th round Training Accuracy : 9.90%
|----32th round Training Accuracy : 9.90%
|----33th round Training Accuracy : 9.90%
|----34th round Training Accuracy : 9.90%
|----35th round Training Accuracy : 9.90%
|----36th round Training Accuracy : 9.90%
|----37th round Training Accuracy : 9.90%
|----38th round Training Accuracy : 9.90%
|----39th round Training Accuracy : 9.90%
|----40th round Training Accuracy : 9.90%
|----41th round Training Accuracy : 9.90%
|----42th round Training Accuracy : 9.90%
|----43th round Training Accuracy : 9.90%
|----44th round Training Accuracy : 9.91%
|----45th round Training Accuracy : 9.90%
|----46th round Training Accuracy : 9.90%
|----47th round Training Accuracy : 10.20%
|----48th round Training Accuracy : 9.90%
|----49th round Training Accuracy : 9.90%
|----Final Test Accuracy: 10.00%
|----0th round Final Test Accuracy : 85.73%
|----1th round Final Test Accuracy : 86.67%
|----2th round Final Test Accuracy : 86.29%
|----3th round Final Test Accuracy : 86.69%
|----4th round Final Test Accuracy : 79.77%
|----5th round Final Test Accuracy : 60.28%
|----6th round Final Test Accuracy : 71.42%
|----7th round Final Test Accuracy : 85.26%
|----8th round Final Test Accuracy : 84.05%
|----9th round Final Test Accuracy : 84.59%
|----10th round Final Test Accuracy : 69.94%
|----11th round Final Test Accuracy : 82.58%
|----12th round Final Test Accuracy : 83.45%
|----13th round Final Test Accuracy : 83.02%
|----14th round Final Test Accuracy : 85.22%
|----15th round Final Test Accuracy : 81.47%
|----16th round Final Test Accuracy : 82.95%
|----17th round Final Test Accuracy : 74.15%
|----18th round Final Test Accuracy : 80.04%
|----19th round Final Test Accuracy : 86.03%
|----20th round Final Test Accuracy : 84.37%
|----21th round Final Test Accuracy : 87.19%
|----22th round Final Test Accuracy : 85.40%
|----23th round Final Test Accuracy : 86.82%
|----24th round Final Test Accuracy : 85.12%
|----25th round Final Test Accuracy : 8.93%
|----26th round Final Test Accuracy : 10.00%
|----27th round Final Test Accuracy : 10.00%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 10.00%
|----30th round Final Test Accuracy : 10.00%
|----31th round Final Test Accuracy : 10.00%
|----32th round Final Test Accuracy : 10.00%
|----33th round Final Test Accuracy : 10.00%
|----34th round Final Test Accuracy : 10.00%
|----35th round Final Test Accuracy : 10.00%
|----36th round Final Test Accuracy : 10.00%
|----37th round Final Test Accuracy : 10.00%
|----38th round Final Test Accuracy : 10.00%
|----39th round Final Test Accuracy : 10.01%
|----40th round Final Test Accuracy : 10.00%
|----41th round Final Test Accuracy : 10.00%
|----42th round Final Test Accuracy : 10.00%
|----43th round Final Test Accuracy : 10.00%
|----44th round Final Test Accuracy : 10.01%
|----45th round Final Test Accuracy : 10.00%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 10.00%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 10.00%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 28970.3001
