
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4169309735298157
distance 1 is tensor(102.8615, device='cuda:3')
benign distance is  tensor(102.8615, device='cuda:3')
norm1 res is  tensor(0.1174, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.40455347299575806
distance 1 is tensor(118.5519, device='cuda:3')
benign distance is  tensor(118.5519, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3410186767578125
distance 1 is tensor(123.4192, device='cuda:3')
benign distance is  tensor(123.4192, device='cuda:3')
norm1 res is  tensor(0.1399, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.46792808175086975
distance 1 is tensor(115.9329, device='cuda:3')
benign distance is  tensor(115.9329, device='cuda:3')
norm1 res is  tensor(0.1341, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7618342638015747
distance 1 is tensor(108.9609, device='cuda:3')
benign distance is  tensor(108.9609, device='cuda:3')
norm1 res is  tensor(0.1287, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6745012402534485
distance 1 is tensor(121.7013, device='cuda:3')
benign distance is  tensor(121.7013, device='cuda:3')
norm1 res is  tensor(0.1457, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6167237162590027
distance 1 is tensor(106.7568, device='cuda:3')
benign distance is  tensor(106.7568, device='cuda:3')
norm1 res is  tensor(0.1192, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.31496620178222656
distance 1 is tensor(119.4437, device='cuda:3')
benign distance is  tensor(119.4437, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.20242926478385925
distance 1 is tensor(141.0527, device='cuda:3')
benign distance is  tensor(141.0527, device='cuda:3')
norm1 res is  tensor(0.1631, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.36288982629776
distance 1 is tensor(136.8392, device='cuda:3')
benign distance is  tensor(136.8392, device='cuda:3')
norm1 res is  tensor(0.1570, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.6290327310562134
distance 1 is tensor(121.5914, device='cuda:3')
benign distance is  tensor(121.5914, device='cuda:3')
norm1 res is  tensor(0.1400, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.10882923752069473
distance 1 is tensor(130.4711, device='cuda:3')
benign distance is  tensor(130.4711, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.38975265622138977
distance 1 is tensor(128.2938, device='cuda:3')
benign distance is  tensor(128.2938, device='cuda:3')
norm1 res is  tensor(0.1469, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.37291401624679565
distance 1 is tensor(147.1193, device='cuda:3')
benign distance is  tensor(147.1193, device='cuda:3')
norm1 res is  tensor(0.1685, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.8730848431587219
distance 1 is tensor(137.1379, device='cuda:3')
benign distance is  tensor(137.1379, device='cuda:3')
norm1 res is  tensor(0.1589, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3940919041633606
distance 1 is tensor(136.0475, device='cuda:3')
benign distance is  tensor(136.0475, device='cuda:3')
norm1 res is  tensor(0.1559, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.25978025794029236
distance 1 is tensor(126.4968, device='cuda:3')
benign distance is  tensor(126.4968, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.8579353094100952
distance 1 is tensor(143.5164, device='cuda:3')
benign distance is  tensor(143.5164, device='cuda:3')
norm1 res is  tensor(0.1669, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.3002455234527588
distance 1 is tensor(126.2752, device='cuda:3')
benign distance is  tensor(126.2752, device='cuda:3')
norm1 res is  tensor(0.1491, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.42823272943496704
distance 1 is tensor(127.7285, device='cuda:3')
benign distance is  tensor(127.7285, device='cuda:3')
norm1 res is  tensor(0.1519, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.2550564706325531
distance 1 is tensor(130.1911, device='cuda:3')
benign distance is  tensor(130.1911, device='cuda:3')
norm1 res is  tensor(0.1489, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.2159195840358734
distance 1 is tensor(123.9594, device='cuda:3')
benign distance is  tensor(123.9594, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3450435996055603
distance 1 is tensor(142.4361, device='cuda:3')
benign distance is  tensor(142.4361, device='cuda:3')
norm1 res is  tensor(0.1647, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.8421791195869446
distance 1 is tensor(135.5702, device='cuda:3')
benign distance is  tensor(135.5702, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.5319390892982483
distance 1 is tensor(145.0707, device='cuda:3')
benign distance is  tensor(145.0707, device='cuda:3')
norm1 res is  tensor(0.1671, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.5595752000808716
distance 1 is tensor(122.8029, device='cuda:3')
benign distance is  tensor(122.8029, device='cuda:3')
norm1 res is  tensor(0.1357, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.9679329991340637
distance 1 is tensor(136.8259, device='cuda:3')
benign distance is  tensor(136.8259, device='cuda:3')
norm1 res is  tensor(0.1565, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.22697477042675018
distance 1 is tensor(150.8102, device='cuda:3')
benign distance is  tensor(150.8102, device='cuda:3')
norm1 res is  tensor(0.1672, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  1.0609418153762817
distance 1 is tensor(129.8354, device='cuda:3')
benign distance is  tensor(129.8354, device='cuda:3')
norm1 res is  tensor(0.1491, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.7615232467651367
distance 1 is tensor(136.7387, device='cuda:3')
benign distance is  tensor(136.7387, device='cuda:3')
norm1 res is  tensor(0.1618, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.539945662021637
distance 1 is tensor(124.6095, device='cuda:3')
benign distance is  tensor(124.6095, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.9161020517349243
distance 1 is tensor(131.5638, device='cuda:3')
benign distance is  tensor(131.5638, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.5032418966293335
distance 1 is tensor(134.3087, device='cuda:3')
benign distance is  tensor(134.3087, device='cuda:3')
norm1 res is  tensor(0.1542, device='cuda:3')
current submit client idx and staleness is  33 5

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5811079740524292
distance 1 is tensor(111.5575, device='cuda:3')
benign distance is  tensor(111.5575, device='cuda:3')
norm1 res is  tensor(0.1297, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.541612982749939
distance 1 is tensor(120.8714, device='cuda:3')
benign distance is  tensor(120.8714, device='cuda:3')
norm1 res is  tensor(0.1413, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.7939136028289795
distance 1 is tensor(126.2110, device='cuda:3')
benign distance is  tensor(126.2110, device='cuda:3')
norm1 res is  tensor(0.1440, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.556455135345459
distance 1 is tensor(117.9877, device='cuda:3')
benign distance is  tensor(117.9877, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.678381621837616
distance 1 is tensor(106.2028, device='cuda:3')
benign distance is  tensor(106.2028, device='cuda:3')
norm1 res is  tensor(0.1224, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.39493268728256226
distance 1 is tensor(123.5407, device='cuda:3')
benign distance is  tensor(123.5407, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5113517045974731
distance 1 is tensor(105.1358, device='cuda:3')
benign distance is  tensor(105.1358, device='cuda:3')
norm1 res is  tensor(0.1179, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.48258644342422485
distance 1 is tensor(124.6522, device='cuda:3')
benign distance is  tensor(124.6522, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.14146524667739868
distance 1 is tensor(140.8964, device='cuda:3')
benign distance is  tensor(140.8964, device='cuda:3')
norm1 res is  tensor(0.1628, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5160371661186218
distance 1 is tensor(135.0701, device='cuda:3')
benign distance is  tensor(135.0701, device='cuda:3')
norm1 res is  tensor(0.1538, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.31244218349456787
distance 1 is tensor(125.4541, device='cuda:3')
benign distance is  tensor(125.4541, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5941583514213562
distance 1 is tensor(133.0699, device='cuda:3')
benign distance is  tensor(133.0699, device='cuda:3')
norm1 res is  tensor(0.1548, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.43367481231689453
distance 1 is tensor(129.4442, device='cuda:3')
benign distance is  tensor(129.4442, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.28471213579177856
distance 1 is tensor(138.6632, device='cuda:3')
benign distance is  tensor(138.6632, device='cuda:3')
norm1 res is  tensor(0.1601, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4878617823123932
distance 1 is tensor(136.8481, device='cuda:3')
benign distance is  tensor(136.8481, device='cuda:3')
norm1 res is  tensor(0.1578, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3500876724720001
distance 1 is tensor(132.4831, device='cuda:3')
benign distance is  tensor(132.4831, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.2975606918334961
distance 1 is tensor(127.8609, device='cuda:3')
benign distance is  tensor(127.8609, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.24957172572612762
distance 1 is tensor(147.8644, device='cuda:3')
benign distance is  tensor(147.8644, device='cuda:3')
norm1 res is  tensor(0.1723, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.47012537717819214
distance 1 is tensor(124.3622, device='cuda:3')
benign distance is  tensor(124.3622, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.8126007318496704
distance 1 is tensor(123.0979, device='cuda:3')
benign distance is  tensor(123.0979, device='cuda:3')
norm1 res is  tensor(0.1446, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.17251989245414734
distance 1 is tensor(128.6574, device='cuda:3')
benign distance is  tensor(128.6574, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.1913871169090271
distance 1 is tensor(127.1453, device='cuda:3')
benign distance is  tensor(127.1453, device='cuda:3')
norm1 res is  tensor(0.1449, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.1831352561712265
distance 1 is tensor(139.7718, device='cuda:3')
benign distance is  tensor(139.7718, device='cuda:3')
norm1 res is  tensor(0.1645, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.8421910405158997
distance 1 is tensor(133.6743, device='cuda:3')
benign distance is  tensor(133.6743, device='cuda:3')
norm1 res is  tensor(0.1519, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.5328723192214966
distance 1 is tensor(143.0553, device='cuda:3')
benign distance is  tensor(143.0553, device='cuda:3')
norm1 res is  tensor(0.1638, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.6259765625
distance 1 is tensor(122.8026, device='cuda:3')
benign distance is  tensor(122.8026, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.8682416677474976
distance 1 is tensor(138.3564, device='cuda:3')
benign distance is  tensor(138.3564, device='cuda:3')
norm1 res is  tensor(0.1575, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.2813560366630554
distance 1 is tensor(139.1830, device='cuda:3')
benign distance is  tensor(139.1830, device='cuda:3')
norm1 res is  tensor(0.1544, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  1.0091603994369507
distance 1 is tensor(130.9159, device='cuda:3')
benign distance is  tensor(130.9159, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.9806715250015259
distance 1 is tensor(133.1470, device='cuda:3')
benign distance is  tensor(133.1470, device='cuda:3')
norm1 res is  tensor(0.1557, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.3613826632499695
distance 1 is tensor(127.1301, device='cuda:3')
benign distance is  tensor(127.1301, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.926850438117981
distance 1 is tensor(134.1976, device='cuda:3')
benign distance is  tensor(134.1976, device='cuda:3')
norm1 res is  tensor(0.1591, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.3321477174758911
distance 1 is tensor(136.3563, device='cuda:3')
benign distance is  tensor(136.3563, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.05136726051568985
distance 1 is tensor(123.5528, device='cuda:3')
benign distance is  tensor(123.5528, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.4774765372276306
distance 1 is tensor(141.6225, device='cuda:3')
benign distance is  tensor(141.6225, device='cuda:3')
norm1 res is  tensor(0.1652, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.11085996776819229
distance 1 is tensor(132.2444, device='cuda:3')
benign distance is  tensor(132.2444, device='cuda:3')
norm1 res is  tensor(0.1507, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.3490488529205322
distance 1 is tensor(131.1490, device='cuda:3')
benign distance is  tensor(131.1490, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.23710136115550995
distance 1 is tensor(125.5196, device='cuda:3')
benign distance is  tensor(125.5196, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.533455491065979
distance 1 is tensor(127.4865, device='cuda:3')
benign distance is  tensor(127.4865, device='cuda:3')
norm1 res is  tensor(0.1473, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.2933187186717987
distance 1 is tensor(124.9239, device='cuda:3')
benign distance is  tensor(124.9239, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.14231982827186584
distance 1 is tensor(128.0027, device='cuda:3')
benign distance is  tensor(128.0027, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.4778018891811371
distance 1 is tensor(125.4059, device='cuda:3')
benign distance is  tensor(125.4059, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.07480348646640778
distance 1 is tensor(129.0067, device='cuda:3')
benign distance is  tensor(129.0067, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.1616494208574295
distance 1 is tensor(140.5998, device='cuda:3')
benign distance is  tensor(140.5998, device='cuda:3')
norm1 res is  tensor(0.1583, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.42716073989868164
distance 1 is tensor(133.2476, device='cuda:3')
benign distance is  tensor(133.2476, device='cuda:3')
norm1 res is  tensor(0.1532, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.6687940359115601
distance 1 is tensor(127.3169, device='cuda:3')
benign distance is  tensor(127.3169, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.7235814332962036
distance 1 is tensor(135.4989, device='cuda:3')
benign distance is  tensor(135.4989, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.179883673787117
distance 1 is tensor(131.0132, device='cuda:3')
benign distance is  tensor(131.0132, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  48 1
 benign loss is  0.1708247810602188
distance 1 is tensor(113.8606, device='cuda:3')
benign distance is  tensor(113.8606, device='cuda:3')
norm1 res is  tensor(0.1344, device='cuda:3')
current submit client idx and staleness is  49 1
 benign loss is  0.4810594618320465
distance 1 is tensor(111.8663, device='cuda:3')
benign distance is  tensor(111.8663, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  50 1
 benign loss is  0.5284997820854187
distance 1 is tensor(125.5805, device='cuda:3')
benign distance is  tensor(125.5805, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  51 1
 benign loss is  0.17913205921649933
distance 1 is tensor(123.8761, device='cuda:3')
benign distance is  tensor(123.8761, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  52 1
 benign loss is  0.6562947034835815
distance 1 is tensor(120.2939, device='cuda:3')
benign distance is  tensor(120.2939, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  53 1
 benign loss is  0.5913189053535461
distance 1 is tensor(117.3999, device='cuda:3')
benign distance is  tensor(117.3999, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  54 1
 benign loss is  0.03419490531086922
distance 1 is tensor(123.7153, device='cuda:3')
benign distance is  tensor(123.7153, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  55 1
 benign loss is  0.6716409921646118
distance 1 is tensor(119.3532, device='cuda:3')
benign distance is  tensor(119.3532, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  56 1
 benign loss is  0.5969334840774536
distance 1 is tensor(126.1733, device='cuda:3')
benign distance is  tensor(126.1733, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  57 1
 benign loss is  0.770175576210022
distance 1 is tensor(118.0229, device='cuda:3')
benign distance is  tensor(118.0229, device='cuda:3')
norm1 res is  tensor(0.1358, device='cuda:3')
current submit client idx and staleness is  58 1
 benign loss is  0.31465932726860046
distance 1 is tensor(122.8874, device='cuda:3')
benign distance is  tensor(122.8874, device='cuda:3')
norm1 res is  tensor(0.1437, device='cuda:3')
current submit client idx and staleness is  59 1
 benign loss is  0.2808428704738617
distance 1 is tensor(127.0979, device='cuda:3')
benign distance is  tensor(127.0979, device='cuda:3')
norm1 res is  tensor(0.1447, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(23.7444, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.7764, device='cuda:3')
part1 is  tensor(-15.6319, device='cuda:3')
score : tensor(-0.1799, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.2130, device='cuda:3')
part1 is  tensor(-10.3085, device='cuda:3')
score : tensor(-0.1266, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(570.8273, device='cuda:3')
part1 is  tensor(47.6751, device='cuda:3')
score : tensor(0.4532, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.9958, device='cuda:3')
part1 is  tensor(32.7192, device='cuda:3')
score : tensor(0.3036, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.7746, device='cuda:3')
part1 is  tensor(-43.8827, device='cuda:3')
score : tensor(-0.4624, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.6920, device='cuda:3')
part1 is  tensor(-8.9375, device='cuda:3')
score : tensor(-0.1129, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.3285, device='cuda:3')
part1 is  tensor(26.9368, device='cuda:3')
score : tensor(0.2458, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.4061, device='cuda:3')
part1 is  tensor(10.2275, device='cuda:3')
score : tensor(0.0787, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.1757, device='cuda:3')
part1 is  tensor(44.6275, device='cuda:3')
score : tensor(0.4227, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.6617, device='cuda:3')
part1 is  tensor(-33.1675, device='cuda:3')
score : tensor(-0.3552, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.6862, device='cuda:3')
part1 is  tensor(3.2659, device='cuda:3')
score : tensor(0.0091, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.4673, device='cuda:3')
part1 is  tensor(5.7700, device='cuda:3')
score : tensor(0.0342, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.6837, device='cuda:3')
part1 is  tensor(32.0458, device='cuda:3')
score : tensor(0.2969, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.8069, device='cuda:3')
part1 is  tensor(-18.8531, device='cuda:3')
score : tensor(-0.2121, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.0686, device='cuda:3')
part1 is  tensor(44.2611, device='cuda:3')
score : tensor(0.4191, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.0652, device='cuda:3')
part1 is  tensor(-39.7159, device='cuda:3')
score : tensor(-0.4207, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.4035, device='cuda:3')
part1 is  tensor(-45.8792, device='cuda:3')
score : tensor(-0.4823, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.9305, device='cuda:3')
part1 is  tensor(-7.3470, device='cuda:3')
score : tensor(-0.0970, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.1388, device='cuda:3')
part1 is  tensor(47.0167, device='cuda:3')
score : tensor(0.4466, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.9236, device='cuda:3')
part1 is  tensor(14.2239, device='cuda:3')
score : tensor(0.1187, device='cuda:3')
accept
len accept list 11
len all weights is 11
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 89.45% 

Test Accuracy: 88.75% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.11829733848571777
distance 1 is tensor(126.7794, device='cuda:3')
benign distance is  tensor(126.7794, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7051382064819336
distance 1 is tensor(137.8678, device='cuda:3')
benign distance is  tensor(137.8678, device='cuda:3')
norm1 res is  tensor(0.1608, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.04168172925710678
distance 1 is tensor(123.1512, device='cuda:3')
benign distance is  tensor(123.1512, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.2240624725818634
distance 1 is tensor(114.5501, device='cuda:3')
benign distance is  tensor(114.5501, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3589787483215332
distance 1 is tensor(105.3716, device='cuda:3')
benign distance is  tensor(105.3716, device='cuda:3')
norm1 res is  tensor(0.1209, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.47294822335243225
distance 1 is tensor(118.9595, device='cuda:3')
benign distance is  tensor(118.9595, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.0719156563282013
distance 1 is tensor(118.2146, device='cuda:3')
benign distance is  tensor(118.2146, device='cuda:3')
norm1 res is  tensor(0.1336, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.35865268111228943
distance 1 is tensor(118.0499, device='cuda:3')
benign distance is  tensor(118.0499, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(19.5229, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.6674, device='cuda:3')
part1 is  tensor(-20.6190, device='cuda:3')
score : tensor(-0.2255, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.3162, device='cuda:3')
part1 is  tensor(-36.3930, device='cuda:3')
score : tensor(-0.3833, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.5610, device='cuda:3')
part1 is  tensor(70.2687, device='cuda:3')
score : tensor(0.6834, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.4777, device='cuda:3')
part1 is  tensor(28.1698, device='cuda:3')
score : tensor(0.2624, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.1877, device='cuda:3')
part1 is  tensor(-36.6141, device='cuda:3')
score : tensor(-0.3855, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.5798, device='cuda:3')
part1 is  tensor(5.2499, device='cuda:3')
score : tensor(0.0332, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(529.3089, device='cuda:3')
part1 is  tensor(24.6033, device='cuda:3')
score : tensor(0.2267, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.2507, device='cuda:3')
part1 is  tensor(-25.1676, device='cuda:3')
score : tensor(-0.2710, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.6868, device='cuda:3')
part1 is  tensor(22.6357, device='cuda:3')
score : tensor(0.2070, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.3229, device='cuda:3')
part1 is  tensor(-7.1602, device='cuda:3')
score : tensor(-0.0909, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.1917, device='cuda:3')
part1 is  tensor(1.2182, device='cuda:3')
score : tensor(-0.0071, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.8576, device='cuda:3')
part1 is  tensor(-20.9158, device='cuda:3')
score : tensor(-0.2285, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.4090, device='cuda:3')
part1 is  tensor(-6.7242, device='cuda:3')
score : tensor(-0.0866, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.3963, device='cuda:3')
part1 is  tensor(3.1359, device='cuda:3')
score : tensor(0.0120, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.3044, device='cuda:3')
part1 is  tensor(-25.9078, device='cuda:3')
score : tensor(-0.2784, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.1038, device='cuda:3')
part1 is  tensor(-13.4070, device='cuda:3')
score : tensor(-0.1534, device='cuda:3')
len accept list 6
len all weights is 6
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 89.38% 

Test Accuracy: 88.76% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2987596392631531
distance 1 is tensor(131.0058, device='cuda:3')
benign distance is  tensor(131.0058, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7507517337799072
distance 1 is tensor(121.6006, device='cuda:3')
benign distance is  tensor(121.6006, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.16957694292068481
distance 1 is tensor(113.2466, device='cuda:3')
benign distance is  tensor(113.2466, device='cuda:3')
norm1 res is  tensor(0.1288, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4486161172389984
distance 1 is tensor(107.4717, device='cuda:3')
benign distance is  tensor(107.4717, device='cuda:3')
norm1 res is  tensor(0.1225, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7057466506958008
distance 1 is tensor(104.4186, device='cuda:3')
benign distance is  tensor(104.4186, device='cuda:3')
norm1 res is  tensor(0.1206, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3575969934463501
distance 1 is tensor(108.7123, device='cuda:3')
benign distance is  tensor(108.7123, device='cuda:3')
norm1 res is  tensor(0.1236, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.13361361622810364
distance 1 is tensor(112.1027, device='cuda:3')
benign distance is  tensor(112.1027, device='cuda:3')
norm1 res is  tensor(0.1270, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.17062683403491974
distance 1 is tensor(120.4122, device='cuda:3')
benign distance is  tensor(120.4122, device='cuda:3')
norm1 res is  tensor(0.1408, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.18254753947257996
distance 1 is tensor(128.8020, device='cuda:3')
benign distance is  tensor(128.8020, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.32023316621780396
distance 1 is tensor(141.0434, device='cuda:3')
benign distance is  tensor(141.0434, device='cuda:3')
norm1 res is  tensor(0.1606, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.33351147174835205
distance 1 is tensor(140.0733, device='cuda:3')
benign distance is  tensor(140.0733, device='cuda:3')
norm1 res is  tensor(0.1593, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.4872349798679352
distance 1 is tensor(142.3211, device='cuda:3')
benign distance is  tensor(142.3211, device='cuda:3')
norm1 res is  tensor(0.1639, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5043551325798035
distance 1 is tensor(135.6510, device='cuda:3')
benign distance is  tensor(135.6510, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.15993709862232208
distance 1 is tensor(133.9043, device='cuda:3')
benign distance is  tensor(133.9043, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.3236585557460785
distance 1 is tensor(129.9170, device='cuda:3')
benign distance is  tensor(129.9170, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.19083304703235626
distance 1 is tensor(139.1837, device='cuda:3')
benign distance is  tensor(139.1837, device='cuda:3')
norm1 res is  tensor(0.1592, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(20.4349, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.2817, device='cuda:3')
part1 is  tensor(-2.9050, device='cuda:3')
score : tensor(-0.0493, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.5217, device='cuda:3')
part1 is  tensor(5.4979, device='cuda:3')
score : tensor(0.0347, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(507.5555, device='cuda:3')
part1 is  tensor(-6.3308, device='cuda:3')
score : tensor(-0.0835, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(478.4591, device='cuda:3')
part1 is  tensor(12.9768, device='cuda:3')
score : tensor(0.1095, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.1448, device='cuda:3')
part1 is  tensor(39.8935, device='cuda:3')
score : tensor(0.3787, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(484.8478, device='cuda:3')
part1 is  tensor(-40.6488, device='cuda:3')
score : tensor(-0.4267, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(499.6635, device='cuda:3')
part1 is  tensor(-8.2905, device='cuda:3')
score : tensor(-0.1031, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.2873, device='cuda:3')
part1 is  tensor(5.5327, device='cuda:3')
score : tensor(0.0351, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.5961, device='cuda:3')
part1 is  tensor(17.4702, device='cuda:3')
score : tensor(0.1545, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.4247, device='cuda:3')
part1 is  tensor(-25.7693, device='cuda:3')
score : tensor(-0.2779, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.1370, device='cuda:3')
part1 is  tensor(23.6486, device='cuda:3')
score : tensor(0.2163, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.3253, device='cuda:3')
part1 is  tensor(11.5178, device='cuda:3')
score : tensor(0.0949, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.7736, device='cuda:3')
part1 is  tensor(-2.9545, device='cuda:3')
score : tensor(-0.0498, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.8306, device='cuda:3')
part1 is  tensor(-25.6955, device='cuda:3')
score : tensor(-0.2772, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.9198, device='cuda:3')
part1 is  tensor(10.4538, device='cuda:3')
score : tensor(0.0843, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.1080, device='cuda:3')
part1 is  tensor(-0.0794, device='cuda:3')
score : tensor(-0.0210, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.51% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.35645392537117004
distance 1 is tensor(127.9122, device='cuda:3')
benign distance is  tensor(127.9122, device='cuda:3')
norm1 res is  tensor(0.1484, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.23210664093494415
distance 1 is tensor(118.7327, device='cuda:3')
benign distance is  tensor(118.7327, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.0950370654463768
distance 1 is tensor(120.1322, device='cuda:3')
benign distance is  tensor(120.1322, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4127272665500641
distance 1 is tensor(94.6567, device='cuda:3')
benign distance is  tensor(94.6567, device='cuda:3')
norm1 res is  tensor(0.1068, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6589239835739136
distance 1 is tensor(108.1391, device='cuda:3')
benign distance is  tensor(108.1391, device='cuda:3')
norm1 res is  tensor(0.1212, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5653995275497437
distance 1 is tensor(128.4716, device='cuda:3')
benign distance is  tensor(128.4716, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2770156264305115
distance 1 is tensor(120.0770, device='cuda:3')
benign distance is  tensor(120.0770, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.46198540925979614
distance 1 is tensor(111.5382, device='cuda:3')
benign distance is  tensor(111.5382, device='cuda:3')
norm1 res is  tensor(0.1273, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.2710030972957611
distance 1 is tensor(131.9353, device='cuda:3')
benign distance is  tensor(131.9353, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.6340340375900269
distance 1 is tensor(158.3978, device='cuda:3')
benign distance is  tensor(158.3978, device='cuda:3')
norm1 res is  tensor(0.1800, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.2635243535041809
distance 1 is tensor(126.5559, device='cuda:3')
benign distance is  tensor(126.5559, device='cuda:3')
norm1 res is  tensor(0.1457, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  1.036041259765625
distance 1 is tensor(132.5300, device='cuda:3')
benign distance is  tensor(132.5300, device='cuda:3')
norm1 res is  tensor(0.1551, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.2474915236234665
distance 1 is tensor(134.0036, device='cuda:3')
benign distance is  tensor(134.0036, device='cuda:3')
norm1 res is  tensor(0.1532, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.31147533655166626
distance 1 is tensor(129.7671, device='cuda:3')
benign distance is  tensor(129.7671, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.19928355515003204
distance 1 is tensor(147.3288, device='cuda:3')
benign distance is  tensor(147.3288, device='cuda:3')
norm1 res is  tensor(0.1681, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.3229255676269531
distance 1 is tensor(131.8645, device='cuda:3')
benign distance is  tensor(131.8645, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 24
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(17.0992, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.5447, device='cuda:3')
part1 is  tensor(17.0582, device='cuda:3')
score : tensor(0.1537, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.1675, device='cuda:3')
part1 is  tensor(-17.4192, device='cuda:3')
score : tensor(-0.1911, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(543.1408, device='cuda:3')
part1 is  tensor(55.3924, device='cuda:3')
score : tensor(0.5370, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(417.6567, device='cuda:3')
part1 is  tensor(-12.7710, device='cuda:3')
score : tensor(-0.1446, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(479.2468, device='cuda:3')
part1 is  tensor(-12.7538, device='cuda:3')
score : tensor(-0.1444, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(585.4485, device='cuda:3')
part1 is  tensor(8.9083, device='cuda:3')
score : tensor(0.0722, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.0003, device='cuda:3')
part1 is  tensor(26.5526, device='cuda:3')
score : tensor(0.2486, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.3919, device='cuda:3')
part1 is  tensor(-20.5114, device='cuda:3')
score : tensor(-0.2220, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(674.2465, device='cuda:3')
part1 is  tensor(-22.2687, device='cuda:3')
score : tensor(-0.2396, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.0139, device='cuda:3')
part1 is  tensor(-19.1366, device='cuda:3')
score : tensor(-0.2083, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.1104, device='cuda:3')
part1 is  tensor(-44.3410, device='cuda:3')
score : tensor(-0.4603, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.7380, device='cuda:3')
part1 is  tensor(-25.8073, device='cuda:3')
score : tensor(-0.2750, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.5759, device='cuda:3')
part1 is  tensor(-51.1876, device='cuda:3')
score : tensor(-0.5288, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.9824, device='cuda:3')
part1 is  tensor(-19.9183, device='cuda:3')
score : tensor(-0.2161, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.5081, device='cuda:3')
part1 is  tensor(-8.2520, device='cuda:3')
score : tensor(-0.0994, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.9409, device='cuda:3')
part1 is  tensor(32.0357, device='cuda:3')
score : tensor(0.3035, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.4786, device='cuda:3')
part1 is  tensor(1.0811, device='cuda:3')
score : tensor(-0.0061, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.9387, device='cuda:3')
part1 is  tensor(31.3549, device='cuda:3')
score : tensor(0.2966, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.7308, device='cuda:3')
part1 is  tensor(-4.9071, device='cuda:3')
score : tensor(-0.0660, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.5956, device='cuda:3')
part1 is  tensor(-23.9397, device='cuda:3')
score : tensor(-0.2563, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.7498, device='cuda:3')
part1 is  tensor(-9.7438, device='cuda:3')
score : tensor(-0.1143, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.9697, device='cuda:3')
part1 is  tensor(11.2492, device='cuda:3')
score : tensor(0.0956, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.1223, device='cuda:3')
part1 is  tensor(-0.3328, device='cuda:3')
score : tensor(-0.0202, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.6993, device='cuda:3')
part1 is  tensor(-14.2236, device='cuda:3')
score : tensor(-0.1591, device='cuda:3')
len accept list 7
len all weights is 7
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.26% 

Test Accuracy: 88.78% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.34732574224472046
distance 1 is tensor(115.1998, device='cuda:3')
benign distance is  tensor(115.1998, device='cuda:3')
norm1 res is  tensor(0.1341, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7102135419845581
distance 1 is tensor(123.6186, device='cuda:3')
benign distance is  tensor(123.6186, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3345998227596283
distance 1 is tensor(124.4677, device='cuda:3')
benign distance is  tensor(124.4677, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6016132831573486
distance 1 is tensor(111.5739, device='cuda:3')
benign distance is  tensor(111.5739, device='cuda:3')
norm1 res is  tensor(0.1277, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3866450786590576
distance 1 is tensor(102.9381, device='cuda:3')
benign distance is  tensor(102.9381, device='cuda:3')
norm1 res is  tensor(0.1211, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4011273980140686
distance 1 is tensor(116.4480, device='cuda:3')
benign distance is  tensor(116.4480, device='cuda:3')
norm1 res is  tensor(0.1365, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.29710817337036133
distance 1 is tensor(110.7786, device='cuda:3')
benign distance is  tensor(110.7786, device='cuda:3')
norm1 res is  tensor(0.1248, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.35945504903793335
distance 1 is tensor(119.0913, device='cuda:3')
benign distance is  tensor(119.0913, device='cuda:3')
norm1 res is  tensor(0.1337, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2604413628578186
distance 1 is tensor(135.7748, device='cuda:3')
benign distance is  tensor(135.7748, device='cuda:3')
norm1 res is  tensor(0.1537, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.6073881387710571
distance 1 is tensor(138.1726, device='cuda:3')
benign distance is  tensor(138.1726, device='cuda:3')
norm1 res is  tensor(0.1555, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.9751348495483398
distance 1 is tensor(139.1850, device='cuda:3')
benign distance is  tensor(139.1850, device='cuda:3')
norm1 res is  tensor(0.1557, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.34228014945983887
distance 1 is tensor(131.5702, device='cuda:3')
benign distance is  tensor(131.5702, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.40885958075523376
distance 1 is tensor(124.2244, device='cuda:3')
benign distance is  tensor(124.2244, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.07163812220096588
distance 1 is tensor(117.9643, device='cuda:3')
benign distance is  tensor(117.9643, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.37004321813583374
distance 1 is tensor(134.1340, device='cuda:3')
benign distance is  tensor(134.1340, device='cuda:3')
norm1 res is  tensor(0.1567, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.5744705200195312
distance 1 is tensor(143.4060, device='cuda:3')
benign distance is  tensor(143.4060, device='cuda:3')
norm1 res is  tensor(0.1636, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.18133792281150818
distance 1 is tensor(136.6461, device='cuda:3')
benign distance is  tensor(136.6461, device='cuda:3')
norm1 res is  tensor(0.1578, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.15917842090129852
distance 1 is tensor(123.6722, device='cuda:3')
benign distance is  tensor(123.6722, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.56325364112854
distance 1 is tensor(143.3629, device='cuda:3')
benign distance is  tensor(143.3629, device='cuda:3')
norm1 res is  tensor(0.1610, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.3462354838848114
distance 1 is tensor(144.7647, device='cuda:3')
benign distance is  tensor(144.7647, device='cuda:3')
norm1 res is  tensor(0.1626, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  1.0657565593719482
distance 1 is tensor(135.9215, device='cuda:3')
benign distance is  tensor(135.9215, device='cuda:3')
norm1 res is  tensor(0.1532, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.43053436279296875
distance 1 is tensor(131.9500, device='cuda:3')
benign distance is  tensor(131.9500, device='cuda:3')
norm1 res is  tensor(0.1488, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.1922282725572586
distance 1 is tensor(124.5861, device='cuda:3')
benign distance is  tensor(124.5861, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.17936109006404877
distance 1 is tensor(124.9192, device='cuda:3')
benign distance is  tensor(124.9192, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 16
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(8.2119, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.2681, device='cuda:3')
part1 is  tensor(4.0874, device='cuda:3')
score : tensor(0.0329, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.9349, device='cuda:3')
part1 is  tensor(-8.8163, device='cuda:3')
score : tensor(-0.0962, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(554.0010, device='cuda:3')
part1 is  tensor(12.9896, device='cuda:3')
score : tensor(0.1219, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.8777, device='cuda:3')
part1 is  tensor(-10.8532, device='cuda:3')
score : tensor(-0.1165, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(467.1079, device='cuda:3')
part1 is  tensor(-9.2807, device='cuda:3')
score : tensor(-0.1008, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.7936, device='cuda:3')
part1 is  tensor(-1.9984, device='cuda:3')
score : tensor(-0.0280, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(486.0086, device='cuda:3')
part1 is  tensor(2.0291, device='cuda:3')
score : tensor(0.0123, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(530.5946, device='cuda:3')
part1 is  tensor(-2.0898, device='cuda:3')
score : tensor(-0.0289, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.1030, device='cuda:3')
part1 is  tensor(1.4563, device='cuda:3')
score : tensor(0.0066, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.0568, device='cuda:3')
part1 is  tensor(4.5547, device='cuda:3')
score : tensor(0.0375, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.0598, device='cuda:3')
part1 is  tensor(-0.5618, device='cuda:3')
score : tensor(-0.0136, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(640.9242, device='cuda:3')
part1 is  tensor(9.3856, device='cuda:3')
score : tensor(0.0858, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.2629, device='cuda:3')
part1 is  tensor(-9.5686, device='cuda:3')
score : tensor(-0.1037, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.6910, device='cuda:3')
part1 is  tensor(-9.9274, device='cuda:3')
score : tensor(-0.1073, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.0715, device='cuda:3')
part1 is  tensor(-8.3363, device='cuda:3')
score : tensor(-0.0914, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.5274, device='cuda:3')
part1 is  tensor(-0.9459, device='cuda:3')
score : tensor(-0.0175, device='cuda:3')
len accept list 6
len all weights is 6
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.17% 

Test Accuracy: 88.66% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.47911399602890015
distance 1 is tensor(84.5640, device='cuda:3')
benign distance is  tensor(84.5640, device='cuda:3')
norm1 res is  tensor(0.0994, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8668277859687805
distance 1 is tensor(130.0518, device='cuda:3')
benign distance is  tensor(130.0518, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.0693478137254715
distance 1 is tensor(111.9060, device='cuda:3')
benign distance is  tensor(111.9060, device='cuda:3')
norm1 res is  tensor(0.1269, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.1944233775138855
distance 1 is tensor(112.3772, device='cuda:3')
benign distance is  tensor(112.3772, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.25648635625839233
distance 1 is tensor(103.8288, device='cuda:3')
benign distance is  tensor(103.8288, device='cuda:3')
norm1 res is  tensor(0.1176, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6554906964302063
distance 1 is tensor(118.9609, device='cuda:3')
benign distance is  tensor(118.9609, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4581839144229889
distance 1 is tensor(118.8151, device='cuda:3')
benign distance is  tensor(118.8151, device='cuda:3')
norm1 res is  tensor(0.1352, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.323119580745697
distance 1 is tensor(113.8161, device='cuda:3')
benign distance is  tensor(113.8161, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.5431657433509827
distance 1 is tensor(130.2268, device='cuda:3')
benign distance is  tensor(130.2268, device='cuda:3')
norm1 res is  tensor(0.1474, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.12589356303215027
distance 1 is tensor(130.3298, device='cuda:3')
benign distance is  tensor(130.3298, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.10053747892379761
distance 1 is tensor(145.9168, device='cuda:3')
benign distance is  tensor(145.9168, device='cuda:3')
norm1 res is  tensor(0.1660, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.094929039478302
distance 1 is tensor(114.3672, device='cuda:3')
benign distance is  tensor(114.3672, device='cuda:3')
norm1 res is  tensor(0.1312, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.21282139420509338
distance 1 is tensor(132.1418, device='cuda:3')
benign distance is  tensor(132.1418, device='cuda:3')
norm1 res is  tensor(0.1523, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.4128015637397766
distance 1 is tensor(136.9479, device='cuda:3')
benign distance is  tensor(136.9479, device='cuda:3')
norm1 res is  tensor(0.1525, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.236491397023201
distance 1 is tensor(130.0934, device='cuda:3')
benign distance is  tensor(130.0934, device='cuda:3')
norm1 res is  tensor(0.1457, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.14870253205299377
distance 1 is tensor(120.1628, device='cuda:3')
benign distance is  tensor(120.1628, device='cuda:3')
norm1 res is  tensor(0.1369, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len current grad  8
len all grad 32
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(9.9831, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(393.9605, device='cuda:3')
part1 is  tensor(-16.6579, device='cuda:3')
score : tensor(-0.1764, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.1988, device='cuda:3')
part1 is  tensor(2.3353, device='cuda:3')
score : tensor(0.0136, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.1467, device='cuda:3')
part1 is  tensor(10.7959, device='cuda:3')
score : tensor(0.0982, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.3155, device='cuda:3')
part1 is  tensor(-4.4108, device='cuda:3')
score : tensor(-0.0539, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(463.3659, device='cuda:3')
part1 is  tensor(2.7438, device='cuda:3')
score : tensor(0.0177, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.3973, device='cuda:3')
part1 is  tensor(0.9943, device='cuda:3')
score : tensor(0.0002, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.2191, device='cuda:3')
part1 is  tensor(-14.1016, device='cuda:3')
score : tensor(-0.1508, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.4819, device='cuda:3')
part1 is  tensor(-7.0223, device='cuda:3')
score : tensor(-0.0800, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.1993, device='cuda:3')
part1 is  tensor(-7.8795, device='cuda:3')
score : tensor(-0.0886, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.4011, device='cuda:3')
part1 is  tensor(-3.9164, device='cuda:3')
score : tensor(-0.0489, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.0627, device='cuda:3')
part1 is  tensor(-8.1020, device='cuda:3')
score : tensor(-0.0908, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.7797, device='cuda:3')
part1 is  tensor(5.4068, device='cuda:3')
score : tensor(0.0443, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.8586, device='cuda:3')
part1 is  tensor(3.2260, device='cuda:3')
score : tensor(0.0225, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.2437, device='cuda:3')
part1 is  tensor(-10.7541, device='cuda:3')
score : tensor(-0.1173, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.1617, device='cuda:3')
part1 is  tensor(-16.3480, device='cuda:3')
score : tensor(-0.1733, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.8778, device='cuda:3')
part1 is  tensor(-3.9027, device='cuda:3')
score : tensor(-0.0488, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.8654, device='cuda:3')
part1 is  tensor(-5.4886, device='cuda:3')
score : tensor(-0.0647, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(741.5764, device='cuda:3')
part1 is  tensor(-16.1228, device='cuda:3')
score : tensor(-0.1710, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.6281, device='cuda:3')
part1 is  tensor(-4.1371, device='cuda:3')
score : tensor(-0.0512, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.3751, device='cuda:3')
part1 is  tensor(-0.3570, device='cuda:3')
score : tensor(-0.0134, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.4944, device='cuda:3')
part1 is  tensor(8.2607, device='cuda:3')
score : tensor(0.0728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.0540, device='cuda:3')
part1 is  tensor(-3.0661, device='cuda:3')
score : tensor(-0.0404, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.9890, device='cuda:3')
part1 is  tensor(1.2455, device='cuda:3')
score : tensor(0.0027, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.4356, device='cuda:3')
part1 is  tensor(-9.7025, device='cuda:3')
score : tensor(-0.1068, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.9099, device='cuda:3')
part1 is  tensor(-7.3671, device='cuda:3')
score : tensor(-0.0835, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.1111, device='cuda:3')
part1 is  tensor(-12.7948, device='cuda:3')
score : tensor(-0.1377, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(641.2182, device='cuda:3')
part1 is  tensor(-4.1966, device='cuda:3')
score : tensor(-0.0517, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.4088, device='cuda:3')
part1 is  tensor(-7.0359, device='cuda:3')
score : tensor(-0.0801, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.5461, device='cuda:3')
part1 is  tensor(-5.3131, device='cuda:3')
score : tensor(-0.0629, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.8681, device='cuda:3')
part1 is  tensor(2.5146, device='cuda:3')
score : tensor(0.0154, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.2614, device='cuda:3')
part1 is  tensor(-21.5713, device='cuda:3')
score : tensor(-0.2255, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.5413, device='cuda:3')
part1 is  tensor(-16.5498, device='cuda:3')
score : tensor(-0.1753, device='cuda:3')
len accept list 9
len all weights is 9
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 89.05% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3608412444591522
distance 1 is tensor(110.1969, device='cuda:3')
benign distance is  tensor(110.1969, device='cuda:3')
norm1 res is  tensor(0.1265, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.9962655305862427
distance 1 is tensor(116.8565, device='cuda:3')
benign distance is  tensor(116.8565, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.054328419268131256
distance 1 is tensor(123.6620, device='cuda:3')
benign distance is  tensor(123.6620, device='cuda:3')
norm1 res is  tensor(0.1406, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.1796291172504425
distance 1 is tensor(120.2130, device='cuda:3')
benign distance is  tensor(120.2130, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6168978214263916
distance 1 is tensor(109.6209, device='cuda:3')
benign distance is  tensor(109.6209, device='cuda:3')
norm1 res is  tensor(0.1250, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5283554792404175
distance 1 is tensor(116.4542, device='cuda:3')
benign distance is  tensor(116.4542, device='cuda:3')
norm1 res is  tensor(0.1327, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2840377390384674
distance 1 is tensor(97.2616, device='cuda:3')
benign distance is  tensor(97.2616, device='cuda:3')
norm1 res is  tensor(0.1092, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.8103771209716797
distance 1 is tensor(120.0084, device='cuda:3')
benign distance is  tensor(120.0084, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.17780259251594543
distance 1 is tensor(139.4004, device='cuda:3')
benign distance is  tensor(139.4004, device='cuda:3')
norm1 res is  tensor(0.1596, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5921974182128906
distance 1 is tensor(129.2496, device='cuda:3')
benign distance is  tensor(129.2496, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.9214468002319336
distance 1 is tensor(133.7051, device='cuda:3')
benign distance is  tensor(133.7051, device='cuda:3')
norm1 res is  tensor(0.1503, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5804674029350281
distance 1 is tensor(131.1212, device='cuda:3')
benign distance is  tensor(131.1212, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.4362362325191498
distance 1 is tensor(129.5158, device='cuda:3')
benign distance is  tensor(129.5158, device='cuda:3')
norm1 res is  tensor(0.1497, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.6590391397476196
distance 1 is tensor(126.9324, device='cuda:3')
benign distance is  tensor(126.9324, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.376706063747406
distance 1 is tensor(135.7293, device='cuda:3')
benign distance is  tensor(135.7293, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.11270846426486969
distance 1 is tensor(137.7493, device='cuda:3')
benign distance is  tensor(137.7493, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.049213409423828125
distance 1 is tensor(127.3119, device='cuda:3')
benign distance is  tensor(127.3119, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.4961269795894623
distance 1 is tensor(136.5837, device='cuda:3')
benign distance is  tensor(136.5837, device='cuda:3')
norm1 res is  tensor(0.1567, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.3091863989830017
distance 1 is tensor(123.6430, device='cuda:3')
benign distance is  tensor(123.6430, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.41507744789123535
distance 1 is tensor(126.8731, device='cuda:3')
benign distance is  tensor(126.8731, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3344418406486511
distance 1 is tensor(136.8127, device='cuda:3')
benign distance is  tensor(136.8127, device='cuda:3')
norm1 res is  tensor(0.1531, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5068072080612183
distance 1 is tensor(127.2300, device='cuda:3')
benign distance is  tensor(127.2300, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.15212741494178772
distance 1 is tensor(136.9149, device='cuda:3')
benign distance is  tensor(136.9149, device='cuda:3')
norm1 res is  tensor(0.1566, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.533842146396637
distance 1 is tensor(129.3172, device='cuda:3')
benign distance is  tensor(129.3172, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.03687368705868721
distance 1 is tensor(130.5759, device='cuda:3')
benign distance is  tensor(130.5759, device='cuda:3')
norm1 res is  tensor(0.1490, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.1902221143245697
distance 1 is tensor(132.1410, device='cuda:3')
benign distance is  tensor(132.1410, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.24226784706115723
distance 1 is tensor(122.8544, device='cuda:3')
benign distance is  tensor(122.8544, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.6015645265579224
distance 1 is tensor(125.9963, device='cuda:3')
benign distance is  tensor(125.9963, device='cuda:3')
norm1 res is  tensor(0.1431, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.4091302752494812
distance 1 is tensor(118.5212, device='cuda:3')
benign distance is  tensor(118.5212, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.3676224648952484
distance 1 is tensor(137.6343, device='cuda:3')
benign distance is  tensor(137.6343, device='cuda:3')
norm1 res is  tensor(0.1584, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.48522281646728516
distance 1 is tensor(142.7809, device='cuda:3')
benign distance is  tensor(142.7809, device='cuda:3')
norm1 res is  tensor(0.1619, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.3016339838504791
distance 1 is tensor(137.5744, device='cuda:3')
benign distance is  tensor(137.5744, device='cuda:3')
norm1 res is  tensor(0.1595, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(138.7513, device='cuda:3')
compute distance is  tensor(138.7513, device='cuda:3')
compute norm is  tensor(46.2641, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(126.4277, device='cuda:3')
compute distance is  tensor(126.4277, device='cuda:3')
compute norm is  tensor(45.9798, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.3277, device='cuda:3')
compute distance is  tensor(135.3277, device='cuda:3')
compute norm is  tensor(46.4956, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(130.3394, device='cuda:3')
compute distance is  tensor(130.3394, device='cuda:3')
compute norm is  tensor(46.1724, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(132.4815, device='cuda:3')
compute distance is  tensor(132.4815, device='cuda:3')
compute norm is  tensor(46.2838, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.4259, device='cuda:3')
compute distance is  tensor(142.4259, device='cuda:3')
compute norm is  tensor(46.6505, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.3773, device='cuda:3')
compute distance is  tensor(134.3773, device='cuda:3')
compute norm is  tensor(46.3862, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.3496, device='cuda:3')
compute distance is  tensor(147.3496, device='cuda:3')
compute norm is  tensor(46.5625, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(133.3620, device='cuda:3')
compute distance is  tensor(133.3620, device='cuda:3')
compute norm is  tensor(46.3206, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.5182, device='cuda:3')
compute distance is  tensor(134.5182, device='cuda:3')
compute norm is  tensor(46.3824, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.7650, device='cuda:3')
compute distance is  tensor(148.7650, device='cuda:3')
compute norm is  tensor(46.8419, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.7380, device='cuda:3')
compute distance is  tensor(142.7380, device='cuda:3')
compute norm is  tensor(46.5477, device='cuda:3', dtype=torch.float64)
batch acc is 0.10250000015633194
batch acc is 0.10125000015633653
batch acc is 0.10083333348967298
batch acc is 0.10062500015634121
batch acc is 0.10050000015634215
batch acc is 0.1004166668230041
batch acc is 0.10035714301347337
batch acc is 0.10031250015632533
batch acc is 0.10027777793409907
batch acc is 0.10025000015631806
batch acc is 0.10022727288358817
batch acc is 0.10020833348964657
batch acc is 0.10019230784861907
batch acc is 0.10017857158488121
batch acc is 0.10016666682297506
batch acc is 0.10015625015630718
batch acc is 0.10014705897983553
batch acc is 0.10013888904519405
batch acc is 0.10013157910367274
batch acc is 0.10012500015630356
mal_rand_acc is 0.10000000049999999
mal_rand loss is 6.047930778791182e+18
len of model dicts is  12
distance 1 is tensor(138.7513, device='cuda:3')
compute distance is  tensor(138.7513, device='cuda:3')
compute norm is  tensor(46.2641, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(126.4277, device='cuda:3')
compute distance is  tensor(126.4277, device='cuda:3')
compute norm is  tensor(45.9798, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.3277, device='cuda:3')
compute distance is  tensor(135.3277, device='cuda:3')
compute norm is  tensor(46.4956, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(130.3394, device='cuda:3')
compute distance is  tensor(130.3394, device='cuda:3')
compute norm is  tensor(46.1724, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(132.4815, device='cuda:3')
compute distance is  tensor(132.4815, device='cuda:3')
compute norm is  tensor(46.2838, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.4259, device='cuda:3')
compute distance is  tensor(142.4259, device='cuda:3')
compute norm is  tensor(46.6505, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.3773, device='cuda:3')
compute distance is  tensor(134.3773, device='cuda:3')
compute norm is  tensor(46.3862, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.3496, device='cuda:3')
compute distance is  tensor(147.3496, device='cuda:3')
compute norm is  tensor(46.5625, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(133.3620, device='cuda:3')
compute distance is  tensor(133.3620, device='cuda:3')
compute norm is  tensor(46.3206, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.5182, device='cuda:3')
compute distance is  tensor(134.5182, device='cuda:3')
compute norm is  tensor(46.3824, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.7650, device='cuda:3')
compute distance is  tensor(148.7650, device='cuda:3')
compute norm is  tensor(46.8419, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.7380, device='cuda:3')
compute distance is  tensor(142.7380, device='cuda:3')
compute norm is  tensor(46.5477, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(148.7650, device='cuda:3')
distance 1 is tensor(1869494., device='cuda:3')
________________________________
test distance is  tensor(1869494., device='cuda:3')
test similarity is  tensor(-0.1154, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766902610828175e+18
test entropy is  0.0
________________________________
cal ratio is  0.008742072119986923
distance 1 is tensor(16343.2568, device='cuda:3')
cal_distance is  tensor(16343.2568, device='cuda:3')
cal ratio is  0.09349903084943063
distance 1 is tensor(1528.0848, device='cuda:3')
cal_distance is  tensor(1528.0848, device='cuda:3')
cal ratio is  0.3057754977206144
distance 1 is tensor(467.2556, device='cuda:3')
cal_distance is  tensor(467.2556, device='cuda:3')
cal ratio is  0.5529669397889856
distance 1 is tensor(258.3799, device='cuda:3')
cal_distance is  tensor(258.3799, device='cuda:3')
cal ratio is  0.7436131272874277
distance 1 is tensor(192.1364, device='cuda:3')
cal_distance is  tensor(192.1364, device='cuda:3')
cal ratio is  0.8623261822796104
distance 1 is tensor(165.6852, device='cuda:3')
cal_distance is  tensor(165.6852, device='cuda:3')
cal ratio is  0.9286125865054724
distance 1 is tensor(153.8579, device='cuda:3')
cal_distance is  tensor(153.8579, device='cuda:3')
cal ratio is  0.9636438616085502
distance 1 is tensor(148.2644, device='cuda:3')
cal_distance is  tensor(148.2644, device='cuda:3')
distance 1 is tensor(148.2644, device='cuda:3')
________________________________
test distance is  tensor(148.2644, device='cuda:3')
test similarity is  tensor(0.9311, device='cuda:3')
test acc is  0.7904500001563259
test loss is 161.0045024001522
test entropy is  0.001378549919327958
________________________________
distance 1 is tensor(148.2644, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0015825899373930234
avg test loss is  160.37573448783044
avg accuracy is  0.7927833334896591
solo acc is  0.10840000015633197
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(148.2644, device='cuda:3')
compute_norm is  tensor(46.1136, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(134.9588, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9231136225179822
avg test loss is  1.5669786478919008
avg accuracy is  0.8322166668229908
solo acc is  0.30675000015633963
compute similarity  is  tensor(0.9335, device='cuda:3')
compute_distance is  tensor(134.9588, device='cuda:3')
compute_norm is  tensor(44.9851, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.2746, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.898027375372234
avg test loss is  1.6210489212068668
avg accuracy is  0.8316666668229907
solo acc is  0.25066666682300487
compute similarity  is  tensor(0.9329, device='cuda:3')
compute_distance is  tensor(137.2746, device='cuda:3')
compute_norm is  tensor(44.6738, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.1698, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8839049345013429
avg test loss is  1.556385310982336
avg accuracy is  0.8348833334896573
solo acc is  0.25758333348967183
compute similarity  is  tensor(0.9325, device='cuda:3')
compute_distance is  tensor(139.1698, device='cuda:3')
compute_norm is  tensor(44.3850, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.9245, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8767593105210424
avg test loss is  1.5202853542401085
avg accuracy is  0.8382000001563238
solo acc is  0.2589500001563385
compute similarity  is  tensor(0.9321, device='cuda:3')
compute_distance is  tensor(140.9245, device='cuda:3')
compute_norm is  tensor(44.1129, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.6596, device='cuda:3')
________________________________
test distance is  tensor(142.6596, device='cuda:3')
test similarity is  tensor(0.9318, device='cuda:3')
test acc is  0.8399333334896572
test loss is 1.4921152552307795
test entropy is  0.8719567864942652
________________________________
distance 1 is tensor(142.6596, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8709898412481808
avg test loss is  1.4920578854424613
avg accuracy is  0.8403666668229903
solo acc is  0.2579000001563385
compute similarity  is  tensor(0.9318, device='cuda:3')
compute_distance is  tensor(142.6596, device='cuda:3')
compute_norm is  tensor(43.8520, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.2245, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8650923543520319
avg test loss is  1.4550713736619523
avg accuracy is  0.8430000001563237
solo acc is  0.2645000001563387
compute similarity  is  tensor(0.9315, device='cuda:3')
compute_distance is  tensor(144.2245, device='cuda:3')
compute_norm is  tensor(43.5985, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.8918, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8645536834115921
avg test loss is  1.4653386359275786
avg accuracy is  0.8441166668229902
solo acc is  0.24593333348967145
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(145.8918, device='cuda:3')
compute_norm is  tensor(43.3521, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5395, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8511226499385671
avg test loss is  1.4350123305056395
avg accuracy is  0.8466333334896567
solo acc is  0.25485000015633846
compute similarity  is  tensor(0.9307, device='cuda:3')
compute_distance is  tensor(147.5395, device='cuda:3')
compute_norm is  tensor(43.1098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.0533, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8454871968801088
avg test loss is  1.4290680439233272
avg accuracy is  0.8450833334896569
solo acc is  0.24748333348967153
compute similarity  is  tensor(0.9304, device='cuda:3')
compute_distance is  tensor(149.0533, device='cuda:3')
compute_norm is  tensor(42.8746, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.5914, device='cuda:3')
________________________________
test distance is  tensor(150.5914, device='cuda:3')
test similarity is  tensor(0.9301, device='cuda:3')
test acc is  0.8485000001563233
test loss is 1.4146930002200324
test entropy is  0.8478454535703923
________________________________
cal ratio is  0.9740389187173222
distance 1 is tensor(146.6821, device='cuda:3')
cal_distance is  tensor(146.6821, device='cuda:3')
distance 1 is tensor(146.6821, device='cuda:3')
________________________________
test distance is  tensor(146.6821, device='cuda:3')
test similarity is  tensor(0.9337, device='cuda:3')
test acc is  0.85071666682299
test loss is 1.3331864457140599
test entropy is  0.8719129132182359
________________________________
distance 1 is tensor(146.6821, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8721030902252522
avg test loss is  1.331035807315729
avg accuracy is  0.8508666668229901
solo acc is  0.29370000015633935
compute similarity  is  tensor(0.9337, device='cuda:3')
compute_distance is  tensor(146.6821, device='cuda:3')
compute_norm is  tensor(42.6510, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.4818, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8393732051986621
avg test loss is  1.391906909215679
avg accuracy is  0.8515000001563232
solo acc is  0.251916666823005
compute similarity  is  tensor(0.9333, device='cuda:3')
compute_distance is  tensor(148.4818, device='cuda:3')
compute_norm is  tensor(42.4237, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.1580, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8407669379385804
avg test loss is  1.384567645821236
avg accuracy is  0.8535666668229898
solo acc is  0.24801666682300486
compute similarity  is  tensor(0.9329, device='cuda:3')
compute_distance is  tensor(150.1580, device='cuda:3')
compute_norm is  tensor(42.1970, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.7630, device='cuda:3')
exit early
distance 1 is tensor(151.7630, device='cuda:3')
________________________________
test distance is  tensor(151.7630, device='cuda:3')
test similarity is  tensor(0.9326, device='cuda:3')
test acc is  0.8531500001563233
test loss is 1.3816174625842048
test entropy is  0.8292055923038962
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.35982346534729
mal norm is  tensor(729.2348, device='cuda:3')
distance 1 is tensor(151.7630, device='cuda:3')
mal distance is  tensor(151.7630, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(14.6661, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.3560, device='cuda:3')
part1 is  tensor(2.6356, device='cuda:3')
score : tensor(0.0119, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.3670, device='cuda:3')
part1 is  tensor(-53.7096, device='cuda:3')
score : tensor(-0.5516, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.0437, device='cuda:3')
part1 is  tensor(15.9933, device='cuda:3')
score : tensor(0.1455, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.2034, device='cuda:3')
part1 is  tensor(-2.6022, device='cuda:3')
score : tensor(-0.0405, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(490.2941, device='cuda:3')
part1 is  tensor(-6.4631, device='cuda:3')
score : tensor(-0.0791, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.4883, device='cuda:3')
part1 is  tensor(-22.9892, device='cuda:3')
score : tensor(-0.2444, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(429.1604, device='cuda:3')
part1 is  tensor(10.2359, device='cuda:3')
score : tensor(0.0879, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.5167, device='cuda:3')
part1 is  tensor(-10.2900, device='cuda:3')
score : tensor(-0.1174, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.2348, device='cuda:3')
part1 is  tensor(-29.5642, device='cuda:3')
score : tensor(-0.3101, device='cuda:3')
len accept list 3
len all weights is 3
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 89.33% 

Test Accuracy: 88.54% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4383309483528137
distance 1 is tensor(103.7600, device='cuda:3')
benign distance is  tensor(103.7600, device='cuda:3')
norm1 res is  tensor(0.1211, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.2769976556301117
distance 1 is tensor(123.9717, device='cuda:3')
benign distance is  tensor(123.9717, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.16753782331943512
distance 1 is tensor(113.0782, device='cuda:3')
benign distance is  tensor(113.0782, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5761982202529907
distance 1 is tensor(121.9927, device='cuda:3')
benign distance is  tensor(121.9927, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.24473357200622559
distance 1 is tensor(114.7103, device='cuda:3')
benign distance is  tensor(114.7103, device='cuda:3')
norm1 res is  tensor(0.1296, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3809063732624054
distance 1 is tensor(120.5157, device='cuda:3')
benign distance is  tensor(120.5157, device='cuda:3')
norm1 res is  tensor(0.1365, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5925647020339966
distance 1 is tensor(112.1504, device='cuda:3')
benign distance is  tensor(112.1504, device='cuda:3')
norm1 res is  tensor(0.1284, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.37576568126678467
distance 1 is tensor(135.1936, device='cuda:3')
benign distance is  tensor(135.1936, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(139.9525, device='cuda:3')
compute distance is  tensor(139.9525, device='cuda:3')
compute norm is  tensor(46.4983, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.7729, device='cuda:3')
compute distance is  tensor(135.7729, device='cuda:3')
compute norm is  tensor(46.5210, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(146.6666, device='cuda:3')
compute distance is  tensor(146.6666, device='cuda:3')
compute norm is  tensor(46.8791, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(153.7688, device='cuda:3')
compute distance is  tensor(153.7688, device='cuda:3')
compute norm is  tensor(46.9323, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(151.0941, device='cuda:3')
compute distance is  tensor(151.0941, device='cuda:3')
compute norm is  tensor(46.8588, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.1368, device='cuda:3')
compute distance is  tensor(148.1368, device='cuda:3')
compute norm is  tensor(46.8187, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.3073, device='cuda:3')
compute distance is  tensor(142.3073, device='cuda:3')
compute norm is  tensor(46.6728, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(157.4117, device='cuda:3')
compute distance is  tensor(157.4117, device='cuda:3')
compute norm is  tensor(46.9227, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(150.1512, device='cuda:3')
compute distance is  tensor(150.1512, device='cuda:3')
compute norm is  tensor(46.8695, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(129.2568, device='cuda:3')
compute distance is  tensor(129.2568, device='cuda:3')
compute norm is  tensor(46.3840, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.2106, device='cuda:3')
compute distance is  tensor(143.2106, device='cuda:3')
compute norm is  tensor(46.9444, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.3401, device='cuda:3')
compute distance is  tensor(143.3401, device='cuda:3')
compute norm is  tensor(46.7392, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.4117, device='cuda:3')
distance 1 is tensor(1869492.2500, device='cuda:3')
________________________________
test distance is  tensor(1869492.2500, device='cuda:3')
test similarity is  tensor(-0.1109, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766979549095719e+18
test entropy is  0.0
________________________________
cal ratio is  0.00899254793750808
distance 1 is tensor(16811.5039, device='cuda:3')
cal_distance is  tensor(16811.5039, device='cuda:3')
cal ratio is  0.09482902923623654
distance 1 is tensor(1594.2246, device='cuda:3')
cal_distance is  tensor(1594.2246, device='cuda:3')
cal ratio is  0.3079426509069453
distance 1 is tensor(490.9345, device='cuda:3')
cal_distance is  tensor(490.9345, device='cuda:3')
cal ratio is  0.5549231272053221
distance 1 is tensor(272.4339, device='cuda:3')
cal_distance is  tensor(272.4339, device='cuda:3')
cal ratio is  0.7449275374374857
distance 1 is tensor(202.9452, device='cuda:3')
cal_distance is  tensor(202.9452, device='cuda:3')
cal ratio is  0.8630881614889482
distance 1 is tensor(175.1606, device='cuda:3')
cal_distance is  tensor(175.1606, device='cuda:3')
cal ratio is  0.9290228664773529
distance 1 is tensor(162.7286, device='cuda:3')
cal_distance is  tensor(162.7286, device='cuda:3')
cal ratio is  0.9638570092928638
distance 1 is tensor(156.8474, device='cuda:3')
cal_distance is  tensor(156.8474, device='cuda:3')
distance 1 is tensor(156.8474, device='cuda:3')
________________________________
test distance is  tensor(156.8474, device='cuda:3')
test similarity is  tensor(0.9259, device='cuda:3')
test acc is  0.7347000001563287
test loss is 231.90305752947387
test entropy is  0.0005627897892302206
________________________________
distance 1 is tensor(156.8474, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0005296459084892563
avg test loss is  231.77502883878597
avg accuracy is  0.734733333489662
solo acc is  0.10410000015633197
compute similarity  is  tensor(0.9259, device='cuda:3')
compute_distance is  tensor(156.8474, device='cuda:3')
compute_norm is  tensor(47.0036, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(139.8257, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9824427401841577
avg test loss is  1.6227439555532135
avg accuracy is  0.8261833334896577
solo acc is  0.2897833334896726
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(139.8257, device='cuda:3')
compute_norm is  tensor(45.8461, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.4046, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.921737271712533
avg test loss is  1.6496737362987706
avg accuracy is  0.8278166668229908
solo acc is  0.25541666682300507
compute similarity  is  tensor(0.9291, device='cuda:3')
compute_distance is  tensor(142.4046, device='cuda:3')
compute_norm is  tensor(45.5348, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.5308, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9062625086510868
avg test loss is  1.6003918485092457
avg accuracy is  0.8304166668229909
solo acc is  0.25198333348967156
compute similarity  is  tensor(0.9286, device='cuda:3')
compute_distance is  tensor(144.5308, device='cuda:3')
compute_norm is  tensor(45.2421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.4690, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8942322837772654
avg test loss is  1.5502870880972857
avg accuracy is  0.8330833334896572
solo acc is  0.2591666668230052
compute similarity  is  tensor(0.9282, device='cuda:3')
compute_distance is  tensor(146.4690, device='cuda:3')
compute_norm is  tensor(44.9637, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.3330, device='cuda:3')
________________________________
test distance is  tensor(148.3330, device='cuda:3')
test similarity is  tensor(0.9278, device='cuda:3')
test acc is  0.8367833334896572
test loss is 1.5297848606414632
test entropy is  0.8869801086149236
________________________________
distance 1 is tensor(148.3330, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8889963109610177
avg test loss is  1.533259065293554
avg accuracy is  0.8358166668229906
solo acc is  0.25176666682300497
compute similarity  is  tensor(0.9278, device='cuda:3')
compute_distance is  tensor(148.3330, device='cuda:3')
compute_norm is  tensor(44.6944, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.0240, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8658965301157823
avg test loss is  1.4915460241374685
avg accuracy is  0.8408500001563237
solo acc is  0.2649333334896721
compute similarity  is  tensor(0.9274, device='cuda:3')
compute_distance is  tensor(150.0240, device='cuda:3')
compute_norm is  tensor(44.4347, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.7525, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8627243147475887
avg test loss is  1.4749078708671048
avg accuracy is  0.8408666668229904
solo acc is  0.25871666682300515
compute similarity  is  tensor(0.9270, device='cuda:3')
compute_distance is  tensor(151.7525, device='cuda:3')
compute_norm is  tensor(44.1794, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.4105, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8637896685330853
avg test loss is  1.4599156238631146
avg accuracy is  0.8425000001563238
solo acc is  0.25446666682300506
compute similarity  is  tensor(0.9266, device='cuda:3')
compute_distance is  tensor(153.4105, device='cuda:3')
compute_norm is  tensor(43.9279, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.0422, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8459068701338412
avg test loss is  1.4385795180223135
avg accuracy is  0.8440833334896569
solo acc is  0.2608833334896719
compute similarity  is  tensor(0.9263, device='cuda:3')
compute_distance is  tensor(155.0422, device='cuda:3')
compute_norm is  tensor(43.6814, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.6843, device='cuda:3')
________________________________
test distance is  tensor(156.6843, device='cuda:3')
test similarity is  tensor(0.9259, device='cuda:3')
test acc is  0.8456166668229903
test loss is 1.420590606833826
test entropy is  0.8517947946784339
________________________________
distance 1 is tensor(156.6843, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.851828907344387
avg test loss is  1.4225234687963784
avg accuracy is  0.8455500001563234
solo acc is  0.2557500001563385
compute similarity  is  tensor(0.9259, device='cuda:3')
compute_distance is  tensor(156.6843, device='cuda:3')
compute_norm is  tensor(43.4395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.3052, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8348901955557785
avg test loss is  1.4168689418703253
avg accuracy is  0.84806666682299
solo acc is  0.2545333334896718
compute similarity  is  tensor(0.9255, device='cuda:3')
compute_distance is  tensor(158.3052, device='cuda:3')
compute_norm is  tensor(43.2012, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.8884, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8354033411565874
avg test loss is  1.3965681271512371
avg accuracy is  0.84851666682299
solo acc is  0.25620000015633854
compute similarity  is  tensor(0.9252, device='cuda:3')
compute_distance is  tensor(159.8884, device='cuda:3')
compute_norm is  tensor(42.9662, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(161.4711, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8274579376045829
avg test loss is  1.3817502705018911
avg accuracy is  0.8489000001563234
solo acc is  0.2598000001563386
compute similarity  is  tensor(0.9249, device='cuda:3')
compute_distance is  tensor(161.4711, device='cuda:3')
compute_norm is  tensor(42.7350, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.0477, device='cuda:3')
exit early
distance 1 is tensor(163.0477, device='cuda:3')
________________________________
test distance is  tensor(163.0477, device='cuda:3')
test similarity is  tensor(0.9245, device='cuda:3')
test acc is  0.8518666668229898
test loss is 1.3735119016694108
test entropy is  0.8210171569766266
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.379509449005127
mal norm is  tensor(783.5774, device='cuda:3')
distance 1 is tensor(163.0477, device='cuda:3')
mal distance is  tensor(163.0477, device='cuda:3')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(13.6918, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.6484, device='cuda:3')
part1 is  tensor(1.6380, device='cuda:3')
score : tensor(0.0029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.7073, device='cuda:3')
part1 is  tensor(1.9985, device='cuda:3')
score : tensor(0.0065, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.5831, device='cuda:3')
part1 is  tensor(18.7212, device='cuda:3')
score : tensor(0.1737, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.2504, device='cuda:3')
part1 is  tensor(8.6463, device='cuda:3')
score : tensor(0.0730, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.5512, device='cuda:3')
part1 is  tensor(5.3248, device='cuda:3')
score : tensor(0.0398, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.5137, device='cuda:3')
part1 is  tensor(-7.3458, device='cuda:3')
score : tensor(-0.0869, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(502.9213, device='cuda:3')
part1 is  tensor(8.0574, device='cuda:3')
score : tensor(0.0671, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.9238, device='cuda:3')
part1 is  tensor(-15.1785, device='cuda:3')
score : tensor(-0.1653, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.5774, device='cuda:3')
part1 is  tensor(9.9928, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.6218, device='cuda:3')
part1 is  tensor(10.0540, device='cuda:3')
score : tensor(0.0870, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.8369, device='cuda:3')
part1 is  tensor(33.0232, device='cuda:3')
score : tensor(0.3167, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.3817, device='cuda:3')
part1 is  tensor(9.1881, device='cuda:3')
score : tensor(0.0784, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.8463, device='cuda:3')
part1 is  tensor(14.8575, device='cuda:3')
score : tensor(0.1351, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.7313, device='cuda:3')
part1 is  tensor(16.6191, device='cuda:3')
score : tensor(0.1527, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0087, device='cuda:3')
part1 is  tensor(27.8931, device='cuda:3')
score : tensor(0.2654, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.1774, device='cuda:3')
part1 is  tensor(14.5632, device='cuda:3')
score : tensor(0.1321, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(659.8035, device='cuda:3')
part1 is  tensor(11.2258, device='cuda:3')
score : tensor(0.0988, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.6308, device='cuda:3')
part1 is  tensor(31.2105, device='cuda:3')
score : tensor(0.2986, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.4037, device='cuda:3')
part1 is  tensor(-18.2811, device='cuda:3')
score : tensor(-0.1963, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.9999, device='cuda:3')
part1 is  tensor(6.5805, device='cuda:3')
score : tensor(0.0523, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.7991, device='cuda:3')
part1 is  tensor(0.3319, device='cuda:3')
score : tensor(-0.0102, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.6874, device='cuda:3')
part1 is  tensor(26.6492, device='cuda:3')
score : tensor(0.2530, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.9336, device='cuda:3')
part1 is  tensor(31.4733, device='cuda:3')
score : tensor(0.3012, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.0185, device='cuda:3')
part1 is  tensor(9.3752, device='cuda:3')
score : tensor(0.0803, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.4909, device='cuda:3')
part1 is  tensor(-3.2052, device='cuda:3')
score : tensor(-0.0455, device='cuda:3')
len accept list 31
len all weights is 31
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 87.97% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.28907331824302673
distance 1 is tensor(121.8257, device='cuda:3')
benign distance is  tensor(121.8257, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.20838725566864014
distance 1 is tensor(121.0701, device='cuda:3')
benign distance is  tensor(121.0701, device='cuda:3')
norm1 res is  tensor(0.1329, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.17286451160907745
distance 1 is tensor(125.9599, device='cuda:3')
benign distance is  tensor(125.9599, device='cuda:3')
norm1 res is  tensor(0.1376, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.126546710729599
distance 1 is tensor(129.6905, device='cuda:3')
benign distance is  tensor(129.6905, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.31522804498672485
distance 1 is tensor(136.3543, device='cuda:3')
benign distance is  tensor(136.3543, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7276347875595093
distance 1 is tensor(143.9253, device='cuda:3')
benign distance is  tensor(143.9253, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6030638813972473
distance 1 is tensor(124.0382, device='cuda:3')
benign distance is  tensor(124.0382, device='cuda:3')
norm1 res is  tensor(0.1376, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3704738914966583
distance 1 is tensor(135.4349, device='cuda:3')
benign distance is  tensor(135.4349, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.14339478313922882
distance 1 is tensor(158.9091, device='cuda:3')
benign distance is  tensor(158.9091, device='cuda:3')
norm1 res is  tensor(0.1690, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.7481663823127747
distance 1 is tensor(134.0151, device='cuda:3')
benign distance is  tensor(134.0151, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.8873264193534851
distance 1 is tensor(149.8463, device='cuda:3')
benign distance is  tensor(149.8463, device='cuda:3')
norm1 res is  tensor(0.1620, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.8544002771377563
distance 1 is tensor(146.0855, device='cuda:3')
benign distance is  tensor(146.0855, device='cuda:3')
norm1 res is  tensor(0.1592, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.49134311079978943
distance 1 is tensor(152.0558, device='cuda:3')
benign distance is  tensor(152.0558, device='cuda:3')
norm1 res is  tensor(0.1627, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.26865577697753906
distance 1 is tensor(134.3131, device='cuda:3')
benign distance is  tensor(134.3131, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.6474950909614563
distance 1 is tensor(166.4965, device='cuda:3')
benign distance is  tensor(166.4965, device='cuda:3')
norm1 res is  tensor(0.1787, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.6484942436218262
distance 1 is tensor(155.8613, device='cuda:3')
benign distance is  tensor(155.8613, device='cuda:3')
norm1 res is  tensor(0.1701, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.2116686999797821
distance 1 is tensor(157.3169, device='cuda:3')
benign distance is  tensor(157.3169, device='cuda:3')
norm1 res is  tensor(0.1703, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.5297269225120544
distance 1 is tensor(137.4645, device='cuda:3')
benign distance is  tensor(137.4645, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.2563598155975342
distance 1 is tensor(169.3259, device='cuda:3')
benign distance is  tensor(169.3259, device='cuda:3')
norm1 res is  tensor(0.1881, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.2968582212924957
distance 1 is tensor(148.6801, device='cuda:3')
benign distance is  tensor(148.6801, device='cuda:3')
norm1 res is  tensor(0.1586, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.7217581272125244
distance 1 is tensor(137.1178, device='cuda:3')
benign distance is  tensor(137.1178, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.5333845019340515
distance 1 is tensor(148.4562, device='cuda:3')
benign distance is  tensor(148.4562, device='cuda:3')
norm1 res is  tensor(0.1617, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.5273544788360596
distance 1 is tensor(148.5657, device='cuda:3')
benign distance is  tensor(148.5657, device='cuda:3')
norm1 res is  tensor(0.1635, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.4224144518375397
distance 1 is tensor(140.3407, device='cuda:3')
benign distance is  tensor(140.3407, device='cuda:3')
norm1 res is  tensor(0.1537, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(144.9861, device='cuda:3')
compute distance is  tensor(144.9861, device='cuda:3')
compute norm is  tensor(46.7445, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.2319, device='cuda:3')
compute distance is  tensor(135.2319, device='cuda:3')
compute norm is  tensor(46.4449, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.6355, device='cuda:3')
compute distance is  tensor(148.6355, device='cuda:3')
compute norm is  tensor(46.6875, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(146.4453, device='cuda:3')
compute distance is  tensor(146.4453, device='cuda:3')
compute norm is  tensor(46.6115, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(151.5995, device='cuda:3')
compute distance is  tensor(151.5995, device='cuda:3')
compute norm is  tensor(46.7759, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.1055, device='cuda:3')
compute distance is  tensor(140.1055, device='cuda:3')
compute norm is  tensor(46.6543, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.3974, device='cuda:3')
compute distance is  tensor(140.3974, device='cuda:3')
compute norm is  tensor(46.5331, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(145.7543, device='cuda:3')
compute distance is  tensor(145.7543, device='cuda:3')
compute norm is  tensor(46.7309, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.1761, device='cuda:3')
compute distance is  tensor(149.1761, device='cuda:3')
compute norm is  tensor(46.8533, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(127.6635, device='cuda:3')
compute distance is  tensor(127.6635, device='cuda:3')
compute norm is  tensor(46.2773, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(150.2405, device='cuda:3')
compute distance is  tensor(150.2405, device='cuda:3')
compute norm is  tensor(46.9610, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(145.9547, device='cuda:3')
compute distance is  tensor(145.9547, device='cuda:3')
compute norm is  tensor(46.6098, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.5995, device='cuda:3')
distance 1 is tensor(1869466.2500, device='cuda:3')
________________________________
test distance is  tensor(1869466.2500, device='cuda:3')
test similarity is  tensor(-0.0135, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.768999560605272e+18
test entropy is  0.0
________________________________
cal ratio is  0.008825028207195594
distance 1 is tensor(16498.0977, device='cuda:3')
cal_distance is  tensor(16498.0977, device='cuda:3')
cal ratio is  0.09394160739825277
distance 1 is tensor(1549.8640, device='cuda:3')
cal_distance is  tensor(1549.8640, device='cuda:3')
cal ratio is  0.30649833957578626
distance 1 is tensor(475.0354, device='cuda:3')
cal_distance is  tensor(475.0354, device='cuda:3')
cal ratio is  0.5536202183381513
distance 1 is tensor(262.9922, device='cuda:3')
cal_distance is  tensor(262.9922, device='cuda:3')
cal ratio is  0.7440523298290262
distance 1 is tensor(195.6817, device='cuda:3')
cal_distance is  tensor(195.6817, device='cuda:3')
cal ratio is  0.862580858476231
distance 1 is tensor(168.7922, device='cuda:3')
cal_distance is  tensor(168.7922, device='cuda:3')
cal ratio is  0.9287497980854333
distance 1 is tensor(156.7662, device='cuda:3')
cal_distance is  tensor(156.7662, device='cuda:3')
cal ratio is  0.9637151140734275
distance 1 is tensor(151.0782, device='cuda:3')
cal_distance is  tensor(151.0782, device='cuda:3')
distance 1 is tensor(151.0782, device='cuda:3')
________________________________
test distance is  tensor(151.0782, device='cuda:3')
test similarity is  tensor(0.9300, device='cuda:3')
test acc is  0.40720000015634117
test loss is 240.20886702222356
test entropy is  6.811725200466335e-06
________________________________
distance 1 is tensor(151.0782, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.457997454346577e-08
avg test loss is  240.40382577208823
avg accuracy is  0.4072666668230078
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9300, device='cuda:3')
compute_distance is  tensor(151.0782, device='cuda:3')
compute_norm is  tensor(46.3116, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(133.5698, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9396587488874952
avg test loss is  1.4857514262961935
avg accuracy is  0.7541500001563277
solo acc is  0.30445000015633966
compute similarity  is  tensor(0.9338, device='cuda:3')
compute_distance is  tensor(133.5698, device='cuda:3')
compute_norm is  tensor(45.5338, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance 1 is tensor(133.5698, device='cuda:3')
________________________________
test distance is  tensor(133.5698, device='cuda:3')
test similarity is  tensor(0.9338, device='cuda:3')
test acc is  0.7569833334896608
test loss is 1.4852767019892044
test entropy is  0.9390103531036296
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.633999228477478
mal norm is  tensor(743.4536, device='cuda:3')
distance 1 is tensor(133.5698, device='cuda:3')
mal distance is  tensor(133.5698, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(24.6257, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(548.6579, device='cuda:3')
part1 is  tensor(10.9612, device='cuda:3')
score : tensor(0.0852, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.5750, device='cuda:3')
part1 is  tensor(31.3835, device='cuda:3')
score : tensor(0.2894, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.0543, device='cuda:3')
part1 is  tensor(17.4795, device='cuda:3')
score : tensor(0.1504, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(567.9434, device='cuda:3')
part1 is  tensor(8.7649, device='cuda:3')
score : tensor(0.0632, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.6933, device='cuda:3')
part1 is  tensor(-3.8108, device='cuda:3')
score : tensor(-0.0625, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.1306, device='cuda:3')
part1 is  tensor(-41.0053, device='cuda:3')
score : tensor(-0.4345, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.7950, device='cuda:3')
part1 is  tensor(-42.1057, device='cuda:3')
score : tensor(-0.4455, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.7144, device='cuda:3')
part1 is  tensor(-9.1360, device='cuda:3')
score : tensor(-0.1158, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.4536, device='cuda:3')
part1 is  tensor(-39.2414, device='cuda:3')
score : tensor(-0.4168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.4798, device='cuda:3')
part1 is  tensor(2.1881, device='cuda:3')
score : tensor(-0.0025, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(684.3036, device='cuda:3')
part1 is  tensor(-44.7064, device='cuda:3')
score : tensor(-0.4715, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.3675, device='cuda:3')
part1 is  tensor(8.8645, device='cuda:3')
score : tensor(0.0642, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.5523, device='cuda:3')
part1 is  tensor(21.8583, device='cuda:3')
score : tensor(0.1942, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.6135, device='cuda:3')
part1 is  tensor(26.7761, device='cuda:3')
score : tensor(0.2433, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.7599, device='cuda:3')
part1 is  tensor(0.3670, device='cuda:3')
score : tensor(-0.0208, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.5170, device='cuda:3')
part1 is  tensor(21.8082, device='cuda:3')
score : tensor(0.1937, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.5618, device='cuda:3')
part1 is  tensor(-19.6393, device='cuda:3')
score : tensor(-0.2208, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.70% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4233384132385254
distance 1 is tensor(101.6474, device='cuda:3')
benign distance is  tensor(101.6474, device='cuda:3')
norm1 res is  tensor(0.1174, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8092058300971985
distance 1 is tensor(114.3743, device='cuda:3')
benign distance is  tensor(114.3743, device='cuda:3')
norm1 res is  tensor(0.1317, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2787306606769562
distance 1 is tensor(114.0183, device='cuda:3')
benign distance is  tensor(114.0183, device='cuda:3')
norm1 res is  tensor(0.1250, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.0410267114639282
distance 1 is tensor(105.7129, device='cuda:3')
benign distance is  tensor(105.7129, device='cuda:3')
norm1 res is  tensor(0.1162, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4469432830810547
distance 1 is tensor(109.8837, device='cuda:3')
benign distance is  tensor(109.8837, device='cuda:3')
norm1 res is  tensor(0.1208, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5272198915481567
distance 1 is tensor(126.0537, device='cuda:3')
benign distance is  tensor(126.0537, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.11399812996387482
distance 1 is tensor(106.2349, device='cuda:3')
benign distance is  tensor(106.2349, device='cuda:3')
norm1 res is  tensor(0.1192, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.331916481256485
distance 1 is tensor(121.0579, device='cuda:3')
benign distance is  tensor(121.0579, device='cuda:3')
norm1 res is  tensor(0.1342, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.24429652094841003
distance 1 is tensor(138.5296, device='cuda:3')
benign distance is  tensor(138.5296, device='cuda:3')
norm1 res is  tensor(0.1535, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.6997528672218323
distance 1 is tensor(146.8216, device='cuda:3')
benign distance is  tensor(146.8216, device='cuda:3')
norm1 res is  tensor(0.1634, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.38513725996017456
distance 1 is tensor(138.5573, device='cuda:3')
benign distance is  tensor(138.5573, device='cuda:3')
norm1 res is  tensor(0.1537, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3229297697544098
distance 1 is tensor(130.5215, device='cuda:3')
benign distance is  tensor(130.5215, device='cuda:3')
norm1 res is  tensor(0.1494, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.5612687468528748
distance 1 is tensor(130.6745, device='cuda:3')
benign distance is  tensor(130.6745, device='cuda:3')
norm1 res is  tensor(0.1437, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.7325853109359741
distance 1 is tensor(132.9094, device='cuda:3')
benign distance is  tensor(132.9094, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.178004190325737
distance 1 is tensor(136.7041, device='cuda:3')
benign distance is  tensor(136.7041, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.45137158036231995
distance 1 is tensor(137.7441, device='cuda:3')
benign distance is  tensor(137.7441, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(138.1569, device='cuda:3')
compute distance is  tensor(138.1569, device='cuda:3')
compute norm is  tensor(46.9998, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.6889, device='cuda:3')
compute distance is  tensor(134.6889, device='cuda:3')
compute norm is  tensor(46.9396, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.9749, device='cuda:3')
compute distance is  tensor(148.9749, device='cuda:3')
compute norm is  tensor(47.4823, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(132.6943, device='cuda:3')
compute distance is  tensor(132.6943, device='cuda:3')
compute norm is  tensor(46.9201, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(146.1789, device='cuda:3')
compute distance is  tensor(146.1789, device='cuda:3')
compute norm is  tensor(47.2980, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.1137, device='cuda:3')
compute distance is  tensor(142.1137, device='cuda:3')
compute norm is  tensor(47.2312, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.8426, device='cuda:3')
compute distance is  tensor(140.8426, device='cuda:3')
compute norm is  tensor(47.0570, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.1499, device='cuda:3')
compute distance is  tensor(140.1499, device='cuda:3')
compute norm is  tensor(46.9701, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(141.5318, device='cuda:3')
compute distance is  tensor(141.5318, device='cuda:3')
compute norm is  tensor(47.1011, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.8990, device='cuda:3')
compute distance is  tensor(135.8990, device='cuda:3')
compute norm is  tensor(46.9905, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.5802, device='cuda:3')
compute distance is  tensor(152.5802, device='cuda:3')
compute norm is  tensor(47.5705, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.4799, device='cuda:3')
compute distance is  tensor(140.4799, device='cuda:3')
compute norm is  tensor(47.0396, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.5802, device='cuda:3')
distance 1 is tensor(1869481.6250, device='cuda:3')
________________________________
test distance is  tensor(1869481.6250, device='cuda:3')
test similarity is  tensor(-0.0665, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765522218522617e+18
test entropy is  0.0
________________________________
cal ratio is  0.008853491372680992
distance 1 is tensor(16551.4453, device='cuda:3')
cal_distance is  tensor(16551.4453, device='cuda:3')
cal ratio is  0.09409297816668831
distance 1 is tensor(1557.3810, device='cuda:3')
cal_distance is  tensor(1557.3810, device='cuda:3')
cal ratio is  0.30674517177164534
distance 1 is tensor(477.7237, device='cuda:3')
cal_distance is  tensor(477.7237, device='cuda:3')
cal ratio is  0.5538431037559413
distance 1 is tensor(264.5870, device='cuda:3')
cal_distance is  tensor(264.5870, device='cuda:3')
cal ratio is  0.7442021088598728
distance 1 is tensor(196.9080, device='cuda:3')
cal_distance is  tensor(196.9080, device='cuda:3')
cal ratio is  0.8626676581978688
distance 1 is tensor(169.8671, device='cuda:3')
cal_distance is  tensor(169.8671, device='cuda:3')
cal ratio is  0.9287965168990515
distance 1 is tensor(157.7724, device='cuda:3')
cal_distance is  tensor(157.7724, device='cuda:3')
cal ratio is  0.9637394379062989
distance 1 is tensor(152.0517, device='cuda:3')
cal_distance is  tensor(152.0517, device='cuda:3')
distance 1 is tensor(152.0517, device='cuda:3')
________________________________
test distance is  tensor(152.0517, device='cuda:3')
test similarity is  tensor(0.9291, device='cuda:3')
test acc is  0.6736000001563324
test loss is 208.66371782705474
test entropy is  0.00026045319164771046
________________________________
distance 1 is tensor(152.0517, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00024412774516628487
avg test loss is  208.93183231963786
avg accuracy is  0.673316666822999
solo acc is  0.10101666682299865
compute similarity  is  tensor(0.9291, device='cuda:3')
compute_distance is  tensor(152.0517, device='cuda:3')
compute_norm is  tensor(46.5225, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(135.8095, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.93588879799792
avg test loss is  1.5246795235412207
avg accuracy is  0.831750000156324
solo acc is  0.3054666668230063
compute similarity  is  tensor(0.9323, device='cuda:3')
compute_distance is  tensor(135.8095, device='cuda:3')
compute_norm is  tensor(45.5582, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.6950, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8751404828100062
avg test loss is  1.5785340454532648
avg accuracy is  0.8293166668229909
solo acc is  0.26321666682300526
compute similarity  is  tensor(0.9318, device='cuda:3')
compute_distance is  tensor(137.6950, device='cuda:3')
compute_norm is  tensor(45.2602, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.1861, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8713969480254249
avg test loss is  1.5255926055694693
avg accuracy is  0.8308333334896574
solo acc is  0.26201666682300523
compute similarity  is  tensor(0.9316, device='cuda:3')
compute_distance is  tensor(139.1861, device='cuda:3')
compute_norm is  tensor(44.9798, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.6466, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.861550855293457
avg test loss is  1.5080505842084824
avg accuracy is  0.8323500001563241
solo acc is  0.25536666682300513
compute similarity  is  tensor(0.9313, device='cuda:3')
compute_distance is  tensor(140.6466, device='cuda:3')
compute_norm is  tensor(44.7111, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.1006, device='cuda:3')
________________________________
test distance is  tensor(142.1006, device='cuda:3')
test similarity is  tensor(0.9311, device='cuda:3')
test acc is  0.8360333334896571
test loss is 1.4711657962056874
test entropy is  0.8564629292945618
________________________________
distance 1 is tensor(142.1006, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8583640163259973
avg test loss is  1.4641877314937648
avg accuracy is  0.8369166668229906
solo acc is  0.2642666668230053
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(142.1006, device='cuda:3')
compute_norm is  tensor(44.4501, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.5083, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8450378742553531
avg test loss is  1.4550064919091492
avg accuracy is  0.8376333334896572
solo acc is  0.25961666682300516
compute similarity  is  tensor(0.9308, device='cuda:3')
compute_distance is  tensor(143.5083, device='cuda:3')
compute_norm is  tensor(44.1996, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.9496, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8452582498476195
avg test loss is  1.4305445424783458
avg accuracy is  0.8386333334896571
solo acc is  0.26248333348967195
compute similarity  is  tensor(0.9306, device='cuda:3')
compute_distance is  tensor(144.9496, device='cuda:3')
compute_norm is  tensor(43.9528, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.4039, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8528668905244962
avg test loss is  1.4212263345972562
avg accuracy is  0.8409166668229904
solo acc is  0.25146666682300506
compute similarity  is  tensor(0.9303, device='cuda:3')
compute_distance is  tensor(146.4039, device='cuda:3')
compute_norm is  tensor(43.7130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.8150, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8416159358233023
avg test loss is  1.4115873071938945
avg accuracy is  0.8422166668229902
solo acc is  0.25050000015633833
compute similarity  is  tensor(0.9301, device='cuda:3')
compute_distance is  tensor(147.8150, device='cuda:3')
compute_norm is  tensor(43.4788, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.2176, device='cuda:3')
________________________________
test distance is  tensor(149.2176, device='cuda:3')
test similarity is  tensor(0.9298, device='cuda:3')
test acc is  0.8427500001563236
test loss is 1.3913232569755523
test entropy is  0.841456024250242
________________________________
distance 1 is tensor(149.2176, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8412659497403386
avg test loss is  1.3943035915208015
avg accuracy is  0.8424166668229903
solo acc is  0.25233333348967174
compute similarity  is  tensor(0.9298, device='cuda:3')
compute_distance is  tensor(149.2176, device='cuda:3')
compute_norm is  tensor(43.2475, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.6373, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8276991239234582
avg test loss is  1.3780054401741353
avg accuracy is  0.8447000001563235
solo acc is  0.26010000015633855
compute similarity  is  tensor(0.9296, device='cuda:3')
compute_distance is  tensor(150.6373, device='cuda:3')
compute_norm is  tensor(43.0215, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.0271, device='cuda:3')
exit early
distance 1 is tensor(152.0271, device='cuda:3')
________________________________
test distance is  tensor(152.0271, device='cuda:3')
test similarity is  tensor(0.9293, device='cuda:3')
test acc is  0.8447833334896568
test loss is 1.3756343413517673
test entropy is  0.8287438754715136
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4182242155075073
mal norm is  tensor(746.6814, device='cuda:3')
distance 1 is tensor(152.0271, device='cuda:3')
mal distance is  tensor(152.0271, device='cuda:3')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(27.6144, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(461.9342, device='cuda:3')
part1 is  tensor(-19.5213, device='cuda:3')
score : tensor(-0.2226, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(510.4475, device='cuda:3')
part1 is  tensor(-52.8737, device='cuda:3')
score : tensor(-0.5562, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(492.8510, device='cuda:3')
part1 is  tensor(106.6082, device='cuda:3')
score : tensor(1.0387, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(459.7849, device='cuda:3')
part1 is  tensor(22.4578, device='cuda:3')
score : tensor(0.1972, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(474.7740, device='cuda:3')
part1 is  tensor(-94.8420, device='cuda:3')
score : tensor(-0.9758, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.4189, device='cuda:3')
part1 is  tensor(-56.0658, device='cuda:3')
score : tensor(-0.5881, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.1685, device='cuda:3')
part1 is  tensor(75.5145, device='cuda:3')
score : tensor(0.7277, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(530.3790, device='cuda:3')
part1 is  tensor(-1.8830, device='cuda:3')
score : tensor(-0.0462, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(746.6814, device='cuda:3')
part1 is  tensor(-139.1464, device='cuda:3')
score : tensor(-1.4189, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2245, device='cuda:3')
part1 is  tensor(131.4323, device='cuda:3')
score : tensor(1.2869, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.2900, device='cuda:3')
part1 is  tensor(20.2515, device='cuda:3')
score : tensor(0.1751, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.6099, device='cuda:3')
part1 is  tensor(37.5090, device='cuda:3')
score : tensor(0.3477, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.6158, device='cuda:3')
part1 is  tensor(139.9194, device='cuda:3')
score : tensor(1.3718, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.0513, device='cuda:3')
part1 is  tensor(74.8240, device='cuda:3')
score : tensor(0.7208, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.8608, device='cuda:3')
part1 is  tensor(4.9558, device='cuda:3')
score : tensor(0.0221, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.5953, device='cuda:3')
part1 is  tensor(55.0917, device='cuda:3')
score : tensor(0.5235, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.2045, device='cuda:3')
part1 is  tensor(83.6294, device='cuda:3')
score : tensor(0.8089, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0427, device='cuda:3')
part1 is  tensor(62.5862, device='cuda:3')
score : tensor(0.5984, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.9490, device='cuda:3')
part1 is  tensor(-22.1394, device='cuda:3')
score : tensor(-0.2488, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0385, device='cuda:3')
part1 is  tensor(-19.9368, device='cuda:3')
score : tensor(-0.2268, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.8863, device='cuda:3')
part1 is  tensor(-80.7659, device='cuda:3')
score : tensor(-0.8351, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.7164, device='cuda:3')
part1 is  tensor(-56.3922, device='cuda:3')
score : tensor(-0.5913, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.8320, device='cuda:3')
part1 is  tensor(31.1473, device='cuda:3')
score : tensor(0.2841, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.0256, device='cuda:3')
part1 is  tensor(-18.9886, device='cuda:3')
score : tensor(-0.2173, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(681.1226, device='cuda:3')
part1 is  tensor(19.1640, device='cuda:3')
score : tensor(0.1642, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 89.17% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.7543525099754333
distance 1 is tensor(97.2705, device='cuda:3')
benign distance is  tensor(97.2705, device='cuda:3')
norm1 res is  tensor(0.1120, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.2300695925951004
distance 1 is tensor(120.1905, device='cuda:3')
benign distance is  tensor(120.1905, device='cuda:3')
norm1 res is  tensor(0.1357, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.06322716176509857
distance 1 is tensor(112.6430, device='cuda:3')
benign distance is  tensor(112.6430, device='cuda:3')
norm1 res is  tensor(0.1260, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.19773349165916443
distance 1 is tensor(112.3888, device='cuda:3')
benign distance is  tensor(112.3888, device='cuda:3')
norm1 res is  tensor(0.1282, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.29012563824653625
distance 1 is tensor(103.3999, device='cuda:3')
benign distance is  tensor(103.3999, device='cuda:3')
norm1 res is  tensor(0.1172, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6444913148880005
distance 1 is tensor(116.7479, device='cuda:3')
benign distance is  tensor(116.7479, device='cuda:3')
norm1 res is  tensor(0.1334, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2965385317802429
distance 1 is tensor(112.4996, device='cuda:3')
benign distance is  tensor(112.4996, device='cuda:3')
norm1 res is  tensor(0.1240, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.03157541900873184
distance 1 is tensor(121.3243, device='cuda:3')
benign distance is  tensor(121.3243, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.19324243068695068
distance 1 is tensor(132.4326, device='cuda:3')
benign distance is  tensor(132.4326, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.2860206961631775
distance 1 is tensor(138.7359, device='cuda:3')
benign distance is  tensor(138.7359, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.31748098134994507
distance 1 is tensor(125.2897, device='cuda:3')
benign distance is  tensor(125.2897, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.10334266722202301
distance 1 is tensor(135.7033, device='cuda:3')
benign distance is  tensor(135.7033, device='cuda:3')
norm1 res is  tensor(0.1526, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.19836969673633575
distance 1 is tensor(120.9150, device='cuda:3')
benign distance is  tensor(120.9150, device='cuda:3')
norm1 res is  tensor(0.1376, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.25633639097213745
distance 1 is tensor(126.3668, device='cuda:3')
benign distance is  tensor(126.3668, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.34912973642349243
distance 1 is tensor(135.2967, device='cuda:3')
benign distance is  tensor(135.2967, device='cuda:3')
norm1 res is  tensor(0.1507, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4031434953212738
distance 1 is tensor(129.8331, device='cuda:3')
benign distance is  tensor(129.8331, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.31133121252059937
distance 1 is tensor(126.0926, device='cuda:3')
benign distance is  tensor(126.0926, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.04993915557861328
distance 1 is tensor(118.2084, device='cuda:3')
benign distance is  tensor(118.2084, device='cuda:3')
norm1 res is  tensor(0.1367, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.623505711555481
distance 1 is tensor(130.9469, device='cuda:3')
benign distance is  tensor(130.9469, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.6133342981338501
distance 1 is tensor(131.6650, device='cuda:3')
benign distance is  tensor(131.6650, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.13576941192150116
distance 1 is tensor(131.7300, device='cuda:3')
benign distance is  tensor(131.7300, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.8058193325996399
distance 1 is tensor(127.7576, device='cuda:3')
benign distance is  tensor(127.7576, device='cuda:3')
norm1 res is  tensor(0.1386, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.6138209104537964
distance 1 is tensor(126.8014, device='cuda:3')
benign distance is  tensor(126.8014, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.3104521632194519
distance 1 is tensor(120.8960, device='cuda:3')
benign distance is  tensor(120.8960, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(119.6150, device='cuda:3')
compute distance is  tensor(119.6150, device='cuda:3')
compute norm is  tensor(46.5607, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(122.6130, device='cuda:3')
compute distance is  tensor(122.6130, device='cuda:3')
compute norm is  tensor(46.6632, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(122.6970, device='cuda:3')
compute distance is  tensor(122.6970, device='cuda:3')
compute norm is  tensor(46.8135, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(124.6047, device='cuda:3')
compute distance is  tensor(124.6047, device='cuda:3')
compute norm is  tensor(46.8618, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.9028, device='cuda:3')
compute distance is  tensor(140.9028, device='cuda:3')
compute norm is  tensor(47.1929, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(144.3398, device='cuda:3')
compute distance is  tensor(144.3398, device='cuda:3')
compute norm is  tensor(47.3681, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(123.0657, device='cuda:3')
compute distance is  tensor(123.0657, device='cuda:3')
compute norm is  tensor(46.8541, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(133.9403, device='cuda:3')
compute distance is  tensor(133.9403, device='cuda:3')
compute norm is  tensor(47.0613, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.4853, device='cuda:3')
compute distance is  tensor(135.4853, device='cuda:3')
compute norm is  tensor(47.1029, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(128.7722, device='cuda:3')
compute distance is  tensor(128.7722, device='cuda:3')
compute norm is  tensor(46.9505, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(129.0665, device='cuda:3')
compute distance is  tensor(129.0665, device='cuda:3')
compute norm is  tensor(47.0491, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(124.4451, device='cuda:3')
compute distance is  tensor(124.4451, device='cuda:3')
compute norm is  tensor(46.8333, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.3398, device='cuda:3')
distance 1 is tensor(1869487.5000, device='cuda:3')
________________________________
test distance is  tensor(1869487.5000, device='cuda:3')
test similarity is  tensor(-0.0863, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766668534414557e+18
test entropy is  0.0
________________________________
cal ratio is  0.008611083197271219
distance 1 is tensor(16098.3184, device='cuda:3')
cal_distance is  tensor(16098.3184, device='cuda:3')
cal ratio is  0.09279590719866164
distance 1 is tensor(1493.8641, device='cuda:3')
cal_distance is  tensor(1493.8641, device='cuda:3')
cal ratio is  0.30462358807975015
distance 1 is tensor(455.0709, device='cuda:3')
cal_distance is  tensor(455.0709, device='cuda:3')
cal ratio is  0.5519243174470984
distance 1 is tensor(251.1677, device='cuda:3')
cal_distance is  tensor(251.1677, device='cuda:3')
cal ratio is  0.7429116507970817
distance 1 is tensor(186.5972, device='cuda:3')
cal_distance is  tensor(186.5972, device='cuda:3')
cal ratio is  0.8619192212761027
distance 1 is tensor(160.8326, device='cuda:3')
cal_distance is  tensor(160.8326, device='cuda:3')
cal ratio is  0.9283933510903624
distance 1 is tensor(149.3164, device='cuda:3')
cal_distance is  tensor(149.3164, device='cuda:3')
cal ratio is  0.9635300962313593
distance 1 is tensor(143.8711, device='cuda:3')
cal_distance is  tensor(143.8711, device='cuda:3')
distance 1 is tensor(143.8711, device='cuda:3')
________________________________
test distance is  tensor(143.8711, device='cuda:3')
test similarity is  tensor(0.9358, device='cuda:3')
test acc is  0.7809666668229929
test loss is 148.81561418382853
test entropy is  0.0014070018076680812
________________________________
distance 1 is tensor(143.8711, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0014793542488271325
avg test loss is  148.52886640796783
avg accuracy is  0.7811666668229931
solo acc is  0.10635000015633196
compute similarity  is  tensor(0.9358, device='cuda:3')
compute_distance is  tensor(143.8711, device='cuda:3')
compute_norm is  tensor(46.3666, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(129.8678, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9310425852280436
avg test loss is  1.517689220178356
avg accuracy is  0.8454500001563234
solo acc is  0.3087666668230064
compute similarity  is  tensor(0.9381, device='cuda:3')
compute_distance is  tensor(129.8678, device='cuda:3')
compute_norm is  tensor(45.2962, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.8698, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8775940263576345
avg test loss is  1.563589737105217
avg accuracy is  0.8457166668229902
solo acc is  0.26450000015633857
compute similarity  is  tensor(0.9376, device='cuda:3')
compute_distance is  tensor(131.8698, device='cuda:3')
compute_norm is  tensor(44.9931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.6799, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8775059120106036
avg test loss is  1.5172755934282152
avg accuracy is  0.8472666668229901
solo acc is  0.2611166668230052
compute similarity  is  tensor(0.9372, device='cuda:3')
compute_distance is  tensor(133.6799, device='cuda:3')
compute_norm is  tensor(44.7088, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.2749, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8727321402985913
avg test loss is  1.477861076275677
avg accuracy is  0.85021666682299
solo acc is  0.2648000001563387
compute similarity  is  tensor(0.9370, device='cuda:3')
compute_distance is  tensor(135.2749, device='cuda:3')
compute_norm is  tensor(44.4395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.8778, device='cuda:3')
________________________________
test distance is  tensor(136.8778, device='cuda:3')
test similarity is  tensor(0.9367, device='cuda:3')
test acc is  0.8488666668229901
test loss is 1.4535738563995118
test entropy is  0.8656540644575538
________________________________
distance 1 is tensor(136.8778, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8666103907993862
avg test loss is  1.4514706200882317
avg accuracy is  0.8506000001563233
solo acc is  0.265333333489672
compute similarity  is  tensor(0.9367, device='cuda:3')
compute_distance is  tensor(136.8778, device='cuda:3')
compute_norm is  tensor(44.1808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.4843, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8493733231955246
avg test loss is  1.4426882739768607
avg accuracy is  0.8528500001563232
solo acc is  0.2605000001563386
compute similarity  is  tensor(0.9364, device='cuda:3')
compute_distance is  tensor(138.4843, device='cuda:3')
compute_norm is  tensor(43.9300, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0388, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8431930502594661
avg test loss is  1.4336019266388818
avg accuracy is  0.8535166668229899
solo acc is  0.25421666682300503
compute similarity  is  tensor(0.9361, device='cuda:3')
compute_distance is  tensor(140.0388, device='cuda:3')
compute_norm is  tensor(43.6847, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.5748, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8370283429048209
avg test loss is  1.4160903829501381
avg accuracy is  0.8537833334896565
solo acc is  0.25603333348967183
compute similarity  is  tensor(0.9358, device='cuda:3')
compute_distance is  tensor(141.5748, device='cuda:3')
compute_norm is  tensor(43.4449, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.0802, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8289734437775764
avg test loss is  1.4059186502814547
avg accuracy is  0.8563666668229898
solo acc is  0.25495000015633834
compute similarity  is  tensor(0.9355, device='cuda:3')
compute_distance is  tensor(143.0802, device='cuda:3')
compute_norm is  tensor(43.2099, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.6200, device='cuda:3')
________________________________
test distance is  tensor(144.6200, device='cuda:3')
test similarity is  tensor(0.9353, device='cuda:3')
test acc is  0.8591666668229897
test loss is 1.389300448299725
test entropy is  0.8312154506950744
________________________________
cal ratio is  0.9790500143176121
distance 1 is tensor(141.5903, device='cuda:3')
cal_distance is  tensor(141.5903, device='cuda:3')
distance 1 is tensor(141.5903, device='cuda:3')
________________________________
test distance is  tensor(141.5903, device='cuda:3')
test similarity is  tensor(0.9380, device='cuda:3')
test acc is  0.8598333334896563
test loss is 1.3200391477613307
test entropy is  0.8470485136071756
________________________________
distance 1 is tensor(141.5903, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8455541110369188
avg test loss is  1.3210938365093425
avg accuracy is  0.8601833334896561
solo acc is  0.2911500001563393
compute similarity  is  tensor(0.9380, device='cuda:3')
compute_distance is  tensor(141.5903, device='cuda:3')
compute_norm is  tensor(42.9806, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.3246, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8294559921155861
avg test loss is  1.3630002367216896
avg accuracy is  0.8600333334896563
solo acc is  0.26070000015633854
compute similarity  is  tensor(0.9376, device='cuda:3')
compute_distance is  tensor(143.3246, device='cuda:3')
compute_norm is  tensor(42.7535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.9880, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8231614373131856
avg test loss is  1.352241627379521
avg accuracy is  0.8621666668229895
solo acc is  0.26093333348967196
compute similarity  is  tensor(0.9373, device='cuda:3')
compute_distance is  tensor(144.9880, device='cuda:3')
compute_norm is  tensor(42.5277, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.6018, device='cuda:3')
exit early
distance 1 is tensor(146.6018, device='cuda:3')
________________________________
test distance is  tensor(146.6018, device='cuda:3')
test similarity is  tensor(0.9370, device='cuda:3')
test acc is  0.8641500001563227
test loss is 1.35388877790874
test entropy is  0.8181766399315425
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.5029165744781494
mal norm is  tensor(705.8154, device='cuda:3')
distance 1 is tensor(146.6018, device='cuda:3')
mal distance is  tensor(146.6018, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(10.7609, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(440.1679, device='cuda:3')
part1 is  tensor(-10.3412, device='cuda:3')
score : tensor(-0.1140, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(537.0219, device='cuda:3')
part1 is  tensor(-6.2553, device='cuda:3')
score : tensor(-0.0731, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.4665, device='cuda:3')
part1 is  tensor(9.9365, device='cuda:3')
score : tensor(0.0888, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(506.3451, device='cuda:3')
part1 is  tensor(7.2759, device='cuda:3')
score : tensor(0.0622, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(462.6865, device='cuda:3')
part1 is  tensor(-6.7528, device='cuda:3')
score : tensor(-0.0781, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.6168, device='cuda:3')
part1 is  tensor(-16.8334, device='cuda:3')
score : tensor(-0.1789, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.4511, device='cuda:3')
part1 is  tensor(-3.2946, device='cuda:3')
score : tensor(-0.0435, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.5304, device='cuda:3')
part1 is  tensor(-1.8728, device='cuda:3')
score : tensor(-0.0293, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(705.8154, device='cuda:3')
part1 is  tensor(-7.8462, device='cuda:3')
score : tensor(-0.0890, device='cuda:3')
len accept list 2
len all weights is 2
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 89.03% 

Test Accuracy: 87.85% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.23528090119361877
distance 1 is tensor(108.6133, device='cuda:3')
benign distance is  tensor(108.6133, device='cuda:3')
norm1 res is  tensor(0.1272, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.41940879821777344
distance 1 is tensor(118.5579, device='cuda:3')
benign distance is  tensor(118.5579, device='cuda:3')
norm1 res is  tensor(0.1337, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.7214326858520508
distance 1 is tensor(103.6045, device='cuda:3')
benign distance is  tensor(103.6045, device='cuda:3')
norm1 res is  tensor(0.1164, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3061271905899048
distance 1 is tensor(100.3705, device='cuda:3')
benign distance is  tensor(100.3705, device='cuda:3')
norm1 res is  tensor(0.1149, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.305006206035614
distance 1 is tensor(128.3232, device='cuda:3')
benign distance is  tensor(128.3232, device='cuda:3')
norm1 res is  tensor(0.1433, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4379977285861969
distance 1 is tensor(134.4240, device='cuda:3')
benign distance is  tensor(134.4240, device='cuda:3')
norm1 res is  tensor(0.1525, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4089745581150055
distance 1 is tensor(121.1935, device='cuda:3')
benign distance is  tensor(121.1935, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.18402375280857086
distance 1 is tensor(137.7593, device='cuda:3')
benign distance is  tensor(137.7593, device='cuda:3')
norm1 res is  tensor(0.1539, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(147.8730, device='cuda:3')
compute distance is  tensor(147.8730, device='cuda:3')
compute norm is  tensor(47.0337, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(141.0889, device='cuda:3')
compute distance is  tensor(141.0889, device='cuda:3')
compute norm is  tensor(46.9678, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(146.9769, device='cuda:3')
compute distance is  tensor(146.9769, device='cuda:3')
compute norm is  tensor(47.2709, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(136.1198, device='cuda:3')
compute distance is  tensor(136.1198, device='cuda:3')
compute norm is  tensor(46.7544, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(157.9456, device='cuda:3')
compute distance is  tensor(157.9456, device='cuda:3')
compute norm is  tensor(47.2278, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.9422, device='cuda:3')
compute distance is  tensor(147.9422, device='cuda:3')
compute norm is  tensor(47.1773, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.5818, device='cuda:3')
compute distance is  tensor(149.5818, device='cuda:3')
compute norm is  tensor(47.2449, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.1492, device='cuda:3')
compute distance is  tensor(137.1492, device='cuda:3')
compute norm is  tensor(46.7484, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(136.9373, device='cuda:3')
compute distance is  tensor(136.9373, device='cuda:3')
compute norm is  tensor(46.8281, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.7763, device='cuda:3')
compute distance is  tensor(140.7763, device='cuda:3')
compute norm is  tensor(46.9379, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.0762, device='cuda:3')
compute distance is  tensor(148.0762, device='cuda:3')
compute norm is  tensor(47.1223, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.4603, device='cuda:3')
compute distance is  tensor(147.4603, device='cuda:3')
compute norm is  tensor(47.1135, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.9456, device='cuda:3')
distance 1 is tensor(1869488., device='cuda:3')
________________________________
test distance is  tensor(1869488., device='cuda:3')
test similarity is  tensor(-0.0856, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.764852070874237e+18
test entropy is  0.0
________________________________
cal ratio is  0.009007794315576394
distance 1 is tensor(16839.9668, device='cuda:3')
cal_distance is  tensor(16839.9668, device='cuda:3')
cal ratio is  0.09490939016810541
distance 1 is tensor(1598.2772, device='cuda:3')
cal_distance is  tensor(1598.2772, device='cuda:3')
cal ratio is  0.308073073513134
distance 1 is tensor(492.3908, device='cuda:3')
cal_distance is  tensor(492.3908, device='cuda:3')
cal ratio is  0.5550407139239919
distance 1 is tensor(273.2999, device='cuda:3')
cal_distance is  tensor(273.2999, device='cuda:3')
cal ratio is  0.7450064535469519
distance 1 is tensor(203.6120, device='cuda:3')
cal_distance is  tensor(203.6120, device='cuda:3')
cal ratio is  0.8631338581870911
distance 1 is tensor(175.7453, device='cuda:3')
cal_distance is  tensor(175.7453, device='cuda:3')
cal ratio is  0.929047605675497
distance 1 is tensor(163.2762, device='cuda:3')
cal_distance is  tensor(163.2762, device='cuda:3')
cal ratio is  0.9638696891589875
distance 1 is tensor(157.3772, device='cuda:3')
cal_distance is  tensor(157.3772, device='cuda:3')
distance 1 is tensor(157.3772, device='cuda:3')
________________________________
test distance is  tensor(157.3772, device='cuda:3')
test similarity is  tensor(0.9269, device='cuda:3')
test acc is  0.7259333334896625
test loss is 219.83869467208635
test entropy is  0.00038745969408452915
________________________________
distance 1 is tensor(157.3772, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0005229777795998541
avg test loss is  220.0671602749367
avg accuracy is  0.7241166668229959
solo acc is  0.1022833334896653
compute similarity  is  tensor(0.9269, device='cuda:3')
compute_distance is  tensor(157.3772, device='cuda:3')
compute_norm is  tensor(47.4190, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(141.5321, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9570027934208608
avg test loss is  1.5818911633257673
avg accuracy is  0.818933333489658
solo acc is  0.29401666682300603
compute similarity  is  tensor(0.9303, device='cuda:3')
compute_distance is  tensor(141.5321, device='cuda:3')
compute_norm is  tensor(46.3645, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.3526, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8986043944033478
avg test loss is  1.6355436486221835
avg accuracy is  0.8196666668229913
solo acc is  0.2501666668230049
compute similarity  is  tensor(0.9298, device='cuda:3')
compute_distance is  tensor(143.3526, device='cuda:3')
compute_norm is  tensor(46.0612, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.8822, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9008262438941866
avg test loss is  1.570692521168479
avg accuracy is  0.8242333334896578
solo acc is  0.2502833334896715
compute similarity  is  tensor(0.9295, device='cuda:3')
compute_distance is  tensor(144.8822, device='cuda:3')
compute_norm is  tensor(45.7737, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.3890, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.884916132192876
avg test loss is  1.5523250973555072
avg accuracy is  0.8258833334896577
solo acc is  0.24510000015633815
compute similarity  is  tensor(0.9291, device='cuda:3')
compute_distance is  tensor(146.3890, device='cuda:3')
compute_norm is  tensor(45.4998, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.9093, device='cuda:3')
________________________________
test distance is  tensor(147.9093, device='cuda:3')
test similarity is  tensor(0.9288, device='cuda:3')
test acc is  0.8302666668229908
test loss is 1.5233328515278506
test entropy is  0.8792252675302501
________________________________
distance 1 is tensor(147.9093, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8819904314048255
avg test loss is  1.5113759553000363
avg accuracy is  0.8281500001563242
solo acc is  0.24696666682300486
compute similarity  is  tensor(0.9288, device='cuda:3')
compute_distance is  tensor(147.9093, device='cuda:3')
compute_norm is  tensor(45.2341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.3635, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8694476217730467
avg test loss is  1.497062652604158
avg accuracy is  0.8317000001563241
solo acc is  0.24410000015633812
compute similarity  is  tensor(0.9285, device='cuda:3')
compute_distance is  tensor(149.3635, device='cuda:3')
compute_norm is  tensor(44.9779, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.7629, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8650326921360325
avg test loss is  1.463439484267855
avg accuracy is  0.8342000001563239
solo acc is  0.24973333348967158
compute similarity  is  tensor(0.9282, device='cuda:3')
compute_distance is  tensor(150.7629, device='cuda:3')
compute_norm is  tensor(44.7238, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.1962, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8593177965709141
avg test loss is  1.4541044563118584
avg accuracy is  0.8368833334896572
solo acc is  0.24620000015633817
compute similarity  is  tensor(0.9280, device='cuda:3')
compute_distance is  tensor(152.1962, device='cuda:3')
compute_norm is  tensor(44.4793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.5934, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8609539157927417
avg test loss is  1.4408407259597453
avg accuracy is  0.836700000156324
solo acc is  0.24293333348967144
compute similarity  is  tensor(0.9277, device='cuda:3')
compute_distance is  tensor(153.5934, device='cuda:3')
compute_norm is  tensor(44.2374, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.0031, device='cuda:3')
________________________________
test distance is  tensor(155.0031, device='cuda:3')
test similarity is  tensor(0.9274, device='cuda:3')
test acc is  0.8411500001563237
test loss is 1.4265850544738363
test entropy is  0.8520696512036232
________________________________
distance 1 is tensor(155.0031, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8505499266358073
avg test loss is  1.4292351480231864
avg accuracy is  0.8391166668229904
solo acc is  0.2433166668230047
compute similarity  is  tensor(0.9274, device='cuda:3')
compute_distance is  tensor(155.0031, device='cuda:3')
compute_norm is  tensor(44.0013, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.3639, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.849894099334664
avg test loss is  1.4029787895776062
avg accuracy is  0.8431666668229902
solo acc is  0.25001666682300494
compute similarity  is  tensor(0.9272, device='cuda:3')
compute_distance is  tensor(156.3639, device='cuda:3')
compute_norm is  tensor(43.7676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.7655, device='cuda:3')
exit early
distance 1 is tensor(157.7655, device='cuda:3')
________________________________
test distance is  tensor(157.7655, device='cuda:3')
test similarity is  tensor(0.9269, device='cuda:3')
test acc is  0.8442666668229901
test loss is 1.4016678861971856
test entropy is  0.8396269177704223
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.4515013694763184
mal norm is  tensor(776.1393, device='cuda:3')
distance 1 is tensor(157.7655, device='cuda:3')
mal distance is  tensor(157.7655, device='cuda:3')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(11.4193, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(495.8353, device='cuda:3')
part1 is  tensor(7.5243, device='cuda:3')
score : tensor(0.0640, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.4428, device='cuda:3')
part1 is  tensor(-8.0654, device='cuda:3')
score : tensor(-0.0919, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(457.2901, device='cuda:3')
part1 is  tensor(2.9320, device='cuda:3')
score : tensor(0.0181, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(444.5081, device='cuda:3')
part1 is  tensor(-13.1076, device='cuda:3')
score : tensor(-0.1423, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.1400, device='cuda:3')
part1 is  tensor(11.3588, device='cuda:3')
score : tensor(0.1024, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.5476, device='cuda:3')
part1 is  tensor(3.1415, device='cuda:3')
score : tensor(0.0202, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(533.5211, device='cuda:3')
part1 is  tensor(-6.5566, device='cuda:3')
score : tensor(-0.0768, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.8376, device='cuda:3')
part1 is  tensor(2.4725, device='cuda:3')
score : tensor(0.0135, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(776.1393, device='cuda:3')
part1 is  tensor(9.3910, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.5190, device='cuda:3')
part1 is  tensor(3.1726, device='cuda:3')
score : tensor(0.0205, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.9211, device='cuda:3')
part1 is  tensor(-0.2694, device='cuda:3')
score : tensor(-0.0139, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.9778, device='cuda:3')
part1 is  tensor(9.9337, device='cuda:3')
score : tensor(0.0881, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.9670, device='cuda:3')
part1 is  tensor(6.6092, device='cuda:3')
score : tensor(0.0549, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.9804, device='cuda:3')
part1 is  tensor(4.6658, device='cuda:3')
score : tensor(0.0354, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.8044, device='cuda:3')
part1 is  tensor(-6.9152, device='cuda:3')
score : tensor(-0.0804, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.9625, device='cuda:3')
part1 is  tensor(9.4019, device='cuda:3')
score : tensor(0.0828, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.8618, device='cuda:3')
part1 is  tensor(30.6094, device='cuda:3')
score : tensor(0.2949, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.3803, device='cuda:3')
part1 is  tensor(11.0239, device='cuda:3')
score : tensor(0.0990, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(666.4258, device='cuda:3')
part1 is  tensor(-11.1957, device='cuda:3')
score : tensor(-0.1232, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(805.0696, device='cuda:3')
part1 is  tensor(8.9563, device='cuda:3')
score : tensor(0.0783, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.9620, device='cuda:3')
part1 is  tensor(5.6890, device='cuda:3')
score : tensor(0.0457, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.0432, device='cuda:3')
part1 is  tensor(-9.1091, device='cuda:3')
score : tensor(-0.1023, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.0836, device='cuda:3')
part1 is  tensor(-1.1442, device='cuda:3')
score : tensor(-0.0227, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(729.1381, device='cuda:3')
part1 is  tensor(10.4038, device='cuda:3')
score : tensor(0.0928, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.2740, device='cuda:3')
part1 is  tensor(3.6738, device='cuda:3')
score : tensor(0.0255, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.5542, device='cuda:3')
part1 is  tensor(4.2138, device='cuda:3')
score : tensor(0.0309, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.5772, device='cuda:3')
part1 is  tensor(2.4606, device='cuda:3')
score : tensor(0.0134, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(696.5179, device='cuda:3')
part1 is  tensor(11.3968, device='cuda:3')
score : tensor(0.1027, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.0232, device='cuda:3')
part1 is  tensor(-11.8768, device='cuda:3')
score : tensor(-0.1300, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.7461, device='cuda:3')
part1 is  tensor(13.1748, device='cuda:3')
score : tensor(0.1205, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.7414, device='cuda:3')
part1 is  tensor(1.6038, device='cuda:3')
score : tensor(0.0048, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.6541, device='cuda:3')
part1 is  tensor(7.0604, device='cuda:3')
score : tensor(0.0594, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(683.9308, device='cuda:3')
part1 is  tensor(19.7406, device='cuda:3')
score : tensor(0.1862, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.8761, device='cuda:3')
part1 is  tensor(3.5182, device='cuda:3')
score : tensor(0.0240, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(677.3806, device='cuda:3')
part1 is  tensor(-6.1682, device='cuda:3')
score : tensor(-0.0729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.7642, device='cuda:3')
part1 is  tensor(-5.2300, device='cuda:3')
score : tensor(-0.0635, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.3716, device='cuda:3')
part1 is  tensor(6.2539, device='cuda:3')
score : tensor(0.0513, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.1860, device='cuda:3')
part1 is  tensor(-5.7473, device='cuda:3')
score : tensor(-0.0687, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.0117, device='cuda:3')
part1 is  tensor(-2.7574, device='cuda:3')
score : tensor(-0.0388, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.0373, device='cuda:3')
part1 is  tensor(0.7704, device='cuda:3')
score : tensor(-0.0035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.4620, device='cuda:3')
part1 is  tensor(-2.7830, device='cuda:3')
score : tensor(-0.0390, device='cuda:3')
len accept list 37
len all weights is 37
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.43% 

Test Accuracy: 88.45% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.455841064453125
distance 1 is tensor(112.2654, device='cuda:3')
benign distance is  tensor(112.2654, device='cuda:3')
norm1 res is  tensor(0.1322, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7136839628219604
distance 1 is tensor(129.1692, device='cuda:3')
benign distance is  tensor(129.1692, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2302248477935791
distance 1 is tensor(121.9907, device='cuda:3')
benign distance is  tensor(121.9907, device='cuda:3')
norm1 res is  tensor(0.1314, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3933495879173279
distance 1 is tensor(107.0239, device='cuda:3')
benign distance is  tensor(107.0239, device='cuda:3')
norm1 res is  tensor(0.1173, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5931660532951355
distance 1 is tensor(131.1412, device='cuda:3')
benign distance is  tensor(131.1412, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.2877405285835266
distance 1 is tensor(128.2170, device='cuda:3')
benign distance is  tensor(128.2170, device='cuda:3')
norm1 res is  tensor(0.1422, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.15893389284610748
distance 1 is tensor(137.3434, device='cuda:3')
benign distance is  tensor(137.3434, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7563186287879944
distance 1 is tensor(152.3229, device='cuda:3')
benign distance is  tensor(152.3229, device='cuda:3')
norm1 res is  tensor(0.1657, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.023390639573335648
distance 1 is tensor(155.1574, device='cuda:3')
benign distance is  tensor(155.1574, device='cuda:3')
norm1 res is  tensor(0.1685, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.3980322480201721
distance 1 is tensor(148.4380, device='cuda:3')
benign distance is  tensor(148.4380, device='cuda:3')
norm1 res is  tensor(0.1587, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  1.0746463537216187
distance 1 is tensor(143.3088, device='cuda:3')
benign distance is  tensor(143.3088, device='cuda:3')
norm1 res is  tensor(0.1523, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.3995489478111267
distance 1 is tensor(150.1674, device='cuda:3')
benign distance is  tensor(150.1674, device='cuda:3')
norm1 res is  tensor(0.1632, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.7774938941001892
distance 1 is tensor(137.7894, device='cuda:3')
benign distance is  tensor(137.7894, device='cuda:3')
norm1 res is  tensor(0.1496, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.3857782781124115
distance 1 is tensor(146.4689, device='cuda:3')
benign distance is  tensor(146.4689, device='cuda:3')
norm1 res is  tensor(0.1591, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4180077016353607
distance 1 is tensor(146.0488, device='cuda:3')
benign distance is  tensor(146.0488, device='cuda:3')
norm1 res is  tensor(0.1568, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  1.016526222229004
distance 1 is tensor(163.0085, device='cuda:3')
benign distance is  tensor(163.0085, device='cuda:3')
norm1 res is  tensor(0.1751, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.2497093677520752
distance 1 is tensor(147.3638, device='cuda:3')
benign distance is  tensor(147.3638, device='cuda:3')
norm1 res is  tensor(0.1591, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.47459039092063904
distance 1 is tensor(160.7763, device='cuda:3')
benign distance is  tensor(160.7763, device='cuda:3')
norm1 res is  tensor(0.1728, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.24812594056129456
distance 1 is tensor(141.8333, device='cuda:3')
benign distance is  tensor(141.8333, device='cuda:3')
norm1 res is  tensor(0.1523, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.5107280015945435
distance 1 is tensor(144.3398, device='cuda:3')
benign distance is  tensor(144.3398, device='cuda:3')
norm1 res is  tensor(0.1592, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.4616727828979492
distance 1 is tensor(144.3403, device='cuda:3')
benign distance is  tensor(144.3403, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.534008800983429
distance 1 is tensor(142.3371, device='cuda:3')
benign distance is  tensor(142.3371, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.4626299738883972
distance 1 is tensor(151.6615, device='cuda:3')
benign distance is  tensor(151.6615, device='cuda:3')
norm1 res is  tensor(0.1665, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.4654936194419861
distance 1 is tensor(146.2659, device='cuda:3')
benign distance is  tensor(146.2659, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.2733191251754761
distance 1 is tensor(151.9367, device='cuda:3')
benign distance is  tensor(151.9367, device='cuda:3')
norm1 res is  tensor(0.1627, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.5588151216506958
distance 1 is tensor(128.9874, device='cuda:3')
benign distance is  tensor(128.9874, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.4312618374824524
distance 1 is tensor(137.4647, device='cuda:3')
benign distance is  tensor(137.4647, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.43375301361083984
distance 1 is tensor(149.8430, device='cuda:3')
benign distance is  tensor(149.8430, device='cuda:3')
norm1 res is  tensor(0.1610, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.7082613706588745
distance 1 is tensor(139.5138, device='cuda:3')
benign distance is  tensor(139.5138, device='cuda:3')
norm1 res is  tensor(0.1496, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.19975045323371887
distance 1 is tensor(142.1471, device='cuda:3')
benign distance is  tensor(142.1471, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.22962859272956848
distance 1 is tensor(144.8640, device='cuda:3')
benign distance is  tensor(144.8640, device='cuda:3')
norm1 res is  tensor(0.1566, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.22365979850292206
distance 1 is tensor(140.4537, device='cuda:3')
benign distance is  tensor(140.4537, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.13430944085121155
distance 1 is tensor(139.9454, device='cuda:3')
benign distance is  tensor(139.9454, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.40467995405197144
distance 1 is tensor(138.0005, device='cuda:3')
benign distance is  tensor(138.0005, device='cuda:3')
norm1 res is  tensor(0.1486, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.713884174823761
distance 1 is tensor(144.0313, device='cuda:3')
benign distance is  tensor(144.0313, device='cuda:3')
norm1 res is  tensor(0.1574, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.6623608469963074
distance 1 is tensor(165.0036, device='cuda:3')
benign distance is  tensor(165.0036, device='cuda:3')
norm1 res is  tensor(0.1757, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.2854922413825989
distance 1 is tensor(131.2217, device='cuda:3')
benign distance is  tensor(131.2217, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.5617223978042603
distance 1 is tensor(142.1134, device='cuda:3')
benign distance is  tensor(142.1134, device='cuda:3')
norm1 res is  tensor(0.1542, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.39746809005737305
distance 1 is tensor(149.7422, device='cuda:3')
benign distance is  tensor(149.7422, device='cuda:3')
norm1 res is  tensor(0.1627, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.21460381150245667
distance 1 is tensor(143.1765, device='cuda:3')
benign distance is  tensor(143.1765, device='cuda:3')
norm1 res is  tensor(0.1564, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(147.7521, device='cuda:3')
compute distance is  tensor(147.7521, device='cuda:3')
compute norm is  tensor(47.6232, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.6776, device='cuda:3')
compute distance is  tensor(155.6776, device='cuda:3')
compute norm is  tensor(47.7595, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(168.1968, device='cuda:3')
compute distance is  tensor(168.1968, device='cuda:3')
compute norm is  tensor(48.2498, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.5581, device='cuda:3')
compute distance is  tensor(147.5581, device='cuda:3')
compute norm is  tensor(47.6003, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(150.9554, device='cuda:3')
compute distance is  tensor(150.9554, device='cuda:3')
compute norm is  tensor(47.6678, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.3430, device='cuda:3')
compute distance is  tensor(148.3430, device='cuda:3')
compute norm is  tensor(47.6282, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.4452, device='cuda:3')
compute distance is  tensor(149.4452, device='cuda:3')
compute norm is  tensor(47.7945, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(163.5279, device='cuda:3')
compute distance is  tensor(163.5279, device='cuda:3')
compute norm is  tensor(47.9884, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.7264, device='cuda:3')
compute distance is  tensor(155.7264, device='cuda:3')
compute norm is  tensor(47.6999, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.4137, device='cuda:3')
compute distance is  tensor(143.4137, device='cuda:3')
compute norm is  tensor(47.4704, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(164.7215, device='cuda:3')
compute distance is  tensor(164.7215, device='cuda:3')
compute norm is  tensor(48.0037, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.3630, device='cuda:3')
compute distance is  tensor(158.3630, device='cuda:3')
compute norm is  tensor(47.8770, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(168.1968, device='cuda:3')
distance 1 is tensor(1869463.1250, device='cuda:3')
________________________________
test distance is  tensor(1869463.1250, device='cuda:3')
test similarity is  tensor(0.0010, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765537854328164e+18
test entropy is  0.0
________________________________
cal ratio is  0.009295579134292202
distance 1 is tensor(17377.7480, device='cuda:3')
cal_distance is  tensor(17377.7480, device='cuda:3')
cal ratio is  0.09641356977530521
distance 1 is tensor(1675.4568, device='cuda:3')
cal_distance is  tensor(1675.4568, device='cuda:3')
cal ratio is  0.310504782509906
distance 1 is tensor(520.2420, device='cuda:3')
cal_distance is  tensor(520.2420, device='cuda:3')
cal ratio is  0.5572270792769193
distance 1 is tensor(289.8959, device='cuda:3')
cal_distance is  tensor(289.8959, device='cuda:3')
cal ratio is  0.7464726037295556
distance 1 is tensor(216.4011, device='cuda:3')
cal_distance is  tensor(216.4011, device='cuda:3')
cal ratio is  0.8639830184306361
distance 1 is tensor(186.9678, device='cuda:3')
cal_distance is  tensor(186.9678, device='cuda:3')
cal ratio is  0.9295045924055303
distance 1 is tensor(173.7879, device='cuda:3')
cal_distance is  tensor(173.7879, device='cuda:3')
cal ratio is  0.9641067749070478
distance 1 is tensor(167.5503, device='cuda:3')
cal_distance is  tensor(167.5503, device='cuda:3')
distance 1 is tensor(167.5503, device='cuda:3')
________________________________
test distance is  tensor(167.5503, device='cuda:3')
test similarity is  tensor(0.9177, device='cuda:3')
test acc is  0.3192833334896731
test loss is 329.33494444239113
test entropy is  1.1542694057490995e-05
________________________________
distance 1 is tensor(167.5503, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9655751393762944e-06
avg test loss is  330.00262464185766
avg accuracy is  0.3171500001563398
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9177, device='cuda:3')
compute_distance is  tensor(167.5503, device='cuda:3')
compute_norm is  tensor(47.2045, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(146.8891, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9542245543333513
avg test loss is  1.5253686607519448
avg accuracy is  0.7526166668229943
solo acc is  0.28728333348967255
compute similarity  is  tensor(0.9224, device='cuda:3')
compute_distance is  tensor(146.8891, device='cuda:3')
compute_norm is  tensor(46.5083, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance 1 is tensor(146.8891, device='cuda:3')
________________________________
test distance is  tensor(146.8891, device='cuda:3')
test similarity is  tensor(0.9224, device='cuda:3')
test acc is  0.7537000001563277
test loss is 1.5243399345290178
test entropy is  0.9561980486170315
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.5138790607452393
mal norm is  tensor(822.6409, device='cuda:3')
distance 1 is tensor(146.8891, device='cuda:3')
mal distance is  tensor(146.8891, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(16.9478, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(493.2847, device='cuda:3')
part1 is  tensor(14.8781, device='cuda:3')
score : tensor(0.1320, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.6180, device='cuda:3')
part1 is  tensor(-12.0533, device='cuda:3')
score : tensor(-0.1373, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.9882, device='cuda:3')
part1 is  tensor(-10.2333, device='cuda:3')
score : tensor(-0.1191, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.7314, device='cuda:3')
part1 is  tensor(0.9427, device='cuda:3')
score : tensor(-0.0073, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(559.2269, device='cuda:3')
part1 is  tensor(-25.9175, device='cuda:3')
score : tensor(-0.2759, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(564.0135, device='cuda:3')
part1 is  tensor(-7.8408, device='cuda:3')
score : tensor(-0.0952, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.2599, device='cuda:3')
part1 is  tensor(-23.4208, device='cuda:3')
score : tensor(-0.2510, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.6606, device='cuda:3')
part1 is  tensor(-22.5089, device='cuda:3')
score : tensor(-0.2418, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.6409, device='cuda:3')
part1 is  tensor(-35.5140, device='cuda:3')
score : tensor(-0.3719, device='cuda:3')
len accept list 1
len all weights is 1
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.30% 

Test Accuracy: 87.91% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  0.0805743932723999
distance 1 is tensor(112.6388, device='cuda:3')
benign distance is  tensor(112.6388, device='cuda:3')
norm1 res is  tensor(0.1246, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6019463539123535
distance 1 is tensor(150.8273, device='cuda:3')
benign distance is  tensor(150.8273, device='cuda:3')
norm1 res is  tensor(0.1672, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3670511543750763
distance 1 is tensor(135.3481, device='cuda:3')
benign distance is  tensor(135.3481, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5003726482391357
distance 1 is tensor(131.7563, device='cuda:3')
benign distance is  tensor(131.7563, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7571889758110046
distance 1 is tensor(147.3304, device='cuda:3')
benign distance is  tensor(147.3304, device='cuda:3')
norm1 res is  tensor(0.1605, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8030511736869812
distance 1 is tensor(157.9072, device='cuda:3')
benign distance is  tensor(157.9072, device='cuda:3')
norm1 res is  tensor(0.1720, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3125697076320648
distance 1 is tensor(145.3956, device='cuda:3')
benign distance is  tensor(145.3956, device='cuda:3')
norm1 res is  tensor(0.1586, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3510783612728119
distance 1 is tensor(140.9604, device='cuda:3')
benign distance is  tensor(140.9604, device='cuda:3')
norm1 res is  tensor(0.1536, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(171.2863, device='cuda:3')
compute distance is  tensor(171.2863, device='cuda:3')
compute norm is  tensor(46.1557, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(170.7870, device='cuda:3')
compute distance is  tensor(170.7870, device='cuda:3')
compute norm is  tensor(46.1249, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(170.7502, device='cuda:3')
compute distance is  tensor(170.7502, device='cuda:3')
compute norm is  tensor(46.2239, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(153.7028, device='cuda:3')
compute distance is  tensor(153.7028, device='cuda:3')
compute norm is  tensor(45.7425, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(169.1943, device='cuda:3')
compute distance is  tensor(169.1943, device='cuda:3')
compute norm is  tensor(46.1772, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(186.5886, device='cuda:3')
compute distance is  tensor(186.5886, device='cuda:3')
compute norm is  tensor(46.9009, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(167.1402, device='cuda:3')
compute distance is  tensor(167.1402, device='cuda:3')
compute norm is  tensor(46.1333, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(167.1490, device='cuda:3')
compute distance is  tensor(167.1490, device='cuda:3')
compute norm is  tensor(46.0272, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(173.5275, device='cuda:3')
compute distance is  tensor(173.5275, device='cuda:3')
compute norm is  tensor(46.3292, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(170.3974, device='cuda:3')
compute distance is  tensor(170.3974, device='cuda:3')
compute norm is  tensor(46.1982, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(166.2014, device='cuda:3')
compute distance is  tensor(166.2014, device='cuda:3')
compute norm is  tensor(46.1859, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(169.9825, device='cuda:3')
compute distance is  tensor(169.9825, device='cuda:3')
compute norm is  tensor(46.0687, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(186.5886, device='cuda:3')
distance 1 is tensor(1869464.7500, device='cuda:3')
________________________________
test distance is  tensor(1869464.7500, device='cuda:3')
test similarity is  tensor(-0.0141, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.768376100588425e+18
test entropy is  0.0
________________________________
cal ratio is  0.009790616004637858
distance 1 is tensor(18303.2188, device='cuda:3')
cal_distance is  tensor(18303.2188, device='cuda:3')
cal ratio is  0.09894752009964028
distance 1 is tensor(1811.0642, device='cuda:3')
cal_distance is  tensor(1811.0642, device='cuda:3')
cal ratio is  0.3145587211111321
distance 1 is tensor(569.6906, device='cuda:3')
cal_distance is  tensor(569.6906, device='cuda:3')
cal ratio is  0.5608531023145801
distance 1 is tensor(319.5157, device='cuda:3')
cal_distance is  tensor(319.5157, device='cuda:3')
cal ratio is  0.7488978210076748
distance 1 is tensor(239.2863, device='cuda:3')
cal_distance is  tensor(239.2863, device='cuda:3')
cal ratio is  0.8653857178328086
distance 1 is tensor(207.0759, device='cuda:3')
cal_distance is  tensor(207.0759, device='cuda:3')
cal ratio is  0.9302589896756249
distance 1 is tensor(192.6347, device='cuda:3')
cal_distance is  tensor(192.6347, device='cuda:3')
cal ratio is  0.9644982173447377
distance 1 is tensor(185.7961, device='cuda:3')
cal_distance is  tensor(185.7961, device='cuda:3')
distance 1 is tensor(185.7961, device='cuda:3')
________________________________
test distance is  tensor(185.7961, device='cuda:3')
test similarity is  tensor(0.9049, device='cuda:3')
test acc is  0.3069166668230063
test loss is 537.6828580095823
test entropy is  1.0801820038806527e-05
________________________________
distance 1 is tensor(185.7961, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6494591042917618e-09
avg test loss is  537.2053027122514
avg accuracy is  0.30795000015633966
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9049, device='cuda:3')
compute_distance is  tensor(185.7961, device='cuda:3')
compute_norm is  tensor(48.4653, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(166.8981, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9805856575843876
avg test loss is  1.6445606959654069
avg accuracy is  0.7665833334896603
solo acc is  0.2850666668230059
compute similarity  is  tensor(0.9103, device='cuda:3')
compute_distance is  tensor(166.8981, device='cuda:3')
compute_norm is  tensor(48.2029, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance 1 is tensor(166.8981, device='cuda:3')
________________________________
test distance is  tensor(166.8981, device='cuda:3')
test similarity is  tensor(0.9103, device='cuda:3')
test acc is  0.7650500001563271
test loss is 1.645774561713245
test entropy is  0.9798841564131698
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.631882905960083
mal norm is  tensor(915.6926, device='cuda:3')
distance 1 is tensor(166.8981, device='cuda:3')
mal distance is  tensor(166.8981, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(19.2110, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(490.2168, device='cuda:3')
part1 is  tensor(42.1873, device='cuda:3')
score : tensor(0.4029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.2797, device='cuda:3')
part1 is  tensor(45.2847, device='cuda:3')
score : tensor(0.4338, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.4785, device='cuda:3')
part1 is  tensor(20.8745, device='cuda:3')
score : tensor(0.1897, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(557.3871, device='cuda:3')
part1 is  tensor(34.0619, device='cuda:3')
score : tensor(0.3216, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.0532, device='cuda:3')
part1 is  tensor(-30.1312, device='cuda:3')
score : tensor(-0.3203, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(680.7006, device='cuda:3')
part1 is  tensor(-9.7107, device='cuda:3')
score : tensor(-0.1161, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(628.2666, device='cuda:3')
part1 is  tensor(47.3999, device='cuda:3')
score : tensor(0.4550, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(606.5071, device='cuda:3')
part1 is  tensor(41.6071, device='cuda:3')
score : tensor(0.3971, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(915.6926, device='cuda:3')
part1 is  tensor(-110.6825, device='cuda:3')
score : tensor(-1.1258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(764.8666, device='cuda:3')
part1 is  tensor(55.5641, device='cuda:3')
score : tensor(0.5366, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.0474, device='cuda:3')
part1 is  tensor(29.9656, device='cuda:3')
score : tensor(0.2806, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(710.1048, device='cuda:3')
part1 is  tensor(12.2762, device='cuda:3')
score : tensor(0.1038, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.9898, device='cuda:3')
part1 is  tensor(7.7693, device='cuda:3')
score : tensor(0.0587, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.7292, device='cuda:3')
part1 is  tensor(14.0262, device='cuda:3')
score : tensor(0.1213, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(735.3300, device='cuda:3')
part1 is  tensor(54.3970, device='cuda:3')
score : tensor(0.5250, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(730.9680, device='cuda:3')
part1 is  tensor(73.1006, device='cuda:3')
score : tensor(0.7120, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(792.8026, device='cuda:3')
part1 is  tensor(13.0055, device='cuda:3')
score : tensor(0.1110, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 88.87% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1532401442527771
distance 1 is tensor(67.1029, device='cuda:3')
benign distance is  tensor(67.1029, device='cuda:3')
norm1 res is  tensor(0.0738, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5487944483757019
distance 1 is tensor(126.3511, device='cuda:3')
benign distance is  tensor(126.3511, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.537406325340271
distance 1 is tensor(128.7736, device='cuda:3')
benign distance is  tensor(128.7736, device='cuda:3')
norm1 res is  tensor(0.1433, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.46342238783836365
distance 1 is tensor(94.4032, device='cuda:3')
benign distance is  tensor(94.4032, device='cuda:3')
norm1 res is  tensor(0.1045, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.34845346212387085
distance 1 is tensor(124.6044, device='cuda:3')
benign distance is  tensor(124.6044, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8400774002075195
distance 1 is tensor(119.8609, device='cuda:3')
benign distance is  tensor(119.8609, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.12631766498088837
distance 1 is tensor(124.2465, device='cuda:3')
benign distance is  tensor(124.2465, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1682722270488739
distance 1 is tensor(120.3325, device='cuda:3')
benign distance is  tensor(120.3325, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.2803940773010254
distance 1 is tensor(126.2473, device='cuda:3')
benign distance is  tensor(126.2473, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.22341148555278778
distance 1 is tensor(135.9474, device='cuda:3')
benign distance is  tensor(135.9474, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.33773407340049744
distance 1 is tensor(134.5420, device='cuda:3')
benign distance is  tensor(134.5420, device='cuda:3')
norm1 res is  tensor(0.1471, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.7519343495368958
distance 1 is tensor(125.0954, device='cuda:3')
benign distance is  tensor(125.0954, device='cuda:3')
norm1 res is  tensor(0.1394, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.24040040373802185
distance 1 is tensor(130.2514, device='cuda:3')
benign distance is  tensor(130.2514, device='cuda:3')
norm1 res is  tensor(0.1440, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.21321740746498108
distance 1 is tensor(125.0615, device='cuda:3')
benign distance is  tensor(125.0615, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.26260218024253845
distance 1 is tensor(137.8173, device='cuda:3')
benign distance is  tensor(137.8173, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.41535186767578125
distance 1 is tensor(121.2178, device='cuda:3')
benign distance is  tensor(121.2178, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(146.1550, device='cuda:3')
compute distance is  tensor(146.1550, device='cuda:3')
compute norm is  tensor(46.6815, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(144.2753, device='cuda:3')
compute distance is  tensor(144.2753, device='cuda:3')
compute norm is  tensor(46.6651, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(156.0668, device='cuda:3')
compute distance is  tensor(156.0668, device='cuda:3')
compute norm is  tensor(47.2780, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.7586, device='cuda:3')
compute distance is  tensor(149.7586, device='cuda:3')
compute norm is  tensor(46.8269, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.4366, device='cuda:3')
compute distance is  tensor(147.4366, device='cuda:3')
compute norm is  tensor(46.8637, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(151.7960, device='cuda:3')
compute distance is  tensor(151.7960, device='cuda:3')
compute norm is  tensor(47.0187, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.8903, device='cuda:3')
compute distance is  tensor(142.8903, device='cuda:3')
compute norm is  tensor(46.7775, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(151.9055, device='cuda:3')
compute distance is  tensor(151.9055, device='cuda:3')
compute norm is  tensor(46.8944, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.8687, device='cuda:3')
compute distance is  tensor(154.8687, device='cuda:3')
compute norm is  tensor(46.9329, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(139.5250, device='cuda:3')
compute distance is  tensor(139.5250, device='cuda:3')
compute norm is  tensor(46.7332, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(145.3481, device='cuda:3')
compute distance is  tensor(145.3481, device='cuda:3')
compute norm is  tensor(46.7222, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.4441, device='cuda:3')
compute distance is  tensor(148.4441, device='cuda:3')
compute norm is  tensor(46.8111, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(156.0668, device='cuda:3')
distance 1 is tensor(1869471.6250, device='cuda:3')
________________________________
test distance is  tensor(1869471.6250, device='cuda:3')
test similarity is  tensor(-0.0265, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.764978199393064e+18
test entropy is  0.0
________________________________
cal ratio is  0.00895409795714959
distance 1 is tensor(16739.4395, device='cuda:3')
cal_distance is  tensor(16739.4395, device='cuda:3')
cal ratio is  0.09462607257052782
distance 1 is tensor(1583.9932, device='cuda:3')
cal_distance is  tensor(1583.9932, device='cuda:3')
cal ratio is  0.3076129563104188
distance 1 is tensor(487.2615, device='cuda:3')
cal_distance is  tensor(487.2615, device='cuda:3')
cal ratio is  0.5546260065835206
distance 1 is tensor(270.2509, device='cuda:3')
cal_distance is  tensor(270.2509, device='cuda:3')
cal ratio is  0.7447280198990122
distance 1 is tensor(201.2652, device='cuda:3')
cal_distance is  tensor(201.2652, device='cuda:3')
cal ratio is  0.8629725493140766
distance 1 is tensor(173.6872, device='cuda:3')
cal_distance is  tensor(173.6872, device='cuda:3')
cal ratio is  0.9289606920848146
distance 1 is tensor(161.3491, device='cuda:3')
cal_distance is  tensor(161.3491, device='cuda:3')
cal ratio is  0.9638245813354545
distance 1 is tensor(155.5125, device='cuda:3')
cal_distance is  tensor(155.5125, device='cuda:3')
distance 1 is tensor(155.5125, device='cuda:3')
________________________________
test distance is  tensor(155.5125, device='cuda:3')
test similarity is  tensor(0.9291, device='cuda:3')
test acc is  0.6622000001563331
test loss is 215.42427259823407
test entropy is  0.000167441815977
________________________________
distance 1 is tensor(155.5125, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00018740910895574932
avg test loss is  215.39261695520202
avg accuracy is  0.6638000001563329
solo acc is  0.10045000015633199
compute similarity  is  tensor(0.9291, device='cuda:3')
compute_distance is  tensor(155.5125, device='cuda:3')
compute_norm is  tensor(47.3170, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(139.0955, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9331726082352433
avg test loss is  1.4698752776137802
avg accuracy is  0.8250000001563244
solo acc is  0.3118500001563398
compute similarity  is  tensor(0.9321, device='cuda:3')
compute_distance is  tensor(139.0955, device='cuda:3')
compute_norm is  tensor(46.5198, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.5240, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8895670590497283
avg test loss is  1.5722390164190263
avg accuracy is  0.8188333334896579
solo acc is  0.2399666668230046
compute similarity  is  tensor(0.9318, device='cuda:3')
compute_distance is  tensor(140.5240, device='cuda:3')
compute_norm is  tensor(46.2441, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.6436, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8932879529019663
avg test loss is  1.5043459830761972
avg accuracy is  0.8252333334896577
solo acc is  0.25161666682300504
compute similarity  is  tensor(0.9317, device='cuda:3')
compute_distance is  tensor(141.6436, device='cuda:3')
compute_norm is  tensor(45.9766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.6684, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8812001282726524
avg test loss is  1.4800443757317467
avg accuracy is  0.8249500001563244
solo acc is  0.2502500001563383
compute similarity  is  tensor(0.9315, device='cuda:3')
compute_distance is  tensor(142.6684, device='cuda:3')
compute_norm is  tensor(45.7188, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.7313, device='cuda:3')
________________________________
test distance is  tensor(143.7313, device='cuda:3')
test similarity is  tensor(0.9314, device='cuda:3')
test acc is  0.8273500001563242
test loss is 1.4577715738749961
test entropy is  0.8719377315629011
________________________________
distance 1 is tensor(143.7313, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8717291254732908
avg test loss is  1.4593750284170546
avg accuracy is  0.828900000156324
solo acc is  0.2517333334896716
compute similarity  is  tensor(0.9314, device='cuda:3')
compute_distance is  tensor(143.7313, device='cuda:3')
compute_norm is  tensor(45.4674, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.8386, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8568432857232816
avg test loss is  1.440015702740724
avg accuracy is  0.8300333334896574
solo acc is  0.2543000001563384
compute similarity  is  tensor(0.9312, device='cuda:3')
compute_distance is  tensor(144.8386, device='cuda:3')
compute_norm is  tensor(45.2223, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.8807, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8559003267079782
avg test loss is  1.4296577959172507
avg accuracy is  0.8324166668229906
solo acc is  0.2499000001563383
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(145.8807, device='cuda:3')
compute_norm is  tensor(44.9819, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.9547, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8554977608769179
avg test loss is  1.4171528556962003
avg accuracy is  0.8319833334896573
solo acc is  0.2472833334896716
compute similarity  is  tensor(0.9309, device='cuda:3')
compute_distance is  tensor(146.9547, device='cuda:3')
compute_norm is  tensor(44.7451, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.0666, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8435495799538423
avg test loss is  1.4113423976816857
avg accuracy is  0.8341500001563241
solo acc is  0.24605000015633813
compute similarity  is  tensor(0.9308, device='cuda:3')
compute_distance is  tensor(148.0666, device='cuda:3')
compute_norm is  tensor(44.5129, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.1750, device='cuda:3')
________________________________
test distance is  tensor(149.1750, device='cuda:3')
test similarity is  tensor(0.9306, device='cuda:3')
test acc is  0.8365500001563239
test loss is 1.3936968197954742
test entropy is  0.8470114995040365
________________________________
distance 1 is tensor(149.1750, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8483257392194988
avg test loss is  1.397485490546806
avg accuracy is  0.8364333334896572
solo acc is  0.24243333348967142
compute similarity  is  tensor(0.9306, device='cuda:3')
compute_distance is  tensor(149.1750, device='cuda:3')
compute_norm is  tensor(44.2835, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.3417, device='cuda:3')
exit early
distance 1 is tensor(150.3417, device='cuda:3')
________________________________
test distance is  tensor(150.3417, device='cuda:3')
test similarity is  tensor(0.9305, device='cuda:3')
test acc is  0.8377833334896572
test loss is 1.394864268013155
test entropy is  0.8383908849408124
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1017825603485107
mal norm is  tensor(753.7347, device='cuda:3')
distance 1 is tensor(150.3417, device='cuda:3')
mal distance is  tensor(150.3417, device='cuda:3')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(23.8411, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(292.8855, device='cuda:3')
part1 is  tensor(30.6511, device='cuda:3')
score : tensor(0.2829, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.3608, device='cuda:3')
part1 is  tensor(-13.3312, device='cuda:3')
score : tensor(-0.1570, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(565.6133, device='cuda:3')
part1 is  tensor(55.5432, device='cuda:3')
score : tensor(0.5318, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(403.3199, device='cuda:3')
part1 is  tensor(6.7724, device='cuda:3')
score : tensor(0.0441, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.4627, device='cuda:3')
part1 is  tensor(-31.3652, device='cuda:3')
score : tensor(-0.3373, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.7495, device='cuda:3')
part1 is  tensor(-33.6544, device='cuda:3')
score : tensor(-0.3602, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(520.9321, device='cuda:3')
part1 is  tensor(54.8071, device='cuda:3')
score : tensor(0.5244, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.7651, device='cuda:3')
part1 is  tensor(21.1220, device='cuda:3')
score : tensor(0.1876, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(753.7347, device='cuda:3')
part1 is  tensor(-88.7440, device='cuda:3')
score : tensor(-0.9111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.7173, device='cuda:3')
part1 is  tensor(9.6295, device='cuda:3')
score : tensor(0.0727, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.9514, device='cuda:3')
part1 is  tensor(51.8862, device='cuda:3')
score : tensor(0.4952, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.5588, device='cuda:3')
part1 is  tensor(11.2995, device='cuda:3')
score : tensor(0.0894, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.6542, device='cuda:3')
part1 is  tensor(99.0560, device='cuda:3')
score : tensor(0.9669, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(675.1678, device='cuda:3')
part1 is  tensor(75.1684, device='cuda:3')
score : tensor(0.7280, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.1561, device='cuda:3')
part1 is  tensor(31.8857, device='cuda:3')
score : tensor(0.2952, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.5438, device='cuda:3')
part1 is  tensor(-14.3206, device='cuda:3')
score : tensor(-0.1668, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.2928, device='cuda:3')
part1 is  tensor(35.8657, device='cuda:3')
score : tensor(0.3350, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(662.6589, device='cuda:3')
part1 is  tensor(11.0700, device='cuda:3')
score : tensor(0.0871, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(712.1680, device='cuda:3')
part1 is  tensor(17.5680, device='cuda:3')
score : tensor(0.1520, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.5667, device='cuda:3')
part1 is  tensor(-16.8498, device='cuda:3')
score : tensor(-0.1921, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.3718, device='cuda:3')
part1 is  tensor(65.4463, device='cuda:3')
score : tensor(0.6308, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.8478, device='cuda:3')
part1 is  tensor(1.4110, device='cuda:3')
score : tensor(-0.0095, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.5557, device='cuda:3')
part1 is  tensor(-6.7355, device='cuda:3')
score : tensor(-0.0910, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.9571, device='cuda:3')
part1 is  tensor(-17.9881, device='cuda:3')
score : tensor(-0.2035, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(652.9009, device='cuda:3')
part1 is  tensor(-8.9084, device='cuda:3')
score : tensor(-0.1127, device='cuda:3')
len accept list 15
len all weights is 15
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.70% 

Test Accuracy: 89.22% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  0.230914905667305
distance 1 is tensor(84.0875, device='cuda:3')
benign distance is  tensor(84.0875, device='cuda:3')
norm1 res is  tensor(0.0926, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.6782642602920532
distance 1 is tensor(121.5266, device='cuda:3')
benign distance is  tensor(121.5266, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.046457502990961075
distance 1 is tensor(93.2709, device='cuda:3')
benign distance is  tensor(93.2709, device='cuda:3')
norm1 res is  tensor(0.1058, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6378976106643677
distance 1 is tensor(96.2662, device='cuda:3')
benign distance is  tensor(96.2662, device='cuda:3')
norm1 res is  tensor(0.1077, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.26976457238197327
distance 1 is tensor(104.2028, device='cuda:3')
benign distance is  tensor(104.2028, device='cuda:3')
norm1 res is  tensor(0.1158, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.21482448279857635
distance 1 is tensor(125.5335, device='cuda:3')
benign distance is  tensor(125.5335, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.14367268979549408
distance 1 is tensor(99.5176, device='cuda:3')
benign distance is  tensor(99.5176, device='cuda:3')
norm1 res is  tensor(0.1082, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3304939866065979
distance 1 is tensor(111.7482, device='cuda:3')
benign distance is  tensor(111.7482, device='cuda:3')
norm1 res is  tensor(0.1270, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.3264700770378113
distance 1 is tensor(134.7339, device='cuda:3')
benign distance is  tensor(134.7339, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.7396361231803894
distance 1 is tensor(144.5192, device='cuda:3')
benign distance is  tensor(144.5192, device='cuda:3')
norm1 res is  tensor(0.1596, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.1311996877193451
distance 1 is tensor(126.0122, device='cuda:3')
benign distance is  tensor(126.0122, device='cuda:3')
norm1 res is  tensor(0.1411, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.4710046648979187
distance 1 is tensor(120.3486, device='cuda:3')
benign distance is  tensor(120.3486, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.24117979407310486
distance 1 is tensor(131.2077, device='cuda:3')
benign distance is  tensor(131.2077, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5761741399765015
distance 1 is tensor(129.6369, device='cuda:3')
benign distance is  tensor(129.6369, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.26560837030410767
distance 1 is tensor(141.2862, device='cuda:3')
benign distance is  tensor(141.2862, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.28987765312194824
distance 1 is tensor(130.3807, device='cuda:3')
benign distance is  tensor(130.3807, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.34133899211883545
distance 1 is tensor(128.4951, device='cuda:3')
benign distance is  tensor(128.4951, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.27223020792007446
distance 1 is tensor(127.3995, device='cuda:3')
benign distance is  tensor(127.3995, device='cuda:3')
norm1 res is  tensor(0.1432, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.526138186454773
distance 1 is tensor(138.7972, device='cuda:3')
benign distance is  tensor(138.7972, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.17655615508556366
distance 1 is tensor(125.4449, device='cuda:3')
benign distance is  tensor(125.4449, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.25817155838012695
distance 1 is tensor(128.3762, device='cuda:3')
benign distance is  tensor(128.3762, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.31311312317848206
distance 1 is tensor(129.7785, device='cuda:3')
benign distance is  tensor(129.7785, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.3238953948020935
distance 1 is tensor(118.0817, device='cuda:3')
benign distance is  tensor(118.0817, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.04243426397442818
distance 1 is tensor(132.2337, device='cuda:3')
benign distance is  tensor(132.2337, device='cuda:3')
norm1 res is  tensor(0.1453, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(140.1984, device='cuda:3')
compute distance is  tensor(140.1984, device='cuda:3')
compute norm is  tensor(47.0880, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(124.9612, device='cuda:3')
compute distance is  tensor(124.9612, device='cuda:3')
compute norm is  tensor(46.8107, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(132.6368, device='cuda:3')
compute distance is  tensor(132.6368, device='cuda:3')
compute norm is  tensor(47.0535, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.8876, device='cuda:3')
compute distance is  tensor(134.8876, device='cuda:3')
compute norm is  tensor(47.2195, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(126.9990, device='cuda:3')
compute distance is  tensor(126.9990, device='cuda:3')
compute norm is  tensor(46.7829, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(131.9424, device='cuda:3')
compute distance is  tensor(131.9424, device='cuda:3')
compute norm is  tensor(46.9826, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(127.2915, device='cuda:3')
compute distance is  tensor(127.2915, device='cuda:3')
compute norm is  tensor(46.9716, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(130.5548, device='cuda:3')
compute distance is  tensor(130.5548, device='cuda:3')
compute norm is  tensor(47.0285, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(133.6778, device='cuda:3')
compute distance is  tensor(133.6778, device='cuda:3')
compute norm is  tensor(47.0963, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(128.0691, device='cuda:3')
compute distance is  tensor(128.0691, device='cuda:3')
compute norm is  tensor(46.9106, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(144.3764, device='cuda:3')
compute distance is  tensor(144.3764, device='cuda:3')
compute norm is  tensor(47.3819, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(131.4708, device='cuda:3')
compute distance is  tensor(131.4708, device='cuda:3')
compute norm is  tensor(46.9382, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.3764, device='cuda:3')
distance 1 is tensor(1869478.6250, device='cuda:3')
________________________________
test distance is  tensor(1869478.6250, device='cuda:3')
test similarity is  tensor(-0.0536, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766416630791353e+18
test entropy is  0.0
________________________________
cal ratio is  0.008612195275974316
distance 1 is tensor(16100.3213, device='cuda:3')
cal_distance is  tensor(16100.3213, device='cuda:3')
cal ratio is  0.0928018975262793
distance 1 is tensor(1494.1466, device='cuda:3')
cal_distance is  tensor(1494.1466, device='cuda:3')
cal ratio is  0.30463339490029934
distance 1 is tensor(455.1716, device='cuda:3')
cal_distance is  tensor(455.1716, device='cuda:3')
cal ratio is  0.5519332111651191
distance 1 is tensor(251.2273, device='cuda:3')
cal_distance is  tensor(251.2273, device='cuda:3')
cal ratio is  0.742917622456673
distance 1 is tensor(186.6430, device='cuda:3')
cal_distance is  tensor(186.6430, device='cuda:3')
cal ratio is  0.8619226416379778
distance 1 is tensor(160.8727, device='cuda:3')
cal_distance is  tensor(160.8727, device='cuda:3')
cal ratio is  0.9283952008745217
distance 1 is tensor(149.3539, device='cuda:3')
cal_distance is  tensor(149.3539, device='cuda:3')
cal ratio is  0.963531165629033
distance 1 is tensor(143.9074, device='cuda:3')
cal_distance is  tensor(143.9074, device='cuda:3')
distance 1 is tensor(143.9074, device='cuda:3')
________________________________
test distance is  tensor(143.9074, device='cuda:3')
test similarity is  tensor(0.9375, device='cuda:3')
test acc is  0.7774666668229931
test loss is 150.58268930561252
test entropy is  0.0012088408906210364
________________________________
distance 1 is tensor(143.9074, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0012537400742730414
avg test loss is  150.3949516312654
avg accuracy is  0.7780166668229932
solo acc is  0.1052333334896653
compute similarity  is  tensor(0.9375, device='cuda:3')
compute_distance is  tensor(143.9074, device='cuda:3')
compute_norm is  tensor(46.9051, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(129.9948, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.90951635893474
avg test loss is  1.4824954395863548
avg accuracy is  0.8443833334896569
solo acc is  0.311583333489673
compute similarity  is  tensor(0.9398, device='cuda:3')
compute_distance is  tensor(129.9948, device='cuda:3')
compute_norm is  tensor(45.9507, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.7471, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8730280119727161
avg test loss is  1.5350872257879293
avg accuracy is  0.843033333489657
solo acc is  0.26166666682300527
compute similarity  is  tensor(0.9394, device='cuda:3')
compute_distance is  tensor(131.7471, device='cuda:3')
compute_norm is  tensor(45.6591, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.2055, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.869219566395542
avg test loss is  1.5094537231713725
avg accuracy is  0.8453333334896568
solo acc is  0.2533500001563384
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(133.2055, device='cuda:3')
compute_norm is  tensor(45.3857, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.5677, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8628448306370392
avg test loss is  1.4676998263991463
avg accuracy is  0.84761666682299
solo acc is  0.25880000015633847
compute similarity  is  tensor(0.9390, device='cuda:3')
compute_distance is  tensor(134.5677, device='cuda:3')
compute_norm is  tensor(45.1199, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.8727, device='cuda:3')
________________________________
test distance is  tensor(135.8727, device='cuda:3')
test similarity is  tensor(0.9388, device='cuda:3')
test acc is  0.8488500001563234
test loss is 1.4535131479885532
test entropy is  0.8519941125470184
________________________________
distance 1 is tensor(135.8727, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8536904153030819
avg test loss is  1.4483335452801638
avg accuracy is  0.8483000001563233
solo acc is  0.2570500001563385
compute similarity  is  tensor(0.9388, device='cuda:3')
compute_distance is  tensor(135.8727, device='cuda:3')
compute_norm is  tensor(44.8656, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.2229, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8410264270137876
avg test loss is  1.4412112364382632
avg accuracy is  0.8507333334896565
solo acc is  0.2530333334896717
compute similarity  is  tensor(0.9386, device='cuda:3')
compute_distance is  tensor(137.2229, device='cuda:3')
compute_norm is  tensor(44.6175, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.5409, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8488497542165744
avg test loss is  1.4128052174155392
avg accuracy is  0.8523833334896566
solo acc is  0.2542333334896717
compute similarity  is  tensor(0.9384, device='cuda:3')
compute_distance is  tensor(138.5409, device='cuda:3')
compute_norm is  tensor(44.3736, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.8763, device='cuda:3')
exit early
distance 1 is tensor(139.8763, device='cuda:3')
________________________________
test distance is  tensor(139.8763, device='cuda:3')
test similarity is  tensor(0.9381, device='cuda:3')
test acc is  0.8542666668229899
test loss is 1.415201492528163
test entropy is  0.8399235111818131
________________________________
distance 1 is tensor(139.8763, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8409686542904453
avg test loss is  1.414279950580109
avg accuracy is  0.8532666668229898
solo acc is  0.24461666682300479
compute similarity  is  tensor(0.9381, device='cuda:3')
compute_distance is  tensor(139.8763, device='cuda:3')
compute_norm is  tensor(44.1341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.2732, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8403799495717356
avg test loss is  1.3895276490050847
avg accuracy is  0.8556500001563231
solo acc is  0.25068333348967164
compute similarity  is  tensor(0.9379, device='cuda:3')
compute_distance is  tensor(141.2732, device='cuda:3')
compute_norm is  tensor(43.8990, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.6635, device='cuda:3')
exit early
distance 1 is tensor(142.6635, device='cuda:3')
________________________________
test distance is  tensor(142.6635, device='cuda:3')
test similarity is  tensor(0.9377, device='cuda:3')
test acc is  0.8571333334896563
test loss is 1.3846598549692362
test entropy is  0.8392433106645084
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.306820273399353
mal norm is  tensor(709.6516, device='cuda:3')
distance 1 is tensor(142.6635, device='cuda:3')
mal distance is  tensor(142.6635, device='cuda:3')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(11.8437, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(364.7533, device='cuda:3')
part1 is  tensor(8.2467, device='cuda:3')
score : tensor(0.0708, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(534.7828, device='cuda:3')
part1 is  tensor(-14.6732, device='cuda:3')
score : tensor(-0.1584, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(416.5381, device='cuda:3')
part1 is  tensor(24.0448, device='cuda:3')
score : tensor(0.2288, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.3362, device='cuda:3')
part1 is  tensor(-20.4426, device='cuda:3')
score : tensor(-0.2161, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(452.8600, device='cuda:3')
part1 is  tensor(1.8058, device='cuda:3')
score : tensor(0.0064, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(549.8535, device='cuda:3')
part1 is  tensor(-6.0245, device='cuda:3')
score : tensor(-0.0719, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(427.2154, device='cuda:3')
part1 is  tensor(5.4621, device='cuda:3')
score : tensor(0.0430, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.0406, device='cuda:3')
part1 is  tensor(-6.2078, device='cuda:3')
score : tensor(-0.0737, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(709.6516, device='cuda:3')
part1 is  tensor(0.1255, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.0724, device='cuda:3')
part1 is  tensor(9.1828, device='cuda:3')
score : tensor(0.0802, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.8107, device='cuda:3')
part1 is  tensor(-3.5807, device='cuda:3')
score : tensor(-0.0475, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(617.7211, device='cuda:3')
part1 is  tensor(6.0395, device='cuda:3')
score : tensor(0.0488, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(654.1087, device='cuda:3')
part1 is  tensor(3.0875, device='cuda:3')
score : tensor(0.0192, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.1010, device='cuda:3')
part1 is  tensor(-6.1842, device='cuda:3')
score : tensor(-0.0735, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.8511, device='cuda:3')
part1 is  tensor(2.0479, device='cuda:3')
score : tensor(0.0088, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.7372, device='cuda:3')
part1 is  tensor(0.7015, device='cuda:3')
score : tensor(-0.0046, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.1921, device='cuda:3')
part1 is  tensor(8.1511, device='cuda:3')
score : tensor(0.0699, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.9566, device='cuda:3')
part1 is  tensor(-2.9738, device='cuda:3')
score : tensor(-0.0414, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.3920, device='cuda:3')
part1 is  tensor(-4.4925, device='cuda:3')
score : tensor(-0.0566, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.4166, device='cuda:3')
part1 is  tensor(6.2979, device='cuda:3')
score : tensor(0.0513, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.3657, device='cuda:3')
part1 is  tensor(-10.3830, device='cuda:3')
score : tensor(-0.1155, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(597.0936, device='cuda:3')
part1 is  tensor(-8.7644, device='cuda:3')
score : tensor(-0.0993, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.0107, device='cuda:3')
part1 is  tensor(9.8089, device='cuda:3')
score : tensor(0.0864, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.3029, device='cuda:3')
part1 is  tensor(-9.4048, device='cuda:3')
score : tensor(-0.1057, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(563.9988, device='cuda:3')
part1 is  tensor(-8.4393, device='cuda:3')
score : tensor(-0.0960, device='cuda:3')
len accept list 11
len all weights is 11
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 90.06% 

Test Accuracy: 89.07% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  0.18657059967517853
distance 1 is tensor(88.1684, device='cuda:3')
benign distance is  tensor(88.1684, device='cuda:3')
norm1 res is  tensor(0.0981, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.30863747000694275
distance 1 is tensor(124.6383, device='cuda:3')
benign distance is  tensor(124.6383, device='cuda:3')
norm1 res is  tensor(0.1371, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3672141134738922
distance 1 is tensor(108.0097, device='cuda:3')
benign distance is  tensor(108.0097, device='cuda:3')
norm1 res is  tensor(0.1190, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3068890869617462
distance 1 is tensor(103.6837, device='cuda:3')
benign distance is  tensor(103.6837, device='cuda:3')
norm1 res is  tensor(0.1148, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.27630847692489624
distance 1 is tensor(118.7919, device='cuda:3')
benign distance is  tensor(118.7919, device='cuda:3')
norm1 res is  tensor(0.1312, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4995696544647217
distance 1 is tensor(117.0612, device='cuda:3')
benign distance is  tensor(117.0612, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.8215837478637695
distance 1 is tensor(97.3081, device='cuda:3')
benign distance is  tensor(97.3081, device='cuda:3')
norm1 res is  tensor(0.1074, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.4200151860713959
distance 1 is tensor(122.0771, device='cuda:3')
benign distance is  tensor(122.0771, device='cuda:3')
norm1 res is  tensor(0.1371, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.23810406029224396
distance 1 is tensor(135.9147, device='cuda:3')
benign distance is  tensor(135.9147, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.4554682672023773
distance 1 is tensor(122.9894, device='cuda:3')
benign distance is  tensor(122.9894, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.42928487062454224
distance 1 is tensor(130.2336, device='cuda:3')
benign distance is  tensor(130.2336, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6770113706588745
distance 1 is tensor(139.1415, device='cuda:3')
benign distance is  tensor(139.1415, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.4561270773410797
distance 1 is tensor(130.8449, device='cuda:3')
benign distance is  tensor(130.8449, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.1348266452550888
distance 1 is tensor(123.3847, device='cuda:3')
benign distance is  tensor(123.3847, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.11917594820261002
distance 1 is tensor(139.3297, device='cuda:3')
benign distance is  tensor(139.3297, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.15658147633075714
distance 1 is tensor(137.0742, device='cuda:3')
benign distance is  tensor(137.0742, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.13075420260429382
distance 1 is tensor(131.1971, device='cuda:3')
benign distance is  tensor(131.1971, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.28717976808547974
distance 1 is tensor(128.0687, device='cuda:3')
benign distance is  tensor(128.0687, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.08919628709554672
distance 1 is tensor(146.8893, device='cuda:3')
benign distance is  tensor(146.8893, device='cuda:3')
norm1 res is  tensor(0.1634, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.16704371571540833
distance 1 is tensor(143.9332, device='cuda:3')
benign distance is  tensor(143.9332, device='cuda:3')
norm1 res is  tensor(0.1572, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.43166589736938477
distance 1 is tensor(136.6102, device='cuda:3')
benign distance is  tensor(136.6102, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.17226368188858032
distance 1 is tensor(126.7644, device='cuda:3')
benign distance is  tensor(126.7644, device='cuda:3')
norm1 res is  tensor(0.1404, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.08493612706661224
distance 1 is tensor(131.0392, device='cuda:3')
benign distance is  tensor(131.0392, device='cuda:3')
norm1 res is  tensor(0.1449, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.20040234923362732
distance 1 is tensor(126.7065, device='cuda:3')
benign distance is  tensor(126.7065, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(147.0456, device='cuda:3')
compute distance is  tensor(147.0456, device='cuda:3')
compute norm is  tensor(47.7539, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(145.5317, device='cuda:3')
compute distance is  tensor(145.5317, device='cuda:3')
compute norm is  tensor(47.8990, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(151.9645, device='cuda:3')
compute distance is  tensor(151.9645, device='cuda:3')
compute norm is  tensor(48.0463, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(136.6144, device='cuda:3')
compute distance is  tensor(136.6144, device='cuda:3')
compute norm is  tensor(47.6490, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.2514, device='cuda:3')
compute distance is  tensor(148.2514, device='cuda:3')
compute norm is  tensor(47.9236, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(160.8737, device='cuda:3')
compute distance is  tensor(160.8737, device='cuda:3')
compute norm is  tensor(48.2542, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.0170, device='cuda:3')
compute distance is  tensor(147.0170, device='cuda:3')
compute norm is  tensor(47.7846, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.2834, device='cuda:3')
compute distance is  tensor(147.2834, device='cuda:3')
compute norm is  tensor(47.8182, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.1427, device='cuda:3')
compute distance is  tensor(152.1427, device='cuda:3')
compute norm is  tensor(47.9837, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.4281, device='cuda:3')
compute distance is  tensor(152.4281, device='cuda:3')
compute norm is  tensor(48.1486, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.0475, device='cuda:3')
compute distance is  tensor(148.0475, device='cuda:3')
compute norm is  tensor(47.9865, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.3612, device='cuda:3')
compute distance is  tensor(149.3612, device='cuda:3')
compute norm is  tensor(47.8965, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(160.8737, device='cuda:3')
distance 1 is tensor(1869475.6250, device='cuda:3')
________________________________
test distance is  tensor(1869475.6250, device='cuda:3')
test similarity is  tensor(-0.0406, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.767406533535025e+18
test entropy is  0.0
________________________________
cal ratio is  0.009090939476655614
distance 1 is tensor(16995.2949, device='cuda:3')
cal_distance is  tensor(16995.2949, device='cuda:3')
cal ratio is  0.09534640531099473
distance 1 is tensor(1620.4464, device='cuda:3')
cal_distance is  tensor(1620.4464, device='cuda:3')
cal ratio is  0.30878154589138207
distance 1 is tensor(500.3686, device='cuda:3')
cal_distance is  tensor(500.3686, device='cuda:3')
cal ratio is  0.5556785745398406
distance 1 is tensor(278.0471, device='cuda:3')
cal_distance is  tensor(278.0471, device='cuda:3')
cal ratio is  0.7454344681561171
distance 1 is tensor(207.2676, device='cuda:3')
cal_distance is  tensor(207.2676, device='cuda:3')
cal ratio is  0.8633819311335137
distance 1 is tensor(178.9520, device='cuda:3')
cal_distance is  tensor(178.9520, device='cuda:3')
cal ratio is  0.9291810257847077
distance 1 is tensor(166.2793, device='cuda:3')
cal_distance is  tensor(166.2793, device='cuda:3')
cal ratio is  0.9639390245870898
distance 1 is tensor(160.2834, device='cuda:3')
cal_distance is  tensor(160.2834, device='cuda:3')
distance 1 is tensor(160.2834, device='cuda:3')
________________________________
test distance is  tensor(160.2834, device='cuda:3')
test similarity is  tensor(0.9244, device='cuda:3')
test acc is  0.648600000156334
test loss is 244.84898332542957
test entropy is  0.0001125923038666365
________________________________
distance 1 is tensor(160.2834, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00011390833865044275
avg test loss is  245.32100996330604
avg accuracy is  0.6501666668230005
solo acc is  0.10050000015633198
compute similarity  is  tensor(0.9244, device='cuda:3')
compute_distance is  tensor(160.2834, device='cuda:3')
compute_norm is  tensor(47.4152, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(141.4891, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9439885827905333
avg test loss is  1.4808376791126439
avg accuracy is  0.8377833334896572
solo acc is  0.3038500001563396
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(141.4891, device='cuda:3')
compute_norm is  tensor(46.5299, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.8353, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8773588683686531
avg test loss is  1.5451152664003596
avg accuracy is  0.8376500001563238
solo acc is  0.2599000001563385
compute similarity  is  tensor(0.9279, device='cuda:3')
compute_distance is  tensor(142.8353, device='cuda:3')
compute_norm is  tensor(46.2467, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.1124, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8759376075603306
avg test loss is  1.517630477576876
avg accuracy is  0.8392000001563237
solo acc is  0.25446666682300506
compute similarity  is  tensor(0.9277, device='cuda:3')
compute_distance is  tensor(144.1124, device='cuda:3')
compute_norm is  tensor(45.9768, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.2963, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8667491143192055
avg test loss is  1.5006480002199918
avg accuracy is  0.839933333489657
solo acc is  0.24806666682300488
compute similarity  is  tensor(0.9275, device='cuda:3')
compute_distance is  tensor(145.2963, device='cuda:3')
compute_norm is  tensor(45.7192, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.4326, device='cuda:3')
________________________________
test distance is  tensor(146.4326, device='cuda:3')
test similarity is  tensor(0.9273, device='cuda:3')
test acc is  0.8414166668229903
test loss is 1.4716670116636037
test entropy is  0.864445553151275
________________________________
distance 1 is tensor(146.4326, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8655819574525869
avg test loss is  1.470266456161735
avg accuracy is  0.842683333489657
solo acc is  0.2465833334896714
compute similarity  is  tensor(0.9273, device='cuda:3')
compute_distance is  tensor(146.4326, device='cuda:3')
compute_norm is  tensor(45.4673, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5693, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8643829664314734
avg test loss is  1.4331178194932592
avg accuracy is  0.8442166668229902
solo acc is  0.2551000001563385
compute similarity  is  tensor(0.9272, device='cuda:3')
compute_distance is  tensor(147.5693, device='cuda:3')
compute_norm is  tensor(45.2186, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.7099, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.847490343076588
avg test loss is  1.4228982579733518
avg accuracy is  0.8449166668229902
solo acc is  0.2569333334896718
compute similarity  is  tensor(0.9270, device='cuda:3')
compute_distance is  tensor(148.7099, device='cuda:3')
compute_norm is  tensor(44.9772, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.8898, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8499773653077164
avg test loss is  1.4113443314647878
avg accuracy is  0.8479833334896567
solo acc is  0.25393333348967173
compute similarity  is  tensor(0.9268, device='cuda:3')
compute_distance is  tensor(149.8898, device='cuda:3')
compute_norm is  tensor(44.7401, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.0343, device='cuda:3')
exit early
distance 1 is tensor(151.0343, device='cuda:3')
________________________________
test distance is  tensor(151.0343, device='cuda:3')
test similarity is  tensor(0.9267, device='cuda:3')
test acc is  0.84866666682299
test loss is 1.4030925913660257
test entropy is  0.8557449285028331
________________________________
distance 1 is tensor(151.0343, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8550822884797542
avg test loss is  1.4058248282495591
avg accuracy is  0.85006666682299
solo acc is  0.24476666682300477
compute similarity  is  tensor(0.9267, device='cuda:3')
compute_distance is  tensor(151.0343, device='cuda:3')
compute_norm is  tensor(44.5062, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.2778, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8470228780815596
avg test loss is  1.3962104021867454
avg accuracy is  0.8504500001563232
solo acc is  0.2450500001563381
compute similarity  is  tensor(0.9265, device='cuda:3')
compute_distance is  tensor(152.2778, device='cuda:3')
compute_norm is  tensor(44.2751, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.4887, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8340046206898273
avg test loss is  1.3870087044833819
avg accuracy is  0.8525166668229899
solo acc is  0.24690000015633815
compute similarity  is  tensor(0.9263, device='cuda:3')
compute_distance is  tensor(153.4887, device='cuda:3')
compute_norm is  tensor(44.0465, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.7426, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8351721851302109
avg test loss is  1.3792150949618456
avg accuracy is  0.8531166668229898
solo acc is  0.24453333348967138
compute similarity  is  tensor(0.9261, device='cuda:3')
compute_distance is  tensor(154.7426, device='cuda:3')
compute_norm is  tensor(43.8220, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.9801, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8374531492114321
avg test loss is  1.3720848404014034
avg accuracy is  0.8539000001563231
solo acc is  0.23855000015633793
compute similarity  is  tensor(0.9259, device='cuda:3')
compute_distance is  tensor(155.9801, device='cuda:3')
compute_norm is  tensor(43.6013, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.2405, device='cuda:3')
________________________________
test distance is  tensor(157.2405, device='cuda:3')
test similarity is  tensor(0.9258, device='cuda:3')
test acc is  0.8550333334896565
test loss is 1.361616239428266
test entropy is  0.8360516306306762
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2043936252593994
mal norm is  tensor(773.7966, device='cuda:3')
distance 1 is tensor(157.2405, device='cuda:3')
mal distance is  tensor(157.2405, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(11.3894, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(383.8888, device='cuda:3')
part1 is  tensor(5.1562, device='cuda:3')
score : tensor(0.0404, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.2462, device='cuda:3')
part1 is  tensor(1.9094, device='cuda:3')
score : tensor(0.0079, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.3949, device='cuda:3')
part1 is  tensor(3.5063, device='cuda:3')
score : tensor(0.0239, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(451.9882, device='cuda:3')
part1 is  tensor(-6.3327, device='cuda:3')
score : tensor(-0.0745, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(518.4589, device='cuda:3')
part1 is  tensor(-12.0331, device='cuda:3')
score : tensor(-0.1315, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.5911, device='cuda:3')
part1 is  tensor(-10.0838, device='cuda:3')
score : tensor(-0.1120, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.9635, device='cuda:3')
part1 is  tensor(-2.7399, device='cuda:3')
score : tensor(-0.0386, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.9384, device='cuda:3')
part1 is  tensor(4.0479, device='cuda:3')
score : tensor(0.0293, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(773.7966, device='cuda:3')
part1 is  tensor(-12.2433, device='cuda:3')
score : tensor(-0.1336, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 89.95% 

Test Accuracy: 89.22% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8591945767402649
distance 1 is tensor(97.9870, device='cuda:3')
benign distance is  tensor(97.9870, device='cuda:3')
norm1 res is  tensor(0.1110, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.1813482791185379
distance 1 is tensor(113.5173, device='cuda:3')
benign distance is  tensor(113.5173, device='cuda:3')
norm1 res is  tensor(0.1297, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.21350231766700745
distance 1 is tensor(107.3407, device='cuda:3')
benign distance is  tensor(107.3407, device='cuda:3')
norm1 res is  tensor(0.1176, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4456104338169098
distance 1 is tensor(111.2255, device='cuda:3')
benign distance is  tensor(111.2255, device='cuda:3')
norm1 res is  tensor(0.1240, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.686180055141449
distance 1 is tensor(115.9027, device='cuda:3')
benign distance is  tensor(115.9027, device='cuda:3')
norm1 res is  tensor(0.1306, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6263471841812134
distance 1 is tensor(133.9394, device='cuda:3')
benign distance is  tensor(133.9394, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.15923051536083221
distance 1 is tensor(104.9956, device='cuda:3')
benign distance is  tensor(104.9956, device='cuda:3')
norm1 res is  tensor(0.1170, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.20312342047691345
distance 1 is tensor(133.6312, device='cuda:3')
benign distance is  tensor(133.6312, device='cuda:3')
norm1 res is  tensor(0.1482, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(151.1806, device='cuda:3')
compute distance is  tensor(151.1806, device='cuda:3')
compute norm is  tensor(46.3762, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.2028, device='cuda:3')
compute distance is  tensor(149.2028, device='cuda:3')
compute norm is  tensor(46.4308, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.4294, device='cuda:3')
compute distance is  tensor(154.4294, device='cuda:3')
compute norm is  tensor(46.6831, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.6164, device='cuda:3')
compute distance is  tensor(137.6164, device='cuda:3')
compute norm is  tensor(46.0809, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(156.0871, device='cuda:3')
compute distance is  tensor(156.0871, device='cuda:3')
compute norm is  tensor(46.4110, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(146.1234, device='cuda:3')
compute distance is  tensor(146.1234, device='cuda:3')
compute norm is  tensor(46.4224, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(151.8466, device='cuda:3')
compute distance is  tensor(151.8466, device='cuda:3')
compute norm is  tensor(46.4181, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.6447, device='cuda:3')
compute distance is  tensor(152.6447, device='cuda:3')
compute norm is  tensor(46.3687, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.8158, device='cuda:3')
compute distance is  tensor(155.8158, device='cuda:3')
compute norm is  tensor(46.2840, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(138.1428, device='cuda:3')
compute distance is  tensor(138.1428, device='cuda:3')
compute norm is  tensor(46.1614, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.3076, device='cuda:3')
compute distance is  tensor(154.3076, device='cuda:3')
compute norm is  tensor(46.5968, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(144.5690, device='cuda:3')
compute distance is  tensor(144.5690, device='cuda:3')
compute norm is  tensor(46.3611, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(156.0871, device='cuda:3')
distance 1 is tensor(1869475.7500, device='cuda:3')
________________________________
test distance is  tensor(1869475.7500, device='cuda:3')
test similarity is  tensor(-0.0445, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766240674937479e+18
test entropy is  0.0
________________________________
cal ratio is  0.008954671537017908
distance 1 is tensor(16740.5449, device='cuda:3')
cal_distance is  tensor(16740.5449, device='cuda:3')
cal ratio is  0.09462911618999739
distance 1 is tensor(1584.1494, device='cuda:3')
cal_distance is  tensor(1584.1494, device='cuda:3')
cal ratio is  0.3076178295552653
distance 1 is tensor(487.3173, device='cuda:3')
cal_distance is  tensor(487.3173, device='cuda:3')
cal ratio is  0.5546304188975804
distance 1 is tensor(270.2840, device='cuda:3')
cal_distance is  tensor(270.2840, device='cuda:3')
cal ratio is  0.7447310176689093
distance 1 is tensor(201.2906, device='cuda:3')
cal_distance is  tensor(201.2906, device='cuda:3')
cal ratio is  0.8629742739927304
distance 1 is tensor(173.7095, device='cuda:3')
cal_distance is  tensor(173.7095, device='cuda:3')
cal ratio is  0.9289615239797719
distance 1 is tensor(161.3699, device='cuda:3')
cal_distance is  tensor(161.3699, device='cuda:3')
cal ratio is  0.963825145567483
distance 1 is tensor(155.5327, device='cuda:3')
cal_distance is  tensor(155.5327, device='cuda:3')
distance 1 is tensor(155.5327, device='cuda:3')
________________________________
test distance is  tensor(155.5327, device='cuda:3')
test similarity is  tensor(0.9301, device='cuda:3')
test acc is  0.6677000001563327
test loss is 239.24549922658437
test entropy is  0.00021195333205114225
________________________________
distance 1 is tensor(155.5327, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0002297130443516645
avg test loss is  239.71749978787355
avg accuracy is  0.6668166668229993
solo acc is  0.10078333348966531
compute similarity  is  tensor(0.9301, device='cuda:3')
compute_distance is  tensor(155.5327, device='cuda:3')
compute_norm is  tensor(47.8145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(139.6152, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9429991421287757
avg test loss is  1.4716983573523157
avg accuracy is  0.8368000001563238
solo acc is  0.31031666682300646
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(139.6152, device='cuda:3')
compute_norm is  tensor(46.8911, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.3897, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8821875679213355
avg test loss is  1.5576563276715878
avg accuracy is  0.834750000156324
solo acc is  0.251766666823005
compute similarity  is  tensor(0.9328, device='cuda:3')
compute_distance is  tensor(141.3897, device='cuda:3')
compute_norm is  tensor(46.6049, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.7610, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8748934736002737
avg test loss is  1.5107129122148444
avg accuracy is  0.8359000001563238
solo acc is  0.25833333348967186
compute similarity  is  tensor(0.9326, device='cuda:3')
compute_distance is  tensor(142.7610, device='cuda:3')
compute_norm is  tensor(46.3315, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.0667, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8741425916330138
avg test loss is  1.4964975370908342
avg accuracy is  0.8378500001563238
solo acc is  0.2509500001563383
compute similarity  is  tensor(0.9324, device='cuda:3')
compute_distance is  tensor(144.0667, device='cuda:3')
compute_norm is  tensor(46.0691, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.2310, device='cuda:3')
________________________________
test distance is  tensor(145.2310, device='cuda:3')
test similarity is  tensor(0.9323, device='cuda:3')
test acc is  0.8401166668229904
test loss is 1.4750197485311707
test entropy is  0.8625748343686305
________________________________
distance 1 is tensor(145.2310, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8626459103022048
avg test loss is  1.4730838284309484
avg accuracy is  0.839233333489657
solo acc is  0.25068333348967164
compute similarity  is  tensor(0.9323, device='cuda:3')
compute_distance is  tensor(145.2310, device='cuda:3')
compute_norm is  tensor(45.8139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.4223, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8698425905536741
avg test loss is  1.4462944214532116
avg accuracy is  0.840833333489657
solo acc is  0.24961666682300496
compute similarity  is  tensor(0.9321, device='cuda:3')
compute_distance is  tensor(146.4223, device='cuda:3')
compute_norm is  tensor(45.5622, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.6048, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8520491439015118
avg test loss is  1.4318763073573488
avg accuracy is  0.8431833334896569
solo acc is  0.2502000001563383
compute similarity  is  tensor(0.9319, device='cuda:3')
compute_distance is  tensor(147.6048, device='cuda:3')
compute_norm is  tensor(45.3171, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.8109, device='cuda:3')
exit early
distance 1 is tensor(148.8109, device='cuda:3')
________________________________
test distance is  tensor(148.8109, device='cuda:3')
test similarity is  tensor(0.9317, device='cuda:3')
test acc is  0.8458333334896568
test loss is 1.4355304487732683
test entropy is  0.8404540277239102
________________________________
distance 1 is tensor(148.8109, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8419571225958338
avg test loss is  1.432213364760759
avg accuracy is  0.8453333334896569
solo acc is  0.2466500001563382
compute similarity  is  tensor(0.9317, device='cuda:3')
compute_distance is  tensor(148.8109, device='cuda:3')
compute_norm is  tensor(45.0762, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.0934, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8416112929519052
avg test loss is  1.4173373178378352
avg accuracy is  0.8454833334896568
solo acc is  0.24265000015633806
compute similarity  is  tensor(0.9315, device='cuda:3')
compute_distance is  tensor(150.0934, device='cuda:3')
compute_norm is  tensor(44.8385, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.3979, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8380672207900456
avg test loss is  1.393287720202383
avg accuracy is  0.8470833334896567
solo acc is  0.24903333348967152
compute similarity  is  tensor(0.9314, device='cuda:3')
compute_distance is  tensor(151.3979, device='cuda:3')
compute_norm is  tensor(44.6038, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.7574, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8330237704045229
avg test loss is  1.3872317773446854
avg accuracy is  0.8488666668229898
solo acc is  0.24471666682300472
compute similarity  is  tensor(0.9312, device='cuda:3')
compute_distance is  tensor(152.7574, device='cuda:3')
compute_norm is  tensor(44.3723, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.0766, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8358655000673428
avg test loss is  1.370304838426586
avg accuracy is  0.85051666682299
solo acc is  0.24638333348967154
compute similarity  is  tensor(0.9310, device='cuda:3')
compute_distance is  tensor(154.0766, device='cuda:3')
compute_norm is  tensor(44.1422, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.3906, device='cuda:3')
________________________________
test distance is  tensor(155.3906, device='cuda:3')
test similarity is  tensor(0.9308, device='cuda:3')
test acc is  0.8527166668229899
test loss is 1.3690673741958796
test entropy is  0.8320154884476652
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4138209819793701
mal norm is  tensor(757.3506, device='cuda:3')
distance 1 is tensor(155.3906, device='cuda:3')
mal distance is  tensor(155.3906, device='cuda:3')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(10.6596, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(431.4485, device='cuda:3')
part1 is  tensor(-4.0055, device='cuda:3')
score : tensor(-0.0505, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(511.6872, device='cuda:3')
part1 is  tensor(1.8149, device='cuda:3')
score : tensor(0.0077, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.7687, device='cuda:3')
part1 is  tensor(10.1751, device='cuda:3')
score : tensor(0.0913, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(485.1187, device='cuda:3')
part1 is  tensor(-4.7976, device='cuda:3')
score : tensor(-0.0584, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(501.6923, device='cuda:3')
part1 is  tensor(-7.9510, device='cuda:3')
score : tensor(-0.0900, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.4361, device='cuda:3')
part1 is  tensor(-10.0631, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(461.7246, device='cuda:3')
part1 is  tensor(24.1879, device='cuda:3')
score : tensor(0.2314, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(587.0227, device='cuda:3')
part1 is  tensor(-9.4798, device='cuda:3')
score : tensor(-0.1053, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(757.3506, device='cuda:3')
part1 is  tensor(-10.0670, device='cuda:3')
score : tensor(-0.1111, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.2964, device='cuda:3')
part1 is  tensor(-0.6303, device='cuda:3')
score : tensor(-0.0168, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.6473, device='cuda:3')
part1 is  tensor(-12.2616, device='cuda:3')
score : tensor(-0.1331, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(673.2784, device='cuda:3')
part1 is  tensor(7.1563, device='cuda:3')
score : tensor(0.0611, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(734.4644, device='cuda:3')
part1 is  tensor(-7.7823, device='cuda:3')
score : tensor(-0.0883, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.3067, device='cuda:3')
part1 is  tensor(6.3986, device='cuda:3')
score : tensor(0.0535, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(653.3130, device='cuda:3')
part1 is  tensor(-22.2152, device='cuda:3')
score : tensor(-0.2326, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.4503, device='cuda:3')
part1 is  tensor(-8.5630, device='cuda:3')
score : tensor(-0.0961, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.7678, device='cuda:3')
part1 is  tensor(-13.0064, device='cuda:3')
score : tensor(-0.1405, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.4296, device='cuda:3')
part1 is  tensor(-11.4487, device='cuda:3')
score : tensor(-0.1249, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(676.8842, device='cuda:3')
part1 is  tensor(-22.8103, device='cuda:3')
score : tensor(-0.2386, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.8040, device='cuda:3')
part1 is  tensor(1.4197, device='cuda:3')
score : tensor(0.0037, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.3588, device='cuda:3')
part1 is  tensor(-7.6828, device='cuda:3')
score : tensor(-0.0873, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.3047, device='cuda:3')
part1 is  tensor(6.0867, device='cuda:3')
score : tensor(0.0504, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.1524, device='cuda:3')
part1 is  tensor(-11.7414, device='cuda:3')
score : tensor(-0.1279, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(655.3748, device='cuda:3')
part1 is  tensor(-13.7341, device='cuda:3')
score : tensor(-0.1478, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(622.3027, device='cuda:3')
part1 is  tensor(0.0254, device='cuda:3')
score : tensor(-0.0102, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.1759, device='cuda:3')
part1 is  tensor(3.1552, device='cuda:3')
score : tensor(0.0211, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.6245, device='cuda:3')
part1 is  tensor(-23.8253, device='cuda:3')
score : tensor(-0.2487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.8651, device='cuda:3')
part1 is  tensor(-15.2945, device='cuda:3')
score : tensor(-0.1634, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.1058, device='cuda:3')
part1 is  tensor(-20.3518, device='cuda:3')
score : tensor(-0.2140, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.3800, device='cuda:3')
part1 is  tensor(0.0018, device='cuda:3')
score : tensor(-0.0104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.2763, device='cuda:3')
part1 is  tensor(-2.9720, device='cuda:3')
score : tensor(-0.0402, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.5480, device='cuda:3')
part1 is  tensor(-9.1909, device='cuda:3')
score : tensor(-0.1024, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.9368, device='cuda:3')
part1 is  tensor(-17.5389, device='cuda:3')
score : tensor(-0.1858, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.98% 

Test Accuracy: 89.12% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
 benign loss is  0.39415472745895386
distance 1 is tensor(92.4749, device='cuda:3')
benign distance is  tensor(92.4749, device='cuda:3')
norm1 res is  tensor(0.1055, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4924025535583496
distance 1 is tensor(116.7327, device='cuda:3')
benign distance is  tensor(116.7327, device='cuda:3')
norm1 res is  tensor(0.1291, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.12772977352142334
distance 1 is tensor(98.5045, device='cuda:3')
benign distance is  tensor(98.5045, device='cuda:3')
norm1 res is  tensor(0.1089, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.744267463684082
distance 1 is tensor(104.6772, device='cuda:3')
benign distance is  tensor(104.6772, device='cuda:3')
norm1 res is  tensor(0.1156, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.49964040517807007
distance 1 is tensor(115.8851, device='cuda:3')
benign distance is  tensor(115.8851, device='cuda:3')
norm1 res is  tensor(0.1314, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.19214339554309845
distance 1 is tensor(125.5470, device='cuda:3')
benign distance is  tensor(125.5470, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.14146330952644348
distance 1 is tensor(105.3781, device='cuda:3')
benign distance is  tensor(105.3781, device='cuda:3')
norm1 res is  tensor(0.1185, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.08422848582267761
distance 1 is tensor(127.4314, device='cuda:3')
benign distance is  tensor(127.4314, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.028972694650292397
distance 1 is tensor(142.4282, device='cuda:3')
benign distance is  tensor(142.4282, device='cuda:3')
norm1 res is  tensor(0.1551, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.2945156693458557
distance 1 is tensor(145.1490, device='cuda:3')
benign distance is  tensor(145.1490, device='cuda:3')
norm1 res is  tensor(0.1630, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.26051536202430725
distance 1 is tensor(131.1637, device='cuda:3')
benign distance is  tensor(131.1637, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  1.0168043375015259
distance 1 is tensor(149.6518, device='cuda:3')
benign distance is  tensor(149.6518, device='cuda:3')
norm1 res is  tensor(0.1639, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.30248403549194336
distance 1 is tensor(130.2926, device='cuda:3')
benign distance is  tensor(130.2926, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.33764320611953735
distance 1 is tensor(123.2017, device='cuda:3')
benign distance is  tensor(123.2017, device='cuda:3')
norm1 res is  tensor(0.1385, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.2863873243331909
distance 1 is tensor(126.0783, device='cuda:3')
benign distance is  tensor(126.0783, device='cuda:3')
norm1 res is  tensor(0.1440, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3923916518688202
distance 1 is tensor(133.8679, device='cuda:3')
benign distance is  tensor(133.8679, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.1926267296075821
distance 1 is tensor(139.0320, device='cuda:3')
benign distance is  tensor(139.0320, device='cuda:3')
norm1 res is  tensor(0.1525, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.3676837086677551
distance 1 is tensor(148.6494, device='cuda:3')
benign distance is  tensor(148.6494, device='cuda:3')
norm1 res is  tensor(0.1648, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.0945616215467453
distance 1 is tensor(123.7863, device='cuda:3')
benign distance is  tensor(123.7863, device='cuda:3')
norm1 res is  tensor(0.1390, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.18379142880439758
distance 1 is tensor(129.4124, device='cuda:3')
benign distance is  tensor(129.4124, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.20617632567882538
distance 1 is tensor(128.2225, device='cuda:3')
benign distance is  tensor(128.2225, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.6172446012496948
distance 1 is tensor(138.9454, device='cuda:3')
benign distance is  tensor(138.9454, device='cuda:3')
norm1 res is  tensor(0.1521, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.09233871847391129
distance 1 is tensor(147.9829, device='cuda:3')
benign distance is  tensor(147.9829, device='cuda:3')
norm1 res is  tensor(0.1642, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.6347829103469849
distance 1 is tensor(147.6038, device='cuda:3')
benign distance is  tensor(147.6038, device='cuda:3')
norm1 res is  tensor(0.1579, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.20931479334831238
distance 1 is tensor(135.8446, device='cuda:3')
benign distance is  tensor(135.8446, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.1929478496313095
distance 1 is tensor(133.1383, device='cuda:3')
benign distance is  tensor(133.1383, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.3797030448913574
distance 1 is tensor(120.5361, device='cuda:3')
benign distance is  tensor(120.5361, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.0802183747291565
distance 1 is tensor(138.5381, device='cuda:3')
benign distance is  tensor(138.5381, device='cuda:3')
norm1 res is  tensor(0.1506, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.14234475791454315
distance 1 is tensor(132.0053, device='cuda:3')
benign distance is  tensor(132.0053, device='cuda:3')
norm1 res is  tensor(0.1439, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.57300865650177
distance 1 is tensor(135.9880, device='cuda:3')
benign distance is  tensor(135.9880, device='cuda:3')
norm1 res is  tensor(0.1548, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.3500756025314331
distance 1 is tensor(131.1247, device='cuda:3')
benign distance is  tensor(131.1247, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.3586409091949463
distance 1 is tensor(136.9893, device='cuda:3')
benign distance is  tensor(136.9893, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(178.5953, device='cuda:3')
compute distance is  tensor(178.5953, device='cuda:3')
compute norm is  tensor(47.7057, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.9796, device='cuda:3')
compute distance is  tensor(155.9796, device='cuda:3')
compute norm is  tensor(47.1481, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(181.3707, device='cuda:3')
compute distance is  tensor(181.3707, device='cuda:3')
compute norm is  tensor(48.0930, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.3031, device='cuda:3')
compute distance is  tensor(158.3031, device='cuda:3')
compute norm is  tensor(47.2746, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(163.0996, device='cuda:3')
compute distance is  tensor(163.0996, device='cuda:3')
compute norm is  tensor(47.4285, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(165.8340, device='cuda:3')
compute distance is  tensor(165.8340, device='cuda:3')
compute norm is  tensor(47.4748, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.9726, device='cuda:3')
compute distance is  tensor(158.9726, device='cuda:3')
compute norm is  tensor(47.4722, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(168.2282, device='cuda:3')
compute distance is  tensor(168.2282, device='cuda:3')
compute norm is  tensor(47.5614, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(171.5550, device='cuda:3')
compute distance is  tensor(171.5550, device='cuda:3')
compute norm is  tensor(47.7644, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(165.7953, device='cuda:3')
compute distance is  tensor(165.7953, device='cuda:3')
compute norm is  tensor(47.5152, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(170.7859, device='cuda:3')
compute distance is  tensor(170.7859, device='cuda:3')
compute norm is  tensor(47.7002, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(165.5842, device='cuda:3')
compute distance is  tensor(165.5842, device='cuda:3')
compute norm is  tensor(47.4026, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(181.3707, device='cuda:3')
distance 1 is tensor(1869476.6250, device='cuda:3')
________________________________
test distance is  tensor(1869476.6250, device='cuda:3')
test similarity is  tensor(-0.0450, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.764045160038326e+18
test entropy is  0.0
________________________________
cal ratio is  0.009652718447368844
distance 1 is tensor(18045.5391, device='cuda:3')
cal_distance is  tensor(18045.5391, device='cuda:3')
cal ratio is  0.09824822993494925
distance 1 is tensor(1772.9482, device='cuda:3')
cal_distance is  tensor(1772.9482, device='cuda:3')
cal ratio is  0.31344519879554966
distance 1 is tensor(555.7267, device='cuda:3')
cal_distance is  tensor(555.7267, device='cuda:3')
cal ratio is  0.5598594725389612
distance 1 is tensor(311.1318, device='cuda:3')
cal_distance is  tensor(311.1318, device='cuda:3')
cal ratio is  0.7482339679263563
distance 1 is tensor(232.8011, device='cuda:3')
cal_distance is  tensor(232.8011, device='cuda:3')
cal ratio is  0.8650020353894184
distance 1 is tensor(201.3744, device='cuda:3')
cal_distance is  tensor(201.3744, device='cuda:3')
cal ratio is  0.9300526985496401
distance 1 is tensor(187.2892, device='cuda:3')
cal_distance is  tensor(187.2892, device='cuda:3')
cal ratio is  0.9643912305473544
distance 1 is tensor(180.6203, device='cuda:3')
cal_distance is  tensor(180.6203, device='cuda:3')
distance 1 is tensor(180.6203, device='cuda:3')
________________________________
test distance is  tensor(180.6203, device='cuda:3')
test similarity is  tensor(0.9080, device='cuda:3')
test acc is  0.44916666682300826
test loss is 423.960700386877
test entropy is  8.830517050923005e-07
________________________________
distance 1 is tensor(180.6203, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0778299486517343e-05
avg test loss is  424.1194759930121
avg accuracy is  0.4433666668230082
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9080, device='cuda:3')
compute_distance is  tensor(180.6203, device='cuda:3')
compute_norm is  tensor(48.3601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(155.1215, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9396916222470656
avg test loss is  1.52445402391938
avg accuracy is  0.8292833334896574
solo acc is  0.30316666682300625
compute similarity  is  tensor(0.9139, device='cuda:3')
compute_distance is  tensor(155.1215, device='cuda:3')
compute_norm is  tensor(47.6134, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.5298, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8994870589994418
avg test loss is  1.5845756928549646
avg accuracy is  0.8267000001563242
solo acc is  0.2561166668230051
compute similarity  is  tensor(0.9136, device='cuda:3')
compute_distance is  tensor(156.5298, device='cuda:3')
compute_norm is  tensor(47.3234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.8130, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8888654879796734
avg test loss is  1.5511060265589878
avg accuracy is  0.8307833334896574
solo acc is  0.2496000001563383
compute similarity  is  tensor(0.9134, device='cuda:3')
compute_distance is  tensor(157.8130, device='cuda:3')
compute_norm is  tensor(47.0440, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.0231, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8862434688534564
avg test loss is  1.511100626957696
avg accuracy is  0.8321500001563241
solo acc is  0.25211666682300504
compute similarity  is  tensor(0.9132, device='cuda:3')
compute_distance is  tensor(159.0231, device='cuda:3')
compute_norm is  tensor(46.7738, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(160.3198, device='cuda:3')
________________________________
test distance is  tensor(160.3198, device='cuda:3')
test similarity is  tensor(0.9130, device='cuda:3')
test acc is  0.832950000156324
test loss is 1.496192169723226
test entropy is  0.8753858288722252
________________________________
distance 1 is tensor(160.3198, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8739521659767704
avg test loss is  1.4955894709395956
avg accuracy is  0.8332833334896573
solo acc is  0.24891666682300487
compute similarity  is  tensor(0.9130, device='cuda:3')
compute_distance is  tensor(160.3198, device='cuda:3')
compute_norm is  tensor(46.5130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(161.5327, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8702343818602531
avg test loss is  1.477623605651896
avg accuracy is  0.8341500001563239
solo acc is  0.24571666682300483
compute similarity  is  tensor(0.9128, device='cuda:3')
compute_distance is  tensor(161.5327, device='cuda:3')
compute_norm is  tensor(46.2576, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(162.6626, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8663528597812409
avg test loss is  1.4501561503420506
avg accuracy is  0.836300000156324
solo acc is  0.24583333348967154
compute similarity  is  tensor(0.9126, device='cuda:3')
compute_distance is  tensor(162.6626, device='cuda:3')
compute_norm is  tensor(46.0076, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(163.8401, device='cuda:3')
exit early
distance 1 is tensor(163.8401, device='cuda:3')
________________________________
test distance is  tensor(163.8401, device='cuda:3')
test similarity is  tensor(0.9124, device='cuda:3')
test acc is  0.8371666668229905
test loss is 1.4439434907329616
test entropy is  0.8643772737430865
________________________________
distance 1 is tensor(163.8401, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8652774084732731
avg test loss is  1.4462376342399288
avg accuracy is  0.8358666668229906
solo acc is  0.24093333348967136
compute similarity  is  tensor(0.9124, device='cuda:3')
compute_distance is  tensor(163.8401, device='cuda:3')
compute_norm is  tensor(45.7635, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(165.0059, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8578353510863745
avg test loss is  1.4282712520821008
avg accuracy is  0.8382833334896571
solo acc is  0.24435000015633804
compute similarity  is  tensor(0.9122, device='cuda:3')
compute_distance is  tensor(165.0059, device='cuda:3')
compute_norm is  tensor(45.5246, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(166.2280, device='cuda:3')
exit early
distance 1 is tensor(166.2280, device='cuda:3')
________________________________
test distance is  tensor(166.2280, device='cuda:3')
test similarity is  tensor(0.9120, device='cuda:3')
test acc is  0.8407166668229904
test loss is 1.4245114046881702
test entropy is  0.8450547611154219
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.361259937286377
mal norm is  tensor(864.5403, device='cuda:3')
distance 1 is tensor(166.2280, device='cuda:3')
mal distance is  tensor(166.2280, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(9.4683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(416.3499, device='cuda:3')
part1 is  tensor(-9.1810, device='cuda:3')
score : tensor(-0.1011, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(509.1765, device='cuda:3')
part1 is  tensor(-20.8973, device='cuda:3')
score : tensor(-0.2182, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(430.3825, device='cuda:3')
part1 is  tensor(1.9288, device='cuda:3')
score : tensor(0.0100, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(458.8733, device='cuda:3')
part1 is  tensor(-8.6964, device='cuda:3')
score : tensor(-0.0962, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(497.2196, device='cuda:3')
part1 is  tensor(-3.3545, device='cuda:3')
score : tensor(-0.0428, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.7422, device='cuda:3')
part1 is  tensor(-0.3385, device='cuda:3')
score : tensor(-0.0127, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(458.1402, device='cuda:3')
part1 is  tensor(16.3049, device='cuda:3')
score : tensor(0.1538, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(553.7649, device='cuda:3')
part1 is  tensor(-0.7700, device='cuda:3')
score : tensor(-0.0170, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(864.5403, device='cuda:3')
part1 is  tensor(3.3384, device='cuda:3')
score : tensor(0.0241, device='cuda:3')
accept
len accept list 14
len all weights is 14
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 77.37% 

Test Accuracy: 76.64% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3042868971824646
distance 1 is tensor(185.5825, device='cuda:3')
benign distance is  tensor(185.5825, device='cuda:3')
norm1 res is  tensor(0.1912, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.7323731184005737
distance 1 is tensor(192.2562, device='cuda:3')
benign distance is  tensor(192.2562, device='cuda:3')
norm1 res is  tensor(0.1933, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.18608112633228302
distance 1 is tensor(166.8776, device='cuda:3')
benign distance is  tensor(166.8776, device='cuda:3')
norm1 res is  tensor(0.1726, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6734322309494019
distance 1 is tensor(165.4584, device='cuda:3')
benign distance is  tensor(165.4584, device='cuda:3')
norm1 res is  tensor(0.1688, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7131263613700867
distance 1 is tensor(170.7664, device='cuda:3')
benign distance is  tensor(170.7664, device='cuda:3')
norm1 res is  tensor(0.1747, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3338020443916321
distance 1 is tensor(208.2790, device='cuda:3')
benign distance is  tensor(208.2790, device='cuda:3')
norm1 res is  tensor(0.2106, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.948296844959259
distance 1 is tensor(165.3702, device='cuda:3')
benign distance is  tensor(165.3702, device='cuda:3')
norm1 res is  tensor(0.1656, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.27335813641548157
distance 1 is tensor(166.0164, device='cuda:3')
benign distance is  tensor(166.0164, device='cuda:3')
norm1 res is  tensor(0.1684, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(172.0895, device='cuda:3')
compute distance is  tensor(172.0895, device='cuda:3')
compute norm is  tensor(46.7794, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(172.2553, device='cuda:3')
compute distance is  tensor(172.2553, device='cuda:3')
compute norm is  tensor(46.8240, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.4348, device='cuda:3')
compute distance is  tensor(184.4348, device='cuda:3')
compute norm is  tensor(47.1439, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(170.1044, device='cuda:3')
compute distance is  tensor(170.1044, device='cuda:3')
compute norm is  tensor(46.6998, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(183.8239, device='cuda:3')
compute distance is  tensor(183.8239, device='cuda:3')
compute norm is  tensor(47.2101, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(179.5481, device='cuda:3')
compute distance is  tensor(179.5481, device='cuda:3')
compute norm is  tensor(47.0072, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(182.2480, device='cuda:3')
compute distance is  tensor(182.2480, device='cuda:3')
compute norm is  tensor(47.1794, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(176.5147, device='cuda:3')
compute distance is  tensor(176.5147, device='cuda:3')
compute norm is  tensor(46.8934, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.9218, device='cuda:3')
compute distance is  tensor(184.9218, device='cuda:3')
compute norm is  tensor(47.0591, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(182.4427, device='cuda:3')
compute distance is  tensor(182.4427, device='cuda:3')
compute norm is  tensor(47.2028, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(190.1289, device='cuda:3')
compute distance is  tensor(190.1289, device='cuda:3')
compute norm is  tensor(47.4484, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.9904, device='cuda:3')
compute distance is  tensor(184.9904, device='cuda:3')
compute norm is  tensor(47.0076, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(190.1289, device='cuda:3')
distance 1 is tensor(1869407., device='cuda:3')
________________________________
test distance is  tensor(1869407., device='cuda:3')
test similarity is  tensor(0.2178, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765655479214685e+18
test entropy is  0.0
________________________________
cal ratio is  0.009883214602452284
distance 1 is tensor(18475.7559, device='cuda:3')
cal_distance is  tensor(18475.7559, device='cuda:3')
cal ratio is  0.09941434275806846
distance 1 is tensor(1836.7610, device='cuda:3')
cal_distance is  tensor(1836.7610, device='cuda:3')
cal ratio is  0.31529989447504964
distance 1 is tensor(579.1353, device='cuda:3')
cal_distance is  tensor(579.1353, device='cuda:3')
cal ratio is  0.5615134409245195
distance 1 is tensor(325.1952, device='cuda:3')
cal_distance is  tensor(325.1952, device='cuda:3')
cal ratio is  0.7493386242606614
distance 1 is tensor(243.6830, device='cuda:3')
cal_distance is  tensor(243.6830, device='cuda:3')
cal ratio is  0.8656404527737793
distance 1 is tensor(210.9427, device='cuda:3')
cal_distance is  tensor(210.9427, device='cuda:3')
cal ratio is  0.9303960199765828
distance 1 is tensor(196.2608, device='cuda:3')
cal_distance is  tensor(196.2608, device='cuda:3')
cal ratio is  0.9645692286575871
distance 1 is tensor(189.3073, device='cuda:3')
cal_distance is  tensor(189.3073, device='cuda:3')
distance 1 is tensor(189.3073, device='cuda:3')
________________________________
test distance is  tensor(189.3073, device='cuda:3')
test similarity is  tensor(0.9206, device='cuda:3')
test acc is  0.10016666682299866
test loss is 582.9640039635111
test entropy is  0.0
________________________________
distance 1 is tensor(189.3073, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.398609405438053e-44
avg test loss is  582.4310836629319
avg accuracy is  0.10013333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9206, device='cuda:3')
compute_distance is  tensor(189.3073, device='cuda:3')
compute_norm is  tensor(50.4231, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(192.1120, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.030366444956265
avg test loss is  1.690287158687486
avg accuracy is  0.28931666682300594
solo acc is  0.24771666682300492
compute similarity  is  tensor(0.9212, device='cuda:3')
compute_distance is  tensor(192.1120, device='cuda:3')
compute_norm is  tensor(50.8849, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(191.6186, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6346368026504638
avg test loss is  2.500332799547517
avg accuracy is  0.1926666668230027
solo acc is  0.11448333348966529
compute similarity  is  tensor(0.9212, device='cuda:3')
compute_distance is  tensor(191.6186, device='cuda:3')
compute_norm is  tensor(50.7235, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(190.7498, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9687868567672111
avg test loss is  1.5535529257137892
avg accuracy is  0.3103833334896731
solo acc is  0.2634500001563386
compute similarity  is  tensor(0.9215, device='cuda:3')
compute_distance is  tensor(190.7498, device='cuda:3')
compute_norm is  tensor(50.2998, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance 1 is tensor(190.7498, device='cuda:3')
________________________________
test distance is  tensor(190.7498, device='cuda:3')
test similarity is  tensor(0.9215, device='cuda:3')
test acc is  0.31186666682300646
test loss is 1.5494305666829986
test entropy is  0.9700184295426554
________________________________
cal ratio is  0.9784036867481649
distance 1 is tensor(186.6304, device='cuda:3')
cal_distance is  tensor(186.6304, device='cuda:3')
distance 1 is tensor(186.6304, device='cuda:3')
________________________________
test distance is  tensor(186.6304, device='cuda:3')
test similarity is  tensor(0.9242, device='cuda:3')
test acc is  0.3165833334896732
test loss is 1.551378691374366
test entropy is  0.967041969235772
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3740017414093018
mal norm is  tensor(926.9908, device='cuda:3')
distance 1 is tensor(186.6304, device='cuda:3')
mal distance is  tensor(186.6304, device='cuda:3')
len current grad  20
len all grad 44
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(31.8153, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.7095, device='cuda:3')
part1 is  tensor(369.0613, device='cuda:3')
score : tensor(3.6590, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.9957, device='cuda:3')
part1 is  tensor(446.5397, device='cuda:3')
score : tensor(4.4338, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.0453, device='cuda:3')
part1 is  tensor(551.0228, device='cuda:3')
score : tensor(5.4786, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(669.9103, device='cuda:3')
part1 is  tensor(439.6464, device='cuda:3')
score : tensor(4.3648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.4130, device='cuda:3')
part1 is  tensor(378.0163, device='cuda:3')
score : tensor(3.7485, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(835.3895, device='cuda:3')
part1 is  tensor(389.9150, device='cuda:3')
score : tensor(3.8675, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.4227, device='cuda:3')
part1 is  tensor(449.9199, device='cuda:3')
score : tensor(4.4676, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.8625, device='cuda:3')
part1 is  tensor(380.7103, device='cuda:3')
score : tensor(3.7755, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(926.9908, device='cuda:3')
part1 is  tensor(-337.7560, device='cuda:3')
score : tensor(-3.4092, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(878.8819, device='cuda:3')
part1 is  tensor(392.7373, device='cuda:3')
score : tensor(3.8958, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(872.7249, device='cuda:3')
part1 is  tensor(412.4294, device='cuda:3')
score : tensor(4.0927, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(903.6605, device='cuda:3')
part1 is  tensor(368.1568, device='cuda:3')
score : tensor(3.6500, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(863.6191, device='cuda:3')
part1 is  tensor(418.4963, device='cuda:3')
score : tensor(4.1533, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(870.1426, device='cuda:3')
part1 is  tensor(414.8988, device='cuda:3')
score : tensor(4.1174, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(862.8222, device='cuda:3')
part1 is  tensor(398.6990, device='cuda:3')
score : tensor(3.9554, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(834.3502, device='cuda:3')
part1 is  tensor(407.5286, device='cuda:3')
score : tensor(4.0437, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(870.2523, device='cuda:3')
part1 is  tensor(351.4807, device='cuda:3')
score : tensor(3.4832, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(848.7020, device='cuda:3')
part1 is  tensor(355.2029, device='cuda:3')
score : tensor(3.5204, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(829.4332, device='cuda:3')
part1 is  tensor(362.9742, device='cuda:3')
score : tensor(3.5981, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(898.9788, device='cuda:3')
part1 is  tensor(342.6141, device='cuda:3')
score : tensor(3.3945, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(886.1188, device='cuda:3')
part1 is  tensor(389.1098, device='cuda:3')
score : tensor(3.8595, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(843.8320, device='cuda:3')
part1 is  tensor(394.3074, device='cuda:3')
score : tensor(3.9115, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(831.2427, device='cuda:3')
part1 is  tensor(414.1774, device='cuda:3')
score : tensor(4.1102, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(851.7437, device='cuda:3')
part1 is  tensor(400.3539, device='cuda:3')
score : tensor(3.9719, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(847.2104, device='cuda:3')
part1 is  tensor(456.4097, device='cuda:3')
score : tensor(4.5325, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(863.1522, device='cuda:3')
part1 is  tensor(407.5975, device='cuda:3')
score : tensor(4.0444, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(884.8897, device='cuda:3')
part1 is  tensor(390.7599, device='cuda:3')
score : tensor(3.8760, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(840.7620, device='cuda:3')
part1 is  tensor(401.7451, device='cuda:3')
score : tensor(3.9858, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(900.5639, device='cuda:3')
part1 is  tensor(435.6104, device='cuda:3')
score : tensor(4.3245, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(834.6934, device='cuda:3')
part1 is  tensor(343.1054, device='cuda:3')
score : tensor(3.3994, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(827.7332, device='cuda:3')
part1 is  tensor(423.0169, device='cuda:3')
score : tensor(4.1986, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(836.1786, device='cuda:3')
part1 is  tensor(365.7478, device='cuda:3')
score : tensor(3.6259, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(843.6719, device='cuda:3')
part1 is  tensor(377.7742, device='cuda:3')
score : tensor(3.7461, device='cuda:3')
accept
len accept list 32
len all weights is 32
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.81% 

Test Accuracy: 89.03% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
 benign loss is  0.417472779750824
distance 1 is tensor(84.8389, device='cuda:3')
benign distance is  tensor(84.8389, device='cuda:3')
norm1 res is  tensor(0.0953, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.741499662399292
distance 1 is tensor(122.9825, device='cuda:3')
benign distance is  tensor(122.9825, device='cuda:3')
norm1 res is  tensor(0.1330, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2537490725517273
distance 1 is tensor(115.8257, device='cuda:3')
benign distance is  tensor(115.8257, device='cuda:3')
norm1 res is  tensor(0.1256, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3215971887111664
distance 1 is tensor(105.5844, device='cuda:3')
benign distance is  tensor(105.5844, device='cuda:3')
norm1 res is  tensor(0.1169, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.43416380882263184
distance 1 is tensor(100.2120, device='cuda:3')
benign distance is  tensor(100.2120, device='cuda:3')
norm1 res is  tensor(0.1069, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3900526762008667
distance 1 is tensor(130.6491, device='cuda:3')
benign distance is  tensor(130.6491, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5205133557319641
distance 1 is tensor(91.7240, device='cuda:3')
benign distance is  tensor(91.7240, device='cuda:3')
norm1 res is  tensor(0.0970, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.1673165112733841
distance 1 is tensor(120.0673, device='cuda:3')
benign distance is  tensor(120.0673, device='cuda:3')
norm1 res is  tensor(0.1310, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.11594085395336151
distance 1 is tensor(134.4963, device='cuda:3')
benign distance is  tensor(134.4963, device='cuda:3')
norm1 res is  tensor(0.1474, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.7555789351463318
distance 1 is tensor(138.1782, device='cuda:3')
benign distance is  tensor(138.1782, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.3797829747200012
distance 1 is tensor(136.3947, device='cuda:3')
benign distance is  tensor(136.3947, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.46526241302490234
distance 1 is tensor(145.6111, device='cuda:3')
benign distance is  tensor(145.6111, device='cuda:3')
norm1 res is  tensor(0.1557, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.548375129699707
distance 1 is tensor(142.3305, device='cuda:3')
benign distance is  tensor(142.3305, device='cuda:3')
norm1 res is  tensor(0.1543, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.24103064835071564
distance 1 is tensor(133.8861, device='cuda:3')
benign distance is  tensor(133.8861, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.3311340808868408
distance 1 is tensor(132.4712, device='cuda:3')
benign distance is  tensor(132.4712, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4225882887840271
distance 1 is tensor(135.6259, device='cuda:3')
benign distance is  tensor(135.6259, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.04719826579093933
distance 1 is tensor(146.5622, device='cuda:3')
benign distance is  tensor(146.5622, device='cuda:3')
norm1 res is  tensor(0.1588, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.6185847520828247
distance 1 is tensor(131.2679, device='cuda:3')
benign distance is  tensor(131.2679, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.46595367789268494
distance 1 is tensor(143.6251, device='cuda:3')
benign distance is  tensor(143.6251, device='cuda:3')
norm1 res is  tensor(0.1563, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.12245454639196396
distance 1 is tensor(144.7315, device='cuda:3')
benign distance is  tensor(144.7315, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.7383807301521301
distance 1 is tensor(133.0288, device='cuda:3')
benign distance is  tensor(133.0288, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.14056655764579773
distance 1 is tensor(147.1844, device='cuda:3')
benign distance is  tensor(147.1844, device='cuda:3')
norm1 res is  tensor(0.1600, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.7107278108596802
distance 1 is tensor(138.4678, device='cuda:3')
benign distance is  tensor(138.4678, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.429485946893692
distance 1 is tensor(131.3754, device='cuda:3')
benign distance is  tensor(131.3754, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.24785014986991882
distance 1 is tensor(140.9544, device='cuda:3')
benign distance is  tensor(140.9544, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.08962856233119965
distance 1 is tensor(135.2095, device='cuda:3')
benign distance is  tensor(135.2095, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.07220293581485748
distance 1 is tensor(142.3493, device='cuda:3')
benign distance is  tensor(142.3493, device='cuda:3')
norm1 res is  tensor(0.1526, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.33397147059440613
distance 1 is tensor(137.8108, device='cuda:3')
benign distance is  tensor(137.8108, device='cuda:3')
norm1 res is  tensor(0.1516, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.09590639173984528
distance 1 is tensor(134.1979, device='cuda:3')
benign distance is  tensor(134.1979, device='cuda:3')
norm1 res is  tensor(0.1459, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.6164424419403076
distance 1 is tensor(123.3285, device='cuda:3')
benign distance is  tensor(123.3285, device='cuda:3')
norm1 res is  tensor(0.1330, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.6524840593338013
distance 1 is tensor(131.1742, device='cuda:3')
benign distance is  tensor(131.1742, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.5000743865966797
distance 1 is tensor(132.0033, device='cuda:3')
benign distance is  tensor(132.0033, device='cuda:3')
norm1 res is  tensor(0.1407, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(148.1238, device='cuda:3')
compute distance is  tensor(148.1238, device='cuda:3')
compute norm is  tensor(47.1841, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(127.1991, device='cuda:3')
compute distance is  tensor(127.1991, device='cuda:3')
compute norm is  tensor(46.8638, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(141.2598, device='cuda:3')
compute distance is  tensor(141.2598, device='cuda:3')
compute norm is  tensor(47.3267, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.9300, device='cuda:3')
compute distance is  tensor(135.9300, device='cuda:3')
compute norm is  tensor(47.0720, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.4089, device='cuda:3')
compute distance is  tensor(148.4089, device='cuda:3')
compute norm is  tensor(47.2821, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.2532, device='cuda:3')
compute distance is  tensor(148.2532, device='cuda:3')
compute norm is  tensor(47.4406, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.7230, device='cuda:3')
compute distance is  tensor(134.7230, device='cuda:3')
compute norm is  tensor(47.2647, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.6767, device='cuda:3')
compute distance is  tensor(140.6767, device='cuda:3')
compute norm is  tensor(47.2194, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(138.2627, device='cuda:3')
compute distance is  tensor(138.2627, device='cuda:3')
compute norm is  tensor(47.1053, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.0562, device='cuda:3')
compute distance is  tensor(135.0562, device='cuda:3')
compute norm is  tensor(47.0892, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(139.3212, device='cuda:3')
compute distance is  tensor(139.3212, device='cuda:3')
compute norm is  tensor(47.2393, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.4470, device='cuda:3')
compute distance is  tensor(142.4470, device='cuda:3')
compute norm is  tensor(47.3110, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(148.4089, device='cuda:3')
distance 1 is tensor(1869457.2500, device='cuda:3')
________________________________
test distance is  tensor(1869457.2500, device='cuda:3')
test similarity is  tensor(0.0402, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765668972261964e+18
test entropy is  0.0
________________________________
cal ratio is  0.008731688208201952
distance 1 is tensor(16323.5254, device='cuda:3')
cal_distance is  tensor(16323.5254, device='cuda:3')
cal ratio is  0.09344348182635914
distance 1 is tensor(1525.3330, device='cuda:3')
cal_distance is  tensor(1525.3330, device='cuda:3')
cal ratio is  0.3056846638668634
distance 1 is tensor(466.2756, device='cuda:3')
cal_distance is  tensor(466.2756, device='cuda:3')
cal ratio is  0.5528848147818037
distance 1 is tensor(257.7997, device='cuda:3')
cal_distance is  tensor(257.7997, device='cuda:3')
cal ratio is  0.7435578526639193
distance 1 is tensor(191.6908, device='cuda:3')
cal_distance is  tensor(191.6908, device='cuda:3')
cal ratio is  0.8622940520273306
distance 1 is tensor(165.2947, device='cuda:3')
cal_distance is  tensor(165.2947, device='cuda:3')
cal ratio is  0.9285953257517031
distance 1 is tensor(153.4924, device='cuda:3')
cal_distance is  tensor(153.4924, device='cuda:3')
cal ratio is  0.9636350697763076
distance 1 is tensor(147.9109, device='cuda:3')
cal_distance is  tensor(147.9109, device='cuda:3')
distance 1 is tensor(147.9109, device='cuda:3')
________________________________
test distance is  tensor(147.9109, device='cuda:3')
test similarity is  tensor(0.9381, device='cuda:3')
test acc is  0.6198500001563361
test loss is 165.91070591615463
test entropy is  0.00043146033812266766
________________________________
distance 1 is tensor(147.9109, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0003767480570739941
avg test loss is  165.96189812048158
avg accuracy is  0.6186333334896695
solo acc is  0.10138333348966531
compute similarity  is  tensor(0.9381, device='cuda:3')
compute_distance is  tensor(147.9109, device='cuda:3')
compute_norm is  tensor(47.7926, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(133.5764, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9001173161621541
avg test loss is  1.4659723396748623
avg accuracy is  0.8155166668229914
solo acc is  0.29781666682300606
compute similarity  is  tensor(0.9403, device='cuda:3')
compute_distance is  tensor(133.5764, device='cuda:3')
compute_norm is  tensor(47.1172, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.5148, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8835947776654127
avg test loss is  1.5098752378146532
avg accuracy is  0.8120166668229916
solo acc is  0.2537333334896717
compute similarity  is  tensor(0.9401, device='cuda:3')
compute_distance is  tensor(134.5148, device='cuda:3')
compute_norm is  tensor(46.8490, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.4395, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8797232667520356
avg test loss is  1.4861649376497086
avg accuracy is  0.8139666668229915
solo acc is  0.25150000015633833
compute similarity  is  tensor(0.9400, device='cuda:3')
compute_distance is  tensor(135.4395, device='cuda:3')
compute_norm is  tensor(46.5881, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.2678, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8642430330263272
avg test loss is  1.4629867643689805
avg accuracy is  0.8146833334896582
solo acc is  0.25336666682300507
compute similarity  is  tensor(0.9399, device='cuda:3')
compute_distance is  tensor(136.2678, device='cuda:3')
compute_norm is  tensor(46.3369, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.1210, device='cuda:3')
________________________________
test distance is  tensor(137.1210, device='cuda:3')
test similarity is  tensor(0.9398, device='cuda:3')
test acc is  0.8163333334896581
test loss is 1.4457505159794903
test entropy is  0.8628013538780497
________________________________
distance 1 is tensor(137.1210, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8621457946071747
avg test loss is  1.4480885976413165
avg accuracy is  0.8154000001563246
solo acc is  0.24806666682300496
compute similarity  is  tensor(0.9398, device='cuda:3')
compute_distance is  tensor(137.1210, device='cuda:3')
compute_norm is  tensor(46.0921, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.0089, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8586491094087996
avg test loss is  1.4251768042537958
avg accuracy is  0.8175333334896581
solo acc is  0.2509500001563383
compute similarity  is  tensor(0.9397, device='cuda:3')
compute_distance is  tensor(138.0089, device='cuda:3')
compute_norm is  tensor(45.8497, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.9539, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8612943193805751
avg test loss is  1.4188890242373258
avg accuracy is  0.8193000001563245
solo acc is  0.24150000015633805
compute similarity  is  tensor(0.9395, device='cuda:3')
compute_distance is  tensor(138.9539, device='cuda:3')
compute_norm is  tensor(45.6112, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.8796, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8404121911729069
avg test loss is  1.4065403884916163
avg accuracy is  0.8189666668229914
solo acc is  0.2508833334896717
compute similarity  is  tensor(0.9394, device='cuda:3')
compute_distance is  tensor(139.8796, device='cuda:3')
compute_norm is  tensor(45.3779, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.8587, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8399054952013467
avg test loss is  1.3897999638179217
avg accuracy is  0.824516666822991
solo acc is  0.2494166668230049
compute similarity  is  tensor(0.9393, device='cuda:3')
compute_distance is  tensor(140.8587, device='cuda:3')
compute_norm is  tensor(45.1464, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.8603, device='cuda:3')
________________________________
test distance is  tensor(141.8603, device='cuda:3')
test similarity is  tensor(0.9392, device='cuda:3')
test acc is  0.824666666822991
test loss is 1.394149073151383
test entropy is  0.8390693860267525
________________________________
distance 1 is tensor(141.8603, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8384530543645562
avg test loss is  1.3928188032178737
avg accuracy is  0.825266666822991
solo acc is  0.2416166668230046
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(141.8603, device='cuda:3')
compute_norm is  tensor(44.9194, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.9158, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8342672254103841
avg test loss is  1.3800528332877007
avg accuracy is  0.8261333334896576
solo acc is  0.24065000015633797
compute similarity  is  tensor(0.9390, device='cuda:3')
compute_distance is  tensor(142.9158, device='cuda:3')
compute_norm is  tensor(44.6938, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.0344, device='cuda:3')
exit early
distance 1 is tensor(144.0344, device='cuda:3')
________________________________
test distance is  tensor(144.0344, device='cuda:3')
test similarity is  tensor(0.9389, device='cuda:3')
test acc is  0.8271333334896576
test loss is 1.3717540326530238
test entropy is  0.8328503836065467
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.4054811000823975
mal norm is  tensor(711.6653, device='cuda:3')
distance 1 is tensor(144.0344, device='cuda:3')
mal distance is  tensor(144.0344, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(17.1593, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(374.1570, device='cuda:3')
part1 is  tensor(-14.6281, device='cuda:3')
score : tensor(-0.1632, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.5278, device='cuda:3')
part1 is  tensor(8.4645, device='cuda:3')
score : tensor(0.0677, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.0121, device='cuda:3')
part1 is  tensor(42.1580, device='cuda:3')
score : tensor(0.4046, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(460.7605, device='cuda:3')
part1 is  tensor(-6.1265, device='cuda:3')
score : tensor(-0.0782, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(423.7165, device='cuda:3')
part1 is  tensor(-39.3077, device='cuda:3')
score : tensor(-0.4100, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.2950, device='cuda:3')
part1 is  tensor(-15.0994, device='cuda:3')
score : tensor(-0.1680, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(386.5688, device='cuda:3')
part1 is  tensor(20.1344, device='cuda:3')
score : tensor(0.1844, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.0267, device='cuda:3')
part1 is  tensor(7.6866, device='cuda:3')
score : tensor(0.0599, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.6653, device='cuda:3')
part1 is  tensor(-55.5924, device='cuda:3')
score : tensor(-0.5729, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(648.2311, device='cuda:3')
part1 is  tensor(17.1567, device='cuda:3')
score : tensor(0.1546, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.8116, device='cuda:3')
part1 is  tensor(-24.6790, device='cuda:3')
score : tensor(-0.2637, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(602.4103, device='cuda:3')
part1 is  tensor(29.7984, device='cuda:3')
score : tensor(0.2810, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(619.5613, device='cuda:3')
part1 is  tensor(48.0001, device='cuda:3')
score : tensor(0.4630, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.3546, device='cuda:3')
part1 is  tensor(31.1376, device='cuda:3')
score : tensor(0.2944, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(645.5790, device='cuda:3')
part1 is  tensor(-4.3693, device='cuda:3')
score : tensor(-0.0607, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(694.0392, device='cuda:3')
part1 is  tensor(53.4978, device='cuda:3')
score : tensor(0.5180, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.4732, device='cuda:3')
part1 is  tensor(16.8776, device='cuda:3')
score : tensor(0.1518, device='cuda:3')
accept
len accept list 10
len all weights is 10
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.96% 

Test Accuracy: 89.19% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5071218013763428
distance 1 is tensor(97.5339, device='cuda:3')
benign distance is  tensor(97.5339, device='cuda:3')
norm1 res is  tensor(0.1106, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3644951283931732
distance 1 is tensor(121.6309, device='cuda:3')
benign distance is  tensor(121.6309, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.11764673888683319
distance 1 is tensor(100.4201, device='cuda:3')
benign distance is  tensor(100.4201, device='cuda:3')
norm1 res is  tensor(0.1107, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.2546737790107727
distance 1 is tensor(102.9168, device='cuda:3')
benign distance is  tensor(102.9168, device='cuda:3')
norm1 res is  tensor(0.1140, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2731303572654724
distance 1 is tensor(118.8100, device='cuda:3')
benign distance is  tensor(118.8100, device='cuda:3')
norm1 res is  tensor(0.1318, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.1237456798553467
distance 1 is tensor(122.3003, device='cuda:3')
benign distance is  tensor(122.3003, device='cuda:3')
norm1 res is  tensor(0.1343, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.21063748002052307
distance 1 is tensor(92.1481, device='cuda:3')
benign distance is  tensor(92.1481, device='cuda:3')
norm1 res is  tensor(0.1018, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.08063378930091858
distance 1 is tensor(117.9760, device='cuda:3')
benign distance is  tensor(117.9760, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.10091173648834229
distance 1 is tensor(125.2762, device='cuda:3')
benign distance is  tensor(125.2762, device='cuda:3')
norm1 res is  tensor(0.1362, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.47518864274024963
distance 1 is tensor(142.0161, device='cuda:3')
benign distance is  tensor(142.0161, device='cuda:3')
norm1 res is  tensor(0.1544, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.41816920042037964
distance 1 is tensor(117.1569, device='cuda:3')
benign distance is  tensor(117.1569, device='cuda:3')
norm1 res is  tensor(0.1291, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.2666283845901489
distance 1 is tensor(129.7349, device='cuda:3')
benign distance is  tensor(129.7349, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.18726179003715515
distance 1 is tensor(138.4653, device='cuda:3')
benign distance is  tensor(138.4653, device='cuda:3')
norm1 res is  tensor(0.1513, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5949328541755676
distance 1 is tensor(123.0588, device='cuda:3')
benign distance is  tensor(123.0588, device='cuda:3')
norm1 res is  tensor(0.1330, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.1100180521607399
distance 1 is tensor(131.4713, device='cuda:3')
benign distance is  tensor(131.4713, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.2521577775478363
distance 1 is tensor(129.3425, device='cuda:3')
benign distance is  tensor(129.3425, device='cuda:3')
norm1 res is  tensor(0.1391, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(131.8112, device='cuda:3')
compute distance is  tensor(131.8112, device='cuda:3')
compute norm is  tensor(47.0760, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(125.2479, device='cuda:3')
compute distance is  tensor(125.2479, device='cuda:3')
compute norm is  tensor(46.8191, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.0212, device='cuda:3')
compute distance is  tensor(135.0212, device='cuda:3')
compute norm is  tensor(47.3549, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(129.7953, device='cuda:3')
compute distance is  tensor(129.7953, device='cuda:3')
compute norm is  tensor(47.0882, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(132.5352, device='cuda:3')
compute distance is  tensor(132.5352, device='cuda:3')
compute norm is  tensor(47.0445, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.4718, device='cuda:3')
compute distance is  tensor(143.4718, device='cuda:3')
compute norm is  tensor(47.3672, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.8805, device='cuda:3')
compute distance is  tensor(140.8805, device='cuda:3')
compute norm is  tensor(47.3707, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.7780, device='cuda:3')
compute distance is  tensor(142.7780, device='cuda:3')
compute norm is  tensor(47.3129, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(138.2485, device='cuda:3')
compute distance is  tensor(138.2485, device='cuda:3')
compute norm is  tensor(47.1328, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(127.2742, device='cuda:3')
compute distance is  tensor(127.2742, device='cuda:3')
compute norm is  tensor(47.0270, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(138.3934, device='cuda:3')
compute distance is  tensor(138.3934, device='cuda:3')
compute norm is  tensor(47.2021, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(126.1265, device='cuda:3')
compute distance is  tensor(126.1265, device='cuda:3')
compute norm is  tensor(46.9849, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.4718, device='cuda:3')
distance 1 is tensor(1869470.6250, device='cuda:3')
________________________________
test distance is  tensor(1869470.6250, device='cuda:3')
test similarity is  tensor(-0.0125, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766234304099849e+18
test entropy is  0.0
________________________________
cal ratio is  0.008585193778405794
distance 1 is tensor(16049.7734, device='cuda:3')
cal_distance is  tensor(16049.7734, device='cuda:3')
cal ratio is  0.09265630449853102
distance 1 is tensor(1487.1191, device='cuda:3')
cal_distance is  tensor(1487.1191, device='cuda:3')
cal ratio is  0.3043943121245069
distance 1 is tensor(452.6752, device='cuda:3')
cal_distance is  tensor(452.6752, device='cuda:3')
cal ratio is  0.5517166096708731
distance 1 is tensor(249.7515, device='cuda:3')
cal_distance is  tensor(249.7515, device='cuda:3')
cal ratio is  0.7427717461196857
distance 1 is tensor(185.5101, device='cuda:3')
cal_distance is  tensor(185.5101, device='cuda:3')
cal ratio is  0.8618379919946341
distance 1 is tensor(159.8806, device='cuda:3')
cal_distance is  tensor(159.8806, device='cuda:3')
cal ratio is  0.9283496642830757
distance 1 is tensor(148.4256, device='cuda:3')
cal_distance is  tensor(148.4256, device='cuda:3')
cal ratio is  0.963507430662613
distance 1 is tensor(143.0094, device='cuda:3')
cal_distance is  tensor(143.0094, device='cuda:3')
distance 1 is tensor(143.0094, device='cuda:3')
________________________________
test distance is  tensor(143.0094, device='cuda:3')
test similarity is  tensor(0.9411, device='cuda:3')
test acc is  0.721066666822996
test loss is 153.24588918787583
test entropy is  0.0009804587196793081
________________________________
distance 1 is tensor(143.0094, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0008503078075552611
avg test loss is  153.30483808700464
avg accuracy is  0.7206666668229961
solo acc is  0.10358333348966531
compute similarity  is  tensor(0.9411, device='cuda:3')
compute_distance is  tensor(143.0094, device='cuda:3')
compute_norm is  tensor(47.7867, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(129.9902, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9161792411478852
avg test loss is  1.451932971347878
avg accuracy is  0.8400666668229904
solo acc is  0.3100000001563397
compute similarity  is  tensor(0.9429, device='cuda:3')
compute_distance is  tensor(129.9902, device='cuda:3')
compute_norm is  tensor(46.9285, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(131.4801, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8742411099771447
avg test loss is  1.5180281478204707
avg accuracy is  0.8393000001563237
solo acc is  0.2584666668230052
compute similarity  is  tensor(0.9426, device='cuda:3')
compute_distance is  tensor(131.4801, device='cuda:3')
compute_norm is  tensor(46.6503, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.6535, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8800541980307239
avg test loss is  1.4773638936629427
avg accuracy is  0.8407166668229904
solo acc is  0.2553166668230051
compute similarity  is  tensor(0.9424, device='cuda:3')
compute_distance is  tensor(132.6535, device='cuda:3')
compute_norm is  tensor(46.3839, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.9414, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8585629754864585
avg test loss is  1.462242314683349
avg accuracy is  0.8422500001563236
solo acc is  0.2540833334896717
compute similarity  is  tensor(0.9422, device='cuda:3')
compute_distance is  tensor(133.9414, device='cuda:3')
compute_norm is  tensor(46.1228, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.1465, device='cuda:3')
________________________________
test distance is  tensor(135.1465, device='cuda:3')
test similarity is  tensor(0.9421, device='cuda:3')
test acc is  0.8439166668229902
test loss is 1.4377532839012552
test entropy is  0.8566743814106434
________________________________
distance 1 is tensor(135.1465, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8551119307338048
avg test loss is  1.4390269272617187
avg accuracy is  0.844583333489657
solo acc is  0.253416666823005
compute similarity  is  tensor(0.9421, device='cuda:3')
compute_distance is  tensor(135.1465, device='cuda:3')
compute_norm is  tensor(45.8705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.3553, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8447819563752806
avg test loss is  1.4171581891045641
avg accuracy is  0.8441500001563235
solo acc is  0.25776666682300525
compute similarity  is  tensor(0.9419, device='cuda:3')
compute_distance is  tensor(136.3553, device='cuda:3')
compute_norm is  tensor(45.6229, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.5608, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8454401162006199
avg test loss is  1.4027189171390493
avg accuracy is  0.84651666682299
solo acc is  0.2548000001563385
compute similarity  is  tensor(0.9417, device='cuda:3')
compute_distance is  tensor(137.5608, device='cuda:3')
compute_norm is  tensor(45.3808, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.8136, device='cuda:3')
exit early
distance 1 is tensor(138.8136, device='cuda:3')
________________________________
test distance is  tensor(138.8136, device='cuda:3')
test similarity is  tensor(0.9416, device='cuda:3')
test acc is  0.84746666682299
test loss is 1.3972605347379183
test entropy is  0.8436300965514518
________________________________
distance 1 is tensor(138.8136, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.842817975577515
avg test loss is  1.3979355267116003
avg accuracy is  0.84871666682299
solo acc is  0.24713333348967154
compute similarity  is  tensor(0.9416, device='cuda:3')
compute_distance is  tensor(138.8136, device='cuda:3')
compute_norm is  tensor(45.1420, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0742, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8449480698815287
avg test loss is  1.3831971749059682
avg accuracy is  0.84801666682299
solo acc is  0.24980000015633824
compute similarity  is  tensor(0.9414, device='cuda:3')
compute_distance is  tensor(140.0742, device='cuda:3')
compute_norm is  tensor(44.9077, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.3545, device='cuda:3')
exit early
distance 1 is tensor(141.3545, device='cuda:3')
________________________________
test distance is  tensor(141.3545, device='cuda:3')
test similarity is  tensor(0.9412, device='cuda:3')
test acc is  0.8526000001563232
test loss is 1.3801312344923202
test entropy is  0.840592583105254
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.5446641445159912
mal norm is  tensor(701.7934, device='cuda:3')
distance 1 is tensor(141.3545, device='cuda:3')
mal distance is  tensor(141.3545, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(13.3147, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(428.2075, device='cuda:3')
part1 is  tensor(-6.6847, device='cuda:3')
score : tensor(-0.0800, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(527.9207, device='cuda:3')
part1 is  tensor(-16.0063, device='cuda:3')
score : tensor(-0.1732, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(438.4990, device='cuda:3')
part1 is  tensor(8.4798, device='cuda:3')
score : tensor(0.0717, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(449.0469, device='cuda:3')
part1 is  tensor(-23.0101, device='cuda:3')
score : tensor(-0.2432, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.0339, device='cuda:3')
part1 is  tensor(-36.6786, device='cuda:3')
score : tensor(-0.3799, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.7839, device='cuda:3')
part1 is  tensor(-38.3920, device='cuda:3')
score : tensor(-0.3970, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(396.0328, device='cuda:3')
part1 is  tensor(3.3230, device='cuda:3')
score : tensor(0.0201, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.4024, device='cuda:3')
part1 is  tensor(3.3467, device='cuda:3')
score : tensor(0.0204, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.7934, device='cuda:3')
part1 is  tensor(-15.7730, device='cuda:3')
score : tensor(-0.1708, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.8203, device='cuda:3')
part1 is  tensor(7.4302, device='cuda:3')
score : tensor(0.0612, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(607.2508, device='cuda:3')
part1 is  tensor(-33.5591, device='cuda:3')
score : tensor(-0.3487, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.4464, device='cuda:3')
part1 is  tensor(-6.4249, device='cuda:3')
score : tensor(-0.0774, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.5602, device='cuda:3')
part1 is  tensor(-27.9294, device='cuda:3')
score : tensor(-0.2924, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(636.1836, device='cuda:3')
part1 is  tensor(-24.7289, device='cuda:3')
score : tensor(-0.2604, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.2251, device='cuda:3')
part1 is  tensor(-7.7213, device='cuda:3')
score : tensor(-0.0903, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(582.0883, device='cuda:3')
part1 is  tensor(-3.9887, device='cuda:3')
score : tensor(-0.0530, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(593.2319, device='cuda:3')
part1 is  tensor(-28.5618, device='cuda:3')
score : tensor(-0.2987, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 90.01% 

Test Accuracy: 88.94% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
 benign loss is  0.28879010677337646
distance 1 is tensor(119.8637, device='cuda:3')
benign distance is  tensor(119.8637, device='cuda:3')
norm1 res is  tensor(0.1319, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5394147634506226
distance 1 is tensor(124.7113, device='cuda:3')
benign distance is  tensor(124.7113, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.23232479393482208
distance 1 is tensor(102.5102, device='cuda:3')
benign distance is  tensor(102.5102, device='cuda:3')
norm1 res is  tensor(0.1120, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5788981914520264
distance 1 is tensor(121.2619, device='cuda:3')
benign distance is  tensor(121.2619, device='cuda:3')
norm1 res is  tensor(0.1323, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.38442185521125793
distance 1 is tensor(112.9318, device='cuda:3')
benign distance is  tensor(112.9318, device='cuda:3')
norm1 res is  tensor(0.1249, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.34209194779396057
distance 1 is tensor(138.5014, device='cuda:3')
benign distance is  tensor(138.5014, device='cuda:3')
norm1 res is  tensor(0.1516, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.05039016157388687
distance 1 is tensor(92.9625, device='cuda:3')
benign distance is  tensor(92.9625, device='cuda:3')
norm1 res is  tensor(0.1049, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3011135160923004
distance 1 is tensor(105.4866, device='cuda:3')
benign distance is  tensor(105.4866, device='cuda:3')
norm1 res is  tensor(0.1160, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.30058154463768005
distance 1 is tensor(126.8625, device='cuda:3')
benign distance is  tensor(126.8625, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.24311819672584534
distance 1 is tensor(132.1537, device='cuda:3')
benign distance is  tensor(132.1537, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.3242044448852539
distance 1 is tensor(137.7272, device='cuda:3')
benign distance is  tensor(137.7272, device='cuda:3')
norm1 res is  tensor(0.1527, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.4063233435153961
distance 1 is tensor(147.6207, device='cuda:3')
benign distance is  tensor(147.6207, device='cuda:3')
norm1 res is  tensor(0.1626, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.08948565274477005
distance 1 is tensor(132.4897, device='cuda:3')
benign distance is  tensor(132.4897, device='cuda:3')
norm1 res is  tensor(0.1463, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.04514443129301071
distance 1 is tensor(139.2481, device='cuda:3')
benign distance is  tensor(139.2481, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.3584616482257843
distance 1 is tensor(135.4749, device='cuda:3')
benign distance is  tensor(135.4749, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.47135597467422485
distance 1 is tensor(144.9724, device='cuda:3')
benign distance is  tensor(144.9724, device='cuda:3')
norm1 res is  tensor(0.1613, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(141.6367, device='cuda:3')
compute distance is  tensor(141.6367, device='cuda:3')
compute norm is  tensor(47.5816, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.7870, device='cuda:3')
compute distance is  tensor(140.7870, device='cuda:3')
compute norm is  tensor(47.5903, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.4776, device='cuda:3')
compute distance is  tensor(152.4776, device='cuda:3')
compute norm is  tensor(48.1332, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.8493, device='cuda:3')
compute distance is  tensor(143.8493, device='cuda:3')
compute norm is  tensor(47.7333, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(141.2797, device='cuda:3')
compute distance is  tensor(141.2797, device='cuda:3')
compute norm is  tensor(47.5943, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(157.3830, device='cuda:3')
compute distance is  tensor(157.3830, device='cuda:3')
compute norm is  tensor(48.0309, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(153.9444, device='cuda:3')
compute distance is  tensor(153.9444, device='cuda:3')
compute norm is  tensor(48.0891, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.3079, device='cuda:3')
compute distance is  tensor(155.3079, device='cuda:3')
compute norm is  tensor(48.0387, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(170.7899, device='cuda:3')
compute distance is  tensor(170.7899, device='cuda:3')
compute norm is  tensor(48.3758, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.9254, device='cuda:3')
compute distance is  tensor(143.9254, device='cuda:3')
compute norm is  tensor(47.7164, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.7726, device='cuda:3')
compute distance is  tensor(147.7726, device='cuda:3')
compute norm is  tensor(47.8513, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.8461, device='cuda:3')
compute distance is  tensor(154.8461, device='cuda:3')
compute norm is  tensor(48.0206, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.7899, device='cuda:3')
distance 1 is tensor(1869467.3750, device='cuda:3')
________________________________
test distance is  tensor(1869467.3750, device='cuda:3')
test similarity is  tensor(-0.0094, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766628867012383e+18
test entropy is  0.0
________________________________
cal ratio is  0.009366950923909314
distance 1 is tensor(17511.2148, device='cuda:3')
cal_distance is  tensor(17511.2148, device='cuda:3')
cal ratio is  0.09678299208940157
distance 1 is tensor(1694.7939, device='cuda:3')
cal_distance is  tensor(1694.7939, device='cuda:3')
cal ratio is  0.31109908212894505
distance 1 is tensor(527.2535, device='cuda:3')
cal_distance is  tensor(527.2535, device='cuda:3')
cal ratio is  0.5577601248144054
distance 1 is tensor(294.0839, device='cuda:3')
cal_distance is  tensor(294.0839, device='cuda:3')
cal ratio is  0.7468296469321682
distance 1 is tensor(219.6323, device='cuda:3')
cal_distance is  tensor(219.6323, device='cuda:3')
cal ratio is  0.8641896801799173
distance 1 is tensor(189.8049, device='cuda:3')
cal_distance is  tensor(189.8049, device='cuda:3')
cal ratio is  0.9296157481610408
distance 1 is tensor(176.4461, device='cuda:3')
cal_distance is  tensor(176.4461, device='cuda:3')
cal ratio is  0.9641645752024957
distance 1 is tensor(170.1233, device='cuda:3')
cal_distance is  tensor(170.1233, device='cuda:3')
distance 1 is tensor(170.1233, device='cuda:3')
________________________________
test distance is  tensor(170.1233, device='cuda:3')
test similarity is  tensor(0.9213, device='cuda:3')
test acc is  0.5208833334896756
test loss is 329.19184758363247
test entropy is  5.2505729103289644e-05
________________________________
distance 1 is tensor(170.1233, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.740977167315973e-05
avg test loss is  329.0306533780942
avg accuracy is  0.5191333334896755
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9213, device='cuda:3')
compute_distance is  tensor(170.1233, device='cuda:3')
compute_norm is  tensor(49.0019, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(150.2607, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9580427597580689
avg test loss is  1.5144271548114605
avg accuracy is  0.8203500001563245
solo acc is  0.28568333348967256
compute similarity  is  tensor(0.9254, device='cuda:3')
compute_distance is  tensor(150.2607, device='cuda:3')
compute_norm is  tensor(48.2580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.7570, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.901546472616033
avg test loss is  1.5485466661483749
avg accuracy is  0.8192166668229912
solo acc is  0.25363333348967176
compute similarity  is  tensor(0.9251, device='cuda:3')
compute_distance is  tensor(151.7570, device='cuda:3')
compute_norm is  tensor(47.9807, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.9195, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.892080872869695
avg test loss is  1.514658648195043
avg accuracy is  0.8201666668229912
solo acc is  0.2542333334896717
compute similarity  is  tensor(0.9249, device='cuda:3')
compute_distance is  tensor(152.9195, device='cuda:3')
compute_norm is  tensor(47.7084, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.9418, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8771910031340016
avg test loss is  1.5012280041220853
avg accuracy is  0.8240000001563244
solo acc is  0.24976666682300497
compute similarity  is  tensor(0.9248, device='cuda:3')
compute_distance is  tensor(153.9418, device='cuda:3')
compute_norm is  tensor(47.4474, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.9562, device='cuda:3')
________________________________
test distance is  tensor(154.9562, device='cuda:3')
test similarity is  tensor(0.9246, device='cuda:3')
test acc is  0.8275166668229909
test loss is 1.4815829028961247
test entropy is  0.8785930352805774
________________________________
distance 1 is tensor(154.9562, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.877962367493969
avg test loss is  1.4830916934430218
avg accuracy is  0.8281000001563242
solo acc is  0.24231666682300465
compute similarity  is  tensor(0.9246, device='cuda:3')
compute_distance is  tensor(154.9562, device='cuda:3')
compute_norm is  tensor(47.1909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.8831, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8666118114614791
avg test loss is  1.4531872071691159
avg accuracy is  0.8278833334896575
solo acc is  0.2522000001563383
compute similarity  is  tensor(0.9245, device='cuda:3')
compute_distance is  tensor(155.8831, device='cuda:3')
compute_norm is  tensor(46.9375, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.9435, device='cuda:3')
exit early
distance 1 is tensor(156.9435, device='cuda:3')
________________________________
test distance is  tensor(156.9435, device='cuda:3')
test similarity is  tensor(0.9243, device='cuda:3')
test acc is  0.8331333334896572
test loss is 1.452414553811047
test entropy is  0.8600488906857301
________________________________
distance 1 is tensor(156.9435, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8602895086635151
avg test loss is  1.449670404894774
avg accuracy is  0.8307333334896574
solo acc is  0.2428666668230047
compute similarity  is  tensor(0.9243, device='cuda:3')
compute_distance is  tensor(156.9435, device='cuda:3')
compute_norm is  tensor(46.6906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.9919, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8499722198001357
avg test loss is  1.4385121028814742
avg accuracy is  0.834250000156324
solo acc is  0.24450000015633808
compute similarity  is  tensor(0.9241, device='cuda:3')
compute_distance is  tensor(157.9919, device='cuda:3')
compute_norm is  tensor(46.4493, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(159.0387, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.848384932922656
avg test loss is  1.4166638078465899
avg accuracy is  0.835600000156324
solo acc is  0.24598333348967144
compute similarity  is  tensor(0.9240, device='cuda:3')
compute_distance is  tensor(159.0387, device='cuda:3')
compute_norm is  tensor(46.2100, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(160.1288, device='cuda:3')
exit early
distance 1 is tensor(160.1288, device='cuda:3')
________________________________
test distance is  tensor(160.1288, device='cuda:3')
test similarity is  tensor(0.9238, device='cuda:3')
test acc is  0.8373333334896572
test loss is 1.419187388567528
test entropy is  0.8457786693120561
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2840266227722168
mal norm is  tensor(817.4938, device='cuda:3')
distance 1 is tensor(160.1288, device='cuda:3')
mal distance is  tensor(160.1288, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(8.2202, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.1544, device='cuda:3')
part1 is  tensor(13.5691, device='cuda:3')
score : tensor(0.1277, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.6667, device='cuda:3')
part1 is  tensor(13.4842, device='cuda:3')
score : tensor(0.1268, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(440.1802, device='cuda:3')
part1 is  tensor(6.5795, device='cuda:3')
score : tensor(0.0578, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(522.8979, device='cuda:3')
part1 is  tensor(-21.3833, device='cuda:3')
score : tensor(-0.2219, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.1285, device='cuda:3')
part1 is  tensor(-5.2616, device='cuda:3')
score : tensor(-0.0606, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.0040, device='cuda:3')
part1 is  tensor(3.1384, device='cuda:3')
score : tensor(0.0234, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(397.4442, device='cuda:3')
part1 is  tensor(-8.0770, device='cuda:3')
score : tensor(-0.0888, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(460.3379, device='cuda:3')
part1 is  tensor(-6.3000, device='cuda:3')
score : tensor(-0.0710, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.4938, device='cuda:3')
part1 is  tensor(27.4679, device='cuda:3')
score : tensor(0.2667, device='cuda:3')
accept
len accept list 16
len all weights is 16
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 82.92% 

Test Accuracy: 82.41% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
 benign loss is  0.44242650270462036
distance 1 is tensor(156.4112, device='cuda:3')
benign distance is  tensor(156.4112, device='cuda:3')
norm1 res is  tensor(0.1617, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.473585844039917
distance 1 is tensor(172.4386, device='cuda:3')
benign distance is  tensor(172.4386, device='cuda:3')
norm1 res is  tensor(0.1783, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.11005067825317383
distance 1 is tensor(162.3278, device='cuda:3')
benign distance is  tensor(162.3278, device='cuda:3')
norm1 res is  tensor(0.1647, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.1464632898569107
distance 1 is tensor(164.6755, device='cuda:3')
benign distance is  tensor(164.6755, device='cuda:3')
norm1 res is  tensor(0.1673, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7908104658126831
distance 1 is tensor(171.2380, device='cuda:3')
benign distance is  tensor(171.2380, device='cuda:3')
norm1 res is  tensor(0.1734, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.051648736000061
distance 1 is tensor(192.8119, device='cuda:3')
benign distance is  tensor(192.8119, device='cuda:3')
norm1 res is  tensor(0.1933, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.34974196553230286
distance 1 is tensor(161.4890, device='cuda:3')
benign distance is  tensor(161.4890, device='cuda:3')
norm1 res is  tensor(0.1661, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.40390458703041077
distance 1 is tensor(169.3273, device='cuda:3')
benign distance is  tensor(169.3273, device='cuda:3')
norm1 res is  tensor(0.1749, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(174.8969, device='cuda:3')
compute distance is  tensor(174.8969, device='cuda:3')
compute norm is  tensor(47.3530, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(171.5100, device='cuda:3')
compute distance is  tensor(171.5100, device='cuda:3')
compute norm is  tensor(47.2765, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(181.6337, device='cuda:3')
compute distance is  tensor(181.6337, device='cuda:3')
compute norm is  tensor(47.7374, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(177.5915, device='cuda:3')
compute distance is  tensor(177.5915, device='cuda:3')
compute norm is  tensor(47.4322, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(181.8691, device='cuda:3')
compute distance is  tensor(181.8691, device='cuda:3')
compute norm is  tensor(47.5910, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.9886, device='cuda:3')
compute distance is  tensor(184.9886, device='cuda:3')
compute norm is  tensor(47.8387, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(177.1161, device='cuda:3')
compute distance is  tensor(177.1161, device='cuda:3')
compute norm is  tensor(47.6263, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(180.0738, device='cuda:3')
compute distance is  tensor(180.0738, device='cuda:3')
compute norm is  tensor(47.5879, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(187.0594, device='cuda:3')
compute distance is  tensor(187.0594, device='cuda:3')
compute norm is  tensor(47.9025, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(169.9732, device='cuda:3')
compute distance is  tensor(169.9732, device='cuda:3')
compute norm is  tensor(47.4550, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.7459, device='cuda:3')
compute distance is  tensor(184.7459, device='cuda:3')
compute norm is  tensor(47.8305, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(186.5182, device='cuda:3')
compute distance is  tensor(186.5182, device='cuda:3')
compute norm is  tensor(47.7003, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(187.0594, device='cuda:3')
distance 1 is tensor(1869407.3750, device='cuda:3')
________________________________
test distance is  tensor(1869407.3750, device='cuda:3')
test similarity is  tensor(0.2033, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.764312520708523e+18
test entropy is  0.0
________________________________
cal ratio is  0.009803110036508515
distance 1 is tensor(18326.0117, device='cuda:3')
cal_distance is  tensor(18326.0117, device='cuda:3')
cal ratio is  0.09901064130391211
distance 1 is tensor(1814.4763, device='cuda:3')
cal_distance is  tensor(1814.4763, device='cuda:3')
cal ratio is  0.3146590231802508
distance 1 is tensor(570.9459, device='cuda:3')
cal_distance is  tensor(570.9459, device='cuda:3')
cal ratio is  0.5609425054236525
distance 1 is tensor(320.2708, device='cuda:3')
cal_distance is  tensor(320.2708, device='cuda:3')
cal ratio is  0.7489574403257887
distance 1 is tensor(239.8709, device='cuda:3')
cal_distance is  tensor(239.8709, device='cuda:3')
cal ratio is  0.865420246862231
distance 1 is tensor(207.5901, device='cuda:3')
cal_distance is  tensor(207.5901, device='cuda:3')
cal ratio is  0.930277604091555
distance 1 is tensor(193.1169, device='cuda:3')
cal_distance is  tensor(193.1169, device='cuda:3')
cal ratio is  0.9645077728696894
distance 1 is tensor(186.2629, device='cuda:3')
cal_distance is  tensor(186.2629, device='cuda:3')
distance 1 is tensor(186.2629, device='cuda:3')
________________________________
test distance is  tensor(186.2629, device='cuda:3')
test similarity is  tensor(0.9234, device='cuda:3')
test acc is  0.10281666682299863
test loss is 495.69817783380114
test entropy is  4.172418464783274e-43
________________________________
distance 1 is tensor(186.2629, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.312968951063433e-35
avg test loss is  495.67191225226753
avg accuracy is  0.10286666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9234, device='cuda:3')
compute_distance is  tensor(186.2629, device='cuda:3')
compute_norm is  tensor(50.8713, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(182.7987, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.024471217190533
avg test loss is  1.622232834794628
avg accuracy is  0.3871333334896743
solo acc is  0.24941666682300492
compute similarity  is  tensor(0.9253, device='cuda:3')
compute_distance is  tensor(182.7987, device='cuda:3')
compute_norm is  tensor(51.0861, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(182.5886, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6314331468806338
avg test loss is  2.475177094880452
avg accuracy is  0.25086666682300496
solo acc is  0.11145000015633195
compute similarity  is  tensor(0.9253, device='cuda:3')
compute_distance is  tensor(182.5886, device='cuda:3')
compute_norm is  tensor(50.9351, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(181.6213, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9674208126088449
avg test loss is  1.505180839409452
avg accuracy is  0.4221000001563413
solo acc is  0.26580000015633864
compute similarity  is  tensor(0.9256, device='cuda:3')
compute_distance is  tensor(181.6213, device='cuda:3')
compute_norm is  tensor(50.5394, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance 1 is tensor(181.6213, device='cuda:3')
________________________________
test distance is  tensor(181.6213, device='cuda:3')
test similarity is  tensor(0.9256, device='cuda:3')
test acc is  0.42008333348967464
test loss is 1.5052486797893987
test entropy is  0.966432802331473
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.39301598072052
mal norm is  tensor(923.3329, device='cuda:3')
distance 1 is tensor(181.6213, device='cuda:3')
mal distance is  tensor(181.6213, device='cuda:3')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(22.5446, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(631.7510, device='cuda:3')
part1 is  tensor(165.0439, device='cuda:3')
score : tensor(1.6281, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(701.6675, device='cuda:3')
part1 is  tensor(208.7564, device='cuda:3')
score : tensor(2.0652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(646.2598, device='cuda:3')
part1 is  tensor(161.7954, device='cuda:3')
score : tensor(1.5956, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(661.9414, device='cuda:3')
part1 is  tensor(148.1819, device='cuda:3')
score : tensor(1.4595, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.8411, device='cuda:3')
part1 is  tensor(142.1102, device='cuda:3')
score : tensor(1.3988, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.4626, device='cuda:3')
part1 is  tensor(111.8115, device='cuda:3')
score : tensor(1.0958, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.3221, device='cuda:3')
part1 is  tensor(114.2579, device='cuda:3')
score : tensor(1.1202, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.0982, device='cuda:3')
part1 is  tensor(162.1827, device='cuda:3')
score : tensor(1.5995, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(923.3329, device='cuda:3')
part1 is  tensor(-213.4570, device='cuda:3')
score : tensor(-2.1569, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(852.6514, device='cuda:3')
part1 is  tensor(174.9660, device='cuda:3')
score : tensor(1.7273, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(853.0580, device='cuda:3')
part1 is  tensor(175.5907, device='cuda:3')
score : tensor(1.7336, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(817.1457, device='cuda:3')
part1 is  tensor(161.8618, device='cuda:3')
score : tensor(1.5963, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(862.8746, device='cuda:3')
part1 is  tensor(234.8208, device='cuda:3')
score : tensor(2.3259, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(841.5850, device='cuda:3')
part1 is  tensor(142.6287, device='cuda:3')
score : tensor(1.4039, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(868.1216, device='cuda:3')
part1 is  tensor(165.2289, device='cuda:3')
score : tensor(1.6299, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(840.9547, device='cuda:3')
part1 is  tensor(180.6271, device='cuda:3')
score : tensor(1.7839, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(873.9781, device='cuda:3')
part1 is  tensor(143.6519, device='cuda:3')
score : tensor(1.4142, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(787.0997, device='cuda:3')
part1 is  tensor(176.7102, device='cuda:3')
score : tensor(1.7448, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.4234, device='cuda:3')
part1 is  tensor(116.0706, device='cuda:3')
score : tensor(1.1384, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.4294, device='cuda:3')
part1 is  tensor(150.1644, device='cuda:3')
score : tensor(1.4793, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.2825, device='cuda:3')
part1 is  tensor(175.0385, device='cuda:3')
score : tensor(1.7280, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(740.6788, device='cuda:3')
part1 is  tensor(183.7785, device='cuda:3')
score : tensor(1.8154, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(786.1688, device='cuda:3')
part1 is  tensor(137.5448, device='cuda:3')
score : tensor(1.3531, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(756.9021, device='cuda:3')
part1 is  tensor(158.5646, device='cuda:3')
score : tensor(1.5633, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(744.6613, device='cuda:3')
part1 is  tensor(172.8008, device='cuda:3')
score : tensor(1.7057, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(767.9490, device='cuda:3')
part1 is  tensor(182.5233, device='cuda:3')
score : tensor(1.8029, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(815.8121, device='cuda:3')
part1 is  tensor(157.1263, device='cuda:3')
score : tensor(1.5489, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(747.9031, device='cuda:3')
part1 is  tensor(181.1273, device='cuda:3')
score : tensor(1.7889, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(788.0038, device='cuda:3')
part1 is  tensor(176.1643, device='cuda:3')
score : tensor(1.7393, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(818.5259, device='cuda:3')
part1 is  tensor(169.4330, device='cuda:3')
score : tensor(1.6720, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(750.8574, device='cuda:3')
part1 is  tensor(209.8848, device='cuda:3')
score : tensor(2.0765, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(797.5308, device='cuda:3')
part1 is  tensor(154.4371, device='cuda:3')
score : tensor(1.5220, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.3430, device='cuda:3')
part1 is  tensor(165.5933, device='cuda:3')
score : tensor(1.6336, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.0760, device='cuda:3')
part1 is  tensor(197.8863, device='cuda:3')
score : tensor(1.9565, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(775.8329, device='cuda:3')
part1 is  tensor(219.8962, device='cuda:3')
score : tensor(2.1766, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(790.2905, device='cuda:3')
part1 is  tensor(189.3629, device='cuda:3')
score : tensor(1.8713, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(823.4252, device='cuda:3')
part1 is  tensor(184.9153, device='cuda:3')
score : tensor(1.8268, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(761.2540, device='cuda:3')
part1 is  tensor(174.8000, device='cuda:3')
score : tensor(1.7257, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(797.4100, device='cuda:3')
part1 is  tensor(191.9426, device='cuda:3')
score : tensor(1.8971, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(772.4294, device='cuda:3')
part1 is  tensor(134.2151, device='cuda:3')
score : tensor(1.3198, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(818.3434, device='cuda:3')
part1 is  tensor(153.3452, device='cuda:3')
score : tensor(1.5111, device='cuda:3')
accept
len accept list 40
len all weights is 40
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 90.12% 

Test Accuracy: 89.09% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
 benign loss is  0.29790830612182617
distance 1 is tensor(104.0257, device='cuda:3')
benign distance is  tensor(104.0257, device='cuda:3')
norm1 res is  tensor(0.1124, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.29765135049819946
distance 1 is tensor(118.7060, device='cuda:3')
benign distance is  tensor(118.7060, device='cuda:3')
norm1 res is  tensor(0.1316, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.38702836632728577
distance 1 is tensor(108.3790, device='cuda:3')
benign distance is  tensor(108.3790, device='cuda:3')
norm1 res is  tensor(0.1195, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.40067386627197266
distance 1 is tensor(110.2470, device='cuda:3')
benign distance is  tensor(110.2470, device='cuda:3')
norm1 res is  tensor(0.1191, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.26642853021621704
distance 1 is tensor(106.8772, device='cuda:3')
benign distance is  tensor(106.8772, device='cuda:3')
norm1 res is  tensor(0.1143, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8727620840072632
distance 1 is tensor(142.9737, device='cuda:3')
benign distance is  tensor(142.9737, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.36147481203079224
distance 1 is tensor(105.1377, device='cuda:3')
benign distance is  tensor(105.1377, device='cuda:3')
norm1 res is  tensor(0.1144, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3992609977722168
distance 1 is tensor(116.3520, device='cuda:3')
benign distance is  tensor(116.3520, device='cuda:3')
norm1 res is  tensor(0.1273, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.182615727186203
distance 1 is tensor(133.0344, device='cuda:3')
benign distance is  tensor(133.0344, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.6157364845275879
distance 1 is tensor(131.9758, device='cuda:3')
benign distance is  tensor(131.9758, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  1.0335865020751953
distance 1 is tensor(131.2176, device='cuda:3')
benign distance is  tensor(131.2176, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.48409920930862427
distance 1 is tensor(138.7490, device='cuda:3')
benign distance is  tensor(138.7490, device='cuda:3')
norm1 res is  tensor(0.1497, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.4067043364048004
distance 1 is tensor(141.9869, device='cuda:3')
benign distance is  tensor(141.9869, device='cuda:3')
norm1 res is  tensor(0.1551, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.04203588142991066
distance 1 is tensor(133.1752, device='cuda:3')
benign distance is  tensor(133.1752, device='cuda:3')
norm1 res is  tensor(0.1432, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4237440526485443
distance 1 is tensor(139.5469, device='cuda:3')
benign distance is  tensor(139.5469, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4045381546020508
distance 1 is tensor(135.3562, device='cuda:3')
benign distance is  tensor(135.3562, device='cuda:3')
norm1 res is  tensor(0.1471, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.19292768836021423
distance 1 is tensor(136.9558, device='cuda:3')
benign distance is  tensor(136.9558, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.24744562804698944
distance 1 is tensor(148.6799, device='cuda:3')
benign distance is  tensor(148.6799, device='cuda:3')
norm1 res is  tensor(0.1620, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.09808183461427689
distance 1 is tensor(125.1263, device='cuda:3')
benign distance is  tensor(125.1263, device='cuda:3')
norm1 res is  tensor(0.1343, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.11350641399621964
distance 1 is tensor(137.3369, device='cuda:3')
benign distance is  tensor(137.3369, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3890514671802521
distance 1 is tensor(122.1880, device='cuda:3')
benign distance is  tensor(122.1880, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.23676057159900665
distance 1 is tensor(128.6601, device='cuda:3')
benign distance is  tensor(128.6601, device='cuda:3')
norm1 res is  tensor(0.1392, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.29788869619369507
distance 1 is tensor(138.1351, device='cuda:3')
benign distance is  tensor(138.1351, device='cuda:3')
norm1 res is  tensor(0.1497, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.730509877204895
distance 1 is tensor(126.2637, device='cuda:3')
benign distance is  tensor(126.2637, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.30262985825538635
distance 1 is tensor(146.8329, device='cuda:3')
benign distance is  tensor(146.8329, device='cuda:3')
norm1 res is  tensor(0.1581, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.5401701927185059
distance 1 is tensor(126.6283, device='cuda:3')
benign distance is  tensor(126.6283, device='cuda:3')
norm1 res is  tensor(0.1347, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.5821632146835327
distance 1 is tensor(140.0620, device='cuda:3')
benign distance is  tensor(140.0620, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.3040168881416321
distance 1 is tensor(132.5319, device='cuda:3')
benign distance is  tensor(132.5319, device='cuda:3')
norm1 res is  tensor(0.1400, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.5617086291313171
distance 1 is tensor(138.3732, device='cuda:3')
benign distance is  tensor(138.3732, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.020057380199432373
distance 1 is tensor(126.9690, device='cuda:3')
benign distance is  tensor(126.9690, device='cuda:3')
norm1 res is  tensor(0.1378, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.3770403563976288
distance 1 is tensor(134.6663, device='cuda:3')
benign distance is  tensor(134.6663, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.4615711271762848
distance 1 is tensor(135.8125, device='cuda:3')
benign distance is  tensor(135.8125, device='cuda:3')
norm1 res is  tensor(0.1531, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.038090817630290985
distance 1 is tensor(134.2355, device='cuda:3')
benign distance is  tensor(134.2355, device='cuda:3')
norm1 res is  tensor(0.1428, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.08492258936166763
distance 1 is tensor(136.5590, device='cuda:3')
benign distance is  tensor(136.5590, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.16618908941745758
distance 1 is tensor(130.0066, device='cuda:3')
benign distance is  tensor(130.0066, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.1767507940530777
distance 1 is tensor(126.4973, device='cuda:3')
benign distance is  tensor(126.4973, device='cuda:3')
norm1 res is  tensor(0.1358, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.37233680486679077
distance 1 is tensor(129.8789, device='cuda:3')
benign distance is  tensor(129.8789, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.7305113673210144
distance 1 is tensor(137.6632, device='cuda:3')
benign distance is  tensor(137.6632, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.9405509233474731
distance 1 is tensor(135.2598, device='cuda:3')
benign distance is  tensor(135.2598, device='cuda:3')
norm1 res is  tensor(0.1446, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.17563357949256897
distance 1 is tensor(137.1634, device='cuda:3')
benign distance is  tensor(137.1634, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(169.8119, device='cuda:3')
compute distance is  tensor(169.8119, device='cuda:3')
compute norm is  tensor(46.8805, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(173.9324, device='cuda:3')
compute distance is  tensor(173.9324, device='cuda:3')
compute norm is  tensor(46.8954, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(197.1568, device='cuda:3')
compute distance is  tensor(197.1568, device='cuda:3')
compute norm is  tensor(47.8154, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(174.8537, device='cuda:3')
compute distance is  tensor(174.8537, device='cuda:3')
compute norm is  tensor(47.0503, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(188.6446, device='cuda:3')
compute distance is  tensor(188.6446, device='cuda:3')
compute norm is  tensor(47.3222, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.1668, device='cuda:3')
compute distance is  tensor(184.1668, device='cuda:3')
compute norm is  tensor(47.4393, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(177.3117, device='cuda:3')
compute distance is  tensor(177.3117, device='cuda:3')
compute norm is  tensor(47.1536, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(189.8748, device='cuda:3')
compute distance is  tensor(189.8748, device='cuda:3')
compute norm is  tensor(47.2451, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(185.4369, device='cuda:3')
compute distance is  tensor(185.4369, device='cuda:3')
compute norm is  tensor(47.2859, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(181.6694, device='cuda:3')
compute distance is  tensor(181.6694, device='cuda:3')
compute norm is  tensor(47.4479, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.4445, device='cuda:3')
compute distance is  tensor(184.4445, device='cuda:3')
compute norm is  tensor(47.3549, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(179.1064, device='cuda:3')
compute distance is  tensor(179.1064, device='cuda:3')
compute norm is  tensor(47.0783, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(197.1568, device='cuda:3')
distance 1 is tensor(1869454.3750, device='cuda:3')
________________________________
test distance is  tensor(1869454.3750, device='cuda:3')
test similarity is  tensor(0.0498, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.764674289924835e+18
test entropy is  0.0
________________________________
cal ratio is  0.010064091415515314
distance 1 is tensor(18814.3672, device='cuda:3')
cal_distance is  tensor(18814.3672, device='cuda:3')
cal ratio is  0.1003199254222247
distance 1 is tensor(1887.4622, device='cuda:3')
cal_distance is  tensor(1887.4622, device='cuda:3')
cal ratio is  0.3167326830587812
distance 1 is tensor(597.8254, device='cuda:3')
cal_distance is  tensor(597.8254, device='cuda:3')
cal ratio is  0.5627879816589266
distance 1 is tensor(336.4520, device='cuda:3')
cal_distance is  tensor(336.4520, device='cuda:3')
cal ratio is  0.7501886265542921
distance 1 is tensor(252.4041, device='cuda:3')
cal_distance is  tensor(252.4041, device='cuda:3')
cal ratio is  0.8661313906299108
distance 1 is tensor(218.6160, device='cuda:3')
cal_distance is  tensor(218.6160, device='cuda:3')
cal ratio is  0.9306598710597181
distance 1 is tensor(203.4577, device='cuda:3')
cal_distance is  tensor(203.4577, device='cuda:3')
cal ratio is  0.9647060138197416
distance 1 is tensor(196.2771, device='cuda:3')
cal_distance is  tensor(196.2771, device='cuda:3')
distance 1 is tensor(196.2771, device='cuda:3')
________________________________
test distance is  tensor(196.2771, device='cuda:3')
test similarity is  tensor(0.9019, device='cuda:3')
test acc is  0.30003333348967287
test loss is 486.00096338593374
test entropy is  7.17331640419118e-06
________________________________
distance 1 is tensor(196.2771, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.283615497837055e-12
avg test loss is  486.5256274127757
avg accuracy is  0.2996666668230061
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9019, device='cuda:3')
compute_distance is  tensor(196.2771, device='cuda:3')
compute_norm is  tensor(49.8802, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(173.2945, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.010054274281459
avg test loss is  1.5917185467443487
avg accuracy is  0.7498000001563279
solo acc is  0.2715166668230055
compute similarity  is  tensor(0.9070, device='cuda:3')
compute_distance is  tensor(173.2945, device='cuda:3')
compute_norm is  tensor(49.6774, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(174.1357, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.607343880352435
avg test loss is  2.472481408353045
avg accuracy is  0.6731333334896656
solo acc is  0.11398333348966529
compute similarity  is  tensor(0.9067, device='cuda:3')
compute_distance is  tensor(174.1357, device='cuda:3')
compute_norm is  tensor(49.5177, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(173.7842, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9475362145189029
avg test loss is  1.46037389258586
avg accuracy is  0.7650166668229937
solo acc is  0.28576666682300583
compute similarity  is  tensor(0.9071, device='cuda:3')
compute_distance is  tensor(173.7842, device='cuda:3')
compute_norm is  tensor(49.1003, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance 1 is tensor(173.7842, device='cuda:3')
________________________________
test distance is  tensor(173.7842, device='cuda:3')
test similarity is  tensor(0.9071, device='cuda:3')
test acc is  0.7651666668229937
test loss is 1.461752562761815
test entropy is  0.9459010573592521
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3877055644989014
mal norm is  tensor(957.8892, device='cuda:3')
distance 1 is tensor(173.7842, device='cuda:3')
mal distance is  tensor(173.7842, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(16.3277, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(448.2041, device='cuda:3')
part1 is  tensor(21.7115, device='cuda:3')
score : tensor(0.2010, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.0524, device='cuda:3')
part1 is  tensor(-0.1260, device='cuda:3')
score : tensor(-0.0174, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(470.8723, device='cuda:3')
part1 is  tensor(43.3434, device='cuda:3')
score : tensor(0.4173, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(468.3412, device='cuda:3')
part1 is  tensor(13.1613, device='cuda:3')
score : tensor(0.1155, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.7758, device='cuda:3')
part1 is  tensor(5.3194, device='cuda:3')
score : tensor(0.0371, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.3058, device='cuda:3')
part1 is  tensor(-19.0729, device='cuda:3')
score : tensor(-0.2069, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(449.3484, device='cuda:3')
part1 is  tensor(-2.6846, device='cuda:3')
score : tensor(-0.0430, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.4477, device='cuda:3')
part1 is  tensor(-9.9271, device='cuda:3')
score : tensor(-0.1154, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(957.8892, device='cuda:3')
part1 is  tensor(-43.9002, device='cuda:3')
score : tensor(-0.4551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(620.5843, device='cuda:3')
part1 is  tensor(-8.4077, device='cuda:3')
score : tensor(-0.1002, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(592.9150, device='cuda:3')
part1 is  tensor(35.3395, device='cuda:3')
score : tensor(0.3373, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.7333, device='cuda:3')
part1 is  tensor(-10.5965, device='cuda:3')
score : tensor(-0.1221, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.7364, device='cuda:3')
part1 is  tensor(70.0477, device='cuda:3')
score : tensor(0.6843, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.5374, device='cuda:3')
part1 is  tensor(25.1994, device='cuda:3')
score : tensor(0.2359, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(547.4481, device='cuda:3')
part1 is  tensor(-4.1409, device='cuda:3')
score : tensor(-0.0575, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.3798, device='cuda:3')
part1 is  tensor(-5.2198, device='cuda:3')
score : tensor(-0.0683, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(581.3596, device='cuda:3')
part1 is  tensor(5.9355, device='cuda:3')
score : tensor(0.0432, device='cuda:3')
accept
len accept list 8
len all weights is 8
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 88.89% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6178260445594788
distance 1 is tensor(111.0042, device='cuda:3')
benign distance is  tensor(111.0042, device='cuda:3')
norm1 res is  tensor(0.1270, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.44774603843688965
distance 1 is tensor(120.2519, device='cuda:3')
benign distance is  tensor(120.2519, device='cuda:3')
norm1 res is  tensor(0.1341, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.19203010201454163
distance 1 is tensor(100.0608, device='cuda:3')
benign distance is  tensor(100.0608, device='cuda:3')
norm1 res is  tensor(0.1137, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6438671350479126
distance 1 is tensor(121.4538, device='cuda:3')
benign distance is  tensor(121.4538, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6723127365112305
distance 1 is tensor(114.5617, device='cuda:3')
benign distance is  tensor(114.5617, device='cuda:3')
norm1 res is  tensor(0.1241, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4210661053657532
distance 1 is tensor(130.7171, device='cuda:3')
benign distance is  tensor(130.7171, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3566754460334778
distance 1 is tensor(103.3555, device='cuda:3')
benign distance is  tensor(103.3555, device='cuda:3')
norm1 res is  tensor(0.1103, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.12146005779504776
distance 1 is tensor(120.4704, device='cuda:3')
benign distance is  tensor(120.4704, device='cuda:3')
norm1 res is  tensor(0.1317, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.3036380708217621
distance 1 is tensor(127.9310, device='cuda:3')
benign distance is  tensor(127.9310, device='cuda:3')
norm1 res is  tensor(0.1390, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.04557579383254051
distance 1 is tensor(134.6890, device='cuda:3')
benign distance is  tensor(134.6890, device='cuda:3')
norm1 res is  tensor(0.1493, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.714854896068573
distance 1 is tensor(146.3784, device='cuda:3')
benign distance is  tensor(146.3784, device='cuda:3')
norm1 res is  tensor(0.1581, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.29957395792007446
distance 1 is tensor(131.2332, device='cuda:3')
benign distance is  tensor(131.2332, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.11094237864017487
distance 1 is tensor(131.9940, device='cuda:3')
benign distance is  tensor(131.9940, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.39153745770454407
distance 1 is tensor(126.1873, device='cuda:3')
benign distance is  tensor(126.1873, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.27516818046569824
distance 1 is tensor(123.5830, device='cuda:3')
benign distance is  tensor(123.5830, device='cuda:3')
norm1 res is  tensor(0.1344, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.21350137889385223
distance 1 is tensor(132.7815, device='cuda:3')
benign distance is  tensor(132.7815, device='cuda:3')
norm1 res is  tensor(0.1471, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(130.3473, device='cuda:3')
compute distance is  tensor(130.3473, device='cuda:3')
compute norm is  tensor(46.8724, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(127.7891, device='cuda:3')
compute distance is  tensor(127.7891, device='cuda:3')
compute norm is  tensor(46.8148, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.6627, device='cuda:3')
compute distance is  tensor(137.6627, device='cuda:3')
compute norm is  tensor(47.0598, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(126.6570, device='cuda:3')
compute distance is  tensor(126.6570, device='cuda:3')
compute norm is  tensor(46.8279, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.0479, device='cuda:3')
compute distance is  tensor(142.0479, device='cuda:3')
compute norm is  tensor(47.0749, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.6466, device='cuda:3')
compute distance is  tensor(149.6466, device='cuda:3')
compute norm is  tensor(47.4607, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(130.7776, device='cuda:3')
compute distance is  tensor(130.7776, device='cuda:3')
compute norm is  tensor(46.9147, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.3112, device='cuda:3')
compute distance is  tensor(137.3112, device='cuda:3')
compute norm is  tensor(47.0085, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(129.7568, device='cuda:3')
compute distance is  tensor(129.7568, device='cuda:3')
compute norm is  tensor(46.8100, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(127.5181, device='cuda:3')
compute distance is  tensor(127.5181, device='cuda:3')
compute norm is  tensor(46.9576, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.2363, device='cuda:3')
compute distance is  tensor(135.2363, device='cuda:3')
compute norm is  tensor(47.0414, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(133.4559, device='cuda:3')
compute distance is  tensor(133.4559, device='cuda:3')
compute norm is  tensor(46.9317, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.6466, device='cuda:3')
distance 1 is tensor(1869458.5000, device='cuda:3')
________________________________
test distance is  tensor(1869458.5000, device='cuda:3')
test similarity is  tensor(0.0317, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.768831358769967e+18
test entropy is  0.0
________________________________
cal ratio is  0.00876802073522462
distance 1 is tensor(16391.4590, device='cuda:3')
cal_distance is  tensor(16391.4590, device='cuda:3')
cal ratio is  0.09363768759438663
distance 1 is tensor(1534.8644, device='cuda:3')
cal_distance is  tensor(1534.8644, device='cuda:3')
cal ratio is  0.30600216040012257
distance 1 is tensor(469.6765, device='cuda:3')
cal_distance is  tensor(469.6765, device='cuda:3')
cal ratio is  0.5531718238365275
distance 1 is tensor(259.8148, device='cuda:3')
cal_distance is  tensor(259.8148, device='cuda:3')
cal ratio is  0.7437509495224222
distance 1 is tensor(193.2393, device='cuda:3')
cal_distance is  tensor(193.2393, device='cuda:3')
cal ratio is  0.862406038031248
distance 1 is tensor(166.6516, device='cuda:3')
cal_distance is  tensor(166.6516, device='cuda:3')
cal ratio is  0.9286556137020651
distance 1 is tensor(154.7625, device='cuda:3')
cal_distance is  tensor(154.7625, device='cuda:3')
cal ratio is  0.9636662566566673
distance 1 is tensor(149.1396, device='cuda:3')
cal_distance is  tensor(149.1396, device='cuda:3')
distance 1 is tensor(149.1396, device='cuda:3')
________________________________
test distance is  tensor(149.1396, device='cuda:3')
test similarity is  tensor(0.9387, device='cuda:3')
test acc is  0.7196500001563295
test loss is 164.00353850179644
test entropy is  0.0008820304511360373
________________________________
distance 1 is tensor(149.1396, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.001194592283377443
avg test loss is  164.44507079947985
avg accuracy is  0.7218833334896626
solo acc is  0.10308333348966531
compute similarity  is  tensor(0.9387, device='cuda:3')
compute_distance is  tensor(149.1396, device='cuda:3')
compute_norm is  tensor(48.4324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(135.2491, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9182900483293066
avg test loss is  1.4267480025159271
avg accuracy is  0.8426500001563236
solo acc is  0.30531666682300623
compute similarity  is  tensor(0.9405, device='cuda:3')
compute_distance is  tensor(135.2491, device='cuda:3')
compute_norm is  tensor(47.6915, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.3253, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8867876160500655
avg test loss is  1.4960028332179542
avg accuracy is  0.8396666668229904
solo acc is  0.25375000015633836
compute similarity  is  tensor(0.9403, device='cuda:3')
compute_distance is  tensor(136.3253, device='cuda:3')
compute_norm is  tensor(47.4179, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.3073, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.863470041802697
avg test loss is  1.4824703878431178
avg accuracy is  0.8415000001563235
solo acc is  0.2496833334896716
compute similarity  is  tensor(0.9402, device='cuda:3')
compute_distance is  tensor(137.3073, device='cuda:3')
compute_norm is  tensor(47.1555, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.2419, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8608477345661822
avg test loss is  1.4427210252676437
avg accuracy is  0.8431333334896569
solo acc is  0.25590000015633846
compute similarity  is  tensor(0.9400, device='cuda:3')
compute_distance is  tensor(138.2419, device='cuda:3')
compute_norm is  tensor(46.8989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.1423, device='cuda:3')
________________________________
test distance is  tensor(139.1423, device='cuda:3')
test similarity is  tensor(0.9399, device='cuda:3')
test acc is  0.8434500001563235
test loss is 1.4299978222419967
test entropy is  0.8571351837120584
________________________________
distance 1 is tensor(139.1423, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8575639053702608
avg test loss is  1.429322257224939
avg accuracy is  0.8434333334896569
solo acc is  0.25076666682300497
compute similarity  is  tensor(0.9399, device='cuda:3')
compute_distance is  tensor(139.1423, device='cuda:3')
compute_norm is  tensor(46.6511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.0971, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8544132837862857
avg test loss is  1.4184142657434509
avg accuracy is  0.8453666668229901
solo acc is  0.24920000015633828
compute similarity  is  tensor(0.9398, device='cuda:3')
compute_distance is  tensor(140.0971, device='cuda:3')
compute_norm is  tensor(46.4060, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.0831, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8385919090400118
avg test loss is  1.4104331897011697
avg accuracy is  0.8463500001563234
solo acc is  0.2489333334896716
compute similarity  is  tensor(0.9397, device='cuda:3')
compute_distance is  tensor(141.0831, device='cuda:3')
compute_norm is  tensor(46.1662, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.0760, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8467850010913572
avg test loss is  1.3876725339940361
avg accuracy is  0.8466000001563233
solo acc is  0.2470333334896715
compute similarity  is  tensor(0.9395, device='cuda:3')
compute_distance is  tensor(142.0760, device='cuda:3')
compute_norm is  tensor(45.9299, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.1060, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8390910867561918
avg test loss is  1.3788457936061216
avg accuracy is  0.84791666682299
solo acc is  0.24803333348967155
compute similarity  is  tensor(0.9394, device='cuda:3')
compute_distance is  tensor(143.1060, device='cuda:3')
compute_norm is  tensor(45.6970, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.1951, device='cuda:3')
________________________________
test distance is  tensor(144.1951, device='cuda:3')
test similarity is  tensor(0.9393, device='cuda:3')
test acc is  0.84846666682299
test loss is 1.3788350439274997
test entropy is  0.8401699888426611
________________________________
distance 1 is tensor(144.1951, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8389456357910181
avg test loss is  1.3800463102011284
avg accuracy is  0.8485833334896566
solo acc is  0.24008333348967126
compute similarity  is  tensor(0.9393, device='cuda:3')
compute_distance is  tensor(144.1951, device='cuda:3')
compute_norm is  tensor(45.4683, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.3026, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8287335605001145
avg test loss is  1.374938696559304
avg accuracy is  0.8503500001563233
solo acc is  0.2380500001563379
compute similarity  is  tensor(0.9391, device='cuda:3')
compute_distance is  tensor(145.3026, device='cuda:3')
compute_norm is  tensor(45.2426, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.4073, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8352127903814255
avg test loss is  1.3536162675062478
avg accuracy is  0.8519666668229899
solo acc is  0.24325000015633813
compute similarity  is  tensor(0.9390, device='cuda:3')
compute_distance is  tensor(146.4073, device='cuda:3')
compute_norm is  tensor(45.0178, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.5555, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8257470050219026
avg test loss is  1.3415298269374538
avg accuracy is  0.8526333334896565
solo acc is  0.2498666668230049
compute similarity  is  tensor(0.9388, device='cuda:3')
compute_distance is  tensor(147.5555, device='cuda:3')
compute_norm is  tensor(44.7963, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.7551, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8286805235500783
avg test loss is  1.3501372473326319
avg accuracy is  0.8525000001563232
solo acc is  0.23240000015633772
compute similarity  is  tensor(0.9387, device='cuda:3')
compute_distance is  tensor(148.7551, device='cuda:3')
compute_norm is  tensor(44.5786, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.9301, device='cuda:3')
________________________________
test distance is  tensor(149.9301, device='cuda:3')
test similarity is  tensor(0.9385, device='cuda:3')
test acc is  0.8557833334896563
test loss is 1.3352701311934985
test entropy is  0.8227334380912374
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2886815071105957
mal norm is  tensor(718.9750, device='cuda:3')
distance 1 is tensor(149.9301, device='cuda:3')
mal distance is  tensor(149.9301, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(16.5543, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(482.3921, device='cuda:3')
part1 is  tensor(-19.6500, device='cuda:3')
score : tensor(-0.2129, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(523.8572, device='cuda:3')
part1 is  tensor(6.2476, device='cuda:3')
score : tensor(0.0461, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(423.2947, device='cuda:3')
part1 is  tensor(22.0721, device='cuda:3')
score : tensor(0.2044, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(539.2971, device='cuda:3')
part1 is  tensor(-13.3108, device='cuda:3')
score : tensor(-0.1495, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(490.3758, device='cuda:3')
part1 is  tensor(-27.2306, device='cuda:3')
score : tensor(-0.2887, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(568.6028, device='cuda:3')
part1 is  tensor(-8.9668, device='cuda:3')
score : tensor(-0.1060, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(437.2289, device='cuda:3')
part1 is  tensor(-23.5290, device='cuda:3')
score : tensor(-0.2516, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(516.2717, device='cuda:3')
part1 is  tensor(8.8642, device='cuda:3')
score : tensor(0.0723, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(718.9750, device='cuda:3')
part1 is  tensor(-29.7154, device='cuda:3')
score : tensor(-0.3135, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(601.2834, device='cuda:3')
part1 is  tensor(-0.3570, device='cuda:3')
score : tensor(-0.0199, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.0375, device='cuda:3')
part1 is  tensor(-6.1453, device='cuda:3')
score : tensor(-0.0778, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.1944, device='cuda:3')
part1 is  tensor(-21.6781, device='cuda:3')
score : tensor(-0.2331, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.6937, device='cuda:3')
part1 is  tensor(-25.2314, device='cuda:3')
score : tensor(-0.2687, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.7980, device='cuda:3')
part1 is  tensor(9.3839, device='cuda:3')
score : tensor(0.0775, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(584.8101, device='cuda:3')
part1 is  tensor(11.6653, device='cuda:3')
score : tensor(0.1003, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(618.1843, device='cuda:3')
part1 is  tensor(-26.6689, device='cuda:3')
score : tensor(-0.2830, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.2023, device='cuda:3')
part1 is  tensor(-20.2875, device='cuda:3')
score : tensor(-0.2192, device='cuda:3')
len accept list 5
len all weights is 5
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 88.97% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
 benign loss is  0.1923319399356842
distance 1 is tensor(112.7937, device='cuda:3')
benign distance is  tensor(112.7937, device='cuda:3')
norm1 res is  tensor(0.1239, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5246692895889282
distance 1 is tensor(117.3863, device='cuda:3')
benign distance is  tensor(117.3863, device='cuda:3')
norm1 res is  tensor(0.1324, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.08604635298252106
distance 1 is tensor(98.0186, device='cuda:3')
benign distance is  tensor(98.0186, device='cuda:3')
norm1 res is  tensor(0.1069, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5312736630439758
distance 1 is tensor(109.9644, device='cuda:3')
benign distance is  tensor(109.9644, device='cuda:3')
norm1 res is  tensor(0.1190, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6729852557182312
distance 1 is tensor(101.6619, device='cuda:3')
benign distance is  tensor(101.6619, device='cuda:3')
norm1 res is  tensor(0.1099, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.4641919136047363
distance 1 is tensor(130.8379, device='cuda:3')
benign distance is  tensor(130.8379, device='cuda:3')
norm1 res is  tensor(0.1463, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.03479240462183952
distance 1 is tensor(118.3107, device='cuda:3')
benign distance is  tensor(118.3107, device='cuda:3')
norm1 res is  tensor(0.1267, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3550571799278259
distance 1 is tensor(120.6712, device='cuda:3')
benign distance is  tensor(120.6712, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.09848729521036148
distance 1 is tensor(134.4922, device='cuda:3')
benign distance is  tensor(134.4922, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.24453870952129364
distance 1 is tensor(130.0716, device='cuda:3')
benign distance is  tensor(130.0716, device='cuda:3')
norm1 res is  tensor(0.1421, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.1082736998796463
distance 1 is tensor(148.5203, device='cuda:3')
benign distance is  tensor(148.5203, device='cuda:3')
norm1 res is  tensor(0.1630, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5251342058181763
distance 1 is tensor(141.9472, device='cuda:3')
benign distance is  tensor(141.9472, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.24207660555839539
distance 1 is tensor(137.2885, device='cuda:3')
benign distance is  tensor(137.2885, device='cuda:3')
norm1 res is  tensor(0.1512, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.10822010040283203
distance 1 is tensor(120.0900, device='cuda:3')
benign distance is  tensor(120.0900, device='cuda:3')
norm1 res is  tensor(0.1314, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4877176880836487
distance 1 is tensor(141.4015, device='cuda:3')
benign distance is  tensor(141.4015, device='cuda:3')
norm1 res is  tensor(0.1549, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.42747363448143005
distance 1 is tensor(145.7095, device='cuda:3')
benign distance is  tensor(145.7095, device='cuda:3')
norm1 res is  tensor(0.1586, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(139.6825, device='cuda:3')
compute distance is  tensor(139.6825, device='cuda:3')
compute norm is  tensor(47.6004, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(128.4446, device='cuda:3')
compute distance is  tensor(128.4446, device='cuda:3')
compute norm is  tensor(47.4090, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(139.4414, device='cuda:3')
compute distance is  tensor(139.4414, device='cuda:3')
compute norm is  tensor(47.7713, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(138.0840, device='cuda:3')
compute distance is  tensor(138.0840, device='cuda:3')
compute norm is  tensor(47.6400, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(139.7876, device='cuda:3')
compute distance is  tensor(139.7876, device='cuda:3')
compute norm is  tensor(47.6834, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.7964, device='cuda:3')
compute distance is  tensor(137.7964, device='cuda:3')
compute norm is  tensor(47.6636, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.6744, device='cuda:3')
compute distance is  tensor(137.6744, device='cuda:3')
compute norm is  tensor(47.6097, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(144.1746, device='cuda:3')
compute distance is  tensor(144.1746, device='cuda:3')
compute norm is  tensor(47.6689, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.2459, device='cuda:3')
compute distance is  tensor(142.2459, device='cuda:3')
compute norm is  tensor(47.6258, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.1653, device='cuda:3')
compute distance is  tensor(137.1653, device='cuda:3')
compute norm is  tensor(47.6484, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(141.4301, device='cuda:3')
compute distance is  tensor(141.4301, device='cuda:3')
compute norm is  tensor(47.7488, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.1590, device='cuda:3')
compute distance is  tensor(149.1590, device='cuda:3')
compute norm is  tensor(47.8595, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(149.1590, device='cuda:3')
distance 1 is tensor(1869461.1250, device='cuda:3')
________________________________
test distance is  tensor(1869461.1250, device='cuda:3')
test similarity is  tensor(0.0249, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.764320176263364e+18
test entropy is  0.0
________________________________
cal ratio is  0.00875371983949565
distance 1 is tensor(16364.7451, device='cuda:3')
cal_distance is  tensor(16364.7451, device='cuda:3')
cal ratio is  0.09356130124448882
distance 1 is tensor(1531.1130, device='cuda:3')
cal_distance is  tensor(1531.1130, device='cuda:3')
cal ratio is  0.30587729973721595
distance 1 is tensor(468.3374, device='cuda:3')
cal_distance is  tensor(468.3374, device='cuda:3')
cal ratio is  0.5530589891581581
distance 1 is tensor(259.0212, device='cuda:3')
cal_distance is  tensor(259.0212, device='cuda:3')
cal ratio is  0.7436750561597743
distance 1 is tensor(192.6293, device='cuda:3')
cal_distance is  tensor(192.6293, device='cuda:3')
cal ratio is  0.8623620618592509
distance 1 is tensor(166.1172, device='cuda:3')
cal_distance is  tensor(166.1172, device='cuda:3')
cal ratio is  0.9286319120044343
distance 1 is tensor(154.2622, device='cuda:3')
cal_distance is  tensor(154.2622, device='cuda:3')
cal ratio is  0.9636539899374805
distance 1 is tensor(148.6556, device='cuda:3')
cal_distance is  tensor(148.6556, device='cuda:3')
distance 1 is tensor(148.6556, device='cuda:3')
________________________________
test distance is  tensor(148.6556, device='cuda:3')
test similarity is  tensor(0.9399, device='cuda:3')
test acc is  0.7222000001563292
test loss is 166.956083643411
test entropy is  0.001464187014850817
________________________________
distance 1 is tensor(148.6556, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0018150494077918053
avg test loss is  166.73879503034578
avg accuracy is  0.7237333334896626
solo acc is  0.10550000015633197
compute similarity  is  tensor(0.9399, device='cuda:3')
compute_distance is  tensor(148.6556, device='cuda:3')
compute_norm is  tensor(48.7927, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(134.8756, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9191736572586906
avg test loss is  1.4121783078352272
avg accuracy is  0.84716666682299
solo acc is  0.3152666668230065
compute similarity  is  tensor(0.9418, device='cuda:3')
compute_distance is  tensor(134.8756, device='cuda:3')
compute_norm is  tensor(48.0202, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.2229, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8810681984114495
avg test loss is  1.488161984410113
avg accuracy is  0.8455333334896568
solo acc is  0.25911666682300516
compute similarity  is  tensor(0.9416, device='cuda:3')
compute_distance is  tensor(136.2229, device='cuda:3')
compute_norm is  tensor(47.7446, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.2613, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8617927074940728
avg test loss is  1.4543969454541643
avg accuracy is  0.8498333334896565
solo acc is  0.2616500001563386
compute similarity  is  tensor(0.9414, device='cuda:3')
compute_distance is  tensor(137.2613, device='cuda:3')
compute_norm is  tensor(47.4782, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.3466, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8745564728784663
avg test loss is  1.4452650930835749
avg accuracy is  0.8476000001563233
solo acc is  0.24976666682300497
compute similarity  is  tensor(0.9412, device='cuda:3')
compute_distance is  tensor(138.3466, device='cuda:3')
compute_norm is  tensor(47.2205, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.4195, device='cuda:3')
________________________________
test distance is  tensor(139.4195, device='cuda:3')
test similarity is  tensor(0.9411, device='cuda:3')
test acc is  0.8510333334896566
test loss is 1.435276772167637
test entropy is  0.858745923047381
________________________________
distance 1 is tensor(139.4195, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8575981624726293
avg test loss is  1.4380847785010267
avg accuracy is  0.8486333334896566
solo acc is  0.24691666682300487
compute similarity  is  tensor(0.9411, device='cuda:3')
compute_distance is  tensor(139.4195, device='cuda:3')
compute_norm is  tensor(46.9684, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.4677, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8479196511224897
avg test loss is  1.4108698748068007
avg accuracy is  0.8492333334896567
solo acc is  0.2550000001563384
compute similarity  is  tensor(0.9409, device='cuda:3')
compute_distance is  tensor(140.4677, device='cuda:3')
compute_norm is  tensor(46.7214, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.5258, device='cuda:3')
exit early
distance 1 is tensor(141.5258, device='cuda:3')
________________________________
test distance is  tensor(141.5258, device='cuda:3')
test similarity is  tensor(0.9408, device='cuda:3')
test acc is  0.8523333334896566
test loss is 1.4021466182493199
test entropy is  0.8501649040148965
________________________________
distance 1 is tensor(141.5258, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8493350888493219
avg test loss is  1.4059904122403435
avg accuracy is  0.8516166668229899
solo acc is  0.24686666682300484
compute similarity  is  tensor(0.9408, device='cuda:3')
compute_distance is  tensor(141.5258, device='cuda:3')
compute_norm is  tensor(46.4789, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.5500, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.837368865892577
avg test loss is  1.3932130787926695
avg accuracy is  0.8526666668229899
solo acc is  0.24705000015633818
compute similarity  is  tensor(0.9407, device='cuda:3')
compute_distance is  tensor(142.5500, device='cuda:3')
compute_norm is  tensor(46.2410, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.6566, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8374487716378942
avg test loss is  1.3789675292938248
avg accuracy is  0.8545666668229898
solo acc is  0.24910000015633832
compute similarity  is  tensor(0.9405, device='cuda:3')
compute_distance is  tensor(143.6566, device='cuda:3')
compute_norm is  tensor(46.0057, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.7741, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8403643543786331
avg test loss is  1.3640775847028312
avg accuracy is  0.8551833334896565
solo acc is  0.24896666682300492
compute similarity  is  tensor(0.9403, device='cuda:3')
compute_distance is  tensor(144.7741, device='cuda:3')
compute_norm is  tensor(45.7746, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.9244, device='cuda:3')
exit early
distance 1 is tensor(145.9244, device='cuda:3')
________________________________
test distance is  tensor(145.9244, device='cuda:3')
test similarity is  tensor(0.9402, device='cuda:3')
test acc is  0.8572833334896564
test loss is 1.360624228586266
test entropy is  0.8383359093147554
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3858803510665894
mal norm is  tensor(721.8634, device='cuda:3')
distance 1 is tensor(145.9244, device='cuda:3')
mal distance is  tensor(145.9244, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(9.8047, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.8368, device='cuda:3')
part1 is  tensor(11.0945, device='cuda:3')
score : tensor(0.1013, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(517.4455, device='cuda:3')
part1 is  tensor(-12.8139, device='cuda:3')
score : tensor(-0.1377, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(422.9344, device='cuda:3')
part1 is  tensor(7.1245, device='cuda:3')
score : tensor(0.0616, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(471.4265, device='cuda:3')
part1 is  tensor(-9.7200, device='cuda:3')
score : tensor(-0.1068, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(437.9939, device='cuda:3')
part1 is  tensor(-5.6519, device='cuda:3')
score : tensor(-0.0661, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(575.2853, device='cuda:3')
part1 is  tensor(-4.3700, device='cuda:3')
score : tensor(-0.0533, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.9389, device='cuda:3')
part1 is  tensor(17.0851, device='cuda:3')
score : tensor(0.1612, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(532.2160, device='cuda:3')
part1 is  tensor(4.2101, device='cuda:3')
score : tensor(0.0325, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(721.8634, device='cuda:3')
part1 is  tensor(-8.0275, device='cuda:3')
score : tensor(-0.0899, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.2491, device='cuda:3')
part1 is  tensor(-3.8504, device='cuda:3')
score : tensor(-0.0481, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(671.9243, device='cuda:3')
part1 is  tensor(1.1071, device='cuda:3')
score : tensor(0.0015, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.8216, device='cuda:3')
part1 is  tensor(27.2521, device='cuda:3')
score : tensor(0.2629, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.3181, device='cuda:3')
part1 is  tensor(8.2591, device='cuda:3')
score : tensor(0.0730, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(558.1105, device='cuda:3')
part1 is  tensor(6.7990, device='cuda:3')
score : tensor(0.0584, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(583.2159, device='cuda:3')
part1 is  tensor(-2.1950, device='cuda:3')
score : tensor(-0.0316, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.0082, device='cuda:3')
part1 is  tensor(8.8684, device='cuda:3')
score : tensor(0.0791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.2562, device='cuda:3')
part1 is  tensor(5.3388, device='cuda:3')
score : tensor(0.0438, device='cuda:3')
accept
len accept list 10
len all weights is 10
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 90.03% 

Test Accuracy: 89.14% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3286375403404236
distance 1 is tensor(107.9699, device='cuda:3')
benign distance is  tensor(107.9699, device='cuda:3')
norm1 res is  tensor(0.1253, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.46350961923599243
distance 1 is tensor(118.7670, device='cuda:3')
benign distance is  tensor(118.7670, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.14525818824768066
distance 1 is tensor(93.7527, device='cuda:3')
benign distance is  tensor(93.7527, device='cuda:3')
norm1 res is  tensor(0.1017, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3968658447265625
distance 1 is tensor(112.8763, device='cuda:3')
benign distance is  tensor(112.8763, device='cuda:3')
norm1 res is  tensor(0.1256, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5557869672775269
distance 1 is tensor(125.9236, device='cuda:3')
benign distance is  tensor(125.9236, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7493147253990173
distance 1 is tensor(131.7655, device='cuda:3')
benign distance is  tensor(131.7655, device='cuda:3')
norm1 res is  tensor(0.1454, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.29669222235679626
distance 1 is tensor(97.5664, device='cuda:3')
benign distance is  tensor(97.5664, device='cuda:3')
norm1 res is  tensor(0.1066, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.038025617599487305
distance 1 is tensor(106.7445, device='cuda:3')
benign distance is  tensor(106.7445, device='cuda:3')
norm1 res is  tensor(0.1173, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.3856789171695709
distance 1 is tensor(132.4958, device='cuda:3')
benign distance is  tensor(132.4958, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.606092095375061
distance 1 is tensor(148.4611, device='cuda:3')
benign distance is  tensor(148.4611, device='cuda:3')
norm1 res is  tensor(0.1635, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.059338491410017014
distance 1 is tensor(122.2288, device='cuda:3')
benign distance is  tensor(122.2288, device='cuda:3')
norm1 res is  tensor(0.1352, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.09682343900203705
distance 1 is tensor(132.6308, device='cuda:3')
benign distance is  tensor(132.6308, device='cuda:3')
norm1 res is  tensor(0.1473, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.3279776871204376
distance 1 is tensor(129.5199, device='cuda:3')
benign distance is  tensor(129.5199, device='cuda:3')
norm1 res is  tensor(0.1420, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.48678717017173767
distance 1 is tensor(125.5003, device='cuda:3')
benign distance is  tensor(125.5003, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3241059184074402
distance 1 is tensor(133.1424, device='cuda:3')
benign distance is  tensor(133.1424, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.3801562786102295
distance 1 is tensor(126.8987, device='cuda:3')
benign distance is  tensor(126.8987, device='cuda:3')
norm1 res is  tensor(0.1366, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(139.0691, device='cuda:3')
compute distance is  tensor(139.0691, device='cuda:3')
compute norm is  tensor(47.9748, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.3046, device='cuda:3')
compute distance is  tensor(135.3046, device='cuda:3')
compute norm is  tensor(47.8831, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.6044, device='cuda:3')
compute distance is  tensor(154.6044, device='cuda:3')
compute norm is  tensor(48.5669, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(138.6100, device='cuda:3')
compute distance is  tensor(138.6100, device='cuda:3')
compute norm is  tensor(48.1163, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.8770, device='cuda:3')
compute distance is  tensor(158.8770, device='cuda:3')
compute norm is  tensor(48.5979, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.5618, device='cuda:3')
compute distance is  tensor(142.5618, device='cuda:3')
compute norm is  tensor(48.1406, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.8648, device='cuda:3')
compute distance is  tensor(134.8648, device='cuda:3')
compute norm is  tensor(48.1282, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.5169, device='cuda:3')
compute distance is  tensor(152.5169, device='cuda:3')
compute norm is  tensor(48.4651, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.3089, device='cuda:3')
compute distance is  tensor(148.3089, device='cuda:3')
compute norm is  tensor(48.2659, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.8386, device='cuda:3')
compute distance is  tensor(148.8386, device='cuda:3')
compute norm is  tensor(48.2611, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(161.6798, device='cuda:3')
compute distance is  tensor(161.6798, device='cuda:3')
compute norm is  tensor(48.8001, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.4605, device='cuda:3')
compute distance is  tensor(140.4605, device='cuda:3')
compute norm is  tensor(48.1301, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(161.6798, device='cuda:3')
distance 1 is tensor(1869461.3750, device='cuda:3')
________________________________
test distance is  tensor(1869461.3750, device='cuda:3')
test similarity is  tensor(0.0236, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.767784001854995e+18
test entropy is  0.0
________________________________
cal ratio is  0.009113719728902453
distance 1 is tensor(17037.7539, device='cuda:3')
cal_distance is  tensor(17037.7539, device='cuda:3')
cal ratio is  0.0954657832170915
distance 1 is tensor(1626.5287, device='cuda:3')
cal_distance is  tensor(1626.5287, device='cuda:3')
cal ratio is  0.3089747868628453
distance 1 is tensor(502.5610, device='cuda:3')
cal_distance is  tensor(502.5610, device='cuda:3')
cal ratio is  0.5558524399175312
distance 1 is tensor(279.3528, device='cuda:3')
cal_distance is  tensor(279.3528, device='cuda:3')
cal ratio is  0.7455511462974574
distance 1 is tensor(208.2735, device='cuda:3')
cal_distance is  tensor(208.2735, device='cuda:3')
cal ratio is  0.8634494574951397
distance 1 is tensor(179.8345, device='cuda:3')
cal_distance is  tensor(179.8345, device='cuda:3')
cal ratio is  0.9292174657668775
distance 1 is tensor(167.1059, device='cuda:3')
cal_distance is  tensor(167.1059, device='cuda:3')
cal ratio is  0.9639577606284113
distance 1 is tensor(161.0833, device='cuda:3')
cal_distance is  tensor(161.0833, device='cuda:3')
distance 1 is tensor(161.0833, device='cuda:3')
________________________________
test distance is  tensor(161.0833, device='cuda:3')
test similarity is  tensor(0.9307, device='cuda:3')
test acc is  0.6467833334896674
test loss is 234.74058065841447
test entropy is  0.0002975264613940552
________________________________
distance 1 is tensor(161.0833, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0002068601413118776
avg test loss is  234.24010692018945
avg accuracy is  0.647350000156334
solo acc is  0.10078333348966531
compute similarity  is  tensor(0.9307, device='cuda:3')
compute_distance is  tensor(161.0833, device='cuda:3')
compute_norm is  tensor(49.1900, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(142.7766, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9211347478666285
avg test loss is  1.4617646867786642
avg accuracy is  0.8461166668229901
solo acc is  0.29673333348967273
compute similarity  is  tensor(0.9337, device='cuda:3')
compute_distance is  tensor(142.7766, device='cuda:3')
compute_norm is  tensor(48.4370, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.9378, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8754980996854778
avg test loss is  1.5123712331501407
avg accuracy is  0.8431666668229902
solo acc is  0.25505000015633833
compute similarity  is  tensor(0.9334, device='cuda:3')
compute_distance is  tensor(143.9378, device='cuda:3')
compute_norm is  tensor(48.1619, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.9849, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8668605104438277
avg test loss is  1.4811585185878566
avg accuracy is  0.8448000001563235
solo acc is  0.2548500001563384
compute similarity  is  tensor(0.9333, device='cuda:3')
compute_distance is  tensor(144.9849, device='cuda:3')
compute_norm is  tensor(47.8952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.0055, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8674179008012133
avg test loss is  1.4512056756629619
avg accuracy is  0.8448166668229902
solo acc is  0.2564833334896718
compute similarity  is  tensor(0.9332, device='cuda:3')
compute_distance is  tensor(146.0055, device='cuda:3')
compute_norm is  tensor(47.6372, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(147.0700, device='cuda:3')
________________________________
test distance is  tensor(147.0700, device='cuda:3')
test similarity is  tensor(0.9330, device='cuda:3')
test acc is  0.8482166668229901
test loss is 1.4431982020071066
test entropy is  0.8675134755782227
________________________________
distance 1 is tensor(147.0700, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8679536125426099
avg test loss is  1.4452203324100357
avg accuracy is  0.8450833334896568
solo acc is  0.24553333348967146
compute similarity  is  tensor(0.9330, device='cuda:3')
compute_distance is  tensor(147.0700, device='cuda:3')
compute_norm is  tensor(47.3853, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.0750, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8623852007297564
avg test loss is  1.4235609735507193
avg accuracy is  0.8488833334896565
solo acc is  0.24871666682300486
compute similarity  is  tensor(0.9329, device='cuda:3')
compute_distance is  tensor(148.0750, device='cuda:3')
compute_norm is  tensor(47.1371, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.1521, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8501835471785653
avg test loss is  1.4330510462779227
avg accuracy is  0.85001666682299
solo acc is  0.23533333348967111
compute similarity  is  tensor(0.9327, device='cuda:3')
compute_distance is  tensor(149.1521, device='cuda:3')
compute_norm is  tensor(46.8952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.1438, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8567507573917731
avg test loss is  1.3919796028625229
avg accuracy is  0.8494333334896566
solo acc is  0.24851666682300497
compute similarity  is  tensor(0.9326, device='cuda:3')
compute_distance is  tensor(150.1438, device='cuda:3')
compute_norm is  tensor(46.6557, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.2439, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8498469849766445
avg test loss is  1.3996914322696514
avg accuracy is  0.8519500001563233
solo acc is  0.23926666682300463
compute similarity  is  tensor(0.9325, device='cuda:3')
compute_distance is  tensor(151.2439, device='cuda:3')
compute_norm is  tensor(46.4208, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.3501, device='cuda:3')
________________________________
test distance is  tensor(152.3501, device='cuda:3')
test similarity is  tensor(0.9323, device='cuda:3')
test acc is  0.8531666668229898
test loss is 1.3822116681507655
test entropy is  0.8375307598602034
________________________________
distance 1 is tensor(152.3501, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8369447339191112
avg test loss is  1.3867123315075058
avg accuracy is  0.8525166668229898
solo acc is  0.24156666682300462
compute similarity  is  tensor(0.9323, device='cuda:3')
compute_distance is  tensor(152.3501, device='cuda:3')
compute_norm is  tensor(46.1885, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.4229, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8381473408070709
avg test loss is  1.3762668430932294
avg accuracy is  0.8554000001563231
solo acc is  0.24101666682300468
compute similarity  is  tensor(0.9322, device='cuda:3')
compute_distance is  tensor(153.4229, device='cuda:3')
compute_norm is  tensor(45.9601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.5328, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8409477457054643
avg test loss is  1.3620001428417052
avg accuracy is  0.8556666668229898
solo acc is  0.2401666668230046
compute similarity  is  tensor(0.9320, device='cuda:3')
compute_distance is  tensor(154.5328, device='cuda:3')
compute_norm is  tensor(45.7333, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.6848, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8338535601523385
avg test loss is  1.3490379986478322
avg accuracy is  0.8563666668229898
solo acc is  0.24456666682300476
compute similarity  is  tensor(0.9319, device='cuda:3')
compute_distance is  tensor(155.6848, device='cuda:3')
compute_norm is  tensor(45.5086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.8405, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8334010754312787
avg test loss is  1.3431763234677345
avg accuracy is  0.8579333334896563
solo acc is  0.24353333348967138
compute similarity  is  tensor(0.9318, device='cuda:3')
compute_distance is  tensor(156.8405, device='cuda:3')
compute_norm is  tensor(45.2867, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(158.0152, device='cuda:3')
________________________________
test distance is  tensor(158.0152, device='cuda:3')
test similarity is  tensor(0.9316, device='cuda:3')
test acc is  0.8603666668229896
test loss is 1.3294442617562787
test entropy is  0.8317303289609678
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1385843753814697
mal norm is  tensor(769.4324, device='cuda:3')
distance 1 is tensor(158.0152, device='cuda:3')
mal distance is  tensor(158.0152, device='cuda:3')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(14.5501, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(488.8113, device='cuda:3')
part1 is  tensor(-16.6842, device='cuda:3')
score : tensor(-0.1812, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.9850, device='cuda:3')
part1 is  tensor(-5.9364, device='cuda:3')
score : tensor(-0.0737, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(401.9951, device='cuda:3')
part1 is  tensor(2.1470, device='cuda:3')
score : tensor(0.0071, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(494.6131, device='cuda:3')
part1 is  tensor(-1.3718, device='cuda:3')
score : tensor(-0.0281, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(536.2448, device='cuda:3')
part1 is  tensor(-10.6396, device='cuda:3')
score : tensor(-0.1207, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.7269, device='cuda:3')
part1 is  tensor(-21.8664, device='cuda:3')
score : tensor(-0.2330, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(414.9970, device='cuda:3')
part1 is  tensor(-12.0413, device='cuda:3')
score : tensor(-0.1348, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(466.8611, device='cuda:3')
part1 is  tensor(-5.4881, device='cuda:3')
score : tensor(-0.0692, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(769.4324, device='cuda:3')
part1 is  tensor(3.0054, device='cuda:3')
score : tensor(0.0157, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.0091, device='cuda:3')
part1 is  tensor(-13.1362, device='cuda:3')
score : tensor(-0.1457, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(555.2562, device='cuda:3')
part1 is  tensor(-25.2907, device='cuda:3')
score : tensor(-0.2673, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(614.4387, device='cuda:3')
part1 is  tensor(-1.1673, device='cuda:3')
score : tensor(-0.0260, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(577.9734, device='cuda:3')
part1 is  tensor(19.8986, device='cuda:3')
score : tensor(0.1846, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.1632, device='cuda:3')
part1 is  tensor(-28.4410, device='cuda:3')
score : tensor(-0.2988, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(569.5845, device='cuda:3')
part1 is  tensor(-4.9548, device='cuda:3')
score : tensor(-0.0639, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(596.8799, device='cuda:3')
part1 is  tensor(-7.5971, device='cuda:3')
score : tensor(-0.0903, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.2755, device='cuda:3')
part1 is  tensor(-11.0699, device='cuda:3')
score : tensor(-0.1250, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(590.2990, device='cuda:3')
part1 is  tensor(-0.4323, device='cuda:3')
score : tensor(-0.0187, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(579.2798, device='cuda:3')
part1 is  tensor(17.5835, device='cuda:3')
score : tensor(0.1615, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(660.4417, device='cuda:3')
part1 is  tensor(-3.3716, device='cuda:3')
score : tensor(-0.0481, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(629.0865, device='cuda:3')
part1 is  tensor(-29.8512, device='cuda:3')
score : tensor(-0.3129, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.9825, device='cuda:3')
part1 is  tensor(24.3752, device='cuda:3')
score : tensor(0.2294, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.9227, device='cuda:3')
part1 is  tensor(0.5575, device='cuda:3')
score : tensor(-0.0088, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.9073, device='cuda:3')
part1 is  tensor(-13.2671, device='cuda:3')
score : tensor(-0.1470, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(639.2416, device='cuda:3')
part1 is  tensor(-19.9717, device='cuda:3')
score : tensor(-0.2141, device='cuda:3')
len accept list 16
len all weights is 16
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 85.08% 

Test Accuracy: 84.54% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6317480802536011
distance 1 is tensor(137.6448, device='cuda:3')
benign distance is  tensor(137.6448, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.48048537969589233
distance 1 is tensor(148.9040, device='cuda:3')
benign distance is  tensor(148.9040, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.46557897329330444
distance 1 is tensor(148.7163, device='cuda:3')
benign distance is  tensor(148.7163, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.8581131100654602
distance 1 is tensor(150.0994, device='cuda:3')
benign distance is  tensor(150.0994, device='cuda:3')
norm1 res is  tensor(0.1541, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.268524706363678
distance 1 is tensor(149.5384, device='cuda:3')
benign distance is  tensor(149.5384, device='cuda:3')
norm1 res is  tensor(0.1517, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.102160096168518
distance 1 is tensor(159.9318, device='cuda:3')
benign distance is  tensor(159.9318, device='cuda:3')
norm1 res is  tensor(0.1621, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.19976003468036652
distance 1 is tensor(146.0064, device='cuda:3')
benign distance is  tensor(146.0064, device='cuda:3')
norm1 res is  tensor(0.1505, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.29156237840652466
distance 1 is tensor(148.3906, device='cuda:3')
benign distance is  tensor(148.3906, device='cuda:3')
norm1 res is  tensor(0.1548, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.4194389879703522
distance 1 is tensor(170.6556, device='cuda:3')
benign distance is  tensor(170.6556, device='cuda:3')
norm1 res is  tensor(0.1757, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.42648404836654663
distance 1 is tensor(155.4856, device='cuda:3')
benign distance is  tensor(155.4856, device='cuda:3')
norm1 res is  tensor(0.1629, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.22550463676452637
distance 1 is tensor(158.8466, device='cuda:3')
benign distance is  tensor(158.8466, device='cuda:3')
norm1 res is  tensor(0.1617, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5612637400627136
distance 1 is tensor(159.4496, device='cuda:3')
benign distance is  tensor(159.4496, device='cuda:3')
norm1 res is  tensor(0.1641, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3632742762565613
distance 1 is tensor(150.5485, device='cuda:3')
benign distance is  tensor(150.5485, device='cuda:3')
norm1 res is  tensor(0.1540, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.16986533999443054
distance 1 is tensor(161.6779, device='cuda:3')
benign distance is  tensor(161.6779, device='cuda:3')
norm1 res is  tensor(0.1658, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.3398180305957794
distance 1 is tensor(150.3350, device='cuda:3')
benign distance is  tensor(150.3350, device='cuda:3')
norm1 res is  tensor(0.1526, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.4784553647041321
distance 1 is tensor(154.6067, device='cuda:3')
benign distance is  tensor(154.6067, device='cuda:3')
norm1 res is  tensor(0.1592, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.39078840613365173
distance 1 is tensor(171.3641, device='cuda:3')
benign distance is  tensor(171.3641, device='cuda:3')
norm1 res is  tensor(0.1790, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.7007076144218445
distance 1 is tensor(149.0298, device='cuda:3')
benign distance is  tensor(149.0298, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.20873121917247772
distance 1 is tensor(156.1936, device='cuda:3')
benign distance is  tensor(156.1936, device='cuda:3')
norm1 res is  tensor(0.1613, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.18027670681476593
distance 1 is tensor(160.6586, device='cuda:3')
benign distance is  tensor(160.6586, device='cuda:3')
norm1 res is  tensor(0.1626, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.09693723917007446
distance 1 is tensor(154.3584, device='cuda:3')
benign distance is  tensor(154.3584, device='cuda:3')
norm1 res is  tensor(0.1599, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.3107089102268219
distance 1 is tensor(157.5309, device='cuda:3')
benign distance is  tensor(157.5309, device='cuda:3')
norm1 res is  tensor(0.1612, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.7401858568191528
distance 1 is tensor(164.2226, device='cuda:3')
benign distance is  tensor(164.2226, device='cuda:3')
norm1 res is  tensor(0.1709, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.035981543362140656
distance 1 is tensor(155.9874, device='cuda:3')
benign distance is  tensor(155.9874, device='cuda:3')
norm1 res is  tensor(0.1612, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(157.2109, device='cuda:3')
compute distance is  tensor(157.2109, device='cuda:3')
compute norm is  tensor(47.2916, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(160.8762, device='cuda:3')
compute distance is  tensor(160.8762, device='cuda:3')
compute norm is  tensor(47.2836, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(189.6972, device='cuda:3')
compute distance is  tensor(189.6972, device='cuda:3')
compute norm is  tensor(48.3156, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(199.6059, device='cuda:3')
compute distance is  tensor(199.6059, device='cuda:3')
compute norm is  tensor(48.2855, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(183.5701, device='cuda:3')
compute distance is  tensor(183.5701, device='cuda:3')
compute norm is  tensor(47.9419, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.1157, device='cuda:3')
compute distance is  tensor(184.1157, device='cuda:3')
compute norm is  tensor(48.1256, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(180.1767, device='cuda:3')
compute distance is  tensor(180.1767, device='cuda:3')
compute norm is  tensor(47.8388, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(172.4732, device='cuda:3')
compute distance is  tensor(172.4732, device='cuda:3')
compute norm is  tensor(47.5220, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(179.5916, device='cuda:3')
compute distance is  tensor(179.5916, device='cuda:3')
compute norm is  tensor(47.8567, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(176.0242, device='cuda:3')
compute distance is  tensor(176.0242, device='cuda:3')
compute norm is  tensor(47.8581, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(174.6511, device='cuda:3')
compute distance is  tensor(174.6511, device='cuda:3')
compute norm is  tensor(47.7636, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(188.5142, device='cuda:3')
compute distance is  tensor(188.5142, device='cuda:3')
compute norm is  tensor(48.1292, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(199.6059, device='cuda:3')
distance 1 is tensor(1869402.3750, device='cuda:3')
________________________________
test distance is  tensor(1869402.3750, device='cuda:3')
test similarity is  tensor(0.2225, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765141934608905e+18
test entropy is  0.0
________________________________
cal ratio is  0.01012654727763549
distance 1 is tensor(18930.5977, device='cuda:3')
cal_distance is  tensor(18930.5977, device='cuda:3')
cal ratio is  0.10063072916493383
distance 1 is tensor(1905.0061, device='cuda:3')
cal_distance is  tensor(1905.0061, device='cuda:3')
cal ratio is  0.317222950697199
distance 1 is tensor(604.3163, device='cuda:3')
cal_distance is  tensor(604.3163, device='cuda:3')
cal ratio is  0.5632233339182524
distance 1 is tensor(340.3680, device='cuda:3')
cal_distance is  tensor(340.3680, device='cuda:3')
cal ratio is  0.7504788405093266
distance 1 is tensor(255.4407, device='cuda:3')
cal_distance is  tensor(255.4407, device='cuda:3')
cal ratio is  0.866298917487361
distance 1 is tensor(221.2889, device='cuda:3')
cal_distance is  tensor(221.2889, device='cuda:3')
cal ratio is  0.9307498856671735
distance 1 is tensor(205.9651, device='cuda:3')
cal_distance is  tensor(205.9651, device='cuda:3')
cal ratio is  0.9647527121648849
distance 1 is tensor(198.7056, device='cuda:3')
cal_distance is  tensor(198.7056, device='cuda:3')
distance 1 is tensor(198.7056, device='cuda:3')
________________________________
test distance is  tensor(198.7056, device='cuda:3')
test similarity is  tensor(0.9159, device='cuda:3')
test acc is  0.10083333348966532
test loss is 663.5899221587028
test entropy is  0.0
________________________________
distance 1 is tensor(198.7056, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  663.9931463636061
avg accuracy is  0.10075000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9159, device='cuda:3')
compute_distance is  tensor(198.7056, device='cuda:3')
compute_norm is  tensor(51.0217, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(200.6117, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0825897640129651
avg test loss is  1.7779142409245343
avg accuracy is  0.3513166668230071
solo acc is  0.23473333348967113
compute similarity  is  tensor(0.9166, device='cuda:3')
compute_distance is  tensor(200.6117, device='cuda:3')
compute_norm is  tensor(51.9464, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(200.1730, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6316341339652218
avg test loss is  2.5764595819180456
avg accuracy is  0.2310000001563377
solo acc is  0.11203333348966528
compute similarity  is  tensor(0.9168, device='cuda:3')
compute_distance is  tensor(200.1730, device='cuda:3')
compute_norm is  tensor(51.8032, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(198.5391, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9776866173566278
avg test loss is  1.5507165151618436
avg accuracy is  0.4026000001563411
solo acc is  0.2661833334896721
compute similarity  is  tensor(0.9175, device='cuda:3')
compute_distance is  tensor(198.5391, device='cuda:3')
compute_norm is  tensor(51.3247, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance 1 is tensor(198.5391, device='cuda:3')
________________________________
test distance is  tensor(198.5391, device='cuda:3')
test similarity is  tensor(0.9175, device='cuda:3')
test acc is  0.40250000015634113
test loss is 1.547389922365705
test entropy is  0.9774772219820571
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.6192989349365234
mal norm is  tensor(994.1932, device='cuda:3')
distance 1 is tensor(198.5391, device='cuda:3')
mal distance is  tensor(198.5391, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(21.7579, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(560.3378, device='cuda:3')
part1 is  tensor(216.9850, device='cuda:3')
score : tensor(2.1483, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(611.5350, device='cuda:3')
part1 is  tensor(178.9725, device='cuda:3')
score : tensor(1.7682, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.2922, device='cuda:3')
part1 is  tensor(213.5539, device='cuda:3')
score : tensor(2.1140, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.4087, device='cuda:3')
part1 is  tensor(171.3383, device='cuda:3')
score : tensor(1.6918, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.8608, device='cuda:3')
part1 is  tensor(114.5992, device='cuda:3')
score : tensor(1.1244, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.3578, device='cuda:3')
part1 is  tensor(120.0666, device='cuda:3')
score : tensor(1.1791, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(588.5826, device='cuda:3')
part1 is  tensor(186.0288, device='cuda:3')
score : tensor(1.8387, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.6719, device='cuda:3')
part1 is  tensor(148.0082, device='cuda:3')
score : tensor(1.4585, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(994.1932, device='cuda:3')
part1 is  tensor(-163.2932, device='cuda:3')
score : tensor(-1.6545, device='cuda:3')
len accept list 8
len all weights is 8
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 89.66% 

Test Accuracy: 88.79% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4032510817050934
distance 1 is tensor(133.4297, device='cuda:3')
benign distance is  tensor(133.4297, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.48378461599349976
distance 1 is tensor(134.5603, device='cuda:3')
benign distance is  tensor(134.5603, device='cuda:3')
norm1 res is  tensor(0.1432, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.27178025245666504
distance 1 is tensor(118.4950, device='cuda:3')
benign distance is  tensor(118.4950, device='cuda:3')
norm1 res is  tensor(0.1263, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6775587797164917
distance 1 is tensor(119.6792, device='cuda:3')
benign distance is  tensor(119.6792, device='cuda:3')
norm1 res is  tensor(0.1242, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.27104994654655457
distance 1 is tensor(123.0256, device='cuda:3')
benign distance is  tensor(123.0256, device='cuda:3')
norm1 res is  tensor(0.1303, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5592325925827026
distance 1 is tensor(134.6011, device='cuda:3')
benign distance is  tensor(134.6011, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2850547730922699
distance 1 is tensor(110.5435, device='cuda:3')
benign distance is  tensor(110.5435, device='cuda:3')
norm1 res is  tensor(0.1188, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.35426586866378784
distance 1 is tensor(119.1304, device='cuda:3')
benign distance is  tensor(119.1304, device='cuda:3')
norm1 res is  tensor(0.1266, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(154.7412, device='cuda:3')
compute distance is  tensor(154.7412, device='cuda:3')
compute norm is  tensor(47.3552, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.7139, device='cuda:3')
compute distance is  tensor(154.7139, device='cuda:3')
compute norm is  tensor(47.4231, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(162.4639, device='cuda:3')
compute distance is  tensor(162.4639, device='cuda:3')
compute norm is  tensor(47.7764, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(163.3239, device='cuda:3')
compute distance is  tensor(163.3239, device='cuda:3')
compute norm is  tensor(47.6449, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(162.0937, device='cuda:3')
compute distance is  tensor(162.0937, device='cuda:3')
compute norm is  tensor(47.7049, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(168.2645, device='cuda:3')
compute distance is  tensor(168.2645, device='cuda:3')
compute norm is  tensor(47.6521, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.8452, device='cuda:3')
compute distance is  tensor(158.8452, device='cuda:3')
compute norm is  tensor(47.4924, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(174.0049, device='cuda:3')
compute distance is  tensor(174.0049, device='cuda:3')
compute norm is  tensor(47.9529, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(163.5580, device='cuda:3')
compute distance is  tensor(163.5580, device='cuda:3')
compute norm is  tensor(47.5861, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(156.2706, device='cuda:3')
compute distance is  tensor(156.2706, device='cuda:3')
compute norm is  tensor(47.4946, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(159.3709, device='cuda:3')
compute distance is  tensor(159.3709, device='cuda:3')
compute norm is  tensor(47.6826, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.5297, device='cuda:3')
compute distance is  tensor(158.5297, device='cuda:3')
compute norm is  tensor(47.5176, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(174.0049, device='cuda:3')
distance 1 is tensor(1869418.6250, device='cuda:3')
________________________________
test distance is  tensor(1869418.6250, device='cuda:3')
test similarity is  tensor(0.1825, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765614744536031e+18
test entropy is  0.0
________________________________
cal ratio is  0.009454827019043243
distance 1 is tensor(17675.0352, device='cuda:3')
cal_distance is  tensor(17675.0352, device='cuda:3')
cal ratio is  0.09723591836695676
distance 1 is tensor(1718.6544, device='cuda:3')
cal_distance is  tensor(1718.6544, device='cuda:3')
cal ratio is  0.31182618575227367
distance 1 is tensor(535.9261, device='cuda:3')
cal_distance is  tensor(535.9261, device='cuda:3')
cal ratio is  0.5584115632240075
distance 1 is tensor(299.2703, device='cuda:3')
cal_distance is  tensor(299.2703, device='cuda:3')
cal ratio is  0.7472656950005888
distance 1 is tensor(223.6361, device='cuda:3')
cal_distance is  tensor(223.6361, device='cuda:3')
cal ratio is  0.8644420193985748
distance 1 is tensor(193.3214, device='cuda:3')
cal_distance is  tensor(193.3214, device='cuda:3')
cal ratio is  0.9297515187380584
distance 1 is tensor(179.7414, device='cuda:3')
cal_distance is  tensor(179.7414, device='cuda:3')
cal ratio is  0.9642349283594767
distance 1 is tensor(173.3131, device='cuda:3')
cal_distance is  tensor(173.3131, device='cuda:3')
distance 1 is tensor(173.3131, device='cuda:3')
________________________________
test distance is  tensor(173.3131, device='cuda:3')
test similarity is  tensor(0.9311, device='cuda:3')
test acc is  0.49350000015634204
test loss is 277.9286972566454
test entropy is  3.166185659335335e-05
________________________________
distance 1 is tensor(173.3131, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.2984103043430276e-05
avg test loss is  278.0970124852683
avg accuracy is  0.49778333348967535
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(173.3131, device='cuda:3')
compute_norm is  tensor(50.1895, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(154.1554, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.91208068387849
avg test loss is  1.4126390552978272
avg accuracy is  0.8107166668229916
solo acc is  0.2853666668230058
compute similarity  is  tensor(0.9344, device='cuda:3')
compute_distance is  tensor(154.1554, device='cuda:3')
compute_norm is  tensor(50.0567, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.0785, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8723484134114882
avg test loss is  1.4890709993427496
avg accuracy is  0.8081666668229917
solo acc is  0.23308333348967103
compute similarity  is  tensor(0.9345, device='cuda:3')
compute_distance is  tensor(154.0785, device='cuda:3')
compute_norm is  tensor(49.7912, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.0283, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8719221336373897
avg test loss is  1.445176137535811
avg accuracy is  0.8102833334896582
solo acc is  0.24260000015633798
compute similarity  is  tensor(0.9345, device='cuda:3')
compute_distance is  tensor(154.0283, device='cuda:3')
compute_norm is  tensor(49.5272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.0676, device='cuda:3')
exit early
distance 1 is tensor(154.0676, device='cuda:3')
________________________________
test distance is  tensor(154.0676, device='cuda:3')
test similarity is  tensor(0.9346, device='cuda:3')
test acc is  0.8119833334896582
test loss is 1.4485125361220923
test entropy is  0.8633984163371738
________________________________
distance 1 is tensor(154.0676, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8633826453802682
avg test loss is  1.4480864432320666
avg accuracy is  0.8148166668229914
solo acc is  0.2294500001563376
compute similarity  is  tensor(0.9346, device='cuda:3')
compute_distance is  tensor(154.0676, device='cuda:3')
compute_norm is  tensor(49.2721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.2070, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8603849026567137
avg test loss is  1.4261015583711392
avg accuracy is  0.8129500001563248
solo acc is  0.23351666682300445
compute similarity  is  tensor(0.9346, device='cuda:3')
compute_distance is  tensor(154.2070, device='cuda:3')
compute_norm is  tensor(49.0216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.4021, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8575717231739305
avg test loss is  1.4100624076974417
avg accuracy is  0.817333333489658
solo acc is  0.23296666682300438
compute similarity  is  tensor(0.9347, device='cuda:3')
compute_distance is  tensor(154.4021, device='cuda:3')
compute_norm is  tensor(48.7771, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.6397, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8461345376998886
avg test loss is  1.4016555255410006
avg accuracy is  0.8151500001563248
solo acc is  0.23470000015633793
compute similarity  is  tensor(0.9347, device='cuda:3')
compute_distance is  tensor(154.6397, device='cuda:3')
compute_norm is  tensor(48.5370, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.9259, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.854408314805041
avg test loss is  1.37586609412358
avg accuracy is  0.8201166668229912
solo acc is  0.2367000001563379
compute similarity  is  tensor(0.9347, device='cuda:3')
compute_distance is  tensor(154.9259, device='cuda:3')
compute_norm is  tensor(48.2988, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.2479, device='cuda:3')
________________________________
test distance is  tensor(155.2479, device='cuda:3')
test similarity is  tensor(0.9347, device='cuda:3')
test acc is  0.8218333334896578
test loss is 1.3742646366548437
test entropy is  0.8339491524676016
________________________________
distance 1 is tensor(155.2479, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8347622888174646
avg test loss is  1.374014985968055
avg accuracy is  0.8217000001563246
solo acc is  0.24311666682300476
compute similarity  is  tensor(0.9347, device='cuda:3')
compute_distance is  tensor(155.2479, device='cuda:3')
compute_norm is  tensor(48.0669, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.6642, device='cuda:3')
exit early
distance 1 is tensor(155.6642, device='cuda:3')
________________________________
test distance is  tensor(155.6642, device='cuda:3')
test similarity is  tensor(0.9347, device='cuda:3')
test acc is  0.8224666668229911
test loss is 1.3785999637168607
test entropy is  0.8368711266944657
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1339819431304932
mal norm is  tensor(809.0789, device='cuda:3')
distance 1 is tensor(155.6642, device='cuda:3')
mal distance is  tensor(155.6642, device='cuda:3')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(22.6861, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(561.2358, device='cuda:3')
part1 is  tensor(-52.4372, device='cuda:3')
score : tensor(-0.5469, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(566.3799, device='cuda:3')
part1 is  tensor(-30.7975, device='cuda:3')
score : tensor(-0.3305, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.5184, device='cuda:3')
part1 is  tensor(23.7891, device='cuda:3')
score : tensor(0.2154, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(491.6367, device='cuda:3')
part1 is  tensor(-16.2833, device='cuda:3')
score : tensor(-0.1853, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(505.9049, device='cuda:3')
part1 is  tensor(-26.1400, device='cuda:3')
score : tensor(-0.2839, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(556.4318, device='cuda:3')
part1 is  tensor(-5.8581, device='cuda:3')
score : tensor(-0.0811, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(460.6926, device='cuda:3')
part1 is  tensor(7.9393, device='cuda:3')
score : tensor(0.0569, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(503.0762, device='cuda:3')
part1 is  tensor(-10.4563, device='cuda:3')
score : tensor(-0.1270, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(809.0789, device='cuda:3')
part1 is  tensor(-38.0119, device='cuda:3')
score : tensor(-0.4026, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(707.9474, device='cuda:3')
part1 is  tensor(78.3241, device='cuda:3')
score : tensor(0.7608, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(711.4651, device='cuda:3')
part1 is  tensor(37.5877, device='cuda:3')
score : tensor(0.3534, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(704.0073, device='cuda:3')
part1 is  tensor(20.6530, device='cuda:3')
score : tensor(0.1840, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(682.6740, device='cuda:3')
part1 is  tensor(5.7701, device='cuda:3')
score : tensor(0.0352, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(691.5994, device='cuda:3')
part1 is  tensor(12.7893, device='cuda:3')
score : tensor(0.1054, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.7884, device='cuda:3')
part1 is  tensor(-62.8830, device='cuda:3')
score : tensor(-0.6513, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.0298, device='cuda:3')
part1 is  tensor(-45.0275, device='cuda:3')
score : tensor(-0.4728, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(732.9560, device='cuda:3')
part1 is  tensor(15.2993, device='cuda:3')
score : tensor(0.1305, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(719.0330, device='cuda:3')
part1 is  tensor(50.0221, device='cuda:3')
score : tensor(0.4777, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(758.5390, device='cuda:3')
part1 is  tensor(29.8549, device='cuda:3')
score : tensor(0.2761, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(772.7957, device='cuda:3')
part1 is  tensor(9.3151, device='cuda:3')
score : tensor(0.0707, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(742.3491, device='cuda:3')
part1 is  tensor(52.5472, device='cuda:3')
score : tensor(0.5030, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(743.2776, device='cuda:3')
part1 is  tensor(65.1531, device='cuda:3')
score : tensor(0.6290, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(708.7148, device='cuda:3')
part1 is  tensor(14.9219, device='cuda:3')
score : tensor(0.1267, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(699.3282, device='cuda:3')
part1 is  tensor(40.7919, device='cuda:3')
score : tensor(0.3854, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(751.0372, device='cuda:3')
part1 is  tensor(43.3316, device='cuda:3')
score : tensor(0.4108, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(713.4174, device='cuda:3')
part1 is  tensor(24.6739, device='cuda:3')
score : tensor(0.2243, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(782.7396, device='cuda:3')
part1 is  tensor(-18.7135, device='cuda:3')
score : tensor(-0.2096, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(697.9457, device='cuda:3')
part1 is  tensor(48.3962, device='cuda:3')
score : tensor(0.4615, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.1168, device='cuda:3')
part1 is  tensor(31.6910, device='cuda:3')
score : tensor(0.2944, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(715.6572, device='cuda:3')
part1 is  tensor(39.7050, device='cuda:3')
score : tensor(0.3746, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.0219, device='cuda:3')
part1 is  tensor(-9.1627, device='cuda:3')
score : tensor(-0.1141, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(737.0231, device='cuda:3')
part1 is  tensor(17.2882, device='cuda:3')
score : tensor(0.1504, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5233, device='cuda:3')
part1 is  tensor(16.7627, device='cuda:3')
score : tensor(0.1451, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.3901, device='cuda:3')
part1 is  tensor(39.3260, device='cuda:3')
score : tensor(0.3708, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(635.9432, device='cuda:3')
part1 is  tensor(-53.9598, device='cuda:3')
score : tensor(-0.5621, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(634.0032, device='cuda:3')
part1 is  tensor(41.7346, device='cuda:3')
score : tensor(0.3949, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(647.3109, device='cuda:3')
part1 is  tensor(-34.7445, device='cuda:3')
score : tensor(-0.3699, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.1187, device='cuda:3')
part1 is  tensor(5.2106, device='cuda:3')
score : tensor(0.0296, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(650.3254, device='cuda:3')
part1 is  tensor(26.0154, device='cuda:3')
score : tensor(0.2377, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.2526, device='cuda:3')
part1 is  tensor(2.8561, device='cuda:3')
score : tensor(0.0061, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.8705, device='cuda:3')
part1 is  tensor(-25.6831, device='cuda:3')
score : tensor(-0.2793, device='cuda:3')
len accept list 27
len all weights is 27
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 90.09% 

Test Accuracy: 89.00% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5026906132698059
distance 1 is tensor(106.4421, device='cuda:3')
benign distance is  tensor(106.4421, device='cuda:3')
norm1 res is  tensor(0.1201, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.09767377376556396
distance 1 is tensor(119.5575, device='cuda:3')
benign distance is  tensor(119.5575, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.8219850659370422
distance 1 is tensor(107.2228, device='cuda:3')
benign distance is  tensor(107.2228, device='cuda:3')
norm1 res is  tensor(0.1179, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.6347697973251343
distance 1 is tensor(123.5121, device='cuda:3')
benign distance is  tensor(123.5121, device='cuda:3')
norm1 res is  tensor(0.1326, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5790222883224487
distance 1 is tensor(117.4068, device='cuda:3')
benign distance is  tensor(117.4068, device='cuda:3')
norm1 res is  tensor(0.1305, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.467106431722641
distance 1 is tensor(128.5000, device='cuda:3')
benign distance is  tensor(128.5000, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.40195560455322266
distance 1 is tensor(89.4197, device='cuda:3')
benign distance is  tensor(89.4197, device='cuda:3')
norm1 res is  tensor(0.0981, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.37936562299728394
distance 1 is tensor(116.4027, device='cuda:3')
benign distance is  tensor(116.4027, device='cuda:3')
norm1 res is  tensor(0.1282, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.712691068649292
distance 1 is tensor(137.0100, device='cuda:3')
benign distance is  tensor(137.0100, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  1.1082980632781982
distance 1 is tensor(136.7627, device='cuda:3')
benign distance is  tensor(136.7627, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.18744178116321564
distance 1 is tensor(121.7596, device='cuda:3')
benign distance is  tensor(121.7596, device='cuda:3')
norm1 res is  tensor(0.1286, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.8345991373062134
distance 1 is tensor(139.1949, device='cuda:3')
benign distance is  tensor(139.1949, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.31091445684432983
distance 1 is tensor(128.4463, device='cuda:3')
benign distance is  tensor(128.4463, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.16889610886573792
distance 1 is tensor(129.1051, device='cuda:3')
benign distance is  tensor(129.1051, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4240970015525818
distance 1 is tensor(124.7792, device='cuda:3')
benign distance is  tensor(124.7792, device='cuda:3')
norm1 res is  tensor(0.1380, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.43714770674705505
distance 1 is tensor(136.0704, device='cuda:3')
benign distance is  tensor(136.0704, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.21380338072776794
distance 1 is tensor(127.9273, device='cuda:3')
benign distance is  tensor(127.9273, device='cuda:3')
norm1 res is  tensor(0.1358, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.33949652314186096
distance 1 is tensor(142.1674, device='cuda:3')
benign distance is  tensor(142.1674, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.07353489845991135
distance 1 is tensor(124.2657, device='cuda:3')
benign distance is  tensor(124.2657, device='cuda:3')
norm1 res is  tensor(0.1346, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.10297189652919769
distance 1 is tensor(132.1770, device='cuda:3')
benign distance is  tensor(132.1770, device='cuda:3')
norm1 res is  tensor(0.1449, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.2502351999282837
distance 1 is tensor(124.1258, device='cuda:3')
benign distance is  tensor(124.1258, device='cuda:3')
norm1 res is  tensor(0.1321, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.5737980604171753
distance 1 is tensor(131.6160, device='cuda:3')
benign distance is  tensor(131.6160, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.4281635284423828
distance 1 is tensor(130.2606, device='cuda:3')
benign distance is  tensor(130.2606, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.23387150466442108
distance 1 is tensor(135.8591, device='cuda:3')
benign distance is  tensor(135.8591, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.2377532720565796
distance 1 is tensor(127.5512, device='cuda:3')
benign distance is  tensor(127.5512, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.1007770448923111
distance 1 is tensor(126.5007, device='cuda:3')
benign distance is  tensor(126.5007, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.697359561920166
distance 1 is tensor(127.3590, device='cuda:3')
benign distance is  tensor(127.3590, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.02201024815440178
distance 1 is tensor(119.8929, device='cuda:3')
benign distance is  tensor(119.8929, device='cuda:3')
norm1 res is  tensor(0.1302, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.483143150806427
distance 1 is tensor(133.1955, device='cuda:3')
benign distance is  tensor(133.1955, device='cuda:3')
norm1 res is  tensor(0.1462, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.2324930727481842
distance 1 is tensor(125.2891, device='cuda:3')
benign distance is  tensor(125.2891, device='cuda:3')
norm1 res is  tensor(0.1327, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.1864597350358963
distance 1 is tensor(130.1713, device='cuda:3')
benign distance is  tensor(130.1713, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.18741250038146973
distance 1 is tensor(125.7874, device='cuda:3')
benign distance is  tensor(125.7874, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.3912183344364166
distance 1 is tensor(126.4609, device='cuda:3')
benign distance is  tensor(126.4609, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.3575846552848816
distance 1 is tensor(133.0475, device='cuda:3')
benign distance is  tensor(133.0475, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.02621830627322197
distance 1 is tensor(122.4881, device='cuda:3')
benign distance is  tensor(122.4881, device='cuda:3')
norm1 res is  tensor(0.1334, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.301493376493454
distance 1 is tensor(136.8043, device='cuda:3')
benign distance is  tensor(136.8043, device='cuda:3')
norm1 res is  tensor(0.1471, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.11258657276630402
distance 1 is tensor(116.3070, device='cuda:3')
benign distance is  tensor(116.3070, device='cuda:3')
norm1 res is  tensor(0.1261, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.44033414125442505
distance 1 is tensor(133.2010, device='cuda:3')
benign distance is  tensor(133.2010, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.13905076682567596
distance 1 is tensor(132.8657, device='cuda:3')
benign distance is  tensor(132.8657, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.32217809557914734
distance 1 is tensor(133.6706, device='cuda:3')
benign distance is  tensor(133.6706, device='cuda:3')
norm1 res is  tensor(0.1437, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(141.1408, device='cuda:3')
compute distance is  tensor(141.1408, device='cuda:3')
compute norm is  tensor(47.6177, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(131.6191, device='cuda:3')
compute distance is  tensor(131.6191, device='cuda:3')
compute norm is  tensor(47.4441, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(144.3070, device='cuda:3')
compute distance is  tensor(144.3070, device='cuda:3')
compute norm is  tensor(47.8689, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(146.7970, device='cuda:3')
compute distance is  tensor(146.7970, device='cuda:3')
compute norm is  tensor(47.9564, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(139.1378, device='cuda:3')
compute distance is  tensor(139.1378, device='cuda:3')
compute norm is  tensor(47.5689, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(138.8242, device='cuda:3')
compute distance is  tensor(138.8242, device='cuda:3')
compute norm is  tensor(47.7222, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(136.8817, device='cuda:3')
compute distance is  tensor(136.8817, device='cuda:3')
compute norm is  tensor(47.7188, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(153.1805, device='cuda:3')
compute distance is  tensor(153.1805, device='cuda:3')
compute norm is  tensor(48.0901, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.9582, device='cuda:3')
compute distance is  tensor(134.9582, device='cuda:3')
compute norm is  tensor(47.6029, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(131.4081, device='cuda:3')
compute distance is  tensor(131.4081, device='cuda:3')
compute norm is  tensor(47.5401, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.8518, device='cuda:3')
compute distance is  tensor(147.8518, device='cuda:3')
compute norm is  tensor(47.9220, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(135.7051, device='cuda:3')
compute distance is  tensor(135.7051, device='cuda:3')
compute norm is  tensor(47.6538, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.1805, device='cuda:3')
distance 1 is tensor(1869447.3750, device='cuda:3')
________________________________
test distance is  tensor(1869447.3750, device='cuda:3')
test similarity is  tensor(0.0825, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765530085071161e+18
test entropy is  0.0
________________________________
cal ratio is  0.008870972317322909
distance 1 is tensor(16583.8223, device='cuda:3')
cal_distance is  tensor(16583.8223, device='cuda:3')
cal ratio is  0.09418582440392288
distance 1 is tensor(1561.9672, device='cuda:3')
cal_distance is  tensor(1561.9672, device='cuda:3')
cal ratio is  0.3068964819954481
distance 1 is tensor(479.3669, device='cuda:3')
cal_distance is  tensor(479.3669, device='cuda:3')
cal ratio is  0.5539797007899215
distance 1 is tensor(265.5625, device='cuda:3')
cal_distance is  tensor(265.5625, device='cuda:3')
cal ratio is  0.7442939461139619
distance 1 is tensor(197.6583, device='cuda:3')
cal_distance is  tensor(197.6583, device='cuda:3')
cal ratio is  0.8627209082915789
distance 1 is tensor(170.5249, device='cuda:3')
cal_distance is  tensor(170.5249, device='cuda:3')
cal ratio is  0.9288251140634558
distance 1 is tensor(158.3883, device='cuda:3')
cal_distance is  tensor(158.3883, device='cuda:3')
cal ratio is  0.9637542873193199
distance 1 is tensor(152.6476, device='cuda:3')
cal_distance is  tensor(152.6476, device='cuda:3')
distance 1 is tensor(152.6476, device='cuda:3')
________________________________
test distance is  tensor(152.6476, device='cuda:3')
test similarity is  tensor(0.9389, device='cuda:3')
test acc is  0.7137666668229964
test loss is 161.9087852689503
test entropy is  0.0009980896424955838
________________________________
distance 1 is tensor(152.6476, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0009684058593595985
avg test loss is  162.07769614343704
avg accuracy is  0.7149666668229964
solo acc is  0.1028833334896653
compute similarity  is  tensor(0.9389, device='cuda:3')
compute_distance is  tensor(152.6476, device='cuda:3')
compute_norm is  tensor(48.9937, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(137.6540, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9268651794650153
avg test loss is  1.3910377905694151
avg accuracy is  0.8431166668229902
solo acc is  0.3015833334896729
compute similarity  is  tensor(0.9409, device='cuda:3')
compute_distance is  tensor(137.6540, device='cuda:3')
compute_norm is  tensor(48.4017, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.3880, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8569943989390758
avg test loss is  1.4785192100478133
avg accuracy is  0.841733333489657
solo acc is  0.2508000001563383
compute similarity  is  tensor(0.9407, device='cuda:3')
compute_distance is  tensor(138.3880, device='cuda:3')
compute_norm is  tensor(48.1435, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.1495, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8657331072699541
avg test loss is  1.4434607739387544
avg accuracy is  0.8431666668229902
solo acc is  0.24731666682300493
compute similarity  is  tensor(0.9406, device='cuda:3')
compute_distance is  tensor(139.1495, device='cuda:3')
compute_norm is  tensor(47.8865, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.8014, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8641027572439678
avg test loss is  1.4125525373131482
avg accuracy is  0.8431833334896569
solo acc is  0.253766666823005
compute similarity  is  tensor(0.9406, device='cuda:3')
compute_distance is  tensor(139.8014, device='cuda:3')
compute_norm is  tensor(47.6390, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.5170, device='cuda:3')
________________________________
test distance is  tensor(140.5170, device='cuda:3')
test similarity is  tensor(0.9405, device='cuda:3')
test acc is  0.8436000001563236
test loss is 1.4142047032110219
test entropy is  0.8533694628459304
________________________________
distance 1 is tensor(140.5170, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8528243956535355
avg test loss is  1.4172441207015438
avg accuracy is  0.8445166668229901
solo acc is  0.24190000015633806
compute similarity  is  tensor(0.9405, device='cuda:3')
compute_distance is  tensor(140.5170, device='cuda:3')
compute_norm is  tensor(47.3958, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.2267, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8494830171563732
avg test loss is  1.4029018756931524
avg accuracy is  0.8461000001563235
solo acc is  0.24435000015633804
compute similarity  is  tensor(0.9404, device='cuda:3')
compute_distance is  tensor(141.2267, device='cuda:3')
compute_norm is  tensor(47.1556, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(141.9430, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.846129814190651
avg test loss is  1.385907707819298
avg accuracy is  0.8476500001563233
solo acc is  0.24718333348967156
compute similarity  is  tensor(0.9403, device='cuda:3')
compute_distance is  tensor(141.9430, device='cuda:3')
compute_norm is  tensor(46.9195, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(142.7823, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8413470076726698
avg test loss is  1.3702557010691303
avg accuracy is  0.8489333334896567
solo acc is  0.2471666668230048
compute similarity  is  tensor(0.9403, device='cuda:3')
compute_distance is  tensor(142.7823, device='cuda:3')
compute_norm is  tensor(46.6862, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.6273, device='cuda:3')
exit early
distance 1 is tensor(143.6273, device='cuda:3')
________________________________
test distance is  tensor(143.6273, device='cuda:3')
test similarity is  tensor(0.9402, device='cuda:3')
test acc is  0.8510166668229899
test loss is 1.3641662438795257
test entropy is  0.8387885010445805
________________________________
distance 1 is tensor(143.6273, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8390126914612012
avg test loss is  1.3644326941799254
avg accuracy is  0.8502666668229899
solo acc is  0.24490000015633817
compute similarity  is  tensor(0.9402, device='cuda:3')
compute_distance is  tensor(143.6273, device='cuda:3')
compute_norm is  tensor(46.4566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(144.5141, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8369536917092704
avg test loss is  1.352860046411628
avg accuracy is  0.8494333334896566
solo acc is  0.24418333348967144
compute similarity  is  tensor(0.9401, device='cuda:3')
compute_distance is  tensor(144.5141, device='cuda:3')
compute_norm is  tensor(46.2291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(145.4337, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8267649908436895
avg test loss is  1.3472413393988538
avg accuracy is  0.8528500001563231
solo acc is  0.24585000015633815
compute similarity  is  tensor(0.9400, device='cuda:3')
compute_distance is  tensor(145.4337, device='cuda:3')
compute_norm is  tensor(46.0061, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(146.3663, device='cuda:3')
exit early
distance 1 is tensor(146.3663, device='cuda:3')
________________________________
test distance is  tensor(146.3663, device='cuda:3')
test similarity is  tensor(0.9399, device='cuda:3')
test acc is  0.8532333334896566
test loss is 1.3415907715429376
test entropy is  0.8279935038928539
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.268829584121704
mal norm is  tensor(727.8747, device='cuda:3')
distance 1 is tensor(146.3663, device='cuda:3')
mal distance is  tensor(146.3663, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(13.2666, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(463.8795, device='cuda:3')
part1 is  tensor(-0.6235, device='cuda:3')
score : tensor(-0.0193, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(514.8699, device='cuda:3')
part1 is  tensor(-8.9679, device='cuda:3')
score : tensor(-0.1027, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(455.8632, device='cuda:3')
part1 is  tensor(-10.4028, device='cuda:3')
score : tensor(-0.1171, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(525.0962, device='cuda:3')
part1 is  tensor(-10.7070, device='cuda:3')
score : tensor(-0.1201, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.3228, device='cuda:3')
part1 is  tensor(-6.4502, device='cuda:3')
score : tensor(-0.0776, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.9622, device='cuda:3')
part1 is  tensor(-16.8770, device='cuda:3')
score : tensor(-0.1818, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(379.6743, device='cuda:3')
part1 is  tensor(-5.6922, device='cuda:3')
score : tensor(-0.0700, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(504.5164, device='cuda:3')
part1 is  tensor(-0.2073, device='cuda:3')
score : tensor(-0.0151, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.8747, device='cuda:3')
part1 is  tensor(7.7915, device='cuda:3')
score : tensor(0.0648, device='cuda:3')
accept
len accept list 12
len all weights is 12
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 69.11% 

Test Accuracy: 67.75% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
 benign loss is  0.6926130056381226
distance 1 is tensor(156.3805, device='cuda:3')
benign distance is  tensor(156.3805, device='cuda:3')
norm1 res is  tensor(0.1582, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8798500299453735
distance 1 is tensor(174.0762, device='cuda:3')
benign distance is  tensor(174.0762, device='cuda:3')
norm1 res is  tensor(0.1743, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.37163859605789185
distance 1 is tensor(158.2080, device='cuda:3')
benign distance is  tensor(158.2080, device='cuda:3')
norm1 res is  tensor(0.1644, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7046606540679932
distance 1 is tensor(163.5958, device='cuda:3')
benign distance is  tensor(163.5958, device='cuda:3')
norm1 res is  tensor(0.1660, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.6151633858680725
distance 1 is tensor(155.5346, device='cuda:3')
benign distance is  tensor(155.5346, device='cuda:3')
norm1 res is  tensor(0.1538, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.275994896888733
distance 1 is tensor(173.1046, device='cuda:3')
benign distance is  tensor(173.1046, device='cuda:3')
norm1 res is  tensor(0.1750, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.2052597999572754
distance 1 is tensor(159.7185, device='cuda:3')
benign distance is  tensor(159.7185, device='cuda:3')
norm1 res is  tensor(0.1596, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3246169686317444
distance 1 is tensor(170.5775, device='cuda:3')
benign distance is  tensor(170.5775, device='cuda:3')
norm1 res is  tensor(0.1753, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(208.7893, device='cuda:3')
compute distance is  tensor(208.7893, device='cuda:3')
compute norm is  tensor(48.1017, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(204.8433, device='cuda:3')
compute distance is  tensor(204.8433, device='cuda:3')
compute norm is  tensor(48.0554, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(210.2469, device='cuda:3')
compute distance is  tensor(210.2469, device='cuda:3')
compute norm is  tensor(48.2974, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(216.6588, device='cuda:3')
compute distance is  tensor(216.6588, device='cuda:3')
compute norm is  tensor(48.3922, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(205.5144, device='cuda:3')
compute distance is  tensor(205.5144, device='cuda:3')
compute norm is  tensor(48.0416, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(213.1784, device='cuda:3')
compute distance is  tensor(213.1784, device='cuda:3')
compute norm is  tensor(48.4403, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(210.1334, device='cuda:3')
compute distance is  tensor(210.1334, device='cuda:3')
compute norm is  tensor(48.2753, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(202.9295, device='cuda:3')
compute distance is  tensor(202.9295, device='cuda:3')
compute norm is  tensor(48.0412, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(212.3617, device='cuda:3')
compute distance is  tensor(212.3617, device='cuda:3')
compute norm is  tensor(48.2088, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(212.1378, device='cuda:3')
compute distance is  tensor(212.1378, device='cuda:3')
compute norm is  tensor(48.3368, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(213.9645, device='cuda:3')
compute distance is  tensor(213.9645, device='cuda:3')
compute norm is  tensor(48.3909, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(203.6828, device='cuda:3')
compute distance is  tensor(203.6828, device='cuda:3')
compute norm is  tensor(48.0361, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(216.6588, device='cuda:3')
distance 1 is tensor(1869367.1250, device='cuda:3')
________________________________
test distance is  tensor(1869367.1250, device='cuda:3')
test similarity is  tensor(0.3352, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.763508986357946e+18
test entropy is  0.0
________________________________
cal ratio is  0.010550351076418045
distance 1 is tensor(19722.4824, device='cuda:3')
cal_distance is  tensor(19722.4824, device='cuda:3')
cal ratio is  0.10271489254351347
distance 1 is tensor(2025.7992, device='cuda:3')
cal_distance is  tensor(2025.7992, device='cuda:3')
cal ratio is  0.32049113133623325
distance 1 is tensor(649.2551, device='cuda:3')
cal_distance is  tensor(649.2551, device='cuda:3')
cal ratio is  0.5661174046509541
distance 1 is tensor(367.5576, device='cuda:3')
cal_distance is  tensor(367.5576, device='cuda:3')
cal ratio is  0.7524047291128697
distance 1 is tensor(276.5537, device='cuda:3')
cal_distance is  tensor(276.5537, device='cuda:3')
cal ratio is  0.867410019775779
distance 1 is tensor(239.8864, device='cuda:3')
cal_distance is  tensor(239.8864, device='cuda:3')
cal ratio is  0.9313467694766597
distance 1 is tensor(223.4179, device='cuda:3')
cal_distance is  tensor(223.4179, device='cuda:3')
cal ratio is  0.965062039041369
distance 1 is tensor(215.6123, device='cuda:3')
cal_distance is  tensor(215.6123, device='cuda:3')
distance 1 is tensor(215.6123, device='cuda:3')
________________________________
test distance is  tensor(215.6123, device='cuda:3')
test similarity is  tensor(0.9205, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1003.3599804062833
test entropy is  0.0
________________________________
distance 1 is tensor(215.6123, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1003.772467119099
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9205, device='cuda:3')
compute_distance is  tensor(215.6123, device='cuda:3')
compute_norm is  tensor(53.0268, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(293.0337, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6596890259653265
avg test loss is  2.7791845157964907
avg accuracy is  0.10131666682299866
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9015, device='cuda:3')
compute_distance is  tensor(293.0337, device='cuda:3')
compute_norm is  tensor(56.9676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(292.3705, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.965036823106473
avg test loss is  3.440006796485071
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9011, device='cuda:3')
compute_distance is  tensor(292.3705, device='cuda:3')
compute_norm is  tensor(57.3062, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(290.5107, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5443287271934787
avg test loss is  2.860384881877696
avg accuracy is  0.10095000015633199
solo acc is  0.10055000015633199
compute similarity  is  tensor(0.9013, device='cuda:3')
compute_distance is  tensor(290.5107, device='cuda:3')
compute_norm is  tensor(56.5704, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(289.7440, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9404824862856347
avg test loss is  3.4615462555814145
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9010, device='cuda:3')
compute_distance is  tensor(289.7440, device='cuda:3')
compute_norm is  tensor(56.8147, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(288.0317, device='cuda:3')
________________________________
test distance is  tensor(288.0317, device='cuda:3')
test similarity is  tensor(0.9013, device='cuda:3')
test acc is  0.10170000015633197
test loss is 2.8484823230995553
test entropy is  1.5381021151410492
________________________________
cal ratio is  0.849951281231255
distance 1 is tensor(244.8136, device='cuda:3')
cal_distance is  tensor(244.8136, device='cuda:3')
cal ratio is  0.9219267303306358
distance 1 is tensor(225.7006, device='cuda:3')
cal_distance is  tensor(225.7006, device='cuda:3')
cal ratio is  0.9601694440191216
distance 1 is tensor(216.7110, device='cuda:3')
cal_distance is  tensor(216.7110, device='cuda:3')
cal ratio is  0.9798819703312722
distance 1 is tensor(212.3513, device='cuda:3')
cal_distance is  tensor(212.3513, device='cuda:3')
distance 1 is tensor(212.3513, device='cuda:3')
________________________________
test distance is  tensor(212.3513, device='cuda:3')
test similarity is  tensor(0.9386, device='cuda:3')
test acc is  0.1369333334896653
test loss is 2.674116378399863
test entropy is  1.7710880152960575
________________________________
distance 1 is tensor(212.3513, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7712741417925495
avg test loss is  2.6739585531800034
avg accuracy is  0.13700000015633196
solo acc is  0.10155000015633198
compute similarity  is  tensor(0.9386, device='cuda:3')
compute_distance is  tensor(212.3513, device='cuda:3')
compute_norm is  tensor(52.4291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(212.2822, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9543507814026082
avg test loss is  3.4061261689993363
avg accuracy is  0.10821666682299862
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9379, device='cuda:3')
compute_distance is  tensor(212.2822, device='cuda:3')
compute_norm is  tensor(52.8689, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(211.6107, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1800588435455681
avg test loss is  2.091403411649692
avg accuracy is  0.16188333348966738
solo acc is  0.1464833334896662
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(211.6107, device='cuda:3')
compute_norm is  tensor(52.3712, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(210.9447, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6888931089881133
avg test loss is  2.793453131403242
avg accuracy is  0.1203166668229986
solo acc is  0.10295000015633197
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(210.9447, device='cuda:3')
compute_norm is  tensor(52.2946, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(210.2740, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0750490804470934
avg test loss is  1.8524112288377432
avg accuracy is  0.14916666682299978
solo acc is  0.18111666682300206
compute similarity  is  tensor(0.9397, device='cuda:3')
compute_distance is  tensor(210.2740, device='cuda:3')
compute_norm is  tensor(51.7773, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(209.7253, device='cuda:3')
________________________________
test distance is  tensor(209.7253, device='cuda:3')
test similarity is  tensor(0.9396, device='cuda:3')
test acc is  0.11408333348966529
test loss is 2.5893874857217263
test entropy is  0.673724015130163
________________________________
distance 1 is tensor(209.7253, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6723658969280308
avg test loss is  2.590813874690009
avg accuracy is  0.11333333348966529
solo acc is  0.10530000015633197
compute similarity  is  tensor(0.9396, device='cuda:3')
compute_distance is  tensor(209.7253, device='cuda:3')
compute_norm is  tensor(51.6724, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(209.3350, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0360441550390045
avg test loss is  1.6932822665426015
avg accuracy is  0.13966666682299891
solo acc is  0.2159166668230037
compute similarity  is  tensor(0.9397, device='cuda:3')
compute_distance is  tensor(209.3350, device='cuda:3')
compute_norm is  tensor(51.2632, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(208.8840, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6551836028790423
avg test loss is  2.4842220316055235
avg accuracy is  0.10993333348966529
solo acc is  0.10521666682299863
compute similarity  is  tensor(0.9396, device='cuda:3')
compute_distance is  tensor(208.8840, device='cuda:3')
compute_norm is  tensor(51.1595, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(208.6646, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0231831422619728
avg test loss is  1.6557612832167001
avg accuracy is  0.13423333348966524
solo acc is  0.20666666682300336
compute similarity  is  tensor(0.9396, device='cuda:3')
compute_distance is  tensor(208.6646, device='cuda:3')
compute_norm is  tensor(50.7978, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(208.3071, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6443991476793025
avg test loss is  2.4242265417631756
avg accuracy is  0.10805000015633195
solo acc is  0.10345000015633196
compute similarity  is  tensor(0.9394, device='cuda:3')
compute_distance is  tensor(208.3071, device='cuda:3')
compute_norm is  tensor(50.6866, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(208.1544, device='cuda:3')
________________________________
test distance is  tensor(208.1544, device='cuda:3')
test similarity is  tensor(0.9393, device='cuda:3')
test acc is  0.13291666682299857
test loss is 1.5994990573508907
test entropy is  1.0058816451507846
________________________________
final entropy
distance 1 is tensor(208.1544, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0046987355645023
avg test loss is  1.5973891183765712
avg accuracy is  0.13326666682299856
solo acc is  0.2187500001563372
compute similarity  is  tensor(0.9393, device='cuda:3')
compute_distance is  tensor(208.1544, device='cuda:3')
compute_norm is  tensor(50.3435, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.41619873046875
mal norm is  tensor(824.5663, device='cuda:3')
distance 1 is tensor(207.8403, device='cuda:3')
mal distance is  tensor(207.8403, device='cuda:3')
len current grad  20
len all grad 36
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(37.1834, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(625.7265, device='cuda:3')
part1 is  tensor(652.2880, device='cuda:3')
score : tensor(6.4859, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(692.7857, device='cuda:3')
part1 is  tensor(567.6667, device='cuda:3')
score : tensor(5.6397, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(643.9276, device='cuda:3')
part1 is  tensor(544.8617, device='cuda:3')
score : tensor(5.4116, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(651.4516, device='cuda:3')
part1 is  tensor(517.2123, device='cuda:3')
score : tensor(5.1351, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(608.5983, device='cuda:3')
part1 is  tensor(653.8163, device='cuda:3')
score : tensor(6.5012, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(693.4037, device='cuda:3')
part1 is  tensor(515.5941, device='cuda:3')
score : tensor(5.1190, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(627.3745, device='cuda:3')
part1 is  tensor(675.4833, device='cuda:3')
score : tensor(6.7178, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(688.4051, device='cuda:3')
part1 is  tensor(605.2760, device='cuda:3')
score : tensor(6.0158, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5663, device='cuda:3')
part1 is  tensor(-730.2128, device='cuda:3')
score : tensor(-7.3391, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(783.2960, device='cuda:3')
part1 is  tensor(546.3333, device='cuda:3')
score : tensor(5.4263, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(686.8728, device='cuda:3')
part1 is  tensor(517.0149, device='cuda:3')
score : tensor(5.1332, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(727.7546, device='cuda:3')
part1 is  tensor(540.9762, device='cuda:3')
score : tensor(5.3728, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(739.4264, device='cuda:3')
part1 is  tensor(477.9209, device='cuda:3')
score : tensor(4.7422, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(716.5515, device='cuda:3')
part1 is  tensor(626.3398, device='cuda:3')
score : tensor(6.2264, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.2718, device='cuda:3')
part1 is  tensor(549.1008, device='cuda:3')
score : tensor(5.4540, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(760.1271, device='cuda:3')
part1 is  tensor(602.2186, device='cuda:3')
score : tensor(5.9852, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(726.7871, device='cuda:3')
part1 is  tensor(562.8894, device='cuda:3')
score : tensor(5.5919, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(840.9140, device='cuda:3')
part1 is  tensor(565.9167, device='cuda:3')
score : tensor(5.6222, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(854.3898, device='cuda:3')
part1 is  tensor(554.6729, device='cuda:3')
score : tensor(5.5097, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(795.3857, device='cuda:3')
part1 is  tensor(524.4977, device='cuda:3')
score : tensor(5.2080, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(863.4662, device='cuda:3')
part1 is  tensor(546.2036, device='cuda:3')
score : tensor(5.4251, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(822.3158, device='cuda:3')
part1 is  tensor(509.3922, device='cuda:3')
score : tensor(5.0569, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.8427, device='cuda:3')
part1 is  tensor(439.9891, device='cuda:3')
score : tensor(4.3629, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(816.7484, device='cuda:3')
part1 is  tensor(479.2391, device='cuda:3')
score : tensor(4.7554, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(844.4287, device='cuda:3')
part1 is  tensor(527.0553, device='cuda:3')
score : tensor(5.2336, device='cuda:3')
accept
len accept list 24
len all weights is 24
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 89.00% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
 benign loss is  0.29665327072143555
distance 1 is tensor(113.8021, device='cuda:3')
benign distance is  tensor(113.8021, device='cuda:3')
norm1 res is  tensor(0.1229, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5012365579605103
distance 1 is tensor(152.4048, device='cuda:3')
benign distance is  tensor(152.4048, device='cuda:3')
norm1 res is  tensor(0.1620, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.17997029423713684
distance 1 is tensor(128.5996, device='cuda:3')
benign distance is  tensor(128.5996, device='cuda:3')
norm1 res is  tensor(0.1370, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.363847553730011
distance 1 is tensor(126.3592, device='cuda:3')
benign distance is  tensor(126.3592, device='cuda:3')
norm1 res is  tensor(0.1336, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3988921642303467
distance 1 is tensor(121.9247, device='cuda:3')
benign distance is  tensor(121.9247, device='cuda:3')
norm1 res is  tensor(0.1249, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7213090062141418
distance 1 is tensor(127.8467, device='cuda:3')
benign distance is  tensor(127.8467, device='cuda:3')
norm1 res is  tensor(0.1320, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.38336461782455444
distance 1 is tensor(113.2348, device='cuda:3')
benign distance is  tensor(113.2348, device='cuda:3')
norm1 res is  tensor(0.1192, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2175770103931427
distance 1 is tensor(127.3342, device='cuda:3')
benign distance is  tensor(127.3342, device='cuda:3')
norm1 res is  tensor(0.1363, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.30472010374069214
distance 1 is tensor(132.5497, device='cuda:3')
benign distance is  tensor(132.5497, device='cuda:3')
norm1 res is  tensor(0.1376, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.23470552265644073
distance 1 is tensor(136.6542, device='cuda:3')
benign distance is  tensor(136.6542, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.5892361402511597
distance 1 is tensor(130.9637, device='cuda:3')
benign distance is  tensor(130.9637, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5622508525848389
distance 1 is tensor(141.0805, device='cuda:3')
benign distance is  tensor(141.0805, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.29459530115127563
distance 1 is tensor(126.9354, device='cuda:3')
benign distance is  tensor(126.9354, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.2852765619754791
distance 1 is tensor(140.4698, device='cuda:3')
benign distance is  tensor(140.4698, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.3077284097671509
distance 1 is tensor(134.2071, device='cuda:3')
benign distance is  tensor(134.2071, device='cuda:3')
norm1 res is  tensor(0.1400, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.7526763081550598
distance 1 is tensor(147.6195, device='cuda:3')
benign distance is  tensor(147.6195, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.23077233135700226
distance 1 is tensor(135.1454, device='cuda:3')
benign distance is  tensor(135.1454, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.6110478043556213
distance 1 is tensor(134.0965, device='cuda:3')
benign distance is  tensor(134.0965, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.5357640385627747
distance 1 is tensor(141.5370, device='cuda:3')
benign distance is  tensor(141.5370, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.3776072859764099
distance 1 is tensor(144.0493, device='cuda:3')
benign distance is  tensor(144.0493, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.6304775476455688
distance 1 is tensor(134.2420, device='cuda:3')
benign distance is  tensor(134.2420, device='cuda:3')
norm1 res is  tensor(0.1403, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.3865438401699066
distance 1 is tensor(137.5546, device='cuda:3')
benign distance is  tensor(137.5546, device='cuda:3')
norm1 res is  tensor(0.1456, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.2510678470134735
distance 1 is tensor(138.7693, device='cuda:3')
benign distance is  tensor(138.7693, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.495270311832428
distance 1 is tensor(125.7714, device='cuda:3')
benign distance is  tensor(125.7714, device='cuda:3')
norm1 res is  tensor(0.1340, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(156.0348, device='cuda:3')
compute distance is  tensor(156.0348, device='cuda:3')
compute norm is  tensor(47.9843, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(165.2294, device='cuda:3')
compute distance is  tensor(165.2294, device='cuda:3')
compute norm is  tensor(48.1258, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(173.1929, device='cuda:3')
compute distance is  tensor(173.1929, device='cuda:3')
compute norm is  tensor(48.5232, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(176.4192, device='cuda:3')
compute distance is  tensor(176.4192, device='cuda:3')
compute norm is  tensor(48.4957, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(171.3480, device='cuda:3')
compute distance is  tensor(171.3480, device='cuda:3')
compute norm is  tensor(48.3404, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(167.5199, device='cuda:3')
compute distance is  tensor(167.5199, device='cuda:3')
compute norm is  tensor(48.2882, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(171.9971, device='cuda:3')
compute distance is  tensor(171.9971, device='cuda:3')
compute norm is  tensor(48.3439, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(171.8643, device='cuda:3')
compute distance is  tensor(171.8643, device='cuda:3')
compute norm is  tensor(48.4346, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(162.0831, device='cuda:3')
compute distance is  tensor(162.0831, device='cuda:3')
compute norm is  tensor(48.1026, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(168.0024, device='cuda:3')
compute distance is  tensor(168.0024, device='cuda:3')
compute norm is  tensor(48.3929, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(165.8840, device='cuda:3')
compute distance is  tensor(165.8840, device='cuda:3')
compute norm is  tensor(48.3309, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(165.9371, device='cuda:3')
compute distance is  tensor(165.9371, device='cuda:3')
compute norm is  tensor(48.3449, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(176.4192, device='cuda:3')
distance 1 is tensor(1869413., device='cuda:3')
________________________________
test distance is  tensor(1869413., device='cuda:3')
test similarity is  tensor(0.2070, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.766685474278404e+18
test entropy is  0.0
________________________________
cal ratio is  0.009520206107477792
distance 1 is tensor(17797.2031, device='cuda:3')
cal_distance is  tensor(17797.2031, device='cuda:3')
cal ratio is  0.09757152798497506
distance 1 is tensor(1736.5065, device='cuda:3')
cal_distance is  tensor(1736.5065, device='cuda:3')
cal ratio is  0.312363856977043
distance 1 is tensor(542.4265, device='cuda:3')
cal_distance is  tensor(542.4265, device='cuda:3')
cal ratio is  0.558892858161913
distance 1 is tensor(303.1613, device='cuda:3')
cal_distance is  tensor(303.1613, device='cuda:3')
cal ratio is  0.7475876731234906
distance 1 is tensor(226.6413, device='cuda:3')
cal_distance is  tensor(226.6413, device='cuda:3')
cal ratio is  0.8646282792844707
distance 1 is tensor(195.9614, device='cuda:3')
cal_distance is  tensor(195.9614, device='cuda:3')
cal ratio is  0.9298517484197513
distance 1 is tensor(182.2155, device='cuda:3')
cal_distance is  tensor(182.2155, device='cuda:3')
cal ratio is  0.9642869032809582
distance 1 is tensor(175.7083, device='cuda:3')
cal_distance is  tensor(175.7083, device='cuda:3')
distance 1 is tensor(175.7083, device='cuda:3')
________________________________
test distance is  tensor(175.7083, device='cuda:3')
test similarity is  tensor(0.9316, device='cuda:3')
test acc is  0.49866666682300875
test loss is 264.8582330471925
test entropy is  3.093143261195022e-05
________________________________
distance 1 is tensor(175.7083, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.6077752066971017e-05
avg test loss is  264.6765440267795
avg accuracy is  0.5026333334896754
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9316, device='cuda:3')
compute_distance is  tensor(175.7083, device='cuda:3')
compute_norm is  tensor(50.5878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(157.6635, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9251815315121527
avg test loss is  1.4145199207863066
avg accuracy is  0.8014166668229921
solo acc is  0.2935666668230061
compute similarity  is  tensor(0.9348, device='cuda:3')
compute_distance is  tensor(157.6635, device='cuda:3')
compute_norm is  tensor(50.5037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.4561, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8717317422315765
avg test loss is  1.46291299580511
avg accuracy is  0.8006000001563254
solo acc is  0.25325000015633836
compute similarity  is  tensor(0.9348, device='cuda:3')
compute_distance is  tensor(157.4561, device='cuda:3')
compute_norm is  tensor(50.2406, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.2672, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8706211783230178
avg test loss is  1.4311494998840382
avg accuracy is  0.8037000001563253
solo acc is  0.2510000001563383
compute similarity  is  tensor(0.9349, device='cuda:3')
compute_distance is  tensor(157.2672, device='cuda:3')
compute_norm is  tensor(49.9777, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.1637, device='cuda:3')
exit early
distance 1 is tensor(157.1637, device='cuda:3')
________________________________
test distance is  tensor(157.1637, device='cuda:3')
test similarity is  tensor(0.9350, device='cuda:3')
test acc is  0.8068166668229917
test loss is 1.4343202458515858
test entropy is  0.855166314316711
________________________________
distance 1 is tensor(157.1637, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8552758685434296
avg test loss is  1.4340893821929819
avg accuracy is  0.8064666668229918
solo acc is  0.24138333348967134
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(157.1637, device='cuda:3')
compute_norm is  tensor(49.7217, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.1537, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8545717129320987
avg test loss is  1.4203597698638688
avg accuracy is  0.8095666668229916
solo acc is  0.2372166668230046
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(157.1537, device='cuda:3')
compute_norm is  tensor(49.4704, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.1905, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.846025548891218
avg test loss is  1.4003323595534
avg accuracy is  0.8097833334896583
solo acc is  0.2421833334896714
compute similarity  is  tensor(0.9351, device='cuda:3')
compute_distance is  tensor(157.1905, device='cuda:3')
compute_norm is  tensor(49.2243, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.2993, device='cuda:3')
exit early
distance 1 is tensor(157.2993, device='cuda:3')
________________________________
test distance is  tensor(157.2993, device='cuda:3')
test similarity is  tensor(0.9351, device='cuda:3')
test acc is  0.8112333334896582
test loss is 1.393339964372517
test entropy is  0.8502173097784331
________________________________
distance 1 is tensor(157.2993, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8488016318537788
avg test loss is  1.3953988822792638
avg accuracy is  0.8110000001563249
solo acc is  0.23676666682300457
compute similarity  is  tensor(0.9351, device='cuda:3')
compute_distance is  tensor(157.2993, device='cuda:3')
compute_norm is  tensor(48.9840, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.4810, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8363583678884039
avg test loss is  1.3808938926979424
avg accuracy is  0.8136166668229915
solo acc is  0.24113333348967134
compute similarity  is  tensor(0.9351, device='cuda:3')
compute_distance is  tensor(157.4810, device='cuda:3')
compute_norm is  tensor(48.7464, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.7055, device='cuda:3')
exit early
distance 1 is tensor(157.7055, device='cuda:3')
________________________________
test distance is  tensor(157.7055, device='cuda:3')
test similarity is  tensor(0.9351, device='cuda:3')
test acc is  0.816133333489658
test loss is 1.3788839977687355
test entropy is  0.8379351794084252
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3261215686798096
mal norm is  tensor(824.5499, device='cuda:3')
distance 1 is tensor(157.7055, device='cuda:3')
mal distance is  tensor(157.7055, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 16, 17, 18, 19, 20, 21, 22, 23]
global_param_square norm is    tensor(21.8645, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.5031, device='cuda:3')
part1 is  tensor(-14.0433, device='cuda:3')
score : tensor(-0.1621, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.0352, device='cuda:3')
part1 is  tensor(-39.4387, device='cuda:3')
score : tensor(-0.4161, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(540.7123, device='cuda:3')
part1 is  tensor(58.3370, device='cuda:3')
score : tensor(0.5617, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(528.4387, device='cuda:3')
part1 is  tensor(-33.3413, device='cuda:3')
score : tensor(-0.3551, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(489.1453, device='cuda:3')
part1 is  tensor(-22.2494, device='cuda:3')
score : tensor(-0.2442, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(524.2357, device='cuda:3')
part1 is  tensor(-49.2830, device='cuda:3')
score : tensor(-0.5145, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(465.4103, device='cuda:3')
part1 is  tensor(6.7638, device='cuda:3')
score : tensor(0.0460, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(531.8245, device='cuda:3')
part1 is  tensor(40.3266, device='cuda:3')
score : tensor(0.3816, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(824.5499, device='cuda:3')
part1 is  tensor(-47.2306, device='cuda:3')
score : tensor(-0.4940, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(633.9061, device='cuda:3')
part1 is  tensor(58.8221, device='cuda:3')
score : tensor(0.5666, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(695.7251, device='cuda:3')
part1 is  tensor(-22.7426, device='cuda:3')
score : tensor(-0.2491, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3800, device='cuda:3')
part1 is  tensor(27.4738, device='cuda:3')
score : tensor(0.2531, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(665.3652, device='cuda:3')
part1 is  tensor(50.7771, device='cuda:3')
score : tensor(0.4861, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(616.1718, device='cuda:3')
part1 is  tensor(49.1177, device='cuda:3')
score : tensor(0.4695, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.5641, device='cuda:3')
part1 is  tensor(-2.1649, device='cuda:3')
score : tensor(-0.0433, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(667.7472, device='cuda:3')
part1 is  tensor(48.9176, device='cuda:3')
score : tensor(0.4675, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(664.3597, device='cuda:3')
part1 is  tensor(11.0897, device='cuda:3')
score : tensor(0.0892, device='cuda:3')
accept
len accept list 9
len all weights is 9
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 90.11% 

Test Accuracy: 89.05% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
 benign loss is  0.33560171723365784
distance 1 is tensor(109.1329, device='cuda:3')
benign distance is  tensor(109.1329, device='cuda:3')
norm1 res is  tensor(0.1250, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3741699755191803
distance 1 is tensor(128.4967, device='cuda:3')
benign distance is  tensor(128.4967, device='cuda:3')
norm1 res is  tensor(0.1401, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2710082530975342
distance 1 is tensor(107.5857, device='cuda:3')
benign distance is  tensor(107.5857, device='cuda:3')
norm1 res is  tensor(0.1164, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4500883221626282
distance 1 is tensor(119.0851, device='cuda:3')
benign distance is  tensor(119.0851, device='cuda:3')
norm1 res is  tensor(0.1318, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2142161875963211
distance 1 is tensor(112.8724, device='cuda:3')
benign distance is  tensor(112.8724, device='cuda:3')
norm1 res is  tensor(0.1209, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4289580285549164
distance 1 is tensor(116.8976, device='cuda:3')
benign distance is  tensor(116.8976, device='cuda:3')
norm1 res is  tensor(0.1265, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.25218942761421204
distance 1 is tensor(108.5057, device='cuda:3')
benign distance is  tensor(108.5057, device='cuda:3')
norm1 res is  tensor(0.1173, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.07452855259180069
distance 1 is tensor(119.3771, device='cuda:3')
benign distance is  tensor(119.3771, device='cuda:3')
norm1 res is  tensor(0.1334, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.11714893579483032
distance 1 is tensor(127.9367, device='cuda:3')
benign distance is  tensor(127.9367, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.3783420920372009
distance 1 is tensor(161.5455, device='cuda:3')
benign distance is  tensor(161.5455, device='cuda:3')
norm1 res is  tensor(0.1720, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.6429265737533569
distance 1 is tensor(124.2174, device='cuda:3')
benign distance is  tensor(124.2174, device='cuda:3')
norm1 res is  tensor(0.1347, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.18529284000396729
distance 1 is tensor(129.3701, device='cuda:3')
benign distance is  tensor(129.3701, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.259146511554718
distance 1 is tensor(130.8920, device='cuda:3')
benign distance is  tensor(130.8920, device='cuda:3')
norm1 res is  tensor(0.1414, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.3505813479423523
distance 1 is tensor(135.2491, device='cuda:3')
benign distance is  tensor(135.2491, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.22745127975940704
distance 1 is tensor(129.9518, device='cuda:3')
benign distance is  tensor(129.9518, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.5028966665267944
distance 1 is tensor(125.1673, device='cuda:3')
benign distance is  tensor(125.1673, device='cuda:3')
norm1 res is  tensor(0.1322, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(156.8176, device='cuda:3')
compute distance is  tensor(156.8176, device='cuda:3')
compute norm is  tensor(47.1257, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.8615, device='cuda:3')
compute distance is  tensor(158.8615, device='cuda:3')
compute norm is  tensor(47.1348, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(162.3277, device='cuda:3')
compute distance is  tensor(162.3277, device='cuda:3')
compute norm is  tensor(47.3724, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(165.7832, device='cuda:3')
compute distance is  tensor(165.7832, device='cuda:3')
compute norm is  tensor(47.5210, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(164.8740, device='cuda:3')
compute distance is  tensor(164.8740, device='cuda:3')
compute norm is  tensor(47.5192, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(153.3442, device='cuda:3')
compute distance is  tensor(153.3442, device='cuda:3')
compute norm is  tensor(47.2511, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.1467, device='cuda:3')
compute distance is  tensor(155.1467, device='cuda:3')
compute norm is  tensor(47.1945, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(160.0302, device='cuda:3')
compute distance is  tensor(160.0302, device='cuda:3')
compute norm is  tensor(47.3253, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(172.3118, device='cuda:3')
compute distance is  tensor(172.3118, device='cuda:3')
compute norm is  tensor(47.5347, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(148.1712, device='cuda:3')
compute distance is  tensor(148.1712, device='cuda:3')
compute norm is  tensor(47.0712, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.3897, device='cuda:3')
compute distance is  tensor(154.3897, device='cuda:3')
compute norm is  tensor(47.2505, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.8676, device='cuda:3')
compute distance is  tensor(155.8676, device='cuda:3')
compute norm is  tensor(47.1363, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(172.3118, device='cuda:3')
distance 1 is tensor(1869435.3750, device='cuda:3')
________________________________
test distance is  tensor(1869435.3750, device='cuda:3')
test similarity is  tensor(0.1241, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.767690906744677e+18
test entropy is  0.0
________________________________
cal ratio is  0.009408671443495263
distance 1 is tensor(17588.9082, device='cuda:3')
cal_distance is  tensor(17588.9082, device='cuda:3')
cal ratio is  0.0969982928418175
distance 1 is tensor(1706.1001, device='cuda:3')
cal_distance is  tensor(1706.1001, device='cuda:3')
cal ratio is  0.3114449373934583
distance 1 is tensor(531.3609, device='cuda:3')
cal_distance is  tensor(531.3609, device='cuda:3')
cal ratio is  0.5580700657413187
distance 1 is tensor(296.5396, device='cuda:3')
cal_distance is  tensor(296.5396, device='cuda:3')
cal ratio is  0.7470371472864572
distance 1 is tensor(221.5278, device='cuda:3')
cal_distance is  tensor(221.5278, device='cuda:3')
cal ratio is  0.8643096663993868
distance 1 is tensor(191.4696, device='cuda:3')
cal_distance is  tensor(191.4696, device='cuda:3')
cal ratio is  0.9296803725025496
distance 1 is tensor(178.0060, device='cuda:3')
cal_distance is  tensor(178.0060, device='cuda:3')
cal ratio is  0.9641980306982887
distance 1 is tensor(171.6332, device='cuda:3')
cal_distance is  tensor(171.6332, device='cuda:3')
distance 1 is tensor(171.6332, device='cuda:3')
________________________________
test distance is  tensor(171.6332, device='cuda:3')
test similarity is  tensor(0.9292, device='cuda:3')
test acc is  0.5720166668230068
test loss is 276.9711938788896
test entropy is  0.00010154381019750553
________________________________
distance 1 is tensor(171.6332, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00010907112235374991
avg test loss is  277.48231773132454
avg accuracy is  0.5702166668230068
solo acc is  0.10030000015633199
compute similarity  is  tensor(0.9292, device='cuda:3')
compute_distance is  tensor(171.6332, device='cuda:3')
compute_norm is  tensor(50.2549, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(153.1734, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9321595451979241
avg test loss is  1.417621004301856
avg accuracy is  0.8319666668229906
solo acc is  0.29258333348967264
compute similarity  is  tensor(0.9322, device='cuda:3')
compute_distance is  tensor(153.1734, device='cuda:3')
compute_norm is  tensor(49.9816, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.4559, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8790872892591236
avg test loss is  1.4895156665143174
avg accuracy is  0.8310333334896574
solo acc is  0.2455166668230048
compute similarity  is  tensor(0.9322, device='cuda:3')
compute_distance is  tensor(153.4559, device='cuda:3')
compute_norm is  tensor(49.7192, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.6988, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8680662848293654
avg test loss is  1.4737946300872609
avg accuracy is  0.8346500001563238
solo acc is  0.24078333348967138
compute similarity  is  tensor(0.9321, device='cuda:3')
compute_distance is  tensor(153.6988, device='cuda:3')
compute_norm is  tensor(49.4573, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.0454, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.857810667328743
avg test loss is  1.4350052362820234
avg accuracy is  0.8348500001563238
solo acc is  0.24885000015633826
compute similarity  is  tensor(0.9321, device='cuda:3')
compute_distance is  tensor(154.0454, device='cuda:3')
compute_norm is  tensor(49.2003, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.4855, device='cuda:3')
________________________________
test distance is  tensor(154.4855, device='cuda:3')
test similarity is  tensor(0.9321, device='cuda:3')
test acc is  0.8374000001563239
test loss is 1.4303710211568803
test entropy is  0.8587975862946338
________________________________
distance 1 is tensor(154.4855, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8593144574399187
avg test loss is  1.4304842211798565
avg accuracy is  0.8361333334896571
solo acc is  0.23826666682300462
compute similarity  is  tensor(0.9321, device='cuda:3')
compute_distance is  tensor(154.4855, device='cuda:3')
compute_norm is  tensor(48.9492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.9230, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8599391250468013
avg test loss is  1.4070844961636102
avg accuracy is  0.8375000001563239
solo acc is  0.2416333334896713
compute similarity  is  tensor(0.9320, device='cuda:3')
compute_distance is  tensor(154.9230, device='cuda:3')
compute_norm is  tensor(48.7013, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.4911, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8476852938564602
avg test loss is  1.3941190106782324
avg accuracy is  0.8413333334896569
solo acc is  0.24451666682300477
compute similarity  is  tensor(0.9320, device='cuda:3')
compute_distance is  tensor(155.4911, device='cuda:3')
compute_norm is  tensor(48.4583, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.0315, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8403705127203642
avg test loss is  1.373143600629591
avg accuracy is  0.8404500001563238
solo acc is  0.2512500001563383
compute similarity  is  tensor(0.9319, device='cuda:3')
compute_distance is  tensor(156.0315, device='cuda:3')
compute_norm is  tensor(48.2184, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(156.6204, device='cuda:3')
exit early
distance 1 is tensor(156.6204, device='cuda:3')
________________________________
test distance is  tensor(156.6204, device='cuda:3')
test similarity is  tensor(0.9319, device='cuda:3')
test acc is  0.8431666668229902
test loss is 1.369494400489559
test entropy is  0.8409529833524212
________________________________
distance 1 is tensor(156.6204, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8397888784596661
avg test loss is  1.3693117201963723
avg accuracy is  0.8432333334896569
solo acc is  0.2435000001563381
compute similarity  is  tensor(0.9319, device='cuda:3')
compute_distance is  tensor(156.6204, device='cuda:3')
compute_norm is  tensor(47.9816, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(157.2826, device='cuda:3')
exit early
distance 1 is tensor(157.2826, device='cuda:3')
________________________________
test distance is  tensor(157.2826, device='cuda:3')
test similarity is  tensor(0.9318, device='cuda:3')
test acc is  0.8450333334896568
test loss is 1.3665840765560613
test entropy is  0.8389470523227253
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3810781240463257
mal norm is  tensor(811.6243, device='cuda:3')
distance 1 is tensor(157.2826, device='cuda:3')
mal distance is  tensor(157.2826, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(9.9712, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(467.5492, device='cuda:3')
part1 is  tensor(8.7718, device='cuda:3')
score : tensor(0.0779, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(551.0164, device='cuda:3')
part1 is  tensor(-14.9286, device='cuda:3')
score : tensor(-0.1591, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(453.7504, device='cuda:3')
part1 is  tensor(7.3671, device='cuda:3')
score : tensor(0.0639, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(500.1461, device='cuda:3')
part1 is  tensor(8.4351, device='cuda:3')
score : tensor(0.0746, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(477.9170, device='cuda:3')
part1 is  tensor(-14.3595, device='cuda:3')
score : tensor(-0.1534, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(496.7745, device='cuda:3')
part1 is  tensor(-8.8242, device='cuda:3')
score : tensor(-0.0980, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(454.5403, device='cuda:3')
part1 is  tensor(-12.9838, device='cuda:3')
score : tensor(-0.1396, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(519.5277, device='cuda:3')
part1 is  tensor(5.3724, device='cuda:3')
score : tensor(0.0440, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(811.6243, device='cuda:3')
part1 is  tensor(-7.4396, device='cuda:3')
score : tensor(-0.0842, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(574.7358, device='cuda:3')
part1 is  tensor(-12.4650, device='cuda:3')
score : tensor(-0.1344, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.9043, device='cuda:3')
part1 is  tensor(-16.4394, device='cuda:3')
score : tensor(-0.1742, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(573.9072, device='cuda:3')
part1 is  tensor(-10.4778, device='cuda:3')
score : tensor(-0.1145, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.3594, device='cuda:3')
part1 is  tensor(-23.7505, device='cuda:3')
score : tensor(-0.2473, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(572.5303, device='cuda:3')
part1 is  tensor(-10.1175, device='cuda:3')
score : tensor(-0.1109, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.3537, device='cuda:3')
part1 is  tensor(-0.5261, device='cuda:3')
score : tensor(-0.0150, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(591.2959, device='cuda:3')
part1 is  tensor(-26.9761, device='cuda:3')
score : tensor(-0.2795, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.1727, device='cuda:3')
part1 is  tensor(-26.3933, device='cuda:3')
score : tensor(-0.2737, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.75% 

Test Accuracy: 88.90% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
 benign loss is  0.5191982984542847
distance 1 is tensor(102.2355, device='cuda:3')
benign distance is  tensor(102.2355, device='cuda:3')
norm1 res is  tensor(0.1153, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4122484624385834
distance 1 is tensor(136.9342, device='cuda:3')
benign distance is  tensor(136.9342, device='cuda:3')
norm1 res is  tensor(0.1533, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2665773034095764
distance 1 is tensor(114.7340, device='cuda:3')
benign distance is  tensor(114.7340, device='cuda:3')
norm1 res is  tensor(0.1235, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.2577120065689087
distance 1 is tensor(124.5274, device='cuda:3')
benign distance is  tensor(124.5274, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.22661630809307098
distance 1 is tensor(129.1402, device='cuda:3')
benign distance is  tensor(129.1402, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.40692242980003357
distance 1 is tensor(150.2568, device='cuda:3')
benign distance is  tensor(150.2568, device='cuda:3')
norm1 res is  tensor(0.1619, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.37801966071128845
distance 1 is tensor(103.4042, device='cuda:3')
benign distance is  tensor(103.4042, device='cuda:3')
norm1 res is  tensor(0.1111, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2426837980747223
distance 1 is tensor(104.0781, device='cuda:3')
benign distance is  tensor(104.0781, device='cuda:3')
norm1 res is  tensor(0.1126, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.07108570635318756
distance 1 is tensor(153.4282, device='cuda:3')
benign distance is  tensor(153.4282, device='cuda:3')
norm1 res is  tensor(0.1642, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.4558469355106354
distance 1 is tensor(137.3352, device='cuda:3')
benign distance is  tensor(137.3352, device='cuda:3')
norm1 res is  tensor(0.1482, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.5462054014205933
distance 1 is tensor(136.0055, device='cuda:3')
benign distance is  tensor(136.0055, device='cuda:3')
norm1 res is  tensor(0.1480, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.660035252571106
distance 1 is tensor(132.6281, device='cuda:3')
benign distance is  tensor(132.6281, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.27012476325035095
distance 1 is tensor(140.5060, device='cuda:3')
benign distance is  tensor(140.5060, device='cuda:3')
norm1 res is  tensor(0.1530, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.24268081784248352
distance 1 is tensor(142.2876, device='cuda:3')
benign distance is  tensor(142.2876, device='cuda:3')
norm1 res is  tensor(0.1549, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.21412353217601776
distance 1 is tensor(134.4734, device='cuda:3')
benign distance is  tensor(134.4734, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.40208491683006287
distance 1 is tensor(147.2224, device='cuda:3')
benign distance is  tensor(147.2224, device='cuda:3')
norm1 res is  tensor(0.1612, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(153.2916, device='cuda:3')
compute distance is  tensor(153.2916, device='cuda:3')
compute norm is  tensor(47.5326, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.8422, device='cuda:3')
compute distance is  tensor(149.8422, device='cuda:3')
compute norm is  tensor(47.3456, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.9176, device='cuda:3')
compute distance is  tensor(149.9176, device='cuda:3')
compute norm is  tensor(47.6177, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(158.6748, device='cuda:3')
compute distance is  tensor(158.6748, device='cuda:3')
compute norm is  tensor(47.7676, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(162.0290, device='cuda:3')
compute distance is  tensor(162.0290, device='cuda:3')
compute norm is  tensor(47.8614, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(164.8254, device='cuda:3')
compute distance is  tensor(164.8254, device='cuda:3')
compute norm is  tensor(48.0214, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(151.0237, device='cuda:3')
compute distance is  tensor(151.0237, device='cuda:3')
compute norm is  tensor(47.4818, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(142.8514, device='cuda:3')
compute distance is  tensor(142.8514, device='cuda:3')
compute norm is  tensor(47.3669, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(157.7078, device='cuda:3')
compute distance is  tensor(157.7078, device='cuda:3')
compute norm is  tensor(47.6468, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(153.0707, device='cuda:3')
compute distance is  tensor(153.0707, device='cuda:3')
compute norm is  tensor(47.6109, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(145.1786, device='cuda:3')
compute distance is  tensor(145.1786, device='cuda:3')
compute norm is  tensor(47.5469, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.1532, device='cuda:3')
compute distance is  tensor(152.1532, device='cuda:3')
compute norm is  tensor(47.7072, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.8254, device='cuda:3')
distance 1 is tensor(1869437.1250, device='cuda:3')
________________________________
test distance is  tensor(1869437.1250, device='cuda:3')
test similarity is  tensor(0.1099, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765900758807815e+18
test entropy is  0.0
________________________________
cal ratio is  0.009202009720335165
distance 1 is tensor(17202.5840, device='cuda:3')
cal_distance is  tensor(17202.5840, device='cuda:3')
cal ratio is  0.09592709236353475
distance 1 is tensor(1650.1998, device='cuda:3')
cal_distance is  tensor(1650.1998, device='cuda:3')
cal ratio is  0.30972042809910205
distance 1 is tensor(511.1053, device='cuda:3')
cal_distance is  tensor(511.1053, device='cuda:3')
cal ratio is  0.5565227494028379
distance 1 is tensor(284.4447, device='cuda:3')
cal_distance is  tensor(284.4447, device='cuda:3')
cal ratio is  0.7460006030511079
distance 1 is tensor(212.1976, device='cuda:3')
cal_distance is  tensor(212.1976, device='cuda:3')
cal ratio is  0.8637097674493825
distance 1 is tensor(183.2781, device='cuda:3')
cal_distance is  tensor(183.2781, device='cuda:3')
cal ratio is  0.9293575138353098
distance 1 is tensor(170.3313, device='cuda:3')
cal_distance is  tensor(170.3313, device='cuda:3')
cal ratio is  0.9640306228486771
distance 1 is tensor(164.2049, device='cuda:3')
cal_distance is  tensor(164.2049, device='cuda:3')
distance 1 is tensor(164.2049, device='cuda:3')
________________________________
test distance is  tensor(164.2049, device='cuda:3')
test similarity is  tensor(0.9352, device='cuda:3')
test acc is  0.6903000001563312
test loss is 228.24454347004513
test entropy is  0.0009574650689704016
________________________________
distance 1 is tensor(164.2049, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0009770837709217137
avg test loss is  228.6530504369024
avg accuracy is  0.692900000156331
solo acc is  0.10256666682299863
compute similarity  is  tensor(0.9352, device='cuda:3')
compute_distance is  tensor(164.2049, device='cuda:3')
compute_norm is  tensor(50.4915, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(148.0756, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9145407747866502
avg test loss is  1.4132121897963827
avg accuracy is  0.8412500001563236
solo acc is  0.29726666682300606
compute similarity  is  tensor(0.9375, device='cuda:3')
compute_distance is  tensor(148.0756, device='cuda:3')
compute_norm is  tensor(50.0342, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(148.7171, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8783896717943871
avg test loss is  1.474117523317398
avg accuracy is  0.8385333334896571
solo acc is  0.25275000015633836
compute similarity  is  tensor(0.9374, device='cuda:3')
compute_distance is  tensor(148.7171, device='cuda:3')
compute_norm is  tensor(49.7695, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.2587, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8709269357261373
avg test loss is  1.4584322988605702
avg accuracy is  0.839383333489657
solo acc is  0.24518333348967147
compute similarity  is  tensor(0.9373, device='cuda:3')
compute_distance is  tensor(149.2587, device='cuda:3')
compute_norm is  tensor(49.5063, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(149.7290, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8616213958019386
avg test loss is  1.4474504956050214
avg accuracy is  0.8426666668229903
solo acc is  0.24128333348967132
compute similarity  is  tensor(0.9372, device='cuda:3')
compute_distance is  tensor(149.7290, device='cuda:3')
compute_norm is  tensor(49.2496, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.2315, device='cuda:3')
________________________________
test distance is  tensor(150.2315, device='cuda:3')
test similarity is  tensor(0.9371, device='cuda:3')
test acc is  0.8462666668229901
test loss is 1.41564076058646
test entropy is  0.8591846768408696
________________________________
distance 1 is tensor(150.2315, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8588592710017141
avg test loss is  1.4150357383654824
avg accuracy is  0.8426166668229903
solo acc is  0.24975000015633828
compute similarity  is  tensor(0.9371, device='cuda:3')
compute_distance is  tensor(150.2315, device='cuda:3')
compute_norm is  tensor(48.9992, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(150.8418, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8538107324256572
avg test loss is  1.4085250008843346
avg accuracy is  0.8448500001563234
solo acc is  0.24280000015633804
compute similarity  is  tensor(0.9370, device='cuda:3')
compute_distance is  tensor(150.8418, device='cuda:3')
compute_norm is  tensor(48.7516, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(151.4749, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8511088158148946
avg test loss is  1.397599736764741
avg accuracy is  0.8465333334896566
solo acc is  0.24218333348967144
compute similarity  is  tensor(0.9370, device='cuda:3')
compute_distance is  tensor(151.4749, device='cuda:3')
compute_norm is  tensor(48.5092, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.1497, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8468528648556423
avg test loss is  1.3900785505898725
avg accuracy is  0.8490500001563234
solo acc is  0.23805000015633787
compute similarity  is  tensor(0.9369, device='cuda:3')
compute_distance is  tensor(152.1497, device='cuda:3')
compute_norm is  tensor(48.2701, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(152.8692, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8401918333730718
avg test loss is  1.3752765636454258
avg accuracy is  0.84836666682299
solo acc is  0.23995000015633797
compute similarity  is  tensor(0.9368, device='cuda:3')
compute_distance is  tensor(152.8692, device='cuda:3')
compute_norm is  tensor(48.0328, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(153.6360, device='cuda:3')
________________________________
test distance is  tensor(153.6360, device='cuda:3')
test similarity is  tensor(0.9367, device='cuda:3')
test acc is  0.8501166668229899
test loss is 1.3626881113438718
test entropy is  0.8377652513320004
________________________________
distance 1 is tensor(153.6360, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8387649318556796
avg test loss is  1.3602625708590184
avg accuracy is  0.8497000001563232
solo acc is  0.24105000015633798
compute similarity  is  tensor(0.9367, device='cuda:3')
compute_distance is  tensor(153.6360, device='cuda:3')
compute_norm is  tensor(47.7985, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(154.4472, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.83538454440611
avg test loss is  1.351632014012286
avg accuracy is  0.8505500001563233
solo acc is  0.24013333348967136
compute similarity  is  tensor(0.9366, device='cuda:3')
compute_distance is  tensor(154.4472, device='cuda:3')
compute_norm is  tensor(47.5663, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(155.2645, device='cuda:3')
exit early
distance 1 is tensor(155.2645, device='cuda:3')
________________________________
test distance is  tensor(155.2645, device='cuda:3')
test similarity is  tensor(0.9365, device='cuda:3')
test acc is  0.8529666668229899
test loss is 1.351858443797016
test entropy is  0.8272451650994673
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.196411371231079
mal norm is  tensor(777.0874, device='cuda:3')
distance 1 is tensor(155.2645, device='cuda:3')
mal distance is  tensor(155.2645, device='cuda:3')
len current grad  20
len all grad 28
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 32, 33, 34, 35, 36, 37, 38, 39]
global_param_square norm is    tensor(11.7258, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(436.5172, device='cuda:3')
part1 is  tensor(18.7027, device='cuda:3')
score : tensor(0.1755, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(599.3519, device='cuda:3')
part1 is  tensor(-17.0698, device='cuda:3')
score : tensor(-0.1822, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(479.2894, device='cuda:3')
part1 is  tensor(-5.6423, device='cuda:3')
score : tensor(-0.0679, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(542.7495, device='cuda:3')
part1 is  tensor(-0.7242, device='cuda:3')
score : tensor(-0.0188, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(545.4352, device='cuda:3')
part1 is  tensor(-19.8557, device='cuda:3')
score : tensor(-0.2101, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(642.5828, device='cuda:3')
part1 is  tensor(-2.8677, device='cuda:3')
score : tensor(-0.0402, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(433.7993, device='cuda:3')
part1 is  tensor(-22.7002, device='cuda:3')
score : tensor(-0.2385, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(446.2090, device='cuda:3')
part1 is  tensor(-7.7543, device='cuda:3')
score : tensor(-0.0891, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(777.0874, device='cuda:3')
part1 is  tensor(-2.7729, device='cuda:3')
score : tensor(-0.0393, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.9173, device='cuda:3')
part1 is  tensor(-1.0645, device='cuda:3')
score : tensor(-0.0222, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.8474, device='cuda:3')
part1 is  tensor(27.7099, device='cuda:3')
score : tensor(0.2656, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(603.9797, device='cuda:3')
part1 is  tensor(-14.4086, device='cuda:3')
score : tensor(-0.1556, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(576.7272, device='cuda:3')
part1 is  tensor(3.6438, device='cuda:3')
score : tensor(0.0249, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(630.2830, device='cuda:3')
part1 is  tensor(-6.2357, device='cuda:3')
score : tensor(-0.0739, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.0706, device='cuda:3')
part1 is  tensor(-6.8170, device='cuda:3')
score : tensor(-0.0797, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(609.5674, device='cuda:3')
part1 is  tensor(0.9541, device='cuda:3')
score : tensor(-0.0020, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(589.0729, device='cuda:3')
part1 is  tensor(-10.7332, device='cuda:3')
score : tensor(-0.1189, device='cuda:3')
len accept list 3
len all weights is 3
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.84% 

Test Accuracy: 88.91% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4527858793735504
distance 1 is tensor(96.7564, device='cuda:3')
benign distance is  tensor(96.7564, device='cuda:3')
norm1 res is  tensor(0.1057, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5231216549873352
distance 1 is tensor(132.2377, device='cuda:3')
benign distance is  tensor(132.2377, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.4170083999633789
distance 1 is tensor(111.5073, device='cuda:3')
benign distance is  tensor(111.5073, device='cuda:3')
norm1 res is  tensor(0.1189, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.08449865877628326
distance 1 is tensor(103.6427, device='cuda:3')
benign distance is  tensor(103.6427, device='cuda:3')
norm1 res is  tensor(0.1127, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.055063288658857346
distance 1 is tensor(117.4585, device='cuda:3')
benign distance is  tensor(117.4585, device='cuda:3')
norm1 res is  tensor(0.1299, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.18962767720222473
distance 1 is tensor(132.1174, device='cuda:3')
benign distance is  tensor(132.1174, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.4960384964942932
distance 1 is tensor(128.0372, device='cuda:3')
benign distance is  tensor(128.0372, device='cuda:3')
norm1 res is  tensor(0.1359, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.08679307997226715
distance 1 is tensor(126.7131, device='cuda:3')
benign distance is  tensor(126.7131, device='cuda:3')
norm1 res is  tensor(0.1358, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.44426989555358887
distance 1 is tensor(140.1749, device='cuda:3')
benign distance is  tensor(140.1749, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.06982602179050446
distance 1 is tensor(113.0402, device='cuda:3')
benign distance is  tensor(113.0402, device='cuda:3')
norm1 res is  tensor(0.1260, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.3619023859500885
distance 1 is tensor(154.8628, device='cuda:3')
benign distance is  tensor(154.8628, device='cuda:3')
norm1 res is  tensor(0.1637, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.3459224998950958
distance 1 is tensor(121.7904, device='cuda:3')
benign distance is  tensor(121.7904, device='cuda:3')
norm1 res is  tensor(0.1308, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.10042474418878555
distance 1 is tensor(133.9719, device='cuda:3')
benign distance is  tensor(133.9719, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.4172421991825104
distance 1 is tensor(130.5925, device='cuda:3')
benign distance is  tensor(130.5925, device='cuda:3')
norm1 res is  tensor(0.1389, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.2308005839586258
distance 1 is tensor(125.1555, device='cuda:3')
benign distance is  tensor(125.1555, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.2213582992553711
distance 1 is tensor(135.6302, device='cuda:3')
benign distance is  tensor(135.6302, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(145.2277, device='cuda:3')
compute distance is  tensor(145.2277, device='cuda:3')
compute norm is  tensor(47.7985, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(130.7629, device='cuda:3')
compute distance is  tensor(130.7629, device='cuda:3')
compute norm is  tensor(47.3678, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(146.0390, device='cuda:3')
compute distance is  tensor(146.0390, device='cuda:3')
compute norm is  tensor(47.9847, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(136.4521, device='cuda:3')
compute distance is  tensor(136.4521, device='cuda:3')
compute norm is  tensor(47.7324, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.6920, device='cuda:3')
compute distance is  tensor(134.6920, device='cuda:3')
compute norm is  tensor(47.5977, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(144.7830, device='cuda:3')
compute distance is  tensor(144.7830, device='cuda:3')
compute norm is  tensor(47.8823, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(140.6663, device='cuda:3')
compute distance is  tensor(140.6663, device='cuda:3')
compute norm is  tensor(47.7688, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(139.6621, device='cuda:3')
compute distance is  tensor(139.6621, device='cuda:3')
compute norm is  tensor(47.7176, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.0305, device='cuda:3')
compute distance is  tensor(143.0305, device='cuda:3')
compute norm is  tensor(47.7606, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(137.5098, device='cuda:3')
compute distance is  tensor(137.5098, device='cuda:3')
compute norm is  tensor(47.6993, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(136.0733, device='cuda:3')
compute distance is  tensor(136.0733, device='cuda:3')
compute norm is  tensor(47.6536, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(134.7965, device='cuda:3')
compute distance is  tensor(134.7965, device='cuda:3')
compute norm is  tensor(47.5308, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.0390, device='cuda:3')
distance 1 is tensor(1869443.7500, device='cuda:3')
________________________________
test distance is  tensor(1869443.7500, device='cuda:3')
test similarity is  tensor(0.0868, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.765957715971727e+18
test entropy is  0.0
________________________________
cal ratio is  0.008661723582065272
distance 1 is tensor(16192.6123, device='cuda:3')
cal_distance is  tensor(16192.6123, device='cuda:3')
cal ratio is  0.09306836268278941
distance 1 is tensor(1507.0261, device='cuda:3')
cal_distance is  tensor(1507.0261, device='cuda:3')
cal ratio is  0.30507044679696943
distance 1 is tensor(459.7538, device='cuda:3')
cal_distance is  tensor(459.7538, device='cuda:3')
cal ratio is  0.5523290050540264
distance 1 is tensor(253.9384, device='cuda:3')
cal_distance is  tensor(253.9384, device='cuda:3')
cal ratio is  0.7431839867065222
distance 1 is tensor(188.7247, device='cuda:3')
cal_distance is  tensor(188.7247, device='cuda:3')
cal ratio is  0.8620771747032338
distance 1 is tensor(162.6962, device='cuda:3')
cal_distance is  tensor(162.6962, device='cuda:3')
cal ratio is  0.9284784990013066
distance 1 is tensor(151.0604, device='cuda:3')
cal_distance is  tensor(151.0604, device='cuda:3')
cal ratio is  0.9635743861249989
distance 1 is tensor(145.5582, device='cuda:3')
cal_distance is  tensor(145.5582, device='cuda:3')
distance 1 is tensor(145.5582, device='cuda:3')
________________________________
test distance is  tensor(145.5582, device='cuda:3')
test similarity is  tensor(0.9463, device='cuda:3')
test acc is  0.7710333334896601
test loss is 148.1262462510229
test entropy is  0.0023722233951485377
________________________________
distance 1 is tensor(145.5582, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.002401345174434597
avg test loss is  147.98778061368571
avg accuracy is  0.7716333334896601
solo acc is  0.10866666682299862
compute similarity  is  tensor(0.9463, device='cuda:3')
compute_distance is  tensor(145.5582, device='cuda:3')
compute_norm is  tensor(49.7212, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(131.5618, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.906569345609974
avg test loss is  1.3940571455050632
avg accuracy is  0.8556333334896564
solo acc is  0.3042500001563395
compute similarity  is  tensor(0.9478, device='cuda:3')
compute_distance is  tensor(131.5618, device='cuda:3')
compute_norm is  tensor(49.0142, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(132.5797, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8682352296197846
avg test loss is  1.4538040637715792
avg accuracy is  0.8534500001563232
solo acc is  0.2552166668230051
compute similarity  is  tensor(0.9475, device='cuda:3')
compute_distance is  tensor(132.5797, device='cuda:3')
compute_norm is  tensor(48.7457, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(133.4630, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8594643717000225
avg test loss is  1.420723975594364
avg accuracy is  0.8528500001563232
solo acc is  0.2591000001563385
compute similarity  is  tensor(0.9474, device='cuda:3')
compute_distance is  tensor(133.4630, device='cuda:3')
compute_norm is  tensor(48.4864, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(134.3268, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8536802720286445
avg test loss is  1.4062576712067447
avg accuracy is  0.8562333334896564
solo acc is  0.25616666682300515
compute similarity  is  tensor(0.9473, device='cuda:3')
compute_distance is  tensor(134.3268, device='cuda:3')
compute_norm is  tensor(48.2339, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(135.2791, device='cuda:3')
________________________________
test distance is  tensor(135.2791, device='cuda:3')
test similarity is  tensor(0.9471, device='cuda:3')
test acc is  0.8578166668229896
test loss is 1.4026257294708733
test entropy is  0.8443188728935429
________________________________
distance 1 is tensor(135.2791, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8432355200303897
avg test loss is  1.4015152237054382
avg accuracy is  0.8579833334896562
solo acc is  0.25148333348967167
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(135.2791, device='cuda:3')
compute_norm is  tensor(47.9866, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(136.2347, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8416886071025181
avg test loss is  1.3846178034475363
avg accuracy is  0.8585833334896562
solo acc is  0.25141666682300495
compute similarity  is  tensor(0.9470, device='cuda:3')
compute_distance is  tensor(136.2347, device='cuda:3')
compute_norm is  tensor(47.7434, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(137.1753, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8459523444745078
avg test loss is  1.3723754284224277
avg accuracy is  0.8591333334896561
solo acc is  0.24726666682300488
compute similarity  is  tensor(0.9469, device='cuda:3')
compute_distance is  tensor(137.1753, device='cuda:3')
compute_norm is  tensor(47.5037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(138.1438, device='cuda:3')
exit early
distance 1 is tensor(138.1438, device='cuda:3')
________________________________
test distance is  tensor(138.1438, device='cuda:3')
test similarity is  tensor(0.9467, device='cuda:3')
test acc is  0.8610333334896562
test loss is 1.3661954217373944
test entropy is  0.8398119601994943
________________________________
distance 1 is tensor(138.1438, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8413115615910812
avg test loss is  1.3637886612908419
avg accuracy is  0.8608000001563229
solo acc is  0.24375000015633805
compute similarity  is  tensor(0.9467, device='cuda:3')
compute_distance is  tensor(138.1438, device='cuda:3')
compute_norm is  tensor(47.2681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(139.1204, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8381485484683437
avg test loss is  1.349336524253715
avg accuracy is  0.8627000001563228
solo acc is  0.24666666682300484
compute similarity  is  tensor(0.9466, device='cuda:3')
compute_distance is  tensor(139.1204, device='cuda:3')
compute_norm is  tensor(47.0347, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(140.1638, device='cuda:3')
exit early
distance 1 is tensor(140.1638, device='cuda:3')
________________________________
test distance is  tensor(140.1638, device='cuda:3')
test similarity is  tensor(0.9465, device='cuda:3')
test acc is  0.863083333489656
test loss is 1.3501923349874614
test entropy is  0.8308327161808258
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3178818225860596
mal norm is  tensor(702.5109, device='cuda:3')
distance 1 is tensor(140.1638, device='cuda:3')
mal distance is  tensor(140.1638, device='cuda:3')
len current grad  20
len all grad 52
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 40, 41, 42, 43, 44, 45, 46, 47, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
global_param_square norm is    tensor(21.9825, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(416.8426, device='cuda:3')
part1 is  tensor(10.8850, device='cuda:3')
score : tensor(0.0871, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(578.5527, device='cuda:3')
part1 is  tensor(39.7312, device='cuda:3')
score : tensor(0.3755, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(469.1692, device='cuda:3')
part1 is  tensor(29.2902, device='cuda:3')
score : tensor(0.2711, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(445.2339, device='cuda:3')
part1 is  tensor(34.7342, device='cuda:3')
score : tensor(0.3256, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(495.1252, device='cuda:3')
part1 is  tensor(-22.4586, device='cuda:3')
score : tensor(-0.2464, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.1629, device='cuda:3')
part1 is  tensor(27.3075, device='cuda:3')
score : tensor(0.2513, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(535.8357, device='cuda:3')
part1 is  tensor(106.2978, device='cuda:3')
score : tensor(1.0412, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(538.3802, device='cuda:3')
part1 is  tensor(35.0436, device='cuda:3')
score : tensor(0.3287, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(702.5109, device='cuda:3')
part1 is  tensor(-41.8022, device='cuda:3')
score : tensor(-0.4398, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(598.8889, device='cuda:3')
part1 is  tensor(-13.3650, device='cuda:3')
score : tensor(-0.1554, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(612.4653, device='cuda:3')
part1 is  tensor(-41.3852, device='cuda:3')
score : tensor(-0.4356, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(586.3458, device='cuda:3')
part1 is  tensor(64.7330, device='cuda:3')
score : tensor(0.6255, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(638.9902, device='cuda:3')
part1 is  tensor(27.1957, device='cuda:3')
score : tensor(0.2502, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(562.2712, device='cuda:3')
part1 is  tensor(-6.6206, device='cuda:3')
score : tensor(-0.0880, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(613.1700, device='cuda:3')
part1 is  tensor(10.4523, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(605.3740, device='cuda:3')
part1 is  tensor(8.6161, device='cuda:3')
score : tensor(0.0644, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(623.6109, device='cuda:3')
part1 is  tensor(-12.4549, device='cuda:3')
score : tensor(-0.1463, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(663.8793, device='cuda:3')
part1 is  tensor(3.2477, device='cuda:3')
score : tensor(0.0107, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(649.9160, device='cuda:3')
part1 is  tensor(6.2480, device='cuda:3')
score : tensor(0.0407, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(678.9307, device='cuda:3')
part1 is  tensor(2.3367, device='cuda:3')
score : tensor(0.0016, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(689.5561, device='cuda:3')
part1 is  tensor(11.5177, device='cuda:3')
score : tensor(0.0934, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(658.1161, device='cuda:3')
part1 is  tensor(-28.8599, device='cuda:3')
score : tensor(-0.3104, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(672.1041, device='cuda:3')
part1 is  tensor(37.7350, device='cuda:3')
score : tensor(0.3556, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(687.3433, device='cuda:3')
part1 is  tensor(10.4383, device='cuda:3')
score : tensor(0.0826, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(637.9420, device='cuda:3')
part1 is  tensor(-21.1152, device='cuda:3')
score : tensor(-0.2329, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(600.4680, device='cuda:3')
part1 is  tensor(-8.3168, device='cuda:3')
score : tensor(-0.1049, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(725.4583, device='cuda:3')
part1 is  tensor(26.7057, device='cuda:3')
score : tensor(0.2453, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.1311, device='cuda:3')
part1 is  tensor(17.6220, device='cuda:3')
score : tensor(0.1544, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(604.5190, device='cuda:3')
part1 is  tensor(24.9930, device='cuda:3')
score : tensor(0.2281, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(621.5786, device='cuda:3')
part1 is  tensor(46.1460, device='cuda:3')
score : tensor(0.4397, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(624.4868, device='cuda:3')
part1 is  tensor(18.1700, device='cuda:3')
score : tensor(0.1599, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(615.3639, device='cuda:3')
part1 is  tensor(10.6629, device='cuda:3')
score : tensor(0.0848, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(594.4902, device='cuda:3')
part1 is  tensor(18.7024, device='cuda:3')
score : tensor(0.1652, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(690.5289, device='cuda:3')
part1 is  tensor(-0.0517, device='cuda:3')
score : tensor(-0.0223, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.7449, device='cuda:3')
part1 is  tensor(46.2177, device='cuda:3')
score : tensor(0.4404, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(626.3815, device='cuda:3')
part1 is  tensor(10.8634, device='cuda:3')
score : tensor(0.0869, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(610.8533, device='cuda:3')
part1 is  tensor(-3.3533, device='cuda:3')
score : tensor(-0.0553, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(656.8675, device='cuda:3')
part1 is  tensor(10.4509, device='cuda:3')
score : tensor(0.0827, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(657.6639, device='cuda:3')
part1 is  tensor(81.2606, device='cuda:3')
score : tensor(0.7908, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(632.8148, device='cuda:3')
part1 is  tensor(64.7271, device='cuda:3')
score : tensor(0.6255, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(679.9476, device='cuda:3')
part1 is  tensor(28.7123, device='cuda:3')
score : tensor(0.2653, device='cuda:3')
accept
len accept list 30
len all weights is 30
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 90.30% 

Test Accuracy: 89.11% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
 benign loss is  0.29527193307876587
distance 1 is tensor(86.9336, device='cuda:3')
benign distance is  tensor(86.9336, device='cuda:3')
norm1 res is  tensor(0.0980, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3484859764575958
distance 1 is tensor(121.8113, device='cuda:3')
benign distance is  tensor(121.8113, device='cuda:3')
norm1 res is  tensor(0.1330, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2787793278694153
distance 1 is tensor(112.9106, device='cuda:3')
benign distance is  tensor(112.9106, device='cuda:3')
norm1 res is  tensor(0.1206, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.32076936960220337
distance 1 is tensor(115.3047, device='cuda:3')
benign distance is  tensor(115.3047, device='cuda:3')
norm1 res is  tensor(0.1251, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4685239791870117
distance 1 is tensor(128.5439, device='cuda:3')
benign distance is  tensor(128.5439, device='cuda:3')
norm1 res is  tensor(0.1396, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.6746020317077637
distance 1 is tensor(132.4299, device='cuda:3')
benign distance is  tensor(132.4299, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.18353962898254395
distance 1 is tensor(87.8329, device='cuda:3')
benign distance is  tensor(87.8329, device='cuda:3')
norm1 res is  tensor(0.0938, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.15029478073120117
distance 1 is tensor(100.7145, device='cuda:3')
benign distance is  tensor(100.7145, device='cuda:3')
norm1 res is  tensor(0.1118, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.28988295793533325
distance 1 is tensor(125.0064, device='cuda:3')
benign distance is  tensor(125.0064, device='cuda:3')
norm1 res is  tensor(0.1371, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.5087743997573853
distance 1 is tensor(135.2072, device='cuda:3')
benign distance is  tensor(135.2072, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.4238005578517914
distance 1 is tensor(120.5962, device='cuda:3')
benign distance is  tensor(120.5962, device='cuda:3')
norm1 res is  tensor(0.1288, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.38876572251319885
distance 1 is tensor(135.0586, device='cuda:3')
benign distance is  tensor(135.0586, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.4112481474876404
distance 1 is tensor(122.0197, device='cuda:3')
benign distance is  tensor(122.0197, device='cuda:3')
norm1 res is  tensor(0.1338, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.1320546716451645
distance 1 is tensor(126.2578, device='cuda:3')
benign distance is  tensor(126.2578, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.32398995757102966
distance 1 is tensor(124.6744, device='cuda:3')
benign distance is  tensor(124.6744, device='cuda:3')
norm1 res is  tensor(0.1351, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3703852593898773
distance 1 is tensor(137.7783, device='cuda:3')
benign distance is  tensor(137.7783, device='cuda:3')
norm1 res is  tensor(0.1479, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.15417654812335968
distance 1 is tensor(134.5721, device='cuda:3')
benign distance is  tensor(134.5721, device='cuda:3')
norm1 res is  tensor(0.1464, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.4847868084907532
distance 1 is tensor(139.9875, device='cuda:3')
benign distance is  tensor(139.9875, device='cuda:3')
norm1 res is  tensor(0.1524, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.10011269152164459
distance 1 is tensor(127.7136, device='cuda:3')
benign distance is  tensor(127.7136, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.14456304907798767
distance 1 is tensor(121.7962, device='cuda:3')
benign distance is  tensor(121.7962, device='cuda:3')
norm1 res is  tensor(0.1373, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.05456899479031563
distance 1 is tensor(120.8977, device='cuda:3')
benign distance is  tensor(120.8977, device='cuda:3')
norm1 res is  tensor(0.1298, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.7685869932174683
distance 1 is tensor(134.6432, device='cuda:3')
benign distance is  tensor(134.6432, device='cuda:3')
norm1 res is  tensor(0.1441, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.16808739304542542
distance 1 is tensor(132.5944, device='cuda:3')
benign distance is  tensor(132.5944, device='cuda:3')
norm1 res is  tensor(0.1438, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.40014737844467163
distance 1 is tensor(124.7240, device='cuda:3')
benign distance is  tensor(124.7240, device='cuda:3')
norm1 res is  tensor(0.1311, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.17110967636108398
distance 1 is tensor(142.9611, device='cuda:3')
benign distance is  tensor(142.9611, device='cuda:3')
norm1 res is  tensor(0.1545, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.49010738730430603
distance 1 is tensor(123.4058, device='cuda:3')
benign distance is  tensor(123.4058, device='cuda:3')
norm1 res is  tensor(0.1296, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.14479650557041168
distance 1 is tensor(136.1328, device='cuda:3')
benign distance is  tensor(136.1328, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.5981725454330444
distance 1 is tensor(140.5005, device='cuda:3')
benign distance is  tensor(140.5005, device='cuda:3')
norm1 res is  tensor(0.1475, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.821574866771698
distance 1 is tensor(127.6382, device='cuda:3')
benign distance is  tensor(127.6382, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.058661770075559616
distance 1 is tensor(129.9166, device='cuda:3')
benign distance is  tensor(129.9166, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.5980494618415833
distance 1 is tensor(118.7398, device='cuda:3')
benign distance is  tensor(118.7398, device='cuda:3')
norm1 res is  tensor(0.1280, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.15962788462638855
distance 1 is tensor(117.4930, device='cuda:3')
benign distance is  tensor(117.4930, device='cuda:3')
norm1 res is  tensor(0.1322, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.0692201778292656
distance 1 is tensor(131.3059, device='cuda:3')
benign distance is  tensor(131.3059, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.3377968966960907
distance 1 is tensor(142.6054, device='cuda:3')
benign distance is  tensor(142.6054, device='cuda:3')
norm1 res is  tensor(0.1524, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.03291013091802597
distance 1 is tensor(122.5798, device='cuda:3')
benign distance is  tensor(122.5798, device='cuda:3')
norm1 res is  tensor(0.1336, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.07012353092432022
distance 1 is tensor(126.7405, device='cuda:3')
benign distance is  tensor(126.7405, device='cuda:3')
norm1 res is  tensor(0.1387, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.18630467355251312
distance 1 is tensor(134.0404, device='cuda:3')
benign distance is  tensor(134.0404, device='cuda:3')
norm1 res is  tensor(0.1452, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.570137619972229
distance 1 is tensor(135.8712, device='cuda:3')
benign distance is  tensor(135.8712, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.5844405889511108
distance 1 is tensor(133.1734, device='cuda:3')
benign distance is  tensor(133.1734, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.044627077877521515
distance 1 is tensor(136.2839, device='cuda:3')
benign distance is  tensor(136.2839, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(189.8704, device='cuda:3')
compute distance is  tensor(189.8704, device='cuda:3')
compute norm is  tensor(47.9936, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(187.7957, device='cuda:3')
compute distance is  tensor(187.7957, device='cuda:3')
compute norm is  tensor(47.9116, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(196.9502, device='cuda:3')
compute distance is  tensor(196.9502, device='cuda:3')
compute norm is  tensor(48.3667, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(186.6287, device='cuda:3')
compute distance is  tensor(186.6287, device='cuda:3')
compute norm is  tensor(47.9502, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(187.3539, device='cuda:3')
compute distance is  tensor(187.3539, device='cuda:3')
compute norm is  tensor(47.8439, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(189.8094, device='cuda:3')
compute distance is  tensor(189.8094, device='cuda:3')
compute norm is  tensor(47.9724, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(184.2278, device='cuda:3')
compute distance is  tensor(184.2278, device='cuda:3')
compute norm is  tensor(47.8162, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(188.0132, device='cuda:3')
compute distance is  tensor(188.0132, device='cuda:3')
compute norm is  tensor(48.1016, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(200.2118, device='cuda:3')
compute distance is  tensor(200.2118, device='cuda:3')
compute norm is  tensor(48.2923, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(189.9828, device='cuda:3')
compute distance is  tensor(189.9828, device='cuda:3')
compute norm is  tensor(48.2092, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(185.2773, device='cuda:3')
compute distance is  tensor(185.2773, device='cuda:3')
compute norm is  tensor(47.9660, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(181.6396, device='cuda:3')
compute distance is  tensor(181.6396, device='cuda:3')
compute norm is  tensor(47.7782, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(200.2118, device='cuda:3')
distance 1 is tensor(1869442.3750, device='cuda:3')
________________________________
test distance is  tensor(1869442.3750, device='cuda:3')
test similarity is  tensor(0.1009, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.762860988359586e+18
test entropy is  0.0
________________________________
cal ratio is  0.010141796953654346
distance 1 is tensor(18959.5098, device='cuda:3')
cal_distance is  tensor(18959.5098, device='cuda:3')
cal ratio is  0.10070647837269323
distance 1 is tensor(1909.3517, device='cuda:3')
cal_distance is  tensor(1909.3517, device='cuda:3')
cal ratio is  0.3173423214292842
distance 1 is tensor(605.9227, device='cuda:3')
cal_distance is  tensor(605.9227, device='cuda:3')
cal ratio is  0.5633292804721298
distance 1 is tensor(341.3370, device='cuda:3')
cal_distance is  tensor(341.3370, device='cuda:3')
cal ratio is  0.7505493553154786
distance 1 is tensor(256.1919, device='cuda:3')
cal_distance is  tensor(256.1919, device='cuda:3')
cal ratio is  0.8663397204049423
distance 1 is tensor(221.9501, device='cuda:3')
cal_distance is  tensor(221.9501, device='cuda:3')
cal ratio is  0.9307718421290245
distance 1 is tensor(206.5854, device='cuda:3')
cal_distance is  tensor(206.5854, device='cuda:3')
cal ratio is  0.9647641045566655
distance 1 is tensor(199.3064, device='cuda:3')
cal_distance is  tensor(199.3064, device='cuda:3')
distance 1 is tensor(199.3064, device='cuda:3')
________________________________
test distance is  tensor(199.3064, device='cuda:3')
test similarity is  tensor(0.9085, device='cuda:3')
test acc is  0.451733333489675
test loss is 480.6224984370315
test entropy is  2.4626966058991467e-05
________________________________
distance 1 is tensor(199.3064, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.210599270454347e-05
avg test loss is  480.8684935742604
avg accuracy is  0.45075000015634165
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9085, device='cuda:3')
compute_distance is  tensor(199.3064, device='cuda:3')
compute_norm is  tensor(51.4293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(176.9958, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0688407022053246
avg test loss is  1.6249120427347195
avg accuracy is  0.7994500001563255
solo acc is  0.2549666668230051
compute similarity  is  tensor(0.9122, device='cuda:3')
compute_distance is  tensor(176.9958, device='cuda:3')
compute_norm is  tensor(51.7980, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance 1 is tensor(177.9487, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.63839154711156
avg test loss is  2.4722642181778767
avg accuracy is  0.7453666668229948
solo acc is  0.11263333348966528
compute similarity  is  tensor(0.9119, device='cuda:3')
compute_distance is  tensor(177.9487, device='cuda:3')
compute_norm is  tensor(51.6866, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(177.2442, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.949116833555673
avg test loss is  1.4463639676189626
avg accuracy is  0.808000000156325
solo acc is  0.28410000015633924
compute similarity  is  tensor(0.9125, device='cuda:3')
compute_distance is  tensor(177.2442, device='cuda:3')
compute_norm is  tensor(51.3002, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(177.5418, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8835914622364777
avg test loss is  1.5253804238366167
avg accuracy is  0.8049166668229918
solo acc is  0.2411666668230046
compute similarity  is  tensor(0.9125, device='cuda:3')
compute_distance is  tensor(177.5418, device='cuda:3')
compute_norm is  tensor(51.0380, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(177.7597, device='cuda:3')
________________________________
test distance is  tensor(177.7597, device='cuda:3')
test similarity is  tensor(0.9126, device='cuda:3')
test acc is  0.8087333334896583
test loss is 1.513149367593753
test entropy is  0.8874097625329804
________________________________
distance 1 is tensor(177.7597, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.888220162851724
avg test loss is  1.5088409024006777
avg accuracy is  0.8084833334896584
solo acc is  0.23025000015633762
compute similarity  is  tensor(0.9126, device='cuda:3')
compute_distance is  tensor(177.7597, device='cuda:3')
compute_norm is  tensor(50.7707, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(177.9933, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8775877007670494
avg test loss is  1.4846681890202993
avg accuracy is  0.8116833334896583
solo acc is  0.23443333348967116
compute similarity  is  tensor(0.9126, device='cuda:3')
compute_distance is  tensor(177.9933, device='cuda:3')
compute_norm is  tensor(50.5078, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(178.2757, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8741860563185677
avg test loss is  1.470016655764346
avg accuracy is  0.8130000001563248
solo acc is  0.23235000015633778
compute similarity  is  tensor(0.9126, device='cuda:3')
compute_distance is  tensor(178.2757, device='cuda:3')
compute_norm is  tensor(50.2495, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(178.5955, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8701683964683558
avg test loss is  1.4570633474189336
avg accuracy is  0.817433333489658
solo acc is  0.22790000015633752
compute similarity  is  tensor(0.9126, device='cuda:3')
compute_distance is  tensor(178.5955, device='cuda:3')
compute_norm is  tensor(49.9955, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(178.9470, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8683112704042178
avg test loss is  1.4410159822974378
avg accuracy is  0.8194000001563245
solo acc is  0.22760000015633755
compute similarity  is  tensor(0.9126, device='cuda:3')
compute_distance is  tensor(178.9470, device='cuda:3')
compute_norm is  tensor(49.7442, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(179.3769, device='cuda:3')
________________________________
test distance is  tensor(179.3769, device='cuda:3')
test similarity is  tensor(0.9125, device='cuda:3')
test acc is  0.8221333334896578
test loss is 1.4342413200244213
test entropy is  0.8625872292117015
________________________________
distance 1 is tensor(179.3769, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8631860948701912
avg test loss is  1.4357704569790155
avg accuracy is  0.8224000001563244
solo acc is  0.22300000015633742
compute similarity  is  tensor(0.9125, device='cuda:3')
compute_distance is  tensor(179.3769, device='cuda:3')
compute_norm is  tensor(49.4971, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(179.7904, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.858836357972261
avg test loss is  1.4161978253423533
avg accuracy is  0.8244500001563243
solo acc is  0.22583333348967083
compute similarity  is  tensor(0.9125, device='cuda:3')
compute_distance is  tensor(179.7904, device='cuda:3')
compute_norm is  tensor(49.2519, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(180.2818, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8643489901317971
avg test loss is  1.4260373260420778
avg accuracy is  0.8254166668229909
solo acc is  0.21048333348967016
compute similarity  is  tensor(0.9124, device='cuda:3')
compute_distance is  tensor(180.2818, device='cuda:3')
compute_norm is  tensor(49.0109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(180.8078, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8456303090937356
avg test loss is  1.3928997043861764
avg accuracy is  0.8287666668229907
solo acc is  0.231783333489671
compute similarity  is  tensor(0.9124, device='cuda:3')
compute_distance is  tensor(180.8078, device='cuda:3')
compute_norm is  tensor(48.7721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(181.3754, device='cuda:3')
exit early
distance 1 is tensor(181.3754, device='cuda:3')
________________________________
test distance is  tensor(181.3754, device='cuda:3')
test similarity is  tensor(0.9123, device='cuda:3')
test acc is  0.8302833334896573
test loss is 1.3951468583363205
test entropy is  0.8514181427609946
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2145154476165771
mal norm is  tensor(929.6336, device='cuda:3')
distance 1 is tensor(181.3754, device='cuda:3')
mal distance is  tensor(181.3754, device='cuda:3')
len current grad  20
len all grad 20
grad,shape is torch.Size([215370])
index is  [0, 1, 2, 3, 4, 5, 6, 7, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
global_param_square norm is    tensor(15.4257, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(383.4682, device='cuda:3')
part1 is  tensor(3.3390, device='cuda:3')
score : tensor(0.0182, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(521.6175, device='cuda:3')
part1 is  tensor(-4.0603, device='cuda:3')
score : tensor(-0.0558, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(473.6652, device='cuda:3')
part1 is  tensor(12.6294, device='cuda:3')
score : tensor(0.1111, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(487.4340, device='cuda:3')
part1 is  tensor(-5.8681, device='cuda:3')
score : tensor(-0.0739, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(552.9250, device='cuda:3')
part1 is  tensor(-29.1913, device='cuda:3')
score : tensor(-0.3071, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(571.4242, device='cuda:3')
part1 is  tensor(1.1876, device='cuda:3')
score : tensor(-0.0033, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(367.3459, device='cuda:3')
part1 is  tensor(33.2059, device='cuda:3')
score : tensor(0.3168, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(439.6571, device='cuda:3')
part1 is  tensor(1.8449, device='cuda:3')
score : tensor(0.0032, device='cuda:3')
accept
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
grad,shape is torch.Size([215370])
user_param_square norm is    tensor(929.6336, device='cuda:3')
part1 is  tensor(-20.9440, device='cuda:3')
score : tensor(-0.2247, device='cuda:3')
len accept list 4
len all weights is 4
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 90.18% 

Test Accuracy: 89.05% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
 benign loss is  0.40931883454322815
distance 1 is tensor(87.3949, device='cuda:3')
benign distance is  tensor(87.3949, device='cuda:3')
norm1 res is  tensor(0.0973, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4704618453979492
distance 1 is tensor(131.5516, device='cuda:3')
benign distance is  tensor(131.5516, device='cuda:3')
norm1 res is  tensor(0.1439, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.30845117568969727
distance 1 is tensor(98.8687, device='cuda:3')
benign distance is  tensor(98.8687, device='cuda:3')
norm1 res is  tensor(0.1070, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.3262292444705963
distance 1 is tensor(119.7082, device='cuda:3')
benign distance is  tensor(119.7082, device='cuda:3')
norm1 res is  tensor(0.1297, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.2955918610095978
distance 1 is tensor(145.7401, device='cuda:3')
benign distance is  tensor(145.7401, device='cuda:3')
norm1 res is  tensor(0.1561, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7570589184761047
distance 1 is tensor(126.6548, device='cuda:3')
benign distance is  tensor(126.6548, device='cuda:3')
norm1 res is  tensor(0.1377, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6547366976737976
distance 1 is tensor(110.4564, device='cuda:3')
benign distance is  tensor(110.4564, device='cuda:3')
norm1 res is  tensor(0.1196, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5198642611503601
distance 1 is tensor(103.5333, device='cuda:3')
benign distance is  tensor(103.5333, device='cuda:3')
norm1 res is  tensor(0.1163, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
distance 1 is tensor(146.3991, device='cuda:3')
compute distance is  tensor(146.3991, device='cuda:3')
compute norm is  tensor(47.4506, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(153.7465, device='cuda:3')
compute distance is  tensor(153.7465, device='cuda:3')
compute norm is  tensor(47.6093, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(147.6101, device='cuda:3')
compute distance is  tensor(147.6101, device='cuda:3')
compute norm is  tensor(47.6980, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.0385, device='cuda:3')
compute distance is  tensor(149.0385, device='cuda:3')
compute norm is  tensor(47.4662, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.6854, device='cuda:3')
compute distance is  tensor(149.6854, device='cuda:3')
compute norm is  tensor(47.5678, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(152.6826, device='cuda:3')
compute distance is  tensor(152.6826, device='cuda:3')
compute norm is  tensor(47.6609, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.4439, device='cuda:3')
compute distance is  tensor(149.4439, device='cuda:3')
compute norm is  tensor(47.5452, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(159.0248, device='cuda:3')
compute distance is  tensor(159.0248, device='cuda:3')
compute norm is  tensor(47.8219, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(155.3411, device='cuda:3')
compute distance is  tensor(155.3411, device='cuda:3')
compute norm is  tensor(47.6596, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(143.7024, device='cuda:3')
compute distance is  tensor(143.7024, device='cuda:3')
compute norm is  tensor(47.5351, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(149.1794, device='cuda:3')
compute distance is  tensor(149.1794, device='cuda:3')
compute norm is  tensor(47.6761, device='cuda:3', dtype=torch.float64)
distance 1 is tensor(154.0659, device='cuda:3')
compute distance is  tensor(154.0659, device='cuda:3')
compute norm is  tensor(47.6810, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(159.0248, device='cuda:3')
distance 1 is tensor(1869440.1250, device='cuda:3')
________________________________
test distance is  tensor(1869440.1250, device='cuda:3')
test similarity is  tensor(0.0951, device='cuda:3')
test acc is  0.10000000015633198
test loss is 6.764620587338786e+18
test entropy is  0.0
________________________________
cal ratio is  0.00903863320153789
distance 1 is tensor(16897.1914, device='cuda:3')
cal_distance is  tensor(16897.1914, device='cuda:3')
cal ratio is  0.0950717052092348
distance 1 is tensor(1606.4509, device='cuda:3')
cal_distance is  tensor(1606.4509, device='cuda:3')
cal ratio is  0.3083364104260228
distance 1 is tensor(495.3319, device='cuda:3')
cal_distance is  tensor(495.3319, device='cuda:3')
cal ratio is  0.5552779002619135
distance 1 is tensor(275.0499, device='cuda:3')
cal_distance is  tensor(275.0499, device='cuda:3')
cal ratio is  0.7451656434708307
distance 1 is tensor(204.9594, device='cuda:3')
cal_distance is  tensor(204.9594, device='cuda:3')
cal ratio is  0.8632261727279116
distance 1 is tensor(176.9273, device='cuda:3')
cal_distance is  tensor(176.9273, device='cuda:3')
cal ratio is  0.929097236127646
distance 1 is tensor(164.3831, device='cuda:3')
cal_distance is  tensor(164.3831, device='cuda:3')
cal ratio is  0.9638954047218883
distance 1 is tensor(158.4484, device='cuda:3')
cal_distance is  tensor(158.4484, device='cuda:3')
distance 1 is tensor(158.4484, device='cuda:3')
________________________________
test distance is  tensor(158.4484, device='cuda:3')
test similarity is  tensor(0.9392, device='cuda:3')
test acc is  0.6883833334896649
test loss is 236.1901692144398
test entropy is  0.000829381769719628
________________________________
distance 1 is tensor(158.4484, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0007584977808236608
avg test loss is  236.33394199851224
avg accuracy is  0.6862000001563314
solo acc is  0.10260000015633197
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(158.4484, device='cuda:3')
compute_norm is  tensor(50.6325, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance 1 is tensor(142.4152, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9095352713995651
avg test loss is  1.406400703036709
avg accuracy is  0.8456333334896567
solo acc is  0.30736666682300634
compute similarity  is  tensor(0.9414, device='cuda:3')
compute_distance is  tensor(142.4152, device='cuda:3')
compute_norm is  tensor(50.1139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.2318, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8715133759131564
avg test loss is  1.4800801692741004
avg accuracy is  0.8442666668229901
solo acc is  0.2502500001563383
compute similarity  is  tensor(0.9412, device='cuda:3')
compute_distance is  tensor(143.2318, device='cuda:3')
compute_norm is  tensor(49.8430, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance 1 is tensor(143.9057, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8692282484665609
avg test loss is  1.442941440193892
avg accuracy is  0.8476333334896566
solo acc is  0.2502333334896717
compute similarity  is  tensor(0.9410, device='cuda:3')
compute_distance is  tensor(143.9057, device='cuda:3')
compute_norm is  tensor(49.5737, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
