
Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 40

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 30.83% 

Test Accuracy: 36.87% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.012352808378636837
 benign empirical indicaor res is  0.012352808378636837
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 69.27% 

Test Accuracy: 68.73% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.013809090480208397
 benign empirical indicaor res is  0.013809090480208397
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 74.41% 

Test Accuracy: 76.74% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.011244792491197586
 benign empirical indicaor res is  0.011244792491197586
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.87% 

Test Accuracy: 90.44% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.007068968843668699
 benign empirical indicaor res is  0.007068968843668699
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.74% 

Test Accuracy: 90.37% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0032044195104390383
 benign empirical indicaor res is  0.0032044195104390383
the length of epoch_weights is  2
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 93.82% 

Test Accuracy: 94.15% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.009793627075850964
 benign empirical indicaor res is  0.009793627075850964
the length of epoch_weights is  0
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 91.29% 

Test Accuracy: 91.99% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.008470610715448856
 benign empirical indicaor res is  0.008470610715448856
the length of epoch_weights is  2
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 95.19% 

Test Accuracy: 95.22% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.002862149616703391
 benign empirical indicaor res is  0.002862149616703391
the length of epoch_weights is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 94.78% 

Test Accuracy: 95.35% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0031325744930654764
 benign empirical indicaor res is  0.0031325744930654764
the length of epoch_weights is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 95.76% 

Test Accuracy: 95.67% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0026477009523659945
 benign empirical indicaor res is  0.0026477009523659945
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 94.05% 

Test Accuracy: 94.73% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0050995200872421265
 benign empirical indicaor res is  0.0050995200872421265
the length of epoch_weights is  3
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 96.56% 

Test Accuracy: 96.52% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0013558831997215748
 benign empirical indicaor res is  0.0013558831997215748
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 95.94% 

Test Accuracy: 96.22% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.00456353509798646
 benign empirical indicaor res is  0.00456353509798646
the length of epoch_weights is  1
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 96.58% 

Test Accuracy: 96.61% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.003733685938641429
 benign empirical indicaor res is  0.003733685938641429
the length of epoch_weights is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 96.88% 

Test Accuracy: 97.02% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.00038048624992370605
 benign empirical indicaor res is  0.00038048624992370605
the length of epoch_weights is  2
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 96.99% 

Test Accuracy: 97.02% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.001300919451750815
 benign empirical indicaor res is  0.001300919451750815
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 96.89% 

Test Accuracy: 97.11% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0015981701435521245
 benign empirical indicaor res is  0.0015981701435521245
the length of epoch_weights is  2
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 97.16% 

Test Accuracy: 97.36% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0015890162903815508
 benign empirical indicaor res is  0.0015890162903815508
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 97.08% 

Test Accuracy: 97.32% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.001857641851529479
 benign empirical indicaor res is  0.001857641851529479
the length of epoch_weights is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 97.38% 

Test Accuracy: 97.33% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.000961766520049423
 benign empirical indicaor res is  0.000961766520049423
the length of epoch_weights is  1
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 97.43% 

Test Accuracy: 97.44% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0012527111684903502
 benign empirical indicaor res is  0.0012527111684903502
the length of epoch_weights is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 97.48% 

Test Accuracy: 97.35% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0015068837674334645
 benign empirical indicaor res is  0.0015068837674334645
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 97.32% 

Test Accuracy: 97.32% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.001945546013303101
 benign empirical indicaor res is  0.001945546013303101
the length of epoch_weights is  3
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 97.51% 

Test Accuracy: 97.59% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0008663579355925322
 benign empirical indicaor res is  0.0008663579355925322
the length of epoch_weights is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 97.56% 

Test Accuracy: 97.53% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0010199557291343808
 benign empirical indicaor res is  0.0010199557291343808
the length of epoch_weights is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 97.56% 

Test Accuracy: 97.56% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.001549835316836834
 benign empirical indicaor res is  0.001549835316836834
the length of epoch_weights is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 97.65% 

Test Accuracy: 97.67% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0011282037012279034
 benign empirical indicaor res is  0.0011282037012279034
the length of epoch_weights is  2
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 97.81% 

Test Accuracy: 97.79% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0010496941395103931
 benign empirical indicaor res is  0.0010496941395103931
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 97.69% 

Test Accuracy: 97.68% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0011459694942459464
 benign empirical indicaor res is  0.0011459694942459464
the length of epoch_weights is  3
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 97.81% 

Test Accuracy: 97.82% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
poisoned accuracy threshold is  0.8282000001570008
distance ratio is <class 'float'>
len of model dicts is  10
compute distance is  tensor(29.2299, device='cuda:3')
compute distance is  tensor(26.4756, device='cuda:3')
compute distance is  tensor(57.0398, device='cuda:3')
compute distance is  tensor(49.7643, device='cuda:3')
compute distance is  tensor(31.1176, device='cuda:3')
compute distance is  tensor(22.5072, device='cuda:3')
compute distance is  tensor(51.8256, device='cuda:3')
compute distance is  tensor(31.9833, device='cuda:3')
compute distance is  tensor(90.0963, device='cuda:3')
compute distance is  tensor(58.4581, device='cuda:3')
calculated distance threshold is  tensor(89.4204, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.4611000001563417
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.31693333348967323
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.38315000015634093
====================
====================
iteration is  1
round is  0
accuracy is  0.3575000001563405
====================
====================
iteration is  1
round is  1
accuracy is  0.32945000015634013
====================
________________________________
test distance is  tensor(4283.3452, device='cuda:3')
test acc is  0.31693333348967323
test entropy is  0.3307771400284411
________________________________
diff is  tensor(43.2482, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4355, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.1307, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4784, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.5094, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0567, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3278, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4193.9248, device='cuda:3')
sum is tensor(0.1594, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5948, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0733, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1300, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4578, device='cuda:3', dtype=torch.float64)
sum is tensor(66.7060, device='cuda:3', dtype=torch.float64)
sum is tensor(640.8367, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.3461, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0245, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.5094, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.2482, device='cuda:3')
discard
cal diff is tensor(0.4355, device='cuda:3')
discard
cal diff is tensor(574.1307, device='cuda:3')
discard
cal diff is tensor(0.4784, device='cuda:3')
discard
cal diff is tensor(3642.5093, device='cuda:3')
discard
cal diff is tensor(2.0567, device='cuda:3')
discard
cal diff is tensor(20.3278, device='cuda:3')
discard
cal diff is tensor(0.1594, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9775166668229855
test entropy is  0.11756307524301286
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11756307524301286
avg test loss is  0.07549736420410488
avg accuracy is  0.9775166668229855
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.32353938135828797
avg test loss is  4.706765671020378
avg accuracy is  0.3532333334896738
compute_distance is  tensor(107.3490, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(107.3490, device='cuda:3')
test acc is  0.3532333334896738
test entropy is  0.32353938135828797
________________________________
diff is  tensor(0.7526, device='cuda:3')
diff is  tensor(0.0064, device='cuda:3')
diff is  tensor(15.2052, device='cuda:3')
diff is  tensor(0.0163, device='cuda:3')
diff is  tensor(90.8788, device='cuda:3')
diff is  tensor(0.0383, device='cuda:3')
diff is  tensor(0.4404, device='cuda:3')
diff is  tensor(0.0032, device='cuda:3')
threshold is  tensor(17.9286, device='cuda:3')
sum is tensor(0.0032, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0259, device='cuda:3')
sum is tensor(0.0642, device='cuda:3')
sum is tensor(0.5045, device='cuda:3')
sum is tensor(1.2571, device='cuda:3')
sum is tensor(16.4623, device='cuda:3')
sum is tensor(107.3411, device='cuda:3')
ratio is tensor(0.9839, device='cuda:3')
threshold is tensor(90.8788, device='cuda:3')
cal diff is tensor(0.7526, device='cuda:3')
discard
cal diff is tensor(0.0064, device='cuda:3')
discard
cal diff is tensor(15.2052, device='cuda:3')
discard
cal diff is tensor(0.0163, device='cuda:3')
discard
cal diff is tensor(90.8788, device='cuda:3')
clipping
cal diff is tensor(0.0383, device='cuda:3')
discard
cal diff is tensor(0.4404, device='cuda:3')
discard
cal diff is tensor(0.0032, device='cuda:3')
discard
________________________________
test distance is  tensor(89.4227, device='cuda:3')
test acc is  0.5592500001563411
test entropy is  0.43525765032402236
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(89.4126, device='cuda:3')
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0023, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.8788, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(89.4126, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(78.5846, device='cuda:3')
test acc is  0.683633333489665
test entropy is  0.43426579014578864
________________________________
new distance ratio is 0.99
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 96.38% 

Test Accuracy: 95.89% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0006568289827555418
attack res is False
len of model dicts is  10
compute distance is  tensor(24.7716, device='cuda:3')
compute distance is  tensor(29.3774, device='cuda:3')
compute distance is  tensor(26.9161, device='cuda:3')
compute distance is  tensor(49.4010, device='cuda:3')
compute distance is  tensor(37.5794, device='cuda:3')
compute distance is  tensor(26.4643, device='cuda:3')
compute distance is  tensor(44.9906, device='cuda:3')
compute distance is  tensor(25.8398, device='cuda:3')
compute distance is  tensor(63.1086, device='cuda:3')
compute distance is  tensor(26.4551, device='cuda:3')
calculated distance threshold is  tensor(59.2749, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.2771333334896723
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4742333334896752
====================
====================
iteration is  0
round is  2
accuracy is  0.40101666682300774
====================
====================
iteration is  1
round is  0
accuracy is  0.3407000001563403
====================
====================
iteration is  1
round is  1
accuracy is  0.2308000001563376
====================
succ_min + 1
________________________________
test distance is  tensor(4281.8457, device='cuda:3')
test acc is  0.2308000001563376
test entropy is  0.3049940451471282
________________________________
diff is  tensor(44.7948, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2929, device='cuda:3', dtype=torch.float64)
diff is  tensor(570.9380, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5041, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.7832, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0289, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3142, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4222.5708, device='cuda:3')
sum is tensor(0.1901, device='cuda:3', dtype=torch.float64)
sum is tensor(0.4831, device='cuda:3', dtype=torch.float64)
sum is tensor(0.9871, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0160, device='cuda:3', dtype=torch.float64)
sum is tensor(23.3302, device='cuda:3', dtype=torch.float64)
sum is tensor(68.1250, device='cuda:3', dtype=torch.float64)
sum is tensor(639.0630, device='cuda:3', dtype=torch.float64)
sum is tensor(4281.8462, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0163, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.7832, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.7948, device='cuda:3')
discard
cal diff is tensor(0.2929, device='cuda:3')
discard
cal diff is tensor(570.9380, device='cuda:3')
discard
cal diff is tensor(0.5041, device='cuda:3')
discard
cal diff is tensor(3642.7832, device='cuda:3')
clipping
cal diff is tensor(2.0289, device='cuda:3')
discard
cal diff is tensor(20.3142, device='cuda:3')
discard
cal diff is tensor(0.1901, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2856, device='cuda:3')
test acc is  0.9569833334896528
test entropy is  0.14549352585681594
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(59.2754, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0107, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
sum is tensor(59.2856, device='cuda:3')
ratio is tensor(1.0000, device='cuda:3', dtype=torch.float64)
threshold is tensor(59.2754, device='cuda:3', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
discard
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(59.2754, device='cuda:3')
discard
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9568166668229862
test entropy is  0.14536975571182745
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14536975571182745
avg test loss is  0.11948447822253587
avg accuracy is  0.9568166668229862
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.32047410372859125
avg test loss is  5.641285952728694
avg accuracy is  0.23673333348967113
compute_distance is  tensor(108.1639, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(108.1639, device='cuda:3')
test acc is  0.23673333348967113
test entropy is  0.32047410372859125
________________________________
diff is  tensor(0.7875, device='cuda:3')
diff is  tensor(0.0065, device='cuda:3')
diff is  tensor(15.9510, device='cuda:3')
diff is  tensor(0.0176, device='cuda:3')
diff is  tensor(90.8822, device='cuda:3')
diff is  tensor(0.0402, device='cuda:3')
diff is  tensor(0.4660, device='cuda:3')
diff is  tensor(0.0036, device='cuda:3')
threshold is  tensor(48.8890, device='cuda:3')
sum is tensor(0.0036, device='cuda:3')
sum is tensor(0.0101, device='cuda:3')
sum is tensor(0.0278, device='cuda:3')
sum is tensor(0.0680, device='cuda:3')
sum is tensor(0.5340, device='cuda:3')
sum is tensor(1.3216, device='cuda:3')
sum is tensor(17.2726, device='cuda:3')
sum is tensor(108.1548, device='cuda:3')
ratio is tensor(0.6521, device='cuda:3')
threshold is tensor(90.8822, device='cuda:3')
cal diff is tensor(0.7875, device='cuda:3')
discard
cal diff is tensor(0.0065, device='cuda:3')
discard
cal diff is tensor(15.9510, device='cuda:3')
discard
cal diff is tensor(0.0176, device='cuda:3')
discard
cal diff is tensor(90.8822, device='cuda:3')
clipping
cal diff is tensor(0.0402, device='cuda:3')
discard
cal diff is tensor(0.4660, device='cuda:3')
discard
cal diff is tensor(0.0036, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2754, device='cuda:3')
test acc is  0.8924666668229884
test entropy is  0.3563109803428528
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(59.2659, device='cuda:3')
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0005, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
ratio is tensor(0.8745, device='cuda:3')
threshold is tensor(0.0008, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
clipping
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(59.2659, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(51.8384, device='cuda:3')
test acc is  0.9298500001563204
test entropy is  0.2929743852919099
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2929743852919099
avg test loss is  0.22596318148441916
avg accuracy is  0.9298500001563204
compute_distance is  tensor(51.8384, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.317598100203568
avg test loss is  5.864301047599646
avg accuracy is  0.2371000001563378
compute_distance is  tensor(134.7352, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(134.7352, device='cuda:3')
test acc is  0.2371000001563378
test entropy is  0.317598100203568
________________________________
diff is  tensor(0.7992, device='cuda:3')
diff is  tensor(0.0065, device='cuda:3')
diff is  tensor(13.9391, device='cuda:3')
diff is  tensor(0.0146, device='cuda:3')
diff is  tensor(119.6078, device='cuda:3')
diff is  tensor(0.0251, device='cuda:3')
diff is  tensor(0.3241, device='cuda:3')
diff is  tensor(0.0024, device='cuda:3')
threshold is  tensor(75.4603, device='cuda:3')
sum is tensor(0.0024, device='cuda:3')
sum is tensor(0.0089, device='cuda:3')
sum is tensor(0.0235, device='cuda:3')
sum is tensor(0.0485, device='cuda:3')
sum is tensor(0.3727, device='cuda:3')
sum is tensor(1.1718, device='cuda:3')
sum is tensor(15.1109, device='cuda:3')
sum is tensor(134.7188, device='cuda:3')
ratio is tensor(0.4954, device='cuda:3')
threshold is tensor(119.6078, device='cuda:3')
cal diff is tensor(0.7992, device='cuda:3')
discard
cal diff is tensor(0.0065, device='cuda:3')
discard
cal diff is tensor(13.9391, device='cuda:3')
discard
cal diff is tensor(0.0146, device='cuda:3')
discard
cal diff is tensor(119.6078, device='cuda:3')
clipping
cal diff is tensor(0.0251, device='cuda:3')
discard
cal diff is tensor(0.3241, device='cuda:3')
discard
cal diff is tensor(0.0024, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2700, device='cuda:3')
test acc is  0.9303833334896536
test entropy is  0.30239346586088384
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.30239346586088384
avg test loss is  0.22618857505066053
avg accuracy is  0.9303833334896536
compute_distance is  tensor(59.2700, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3171316093918103
avg test loss is  5.893912492276255
avg accuracy is  0.23630000015633779
compute_distance is  tensor(142.0734, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(142.0734, device='cuda:3')
test acc is  0.23630000015633779
test entropy is  0.3171316093918103
________________________________
diff is  tensor(0.8233, device='cuda:3')
diff is  tensor(0.0067, device='cuda:3')
diff is  tensor(14.0676, device='cuda:3')
diff is  tensor(0.0147, device='cuda:3')
diff is  tensor(126.8040, device='cuda:3')
diff is  tensor(0.0245, device='cuda:3')
diff is  tensor(0.3121, device='cuda:3')
diff is  tensor(0.0023, device='cuda:3')
threshold is  tensor(82.7985, device='cuda:3')
sum is tensor(0.0023, device='cuda:3')
sum is tensor(0.0090, device='cuda:3')
sum is tensor(0.0238, device='cuda:3')
sum is tensor(0.0483, device='cuda:3')
sum is tensor(0.3603, device='cuda:3')
sum is tensor(1.1836, device='cuda:3')
sum is tensor(15.2512, device='cuda:3')
sum is tensor(142.0552, device='cuda:3')
ratio is tensor(0.4673, device='cuda:3')
threshold is tensor(126.8040, device='cuda:3')
cal diff is tensor(0.8233, device='cuda:3')
discard
cal diff is tensor(0.0067, device='cuda:3')
discard
cal diff is tensor(14.0676, device='cuda:3')
discard
cal diff is tensor(0.0147, device='cuda:3')
discard
cal diff is tensor(126.8040, device='cuda:3')
clipping
cal diff is tensor(0.0245, device='cuda:3')
discard
cal diff is tensor(0.3121, device='cuda:3')
discard
cal diff is tensor(0.0023, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2692, device='cuda:3')
test acc is  0.94045000015632
test entropy is  0.28105643128694247
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.28105643128694247
avg test loss is  0.1990401224711779
avg accuracy is  0.94045000015632
compute_distance is  tensor(59.2692, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.31710472552062097
avg test loss is  5.893759215056007
avg accuracy is  0.2360333334896711
compute_distance is  tensor(143.1792, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(143.1792, device='cuda:3')
test acc is  0.2360333334896711
test entropy is  0.31710472552062097
________________________________
diff is  tensor(0.8299, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(14.3370, device='cuda:3')
diff is  tensor(0.0150, device='cuda:3')
diff is  tensor(127.6280, device='cuda:3')
diff is  tensor(0.0251, device='cuda:3')
diff is  tensor(0.3161, device='cuda:3')
diff is  tensor(0.0024, device='cuda:3')
threshold is  tensor(83.9043, device='cuda:3')
sum is tensor(0.0024, device='cuda:3')
sum is tensor(0.0092, device='cuda:3')
sum is tensor(0.0242, device='cuda:3')
sum is tensor(0.0493, device='cuda:3')
sum is tensor(0.3654, device='cuda:3')
sum is tensor(1.1953, device='cuda:3')
sum is tensor(15.5323, device='cuda:3')
sum is tensor(143.1603, device='cuda:3')
ratio is tensor(0.4643, device='cuda:3')
threshold is tensor(127.6280, device='cuda:3')
cal diff is tensor(0.8299, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(14.3370, device='cuda:3')
discard
cal diff is tensor(0.0150, device='cuda:3')
discard
cal diff is tensor(127.6280, device='cuda:3')
clipping
cal diff is tensor(0.0251, device='cuda:3')
discard
cal diff is tensor(0.3161, device='cuda:3')
discard
cal diff is tensor(0.0024, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2690, device='cuda:3')
test acc is  0.9431666668229864
test entropy is  0.2743767069728136
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2743767069728136
avg test loss is  0.1915438434700849
avg accuracy is  0.9431666668229864
compute_distance is  tensor(59.2690, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.31704915106804893
avg test loss is  5.895269820430894
avg accuracy is  0.23578333348967107
compute_distance is  tensor(143.4909, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(143.4909, device='cuda:3')
test acc is  0.23578333348967107
test entropy is  0.31704915106804893
________________________________
diff is  tensor(0.8306, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(14.4182, device='cuda:3')
diff is  tensor(0.0151, device='cuda:3')
diff is  tensor(127.8557, device='cuda:3')
diff is  tensor(0.0253, device='cuda:3')
diff is  tensor(0.3175, device='cuda:3')
diff is  tensor(0.0024, device='cuda:3')
threshold is  tensor(84.2160, device='cuda:3')
sum is tensor(0.0024, device='cuda:3')
sum is tensor(0.0092, device='cuda:3')
sum is tensor(0.0243, device='cuda:3')
sum is tensor(0.0496, device='cuda:3')
sum is tensor(0.3670, device='cuda:3')
sum is tensor(1.1976, device='cuda:3')
sum is tensor(15.6158, device='cuda:3')
sum is tensor(143.4716, device='cuda:3')
ratio is tensor(0.4635, device='cuda:3')
threshold is tensor(127.8557, device='cuda:3')
cal diff is tensor(0.8306, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(14.4182, device='cuda:3')
discard
cal diff is tensor(0.0151, device='cuda:3')
discard
cal diff is tensor(127.8557, device='cuda:3')
clipping
cal diff is tensor(0.0253, device='cuda:3')
discard
cal diff is tensor(0.3175, device='cuda:3')
discard
cal diff is tensor(0.0024, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2689, device='cuda:3')
test acc is  0.9437166668229866
test entropy is  0.2718654582654235
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2718654582654235
avg test loss is  0.18895036944631002
avg accuracy is  0.9437166668229866
compute_distance is  tensor(59.2689, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3170543195945876
avg test loss is  5.8957982286969735
avg accuracy is  0.23578333348967107
compute_distance is  tensor(143.5992, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(143.5992, device='cuda:3')
test acc is  0.23578333348967107
test entropy is  0.3170543195945876
________________________________
diff is  tensor(0.8303, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(14.4419, device='cuda:3')
diff is  tensor(0.0151, device='cuda:3')
diff is  tensor(127.9400, device='cuda:3')
diff is  tensor(0.0253, device='cuda:3')
diff is  tensor(0.3178, device='cuda:3')
diff is  tensor(0.0024, device='cuda:3')
threshold is  tensor(84.3243, device='cuda:3')
sum is tensor(0.0024, device='cuda:3')
sum is tensor(0.0092, device='cuda:3')
sum is tensor(0.0243, device='cuda:3')
sum is tensor(0.0496, device='cuda:3')
sum is tensor(0.3675, device='cuda:3')
sum is tensor(1.1978, device='cuda:3')
sum is tensor(15.6398, device='cuda:3')
sum is tensor(143.5797, device='cuda:3')
ratio is tensor(0.4631, device='cuda:3')
threshold is tensor(127.9400, device='cuda:3')
cal diff is tensor(0.8303, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(14.4419, device='cuda:3')
discard
cal diff is tensor(0.0151, device='cuda:3')
discard
cal diff is tensor(127.9400, device='cuda:3')
clipping
cal diff is tensor(0.0253, device='cuda:3')
discard
cal diff is tensor(0.3178, device='cuda:3')
discard
cal diff is tensor(0.0024, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2689, device='cuda:3')
test acc is  0.9439833334896532
test entropy is  0.27073713380104697
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.27073713380104697
avg test loss is  0.18780656650201724
avg accuracy is  0.9439833334896532
compute_distance is  tensor(59.2689, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.317047180222677
avg test loss is  5.896918746708298
avg accuracy is  0.2356666668230044
compute_distance is  tensor(143.6472, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(143.6472, device='cuda:3')
test acc is  0.2356666668230044
test entropy is  0.317047180222677
________________________________
diff is  tensor(0.8298, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(14.4492, device='cuda:3')
diff is  tensor(0.0151, device='cuda:3')
diff is  tensor(127.9808, device='cuda:3')
diff is  tensor(0.0253, device='cuda:3')
diff is  tensor(0.3179, device='cuda:3')
diff is  tensor(0.0024, device='cuda:3')
threshold is  tensor(84.3723, device='cuda:3')
sum is tensor(0.0024, device='cuda:3')
sum is tensor(0.0092, device='cuda:3')
sum is tensor(0.0243, device='cuda:3')
sum is tensor(0.0497, device='cuda:3')
sum is tensor(0.3676, device='cuda:3')
sum is tensor(1.1974, device='cuda:3')
sum is tensor(15.6466, device='cuda:3')
sum is tensor(143.6274, device='cuda:3')
ratio is tensor(0.4630, device='cuda:3')
threshold is tensor(127.9808, device='cuda:3')
cal diff is tensor(0.8298, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(14.4492, device='cuda:3')
discard
cal diff is tensor(0.0151, device='cuda:3')
discard
cal diff is tensor(127.9808, device='cuda:3')
clipping
cal diff is tensor(0.0253, device='cuda:3')
discard
cal diff is tensor(0.3179, device='cuda:3')
discard
cal diff is tensor(0.0024, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2688, device='cuda:3')
test acc is  0.9441666668229864
test entropy is  0.27006883996286624
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.27006883996286624
avg test loss is  0.18715298629757057
avg accuracy is  0.9441666668229864
compute_distance is  tensor(59.2688, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3170025473686932
avg test loss is  5.897413004690142
avg accuracy is  0.2356666668230044
compute_distance is  tensor(143.6714, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(143.6714, device='cuda:3')
test acc is  0.2356666668230044
test entropy is  0.3170025473686932
________________________________
diff is  tensor(0.8294, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(14.4526, device='cuda:3')
diff is  tensor(0.0151, device='cuda:3')
diff is  tensor(128.0018, device='cuda:3')
diff is  tensor(0.0254, device='cuda:3')
diff is  tensor(0.3180, device='cuda:3')
diff is  tensor(0.0024, device='cuda:3')
threshold is  tensor(84.3965, device='cuda:3')
sum is tensor(0.0024, device='cuda:3')
sum is tensor(0.0092, device='cuda:3')
sum is tensor(0.0243, device='cuda:3')
sum is tensor(0.0497, device='cuda:3')
sum is tensor(0.3677, device='cuda:3')
sum is tensor(1.1971, device='cuda:3')
sum is tensor(15.6498, device='cuda:3')
sum is tensor(143.6516, device='cuda:3')
ratio is tensor(0.4629, device='cuda:3')
threshold is tensor(128.0018, device='cuda:3')
cal diff is tensor(0.8294, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(14.4526, device='cuda:3')
discard
cal diff is tensor(0.0151, device='cuda:3')
discard
cal diff is tensor(128.0018, device='cuda:3')
clipping
cal diff is tensor(0.0254, device='cuda:3')
discard
cal diff is tensor(0.3180, device='cuda:3')
discard
cal diff is tensor(0.0024, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2688, device='cuda:3')
test acc is  0.9443500001563199
test entropy is  0.26966998734072584
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.26966998734072584
avg test loss is  0.18676500202122845
avg accuracy is  0.9443500001563199
compute_distance is  tensor(59.2688, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.31697634466167196
avg test loss is  5.897746481620935
avg accuracy is  0.2355833334896711
compute_distance is  tensor(143.6935, device='cuda:3')
++++++++++++++++++++
reach max round
new distance ratio is 0.99
the length of epoch_weights is  2
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 96.22% 

Test Accuracy: 95.45% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0012615894665941596
attack res is False
len of model dicts is  10
compute distance is  tensor(25.6300, device='cuda:3')
compute distance is  tensor(24.6254, device='cuda:3')
compute distance is  tensor(38.7225, device='cuda:3')
compute distance is  tensor(64.6510, device='cuda:3')
compute distance is  tensor(39.4056, device='cuda:3')
compute distance is  tensor(35.9673, device='cuda:3')
compute distance is  tensor(65.4449, device='cuda:3')
compute distance is  tensor(25.8669, device='cuda:3')
compute distance is  tensor(68.3859, device='cuda:3')
compute distance is  tensor(19.3993, device='cuda:3')
calculated distance threshold is  tensor(63.4873, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.40251666682300785
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3208166668230067
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.40880000015634116
====================
====================
iteration is  1
round is  0
accuracy is  0.4302500001563414
====================
====================
iteration is  1
round is  1
accuracy is  0.21403333348967019
====================
succ_min + 1
________________________________
test distance is  tensor(4281.7632, device='cuda:3')
test acc is  0.21403333348967019
test entropy is  0.1458982762290852
________________________________
diff is  tensor(44.1419, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4088, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.1321, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4969, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.0505, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0374, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2842, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2109, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4218.2759, device='cuda:3')
sum is tensor(0.2109, device='cuda:3', dtype=torch.float64)
sum is tensor(0.6198, device='cuda:3', dtype=torch.float64)
sum is tensor(1.1167, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1541, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4383, device='cuda:3', dtype=torch.float64)
sum is tensor(67.5802, device='cuda:3', dtype=torch.float64)
sum is tensor(640.7123, device='cuda:3', dtype=torch.float64)
sum is tensor(4281.7628, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0174, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.0505, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.1419, device='cuda:3')
discard
cal diff is tensor(0.4088, device='cuda:3')
discard
cal diff is tensor(573.1321, device='cuda:3')
discard
cal diff is tensor(0.4969, device='cuda:3')
discard
cal diff is tensor(3641.0505, device='cuda:3')
discard
cal diff is tensor(2.0374, device='cuda:3')
discard
cal diff is tensor(20.2842, device='cuda:3')
discard
cal diff is tensor(0.2109, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9539833334896529
test entropy is  0.14358940529527822
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14358940529527822
avg test loss is  0.12576994676488454
avg accuracy is  0.9539833334896529
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12406341351473382
avg test loss is  7.0880977919360975
avg accuracy is  0.20000000015633632
compute_distance is  tensor(101.1044, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(101.1044, device='cuda:3')
test acc is  0.20000000015633632
test entropy is  0.12406341351473382
________________________________
diff is  tensor(0.7317, device='cuda:3')
diff is  tensor(0.0064, device='cuda:3')
diff is  tensor(13.6617, device='cuda:3')
diff is  tensor(0.0160, device='cuda:3')
diff is  tensor(86.1728, device='cuda:3')
diff is  tensor(0.0378, device='cuda:3')
diff is  tensor(0.4621, device='cuda:3')
diff is  tensor(0.0032, device='cuda:3')
threshold is  tensor(37.6171, device='cuda:3')
sum is tensor(0.0032, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0256, device='cuda:3')
sum is tensor(0.0634, device='cuda:3')
sum is tensor(0.5255, device='cuda:3')
sum is tensor(1.2572, device='cuda:3')
sum is tensor(14.9188, device='cuda:3')
sum is tensor(101.0916, device='cuda:3')
ratio is tensor(0.7366, device='cuda:3')
threshold is tensor(86.1728, device='cuda:3')
cal diff is tensor(0.7317, device='cuda:3')
discard
cal diff is tensor(0.0064, device='cuda:3')
discard
cal diff is tensor(13.6617, device='cuda:3')
discard
cal diff is tensor(0.0160, device='cuda:3')
discard
cal diff is tensor(86.1728, device='cuda:3')
clipping
cal diff is tensor(0.0378, device='cuda:3')
discard
cal diff is tensor(0.4621, device='cuda:3')
discard
cal diff is tensor(0.0032, device='cuda:3')
discard
________________________________
test distance is  tensor(63.4859, device='cuda:3')
test acc is  0.6877000001563316
test entropy is  0.36701993215312834
________________________________
new distance ratio is 0.8999999999999999
the length of epoch_weights is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 95.99% 

Test Accuracy: 95.12% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0018569567473605275
attack res is False
len of model dicts is  10
compute distance is  tensor(26.2954, device='cuda:3')
compute distance is  tensor(42.6799, device='cuda:3')
compute distance is  tensor(64.1015, device='cuda:3')
compute distance is  tensor(42.0302, device='cuda:3')
compute distance is  tensor(40.1316, device='cuda:3')
compute distance is  tensor(29.2838, device='cuda:3')
compute distance is  tensor(73.1107, device='cuda:3')
compute distance is  tensor(30.6154, device='cuda:3')
compute distance is  tensor(86.5205, device='cuda:3')
compute distance is  tensor(19.2196, device='cuda:3')
calculated distance threshold is  tensor(74.2839, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.24511666682300473
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.37590000015634084
====================
====================
iteration is  0
round is  2
accuracy is  0.2543500001563384
====================
====================
iteration is  1
round is  0
accuracy is  0.4258333334896746
====================
====================
iteration is  1
round is  1
accuracy is  0.29611666682300614
====================
________________________________
test distance is  tensor(4282.6172, device='cuda:3')
test acc is  0.24511666682300473
test entropy is  0.20865084202304832
________________________________
diff is  tensor(43.3553, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3872, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.8495, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5272, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.9505, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0349, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3360, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4208.3330, device='cuda:3')
sum is tensor(0.1768, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5640, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0911, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1261, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4620, device='cuda:3', dtype=torch.float64)
sum is tensor(66.8174, device='cuda:3', dtype=torch.float64)
sum is tensor(640.6668, device='cuda:3', dtype=torch.float64)
sum is tensor(4282.6173, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0204, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.9505, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.3553, device='cuda:3')
discard
cal diff is tensor(0.3872, device='cuda:3')
discard
cal diff is tensor(573.8494, device='cuda:3')
discard
cal diff is tensor(0.5272, device='cuda:3')
discard
cal diff is tensor(3641.9504, device='cuda:3')
discard
cal diff is tensor(2.0349, device='cuda:3')
discard
cal diff is tensor(20.3360, device='cuda:3')
discard
cal diff is tensor(0.1768, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9509666668229864
test entropy is  0.14063512434615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14063512434615
avg test loss is  0.13324825584626337
avg accuracy is  0.9509666668229864
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17497036538160304
avg test loss is  5.503231169064162
avg accuracy is  0.2390666668230046
compute_distance is  tensor(105.1969, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(105.1969, device='cuda:3')
test acc is  0.2390666668230046
test entropy is  0.17497036538160304
________________________________
diff is  tensor(0.7024, device='cuda:3')
diff is  tensor(0.0071, device='cuda:3')
diff is  tensor(14.8315, device='cuda:3')
diff is  tensor(0.0175, device='cuda:3')
diff is  tensor(89.0878, device='cuda:3')
diff is  tensor(0.0382, device='cuda:3')
diff is  tensor(0.5045, device='cuda:3')
diff is  tensor(0.0038, device='cuda:3')
threshold is  tensor(30.9130, device='cuda:3')
sum is tensor(0.0038, device='cuda:3')
sum is tensor(0.0109, device='cuda:3')
sum is tensor(0.0283, device='cuda:3')
sum is tensor(0.0665, device='cuda:3')
sum is tensor(0.5710, device='cuda:3')
sum is tensor(1.2734, device='cuda:3')
sum is tensor(16.1048, device='cuda:3')
sum is tensor(105.1927, device='cuda:3')
ratio is tensor(0.8338, device='cuda:3')
threshold is tensor(89.0878, device='cuda:3')
cal diff is tensor(0.7024, device='cuda:3')
discard
cal diff is tensor(0.0071, device='cuda:3')
discard
cal diff is tensor(14.8315, device='cuda:3')
discard
cal diff is tensor(0.0175, device='cuda:3')
discard
cal diff is tensor(89.0878, device='cuda:3')
clipping
cal diff is tensor(0.0382, device='cuda:3')
discard
cal diff is tensor(0.5045, device='cuda:3')
discard
cal diff is tensor(0.0038, device='cuda:3')
discard
________________________________
test distance is  tensor(74.2862, device='cuda:3')
test acc is  0.6561000001563336
test entropy is  0.3566859220740383
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(74.2800, device='cuda:3')
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0023, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.8805, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(74.2800, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(65.4078, device='cuda:3')
test acc is  0.736733333489662
test entropy is  0.3461125285100581
________________________________
new distance ratio is 0.818181818181818
the length of epoch_weights is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 95.61% 

Test Accuracy: 94.67% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0024438584223389626
attack res is False
len of model dicts is  10
compute distance is  tensor(24.8662, device='cuda:3')
compute distance is  tensor(26.7937, device='cuda:3')
compute distance is  tensor(64.0338, device='cuda:3')
compute distance is  tensor(57.2411, device='cuda:3')
compute distance is  tensor(42.0304, device='cuda:3')
compute distance is  tensor(29.4825, device='cuda:3')
compute distance is  tensor(59.4995, device='cuda:3')
compute distance is  tensor(27.4623, device='cuda:3')
compute distance is  tensor(61.6241, device='cuda:3')
compute distance is  tensor(12.0255, device='cuda:3')
calculated distance threshold is  tensor(50.7093, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.14301666682299927
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34961666682300707
====================
====================
iteration is  0
round is  2
accuracy is  0.2857666668230059
====================
====================
iteration is  1
round is  0
accuracy is  0.42675000015634146
====================
====================
iteration is  1
round is  1
accuracy is  0.47333333348967516
====================
________________________________
test distance is  tensor(4284.0562, device='cuda:3')
test acc is  0.14301666682299927
test entropy is  0.09304456507115921
________________________________
diff is  tensor(43.9839, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3850, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.4999, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5362, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.0559, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0340, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3441, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4233.3467, device='cuda:3')
sum is tensor(0.2166, device='cuda:3', dtype=torch.float64)
sum is tensor(0.6016, device='cuda:3', dtype=torch.float64)
sum is tensor(1.1378, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1718, device='cuda:3', dtype=torch.float64)
sum is tensor(23.5160, device='cuda:3', dtype=torch.float64)
sum is tensor(67.4998, device='cuda:3', dtype=torch.float64)
sum is tensor(641.9997, device='cuda:3', dtype=torch.float64)
sum is tensor(4284.0556, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0139, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.0559, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.9839, device='cuda:3')
discard
cal diff is tensor(0.3850, device='cuda:3')
discard
cal diff is tensor(574.4999, device='cuda:3')
discard
cal diff is tensor(0.5362, device='cuda:3')
discard
cal diff is tensor(3642.0557, device='cuda:3')
discard
cal diff is tensor(2.0340, device='cuda:3')
discard
cal diff is tensor(20.3441, device='cuda:3')
discard
cal diff is tensor(0.2166, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9450666668229865
test entropy is  0.14156962088001435
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14156962088001435
avg test loss is  0.14674041251828676
avg accuracy is  0.9450666668229865
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.07936772770846068
avg test loss is  8.627751317359746
avg accuracy is  0.144383333489666
compute_distance is  tensor(99.3409, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(99.3409, device='cuda:3')
test acc is  0.144383333489666
test entropy is  0.07936772770846068
________________________________
diff is  tensor(0.7888, device='cuda:3')
diff is  tensor(0.0067, device='cuda:3')
diff is  tensor(13.3916, device='cuda:3')
diff is  tensor(0.0153, device='cuda:3')
diff is  tensor(84.6767, device='cuda:3')
diff is  tensor(0.0382, device='cuda:3')
diff is  tensor(0.4128, device='cuda:3')
diff is  tensor(0.0031, device='cuda:3')
threshold is  tensor(48.6315, device='cuda:3')
sum is tensor(0.0031, device='cuda:3')
sum is tensor(0.0098, device='cuda:3')
sum is tensor(0.0252, device='cuda:3')
sum is tensor(0.0633, device='cuda:3')
sum is tensor(0.4762, device='cuda:3')
sum is tensor(1.2650, device='cuda:3')
sum is tensor(14.6566, device='cuda:3')
sum is tensor(99.3333, device='cuda:3')
ratio is tensor(0.5988, device='cuda:3')
threshold is tensor(84.6767, device='cuda:3')
cal diff is tensor(0.7888, device='cuda:3')
discard
cal diff is tensor(0.0067, device='cuda:3')
discard
cal diff is tensor(13.3916, device='cuda:3')
discard
cal diff is tensor(0.0153, device='cuda:3')
discard
cal diff is tensor(84.6767, device='cuda:3')
clipping
cal diff is tensor(0.0382, device='cuda:3')
discard
cal diff is tensor(0.4128, device='cuda:3')
discard
cal diff is tensor(0.0031, device='cuda:3')
discard
________________________________
test distance is  tensor(50.7102, device='cuda:3')
test acc is  0.7149333334896631
test entropy is  0.3350489032643436
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(50.7022, device='cuda:3')
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0009, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
ratio is tensor(0.3500, device='cuda:3')
threshold is tensor(0.0008, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
clipping
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(50.7022, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(17.7542, device='cuda:3')
test acc is  0.9173166668229875
test entropy is  0.1788707438832534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1788707438832534
avg test loss is  0.2155520717746445
avg accuracy is  0.9173166668229875
compute_distance is  tensor(17.7542, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.07861049138486131
avg test loss is  8.714951119189069
avg accuracy is  0.1431333334896659
compute_distance is  tensor(109.6664, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(109.6664, device='cuda:3')
test acc is  0.1431333334896659
test entropy is  0.07861049138486131
________________________________
diff is  tensor(0.7284, device='cuda:3')
diff is  tensor(0.0061, device='cuda:3')
diff is  tensor(13.3764, device='cuda:3')
diff is  tensor(0.0147, device='cuda:3')
diff is  tensor(95.1314, device='cuda:3')
diff is  tensor(0.0313, device='cuda:3')
diff is  tensor(0.3648, device='cuda:3')
diff is  tensor(0.0027, device='cuda:3')
threshold is  tensor(58.9570, device='cuda:3')
sum is tensor(0.0027, device='cuda:3')
sum is tensor(0.0089, device='cuda:3')
sum is tensor(0.0235, device='cuda:3')
sum is tensor(0.0548, device='cuda:3')
sum is tensor(0.4196, device='cuda:3')
sum is tensor(1.1480, device='cuda:3')
sum is tensor(14.5244, device='cuda:3')
sum is tensor(109.6559, device='cuda:3')
ratio is tensor(0.5329, device='cuda:3')
threshold is tensor(95.1314, device='cuda:3')
cal diff is tensor(0.7284, device='cuda:3')
discard
cal diff is tensor(0.0061, device='cuda:3')
discard
cal diff is tensor(13.3764, device='cuda:3')
discard
cal diff is tensor(0.0147, device='cuda:3')
discard
cal diff is tensor(95.1314, device='cuda:3')
clipping
cal diff is tensor(0.0313, device='cuda:3')
discard
cal diff is tensor(0.3648, device='cuda:3')
discard
cal diff is tensor(0.0027, device='cuda:3')
discard
________________________________
test distance is  tensor(50.7078, device='cuda:3')
test acc is  0.7630000001563273
test entropy is  0.31575827503890624
________________________________
new distance ratio is 0.7438016528925617
the length of epoch_weights is  1
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 95.72% 

Test Accuracy: 94.80% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0029900562949478626
attack res is False
len of model dicts is  10
compute distance is  tensor(23.0741, device='cuda:3')
compute distance is  tensor(24.7957, device='cuda:3')
compute distance is  tensor(52.5051, device='cuda:3')
compute distance is  tensor(47.1621, device='cuda:3')
compute distance is  tensor(41.5219, device='cuda:3')
compute distance is  tensor(23.4870, device='cuda:3')
compute distance is  tensor(77.6481, device='cuda:3')
compute distance is  tensor(25.5136, device='cuda:3')
compute distance is  tensor(77.6058, device='cuda:3')
compute distance is  tensor(12.3568, device='cuda:3')
calculated distance threshold is  tensor(56.5057, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.30548333348967294
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.30446666682300627
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5482000001563422
====================
====================
iteration is  1
round is  0
accuracy is  0.28363333348967246
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4159000001563412
====================
________________________________
test distance is  tensor(4283.6494, device='cuda:3')
test acc is  0.28363333348967246
test entropy is  0.32033323224927823
________________________________
diff is  tensor(44.3641, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3594, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.9882, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4893, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.8291, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0394, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3790, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2005, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4227.1436, device='cuda:3')
sum is tensor(0.2005, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5600, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0493, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0887, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4677, device='cuda:3', dtype=torch.float64)
sum is tensor(67.8318, device='cuda:3', dtype=torch.float64)
sum is tensor(641.8200, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.6491, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0155, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.8291, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.3641, device='cuda:3')
discard
cal diff is tensor(0.3594, device='cuda:3')
discard
cal diff is tensor(573.9882, device='cuda:3')
discard
cal diff is tensor(0.4893, device='cuda:3')
discard
cal diff is tensor(3641.8291, device='cuda:3')
clipping
cal diff is tensor(2.0394, device='cuda:3')
discard
cal diff is tensor(20.3790, device='cuda:3')
discard
cal diff is tensor(0.2005, device='cuda:3')
discard
________________________________
test distance is  tensor(56.5157, device='cuda:3')
test acc is  0.9485833334896531
test entropy is  0.13915581584199152
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(56.5056, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0101, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.0181, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(56.5056, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(1.0372, device='cuda:3')
test acc is  0.9481333334896531
test entropy is  0.13919979680591682
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13919979680591682
avg test loss is  0.14127635423824794
avg accuracy is  0.9481333334896531
compute_distance is  tensor(1.0372, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3422167264322228
avg test loss is  4.396321388450004
avg accuracy is  0.29146666682300604
compute_distance is  tensor(106.6536, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(106.6536, device='cuda:3')
test acc is  0.29146666682300604
test entropy is  0.3422167264322228
________________________________
diff is  tensor(0.6591, device='cuda:3')
diff is  tensor(0.0067, device='cuda:3')
diff is  tensor(14.9035, device='cuda:3')
diff is  tensor(0.0173, device='cuda:3')
diff is  tensor(90.5488, device='cuda:3')
diff is  tensor(0.0369, device='cuda:3')
diff is  tensor(0.4658, device='cuda:3')
diff is  tensor(0.0040, device='cuda:3')
threshold is  tensor(50.1479, device='cuda:3')
sum is tensor(0.0040, device='cuda:3')
sum is tensor(0.0107, device='cuda:3')
sum is tensor(0.0280, device='cuda:3')
sum is tensor(0.0649, device='cuda:3')
sum is tensor(0.5307, device='cuda:3')
sum is tensor(1.1898, device='cuda:3')
sum is tensor(16.0933, device='cuda:3')
sum is tensor(106.6421, device='cuda:3')
ratio is tensor(0.6239, device='cuda:3')
threshold is tensor(90.5488, device='cuda:3')
cal diff is tensor(0.6591, device='cuda:3')
discard
cal diff is tensor(0.0067, device='cuda:3')
discard
cal diff is tensor(14.9035, device='cuda:3')
discard
cal diff is tensor(0.0173, device='cuda:3')
discard
cal diff is tensor(90.5488, device='cuda:3')
clipping
cal diff is tensor(0.0369, device='cuda:3')
discard
cal diff is tensor(0.4658, device='cuda:3')
discard
cal diff is tensor(0.0040, device='cuda:3')
discard
________________________________
test distance is  tensor(56.5056, device='cuda:3')
test acc is  0.9140666668229875
test entropy is  0.2779820132960897
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2779820132960897
avg test loss is  0.26019181348462855
avg accuracy is  0.9140666668229875
compute_distance is  tensor(56.5056, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.345670071976589
avg test loss is  4.5411206494008045
avg accuracy is  0.2863333334896725
compute_distance is  tensor(137.5895, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(137.5895, device='cuda:3')
test acc is  0.2863333334896725
test entropy is  0.345670071976589
________________________________
diff is  tensor(0.7932, device='cuda:3')
diff is  tensor(0.0064, device='cuda:3')
diff is  tensor(13.8509, device='cuda:3')
diff is  tensor(0.0149, device='cuda:3')
diff is  tensor(122.5364, device='cuda:3')
diff is  tensor(0.0222, device='cuda:3')
diff is  tensor(0.3431, device='cuda:3')
diff is  tensor(0.0025, device='cuda:3')
threshold is  tensor(81.0839, device='cuda:3')
sum is tensor(0.0025, device='cuda:3')
sum is tensor(0.0088, device='cuda:3')
sum is tensor(0.0237, device='cuda:3')
sum is tensor(0.0459, device='cuda:3')
sum is tensor(0.3890, device='cuda:3')
sum is tensor(1.1822, device='cuda:3')
sum is tensor(15.0331, device='cuda:3')
sum is tensor(137.5695, device='cuda:3')
ratio is tensor(0.4610, device='cuda:3')
threshold is tensor(122.5364, device='cuda:3')
cal diff is tensor(0.7932, device='cuda:3')
discard
cal diff is tensor(0.0064, device='cuda:3')
discard
cal diff is tensor(13.8509, device='cuda:3')
discard
cal diff is tensor(0.0149, device='cuda:3')
discard
cal diff is tensor(122.5364, device='cuda:3')
clipping
cal diff is tensor(0.0222, device='cuda:3')
discard
cal diff is tensor(0.3431, device='cuda:3')
discard
cal diff is tensor(0.0025, device='cuda:3')
discard
________________________________
test distance is  tensor(56.4994, device='cuda:3')
test acc is  0.9428000001563199
test entropy is  0.22955291850893483
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22955291850893483
avg test loss is  0.1796516158016347
avg accuracy is  0.9428000001563199
compute_distance is  tensor(56.4994, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3455872238556078
avg test loss is  4.551761528068005
avg accuracy is  0.2861333334896725
compute_distance is  tensor(140.7258, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(140.7258, device='cuda:3')
test acc is  0.2861333334896725
test entropy is  0.3455872238556078
________________________________
diff is  tensor(0.8327, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(14.4112, device='cuda:3')
diff is  tensor(0.0154, device='cuda:3')
diff is  tensor(125.0754, device='cuda:3')
diff is  tensor(0.0232, device='cuda:3')
diff is  tensor(0.3373, device='cuda:3')
diff is  tensor(0.0026, device='cuda:3')
threshold is  tensor(84.2201, device='cuda:3')
sum is tensor(0.0026, device='cuda:3')
sum is tensor(0.0094, device='cuda:3')
sum is tensor(0.0248, device='cuda:3')
sum is tensor(0.0480, device='cuda:3')
sum is tensor(0.3853, device='cuda:3')
sum is tensor(1.2181, device='cuda:3')
sum is tensor(15.6293, device='cuda:3')
sum is tensor(140.7047, device='cuda:3')
ratio is tensor(0.4516, device='cuda:3')
threshold is tensor(125.0754, device='cuda:3')
cal diff is tensor(0.8327, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(14.4112, device='cuda:3')
discard
cal diff is tensor(0.0154, device='cuda:3')
discard
cal diff is tensor(125.0754, device='cuda:3')
clipping
cal diff is tensor(0.0232, device='cuda:3')
discard
cal diff is tensor(0.3373, device='cuda:3')
discard
cal diff is tensor(0.0026, device='cuda:3')
discard
________________________________
test distance is  tensor(56.4991, device='cuda:3')
test acc is  0.9472333334896531
test entropy is  0.2188598706381026
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2188598706381026
avg test loss is  0.166488048796262
avg accuracy is  0.9472333334896531
compute_distance is  tensor(56.4991, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3454940900492516
avg test loss is  4.5546908810702975
avg accuracy is  0.2859333334896725
compute_distance is  tensor(141.5875, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(141.5875, device='cuda:3')
test acc is  0.2859333334896725
test entropy is  0.3454940900492516
________________________________
diff is  tensor(0.8379, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(14.5987, device='cuda:3')
diff is  tensor(0.0155, device='cuda:3')
diff is  tensor(125.7401, device='cuda:3')
diff is  tensor(0.0237, device='cuda:3')
diff is  tensor(0.3403, device='cuda:3')
diff is  tensor(0.0027, device='cuda:3')
threshold is  tensor(85.0819, device='cuda:3')
sum is tensor(0.0027, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0251, device='cuda:3')
sum is tensor(0.0488, device='cuda:3')
sum is tensor(0.3891, device='cuda:3')
sum is tensor(1.2270, device='cuda:3')
sum is tensor(15.8257, device='cuda:3')
sum is tensor(141.5658, device='cuda:3')
ratio is tensor(0.4492, device='cuda:3')
threshold is tensor(125.7401, device='cuda:3')
cal diff is tensor(0.8379, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(14.5987, device='cuda:3')
discard
cal diff is tensor(0.0155, device='cuda:3')
discard
cal diff is tensor(125.7401, device='cuda:3')
clipping
cal diff is tensor(0.0237, device='cuda:3')
discard
cal diff is tensor(0.3403, device='cuda:3')
discard
cal diff is tensor(0.0027, device='cuda:3')
discard
________________________________
test distance is  tensor(56.4990, device='cuda:3')
test acc is  0.9484000001563199
test entropy is  0.2154779006073724
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2154779006073724
avg test loss is  0.16289448503778178
avg accuracy is  0.9484000001563199
compute_distance is  tensor(56.4990, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3454994705599
avg test loss is  4.556088714203092
avg accuracy is  0.2860500001563392
compute_distance is  tensor(141.8840, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(141.8840, device='cuda:3')
test acc is  0.2860500001563392
test entropy is  0.3454994705599
________________________________
diff is  tensor(0.8382, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(14.6690, device='cuda:3')
diff is  tensor(0.0156, device='cuda:3')
diff is  tensor(125.9658, device='cuda:3')
diff is  tensor(0.0239, device='cuda:3')
diff is  tensor(0.3398, device='cuda:3')
diff is  tensor(0.0027, device='cuda:3')
threshold is  tensor(85.3784, device='cuda:3')
sum is tensor(0.0027, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0252, device='cuda:3')
sum is tensor(0.0490, device='cuda:3')
sum is tensor(0.3889, device='cuda:3')
sum is tensor(1.2271, device='cuda:3')
sum is tensor(15.8961, device='cuda:3')
sum is tensor(141.8618, device='cuda:3')
ratio is tensor(0.4484, device='cuda:3')
threshold is tensor(125.9658, device='cuda:3')
cal diff is tensor(0.8382, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(14.6690, device='cuda:3')
discard
cal diff is tensor(0.0156, device='cuda:3')
discard
cal diff is tensor(125.9658, device='cuda:3')
clipping
cal diff is tensor(0.0239, device='cuda:3')
discard
cal diff is tensor(0.3398, device='cuda:3')
discard
cal diff is tensor(0.0027, device='cuda:3')
discard
________________________________
test distance is  tensor(56.4988, device='cuda:3')
test acc is  0.9487333334896532
test entropy is  0.21407056547431294
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21407056547431294
avg test loss is  0.16155576133735175
avg accuracy is  0.9487333334896532
compute_distance is  tensor(56.4988, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3455413772956903
avg test loss is  4.557208441976291
avg accuracy is  0.2858833334896725
compute_distance is  tensor(141.9927, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(141.9927, device='cuda:3')
test acc is  0.2858833334896725
test entropy is  0.3455413772956903
________________________________
diff is  tensor(0.8379, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(14.6948, device='cuda:3')
diff is  tensor(0.0156, device='cuda:3')
diff is  tensor(126.0489, device='cuda:3')
diff is  tensor(0.0239, device='cuda:3')
diff is  tensor(0.3395, device='cuda:3')
diff is  tensor(0.0027, device='cuda:3')
threshold is  tensor(85.4870, device='cuda:3')
sum is tensor(0.0027, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0252, device='cuda:3')
sum is tensor(0.0491, device='cuda:3')
sum is tensor(0.3887, device='cuda:3')
sum is tensor(1.2265, device='cuda:3')
sum is tensor(15.9214, device='cuda:3')
sum is tensor(141.9702, device='cuda:3')
ratio is tensor(0.4481, device='cuda:3')
threshold is tensor(126.0489, device='cuda:3')
cal diff is tensor(0.8379, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(14.6948, device='cuda:3')
discard
cal diff is tensor(0.0156, device='cuda:3')
discard
cal diff is tensor(126.0489, device='cuda:3')
clipping
cal diff is tensor(0.0239, device='cuda:3')
discard
cal diff is tensor(0.3395, device='cuda:3')
discard
cal diff is tensor(0.0027, device='cuda:3')
discard
________________________________
test distance is  tensor(56.4988, device='cuda:3')
test acc is  0.9489000001563197
test entropy is  0.21337994883881448
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21337994883881448
avg test loss is  0.16093772540845946
avg accuracy is  0.9489000001563197
compute_distance is  tensor(56.4988, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3455741899862472
avg test loss is  4.558533865251521
avg accuracy is  0.2858166668230058
compute_distance is  tensor(142.0497, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(142.0497, device='cuda:3')
test acc is  0.2858166668230058
test entropy is  0.3455741899862472
________________________________
diff is  tensor(0.8372, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(14.7033, device='cuda:3')
diff is  tensor(0.0156, device='cuda:3')
diff is  tensor(126.0981, device='cuda:3')
diff is  tensor(0.0240, device='cuda:3')
diff is  tensor(0.3394, device='cuda:3')
diff is  tensor(0.0027, device='cuda:3')
threshold is  tensor(85.5440, device='cuda:3')
sum is tensor(0.0027, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0252, device='cuda:3')
sum is tensor(0.0492, device='cuda:3')
sum is tensor(0.3886, device='cuda:3')
sum is tensor(1.2257, device='cuda:3')
sum is tensor(15.9290, device='cuda:3')
sum is tensor(142.0271, device='cuda:3')
ratio is tensor(0.4479, device='cuda:3')
threshold is tensor(126.0981, device='cuda:3')
cal diff is tensor(0.8372, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(14.7033, device='cuda:3')
discard
cal diff is tensor(0.0156, device='cuda:3')
discard
cal diff is tensor(126.0981, device='cuda:3')
clipping
cal diff is tensor(0.0240, device='cuda:3')
discard
cal diff is tensor(0.3394, device='cuda:3')
discard
cal diff is tensor(0.0027, device='cuda:3')
discard
________________________________
test distance is  tensor(56.4988, device='cuda:3')
test acc is  0.948983333489653
test entropy is  0.21299847189996288
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21299847189996288
avg test loss is  0.1605990530738333
avg accuracy is  0.948983333489653
compute_distance is  tensor(56.4988, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.34561126598162945
avg test loss is  4.559157906056467
avg accuracy is  0.2857333334896725
compute_distance is  tensor(142.0879, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(142.0879, device='cuda:3')
test acc is  0.2857333334896725
test entropy is  0.34561126598162945
________________________________
diff is  tensor(0.8367, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(14.7101, device='cuda:3')
diff is  tensor(0.0156, device='cuda:3')
diff is  tensor(126.1300, device='cuda:3')
diff is  tensor(0.0240, device='cuda:3')
diff is  tensor(0.3392, device='cuda:3')
diff is  tensor(0.0027, device='cuda:3')
threshold is  tensor(85.5823, device='cuda:3')
sum is tensor(0.0027, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0252, device='cuda:3')
sum is tensor(0.0492, device='cuda:3')
sum is tensor(0.3884, device='cuda:3')
sum is tensor(1.2252, device='cuda:3')
sum is tensor(15.9352, device='cuda:3')
sum is tensor(142.0652, device='cuda:3')
ratio is tensor(0.4478, device='cuda:3')
threshold is tensor(126.1300, device='cuda:3')
cal diff is tensor(0.8367, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(14.7101, device='cuda:3')
discard
cal diff is tensor(0.0156, device='cuda:3')
discard
cal diff is tensor(126.1300, device='cuda:3')
clipping
cal diff is tensor(0.0240, device='cuda:3')
discard
cal diff is tensor(0.3392, device='cuda:3')
discard
cal diff is tensor(0.0027, device='cuda:3')
discard
________________________________
test distance is  tensor(56.4987, device='cuda:3')
test acc is  0.949083333489653
test entropy is  0.21273876327886257
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21273876327886257
avg test loss is  0.1603782584866894
avg accuracy is  0.949083333489653
compute_distance is  tensor(56.4987, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3456555156311247
avg test loss is  4.559355742641603
avg accuracy is  0.2857333334896725
compute_distance is  tensor(142.1073, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(142.1073, device='cuda:3')
test acc is  0.2857333334896725
test entropy is  0.3456555156311247
________________________________
diff is  tensor(0.8368, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(14.7165, device='cuda:3')
diff is  tensor(0.0156, device='cuda:3')
diff is  tensor(126.1430, device='cuda:3')
diff is  tensor(0.0240, device='cuda:3')
diff is  tensor(0.3390, device='cuda:3')
diff is  tensor(0.0027, device='cuda:3')
threshold is  tensor(85.6016, device='cuda:3')
sum is tensor(0.0027, device='cuda:3')
sum is tensor(0.0097, device='cuda:3')
sum is tensor(0.0252, device='cuda:3')
sum is tensor(0.0492, device='cuda:3')
sum is tensor(0.3882, device='cuda:3')
sum is tensor(1.2250, device='cuda:3')
sum is tensor(15.9415, device='cuda:3')
sum is tensor(142.0845, device='cuda:3')
ratio is tensor(0.4478, device='cuda:3')
threshold is tensor(126.1430, device='cuda:3')
cal diff is tensor(0.8368, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(14.7165, device='cuda:3')
discard
cal diff is tensor(0.0156, device='cuda:3')
discard
cal diff is tensor(126.1430, device='cuda:3')
clipping
cal diff is tensor(0.0240, device='cuda:3')
discard
cal diff is tensor(0.3390, device='cuda:3')
discard
cal diff is tensor(0.0027, device='cuda:3')
discard
reach max round
new distance ratio is 0.7438016528925617
the length of epoch_weights is  3
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 96.06% 

Test Accuracy: 95.22% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0035617665853351355
attack res is False
len of model dicts is  10
compute distance is  tensor(24.3013, device='cuda:3')
compute distance is  tensor(26.5628, device='cuda:3')
compute distance is  tensor(50.8770, device='cuda:3')
compute distance is  tensor(51.1778, device='cuda:3')
compute distance is  tensor(35.7014, device='cuda:3')
compute distance is  tensor(42.3971, device='cuda:3')
compute distance is  tensor(63.4154, device='cuda:3')
compute distance is  tensor(31.5688, device='cuda:3')
compute distance is  tensor(80.1530, device='cuda:3')
compute distance is  tensor(12.3546, device='cuda:3')
calculated distance threshold is  tensor(58.1987, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.3703166668230074
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.311033333489673
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.32843333348967335
====================
====================
iteration is  1
round is  0
accuracy is  0.3855166668230076
====================
====================
iteration is  1
round is  1
accuracy is  0.32660000015634
====================
________________________________
test distance is  tensor(4283.1128, device='cuda:3')
test acc is  0.311033333489673
test entropy is  0.23997851162513437
________________________________
diff is  tensor(43.8952, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3543, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.0347, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5404, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.7530, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0597, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3048, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1707, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4224.9141, device='cuda:3')
sum is tensor(0.1707, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5250, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0654, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1251, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4299, device='cuda:3', dtype=torch.float64)
sum is tensor(67.3251, device='cuda:3', dtype=torch.float64)
sum is tensor(641.3598, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.1128, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0160, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.7530, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.8952, device='cuda:3')
discard
cal diff is tensor(0.3543, device='cuda:3')
discard
cal diff is tensor(574.0347, device='cuda:3')
discard
cal diff is tensor(0.5404, device='cuda:3')
discard
cal diff is tensor(3641.7532, device='cuda:3')
clipping
cal diff is tensor(2.0597, device='cuda:3')
discard
cal diff is tensor(20.3048, device='cuda:3')
discard
cal diff is tensor(0.1707, device='cuda:3')
discard
________________________________
test distance is  tensor(58.2090, device='cuda:3')
test acc is  0.9515333334896531
test entropy is  0.1349280818875855
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(58.1988, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0102, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
sum is tensor(58.2090, device='cuda:3')
ratio is tensor(1.0000, device='cuda:3', dtype=torch.float64)
threshold is tensor(58.1988, device='cuda:3', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
discard
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(58.1988, device='cuda:3')
discard
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9517166668229864
test entropy is  0.13481076745622195
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13481076745622195
avg test loss is  0.13183133487404983
avg accuracy is  0.9517166668229864
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24531282734737467
avg test loss is  4.748548724249736
avg accuracy is  0.3345333334896734
compute_distance is  tensor(103.2223, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(103.2223, device='cuda:3')
test acc is  0.3345333334896734
test entropy is  0.24531282734737467
________________________________
diff is  tensor(0.9613, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(15.5840, device='cuda:3')
diff is  tensor(0.0165, device='cuda:3')
diff is  tensor(86.1333, device='cuda:3')
diff is  tensor(0.0356, device='cuda:3')
diff is  tensor(0.4654, device='cuda:3')
diff is  tensor(0.0035, device='cuda:3')
threshold is  tensor(45.0235, device='cuda:3')
sum is tensor(0.0035, device='cuda:3')
sum is tensor(0.0103, device='cuda:3')
sum is tensor(0.0268, device='cuda:3')
sum is tensor(0.0624, device='cuda:3')
sum is tensor(0.5278, device='cuda:3')
sum is tensor(1.4891, device='cuda:3')
sum is tensor(17.0731, device='cuda:3')
sum is tensor(103.2064, device='cuda:3')
ratio is tensor(0.6755, device='cuda:3')
threshold is tensor(86.1333, device='cuda:3')
cal diff is tensor(0.9613, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(15.5840, device='cuda:3')
discard
cal diff is tensor(0.0165, device='cuda:3')
discard
cal diff is tensor(86.1333, device='cuda:3')
clipping
cal diff is tensor(0.0356, device='cuda:3')
discard
cal diff is tensor(0.4654, device='cuda:3')
discard
cal diff is tensor(0.0035, device='cuda:3')
discard
________________________________
test distance is  tensor(58.1964, device='cuda:3')
test acc is  0.7825500001563264
test entropy is  0.30843145949944756
________________________________
new distance ratio is 0.6761833208114197
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 95.43% 

Test Accuracy: 94.60% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004134868271648884
attack res is False
len of model dicts is  10
compute distance is  tensor(28.4177, device='cuda:3')
compute distance is  tensor(37.3386, device='cuda:3')
compute distance is  tensor(105.5835, device='cuda:3')
compute distance is  tensor(54.8834, device='cuda:3')
compute distance is  tensor(39.4242, device='cuda:3')
compute distance is  tensor(29.3259, device='cuda:3')
compute distance is  tensor(58.8095, device='cuda:3')
compute distance is  tensor(39.3427, device='cuda:3')
compute distance is  tensor(95.2759, device='cuda:3')
compute distance is  tensor(10.5875, device='cuda:3')
calculated distance threshold is  tensor(68.9827, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.43311666682300815
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34863333348967374
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.41291666682300787
====================
====================
iteration is  1
round is  0
accuracy is  0.38101666682300755
====================
====================
iteration is  1
round is  1
accuracy is  0.3138833334896731
====================
succ_min + 1
________________________________
test distance is  tensor(4281.6997, device='cuda:3')
test acc is  0.3138833334896731
test entropy is  0.3417853080768829
________________________________
diff is  tensor(42.3050, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3335, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.4211, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5136, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.4770, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0237, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.4020, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2235, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4212.7168, device='cuda:3')
sum is tensor(0.2235, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5571, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0706, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0943, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4963, device='cuda:3', dtype=torch.float64)
sum is tensor(65.8014, device='cuda:3', dtype=torch.float64)
sum is tensor(639.2224, device='cuda:3', dtype=torch.float64)
sum is tensor(4281.6994, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0189, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.4770, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.3050, device='cuda:3')
discard
cal diff is tensor(0.3335, device='cuda:3')
discard
cal diff is tensor(573.4210, device='cuda:3')
discard
cal diff is tensor(0.5136, device='cuda:3')
discard
cal diff is tensor(3642.4771, device='cuda:3')
clipping
cal diff is tensor(2.0237, device='cuda:3')
discard
cal diff is tensor(20.4020, device='cuda:3')
discard
cal diff is tensor(0.2235, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9928, device='cuda:3')
test acc is  0.9440500001563198
test entropy is  0.13685676422931237
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(68.9827, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0101, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.0080, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(68.9827, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.5672, device='cuda:3')
test acc is  0.9446833334896532
test entropy is  0.13595272111358928
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13595272111358928
avg test loss is  0.15042326453803126
avg accuracy is  0.9446833334896532
compute_distance is  tensor(0.5672, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.34811716358354095
avg test loss is  3.7365908986215652
avg accuracy is  0.305683333489673
compute_distance is  tensor(103.8361, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(103.8361, device='cuda:3')
test acc is  0.305683333489673
test entropy is  0.34811716358354095
________________________________
diff is  tensor(0.7960, device='cuda:3')
diff is  tensor(0.0062, device='cuda:3')
diff is  tensor(15.0547, device='cuda:3')
diff is  tensor(0.0177, device='cuda:3')
diff is  tensor(87.3859, device='cuda:3')
diff is  tensor(0.0342, device='cuda:3')
diff is  tensor(0.5250, device='cuda:3')
diff is  tensor(0.0034, device='cuda:3')
threshold is  tensor(34.8534, device='cuda:3')
sum is tensor(0.0034, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0273, device='cuda:3')
sum is tensor(0.0615, device='cuda:3')
sum is tensor(0.5865, device='cuda:3')
sum is tensor(1.3825, device='cuda:3')
sum is tensor(16.4372, device='cuda:3')
sum is tensor(103.8231, device='cuda:3')
ratio is tensor(0.7893, device='cuda:3')
threshold is tensor(87.3859, device='cuda:3')
cal diff is tensor(0.7960, device='cuda:3')
discard
cal diff is tensor(0.0062, device='cuda:3')
discard
cal diff is tensor(15.0547, device='cuda:3')
discard
cal diff is tensor(0.0177, device='cuda:3')
discard
cal diff is tensor(87.3859, device='cuda:3')
clipping
cal diff is tensor(0.0342, device='cuda:3')
discard
cal diff is tensor(0.5250, device='cuda:3')
discard
cal diff is tensor(0.0034, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9832, device='cuda:3')
test acc is  0.7720166668229936
test entropy is  0.4030826139742377
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(68.9693, device='cuda:3')
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0005, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
ratio is tensor(0.8697, device='cuda:3')
threshold is tensor(0.0008, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
clipping
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(68.9693, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(59.9994, device='cuda:3')
test acc is  0.8361166668229906
test entropy is  0.3448387207125804
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3448387207125804
avg test loss is  0.4697058579957943
avg accuracy is  0.8361166668229906
compute_distance is  tensor(59.9994, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3510150691466545
avg test loss is  3.8901230574670884
avg accuracy is  0.31440000015633984
compute_distance is  tensor(139.4154, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(139.4154, device='cuda:3')
test acc is  0.31440000015633984
test entropy is  0.3510150691466545
________________________________
diff is  tensor(0.8288, device='cuda:3')
diff is  tensor(0.0077, device='cuda:3')
diff is  tensor(14.8230, device='cuda:3')
diff is  tensor(0.0156, device='cuda:3')
diff is  tensor(123.3218, device='cuda:3')
diff is  tensor(0.0195, device='cuda:3')
diff is  tensor(0.3744, device='cuda:3')
diff is  tensor(0.0022, device='cuda:3')
threshold is  tensor(70.4327, device='cuda:3')
sum is tensor(0.0022, device='cuda:3')
sum is tensor(0.0098, device='cuda:3')
sum is tensor(0.0254, device='cuda:3')
sum is tensor(0.0449, device='cuda:3')
sum is tensor(0.4193, device='cuda:3')
sum is tensor(1.2482, device='cuda:3')
sum is tensor(16.0712, device='cuda:3')
sum is tensor(139.3931, device='cuda:3')
ratio is tensor(0.5592, device='cuda:3')
threshold is tensor(123.3218, device='cuda:3')
cal diff is tensor(0.8288, device='cuda:3')
discard
cal diff is tensor(0.0077, device='cuda:3')
discard
cal diff is tensor(14.8230, device='cuda:3')
discard
cal diff is tensor(0.0156, device='cuda:3')
discard
cal diff is tensor(123.3218, device='cuda:3')
clipping
cal diff is tensor(0.0195, device='cuda:3')
discard
cal diff is tensor(0.3744, device='cuda:3')
discard
cal diff is tensor(0.0022, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9761, device='cuda:3')
test acc is  0.8685166668229893
test entropy is  0.3144538199691884
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3144538199691884
avg test loss is  0.37919901813398293
avg accuracy is  0.8685166668229893
compute_distance is  tensor(68.9761, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.35052873079837765
avg test loss is  3.931112413213197
avg accuracy is  0.3130333334896731
compute_distance is  tensor(148.3198, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(148.3198, device='cuda:3')
test acc is  0.3130333334896731
test entropy is  0.35052873079837765
________________________________
diff is  tensor(0.8422, device='cuda:3')
diff is  tensor(0.0076, device='cuda:3')
diff is  tensor(15.0002, device='cuda:3')
diff is  tensor(0.0157, device='cuda:3')
diff is  tensor(132.0574, device='cuda:3')
diff is  tensor(0.0191, device='cuda:3')
diff is  tensor(0.3514, device='cuda:3')
diff is  tensor(0.0020, device='cuda:3')
threshold is  tensor(79.3371, device='cuda:3')
sum is tensor(0.0020, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0254, device='cuda:3')
sum is tensor(0.0444, device='cuda:3')
sum is tensor(0.3958, device='cuda:3')
sum is tensor(1.2380, device='cuda:3')
sum is tensor(16.2382, device='cuda:3')
sum is tensor(148.2956, device='cuda:3')
ratio is tensor(0.5222, device='cuda:3')
threshold is tensor(132.0574, device='cuda:3')
cal diff is tensor(0.8422, device='cuda:3')
discard
cal diff is tensor(0.0076, device='cuda:3')
discard
cal diff is tensor(15.0002, device='cuda:3')
discard
cal diff is tensor(0.0157, device='cuda:3')
discard
cal diff is tensor(132.0574, device='cuda:3')
clipping
cal diff is tensor(0.0191, device='cuda:3')
discard
cal diff is tensor(0.3514, device='cuda:3')
discard
cal diff is tensor(0.0020, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9752, device='cuda:3')
test acc is  0.8817166668229888
test entropy is  0.2906123231659566
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2906123231659566
avg test loss is  0.33809601338798684
avg accuracy is  0.8817166668229888
compute_distance is  tensor(68.9752, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.35041488294027
avg test loss is  3.9336463558648442
avg accuracy is  0.31241666682300645
compute_distance is  tensor(149.6708, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(149.6708, device='cuda:3')
test acc is  0.31241666682300645
test entropy is  0.35041488294027
________________________________
diff is  tensor(0.8404, device='cuda:3')
diff is  tensor(0.0076, device='cuda:3')
diff is  tensor(15.2588, device='cuda:3')
diff is  tensor(0.0161, device='cuda:3')
diff is  tensor(133.1473, device='cuda:3')
diff is  tensor(0.0198, device='cuda:3')
diff is  tensor(0.3539, device='cuda:3')
diff is  tensor(0.0020, device='cuda:3')
threshold is  tensor(80.6881, device='cuda:3')
sum is tensor(0.0020, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0257, device='cuda:3')
sum is tensor(0.0455, device='cuda:3')
sum is tensor(0.3994, device='cuda:3')
sum is tensor(1.2398, device='cuda:3')
sum is tensor(16.4986, device='cuda:3')
sum is tensor(149.6460, device='cuda:3')
ratio is tensor(0.5179, device='cuda:3')
threshold is tensor(133.1473, device='cuda:3')
cal diff is tensor(0.8404, device='cuda:3')
discard
cal diff is tensor(0.0076, device='cuda:3')
discard
cal diff is tensor(15.2588, device='cuda:3')
discard
cal diff is tensor(0.0161, device='cuda:3')
discard
cal diff is tensor(133.1473, device='cuda:3')
clipping
cal diff is tensor(0.0198, device='cuda:3')
discard
cal diff is tensor(0.3539, device='cuda:3')
discard
cal diff is tensor(0.0020, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9750, device='cuda:3')
test acc is  0.8847333334896553
test entropy is  0.28485697274332616
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.28485697274332616
avg test loss is  0.32922677905844855
avg accuracy is  0.8847333334896553
compute_distance is  tensor(68.9750, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.35038788130542614
avg test loss is  3.934713939613879
avg accuracy is  0.3120000001563397
compute_distance is  tensor(150.1223, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(150.1223, device='cuda:3')
test acc is  0.3120000001563397
test entropy is  0.35038788130542614
________________________________
diff is  tensor(0.8408, device='cuda:3')
diff is  tensor(0.0076, device='cuda:3')
diff is  tensor(15.3588, device='cuda:3')
diff is  tensor(0.0162, device='cuda:3')
diff is  tensor(133.4970, device='cuda:3')
diff is  tensor(0.0200, device='cuda:3')
diff is  tensor(0.3546, device='cuda:3')
diff is  tensor(0.0020, device='cuda:3')
threshold is  tensor(81.1396, device='cuda:3')
sum is tensor(0.0020, device='cuda:3')
sum is tensor(0.0097, device='cuda:3')
sum is tensor(0.0258, device='cuda:3')
sum is tensor(0.0458, device='cuda:3')
sum is tensor(0.4005, device='cuda:3')
sum is tensor(1.2413, device='cuda:3')
sum is tensor(16.6000, device='cuda:3')
sum is tensor(150.0970, device='cuda:3')
ratio is tensor(0.5165, device='cuda:3')
threshold is tensor(133.4970, device='cuda:3')
cal diff is tensor(0.8408, device='cuda:3')
discard
cal diff is tensor(0.0076, device='cuda:3')
discard
cal diff is tensor(15.3588, device='cuda:3')
discard
cal diff is tensor(0.0162, device='cuda:3')
discard
cal diff is tensor(133.4970, device='cuda:3')
clipping
cal diff is tensor(0.0200, device='cuda:3')
discard
cal diff is tensor(0.3546, device='cuda:3')
discard
cal diff is tensor(0.0020, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9749, device='cuda:3')
test acc is  0.8856000001563219
test entropy is  0.2828459848504839
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2828459848504839
avg test loss is  0.32611048381243435
avg accuracy is  0.8856000001563219
compute_distance is  tensor(68.9749, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.35056724840961795
avg test loss is  3.933689867509708
avg accuracy is  0.31236666682300646
compute_distance is  tensor(150.3027, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(150.3027, device='cuda:3')
test acc is  0.31236666682300646
test entropy is  0.35056724840961795
________________________________
diff is  tensor(0.8409, device='cuda:3')
diff is  tensor(0.0076, device='cuda:3')
diff is  tensor(15.4054, device='cuda:3')
diff is  tensor(0.0162, device='cuda:3')
diff is  tensor(133.6301, device='cuda:3')
diff is  tensor(0.0201, device='cuda:3')
diff is  tensor(0.3547, device='cuda:3')
diff is  tensor(0.0020, device='cuda:3')
threshold is  tensor(81.3200, device='cuda:3')
sum is tensor(0.0020, device='cuda:3')
sum is tensor(0.0097, device='cuda:3')
sum is tensor(0.0259, device='cuda:3')
sum is tensor(0.0460, device='cuda:3')
sum is tensor(0.4007, device='cuda:3')
sum is tensor(1.2416, device='cuda:3')
sum is tensor(16.6470, device='cuda:3')
sum is tensor(150.2771, device='cuda:3')
ratio is tensor(0.5160, device='cuda:3')
threshold is tensor(133.6301, device='cuda:3')
cal diff is tensor(0.8409, device='cuda:3')
discard
cal diff is tensor(0.0076, device='cuda:3')
discard
cal diff is tensor(15.4054, device='cuda:3')
discard
cal diff is tensor(0.0162, device='cuda:3')
discard
cal diff is tensor(133.6301, device='cuda:3')
clipping
cal diff is tensor(0.0201, device='cuda:3')
discard
cal diff is tensor(0.3547, device='cuda:3')
discard
cal diff is tensor(0.0020, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9749, device='cuda:3')
test acc is  0.8859333334896552
test entropy is  0.28189303266849597
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.28189303266849597
avg test loss is  0.3247641243977841
avg accuracy is  0.8859333334896552
compute_distance is  tensor(68.9749, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3505646436612235
avg test loss is  3.9349248368602825
avg accuracy is  0.3123000001563398
compute_distance is  tensor(150.3736, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(150.3736, device='cuda:3')
test acc is  0.3123000001563398
test entropy is  0.3505646436612235
________________________________
diff is  tensor(0.8403, device='cuda:3')
diff is  tensor(0.0076, device='cuda:3')
diff is  tensor(15.4263, device='cuda:3')
diff is  tensor(0.0162, device='cuda:3')
diff is  tensor(133.6804, device='cuda:3')
diff is  tensor(0.0201, device='cuda:3')
diff is  tensor(0.3547, device='cuda:3')
diff is  tensor(0.0020, device='cuda:3')
threshold is  tensor(81.3909, device='cuda:3')
sum is tensor(0.0020, device='cuda:3')
sum is tensor(0.0097, device='cuda:3')
sum is tensor(0.0259, device='cuda:3')
sum is tensor(0.0460, device='cuda:3')
sum is tensor(0.4008, device='cuda:3')
sum is tensor(1.2411, device='cuda:3')
sum is tensor(16.6674, device='cuda:3')
sum is tensor(150.3478, device='cuda:3')
ratio is tensor(0.5158, device='cuda:3')
threshold is tensor(133.6804, device='cuda:3')
cal diff is tensor(0.8403, device='cuda:3')
discard
cal diff is tensor(0.0076, device='cuda:3')
discard
cal diff is tensor(15.4263, device='cuda:3')
discard
cal diff is tensor(0.0162, device='cuda:3')
discard
cal diff is tensor(133.6804, device='cuda:3')
clipping
cal diff is tensor(0.0201, device='cuda:3')
discard
cal diff is tensor(0.3547, device='cuda:3')
discard
cal diff is tensor(0.0020, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9748, device='cuda:3')
test acc is  0.8860000001563219
test entropy is  0.28137257528394016
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.28137257528394016
avg test loss is  0.324200163172411
avg accuracy is  0.8860000001563219
compute_distance is  tensor(68.9748, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3505222652512573
avg test loss is  3.9359957091589726
avg accuracy is  0.3123333334896731
compute_distance is  tensor(150.3991, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(150.3991, device='cuda:3')
test acc is  0.3123333334896731
test entropy is  0.3505222652512573
________________________________
diff is  tensor(0.8403, device='cuda:3')
diff is  tensor(0.0076, device='cuda:3')
diff is  tensor(15.4324, device='cuda:3')
diff is  tensor(0.0162, device='cuda:3')
diff is  tensor(133.6998, device='cuda:3')
diff is  tensor(0.0201, device='cuda:3')
diff is  tensor(0.3546, device='cuda:3')
diff is  tensor(0.0020, device='cuda:3')
threshold is  tensor(81.4164, device='cuda:3')
sum is tensor(0.0020, device='cuda:3')
sum is tensor(0.0097, device='cuda:3')
sum is tensor(0.0259, device='cuda:3')
sum is tensor(0.0461, device='cuda:3')
sum is tensor(0.4006, device='cuda:3')
sum is tensor(1.2409, device='cuda:3')
sum is tensor(16.6733, device='cuda:3')
sum is tensor(150.3732, device='cuda:3')
ratio is tensor(0.5158, device='cuda:3')
threshold is tensor(133.6998, device='cuda:3')
cal diff is tensor(0.8403, device='cuda:3')
discard
cal diff is tensor(0.0076, device='cuda:3')
discard
cal diff is tensor(15.4324, device='cuda:3')
discard
cal diff is tensor(0.0162, device='cuda:3')
discard
cal diff is tensor(133.6998, device='cuda:3')
clipping
cal diff is tensor(0.0201, device='cuda:3')
discard
cal diff is tensor(0.3546, device='cuda:3')
discard
cal diff is tensor(0.0020, device='cuda:3')
discard
________________________________
test distance is  tensor(68.9748, device='cuda:3')
test acc is  0.8861166668229885
test entropy is  0.28104632689373327
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.28104632689373327
avg test loss is  0.32386730738413105
avg accuracy is  0.8861166668229885
compute_distance is  tensor(68.9748, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3505383601416149
avg test loss is  3.9362523334621113
avg accuracy is  0.3124000001563398
compute_distance is  tensor(150.4143, device='cuda:3')
++++++++++++++++++++
reach max round
new distance ratio is 0.6761833208114197
the length of epoch_weights is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 95.19% 

Test Accuracy: 94.20% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004740788601338863
attack res is False
len of model dicts is  10
compute distance is  tensor(28.1793, device='cuda:3')
compute distance is  tensor(32.0949, device='cuda:3')
compute distance is  tensor(52.6512, device='cuda:3')
compute distance is  tensor(59.2464, device='cuda:3')
compute distance is  tensor(47.0838, device='cuda:3')
compute distance is  tensor(28.3131, device='cuda:3')
compute distance is  tensor(48.5503, device='cuda:3')
compute distance is  tensor(40.1976, device='cuda:3')
compute distance is  tensor(55.7046, device='cuda:3')
compute distance is  tensor(10.3694, device='cuda:3')
calculated distance threshold is  tensor(40.4147, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.3609333334896739
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2448000001563381
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5214666668230088
====================
====================
iteration is  1
round is  0
accuracy is  0.536216666823009
====================
====================
iteration is  1
round is  1
accuracy is  0.3341000001563402
====================
________________________________
test distance is  tensor(4283.1401, device='cuda:3')
test acc is  0.2448000001563381
test entropy is  0.2056856395752191
________________________________
diff is  tensor(42.6063, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4002, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.8458, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4836, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.3844, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0114, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2196, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4242.7256, device='cuda:3')
sum is tensor(0.1888, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5890, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0726, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0841, device='cuda:3', dtype=torch.float64)
sum is tensor(23.3037, device='cuda:3', dtype=torch.float64)
sum is tensor(65.9100, device='cuda:3', dtype=torch.float64)
sum is tensor(640.7558, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.1402, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0111, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.3844, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.6063, device='cuda:3')
discard
cal diff is tensor(0.4002, device='cuda:3')
discard
cal diff is tensor(574.8458, device='cuda:3')
discard
cal diff is tensor(0.4836, device='cuda:3')
discard
cal diff is tensor(3642.3845, device='cuda:3')
clipping
cal diff is tensor(2.0114, device='cuda:3')
discard
cal diff is tensor(20.2196, device='cuda:3')
discard
cal diff is tensor(0.1888, device='cuda:3')
discard
________________________________
test distance is  tensor(40.4249, device='cuda:3')
test acc is  0.9401333334896533
test entropy is  0.13660923733330294
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(40.4147, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0102, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.0009, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(40.4147, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0774, device='cuda:3')
test acc is  0.9405833334896533
test entropy is  0.13629622084857113
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13629622084857113
avg test loss is  0.16178240527116905
avg accuracy is  0.9405833334896533
compute_distance is  tensor(0.0774, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2461878169637753
avg test loss is  9.97648773162858
avg accuracy is  0.2566500001563385
compute_distance is  tensor(107.0201, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(107.0201, device='cuda:3')
test acc is  0.2566500001563385
test entropy is  0.2461878169637753
________________________________
diff is  tensor(0.7394, device='cuda:3')
diff is  tensor(0.0073, device='cuda:3')
diff is  tensor(15.3587, device='cuda:3')
diff is  tensor(0.0173, device='cuda:3')
diff is  tensor(90.3806, device='cuda:3')
diff is  tensor(0.0414, device='cuda:3')
diff is  tensor(0.4570, device='cuda:3')
diff is  tensor(0.0039, device='cuda:3')
threshold is  tensor(66.6054, device='cuda:3')
sum is tensor(0.0039, device='cuda:3')
sum is tensor(0.0112, device='cuda:3')
sum is tensor(0.0284, device='cuda:3')
sum is tensor(0.0699, device='cuda:3')
sum is tensor(0.5268, device='cuda:3')
sum is tensor(1.2662, device='cuda:3')
sum is tensor(16.6249, device='cuda:3')
sum is tensor(107.0056, device='cuda:3')
ratio is tensor(0.4470, device='cuda:3')
threshold is tensor(90.3806, device='cuda:3')
cal diff is tensor(0.7394, device='cuda:3')
discard
cal diff is tensor(0.0073, device='cuda:3')
discard
cal diff is tensor(15.3587, device='cuda:3')
discard
cal diff is tensor(0.0173, device='cuda:3')
discard
cal diff is tensor(90.3806, device='cuda:3')
clipping
cal diff is tensor(0.0414, device='cuda:3')
discard
cal diff is tensor(0.4570, device='cuda:3')
discard
cal diff is tensor(0.0039, device='cuda:3')
discard
________________________________
test distance is  tensor(40.4124, device='cuda:3')
test acc is  0.8176500001563247
test entropy is  0.26715882020845594
________________________________
new distance ratio is 0.6147121098285634
the length of epoch_weights is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 95.08% 

Test Accuracy: 94.10% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.005171484779566526
attack res is True
len of model dicts is  10
compute distance is  tensor(31.8304, device='cuda:3')
compute distance is  tensor(25.0052, device='cuda:3')
compute distance is  tensor(37.6405, device='cuda:3')
compute distance is  tensor(62.5524, device='cuda:3')
compute distance is  tensor(45.7263, device='cuda:3')
compute distance is  tensor(32.0972, device='cuda:3')
compute distance is  tensor(68.2316, device='cuda:3')
compute distance is  tensor(40.5020, device='cuda:3')
compute distance is  tensor(81.0595, device='cuda:3')
compute distance is  tensor(9.6583, device='cuda:3')
calculated distance threshold is  tensor(57.9386, device='cuda:3')
pinned_accuracy threshold is  0.8282000001570008
====================
iteration is  0
round is  0
accuracy is  0.3366833334896736
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3448500001563404
====================
====================
iteration is  0
round is  2
accuracy is  0.3217333334896733
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.393750000156341
====================
====================
iteration is  1
round is  1
accuracy is  0.2586166668230052
====================
succ_min + 1
________________________________
test distance is  tensor(4283.1558, device='cuda:3')
test acc is  0.2586166668230052
test entropy is  0.40273103279981026
________________________________
diff is  tensor(43.0145, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3346, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.5915, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4368, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.2417, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9898, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3040, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2427, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4225.2173, device='cuda:3')
sum is tensor(0.2427, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5773, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0141, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0038, device='cuda:3', dtype=torch.float64)
sum is tensor(23.3079, device='cuda:3', dtype=torch.float64)
sum is tensor(66.3224, device='cuda:3', dtype=torch.float64)
sum is tensor(640.9139, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.1556, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0159, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.2417, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.0145, device='cuda:3')
discard
cal diff is tensor(0.3346, device='cuda:3')
discard
cal diff is tensor(574.5915, device='cuda:3')
discard
cal diff is tensor(0.4368, device='cuda:3')
discard
cal diff is tensor(3642.2417, device='cuda:3')
discard
cal diff is tensor(1.9898, device='cuda:3')
discard
cal diff is tensor(20.3040, device='cuda:3')
discard
cal diff is tensor(0.2427, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9387166668229867
test entropy is  0.13366902874770767
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13366902874770767
avg test loss is  0.16757774483343002
avg accuracy is  0.9387166668229867
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4664901765837852
avg test loss is  4.092250206831421
avg accuracy is  0.30335000015633967
compute_distance is  tensor(108.2783, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(108.2783, device='cuda:3')
test acc is  0.30335000015633967
test entropy is  0.4664901765837852
________________________________
diff is  tensor(0.8467, device='cuda:3')
diff is  tensor(0.0068, device='cuda:3')
diff is  tensor(15.0777, device='cuda:3')
diff is  tensor(0.0166, device='cuda:3')
diff is  tensor(91.8396, device='cuda:3')
diff is  tensor(0.0405, device='cuda:3')
diff is  tensor(0.4500, device='cuda:3')
diff is  tensor(0.0034, device='cuda:3')
threshold is  tensor(50.3398, device='cuda:3')
sum is tensor(0.0034, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
sum is tensor(0.0268, device='cuda:3')
sum is tensor(0.0673, device='cuda:3')
sum is tensor(0.5173, device='cuda:3')
sum is tensor(1.3641, device='cuda:3')
sum is tensor(16.4418, device='cuda:3')
sum is tensor(108.2813, device='cuda:3')
ratio is tensor(0.6309, device='cuda:3')
threshold is tensor(91.8396, device='cuda:3')
cal diff is tensor(0.8467, device='cuda:3')
discard
cal diff is tensor(0.0068, device='cuda:3')
discard
cal diff is tensor(15.0777, device='cuda:3')
discard
cal diff is tensor(0.0166, device='cuda:3')
discard
cal diff is tensor(91.8396, device='cuda:3')
clipping
cal diff is tensor(0.0405, device='cuda:3')
discard
cal diff is tensor(0.4500, device='cuda:3')
discard
cal diff is tensor(0.0034, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9449, device='cuda:3')
test acc is  0.8749333334896557
test entropy is  0.3463190232735199
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(57.9432, device='cuda:3')
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0063, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.4337, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(57.9432, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(25.1350, device='cuda:3')
test acc is  0.9414333334896533
test entropy is  0.1619457615527517
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1619457615527517
avg test loss is  0.16259235601876176
avg accuracy is  0.9414333334896533
compute_distance is  tensor(25.1350, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4639894571512747
avg test loss is  4.2122745684215
avg accuracy is  0.3008000001563395
compute_distance is  tensor(121.5263, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(121.5263, device='cuda:3')
test acc is  0.3008000001563395
test entropy is  0.4639894571512747
________________________________
diff is  tensor(0.8126, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(15.6779, device='cuda:3')
diff is  tensor(0.0173, device='cuda:3')
diff is  tensor(104.6023, device='cuda:3')
diff is  tensor(0.0305, device='cuda:3')
diff is  tensor(0.3734, device='cuda:3')
diff is  tensor(0.0026, device='cuda:3')
threshold is  tensor(63.5877, device='cuda:3')
sum is tensor(0.0026, device='cuda:3')
sum is tensor(0.0095, device='cuda:3')
sum is tensor(0.0268, device='cuda:3')
sum is tensor(0.0573, device='cuda:3')
sum is tensor(0.4307, device='cuda:3')
sum is tensor(1.2432, device='cuda:3')
sum is tensor(16.9211, device='cuda:3')
sum is tensor(121.5235, device='cuda:3')
ratio is tensor(0.5539, device='cuda:3')
threshold is tensor(104.6023, device='cuda:3')
cal diff is tensor(0.8126, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(15.6779, device='cuda:3')
discard
cal diff is tensor(0.0173, device='cuda:3')
discard
cal diff is tensor(104.6023, device='cuda:3')
clipping
cal diff is tensor(0.0305, device='cuda:3')
discard
cal diff is tensor(0.3734, device='cuda:3')
discard
cal diff is tensor(0.0026, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9409, device='cuda:3')
test acc is  0.9111166668229878
test entropy is  0.2964993514327098
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(57.9373, device='cuda:3')
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0024, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.8687, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(57.9373, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(50.3325, device='cuda:3')
test acc is  0.9269333334896538
test entropy is  0.2472995142978646
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2472995142978646
avg test loss is  0.21519611357673527
avg accuracy is  0.9269333334896538
compute_distance is  tensor(50.3325, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.462818278766263
avg test loss is  4.318811507875731
avg accuracy is  0.2969500001563395
compute_distance is  tensor(137.9147, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(137.9147, device='cuda:3')
test acc is  0.2969500001563395
test entropy is  0.462818278766263
________________________________
diff is  tensor(0.8914, device='cuda:3')
diff is  tensor(0.0076, device='cuda:3')
diff is  tensor(15.1004, device='cuda:3')
diff is  tensor(0.0157, device='cuda:3')
diff is  tensor(121.5376, device='cuda:3')
diff is  tensor(0.0249, device='cuda:3')
diff is  tensor(0.3271, device='cuda:3')
diff is  tensor(0.0021, device='cuda:3')
threshold is  tensor(79.9761, device='cuda:3')
sum is tensor(0.0021, device='cuda:3')
sum is tensor(0.0097, device='cuda:3')
sum is tensor(0.0254, device='cuda:3')
sum is tensor(0.0503, device='cuda:3')
sum is tensor(0.3774, device='cuda:3')
sum is tensor(1.2687, device='cuda:3')
sum is tensor(16.3691, device='cuda:3')
sum is tensor(137.9067, device='cuda:3')
ratio is tensor(0.4766, device='cuda:3')
threshold is tensor(121.5376, device='cuda:3')
cal diff is tensor(0.8914, device='cuda:3')
discard
cal diff is tensor(0.0076, device='cuda:3')
discard
cal diff is tensor(15.1004, device='cuda:3')
discard
cal diff is tensor(0.0157, device='cuda:3')
discard
cal diff is tensor(121.5376, device='cuda:3')
clipping
cal diff is tensor(0.0249, device='cuda:3')
discard
cal diff is tensor(0.3271, device='cuda:3')
discard
cal diff is tensor(0.0021, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9378, device='cuda:3')
test acc is  0.9241666668229872
test entropy is  0.26298938282549
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.26298938282549
avg test loss is  0.22525338671291306
avg accuracy is  0.9241666668229872
compute_distance is  tensor(57.9378, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4626638868978537
avg test loss is  4.353008763876551
avg accuracy is  0.2951166668230061
compute_distance is  tensor(144.3116, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(144.3116, device='cuda:3')
test acc is  0.2951166668230061
test entropy is  0.4626638868978537
________________________________
diff is  tensor(0.9204, device='cuda:3')
diff is  tensor(0.0078, device='cuda:3')
diff is  tensor(15.1035, device='cuda:3')
diff is  tensor(0.0156, device='cuda:3')
diff is  tensor(127.9132, device='cuda:3')
diff is  tensor(0.0241, device='cuda:3')
diff is  tensor(0.3150, device='cuda:3')
diff is  tensor(0.0020, device='cuda:3')
threshold is  tensor(86.3731, device='cuda:3')
sum is tensor(0.0020, device='cuda:3')
sum is tensor(0.0098, device='cuda:3')
sum is tensor(0.0254, device='cuda:3')
sum is tensor(0.0495, device='cuda:3')
sum is tensor(0.3645, device='cuda:3')
sum is tensor(1.2849, device='cuda:3')
sum is tensor(16.3884, device='cuda:3')
sum is tensor(144.3015, device='cuda:3')
ratio is tensor(0.4529, device='cuda:3')
threshold is tensor(127.9132, device='cuda:3')
cal diff is tensor(0.9204, device='cuda:3')
discard
cal diff is tensor(0.0078, device='cuda:3')
discard
cal diff is tensor(15.1035, device='cuda:3')
discard
cal diff is tensor(0.0156, device='cuda:3')
discard
cal diff is tensor(127.9132, device='cuda:3')
clipping
cal diff is tensor(0.0241, device='cuda:3')
discard
cal diff is tensor(0.3150, device='cuda:3')
discard
cal diff is tensor(0.0020, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9368, device='cuda:3')
test acc is  0.9281166668229871
test entropy is  0.24986113394215417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24986113394215417
avg test loss is  0.2132030066881162
avg accuracy is  0.9281166668229871
compute_distance is  tensor(57.9368, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4628749828793601
avg test loss is  4.354378341611769
avg accuracy is  0.29458333348967275
compute_distance is  tensor(145.0692, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(145.0692, device='cuda:3')
test acc is  0.29458333348967275
test entropy is  0.4628749828793601
________________________________
diff is  tensor(0.9172, device='cuda:3')
diff is  tensor(0.0078, device='cuda:3')
diff is  tensor(15.2878, device='cuda:3')
diff is  tensor(0.0158, device='cuda:3')
diff is  tensor(128.4883, device='cuda:3')
diff is  tensor(0.0246, device='cuda:3')
diff is  tensor(0.3149, device='cuda:3')
diff is  tensor(0.0021, device='cuda:3')
threshold is  tensor(87.1306, device='cuda:3')
sum is tensor(0.0021, device='cuda:3')
sum is tensor(0.0099, device='cuda:3')
sum is tensor(0.0257, device='cuda:3')
sum is tensor(0.0503, device='cuda:3')
sum is tensor(0.3651, device='cuda:3')
sum is tensor(1.2824, device='cuda:3')
sum is tensor(16.5701, device='cuda:3')
sum is tensor(145.0584, device='cuda:3')
ratio is tensor(0.4508, device='cuda:3')
threshold is tensor(128.4883, device='cuda:3')
cal diff is tensor(0.9172, device='cuda:3')
discard
cal diff is tensor(0.0078, device='cuda:3')
discard
cal diff is tensor(15.2878, device='cuda:3')
discard
cal diff is tensor(0.0158, device='cuda:3')
discard
cal diff is tensor(128.4883, device='cuda:3')
clipping
cal diff is tensor(0.0246, device='cuda:3')
discard
cal diff is tensor(0.3149, device='cuda:3')
discard
cal diff is tensor(0.0021, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9367, device='cuda:3')
test acc is  0.9287500001563205
test entropy is  0.24636307142690808
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24636307142690808
avg test loss is  0.21026049453074108
avg accuracy is  0.9287500001563205
compute_distance is  tensor(57.9367, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4629537800132339
avg test loss is  4.356670472413492
avg accuracy is  0.2944666668230061
compute_distance is  tensor(145.3055, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(145.3055, device='cuda:3')
test acc is  0.2944666668230061
test entropy is  0.4629537800132339
________________________________
diff is  tensor(0.9158, device='cuda:3')
diff is  tensor(0.0078, device='cuda:3')
diff is  tensor(15.3432, device='cuda:3')
diff is  tensor(0.0159, device='cuda:3')
diff is  tensor(128.6703, device='cuda:3')
diff is  tensor(0.0247, device='cuda:3')
diff is  tensor(0.3145, device='cuda:3')
diff is  tensor(0.0021, device='cuda:3')
threshold is  tensor(87.3670, device='cuda:3')
sum is tensor(0.0021, device='cuda:3')
sum is tensor(0.0099, device='cuda:3')
sum is tensor(0.0258, device='cuda:3')
sum is tensor(0.0505, device='cuda:3')
sum is tensor(0.3650, device='cuda:3')
sum is tensor(1.2808, device='cuda:3')
sum is tensor(16.6240, device='cuda:3')
sum is tensor(145.2943, device='cuda:3')
ratio is tensor(0.4502, device='cuda:3')
threshold is tensor(128.6703, device='cuda:3')
cal diff is tensor(0.9158, device='cuda:3')
discard
cal diff is tensor(0.0078, device='cuda:3')
discard
cal diff is tensor(15.3432, device='cuda:3')
discard
cal diff is tensor(0.0159, device='cuda:3')
discard
cal diff is tensor(128.6703, device='cuda:3')
clipping
cal diff is tensor(0.0247, device='cuda:3')
discard
cal diff is tensor(0.3145, device='cuda:3')
discard
cal diff is tensor(0.0021, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9366, device='cuda:3')
test acc is  0.9290666668229871
test entropy is  0.2449213514434122
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2449213514434122
avg test loss is  0.2091355602195395
avg accuracy is  0.9290666668229871
compute_distance is  tensor(57.9366, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.46315393140956534
avg test loss is  4.357354890563086
avg accuracy is  0.29445000015633943
compute_distance is  tensor(145.3951, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(145.3951, device='cuda:3')
test acc is  0.29445000015633943
test entropy is  0.46315393140956534
________________________________
diff is  tensor(0.9148, device='cuda:3')
diff is  tensor(0.0078, device='cuda:3')
diff is  tensor(15.3633, device='cuda:3')
diff is  tensor(0.0159, device='cuda:3')
diff is  tensor(128.7411, device='cuda:3')
diff is  tensor(0.0248, device='cuda:3')
diff is  tensor(0.3137, device='cuda:3')
diff is  tensor(0.0021, device='cuda:3')
threshold is  tensor(87.4565, device='cuda:3')
sum is tensor(0.0021, device='cuda:3')
sum is tensor(0.0099, device='cuda:3')
sum is tensor(0.0258, device='cuda:3')
sum is tensor(0.0506, device='cuda:3')
sum is tensor(0.3643, device='cuda:3')
sum is tensor(1.2791, device='cuda:3')
sum is tensor(16.6424, device='cuda:3')
sum is tensor(145.3836, device='cuda:3')
ratio is tensor(0.4499, device='cuda:3')
threshold is tensor(128.7411, device='cuda:3')
cal diff is tensor(0.9148, device='cuda:3')
discard
cal diff is tensor(0.0078, device='cuda:3')
discard
cal diff is tensor(15.3633, device='cuda:3')
discard
cal diff is tensor(0.0159, device='cuda:3')
discard
cal diff is tensor(128.7411, device='cuda:3')
clipping
cal diff is tensor(0.0248, device='cuda:3')
discard
cal diff is tensor(0.3137, device='cuda:3')
discard
cal diff is tensor(0.0021, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9365, device='cuda:3')
test acc is  0.9292333334896538
test entropy is  0.2441660945397069
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2441660945397069
avg test loss is  0.2085424220558804
avg accuracy is  0.9292333334896538
compute_distance is  tensor(57.9365, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4631879143972895
avg test loss is  4.358599975673375
avg accuracy is  0.29426666682300606
compute_distance is  tensor(145.4381, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(145.4381, device='cuda:3')
test acc is  0.29426666682300606
test entropy is  0.4631879143972895
________________________________
diff is  tensor(0.9146, device='cuda:3')
diff is  tensor(0.0078, device='cuda:3')
diff is  tensor(15.3766, device='cuda:3')
diff is  tensor(0.0159, device='cuda:3')
diff is  tensor(128.7717, device='cuda:3')
diff is  tensor(0.0248, device='cuda:3')
diff is  tensor(0.3131, device='cuda:3')
diff is  tensor(0.0021, device='cuda:3')
threshold is  tensor(87.4996, device='cuda:3')
sum is tensor(0.0021, device='cuda:3')
sum is tensor(0.0099, device='cuda:3')
sum is tensor(0.0258, device='cuda:3')
sum is tensor(0.0506, device='cuda:3')
sum is tensor(0.3637, device='cuda:3')
sum is tensor(1.2782, device='cuda:3')
sum is tensor(16.6548, device='cuda:3')
sum is tensor(145.4265, device='cuda:3')
ratio is tensor(0.4498, device='cuda:3')
threshold is tensor(128.7717, device='cuda:3')
cal diff is tensor(0.9146, device='cuda:3')
discard
cal diff is tensor(0.0078, device='cuda:3')
discard
cal diff is tensor(15.3766, device='cuda:3')
discard
cal diff is tensor(0.0159, device='cuda:3')
discard
cal diff is tensor(128.7717, device='cuda:3')
clipping
cal diff is tensor(0.0248, device='cuda:3')
discard
cal diff is tensor(0.3131, device='cuda:3')
discard
cal diff is tensor(0.0021, device='cuda:3')
discard
________________________________
test distance is  tensor(57.9365, device='cuda:3')
test acc is  0.9293000001563204
test entropy is  0.2437300034788753
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2437300034788753
avg test loss is  0.20825163381440298
avg accuracy is  0.9293000001563204
compute_distance is  tensor(57.9365, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4632927738368384
avg test loss is  4.359774686380236
avg accuracy is  0.2940500001563394
compute_distance is  tensor(145.4579, device='cuda:3')
++++++++++++++++++++
reach max round
new distance ratio is 0.6147121098285634
the length of epoch_weights is  3
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 95.87% 

Test Accuracy: 94.92% 

 
 Results after 40 global rounds of training:
|---- Avg testing Accuracy across each device's data: 95.87%
|----0th round Training Accuracy : 30.83%
|----1th round Training Accuracy : 69.27%
|----2th round Training Accuracy : 74.41%
|----3th round Training Accuracy : 89.87%
|----4th round Training Accuracy : 89.74%
|----5th round Training Accuracy : 93.82%
|----6th round Training Accuracy : 91.29%
|----7th round Training Accuracy : 95.19%
|----8th round Training Accuracy : 94.78%
|----9th round Training Accuracy : 95.76%
|----10th round Training Accuracy : 94.05%
|----11th round Training Accuracy : 96.56%
|----12th round Training Accuracy : 95.94%
|----13th round Training Accuracy : 96.58%
|----14th round Training Accuracy : 96.88%
|----15th round Training Accuracy : 96.99%
|----16th round Training Accuracy : 96.89%
|----17th round Training Accuracy : 97.16%
|----18th round Training Accuracy : 97.08%
|----19th round Training Accuracy : 97.38%
|----20th round Training Accuracy : 97.43%
|----21th round Training Accuracy : 97.48%
|----22th round Training Accuracy : 97.32%
|----23th round Training Accuracy : 97.51%
|----24th round Training Accuracy : 97.56%
|----25th round Training Accuracy : 97.56%
|----26th round Training Accuracy : 97.65%
|----27th round Training Accuracy : 97.81%
|----28th round Training Accuracy : 97.69%
|----29th round Training Accuracy : 97.81%
|----30th round Training Accuracy : 96.38%
|----31th round Training Accuracy : 96.22%
|----32th round Training Accuracy : 95.99%
|----33th round Training Accuracy : 95.61%
|----34th round Training Accuracy : 95.72%
|----35th round Training Accuracy : 96.06%
|----36th round Training Accuracy : 95.43%
|----37th round Training Accuracy : 95.19%
|----38th round Training Accuracy : 95.08%
|----39th round Training Accuracy : 95.87%
|----Final Test Accuracy: 94.92%
|----0th round Final Test Accuracy : 36.87%
|----1th round Final Test Accuracy : 68.73%
|----2th round Final Test Accuracy : 76.74%
|----3th round Final Test Accuracy : 90.44%
|----4th round Final Test Accuracy : 90.37%
|----5th round Final Test Accuracy : 94.15%
|----6th round Final Test Accuracy : 91.99%
|----7th round Final Test Accuracy : 95.22%
|----8th round Final Test Accuracy : 95.35%
|----9th round Final Test Accuracy : 95.67%
|----10th round Final Test Accuracy : 94.73%
|----11th round Final Test Accuracy : 96.52%
|----12th round Final Test Accuracy : 96.22%
|----13th round Final Test Accuracy : 96.61%
|----14th round Final Test Accuracy : 97.02%
|----15th round Final Test Accuracy : 97.02%
|----16th round Final Test Accuracy : 97.11%
|----17th round Final Test Accuracy : 97.36%
|----18th round Final Test Accuracy : 97.32%
|----19th round Final Test Accuracy : 97.33%
|----20th round Final Test Accuracy : 97.44%
|----21th round Final Test Accuracy : 97.35%
|----22th round Final Test Accuracy : 97.32%
|----23th round Final Test Accuracy : 97.59%
|----24th round Final Test Accuracy : 97.53%
|----25th round Final Test Accuracy : 97.56%
|----26th round Final Test Accuracy : 97.67%
|----27th round Final Test Accuracy : 97.79%
|----28th round Final Test Accuracy : 97.68%
|----29th round Final Test Accuracy : 97.82%
|----30th round Final Test Accuracy : 95.89%
|----31th round Final Test Accuracy : 95.45%
|----32th round Final Test Accuracy : 95.12%
|----33th round Final Test Accuracy : 94.67%
|----34th round Final Test Accuracy : 94.80%
|----35th round Final Test Accuracy : 95.22%
|----36th round Final Test Accuracy : 94.60%
|----37th round Final Test Accuracy : 94.20%
|----38th round Final Test Accuracy : 94.10%
|----39th round Final Test Accuracy : 94.92%

Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 40

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 5095.8627
