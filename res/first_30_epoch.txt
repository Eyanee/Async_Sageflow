
Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
CNNMnist(
  (conv1): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (conv2): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (fc1): Linear(in_features=3136, out_features=1024, bias=True)
  (fc2): Linear(in_features=1024, out_features=10, bias=True)
)
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 10, 11, 12, 13, 14, 15]
left index is  [17, 18, 19, 20, 21, 22, 23]
left index is  [25, 26, 27, 28, 29, 30, 31]
left index is  [32, 33, 34, 35, 36, 37, 39]
left index is  [0, 1, 2, 4, 5, 6, 7, 41, 42, 43, 44, 45, 46, 47, 48]
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 40.78% 

Test Accuracy: 46.90% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 3, 4, 5, 6, 41, 42, 43, 44, 45, 46, 47, 48]
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 59.79% 

Test Accuracy: 63.85% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 10, 11, 12, 14, 15]
left index is  [0, 2, 3, 4, 5, 6, 7, 40, 41, 43, 44, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 74.36% 

Test Accuracy: 76.60% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 48]
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 85.53% 

Test Accuracy: 85.61% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 10, 11, 12, 13, 15]
left index is  [24, 25, 26, 28, 29, 30, 31]
left index is  [1, 2, 3, 4, 5, 6, 7, 40, 41, 43, 44, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 81.98% 

Test Accuracy: 83.92% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [32, 33, 34, 36, 37, 38, 39]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  2
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 92.90% 

Test Accuracy: 92.82% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 10, 11, 12, 14, 15]
left index is  [16, 17, 18, 19, 21, 22, 23]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48]
the length of epoch_weights is  0
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 82.40% 

Test Accuracy: 83.52% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 48]
the length of epoch_weights is  2
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 92.11% 

Test Accuracy: 91.90% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [24, 25, 26, 28, 29, 30, 31]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 91.03% 

Test Accuracy: 92.24% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [16, 17, 18, 19, 20, 21, 23]
left index is  [0, 1, 2, 4, 5, 6, 40, 41, 42, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 93.27% 

Test Accuracy: 93.03% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [32, 34, 35, 36, 37, 38, 39]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 94.00% 

Test Accuracy: 94.33% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  3
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 96.09% 

Test Accuracy: 95.96% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [16, 17, 18, 19, 20, 21, 23]
left index is  [24, 26, 27, 28, 29, 30, 31]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 95.67% 

Test Accuracy: 95.63% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  1
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 95.98% 

Test Accuracy: 96.14% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 10, 11, 12, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 96.27% 

Test Accuracy: 96.37% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [16, 17, 18, 19, 20, 21, 23]
left index is  [32, 33, 34, 35, 36, 37, 39]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  2
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 96.56% 

Test Accuracy: 96.65% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 10, 11, 12, 13, 14, 15]
left index is  [24, 25, 27, 28, 29, 30, 31]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 96.30% 

Test Accuracy: 96.49% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 96.76% 

Test Accuracy: 96.88% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [16, 17, 18, 19, 21, 22, 23]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 96.95% 

Test Accuracy: 96.79% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48]
the length of epoch_weights is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 97.10% 

Test Accuracy: 96.94% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [24, 26, 27, 28, 29, 30, 31]
left index is  [32, 33, 34, 36, 37, 38, 39]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 44, 45, 46, 47, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 97.17% 

Test Accuracy: 97.06% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [16, 17, 18, 19, 21, 22, 23]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 97.19% 

Test Accuracy: 97.11% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 97.16% 

Test Accuracy: 96.93% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 47, 49]
the length of epoch_weights is  3
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 97.35% 

Test Accuracy: 97.24% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 10, 11, 12, 14, 15]
left index is  [16, 17, 18, 19, 20, 21, 23]
left index is  [24, 26, 27, 28, 29, 30, 31]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 97.14% 

Test Accuracy: 97.08% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [32, 34, 35, 36, 37, 38, 39]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 97.32% 

Test Accuracy: 97.21% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 9, 10, 11, 12, 14, 15]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 97.45% 

Test Accuracy: 97.36% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [17, 18, 19, 20, 21, 22, 23]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 97.53% 

Test Accuracy: 97.46% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [8, 10, 11, 12, 13, 14, 15]
left index is  [24, 26, 27, 28, 29, 30, 31]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 97.46% 

Test Accuracy: 97.35% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47]
the length of epoch_weights is  3
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 97.59% 

Test Accuracy: 97.47% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
poisoned accuracy threshold is  0.8747000001570008
distance ratio is <class 'float'>
len of model dicts is  10
compute distance is  tensor(26.0511, device='cuda:0')
compute distance is  tensor(24.9670, device='cuda:0')
compute distance is  tensor(84.3429, device='cuda:0')
compute distance is  tensor(53.2661, device='cuda:0')
compute distance is  tensor(33.8817, device='cuda:0')
compute distance is  tensor(22.1957, device='cuda:0')
compute distance is  tensor(49.7322, device='cuda:0')
compute distance is  tensor(34.3806, device='cuda:0')
compute distance is  tensor(102.5072, device='cuda:0')
compute distance is  tensor(64.7034, device='cuda:0')
calculated distance threshold is  tensor(86.4449, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.973300000156319
====================
====================
iteration is  0
round is  1
accuracy is  0.9728833334896523
====================
====================
iteration is  0
round is  2
accuracy is  0.9738000001563188
====================
====================
iteration is  1
round is  0
accuracy is  0.9731833334896524
====================
====================
iteration is  1
round is  1
accuracy is  0.9738500001563188
====================
====================
iteration is  1
round is  2
accuracy is  0.9732333334896524
====================
====================
iteration is  2
round is  0
accuracy is  0.9730000001563189
====================
====================
iteration is  2
round is  1
accuracy is  0.9723333334896523
====================
====================
iteration is  2
round is  2
accuracy is  0.9740833334896521
====================
====================
iteration is  3
round is  0
accuracy is  0.9730000001563189
====================
====================
iteration is  3
round is  1
accuracy is  0.9738666668229855
====================
====================
iteration is  3
round is  2
accuracy is  0.972700000156319
====================
====================
iteration is  4
round is  0
accuracy is  0.9729166668229856
====================
====================
iteration is  4
round is  1
accuracy is  0.9733166668229857
====================
====================
iteration is  4
round is  2
accuracy is  0.973500000156319
====================
====================
iteration is  5
round is  0
accuracy is  0.9736833334896522
====================
====================
iteration is  5
round is  1
accuracy is  0.9728166668229856
====================
====================
iteration is  5
round is  2
accuracy is  0.9719500001563189
====================
====================
iteration is  6
round is  0
accuracy is  0.9723333334896523
====================
====================
iteration is  6
round is  1
accuracy is  0.9699333334896523
====================
====================
iteration is  6
round is  2
accuracy is  0.9718666668229856
====================
====================
iteration is  7
round is  0
accuracy is  0.971350000156319
====================
====================
iteration is  7
round is  1
accuracy is  0.9724666668229857
====================
====================
iteration is  7
round is  2
accuracy is  0.9694500001563191
====================
====================
iteration is  8
round is  0
accuracy is  0.9695000001563191
====================
====================
iteration is  8
round is  1
accuracy is  0.972350000156319
====================
====================
iteration is  8
round is  2
accuracy is  0.9696333334896524
====================
====================
iteration is  9
round is  0
accuracy is  0.9695333334896524
====================
====================
iteration is  9
round is  1
accuracy is  0.9707166668229856
====================
====================
iteration is  9
round is  2
accuracy is  0.970350000156319
====================
====================
iteration is  10
round is  0
accuracy is  0.9689666668229857
====================
====================
iteration is  10
round is  1
accuracy is  0.9657500001563192
====================
====================
iteration is  10
round is  2
accuracy is  0.9675000001563191
====================
====================
iteration is  11
round is  0
accuracy is  0.9670333334896525
====================
====================
iteration is  11
round is  1
accuracy is  0.9687166668229857
====================
====================
iteration is  11
round is  2
accuracy is  0.9682500001563191
====================
====================
iteration is  12
round is  0
accuracy is  0.9629333334896526
====================
====================
iteration is  12
round is  1
accuracy is  0.9586000001563194
====================
====================
iteration is  12
round is  2
accuracy is  0.9639166668229859
====================
====================
iteration is  13
round is  0
accuracy is  0.960216666822986
====================
====================
iteration is  13
round is  1
accuracy is  0.9597333334896527
====================
====================
iteration is  13
round is  2
accuracy is  0.9498666668229864
====================
====================
iteration is  14
round is  0
accuracy is  0.9326666668229868
====================
====================
iteration is  14
round is  1
accuracy is  0.9622666668229859
====================
====================
iteration is  14
round is  2
accuracy is  0.948283333489653
====================
====================
iteration is  15
round is  0
accuracy is  0.9266666668229872
====================
====================
iteration is  15
round is  1
accuracy is  0.9509333334896529
====================
====================
iteration is  15
round is  2
accuracy is  0.950833333489653
====================
====================
iteration is  16
round is  0
accuracy is  0.9238500001563206
====================
====================
iteration is  16
round is  1
accuracy is  0.9358333334896535
====================
====================
iteration is  16
round is  2
accuracy is  0.9460333334896531
====================
====================
iteration is  17
round is  0
accuracy is  0.914200000156321
====================
====================
iteration is  17
round is  1
accuracy is  0.9053500001563212
====================
====================
iteration is  17
round is  2
accuracy is  0.9193000001563209
====================
====================
iteration is  18
round is  0
accuracy is  0.9062000001563212
====================
====================
iteration is  18
round is  1
accuracy is  0.883800000156322
====================
====================
iteration is  18
round is  2
accuracy is  0.8851166668229885
====================
====================
iteration is  19
round is  0
accuracy is  0.8714333334896558
====================
succ_min + 1
====================
iteration is  19
round is  1
accuracy is  0.7027000001563306
====================
succ_min + 1
====================
iteration is  19
round is  2
accuracy is  0.8866833334896552
====================
====================
iteration is  20
round is  0
accuracy is  0.6406666668230013
====================
succ_min + 1
====================
iteration is  20
round is  1
accuracy is  0.6893166668229981
====================
====================
iteration is  20
round is  2
accuracy is  0.669033333489666
====================
________________________________
test distance is  tensor(2880.1174, device='cuda:0')
test acc is  0.6406666668230013
test entropy is  0.5034365949155425
________________________________
diff is  tensor(29.4685, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2255, device='cuda:0', dtype=torch.float64)
diff is  tensor(385.2335, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3337, device='cuda:0', dtype=torch.float64)
diff is  tensor(2449.6762, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3899, device='cuda:0', dtype=torch.float64)
diff is  tensor(13.6644, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1259, device='cuda:0', dtype=torch.float64)
threshold is  tensor(2793.6726, device='cuda:0')
sum is tensor(0.1259, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3514, device='cuda:0', dtype=torch.float64)
sum is tensor(0.6851, device='cuda:0', dtype=torch.float64)
sum is tensor(2.0750, device='cuda:0', dtype=torch.float64)
sum is tensor(15.7393, device='cuda:0', dtype=torch.float64)
sum is tensor(45.2078, device='cuda:0', dtype=torch.float64)
sum is tensor(430.4414, device='cuda:0', dtype=torch.float64)
sum is tensor(2880.1176, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0353, device='cuda:0', dtype=torch.float64)
threshold is tensor(2449.6762, device='cuda:0', dtype=torch.float64)
cal diff is tensor(29.4685, device='cuda:0')
discard
cal diff is tensor(0.2255, device='cuda:0')
discard
cal diff is tensor(385.2335, device='cuda:0')
discard
cal diff is tensor(0.3337, device='cuda:0')
discard
cal diff is tensor(2449.6763, device='cuda:0')
clipping
cal diff is tensor(1.3899, device='cuda:0')
discard
cal diff is tensor(13.6644, device='cuda:0')
discard
cal diff is tensor(0.1259, device='cuda:0')
discard
________________________________
test distance is  tensor(86.4552, device='cuda:0')
test acc is  0.9744166668229856
test entropy is  0.12541827125582042
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(86.4450, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0104, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
sum is tensor(86.4552, device='cuda:0')
ratio is tensor(1.0000, device='cuda:0', dtype=torch.float64)
threshold is tensor(86.4450, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
discard
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(86.4450, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(86.4551, device='cuda:0')
test acc is  0.9744166668229856
test entropy is  0.1254182943959099
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(86.4449, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0102, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
ratio is tensor(0.0004, device='cuda:0')
threshold is tensor(0.0091, device='cuda:0')
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
clipping
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(86.4449, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0793, device='cuda:0')
test acc is  0.9745000001563189
test entropy is  0.12476068873728897
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12476068873728897
avg test loss is  0.08319696412781186
avg accuracy is  0.9745000001563189
compute_distance is  tensor(0.0793, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4882044696540975
avg test loss is  1.0342121831199
avg accuracy is  0.6542000001563337
compute_distance is  tensor(77.1971, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(77.1971, device='cuda:0')
test acc is  0.6542000001563337
test entropy is  0.4882044696540975
________________________________
out distance ratio is 0.8
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [16, 17, 18, 19, 21, 22, 23]
left index is  [32, 34, 35, 36, 37, 38, 39]
left index is  [0, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 95.22% 

Test Accuracy: 94.09% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0008562359143979847
len of model dicts is  10
compute distance is  tensor(25.7209, device='cuda:0')
compute distance is  tensor(43.3087, device='cuda:0')
compute distance is  tensor(78.4189, device='cuda:0')
compute distance is  tensor(50.9498, device='cuda:0')
compute distance is  tensor(40.9350, device='cuda:0')
compute distance is  tensor(22.9093, device='cuda:0')
compute distance is  tensor(71.3099, device='cuda:0')
compute distance is  tensor(37.4271, device='cuda:0')
compute distance is  tensor(77.0002, device='cuda:0')
compute distance is  tensor(18.9911, device='cuda:0')
calculated distance threshold is  tensor(66.5333, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.930366666822987
====================
====================
iteration is  0
round is  1
accuracy is  0.9357333334896535
====================
====================
iteration is  0
round is  2
accuracy is  0.9409333334896532
====================
====================
iteration is  1
round is  0
accuracy is  0.9359833334896536
====================
====================
iteration is  1
round is  1
accuracy is  0.9343166668229869
====================
====================
iteration is  1
round is  2
accuracy is  0.9433833334896532
====================
====================
iteration is  2
round is  0
accuracy is  0.9366000001563201
====================
====================
iteration is  2
round is  1
accuracy is  0.9395666668229866
====================
====================
iteration is  2
round is  2
accuracy is  0.9229166668229872
====================
====================
iteration is  3
round is  0
accuracy is  0.9272833334896537
====================
====================
iteration is  3
round is  1
accuracy is  0.9370000001563201
====================
====================
iteration is  3
round is  2
accuracy is  0.9329166668229869
====================
====================
iteration is  4
round is  0
accuracy is  0.9329166668229869
====================
====================
iteration is  4
round is  1
accuracy is  0.921783333489654
====================
====================
iteration is  4
round is  2
accuracy is  0.929516666822987
====================
====================
iteration is  5
round is  0
accuracy is  0.9396666668229866
====================
====================
iteration is  5
round is  1
accuracy is  0.9306833334896536
====================
====================
iteration is  5
round is  2
accuracy is  0.9340500001563202
====================
====================
iteration is  6
round is  0
accuracy is  0.9226000001563207
====================
====================
iteration is  6
round is  1
accuracy is  0.9382166668229868
====================
====================
iteration is  6
round is  2
accuracy is  0.9444333334896532
====================
====================
iteration is  7
round is  0
accuracy is  0.931766666822987
====================
====================
iteration is  7
round is  1
accuracy is  0.9497166668229864
====================
====================
iteration is  7
round is  2
accuracy is  0.9247500001563206
====================
====================
iteration is  8
round is  0
accuracy is  0.9172500001563207
====================
====================
iteration is  8
round is  1
accuracy is  0.9256000001563204
====================
====================
iteration is  8
round is  2
accuracy is  0.9377666668229867
====================
====================
iteration is  9
round is  0
accuracy is  0.9138833334896541
====================
====================
iteration is  9
round is  1
accuracy is  0.9204500001563207
====================
====================
iteration is  9
round is  2
accuracy is  0.9353000001563201
====================
====================
iteration is  10
round is  0
accuracy is  0.9181500001563206
====================
====================
iteration is  10
round is  1
accuracy is  0.916483333489654
====================
====================
iteration is  10
round is  2
accuracy is  0.899316666822988
====================
====================
iteration is  11
round is  0
accuracy is  0.9143500001563208
====================
====================
iteration is  11
round is  1
accuracy is  0.9051500001563212
====================
====================
iteration is  11
round is  2
accuracy is  0.9259666668229871
====================
====================
iteration is  12
round is  0
accuracy is  0.9252500001563204
====================
====================
iteration is  12
round is  1
accuracy is  0.9287000001563203
====================
====================
iteration is  12
round is  2
accuracy is  0.9349666668229869
====================
====================
iteration is  13
round is  0
accuracy is  0.9267000001563205
====================
====================
iteration is  13
round is  1
accuracy is  0.920183333489654
====================
====================
iteration is  13
round is  2
accuracy is  0.893933333489655
====================
====================
iteration is  14
round is  0
accuracy is  0.9160333334896541
====================
====================
iteration is  14
round is  1
accuracy is  0.9240833334896539
====================
====================
iteration is  14
round is  2
accuracy is  0.9017666668229879
====================
====================
iteration is  15
round is  0
accuracy is  0.8742833334896557
====================
succ_min + 1
====================
iteration is  15
round is  1
accuracy is  0.9215166668229873
====================
====================
iteration is  15
round is  2
accuracy is  0.868533333489656
====================
succ_min + 1
====================
iteration is  16
round is  0
accuracy is  0.8573166668229897
====================
succ_min + 1
====================
iteration is  16
round is  1
accuracy is  0.9187500001563207
====================
====================
iteration is  16
round is  2
accuracy is  0.8981833334896548
====================
====================
iteration is  17
round is  0
accuracy is  0.9080333334896544
====================
====================
iteration is  17
round is  1
accuracy is  0.820483333489658
====================
succ_min + 1
====================
iteration is  17
round is  2
accuracy is  0.8348333334896572
====================
________________________________
test distance is  tensor(2163.1418, device='cuda:0')
test acc is  0.820483333489658
test entropy is  0.3930718795990131
________________________________
diff is  tensor(21.6766, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1683, device='cuda:0', dtype=torch.float64)
diff is  tensor(288.6318, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2675, device='cuda:0', dtype=torch.float64)
diff is  tensor(1841.0325, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.0326, device='cuda:0', dtype=torch.float64)
diff is  tensor(10.2499, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0826, device='cuda:0', dtype=torch.float64)
threshold is  tensor(2096.6084, device='cuda:0')
sum is tensor(0.0826, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2509, device='cuda:0', dtype=torch.float64)
sum is tensor(0.5184, device='cuda:0', dtype=torch.float64)
sum is tensor(1.5511, device='cuda:0', dtype=torch.float64)
sum is tensor(11.8010, device='cuda:0', dtype=torch.float64)
sum is tensor(33.4776, device='cuda:0', dtype=torch.float64)
sum is tensor(322.1094, device='cuda:0', dtype=torch.float64)
sum is tensor(2163.1419, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0361, device='cuda:0', dtype=torch.float64)
threshold is tensor(1841.0325, device='cuda:0', dtype=torch.float64)
cal diff is tensor(21.6766, device='cuda:0')
discard
cal diff is tensor(0.1683, device='cuda:0')
discard
cal diff is tensor(288.6318, device='cuda:0')
discard
cal diff is tensor(0.2675, device='cuda:0')
discard
cal diff is tensor(1841.0325, device='cuda:0')
discard
cal diff is tensor(1.0326, device='cuda:0')
discard
cal diff is tensor(10.2499, device='cuda:0')
discard
cal diff is tensor(0.0826, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.9400333334896532
test entropy is  0.1623628789991903
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1623628789991903
avg test loss is  0.15758041683425592
avg accuracy is  0.9400333334896532
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3639189504992479
avg test loss is  0.4965310367757578
avg accuracy is  0.8323333334896575
compute_distance is  tensor(68.5143, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(68.5143, device='cuda:0')
test acc is  0.8323333334896575
test entropy is  0.3639189504992479
________________________________
diff is  tensor(0.5013, device='cuda:0')
diff is  tensor(0.0036, device='cuda:0')
diff is  tensor(7.5263, device='cuda:0')
diff is  tensor(0.0080, device='cuda:0')
diff is  tensor(60.1395, device='cuda:0')
diff is  tensor(0.0216, device='cuda:0')
diff is  tensor(0.3084, device='cuda:0')
diff is  tensor(0.0014, device='cuda:0')
threshold is  tensor(1.9810, device='cuda:0')
sum is tensor(0.0014, device='cuda:0')
sum is tensor(0.0050, device='cuda:0')
sum is tensor(0.0130, device='cuda:0')
sum is tensor(0.0346, device='cuda:0')
sum is tensor(0.3429, device='cuda:0')
sum is tensor(0.8442, device='cuda:0')
sum is tensor(8.3706, device='cuda:0')
ratio is tensor(0.8490, device='cuda:0')
threshold is tensor(7.5263, device='cuda:0')
cal diff is tensor(0.5013, device='cuda:0')
discard
cal diff is tensor(0.0036, device='cuda:0')
discard
cal diff is tensor(7.5263, device='cuda:0')
clipping
cal diff is tensor(0.0080, device='cuda:0')
discard
cal diff is tensor(60.1395, device='cuda:0')
clipping
cal diff is tensor(0.0216, device='cuda:0')
discard
cal diff is tensor(0.3084, device='cuda:0')
discard
cal diff is tensor(0.0014, device='cuda:0')
discard
________________________________
test distance is  tensor(57.4510, device='cuda:0')
test acc is  0.8691000001563226
test entropy is  0.29000442311453667
________________________________
out distance ratio is 0.8
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 94.59% 

Test Accuracy: 93.49% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0005425831768661737
len of model dicts is  10
compute distance is  tensor(28.0182, device='cuda:0')
compute distance is  tensor(42.8924, device='cuda:0')
compute distance is  tensor(75.5043, device='cuda:0')
compute distance is  tensor(43.5662, device='cuda:0')
compute distance is  tensor(42.6594, device='cuda:0')
compute distance is  tensor(23.5844, device='cuda:0')
compute distance is  tensor(59.8450, device='cuda:0')
compute distance is  tensor(43.7317, device='cuda:0')
compute distance is  tensor(102.9078, device='cuda:0')
compute distance is  tensor(21.1051, device='cuda:0')
calculated distance threshold is  tensor(86.5472, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.93690000015632
====================
====================
iteration is  0
round is  1
accuracy is  0.9281333334896538
====================
====================
iteration is  0
round is  2
accuracy is  0.9295833334896536
====================
====================
iteration is  1
round is  0
accuracy is  0.9255833334896539
====================
====================
iteration is  1
round is  1
accuracy is  0.9189000001563207
====================
====================
iteration is  1
round is  2
accuracy is  0.9275833334896537
====================
====================
iteration is  2
round is  0
accuracy is  0.9362000001563201
====================
====================
iteration is  2
round is  1
accuracy is  0.9320000001563203
====================
====================
iteration is  2
round is  2
accuracy is  0.9297166668229869
====================
====================
iteration is  3
round is  0
accuracy is  0.9232000001563205
====================
====================
iteration is  3
round is  1
accuracy is  0.9163833334896542
====================
====================
iteration is  3
round is  2
accuracy is  0.9286333334896537
====================
====================
iteration is  4
round is  0
accuracy is  0.9252000001563205
====================
====================
iteration is  4
round is  1
accuracy is  0.9339833334896536
====================
====================
iteration is  4
round is  2
accuracy is  0.9271333334896538
====================
====================
iteration is  5
round is  0
accuracy is  0.9345666668229868
====================
====================
iteration is  5
round is  1
accuracy is  0.9143333334896542
====================
====================
iteration is  5
round is  2
accuracy is  0.9127500001563209
====================
====================
iteration is  6
round is  0
accuracy is  0.9268833334896538
====================
====================
iteration is  6
round is  1
accuracy is  0.9301833334896537
====================
====================
iteration is  6
round is  2
accuracy is  0.9103666668229877
====================
====================
iteration is  7
round is  0
accuracy is  0.9306833334896536
====================
====================
iteration is  7
round is  1
accuracy is  0.9254833334896537
====================
====================
iteration is  7
round is  2
accuracy is  0.9213000001563206
====================
====================
iteration is  8
round is  0
accuracy is  0.9136666668229876
====================
====================
iteration is  8
round is  1
accuracy is  0.9413666668229866
====================
====================
iteration is  8
round is  2
accuracy is  0.9238333334896539
====================
====================
iteration is  9
round is  0
accuracy is  0.9315833334896536
====================
====================
iteration is  9
round is  1
accuracy is  0.9157166668229875
====================
====================
iteration is  9
round is  2
accuracy is  0.912150000156321
====================
====================
iteration is  10
round is  0
accuracy is  0.8976333334896549
====================
====================
iteration is  10
round is  1
accuracy is  0.9097833334896543
====================
====================
iteration is  10
round is  2
accuracy is  0.9248333334896538
====================
====================
iteration is  11
round is  0
accuracy is  0.9065166668229878
====================
====================
iteration is  11
round is  1
accuracy is  0.9171166668229874
====================
====================
iteration is  11
round is  2
accuracy is  0.9083000001563211
====================
====================
iteration is  12
round is  0
accuracy is  0.9288000001563204
====================
====================
iteration is  12
round is  1
accuracy is  0.9027666668229879
====================
====================
iteration is  12
round is  2
accuracy is  0.9134500001563209
====================
====================
iteration is  13
round is  0
accuracy is  0.8978333334896549
====================
====================
iteration is  13
round is  1
accuracy is  0.9012000001563214
====================
====================
iteration is  13
round is  2
accuracy is  0.9186333334896541
====================
====================
iteration is  14
round is  0
accuracy is  0.894033333489655
====================
====================
iteration is  14
round is  1
accuracy is  0.9269833334896538
====================
====================
iteration is  14
round is  2
accuracy is  0.8831166668229887
====================
====================
iteration is  15
round is  0
accuracy is  0.8933333334896549
====================
====================
iteration is  15
round is  1
accuracy is  0.8663500001563227
====================
succ_min + 1
====================
iteration is  15
round is  2
accuracy is  0.8567666668229896
====================
succ_min + 1
====================
iteration is  16
round is  0
accuracy is  0.8274500001563242
====================
succ_min + 1
====================
iteration is  16
round is  1
accuracy is  0.8962666668229882
====================
====================
iteration is  16
round is  2
accuracy is  0.8553666668229898
====================
====================
iteration is  17
round is  0
accuracy is  0.8806000001563221
====================
====================
iteration is  17
round is  1
accuracy is  0.8881833334896551
====================
====================
iteration is  17
round is  2
accuracy is  0.868583333489656
====================
________________________________
test distance is  tensor(1966.8662, device='cuda:0')
test acc is  0.8274500001563242
test entropy is  0.3078008918429234
________________________________
diff is  tensor(19.9379, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1533, device='cuda:0', dtype=torch.float64)
diff is  tensor(263.1738, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2393, device='cuda:0', dtype=torch.float64)
diff is  tensor(1673.0100, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9513, device='cuda:0', dtype=torch.float64)
diff is  tensor(9.3354, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0653, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1880.3190, device='cuda:0')
sum is tensor(0.0653, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2186, device='cuda:0', dtype=torch.float64)
sum is tensor(0.4579, device='cuda:0', dtype=torch.float64)
sum is tensor(1.4093, device='cuda:0', dtype=torch.float64)
sum is tensor(10.7446, device='cuda:0', dtype=torch.float64)
sum is tensor(30.6825, device='cuda:0', dtype=torch.float64)
sum is tensor(293.8563, device='cuda:0', dtype=torch.float64)
sum is tensor(1966.8663, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0517, device='cuda:0', dtype=torch.float64)
threshold is tensor(1673.0100, device='cuda:0', dtype=torch.float64)
cal diff is tensor(19.9379, device='cuda:0')
discard
cal diff is tensor(0.1533, device='cuda:0')
discard
cal diff is tensor(263.1738, device='cuda:0')
discard
cal diff is tensor(0.2393, device='cuda:0')
discard
cal diff is tensor(1673.0100, device='cuda:0')
clipping
cal diff is tensor(0.9513, device='cuda:0')
discard
cal diff is tensor(9.3354, device='cuda:0')
discard
cal diff is tensor(0.0653, device='cuda:0')
discard
________________________________
test distance is  tensor(86.5575, device='cuda:0')
test acc is  0.9322000001563203
test entropy is  0.1598629240137237
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(86.5473, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0103, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
sum is tensor(86.5575, device='cuda:0')
ratio is tensor(1.0000, device='cuda:0', dtype=torch.float64)
threshold is tensor(86.5473, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
discard
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(86.5473, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(86.5574, device='cuda:0')
test acc is  0.9322000001563203
test entropy is  0.15986289497393408
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(86.5472, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0102, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
sum is tensor(86.5574, device='cuda:0')
ratio is tensor(1.0000, device='cuda:0', dtype=torch.float64)
threshold is tensor(86.5472, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
discard
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(86.5472, device='cuda:0')
discard
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.9329666668229869
test entropy is  0.1587866869355951
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1587866869355951
avg test loss is  0.1757117043684191
avg accuracy is  0.9329666668229869
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2858552488405059
avg test loss is  0.53544036371272
avg accuracy is  0.8376333334896572
compute_distance is  tensor(64.6894, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(64.6894, device='cuda:0')
test acc is  0.8376333334896572
test entropy is  0.2858552488405059
________________________________
out distance ratio is 0.8
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [24, 26, 27, 28, 29, 30, 31]
left index is  [0, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 94.30% 

Test Accuracy: 93.17% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0005857755313627422
len of model dicts is  10
compute distance is  tensor(26.8251, device='cuda:0')
compute distance is  tensor(44.4011, device='cuda:0')
compute distance is  tensor(78.1839, device='cuda:0')
compute distance is  tensor(43.8954, device='cuda:0')
compute distance is  tensor(52.0751, device='cuda:0')
compute distance is  tensor(28.3726, device='cuda:0')
compute distance is  tensor(52.5038, device='cuda:0')
compute distance is  tensor(33.4247, device='cuda:0')
compute distance is  tensor(84.7661, device='cuda:0')
compute distance is  tensor(17.4534, device='cuda:0')
calculated distance threshold is  tensor(71.3036, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.9270500001563204
====================
====================
iteration is  0
round is  1
accuracy is  0.9295500001563203
====================
====================
iteration is  0
round is  2
accuracy is  0.9288333334896538
====================
====================
iteration is  1
round is  0
accuracy is  0.9289500001563205
====================
====================
iteration is  1
round is  1
accuracy is  0.9257166668229871
====================
====================
iteration is  1
round is  2
accuracy is  0.9263166668229871
====================
====================
iteration is  2
round is  0
accuracy is  0.9302333334896536
====================
====================
iteration is  2
round is  1
accuracy is  0.9159666668229874
====================
====================
iteration is  2
round is  2
accuracy is  0.9277500001563205
====================
====================
iteration is  3
round is  0
accuracy is  0.9329666668229869
====================
====================
iteration is  3
round is  1
accuracy is  0.9251166668229872
====================
====================
iteration is  3
round is  2
accuracy is  0.9166333334896541
====================
====================
iteration is  4
round is  0
accuracy is  0.9307333334896536
====================
====================
iteration is  4
round is  1
accuracy is  0.9326833334896535
====================
====================
iteration is  4
round is  2
accuracy is  0.9299500001563203
====================
====================
iteration is  5
round is  0
accuracy is  0.9142500001563207
====================
====================
iteration is  5
round is  1
accuracy is  0.9116000001563209
====================
====================
iteration is  5
round is  2
accuracy is  0.9115166668229876
====================
====================
iteration is  6
round is  0
accuracy is  0.9092666668229877
====================
====================
iteration is  6
round is  1
accuracy is  0.9059833334896545
====================
====================
iteration is  6
round is  2
accuracy is  0.9245666668229873
====================
====================
iteration is  7
round is  0
accuracy is  0.9088333334896543
====================
====================
iteration is  7
round is  1
accuracy is  0.9292333334896536
====================
====================
iteration is  7
round is  2
accuracy is  0.9108666668229877
====================
====================
iteration is  8
round is  0
accuracy is  0.9102000001563211
====================
====================
iteration is  8
round is  1
accuracy is  0.9325000001563203
====================
====================
iteration is  8
round is  2
accuracy is  0.9096166668229877
====================
====================
iteration is  9
round is  0
accuracy is  0.8961166668229882
====================
====================
iteration is  9
round is  1
accuracy is  0.9337666668229868
====================
====================
iteration is  9
round is  2
accuracy is  0.9118000001563209
====================
====================
iteration is  10
round is  0
accuracy is  0.8866833334896552
====================
====================
iteration is  10
round is  1
accuracy is  0.9377833334896534
====================
====================
iteration is  10
round is  2
accuracy is  0.9082333334896544
====================
====================
iteration is  11
round is  0
accuracy is  0.8965833334896549
====================
====================
iteration is  11
round is  1
accuracy is  0.8883333334896552
====================
====================
iteration is  11
round is  2
accuracy is  0.8808333334896554
====================
====================
iteration is  12
round is  0
accuracy is  0.894733333489655
====================
====================
iteration is  12
round is  1
accuracy is  0.8769500001563223
====================
====================
iteration is  12
round is  2
accuracy is  0.9254833334896538
====================
====================
iteration is  13
round is  0
accuracy is  0.9081333334896544
====================
====================
iteration is  13
round is  1
accuracy is  0.8898000001563218
====================
====================
iteration is  13
round is  2
accuracy is  0.875966666822989
====================
====================
iteration is  14
round is  0
accuracy is  0.8821166668229888
====================
====================
iteration is  14
round is  1
accuracy is  0.8761333334896556
====================
====================
iteration is  14
round is  2
accuracy is  0.8553833334896564
====================
succ_min + 1
====================
iteration is  15
round is  0
accuracy is  0.8976500001563216
====================
====================
iteration is  15
round is  1
accuracy is  0.8100833334896582
====================
succ_min + 1
====================
iteration is  15
round is  2
accuracy is  0.8493000001563233
====================
====================
iteration is  16
round is  0
accuracy is  0.9261166668229871
====================
====================
iteration is  16
round is  1
accuracy is  0.876866666822989
====================
====================
iteration is  16
round is  2
accuracy is  0.8888833334896551
====================
====================
iteration is  17
round is  0
accuracy is  0.819283333489658
====================
====================
iteration is  17
round is  1
accuracy is  0.8651000001563227
====================
________________________________
test distance is  tensor(1788.1676, device='cuda:0')
test acc is  0.8100833334896582
test entropy is  0.327181255321767
________________________________
diff is  tensor(17.8996, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1578, device='cuda:0', dtype=torch.float64)
diff is  tensor(239.6115, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1980, device='cuda:0', dtype=torch.float64)
diff is  tensor(1521.0162, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8184, device='cuda:0', dtype=torch.float64)
diff is  tensor(8.3954, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0708, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1716.8640, device='cuda:0')
sum is tensor(0.0708, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2287, device='cuda:0', dtype=torch.float64)
sum is tensor(0.4267, device='cuda:0', dtype=torch.float64)
sum is tensor(1.2451, device='cuda:0', dtype=torch.float64)
sum is tensor(9.6406, device='cuda:0', dtype=torch.float64)
sum is tensor(27.5401, device='cuda:0', dtype=torch.float64)
sum is tensor(267.1516, device='cuda:0', dtype=torch.float64)
sum is tensor(1788.1678, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0469, device='cuda:0', dtype=torch.float64)
threshold is tensor(1521.0162, device='cuda:0', dtype=torch.float64)
cal diff is tensor(17.8995, device='cuda:0')
discard
cal diff is tensor(0.1578, device='cuda:0')
discard
cal diff is tensor(239.6115, device='cuda:0')
discard
cal diff is tensor(0.1980, device='cuda:0')
discard
cal diff is tensor(1521.0162, device='cuda:0')
clipping
cal diff is tensor(0.8184, device='cuda:0')
discard
cal diff is tensor(8.3954, device='cuda:0')
discard
cal diff is tensor(0.0708, device='cuda:0')
discard
________________________________
test distance is  tensor(71.3140, device='cuda:0')
test acc is  0.9289000001563205
test entropy is  0.15865371423934313
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(71.3038, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0104, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
sum is tensor(71.3140, device='cuda:0')
ratio is tensor(1.0000, device='cuda:0', dtype=torch.float64)
threshold is tensor(71.3038, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
discard
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(71.3038, device='cuda:0')
discard
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.929116666822987
test entropy is  0.1584453797226013
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1584453797226013
avg test loss is  0.18792672441211908
avg accuracy is  0.929116666822987
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3100138282947449
avg test loss is  0.5308610732589704
avg accuracy is  0.8174666668229913
compute_distance is  tensor(62.7152, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(62.7152, device='cuda:0')
test acc is  0.8174666668229913
test entropy is  0.3100138282947449
________________________________
out distance ratio is 0.8
left index is  [16, 17, 18, 19, 20, 21, 23]
left index is  [0, 1, 2, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 93.03% 

Test Accuracy: 91.17% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0007710231584496796
len of model dicts is  10
compute distance is  tensor(28.3827, device='cuda:0')
compute distance is  tensor(41.3789, device='cuda:0')
compute distance is  tensor(69.5966, device='cuda:0')
compute distance is  tensor(45.9601, device='cuda:0')
compute distance is  tensor(49.6127, device='cuda:0')
compute distance is  tensor(53.4076, device='cuda:0')
compute distance is  tensor(65.7865, device='cuda:0')
compute distance is  tensor(48.1805, device='cuda:0')
compute distance is  tensor(77.6476, device='cuda:0')
compute distance is  tensor(61.4291, device='cuda:0')
calculated distance threshold is  tensor(67.7946, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.9056166668229878
====================
====================
iteration is  0
round is  1
accuracy is  0.9040500001563213
====================
====================
iteration is  0
round is  2
accuracy is  0.9124333334896543
====================
====================
iteration is  1
round is  0
accuracy is  0.9006833334896548
====================
====================
iteration is  1
round is  1
accuracy is  0.9109000001563209
====================
====================
iteration is  1
round is  2
accuracy is  0.9044833334896546
====================
====================
iteration is  2
round is  0
accuracy is  0.9134333334896543
====================
====================
iteration is  2
round is  1
accuracy is  0.9114333334896543
====================
====================
iteration is  2
round is  2
accuracy is  0.8974000001563215
====================
====================
iteration is  3
round is  0
accuracy is  0.899466666822988
====================
====================
iteration is  3
round is  1
accuracy is  0.9041333334896546
====================
====================
iteration is  3
round is  2
accuracy is  0.9070500001563212
====================
====================
iteration is  4
round is  0
accuracy is  0.9151500001563208
====================
====================
iteration is  4
round is  1
accuracy is  0.9009666668229881
====================
====================
iteration is  4
round is  2
accuracy is  0.9052666668229878
====================
====================
iteration is  5
round is  0
accuracy is  0.900466666822988
====================
====================
iteration is  5
round is  1
accuracy is  0.8895333334896551
====================
====================
iteration is  5
round is  2
accuracy is  0.8856666668229886
====================
====================
iteration is  6
round is  0
accuracy is  0.9000000001563214
====================
====================
iteration is  6
round is  1
accuracy is  0.8925666668229884
====================
====================
iteration is  6
round is  2
accuracy is  0.8977333334896549
====================
====================
iteration is  7
round is  0
accuracy is  0.8916166668229883
====================
====================
iteration is  7
round is  1
accuracy is  0.8976166668229882
====================
====================
iteration is  7
round is  2
accuracy is  0.8943000001563216
====================
====================
iteration is  8
round is  0
accuracy is  0.892583333489655
====================
====================
iteration is  8
round is  1
accuracy is  0.902116666822988
====================
====================
iteration is  8
round is  2
accuracy is  0.8986500001563213
====================
====================
iteration is  9
round is  0
accuracy is  0.8985666668229881
====================
====================
iteration is  9
round is  1
accuracy is  0.8805500001563221
====================
====================
iteration is  9
round is  2
accuracy is  0.9181666668229873
====================
====================
iteration is  10
round is  0
accuracy is  0.8828166668229886
====================
====================
iteration is  10
round is  1
accuracy is  0.9023666668229879
====================
====================
iteration is  10
round is  2
accuracy is  0.9028000001563213
====================
====================
iteration is  11
round is  0
accuracy is  0.9106666668229877
====================
====================
iteration is  11
round is  1
accuracy is  0.8996500001563213
====================
====================
iteration is  11
round is  2
accuracy is  0.8809666668229887
====================
====================
iteration is  12
round is  0
accuracy is  0.8722000001563225
====================
succ_min + 1
====================
iteration is  12
round is  1
accuracy is  0.8669000001563227
====================
succ_min + 1
====================
iteration is  12
round is  2
accuracy is  0.8813333334896555
====================
====================
iteration is  13
round is  0
accuracy is  0.8952166668229882
====================
====================
iteration is  13
round is  1
accuracy is  0.8796833334896554
====================
====================
iteration is  13
round is  2
accuracy is  0.894733333489655
====================
====================
iteration is  14
round is  0
accuracy is  0.85111666682299
====================
succ_min + 1
====================
iteration is  14
round is  1
accuracy is  0.7896333334896593
====================
succ_min + 1
====================
iteration is  14
round is  2
accuracy is  0.8438000001563235
====================
________________________________
test distance is  tensor(1626.5758, device='cuda:0')
test acc is  0.7896333334896593
test entropy is  0.2881581481141068
________________________________
diff is  tensor(16.7971, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1267, device='cuda:0', dtype=torch.float64)
diff is  tensor(218.1794, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1875, device='cuda:0', dtype=torch.float64)
diff is  tensor(1382.7060, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7854, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.7302, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0636, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1558.7811, device='cuda:0')
sum is tensor(0.0636, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1903, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3778, device='cuda:0', dtype=torch.float64)
sum is tensor(1.1632, device='cuda:0', dtype=torch.float64)
sum is tensor(8.8933, device='cuda:0', dtype=torch.float64)
sum is tensor(25.6904, device='cuda:0', dtype=torch.float64)
sum is tensor(243.8698, device='cuda:0', dtype=torch.float64)
sum is tensor(1626.5758, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0490, device='cuda:0', dtype=torch.float64)
threshold is tensor(1382.7060, device='cuda:0', dtype=torch.float64)
cal diff is tensor(16.7971, device='cuda:0')
discard
cal diff is tensor(0.1267, device='cuda:0')
discard
cal diff is tensor(218.1794, device='cuda:0')
discard
cal diff is tensor(0.1875, device='cuda:0')
discard
cal diff is tensor(1382.7061, device='cuda:0')
clipping
cal diff is tensor(0.7854, device='cuda:0')
discard
cal diff is tensor(7.7302, device='cuda:0')
discard
cal diff is tensor(0.0636, device='cuda:0')
discard
________________________________
test distance is  tensor(67.8050, device='cuda:0')
test acc is  0.9102500001563211
test entropy is  0.16133241679495586
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(67.7947, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0103, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
sum is tensor(67.8049, device='cuda:0')
ratio is tensor(1.0000, device='cuda:0', dtype=torch.float64)
threshold is tensor(67.7947, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
discard
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(67.7947, device='cuda:0')
discard
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.9114833334896543
test entropy is  0.16086094150506358
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16086094150506358
avg test loss is  0.24077368994305
avg accuracy is  0.9114833334896543
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.27399706206659774
avg test loss is  0.6351368039020343
avg accuracy is  0.7957500001563256
compute_distance is  tensor(61.2874, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(61.2874, device='cuda:0')
test acc is  0.7957500001563256
test entropy is  0.27399706206659774
________________________________
out distance ratio is 0.8
left index is  [8, 10, 11, 12, 13, 14, 15]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 91.38% 

Test Accuracy: 89.13% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.001017262227833271
len of model dicts is  10
compute distance is  tensor(26.3492, device='cuda:0')
compute distance is  tensor(50.6467, device='cuda:0')
compute distance is  tensor(76.1502, device='cuda:0')
compute distance is  tensor(77.1768, device='cuda:0')
compute distance is  tensor(90.8723, device='cuda:0')
compute distance is  tensor(37.9820, device='cuda:0')
compute distance is  tensor(67.0861, device='cuda:0')
compute distance is  tensor(50.6810, device='cuda:0')
compute distance is  tensor(94.4386, device='cuda:0')
compute distance is  tensor(10.7768, device='cuda:0')
calculated distance threshold is  tensor(77.7062, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8971500001563215
====================
====================
iteration is  0
round is  1
accuracy is  0.8912666668229883
====================
====================
iteration is  0
round is  2
accuracy is  0.8948666668229883
====================
====================
iteration is  1
round is  0
accuracy is  0.8951500001563216
====================
====================
iteration is  1
round is  1
accuracy is  0.8976000001563216
====================
====================
iteration is  1
round is  2
accuracy is  0.8975333334896548
====================
====================
iteration is  2
round is  0
accuracy is  0.9028833334896547
====================
====================
iteration is  2
round is  1
accuracy is  0.8952833334896549
====================
====================
iteration is  2
round is  2
accuracy is  0.8792833334896555
====================
====================
iteration is  3
round is  0
accuracy is  0.8856166668229886
====================
====================
iteration is  3
round is  1
accuracy is  0.8868333334896552
====================
====================
iteration is  3
round is  2
accuracy is  0.8926166668229883
====================
====================
iteration is  4
round is  0
accuracy is  0.8870833334896552
====================
====================
iteration is  4
round is  1
accuracy is  0.8845666668229887
====================
====================
iteration is  4
round is  2
accuracy is  0.8885666668229885
====================
====================
iteration is  5
round is  0
accuracy is  0.882450000156322
====================
====================
iteration is  5
round is  1
accuracy is  0.8893666668229885
====================
====================
iteration is  5
round is  2
accuracy is  0.8665000001563227
====================
succ_min + 1
====================
iteration is  6
round is  0
accuracy is  0.8776833334896555
====================
====================
iteration is  6
round is  1
accuracy is  0.8876166668229886
====================
====================
iteration is  6
round is  2
accuracy is  0.8718000001563225
====================
====================
iteration is  7
round is  0
accuracy is  0.893633333489655
====================
====================
iteration is  7
round is  1
accuracy is  0.867733333489656
====================
====================
iteration is  7
round is  2
accuracy is  0.874716666822989
====================
====================
iteration is  8
round is  0
accuracy is  0.8812333334896554
====================
====================
iteration is  8
round is  1
accuracy is  0.8650666668229894
====================
succ_min + 1
====================
iteration is  8
round is  2
accuracy is  0.8797666668229888
====================
====================
iteration is  9
round is  0
accuracy is  0.8723333334896557
====================
________________________________
test distance is  tensor(918.3212, device='cuda:0')
test acc is  0.8650666668229894
test entropy is  0.2068920865305451
________________________________
diff is  tensor(9.4248, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0756, device='cuda:0', dtype=torch.float64)
diff is  tensor(123.4348, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1097, device='cuda:0', dtype=torch.float64)
diff is  tensor(780.4243, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4422, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.3647, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0450, device='cuda:0', dtype=torch.float64)
threshold is  tensor(840.6149, device='cuda:0')
sum is tensor(0.0450, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1205, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2303, device='cuda:0', dtype=torch.float64)
sum is tensor(0.6725, device='cuda:0', dtype=torch.float64)
sum is tensor(5.0372, device='cuda:0', dtype=torch.float64)
sum is tensor(14.4620, device='cuda:0', dtype=torch.float64)
sum is tensor(137.8968, device='cuda:0', dtype=torch.float64)
sum is tensor(918.3212, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0996, device='cuda:0', dtype=torch.float64)
threshold is tensor(780.4243, device='cuda:0', dtype=torch.float64)
cal diff is tensor(9.4248, device='cuda:0')
discard
cal diff is tensor(0.0756, device='cuda:0')
discard
cal diff is tensor(123.4348, device='cuda:0')
discard
cal diff is tensor(0.1097, device='cuda:0')
discard
cal diff is tensor(780.4243, device='cuda:0')
discard
cal diff is tensor(0.4422, device='cuda:0')
discard
cal diff is tensor(4.3647, device='cuda:0')
discard
cal diff is tensor(0.0450, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.8933666668229883
test entropy is  0.17861723922081849
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17861723922081849
avg test loss is  0.29724237353388056
avg accuracy is  0.8933666668229883
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19939266030849423
avg test loss is  0.3945716815208321
avg accuracy is  0.8675666668229894
compute_distance is  tensor(56.8458, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(56.8458, device='cuda:0')
test acc is  0.8675666668229894
test entropy is  0.19939266030849423
________________________________
out distance ratio is 0.8
left index is  [32, 33, 34, 36, 37, 38, 39]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  3
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 92.67% 

Test Accuracy: 90.78% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0003743876295629889
len of model dicts is  10
compute distance is  tensor(25.4430, device='cuda:0')
compute distance is  tensor(37.9532, device='cuda:0')
compute distance is  tensor(63.5745, device='cuda:0')
compute distance is  tensor(48.1994, device='cuda:0')
compute distance is  tensor(75.0932, device='cuda:0')
compute distance is  tensor(41.8765, device='cuda:0')
compute distance is  tensor(74.7826, device='cuda:0')
compute distance is  tensor(39.5793, device='cuda:0')
compute distance is  tensor(84.9854, device='cuda:0')
compute distance is  tensor(10.9175, device='cuda:0')
calculated distance threshold is  tensor(70.1718, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.9078166668229878
====================
====================
iteration is  0
round is  1
accuracy is  0.9115833334896543
====================
====================
iteration is  0
round is  2
accuracy is  0.9016666668229879
====================
====================
iteration is  1
round is  0
accuracy is  0.903916666822988
====================
====================
iteration is  1
round is  1
accuracy is  0.9036166668229879
====================
====================
iteration is  1
round is  2
accuracy is  0.9008666668229881
====================
====================
iteration is  2
round is  0
accuracy is  0.9034666668229879
====================
====================
iteration is  2
round is  1
accuracy is  0.9148166668229875
====================
====================
iteration is  2
round is  2
accuracy is  0.9139500001563209
====================
====================
iteration is  3
round is  0
accuracy is  0.9007166668229881
====================
====================
iteration is  3
round is  1
accuracy is  0.8911166668229883
====================
====================
iteration is  3
round is  2
accuracy is  0.9016000001563212
====================
====================
iteration is  4
round is  0
accuracy is  0.9016333334896546
====================
====================
iteration is  4
round is  1
accuracy is  0.9024000001563213
====================
====================
iteration is  4
round is  2
accuracy is  0.8901833334896551
====================
====================
iteration is  5
round is  0
accuracy is  0.8973500001563215
====================
====================
iteration is  5
round is  1
accuracy is  0.9055000001563211
====================
====================
iteration is  5
round is  2
accuracy is  0.9090666668229878
====================
====================
iteration is  6
round is  0
accuracy is  0.902216666822988
====================
====================
iteration is  6
round is  1
accuracy is  0.8998833334896548
====================
====================
iteration is  6
round is  2
accuracy is  0.9091500001563211
====================
====================
iteration is  7
round is  0
accuracy is  0.8878166668229884
====================
====================
iteration is  7
round is  1
accuracy is  0.8795333334896555
====================
====================
iteration is  7
round is  2
accuracy is  0.8954000001563215
====================
====================
iteration is  8
round is  0
accuracy is  0.8965333334896548
====================
====================
iteration is  8
round is  1
accuracy is  0.8784333334896556
====================
====================
iteration is  8
round is  2
accuracy is  0.8911500001563217
====================
====================
iteration is  9
round is  0
accuracy is  0.8862000001563219
====================
====================
iteration is  9
round is  1
accuracy is  0.8907666668229883
====================
====================
iteration is  9
round is  2
accuracy is  0.8891500001563217
====================
====================
iteration is  10
round is  0
accuracy is  0.9035166668229879
====================
====================
iteration is  10
round is  1
accuracy is  0.8872000001563218
====================
====================
iteration is  10
round is  2
accuracy is  0.8788666668229888
====================
====================
iteration is  11
round is  0
accuracy is  0.891483333489655
====================
====================
iteration is  11
round is  1
accuracy is  0.8891666668229884
====================
====================
iteration is  11
round is  2
accuracy is  0.8768500001563223
====================
====================
iteration is  12
round is  0
accuracy is  0.868033333489656
====================
succ_min + 1
====================
iteration is  12
round is  1
accuracy is  0.895133333489655
====================
====================
iteration is  12
round is  2
accuracy is  0.8731166668229892
====================
====================
iteration is  13
round is  0
accuracy is  0.8386333334896571
====================
succ_min + 1
====================
iteration is  13
round is  1
accuracy is  0.829800000156324
====================
succ_min + 1
====================
iteration is  13
round is  2
accuracy is  0.8576333334896563
====================
________________________________
test distance is  tensor(1477.9034, device='cuda:0')
test acc is  0.829800000156324
test entropy is  0.25393855379525027
________________________________
diff is  tensor(14.9904, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1234, device='cuda:0', dtype=torch.float64)
diff is  tensor(197.6643, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1858, device='cuda:0', dtype=torch.float64)
diff is  tensor(1257.1907, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6964, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.9987, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0536, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1407.7317, device='cuda:0')
sum is tensor(0.0536, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1770, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3628, device='cuda:0', dtype=torch.float64)
sum is tensor(1.0592, device='cuda:0', dtype=torch.float64)
sum is tensor(8.0579, device='cuda:0', dtype=torch.float64)
sum is tensor(23.0484, device='cuda:0', dtype=torch.float64)
sum is tensor(220.7127, device='cuda:0', dtype=torch.float64)
sum is tensor(1477.9034, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0558, device='cuda:0', dtype=torch.float64)
threshold is tensor(1257.1907, device='cuda:0', dtype=torch.float64)
cal diff is tensor(14.9904, device='cuda:0')
discard
cal diff is tensor(0.1234, device='cuda:0')
discard
cal diff is tensor(197.6643, device='cuda:0')
discard
cal diff is tensor(0.1858, device='cuda:0')
discard
cal diff is tensor(1257.1907, device='cuda:0')
clipping
cal diff is tensor(0.6964, device='cuda:0')
discard
cal diff is tensor(6.9987, device='cuda:0')
discard
cal diff is tensor(0.0536, device='cuda:0')
discard
________________________________
test distance is  tensor(70.1819, device='cuda:0')
test acc is  0.9082666668229877
test entropy is  0.16879703712139302
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(70.1717, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0101, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
ratio is tensor(0.0139, device='cuda:0')
threshold is tensor(0.0091, device='cuda:0')
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
clipping
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(70.1717, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.9895, device='cuda:0')
test acc is  0.9083500001563211
test entropy is  0.16851259798589927
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16851259798589927
avg test loss is  0.25091812478056724
avg accuracy is  0.9083500001563211
compute_distance is  tensor(0.9895, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24102033601640893
avg test loss is  0.5045569518815353
avg accuracy is  0.833650000156324
compute_distance is  tensor(60.2947, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(60.2947, device='cuda:0')
test acc is  0.833650000156324
test entropy is  0.24102033601640893
________________________________
out distance ratio is 0.8
left index is  [8, 10, 11, 12, 13, 14, 15]
left index is  [17, 18, 19, 20, 21, 22, 23]
left index is  [24, 26, 27, 28, 29, 30, 31]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 91.86% 

Test Accuracy: 89.41% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00039956459659151733
len of model dicts is  10
compute distance is  tensor(32.7982, device='cuda:0')
compute distance is  tensor(57.5446, device='cuda:0')
compute distance is  tensor(99.5491, device='cuda:0')
compute distance is  tensor(72.1310, device='cuda:0')
compute distance is  tensor(50.5200, device='cuda:0')
compute distance is  tensor(34.3701, device='cuda:0')
compute distance is  tensor(61.2615, device='cuda:0')
compute distance is  tensor(49.8741, device='cuda:0')
compute distance is  tensor(82.7045, device='cuda:0')
compute distance is  tensor(9.1544, device='cuda:0')
calculated distance threshold is  tensor(81.4702, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8951500001563216
====================
====================
iteration is  0
round is  1
accuracy is  0.8957166668229882
====================
====================
iteration is  0
round is  2
accuracy is  0.8884166668229885
====================
====================
iteration is  1
round is  0
accuracy is  0.8992000001563214
====================
====================
iteration is  1
round is  1
accuracy is  0.8938166668229883
====================
====================
iteration is  1
round is  2
accuracy is  0.8962500001563215
====================
====================
iteration is  2
round is  0
accuracy is  0.8849166668229886
====================
====================
iteration is  2
round is  1
accuracy is  0.8917666668229883
====================
====================
iteration is  2
round is  2
accuracy is  0.8913166668229884
====================
====================
iteration is  3
round is  0
accuracy is  0.8825166668229887
====================
====================
iteration is  3
round is  1
accuracy is  0.8829333334896553
====================
====================
iteration is  3
round is  2
accuracy is  0.8938000001563217
====================
====================
iteration is  4
round is  0
accuracy is  0.8864166668229886
====================
====================
iteration is  4
round is  1
accuracy is  0.8942500001563215
====================
====================
iteration is  4
round is  2
accuracy is  0.8900166668229884
====================
====================
iteration is  5
round is  0
accuracy is  0.8787166668229889
====================
====================
iteration is  5
round is  1
accuracy is  0.8688500001563226
====================
succ_min + 1
====================
iteration is  5
round is  2
accuracy is  0.8849166668229885
====================
====================
iteration is  6
round is  0
accuracy is  0.8767833334896555
====================
====================
iteration is  6
round is  1
accuracy is  0.892733333489655
====================
====================
iteration is  6
round is  2
accuracy is  0.8934000001563216
====================
====================
iteration is  7
round is  0
accuracy is  0.8924666668229884
====================
====================
iteration is  7
round is  1
accuracy is  0.8922666668229883
====================
====================
iteration is  7
round is  2
accuracy is  0.876216666822989
====================
====================
iteration is  8
round is  0
accuracy is  0.8850166668229886
====================
====================
iteration is  8
round is  1
accuracy is  0.8846333334896553
====================
====================
iteration is  8
round is  2
accuracy is  0.8854333334896552
====================
====================
iteration is  9
round is  0
accuracy is  0.8938500001563217
====================
====================
iteration is  9
round is  1
accuracy is  0.907600000156321
====================
====================
iteration is  9
round is  2
accuracy is  0.8526833334896565
====================
succ_min + 1
====================
iteration is  10
round is  0
accuracy is  0.8640000001563227
====================
====================
iteration is  10
round is  1
accuracy is  0.8867000001563219
====================
====================
iteration is  10
round is  2
accuracy is  0.8662500001563226
====================
====================
iteration is  11
round is  0
accuracy is  0.8826166668229887
====================
====================
iteration is  11
round is  1
accuracy is  0.8515333334896567
====================
succ_min + 1
________________________________
test distance is  tensor(1221.8054, device='cuda:0')
test acc is  0.8515333334896567
test entropy is  0.22580241821785726
________________________________
diff is  tensor(12.4081, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1061, device='cuda:0', dtype=torch.float64)
diff is  tensor(163.5178, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1499, device='cuda:0', dtype=torch.float64)
diff is  tensor(1039.1514, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5948, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.8118, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0654, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1140.3352, device='cuda:0')
sum is tensor(0.0654, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1715, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3214, device='cuda:0', dtype=torch.float64)
sum is tensor(0.9162, device='cuda:0', dtype=torch.float64)
sum is tensor(6.7280, device='cuda:0', dtype=torch.float64)
sum is tensor(19.1361, device='cuda:0', dtype=torch.float64)
sum is tensor(182.6539, device='cuda:0', dtype=torch.float64)
sum is tensor(1221.8054, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0784, device='cuda:0', dtype=torch.float64)
threshold is tensor(1039.1514, device='cuda:0', dtype=torch.float64)
cal diff is tensor(12.4081, device='cuda:0')
discard
cal diff is tensor(0.1061, device='cuda:0')
discard
cal diff is tensor(163.5178, device='cuda:0')
discard
cal diff is tensor(0.1499, device='cuda:0')
discard
cal diff is tensor(1039.1515, device='cuda:0')
clipping
cal diff is tensor(0.5948, device='cuda:0')
discard
cal diff is tensor(5.8118, device='cuda:0')
discard
cal diff is tensor(0.0654, device='cuda:0')
discard
________________________________
test distance is  tensor(81.4804, device='cuda:0')
test acc is  0.8977166668229882
test entropy is  0.16411581881312545
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(81.4702, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0102, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
ratio is tensor(0.0055, device='cuda:0')
threshold is tensor(0.0091, device='cuda:0')
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
clipping
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(81.4702, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.4621, device='cuda:0')
test acc is  0.8974166668229882
test entropy is  0.16325994154442347
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16325994154442347
avg test loss is  0.29473023041526775
avg accuracy is  0.8974166668229882
compute_distance is  tensor(0.4621, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.21699233759822115
avg test loss is  0.43481471919333503
avg accuracy is  0.8560833334896565
compute_distance is  tensor(57.9585, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(57.9585, device='cuda:0')
test acc is  0.8560833334896565
test entropy is  0.21699233759822115
________________________________
out distance ratio is 0.8
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 91.74% 

Test Accuracy: 89.10% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0005483177956193686
len of model dicts is  10
compute distance is  tensor(26.9082, device='cuda:0')
compute distance is  tensor(40.4095, device='cuda:0')
compute distance is  tensor(70.5303, device='cuda:0')
compute distance is  tensor(71.8084, device='cuda:0')
compute distance is  tensor(63.0035, device='cuda:0')
compute distance is  tensor(32.3013, device='cuda:0')
compute distance is  tensor(99.4870, device='cuda:0')
compute distance is  tensor(57.1103, device='cuda:0')
compute distance is  tensor(98.6846, device='cuda:0')
compute distance is  tensor(8.7921, device='cuda:0')
calculated distance threshold is  tensor(81.3480, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8965333334896548
====================
====================
iteration is  0
round is  1
accuracy is  0.8888166668229884
====================
====================
iteration is  0
round is  2
accuracy is  0.8882500001563219
====================
====================
iteration is  1
round is  0
accuracy is  0.8927000001563217
====================
====================
iteration is  1
round is  1
accuracy is  0.8889666668229884
====================
====================
iteration is  1
round is  2
accuracy is  0.8899333334896551
====================
====================
iteration is  2
round is  0
accuracy is  0.8809333334896554
====================
====================
iteration is  2
round is  1
accuracy is  0.8804333334896555
====================
====================
iteration is  2
round is  2
accuracy is  0.8935166668229884
====================
====================
iteration is  3
round is  0
accuracy is  0.8928500001563217
====================
====================
iteration is  3
round is  1
accuracy is  0.8982833334896548
====================
====================
iteration is  3
round is  2
accuracy is  0.8810500001563222
====================
====================
iteration is  4
round is  0
accuracy is  0.892083333489655
====================
====================
iteration is  4
round is  1
accuracy is  0.8877833334896552
====================
====================
iteration is  4
round is  2
accuracy is  0.8710500001563225
====================
succ_min + 1
====================
iteration is  5
round is  0
accuracy is  0.884050000156322
====================
====================
iteration is  5
round is  1
accuracy is  0.8812833334896555
====================
====================
iteration is  5
round is  2
accuracy is  0.8886000001563218
====================
====================
iteration is  6
round is  0
accuracy is  0.8759333334896557
====================
====================
iteration is  6
round is  1
accuracy is  0.8929166668229883
====================
====================
iteration is  6
round is  2
accuracy is  0.8810500001563222
====================
====================
iteration is  7
round is  0
accuracy is  0.8869166668229885
====================
====================
iteration is  7
round is  1
accuracy is  0.883550000156322
====================
====================
iteration is  7
round is  2
accuracy is  0.8695166668229893
====================
succ_min + 1
====================
iteration is  8
round is  0
accuracy is  0.8772666668229889
====================
====================
iteration is  8
round is  1
accuracy is  0.8768500001563223
====================
====================
iteration is  8
round is  2
accuracy is  0.8873833334896553
====================
====================
iteration is  9
round is  0
accuracy is  0.8606166668229895
====================
succ_min + 1
====================
iteration is  9
round is  1
accuracy is  0.8916666668229883
====================
====================
iteration is  9
round is  2
accuracy is  0.8757666668229891
====================
====================
iteration is  10
round is  0
accuracy is  0.8688166668229893
====================
====================
iteration is  10
round is  1
accuracy is  0.8832166668229887
====================
====================
iteration is  10
round is  2
accuracy is  0.8995833334896547
====================
====================
iteration is  11
round is  0
accuracy is  0.8722666668229891
====================
________________________________
test distance is  tensor(1009.7009, device='cuda:0')
test acc is  0.8606166668229895
test entropy is  0.21689998580893474
________________________________
diff is  tensor(10.6349, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0802, device='cuda:0', dtype=torch.float64)
diff is  tensor(134.8300, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1139, device='cuda:0', dtype=torch.float64)
diff is  tensor(858.7314, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4800, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.7818, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0486, device='cuda:0', dtype=torch.float64)
threshold is  tensor(928.3528, device='cuda:0')
sum is tensor(0.0486, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1289, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2428, device='cuda:0', dtype=torch.float64)
sum is tensor(0.7227, device='cuda:0', dtype=torch.float64)
sum is tensor(5.5045, device='cuda:0', dtype=torch.float64)
sum is tensor(16.1394, device='cuda:0', dtype=torch.float64)
sum is tensor(150.9695, device='cuda:0', dtype=torch.float64)
sum is tensor(1009.7008, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0947, device='cuda:0', dtype=torch.float64)
threshold is tensor(858.7314, device='cuda:0', dtype=torch.float64)
cal diff is tensor(10.6349, device='cuda:0')
discard
cal diff is tensor(0.0802, device='cuda:0')
discard
cal diff is tensor(134.8300, device='cuda:0')
discard
cal diff is tensor(0.1139, device='cuda:0')
discard
cal diff is tensor(858.7314, device='cuda:0')
clipping
cal diff is tensor(0.4800, device='cuda:0')
discard
cal diff is tensor(4.7818, device='cuda:0')
discard
cal diff is tensor(0.0486, device='cuda:0')
discard
________________________________
test distance is  tensor(81.3582, device='cuda:0')
test acc is  0.8929666668229883
test entropy is  0.1587995409782825
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(81.3480, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0102, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
ratio is tensor(0.0013, device='cuda:0')
threshold is tensor(0.0091, device='cuda:0')
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
clipping
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(81.3480, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.1297, device='cuda:0')
test acc is  0.893783333489655
test entropy is  0.1577520969389344
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1577520969389344
avg test loss is  0.31568476560511693
avg accuracy is  0.893783333489655
compute_distance is  tensor(0.1297, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2096239667155468
avg test loss is  0.39064950592863534
avg accuracy is  0.8634166668229896
compute_distance is  tensor(56.7523, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(56.7523, device='cuda:0')
test acc is  0.8634166668229896
test entropy is  0.2096239667155468
________________________________
out distance ratio is 0.8
left index is  [8, 9, 10, 11, 12, 13, 14]
left index is  [0, 1, 2, 4, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 91.53% 

Test Accuracy: 89.07% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0004678053956013173
len of model dicts is  10
compute distance is  tensor(23.4486, device='cuda:0')
compute distance is  tensor(36.7376, device='cuda:0')
compute distance is  tensor(75.8566, device='cuda:0')
compute distance is  tensor(90.5914, device='cuda:0')
compute distance is  tensor(54.8616, device='cuda:0')
compute distance is  tensor(34.5086, device='cuda:0')
compute distance is  tensor(84.5253, device='cuda:0')
compute distance is  tensor(53.2569, device='cuda:0')
compute distance is  tensor(82.0058, device='cuda:0')
compute distance is  tensor(9.6100, device='cuda:0')
calculated distance threshold is  tensor(74.3951, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8860166668229885
====================
====================
iteration is  0
round is  1
accuracy is  0.8887833334896551
====================
====================
iteration is  0
round is  2
accuracy is  0.8886333334896551
====================
====================
iteration is  1
round is  0
accuracy is  0.8987000001563215
====================
====================
iteration is  1
round is  1
accuracy is  0.8916666668229883
====================
====================
iteration is  1
round is  2
accuracy is  0.8842666668229887
====================
====================
iteration is  2
round is  0
accuracy is  0.8860833334896552
====================
====================
iteration is  2
round is  1
accuracy is  0.8881666668229884
====================
====================
iteration is  2
round is  2
accuracy is  0.890883333489655
====================
====================
iteration is  3
round is  0
accuracy is  0.8806833334896554
====================
====================
iteration is  3
round is  1
accuracy is  0.8838833334896553
====================
====================
iteration is  3
round is  2
accuracy is  0.8911000001563217
====================
====================
iteration is  4
round is  0
accuracy is  0.8907333334896551
====================
====================
iteration is  4
round is  1
accuracy is  0.8956666668229883
====================
====================
iteration is  4
round is  2
accuracy is  0.875216666822989
====================
====================
iteration is  5
round is  0
accuracy is  0.8841333334896554
====================
====================
iteration is  5
round is  1
accuracy is  0.8904333334896551
====================
====================
iteration is  5
round is  2
accuracy is  0.883650000156322
====================
====================
iteration is  6
round is  0
accuracy is  0.884200000156322
====================
====================
iteration is  6
round is  1
accuracy is  0.9036000001563212
====================
====================
iteration is  6
round is  2
accuracy is  0.882400000156322
====================
====================
iteration is  7
round is  0
accuracy is  0.8753833334896557
====================
====================
iteration is  7
round is  1
accuracy is  0.8794166668229888
====================
====================
iteration is  7
round is  2
accuracy is  0.9036333334896546
====================
====================
iteration is  8
round is  0
accuracy is  0.8752833334896557
====================
====================
iteration is  8
round is  1
accuracy is  0.8864166668229886
====================
====================
iteration is  8
round is  2
accuracy is  0.876566666822989
====================
====================
iteration is  9
round is  0
accuracy is  0.8808666668229888
====================
====================
iteration is  9
round is  1
accuracy is  0.8799833334896555
====================
====================
iteration is  9
round is  2
accuracy is  0.855950000156323
====================
succ_min + 1
====================
iteration is  10
round is  0
accuracy is  0.8929500001563216
====================
====================
iteration is  10
round is  1
accuracy is  0.8767166668229889
====================
====================
iteration is  10
round is  2
accuracy is  0.8631166668229894
====================
====================
iteration is  11
round is  0
accuracy is  0.8704833334896558
====================
====================
iteration is  11
round is  1
accuracy is  0.8498666668229901
====================
succ_min + 1
====================
iteration is  11
round is  2
accuracy is  0.8718333334896559
====================
________________________________
test distance is  tensor(1221.5424, device='cuda:0')
test acc is  0.8498666668229901
test entropy is  0.20995795552823335
________________________________
diff is  tensor(12.8616, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1065, device='cuda:0', dtype=torch.float64)
diff is  tensor(163.3130, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1490, device='cuda:0', dtype=torch.float64)
diff is  tensor(1038.6647, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5850, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.8015, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0611, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1147.1472, device='cuda:0')
sum is tensor(0.0611, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1676, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3165, device='cuda:0', dtype=torch.float64)
sum is tensor(0.9015, device='cuda:0', dtype=torch.float64)
sum is tensor(6.7030, device='cuda:0', dtype=torch.float64)
sum is tensor(19.5647, device='cuda:0', dtype=torch.float64)
sum is tensor(182.8777, device='cuda:0', dtype=torch.float64)
sum is tensor(1221.5424, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0716, device='cuda:0', dtype=torch.float64)
threshold is tensor(1038.6647, device='cuda:0', dtype=torch.float64)
cal diff is tensor(12.8616, device='cuda:0')
discard
cal diff is tensor(0.1065, device='cuda:0')
discard
cal diff is tensor(163.3130, device='cuda:0')
discard
cal diff is tensor(0.1490, device='cuda:0')
discard
cal diff is tensor(1038.6648, device='cuda:0')
clipping
cal diff is tensor(0.5850, device='cuda:0')
discard
cal diff is tensor(5.8015, device='cuda:0')
discard
cal diff is tensor(0.0611, device='cuda:0')
discard
________________________________
test distance is  tensor(74.4054, device='cuda:0')
test acc is  0.8915500001563217
test entropy is  0.1540714662426761
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(74.3951, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0103, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
sum is tensor(74.4054, device='cuda:0')
ratio is tensor(1.0000, device='cuda:0', dtype=torch.float64)
threshold is tensor(74.3951, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
discard
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(74.3951, device='cuda:0')
discard
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.892433333489655
test entropy is  0.1539918706416766
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1539918706416766
avg test loss is  0.3252808905081518
avg accuracy is  0.892433333489655
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20216489410889682
avg test loss is  0.4880755775169269
avg accuracy is  0.853950000156323
compute_distance is  tensor(58.3497, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(58.3497, device='cuda:0')
test acc is  0.853950000156323
test entropy is  0.20216489410889682
________________________________
out distance ratio is 0.8
left index is  [16, 17, 18, 19, 20, 21, 22]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  3
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 92.63% 

Test Accuracy: 90.60% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00032608170295134187
len of model dicts is  10
compute distance is  tensor(27.3995, device='cuda:0')
compute distance is  tensor(42.6900, device='cuda:0')
compute distance is  tensor(84.1680, device='cuda:0')
compute distance is  tensor(54.1509, device='cuda:0')
compute distance is  tensor(62.3479, device='cuda:0')
compute distance is  tensor(44.0022, device='cuda:0')
compute distance is  tensor(61.1537, device='cuda:0')
compute distance is  tensor(46.7967, device='cuda:0')
compute distance is  tensor(95.6053, device='cuda:0')
compute distance is  tensor(9.3013, device='cuda:0')
calculated distance threshold is  tensor(78.3445, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.9047500001563212
====================
====================
iteration is  0
round is  1
accuracy is  0.9017166668229881
====================
====================
iteration is  0
round is  2
accuracy is  0.8990833334896547
====================
====================
iteration is  1
round is  0
accuracy is  0.9015500001563214
====================
====================
iteration is  1
round is  1
accuracy is  0.8993833334896547
====================
====================
iteration is  1
round is  2
accuracy is  0.9072833334896545
====================
====================
iteration is  2
round is  0
accuracy is  0.9071833334896545
====================
====================
iteration is  2
round is  1
accuracy is  0.8945500001563217
====================
====================
iteration is  2
round is  2
accuracy is  0.9062333334896545
====================
====================
iteration is  3
round is  0
accuracy is  0.8976500001563216
====================
====================
iteration is  3
round is  1
accuracy is  0.899466666822988
====================
====================
iteration is  3
round is  2
accuracy is  0.898666666822988
====================
====================
iteration is  4
round is  0
accuracy is  0.8994833334896547
====================
====================
iteration is  4
round is  1
accuracy is  0.9052000001563212
====================
====================
iteration is  4
round is  2
accuracy is  0.9026166668229879
====================
====================
iteration is  5
round is  0
accuracy is  0.9046833334896545
====================
====================
iteration is  5
round is  1
accuracy is  0.8927000001563217
====================
====================
iteration is  5
round is  2
accuracy is  0.8973333334896548
====================
====================
iteration is  6
round is  0
accuracy is  0.8804333334896555
====================
====================
iteration is  6
round is  1
accuracy is  0.9061666668229879
====================
====================
iteration is  6
round is  2
accuracy is  0.9015500001563213
====================
====================
iteration is  7
round is  0
accuracy is  0.8807500001563221
====================
====================
iteration is  7
round is  1
accuracy is  0.8961333334896548
====================
====================
iteration is  7
round is  2
accuracy is  0.8818166668229886
====================
====================
iteration is  8
round is  0
accuracy is  0.8806333334896554
====================
====================
iteration is  8
round is  1
accuracy is  0.8870000001563219
====================
====================
iteration is  8
round is  2
accuracy is  0.9030333334896546
====================
====================
iteration is  9
round is  0
accuracy is  0.8835666668229887
====================
====================
iteration is  9
round is  1
accuracy is  0.8846666668229887
====================
====================
iteration is  9
round is  2
accuracy is  0.8841166668229887
====================
====================
iteration is  10
round is  0
accuracy is  0.8933166668229883
====================
====================
iteration is  10
round is  1
accuracy is  0.8687666668229893
====================
succ_min + 1
====================
iteration is  10
round is  2
accuracy is  0.8907500001563218
====================
====================
iteration is  11
round is  0
accuracy is  0.8977166668229881
====================
====================
iteration is  11
round is  1
accuracy is  0.8871833334896552
====================
====================
iteration is  11
round is  2
accuracy is  0.8862333334896553
====================
====================
iteration is  12
round is  0
accuracy is  0.8670166668229894
====================
succ_min + 1
====================
iteration is  12
round is  1
accuracy is  0.8738833334896557
====================
====================
iteration is  12
round is  2
accuracy is  0.8384000001563237
====================
succ_min + 1
====================
iteration is  13
round is  0
accuracy is  0.8792666668229888
====================
====================
iteration is  13
round is  1
accuracy is  0.8584666668229897
====================
________________________________
test distance is  tensor(1344.6997, device='cuda:0')
test acc is  0.8384000001563237
test entropy is  0.24048520589688185
________________________________
diff is  tensor(14.0843, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1058, device='cuda:0', dtype=torch.float64)
diff is  tensor(180.0620, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1520, device='cuda:0', dtype=torch.float64)
diff is  tensor(1143.1830, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6561, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.3998, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0567, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1266.3552, device='cuda:0')
sum is tensor(0.0567, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1625, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3145, device='cuda:0', dtype=torch.float64)
sum is tensor(0.9706, device='cuda:0', dtype=torch.float64)
sum is tensor(7.3705, device='cuda:0', dtype=torch.float64)
sum is tensor(21.4547, device='cuda:0', dtype=torch.float64)
sum is tensor(201.5168, device='cuda:0', dtype=torch.float64)
sum is tensor(1344.6997, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0685, device='cuda:0', dtype=torch.float64)
threshold is tensor(1143.1830, device='cuda:0', dtype=torch.float64)
cal diff is tensor(14.0843, device='cuda:0')
discard
cal diff is tensor(0.1058, device='cuda:0')
discard
cal diff is tensor(180.0620, device='cuda:0')
discard
cal diff is tensor(0.1520, device='cuda:0')
discard
cal diff is tensor(1143.1830, device='cuda:0')
clipping
cal diff is tensor(0.6561, device='cuda:0')
discard
cal diff is tensor(6.3998, device='cuda:0')
discard
cal diff is tensor(0.0567, device='cuda:0')
discard
________________________________
test distance is  tensor(78.3547, device='cuda:0')
test acc is  0.9052333334896546
test entropy is  0.15412740204443556
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(78.3445, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0102, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
sum is tensor(78.3547, device='cuda:0')
ratio is tensor(1.0000, device='cuda:0', dtype=torch.float64)
threshold is tensor(78.3445, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
discard
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(78.3445, device='cuda:0')
discard
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.9066500001563211
test entropy is  0.15316058124608195
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15316058124608195
avg test loss is  0.26717275489113734
avg accuracy is  0.9066500001563211
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23268437832752778
avg test loss is  0.47037752294368834
avg accuracy is  0.8431666668229902
compute_distance is  tensor(58.7240, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(58.7240, device='cuda:0')
test acc is  0.8431666668229902
test entropy is  0.23268437832752778
________________________________
out distance ratio is 0.8
left index is  [8, 10, 11, 12, 13, 14, 15]
left index is  [24, 26, 27, 28, 29, 30, 31]
left index is  [32, 33, 34, 35, 37, 38, 39]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 91.92% 

Test Accuracy: 89.47% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0004048366390634328
len of model dicts is  10
compute distance is  tensor(25.8523, device='cuda:0')
compute distance is  tensor(47.5981, device='cuda:0')
compute distance is  tensor(82.8077, device='cuda:0')
compute distance is  tensor(73.9944, device='cuda:0')
compute distance is  tensor(56.2946, device='cuda:0')
compute distance is  tensor(74.2636, device='cuda:0')
compute distance is  tensor(85.9340, device='cuda:0')
compute distance is  tensor(58.1687, device='cuda:0')
compute distance is  tensor(83.6086, device='cuda:0')
compute distance is  tensor(7.8152, device='cuda:0')
calculated distance threshold is  tensor(70.3102, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.9001000001563214
====================
====================
iteration is  0
round is  1
accuracy is  0.900366666822988
====================
====================
iteration is  0
round is  2
accuracy is  0.8886666668229884
====================
====================
iteration is  1
round is  0
accuracy is  0.892233333489655
====================
====================
iteration is  1
round is  1
accuracy is  0.8899666668229884
====================
====================
iteration is  1
round is  2
accuracy is  0.9024000001563213
====================
====================
iteration is  2
round is  0
accuracy is  0.8973833334896548
====================
====================
iteration is  2
round is  1
accuracy is  0.895083333489655
====================
====================
iteration is  2
round is  2
accuracy is  0.8873833334896553
====================
====================
iteration is  3
round is  0
accuracy is  0.8969333334896549
====================
====================
iteration is  3
round is  1
accuracy is  0.8836333334896553
====================
====================
iteration is  3
round is  2
accuracy is  0.8933666668229883
====================
====================
iteration is  4
round is  0
accuracy is  0.8946666668229883
====================
====================
iteration is  4
round is  1
accuracy is  0.8899500001563218
====================
====================
iteration is  4
round is  2
accuracy is  0.8781666668229889
====================
====================
iteration is  5
round is  0
accuracy is  0.8895166668229885
====================
====================
iteration is  5
round is  1
accuracy is  0.8855833334896552
====================
====================
iteration is  5
round is  2
accuracy is  0.8724500001563225
====================
succ_min + 1
====================
iteration is  6
round is  0
accuracy is  0.8754500001563223
====================
====================
iteration is  6
round is  1
accuracy is  0.8866333334896552
====================
====================
iteration is  6
round is  2
accuracy is  0.8903833334896551
====================
====================
iteration is  7
round is  0
accuracy is  0.8894666668229885
====================
====================
iteration is  7
round is  1
accuracy is  0.9034500001563213
====================
====================
iteration is  7
round is  2
accuracy is  0.8777833334896555
====================
====================
iteration is  8
round is  0
accuracy is  0.8948166668229883
====================
====================
iteration is  8
round is  1
accuracy is  0.8826666668229887
====================
====================
iteration is  8
round is  2
accuracy is  0.8719333334896558
====================
succ_min + 1
====================
iteration is  9
round is  0
accuracy is  0.8749500001563224
====================
====================
iteration is  9
round is  1
accuracy is  0.8829666668229886
====================
====================
iteration is  9
round is  2
accuracy is  0.8745000001563223
====================
====================
iteration is  10
round is  0
accuracy is  0.8607666668229895
====================
succ_min + 1
====================
iteration is  10
round is  1
accuracy is  0.8806833334896554
====================
====================
iteration is  10
round is  2
accuracy is  0.8917833334896551
====================
====================
iteration is  11
round is  0
accuracy is  0.8810333334896555
====================
====================
iteration is  11
round is  1
accuracy is  0.8792500001563222
====================
====================
iteration is  11
round is  2
accuracy is  0.8536000001563232
====================
succ_min + 1
________________________________
test distance is  tensor(1221.2987, device='cuda:0')
test acc is  0.8536000001563232
test entropy is  0.20878071405454232
________________________________
diff is  tensor(12.1808, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1010, device='cuda:0', dtype=torch.float64)
diff is  tensor(163.5834, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1518, device='cuda:0', dtype=torch.float64)
diff is  tensor(1038.8120, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5839, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.8263, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0594, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1150.9885, device='cuda:0')
sum is tensor(0.0594, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1604, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3122, device='cuda:0', dtype=torch.float64)
sum is tensor(0.8961, device='cuda:0', dtype=torch.float64)
sum is tensor(6.7223, device='cuda:0', dtype=torch.float64)
sum is tensor(18.9031, device='cuda:0', dtype=torch.float64)
sum is tensor(182.4865, device='cuda:0', dtype=torch.float64)
sum is tensor(1221.2985, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0677, device='cuda:0', dtype=torch.float64)
threshold is tensor(1038.8120, device='cuda:0', dtype=torch.float64)
cal diff is tensor(12.1808, device='cuda:0')
discard
cal diff is tensor(0.1010, device='cuda:0')
discard
cal diff is tensor(163.5834, device='cuda:0')
discard
cal diff is tensor(0.1518, device='cuda:0')
discard
cal diff is tensor(1038.8120, device='cuda:0')
clipping
cal diff is tensor(0.5839, device='cuda:0')
discard
cal diff is tensor(5.8263, device='cuda:0')
discard
cal diff is tensor(0.0594, device='cuda:0')
discard
________________________________
test distance is  tensor(70.3202, device='cuda:0')
test acc is  0.8963166668229882
test entropy is  0.1516947797231519
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(70.3100, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0100, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
ratio is tensor(0.0257, device='cuda:0')
threshold is tensor(0.0091, device='cuda:0')
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
clipping
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(70.3100, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(1.8204, device='cuda:0')
test acc is  0.8967666668229882
test entropy is  0.1512275824803851
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1512275824803851
avg test loss is  0.30866200909979624
avg accuracy is  0.8967666668229882
compute_distance is  tensor(1.8204, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20163830872505967
avg test loss is  0.45338128269640116
avg accuracy is  0.8568666668229897
compute_distance is  tensor(58.2915, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(58.2915, device='cuda:0')
test acc is  0.8568666668229897
test entropy is  0.20163830872505967
________________________________
out distance ratio is 0.8
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 92.17% 

Test Accuracy: 89.73% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0004559001827146858
len of model dicts is  10
compute distance is  tensor(35.4044, device='cuda:0')
compute distance is  tensor(59.2217, device='cuda:0')
compute distance is  tensor(74.2862, device='cuda:0')
compute distance is  tensor(78.4604, device='cuda:0')
compute distance is  tensor(77.5355, device='cuda:0')
compute distance is  tensor(33.8613, device='cuda:0')
compute distance is  tensor(72.2348, device='cuda:0')
compute distance is  tensor(67.3966, device='cuda:0')
compute distance is  tensor(88.1546, device='cuda:0')
compute distance is  tensor(7.9541, device='cuda:0')
calculated distance threshold is  tensor(72.1145, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.9005333334896547
====================
====================
iteration is  0
round is  1
accuracy is  0.8926500001563217
====================
====================
iteration is  0
round is  2
accuracy is  0.8976333334896549
====================
====================
iteration is  1
round is  0
accuracy is  0.8998333334896548
====================
====================
iteration is  1
round is  1
accuracy is  0.8963500001563215
====================
====================
iteration is  1
round is  2
accuracy is  0.891183333489655
====================
====================
iteration is  2
round is  0
accuracy is  0.8896166668229885
====================
====================
iteration is  2
round is  1
accuracy is  0.8995500001563214
====================
====================
iteration is  2
round is  2
accuracy is  0.8953500001563216
====================
====================
iteration is  3
round is  0
accuracy is  0.8977833334896549
====================
====================
iteration is  3
round is  1
accuracy is  0.8942000001563216
====================
====================
iteration is  3
round is  2
accuracy is  0.8945500001563217
====================
====================
iteration is  4
round is  0
accuracy is  0.8874166668229886
====================
====================
iteration is  4
round is  1
accuracy is  0.8808500001563221
====================
====================
iteration is  4
round is  2
accuracy is  0.8957833334896549
====================
====================
iteration is  5
round is  0
accuracy is  0.8811166668229888
====================
====================
iteration is  5
round is  1
accuracy is  0.8855166668229886
====================
====================
iteration is  5
round is  2
accuracy is  0.8986666668229882
====================
====================
iteration is  6
round is  0
accuracy is  0.8872500001563219
====================
====================
iteration is  6
round is  1
accuracy is  0.8957500001563217
====================
====================
iteration is  6
round is  2
accuracy is  0.8882666668229886
====================
====================
iteration is  7
round is  0
accuracy is  0.8790666668229888
====================
====================
iteration is  7
round is  1
accuracy is  0.8696833334896559
====================
succ_min + 1
====================
iteration is  7
round is  2
accuracy is  0.8893666668229885
====================
====================
iteration is  8
round is  0
accuracy is  0.8767666668229889
====================
====================
iteration is  8
round is  1
accuracy is  0.8659166668229894
====================
succ_min + 1
====================
iteration is  8
round is  2
accuracy is  0.8918833334896551
====================
====================
iteration is  9
round is  0
accuracy is  0.8676333334896561
====================
====================
iteration is  9
round is  1
accuracy is  0.8885500001563218
====================
====================
iteration is  9
round is  2
accuracy is  0.8817500001563221
====================
====================
iteration is  10
round is  0
accuracy is  0.8656000001563228
====================
succ_min + 1
====================
iteration is  10
round is  1
accuracy is  0.8731000001563225
====================
________________________________
test distance is  tensor(1110.3422, device='cuda:0')
test acc is  0.8656000001563228
test entropy is  0.17946978570269878
________________________________
diff is  tensor(11.3326, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0855, device='cuda:0', dtype=torch.float64)
diff is  tensor(148.4587, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1462, device='cuda:0', dtype=torch.float64)
diff is  tensor(944.4922, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5248, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.2517, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0504, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1038.2277, device='cuda:0')
sum is tensor(0.0504, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1360, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2822, device='cuda:0', dtype=torch.float64)
sum is tensor(0.8070, device='cuda:0', dtype=torch.float64)
sum is tensor(6.0587, device='cuda:0', dtype=torch.float64)
sum is tensor(17.3913, device='cuda:0', dtype=torch.float64)
sum is tensor(165.8500, device='cuda:0', dtype=torch.float64)
sum is tensor(1110.3422, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0764, device='cuda:0', dtype=torch.float64)
threshold is tensor(944.4922, device='cuda:0', dtype=torch.float64)
cal diff is tensor(11.3326, device='cuda:0')
discard
cal diff is tensor(0.0855, device='cuda:0')
discard
cal diff is tensor(148.4587, device='cuda:0')
discard
cal diff is tensor(0.1462, device='cuda:0')
discard
cal diff is tensor(944.4922, device='cuda:0')
discard
cal diff is tensor(0.5248, device='cuda:0')
discard
cal diff is tensor(5.2517, device='cuda:0')
discard
cal diff is tensor(0.0504, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.8993833334896547
test entropy is  0.14739798821969582
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14739798821969582
avg test loss is  0.30182305939082527
avg accuracy is  0.8993833334896547
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17362085246899997
avg test loss is  0.4495079329829099
avg accuracy is  0.8679666668229894
compute_distance is  tensor(57.8824, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(57.8824, device='cuda:0')
test acc is  0.8679666668229894
test entropy is  0.17362085246899997
________________________________
out distance ratio is 0.8
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [17, 18, 19, 20, 21, 22, 23]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 91.62% 

Test Accuracy: 89.15% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0003539858153089881
len of model dicts is  10
compute distance is  tensor(40.9452, device='cuda:0')
compute distance is  tensor(51.3675, device='cuda:0')
compute distance is  tensor(58.7554, device='cuda:0')
compute distance is  tensor(61.6948, device='cuda:0')
compute distance is  tensor(78.6816, device='cuda:0')
compute distance is  tensor(48.8047, device='cuda:0')
compute distance is  tensor(65.6539, device='cuda:0')
compute distance is  tensor(60.7099, device='cuda:0')
compute distance is  tensor(81.8606, device='cuda:0')
compute distance is  tensor(7.0765, device='cuda:0')
calculated distance threshold is  tensor(66.9038, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8907666668229884
====================
====================
iteration is  0
round is  1
accuracy is  0.8887833334896551
====================
====================
iteration is  0
round is  2
accuracy is  0.8904833334896551
====================
====================
iteration is  1
round is  0
accuracy is  0.8821666668229887
====================
====================
iteration is  1
round is  1
accuracy is  0.8845166668229887
====================
====================
iteration is  1
round is  2
accuracy is  0.8885833334896551
====================
====================
iteration is  2
round is  0
accuracy is  0.8862333334896553
====================
====================
iteration is  2
round is  1
accuracy is  0.8818833334896554
====================
====================
iteration is  2
round is  2
accuracy is  0.8886000001563218
====================
====================
iteration is  3
round is  0
accuracy is  0.8896500001563218
====================
====================
iteration is  3
round is  1
accuracy is  0.8813833334896555
====================
====================
iteration is  3
round is  2
accuracy is  0.8912166668229883
====================
====================
iteration is  4
round is  0
accuracy is  0.892233333489655
====================
====================
iteration is  4
round is  1
accuracy is  0.8802666668229888
====================
====================
iteration is  4
round is  2
accuracy is  0.882350000156322
====================
====================
iteration is  5
round is  0
accuracy is  0.8905333334896551
====================
====================
iteration is  5
round is  1
accuracy is  0.8845833334896553
====================
====================
iteration is  5
round is  2
accuracy is  0.8803666668229888
====================
====================
iteration is  6
round is  0
accuracy is  0.8727333334896559
====================
succ_min + 1
====================
iteration is  6
round is  1
accuracy is  0.8733000001563224
====================
====================
iteration is  6
round is  2
accuracy is  0.8863166668229886
====================
====================
iteration is  7
round is  0
accuracy is  0.8789833334896555
====================
====================
iteration is  7
round is  1
accuracy is  0.884400000156322
====================
====================
iteration is  7
round is  2
accuracy is  0.8912500001563217
====================
====================
iteration is  8
round is  0
accuracy is  0.8746333334896557
====================
====================
iteration is  8
round is  1
accuracy is  0.8752000001563224
====================
====================
iteration is  8
round is  2
accuracy is  0.8739000001563224
====================
====================
iteration is  9
round is  0
accuracy is  0.8829666668229886
====================
====================
iteration is  9
round is  1
accuracy is  0.873116666822989
====================
________________________________
test distance is  tensor(758.5173, device='cuda:0')
test acc is  0.8727333334896559
test entropy is  0.15232666001629347
________________________________
diff is  tensor(7.6644, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0563, device='cuda:0', dtype=torch.float64)
diff is  tensor(101.3252, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0822, device='cuda:0', dtype=torch.float64)
diff is  tensor(645.4008, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3543, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.6010, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0331, device='cuda:0', dtype=torch.float64)
threshold is  tensor(691.6135, device='cuda:0')
sum is tensor(0.0331, device='cuda:0', dtype=torch.float64)
sum is tensor(0.0895, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1717, device='cuda:0', dtype=torch.float64)
sum is tensor(0.5259, device='cuda:0', dtype=torch.float64)
sum is tensor(4.1270, device='cuda:0', dtype=torch.float64)
sum is tensor(11.7913, device='cuda:0', dtype=torch.float64)
sum is tensor(113.1165, device='cuda:0', dtype=torch.float64)
sum is tensor(758.5173, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.1037, device='cuda:0', dtype=torch.float64)
threshold is tensor(645.4008, device='cuda:0', dtype=torch.float64)
cal diff is tensor(7.6644, device='cuda:0')
discard
cal diff is tensor(0.0563, device='cuda:0')
discard
cal diff is tensor(101.3251, device='cuda:0')
discard
cal diff is tensor(0.0822, device='cuda:0')
discard
cal diff is tensor(645.4008, device='cuda:0')
discard
cal diff is tensor(0.3543, device='cuda:0')
discard
cal diff is tensor(3.6010, device='cuda:0')
discard
cal diff is tensor(0.0331, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.8924666668229884
test entropy is  0.144746526511811
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.144746526511811
avg test loss is  0.33419338031721585
avg accuracy is  0.8924666668229884
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14898454704121358
avg test loss is  0.42535728424676317
avg accuracy is  0.8740500001563224
compute_distance is  tensor(55.1607, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(55.1607, device='cuda:0')
test acc is  0.8740500001563224
test entropy is  0.14898454704121358
________________________________
out distance ratio is 0.8
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 92.56% 

Test Accuracy: 90.40% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00031517897150479257
len of model dicts is  10
compute distance is  tensor(30.1044, device='cuda:0')
compute distance is  tensor(46.5405, device='cuda:0')
compute distance is  tensor(76.7967, device='cuda:0')
compute distance is  tensor(57.8269, device='cuda:0')
compute distance is  tensor(61.6336, device='cuda:0')
compute distance is  tensor(57.4827, device='cuda:0')
compute distance is  tensor(87.2365, device='cuda:0')
compute distance is  tensor(41.8047, device='cuda:0')
compute distance is  tensor(108.6132, device='cuda:0')
compute distance is  tensor(8.3535, device='cuda:0')
calculated distance threshold is  tensor(88.5613, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8923166668229883
====================
====================
iteration is  0
round is  1
accuracy is  0.8997500001563215
====================
====================
iteration is  0
round is  2
accuracy is  0.8981166668229882
====================
====================
iteration is  1
round is  0
accuracy is  0.8992666668229881
====================
====================
iteration is  1
round is  1
accuracy is  0.9067333334896545
====================
====================
iteration is  1
round is  2
accuracy is  0.9034166668229879
====================
====================
iteration is  2
round is  0
accuracy is  0.8976000001563216
====================
====================
iteration is  2
round is  1
accuracy is  0.8933833334896549
====================
====================
iteration is  2
round is  2
accuracy is  0.8947666668229883
====================
====================
iteration is  3
round is  0
accuracy is  0.8929000001563216
====================
====================
iteration is  3
round is  1
accuracy is  0.8922833334896549
====================
====================
iteration is  3
round is  2
accuracy is  0.9052500001563213
====================
====================
iteration is  4
round is  0
accuracy is  0.9036666668229879
====================
====================
iteration is  4
round is  1
accuracy is  0.8982333334896548
====================
====================
iteration is  4
round is  2
accuracy is  0.8934666668229884
====================
====================
iteration is  5
round is  0
accuracy is  0.9137833334896542
====================
====================
iteration is  5
round is  1
accuracy is  0.894483333489655
====================
====================
iteration is  5
round is  2
accuracy is  0.8959666668229882
====================
====================
iteration is  6
round is  0
accuracy is  0.8975333334896548
====================
====================
iteration is  6
round is  1
accuracy is  0.8927666668229883
====================
====================
iteration is  6
round is  2
accuracy is  0.8905333334896551
====================
====================
iteration is  7
round is  0
accuracy is  0.8914166668229885
====================
====================
iteration is  7
round is  1
accuracy is  0.8849666668229886
====================
====================
iteration is  7
round is  2
accuracy is  0.9002833334896547
====================
====================
iteration is  8
round is  0
accuracy is  0.8996333334896547
====================
====================
iteration is  8
round is  1
accuracy is  0.8826833334896553
====================
====================
iteration is  8
round is  2
accuracy is  0.8664166668229895
====================
succ_min + 1
====================
iteration is  9
round is  0
accuracy is  0.868883333489656
====================
====================
iteration is  9
round is  1
accuracy is  0.884250000156322
====================
====================
iteration is  9
round is  2
accuracy is  0.8907000001563218
====================
====================
iteration is  10
round is  0
accuracy is  0.8708500001563225
====================
====================
iteration is  10
round is  1
accuracy is  0.8723333334896558
====================
====================
iteration is  10
round is  2
accuracy is  0.8915000001563217
====================
====================
iteration is  11
round is  0
accuracy is  0.8498000001563234
====================
succ_min + 1
________________________________
test distance is  tensor(1221.7266, device='cuda:0')
test acc is  0.8498000001563234
test entropy is  0.20876406450896884
________________________________
diff is  tensor(12.5281, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0970, device='cuda:0', dtype=torch.float64)
diff is  tensor(163.3644, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1455, device='cuda:0', dtype=torch.float64)
diff is  tensor(1039.1346, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5926, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.8123, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0520, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1133.1653, device='cuda:0')
sum is tensor(0.0520, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1490, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2945, device='cuda:0', dtype=torch.float64)
sum is tensor(0.8871, device='cuda:0', dtype=torch.float64)
sum is tensor(6.6994, device='cuda:0', dtype=torch.float64)
sum is tensor(19.2275, device='cuda:0', dtype=torch.float64)
sum is tensor(182.5919, device='cuda:0', dtype=torch.float64)
sum is tensor(1221.7265, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0852, device='cuda:0', dtype=torch.float64)
threshold is tensor(1039.1346, device='cuda:0', dtype=torch.float64)
cal diff is tensor(12.5281, device='cuda:0')
discard
cal diff is tensor(0.0970, device='cuda:0')
discard
cal diff is tensor(163.3644, device='cuda:0')
discard
cal diff is tensor(0.1455, device='cuda:0')
discard
cal diff is tensor(1039.1345, device='cuda:0')
discard
cal diff is tensor(0.5926, device='cuda:0')
discard
cal diff is tensor(5.8123, device='cuda:0')
discard
cal diff is tensor(0.0520, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.9051166668229879
test entropy is  0.14228065135175866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14228065135175866
avg test loss is  0.28161259564652497
avg accuracy is  0.9051166668229879
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2006653319400892
avg test loss is  0.462097370548289
avg accuracy is  0.8519833334896566
compute_distance is  tensor(57.0643, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(57.0643, device='cuda:0')
test acc is  0.8519833334896566
test entropy is  0.2006653319400892
________________________________
out distance ratio is 0.8
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [24, 25, 26, 27, 28, 29, 31]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 92.44% 

Test Accuracy: 90.20% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00033248672843910754
len of model dicts is  10
compute distance is  tensor(33.7218, device='cuda:0')
compute distance is  tensor(51.7613, device='cuda:0')
compute distance is  tensor(69.2857, device='cuda:0')
compute distance is  tensor(91.0557, device='cuda:0')
compute distance is  tensor(54.0001, device='cuda:0')
compute distance is  tensor(32.0968, device='cuda:0')
compute distance is  tensor(126.4217, device='cuda:0')
compute distance is  tensor(47.7812, device='cuda:0')
compute distance is  tensor(88.5469, device='cuda:0')
compute distance is  tensor(7.2798, device='cuda:0')
calculated distance threshold is  tensor(102.5933, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.901866666822988
====================
====================
iteration is  0
round is  1
accuracy is  0.9036000001563212
====================
====================
iteration is  0
round is  2
accuracy is  0.903066666822988
====================
====================
iteration is  1
round is  0
accuracy is  0.8970166668229882
====================
====================
iteration is  1
round is  1
accuracy is  0.8982166668229882
====================
====================
iteration is  1
round is  2
accuracy is  0.8938000001563217
====================
====================
iteration is  2
round is  0
accuracy is  0.8936500001563217
====================
====================
iteration is  2
round is  1
accuracy is  0.9014000001563214
====================
====================
iteration is  2
round is  2
accuracy is  0.899666666822988
====================
====================
iteration is  3
round is  0
accuracy is  0.8947000001563217
====================
====================
iteration is  3
round is  1
accuracy is  0.8975666668229882
====================
====================
iteration is  3
round is  2
accuracy is  0.9029000001563213
====================
====================
iteration is  4
round is  0
accuracy is  0.9064666668229878
====================
====================
iteration is  4
round is  1
accuracy is  0.9036833334896546
====================
====================
iteration is  4
round is  2
accuracy is  0.8830333334896553
====================
====================
iteration is  5
round is  0
accuracy is  0.8908500001563218
====================
====================
iteration is  5
round is  1
accuracy is  0.8797166668229888
====================
====================
iteration is  5
round is  2
accuracy is  0.9044000001563213
====================
====================
iteration is  6
round is  0
accuracy is  0.8989166668229881
====================
====================
iteration is  6
round is  1
accuracy is  0.8861666668229885
====================
====================
iteration is  6
round is  2
accuracy is  0.9086833334896544
====================
====================
iteration is  7
round is  0
accuracy is  0.8901666668229884
====================
====================
iteration is  7
round is  1
accuracy is  0.8937000001563217
====================
====================
iteration is  7
round is  2
accuracy is  0.8846333334896552
====================
====================
iteration is  8
round is  0
accuracy is  0.9038500001563213
====================
====================
iteration is  8
round is  1
accuracy is  0.8887833334896552
====================
====================
iteration is  8
round is  2
accuracy is  0.882050000156322
====================
====================
iteration is  9
round is  0
accuracy is  0.8949500001563216
====================
====================
iteration is  9
round is  1
accuracy is  0.8772500001563223
====================
====================
iteration is  9
round is  2
accuracy is  0.8807500001563221
====================
====================
iteration is  10
round is  0
accuracy is  0.8907666668229883
====================
====================
iteration is  10
round is  1
accuracy is  0.8996833334896548
====================
====================
iteration is  10
round is  2
accuracy is  0.8715666668229891
====================
succ_min + 1
====================
iteration is  11
round is  0
accuracy is  0.8561500001563231
====================
succ_min + 1
====================
iteration is  11
round is  1
accuracy is  0.8773666668229889
====================
====================
iteration is  11
round is  2
accuracy is  0.8698500001563226
====================
====================
iteration is  12
round is  0
accuracy is  0.8711166668229892
====================
====================
iteration is  12
round is  1
accuracy is  0.8649000001563227
====================
________________________________
test distance is  tensor(1222.4574, device='cuda:0')
test acc is  0.8561500001563231
test entropy is  0.1922626428957433
________________________________
diff is  tensor(12.6839, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1020, device='cuda:0', dtype=torch.float64)
diff is  tensor(163.8556, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1427, device='cuda:0', dtype=torch.float64)
diff is  tensor(1039.2506, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5795, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.7884, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0546, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1119.8641, device='cuda:0')
sum is tensor(0.0546, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1566, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2993, device='cuda:0', dtype=torch.float64)
sum is tensor(0.8788, device='cuda:0', dtype=torch.float64)
sum is tensor(6.6672, device='cuda:0', dtype=torch.float64)
sum is tensor(19.3510, device='cuda:0', dtype=torch.float64)
sum is tensor(183.2066, device='cuda:0', dtype=torch.float64)
sum is tensor(1222.4573, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0987, device='cuda:0', dtype=torch.float64)
threshold is tensor(1039.2506, device='cuda:0', dtype=torch.float64)
cal diff is tensor(12.6839, device='cuda:0')
discard
cal diff is tensor(0.1020, device='cuda:0')
discard
cal diff is tensor(163.8556, device='cuda:0')
discard
cal diff is tensor(0.1427, device='cuda:0')
discard
cal diff is tensor(1039.2507, device='cuda:0')
clipping
cal diff is tensor(0.5795, device='cuda:0')
discard
cal diff is tensor(5.7884, device='cuda:0')
discard
cal diff is tensor(0.0546, device='cuda:0')
discard
________________________________
test distance is  tensor(102.6034, device='cuda:0')
test acc is  0.9011333334896547
test entropy is  0.14194894428335147
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(102.5931, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0101, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
ratio is tensor(0.0148, device='cuda:0')
threshold is tensor(0.0091, device='cuda:0')
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
clipping
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(102.5932, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(1.5271, device='cuda:0')
test acc is  0.9031500001563213
test entropy is  0.14116881675382795
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14116881675382795
avg test loss is  0.29267390886905476
avg accuracy is  0.9031500001563213
compute_distance is  tensor(1.5271, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18630322717082526
avg test loss is  0.449949708769221
avg accuracy is  0.858150000156323
compute_distance is  tensor(57.2181, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(57.2181, device='cuda:0')
test acc is  0.858150000156323
test entropy is  0.18630322717082526
________________________________
out distance ratio is 0.8
left index is  [16, 17, 18, 19, 20, 21, 22]
left index is  [32, 34, 35, 36, 37, 38, 39]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 92.35% 

Test Accuracy: 89.90% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0002244648931082338
len of model dicts is  10
compute distance is  tensor(31.4620, device='cuda:0')
compute distance is  tensor(60.0718, device='cuda:0')
compute distance is  tensor(76.8519, device='cuda:0')
compute distance is  tensor(80.0390, device='cuda:0')
compute distance is  tensor(59.3736, device='cuda:0')
compute distance is  tensor(61.4402, device='cuda:0')
compute distance is  tensor(82.6679, device='cuda:0')
compute distance is  tensor(44.8851, device='cuda:0')
compute distance is  tensor(91.2751, device='cuda:0')
compute distance is  tensor(7.0993, device='cuda:0')
calculated distance threshold is  tensor(74.4399, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8976833334896549
====================
====================
iteration is  0
round is  1
accuracy is  0.893083333489655
====================
====================
iteration is  0
round is  2
accuracy is  0.8977333334896549
====================
====================
iteration is  1
round is  0
accuracy is  0.8873333334896553
====================
====================
iteration is  1
round is  1
accuracy is  0.8976833334896549
====================
====================
iteration is  1
round is  2
accuracy is  0.8955500001563217
====================
====================
iteration is  2
round is  0
accuracy is  0.8856000001563219
====================
====================
iteration is  2
round is  1
accuracy is  0.8911166668229884
====================
====================
iteration is  2
round is  2
accuracy is  0.894733333489655
====================
====================
iteration is  3
round is  0
accuracy is  0.8855833334896553
====================
====================
iteration is  3
round is  1
accuracy is  0.9011833334896547
====================
====================
iteration is  3
round is  2
accuracy is  0.9012166668229881
====================
====================
iteration is  4
round is  0
accuracy is  0.8955000001563217
====================
====================
iteration is  4
round is  1
accuracy is  0.9042833334896546
====================
====================
iteration is  4
round is  2
accuracy is  0.8824500001563221
====================
====================
iteration is  5
round is  0
accuracy is  0.891783333489655
====================
====================
iteration is  5
round is  1
accuracy is  0.9085166668229877
====================
====================
iteration is  5
round is  2
accuracy is  0.9051666668229879
====================
====================
iteration is  6
round is  0
accuracy is  0.8758500001563224
====================
====================
iteration is  6
round is  1
accuracy is  0.8918666668229884
====================
====================
iteration is  6
round is  2
accuracy is  0.8868500001563219
====================
====================
iteration is  7
round is  0
accuracy is  0.8632166668229895
====================
succ_min + 1
====================
iteration is  7
round is  1
accuracy is  0.8887500001563218
====================
====================
iteration is  7
round is  2
accuracy is  0.8862333334896553
====================
====================
iteration is  8
round is  0
accuracy is  0.8988833334896548
====================
====================
iteration is  8
round is  1
accuracy is  0.8925666668229884
====================
====================
iteration is  8
round is  2
accuracy is  0.8855833334896552
====================
====================
iteration is  9
round is  0
accuracy is  0.8778166668229889
====================
====================
iteration is  9
round is  1
accuracy is  0.8924666668229884
====================
====================
iteration is  9
round is  2
accuracy is  0.8922666668229883
====================
====================
iteration is  10
round is  0
accuracy is  0.8978166668229882
====================
====================
iteration is  10
round is  1
accuracy is  0.8697000001563227
====================
====================
iteration is  10
round is  2
accuracy is  0.8738500001563224
====================
====================
iteration is  11
round is  0
accuracy is  0.8886500001563218
====================
====================
iteration is  11
round is  1
accuracy is  0.8841000001563221
====================
====================
iteration is  11
round is  2
accuracy is  0.8805666668229888
====================
====================
iteration is  12
round is  0
accuracy is  0.8602500001563228
====================
succ_min + 1
====================
iteration is  12
round is  1
accuracy is  0.842783333489657
====================
succ_min + 1
________________________________
test distance is  tensor(1343.7634, device='cuda:0')
test acc is  0.842783333489657
test entropy is  0.19895001132287451
________________________________
diff is  tensor(13.6663, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1030, device='cuda:0', dtype=torch.float64)
diff is  tensor(179.8815, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1619, device='cuda:0', dtype=torch.float64)
diff is  tensor(1142.8546, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6534, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.3824, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0604, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1269.3235, device='cuda:0')
sum is tensor(0.0604, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1634, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3252, device='cuda:0', dtype=torch.float64)
sum is tensor(0.9786, device='cuda:0', dtype=torch.float64)
sum is tensor(7.3610, device='cuda:0', dtype=torch.float64)
sum is tensor(21.0274, device='cuda:0', dtype=torch.float64)
sum is tensor(200.9089, device='cuda:0', dtype=torch.float64)
sum is tensor(1343.7635, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0651, device='cuda:0', dtype=torch.float64)
threshold is tensor(1142.8546, device='cuda:0', dtype=torch.float64)
cal diff is tensor(13.6663, device='cuda:0')
discard
cal diff is tensor(0.1030, device='cuda:0')
discard
cal diff is tensor(179.8815, device='cuda:0')
discard
cal diff is tensor(0.1619, device='cuda:0')
discard
cal diff is tensor(1142.8546, device='cuda:0')
discard
cal diff is tensor(0.6534, device='cuda:0')
discard
cal diff is tensor(6.3824, device='cuda:0')
discard
cal diff is tensor(0.0604, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.9007000001563215
test entropy is  0.1397563523249522
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1397563523249522
avg test loss is  0.3035311056837154
avg accuracy is  0.9007000001563215
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19055799443298566
avg test loss is  0.5067657627888135
avg accuracy is  0.8452666668229901
compute_distance is  tensor(57.3794, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(57.3794, device='cuda:0')
test acc is  0.8452666668229901
test entropy is  0.19055799443298566
________________________________
out distance ratio is 0.8
left index is  [8, 9, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 92.10% 

Test Accuracy: 89.63% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00017210561782121658
len of model dicts is  10
compute distance is  tensor(26.3921, device='cuda:0')
compute distance is  tensor(59.1360, device='cuda:0')
compute distance is  tensor(112.8483, device='cuda:0')
compute distance is  tensor(112.3098, device='cuda:0')
compute distance is  tensor(47.8437, device='cuda:0')
compute distance is  tensor(31.5911, device='cuda:0')
compute distance is  tensor(84.5180, device='cuda:0')
compute distance is  tensor(52.3345, device='cuda:0')
compute distance is  tensor(87.1960, device='cuda:0')
compute distance is  tensor(6.7224, device='cuda:0')
calculated distance threshold is  tensor(91.6231, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8980500001563215
====================
====================
iteration is  0
round is  1
accuracy is  0.8967000001563216
====================
====================
iteration is  0
round is  2
accuracy is  0.8886666668229884
====================
====================
iteration is  1
round is  0
accuracy is  0.8907833334896551
====================
====================
iteration is  1
round is  1
accuracy is  0.8920500001563216
====================
====================
iteration is  1
round is  2
accuracy is  0.883750000156322
====================
====================
iteration is  2
round is  0
accuracy is  0.8879500001563219
====================
====================
iteration is  2
round is  1
accuracy is  0.8963833334896548
====================
====================
iteration is  2
round is  2
accuracy is  0.8983166668229882
====================
====================
iteration is  3
round is  0
accuracy is  0.883650000156322
====================
====================
iteration is  3
round is  1
accuracy is  0.8915166668229884
====================
====================
iteration is  3
round is  2
accuracy is  0.8940000001563216
====================
====================
iteration is  4
round is  0
accuracy is  0.8927166668229883
====================
====================
iteration is  4
round is  1
accuracy is  0.8868333334896552
====================
====================
iteration is  4
round is  2
accuracy is  0.8868666668229885
====================
====================
iteration is  5
round is  0
accuracy is  0.9068000001563211
====================
====================
iteration is  5
round is  1
accuracy is  0.9065833334896545
====================
====================
iteration is  5
round is  2
accuracy is  0.9040833334896546
====================
====================
iteration is  6
round is  0
accuracy is  0.8899833334896551
====================
====================
iteration is  6
round is  1
accuracy is  0.8888666668229884
====================
====================
iteration is  6
round is  2
accuracy is  0.8954333334896549
====================
====================
iteration is  7
round is  0
accuracy is  0.8928666668229883
====================
====================
iteration is  7
round is  1
accuracy is  0.883850000156322
====================
====================
iteration is  7
round is  2
accuracy is  0.893733333489655
====================
====================
iteration is  8
round is  0
accuracy is  0.8813666668229888
====================
====================
iteration is  8
round is  1
accuracy is  0.8714333334896558
====================
succ_min + 1
====================
iteration is  8
round is  2
accuracy is  0.8938666668229883
====================
====================
iteration is  9
round is  0
accuracy is  0.8997833334896548
====================
====================
iteration is  9
round is  1
accuracy is  0.8616666668229895
====================
succ_min + 1
====================
iteration is  9
round is  2
accuracy is  0.8863500001563219
====================
====================
iteration is  10
round is  0
accuracy is  0.8664000001563226
====================
====================
iteration is  10
round is  1
accuracy is  0.8858000001563219
====================
====================
iteration is  10
round is  2
accuracy is  0.8556833334896564
====================
succ_min + 1
====================
iteration is  11
round is  0
accuracy is  0.8646166668229895
====================
________________________________
test distance is  tensor(1110.3153, device='cuda:0')
test acc is  0.8556833334896564
test entropy is  0.19237653116014466
________________________________
diff is  tensor(11.2619, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0892, device='cuda:0', dtype=torch.float64)
diff is  tensor(148.6539, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1150, device='cuda:0', dtype=torch.float64)
diff is  tensor(944.3563, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5274, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.2701, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0418, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1018.6922, device='cuda:0')
sum is tensor(0.0418, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1310, device='cuda:0', dtype=torch.float64)
sum is tensor(0.2460, device='cuda:0', dtype=torch.float64)
sum is tensor(0.7733, device='cuda:0', dtype=torch.float64)
sum is tensor(6.0434, device='cuda:0', dtype=torch.float64)
sum is tensor(17.3053, device='cuda:0', dtype=torch.float64)
sum is tensor(165.9592, device='cuda:0', dtype=torch.float64)
sum is tensor(1110.3155, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0970, device='cuda:0', dtype=torch.float64)
threshold is tensor(944.3563, device='cuda:0', dtype=torch.float64)
cal diff is tensor(11.2619, device='cuda:0')
discard
cal diff is tensor(0.0892, device='cuda:0')
discard
cal diff is tensor(148.6539, device='cuda:0')
discard
cal diff is tensor(0.1150, device='cuda:0')
discard
cal diff is tensor(944.3563, device='cuda:0')
discard
cal diff is tensor(0.5274, device='cuda:0')
discard
cal diff is tensor(5.2701, device='cuda:0')
discard
cal diff is tensor(0.0418, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.8973333334896548
test entropy is  0.13884018356802622
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13884018356802622
avg test loss is  0.3199161683826813
avg accuracy is  0.8973333334896548
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18661073144120194
avg test loss is  0.4734978565989908
avg accuracy is  0.857800000156323
compute_distance is  tensor(56.1925, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(56.1925, device='cuda:0')
test acc is  0.857800000156323
test entropy is  0.18661073144120194
________________________________
out distance ratio is 0.8
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  3
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 92.85% 

Test Accuracy: 90.70% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00017289319657720625
len of model dicts is  10
compute distance is  tensor(25.8552, device='cuda:0')
compute distance is  tensor(37.9521, device='cuda:0')
compute distance is  tensor(97.1840, device='cuda:0')
compute distance is  tensor(95.2003, device='cuda:0')
compute distance is  tensor(56.3271, device='cuda:0')
compute distance is  tensor(81.3179, device='cuda:0')
compute distance is  tensor(90.1958, device='cuda:0')
compute distance is  tensor(53.2547, device='cuda:0')
compute distance is  tensor(83.0540, device='cuda:0')
compute distance is  tensor(7.3293, device='cuda:0')
calculated distance threshold is  tensor(79.2131, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.9036833334896546
====================
====================
iteration is  0
round is  1
accuracy is  0.9061333334896545
====================
====================
iteration is  0
round is  2
accuracy is  0.9053166668229878
====================
====================
iteration is  1
round is  0
accuracy is  0.8968333334896549
====================
====================
iteration is  1
round is  1
accuracy is  0.8974833334896548
====================
====================
iteration is  1
round is  2
accuracy is  0.9046166668229879
====================
====================
iteration is  2
round is  0
accuracy is  0.8980666668229882
====================
====================
iteration is  2
round is  1
accuracy is  0.9052333334896546
====================
====================
iteration is  2
round is  2
accuracy is  0.9047500001563211
====================
====================
iteration is  3
round is  0
accuracy is  0.9053333334896545
====================
====================
iteration is  3
round is  1
accuracy is  0.8934333334896549
====================
====================
iteration is  3
round is  2
accuracy is  0.909000000156321
====================
====================
iteration is  4
round is  0
accuracy is  0.8972500001563215
====================
====================
iteration is  4
round is  1
accuracy is  0.8968666668229882
====================
====================
iteration is  4
round is  2
accuracy is  0.9029833334896546
====================
====================
iteration is  5
round is  0
accuracy is  0.9122333334896543
====================
====================
iteration is  5
round is  1
accuracy is  0.9100833334896544
====================
====================
iteration is  5
round is  2
accuracy is  0.9012333334896547
====================
====================
iteration is  6
round is  0
accuracy is  0.9077000001563211
====================
====================
iteration is  6
round is  1
accuracy is  0.8990333334896548
====================
====================
iteration is  6
round is  2
accuracy is  0.9052666668229878
====================
====================
iteration is  7
round is  0
accuracy is  0.8921000001563216
====================
====================
iteration is  7
round is  1
accuracy is  0.8979000001563215
====================
====================
iteration is  7
round is  2
accuracy is  0.8946166668229883
====================
====================
iteration is  8
round is  0
accuracy is  0.8965333334896548
====================
====================
iteration is  8
round is  1
accuracy is  0.8997333334896548
====================
====================
iteration is  8
round is  2
accuracy is  0.9054500001563212
====================
====================
iteration is  9
round is  0
accuracy is  0.8862333334896553
====================
====================
iteration is  9
round is  1
accuracy is  0.8855833334896552
====================
====================
iteration is  9
round is  2
accuracy is  0.8878166668229885
====================
====================
iteration is  10
round is  0
accuracy is  0.8977166668229882
====================
====================
iteration is  10
round is  1
accuracy is  0.8802333334896555
====================
====================
iteration is  10
round is  2
accuracy is  0.8910666668229883
====================
====================
iteration is  11
round is  0
accuracy is  0.9063000001563212
====================
====================
iteration is  11
round is  1
accuracy is  0.9062500001563212
====================
====================
iteration is  11
round is  2
accuracy is  0.8740833334896557
====================
succ_min + 1
====================
iteration is  12
round is  0
accuracy is  0.8486500001563233
====================
succ_min + 1
====================
iteration is  12
round is  1
accuracy is  0.8707000001563225
====================
====================
iteration is  12
round is  2
accuracy is  0.8713166668229891
====================
====================
iteration is  13
round is  0
accuracy is  0.8782000001563223
====================
====================
iteration is  13
round is  1
accuracy is  0.8659000001563227
====================
________________________________
test distance is  tensor(1344.4076, device='cuda:0')
test acc is  0.8486500001563233
test entropy is  0.2015275484415641
________________________________
diff is  tensor(14.0598, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1196, device='cuda:0', dtype=torch.float64)
diff is  tensor(179.8336, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1826, device='cuda:0', dtype=torch.float64)
diff is  tensor(1143.0871, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6469, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.4101, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0680, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1265.1946, device='cuda:0')
sum is tensor(0.0680, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1875, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3701, device='cuda:0', dtype=torch.float64)
sum is tensor(1.0170, device='cuda:0', dtype=torch.float64)
sum is tensor(7.4272, device='cuda:0', dtype=torch.float64)
sum is tensor(21.4870, device='cuda:0', dtype=torch.float64)
sum is tensor(201.3205, device='cuda:0', dtype=torch.float64)
sum is tensor(1344.4076, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0693, device='cuda:0', dtype=torch.float64)
threshold is tensor(1143.0871, device='cuda:0', dtype=torch.float64)
cal diff is tensor(14.0598, device='cuda:0')
discard
cal diff is tensor(0.1196, device='cuda:0')
discard
cal diff is tensor(179.8336, device='cuda:0')
discard
cal diff is tensor(0.1826, device='cuda:0')
discard
cal diff is tensor(1143.0872, device='cuda:0')
clipping
cal diff is tensor(0.6469, device='cuda:0')
discard
cal diff is tensor(6.4101, device='cuda:0')
discard
cal diff is tensor(0.0680, device='cuda:0')
discard
________________________________
test distance is  tensor(79.2232, device='cuda:0')
test acc is  0.9067500001563211
test entropy is  0.1388810247159017
________________________________
diff is  tensor(0.0008, device='cuda:0')
diff is  tensor(5.6569e-06, device='cuda:0')
diff is  tensor(0.0091, device='cuda:0')
diff is  tensor(8.0000e-06, device='cuda:0')
diff is  tensor(79.2131, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:0')
diff is  tensor(0.0003, device='cuda:0')
diff is  tensor(3.1623e-06, device='cuda:0')
threshold is  tensor(0.0102, device='cuda:0')
sum is tensor(3.1623e-06, device='cuda:0')
sum is tensor(8.8191e-06, device='cuda:0')
sum is tensor(1.6819e-05, device='cuda:0')
sum is tensor(4.8819e-05, device='cuda:0')
sum is tensor(0.0004, device='cuda:0')
sum is tensor(0.0012, device='cuda:0')
sum is tensor(0.0102, device='cuda:0')
ratio is tensor(0.0030, device='cuda:0')
threshold is tensor(0.0091, device='cuda:0')
cal diff is tensor(0.0008, device='cuda:0')
discard
cal diff is tensor(5.6569e-06, device='cuda:0')
discard
cal diff is tensor(0.0091, device='cuda:0')
clipping
cal diff is tensor(8.0000e-06, device='cuda:0')
discard
cal diff is tensor(79.2131, device='cuda:0')
clipping
cal diff is tensor(3.2000e-05, device='cuda:0')
discard
cal diff is tensor(0.0003, device='cuda:0')
discard
cal diff is tensor(3.1623e-06, device='cuda:0')
discard
________________________________
test distance is  tensor(0.2526, device='cuda:0')
test acc is  0.9078833334896544
test entropy is  0.13874756429654195
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13874756429654195
avg test loss is  0.2731896035913338
avg accuracy is  0.9078833334896544
compute_distance is  tensor(0.2526, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19226379969766907
avg test loss is  0.5664065938943358
avg accuracy is  0.8524666668229899
compute_distance is  tensor(58.0473, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(58.0473, device='cuda:0')
test acc is  0.8524666668229899
test entropy is  0.19226379969766907
________________________________
out distance ratio is 0.8
left index is  [8, 9, 10, 11, 12, 13, 15]
left index is  [17, 18, 19, 20, 21, 22, 23]
left index is  [24, 25, 26, 27, 28, 29, 31]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  0
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 92.47% 

Test Accuracy: 90.19% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00017694853886496276
len of model dicts is  10
compute distance is  tensor(32.0074, device='cuda:0')
compute distance is  tensor(38.9184, device='cuda:0')
compute distance is  tensor(79.7636, device='cuda:0')
compute distance is  tensor(73.8901, device='cuda:0')
compute distance is  tensor(64.7865, device='cuda:0')
compute distance is  tensor(57.3143, device='cuda:0')
compute distance is  tensor(80.4859, device='cuda:0')
compute distance is  tensor(48.5263, device='cuda:0')
compute distance is  tensor(85.2439, device='cuda:0')
compute distance is  tensor(6.8342, device='cuda:0')
calculated distance threshold is  tensor(69.5619, device='cuda:0')
pinned_accuracy threshold is  0.8747000001570008
====================
iteration is  0
round is  0
accuracy is  0.8998166668229881
====================
====================
iteration is  0
round is  1
accuracy is  0.8987333334896548
====================
====================
iteration is  0
round is  2
accuracy is  0.901566666822988
====================
====================
iteration is  1
round is  0
accuracy is  0.8979500001563215
====================
====================
iteration is  1
round is  1
accuracy is  0.9031500001563213
====================
====================
iteration is  1
round is  2
accuracy is  0.8979333334896549
====================
====================
iteration is  2
round is  0
accuracy is  0.8978666668229882
====================
====================
iteration is  2
round is  1
accuracy is  0.9002500001563214
====================
====================
iteration is  2
round is  2
accuracy is  0.8933500001563216
====================
====================
iteration is  3
round is  0
accuracy is  0.9078166668229878
====================
====================
iteration is  3
round is  1
accuracy is  0.8990833334896547
====================
====================
iteration is  3
round is  2
accuracy is  0.8984833334896547
====================
====================
iteration is  4
round is  0
accuracy is  0.883050000156322
====================
====================
iteration is  4
round is  1
accuracy is  0.898616666822988
====================
====================
iteration is  4
round is  2
accuracy is  0.8927500001563217
====================
====================
iteration is  5
round is  0
accuracy is  0.8935500001563217
====================
====================
iteration is  5
round is  1
accuracy is  0.8786500001563222
====================
====================
iteration is  5
round is  2
accuracy is  0.8976833334896549
====================
====================
iteration is  6
round is  0
accuracy is  0.8854666668229887
====================
====================
iteration is  6
round is  1
accuracy is  0.8886166668229885
====================
====================
iteration is  6
round is  2
accuracy is  0.8905333334896551
====================
====================
iteration is  7
round is  0
accuracy is  0.8810833334896555
====================
====================
iteration is  7
round is  1
accuracy is  0.9104833334896544
====================
====================
iteration is  7
round is  2
accuracy is  0.8906666668229883
====================
====================
iteration is  8
round is  0
accuracy is  0.9108333334896543
====================
====================
iteration is  8
round is  1
accuracy is  0.8897833334896551
====================
====================
iteration is  8
round is  2
accuracy is  0.8921000001563216
====================
====================
iteration is  9
round is  0
accuracy is  0.8904333334896551
====================
====================
iteration is  9
round is  1
accuracy is  0.8810666668229888
====================
====================
iteration is  9
round is  2
accuracy is  0.8815000001563221
====================
====================
iteration is  10
round is  0
accuracy is  0.8580666668229896
====================
succ_min + 1
====================
iteration is  10
round is  1
accuracy is  0.9061166668229879
====================
====================
iteration is  10
round is  2
accuracy is  0.856600000156323
====================
succ_min + 1
====================
iteration is  11
round is  0
accuracy is  0.8585833334896563
====================
====================
iteration is  11
round is  1
accuracy is  0.9045000001563213
====================
====================
iteration is  11
round is  2
accuracy is  0.8787500001563221
====================
====================
iteration is  12
round is  0
accuracy is  0.8331000001563239
====================
succ_min + 1
====================
iteration is  12
round is  1
accuracy is  0.9034500001563213
====================
====================
iteration is  12
round is  2
accuracy is  0.9002666668229881
====================
====================
iteration is  13
round is  0
accuracy is  0.8777666668229889
====================
====================
iteration is  13
round is  1
accuracy is  0.8683666668229892
====================
________________________________
test distance is  tensor(1345.0328, device='cuda:0')
test acc is  0.8331000001563239
test entropy is  0.24257218804377229
________________________________
diff is  tensor(13.7084, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1125, device='cuda:0', dtype=torch.float64)
diff is  tensor(180.9916, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1660, device='cuda:0', dtype=torch.float64)
diff is  tensor(1142.9320, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6558, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.4111, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0555, device='cuda:0', dtype=torch.float64)
threshold is  tensor(1275.4709, device='cuda:0')
sum is tensor(0.0555, device='cuda:0', dtype=torch.float64)
sum is tensor(0.1680, device='cuda:0', dtype=torch.float64)
sum is tensor(0.3340, device='cuda:0', dtype=torch.float64)
sum is tensor(0.9898, device='cuda:0', dtype=torch.float64)
sum is tensor(7.4009, device='cuda:0', dtype=torch.float64)
sum is tensor(21.1093, device='cuda:0', dtype=torch.float64)
sum is tensor(202.1009, device='cuda:0', dtype=torch.float64)
sum is tensor(1345.0329, device='cuda:0', dtype=torch.float64)
ratio is tensor(0.0609, device='cuda:0', dtype=torch.float64)
threshold is tensor(1142.9320, device='cuda:0', dtype=torch.float64)
cal diff is tensor(13.7084, device='cuda:0')
discard
cal diff is tensor(0.1125, device='cuda:0')
discard
cal diff is tensor(180.9917, device='cuda:0')
discard
cal diff is tensor(0.1660, device='cuda:0')
discard
cal diff is tensor(1142.9320, device='cuda:0')
discard
cal diff is tensor(0.6558, device='cuda:0')
discard
cal diff is tensor(6.4111, device='cuda:0')
discard
cal diff is tensor(0.0555, device='cuda:0')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:0')
test acc is  0.9031833334896546
test entropy is  0.1384881816879868
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1384881816879868
avg test loss is  0.29372989317612735
avg accuracy is  0.9031833334896546
compute_distance is  tensor(0.0676, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23400792411999152
avg test loss is  0.5022550425899308
avg accuracy is  0.8375166668229905
compute_distance is  tensor(57.8334, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(57.8334, device='cuda:0')
test acc is  0.8375166668229905
test entropy is  0.23400792411999152
________________________________
out distance ratio is 0.8
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
the length of epoch_weights is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 92.81% 

Test Accuracy: 90.54% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 92.81%
|----0th round Training Accuracy : 40.78%
|----1th round Training Accuracy : 59.79%
|----2th round Training Accuracy : 74.36%
|----3th round Training Accuracy : 85.53%
|----4th round Training Accuracy : 81.98%
|----5th round Training Accuracy : 92.90%
|----6th round Training Accuracy : 82.40%
|----7th round Training Accuracy : 92.11%
|----8th round Training Accuracy : 91.03%
|----9th round Training Accuracy : 93.27%
|----10th round Training Accuracy : 94.00%
|----11th round Training Accuracy : 96.09%
|----12th round Training Accuracy : 95.67%
|----13th round Training Accuracy : 95.98%
|----14th round Training Accuracy : 96.27%
|----15th round Training Accuracy : 96.56%
|----16th round Training Accuracy : 96.30%
|----17th round Training Accuracy : 96.76%
|----18th round Training Accuracy : 96.95%
|----19th round Training Accuracy : 97.10%
|----20th round Training Accuracy : 97.17%
|----21th round Training Accuracy : 97.19%
|----22th round Training Accuracy : 97.16%
|----23th round Training Accuracy : 97.35%
|----24th round Training Accuracy : 97.14%
|----25th round Training Accuracy : 97.32%
|----26th round Training Accuracy : 97.45%
|----27th round Training Accuracy : 97.53%
|----28th round Training Accuracy : 97.46%
|----29th round Training Accuracy : 97.59%
|----30th round Training Accuracy : 95.22%
|----31th round Training Accuracy : 94.59%
|----32th round Training Accuracy : 94.30%
|----33th round Training Accuracy : 93.03%
|----34th round Training Accuracy : 91.38%
|----35th round Training Accuracy : 92.67%
|----36th round Training Accuracy : 91.86%
|----37th round Training Accuracy : 91.74%
|----38th round Training Accuracy : 91.53%
|----39th round Training Accuracy : 92.63%
|----40th round Training Accuracy : 91.92%
|----41th round Training Accuracy : 92.17%
|----42th round Training Accuracy : 91.62%
|----43th round Training Accuracy : 92.56%
|----44th round Training Accuracy : 92.44%
|----45th round Training Accuracy : 92.35%
|----46th round Training Accuracy : 92.10%
|----47th round Training Accuracy : 92.85%
|----48th round Training Accuracy : 92.47%
|----49th round Training Accuracy : 92.81%
|----Final Test Accuracy: 90.54%
|----0th round Final Test Accuracy : 46.90%
|----1th round Final Test Accuracy : 63.85%
|----2th round Final Test Accuracy : 76.60%
|----3th round Final Test Accuracy : 85.61%
|----4th round Final Test Accuracy : 83.92%
|----5th round Final Test Accuracy : 92.82%
|----6th round Final Test Accuracy : 83.52%
|----7th round Final Test Accuracy : 91.90%
|----8th round Final Test Accuracy : 92.24%
|----9th round Final Test Accuracy : 93.03%
|----10th round Final Test Accuracy : 94.33%
|----11th round Final Test Accuracy : 95.96%
|----12th round Final Test Accuracy : 95.63%
|----13th round Final Test Accuracy : 96.14%
|----14th round Final Test Accuracy : 96.37%
|----15th round Final Test Accuracy : 96.65%
|----16th round Final Test Accuracy : 96.49%
|----17th round Final Test Accuracy : 96.88%
|----18th round Final Test Accuracy : 96.79%
|----19th round Final Test Accuracy : 96.94%
|----20th round Final Test Accuracy : 97.06%
|----21th round Final Test Accuracy : 97.11%
|----22th round Final Test Accuracy : 96.93%
|----23th round Final Test Accuracy : 97.24%
|----24th round Final Test Accuracy : 97.08%
|----25th round Final Test Accuracy : 97.21%
|----26th round Final Test Accuracy : 97.36%
|----27th round Final Test Accuracy : 97.46%
|----28th round Final Test Accuracy : 97.35%
|----29th round Final Test Accuracy : 97.47%
|----30th round Final Test Accuracy : 94.09%
|----31th round Final Test Accuracy : 93.49%
|----32th round Final Test Accuracy : 93.17%
|----33th round Final Test Accuracy : 91.17%
|----34th round Final Test Accuracy : 89.13%
|----35th round Final Test Accuracy : 90.78%
|----36th round Final Test Accuracy : 89.41%
|----37th round Final Test Accuracy : 89.10%
|----38th round Final Test Accuracy : 89.07%
|----39th round Final Test Accuracy : 90.60%
|----40th round Final Test Accuracy : 89.47%
|----41th round Final Test Accuracy : 89.73%
|----42th round Final Test Accuracy : 89.15%
|----43th round Final Test Accuracy : 90.40%
|----44th round Final Test Accuracy : 90.20%
|----45th round Final Test Accuracy : 89.90%
|----46th round Final Test Accuracy : 89.63%
|----47th round Final Test Accuracy : 90.70%
|----48th round Final Test Accuracy : 90.19%
|----49th round Final Test Accuracy : 90.54%

Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 13363.6668
