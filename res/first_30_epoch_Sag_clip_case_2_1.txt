
Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
CNNMnist(
  (conv1): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (conv2): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (fc1): Linear(in_features=3136, out_features=1024, bias=True)
  (fc2): Linear(in_features=1024, out_features=10, bias=True)
)
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 27.47% 

Test Accuracy: 32.27% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 72.13% 

Test Accuracy: 71.89% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 81.62% 

Test Accuracy: 81.45% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 84.89% 

Test Accuracy: 84.99% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 89.82% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 93.03% 

Test Accuracy: 93.08% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 91.73% 

Test Accuracy: 92.22% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 94.18% 

Test Accuracy: 94.23% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 95.21% 

Test Accuracy: 95.48% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 95.91% 

Test Accuracy: 95.45% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 95.15% 

Test Accuracy: 95.35% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 95.90% 

Test Accuracy: 96.10% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 96.46% 

Test Accuracy: 96.36% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 96.79% 

Test Accuracy: 96.35% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 96.45% 

Test Accuracy: 96.48% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 96.69% 

Test Accuracy: 96.60% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 96.72% 

Test Accuracy: 96.59% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 96.98% 

Test Accuracy: 96.83% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 96.66% 

Test Accuracy: 96.82% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 96.94% 

Test Accuracy: 96.83% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 97.12% 

Test Accuracy: 96.88% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 97.23% 

Test Accuracy: 96.92% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 97.08% 

Test Accuracy: 96.95% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 97.19% 

Test Accuracy: 97.00% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 97.06% 

Test Accuracy: 96.99% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 97.10% 

Test Accuracy: 96.97% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 97.02% 

Test Accuracy: 97.01% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 97.14% 

Test Accuracy: 97.11% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 97.15% 

Test Accuracy: 97.08% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 97.32% 

Test Accuracy: 97.23% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
poisoned accuracy threshold is  0.8723000001570008
distance ratio is <class 'float'>
len of model dicts is  10
compute distance is  tensor(29.8877, device='cuda:0')
compute distance is  tensor(45.3374, device='cuda:0')
compute distance is  tensor(78.7836, device='cuda:0')
compute distance is  tensor(59.5883, device='cuda:0')
compute distance is  tensor(56.4157, device='cuda:0')
compute distance is  tensor(34.1947, device='cuda:0')
compute distance is  tensor(81.3341, device='cuda:0')
compute distance is  tensor(65.3420, device='cuda:0')
compute distance is  tensor(133.9007, device='cuda:0')
compute distance is  tensor(90.5756, device='cuda:0')
calculated distance threshold is  tensor(113.0981, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.9708333334896523
====================
====================
iteration is  0
round is  1
accuracy is  0.9702833334896523
====================
====================
iteration is  0
round is  2
accuracy is  0.9702333334896525
====================
====================
iteration is  1
round is  0
accuracy is  0.9676666668229857
====================
====================
iteration is  1
round is  1
accuracy is  0.9708166668229856
====================
====================
iteration is  1
round is  2
accuracy is  0.9701333334896525
====================
====================
iteration is  2
round is  0
accuracy is  0.9691833334896525
====================
====================
iteration is  2
round is  1
accuracy is  0.9684166668229858
====================
====================
iteration is  2
round is  2
accuracy is  0.9701833334896524
====================
====================
iteration is  3
round is  0
accuracy is  0.9712833334896523
====================
====================
iteration is  3
round is  1
accuracy is  0.9696166668229858
====================
====================
iteration is  3
round is  2
accuracy is  0.9675166668229858
====================
====================
iteration is  4
round is  0
accuracy is  0.9673833334896524
====================
====================
iteration is  4
round is  1
accuracy is  0.9686500001563191
====================
====================
iteration is  4
round is  2
accuracy is  0.9670666668229858
====================
====================
iteration is  5
round is  0
accuracy is  0.9698166668229856
====================
====================
iteration is  5
round is  1
accuracy is  0.9678333334896524
====================
====================
iteration is  5
round is  2
accuracy is  0.9701666668229857
====================
====================
iteration is  6
round is  0
accuracy is  0.9684500001563191
====================
====================
iteration is  6
round is  1
accuracy is  0.9688166668229857
====================
====================
iteration is  6
round is  2
accuracy is  0.9660333334896526
====================
====================
iteration is  7
round is  0
accuracy is  0.9647000001563192
====================
====================
iteration is  7
round is  1
accuracy is  0.9685666668229858
====================
====================
iteration is  7
round is  2
accuracy is  0.9656166668229859
====================
====================
iteration is  8
round is  0
accuracy is  0.9699333334896524
====================
====================
iteration is  8
round is  1
accuracy is  0.9652666668229859
====================
====================
iteration is  8
round is  2
accuracy is  0.9659833334896526
====================
====================
iteration is  9
round is  0
accuracy is  0.9661500001563191
====================
====================
iteration is  9
round is  1
accuracy is  0.9684166668229858
====================
====================
iteration is  9
round is  2
accuracy is  0.9649166668229859
====================
====================
iteration is  10
round is  0
accuracy is  0.9633000001563192
====================
====================
iteration is  10
round is  1
accuracy is  0.9618000001563194
====================
====================
iteration is  10
round is  2
accuracy is  0.9523333334896529
====================
====================
iteration is  11
round is  0
accuracy is  0.9642666668229859
====================
====================
iteration is  11
round is  1
accuracy is  0.9678000001563191
====================
====================
iteration is  11
round is  2
accuracy is  0.9584000001563194
====================
====================
iteration is  12
round is  0
accuracy is  0.9651166668229859
====================
====================
iteration is  12
round is  1
accuracy is  0.9553500001563194
====================
====================
iteration is  12
round is  2
accuracy is  0.9587000001563195
====================
====================
iteration is  13
round is  0
accuracy is  0.9489666668229864
====================
====================
iteration is  13
round is  1
accuracy is  0.9577500001563195
====================
====================
iteration is  13
round is  2
accuracy is  0.9230833334896539
====================
====================
iteration is  14
round is  0
accuracy is  0.959966666822986
====================
====================
iteration is  14
round is  1
accuracy is  0.9588333334896527
====================
====================
iteration is  14
round is  2
accuracy is  0.9491666668229863
====================
====================
iteration is  15
round is  0
accuracy is  0.9416166668229866
====================
====================
iteration is  15
round is  1
accuracy is  0.9236333334896539
====================
====================
iteration is  15
round is  2
accuracy is  0.9510000001563197
====================
====================
iteration is  16
round is  0
accuracy is  0.9151333334896542
====================
====================
iteration is  16
round is  1
accuracy is  0.9499166668229864
====================
====================
iteration is  16
round is  2
accuracy is  0.9349666668229869
====================
====================
iteration is  17
round is  0
accuracy is  0.9444333334896532
====================
====================
iteration is  17
round is  1
accuracy is  0.8787333334896554
====================
====================
iteration is  17
round is  2
accuracy is  0.8979833334896549
====================
====================
iteration is  18
round is  0
accuracy is  0.8740166668229891
====================
====================
iteration is  18
round is  1
accuracy is  0.8795333334896555
====================
====================
iteration is  18
round is  2
accuracy is  0.830900000156324
====================
succ_min + 1
====================
iteration is  19
round is  0
accuracy is  0.8563833334896565
====================
====================
iteration is  19
round is  1
accuracy is  0.7102833334896635
====================
succ_min + 1
====================
iteration is  19
round is  2
accuracy is  0.8499500001563234
====================
====================
iteration is  20
round is  0
accuracy is  0.7890666668229928
====================
________________________________
test distance is  tensor(3128.7766, device='cuda:0')
test acc is  0.7102833334896635
test entropy is  0.5309359666698777
________________________________
diff is  tensor(14.1890, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2091, device='cuda:0', dtype=torch.float64)
diff is  tensor(872.9576, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3234, device='cuda:0', dtype=torch.float64)
diff is  tensor(2227.3027, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.2437, device='cuda:0', dtype=torch.float64)
diff is  tensor(12.4272, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1240, device='cuda:0', dtype=torch.float64)
cal diff is tensor(14.1890, device='cuda:0')
clipping
cal diff is tensor(0.2091, device='cuda:0')
clipping
cal diff is tensor(872.9576, device='cuda:0')
clipping
cal diff is tensor(0.3234, device='cuda:0')
clipping
cal diff is tensor(2227.3027, device='cuda:0')
clipping
cal diff is tensor(1.2437, device='cuda:0')
clipping
cal diff is tensor(12.4272, device='cuda:0')
clipping
cal diff is tensor(0.1240, device='cuda:0')
clipping
________________________________
test distance is  tensor(3015.6785, device='cuda:0')
test acc is  0.7410333334896619
test entropy is  0.5156841043279623
________________________________
diff is  tensor(13.6761, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2016, device='cuda:0', dtype=torch.float64)
diff is  tensor(841.4021, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3117, device='cuda:0', dtype=torch.float64)
diff is  tensor(2146.7908, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1988, device='cuda:0', dtype=torch.float64)
diff is  tensor(11.9779, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(13.6761, device='cuda:0')
clipping
cal diff is tensor(0.2016, device='cuda:0')
clipping
cal diff is tensor(841.4021, device='cuda:0')
clipping
cal diff is tensor(0.3117, device='cuda:0')
clipping
cal diff is tensor(2146.7908, device='cuda:0')
clipping
cal diff is tensor(1.1988, device='cuda:0')
clipping
cal diff is tensor(11.9779, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2902.5847, device='cuda:0')
test acc is  0.7714500001563268
test entropy is  0.4963354568428068
________________________________
diff is  tensor(13.1632, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1940, device='cuda:0', dtype=torch.float64)
diff is  tensor(809.8467, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3000, device='cuda:0', dtype=torch.float64)
diff is  tensor(2066.2789, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1538, device='cuda:0', dtype=torch.float64)
diff is  tensor(11.5287, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(13.1632, device='cuda:0')
clipping
cal diff is tensor(0.1940, device='cuda:0')
clipping
cal diff is tensor(809.8467, device='cuda:0')
clipping
cal diff is tensor(0.3000, device='cuda:0')
clipping
cal diff is tensor(2066.2788, device='cuda:0')
clipping
cal diff is tensor(1.1538, device='cuda:0')
clipping
cal diff is tensor(11.5287, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2789.4912, device='cuda:0')
test acc is  0.8001333334896589
test entropy is  0.4733924650624871
________________________________
diff is  tensor(12.6503, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1865, device='cuda:0', dtype=torch.float64)
diff is  tensor(778.2913, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2883, device='cuda:0', dtype=torch.float64)
diff is  tensor(1985.7670, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1089, device='cuda:0', dtype=torch.float64)
diff is  tensor(11.0795, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(12.6503, device='cuda:0')
clipping
cal diff is tensor(0.1865, device='cuda:0')
clipping
cal diff is tensor(778.2913, device='cuda:0')
clipping
cal diff is tensor(0.2883, device='cuda:0')
clipping
cal diff is tensor(1985.7671, device='cuda:0')
clipping
cal diff is tensor(1.1089, device='cuda:0')
clipping
cal diff is tensor(11.0795, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2676.3979, device='cuda:0')
test acc is  0.8263333334896578
test entropy is  0.4477183859485553
________________________________
diff is  tensor(12.1374, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1789, device='cuda:0', dtype=torch.float64)
diff is  tensor(746.7360, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2766, device='cuda:0', dtype=torch.float64)
diff is  tensor(1905.2553, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.0639, device='cuda:0', dtype=torch.float64)
diff is  tensor(10.6303, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(12.1374, device='cuda:0')
clipping
cal diff is tensor(0.1789, device='cuda:0')
clipping
cal diff is tensor(746.7360, device='cuda:0')
clipping
cal diff is tensor(0.2766, device='cuda:0')
clipping
cal diff is tensor(1905.2554, device='cuda:0')
clipping
cal diff is tensor(1.0639, device='cuda:0')
clipping
cal diff is tensor(10.6303, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2563.3049, device='cuda:0')
test acc is  0.8488000001563235
test entropy is  0.42046725476728575
________________________________
diff is  tensor(11.6245, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1713, device='cuda:0', dtype=torch.float64)
diff is  tensor(715.1807, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2649, device='cuda:0', dtype=torch.float64)
diff is  tensor(1824.7438, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.0189, device='cuda:0', dtype=torch.float64)
diff is  tensor(10.1811, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(11.6245, device='cuda:0')
clipping
cal diff is tensor(0.1713, device='cuda:0')
clipping
cal diff is tensor(715.1807, device='cuda:0')
clipping
cal diff is tensor(0.2649, device='cuda:0')
clipping
cal diff is tensor(1824.7439, device='cuda:0')
clipping
cal diff is tensor(1.0189, device='cuda:0')
clipping
cal diff is tensor(10.1811, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2450.2117, device='cuda:0')
test acc is  0.8693000001563226
test entropy is  0.3927816797865988
________________________________
diff is  tensor(11.1116, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1638, device='cuda:0', dtype=torch.float64)
diff is  tensor(683.6255, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2533, device='cuda:0', dtype=torch.float64)
diff is  tensor(1744.2325, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9740, device='cuda:0', dtype=torch.float64)
diff is  tensor(9.7319, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(11.1116, device='cuda:0')
clipping
cal diff is tensor(0.1638, device='cuda:0')
clipping
cal diff is tensor(683.6256, device='cuda:0')
clipping
cal diff is tensor(0.2533, device='cuda:0')
clipping
cal diff is tensor(1744.2325, device='cuda:0')
clipping
cal diff is tensor(0.9740, device='cuda:0')
clipping
cal diff is tensor(9.7319, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2337.1189, device='cuda:0')
test acc is  0.8863166668229886
test entropy is  0.3656376277459964
________________________________
diff is  tensor(10.5987, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1562, device='cuda:0', dtype=torch.float64)
diff is  tensor(652.0703, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2416, device='cuda:0', dtype=torch.float64)
diff is  tensor(1663.7211, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9290, device='cuda:0', dtype=torch.float64)
diff is  tensor(9.2827, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(10.5987, device='cuda:0')
clipping
cal diff is tensor(0.1562, device='cuda:0')
clipping
cal diff is tensor(652.0703, device='cuda:0')
clipping
cal diff is tensor(0.2416, device='cuda:0')
clipping
cal diff is tensor(1663.7211, device='cuda:0')
clipping
cal diff is tensor(0.9290, device='cuda:0')
clipping
cal diff is tensor(9.2827, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2224.0264, device='cuda:0')
test acc is  0.9002166668229881
test entropy is  0.3397069444089556
________________________________
diff is  tensor(10.0858, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1487, device='cuda:0', dtype=torch.float64)
diff is  tensor(620.5152, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2299, device='cuda:0', dtype=torch.float64)
diff is  tensor(1583.2100, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8841, device='cuda:0', dtype=torch.float64)
diff is  tensor(8.8335, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(10.0858, device='cuda:0')
clipping
cal diff is tensor(0.1487, device='cuda:0')
clipping
cal diff is tensor(620.5152, device='cuda:0')
clipping
cal diff is tensor(0.2299, device='cuda:0')
clipping
cal diff is tensor(1583.2100, device='cuda:0')
clipping
cal diff is tensor(0.8841, device='cuda:0')
clipping
cal diff is tensor(8.8335, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(2110.9341, device='cuda:0')
test acc is  0.9117833334896542
test entropy is  0.3153840272125405
________________________________
diff is  tensor(9.5729, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1411, device='cuda:0', dtype=torch.float64)
diff is  tensor(588.9602, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2182, device='cuda:0', dtype=torch.float64)
diff is  tensor(1502.6991, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8391, device='cuda:0', dtype=torch.float64)
diff is  tensor(8.3843, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(9.5729, device='cuda:0')
clipping
cal diff is tensor(0.1411, device='cuda:0')
clipping
cal diff is tensor(588.9602, device='cuda:0')
clipping
cal diff is tensor(0.2182, device='cuda:0')
clipping
cal diff is tensor(1502.6991, device='cuda:0')
clipping
cal diff is tensor(0.8391, device='cuda:0')
clipping
cal diff is tensor(8.3843, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(1997.8424, device='cuda:0')
test acc is  0.9215166668229873
test entropy is  0.29283230331565524
________________________________
diff is  tensor(9.0600, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1335, device='cuda:0', dtype=torch.float64)
diff is  tensor(557.4052, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2065, device='cuda:0', dtype=torch.float64)
diff is  tensor(1422.1884, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7941, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.9350, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(9.0600, device='cuda:0')
clipping
cal diff is tensor(0.1335, device='cuda:0')
clipping
cal diff is tensor(557.4053, device='cuda:0')
clipping
cal diff is tensor(0.2065, device='cuda:0')
clipping
cal diff is tensor(1422.1884, device='cuda:0')
clipping
cal diff is tensor(0.7941, device='cuda:0')
clipping
cal diff is tensor(7.9350, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(1884.7509, device='cuda:0')
test acc is  0.9293000001563203
test entropy is  0.27213747460228294
________________________________
diff is  tensor(8.5471, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1260, device='cuda:0', dtype=torch.float64)
diff is  tensor(525.8505, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1948, device='cuda:0', dtype=torch.float64)
diff is  tensor(1341.6781, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7492, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.4858, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(8.5471, device='cuda:0')
clipping
cal diff is tensor(0.1260, device='cuda:0')
clipping
cal diff is tensor(525.8505, device='cuda:0')
clipping
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(1341.6782, device='cuda:0')
clipping
cal diff is tensor(0.7492, device='cuda:0')
clipping
cal diff is tensor(7.4858, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
________________________________
test distance is  tensor(1771.6597, device='cuda:0')
test acc is  0.9368166668229867
test entropy is  0.2531969186657273
________________________________
diff is  tensor(8.0343, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1184, device='cuda:0', dtype=torch.float64)
diff is  tensor(494.2957, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1831, device='cuda:0', dtype=torch.float64)
diff is  tensor(1261.1680, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7042, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.0366, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:0', dtype=torch.float64)
cal diff is tensor(8.0343, device='cuda:0')
clipping
cal diff is tensor(0.1184, device='cuda:0')
cal diff is tensor(494.2957, device='cuda:0')
clipping
cal diff is tensor(0.1831, device='cuda:0')
clipping
cal diff is tensor(1261.1680, device='cuda:0')
clipping
cal diff is tensor(0.7042, device='cuda:0')
clipping
cal diff is tensor(7.0366, device='cuda:0')
clipping
cal diff is tensor(0.1195, device='cuda:0')
clipping
________________________________
test distance is  tensor(1658.5690, device='cuda:0')
test acc is  0.9430333334896531
test entropy is  0.235948070899637
________________________________
diff is  tensor(7.5214, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1184, device='cuda:0', dtype=torch.float64)
diff is  tensor(462.7411, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1714, device='cuda:0', dtype=torch.float64)
diff is  tensor(1180.6582, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6593, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.5874, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1118, device='cuda:0', dtype=torch.float64)
cal diff is tensor(7.5214, device='cuda:0')
clipping
cal diff is tensor(0.1184, device='cuda:0')
clipping
cal diff is tensor(462.7411, device='cuda:0')
clipping
cal diff is tensor(0.1714, device='cuda:0')
clipping
cal diff is tensor(1180.6582, device='cuda:0')
clipping
cal diff is tensor(0.6593, device='cuda:0')
clipping
cal diff is tensor(6.5874, device='cuda:0')
clipping
cal diff is tensor(0.1118, device='cuda:0')
________________________________
test distance is  tensor(1545.4783, device='cuda:0')
test acc is  0.947983333489653
test entropy is  0.2202372603785636
________________________________
diff is  tensor(7.0085, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1103, device='cuda:0', dtype=torch.float64)
diff is  tensor(431.1867, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1597, device='cuda:0', dtype=torch.float64)
diff is  tensor(1100.1488, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6143, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.1382, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1118, device='cuda:0', dtype=torch.float64)
cal diff is tensor(7.0085, device='cuda:0')
clipping
cal diff is tensor(0.1103, device='cuda:0')
clipping
cal diff is tensor(431.1867, device='cuda:0')
clipping
cal diff is tensor(0.1597, device='cuda:0')
clipping
cal diff is tensor(1100.1487, device='cuda:0')
clipping
cal diff is tensor(0.6143, device='cuda:0')
clipping
cal diff is tensor(6.1382, device='cuda:0')
clipping
cal diff is tensor(0.1118, device='cuda:0')
clipping
________________________________
test distance is  tensor(1432.3800, device='cuda:0')
test acc is  0.952633333489653
test entropy is  0.2058702948679929
________________________________
diff is  tensor(6.4956, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1023, device='cuda:0', dtype=torch.float64)
diff is  tensor(399.6324, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1480, device='cuda:0', dtype=torch.float64)
diff is  tensor(1019.6397, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5694, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.6890, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1037, device='cuda:0', dtype=torch.float64)
cal diff is tensor(6.4956, device='cuda:0')
clipping
cal diff is tensor(0.1023, device='cuda:0')
cal diff is tensor(399.6324, device='cuda:0')
clipping
cal diff is tensor(0.1480, device='cuda:0')
clipping
cal diff is tensor(1019.6398, device='cuda:0')
clipping
cal diff is tensor(0.5694, device='cuda:0')
clipping
cal diff is tensor(5.6890, device='cuda:0')
clipping
cal diff is tensor(0.1037, device='cuda:0')
clipping
________________________________
test distance is  tensor(1319.2898, device='cuda:0')
test acc is  0.9562166668229861
test entropy is  0.19290462104496417
________________________________
diff is  tensor(5.9827, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1023, device='cuda:0', dtype=torch.float64)
diff is  tensor(368.0781, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1364, device='cuda:0', dtype=torch.float64)
diff is  tensor(939.1307, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5244, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.2398, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0955, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.9827, device='cuda:0')
clipping
cal diff is tensor(0.1023, device='cuda:0')
clipping
cal diff is tensor(368.0781, device='cuda:0')
clipping
cal diff is tensor(0.1364, device='cuda:0')
clipping
cal diff is tensor(939.1307, device='cuda:0')
clipping
cal diff is tensor(0.5244, device='cuda:0')
clipping
cal diff is tensor(5.2398, device='cuda:0')
clipping
cal diff is tensor(0.0955, device='cuda:0')
________________________________
test distance is  tensor(1206.1997, device='cuda:0')
test acc is  0.9593500001563193
test entropy is  0.1811754894988941
________________________________
diff is  tensor(5.4698, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0935, device='cuda:0', dtype=torch.float64)
diff is  tensor(336.5240, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1247, device='cuda:0', dtype=torch.float64)
diff is  tensor(858.6222, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4795, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.7907, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0955, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.4698, device='cuda:0')
clipping
cal diff is tensor(0.0935, device='cuda:0')
clipping
cal diff is tensor(336.5240, device='cuda:0')
clipping
cal diff is tensor(0.1247, device='cuda:0')
clipping
cal diff is tensor(858.6222, device='cuda:0')
clipping
cal diff is tensor(0.4795, device='cuda:0')
clipping
cal diff is tensor(4.7907, device='cuda:0')
clipping
cal diff is tensor(0.0955, device='cuda:0')
clipping
________________________________
test distance is  tensor(1093.1013, device='cuda:0')
test acc is  0.9620666668229859
test entropy is  0.17049733419487598
________________________________
diff is  tensor(4.9570, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0847, device='cuda:0', dtype=torch.float64)
diff is  tensor(304.9702, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1130, device='cuda:0', dtype=torch.float64)
diff is  tensor(778.1143, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4345, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.3415, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0865, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.9570, device='cuda:0')
clipping
cal diff is tensor(0.0847, device='cuda:0')
cal diff is tensor(304.9702, device='cuda:0')
clipping
cal diff is tensor(0.1130, device='cuda:0')
clipping
cal diff is tensor(778.1143, device='cuda:0')
clipping
cal diff is tensor(0.4345, device='cuda:0')
clipping
cal diff is tensor(4.3415, device='cuda:0')
clipping
cal diff is tensor(0.0865, device='cuda:0')
clipping
________________________________
test distance is  tensor(980.0118, device='cuda:0')
test acc is  0.9643333334896526
test entropy is  0.16098551663842156
________________________________
diff is  tensor(4.4441, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0847, device='cuda:0', dtype=torch.float64)
diff is  tensor(273.4163, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1013, device='cuda:0', dtype=torch.float64)
diff is  tensor(697.6063, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3895, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.8923, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0776, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.4441, device='cuda:0')
clipping
cal diff is tensor(0.0847, device='cuda:0')
clipping
cal diff is tensor(273.4163, device='cuda:0')
clipping
cal diff is tensor(0.1013, device='cuda:0')
clipping
cal diff is tensor(697.6063, device='cuda:0')
clipping
cal diff is tensor(0.3895, device='cuda:0')
clipping
cal diff is tensor(3.8923, device='cuda:0')
clipping
cal diff is tensor(0.0776, device='cuda:0')
________________________________
test distance is  tensor(866.9225, device='cuda:0')
test acc is  0.9655666668229859
test entropy is  0.15247796488596177
________________________________
diff is  tensor(3.9312, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0750, device='cuda:0', dtype=torch.float64)
diff is  tensor(241.8627, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0896, device='cuda:0', dtype=torch.float64)
diff is  tensor(617.0990, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3446, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.4431, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0776, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.9312, device='cuda:0')
clipping
cal diff is tensor(0.0750, device='cuda:0')
cal diff is tensor(241.8627, device='cuda:0')
clipping
cal diff is tensor(0.0896, device='cuda:0')
clipping
cal diff is tensor(617.0991, device='cuda:0')
clipping
cal diff is tensor(0.3446, device='cuda:0')
clipping
cal diff is tensor(3.4431, device='cuda:0')
clipping
cal diff is tensor(0.0776, device='cuda:0')
clipping
________________________________
test distance is  tensor(753.8341, device='cuda:0')
test acc is  0.9670166668229858
test entropy is  0.14493422236428585
________________________________
diff is  tensor(3.4184, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0750, device='cuda:0', dtype=torch.float64)
diff is  tensor(210.3094, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0779, device='cuda:0', dtype=torch.float64)
diff is  tensor(536.5926, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2996, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.9939, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0675, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.4184, device='cuda:0')
clipping
cal diff is tensor(0.0750, device='cuda:0')
clipping
cal diff is tensor(210.3094, device='cuda:0')
clipping
cal diff is tensor(0.0779, device='cuda:0')
clipping
cal diff is tensor(536.5927, device='cuda:0')
clipping
cal diff is tensor(0.2996, device='cuda:0')
clipping
cal diff is tensor(2.9939, device='cuda:0')
clipping
cal diff is tensor(0.0675, device='cuda:0')
________________________________
test distance is  tensor(640.7460, device='cuda:0')
test acc is  0.9680333334896525
test entropy is  0.13831216167968347
________________________________
diff is  tensor(2.9055, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0637, device='cuda:0', dtype=torch.float64)
diff is  tensor(178.7566, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0662, device='cuda:0', dtype=torch.float64)
diff is  tensor(456.0873, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2547, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.5447, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0675, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.9055, device='cuda:0')
clipping
cal diff is tensor(0.0637, device='cuda:0')
clipping
cal diff is tensor(178.7566, device='cuda:0')
clipping
cal diff is tensor(0.0662, device='cuda:0')
clipping
cal diff is tensor(456.0873, device='cuda:0')
clipping
cal diff is tensor(0.2547, device='cuda:0')
clipping
cal diff is tensor(2.5447, device='cuda:0')
clipping
cal diff is tensor(0.0675, device='cuda:0')
clipping
________________________________
test distance is  tensor(527.6478, device='cuda:0')
test acc is  0.9691166668229858
test entropy is  0.1325314867653763
________________________________
diff is  tensor(2.3926, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0525, device='cuda:0', dtype=torch.float64)
diff is  tensor(147.2042, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0545, device='cuda:0', dtype=torch.float64)
diff is  tensor(375.5833, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2097, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.0956, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0555, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.3926, device='cuda:0')
clipping
cal diff is tensor(0.0525, device='cuda:0')
cal diff is tensor(147.2043, device='cuda:0')
clipping
cal diff is tensor(0.0545, device='cuda:0')
clipping
cal diff is tensor(375.5833, device='cuda:0')
clipping
cal diff is tensor(0.2097, device='cuda:0')
clipping
cal diff is tensor(2.0956, device='cuda:0')
clipping
cal diff is tensor(0.0555, device='cuda:0')
clipping
________________________________
test distance is  tensor(414.5609, device='cuda:0')
test acc is  0.9697666668229857
test entropy is  0.12772845880571268
________________________________
diff is  tensor(1.8798, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0525, device='cuda:0', dtype=torch.float64)
diff is  tensor(115.6519, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0428, device='cuda:0', dtype=torch.float64)
diff is  tensor(295.0792, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1648, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.6464, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0436, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.8798, device='cuda:0')
clipping
cal diff is tensor(0.0525, device='cuda:0')
clipping
cal diff is tensor(115.6519, device='cuda:0')
clipping
cal diff is tensor(0.0428, device='cuda:0')
clipping
cal diff is tensor(295.0792, device='cuda:0')
clipping
cal diff is tensor(0.1648, device='cuda:0')
clipping
cal diff is tensor(1.6464, device='cuda:0')
clipping
cal diff is tensor(0.0436, device='cuda:0')
clipping
________________________________
test distance is  tensor(301.4626, device='cuda:0')
test acc is  0.9703666668229857
test entropy is  0.12373263467111185
________________________________
diff is  tensor(1.3670, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0382, device='cuda:0', dtype=torch.float64)
diff is  tensor(84.1004, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0312, device='cuda:0', dtype=torch.float64)
diff is  tensor(214.5773, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1198, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1972, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0317, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.3670, device='cuda:0')
clipping
cal diff is tensor(0.0382, device='cuda:0')
clipping
cal diff is tensor(84.1004, device='cuda:0')
clipping
cal diff is tensor(0.0312, device='cuda:0')
cal diff is tensor(214.5773, device='cuda:0')
clipping
cal diff is tensor(0.1198, device='cuda:0')
clipping
cal diff is tensor(1.1972, device='cuda:0')
clipping
cal diff is tensor(0.0317, device='cuda:0')
clipping
________________________________
test distance is  tensor(188.3761, device='cuda:0')
test acc is  0.9707833334896523
test entropy is  0.12069888592068194
________________________________
diff is  tensor(0.8541, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0238, device='cuda:0', dtype=torch.float64)
diff is  tensor(52.5489, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0312, device='cuda:0', dtype=torch.float64)
diff is  tensor(134.0755, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0749, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7481, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0198, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.8541, device='cuda:0')
clipping
cal diff is tensor(0.0238, device='cuda:0')
clipping
cal diff is tensor(52.5489, device='cuda:0')
clipping
cal diff is tensor(0.0312, device='cuda:0')
clipping
cal diff is tensor(134.0755, device='cuda:0')
clipping
cal diff is tensor(0.0749, device='cuda:0')
clipping
cal diff is tensor(0.7481, device='cuda:0')
clipping
cal diff is tensor(0.0198, device='cuda:0')
________________________________
test distance is  tensor(75.2899, device='cuda:0')
test acc is  0.970800000156319
test entropy is  0.11857297262554166
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11857297262554166
avg test loss is  0.09344418072300568
avg accuracy is  0.970800000156319
compute_distance is  tensor(75.2899, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5099077010269104
avg test loss is  0.8437577721470201
avg accuracy is  0.7344333334896621
compute_distance is  tensor(135.1777, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(135.1777, device='cuda:0')
test acc is  0.7344333334896621
test entropy is  0.5099077010269104
________________________________
diff is  tensor(0.4601, device='cuda:0')
diff is  tensor(0.0117, device='cuda:0')
diff is  tensor(35.6658, device='cuda:0')
diff is  tensor(0.0173, device='cuda:0')
diff is  tensor(98.4876, device='cuda:0')
diff is  tensor(0.0451, device='cuda:0')
diff is  tensor(0.4642, device='cuda:0')
diff is  tensor(0.0205, device='cuda:0')
cal diff is tensor(0.4601, device='cuda:0')
clipping
cal diff is tensor(0.0117, device='cuda:0')
clipping
cal diff is tensor(35.6658, device='cuda:0')
clipping
cal diff is tensor(0.0173, device='cuda:0')
clipping
cal diff is tensor(98.4876, device='cuda:0')
clipping
cal diff is tensor(0.0451, device='cuda:0')
clipping
cal diff is tensor(0.4642, device='cuda:0')
clipping
cal diff is tensor(0.0205, device='cuda:0')
clipping
________________________________
test distance is  tensor(22.0828, device='cuda:0')
test acc is  0.9681000001563191
test entropy is  0.1341818891473607
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1341818891473607
avg test loss is  0.10208584731424859
avg accuracy is  0.9681000001563191
compute_distance is  tensor(22.0828, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5123598071367248
avg test loss is  0.8502485628194137
avg accuracy is  0.7320666668229956
compute_distance is  tensor(122.9451, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(122.9451, device='cuda:0')
test acc is  0.7320666668229956
test entropy is  0.5123598071367248
________________________________
diff is  tensor(0.3206, device='cuda:0')
diff is  tensor(0.0059, device='cuda:0')
diff is  tensor(30.6189, device='cuda:0')
diff is  tensor(0.0138, device='cuda:0')
diff is  tensor(91.5907, device='cuda:0')
diff is  tensor(0.0318, device='cuda:0')
diff is  tensor(0.3510, device='cuda:0')
diff is  tensor(0.0043, device='cuda:0')
cal diff is tensor(0.3206, device='cuda:0')
clipping
cal diff is tensor(0.0059, device='cuda:0')
clipping
cal diff is tensor(30.6189, device='cuda:0')
clipping
cal diff is tensor(0.0138, device='cuda:0')
clipping
cal diff is tensor(91.5907, device='cuda:0')
clipping
cal diff is tensor(0.0318, device='cuda:0')
clipping
cal diff is tensor(0.3510, device='cuda:0')
clipping
cal diff is tensor(0.0043, device='cuda:0')
clipping
________________________________
test distance is  tensor(9.8517, device='cuda:0')
test acc is  0.9703833334896523
test entropy is  0.12388146087241325
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12388146087241325
avg test loss is  0.09563567034248859
avg accuracy is  0.9703833334896523
compute_distance is  tensor(9.8517, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5115687442677361
avg test loss is  0.8478318017238239
avg accuracy is  0.7329333334896623
compute_distance is  tensor(117.3395, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(117.3395, device='cuda:0')
test acc is  0.7329333334896623
test entropy is  0.5115687442677361
________________________________
diff is  tensor(0.3054, device='cuda:0')
diff is  tensor(0.0054, device='cuda:0')
diff is  tensor(29.0551, device='cuda:0')
diff is  tensor(0.0134, device='cuda:0')
diff is  tensor(87.5799, device='cuda:0')
diff is  tensor(0.0314, device='cuda:0')
diff is  tensor(0.3409, device='cuda:0')
diff is  tensor(0.0023, device='cuda:0')
cal diff is tensor(0.3054, device='cuda:0')
clipping
cal diff is tensor(0.0054, device='cuda:0')
clipping
cal diff is tensor(29.0551, device='cuda:0')
clipping
cal diff is tensor(0.0134, device='cuda:0')
clipping
cal diff is tensor(87.5799, device='cuda:0')
clipping
cal diff is tensor(0.0314, device='cuda:0')
clipping
cal diff is tensor(0.3409, device='cuda:0')
clipping
cal diff is tensor(0.0023, device='cuda:0')
clipping
________________________________
test distance is  tensor(4.2451, device='cuda:0')
test acc is  0.9707833334896523
test entropy is  0.12018109818717945
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12018109818717945
avg test loss is  0.09387000172740535
avg accuracy is  0.9707833334896523
compute_distance is  tensor(4.2451, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5107425946289542
avg test loss is  0.8454208759102486
avg accuracy is  0.7336833334896623
compute_distance is  tensor(113.8427, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(113.8427, device='cuda:0')
test acc is  0.7336833334896623
test entropy is  0.5107425946289542
________________________________
diff is  tensor(0.3017, device='cuda:0')
diff is  tensor(0.0054, device='cuda:0')
diff is  tensor(27.9429, device='cuda:0')
diff is  tensor(0.0132, device='cuda:0')
diff is  tensor(85.2017, device='cuda:0')
diff is  tensor(0.0317, device='cuda:0')
diff is  tensor(0.3400, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
cal diff is tensor(0.3017, device='cuda:0')
clipping
cal diff is tensor(0.0054, device='cuda:0')
clipping
cal diff is tensor(27.9429, device='cuda:0')
clipping
cal diff is tensor(0.0132, device='cuda:0')
clipping
cal diff is tensor(85.2017, device='cuda:0')
clipping
cal diff is tensor(0.0317, device='cuda:0')
clipping
cal diff is tensor(0.3400, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
________________________________
test distance is  tensor(0.7503, device='cuda:0')
test acc is  0.9709833334896523
test entropy is  0.11802278548828575
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11802278548828575
avg test loss is  0.09304839841920191
avg accuracy is  0.9709833334896523
compute_distance is  tensor(0.7503, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5098817234418032
avg test loss is  0.8434567108655027
avg accuracy is  0.7347833334896622
compute_distance is  tensor(111.6158, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(111.6158, device='cuda:0')
test acc is  0.7347833334896622
test entropy is  0.5098817234418032
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 94.11% 

Test Accuracy: 93.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0008932420751079917
len of model dicts is  10
compute distance is  tensor(39.2054, device='cuda:0')
compute distance is  tensor(46.4859, device='cuda:0')
compute distance is  tensor(119.6615, device='cuda:0')
compute distance is  tensor(74.1782, device='cuda:0')
compute distance is  tensor(69.1991, device='cuda:0')
compute distance is  tensor(40.5289, device='cuda:0')
compute distance is  tensor(107.2019, device='cuda:0')
compute distance is  tensor(62.7474, device='cuda:0')
compute distance is  tensor(116.9159, device='cuda:0')
compute distance is  tensor(56.5108, device='cuda:0')
calculated distance threshold is  tensor(103.5703, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.9242833334896539
====================
====================
iteration is  0
round is  1
accuracy is  0.9324666668229868
====================
====================
iteration is  0
round is  2
accuracy is  0.9180500001563207
====================
====================
iteration is  1
round is  0
accuracy is  0.919733333489654
====================
====================
iteration is  1
round is  1
accuracy is  0.9247833334896539
====================
====================
iteration is  1
round is  2
accuracy is  0.9229000001563206
====================
====================
iteration is  2
round is  0
accuracy is  0.921733333489654
====================
====================
iteration is  2
round is  1
accuracy is  0.930816666822987
====================
====================
iteration is  2
round is  2
accuracy is  0.9228833334896539
====================
====================
iteration is  3
round is  0
accuracy is  0.9264166668229871
====================
====================
iteration is  3
round is  1
accuracy is  0.909500000156321
====================
====================
iteration is  3
round is  2
accuracy is  0.9121000001563209
====================
====================
iteration is  4
round is  0
accuracy is  0.9245166668229872
====================
====================
iteration is  4
round is  1
accuracy is  0.9170000001563207
====================
====================
iteration is  4
round is  2
accuracy is  0.9179000001563207
====================
====================
iteration is  5
round is  0
accuracy is  0.9075166668229878
====================
====================
iteration is  5
round is  1
accuracy is  0.9164166668229875
====================
====================
iteration is  5
round is  2
accuracy is  0.9247666668229872
====================
====================
iteration is  6
round is  0
accuracy is  0.9151666668229874
====================
====================
iteration is  6
round is  1
accuracy is  0.920333333489654
====================
====================
iteration is  6
round is  2
accuracy is  0.9057500001563211
====================
====================
iteration is  7
round is  0
accuracy is  0.9236666668229873
====================
====================
iteration is  7
round is  1
accuracy is  0.9301500001563203
====================
====================
iteration is  7
round is  2
accuracy is  0.9126000001563209
====================
====================
iteration is  8
round is  0
accuracy is  0.9347000001563202
====================
====================
iteration is  8
round is  1
accuracy is  0.9059833334896545
====================
====================
iteration is  8
round is  2
accuracy is  0.903266666822988
====================
====================
iteration is  9
round is  0
accuracy is  0.9063666668229878
====================
====================
iteration is  9
round is  1
accuracy is  0.9229000001563206
====================
====================
iteration is  9
round is  2
accuracy is  0.8977166668229882
====================
====================
iteration is  10
round is  0
accuracy is  0.9045333334896546
====================
====================
iteration is  10
round is  1
accuracy is  0.9136166668229875
====================
====================
iteration is  10
round is  2
accuracy is  0.8949833334896549
====================
====================
iteration is  11
round is  0
accuracy is  0.8905166668229885
====================
====================
iteration is  11
round is  1
accuracy is  0.875266666822989
====================
====================
iteration is  11
round is  2
accuracy is  0.8958000001563216
====================
====================
iteration is  12
round is  0
accuracy is  0.8770000001563223
====================
====================
iteration is  12
round is  1
accuracy is  0.9039333334896547
====================
====================
iteration is  12
round is  2
accuracy is  0.9082000001563211
====================
====================
iteration is  13
round is  0
accuracy is  0.9060833334896545
====================
====================
iteration is  13
round is  1
accuracy is  0.9225500001563206
====================
====================
iteration is  13
round is  2
accuracy is  0.9078666668229878
====================
====================
iteration is  14
round is  0
accuracy is  0.9077166668229878
====================
====================
iteration is  14
round is  1
accuracy is  0.8611500001563229
====================
succ_min + 1
====================
iteration is  14
round is  2
accuracy is  0.8919666668229883
====================
====================
iteration is  15
round is  0
accuracy is  0.8836166668229887
====================
====================
iteration is  15
round is  1
accuracy is  0.8720833334896558
====================
====================
iteration is  15
round is  2
accuracy is  0.8596833334896563
====================
succ_min + 1
====================
iteration is  16
round is  0
accuracy is  0.9016500001563214
====================
====================
iteration is  16
round is  1
accuracy is  0.8431000001563237
====================
succ_min + 1
====================
iteration is  16
round is  2
accuracy is  0.8188166668229913
====================
succ_min + 1
________________________________
test distance is  tensor(2350.0698, device='cuda:0')
test acc is  0.8188166668229913
test entropy is  0.3871664393113366
________________________________
diff is  tensor(10.1056, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1681, device='cuda:0', dtype=torch.float64)
diff is  tensor(656.0592, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2395, device='cuda:0', dtype=torch.float64)
diff is  tensor(1673.1495, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9288, device='cuda:0', dtype=torch.float64)
diff is  tensor(9.3332, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(10.1056, device='cuda:0')
clipping
cal diff is tensor(0.1681, device='cuda:0')
clipping
cal diff is tensor(656.0592, device='cuda:0')
clipping
cal diff is tensor(0.2395, device='cuda:0')
clipping
cal diff is tensor(1673.1497, device='cuda:0')
clipping
cal diff is tensor(0.9288, device='cuda:0')
clipping
cal diff is tensor(9.3333, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(2246.5029, device='cuda:0')
test acc is  0.8326666668229907
test entropy is  0.3681934416961314
________________________________
diff is  tensor(9.6602, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1607, device='cuda:0', dtype=torch.float64)
diff is  tensor(627.1458, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2289, device='cuda:0', dtype=torch.float64)
diff is  tensor(1599.4116, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8879, device='cuda:0', dtype=torch.float64)
diff is  tensor(8.9219, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(9.6602, device='cuda:0')
clipping
cal diff is tensor(0.1607, device='cuda:0')
clipping
cal diff is tensor(627.1458, device='cuda:0')
clipping
cal diff is tensor(0.2289, device='cuda:0')
clipping
cal diff is tensor(1599.4116, device='cuda:0')
clipping
cal diff is tensor(0.8879, device='cuda:0')
clipping
cal diff is tensor(8.9219, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(2142.9363, device='cuda:0')
test acc is  0.843583333489657
test entropy is  0.34932539710548643
________________________________
diff is  tensor(9.2148, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1533, device='cuda:0', dtype=torch.float64)
diff is  tensor(598.2325, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2184, device='cuda:0', dtype=torch.float64)
diff is  tensor(1525.6738, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8469, device='cuda:0', dtype=torch.float64)
diff is  tensor(8.5106, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(9.2148, device='cuda:0')
clipping
cal diff is tensor(0.1533, device='cuda:0')
clipping
cal diff is tensor(598.2324, device='cuda:0')
clipping
cal diff is tensor(0.2184, device='cuda:0')
clipping
cal diff is tensor(1525.6738, device='cuda:0')
clipping
cal diff is tensor(0.8469, device='cuda:0')
clipping
cal diff is tensor(8.5106, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(2039.3700, device='cuda:0')
test acc is  0.8528000001563232
test entropy is  0.330882779110088
________________________________
diff is  tensor(8.7695, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1459, device='cuda:0', dtype=torch.float64)
diff is  tensor(569.3192, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2078, device='cuda:0', dtype=torch.float64)
diff is  tensor(1451.9362, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8060, device='cuda:0', dtype=torch.float64)
diff is  tensor(8.0993, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(8.7695, device='cuda:0')
clipping
cal diff is tensor(0.1459, device='cuda:0')
clipping
cal diff is tensor(569.3192, device='cuda:0')
clipping
cal diff is tensor(0.2078, device='cuda:0')
clipping
cal diff is tensor(1451.9362, device='cuda:0')
clipping
cal diff is tensor(0.8060, device='cuda:0')
clipping
cal diff is tensor(8.0993, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1935.8040, device='cuda:0')
test acc is  0.8614000001563229
test entropy is  0.3131648078878551
________________________________
diff is  tensor(8.3241, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1385, device='cuda:0', dtype=torch.float64)
diff is  tensor(540.4060, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1973, device='cuda:0', dtype=torch.float64)
diff is  tensor(1378.1989, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7651, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.6879, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(8.3241, device='cuda:0')
clipping
cal diff is tensor(0.1385, device='cuda:0')
clipping
cal diff is tensor(540.4060, device='cuda:0')
clipping
cal diff is tensor(0.1973, device='cuda:0')
clipping
cal diff is tensor(1378.1990, device='cuda:0')
clipping
cal diff is tensor(0.7651, device='cuda:0')
clipping
cal diff is tensor(7.6879, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1832.2382, device='cuda:0')
test acc is  0.868883333489656
test entropy is  0.29641149585435134
________________________________
diff is  tensor(7.8788, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1311, device='cuda:0', dtype=torch.float64)
diff is  tensor(511.4929, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1867, device='cuda:0', dtype=torch.float64)
diff is  tensor(1304.4617, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7241, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.2766, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(7.8788, device='cuda:0')
clipping
cal diff is tensor(0.1311, device='cuda:0')
clipping
cal diff is tensor(511.4929, device='cuda:0')
clipping
cal diff is tensor(0.1867, device='cuda:0')
clipping
cal diff is tensor(1304.4617, device='cuda:0')
clipping
cal diff is tensor(0.7241, device='cuda:0')
clipping
cal diff is tensor(7.2766, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1728.6726, device='cuda:0')
test acc is  0.8746000001563223
test entropy is  0.28071973639637676
________________________________
diff is  tensor(7.4334, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1237, device='cuda:0', dtype=torch.float64)
diff is  tensor(482.5799, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1762, device='cuda:0', dtype=torch.float64)
diff is  tensor(1230.7248, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6832, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.8653, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(7.4334, device='cuda:0')
clipping
cal diff is tensor(0.1237, device='cuda:0')
clipping
cal diff is tensor(482.5799, device='cuda:0')
clipping
cal diff is tensor(0.1762, device='cuda:0')
clipping
cal diff is tensor(1230.7249, device='cuda:0')
clipping
cal diff is tensor(0.6832, device='cuda:0')
clipping
cal diff is tensor(6.8653, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1625.1074, device='cuda:0')
test acc is  0.8806666668229888
test entropy is  0.2661623320917585
________________________________
diff is  tensor(6.9880, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1163, device='cuda:0', dtype=torch.float64)
diff is  tensor(453.6670, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1656, device='cuda:0', dtype=torch.float64)
diff is  tensor(1156.9881, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6423, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.4540, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(6.9880, device='cuda:0')
clipping
cal diff is tensor(0.1163, device='cuda:0')
clipping
cal diff is tensor(453.6670, device='cuda:0')
clipping
cal diff is tensor(0.1656, device='cuda:0')
clipping
cal diff is tensor(1156.9880, device='cuda:0')
clipping
cal diff is tensor(0.6423, device='cuda:0')
clipping
cal diff is tensor(6.4540, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1521.5425, device='cuda:0')
test acc is  0.8865166668229886
test entropy is  0.25273859264976434
________________________________
diff is  tensor(6.5427, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1089, device='cuda:0', dtype=torch.float64)
diff is  tensor(424.7542, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1550, device='cuda:0', dtype=torch.float64)
diff is  tensor(1083.2516, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6013, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.0427, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(6.5427, device='cuda:0')
clipping
cal diff is tensor(0.1089, device='cuda:0')
clipping
cal diff is tensor(424.7542, device='cuda:0')
clipping
cal diff is tensor(0.1550, device='cuda:0')
clipping
cal diff is tensor(1083.2516, device='cuda:0')
clipping
cal diff is tensor(0.6013, device='cuda:0')
clipping
cal diff is tensor(6.0427, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1417.9780, device='cuda:0')
test acc is  0.8918000001563217
test entropy is  0.24042420978866405
________________________________
diff is  tensor(6.0973, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1014, device='cuda:0', dtype=torch.float64)
diff is  tensor(395.8414, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1445, device='cuda:0', dtype=torch.float64)
diff is  tensor(1009.5154, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5604, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.6313, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(6.0973, device='cuda:0')
clipping
cal diff is tensor(0.1014, device='cuda:0')
clipping
cal diff is tensor(395.8414, device='cuda:0')
clipping
cal diff is tensor(0.1445, device='cuda:0')
clipping
cal diff is tensor(1009.5154, device='cuda:0')
clipping
cal diff is tensor(0.5604, device='cuda:0')
clipping
cal diff is tensor(5.6313, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1314.4139, device='cuda:0')
test acc is  0.8959666668229882
test entropy is  0.22917462898882976
________________________________
diff is  tensor(5.6520, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0940, device='cuda:0', dtype=torch.float64)
diff is  tensor(366.9288, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1339, device='cuda:0', dtype=torch.float64)
diff is  tensor(935.7795, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5195, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.2200, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.6520, device='cuda:0')
clipping
cal diff is tensor(0.0940, device='cuda:0')
clipping
cal diff is tensor(366.9288, device='cuda:0')
clipping
cal diff is tensor(0.1339, device='cuda:0')
clipping
cal diff is tensor(935.7795, device='cuda:0')
clipping
cal diff is tensor(0.5195, device='cuda:0')
clipping
cal diff is tensor(5.2200, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1210.8503, device='cuda:0')
test acc is  0.9001500001563214
test entropy is  0.21890829753742289
________________________________
diff is  tensor(5.2066, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0866, device='cuda:0', dtype=torch.float64)
diff is  tensor(338.0163, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1234, device='cuda:0', dtype=torch.float64)
diff is  tensor(862.0439, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4785, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.8087, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.2066, device='cuda:0')
clipping
cal diff is tensor(0.0866, device='cuda:0')
clipping
cal diff is tensor(338.0164, device='cuda:0')
clipping
cal diff is tensor(0.1234, device='cuda:0')
clipping
cal diff is tensor(862.0439, device='cuda:0')
clipping
cal diff is tensor(0.4785, device='cuda:0')
clipping
cal diff is tensor(4.8087, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
________________________________
test distance is  tensor(1107.2872, device='cuda:0')
test acc is  0.9038500001563213
test entropy is  0.209542103119687
________________________________
diff is  tensor(4.7613, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0792, device='cuda:0', dtype=torch.float64)
diff is  tensor(309.1040, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1128, device='cuda:0', dtype=torch.float64)
diff is  tensor(788.3088, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4376, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.3974, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0863, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.7613, device='cuda:0')
clipping
cal diff is tensor(0.0792, device='cuda:0')
clipping
cal diff is tensor(309.1040, device='cuda:0')
clipping
cal diff is tensor(0.1128, device='cuda:0')
clipping
cal diff is tensor(788.3088, device='cuda:0')
clipping
cal diff is tensor(0.4376, device='cuda:0')
clipping
cal diff is tensor(4.3974, device='cuda:0')
clipping
cal diff is tensor(0.0863, device='cuda:0')
clipping
________________________________
test distance is  tensor(1003.7167, device='cuda:0')
test acc is  0.9075500001563211
test entropy is  0.20110236871630144
________________________________
diff is  tensor(4.3159, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0718, device='cuda:0', dtype=torch.float64)
diff is  tensor(280.1919, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1023, device='cuda:0', dtype=torch.float64)
diff is  tensor(714.5741, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3967, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.9861, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0782, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.3159, device='cuda:0')
clipping
cal diff is tensor(0.0718, device='cuda:0')
clipping
cal diff is tensor(280.1919, device='cuda:0')
clipping
cal diff is tensor(0.1023, device='cuda:0')
clipping
cal diff is tensor(714.5740, device='cuda:0')
clipping
cal diff is tensor(0.3967, device='cuda:0')
clipping
cal diff is tensor(3.9861, device='cuda:0')
clipping
cal diff is tensor(0.0782, device='cuda:0')
clipping
________________________________
test distance is  tensor(900.1462, device='cuda:0')
test acc is  0.9108500001563209
test entropy is  0.1934233957182751
________________________________
diff is  tensor(3.8706, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0644, device='cuda:0', dtype=torch.float64)
diff is  tensor(251.2797, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0917, device='cuda:0', dtype=torch.float64)
diff is  tensor(640.8393, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3557, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.5748, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0701, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.8706, device='cuda:0')
clipping
cal diff is tensor(0.0644, device='cuda:0')
cal diff is tensor(251.2797, device='cuda:0')
clipping
cal diff is tensor(0.0917, device='cuda:0')
clipping
cal diff is tensor(640.8393, device='cuda:0')
clipping
cal diff is tensor(0.3557, device='cuda:0')
clipping
cal diff is tensor(3.5748, device='cuda:0')
clipping
cal diff is tensor(0.0701, device='cuda:0')
clipping
________________________________
test distance is  tensor(796.5832, device='cuda:0')
test acc is  0.9139000001563208
test entropy is  0.1864737751903628
________________________________
diff is  tensor(3.4252, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0644, device='cuda:0', dtype=torch.float64)
diff is  tensor(222.3676, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0812, device='cuda:0', dtype=torch.float64)
diff is  tensor(567.1046, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3148, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.1635, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0621, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.4252, device='cuda:0')
clipping
cal diff is tensor(0.0644, device='cuda:0')
clipping
cal diff is tensor(222.3676, device='cuda:0')
clipping
cal diff is tensor(0.0812, device='cuda:0')
clipping
cal diff is tensor(567.1046, device='cuda:0')
clipping
cal diff is tensor(0.3148, device='cuda:0')
clipping
cal diff is tensor(3.1635, device='cuda:0')
clipping
cal diff is tensor(0.0621, device='cuda:0')
________________________________
test distance is  tensor(693.0208, device='cuda:0')
test acc is  0.9166166668229875
test entropy is  0.18015245314854295
________________________________
diff is  tensor(2.9799, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0560, device='cuda:0', dtype=torch.float64)
diff is  tensor(193.4557, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0706, device='cuda:0', dtype=torch.float64)
diff is  tensor(493.3706, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2739, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.7521, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0621, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.9799, device='cuda:0')
clipping
cal diff is tensor(0.0560, device='cuda:0')
clipping
cal diff is tensor(193.4557, device='cuda:0')
clipping
cal diff is tensor(0.0706, device='cuda:0')
clipping
cal diff is tensor(493.3706, device='cuda:0')
clipping
cal diff is tensor(0.2739, device='cuda:0')
clipping
cal diff is tensor(2.7521, device='cuda:0')
clipping
cal diff is tensor(0.0621, device='cuda:0')
clipping
________________________________
test distance is  tensor(589.4504, device='cuda:0')
test acc is  0.919233333489654
test entropy is  0.17458944402333262
________________________________
diff is  tensor(2.5345, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0477, device='cuda:0', dtype=torch.float64)
diff is  tensor(164.5442, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0601, device='cuda:0', dtype=torch.float64)
diff is  tensor(419.6374, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2330, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.3408, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0528, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.5345, device='cuda:0')
clipping
cal diff is tensor(0.0477, device='cuda:0')
cal diff is tensor(164.5442, device='cuda:0')
clipping
cal diff is tensor(0.0601, device='cuda:0')
clipping
cal diff is tensor(419.6375, device='cuda:0')
clipping
cal diff is tensor(0.2330, device='cuda:0')
clipping
cal diff is tensor(2.3408, device='cuda:0')
clipping
cal diff is tensor(0.0528, device='cuda:0')
clipping
________________________________
test distance is  tensor(485.8883, device='cuda:0')
test acc is  0.921483333489654
test entropy is  0.1697368334526065
________________________________
diff is  tensor(2.0892, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0477, device='cuda:0', dtype=torch.float64)
diff is  tensor(135.6327, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0495, device='cuda:0', dtype=torch.float64)
diff is  tensor(345.9043, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1920, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.9295, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0435, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.0892, device='cuda:0')
clipping
cal diff is tensor(0.0477, device='cuda:0')
clipping
cal diff is tensor(135.6327, device='cuda:0')
clipping
cal diff is tensor(0.0495, device='cuda:0')
clipping
cal diff is tensor(345.9043, device='cuda:0')
clipping
cal diff is tensor(0.1920, device='cuda:0')
clipping
cal diff is tensor(1.9295, device='cuda:0')
clipping
cal diff is tensor(0.0435, device='cuda:0')
________________________________
test distance is  tensor(382.3272, device='cuda:0')
test acc is  0.9229666668229872
test entropy is  0.16558490915180268
________________________________
diff is  tensor(1.6439, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0375, device='cuda:0', dtype=torch.float64)
diff is  tensor(106.7217, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0390, device='cuda:0', dtype=torch.float64)
diff is  tensor(272.1725, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1511, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.5182, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0435, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.6439, device='cuda:0')
clipping
cal diff is tensor(0.0375, device='cuda:0')
clipping
cal diff is tensor(106.7217, device='cuda:0')
clipping
cal diff is tensor(0.0390, device='cuda:0')
clipping
cal diff is tensor(272.1725, device='cuda:0')
clipping
cal diff is tensor(0.1511, device='cuda:0')
clipping
cal diff is tensor(1.5182, device='cuda:0')
clipping
cal diff is tensor(0.0435, device='cuda:0')
clipping
________________________________
test distance is  tensor(278.7568, device='cuda:0')
test acc is  0.9243166668229872
test entropy is  0.16223033971544396
________________________________
diff is  tensor(1.1986, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0273, device='cuda:0', dtype=torch.float64)
diff is  tensor(77.8113, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0284, device='cuda:0', dtype=torch.float64)
diff is  tensor(198.4424, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1102, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1070, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0317, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.1986, device='cuda:0')
clipping
cal diff is tensor(0.0273, device='cuda:0')
clipping
cal diff is tensor(77.8113, device='cuda:0')
clipping
cal diff is tensor(0.0284, device='cuda:0')
clipping
cal diff is tensor(198.4424, device='cuda:0')
clipping
cal diff is tensor(0.1102, device='cuda:0')
clipping
cal diff is tensor(1.1070, device='cuda:0')
clipping
cal diff is tensor(0.0317, device='cuda:0')
clipping
________________________________
test distance is  tensor(175.1864, device='cuda:0')
test acc is  0.9254000001563205
test entropy is  0.15966287726310016
________________________________
diff is  tensor(0.7532, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0172, device='cuda:0', dtype=torch.float64)
diff is  tensor(48.9010, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0179, device='cuda:0', dtype=torch.float64)
diff is  tensor(124.7123, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0692, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6957, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0199, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.7532, device='cuda:0')
clipping
cal diff is tensor(0.0172, device='cuda:0')
clipping
cal diff is tensor(48.9010, device='cuda:0')
clipping
cal diff is tensor(0.0179, device='cuda:0')
clipping
cal diff is tensor(124.7123, device='cuda:0')
clipping
cal diff is tensor(0.0692, device='cuda:0')
clipping
cal diff is tensor(0.6957, device='cuda:0')
clipping
cal diff is tensor(0.0199, device='cuda:0')
clipping
________________________________
test distance is  tensor(71.6160, device='cuda:0')
test acc is  0.9261333334896538
test entropy is  0.15786411413458237
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15786411413458237
avg test loss is  0.1917081832536248
avg accuracy is  0.9261333334896538
compute_distance is  tensor(71.6160, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.35876595964436847
avg test loss is  0.4817879230641861
avg accuracy is  0.8287666668229908
compute_distance is  tensor(124.4687, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(124.4687, device='cuda:0')
test acc is  0.8287666668229908
test entropy is  0.35876595964436847
________________________________
diff is  tensor(0.4031, device='cuda:0')
diff is  tensor(0.0092, device='cuda:0')
diff is  tensor(31.1716, device='cuda:0')
diff is  tensor(0.0118, device='cuda:0')
diff is  tensor(92.4186, device='cuda:0')
diff is  tensor(0.0363, device='cuda:0')
diff is  tensor(0.4039, device='cuda:0')
diff is  tensor(0.0081, device='cuda:0')
cal diff is tensor(0.4031, device='cuda:0')
clipping
cal diff is tensor(0.0092, device='cuda:0')
clipping
cal diff is tensor(31.1716, device='cuda:0')
clipping
cal diff is tensor(0.0118, device='cuda:0')
clipping
cal diff is tensor(92.4186, device='cuda:0')
clipping
cal diff is tensor(0.0363, device='cuda:0')
clipping
cal diff is tensor(0.4039, device='cuda:0')
clipping
cal diff is tensor(0.0081, device='cuda:0')
clipping
________________________________
test distance is  tensor(20.9021, device='cuda:0')
test acc is  0.919583333489654
test entropy is  0.17002845459035845
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17002845459035845
avg test loss is  0.20884134552117858
avg accuracy is  0.919583333489654
compute_distance is  tensor(20.9021, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3607885354617511
avg test loss is  0.4840443392298115
avg accuracy is  0.8282333334896577
compute_distance is  tensor(112.3684, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(112.3684, device='cuda:0')
test acc is  0.8282333334896577
test entropy is  0.3607885354617511
________________________________
diff is  tensor(0.2652, device='cuda:0')
diff is  tensor(0.0050, device='cuda:0')
diff is  tensor(25.1029, device='cuda:0')
diff is  tensor(0.0119, device='cuda:0')
diff is  tensor(86.6636, device='cuda:0')
diff is  tensor(0.0226, device='cuda:0')
diff is  tensor(0.2854, device='cuda:0')
diff is  tensor(0.0020, device='cuda:0')
cal diff is tensor(0.2652, device='cuda:0')
clipping
cal diff is tensor(0.0050, device='cuda:0')
clipping
cal diff is tensor(25.1029, device='cuda:0')
clipping
cal diff is tensor(0.0119, device='cuda:0')
clipping
cal diff is tensor(86.6636, device='cuda:0')
clipping
cal diff is tensor(0.0226, device='cuda:0')
clipping
cal diff is tensor(0.2854, device='cuda:0')
clipping
cal diff is tensor(0.0020, device='cuda:0')
clipping
________________________________
test distance is  tensor(8.8037, device='cuda:0')
test acc is  0.9235500001563206
test entropy is  0.16244991417569138
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16244991417569138
avg test loss is  0.19828626610982075
avg accuracy is  0.9235500001563206
compute_distance is  tensor(8.8037, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3600108561707712
avg test loss is  0.48308621219861736
avg accuracy is  0.8280833334896577
compute_distance is  tensor(106.2211, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(106.2211, device='cuda:0')
test acc is  0.8280833334896577
test entropy is  0.3600108561707712
________________________________
diff is  tensor(0.2464, device='cuda:0')
diff is  tensor(0.0045, device='cuda:0')
diff is  tensor(23.5770, device='cuda:0')
diff is  tensor(0.0118, device='cuda:0')
diff is  tensor(82.0764, device='cuda:0')
diff is  tensor(0.0218, device='cuda:0')
diff is  tensor(0.2742, device='cuda:0')
diff is  tensor(0.0016, device='cuda:0')
cal diff is tensor(0.2464, device='cuda:0')
clipping
cal diff is tensor(0.0045, device='cuda:0')
clipping
cal diff is tensor(23.5770, device='cuda:0')
clipping
cal diff is tensor(0.0118, device='cuda:0')
clipping
cal diff is tensor(82.0764, device='cuda:0')
clipping
cal diff is tensor(0.0218, device='cuda:0')
clipping
cal diff is tensor(0.2742, device='cuda:0')
clipping
cal diff is tensor(0.0016, device='cuda:0')
clipping
________________________________
test distance is  tensor(2.6557, device='cuda:0')
test acc is  0.9255833334896537
test entropy is  0.1587216571283175
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1587216571283175
avg test loss is  0.19314341047314057
avg accuracy is  0.9255833334896537
compute_distance is  tensor(2.6557, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3591868780664544
avg test loss is  0.4822182059288025
avg accuracy is  0.828516666822991
compute_distance is  tensor(101.9417, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(101.9417, device='cuda:0')
test acc is  0.828516666822991
test entropy is  0.3591868780664544
________________________________
new distance ratio is 0.8
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 93.32% 

Test Accuracy: 91.80% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0007598014199174941
len of model dicts is  10
compute distance is  tensor(36.3815, device='cuda:0')
compute distance is  tensor(48.7807, device='cuda:0')
compute distance is  tensor(75.1642, device='cuda:0')
compute distance is  tensor(72.4120, device='cuda:0')
compute distance is  tensor(72.1222, device='cuda:0')
compute distance is  tensor(87.3783, device='cuda:0')
compute distance is  tensor(92.5627, device='cuda:0')
compute distance is  tensor(54.9833, device='cuda:0')
compute distance is  tensor(122.5107, device='cuda:0')
compute distance is  tensor(26.5962, device='cuda:0')
calculated distance threshold is  tensor(103.3278, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.9252833334896537
====================
====================
iteration is  0
round is  1
accuracy is  0.922183333489654
====================
====================
iteration is  0
round is  2
accuracy is  0.9235500001563206
====================
====================
iteration is  1
round is  0
accuracy is  0.9089833334896543
====================
====================
iteration is  1
round is  1
accuracy is  0.9168666668229875
====================
====================
iteration is  1
round is  2
accuracy is  0.9192666668229873
====================
====================
iteration is  2
round is  0
accuracy is  0.9137333334896542
====================
====================
iteration is  2
round is  1
accuracy is  0.9093166668229877
====================
====================
iteration is  2
round is  2
accuracy is  0.909850000156321
====================
====================
iteration is  3
round is  0
accuracy is  0.8933000001563216
====================
====================
iteration is  3
round is  1
accuracy is  0.9100333334896543
====================
====================
iteration is  3
round is  2
accuracy is  0.9194500001563207
====================
====================
iteration is  4
round is  0
accuracy is  0.9152500001563207
====================
====================
iteration is  4
round is  1
accuracy is  0.9078000001563211
====================
====================
iteration is  4
round is  2
accuracy is  0.9021000001563213
====================
====================
iteration is  5
round is  0
accuracy is  0.8970833334896549
====================
====================
iteration is  5
round is  1
accuracy is  0.9148166668229875
====================
====================
iteration is  5
round is  2
accuracy is  0.9044333334896546
====================
====================
iteration is  6
round is  0
accuracy is  0.9151166668229874
====================
====================
iteration is  6
round is  1
accuracy is  0.9055000001563211
====================
====================
iteration is  6
round is  2
accuracy is  0.9134333334896543
====================
====================
iteration is  7
round is  0
accuracy is  0.8980000001563215
====================
====================
iteration is  7
round is  1
accuracy is  0.8849833334896553
====================
====================
iteration is  7
round is  2
accuracy is  0.909450000156321
====================
====================
iteration is  8
round is  0
accuracy is  0.9051833334896545
====================
====================
iteration is  8
round is  1
accuracy is  0.8907166668229884
====================
====================
iteration is  8
round is  2
accuracy is  0.9058000001563211
====================
====================
iteration is  9
round is  0
accuracy is  0.9090333334896544
====================
====================
iteration is  9
round is  1
accuracy is  0.8883666668229886
====================
====================
iteration is  9
round is  2
accuracy is  0.8838333334896553
====================
====================
iteration is  10
round is  0
accuracy is  0.9245833334896539
====================
====================
iteration is  10
round is  1
accuracy is  0.8952833334896549
====================
====================
iteration is  10
round is  2
accuracy is  0.9070166668229879
====================
====================
iteration is  11
round is  0
accuracy is  0.8901166668229885
====================
====================
iteration is  11
round is  1
accuracy is  0.8873333334896553
====================
====================
iteration is  11
round is  2
accuracy is  0.858700000156323
====================
succ_min + 1
====================
iteration is  12
round is  0
accuracy is  0.8787833334896555
====================
====================
iteration is  12
round is  1
accuracy is  0.8912500001563217
====================
====================
iteration is  12
round is  2
accuracy is  0.8835833334896553
====================
====================
iteration is  13
round is  0
accuracy is  0.8808166668229888
====================
====================
iteration is  13
round is  1
accuracy is  0.8768833334896556
====================
====================
iteration is  13
round is  2
accuracy is  0.8994500001563214
====================
====================
iteration is  14
round is  0
accuracy is  0.8474500001563234
====================
succ_min + 1
====================
iteration is  14
round is  1
accuracy is  0.8821000001563221
====================
====================
iteration is  14
round is  2
accuracy is  0.8692666668229893
====================
====================
iteration is  15
round is  0
accuracy is  0.8795000001563222
====================
====================
iteration is  15
round is  1
accuracy is  0.8760666668229891
====================
====================
iteration is  15
round is  2
accuracy is  0.874416666822989
====================
====================
iteration is  16
round is  0
accuracy is  0.8871166668229885
====================
====================
iteration is  16
round is  1
accuracy is  0.84961666682299
====================
====================
iteration is  16
round is  2
accuracy is  0.8556333334896564
====================
________________________________
test distance is  tensor(1937.0312, device='cuda:0')
test acc is  0.8474500001563234
test entropy is  0.2596110583368395
________________________________
diff is  tensor(8.4853, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1426, device='cuda:0', dtype=torch.float64)
diff is  tensor(537.0674, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1823, device='cuda:0', dtype=torch.float64)
diff is  tensor(1382.6196, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7730, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.6946, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0663, device='cuda:0', dtype=torch.float64)
cal diff is tensor(8.4853, device='cuda:0')
clipping
cal diff is tensor(0.1426, device='cuda:0')
clipping
cal diff is tensor(537.0674, device='cuda:0')
clipping
cal diff is tensor(0.1823, device='cuda:0')
clipping
cal diff is tensor(1382.6195, device='cuda:0')
clipping
cal diff is tensor(0.7730, device='cuda:0')
clipping
cal diff is tensor(7.6946, device='cuda:0')
clipping
cal diff is tensor(0.0663, device='cuda:0')
clipping
________________________________
test distance is  tensor(1833.7034, device='cuda:0')
test acc is  0.8555166668229898
test entropy is  0.2521247758841845
________________________________
diff is  tensor(8.0327, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1350, device='cuda:0', dtype=torch.float64)
diff is  tensor(508.4184, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1725, device='cuda:0', dtype=torch.float64)
diff is  tensor(1308.8660, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7318, device='cuda:0', dtype=torch.float64)
diff is  tensor(7.2841, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0628, device='cuda:0', dtype=torch.float64)
cal diff is tensor(8.0327, device='cuda:0')
clipping
cal diff is tensor(0.1350, device='cuda:0')
clipping
cal diff is tensor(508.4184, device='cuda:0')
clipping
cal diff is tensor(0.1725, device='cuda:0')
clipping
cal diff is tensor(1308.8660, device='cuda:0')
clipping
cal diff is tensor(0.7318, device='cuda:0')
clipping
cal diff is tensor(7.2841, device='cuda:0')
clipping
cal diff is tensor(0.0628, device='cuda:0')
clipping
________________________________
test distance is  tensor(1730.3755, device='cuda:0')
test acc is  0.8625833334896562
test entropy is  0.24467631110123225
________________________________
diff is  tensor(7.5800, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1274, device='cuda:0', dtype=torch.float64)
diff is  tensor(479.7694, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1628, device='cuda:0', dtype=torch.float64)
diff is  tensor(1235.1123, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6906, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.8737, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(7.5800, device='cuda:0')
clipping
cal diff is tensor(0.1274, device='cuda:0')
clipping
cal diff is tensor(479.7694, device='cuda:0')
clipping
cal diff is tensor(0.1628, device='cuda:0')
clipping
cal diff is tensor(1235.1123, device='cuda:0')
clipping
cal diff is tensor(0.6906, device='cuda:0')
clipping
cal diff is tensor(6.8737, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(1627.0511, device='cuda:0')
test acc is  0.8695166668229893
test entropy is  0.23732179514507748
________________________________
diff is  tensor(7.1274, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1198, device='cuda:0', dtype=torch.float64)
diff is  tensor(451.1204, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1531, device='cuda:0', dtype=torch.float64)
diff is  tensor(1161.3587, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6493, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.4632, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(7.1274, device='cuda:0')
clipping
cal diff is tensor(0.1198, device='cuda:0')
clipping
cal diff is tensor(451.1204, device='cuda:0')
clipping
cal diff is tensor(0.1531, device='cuda:0')
clipping
cal diff is tensor(1161.3586, device='cuda:0')
clipping
cal diff is tensor(0.6493, device='cuda:0')
clipping
cal diff is tensor(6.4632, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(1523.7271, device='cuda:0')
test acc is  0.8758333334896555
test entropy is  0.23004473804601475
________________________________
diff is  tensor(6.6748, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1122, device='cuda:0', dtype=torch.float64)
diff is  tensor(422.4714, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1434, device='cuda:0', dtype=torch.float64)
diff is  tensor(1087.6052, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6081, device='cuda:0', dtype=torch.float64)
diff is  tensor(6.0528, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(6.6748, device='cuda:0')
clipping
cal diff is tensor(0.1122, device='cuda:0')
clipping
cal diff is tensor(422.4714, device='cuda:0')
clipping
cal diff is tensor(0.1434, device='cuda:0')
clipping
cal diff is tensor(1087.6051, device='cuda:0')
clipping
cal diff is tensor(0.6081, device='cuda:0')
clipping
cal diff is tensor(6.0528, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(1420.4033, device='cuda:0')
test acc is  0.8820333334896553
test entropy is  0.22291652237905113
________________________________
diff is  tensor(6.2221, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1046, device='cuda:0', dtype=torch.float64)
diff is  tensor(393.8225, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1336, device='cuda:0', dtype=torch.float64)
diff is  tensor(1013.8518, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5669, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.6423, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(6.2221, device='cuda:0')
clipping
cal diff is tensor(0.1046, device='cuda:0')
clipping
cal diff is tensor(393.8225, device='cuda:0')
clipping
cal diff is tensor(0.1336, device='cuda:0')
clipping
cal diff is tensor(1013.8518, device='cuda:0')
clipping
cal diff is tensor(0.5669, device='cuda:0')
clipping
cal diff is tensor(5.6423, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(1317.0798, device='cuda:0')
test acc is  0.8876000001563218
test entropy is  0.2159668189852731
________________________________
diff is  tensor(5.7695, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0970, device='cuda:0', dtype=torch.float64)
diff is  tensor(365.1738, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1239, device='cuda:0', dtype=torch.float64)
diff is  tensor(940.0988, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5256, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.2319, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.7695, device='cuda:0')
clipping
cal diff is tensor(0.0970, device='cuda:0')
clipping
cal diff is tensor(365.1738, device='cuda:0')
clipping
cal diff is tensor(0.1239, device='cuda:0')
clipping
cal diff is tensor(940.0988, device='cuda:0')
clipping
cal diff is tensor(0.5256, device='cuda:0')
clipping
cal diff is tensor(5.2319, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(1213.7567, device='cuda:0')
test acc is  0.8926666668229883
test entropy is  0.20920660031407373
________________________________
diff is  tensor(5.3169, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0894, device='cuda:0', dtype=torch.float64)
diff is  tensor(336.5251, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1142, device='cuda:0', dtype=torch.float64)
diff is  tensor(866.3460, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4844, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.8214, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.3169, device='cuda:0')
clipping
cal diff is tensor(0.0894, device='cuda:0')
clipping
cal diff is tensor(336.5251, device='cuda:0')
clipping
cal diff is tensor(0.1142, device='cuda:0')
clipping
cal diff is tensor(866.3460, device='cuda:0')
clipping
cal diff is tensor(0.4844, device='cuda:0')
clipping
cal diff is tensor(4.8214, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(1110.4338, device='cuda:0')
test acc is  0.8974333334896548
test entropy is  0.2027054519525596
________________________________
diff is  tensor(4.8642, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0818, device='cuda:0', dtype=torch.float64)
diff is  tensor(307.8765, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1045, device='cuda:0', dtype=torch.float64)
diff is  tensor(792.5935, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4431, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.4110, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.8642, device='cuda:0')
clipping
cal diff is tensor(0.0818, device='cuda:0')
clipping
cal diff is tensor(307.8765, device='cuda:0')
clipping
cal diff is tensor(0.1045, device='cuda:0')
clipping
cal diff is tensor(792.5935, device='cuda:0')
clipping
cal diff is tensor(0.4431, device='cuda:0')
clipping
cal diff is tensor(4.4110, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(1007.1117, device='cuda:0')
test acc is  0.9016500001563212
test entropy is  0.19651011367247048
________________________________
diff is  tensor(4.4116, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0742, device='cuda:0', dtype=torch.float64)
diff is  tensor(279.2281, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0948, device='cuda:0', dtype=torch.float64)
diff is  tensor(718.8413, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4019, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.0005, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.4116, device='cuda:0')
clipping
cal diff is tensor(0.0742, device='cuda:0')
clipping
cal diff is tensor(279.2281, device='cuda:0')
clipping
cal diff is tensor(0.0948, device='cuda:0')
clipping
cal diff is tensor(718.8412, device='cuda:0')
clipping
cal diff is tensor(0.4019, device='cuda:0')
clipping
cal diff is tensor(4.0005, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(903.7900, device='cuda:0')
test acc is  0.9049166668229879
test entropy is  0.19064602065982342
________________________________
diff is  tensor(3.9590, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0665, device='cuda:0', dtype=torch.float64)
diff is  tensor(250.5798, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0850, device='cuda:0', dtype=torch.float64)
diff is  tensor(645.0896, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3607, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.5901, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.9590, device='cuda:0')
clipping
cal diff is tensor(0.0665, device='cuda:0')
clipping
cal diff is tensor(250.5798, device='cuda:0')
clipping
cal diff is tensor(0.0850, device='cuda:0')
clipping
cal diff is tensor(645.0896, device='cuda:0')
clipping
cal diff is tensor(0.3607, device='cuda:0')
clipping
cal diff is tensor(3.5901, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
________________________________
test distance is  tensor(800.4692, device='cuda:0')
test acc is  0.9082333334896544
test entropy is  0.18519445773222046
________________________________
diff is  tensor(3.5064, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0589, device='cuda:0', dtype=torch.float64)
diff is  tensor(221.9317, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0753, device='cuda:0', dtype=torch.float64)
diff is  tensor(571.3383, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3194, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.1796, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0593, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.5064, device='cuda:0')
clipping
cal diff is tensor(0.0589, device='cuda:0')
clipping
cal diff is tensor(221.9317, device='cuda:0')
clipping
cal diff is tensor(0.0753, device='cuda:0')
clipping
cal diff is tensor(571.3383, device='cuda:0')
clipping
cal diff is tensor(0.3194, device='cuda:0')
clipping
cal diff is tensor(3.1796, device='cuda:0')
clipping
cal diff is tensor(0.0593, device='cuda:0')
clipping
________________________________
test distance is  tensor(697.1415, device='cuda:0')
test acc is  0.9107833334896543
test entropy is  0.1802189057863661
________________________________
diff is  tensor(3.0538, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0513, device='cuda:0', dtype=torch.float64)
diff is  tensor(193.2839, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0656, device='cuda:0', dtype=torch.float64)
diff is  tensor(497.5877, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2782, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.7692, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0516, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.0538, device='cuda:0')
clipping
cal diff is tensor(0.0513, device='cuda:0')
clipping
cal diff is tensor(193.2839, device='cuda:0')
clipping
cal diff is tensor(0.0656, device='cuda:0')
clipping
cal diff is tensor(497.5878, device='cuda:0')
clipping
cal diff is tensor(0.2782, device='cuda:0')
clipping
cal diff is tensor(2.7692, device='cuda:0')
clipping
cal diff is tensor(0.0516, device='cuda:0')
clipping
________________________________
test distance is  tensor(593.8138, device='cuda:0')
test acc is  0.9131000001563209
test entropy is  0.17570559097044885
________________________________
diff is  tensor(2.6011, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0437, device='cuda:0', dtype=torch.float64)
diff is  tensor(164.6361, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0559, device='cuda:0', dtype=torch.float64)
diff is  tensor(423.8371, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2370, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.3588, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0440, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.6011, device='cuda:0')
clipping
cal diff is tensor(0.0437, device='cuda:0')
cal diff is tensor(164.6361, device='cuda:0')
clipping
cal diff is tensor(0.0559, device='cuda:0')
clipping
cal diff is tensor(423.8372, device='cuda:0')
clipping
cal diff is tensor(0.2370, device='cuda:0')
clipping
cal diff is tensor(2.3588, device='cuda:0')
clipping
cal diff is tensor(0.0440, device='cuda:0')
clipping
________________________________
test distance is  tensor(490.4937, device='cuda:0')
test acc is  0.9144333334896542
test entropy is  0.1717034893106423
________________________________
diff is  tensor(2.1485, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0437, device='cuda:0', dtype=torch.float64)
diff is  tensor(135.9883, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0462, device='cuda:0', dtype=torch.float64)
diff is  tensor(350.0865, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1957, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.9483, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0363, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.1485, device='cuda:0')
clipping
cal diff is tensor(0.0437, device='cuda:0')
clipping
cal diff is tensor(135.9883, device='cuda:0')
clipping
cal diff is tensor(0.0462, device='cuda:0')
clipping
cal diff is tensor(350.0865, device='cuda:0')
clipping
cal diff is tensor(0.1957, device='cuda:0')
clipping
cal diff is tensor(1.9483, device='cuda:0')
clipping
cal diff is tensor(0.0363, device='cuda:0')
clipping
________________________________
test distance is  tensor(387.1660, device='cuda:0')
test acc is  0.9154500001563208
test entropy is  0.1683196810437545
________________________________
diff is  tensor(1.6959, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0345, device='cuda:0', dtype=torch.float64)
diff is  tensor(107.3409, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0364, device='cuda:0', dtype=torch.float64)
diff is  tensor(276.3371, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1545, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.5379, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0287, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.6959, device='cuda:0')
clipping
cal diff is tensor(0.0345, device='cuda:0')
clipping
cal diff is tensor(107.3409, device='cuda:0')
clipping
cal diff is tensor(0.0364, device='cuda:0')
clipping
cal diff is tensor(276.3371, device='cuda:0')
clipping
cal diff is tensor(0.1545, device='cuda:0')
clipping
cal diff is tensor(1.5379, device='cuda:0')
clipping
cal diff is tensor(0.0287, device='cuda:0')
________________________________
test distance is  tensor(283.8460, device='cuda:0')
test acc is  0.9164166668229875
test entropy is  0.16560264164482608
________________________________
diff is  tensor(1.2433, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0253, device='cuda:0', dtype=torch.float64)
diff is  tensor(78.6935, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0267, device='cuda:0', dtype=torch.float64)
diff is  tensor(202.5876, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1133, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1275, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0287, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.2433, device='cuda:0')
clipping
cal diff is tensor(0.0253, device='cuda:0')
cal diff is tensor(78.6935, device='cuda:0')
clipping
cal diff is tensor(0.0267, device='cuda:0')
clipping
cal diff is tensor(202.5876, device='cuda:0')
clipping
cal diff is tensor(0.1133, device='cuda:0')
clipping
cal diff is tensor(1.1275, device='cuda:0')
clipping
cal diff is tensor(0.0287, device='cuda:0')
clipping
________________________________
test distance is  tensor(180.5275, device='cuda:0')
test acc is  0.9167833334896541
test entropy is  0.16351786259808013
________________________________
diff is  tensor(0.7907, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0253, device='cuda:0', dtype=torch.float64)
diff is  tensor(50.0469, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0170, device='cuda:0', dtype=torch.float64)
diff is  tensor(128.8402, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0720, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7170, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0182, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.7907, device='cuda:0')
clipping
cal diff is tensor(0.0253, device='cuda:0')
clipping
cal diff is tensor(50.0469, device='cuda:0')
clipping
cal diff is tensor(0.0170, device='cuda:0')
cal diff is tensor(128.8402, device='cuda:0')
clipping
cal diff is tensor(0.0720, device='cuda:0')
clipping
cal diff is tensor(0.7170, device='cuda:0')
clipping
cal diff is tensor(0.0182, device='cuda:0')
clipping
________________________________
test distance is  tensor(77.2095, device='cuda:0')
test acc is  0.9171000001563208
test entropy is  0.16226505845197356
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16226505845197356
avg test loss is  0.21788430374576404
avg accuracy is  0.9171000001563208
compute_distance is  tensor(77.2095, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24849639520017322
avg test loss is  0.3939354901335069
avg accuracy is  0.8520333334896566
compute_distance is  tensor(124.6617, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(124.6617, device='cuda:0')
test acc is  0.8520333334896566
test entropy is  0.24849639520017322
________________________________
diff is  tensor(0.4138, device='cuda:0')
diff is  tensor(0.0103, device='cuda:0')
diff is  tensor(30.5990, device='cuda:0')
diff is  tensor(0.0195, device='cuda:0')
diff is  tensor(93.1566, device='cuda:0')
diff is  tensor(0.0352, device='cuda:0')
diff is  tensor(0.4106, device='cuda:0')
diff is  tensor(0.0082, device='cuda:0')
cal diff is tensor(0.4138, device='cuda:0')
clipping
cal diff is tensor(0.0103, device='cuda:0')
clipping
cal diff is tensor(30.5990, device='cuda:0')
clipping
cal diff is tensor(0.0195, device='cuda:0')
clipping
cal diff is tensor(93.1566, device='cuda:0')
clipping
cal diff is tensor(0.0352, device='cuda:0')
clipping
cal diff is tensor(0.4106, device='cuda:0')
clipping
cal diff is tensor(0.0082, device='cuda:0')
clipping
________________________________
test distance is  tensor(21.3390, device='cuda:0')
test acc is  0.9108166668229876
test entropy is  0.17146960480301493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17146960480301493
avg test loss is  0.23399332091649142
avg accuracy is  0.9108166668229876
compute_distance is  tensor(21.3390, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24953868769125134
avg test loss is  0.3965620352173728
avg accuracy is  0.8514000001563232
compute_distance is  tensor(108.8050, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(108.8050, device='cuda:0')
test acc is  0.8514000001563232
test entropy is  0.24953868769125134
________________________________
diff is  tensor(0.2404, device='cuda:0')
diff is  tensor(0.0024, device='cuda:0')
diff is  tensor(22.9673, device='cuda:0')
diff is  tensor(0.0114, device='cuda:0')
diff is  tensor(85.2828, device='cuda:0')
diff is  tensor(0.0181, device='cuda:0')
diff is  tensor(0.2677, device='cuda:0')
diff is  tensor(0.0020, device='cuda:0')
cal diff is tensor(0.2404, device='cuda:0')
clipping
cal diff is tensor(0.0024, device='cuda:0')
clipping
cal diff is tensor(22.9673, device='cuda:0')
clipping
cal diff is tensor(0.0114, device='cuda:0')
clipping
cal diff is tensor(85.2828, device='cuda:0')
clipping
cal diff is tensor(0.0181, device='cuda:0')
clipping
cal diff is tensor(0.2677, device='cuda:0')
clipping
cal diff is tensor(0.0020, device='cuda:0')
clipping
________________________________
test distance is  tensor(5.4847, device='cuda:0')
test acc is  0.9153166668229875
test entropy is  0.16432858233068035
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16432858233068035
avg test loss is  0.22255082767623574
avg accuracy is  0.9153166668229875
compute_distance is  tensor(5.4847, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24879284035454172
avg test loss is  0.39483825377881654
avg accuracy is  0.8517166668229899
compute_distance is  tensor(99.8021, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(99.8021, device='cuda:0')
test acc is  0.8517166668229899
test entropy is  0.24879284035454172
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 92.16% 

Test Accuracy: 90.12% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.000658427132293582
len of model dicts is  10
compute distance is  tensor(37.1668, device='cuda:0')
compute distance is  tensor(70.4297, device='cuda:0')
compute distance is  tensor(71.3497, device='cuda:0')
compute distance is  tensor(68.2036, device='cuda:0')
compute distance is  tensor(63.8843, device='cuda:0')
compute distance is  tensor(32.4992, device='cuda:0')
compute distance is  tensor(121.4674, device='cuda:0')
compute distance is  tensor(54.6874, device='cuda:0')
compute distance is  tensor(107.8696, device='cuda:0')
compute distance is  tensor(21.3054, device='cuda:0')
calculated distance threshold is  tensor(101.4350, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.894233333489655
====================
====================
iteration is  0
round is  1
accuracy is  0.8971000001563215
====================
====================
iteration is  0
round is  2
accuracy is  0.8913333334896549
====================
====================
iteration is  1
round is  0
accuracy is  0.902966666822988
====================
====================
iteration is  1
round is  1
accuracy is  0.8970833334896549
====================
====================
iteration is  1
round is  2
accuracy is  0.8990166668229881
====================
====================
iteration is  2
round is  0
accuracy is  0.9023666668229879
====================
====================
iteration is  2
round is  1
accuracy is  0.8937500001563217
====================
====================
iteration is  2
round is  2
accuracy is  0.8981333334896549
====================
====================
iteration is  3
round is  0
accuracy is  0.895533333489655
====================
====================
iteration is  3
round is  1
accuracy is  0.8971666668229882
====================
====================
iteration is  3
round is  2
accuracy is  0.8976166668229882
====================
====================
iteration is  4
round is  0
accuracy is  0.890783333489655
====================
====================
iteration is  4
round is  1
accuracy is  0.8943000001563215
====================
====================
iteration is  4
round is  2
accuracy is  0.8985500001563214
====================
====================
iteration is  5
round is  0
accuracy is  0.8792166668229889
====================
====================
iteration is  5
round is  1
accuracy is  0.8958166668229882
====================
====================
iteration is  5
round is  2
accuracy is  0.9022833334896546
====================
====================
iteration is  6
round is  0
accuracy is  0.8888166668229884
====================
====================
iteration is  6
round is  1
accuracy is  0.8831166668229887
====================
====================
iteration is  6
round is  2
accuracy is  0.9041500001563213
====================
====================
iteration is  7
round is  0
accuracy is  0.9004500001563214
====================
====================
iteration is  7
round is  1
accuracy is  0.9056000001563211
====================
====================
iteration is  7
round is  2
accuracy is  0.8768333334896555
====================
====================
iteration is  8
round is  0
accuracy is  0.875366666822989
====================
====================
iteration is  8
round is  1
accuracy is  0.8719000001563225
====================
succ_min + 1
====================
iteration is  8
round is  2
accuracy is  0.8780500001563223
====================
====================
iteration is  9
round is  0
accuracy is  0.8649500001563227
====================
succ_min + 1
====================
iteration is  9
round is  1
accuracy is  0.891433333489655
====================
====================
iteration is  9
round is  2
accuracy is  0.8707833334896559
====================
====================
iteration is  10
round is  0
accuracy is  0.903216666822988
====================
====================
iteration is  10
round is  1
accuracy is  0.8684333334896559
====================
====================
iteration is  10
round is  2
accuracy is  0.8738000001563224
====================
====================
iteration is  11
round is  0
accuracy is  0.9011000001563214
====================
====================
iteration is  11
round is  1
accuracy is  0.8730500001563225
====================
====================
iteration is  11
round is  2
accuracy is  0.8580166668229896
====================
succ_min + 1
________________________________
test distance is  tensor(1457.2749, device='cuda:0')
test acc is  0.8580166668229896
test entropy is  0.2303871078007638
________________________________
diff is  tensor(6.2386, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0976, device='cuda:0', dtype=torch.float64)
diff is  tensor(405.4626, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1373, device='cuda:0', dtype=torch.float64)
diff is  tensor(1038.9106, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5764, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.7969, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0547, device='cuda:0', dtype=torch.float64)
cal diff is tensor(6.2386, device='cuda:0')
clipping
cal diff is tensor(0.0976, device='cuda:0')
clipping
cal diff is tensor(405.4626, device='cuda:0')
clipping
cal diff is tensor(0.1373, device='cuda:0')
clipping
cal diff is tensor(1038.9105, device='cuda:0')
clipping
cal diff is tensor(0.5764, device='cuda:0')
clipping
cal diff is tensor(5.7969, device='cuda:0')
clipping
cal diff is tensor(0.0547, device='cuda:0')
clipping
________________________________
test distance is  tensor(1355.8401, device='cuda:0')
test acc is  0.8625166668229894
test entropy is  0.22321940756746447
________________________________
diff is  tensor(5.8044, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0908, device='cuda:0', dtype=torch.float64)
diff is  tensor(377.2400, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1278, device='cuda:0', dtype=torch.float64)
diff is  tensor(966.5963, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5363, device='cuda:0', dtype=torch.float64)
diff is  tensor(5.3934, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.8044, device='cuda:0')
clipping
cal diff is tensor(0.0908, device='cuda:0')
clipping
cal diff is tensor(377.2400, device='cuda:0')
clipping
cal diff is tensor(0.1278, device='cuda:0')
clipping
cal diff is tensor(966.5963, device='cuda:0')
clipping
cal diff is tensor(0.5363, device='cuda:0')
clipping
cal diff is tensor(5.3934, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
________________________________
test distance is  tensor(1254.4089, device='cuda:0')
test acc is  0.8670000001563226
test entropy is  0.21628897975502745
________________________________
diff is  tensor(5.3701, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0840, device='cuda:0', dtype=torch.float64)
diff is  tensor(349.0175, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1182, device='cuda:0', dtype=torch.float64)
diff is  tensor(894.2820, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4962, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.9899, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.3701, device='cuda:0')
clipping
cal diff is tensor(0.0840, device='cuda:0')
clipping
cal diff is tensor(349.0175, device='cuda:0')
clipping
cal diff is tensor(0.1182, device='cuda:0')
clipping
cal diff is tensor(894.2820, device='cuda:0')
clipping
cal diff is tensor(0.4962, device='cuda:0')
clipping
cal diff is tensor(4.9899, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
________________________________
test distance is  tensor(1152.9781, device='cuda:0')
test acc is  0.8706333334896559
test entropy is  0.2096133742775363
________________________________
diff is  tensor(4.9359, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0772, device='cuda:0', dtype=torch.float64)
diff is  tensor(320.7949, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1086, device='cuda:0', dtype=torch.float64)
diff is  tensor(821.9679, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4561, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.5864, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.9359, device='cuda:0')
clipping
cal diff is tensor(0.0772, device='cuda:0')
clipping
cal diff is tensor(320.7950, device='cuda:0')
clipping
cal diff is tensor(0.1086, device='cuda:0')
clipping
cal diff is tensor(821.9680, device='cuda:0')
clipping
cal diff is tensor(0.4561, device='cuda:0')
clipping
cal diff is tensor(4.5864, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
________________________________
test distance is  tensor(1051.5477, device='cuda:0')
test acc is  0.874716666822989
test entropy is  0.20320727477576941
________________________________
diff is  tensor(4.5016, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0704, device='cuda:0', dtype=torch.float64)
diff is  tensor(292.5726, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0991, device='cuda:0', dtype=torch.float64)
diff is  tensor(749.6542, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4159, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.1829, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.5016, device='cuda:0')
clipping
cal diff is tensor(0.0704, device='cuda:0')
clipping
cal diff is tensor(292.5726, device='cuda:0')
clipping
cal diff is tensor(0.0991, device='cuda:0')
clipping
cal diff is tensor(749.6542, device='cuda:0')
clipping
cal diff is tensor(0.4159, device='cuda:0')
clipping
cal diff is tensor(4.1829, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
________________________________
test distance is  tensor(950.1179, device='cuda:0')
test acc is  0.8784666668229888
test entropy is  0.1971186067202071
________________________________
diff is  tensor(4.0674, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0636, device='cuda:0', dtype=torch.float64)
diff is  tensor(264.3503, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0895, device='cuda:0', dtype=torch.float64)
diff is  tensor(677.3407, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3758, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.7794, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.0674, device='cuda:0')
clipping
cal diff is tensor(0.0636, device='cuda:0')
clipping
cal diff is tensor(264.3503, device='cuda:0')
clipping
cal diff is tensor(0.0895, device='cuda:0')
clipping
cal diff is tensor(677.3406, device='cuda:0')
clipping
cal diff is tensor(0.3758, device='cuda:0')
clipping
cal diff is tensor(3.7794, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
________________________________
test distance is  tensor(848.6885, device='cuda:0')
test acc is  0.8821666668229887
test entropy is  0.19135385955066314
________________________________
diff is  tensor(3.6332, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0568, device='cuda:0', dtype=torch.float64)
diff is  tensor(236.1282, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0800, device='cuda:0', dtype=torch.float64)
diff is  tensor(605.0277, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3357, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.3759, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.6332, device='cuda:0')
clipping
cal diff is tensor(0.0568, device='cuda:0')
clipping
cal diff is tensor(236.1282, device='cuda:0')
clipping
cal diff is tensor(0.0800, device='cuda:0')
clipping
cal diff is tensor(605.0277, device='cuda:0')
clipping
cal diff is tensor(0.3357, device='cuda:0')
clipping
cal diff is tensor(3.3759, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
________________________________
test distance is  tensor(747.2598, device='cuda:0')
test acc is  0.8859666668229885
test entropy is  0.18595552968699286
________________________________
diff is  tensor(3.1989, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0500, device='cuda:0', dtype=torch.float64)
diff is  tensor(207.9063, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0704, device='cuda:0', dtype=torch.float64)
diff is  tensor(532.7151, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2956, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.9724, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.1989, device='cuda:0')
clipping
cal diff is tensor(0.0500, device='cuda:0')
cal diff is tensor(207.9063, device='cuda:0')
clipping
cal diff is tensor(0.0704, device='cuda:0')
clipping
cal diff is tensor(532.7151, device='cuda:0')
clipping
cal diff is tensor(0.2956, device='cuda:0')
clipping
cal diff is tensor(2.9724, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
clipping
________________________________
test distance is  tensor(645.8317, device='cuda:0')
test acc is  0.8884000001563218
test entropy is  0.18101290788954255
________________________________
diff is  tensor(2.7647, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0500, device='cuda:0', dtype=torch.float64)
diff is  tensor(179.6845, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0609, device='cuda:0', dtype=torch.float64)
diff is  tensor(460.4030, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2555, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.5689, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0440, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.7647, device='cuda:0')
clipping
cal diff is tensor(0.0500, device='cuda:0')
clipping
cal diff is tensor(179.6845, device='cuda:0')
clipping
cal diff is tensor(0.0609, device='cuda:0')
clipping
cal diff is tensor(460.4030, device='cuda:0')
clipping
cal diff is tensor(0.2555, device='cuda:0')
clipping
cal diff is tensor(2.5689, device='cuda:0')
clipping
cal diff is tensor(0.0440, device='cuda:0')
clipping
________________________________
test distance is  tensor(544.3968, device='cuda:0')
test acc is  0.8913000001563216
test entropy is  0.17649125418206776
________________________________
diff is  tensor(2.3305, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0422, device='cuda:0', dtype=torch.float64)
diff is  tensor(151.4631, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0513, device='cuda:0', dtype=torch.float64)
diff is  tensor(388.0917, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2153, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.1655, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0371, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.3305, device='cuda:0')
clipping
cal diff is tensor(0.0422, device='cuda:0')
clipping
cal diff is tensor(151.4631, device='cuda:0')
clipping
cal diff is tensor(0.0513, device='cuda:0')
clipping
cal diff is tensor(388.0917, device='cuda:0')
clipping
cal diff is tensor(0.2153, device='cuda:0')
clipping
cal diff is tensor(2.1655, device='cuda:0')
clipping
cal diff is tensor(0.0371, device='cuda:0')
________________________________
test distance is  tensor(442.9688, device='cuda:0')
test acc is  0.8936000001563216
test entropy is  0.17250653247096773
________________________________
diff is  tensor(1.8963, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0343, device='cuda:0', dtype=torch.float64)
diff is  tensor(123.2417, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0417, device='cuda:0', dtype=torch.float64)
diff is  tensor(315.7804, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1752, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.7620, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0371, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.8963, device='cuda:0')
clipping
cal diff is tensor(0.0343, device='cuda:0')
cal diff is tensor(123.2417, device='cuda:0')
clipping
cal diff is tensor(0.0417, device='cuda:0')
clipping
cal diff is tensor(315.7804, device='cuda:0')
clipping
cal diff is tensor(0.1752, device='cuda:0')
clipping
cal diff is tensor(1.7620, device='cuda:0')
clipping
cal diff is tensor(0.0371, device='cuda:0')
clipping
________________________________
test distance is  tensor(341.5419, device='cuda:0')
test acc is  0.8959666668229882
test entropy is  0.16909016652513287
________________________________
diff is  tensor(1.4620, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0343, device='cuda:0', dtype=torch.float64)
diff is  tensor(95.0207, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0322, device='cuda:0', dtype=torch.float64)
diff is  tensor(243.4702, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1351, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3585, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0286, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.4620, device='cuda:0')
clipping
cal diff is tensor(0.0343, device='cuda:0')
clipping
cal diff is tensor(95.0207, device='cuda:0')
clipping
cal diff is tensor(0.0322, device='cuda:0')
clipping
cal diff is tensor(243.4702, device='cuda:0')
clipping
cal diff is tensor(0.1351, device='cuda:0')
clipping
cal diff is tensor(1.3585, device='cuda:0')
clipping
cal diff is tensor(0.0286, device='cuda:0')
________________________________
test distance is  tensor(240.1155, device='cuda:0')
test acc is  0.8979333334896549
test entropy is  0.1661941945108015
________________________________
diff is  tensor(1.0278, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0241, device='cuda:0', dtype=torch.float64)
diff is  tensor(66.8004, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0226, device='cuda:0', dtype=torch.float64)
diff is  tensor(171.1618, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0950, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9550, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0286, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0278, device='cuda:0')
clipping
cal diff is tensor(0.0241, device='cuda:0')
clipping
cal diff is tensor(66.8004, device='cuda:0')
clipping
cal diff is tensor(0.0226, device='cuda:0')
cal diff is tensor(171.1618, device='cuda:0')
clipping
cal diff is tensor(0.0950, device='cuda:0')
clipping
cal diff is tensor(0.9550, device='cuda:0')
clipping
cal diff is tensor(0.0286, device='cuda:0')
clipping
________________________________
test distance is  tensor(138.6902, device='cuda:0')
test acc is  0.8996500001563213
test entropy is  0.16391983788325462
________________________________
diff is  tensor(0.5936, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0139, device='cuda:0', dtype=torch.float64)
diff is  tensor(38.5811, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0226, device='cuda:0', dtype=torch.float64)
diff is  tensor(98.8558, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0548, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5516, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0165, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.5936, device='cuda:0')
clipping
cal diff is tensor(0.0139, device='cuda:0')
cal diff is tensor(38.5811, device='cuda:0')
clipping
cal diff is tensor(0.0226, device='cuda:0')
clipping
cal diff is tensor(98.8558, device='cuda:0')
clipping
cal diff is tensor(0.0548, device='cuda:0')
clipping
cal diff is tensor(0.5516, device='cuda:0')
clipping
cal diff is tensor(0.0165, device='cuda:0')
clipping
________________________________
test distance is  tensor(37.2655, device='cuda:0')
test acc is  0.9012500001563214
test entropy is  0.16234366736734218
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16234366736734218
avg test loss is  0.27224468146123165
avg accuracy is  0.9012500001563214
compute_distance is  tensor(37.2655, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22188882563096374
avg test loss is  0.3828251970761112
avg accuracy is  0.8608333334896562
compute_distance is  tensor(100.7432, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(100.7432, device='cuda:0')
test acc is  0.8608333334896562
test entropy is  0.22188882563096374
________________________________
new distance ratio is 0.8
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 91.15% 

Test Accuracy: 88.47% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0006261536036618054
len of model dicts is  10
compute distance is  tensor(43.0898, device='cuda:0')
compute distance is  tensor(52.0207, device='cuda:0')
compute distance is  tensor(141.5845, device='cuda:0')
compute distance is  tensor(107.7315, device='cuda:0')
compute distance is  tensor(90.9090, device='cuda:0')
compute distance is  tensor(44.4006, device='cuda:0')
compute distance is  tensor(101.5393, device='cuda:0')
compute distance is  tensor(62.2062, device='cuda:0')
compute distance is  tensor(124.8525, device='cuda:0')
compute distance is  tensor(13.1444, device='cuda:0')
calculated distance threshold is  tensor(115.8965, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.892133333489655
====================
====================
iteration is  0
round is  1
accuracy is  0.882800000156322
====================
====================
iteration is  0
round is  2
accuracy is  0.8782000001563223
====================
====================
iteration is  1
round is  0
accuracy is  0.8899666668229884
====================
====================
iteration is  1
round is  1
accuracy is  0.8814500001563221
====================
====================
iteration is  1
round is  2
accuracy is  0.8805666668229888
====================
====================
iteration is  2
round is  0
accuracy is  0.8772333334896556
====================
====================
iteration is  2
round is  1
accuracy is  0.8702833334896559
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.8833333334896554
====================
====================
iteration is  3
round is  0
accuracy is  0.8706333334896559
====================
====================
iteration is  3
round is  1
accuracy is  0.8863333334896553
====================
====================
iteration is  3
round is  2
accuracy is  0.8895166668229885
====================
====================
iteration is  4
round is  0
accuracy is  0.8792833334896555
====================
====================
iteration is  4
round is  1
accuracy is  0.867683333489656
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.8719000001563225
====================
====================
iteration is  5
round is  0
accuracy is  0.875566666822989
====================
====================
iteration is  5
round is  1
accuracy is  0.8626500001563228
====================
succ_min + 1
________________________________
test distance is  tensor(823.0618, device='cuda:0')
test acc is  0.8626500001563228
test entropy is  0.18560395311953418
________________________________
diff is  tensor(3.5148, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0542, device='cuda:0', dtype=torch.float64)
diff is  tensor(229.0037, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0857, device='cuda:0', dtype=torch.float64)
diff is  tensor(586.7706, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3258, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2741, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0333, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.5148, device='cuda:0')
clipping
cal diff is tensor(0.0542, device='cuda:0')
clipping
cal diff is tensor(229.0037, device='cuda:0')
clipping
cal diff is tensor(0.0857, device='cuda:0')
clipping
cal diff is tensor(586.7706, device='cuda:0')
clipping
cal diff is tensor(0.3258, device='cuda:0')
clipping
cal diff is tensor(3.2741, device='cuda:0')
clipping
cal diff is tensor(0.0333, device='cuda:0')
________________________________
test distance is  tensor(707.1697, device='cuda:0')
test acc is  0.867583333489656
test entropy is  0.18100307927107506
________________________________
diff is  tensor(3.0199, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0465, device='cuda:0', dtype=torch.float64)
diff is  tensor(196.7573, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0737, device='cuda:0', dtype=torch.float64)
diff is  tensor(504.1464, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2799, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.8131, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0333, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.0199, device='cuda:0')
clipping
cal diff is tensor(0.0465, device='cuda:0')
clipping
cal diff is tensor(196.7573, device='cuda:0')
clipping
cal diff is tensor(0.0737, device='cuda:0')
clipping
cal diff is tensor(504.1464, device='cuda:0')
clipping
cal diff is tensor(0.2799, device='cuda:0')
clipping
cal diff is tensor(2.8131, device='cuda:0')
clipping
cal diff is tensor(0.0333, device='cuda:0')
________________________________
test distance is  tensor(591.2783, device='cuda:0')
test acc is  0.8717666668229892
test entropy is  0.17677030248492004
________________________________
diff is  tensor(2.5250, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0389, device='cuda:0', dtype=torch.float64)
diff is  tensor(164.5111, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0616, device='cuda:0', dtype=torch.float64)
diff is  tensor(421.5227, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2340, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.3520, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0333, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.5250, device='cuda:0')
clipping
cal diff is tensor(0.0389, device='cuda:0')
clipping
cal diff is tensor(164.5111, device='cuda:0')
clipping
cal diff is tensor(0.0616, device='cuda:0')
clipping
cal diff is tensor(421.5228, device='cuda:0')
clipping
cal diff is tensor(0.2340, device='cuda:0')
clipping
cal diff is tensor(2.3520, device='cuda:0')
clipping
cal diff is tensor(0.0333, device='cuda:0')
________________________________
test distance is  tensor(475.3879, device='cuda:0')
test acc is  0.8760333334896556
test entropy is  0.17302373827679324
________________________________
diff is  tensor(2.0301, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0313, device='cuda:0', dtype=torch.float64)
diff is  tensor(132.2652, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0495, device='cuda:0', dtype=torch.float64)
diff is  tensor(338.8998, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1882, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.8910, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0333, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.0301, device='cuda:0')
clipping
cal diff is tensor(0.0313, device='cuda:0')
clipping
cal diff is tensor(132.2653, device='cuda:0')
clipping
cal diff is tensor(0.0495, device='cuda:0')
clipping
cal diff is tensor(338.8998, device='cuda:0')
clipping
cal diff is tensor(0.1882, device='cuda:0')
clipping
cal diff is tensor(1.8910, device='cuda:0')
clipping
cal diff is tensor(0.0333, device='cuda:0')
clipping
________________________________
test distance is  tensor(359.4911, device='cuda:0')
test acc is  0.8792833334896555
test entropy is  0.16985480114023313
________________________________
diff is  tensor(1.5351, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0237, device='cuda:0', dtype=torch.float64)
diff is  tensor(100.0198, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0374, device='cuda:0', dtype=torch.float64)
diff is  tensor(256.2780, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1423, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.4300, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0252, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.5351, device='cuda:0')
clipping
cal diff is tensor(0.0237, device='cuda:0')
cal diff is tensor(100.0198, device='cuda:0')
clipping
cal diff is tensor(0.0374, device='cuda:0')
clipping
cal diff is tensor(256.2780, device='cuda:0')
clipping
cal diff is tensor(0.1423, device='cuda:0')
clipping
cal diff is tensor(1.4300, device='cuda:0')
clipping
cal diff is tensor(0.0252, device='cuda:0')
clipping
________________________________
test distance is  tensor(243.6020, device='cuda:0')
test acc is  0.8824333334896554
test entropy is  0.16732175030243168
________________________________
diff is  tensor(1.0402, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0237, device='cuda:0', dtype=torch.float64)
diff is  tensor(67.7744, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0254, device='cuda:0', dtype=torch.float64)
diff is  tensor(173.6563, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0964, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9690, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0170, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0402, device='cuda:0')
clipping
cal diff is tensor(0.0237, device='cuda:0')
clipping
cal diff is tensor(67.7744, device='cuda:0')
clipping
cal diff is tensor(0.0254, device='cuda:0')
clipping
cal diff is tensor(173.6563, device='cuda:0')
clipping
cal diff is tensor(0.0964, device='cuda:0')
clipping
cal diff is tensor(0.9690, device='cuda:0')
clipping
cal diff is tensor(0.0170, device='cuda:0')
________________________________
test distance is  tensor(127.7134, device='cuda:0')
test acc is  0.8851666668229885
test entropy is  0.16554913958554457
________________________________
diff is  tensor(0.5453, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0124, device='cuda:0', dtype=torch.float64)
diff is  tensor(35.5300, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0133, device='cuda:0', dtype=torch.float64)
diff is  tensor(91.0372, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0505, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5080, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0170, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.5453, device='cuda:0')
clipping
cal diff is tensor(0.0124, device='cuda:0')
cal diff is tensor(35.5300, device='cuda:0')
clipping
cal diff is tensor(0.0133, device='cuda:0')
clipping
cal diff is tensor(91.0372, device='cuda:0')
clipping
cal diff is tensor(0.0505, device='cuda:0')
clipping
cal diff is tensor(0.5080, device='cuda:0')
clipping
cal diff is tensor(0.0170, device='cuda:0')
clipping
________________________________
test distance is  tensor(11.8282, device='cuda:0')
test acc is  0.8875000001563219
test entropy is  0.16453207938322253
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16453207938322253
avg test loss is  0.3263891196684606
avg accuracy is  0.8875000001563219
compute_distance is  tensor(11.8282, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18084782792497545
avg test loss is  0.4167790742062811
avg accuracy is  0.8635666668229894
compute_distance is  tensor(92.2075, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(92.2075, device='cuda:0')
test acc is  0.8635666668229894
test entropy is  0.18084782792497545
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 90.64% 

Test Accuracy: 87.70% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0003414613602217287
len of model dicts is  10
compute distance is  tensor(42.7176, device='cuda:0')
compute distance is  tensor(64.4081, device='cuda:0')
compute distance is  tensor(69.4145, device='cuda:0')
compute distance is  tensor(131.6120, device='cuda:0')
compute distance is  tensor(65.5401, device='cuda:0')
compute distance is  tensor(53.5199, device='cuda:0')
compute distance is  tensor(95.5760, device='cuda:0')
compute distance is  tensor(66.8077, device='cuda:0')
compute distance is  tensor(94.1868, device='cuda:0')
compute distance is  tensor(11.7971, device='cuda:0')
calculated distance threshold is  tensor(107.6490, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8806333334896554
====================
====================
iteration is  0
round is  1
accuracy is  0.8683833334896559
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8715833334896558
====================
====================
iteration is  1
round is  0
accuracy is  0.8859333334896552
====================
====================
iteration is  1
round is  1
accuracy is  0.8653166668229894
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.8721833334896558
====================
====================
iteration is  2
round is  0
accuracy is  0.8768333334896555
====================
====================
iteration is  2
round is  1
accuracy is  0.8764000001563222
====================
====================
iteration is  2
round is  2
accuracy is  0.8693833334896559
====================
________________________________
test distance is  tensor(562.1291, device='cuda:0')
test acc is  0.8653166668229894
test entropy is  0.17651890296894096
________________________________
diff is  tensor(2.5023, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0403, device='cuda:0', dtype=torch.float64)
diff is  tensor(156.4441, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0586, device='cuda:0', dtype=torch.float64)
diff is  tensor(400.5945, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2295, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.2433, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0163, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.5023, device='cuda:0')
clipping
cal diff is tensor(0.0403, device='cuda:0')
clipping
cal diff is tensor(156.4442, device='cuda:0')
clipping
cal diff is tensor(0.0586, device='cuda:0')
clipping
cal diff is tensor(400.5945, device='cuda:0')
clipping
cal diff is tensor(0.2295, device='cuda:0')
clipping
cal diff is tensor(2.2433, device='cuda:0')
clipping
cal diff is tensor(0.0163, device='cuda:0')
clipping
________________________________
test distance is  tensor(454.4803, device='cuda:0')
test acc is  0.8689166668229893
test entropy is  0.17289748792645773
________________________________
diff is  tensor(2.0231, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0325, device='cuda:0', dtype=torch.float64)
diff is  tensor(126.4848, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0474, device='cuda:0', dtype=torch.float64)
diff is  tensor(323.8798, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1856, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.8137, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0132, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.0231, device='cuda:0')
clipping
cal diff is tensor(0.0325, device='cuda:0')
clipping
cal diff is tensor(126.4848, device='cuda:0')
clipping
cal diff is tensor(0.0474, device='cuda:0')
clipping
cal diff is tensor(323.8799, device='cuda:0')
clipping
cal diff is tensor(0.1856, device='cuda:0')
clipping
cal diff is tensor(1.8137, device='cuda:0')
clipping
cal diff is tensor(0.0132, device='cuda:0')
clipping
________________________________
test distance is  tensor(346.8315, device='cuda:0')
test acc is  0.8717500001563225
test entropy is  0.16974038896816118
________________________________
diff is  tensor(1.5439, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0248, device='cuda:0', dtype=torch.float64)
diff is  tensor(96.5254, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0362, device='cuda:0', dtype=torch.float64)
diff is  tensor(247.1652, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1416, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3841, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0100, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.5439, device='cuda:0')
clipping
cal diff is tensor(0.0248, device='cuda:0')
clipping
cal diff is tensor(96.5254, device='cuda:0')
clipping
cal diff is tensor(0.0362, device='cuda:0')
clipping
cal diff is tensor(247.1652, device='cuda:0')
clipping
cal diff is tensor(0.1416, device='cuda:0')
clipping
cal diff is tensor(1.3841, device='cuda:0')
clipping
cal diff is tensor(0.0100, device='cuda:0')
clipping
________________________________
test distance is  tensor(239.1826, device='cuda:0')
test acc is  0.8746000001563223
test entropy is  0.1671089415849526
________________________________
diff is  tensor(1.0647, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0171, device='cuda:0', dtype=torch.float64)
diff is  tensor(66.5660, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0250, device='cuda:0', dtype=torch.float64)
diff is  tensor(170.4506, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0977, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9545, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0069, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0647, device='cuda:0')
clipping
cal diff is tensor(0.0171, device='cuda:0')
clipping
cal diff is tensor(66.5660, device='cuda:0')
clipping
cal diff is tensor(0.0250, device='cuda:0')
clipping
cal diff is tensor(170.4506, device='cuda:0')
clipping
cal diff is tensor(0.0977, device='cuda:0')
clipping
cal diff is tensor(0.9545, device='cuda:0')
clipping
cal diff is tensor(0.0069, device='cuda:0')
clipping
________________________________
test distance is  tensor(131.5338, device='cuda:0')
test acc is  0.877016666822989
test entropy is  0.16504664700835753
________________________________
diff is  tensor(0.5855, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0094, device='cuda:0', dtype=torch.float64)
diff is  tensor(36.6066, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0137, device='cuda:0', dtype=torch.float64)
diff is  tensor(93.7359, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0537, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5249, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0038, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.5855, device='cuda:0')
clipping
cal diff is tensor(0.0094, device='cuda:0')
clipping
cal diff is tensor(36.6066, device='cuda:0')
clipping
cal diff is tensor(0.0137, device='cuda:0')
clipping
cal diff is tensor(93.7359, device='cuda:0')
clipping
cal diff is tensor(0.0537, device='cuda:0')
clipping
cal diff is tensor(0.5249, device='cuda:0')
clipping
cal diff is tensor(0.0038, device='cuda:0')
clipping
________________________________
test distance is  tensor(23.8851, device='cuda:0')
test acc is  0.8793500001563221
test entropy is  0.16357276815055274
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16357276815055274
avg test loss is  0.3571605232240422
avg accuracy is  0.8793500001563221
compute_distance is  tensor(23.8851, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1726014037122096
avg test loss is  0.4095780021115852
avg accuracy is  0.8661166668229894
compute_distance is  tensor(94.7180, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(94.7180, device='cuda:0')
test acc is  0.8661166668229894
test entropy is  0.1726014037122096
________________________________
new distance ratio is 0.8
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 91.21% 

Test Accuracy: 88.80% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0004254375526215881
len of model dicts is  10
compute distance is  tensor(32.7415, device='cuda:0')
compute distance is  tensor(66.1821, device='cuda:0')
compute distance is  tensor(92.2205, device='cuda:0')
compute distance is  tensor(71.6680, device='cuda:0')
compute distance is  tensor(70.8442, device='cuda:0')
compute distance is  tensor(45.1986, device='cuda:0')
compute distance is  tensor(96.7117, device='cuda:0')
compute distance is  tensor(61.5434, device='cuda:0')
compute distance is  tensor(98.3052, device='cuda:0')
compute distance is  tensor(11.0467, device='cuda:0')
calculated distance threshold is  tensor(80.8535, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8808000001563221
====================
====================
iteration is  0
round is  1
accuracy is  0.8878000001563218
====================
====================
iteration is  0
round is  2
accuracy is  0.882550000156322
====================
====================
iteration is  1
round is  0
accuracy is  0.8843666668229887
====================
====================
iteration is  1
round is  1
accuracy is  0.8818666668229888
====================
====================
iteration is  1
round is  2
accuracy is  0.8894500001563218
====================
====================
iteration is  2
round is  0
accuracy is  0.8876666668229886
====================
====================
iteration is  2
round is  1
accuracy is  0.8769000001563223
====================
====================
iteration is  2
round is  2
accuracy is  0.8779833334896556
====================
====================
iteration is  3
round is  0
accuracy is  0.8797666668229888
====================
====================
iteration is  3
round is  1
accuracy is  0.8803666668229888
====================
====================
iteration is  3
round is  2
accuracy is  0.8904166668229885
====================
====================
iteration is  4
round is  0
accuracy is  0.8785500001563222
====================
====================
iteration is  4
round is  1
accuracy is  0.8832666668229887
====================
====================
iteration is  4
round is  2
accuracy is  0.8791333334896555
====================
====================
iteration is  5
round is  0
accuracy is  0.865283333489656
====================
succ_min + 1
====================
iteration is  5
round is  1
accuracy is  0.8627000001563229
====================
succ_min + 1
====================
iteration is  5
round is  2
accuracy is  0.8809500001563221
====================
====================
iteration is  6
round is  0
accuracy is  0.8708000001563225
====================
====================
iteration is  6
round is  1
accuracy is  0.8794000001563221
====================
====================
iteration is  6
round is  2
accuracy is  0.8731833334896558
====================
====================
iteration is  7
round is  0
accuracy is  0.8788833334896554
====================
====================
iteration is  7
round is  1
accuracy is  0.8715333334896558
====================
====================
iteration is  7
round is  2
accuracy is  0.8767833334896555
====================
====================
iteration is  8
round is  0
accuracy is  0.8787833334896554
====================
====================
iteration is  8
round is  1
accuracy is  0.8717833334896559
====================
________________________________
test distance is  tensor(822.1318, device='cuda:0')
test acc is  0.8627000001563229
test entropy is  0.18749577590206792
________________________________
diff is  tensor(3.5148, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0560, device='cuda:0', dtype=torch.float64)
diff is  tensor(228.0774, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0805, device='cuda:0', dtype=torch.float64)
diff is  tensor(586.7874, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3197, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2680, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0283, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.5148, device='cuda:0')
clipping
cal diff is tensor(0.0560, device='cuda:0')
clipping
cal diff is tensor(228.0774, device='cuda:0')
clipping
cal diff is tensor(0.0805, device='cuda:0')
clipping
cal diff is tensor(586.7874, device='cuda:0')
clipping
cal diff is tensor(0.3197, device='cuda:0')
clipping
cal diff is tensor(3.2680, device='cuda:0')
clipping
cal diff is tensor(0.0283, device='cuda:0')
clipping
________________________________
test distance is  tensor(741.2780, device='cuda:0')
test acc is  0.8656500001563228
test entropy is  0.182981183899364
________________________________
diff is  tensor(3.1691, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0505, device='cuda:0', dtype=torch.float64)
diff is  tensor(205.6468, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0726, device='cuda:0', dtype=torch.float64)
diff is  tensor(529.0789, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2883, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.9466, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0255, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.1691, device='cuda:0')
clipping
cal diff is tensor(0.0505, device='cuda:0')
clipping
cal diff is tensor(205.6468, device='cuda:0')
clipping
cal diff is tensor(0.0726, device='cuda:0')
clipping
cal diff is tensor(529.0789, device='cuda:0')
clipping
cal diff is tensor(0.2883, device='cuda:0')
clipping
cal diff is tensor(2.9466, device='cuda:0')
clipping
cal diff is tensor(0.0255, device='cuda:0')
clipping
________________________________
test distance is  tensor(660.4243, device='cuda:0')
test acc is  0.8686166668229893
test entropy is  0.1788621841193135
________________________________
diff is  tensor(2.8234, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0450, device='cuda:0', dtype=torch.float64)
diff is  tensor(183.2162, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0647, device='cuda:0', dtype=torch.float64)
diff is  tensor(471.3705, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2568, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.6252, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0227, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.8234, device='cuda:0')
clipping
cal diff is tensor(0.0450, device='cuda:0')
clipping
cal diff is tensor(183.2162, device='cuda:0')
clipping
cal diff is tensor(0.0647, device='cuda:0')
clipping
cal diff is tensor(471.3705, device='cuda:0')
clipping
cal diff is tensor(0.2568, device='cuda:0')
clipping
cal diff is tensor(2.6252, device='cuda:0')
clipping
cal diff is tensor(0.0227, device='cuda:0')
clipping
________________________________
test distance is  tensor(579.5706, device='cuda:0')
test acc is  0.8714500001563225
test entropy is  0.17511237370592952
________________________________
diff is  tensor(2.4778, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0395, device='cuda:0', dtype=torch.float64)
diff is  tensor(160.7856, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0568, device='cuda:0', dtype=torch.float64)
diff is  tensor(413.6620, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2254, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.3038, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0199, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.4778, device='cuda:0')
clipping
cal diff is tensor(0.0395, device='cuda:0')
clipping
cal diff is tensor(160.7856, device='cuda:0')
clipping
cal diff is tensor(0.0568, device='cuda:0')
clipping
cal diff is tensor(413.6620, device='cuda:0')
clipping
cal diff is tensor(0.2254, device='cuda:0')
clipping
cal diff is tensor(2.3038, device='cuda:0')
clipping
cal diff is tensor(0.0199, device='cuda:0')
clipping
________________________________
test distance is  tensor(498.7168, device='cuda:0')
test acc is  0.8745333334896557
test entropy is  0.17177582210473924
________________________________
diff is  tensor(2.1321, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0340, device='cuda:0', dtype=torch.float64)
diff is  tensor(138.3550, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0489, device='cuda:0', dtype=torch.float64)
diff is  tensor(355.9536, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1940, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.9824, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0172, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.1321, device='cuda:0')
clipping
cal diff is tensor(0.0340, device='cuda:0')
clipping
cal diff is tensor(138.3550, device='cuda:0')
clipping
cal diff is tensor(0.0489, device='cuda:0')
clipping
cal diff is tensor(355.9536, device='cuda:0')
clipping
cal diff is tensor(0.1940, device='cuda:0')
clipping
cal diff is tensor(1.9824, device='cuda:0')
clipping
cal diff is tensor(0.0172, device='cuda:0')
clipping
________________________________
test distance is  tensor(417.8631, device='cuda:0')
test acc is  0.8773666668229889
test entropy is  0.16882107537120644
________________________________
diff is  tensor(1.7864, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0285, device='cuda:0', dtype=torch.float64)
diff is  tensor(115.9245, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0409, device='cuda:0', dtype=torch.float64)
diff is  tensor(298.2452, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1625, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.6610, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0144, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.7864, device='cuda:0')
clipping
cal diff is tensor(0.0285, device='cuda:0')
clipping
cal diff is tensor(115.9245, device='cuda:0')
clipping
cal diff is tensor(0.0409, device='cuda:0')
clipping
cal diff is tensor(298.2452, device='cuda:0')
clipping
cal diff is tensor(0.1625, device='cuda:0')
clipping
cal diff is tensor(1.6610, device='cuda:0')
clipping
cal diff is tensor(0.0144, device='cuda:0')
clipping
________________________________
test distance is  tensor(337.0094, device='cuda:0')
test acc is  0.8801833334896555
test entropy is  0.1662724781423998
________________________________
diff is  tensor(1.4408, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0229, device='cuda:0', dtype=torch.float64)
diff is  tensor(93.4939, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0330, device='cuda:0', dtype=torch.float64)
diff is  tensor(240.5367, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1311, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3396, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0116, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.4408, device='cuda:0')
clipping
cal diff is tensor(0.0229, device='cuda:0')
clipping
cal diff is tensor(93.4939, device='cuda:0')
clipping
cal diff is tensor(0.0330, device='cuda:0')
clipping
cal diff is tensor(240.5367, device='cuda:0')
clipping
cal diff is tensor(0.1311, device='cuda:0')
clipping
cal diff is tensor(1.3396, device='cuda:0')
clipping
cal diff is tensor(0.0116, device='cuda:0')
clipping
________________________________
test distance is  tensor(256.1557, device='cuda:0')
test acc is  0.8827166668229887
test entropy is  0.1641178802886942
________________________________
diff is  tensor(1.0951, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0174, device='cuda:0', dtype=torch.float64)
diff is  tensor(71.0633, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0251, device='cuda:0', dtype=torch.float64)
diff is  tensor(182.8283, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0996, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.0182, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0088, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0951, device='cuda:0')
clipping
cal diff is tensor(0.0174, device='cuda:0')
clipping
cal diff is tensor(71.0633, device='cuda:0')
clipping
cal diff is tensor(0.0251, device='cuda:0')
clipping
cal diff is tensor(182.8283, device='cuda:0')
clipping
cal diff is tensor(0.0996, device='cuda:0')
clipping
cal diff is tensor(1.0182, device='cuda:0')
clipping
cal diff is tensor(0.0088, device='cuda:0')
clipping
________________________________
test distance is  tensor(175.3020, device='cuda:0')
test acc is  0.8851833334896552
test entropy is  0.16234861046615948
________________________________
diff is  tensor(0.7494, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0119, device='cuda:0', dtype=torch.float64)
diff is  tensor(48.6327, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0172, device='cuda:0', dtype=torch.float64)
diff is  tensor(125.1199, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0682, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6968, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0060, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.7494, device='cuda:0')
clipping
cal diff is tensor(0.0119, device='cuda:0')
clipping
cal diff is tensor(48.6327, device='cuda:0')
clipping
cal diff is tensor(0.0172, device='cuda:0')
clipping
cal diff is tensor(125.1199, device='cuda:0')
clipping
cal diff is tensor(0.0682, device='cuda:0')
clipping
cal diff is tensor(0.6968, device='cuda:0')
clipping
cal diff is tensor(0.0060, device='cuda:0')
clipping
________________________________
test distance is  tensor(94.4483, device='cuda:0')
test acc is  0.8876166668229886
test entropy is  0.16097892672697237
________________________________
diff is  tensor(0.4038, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0064, device='cuda:0', dtype=torch.float64)
diff is  tensor(26.2022, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0093, device='cuda:0', dtype=torch.float64)
diff is  tensor(67.4115, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0367, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3754, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0033, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.4038, device='cuda:0')
clipping
cal diff is tensor(0.0064, device='cuda:0')
clipping
cal diff is tensor(26.2022, device='cuda:0')
clipping
cal diff is tensor(0.0093, device='cuda:0')
clipping
cal diff is tensor(67.4115, device='cuda:0')
clipping
cal diff is tensor(0.0367, device='cuda:0')
clipping
cal diff is tensor(0.3754, device='cuda:0')
clipping
cal diff is tensor(0.0033, device='cuda:0')
clipping
________________________________
test distance is  tensor(13.5949, device='cuda:0')
test acc is  0.8891666668229884
test entropy is  0.1599894497178193
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1599894497178193
avg test loss is  0.32234654311479916
avg accuracy is  0.8891666668229884
compute_distance is  tensor(13.5949, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18303407055101414
avg test loss is  0.41881069246290337
avg accuracy is  0.8637000001563229
compute_distance is  tensor(91.5169, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(91.5169, device='cuda:0')
test acc is  0.8637000001563229
test entropy is  0.18303407055101414
________________________________
diff is  tensor(0.1594, device='cuda:0')
diff is  tensor(0.0018, device='cuda:0')
diff is  tensor(14.1063, device='cuda:0')
diff is  tensor(0.0068, device='cuda:0')
diff is  tensor(77.0827, device='cuda:0')
diff is  tensor(0.0088, device='cuda:0')
diff is  tensor(0.1513, device='cuda:0')
diff is  tensor(0.0007, device='cuda:0')
cal diff is tensor(0.1594, device='cuda:0')
clipping
cal diff is tensor(0.0018, device='cuda:0')
clipping
cal diff is tensor(14.1063, device='cuda:0')
clipping
cal diff is tensor(0.0068, device='cuda:0')
clipping
cal diff is tensor(77.0827, device='cuda:0')
clipping
cal diff is tensor(0.0088, device='cuda:0')
clipping
cal diff is tensor(0.1513, device='cuda:0')
clipping
cal diff is tensor(0.0007, device='cuda:0')
clipping
________________________________
test distance is  tensor(10.6634, device='cuda:0')
test acc is  0.8866833334896552
test entropy is  0.16212280008044325
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16212280008044325
avg test loss is  0.33127073666402523
avg accuracy is  0.8866833334896552
compute_distance is  tensor(10.6634, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18293773602130317
avg test loss is  0.4191956861075689
avg accuracy is  0.8636500001563229
compute_distance is  tensor(98.7669, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(98.7669, device='cuda:0')
test acc is  0.8636500001563229
test entropy is  0.18293773602130317
________________________________
diff is  tensor(0.1523, device='cuda:0')
diff is  tensor(0.0017, device='cuda:0')
diff is  tensor(14.4565, device='cuda:0')
diff is  tensor(0.0074, device='cuda:0')
diff is  tensor(83.9981, device='cuda:0')
diff is  tensor(0.0073, device='cuda:0')
diff is  tensor(0.1427, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1523, device='cuda:0')
clipping
cal diff is tensor(0.0017, device='cuda:0')
clipping
cal diff is tensor(14.4565, device='cuda:0')
clipping
cal diff is tensor(0.0074, device='cuda:0')
clipping
cal diff is tensor(83.9981, device='cuda:0')
clipping
cal diff is tensor(0.0073, device='cuda:0')
clipping
cal diff is tensor(0.1427, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(17.9139, device='cuda:0')
test acc is  0.8849666668229885
test entropy is  0.1633775978486167
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1633775978486167
avg test loss is  0.3369598021385258
avg accuracy is  0.8849666668229885
compute_distance is  tensor(17.9139, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1828859675604143
avg test loss is  0.41945107013924415
avg accuracy is  0.8635500001563229
compute_distance is  tensor(105.1310, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(105.1310, device='cuda:0')
test acc is  0.8635500001563229
test entropy is  0.1828859675604143
________________________________
diff is  tensor(0.1585, device='cuda:0')
diff is  tensor(0.0018, device='cuda:0')
diff is  tensor(15.4534, device='cuda:0')
diff is  tensor(0.0079, device='cuda:0')
diff is  tensor(89.3539, device='cuda:0')
diff is  tensor(0.0075, device='cuda:0')
diff is  tensor(0.1459, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1585, device='cuda:0')
clipping
cal diff is tensor(0.0018, device='cuda:0')
clipping
cal diff is tensor(15.4534, device='cuda:0')
clipping
cal diff is tensor(0.0079, device='cuda:0')
clipping
cal diff is tensor(89.3539, device='cuda:0')
clipping
cal diff is tensor(0.0075, device='cuda:0')
clipping
cal diff is tensor(0.1459, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(24.2786, device='cuda:0')
test acc is  0.8834833334896554
test entropy is  0.16435207968661145
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16435207968661145
avg test loss is  0.341386719203707
avg accuracy is  0.8834833334896554
compute_distance is  tensor(24.2786, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18284466227234553
avg test loss is  0.41959441430977923
avg accuracy is  0.8634833334896562
compute_distance is  tensor(110.5846, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(110.5846, device='cuda:0')
test acc is  0.8634833334896562
test entropy is  0.18284466227234553
________________________________
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0019, device='cuda:0')
diff is  tensor(16.3167, device='cuda:0')
diff is  tensor(0.0084, device='cuda:0')
diff is  tensor(93.9335, device='cuda:0')
diff is  tensor(0.0077, device='cuda:0')
diff is  tensor(0.1491, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0019, device='cuda:0')
clipping
cal diff is tensor(16.3167, device='cuda:0')
clipping
cal diff is tensor(0.0084, device='cuda:0')
clipping
cal diff is tensor(93.9335, device='cuda:0')
clipping
cal diff is tensor(0.0077, device='cuda:0')
clipping
cal diff is tensor(0.1491, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(29.7327, device='cuda:0')
test acc is  0.8825666668229887
test entropy is  0.1650969866575844
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1650969866575844
avg test loss is  0.34479992691753136
avg accuracy is  0.8825666668229887
compute_distance is  tensor(29.7327, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18279553829892867
avg test loss is  0.4197402532254137
avg accuracy is  0.8633833334896562
compute_distance is  tensor(115.2048, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(115.2048, device='cuda:0')
test acc is  0.8633833334896562
test entropy is  0.18279553829892867
________________________________
diff is  tensor(0.1693, device='cuda:0')
diff is  tensor(0.0019, device='cuda:0')
diff is  tensor(17.0510, device='cuda:0')
diff is  tensor(0.0089, device='cuda:0')
diff is  tensor(97.8106, device='cuda:0')
diff is  tensor(0.0079, device='cuda:0')
diff is  tensor(0.1517, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1693, device='cuda:0')
clipping
cal diff is tensor(0.0019, device='cuda:0')
clipping
cal diff is tensor(17.0510, device='cuda:0')
clipping
cal diff is tensor(0.0089, device='cuda:0')
clipping
cal diff is tensor(97.8106, device='cuda:0')
clipping
cal diff is tensor(0.0079, device='cuda:0')
clipping
cal diff is tensor(0.1517, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(34.3534, device='cuda:0')
test acc is  0.8816833334896554
test entropy is  0.16567014094624818
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16567014094624818
avg test loss is  0.34748196696389966
avg accuracy is  0.8816833334896554
compute_distance is  tensor(34.3534, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18277707933458184
avg test loss is  0.41985229700247745
avg accuracy is  0.8633000001563229
compute_distance is  tensor(119.1292, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(119.1292, device='cuda:0')
test acc is  0.8633000001563229
test entropy is  0.18277707933458184
________________________________
diff is  tensor(0.1737, device='cuda:0')
diff is  tensor(0.0020, device='cuda:0')
diff is  tensor(17.6665, device='cuda:0')
diff is  tensor(0.0092, device='cuda:0')
diff is  tensor(101.1118, device='cuda:0')
diff is  tensor(0.0080, device='cuda:0')
diff is  tensor(0.1540, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1737, device='cuda:0')
clipping
cal diff is tensor(0.0020, device='cuda:0')
clipping
cal diff is tensor(17.6665, device='cuda:0')
clipping
cal diff is tensor(0.0092, device='cuda:0')
clipping
cal diff is tensor(101.1118, device='cuda:0')
clipping
cal diff is tensor(0.0080, device='cuda:0')
clipping
cal diff is tensor(0.1540, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(38.2781, device='cuda:0')
test acc is  0.8809500001563221
test entropy is  0.16612694441461995
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16612694441461995
avg test loss is  0.3496181260365476
avg accuracy is  0.8809500001563221
compute_distance is  tensor(38.2781, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18275128618708805
avg test loss is  0.41991492875539926
avg accuracy is  0.8633833334896562
compute_distance is  tensor(122.4362, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(122.4362, device='cuda:0')
test acc is  0.8633833334896562
test entropy is  0.18275128618708805
________________________________
diff is  tensor(0.1773, device='cuda:0')
diff is  tensor(0.0020, device='cuda:0')
diff is  tensor(18.1918, device='cuda:0')
diff is  tensor(0.0096, device='cuda:0')
diff is  tensor(103.8872, device='cuda:0')
diff is  tensor(0.0081, device='cuda:0')
diff is  tensor(0.1559, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1773, device='cuda:0')
clipping
cal diff is tensor(0.0020, device='cuda:0')
clipping
cal diff is tensor(18.1918, device='cuda:0')
clipping
cal diff is tensor(0.0096, device='cuda:0')
clipping
cal diff is tensor(103.8872, device='cuda:0')
clipping
cal diff is tensor(0.0081, device='cuda:0')
clipping
cal diff is tensor(0.1559, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(41.5854, device='cuda:0')
test acc is  0.8804333334896555
test entropy is  0.16648223282876554
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16648223282876554
avg test loss is  0.3513173747942773
avg accuracy is  0.8804333334896555
compute_distance is  tensor(41.5854, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18273836469599433
avg test loss is  0.41999781867270786
avg accuracy is  0.8633333334896562
compute_distance is  tensor(125.1950, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(125.1950, device='cuda:0')
test acc is  0.8633333334896562
test entropy is  0.18273836469599433
________________________________
diff is  tensor(0.1803, device='cuda:0')
diff is  tensor(0.0020, device='cuda:0')
diff is  tensor(18.6415, device='cuda:0')
diff is  tensor(0.0099, device='cuda:0')
diff is  tensor(106.1910, device='cuda:0')
diff is  tensor(0.0082, device='cuda:0')
diff is  tensor(0.1574, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1803, device='cuda:0')
clipping
cal diff is tensor(0.0020, device='cuda:0')
clipping
cal diff is tensor(18.6415, device='cuda:0')
clipping
cal diff is tensor(0.0099, device='cuda:0')
clipping
cal diff is tensor(106.1910, device='cuda:0')
clipping
cal diff is tensor(0.0082, device='cuda:0')
clipping
cal diff is tensor(0.1574, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(44.3444, device='cuda:0')
test acc is  0.8800833334896555
test entropy is  0.166772125991804
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166772125991804
avg test loss is  0.352684183487061
avg accuracy is  0.8800833334896555
compute_distance is  tensor(44.3444, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18271795905697574
avg test loss is  0.4200701000593873
avg accuracy is  0.8633166668229896
compute_distance is  tensor(127.4767, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(127.4767, device='cuda:0')
test acc is  0.8633166668229896
test entropy is  0.18271795905697574
________________________________
diff is  tensor(0.1827, device='cuda:0')
diff is  tensor(0.0021, device='cuda:0')
diff is  tensor(19.0300, device='cuda:0')
diff is  tensor(0.0101, device='cuda:0')
diff is  tensor(108.0799, device='cuda:0')
diff is  tensor(0.0083, device='cuda:0')
diff is  tensor(0.1586, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1827, device='cuda:0')
clipping
cal diff is tensor(0.0021, device='cuda:0')
clipping
cal diff is tensor(19.0300, device='cuda:0')
clipping
cal diff is tensor(0.0101, device='cuda:0')
clipping
cal diff is tensor(108.0799, device='cuda:0')
clipping
cal diff is tensor(0.0083, device='cuda:0')
clipping
cal diff is tensor(0.1586, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(46.6263, device='cuda:0')
test acc is  0.8798333334896554
test entropy is  0.16699228140273328
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16699228140273328
avg test loss is  0.3537692238828902
avg accuracy is  0.8798333334896554
compute_distance is  tensor(46.6263, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18269371355711017
avg test loss is  0.42012388774279213
avg accuracy is  0.8633166668229896
compute_distance is  tensor(129.3265, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(129.3265, device='cuda:0')
test acc is  0.8633166668229896
test entropy is  0.18269371355711017
________________________________
diff is  tensor(0.1849, device='cuda:0')
diff is  tensor(0.0021, device='cuda:0')
diff is  tensor(19.3295, device='cuda:0')
diff is  tensor(0.0103, device='cuda:0')
diff is  tensor(109.6265, device='cuda:0')
diff is  tensor(0.0084, device='cuda:0')
diff is  tensor(0.1597, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1849, device='cuda:0')
clipping
cal diff is tensor(0.0021, device='cuda:0')
clipping
cal diff is tensor(19.3295, device='cuda:0')
clipping
cal diff is tensor(0.0103, device='cuda:0')
clipping
cal diff is tensor(109.6265, device='cuda:0')
clipping
cal diff is tensor(0.0084, device='cuda:0')
clipping
cal diff is tensor(0.1597, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(48.4763, device='cuda:0')
test acc is  0.8794500001563221
test entropy is  0.167160545684286
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.167160545684286
avg test loss is  0.354621214569727
avg accuracy is  0.8794500001563221
compute_distance is  tensor(48.4763, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826848010741063
avg test loss is  0.4201798525247683
avg accuracy is  0.8633166668229896
compute_distance is  tensor(130.8556, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(130.8556, device='cuda:0')
test acc is  0.8633166668229896
test entropy is  0.1826848010741063
________________________________
diff is  tensor(0.1867, device='cuda:0')
diff is  tensor(0.0021, device='cuda:0')
diff is  tensor(19.5818, device='cuda:0')
diff is  tensor(0.0105, device='cuda:0')
diff is  tensor(110.9003, device='cuda:0')
diff is  tensor(0.0084, device='cuda:0')
diff is  tensor(0.1606, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1867, device='cuda:0')
clipping
cal diff is tensor(0.0021, device='cuda:0')
clipping
cal diff is tensor(19.5818, device='cuda:0')
clipping
cal diff is tensor(0.0105, device='cuda:0')
clipping
cal diff is tensor(110.9003, device='cuda:0')
clipping
cal diff is tensor(0.0084, device='cuda:0')
clipping
cal diff is tensor(0.1606, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(50.0055, device='cuda:0')
test acc is  0.8793500001563221
test entropy is  0.16730720705505628
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16730720705505628
avg test loss is  0.35533750166834543
avg accuracy is  0.8793500001563221
compute_distance is  tensor(50.0055, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18267694610490728
avg test loss is  0.4202344717422147
avg accuracy is  0.8632833334896562
compute_distance is  tensor(132.1398, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(132.1398, device='cuda:0')
test acc is  0.8632833334896562
test entropy is  0.18267694610490728
________________________________
diff is  tensor(0.1882, device='cuda:0')
diff is  tensor(0.0021, device='cuda:0')
diff is  tensor(19.8062, device='cuda:0')
diff is  tensor(0.0106, device='cuda:0')
diff is  tensor(111.9575, device='cuda:0')
diff is  tensor(0.0084, device='cuda:0')
diff is  tensor(0.1613, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1882, device='cuda:0')
clipping
cal diff is tensor(0.0021, device='cuda:0')
clipping
cal diff is tensor(19.8062, device='cuda:0')
clipping
cal diff is tensor(0.0106, device='cuda:0')
clipping
cal diff is tensor(111.9575, device='cuda:0')
clipping
cal diff is tensor(0.0084, device='cuda:0')
clipping
cal diff is tensor(0.1613, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(51.2898, device='cuda:0')
test acc is  0.8792166668229888
test entropy is  0.16742883985643703
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16742883985643703
avg test loss is  0.35590782297302537
avg accuracy is  0.8792166668229888
compute_distance is  tensor(51.2898, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826655584723075
avg test loss is  0.420260874336081
avg accuracy is  0.8632666668229895
compute_distance is  tensor(133.2085, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(133.2085, device='cuda:0')
test acc is  0.8632666668229895
test entropy is  0.1826655584723075
________________________________
diff is  tensor(0.1894, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(19.9813, device='cuda:0')
diff is  tensor(0.0107, device='cuda:0')
diff is  tensor(112.8490, device='cuda:0')
diff is  tensor(0.0085, device='cuda:0')
diff is  tensor(0.1619, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1894, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(19.9813, device='cuda:0')
clipping
cal diff is tensor(0.0107, device='cuda:0')
clipping
cal diff is tensor(112.8490, device='cuda:0')
clipping
cal diff is tensor(0.0085, device='cuda:0')
clipping
cal diff is tensor(0.1619, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(52.3585, device='cuda:0')
test acc is  0.8790166668229888
test entropy is  0.16752571112184383
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16752571112184383
avg test loss is  0.3563825373869461
avg accuracy is  0.8790166668229888
compute_distance is  tensor(52.3585, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18265765201626047
avg test loss is  0.42026235299832276
avg accuracy is  0.8632333334896561
compute_distance is  tensor(134.0268, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(134.0268, device='cuda:0')
test acc is  0.8632333334896561
test entropy is  0.18265765201626047
________________________________
diff is  tensor(0.1905, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.0627, device='cuda:0')
diff is  tensor(0.0108, device='cuda:0')
diff is  tensor(113.5842, device='cuda:0')
diff is  tensor(0.0085, device='cuda:0')
diff is  tensor(0.1624, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1905, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.0627, device='cuda:0')
clipping
cal diff is tensor(0.0108, device='cuda:0')
clipping
cal diff is tensor(113.5842, device='cuda:0')
clipping
cal diff is tensor(0.0085, device='cuda:0')
clipping
cal diff is tensor(0.1624, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(53.1769, device='cuda:0')
test acc is  0.8788833334896554
test entropy is  0.16759614338244455
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16759614338244455
avg test loss is  0.35673897793250425
avg accuracy is  0.8788833334896554
compute_distance is  tensor(53.1769, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18264910843231277
avg test loss is  0.42028063833951823
avg accuracy is  0.8632166668229895
compute_distance is  tensor(134.6812, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(134.6812, device='cuda:0')
test acc is  0.8632166668229895
test entropy is  0.18264910843231277
________________________________
diff is  tensor(0.1914, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.1503, device='cuda:0')
diff is  tensor(0.0109, device='cuda:0')
diff is  tensor(114.1495, device='cuda:0')
diff is  tensor(0.0085, device='cuda:0')
diff is  tensor(0.1628, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1914, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.1503, device='cuda:0')
clipping
cal diff is tensor(0.0109, device='cuda:0')
clipping
cal diff is tensor(114.1495, device='cuda:0')
clipping
cal diff is tensor(0.0085, device='cuda:0')
clipping
cal diff is tensor(0.1628, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(53.8313, device='cuda:0')
test acc is  0.8788333334896555
test entropy is  0.1676511004217652
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1676511004217652
avg test loss is  0.35702969160463127
avg accuracy is  0.8788333334896555
compute_distance is  tensor(53.8313, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18264218673173552
avg test loss is  0.42027887261546115
avg accuracy is  0.8632500001563228
compute_distance is  tensor(135.2263, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(135.2263, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18264218673173552
________________________________
diff is  tensor(0.1920, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.2324, device='cuda:0')
diff is  tensor(0.0110, device='cuda:0')
diff is  tensor(114.6115, device='cuda:0')
diff is  tensor(0.0085, device='cuda:0')
diff is  tensor(0.1631, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1920, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.2324, device='cuda:0')
clipping
cal diff is tensor(0.0110, device='cuda:0')
clipping
cal diff is tensor(114.6115, device='cuda:0')
clipping
cal diff is tensor(0.0085, device='cuda:0')
clipping
cal diff is tensor(0.1631, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(54.3765, device='cuda:0')
test acc is  0.8787833334896555
test entropy is  0.1676964873650562
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1676964873650562
avg test loss is  0.3572414514821158
avg accuracy is  0.8787833334896555
compute_distance is  tensor(54.3765, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18264016506673175
avg test loss is  0.42028080461534867
avg accuracy is  0.8632500001563228
compute_distance is  tensor(135.6756, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(135.6756, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18264016506673175
________________________________
diff is  tensor(0.1925, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.3008, device='cuda:0')
diff is  tensor(0.0110, device='cuda:0')
diff is  tensor(114.9914, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1634, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1925, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.3008, device='cuda:0')
clipping
cal diff is tensor(0.0110, device='cuda:0')
clipping
cal diff is tensor(114.9914, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1634, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(54.8258, device='cuda:0')
test acc is  0.8787333334896555
test entropy is  0.16773397765402345
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16773397765402345
avg test loss is  0.35742423549167385
avg accuracy is  0.8787333334896555
compute_distance is  tensor(54.8258, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263531199841102
avg test loss is  0.420285602062464
avg accuracy is  0.8632500001563228
compute_distance is  tensor(136.0505, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(136.0505, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18263531199841102
________________________________
diff is  tensor(0.1929, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.3648, device='cuda:0')
diff is  tensor(0.0111, device='cuda:0')
diff is  tensor(115.3016, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1636, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1929, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.3648, device='cuda:0')
clipping
cal diff is tensor(0.0111, device='cuda:0')
clipping
cal diff is tensor(115.3016, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1636, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(55.2007, device='cuda:0')
test acc is  0.8786833334896555
test entropy is  0.16776100546915904
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16776100546915904
avg test loss is  0.35757165852544914
avg accuracy is  0.8786833334896555
compute_distance is  tensor(55.2007, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263154925663333
avg test loss is  0.4203151168107097
avg accuracy is  0.8632500001563228
compute_distance is  tensor(136.3742, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(136.3742, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18263154925663333
________________________________
diff is  tensor(0.1932, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.4195, device='cuda:0')
diff is  tensor(0.0111, device='cuda:0')
diff is  tensor(115.5701, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1637, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1932, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.4195, device='cuda:0')
clipping
cal diff is tensor(0.0111, device='cuda:0')
clipping
cal diff is tensor(115.5701, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1637, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(55.5245, device='cuda:0')
test acc is  0.8786833334896555
test entropy is  0.1677854175586055
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1677854175586055
avg test loss is  0.35771324105465463
avg accuracy is  0.8786833334896555
compute_distance is  tensor(55.5245, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263259485586367
avg test loss is  0.42032006309866143
avg accuracy is  0.8632500001563228
compute_distance is  tensor(136.6315, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(136.6315, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18263259485586367
________________________________
diff is  tensor(0.1935, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.4616, device='cuda:0')
diff is  tensor(0.0111, device='cuda:0')
diff is  tensor(115.7848, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1638, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1935, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.4616, device='cuda:0')
clipping
cal diff is tensor(0.0111, device='cuda:0')
clipping
cal diff is tensor(115.7848, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1638, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(55.7817, device='cuda:0')
test acc is  0.8786333334896556
test entropy is  0.16780835463167
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16780835463167
avg test loss is  0.35781366200541764
avg accuracy is  0.8786333334896556
compute_distance is  tensor(55.7817, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263537844202157
avg test loss is  0.4203168814227398
avg accuracy is  0.8632500001563228
compute_distance is  tensor(136.8513, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(136.8513, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18263537844202157
________________________________
diff is  tensor(0.1937, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.4969, device='cuda:0')
diff is  tensor(0.0112, device='cuda:0')
diff is  tensor(115.9690, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1639, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1937, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.4969, device='cuda:0')
clipping
cal diff is tensor(0.0112, device='cuda:0')
clipping
cal diff is tensor(115.9690, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1639, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.0016, device='cuda:0')
test acc is  0.8786000001563222
test entropy is  0.16782791597216623
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16782791597216623
avg test loss is  0.3579014771536533
avg accuracy is  0.8786000001563222
compute_distance is  tensor(56.0016, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263119985776416
avg test loss is  0.4203080017842464
avg accuracy is  0.8632666668229895
compute_distance is  tensor(137.0350, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.0350, device='cuda:0')
test acc is  0.8632666668229895
test entropy is  0.18263119985776416
________________________________
diff is  tensor(0.1939, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.5271, device='cuda:0')
diff is  tensor(0.0112, device='cuda:0')
diff is  tensor(116.1222, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1640, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1939, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.5271, device='cuda:0')
clipping
cal diff is tensor(0.0112, device='cuda:0')
clipping
cal diff is tensor(116.1222, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1640, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.1853, device='cuda:0')
test acc is  0.8785833334896556
test entropy is  0.1678411655588699
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1678411655588699
avg test loss is  0.3579785509158109
avg accuracy is  0.8785833334896556
compute_distance is  tensor(56.1853, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263170182673152
avg test loss is  0.4203141846580864
avg accuracy is  0.8632666668229895
compute_distance is  tensor(137.1932, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.1932, device='cuda:0')
test acc is  0.8632666668229895
test entropy is  0.18263170182673152
________________________________
diff is  tensor(0.1941, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.5505, device='cuda:0')
diff is  tensor(0.0112, device='cuda:0')
diff is  tensor(116.2567, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1641, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1941, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.5505, device='cuda:0')
clipping
cal diff is tensor(0.0112, device='cuda:0')
clipping
cal diff is tensor(116.2567, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1641, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.3436, device='cuda:0')
test acc is  0.8785666668229889
test entropy is  0.16785376784262626
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16785376784262626
avg test loss is  0.3580433476263526
avg accuracy is  0.8785666668229889
compute_distance is  tensor(56.3436, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263062645695102
avg test loss is  0.4203151006068883
avg accuracy is  0.8632166668229895
compute_distance is  tensor(137.3327, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.3327, device='cuda:0')
test acc is  0.8632166668229895
test entropy is  0.18263062645695102
________________________________
diff is  tensor(0.1943, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.5764, device='cuda:0')
diff is  tensor(0.0112, device='cuda:0')
diff is  tensor(116.3700, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1641, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1943, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.5764, device='cuda:0')
clipping
cal diff is tensor(0.0112, device='cuda:0')
clipping
cal diff is tensor(116.3700, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1641, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.4830, device='cuda:0')
test acc is  0.8785500001563222
test entropy is  0.16786618964440786
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16786618964440786
avg test loss is  0.35809678193936345
avg accuracy is  0.8785500001563222
compute_distance is  tensor(56.4830, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826303468139441
avg test loss is  0.4203068683348866
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.4433, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.4433, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.1826303468139441
________________________________
diff is  tensor(0.1944, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.5911, device='cuda:0')
diff is  tensor(0.0112, device='cuda:0')
diff is  tensor(116.4657, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1642, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1944, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.5911, device='cuda:0')
clipping
cal diff is tensor(0.0112, device='cuda:0')
clipping
cal diff is tensor(116.4657, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1642, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.5937, device='cuda:0')
test acc is  0.8785500001563222
test entropy is  0.16787562721065366
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16787562721065366
avg test loss is  0.3581316238090491
avg accuracy is  0.8785500001563222
compute_distance is  tensor(56.5937, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18263125947035197
avg test loss is  0.4203086410845711
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.5474, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.5474, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18263125947035197
________________________________
diff is  tensor(0.1945, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6099, device='cuda:0')
diff is  tensor(0.0112, device='cuda:0')
diff is  tensor(116.5508, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1643, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1945, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6099, device='cuda:0')
clipping
cal diff is tensor(0.0112, device='cuda:0')
clipping
cal diff is tensor(116.5508, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1643, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.6977, device='cuda:0')
test acc is  0.8785500001563222
test entropy is  0.16788281737836694
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16788281737836694
avg test loss is  0.3581748952203468
avg accuracy is  0.8785500001563222
compute_distance is  tensor(56.6977, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262645756321422
avg test loss is  0.42030680172447205
avg accuracy is  0.8632666668229895
compute_distance is  tensor(137.6262, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.6262, device='cuda:0')
test acc is  0.8632666668229895
test entropy is  0.18262645756321422
________________________________
diff is  tensor(0.1946, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6227, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.6167, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1643, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1946, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6227, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.6167, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1643, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.7765, device='cuda:0')
test acc is  0.8785500001563222
test entropy is  0.16788612923292973
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16788612923292973
avg test loss is  0.35819736771237876
avg accuracy is  0.8785500001563222
compute_distance is  tensor(56.7765, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826254973994262
avg test loss is  0.42032523731242366
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.6980, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.6980, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.1826254973994262
________________________________
diff is  tensor(0.1946, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6352, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.6758, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1643, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1946, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6352, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.6758, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1643, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.8483, device='cuda:0')
test acc is  0.8785333334896556
test entropy is  0.16789132444017224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16789132444017224
avg test loss is  0.3582327917400899
avg accuracy is  0.8785333334896556
compute_distance is  tensor(56.8483, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262489300483326
avg test loss is  0.42032109834015496
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.7421, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.7421, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18262489300483326
________________________________
diff is  tensor(0.1947, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6397, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7154, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1643, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1947, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6397, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7154, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1643, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.8924, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.1678925371691108
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1678925371691108
avg test loss is  0.35825514553515897
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.8924, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826262021147366
avg test loss is  0.4203152800840673
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.7821, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.7821, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.1826262021147366
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6528, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7422, device='cuda:0')
diff is  tensor(0.0086, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6528, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7422, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9324, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16789675173538327
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16789675173538327
avg test loss is  0.3582540234999616
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9324, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262636921267267
avg test loss is  0.42032842475102783
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8045, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8045, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18262636921267267
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6591, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7582, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6591, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7582, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9549, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.1678984151847327
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1678984151847327
avg test loss is  0.3582732967142738
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9549, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262809736610475
avg test loss is  0.42033002716598356
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8200, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8200, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18262809736610475
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6651, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7677, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6651, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7677, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9704, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.1679001689862722
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1679001689862722
avg test loss is  0.35827642432582785
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9704, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826269719551113
avg test loss is  0.4203282083148387
avg accuracy is  0.8632166668229895
compute_distance is  tensor(137.8271, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8271, device='cuda:0')
test acc is  0.8632166668229895
test entropy is  0.1826269719551113
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6679, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7719, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6679, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7719, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9775, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790062889679155
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790062889679155
avg test loss is  0.35828062169539776
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9775, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262718176282544
avg test loss is  0.42033497522523533
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8330, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8330, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18262718176282544
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6690, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7767, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6690, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7767, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9834, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.1679009931412206
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1679009931412206
avg test loss is  0.3582845732950961
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9834, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262616083470742
avg test loss is  0.42032498002115853
avg accuracy is  0.8632166668229895
compute_distance is  tensor(137.8366, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8366, device='cuda:0')
test acc is  0.8632166668229895
test entropy is  0.18262616083470742
________________________________
diff is  tensor(0.1949, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6724, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7770, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1949, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6724, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7770, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9870, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790177310104054
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790177310104054
avg test loss is  0.3582796565592607
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9870, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262440870120836
avg test loss is  0.4203278203167196
avg accuracy is  0.8632333334896561
compute_distance is  tensor(137.8352, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8352, device='cuda:0')
test acc is  0.8632333334896561
test entropy is  0.18262440870120836
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6733, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7747, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6733, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7747, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9856, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.1679004052443418
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1679004052443418
avg test loss is  0.3582838881752893
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9856, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262432201076417
avg test loss is  0.420316861712062
avg accuracy is  0.8632333334896561
compute_distance is  tensor(137.8311, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8311, device='cuda:0')
test acc is  0.8632333334896561
test entropy is  0.18262432201076417
________________________________
diff is  tensor(0.1949, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6704, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7734, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1949, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6704, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7734, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9815, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790103320596314
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790103320596314
avg test loss is  0.35827903106395625
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9815, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262734684322687
avg test loss is  0.42031429934380915
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8320, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8320, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18262734684322687
________________________________
diff is  tensor(0.1949, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6754, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7694, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1949, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6754, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7694, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9824, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790215026881142
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790215026881142
avg test loss is  0.35827878315343276
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9824, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262364085453914
avg test loss is  0.4203237721295372
avg accuracy is  0.8632333334896561
compute_distance is  tensor(137.8275, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8275, device='cuda:0')
test acc is  0.8632333334896561
test entropy is  0.18262364085453914
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6741, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7661, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6741, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7661, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9779, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790114902357048
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790114902357048
avg test loss is  0.3582798165203666
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9779, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826247137540312
avg test loss is  0.4203312660553562
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8221, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8221, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.1826247137540312
________________________________
diff is  tensor(0.1949, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6710, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7638, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1949, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6710, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7638, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9725, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790054311979807
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790054311979807
avg test loss is  0.3582814984253919
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9725, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262878834788224
avg test loss is  0.4203350750852559
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8187, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8187, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18262878834788224
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6706, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7608, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6706, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7608, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9691, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.167901729684331
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.167901729684331
avg test loss is  0.35827695448467856
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9691, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826254734273023
avg test loss is  0.42033405437954324
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8216, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8216, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.1826254734273023
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6737, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7606, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6737, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7606, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9720, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790157581951573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790157581951573
avg test loss is  0.35827702014987023
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9720, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262730124217869
avg test loss is  0.42033415943828983
avg accuracy is  0.8632500001563228
compute_distance is  tensor(137.8208, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8208, device='cuda:0')
test acc is  0.8632500001563228
test entropy is  0.18262730124217869
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6750, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7585, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6750, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7585, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9711, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790009459961197
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790009459961197
avg test loss is  0.35827615120803624
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9711, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1826283960406587
avg test loss is  0.4203370269943974
avg accuracy is  0.8632333334896561
compute_distance is  tensor(137.8173, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8173, device='cuda:0')
test acc is  0.8632333334896561
test entropy is  0.1826283960406587
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6737, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7564, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6737, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7564, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
________________________________
test distance is  tensor(56.9677, device='cuda:0')
test acc is  0.8785166668229889
test entropy is  0.16790078252331533
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16790078252331533
avg test loss is  0.3582770446144632
avg accuracy is  0.8785166668229889
compute_distance is  tensor(56.9677, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18262571742190226
avg test loss is  0.42033977200513456
avg accuracy is  0.8632333334896561
compute_distance is  tensor(137.8154, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(137.8154, device='cuda:0')
test acc is  0.8632333334896561
test entropy is  0.18262571742190226
________________________________
diff is  tensor(0.1948, device='cuda:0')
diff is  tensor(0.0022, device='cuda:0')
diff is  tensor(20.6735, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(116.7546, device='cuda:0')
diff is  tensor(0.0087, device='cuda:0')
diff is  tensor(0.1644, device='cuda:0')
diff is  tensor(0.0005, device='cuda:0')
cal diff is tensor(0.1948, device='cuda:0')
clipping
cal diff is tensor(0.0022, device='cuda:0')
clipping
cal diff is tensor(20.6735, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(116.7546, device='cuda:0')
clipping
cal diff is tensor(0.0087, device='cuda:0')
clipping
cal diff is tensor(0.1644, device='cuda:0')
clipping
cal diff is tensor(0.0005, device='cuda:0')
clipping
reach max round
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 90.11% 

Test Accuracy: 87.34% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0004624868161045015
len of model dicts is  10
compute distance is  tensor(42.5925, device='cuda:0')
compute distance is  tensor(54.8698, device='cuda:0')
compute distance is  tensor(71.3981, device='cuda:0')
compute distance is  tensor(120.4810, device='cuda:0')
compute distance is  tensor(71.2782, device='cuda:0')
compute distance is  tensor(88.1145, device='cuda:0')
compute distance is  tensor(106.3019, device='cuda:0')
compute distance is  tensor(85.3005, device='cuda:0')
compute distance is  tensor(107.3930, device='cuda:0')
compute distance is  tensor(9.2533, device='cuda:0')
calculated distance threshold is  tensor(98.2354, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8720000001563225
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8685166668229893
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8767833334896555
====================
====================
iteration is  1
round is  0
accuracy is  0.8659833334896561
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.877016666822989
====================
====================
iteration is  1
round is  2
accuracy is  0.8777333334896555
====================
====================
iteration is  2
round is  0
accuracy is  0.8811500001563222
====================
====================
iteration is  2
round is  1
accuracy is  0.8731833334896557
====================
====================
iteration is  2
round is  2
accuracy is  0.8687000001563226
====================
====================
iteration is  3
round is  0
accuracy is  0.8632833334896562
====================
succ_min + 1
________________________________
test distance is  tensor(679.6129, device='cuda:0')
test acc is  0.8632833334896562
test entropy is  0.17309841697912481
________________________________
diff is  tensor(3.0071, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0503, device='cuda:0', dtype=torch.float64)
diff is  tensor(188.8155, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0639, device='cuda:0', dtype=torch.float64)
diff is  tensor(484.6655, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2714, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.7124, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0269, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.0071, device='cuda:0')
clipping
cal diff is tensor(0.0503, device='cuda:0')
clipping
cal diff is tensor(188.8155, device='cuda:0')
clipping
cal diff is tensor(0.0639, device='cuda:0')
clipping
cal diff is tensor(484.6655, device='cuda:0')
clipping
cal diff is tensor(0.2714, device='cuda:0')
clipping
cal diff is tensor(2.7124, device='cuda:0')
clipping
cal diff is tensor(0.0269, device='cuda:0')
clipping
________________________________
test distance is  tensor(581.3773, device='cuda:0')
test acc is  0.8658166668229894
test entropy is  0.16955276007559508
________________________________
diff is  tensor(2.5724, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0430, device='cuda:0', dtype=torch.float64)
diff is  tensor(161.5229, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0547, device='cuda:0', dtype=torch.float64)
diff is  tensor(414.6088, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.3203, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0230, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.5724, device='cuda:0')
clipping
cal diff is tensor(0.0430, device='cuda:0')
clipping
cal diff is tensor(161.5229, device='cuda:0')
clipping
cal diff is tensor(0.0547, device='cuda:0')
clipping
cal diff is tensor(414.6088, device='cuda:0')
clipping
cal diff is tensor(0.2322, device='cuda:0')
clipping
cal diff is tensor(2.3203, device='cuda:0')
clipping
cal diff is tensor(0.0230, device='cuda:0')
________________________________
test distance is  tensor(483.1457, device='cuda:0')
test acc is  0.8683000001563226
test entropy is  0.16651862511820376
________________________________
diff is  tensor(2.1378, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0358, device='cuda:0', dtype=torch.float64)
diff is  tensor(134.2304, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0454, device='cuda:0', dtype=torch.float64)
diff is  tensor(344.5522, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1930, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.9282, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0230, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.1378, device='cuda:0')
clipping
cal diff is tensor(0.0358, device='cuda:0')
clipping
cal diff is tensor(134.2304, device='cuda:0')
clipping
cal diff is tensor(0.0454, device='cuda:0')
clipping
cal diff is tensor(344.5522, device='cuda:0')
clipping
cal diff is tensor(0.1930, device='cuda:0')
clipping
cal diff is tensor(1.9282, device='cuda:0')
clipping
cal diff is tensor(0.0230, device='cuda:0')
________________________________
test distance is  tensor(384.9148, device='cuda:0')
test acc is  0.8703500001563225
test entropy is  0.1639593818556589
________________________________
diff is  tensor(1.7031, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0285, device='cuda:0', dtype=torch.float64)
diff is  tensor(106.9380, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0362, device='cuda:0', dtype=torch.float64)
diff is  tensor(274.4962, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1537, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.5362, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0230, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.7031, device='cuda:0')
clipping
cal diff is tensor(0.0285, device='cuda:0')
clipping
cal diff is tensor(106.9380, device='cuda:0')
clipping
cal diff is tensor(0.0362, device='cuda:0')
clipping
cal diff is tensor(274.4962, device='cuda:0')
clipping
cal diff is tensor(0.1537, device='cuda:0')
clipping
cal diff is tensor(1.5362, device='cuda:0')
clipping
cal diff is tensor(0.0230, device='cuda:0')
________________________________
test distance is  tensor(286.6851, device='cuda:0')
test acc is  0.8719333334896558
test entropy is  0.16191658583372387
________________________________
diff is  tensor(1.2684, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0212, device='cuda:0', dtype=torch.float64)
diff is  tensor(79.6460, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0270, device='cuda:0', dtype=torch.float64)
diff is  tensor(204.4410, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1145, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1441, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0230, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.2684, device='cuda:0')
clipping
cal diff is tensor(0.0212, device='cuda:0')
cal diff is tensor(79.6460, device='cuda:0')
clipping
cal diff is tensor(0.0270, device='cuda:0')
clipping
cal diff is tensor(204.4409, device='cuda:0')
clipping
cal diff is tensor(0.1145, device='cuda:0')
clipping
cal diff is tensor(1.1441, device='cuda:0')
clipping
cal diff is tensor(0.0230, device='cuda:0')
clipping
________________________________
test distance is  tensor(188.4568, device='cuda:0')
test acc is  0.8729833334896557
test entropy is  0.16039798307869987
________________________________
diff is  tensor(0.8338, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0212, device='cuda:0', dtype=torch.float64)
diff is  tensor(52.3545, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0177, device='cuda:0', dtype=torch.float64)
diff is  tensor(134.3872, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0753, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7521, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0151, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.8338, device='cuda:0')
clipping
cal diff is tensor(0.0212, device='cuda:0')
clipping
cal diff is tensor(52.3545, device='cuda:0')
clipping
cal diff is tensor(0.0177, device='cuda:0')
clipping
cal diff is tensor(134.3872, device='cuda:0')
clipping
cal diff is tensor(0.0753, device='cuda:0')
clipping
cal diff is tensor(0.7521, device='cuda:0')
clipping
cal diff is tensor(0.0151, device='cuda:0')
________________________________
test distance is  tensor(90.2292, device='cuda:0')
test acc is  0.8735500001563223
test entropy is  0.1594445726939483
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1594445726939483
avg test loss is  0.3887181495671778
avg accuracy is  0.8735500001563223
compute_distance is  tensor(90.2292, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16874688249756534
avg test loss is  0.4236710585558465
avg accuracy is  0.8645333334896561
compute_distance is  tensor(131.0987, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(131.0987, device='cuda:0')
test acc is  0.8645333334896561
test entropy is  0.16874688249756534
________________________________
diff is  tensor(0.4618, device='cuda:0')
diff is  tensor(0.0107, device='cuda:0')
diff is  tensor(31.2578, device='cuda:0')
diff is  tensor(0.0104, device='cuda:0')
diff is  tensor(98.9129, device='cuda:0')
diff is  tensor(0.0369, device='cuda:0')
diff is  tensor(0.3906, device='cuda:0')
diff is  tensor(0.0152, device='cuda:0')
cal diff is tensor(0.4618, device='cuda:0')
clipping
cal diff is tensor(0.0107, device='cuda:0')
clipping
cal diff is tensor(31.2578, device='cuda:0')
clipping
cal diff is tensor(0.0104, device='cuda:0')
clipping
cal diff is tensor(98.9129, device='cuda:0')
clipping
cal diff is tensor(0.0369, device='cuda:0')
clipping
cal diff is tensor(0.3906, device='cuda:0')
clipping
cal diff is tensor(0.0152, device='cuda:0')
clipping
________________________________
test distance is  tensor(32.8649, device='cuda:0')
test acc is  0.8724166668229891
test entropy is  0.1609831390175611
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1609831390175611
avg test loss is  0.3945213656570675
avg accuracy is  0.8724166668229891
compute_distance is  tensor(32.8649, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16857373060734032
avg test loss is  0.42376620293473766
avg accuracy is  0.8646000001563228
compute_distance is  tensor(113.5989, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(113.5989, device='cuda:0')
test acc is  0.8646000001563228
test entropy is  0.16857373060734032
________________________________
diff is  tensor(0.2291, device='cuda:0')
diff is  tensor(0.0035, device='cuda:0')
diff is  tensor(18.5597, device='cuda:0')
diff is  tensor(0.0084, device='cuda:0')
diff is  tensor(94.6118, device='cuda:0')
diff is  tensor(0.0116, device='cuda:0')
diff is  tensor(0.1673, device='cuda:0')
diff is  tensor(0.0039, device='cuda:0')
cal diff is tensor(0.2291, device='cuda:0')
clipping
cal diff is tensor(0.0035, device='cuda:0')
clipping
cal diff is tensor(18.5597, device='cuda:0')
clipping
cal diff is tensor(0.0084, device='cuda:0')
clipping
cal diff is tensor(94.6118, device='cuda:0')
clipping
cal diff is tensor(0.0116, device='cuda:0')
clipping
cal diff is tensor(0.1673, device='cuda:0')
clipping
cal diff is tensor(0.0039, device='cuda:0')
clipping
________________________________
test distance is  tensor(15.3658, device='cuda:0')
test acc is  0.8731833334896557
test entropy is  0.1600518979187777
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1600518979187777
avg test loss is  0.3906469376864972
avg accuracy is  0.8731833334896557
compute_distance is  tensor(15.3658, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16862049436709012
avg test loss is  0.4233865301087022
avg accuracy is  0.8647000001563228
compute_distance is  tensor(103.3055, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(103.3055, device='cuda:0')
test acc is  0.8647000001563228
test entropy is  0.16862049436709012
________________________________
diff is  tensor(0.1776, device='cuda:0')
diff is  tensor(0.0017, device='cuda:0')
diff is  tensor(15.4649, device='cuda:0')
diff is  tensor(0.0078, device='cuda:0')
diff is  tensor(87.5147, device='cuda:0')
diff is  tensor(0.0069, device='cuda:0')
diff is  tensor(0.1279, device='cuda:0')
diff is  tensor(0.0006, device='cuda:0')
cal diff is tensor(0.1776, device='cuda:0')
clipping
cal diff is tensor(0.0017, device='cuda:0')
clipping
cal diff is tensor(15.4649, device='cuda:0')
clipping
cal diff is tensor(0.0078, device='cuda:0')
clipping
cal diff is tensor(87.5147, device='cuda:0')
clipping
cal diff is tensor(0.0069, device='cuda:0')
clipping
cal diff is tensor(0.1279, device='cuda:0')
clipping
cal diff is tensor(0.0006, device='cuda:0')
clipping
________________________________
test distance is  tensor(5.0727, device='cuda:0')
test acc is  0.8739000001563224
test entropy is  0.15941352564801795
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15941352564801795
avg test loss is  0.38786861543128615
avg accuracy is  0.8739000001563224
compute_distance is  tensor(5.0727, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16870381012717797
avg test loss is  0.4230059906482887
avg accuracy is  0.8647333334896561
compute_distance is  tensor(94.7542, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(94.7542, device='cuda:0')
test acc is  0.8647333334896561
test entropy is  0.16870381012717797
________________________________
new distance ratio is 0.8
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 90.10% 

Test Accuracy: 87.27% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00044181745033711195
len of model dicts is  10
compute distance is  tensor(41.5427, device='cuda:0')
compute distance is  tensor(79.0427, device='cuda:0')
compute distance is  tensor(140.6888, device='cuda:0')
compute distance is  tensor(97.5512, device='cuda:0')
compute distance is  tensor(83.8859, device='cuda:0')
compute distance is  tensor(74.6974, device='cuda:0')
compute distance is  tensor(111.3480, device='cuda:0')
compute distance is  tensor(58.1133, device='cuda:0')
compute distance is  tensor(109.0098, device='cuda:0')
compute distance is  tensor(8.8946, device='cuda:0')
calculated distance threshold is  tensor(114.3300, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8686166668229893
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.873566666822989
====================
====================
iteration is  0
round is  2
accuracy is  0.8741000001563224
====================
====================
iteration is  1
round is  0
accuracy is  0.8708166668229892
====================
====================
iteration is  1
round is  1
accuracy is  0.8730833334896557
====================
====================
iteration is  1
round is  2
accuracy is  0.8661666668229894
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.8574166668229897
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.8657333334896561
====================
________________________________
test distance is  tensor(618.5370, device='cuda:0')
test acc is  0.8574166668229897
test entropy is  0.17137453218957763
________________________________
diff is  tensor(2.6887, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0404, device='cuda:0', dtype=torch.float64)
diff is  tensor(172.4424, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0597, device='cuda:0', dtype=torch.float64)
diff is  tensor(440.5727, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2503, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.4631, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0203, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.6887, device='cuda:0')
clipping
cal diff is tensor(0.0404, device='cuda:0')
clipping
cal diff is tensor(172.4424, device='cuda:0')
clipping
cal diff is tensor(0.0597, device='cuda:0')
clipping
cal diff is tensor(440.5728, device='cuda:0')
clipping
cal diff is tensor(0.2503, device='cuda:0')
clipping
cal diff is tensor(2.4631, device='cuda:0')
clipping
cal diff is tensor(0.0203, device='cuda:0')
clipping
________________________________
test distance is  tensor(504.2066, device='cuda:0')
test acc is  0.8616500001563229
test entropy is  0.16697451724077084
________________________________
diff is  tensor(2.1917, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0329, device='cuda:0', dtype=torch.float64)
diff is  tensor(140.5682, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0487, device='cuda:0', dtype=torch.float64)
diff is  tensor(359.1373, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2040, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.0078, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0165, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.1917, device='cuda:0')
clipping
cal diff is tensor(0.0329, device='cuda:0')
clipping
cal diff is tensor(140.5682, device='cuda:0')
clipping
cal diff is tensor(0.0487, device='cuda:0')
clipping
cal diff is tensor(359.1373, device='cuda:0')
clipping
cal diff is tensor(0.2040, device='cuda:0')
clipping
cal diff is tensor(2.0078, device='cuda:0')
clipping
cal diff is tensor(0.0165, device='cuda:0')
________________________________
test distance is  tensor(389.8799, device='cuda:0')
test acc is  0.865133333489656
test entropy is  0.1631292400440809
________________________________
diff is  tensor(1.6947, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0254, device='cuda:0', dtype=torch.float64)
diff is  tensor(108.6940, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0377, device='cuda:0', dtype=torch.float64)
diff is  tensor(277.7018, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1577, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.5525, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0165, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.6947, device='cuda:0')
clipping
cal diff is tensor(0.0254, device='cuda:0')
clipping
cal diff is tensor(108.6940, device='cuda:0')
clipping
cal diff is tensor(0.0377, device='cuda:0')
clipping
cal diff is tensor(277.7018, device='cuda:0')
clipping
cal diff is tensor(0.1577, device='cuda:0')
clipping
cal diff is tensor(1.5525, device='cuda:0')
clipping
cal diff is tensor(0.0165, device='cuda:0')
________________________________
test distance is  tensor(275.5544, device='cuda:0')
test acc is  0.868533333489656
test entropy is  0.1598933055552084
________________________________
diff is  tensor(1.1977, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0180, device='cuda:0', dtype=torch.float64)
diff is  tensor(76.8201, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0266, device='cuda:0', dtype=torch.float64)
diff is  tensor(196.2671, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1115, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.0973, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0165, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.1977, device='cuda:0')
clipping
cal diff is tensor(0.0180, device='cuda:0')
clipping
cal diff is tensor(76.8201, device='cuda:0')
clipping
cal diff is tensor(0.0266, device='cuda:0')
clipping
cal diff is tensor(196.2672, device='cuda:0')
clipping
cal diff is tensor(0.1115, device='cuda:0')
clipping
cal diff is tensor(1.0973, device='cuda:0')
clipping
cal diff is tensor(0.0165, device='cuda:0')
________________________________
test distance is  tensor(161.2309, device='cuda:0')
test acc is  0.8709833334896558
test entropy is  0.15728206427763902
________________________________
diff is  tensor(0.7008, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0105, device='cuda:0', dtype=torch.float64)
diff is  tensor(44.9468, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0156, device='cuda:0', dtype=torch.float64)
diff is  tensor(114.8339, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0652, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6420, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0165, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.7008, device='cuda:0')
clipping
cal diff is tensor(0.0105, device='cuda:0')
cal diff is tensor(44.9468, device='cuda:0')
clipping
cal diff is tensor(0.0156, device='cuda:0')
clipping
cal diff is tensor(114.8339, device='cuda:0')
clipping
cal diff is tensor(0.0652, device='cuda:0')
clipping
cal diff is tensor(0.6420, device='cuda:0')
clipping
cal diff is tensor(0.0165, device='cuda:0')
clipping
________________________________
test distance is  tensor(46.9081, device='cuda:0')
test acc is  0.8728333334896559
test entropy is  0.15537376566402822
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15537376566402822
avg test loss is  0.40215279665122283
avg accuracy is  0.8728333334896559
compute_distance is  tensor(46.9081, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1681041398695283
avg test loss is  0.4513755292216661
avg accuracy is  0.8589666668229896
compute_distance is  tensor(104.5439, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(104.5439, device='cuda:0')
test acc is  0.8589666668229896
test entropy is  0.1681041398695283
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 90.06% 

Test Accuracy: 87.16% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00035764131462201476
len of model dicts is  10
compute distance is  tensor(55.6813, device='cuda:0')
compute distance is  tensor(71.2127, device='cuda:0')
compute distance is  tensor(97.3425, device='cuda:0')
compute distance is  tensor(118.0791, device='cuda:0')
compute distance is  tensor(117.6924, device='cuda:0')
compute distance is  tensor(42.3857, device='cuda:0')
compute distance is  tensor(95.5760, device='cuda:0')
compute distance is  tensor(65.5383, device='cuda:0')
compute distance is  tensor(116.3919, device='cuda:0')
compute distance is  tensor(8.4107, device='cuda:0')
calculated distance threshold is  tensor(96.1454, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8787000001563222
====================
====================
iteration is  0
round is  1
accuracy is  0.8707166668229892
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8718833334896559
====================
====================
iteration is  1
round is  0
accuracy is  0.8733333334896557
====================
====================
iteration is  1
round is  1
accuracy is  0.8723333334896558
====================
====================
iteration is  1
round is  2
accuracy is  0.875166666822989
====================
====================
iteration is  2
round is  0
accuracy is  0.8783500001563223
====================
====================
iteration is  2
round is  1
accuracy is  0.8751333334896557
====================
====================
iteration is  2
round is  2
accuracy is  0.8591166668229896
====================
succ_min + 1
====================
iteration is  3
round is  0
accuracy is  0.8657000001563228
====================
====================
iteration is  3
round is  1
accuracy is  0.8677000001563226
====================
________________________________
test distance is  tensor(618.3420, device='cuda:0')
test acc is  0.8591166668229896
test entropy is  0.16680868433069573
________________________________
diff is  tensor(2.8124, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0426, device='cuda:0', dtype=torch.float64)
diff is  tensor(172.0493, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0578, device='cuda:0', dtype=torch.float64)
diff is  tensor(440.6443, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2446, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.4632, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0279, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.8124, device='cuda:0')
clipping
cal diff is tensor(0.0426, device='cuda:0')
clipping
cal diff is tensor(172.0493, device='cuda:0')
clipping
cal diff is tensor(0.0578, device='cuda:0')
clipping
cal diff is tensor(440.6443, device='cuda:0')
clipping
cal diff is tensor(0.2446, device='cuda:0')
clipping
cal diff is tensor(2.4632, device='cuda:0')
clipping
cal diff is tensor(0.0279, device='cuda:0')
________________________________
test distance is  tensor(522.2009, device='cuda:0')
test acc is  0.8622333334896561
test entropy is  0.16309883937176103
________________________________
diff is  tensor(2.3751, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0360, device='cuda:0', dtype=torch.float64)
diff is  tensor(145.2975, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0488, device='cuda:0', dtype=torch.float64)
diff is  tensor(372.1289, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2066, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.0802, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0279, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.3751, device='cuda:0')
clipping
cal diff is tensor(0.0360, device='cuda:0')
clipping
cal diff is tensor(145.2975, device='cuda:0')
clipping
cal diff is tensor(0.0488, device='cuda:0')
clipping
cal diff is tensor(372.1288, device='cuda:0')
clipping
cal diff is tensor(0.2066, device='cuda:0')
clipping
cal diff is tensor(2.0802, device='cuda:0')
clipping
cal diff is tensor(0.0279, device='cuda:0')
________________________________
test distance is  tensor(426.0605, device='cuda:0')
test acc is  0.8649500001563227
test entropy is  0.15985884784317728
________________________________
diff is  tensor(1.9378, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0294, device='cuda:0', dtype=torch.float64)
diff is  tensor(118.5459, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0398, device='cuda:0', dtype=torch.float64)
diff is  tensor(303.6140, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1685, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.6972, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0279, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.9378, device='cuda:0')
clipping
cal diff is tensor(0.0294, device='cuda:0')
clipping
cal diff is tensor(118.5459, device='cuda:0')
clipping
cal diff is tensor(0.0398, device='cuda:0')
clipping
cal diff is tensor(303.6140, device='cuda:0')
clipping
cal diff is tensor(0.1685, device='cuda:0')
clipping
cal diff is tensor(1.6972, device='cuda:0')
clipping
cal diff is tensor(0.0279, device='cuda:0')
________________________________
test distance is  tensor(329.9213, device='cuda:0')
test acc is  0.8675500001563227
test entropy is  0.15712524308308737
________________________________
diff is  tensor(1.5005, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0227, device='cuda:0', dtype=torch.float64)
diff is  tensor(91.7946, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0308, device='cuda:0', dtype=torch.float64)
diff is  tensor(235.1000, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1305, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3142, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0279, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.5005, device='cuda:0')
clipping
cal diff is tensor(0.0227, device='cuda:0')
cal diff is tensor(91.7946, device='cuda:0')
clipping
cal diff is tensor(0.0308, device='cuda:0')
clipping
cal diff is tensor(235.1000, device='cuda:0')
clipping
cal diff is tensor(0.1305, device='cuda:0')
clipping
cal diff is tensor(1.3142, device='cuda:0')
clipping
cal diff is tensor(0.0279, device='cuda:0')
clipping
________________________________
test distance is  tensor(233.7824, device='cuda:0')
test acc is  0.8694000001563226
test entropy is  0.1550150236436553
________________________________
diff is  tensor(1.0632, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0227, device='cuda:0', dtype=torch.float64)
diff is  tensor(65.0439, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0219, device='cuda:0', dtype=torch.float64)
diff is  tensor(166.5873, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0925, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9312, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0198, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0632, device='cuda:0')
clipping
cal diff is tensor(0.0227, device='cuda:0')
clipping
cal diff is tensor(65.0439, device='cuda:0')
clipping
cal diff is tensor(0.0219, device='cuda:0')
clipping
cal diff is tensor(166.5873, device='cuda:0')
clipping
cal diff is tensor(0.0925, device='cuda:0')
clipping
cal diff is tensor(0.9312, device='cuda:0')
clipping
cal diff is tensor(0.0198, device='cuda:0')
clipping
________________________________
test distance is  tensor(137.6369, device='cuda:0')
test acc is  0.8710333334896558
test entropy is  0.15339102369270471
________________________________
diff is  tensor(0.6260, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0134, device='cuda:0', dtype=torch.float64)
diff is  tensor(38.2939, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0129, device='cuda:0', dtype=torch.float64)
diff is  tensor(98.0765, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0544, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5483, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0117, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.6260, device='cuda:0')
clipping
cal diff is tensor(0.0134, device='cuda:0')
clipping
cal diff is tensor(38.2939, device='cuda:0')
clipping
cal diff is tensor(0.0129, device='cuda:0')
clipping
cal diff is tensor(98.0765, device='cuda:0')
clipping
cal diff is tensor(0.0544, device='cuda:0')
clipping
cal diff is tensor(0.5483, device='cuda:0')
clipping
cal diff is tensor(0.0117, device='cuda:0')
________________________________
test distance is  tensor(41.4996, device='cuda:0')
test acc is  0.8724333334896558
test entropy is  0.15238539977813326
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15238539977813326
avg test loss is  0.4116526268946845
avg accuracy is  0.8724333334896558
compute_distance is  tensor(41.4996, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16316359227241228
avg test loss is  0.4444097711492195
avg accuracy is  0.8613000001563229
compute_distance is  tensor(101.0810, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(101.0810, device='cuda:0')
test acc is  0.8613000001563229
test entropy is  0.16316359227241228
________________________________
diff is  tensor(0.2399, device='cuda:0')
diff is  tensor(0.0047, device='cuda:0')
diff is  tensor(19.1349, device='cuda:0')
diff is  tensor(0.0083, device='cuda:0')
diff is  tensor(81.4455, device='cuda:0')
diff is  tensor(0.0174, device='cuda:0')
diff is  tensor(0.2147, device='cuda:0')
diff is  tensor(0.0115, device='cuda:0')
cal diff is tensor(0.2399, device='cuda:0')
clipping
cal diff is tensor(0.0047, device='cuda:0')
clipping
cal diff is tensor(19.1349, device='cuda:0')
clipping
cal diff is tensor(0.0083, device='cuda:0')
clipping
cal diff is tensor(81.4455, device='cuda:0')
clipping
cal diff is tensor(0.0174, device='cuda:0')
clipping
cal diff is tensor(0.2147, device='cuda:0')
clipping
cal diff is tensor(0.0115, device='cuda:0')
clipping
________________________________
test distance is  tensor(4.9384, device='cuda:0')
test acc is  0.8722500001563225
test entropy is  0.15253252190932917
________________________________
new distance ratio is 0.8
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 90.94% 

Test Accuracy: 88.44% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0003304920974187553
len of model dicts is  10
compute distance is  tensor(34.1328, device='cuda:0')
compute distance is  tensor(58.8696, device='cuda:0')
compute distance is  tensor(112.7551, device='cuda:0')
compute distance is  tensor(91.0071, device='cuda:0')
compute distance is  tensor(112.1871, device='cuda:0')
compute distance is  tensor(41.5097, device='cuda:0')
compute distance is  tensor(115.3251, device='cuda:0')
compute distance is  tensor(78.8072, device='cuda:0')
compute distance is  tensor(86.0102, device='cuda:0')
compute distance is  tensor(8.9598, device='cuda:0')
calculated distance threshold is  tensor(94.0521, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8860000001563219
====================
====================
iteration is  0
round is  1
accuracy is  0.8808666668229888
====================
====================
iteration is  0
round is  2
accuracy is  0.8802333334896555
====================
====================
iteration is  1
round is  0
accuracy is  0.8809333334896554
====================
====================
iteration is  1
round is  1
accuracy is  0.8778333334896555
====================
====================
iteration is  1
round is  2
accuracy is  0.8865666668229886
====================
====================
iteration is  2
round is  0
accuracy is  0.8687500001563226
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.8798500001563221
====================
====================
iteration is  2
round is  2
accuracy is  0.882400000156322
====================
====================
iteration is  3
round is  0
accuracy is  0.8727666668229892
====================
====================
iteration is  3
round is  1
accuracy is  0.8812833334896555
====================
====================
iteration is  3
round is  2
accuracy is  0.873716666822989
====================
====================
iteration is  4
round is  0
accuracy is  0.8729500001563225
====================
====================
iteration is  4
round is  1
accuracy is  0.877966666822989
====================
====================
iteration is  4
round is  2
accuracy is  0.8726666668229892
====================
====================
iteration is  5
round is  0
accuracy is  0.8736333334896557
====================
====================
iteration is  5
round is  1
accuracy is  0.8758666668229891
====================
====================
iteration is  5
round is  2
accuracy is  0.881700000156322
====================
====================
iteration is  6
round is  0
accuracy is  0.882850000156322
====================
====================
iteration is  6
round is  1
accuracy is  0.8669666668229893
====================
succ_min + 1
====================
iteration is  6
round is  2
accuracy is  0.8764000001563222
====================
====================
iteration is  7
round is  0
accuracy is  0.8745500001563223
====================
====================
iteration is  7
round is  1
accuracy is  0.8726333334896559
====================
====================
iteration is  7
round is  2
accuracy is  0.8687166668229893
====================
====================
iteration is  8
round is  0
accuracy is  0.8846833334896552
====================
====================
iteration is  8
round is  1
accuracy is  0.8812166668229888
====================
====================
iteration is  8
round is  2
accuracy is  0.8625666668229894
====================
succ_min + 1
====================
iteration is  9
round is  0
accuracy is  0.8411000001563236
====================
succ_min + 1
________________________________
test distance is  tensor(1203.4556, device='cuda:0')
test acc is  0.8411000001563236
test entropy is  0.20231742503196953
________________________________
diff is  tensor(5.1635, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0899, device='cuda:0', dtype=torch.float64)
diff is  tensor(334.3231, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1261, device='cuda:0', dtype=torch.float64)
diff is  tensor(858.4729, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4786, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.7585, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0428, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.1635, device='cuda:0')
clipping
cal diff is tensor(0.0899, device='cuda:0')
clipping
cal diff is tensor(334.3231, device='cuda:0')
clipping
cal diff is tensor(0.1261, device='cuda:0')
clipping
cal diff is tensor(858.4729, device='cuda:0')
clipping
cal diff is tensor(0.4786, device='cuda:0')
clipping
cal diff is tensor(4.7585, device='cuda:0')
clipping
cal diff is tensor(0.0428, device='cuda:0')
clipping
________________________________
test distance is  tensor(1109.4038, device='cuda:0')
test acc is  0.8467666668229902
test entropy is  0.19548612771067284
________________________________
diff is  tensor(4.7599, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0829, device='cuda:0', dtype=torch.float64)
diff is  tensor(308.1953, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1163, device='cuda:0', dtype=torch.float64)
diff is  tensor(791.3820, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4412, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.3866, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.7599, device='cuda:0')
clipping
cal diff is tensor(0.0829, device='cuda:0')
clipping
cal diff is tensor(308.1953, device='cuda:0')
clipping
cal diff is tensor(0.1163, device='cuda:0')
clipping
cal diff is tensor(791.3820, device='cuda:0')
clipping
cal diff is tensor(0.4412, device='cuda:0')
clipping
cal diff is tensor(4.3866, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
________________________________
test distance is  tensor(1015.3553, device='cuda:0')
test acc is  0.8527166668229899
test entropy is  0.18907813086851574
________________________________
diff is  tensor(4.3564, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0758, device='cuda:0', dtype=torch.float64)
diff is  tensor(282.0674, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1064, device='cuda:0', dtype=torch.float64)
diff is  tensor(724.2911, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4038, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.0147, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.3564, device='cuda:0')
clipping
cal diff is tensor(0.0758, device='cuda:0')
clipping
cal diff is tensor(282.0674, device='cuda:0')
clipping
cal diff is tensor(0.1064, device='cuda:0')
clipping
cal diff is tensor(724.2911, device='cuda:0')
clipping
cal diff is tensor(0.4038, device='cuda:0')
clipping
cal diff is tensor(4.0147, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
________________________________
test distance is  tensor(921.3071, device='cuda:0')
test acc is  0.8577333334896563
test entropy is  0.1831197775106059
________________________________
diff is  tensor(3.9529, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0688, device='cuda:0', dtype=torch.float64)
diff is  tensor(255.9396, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0966, device='cuda:0', dtype=torch.float64)
diff is  tensor(657.2003, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3664, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.6428, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.9529, device='cuda:0')
clipping
cal diff is tensor(0.0688, device='cuda:0')
clipping
cal diff is tensor(255.9396, device='cuda:0')
clipping
cal diff is tensor(0.0966, device='cuda:0')
clipping
cal diff is tensor(657.2003, device='cuda:0')
clipping
cal diff is tensor(0.3664, device='cuda:0')
clipping
cal diff is tensor(3.6428, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
________________________________
test distance is  tensor(827.2593, device='cuda:0')
test acc is  0.8619333334896562
test entropy is  0.17757833795919856
________________________________
diff is  tensor(3.5493, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0618, device='cuda:0', dtype=torch.float64)
diff is  tensor(229.8120, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0867, device='cuda:0', dtype=torch.float64)
diff is  tensor(590.1099, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3290, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2709, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.5493, device='cuda:0')
clipping
cal diff is tensor(0.0618, device='cuda:0')
clipping
cal diff is tensor(229.8120, device='cuda:0')
clipping
cal diff is tensor(0.0867, device='cuda:0')
clipping
cal diff is tensor(590.1099, device='cuda:0')
clipping
cal diff is tensor(0.3290, device='cuda:0')
clipping
cal diff is tensor(3.2709, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
________________________________
test distance is  tensor(733.2120, device='cuda:0')
test acc is  0.8660666668229894
test entropy is  0.1724853341036768
________________________________
diff is  tensor(3.1458, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0548, device='cuda:0', dtype=torch.float64)
diff is  tensor(203.6844, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0768, device='cuda:0', dtype=torch.float64)
diff is  tensor(523.0198, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2916, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.8991, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.1458, device='cuda:0')
clipping
cal diff is tensor(0.0548, device='cuda:0')
clipping
cal diff is tensor(203.6844, device='cuda:0')
clipping
cal diff is tensor(0.0768, device='cuda:0')
clipping
cal diff is tensor(523.0198, device='cuda:0')
clipping
cal diff is tensor(0.2916, device='cuda:0')
clipping
cal diff is tensor(2.8991, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
________________________________
test distance is  tensor(639.1653, device='cuda:0')
test acc is  0.8697000001563225
test entropy is  0.1678490532693197
________________________________
diff is  tensor(2.7423, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0477, device='cuda:0', dtype=torch.float64)
diff is  tensor(177.5571, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0670, device='cuda:0', dtype=torch.float64)
diff is  tensor(455.9301, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2542, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.5272, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.7423, device='cuda:0')
clipping
cal diff is tensor(0.0477, device='cuda:0')
clipping
cal diff is tensor(177.5571, device='cuda:0')
clipping
cal diff is tensor(0.0670, device='cuda:0')
clipping
cal diff is tensor(455.9301, device='cuda:0')
clipping
cal diff is tensor(0.2542, device='cuda:0')
clipping
cal diff is tensor(2.5272, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
________________________________
test distance is  tensor(545.1193, device='cuda:0')
test acc is  0.8733500001563224
test entropy is  0.163687722729658
________________________________
diff is  tensor(2.3388, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0407, device='cuda:0', dtype=torch.float64)
diff is  tensor(151.4299, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0571, device='cuda:0', dtype=torch.float64)
diff is  tensor(388.8409, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2168, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.1553, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.3388, device='cuda:0')
clipping
cal diff is tensor(0.0407, device='cuda:0')
clipping
cal diff is tensor(151.4299, device='cuda:0')
clipping
cal diff is tensor(0.0571, device='cuda:0')
clipping
cal diff is tensor(388.8409, device='cuda:0')
clipping
cal diff is tensor(0.2168, device='cuda:0')
clipping
cal diff is tensor(2.1553, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
________________________________
test distance is  tensor(451.0742, device='cuda:0')
test acc is  0.8763000001563223
test entropy is  0.1600073738607453
________________________________
diff is  tensor(1.9353, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0337, device='cuda:0', dtype=torch.float64)
diff is  tensor(125.3030, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0473, device='cuda:0', dtype=torch.float64)
diff is  tensor(321.7525, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1794, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.7835, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0394, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.9353, device='cuda:0')
clipping
cal diff is tensor(0.0337, device='cuda:0')
cal diff is tensor(125.3030, device='cuda:0')
clipping
cal diff is tensor(0.0473, device='cuda:0')
clipping
cal diff is tensor(321.7524, device='cuda:0')
clipping
cal diff is tensor(0.1794, device='cuda:0')
clipping
cal diff is tensor(1.7835, device='cuda:0')
clipping
cal diff is tensor(0.0394, device='cuda:0')
clipping
________________________________
test distance is  tensor(357.0294, device='cuda:0')
test acc is  0.8788000001563221
test entropy is  0.1568218237126687
________________________________
diff is  tensor(1.5317, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0337, device='cuda:0', dtype=torch.float64)
diff is  tensor(99.1765, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0374, device='cuda:0', dtype=torch.float64)
diff is  tensor(254.6650, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1420, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.4116, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0312, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.5317, device='cuda:0')
clipping
cal diff is tensor(0.0337, device='cuda:0')
clipping
cal diff is tensor(99.1765, device='cuda:0')
clipping
cal diff is tensor(0.0374, device='cuda:0')
clipping
cal diff is tensor(254.6650, device='cuda:0')
clipping
cal diff is tensor(0.1420, device='cuda:0')
clipping
cal diff is tensor(1.4116, device='cuda:0')
clipping
cal diff is tensor(0.0312, device='cuda:0')
clipping
________________________________
test distance is  tensor(262.9775, device='cuda:0')
test acc is  0.8809333334896554
test entropy is  0.15414085684777068
________________________________
diff is  tensor(1.1282, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0248, device='cuda:0', dtype=torch.float64)
diff is  tensor(73.0505, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0276, device='cuda:0', dtype=torch.float64)
diff is  tensor(187.5789, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1046, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.0397, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0230, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.1282, device='cuda:0')
clipping
cal diff is tensor(0.0248, device='cuda:0')
clipping
cal diff is tensor(73.0505, device='cuda:0')
clipping
cal diff is tensor(0.0276, device='cuda:0')
clipping
cal diff is tensor(187.5789, device='cuda:0')
clipping
cal diff is tensor(0.1046, device='cuda:0')
clipping
cal diff is tensor(1.0397, device='cuda:0')
clipping
cal diff is tensor(0.0230, device='cuda:0')
________________________________
test distance is  tensor(168.9339, device='cuda:0')
test acc is  0.8828666668229886
test entropy is  0.15197906218993384
________________________________
diff is  tensor(0.7247, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0159, device='cuda:0', dtype=torch.float64)
diff is  tensor(46.9245, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0177, device='cuda:0', dtype=torch.float64)
diff is  tensor(120.4927, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0672, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.6679, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0230, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.7247, device='cuda:0')
clipping
cal diff is tensor(0.0159, device='cuda:0')
clipping
cal diff is tensor(46.9245, device='cuda:0')
clipping
cal diff is tensor(0.0177, device='cuda:0')
clipping
cal diff is tensor(120.4927, device='cuda:0')
clipping
cal diff is tensor(0.0672, device='cuda:0')
clipping
cal diff is tensor(0.6679, device='cuda:0')
clipping
cal diff is tensor(0.0230, device='cuda:0')
clipping
________________________________
test distance is  tensor(74.8821, device='cuda:0')
test acc is  0.8842666668229887
test entropy is  0.1503173883901095
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1503173883901095
avg test loss is  0.35138559372408557
avg accuracy is  0.8842666668229887
compute_distance is  tensor(74.8821, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19633771469598132
avg test loss is  0.49401140527557463
avg accuracy is  0.8420000001563236
compute_distance is  tensor(118.7212, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(118.7212, device='cuda:0')
test acc is  0.8420000001563236
test entropy is  0.19633771469598132
________________________________
diff is  tensor(0.3661, device='cuda:0')
diff is  tensor(0.0075, device='cuda:0')
diff is  tensor(27.4526, device='cuda:0')
diff is  tensor(0.0106, device='cuda:0')
diff is  tensor(90.4811, device='cuda:0')
diff is  tensor(0.0317, device='cuda:0')
diff is  tensor(0.3584, device='cuda:0')
diff is  tensor(0.0104, device='cuda:0')
cal diff is tensor(0.3661, device='cuda:0')
clipping
cal diff is tensor(0.0075, device='cuda:0')
clipping
cal diff is tensor(27.4526, device='cuda:0')
clipping
cal diff is tensor(0.0106, device='cuda:0')
clipping
cal diff is tensor(90.4811, device='cuda:0')
clipping
cal diff is tensor(0.0317, device='cuda:0')
clipping
cal diff is tensor(0.3584, device='cuda:0')
clipping
cal diff is tensor(0.0104, device='cuda:0')
clipping
________________________________
test distance is  tensor(24.6708, device='cuda:0')
test acc is  0.8777000001563222
test entropy is  0.15685527613247507
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15685527613247507
avg test loss is  0.3717070553086396
avg accuracy is  0.8777000001563222
compute_distance is  tensor(24.6708, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1965165702360017
avg test loss is  0.4941283259818803
avg accuracy is  0.8418333334896569
compute_distance is  tensor(105.1793, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(105.1793, device='cuda:0')
test acc is  0.8418333334896569
test entropy is  0.1965165702360017
________________________________
diff is  tensor(0.1813, device='cuda:0')
diff is  tensor(0.0031, device='cuda:0')
diff is  tensor(17.9691, device='cuda:0')
diff is  tensor(0.0089, device='cuda:0')
diff is  tensor(86.7938, device='cuda:0')
diff is  tensor(0.0131, device='cuda:0')
diff is  tensor(0.2030, device='cuda:0')
diff is  tensor(0.0024, device='cuda:0')
cal diff is tensor(0.1813, device='cuda:0')
clipping
cal diff is tensor(0.0031, device='cuda:0')
clipping
cal diff is tensor(17.9691, device='cuda:0')
clipping
cal diff is tensor(0.0089, device='cuda:0')
clipping
cal diff is tensor(86.7938, device='cuda:0')
clipping
cal diff is tensor(0.0131, device='cuda:0')
clipping
cal diff is tensor(0.2030, device='cuda:0')
clipping
cal diff is tensor(0.0024, device='cuda:0')
clipping
________________________________
test distance is  tensor(11.1301, device='cuda:0')
test acc is  0.8814333334896555
test entropy is  0.15303147703345651
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15303147703345651
avg test loss is  0.35996806718853874
avg accuracy is  0.8814333334896555
compute_distance is  tensor(11.1301, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19643645882129923
avg test loss is  0.49422116568093616
avg accuracy is  0.8418833334896569
compute_distance is  tensor(97.3620, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(97.3620, device='cuda:0')
test acc is  0.8418833334896569
test entropy is  0.19643645882129923
________________________________
diff is  tensor(0.1520, device='cuda:0')
diff is  tensor(0.0026, device='cuda:0')
diff is  tensor(16.0276, device='cuda:0')
diff is  tensor(0.0083, device='cuda:0')
diff is  tensor(80.9729, device='cuda:0')
diff is  tensor(0.0113, device='cuda:0')
diff is  tensor(0.1835, device='cuda:0')
diff is  tensor(0.0009, device='cuda:0')
cal diff is tensor(0.1520, device='cuda:0')
clipping
cal diff is tensor(0.0026, device='cuda:0')
clipping
cal diff is tensor(16.0276, device='cuda:0')
clipping
cal diff is tensor(0.0083, device='cuda:0')
clipping
cal diff is tensor(80.9729, device='cuda:0')
clipping
cal diff is tensor(0.0113, device='cuda:0')
clipping
cal diff is tensor(0.1835, device='cuda:0')
clipping
cal diff is tensor(0.0009, device='cuda:0')
clipping
________________________________
test distance is  tensor(3.3126, device='cuda:0')
test acc is  0.883950000156322
test entropy is  0.1505172029693625
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1505172029693625
avg test loss is  0.35240935681582386
avg accuracy is  0.883950000156322
compute_distance is  tensor(3.3126, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.196392067817292
avg test loss is  0.49411366559040826
avg accuracy is  0.8420166668229903
compute_distance is  tensor(91.4945, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(91.4945, device='cuda:0')
test acc is  0.8420166668229903
test entropy is  0.196392067817292
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 90.23% 

Test Accuracy: 87.50% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00038533128099516034
len of model dicts is  10
compute distance is  tensor(60.7439, device='cuda:0')
compute distance is  tensor(73.7607, device='cuda:0')
compute distance is  tensor(95.6326, device='cuda:0')
compute distance is  tensor(105.4885, device='cuda:0')
compute distance is  tensor(128.2543, device='cuda:0')
compute distance is  tensor(48.8947, device='cuda:0')
compute distance is  tensor(125.6693, device='cuda:0')
compute distance is  tensor(56.4987, device='cuda:0')
compute distance is  tensor(91.1712, device='cuda:0')
compute distance is  tensor(7.6160, device='cuda:0')
calculated distance threshold is  tensor(104.1266, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8674166668229892
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8719833334896558
====================
====================
iteration is  0
round is  2
accuracy is  0.868833333489656
====================
====================
iteration is  1
round is  0
accuracy is  0.8647833334896561
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8697500001563226
====================
________________________________
test distance is  tensor(510.4440, device='cuda:0')
test acc is  0.8647833334896561
test entropy is  0.1620175567771326
________________________________
diff is  tensor(2.2458, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0358, device='cuda:0', dtype=torch.float64)
diff is  tensor(141.7926, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0502, device='cuda:0', dtype=torch.float64)
diff is  tensor(364.0702, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1961, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.0317, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0219, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.2458, device='cuda:0')
clipping
cal diff is tensor(0.0358, device='cuda:0')
clipping
cal diff is tensor(141.7926, device='cuda:0')
clipping
cal diff is tensor(0.0502, device='cuda:0')
clipping
cal diff is tensor(364.0702, device='cuda:0')
clipping
cal diff is tensor(0.1961, device='cuda:0')
clipping
cal diff is tensor(2.0317, device='cuda:0')
clipping
cal diff is tensor(0.0219, device='cuda:0')
________________________________
test distance is  tensor(406.3217, device='cuda:0')
test acc is  0.8683500001563226
test entropy is  0.1583121269147025
________________________________
diff is  tensor(1.7877, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0285, device='cuda:0', dtype=torch.float64)
diff is  tensor(112.8680, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0399, device='cuda:0', dtype=torch.float64)
diff is  tensor(289.8026, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1561, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.6172, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0219, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.7877, device='cuda:0')
clipping
cal diff is tensor(0.0285, device='cuda:0')
clipping
cal diff is tensor(112.8680, device='cuda:0')
clipping
cal diff is tensor(0.0399, device='cuda:0')
clipping
cal diff is tensor(289.8026, device='cuda:0')
clipping
cal diff is tensor(0.1561, device='cuda:0')
clipping
cal diff is tensor(1.6172, device='cuda:0')
clipping
cal diff is tensor(0.0219, device='cuda:0')
________________________________
test distance is  tensor(302.2006, device='cuda:0')
test acc is  0.8703833334896558
test entropy is  0.15520104714262206
________________________________
diff is  tensor(1.3295, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0212, device='cuda:0', dtype=torch.float64)
diff is  tensor(83.9437, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0297, device='cuda:0', dtype=torch.float64)
diff is  tensor(215.5359, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1161, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.2028, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0219, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.3295, device='cuda:0')
clipping
cal diff is tensor(0.0212, device='cuda:0')
clipping
cal diff is tensor(83.9437, device='cuda:0')
clipping
cal diff is tensor(0.0297, device='cuda:0')
clipping
cal diff is tensor(215.5359, device='cuda:0')
clipping
cal diff is tensor(0.1161, device='cuda:0')
clipping
cal diff is tensor(1.2028, device='cuda:0')
clipping
cal diff is tensor(0.0219, device='cuda:0')
clipping
________________________________
test distance is  tensor(198.0739, device='cuda:0')
test acc is  0.8724833334896558
test entropy is  0.1527286468824344
________________________________
diff is  tensor(0.8714, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0139, device='cuda:0', dtype=torch.float64)
diff is  tensor(55.0199, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0195, device='cuda:0', dtype=torch.float64)
diff is  tensor(141.2705, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0761, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7884, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0143, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.8714, device='cuda:0')
clipping
cal diff is tensor(0.0139, device='cuda:0')
clipping
cal diff is tensor(55.0199, device='cuda:0')
clipping
cal diff is tensor(0.0195, device='cuda:0')
clipping
cal diff is tensor(141.2705, device='cuda:0')
clipping
cal diff is tensor(0.0761, device='cuda:0')
clipping
cal diff is tensor(0.7884, device='cuda:0')
clipping
cal diff is tensor(0.0143, device='cuda:0')
clipping
________________________________
test distance is  tensor(93.9471, device='cuda:0')
test acc is  0.8739000001563224
test entropy is  0.1509017041806918
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1509017041806918
avg test loss is  0.39717162939022854
avg accuracy is  0.8739000001563224
compute_distance is  tensor(93.9471, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1586243433039834
avg test loss is  0.4280922275020687
avg accuracy is  0.8654333334896561
compute_distance is  tensor(133.6503, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(133.6503, device='cuda:0')
test acc is  0.8654333334896561
test entropy is  0.1586243433039834
________________________________
diff is  tensor(0.4469, device='cuda:0')
diff is  tensor(0.0068, device='cuda:0')
diff is  tensor(31.9052, device='cuda:0')
diff is  tensor(0.0118, device='cuda:0')
diff is  tensor(100.8418, device='cuda:0')
diff is  tensor(0.0365, device='cuda:0')
diff is  tensor(0.3931, device='cuda:0')
diff is  tensor(0.0067, device='cuda:0')
cal diff is tensor(0.4469, device='cuda:0')
clipping
cal diff is tensor(0.0068, device='cuda:0')
clipping
cal diff is tensor(31.9052, device='cuda:0')
clipping
cal diff is tensor(0.0118, device='cuda:0')
clipping
cal diff is tensor(100.8418, device='cuda:0')
clipping
cal diff is tensor(0.0365, device='cuda:0')
clipping
cal diff is tensor(0.3931, device='cuda:0')
clipping
cal diff is tensor(0.0067, device='cuda:0')
clipping
________________________________
test distance is  tensor(29.5247, device='cuda:0')
test acc is  0.8730000001563224
test entropy is  0.1514608959740858
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1514608959740858
avg test loss is  0.4009577917463299
avg accuracy is  0.8730000001563224
compute_distance is  tensor(29.5247, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1584886408079344
avg test loss is  0.42840034350641626
avg accuracy is  0.865333333489656
compute_distance is  tensor(110.2542, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(110.2542, device='cuda:0')
test acc is  0.865333333489656
test entropy is  0.1584886408079344
________________________________
diff is  tensor(0.1669, device='cuda:0')
diff is  tensor(0.0020, device='cuda:0')
diff is  tensor(16.7404, device='cuda:0')
diff is  tensor(0.0085, device='cuda:0')
diff is  tensor(93.1870, device='cuda:0')
diff is  tensor(0.0095, device='cuda:0')
diff is  tensor(0.1361, device='cuda:0')
diff is  tensor(0.0015, device='cuda:0')
cal diff is tensor(0.1669, device='cuda:0')
clipping
cal diff is tensor(0.0020, device='cuda:0')
clipping
cal diff is tensor(16.7404, device='cuda:0')
clipping
cal diff is tensor(0.0085, device='cuda:0')
clipping
cal diff is tensor(93.1870, device='cuda:0')
clipping
cal diff is tensor(0.0095, device='cuda:0')
clipping
cal diff is tensor(0.1361, device='cuda:0')
clipping
cal diff is tensor(0.0015, device='cuda:0')
clipping
________________________________
test distance is  tensor(6.1295, device='cuda:0')
test acc is  0.8743333334896557
test entropy is  0.15021289205516197
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15021289205516197
avg test loss is  0.3961969796838219
avg accuracy is  0.8743333334896557
compute_distance is  tensor(6.1295, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15858653874825568
avg test loss is  0.4282219917463786
avg accuracy is  0.865383333489656
compute_distance is  tensor(94.4230, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(94.4230, device='cuda:0')
test acc is  0.865383333489656
test entropy is  0.15858653874825568
________________________________
new distance ratio is 0.8
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 90.66% 

Test Accuracy: 87.95% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0004022610664833337
len of model dicts is  10
compute distance is  tensor(57.7925, device='cuda:0')
compute distance is  tensor(71.6330, device='cuda:0')
compute distance is  tensor(106.6452, device='cuda:0')
compute distance is  tensor(116.0325, device='cuda:0')
compute distance is  tensor(118.0902, device='cuda:0')
compute distance is  tensor(54.1158, device='cuda:0')
compute distance is  tensor(104.3917, device='cuda:0')
compute distance is  tensor(74.5717, device='cuda:0')
compute distance is  tensor(79.9967, device='cuda:0')
compute distance is  tensor(8.0426, device='cuda:0')
calculated distance threshold is  tensor(96.0807, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8800500001563222
====================
====================
iteration is  0
round is  1
accuracy is  0.8808166668229888
====================
====================
iteration is  0
round is  2
accuracy is  0.8789500001563221
====================
====================
iteration is  1
round is  0
accuracy is  0.8759500001563224
====================
====================
iteration is  1
round is  1
accuracy is  0.8805166668229888
====================
====================
iteration is  1
round is  2
accuracy is  0.8707333334896559
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.8682333334896559
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.8776666668229889
====================
====================
iteration is  2
round is  2
accuracy is  0.8778500001563222
====================
====================
iteration is  3
round is  0
accuracy is  0.8672166668229893
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.8757333334896557
====================
====================
iteration is  3
round is  2
accuracy is  0.8717666668229892
====================
====================
iteration is  4
round is  0
accuracy is  0.8721833334896558
====================
________________________________
test distance is  tensor(680.3082, device='cuda:0')
test acc is  0.8672166668229893
test entropy is  0.15909405209537128
________________________________
diff is  tensor(2.9158, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0435, device='cuda:0', dtype=torch.float64)
diff is  tensor(189.3864, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0636, device='cuda:0', dtype=torch.float64)
diff is  tensor(484.8917, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2741, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.7046, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0287, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.9158, device='cuda:0')
clipping
cal diff is tensor(0.0435, device='cuda:0')
clipping
cal diff is tensor(189.3864, device='cuda:0')
clipping
cal diff is tensor(0.0636, device='cuda:0')
clipping
cal diff is tensor(484.8917, device='cuda:0')
clipping
cal diff is tensor(0.2741, device='cuda:0')
clipping
cal diff is tensor(2.7046, device='cuda:0')
clipping
cal diff is tensor(0.0287, device='cuda:0')
clipping
________________________________
test distance is  tensor(584.2272, device='cuda:0')
test acc is  0.8698500001563226
test entropy is  0.1561741842977655
________________________________
diff is  tensor(2.5040, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0374, device='cuda:0', dtype=torch.float64)
diff is  tensor(162.6391, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0546, device='cuda:0', dtype=torch.float64)
diff is  tensor(416.4098, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2354, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.3226, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0246, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.5040, device='cuda:0')
clipping
cal diff is tensor(0.0374, device='cuda:0')
clipping
cal diff is tensor(162.6391, device='cuda:0')
clipping
cal diff is tensor(0.0546, device='cuda:0')
clipping
cal diff is tensor(416.4099, device='cuda:0')
clipping
cal diff is tensor(0.2354, device='cuda:0')
clipping
cal diff is tensor(2.3226, device='cuda:0')
clipping
cal diff is tensor(0.0246, device='cuda:0')
________________________________
test distance is  tensor(488.1504, device='cuda:0')
test acc is  0.8723500001563225
test entropy is  0.15358854780620984
________________________________
diff is  tensor(2.0922, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0312, device='cuda:0', dtype=torch.float64)
diff is  tensor(135.8918, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0457, device='cuda:0', dtype=torch.float64)
diff is  tensor(347.9278, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1967, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.9406, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0246, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.0922, device='cuda:0')
clipping
cal diff is tensor(0.0312, device='cuda:0')
clipping
cal diff is tensor(135.8918, device='cuda:0')
clipping
cal diff is tensor(0.0457, device='cuda:0')
clipping
cal diff is tensor(347.9278, device='cuda:0')
clipping
cal diff is tensor(0.1967, device='cuda:0')
clipping
cal diff is tensor(1.9406, device='cuda:0')
clipping
cal diff is tensor(0.0246, device='cuda:0')
________________________________
test distance is  tensor(392.0743, device='cuda:0')
test acc is  0.874416666822989
test entropy is  0.15137492540850442
________________________________
diff is  tensor(1.6804, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0251, device='cuda:0', dtype=torch.float64)
diff is  tensor(109.1447, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0367, device='cuda:0', dtype=torch.float64)
diff is  tensor(279.4464, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1580, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.5587, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0246, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.6804, device='cuda:0')
clipping
cal diff is tensor(0.0251, device='cuda:0')
clipping
cal diff is tensor(109.1447, device='cuda:0')
clipping
cal diff is tensor(0.0367, device='cuda:0')
clipping
cal diff is tensor(279.4464, device='cuda:0')
clipping
cal diff is tensor(0.1580, device='cuda:0')
clipping
cal diff is tensor(1.5587, device='cuda:0')
clipping
cal diff is tensor(0.0246, device='cuda:0')
________________________________
test distance is  tensor(295.9994, device='cuda:0')
test acc is  0.8763333334896556
test entropy is  0.14955971330833207
________________________________
diff is  tensor(1.2686, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0189, device='cuda:0', dtype=torch.float64)
diff is  tensor(82.3979, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0277, device='cuda:0', dtype=torch.float64)
diff is  tensor(210.9659, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1192, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.1767, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0246, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.2686, device='cuda:0')
clipping
cal diff is tensor(0.0189, device='cuda:0')
clipping
cal diff is tensor(82.3979, device='cuda:0')
clipping
cal diff is tensor(0.0277, device='cuda:0')
clipping
cal diff is tensor(210.9659, device='cuda:0')
clipping
cal diff is tensor(0.1192, device='cuda:0')
clipping
cal diff is tensor(1.1767, device='cuda:0')
clipping
cal diff is tensor(0.0246, device='cuda:0')
clipping
________________________________
test distance is  tensor(199.9185, device='cuda:0')
test acc is  0.8780000001563223
test entropy is  0.1481335105529345
________________________________
diff is  tensor(0.8568, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0128, device='cuda:0', dtype=torch.float64)
diff is  tensor(55.6517, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0187, device='cuda:0', dtype=torch.float64)
diff is  tensor(142.4868, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0805, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7948, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0166, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.8568, device='cuda:0')
clipping
cal diff is tensor(0.0128, device='cuda:0')
cal diff is tensor(55.6518, device='cuda:0')
clipping
cal diff is tensor(0.0187, device='cuda:0')
clipping
cal diff is tensor(142.4868, device='cuda:0')
clipping
cal diff is tensor(0.0805, device='cuda:0')
clipping
cal diff is tensor(0.7948, device='cuda:0')
clipping
cal diff is tensor(0.0166, device='cuda:0')
clipping
________________________________
test distance is  tensor(103.8438, device='cuda:0')
test acc is  0.8794166668229888
test entropy is  0.1471294372844925
________________________________
diff is  tensor(0.4450, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0128, device='cuda:0', dtype=torch.float64)
diff is  tensor(28.9056, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0097, device='cuda:0', dtype=torch.float64)
diff is  tensor(74.0077, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0418, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4128, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0086, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.4450, device='cuda:0')
clipping
cal diff is tensor(0.0128, device='cuda:0')
clipping
cal diff is tensor(28.9056, device='cuda:0')
clipping
cal diff is tensor(0.0097, device='cuda:0')
clipping
cal diff is tensor(74.0077, device='cuda:0')
clipping
cal diff is tensor(0.0418, device='cuda:0')
clipping
cal diff is tensor(0.4128, device='cuda:0')
clipping
cal diff is tensor(0.0086, device='cuda:0')
clipping
________________________________
test distance is  tensor(7.7634, device='cuda:0')
test acc is  0.8802833334896555
test entropy is  0.14664002433260367
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14664002433260367
avg test loss is  0.37648707216005844
avg accuracy is  0.8802833334896555
compute_distance is  tensor(7.7634, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15514680417949583
avg test loss is  0.4335916001262314
avg accuracy is  0.8679666668229893
compute_distance is  tensor(89.7887, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(89.7887, device='cuda:0')
test acc is  0.8679666668229893
test entropy is  0.15514680417949583
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 90.03% 

Test Accuracy: 87.21% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0003635734610725194
len of model dicts is  10
compute distance is  tensor(37.6707, device='cuda:0')
compute distance is  tensor(62.7841, device='cuda:0')
compute distance is  tensor(68.9488, device='cuda:0')
compute distance is  tensor(112.8738, device='cuda:0')
compute distance is  tensor(102.5626, device='cuda:0')
compute distance is  tensor(48.1323, device='cuda:0')
compute distance is  tensor(131.9842, device='cuda:0')
compute distance is  tensor(57.5345, device='cuda:0')
compute distance is  tensor(89.9185, device='cuda:0')
compute distance is  tensor(6.8858, device='cuda:0')
calculated distance threshold is  tensor(106.9645, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8695666668229893
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.874716666822989
====================
====================
iteration is  0
round is  2
accuracy is  0.8727666668229892
====================
====================
iteration is  1
round is  0
accuracy is  0.8654666668229894
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8704833334896558
====================
====================
iteration is  1
round is  2
accuracy is  0.8699166668229893
====================
====================
iteration is  2
round is  0
accuracy is  0.8648666668229894
====================
succ_min + 1
________________________________
test distance is  tensor(561.4382, device='cuda:0')
test acc is  0.8648666668229894
test entropy is  0.16245070559733205
________________________________
diff is  tensor(2.5064, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0375, device='cuda:0', dtype=torch.float64)
diff is  tensor(155.7726, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0536, device='cuda:0', dtype=torch.float64)
diff is  tensor(400.5817, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2256, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.2401, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0211, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.5064, device='cuda:0')
clipping
cal diff is tensor(0.0375, device='cuda:0')
clipping
cal diff is tensor(155.7726, device='cuda:0')
clipping
cal diff is tensor(0.0536, device='cuda:0')
clipping
cal diff is tensor(400.5817, device='cuda:0')
clipping
cal diff is tensor(0.2256, device='cuda:0')
clipping
cal diff is tensor(2.2401, device='cuda:0')
clipping
cal diff is tensor(0.0211, device='cuda:0')
clipping
________________________________
test distance is  tensor(454.4732, device='cuda:0')
test acc is  0.8672000001563227
test entropy is  0.1580230603371856
________________________________
diff is  tensor(2.0289, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0304, device='cuda:0', dtype=torch.float64)
diff is  tensor(126.0950, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0434, device='cuda:0', dtype=torch.float64)
diff is  tensor(324.2631, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1826, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.8133, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0171, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.0289, device='cuda:0')
clipping
cal diff is tensor(0.0304, device='cuda:0')
clipping
cal diff is tensor(126.0950, device='cuda:0')
clipping
cal diff is tensor(0.0434, device='cuda:0')
clipping
cal diff is tensor(324.2631, device='cuda:0')
clipping
cal diff is tensor(0.1826, device='cuda:0')
clipping
cal diff is tensor(1.8133, device='cuda:0')
clipping
cal diff is tensor(0.0171, device='cuda:0')
________________________________
test distance is  tensor(347.5123, device='cuda:0')
test acc is  0.8688166668229893
test entropy is  0.15419646439108767
________________________________
diff is  tensor(1.5514, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0232, device='cuda:0', dtype=torch.float64)
diff is  tensor(96.4173, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0332, device='cuda:0', dtype=torch.float64)
diff is  tensor(247.9445, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1396, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3865, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0171, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.5514, device='cuda:0')
clipping
cal diff is tensor(0.0232, device='cuda:0')
clipping
cal diff is tensor(96.4173, device='cuda:0')
clipping
cal diff is tensor(0.0332, device='cuda:0')
clipping
cal diff is tensor(247.9445, device='cuda:0')
clipping
cal diff is tensor(0.1396, device='cuda:0')
clipping
cal diff is tensor(1.3865, device='cuda:0')
clipping
cal diff is tensor(0.0171, device='cuda:0')
________________________________
test distance is  tensor(240.5527, device='cuda:0')
test acc is  0.8705000001563225
test entropy is  0.1509795744758425
________________________________
diff is  tensor(1.0739, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0161, device='cuda:0', dtype=torch.float64)
diff is  tensor(66.7399, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0230, device='cuda:0', dtype=torch.float64)
diff is  tensor(171.6268, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0966, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9597, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0171, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0739, device='cuda:0')
clipping
cal diff is tensor(0.0161, device='cuda:0')
cal diff is tensor(66.7399, device='cuda:0')
clipping
cal diff is tensor(0.0230, device='cuda:0')
clipping
cal diff is tensor(171.6268, device='cuda:0')
clipping
cal diff is tensor(0.0966, device='cuda:0')
clipping
cal diff is tensor(0.9597, device='cuda:0')
clipping
cal diff is tensor(0.0171, device='cuda:0')
clipping
________________________________
test distance is  tensor(133.5950, device='cuda:0')
test acc is  0.8717333334896559
test entropy is  0.14842023673072172
________________________________
diff is  tensor(0.5964, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0161, device='cuda:0', dtype=torch.float64)
diff is  tensor(37.0633, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0127, device='cuda:0', dtype=torch.float64)
diff is  tensor(95.3108, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0537, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5330, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0095, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.5964, device='cuda:0')
clipping
cal diff is tensor(0.0161, device='cuda:0')
clipping
cal diff is tensor(37.0633, device='cuda:0')
clipping
cal diff is tensor(0.0127, device='cuda:0')
clipping
cal diff is tensor(95.3108, device='cuda:0')
clipping
cal diff is tensor(0.0537, device='cuda:0')
clipping
cal diff is tensor(0.5330, device='cuda:0')
clipping
cal diff is tensor(0.0095, device='cuda:0')
clipping
________________________________
test distance is  tensor(26.6303, device='cuda:0')
test acc is  0.8722500001563225
test entropy is  0.14647808683706498
________________________________
new distance ratio is 0.8
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 90.92% 

Test Accuracy: 88.34% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00028468799428083
len of model dicts is  10
compute distance is  tensor(60.7886, device='cuda:0')
compute distance is  tensor(71.7629, device='cuda:0')
compute distance is  tensor(102.9497, device='cuda:0')
compute distance is  tensor(127.5877, device='cuda:0')
compute distance is  tensor(104.0024, device='cuda:0')
compute distance is  tensor(43.6486, device='cuda:0')
compute distance is  tensor(177.3339, device='cuda:0')
compute distance is  tensor(65.0862, device='cuda:0')
compute distance is  tensor(100.7114, device='cuda:0')
compute distance is  tensor(7.4463, device='cuda:0')
calculated distance threshold is  tensor(143.3564, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8814500001563221
====================
====================
iteration is  0
round is  1
accuracy is  0.8859333334896552
====================
====================
iteration is  0
round is  2
accuracy is  0.8769833334896556
====================
====================
iteration is  1
round is  0
accuracy is  0.8714000001563225
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8703333334896558
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.8777833334896555
====================
====================
iteration is  2
round is  0
accuracy is  0.8792666668229888
====================
====================
iteration is  2
round is  1
accuracy is  0.882550000156322
====================
====================
iteration is  2
round is  2
accuracy is  0.8737666668229891
====================
====================
iteration is  3
round is  0
accuracy is  0.8833333334896554
====================
====================
iteration is  3
round is  1
accuracy is  0.8782000001563223
====================
====================
iteration is  3
round is  2
accuracy is  0.8811666668229888
====================
====================
iteration is  4
round is  0
accuracy is  0.8723166668229891
====================
====================
iteration is  4
round is  1
accuracy is  0.8780000001563223
====================
====================
iteration is  4
round is  2
accuracy is  0.8761500001563223
====================
====================
iteration is  5
round is  0
accuracy is  0.8689166668229893
====================
succ_min + 1
====================
iteration is  5
round is  1
accuracy is  0.8691166668229893
====================
====================
iteration is  5
round is  2
accuracy is  0.8774666668229889
====================
====================
iteration is  6
round is  0
accuracy is  0.8681333334896559
====================
succ_min + 1
________________________________
test distance is  tensor(905.9883, device='cuda:0')
test acc is  0.8681333334896559
test entropy is  0.16885291130494462
________________________________
diff is  tensor(3.9776, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0672, device='cuda:0', dtype=torch.float64)
diff is  tensor(252.7826, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0880, device='cuda:0', dtype=torch.float64)
diff is  tensor(645.0926, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3644, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.5880, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0278, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.9776, device='cuda:0')
clipping
cal diff is tensor(0.0672, device='cuda:0')
clipping
cal diff is tensor(252.7826, device='cuda:0')
clipping
cal diff is tensor(0.0880, device='cuda:0')
clipping
cal diff is tensor(645.0926, device='cuda:0')
clipping
cal diff is tensor(0.3644, device='cuda:0')
clipping
cal diff is tensor(3.5880, device='cuda:0')
clipping
cal diff is tensor(0.0278, device='cuda:0')
________________________________
test distance is  tensor(762.6363, device='cuda:0')
test acc is  0.8715166668229891
test entropy is  0.16220430345105719
________________________________
diff is  tensor(3.3482, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0566, device='cuda:0', dtype=torch.float64)
diff is  tensor(212.7843, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0741, device='cuda:0', dtype=torch.float64)
diff is  tensor(543.0182, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3068, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.0202, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0278, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.3482, device='cuda:0')
clipping
cal diff is tensor(0.0566, device='cuda:0')
clipping
cal diff is tensor(212.7843, device='cuda:0')
clipping
cal diff is tensor(0.0741, device='cuda:0')
clipping
cal diff is tensor(543.0183, device='cuda:0')
clipping
cal diff is tensor(0.3068, device='cuda:0')
clipping
cal diff is tensor(3.0202, device='cuda:0')
clipping
cal diff is tensor(0.0278, device='cuda:0')
________________________________
test distance is  tensor(619.2852, device='cuda:0')
test acc is  0.874516666822989
test entropy is  0.1564649235623986
________________________________
diff is  tensor(2.7188, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0460, device='cuda:0', dtype=torch.float64)
diff is  tensor(172.7862, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0602, device='cuda:0', dtype=torch.float64)
diff is  tensor(440.9446, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2491, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.4525, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0278, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.7188, device='cuda:0')
clipping
cal diff is tensor(0.0460, device='cuda:0')
clipping
cal diff is tensor(172.7862, device='cuda:0')
clipping
cal diff is tensor(0.0602, device='cuda:0')
clipping
cal diff is tensor(440.9446, device='cuda:0')
clipping
cal diff is tensor(0.2491, device='cuda:0')
clipping
cal diff is tensor(2.4525, device='cuda:0')
clipping
cal diff is tensor(0.0278, device='cuda:0')
________________________________
test distance is  tensor(475.9352, device='cuda:0')
test acc is  0.8776666668229889
test entropy is  0.15167290247134815
________________________________
diff is  tensor(2.0895, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0353, device='cuda:0', dtype=torch.float64)
diff is  tensor(132.7884, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0462, device='cuda:0', dtype=torch.float64)
diff is  tensor(338.8717, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1914, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.8848, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0278, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.0895, device='cuda:0')
clipping
cal diff is tensor(0.0353, device='cuda:0')
clipping
cal diff is tensor(132.7884, device='cuda:0')
clipping
cal diff is tensor(0.0462, device='cuda:0')
clipping
cal diff is tensor(338.8717, device='cuda:0')
clipping
cal diff is tensor(0.1914, device='cuda:0')
clipping
cal diff is tensor(1.8848, device='cuda:0')
clipping
cal diff is tensor(0.0278, device='cuda:0')
________________________________
test distance is  tensor(332.5873, device='cuda:0')
test acc is  0.8801166668229888
test entropy is  0.14784206525047325
________________________________
diff is  tensor(1.4601, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0247, device='cuda:0', dtype=torch.float64)
diff is  tensor(92.7913, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0323, device='cuda:0', dtype=torch.float64)
diff is  tensor(236.8002, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1338, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3171, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0278, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.4601, device='cuda:0')
clipping
cal diff is tensor(0.0247, device='cuda:0')
cal diff is tensor(92.7913, device='cuda:0')
clipping
cal diff is tensor(0.0323, device='cuda:0')
clipping
cal diff is tensor(236.8002, device='cuda:0')
clipping
cal diff is tensor(0.1338, device='cuda:0')
clipping
cal diff is tensor(1.3171, device='cuda:0')
clipping
cal diff is tensor(0.0278, device='cuda:0')
clipping
________________________________
test distance is  tensor(189.2416, device='cuda:0')
test acc is  0.8823333334896554
test entropy is  0.1450478082923874
________________________________
diff is  tensor(0.8307, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0247, device='cuda:0', dtype=torch.float64)
diff is  tensor(52.7951, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0184, device='cuda:0', dtype=torch.float64)
diff is  tensor(134.7313, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0761, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.7494, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0158, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.8307, device='cuda:0')
clipping
cal diff is tensor(0.0247, device='cuda:0')
clipping
cal diff is tensor(52.7951, device='cuda:0')
clipping
cal diff is tensor(0.0184, device='cuda:0')
clipping
cal diff is tensor(134.7313, device='cuda:0')
clipping
cal diff is tensor(0.0761, device='cuda:0')
clipping
cal diff is tensor(0.7494, device='cuda:0')
clipping
cal diff is tensor(0.0158, device='cuda:0')
________________________________
test distance is  tensor(45.8972, device='cuda:0')
test acc is  0.8841000001563221
test entropy is  0.1432569457301453
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1432569457301453
avg test loss is  0.3616509492050356
avg accuracy is  0.8841000001563221
compute_distance is  tensor(45.8972, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16484729336427728
avg test loss is  0.4109606260358334
avg accuracy is  0.868533333489656
compute_distance is  tensor(102.8401, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(102.8401, device='cuda:0')
test acc is  0.868533333489656
test entropy is  0.16484729336427728
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 91.19% 

Test Accuracy: 88.64% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0002217836445197463
len of model dicts is  10
compute distance is  tensor(37.6159, device='cuda:0')
compute distance is  tensor(65.1831, device='cuda:0')
compute distance is  tensor(101.1027, device='cuda:0')
compute distance is  tensor(145.2015, device='cuda:0')
compute distance is  tensor(108.4414, device='cuda:0')
compute distance is  tensor(70.2954, device='cuda:0')
compute distance is  tensor(97.5987, device='cuda:0')
compute distance is  tensor(56.6825, device='cuda:0')
compute distance is  tensor(91.5820, device='cuda:0')
compute distance is  tensor(7.6541, device='cuda:0')
calculated distance threshold is  tensor(117.6920, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8875166668229885
====================
====================
iteration is  0
round is  1
accuracy is  0.8826833334896553
====================
====================
iteration is  0
round is  2
accuracy is  0.8785166668229889
====================
====================
iteration is  1
round is  0
accuracy is  0.8726500001563225
====================
====================
iteration is  1
round is  1
accuracy is  0.8811166668229888
====================
====================
iteration is  1
round is  2
accuracy is  0.8798333334896554
====================
====================
iteration is  2
round is  0
accuracy is  0.8801666668229888
====================
====================
iteration is  2
round is  1
accuracy is  0.8844333334896554
====================
====================
iteration is  2
round is  2
accuracy is  0.8850833334896552
====================
====================
iteration is  3
round is  0
accuracy is  0.8869666668229885
====================
====================
iteration is  3
round is  1
accuracy is  0.8753833334896557
====================
====================
iteration is  3
round is  2
accuracy is  0.8814500001563221
====================
====================
iteration is  4
round is  0
accuracy is  0.8827333334896553
====================
====================
iteration is  4
round is  1
accuracy is  0.8804333334896555
====================
====================
iteration is  4
round is  2
accuracy is  0.8900500001563217
====================
====================
iteration is  5
round is  0
accuracy is  0.8950500001563216
====================
====================
iteration is  5
round is  1
accuracy is  0.8644333334896561
====================
succ_min + 1
====================
iteration is  5
round is  2
accuracy is  0.8775000001563222
====================
====================
iteration is  6
round is  0
accuracy is  0.8810666668229888
====================
====================
iteration is  6
round is  1
accuracy is  0.8725000001563225
====================
====================
iteration is  6
round is  2
accuracy is  0.8806166668229888
====================
====================
iteration is  7
round is  0
accuracy is  0.8613000001563229
====================
succ_min + 1
====================
iteration is  7
round is  1
accuracy is  0.8829166668229886
====================
====================
iteration is  7
round is  2
accuracy is  0.8794666668229888
====================
====================
iteration is  8
round is  0
accuracy is  0.8626666668229894
====================
====================
iteration is  8
round is  1
accuracy is  0.8755333334896557
====================
====================
iteration is  8
round is  2
accuracy is  0.875516666822989
====================
====================
iteration is  9
round is  0
accuracy is  0.8637333334896561
====================
====================
iteration is  9
round is  1
accuracy is  0.8568666668229897
====================
succ_min + 1
________________________________
test distance is  tensor(1204.6343, device='cuda:0')
test acc is  0.8568666668229897
test entropy is  0.16109044900708108
________________________________
diff is  tensor(5.1100, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0886, device='cuda:0', dtype=torch.float64)
diff is  tensor(335.6518, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1192, device='cuda:0', dtype=torch.float64)
diff is  tensor(858.3330, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4899, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.7892, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0523, device='cuda:0', dtype=torch.float64)
cal diff is tensor(5.1100, device='cuda:0')
clipping
cal diff is tensor(0.0886, device='cuda:0')
clipping
cal diff is tensor(335.6518, device='cuda:0')
clipping
cal diff is tensor(0.1192, device='cuda:0')
clipping
cal diff is tensor(858.3330, device='cuda:0')
clipping
cal diff is tensor(0.4899, device='cuda:0')
clipping
cal diff is tensor(4.7892, device='cuda:0')
clipping
cal diff is tensor(0.0523, device='cuda:0')
________________________________
test distance is  tensor(1086.9478, device='cuda:0')
test acc is  0.8615333334896562
test entropy is  0.15718867023314623
________________________________
diff is  tensor(4.6107, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0799, device='cuda:0', dtype=torch.float64)
diff is  tensor(302.8589, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1076, device='cuda:0', dtype=torch.float64)
diff is  tensor(774.4746, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4420, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.3213, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0523, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.6107, device='cuda:0')
clipping
cal diff is tensor(0.0799, device='cuda:0')
clipping
cal diff is tensor(302.8589, device='cuda:0')
clipping
cal diff is tensor(0.1076, device='cuda:0')
clipping
cal diff is tensor(774.4746, device='cuda:0')
clipping
cal diff is tensor(0.4420, device='cuda:0')
clipping
cal diff is tensor(4.3213, device='cuda:0')
clipping
cal diff is tensor(0.0523, device='cuda:0')
________________________________
test distance is  tensor(969.2617, device='cuda:0')
test acc is  0.8656500001563228
test entropy is  0.1536918934990666
________________________________
diff is  tensor(4.1115, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0712, device='cuda:0', dtype=torch.float64)
diff is  tensor(270.0662, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0959, device='cuda:0', dtype=torch.float64)
diff is  tensor(690.6167, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3941, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.8534, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0523, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.1115, device='cuda:0')
clipping
cal diff is tensor(0.0712, device='cuda:0')
clipping
cal diff is tensor(270.0662, device='cuda:0')
clipping
cal diff is tensor(0.0959, device='cuda:0')
clipping
cal diff is tensor(690.6167, device='cuda:0')
clipping
cal diff is tensor(0.3941, device='cuda:0')
clipping
cal diff is tensor(3.8534, device='cuda:0')
clipping
cal diff is tensor(0.0523, device='cuda:0')
________________________________
test distance is  tensor(851.5764, device='cuda:0')
test acc is  0.8694333334896559
test entropy is  0.15055011869715984
________________________________
diff is  tensor(3.6122, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0626, device='cuda:0', dtype=torch.float64)
diff is  tensor(237.2736, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0843, device='cuda:0', dtype=torch.float64)
diff is  tensor(606.7592, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3463, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.3855, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0523, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.6122, device='cuda:0')
clipping
cal diff is tensor(0.0626, device='cuda:0')
clipping
cal diff is tensor(237.2736, device='cuda:0')
clipping
cal diff is tensor(0.0843, device='cuda:0')
clipping
cal diff is tensor(606.7592, device='cuda:0')
clipping
cal diff is tensor(0.3463, device='cuda:0')
clipping
cal diff is tensor(3.3855, device='cuda:0')
clipping
cal diff is tensor(0.0523, device='cuda:0')
________________________________
test distance is  tensor(733.8918, device='cuda:0')
test acc is  0.8732833334896557
test entropy is  0.147763373651929
________________________________
diff is  tensor(3.1130, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0539, device='cuda:0', dtype=torch.float64)
diff is  tensor(204.4813, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0726, device='cuda:0', dtype=torch.float64)
diff is  tensor(522.9023, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2984, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.9176, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0523, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.1130, device='cuda:0')
clipping
cal diff is tensor(0.0539, device='cuda:0')
clipping
cal diff is tensor(204.4813, device='cuda:0')
clipping
cal diff is tensor(0.0726, device='cuda:0')
clipping
cal diff is tensor(522.9023, device='cuda:0')
clipping
cal diff is tensor(0.2984, device='cuda:0')
clipping
cal diff is tensor(2.9176, device='cuda:0')
clipping
cal diff is tensor(0.0523, device='cuda:0')
________________________________
test distance is  tensor(616.2085, device='cuda:0')
test acc is  0.8769833334896556
test entropy is  0.14532367982812275
________________________________
diff is  tensor(2.6138, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0453, device='cuda:0', dtype=torch.float64)
diff is  tensor(171.6893, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0610, device='cuda:0', dtype=torch.float64)
diff is  tensor(439.0462, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2506, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.4497, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0523, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.6138, device='cuda:0')
clipping
cal diff is tensor(0.0453, device='cuda:0')
clipping
cal diff is tensor(171.6893, device='cuda:0')
clipping
cal diff is tensor(0.0610, device='cuda:0')
clipping
cal diff is tensor(439.0462, device='cuda:0')
clipping
cal diff is tensor(0.2506, device='cuda:0')
clipping
cal diff is tensor(2.4497, device='cuda:0')
clipping
cal diff is tensor(0.0523, device='cuda:0')
clipping
________________________________
test distance is  tensor(498.5167, device='cuda:0')
test acc is  0.8798833334896554
test entropy is  0.1433365779962621
________________________________
diff is  tensor(2.1146, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0366, device='cuda:0', dtype=torch.float64)
diff is  tensor(138.8977, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0493, device='cuda:0', dtype=torch.float64)
diff is  tensor(355.1912, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2027, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.9819, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0423, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.1146, device='cuda:0')
clipping
cal diff is tensor(0.0366, device='cuda:0')
cal diff is tensor(138.8977, device='cuda:0')
clipping
cal diff is tensor(0.0493, device='cuda:0')
clipping
cal diff is tensor(355.1912, device='cuda:0')
clipping
cal diff is tensor(0.2027, device='cuda:0')
clipping
cal diff is tensor(1.9819, device='cuda:0')
clipping
cal diff is tensor(0.0423, device='cuda:0')
clipping
________________________________
test distance is  tensor(380.8337, device='cuda:0')
test acc is  0.8821166668229887
test entropy is  0.14181698292398504
________________________________
diff is  tensor(1.6154, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0366, device='cuda:0', dtype=torch.float64)
diff is  tensor(106.1062, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0377, device='cuda:0', dtype=torch.float64)
diff is  tensor(271.3363, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1549, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.5140, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0323, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.6154, device='cuda:0')
clipping
cal diff is tensor(0.0366, device='cuda:0')
clipping
cal diff is tensor(106.1062, device='cuda:0')
clipping
cal diff is tensor(0.0377, device='cuda:0')
clipping
cal diff is tensor(271.3363, device='cuda:0')
clipping
cal diff is tensor(0.1549, device='cuda:0')
clipping
cal diff is tensor(1.5140, device='cuda:0')
clipping
cal diff is tensor(0.0323, device='cuda:0')
________________________________
test distance is  tensor(263.1519, device='cuda:0')
test acc is  0.8844833334896554
test entropy is  0.14073188315385948
________________________________
diff is  tensor(1.1161, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0253, device='cuda:0', dtype=torch.float64)
diff is  tensor(73.3154, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0260, device='cuda:0', dtype=torch.float64)
diff is  tensor(187.4833, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1070, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.0461, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0323, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.1161, device='cuda:0')
clipping
cal diff is tensor(0.0253, device='cuda:0')
clipping
cal diff is tensor(73.3154, device='cuda:0')
clipping
cal diff is tensor(0.0260, device='cuda:0')
clipping
cal diff is tensor(187.4833, device='cuda:0')
clipping
cal diff is tensor(0.1070, device='cuda:0')
clipping
cal diff is tensor(1.0461, device='cuda:0')
clipping
cal diff is tensor(0.0323, device='cuda:0')
clipping
________________________________
test distance is  tensor(145.4601, device='cuda:0')
test acc is  0.8864333334896553
test entropy is  0.14038108437379668
________________________________
diff is  tensor(0.6170, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0140, device='cuda:0', dtype=torch.float64)
diff is  tensor(40.5258, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0144, device='cuda:0', dtype=torch.float64)
diff is  tensor(103.6334, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0591, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5782, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0179, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.6170, device='cuda:0')
clipping
cal diff is tensor(0.0140, device='cuda:0')
clipping
cal diff is tensor(40.5258, device='cuda:0')
clipping
cal diff is tensor(0.0144, device='cuda:0')
clipping
cal diff is tensor(103.6334, device='cuda:0')
clipping
cal diff is tensor(0.0591, device='cuda:0')
clipping
cal diff is tensor(0.5782, device='cuda:0')
clipping
cal diff is tensor(0.0179, device='cuda:0')
clipping
________________________________
test distance is  tensor(27.7684, device='cuda:0')
test acc is  0.8881166668229884
test entropy is  0.14070562070716164
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14070562070716164
avg test loss is  0.34861506568565803
avg accuracy is  0.8881166668229884
compute_distance is  tensor(27.7684, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15557154351428373
avg test loss is  0.48949704623457463
avg accuracy is  0.859300000156323
compute_distance is  tensor(95.6305, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(95.6305, device='cuda:0')
test acc is  0.859300000156323
test entropy is  0.15557154351428373
________________________________
new distance ratio is 0.8
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 91.20% 

Test Accuracy: 88.52% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00023245241027325392
len of model dicts is  10
compute distance is  tensor(56.5238, device='cuda:0')
compute distance is  tensor(58.2313, device='cuda:0')
compute distance is  tensor(97.4221, device='cuda:0')
compute distance is  tensor(137.2742, device='cuda:0')
compute distance is  tensor(173.6493, device='cuda:0')
compute distance is  tensor(45.7058, device='cuda:0')
compute distance is  tensor(128.5625, device='cuda:0')
compute distance is  tensor(58.1068, device='cuda:0')
compute distance is  tensor(118.7592, device='cuda:0')
compute distance is  tensor(7.4519, device='cuda:0')
calculated distance threshold is  tensor(140.4098, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8762000001563223
====================
====================
iteration is  0
round is  1
accuracy is  0.8864500001563219
====================
====================
iteration is  0
round is  2
accuracy is  0.8883166668229885
====================
====================
iteration is  1
round is  0
accuracy is  0.8920000001563216
====================
====================
iteration is  1
round is  1
accuracy is  0.875916666822989
====================
====================
iteration is  1
round is  2
accuracy is  0.8847666668229885
====================
====================
iteration is  2
round is  0
accuracy is  0.8818333334896554
====================
====================
iteration is  2
round is  1
accuracy is  0.8700000001563225
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.8809500001563221
====================
====================
iteration is  3
round is  0
accuracy is  0.8774666668229889
====================
====================
iteration is  3
round is  1
accuracy is  0.8813166668229888
====================
====================
iteration is  3
round is  2
accuracy is  0.8734833334896557
====================
====================
iteration is  4
round is  0
accuracy is  0.8859333334896552
====================
====================
iteration is  4
round is  1
accuracy is  0.876466666822989
====================
====================
iteration is  4
round is  2
accuracy is  0.8811833334896555
====================
====================
iteration is  5
round is  0
accuracy is  0.8779333334896556
====================
====================
iteration is  5
round is  1
accuracy is  0.8695000001563226
====================
succ_min + 1
====================
iteration is  5
round is  2
accuracy is  0.873166666822989
====================
====================
iteration is  6
round is  0
accuracy is  0.874116666822989
====================
====================
iteration is  6
round is  1
accuracy is  0.8850166668229886
====================
====================
iteration is  6
round is  2
accuracy is  0.8693833334896559
====================
succ_min + 1
====================
iteration is  7
round is  0
accuracy is  0.8863000001563219
====================
====================
iteration is  7
round is  1
accuracy is  0.8700500001563226
====================
====================
iteration is  7
round is  2
accuracy is  0.8711166668229892
====================
________________________________
test distance is  tensor(904.6786, device='cuda:0')
test acc is  0.8693833334896559
test entropy is  0.17089651030168604
________________________________
diff is  tensor(4.0330, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0603, device='cuda:0', dtype=torch.float64)
diff is  tensor(251.3325, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0856, device='cuda:0', dtype=torch.float64)
diff is  tensor(645.1776, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3606, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.5926, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0365, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.0330, device='cuda:0')
clipping
cal diff is tensor(0.0603, device='cuda:0')
clipping
cal diff is tensor(251.3325, device='cuda:0')
clipping
cal diff is tensor(0.0856, device='cuda:0')
clipping
cal diff is tensor(645.1776, device='cuda:0')
clipping
cal diff is tensor(0.3606, device='cuda:0')
clipping
cal diff is tensor(3.5926, device='cuda:0')
clipping
cal diff is tensor(0.0365, device='cuda:0')
clipping
________________________________
test distance is  tensor(764.2687, device='cuda:0')
test acc is  0.874166666822989
test entropy is  0.16313031022307842
________________________________
diff is  tensor(3.4071, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0509, device='cuda:0', dtype=torch.float64)
diff is  tensor(212.3247, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0723, device='cuda:0', dtype=torch.float64)
diff is  tensor(545.0433, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3046, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.0350, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0309, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.4071, device='cuda:0')
clipping
cal diff is tensor(0.0509, device='cuda:0')
clipping
cal diff is tensor(212.3246, device='cuda:0')
clipping
cal diff is tensor(0.0723, device='cuda:0')
clipping
cal diff is tensor(545.0433, device='cuda:0')
clipping
cal diff is tensor(0.3046, device='cuda:0')
clipping
cal diff is tensor(3.0350, device='cuda:0')
clipping
cal diff is tensor(0.0309, device='cuda:0')
clipping
________________________________
test distance is  tensor(623.8587, device='cuda:0')
test acc is  0.8787500001563221
test entropy is  0.1563576925267924
________________________________
diff is  tensor(2.7811, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0416, device='cuda:0', dtype=torch.float64)
diff is  tensor(173.3168, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0590, device='cuda:0', dtype=torch.float64)
diff is  tensor(444.9090, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2487, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.4775, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0252, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.7811, device='cuda:0')
clipping
cal diff is tensor(0.0416, device='cuda:0')
clipping
cal diff is tensor(173.3168, device='cuda:0')
clipping
cal diff is tensor(0.0590, device='cuda:0')
clipping
cal diff is tensor(444.9090, device='cuda:0')
clipping
cal diff is tensor(0.2487, device='cuda:0')
clipping
cal diff is tensor(2.4775, device='cuda:0')
clipping
cal diff is tensor(0.0252, device='cuda:0')
________________________________
test distance is  tensor(483.4544, device='cuda:0')
test acc is  0.8817333334896553
test entropy is  0.15069654969963184
________________________________
diff is  tensor(2.1552, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0322, device='cuda:0', dtype=torch.float64)
diff is  tensor(134.3089, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0457, device='cuda:0', dtype=torch.float64)
diff is  tensor(344.7747, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1927, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.9199, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0252, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.1552, device='cuda:0')
clipping
cal diff is tensor(0.0322, device='cuda:0')
clipping
cal diff is tensor(134.3089, device='cuda:0')
clipping
cal diff is tensor(0.0457, device='cuda:0')
clipping
cal diff is tensor(344.7747, device='cuda:0')
clipping
cal diff is tensor(0.1927, device='cuda:0')
clipping
cal diff is tensor(1.9199, device='cuda:0')
clipping
cal diff is tensor(0.0252, device='cuda:0')
________________________________
test distance is  tensor(343.0519, device='cuda:0')
test acc is  0.8841833334896554
test entropy is  0.1461312902817276
________________________________
diff is  tensor(1.5292, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0229, device='cuda:0', dtype=torch.float64)
diff is  tensor(95.3016, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0324, device='cuda:0', dtype=torch.float64)
diff is  tensor(244.6416, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1367, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3623, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0252, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.5292, device='cuda:0')
clipping
cal diff is tensor(0.0229, device='cuda:0')
clipping
cal diff is tensor(95.3016, device='cuda:0')
clipping
cal diff is tensor(0.0324, device='cuda:0')
clipping
cal diff is tensor(244.6416, device='cuda:0')
clipping
cal diff is tensor(0.1367, device='cuda:0')
clipping
cal diff is tensor(1.3623, device='cuda:0')
clipping
cal diff is tensor(0.0252, device='cuda:0')
clipping
________________________________
test distance is  tensor(202.6420, device='cuda:0')
test acc is  0.8858500001563219
test entropy is  0.14261039043429183
________________________________
diff is  tensor(0.9033, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0135, device='cuda:0', dtype=torch.float64)
diff is  tensor(56.2950, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0192, device='cuda:0', dtype=torch.float64)
diff is  tensor(144.5107, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0808, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8047, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0149, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.9033, device='cuda:0')
clipping
cal diff is tensor(0.0135, device='cuda:0')
cal diff is tensor(56.2950, device='cuda:0')
clipping
cal diff is tensor(0.0192, device='cuda:0')
clipping
cal diff is tensor(144.5107, device='cuda:0')
clipping
cal diff is tensor(0.0808, device='cuda:0')
clipping
cal diff is tensor(0.8047, device='cuda:0')
clipping
cal diff is tensor(0.0149, device='cuda:0')
clipping
________________________________
test distance is  tensor(62.2415, device='cuda:0')
test acc is  0.8867166668229886
test entropy is  0.14019387702681999
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14019387702681999
avg test loss is  0.35499119629332826
avg accuracy is  0.8867166668229886
compute_distance is  tensor(62.2415, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16668840871055499
avg test loss is  0.3959014656375657
avg accuracy is  0.8701500001563225
compute_distance is  tensor(110.6820, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(110.6820, device='cuda:0')
test acc is  0.8701500001563225
test entropy is  0.16668840871055499
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 90.83% 

Test Accuracy: 88.18% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00016245995357166976
len of model dicts is  10
compute distance is  tensor(44.2138, device='cuda:0')
compute distance is  tensor(72.2638, device='cuda:0')
compute distance is  tensor(105.1748, device='cuda:0')
compute distance is  tensor(123.0443, device='cuda:0')
compute distance is  tensor(105.1305, device='cuda:0')
compute distance is  tensor(76.7889, device='cuda:0')
compute distance is  tensor(105.3995, device='cuda:0')
compute distance is  tensor(66.4788, device='cuda:0')
compute distance is  tensor(88.7214, device='cuda:0')
compute distance is  tensor(6.9213, device='cuda:0')
calculated distance threshold is  tensor(99.8197, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8791500001563222
====================
====================
iteration is  0
round is  1
accuracy is  0.8829333334896553
====================
====================
iteration is  0
round is  2
accuracy is  0.8803666668229888
====================
====================
iteration is  1
round is  0
accuracy is  0.8772333334896556
====================
====================
iteration is  1
round is  1
accuracy is  0.8771500001563223
====================
====================
iteration is  1
round is  2
accuracy is  0.8771333334896556
====================
====================
iteration is  2
round is  0
accuracy is  0.8860333334896552
====================
====================
iteration is  2
round is  1
accuracy is  0.8829666668229886
====================
====================
iteration is  2
round is  2
accuracy is  0.8731833334896557
====================
====================
iteration is  3
round is  0
accuracy is  0.8724500001563225
====================
====================
iteration is  3
round is  1
accuracy is  0.8771666668229889
====================
====================
iteration is  3
round is  2
accuracy is  0.8754000001563224
====================
====================
iteration is  4
round is  0
accuracy is  0.8704833334896559
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.8670166668229893
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.8773500001563223
====================
====================
iteration is  5
round is  0
accuracy is  0.8807500001563221
====================
====================
iteration is  5
round is  1
accuracy is  0.884050000156322
====================
====================
iteration is  5
round is  2
accuracy is  0.864283333489656
====================
succ_min + 1
====================
iteration is  6
round is  0
accuracy is  0.8701166668229893
====================
====================
iteration is  6
round is  1
accuracy is  0.8797333334896554
====================
====================
iteration is  6
round is  2
accuracy is  0.8718500001563225
====================
________________________________
test distance is  tensor(822.5193, device='cuda:0')
test acc is  0.864283333489656
test entropy is  0.15930495667718111
________________________________
diff is  tensor(3.7013, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0603, device='cuda:0', dtype=torch.float64)
diff is  tensor(228.4795, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0822, device='cuda:0', dtype=torch.float64)
diff is  tensor(586.5575, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3243, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.2767, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0376, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.7013, device='cuda:0')
clipping
cal diff is tensor(0.0603, device='cuda:0')
clipping
cal diff is tensor(228.4795, device='cuda:0')
clipping
cal diff is tensor(0.0822, device='cuda:0')
clipping
cal diff is tensor(586.5575, device='cuda:0')
clipping
cal diff is tensor(0.3243, device='cuda:0')
clipping
cal diff is tensor(3.2767, device='cuda:0')
clipping
cal diff is tensor(0.0376, device='cuda:0')
________________________________
test distance is  tensor(722.7042, device='cuda:0')
test acc is  0.8673333334896559
test entropy is  0.15551191142627172
________________________________
diff is  tensor(3.2521, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0529, device='cuda:0', dtype=torch.float64)
diff is  tensor(200.7516, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0722, device='cuda:0', dtype=torch.float64)
diff is  tensor(515.3738, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2849, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.8791, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0376, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.2521, device='cuda:0')
clipping
cal diff is tensor(0.0529, device='cuda:0')
clipping
cal diff is tensor(200.7516, device='cuda:0')
clipping
cal diff is tensor(0.0722, device='cuda:0')
clipping
cal diff is tensor(515.3738, device='cuda:0')
clipping
cal diff is tensor(0.2849, device='cuda:0')
clipping
cal diff is tensor(2.8791, device='cuda:0')
clipping
cal diff is tensor(0.0376, device='cuda:0')
________________________________
test distance is  tensor(622.8896, device='cuda:0')
test acc is  0.8700500001563226
test entropy is  0.1520735964353786
________________________________
diff is  tensor(2.8030, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0456, device='cuda:0', dtype=torch.float64)
diff is  tensor(173.0238, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0622, device='cuda:0', dtype=torch.float64)
diff is  tensor(444.1905, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2456, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.4814, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0376, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.8030, device='cuda:0')
clipping
cal diff is tensor(0.0456, device='cuda:0')
clipping
cal diff is tensor(173.0238, device='cuda:0')
clipping
cal diff is tensor(0.0622, device='cuda:0')
clipping
cal diff is tensor(444.1905, device='cuda:0')
clipping
cal diff is tensor(0.2456, device='cuda:0')
clipping
cal diff is tensor(2.4814, device='cuda:0')
clipping
cal diff is tensor(0.0376, device='cuda:0')
________________________________
test distance is  tensor(523.0759, device='cuda:0')
test acc is  0.8726000001563224
test entropy is  0.14901442631586656
________________________________
diff is  tensor(2.3538, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0383, device='cuda:0', dtype=torch.float64)
diff is  tensor(145.2963, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0523, device='cuda:0', dtype=torch.float64)
diff is  tensor(373.0078, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2062, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.0838, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0376, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.3538, device='cuda:0')
clipping
cal diff is tensor(0.0383, device='cuda:0')
clipping
cal diff is tensor(145.2963, device='cuda:0')
clipping
cal diff is tensor(0.0523, device='cuda:0')
clipping
cal diff is tensor(373.0078, device='cuda:0')
clipping
cal diff is tensor(0.2062, device='cuda:0')
clipping
cal diff is tensor(2.0838, device='cuda:0')
clipping
cal diff is tensor(0.0376, device='cuda:0')
________________________________
test distance is  tensor(423.2634, device='cuda:0')
test acc is  0.8749500001563224
test entropy is  0.14632523217514506
________________________________
diff is  tensor(1.9046, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0310, device='cuda:0', dtype=torch.float64)
diff is  tensor(117.5691, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0423, device='cuda:0', dtype=torch.float64)
diff is  tensor(301.8259, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1669, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.6861, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0376, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.9046, device='cuda:0')
clipping
cal diff is tensor(0.0310, device='cuda:0')
clipping
cal diff is tensor(117.5691, device='cuda:0')
clipping
cal diff is tensor(0.0423, device='cuda:0')
clipping
cal diff is tensor(301.8259, device='cuda:0')
clipping
cal diff is tensor(0.1669, device='cuda:0')
clipping
cal diff is tensor(1.6861, device='cuda:0')
clipping
cal diff is tensor(0.0376, device='cuda:0')
clipping
________________________________
test distance is  tensor(323.4437, device='cuda:0')
test acc is  0.8773166668229889
test entropy is  0.14400348799632812
________________________________
diff is  tensor(1.4554, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0237, device='cuda:0', dtype=torch.float64)
diff is  tensor(89.8424, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0323, device='cuda:0', dtype=torch.float64)
diff is  tensor(230.6452, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1275, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.2885, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0287, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.4554, device='cuda:0')
clipping
cal diff is tensor(0.0237, device='cuda:0')
cal diff is tensor(89.8424, device='cuda:0')
clipping
cal diff is tensor(0.0323, device='cuda:0')
clipping
cal diff is tensor(230.6452, device='cuda:0')
clipping
cal diff is tensor(0.1275, device='cuda:0')
clipping
cal diff is tensor(1.2885, device='cuda:0')
clipping
cal diff is tensor(0.0287, device='cuda:0')
clipping
________________________________
test distance is  tensor(223.6313, device='cuda:0')
test acc is  0.8793833334896555
test entropy is  0.14207499089049125
________________________________
diff is  tensor(1.0063, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0237, device='cuda:0', dtype=torch.float64)
diff is  tensor(62.1156, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0223, device='cuda:0', dtype=torch.float64)
diff is  tensor(159.4645, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0882, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.8908, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0198, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0063, device='cuda:0')
clipping
cal diff is tensor(0.0237, device='cuda:0')
clipping
cal diff is tensor(62.1156, device='cuda:0')
clipping
cal diff is tensor(0.0223, device='cuda:0')
clipping
cal diff is tensor(159.4645, device='cuda:0')
clipping
cal diff is tensor(0.0882, device='cuda:0')
clipping
cal diff is tensor(0.8908, device='cuda:0')
clipping
cal diff is tensor(0.0198, device='cuda:0')
clipping
________________________________
test distance is  tensor(123.8117, device='cuda:0')
test acc is  0.8810500001563222
test entropy is  0.140603219045759
________________________________
diff is  tensor(0.5571, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0131, device='cuda:0', dtype=torch.float64)
diff is  tensor(34.3898, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0124, device='cuda:0', dtype=torch.float64)
diff is  tensor(88.2862, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0488, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4932, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0110, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.5571, device='cuda:0')
clipping
cal diff is tensor(0.0131, device='cuda:0')
clipping
cal diff is tensor(34.3898, device='cuda:0')
clipping
cal diff is tensor(0.0124, device='cuda:0')
clipping
cal diff is tensor(88.2862, device='cuda:0')
clipping
cal diff is tensor(0.0488, device='cuda:0')
clipping
cal diff is tensor(0.4932, device='cuda:0')
clipping
cal diff is tensor(0.0110, device='cuda:0')
clipping
________________________________
test distance is  tensor(23.9921, device='cuda:0')
test acc is  0.8822333334896554
test entropy is  0.1395770595518193
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1395770595518193
avg test loss is  0.3759152388601288
avg accuracy is  0.8822333334896554
compute_distance is  tensor(23.9921, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.156344910674512
avg test loss is  0.44918322641013275
avg accuracy is  0.8651666668229894
compute_distance is  tensor(93.0086, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(93.0086, device='cuda:0')
test acc is  0.8651666668229894
test entropy is  0.156344910674512
________________________________
new distance ratio is 0.8
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 91.38% 

Test Accuracy: 88.85% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00014941583503969014
len of model dicts is  10
compute distance is  tensor(39.8122, device='cuda:0')
compute distance is  tensor(59.3339, device='cuda:0')
compute distance is  tensor(88.6093, device='cuda:0')
compute distance is  tensor(69.6536, device='cuda:0')
compute distance is  tensor(64.3374, device='cuda:0')
compute distance is  tensor(47.3548, device='cuda:0')
compute distance is  tensor(98.0822, device='cuda:0')
compute distance is  tensor(60.0140, device='cuda:0')
compute distance is  tensor(131.7301, device='cuda:0')
compute distance is  tensor(7.3922, device='cuda:0')
calculated distance threshold is  tensor(106.8625, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8863333334896553
====================
====================
iteration is  0
round is  1
accuracy is  0.8942666668229883
====================
====================
iteration is  0
round is  2
accuracy is  0.8888666668229884
====================
====================
iteration is  1
round is  0
accuracy is  0.8837666668229887
====================
====================
iteration is  1
round is  1
accuracy is  0.8874500001563219
====================
====================
iteration is  1
round is  2
accuracy is  0.8938666668229883
====================
====================
iteration is  2
round is  0
accuracy is  0.8817833334896553
====================
====================
iteration is  2
round is  1
accuracy is  0.8899000001563218
====================
====================
iteration is  2
round is  2
accuracy is  0.8862000001563219
====================
====================
iteration is  3
round is  0
accuracy is  0.8841666668229887
====================
====================
iteration is  3
round is  1
accuracy is  0.884650000156322
====================
====================
iteration is  3
round is  2
accuracy is  0.8747000001563223
====================
====================
iteration is  4
round is  0
accuracy is  0.8909833334896551
====================
====================
iteration is  4
round is  1
accuracy is  0.8863500001563219
====================
====================
iteration is  4
round is  2
accuracy is  0.8797500001563221
====================
====================
iteration is  5
round is  0
accuracy is  0.883800000156322
====================
====================
iteration is  5
round is  1
accuracy is  0.8656000001563228
====================
succ_min + 1
====================
iteration is  5
round is  2
accuracy is  0.8842666668229887
====================
====================
iteration is  6
round is  0
accuracy is  0.8818833334896554
====================
====================
iteration is  6
round is  1
accuracy is  0.8801666668229888
====================
====================
iteration is  6
round is  2
accuracy is  0.8747666668229891
====================
====================
iteration is  7
round is  0
accuracy is  0.8706500001563225
====================
====================
iteration is  7
round is  1
accuracy is  0.8673833334896559
====================
====================
iteration is  7
round is  2
accuracy is  0.8859000001563219
====================
====================
iteration is  8
round is  0
accuracy is  0.883200000156322
====================
====================
iteration is  8
round is  1
accuracy is  0.8571833334896564
====================
succ_min + 1
====================
iteration is  8
round is  2
accuracy is  0.8777833334896555
====================
====================
iteration is  9
round is  0
accuracy is  0.8574833334896563
====================
________________________________
test distance is  tensor(1096.0461, device='cuda:0')
test acc is  0.8571833334896564
test entropy is  0.1836489132488333
________________________________
diff is  tensor(4.7141, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0790, device='cuda:0', dtype=torch.float64)
diff is  tensor(305.5467, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1068, device='cuda:0', dtype=torch.float64)
diff is  tensor(780.7707, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.4395, device='cuda:0', dtype=torch.float64)
diff is  tensor(4.3553, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0342, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.7141, device='cuda:0')
clipping
cal diff is tensor(0.0790, device='cuda:0')
clipping
cal diff is tensor(305.5467, device='cuda:0')
clipping
cal diff is tensor(0.1068, device='cuda:0')
clipping
cal diff is tensor(780.7706, device='cuda:0')
clipping
cal diff is tensor(0.4395, device='cuda:0')
clipping
cal diff is tensor(4.3553, device='cuda:0')
clipping
cal diff is tensor(0.0342, device='cuda:0')
clipping
________________________________
test distance is  tensor(989.1837, device='cuda:0')
test acc is  0.862133333489656
test entropy is  0.17683045937816724
________________________________
diff is  tensor(4.2545, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0713, device='cuda:0', dtype=torch.float64)
diff is  tensor(275.7565, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0964, device='cuda:0', dtype=torch.float64)
diff is  tensor(704.6469, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3966, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.9307, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0308, device='cuda:0', dtype=torch.float64)
cal diff is tensor(4.2545, device='cuda:0')
clipping
cal diff is tensor(0.0713, device='cuda:0')
clipping
cal diff is tensor(275.7565, device='cuda:0')
clipping
cal diff is tensor(0.0964, device='cuda:0')
clipping
cal diff is tensor(704.6469, device='cuda:0')
clipping
cal diff is tensor(0.3966, device='cuda:0')
clipping
cal diff is tensor(3.9307, device='cuda:0')
clipping
cal diff is tensor(0.0308, device='cuda:0')
clipping
________________________________
test distance is  tensor(882.3212, device='cuda:0')
test acc is  0.8668000001563226
test entropy is  0.17045157185114268
________________________________
diff is  tensor(3.7949, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0636, device='cuda:0', dtype=torch.float64)
diff is  tensor(245.9662, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0859, device='cuda:0', dtype=torch.float64)
diff is  tensor(628.5232, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3538, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.5061, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0275, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.7949, device='cuda:0')
clipping
cal diff is tensor(0.0636, device='cuda:0')
clipping
cal diff is tensor(245.9662, device='cuda:0')
clipping
cal diff is tensor(0.0859, device='cuda:0')
clipping
cal diff is tensor(628.5232, device='cuda:0')
clipping
cal diff is tensor(0.3538, device='cuda:0')
clipping
cal diff is tensor(3.5061, device='cuda:0')
clipping
cal diff is tensor(0.0275, device='cuda:0')
________________________________
test distance is  tensor(775.4620, device='cuda:0')
test acc is  0.8711000001563225
test entropy is  0.16452602781593673
________________________________
diff is  tensor(3.3353, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0559, device='cuda:0', dtype=torch.float64)
diff is  tensor(216.1760, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0755, device='cuda:0', dtype=torch.float64)
diff is  tensor(552.3995, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.3109, device='cuda:0', dtype=torch.float64)
diff is  tensor(3.0814, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0275, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.3353, device='cuda:0')
clipping
cal diff is tensor(0.0559, device='cuda:0')
clipping
cal diff is tensor(216.1760, device='cuda:0')
clipping
cal diff is tensor(0.0755, device='cuda:0')
clipping
cal diff is tensor(552.3995, device='cuda:0')
clipping
cal diff is tensor(0.3109, device='cuda:0')
clipping
cal diff is tensor(3.0814, device='cuda:0')
clipping
cal diff is tensor(0.0275, device='cuda:0')
________________________________
test distance is  tensor(668.6033, device='cuda:0')
test acc is  0.8752000001563224
test entropy is  0.15908869269734888
________________________________
diff is  tensor(2.8756, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0482, device='cuda:0', dtype=torch.float64)
diff is  tensor(186.3858, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0651, device='cuda:0', dtype=torch.float64)
diff is  tensor(476.2761, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2681, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.6568, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0275, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.8756, device='cuda:0')
clipping
cal diff is tensor(0.0482, device='cuda:0')
clipping
cal diff is tensor(186.3858, device='cuda:0')
clipping
cal diff is tensor(0.0651, device='cuda:0')
clipping
cal diff is tensor(476.2761, device='cuda:0')
clipping
cal diff is tensor(0.2681, device='cuda:0')
clipping
cal diff is tensor(2.6568, device='cuda:0')
clipping
cal diff is tensor(0.0275, device='cuda:0')
________________________________
test distance is  tensor(561.7452, device='cuda:0')
test acc is  0.8785666668229888
test entropy is  0.15416993588796937
________________________________
diff is  tensor(2.4160, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0405, device='cuda:0', dtype=torch.float64)
diff is  tensor(156.5959, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0547, device='cuda:0', dtype=torch.float64)
diff is  tensor(400.1531, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2252, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.2322, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0275, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.4160, device='cuda:0')
clipping
cal diff is tensor(0.0405, device='cuda:0')
clipping
cal diff is tensor(156.5959, device='cuda:0')
clipping
cal diff is tensor(0.0547, device='cuda:0')
clipping
cal diff is tensor(400.1531, device='cuda:0')
clipping
cal diff is tensor(0.2252, device='cuda:0')
clipping
cal diff is tensor(2.2322, device='cuda:0')
clipping
cal diff is tensor(0.0275, device='cuda:0')
________________________________
test distance is  tensor(454.8878, device='cuda:0')
test acc is  0.881600000156322
test entropy is  0.1498167609839615
________________________________
diff is  tensor(1.9564, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0328, device='cuda:0', dtype=torch.float64)
diff is  tensor(126.8062, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0443, device='cuda:0', dtype=torch.float64)
diff is  tensor(324.0308, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1824, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.8075, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0275, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.9564, device='cuda:0')
clipping
cal diff is tensor(0.0328, device='cuda:0')
clipping
cal diff is tensor(126.8062, device='cuda:0')
clipping
cal diff is tensor(0.0443, device='cuda:0')
clipping
cal diff is tensor(324.0308, device='cuda:0')
clipping
cal diff is tensor(0.1824, device='cuda:0')
clipping
cal diff is tensor(1.8075, device='cuda:0')
clipping
cal diff is tensor(0.0275, device='cuda:0')
________________________________
test distance is  tensor(348.0318, device='cuda:0')
test acc is  0.8840333334896553
test entropy is  0.14605785319323478
________________________________
diff is  tensor(1.4968, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0251, device='cuda:0', dtype=torch.float64)
diff is  tensor(97.0168, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0339, device='cuda:0', dtype=torch.float64)
diff is  tensor(247.9093, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1395, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3829, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0275, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.4968, device='cuda:0')
clipping
cal diff is tensor(0.0251, device='cuda:0')
cal diff is tensor(97.0168, device='cuda:0')
clipping
cal diff is tensor(0.0339, device='cuda:0')
clipping
cal diff is tensor(247.9093, device='cuda:0')
clipping
cal diff is tensor(0.1395, device='cuda:0')
clipping
cal diff is tensor(1.3829, device='cuda:0')
clipping
cal diff is tensor(0.0275, device='cuda:0')
clipping
________________________________
test distance is  tensor(241.1769, device='cuda:0')
test acc is  0.8864500001563219
test entropy is  0.1429798943576401
________________________________
diff is  tensor(1.0372, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0251, device='cuda:0', dtype=torch.float64)
diff is  tensor(67.2279, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0235, device='cuda:0', dtype=torch.float64)
diff is  tensor(171.7892, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0967, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9583, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0191, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0372, device='cuda:0')
clipping
cal diff is tensor(0.0251, device='cuda:0')
clipping
cal diff is tensor(67.2279, device='cuda:0')
clipping
cal diff is tensor(0.0235, device='cuda:0')
clipping
cal diff is tensor(171.7892, device='cuda:0')
clipping
cal diff is tensor(0.0967, device='cuda:0')
clipping
cal diff is tensor(0.9583, device='cuda:0')
clipping
cal diff is tensor(0.0191, device='cuda:0')
clipping
________________________________
test distance is  tensor(134.3144, device='cuda:0')
test acc is  0.8882666668229884
test entropy is  0.14052879623671585
________________________________
diff is  tensor(0.5776, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0140, device='cuda:0', dtype=torch.float64)
diff is  tensor(37.4401, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0131, device='cuda:0', dtype=torch.float64)
diff is  tensor(95.6715, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0539, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5337, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0106, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.5776, device='cuda:0')
clipping
cal diff is tensor(0.0140, device='cuda:0')
clipping
cal diff is tensor(37.4401, device='cuda:0')
clipping
cal diff is tensor(0.0131, device='cuda:0')
clipping
cal diff is tensor(95.6715, device='cuda:0')
clipping
cal diff is tensor(0.0539, device='cuda:0')
clipping
cal diff is tensor(0.5337, device='cuda:0')
clipping
cal diff is tensor(0.0106, device='cuda:0')
________________________________
test distance is  tensor(27.4604, device='cuda:0')
test acc is  0.8895500001563218
test entropy is  0.13874973676828686
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13874973676828686
avg test loss is  0.3454848839136869
avg accuracy is  0.8895500001563218
compute_distance is  tensor(27.4604, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1783211313203962
avg test loss is  0.44061912402415326
avg accuracy is  0.8580666668229896
compute_distance is  tensor(93.8402, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(93.8402, device='cuda:0')
test acc is  0.8580666668229896
test entropy is  0.1783211313203962
________________________________
new distance ratio is 0.8
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 91.05% 

Test Accuracy: 88.43% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00015480715956073254
len of model dicts is  10
compute distance is  tensor(36.7239, device='cuda:0')
compute distance is  tensor(77.4358, device='cuda:0')
compute distance is  tensor(100.9814, device='cuda:0')
compute distance is  tensor(104.3867, device='cuda:0')
compute distance is  tensor(86.3665, device='cuda:0')
compute distance is  tensor(74.5748, device='cuda:0')
compute distance is  tensor(123.4811, device='cuda:0')
compute distance is  tensor(71.4495, device='cuda:0')
compute distance is  tensor(108.8241, device='cuda:0')
compute distance is  tensor(6.8824, device='cuda:0')
calculated distance threshold is  tensor(100.1614, device='cuda:0')
pinned_accuracy threshold is  0.8723000001570008
====================
iteration is  0
round is  0
accuracy is  0.8803500001563221
====================
====================
iteration is  0
round is  1
accuracy is  0.8811000001563222
====================
====================
iteration is  0
round is  2
accuracy is  0.8816833334896554
====================
====================
iteration is  1
round is  0
accuracy is  0.8844833334896554
====================
====================
iteration is  1
round is  1
accuracy is  0.8847666668229887
====================
====================
iteration is  1
round is  2
accuracy is  0.8813166668229888
====================
====================
iteration is  2
round is  0
accuracy is  0.876066666822989
====================
====================
iteration is  2
round is  1
accuracy is  0.882250000156322
====================
====================
iteration is  2
round is  2
accuracy is  0.8701166668229893
====================
succ_min + 1
====================
iteration is  3
round is  0
accuracy is  0.8825333334896553
====================
====================
iteration is  3
round is  1
accuracy is  0.8846166668229887
====================
====================
iteration is  3
round is  2
accuracy is  0.873716666822989
====================
====================
iteration is  4
round is  0
accuracy is  0.8773333334896556
====================
====================
iteration is  4
round is  1
accuracy is  0.8669500001563226
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.8704000001563225
====================
====================
iteration is  5
round is  0
accuracy is  0.8698166668229893
====================
====================
iteration is  5
round is  1
accuracy is  0.8835666668229887
====================
====================
iteration is  5
round is  2
accuracy is  0.8732500001563225
====================
====================
iteration is  6
round is  0
accuracy is  0.8700500001563226
====================
________________________________
test distance is  tensor(747.3103, device='cuda:0')
test acc is  0.8669500001563226
test entropy is  0.15898647581511088
________________________________
diff is  tensor(3.2585, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0490, device='cuda:0', dtype=torch.float64)
diff is  tensor(207.4920, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0640, device='cuda:0', dtype=torch.float64)
diff is  tensor(533.1518, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2953, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.9749, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0247, device='cuda:0', dtype=torch.float64)
cal diff is tensor(3.2585, device='cuda:0')
clipping
cal diff is tensor(0.0490, device='cuda:0')
clipping
cal diff is tensor(207.4920, device='cuda:0')
clipping
cal diff is tensor(0.0640, device='cuda:0')
clipping
cal diff is tensor(533.1519, device='cuda:0')
clipping
cal diff is tensor(0.2953, device='cuda:0')
clipping
cal diff is tensor(2.9749, device='cuda:0')
clipping
cal diff is tensor(0.0247, device='cuda:0')
clipping
________________________________
test distance is  tensor(647.1490, device='cuda:0')
test acc is  0.8704333334896558
test entropy is  0.15461186225464477
________________________________
diff is  tensor(2.8218, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0424, device='cuda:0', dtype=torch.float64)
diff is  tensor(179.6821, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0554, device='cuda:0', dtype=torch.float64)
diff is  tensor(461.6940, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2557, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.5761, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0214, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.8218, device='cuda:0')
clipping
cal diff is tensor(0.0424, device='cuda:0')
clipping
cal diff is tensor(179.6821, device='cuda:0')
clipping
cal diff is tensor(0.0554, device='cuda:0')
clipping
cal diff is tensor(461.6939, device='cuda:0')
clipping
cal diff is tensor(0.2557, device='cuda:0')
clipping
cal diff is tensor(2.5761, device='cuda:0')
clipping
cal diff is tensor(0.0214, device='cuda:0')
________________________________
test distance is  tensor(546.9910, device='cuda:0')
test acc is  0.8738833334896557
test entropy is  0.15070045034863802
________________________________
diff is  tensor(2.3851, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0359, device='cuda:0', dtype=torch.float64)
diff is  tensor(151.8721, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0469, device='cuda:0', dtype=torch.float64)
diff is  tensor(390.2361, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.2161, device='cuda:0', dtype=torch.float64)
diff is  tensor(2.1774, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0214, device='cuda:0', dtype=torch.float64)
cal diff is tensor(2.3851, device='cuda:0')
clipping
cal diff is tensor(0.0359, device='cuda:0')
clipping
cal diff is tensor(151.8721, device='cuda:0')
clipping
cal diff is tensor(0.0469, device='cuda:0')
clipping
cal diff is tensor(390.2361, device='cuda:0')
clipping
cal diff is tensor(0.2161, device='cuda:0')
clipping
cal diff is tensor(2.1774, device='cuda:0')
clipping
cal diff is tensor(0.0214, device='cuda:0')
________________________________
test distance is  tensor(446.8336, device='cuda:0')
test acc is  0.8765666668229889
test entropy is  0.14725481842293034
________________________________
diff is  tensor(1.9483, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0293, device='cuda:0', dtype=torch.float64)
diff is  tensor(124.0623, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0383, device='cuda:0', dtype=torch.float64)
diff is  tensor(318.7787, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1766, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.7787, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0214, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.9483, device='cuda:0')
clipping
cal diff is tensor(0.0293, device='cuda:0')
clipping
cal diff is tensor(124.0623, device='cuda:0')
clipping
cal diff is tensor(0.0383, device='cuda:0')
clipping
cal diff is tensor(318.7787, device='cuda:0')
clipping
cal diff is tensor(0.1766, device='cuda:0')
clipping
cal diff is tensor(1.7787, device='cuda:0')
clipping
cal diff is tensor(0.0214, device='cuda:0')
________________________________
test distance is  tensor(346.6771, device='cuda:0')
test acc is  0.8793666668229888
test entropy is  0.14429944631721037
________________________________
diff is  tensor(1.5116, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0227, device='cuda:0', dtype=torch.float64)
diff is  tensor(96.2528, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0297, device='cuda:0', dtype=torch.float64)
diff is  tensor(247.3219, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.1370, device='cuda:0', dtype=torch.float64)
diff is  tensor(1.3800, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0214, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.5116, device='cuda:0')
clipping
cal diff is tensor(0.0227, device='cuda:0')
clipping
cal diff is tensor(96.2528, device='cuda:0')
clipping
cal diff is tensor(0.0297, device='cuda:0')
clipping
cal diff is tensor(247.3219, device='cuda:0')
clipping
cal diff is tensor(0.1370, device='cuda:0')
clipping
cal diff is tensor(1.3800, device='cuda:0')
clipping
cal diff is tensor(0.0214, device='cuda:0')
________________________________
test distance is  tensor(246.5220, device='cuda:0')
test acc is  0.882000000156322
test entropy is  0.141853407712411
________________________________
diff is  tensor(1.0749, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0162, device='cuda:0', dtype=torch.float64)
diff is  tensor(68.4436, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0211, device='cuda:0', dtype=torch.float64)
diff is  tensor(175.8661, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0974, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.9813, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0214, device='cuda:0', dtype=torch.float64)
cal diff is tensor(1.0749, device='cuda:0')
clipping
cal diff is tensor(0.0162, device='cuda:0')
cal diff is tensor(68.4436, device='cuda:0')
clipping
cal diff is tensor(0.0211, device='cuda:0')
clipping
cal diff is tensor(175.8661, device='cuda:0')
clipping
cal diff is tensor(0.0974, device='cuda:0')
clipping
cal diff is tensor(0.9813, device='cuda:0')
clipping
cal diff is tensor(0.0214, device='cuda:0')
clipping
________________________________
test distance is  tensor(146.3673, device='cuda:0')
test acc is  0.8837833334896553
test entropy is  0.14003888547801768
________________________________
diff is  tensor(0.6381, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0162, device='cuda:0', dtype=torch.float64)
diff is  tensor(40.6351, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0125, device='cuda:0', dtype=torch.float64)
diff is  tensor(104.4121, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0578, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.5826, device='cuda:0', dtype=torch.float64)
diff is  tensor(0.0127, device='cuda:0', dtype=torch.float64)
cal diff is tensor(0.6381, device='cuda:0')
clipping
cal diff is tensor(0.0162, device='cuda:0')
clipping
cal diff is tensor(40.6351, device='cuda:0')
clipping
cal diff is tensor(0.0125, device='cuda:0')
cal diff is tensor(104.4121, device='cuda:0')
clipping
cal diff is tensor(0.0578, device='cuda:0')
clipping
cal diff is tensor(0.5826, device='cuda:0')
clipping
cal diff is tensor(0.0127, device='cuda:0')
clipping
________________________________
test distance is  tensor(46.2146, device='cuda:0')
test acc is  0.8852333334896553
test entropy is  0.13870351274670567
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13870351274670567
avg test loss is  0.3651644788674518
avg accuracy is  0.8852333334896553
compute_distance is  tensor(46.2146, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15581909637016528
avg test loss is  0.4258048345825311
avg accuracy is  0.8678166668229893
compute_distance is  tensor(102.6931, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(102.6931, device='cuda:0')
test acc is  0.8678166668229893
test entropy is  0.15581909637016528
________________________________
diff is  tensor(0.2629, device='cuda:0')
diff is  tensor(0.0052, device='cuda:0')
diff is  tensor(20.5104, device='cuda:0')
diff is  tensor(0.0134, device='cuda:0')
diff is  tensor(81.6397, device='cuda:0')
diff is  tensor(0.0197, device='cuda:0')
diff is  tensor(0.2351, device='cuda:0')
diff is  tensor(0.0040, device='cuda:0')
cal diff is tensor(0.2629, device='cuda:0')
clipping
cal diff is tensor(0.0052, device='cuda:0')
clipping
cal diff is tensor(20.5104, device='cuda:0')
clipping
cal diff is tensor(0.0134, device='cuda:0')
clipping
cal diff is tensor(81.6397, device='cuda:0')
clipping
cal diff is tensor(0.0197, device='cuda:0')
clipping
cal diff is tensor(0.2351, device='cuda:0')
clipping
cal diff is tensor(0.0040, device='cuda:0')
clipping
________________________________
test distance is  tensor(2.5345, device='cuda:0')
test acc is  0.8853833334896553
test entropy is  0.1386027266817497
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1386027266817497
avg test loss is  0.3645174767313672
avg accuracy is  0.8853833334896553
compute_distance is  tensor(2.5345, device='cuda:0')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.155862909271074
avg test loss is  0.4259344624248204
avg accuracy is  0.867783333489656
compute_distance is  tensor(89.9978, device='cuda:0')
++++++++++++++++++++
________________________________
test distance is  tensor(89.9978, device='cuda:0')
test acc is  0.867783333489656
test entropy is  0.155862909271074
________________________________
new distance ratio is 0.8
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 91.28% 

Test Accuracy: 88.62% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 91.28%
|----0th round Training Accuracy : 27.47%
|----1th round Training Accuracy : 72.13%
|----2th round Training Accuracy : 81.62%
|----3th round Training Accuracy : 84.89%
|----4th round Training Accuracy : 89.63%
|----5th round Training Accuracy : 93.03%
|----6th round Training Accuracy : 91.73%
|----7th round Training Accuracy : 94.18%
|----8th round Training Accuracy : 95.21%
|----9th round Training Accuracy : 95.91%
|----10th round Training Accuracy : 95.15%
|----11th round Training Accuracy : 95.90%
|----12th round Training Accuracy : 96.46%
|----13th round Training Accuracy : 96.79%
|----14th round Training Accuracy : 96.45%
|----15th round Training Accuracy : 96.69%
|----16th round Training Accuracy : 96.72%
|----17th round Training Accuracy : 96.98%
|----18th round Training Accuracy : 96.66%
|----19th round Training Accuracy : 96.94%
|----20th round Training Accuracy : 97.12%
|----21th round Training Accuracy : 97.23%
|----22th round Training Accuracy : 97.08%
|----23th round Training Accuracy : 97.19%
|----24th round Training Accuracy : 97.06%
|----25th round Training Accuracy : 97.10%
|----26th round Training Accuracy : 97.02%
|----27th round Training Accuracy : 97.14%
|----28th round Training Accuracy : 97.15%
|----29th round Training Accuracy : 97.32%
|----30th round Training Accuracy : 94.11%
|----31th round Training Accuracy : 93.32%
|----32th round Training Accuracy : 92.16%
|----33th round Training Accuracy : 91.15%
|----34th round Training Accuracy : 90.64%
|----35th round Training Accuracy : 91.21%
|----36th round Training Accuracy : 90.11%
|----37th round Training Accuracy : 90.10%
|----38th round Training Accuracy : 90.06%
|----39th round Training Accuracy : 90.94%
|----40th round Training Accuracy : 90.23%
|----41th round Training Accuracy : 90.66%
|----42th round Training Accuracy : 90.03%
|----43th round Training Accuracy : 90.92%
|----44th round Training Accuracy : 91.19%
|----45th round Training Accuracy : 91.20%
|----46th round Training Accuracy : 90.83%
|----47th round Training Accuracy : 91.38%
|----48th round Training Accuracy : 91.05%
|----49th round Training Accuracy : 91.28%
|----Final Test Accuracy: 88.62%
|----0th round Final Test Accuracy : 32.27%
|----1th round Final Test Accuracy : 71.89%
|----2th round Final Test Accuracy : 81.45%
|----3th round Final Test Accuracy : 84.99%
|----4th round Final Test Accuracy : 89.82%
|----5th round Final Test Accuracy : 93.08%
|----6th round Final Test Accuracy : 92.22%
|----7th round Final Test Accuracy : 94.23%
|----8th round Final Test Accuracy : 95.48%
|----9th round Final Test Accuracy : 95.45%
|----10th round Final Test Accuracy : 95.35%
|----11th round Final Test Accuracy : 96.10%
|----12th round Final Test Accuracy : 96.36%
|----13th round Final Test Accuracy : 96.35%
|----14th round Final Test Accuracy : 96.48%
|----15th round Final Test Accuracy : 96.60%
|----16th round Final Test Accuracy : 96.59%
|----17th round Final Test Accuracy : 96.83%
|----18th round Final Test Accuracy : 96.82%
|----19th round Final Test Accuracy : 96.83%
|----20th round Final Test Accuracy : 96.88%
|----21th round Final Test Accuracy : 96.92%
|----22th round Final Test Accuracy : 96.95%
|----23th round Final Test Accuracy : 97.00%
|----24th round Final Test Accuracy : 96.99%
|----25th round Final Test Accuracy : 96.97%
|----26th round Final Test Accuracy : 97.01%
|----27th round Final Test Accuracy : 97.11%
|----28th round Final Test Accuracy : 97.08%
|----29th round Final Test Accuracy : 97.23%
|----30th round Final Test Accuracy : 93.00%
|----31th round Final Test Accuracy : 91.80%
|----32th round Final Test Accuracy : 90.12%
|----33th round Final Test Accuracy : 88.47%
|----34th round Final Test Accuracy : 87.70%
|----35th round Final Test Accuracy : 88.80%
|----36th round Final Test Accuracy : 87.34%
|----37th round Final Test Accuracy : 87.27%
|----38th round Final Test Accuracy : 87.16%
|----39th round Final Test Accuracy : 88.44%
|----40th round Final Test Accuracy : 87.50%
|----41th round Final Test Accuracy : 87.95%
|----42th round Final Test Accuracy : 87.21%
|----43th round Final Test Accuracy : 88.34%
|----44th round Final Test Accuracy : 88.64%
|----45th round Final Test Accuracy : 88.52%
|----46th round Final Test Accuracy : 88.18%
|----47th round Final Test Accuracy : 88.85%
|----48th round Final Test Accuracy : 88.43%
|----49th round Final Test Accuracy : 88.62%

Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 18750.8997
